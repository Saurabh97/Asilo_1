[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:61803
[S3] → join 127.0.0.1:61802
[S4] → join 127.0.0.1:61802
[S5] → join 127.0.0.1:61802
[S6] → join 127.0.0.1:61802
[S7] → join 127.0.0.1:61802
[S8] → join 127.0.0.1:61802
[S9] → join 127.0.0.1:61802
[S10] → join 127.0.0.1:61802
[S11] → join 127.0.0.1:61802
[S13] → join 127.0.0.1:61802
[S14] → join 127.0.0.1:61802
[S15] → join 127.0.0.1:61802
[S16] → join 127.0.0.1:61802
[S17] → join 127.0.0.1:61802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.154312 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.156208 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.120989 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.160062 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.154517 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.174907 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.109086 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.137045 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.192525 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.165620 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.203068 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.160393 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.130406 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.153339 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.194270 (no previous merge yet)
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S4] + discovered S3
[S3] + discovered S17
[S3] + discovered S5
[S3] + discovered S13
[S3] + discovered S4
[S3] + discovered S14
[S3] + discovered S16
[S3] + discovered S9
[S3] + discovered S15
[S3] + discovered S7
[S3] + discovered S11
[S3] + discovered S6
[S3] + discovered S10
[S3] + discovered S8
[S4] + discovered S2
[S4] + discovered S17
[S4] + discovered S5
[S4] + discovered S13
[S5] + discovered S2
[S4] + discovered S16
[S4] + discovered S14
[S4] + discovered S9
[S4] + discovered S15
[S4] + discovered S7
[S4] + discovered S11
[S4] + discovered S6
[S4] + discovered S10
[S4] + discovered S8
[S5] + discovered S3
[S5] + discovered S4
[S5] + discovered S9
[S5] + discovered S7
[S5] + discovered S17
[S5] + discovered S6
[S5] + discovered S16
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S3
[S6] + discovered S2
[S5] + discovered S15
[S5] + discovered S11
[S5] + discovered S10
[S5] + discovered S8
[S5] + discovered S13
[S5] + discovered S14
[S6] + discovered S13
[S7] + discovered S2
[S7] + discovered S5
[S7] + discovered S6
[S7] + discovered S4
[S7] + discovered S3
[S6] + discovered S15
[S6] + discovered S14
[S6] + discovered S11
[S6] + discovered S10
[S6] + discovered S16
[S6] + discovered S17
[S6] + discovered S7
[S6] + discovered S8
[S6] + discovered S9
[S8] + discovered S4
[S8] + discovered S2
[S7] + discovered S8
[S7] + discovered S17
[S7] + discovered S11
[S7] + discovered S15
[S7] + discovered S13
[S8] + discovered S3
[S7] + discovered S14
[S7] + discovered S9
[S8] + discovered S7
[S7] + discovered S16
[S8] + discovered S6
[S7] + discovered S10
[S8] + discovered S5
[S9] + discovered S3
[S8] + discovered S13
[S9] + discovered S6
[S8] + discovered S9
[S9] + discovered S5
[S8] + discovered S10
[S8] + discovered S16
[S9] + discovered S7
[S8] + discovered S15
[S9] + discovered S4
[S8] + discovered S14
[S9] + discovered S2
[S8] + discovered S11
[S9] + discovered S8
[S8] + discovered S17
[S10] + discovered S6
[S10] + discovered S8
[S10] + discovered S9
[S10] + discovered S2
[S10] + discovered S4
[S10] + discovered S7
[S9] + discovered S14
[S10] + discovered S3
[S10] + discovered S5
[S9] + discovered S13
[S9] + discovered S11
[S9] + discovered S17
[S9] + discovered S15
[S9] + discovered S10
[S9] + discovered S16
[S11] + discovered S7
[S10] + discovered S16
[S10] + discovered S13
[S10] + discovered S15
[S10] + discovered S17
[S11] + discovered S2
[S10] + discovered S11
[S11] + discovered S6
[S10] + discovered S14
[S11] + discovered S9
[S11] + discovered S8
[S11] + discovered S5
[S11] + discovered S3
[S11] + discovered S10
[S11] + discovered S4
[S13] + discovered S8
[S13] + discovered S5
[S13] + discovered S3
[S11] + discovered S14
[S11] + discovered S17
[S11] + discovered S16
[S11] + discovered S13
[S11] + discovered S15
[S13] + discovered S6
[S13] + discovered S2
[S13] + discovered S10
[S13] + discovered S4
[S13] + discovered S11
[S13] + discovered S7
[S13] + discovered S9
[S14] + discovered S6
[S14] + discovered S3
[S14] + discovered S5
[S14] + discovered S13
[S13] + discovered S14
[S13] + discovered S15
[S13] + discovered S16
[S13] + discovered S17
[S14] + discovered S2
[S14] + discovered S10
[S14] + discovered S4
[S14] + discovered S11
[S14] + discovered S7
[S14] + discovered S9
[S14] + discovered S8
[S15] + discovered S4
[S15] + discovered S14
[S15] + discovered S11
[S15] + discovered S7
[S15] + discovered S2
[S15] + discovered S9
[S14] + discovered S15
[S15] + discovered S8
[S15] + discovered S13
[S14] + discovered S16
[S15] + discovered S5
[S15] + discovered S10
[S15] + discovered S6
[S15] + discovered S3
[S14] + discovered S17
[S16] + discovered S14
[S16] + discovered S10
[S16] + discovered S6
[S16] + discovered S2
[S16] + discovered S7
[S16] + discovered S5
[S16] + discovered S15
[S16] + discovered S8
[S16] + discovered S11
[S16] + discovered S4
[S16] + discovered S9
[S16] + discovered S13
[S16] + discovered S3
[S15] + discovered S17
[S15] + discovered S16
[S17] + discovered S14
[S17] + discovered S9
[S17] + discovered S5
[S17] + discovered S8
[S17] + discovered S4
[S17] + discovered S16
[S17] + discovered S7
[S17] + discovered S3
[S17] + discovered S13
[S17] + discovered S2
[S17] + discovered S11
[S17] + discovered S6
[S17] + discovered S10
[S17] + discovered S15
[S16] + discovered S17
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:61802
[S5] ⇄ pheromone p=1.000 → S13@127.0.0.1:61813
[S11] ⇄ pheromone p=1.000 → S5@127.0.0.1:61805
[S9] ⇄ pheromone p=1.000 → S2@127.0.0.1:61802
[S2] ⇄ pheromone p=1.000 → S9@127.0.0.1:61810
[S10] ⇄ pheromone p=1.000 → S4@127.0.0.1:61804
[S6] ⇄ pheromone p=1.000 → S5@127.0.0.1:61805
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:61815
[S7] ⇄ pheromone p=1.000 → S8@127.0.0.1:61809
[S15] ⇄ pheromone p=1.000 → S9@127.0.0.1:61810
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:61812
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:61808
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:61808
[S3] ⇄ pheromone p=1.000 → S13@127.0.0.1:61813
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:61813
[S2] START round=1 head_norm_before_train=1.158977 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6291370670851648, 'loss_val': 1.313236505844575, 'psi': 0.33672110686720597}-{'f1_val': 0.16699242609333007, 'auprc': 0.6282632735183148, 'loss_val': 1.342412108881337, 'psi': 0.35150076506332395}
[S3] START round=1 head_norm_before_train=1.159589 (no previous merge yet)
[S3] round=1 local utility u=0.307884 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7783857832106987, 'loss_val': 1.3236553770525106, 'psi': 0.3952583526527438}-{'f1_val': 0.13984006561410703, 'auprc': 0.5815395731284206, 'loss_val': 1.3488852910126523, 'psi': 0.3165198686198325}
[S4] START round=1 head_norm_before_train=1.122772 (no previous merge yet)
[S4] round=1 local utility u=0.152089 metrics={'f1_val': 0.10637591321673677, 'auprc': 0.7808217578577974, 'loss_val': 1.3406022427378577, 'psi': 0.37615425107316103}-{'f1_val': 0.10637591321673677, 'auprc': 0.6902815700960508, 'loss_val': 1.3731606464979143, 'psi': 0.33993817596846243}
[S5] START round=1 head_norm_before_train=1.161030 (no previous merge yet)
[S5] round=1 local utility u=0.206995 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7408343532569965, 'loss_val': 1.3149765471733286, 'psi': 0.38169088415994146}-{'f1_val': 0.14226190476190476, 'auprc': 0.6141508676931825, 'loss_val': 1.3489159389600225, 'psi': 0.3310174899344159}
[S6] START round=1 head_norm_before_train=1.159149 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8639408655367036, 'loss_val': 1.320216343647236, 'psi': 0.4304321154454507}-{'f1_val': 0.14142628205128205, 'auprc': 0.9146159818752662, 'loss_val': 1.3475820875226274, 'psi': 0.4507021619808757}
[S7] START round=1 head_norm_before_train=1.188252 (no previous merge yet)
[S7] round=1 local utility u=0.040356 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7771697985804531, 'loss_val': 1.3031727242275293, 'psi': 0.39610201306963627}-{'f1_val': 0.14205682272909165, 'auprc': 0.7623482280424349, 'loss_val': 1.3394201400649166, 'psi': 0.39017338485442893}
[S8] START round=1 head_norm_before_train=1.111406 (no previous merge yet)
[S8] round=1 local utility u=0.244838 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7707501399524415, 'loss_val': 1.3127651482809337, 'psi': 0.3922736454167509}-{'f1_val': 0.13995598239295717, 'auprc': 0.6174306447041912, 'loss_val': 1.3424825557610043, 'psi': 0.3309458473174508}
[S9] START round=1 head_norm_before_train=1.150303 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9994569506629717, 'loss_val': 1.2980842939674824, 'psi': 0.4846215545491863}-{'f1_val': 0.3983343741813999, 'auprc': 0.9991873482561814, 'loss_val': 1.3448612664693316, 'psi': 0.6386755638113124}
[S10] START round=1 head_norm_before_train=1.201232 (no previous merge yet)
[S10] round=1 local utility u=0.009095 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6325013063006634, 'loss_val': 1.3144513016781225, 'psi': 0.3361735050452997}-{'f1_val': 0.13862163754172394, 'auprc': 0.6353357614584854, 'loss_val': 1.3411436855495562, 'psi': 0.3373072871084285}
[S11] START round=1 head_norm_before_train=1.164621 (no previous merge yet)
[S11] round=1 local utility u=0.443871 metrics={'f1_val': 0.10359570269677702, 'auprc': 0.6941155472807641, 'loss_val': 1.353507215497781, 'psi': 0.3398036405303718}-{'f1_val': 0.10359570269677702, 'auprc': 0.40872262936764037, 'loss_val': 1.3850698918408964, 'psi': 0.2256464733651224}
[S13] START round=1 head_norm_before_train=1.212455 (no previous merge yet)
[S13] round=1 local utility u=0.061947 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7197503485067569, 'loss_val': 1.2943834821138782, 'psi': 0.3721315969489346}-{'f1_val': 0.1403857625770531, 'auprc': 0.689114906820318, 'loss_val': 1.3263716651117097, 'psi': 0.35987742027435904}
[S14] START round=1 head_norm_before_train=1.160696 (no previous merge yet)
[S14] round=1 local utility u=0.536457 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6318074281876191, 'loss_val': 1.3504136001528535, 'psi': 0.3369376830046699}-{'f1_val': 0.14035785288270378, 'auprc': 0.28109599111407135, 'loss_val': 1.3711937467632147, 'psi': 0.1966531081752508}
[S15] START round=1 head_norm_before_train=1.135391 (no previous merge yet)
[S15] round=1 local utility u=0.010774 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.8095726600355716, 'loss_val': 1.3202360946327811, 'psi': 0.4076692548311637}-{'f1_val': 0.13973365136155833, 'auprc': 0.8109345327244424, 'loss_val': 1.345870617010473, 'psi': 0.408214003906712}
[S16] START round=1 head_norm_before_train=1.158514 (no previous merge yet)
[S16] round=1 local utility u=0.325560 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7430518827014921, 'loss_val': 1.3071318594815247, 'psi': 0.38160322320011875}-{'f1_val': 0.14063745019920318, 'auprc': 0.535389346063103, 'loss_val': 1.3352643916456188, 'psi': 0.2985382085447631}
[S17] START round=1 head_norm_before_train=1.192200 (no previous merge yet)
[S17] round=1 local utility u=1.000000 metrics={'f1_val': 0.3900135889206927, 'auprc': 0.6493953755056997, 'loss_val': 1.3549653672272546, 'psi': 0.49376630355469553}-{'f1_val': 0.09718183851487364, 'auprc': 0.39243276219249024, 'loss_val': 1.377789764322462, 'psi': 0.2152822079859203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S3] → sending delta(kind=head bytes=1788) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:61811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S15] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:61816
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:61811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S8] → sending delta(kind=head bytes=1788) to S6@127.0.0.1:61807
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S16] → sending delta(kind=head bytes=1785) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:61803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S5] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:61813
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1788 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1785 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1788 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1788 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1788 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1788) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.150604)
[S16] loaded HEAD from S15 (vec_in norm=1.150604)
[S16] cosine check vs S15: cos=0.0014
[S16] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1785) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.173040)
[S15] loaded HEAD from S16 (vec_in norm=1.173040)
[S15] cosine check vs S16: cos=0.0014
[S15] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1788) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.174868)
[S13] loaded HEAD from S5 (vec_in norm=1.174868)
[S13] cosine check vs S5: cos=0.0046
[S13] BUFFERED delta from S5 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1793) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.224108)
[S13] loaded HEAD from S10 (vec_in norm=1.224108)
[S13] cosine check vs S10: cos=-0.0309
[S13] DROPPED delta from S10 (cos=-0.0309 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.206928)
[S10] loaded HEAD from S7 (vec_in norm=1.206928)
[S10] cosine check vs S7: cos=0.0082
[S10] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1795) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.135016)
[S10] loaded HEAD from S4 (vec_in norm=1.135016)
[S10] cosine check vs S4: cos=-0.0423
[S10] DROPPED delta from S4 (cos=-0.0423 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1793) from S14
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.167250)
[S9] loaded HEAD from S14 (vec_in norm=1.167250)
[S9] cosine check vs S14: cos=0.0478
[S9] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1788) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.124778)
[S6] loaded HEAD from S8 (vec_in norm=1.124778)
[S6] cosine check vs S8: cos=0.0585
[S6] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1790) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.229662)
[S5] loaded HEAD from S13 (vec_in norm=1.229662)
[S5] cosine check vs S13: cos=0.0046
[S5] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1788) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.172264)
[S4] loaded HEAD from S3 (vec_in norm=1.172264)
[S4] cosine check vs S3: cos=0.1122
[S4] BUFFERED delta from S3 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1794) from S11
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.172833)
[S3] loaded HEAD from S11 (vec_in norm=1.172833)
[S3] cosine check vs S11: cos=-0.0485
[S3] DROPPED delta from S11 (cos=-0.0485 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S17] → sending delta(kind=head bytes=1787) to S10@127.0.0.1:61811
[S17] sending update (kind=head size=1787 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1787) from S17
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.200080)
[S10] loaded HEAD from S17 (vec_in norm=1.200080)
[S10] cosine check vs S17: cos=-0.0247
[S10] DROPPED delta from S17 (cos=-0.0247 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.171913
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.070253e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.846544 delta_norm=0.807025
[S9] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.173494
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.886313e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.836163 delta_norm=0.788631
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.174868
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.484027e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.852294 delta_norm=0.848403
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.150604
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.209782e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.822162 delta_norm=0.820978
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1064 head_norm=1.135016
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.687649e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1064 head_norm=0.860367 delta_norm=0.768765
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.224108
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.559947e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.863036 delta_norm=0.855995
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.1404 head_norm=1.229662
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.484027e-01
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.852294 delta_norm=0.848403
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.173040
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.209781e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.822162 delta_norm=0.820978
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.173635 (no previous merge yet)
[S2] round=2 local utility u=0.206556 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7560153630252733, 'loss_val': 1.2807591885434515, 'psi': 0.3874724252432494}-{'f1_val': 0.1417771333885667, 'auprc': 0.6291370670851648, 'loss_val': 1.313236505844575, 'psi': 0.33672110686720597}
[S3] START round=2 head_norm_before_train=1.172264 (no previous merge yet)
[S3] round=2 local utility u=0.039874 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7948136365118121, 'loss_val': 1.2931900531498586, 'psi': 0.4018294939731891}-{'f1_val': 0.13984006561410703, 'auprc': 0.7783857832106987, 'loss_val': 1.3236553770525106, 'psi': 0.3952583526527438}
[S4] START round=2 head_norm_before_train=0.860367 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.889556 metrics={'f1_val': 0.40017155194158827, 'auprc': 0.7791758928506555, 'loss_val': 1.319326957610606, 'psi': 0.5517732883052151}-{'f1_val': 0.10637591321673677, 'auprc': 0.7808217578577974, 'loss_val': 1.3406022427378577, 'psi': 0.37615425107316103}
[S5] START round=2 head_norm_before_train=0.852294 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7289034314129508, 'loss_val': 1.3084355227766225, 'psi': 0.3769185154223232}-{'f1_val': 0.14226190476190476, 'auprc': 0.7408343532569965, 'loss_val': 1.3149765471733286, 'psi': 0.38169088415994146}
[S6] START round=2 head_norm_before_train=0.836163 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.043876 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8936827748104191, 'loss_val': 1.3216902215249424, 'psi': 0.4423288791549369}-{'f1_val': 0.14142628205128205, 'auprc': 0.8639408655367036, 'loss_val': 1.320216343647236, 'psi': 0.4304321154454507}
[S7] START round=2 head_norm_before_train=1.206928 (no previous merge yet)
[S7] round=2 local utility u=0.016825 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7773918889529103, 'loss_val': 1.270189841648819, 'psi': 0.39619084921861913}-{'f1_val': 0.14205682272909165, 'auprc': 0.7771697985804531, 'loss_val': 1.3031727242275293, 'psi': 0.39610201306963627}
[S8] START round=2 head_norm_before_train=1.124778 (no previous merge yet)
[S8] round=2 local utility u=0.017087 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7707153612542342, 'loss_val': 1.2784866165345856, 'psi': 0.39225973393746805}-{'f1_val': 0.13995598239295717, 'auprc': 0.7707501399524415, 'loss_val': 1.3127651482809337, 'psi': 0.3922736454167509}
[S9] START round=2 head_norm_before_train=0.846544 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.003896 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9997339914020063, 'loss_val': 1.2911230523744277, 'psi': 0.48473237084480014}-{'f1_val': 0.141397957139996, 'auprc': 0.9994569506629717, 'loss_val': 1.2980842939674824, 'psi': 0.4846215545491863}
[S10] START round=2 head_norm_before_train=0.863036 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.001187 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6303170224097792, 'loss_val': 1.3055235155447125, 'psi': 0.335299791488946}-{'f1_val': 0.13862163754172394, 'auprc': 0.6325013063006634, 'loss_val': 1.3144513016781225, 'psi': 0.3361735050452997}
[S11] START round=2 head_norm_before_train=1.172833 (no previous merge yet)
[S11] round=2 local utility u=1.000000 metrics={'f1_val': 0.42255365455174765, 'auprc': 0.7893790211222508, 'loss_val': 1.31355085274648, 'psi': 0.5692838011799489}-{'f1_val': 0.10359570269677702, 'auprc': 0.6941155472807641, 'loss_val': 1.353507215497781, 'psi': 0.3398036405303718}
[S13] START round=2 head_norm_before_train=0.852294 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6622316034362578, 'loss_val': 1.2966089238740823, 'psi': 0.349124098920735}-{'f1_val': 0.1403857625770531, 'auprc': 0.7197503485067569, 'loss_val': 1.2943834821138782, 'psi': 0.3721315969489346}
[S14] START round=2 head_norm_before_train=1.167250 (no previous merge yet)
[S14] round=2 local utility u=0.150891 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7247088888939609, 'loss_val': 1.3273364439547959, 'psi': 0.37409826728720663}-{'f1_val': 0.14035785288270378, 'auprc': 0.6318074281876191, 'loss_val': 1.3504136001528535, 'psi': 0.3369376830046699}
[S15] START round=2 head_norm_before_train=0.822162 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.8008458814045945, 'loss_val': 1.3311772322778541, 'psi': 0.4041785433787728}-{'f1_val': 0.13973365136155833, 'auprc': 0.8095726600355716, 'loss_val': 1.3202360946327811, 'psi': 0.4076692548311637}
[S16] START round=2 head_norm_before_train=0.822162 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.383663 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9973483548103423, 'loss_val': 1.3026944596755692, 'psi': 0.48332181204365887}-{'f1_val': 0.14063745019920318, 'auprc': 0.7430518827014921, 'loss_val': 1.3071318594815247, 'psi': 0.38160322320011875}
[S17] START round=2 head_norm_before_train=1.200080 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.18792789127272927, 'auprc': 0.7244196568902406, 'loss_val': 1.3280820964196267, 'psi': 0.4025245975197338}-{'f1_val': 0.3900135889206927, 'auprc': 0.6493953755056997, 'loss_val': 1.3549653672272546, 'psi': 0.49376630355469553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:61811
[S11] not sending this round → trigger blocked (psi=0.569)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.396)
[S4] not sending this round → trigger blocked (psi=0.552)
[S8] not sending this round → trigger blocked (psi=0.392)
[S14] not sending this round → trigger blocked (psi=0.374)
[S3] not sending this round → trigger blocked (psi=0.402)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61809
[S16] not sending this round → trigger blocked (psi=0.483)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:61816
[S10] not sending this round → trigger blocked (psi=0.335)
[S9] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S9
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.870684)
[S8] loaded HEAD from S9 (vec_in norm=0.870684)
[S8] cosine check vs S9: cos=-0.0834
[S8] DROPPED delta from S9 (cos=-0.0834 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.197152)
[S16] loaded HEAD from S2 (vec_in norm=1.197152)
[S16] cosine check vs S2: cos=-0.0592
[S16] DROPPED delta from S2 (cos=-0.0592 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S6
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.854903)
[S10] loaded HEAD from S6 (vec_in norm=0.854903)
[S10] cosine check vs S6: cos=-0.0189
[S10] DROPPED delta from S6 (cos=-0.0189 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.197152 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.728513519435921, 'loss_val': 1.2375309777297008, 'psi': 0.37647168780750845}-{'f1_val': 0.1417771333885667, 'auprc': 0.7560153630252733, 'loss_val': 1.2807591885434515, 'psi': 0.3874724252432494}
[S3] START round=3 head_norm_before_train=1.194320 (no previous merge yet)
[S3] round=3 local utility u=0.025507 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7984014065065883, 'loss_val': 1.2529401114008398, 'psi': 0.4032646019710996}-{'f1_val': 0.13984006561410703, 'auprc': 0.7948136365118121, 'loss_val': 1.2931900531498586, 'psi': 0.4018294939731891}
[S4] START round=3 head_norm_before_train=0.882490 cos_to_last_merge=0.9967 (last merge round=1)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.34052353472849894, 'auprc': 0.7821813768520188, 'loss_val': 1.2776583738380598, 'psi': 0.5171866715779069}-{'f1_val': 0.40017155194158827, 'auprc': 0.7791758928506555, 'loss_val': 1.319326957610606, 'psi': 0.5517732883052151}
[S5] START round=3 head_norm_before_train=0.873809 cos_to_last_merge=0.9968 (last merge round=1)
[S5] round=3 local utility u=0.022191 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7291543185572227, 'loss_val': 1.264805214854993, 'psi': 0.37701887028003195}-{'f1_val': 0.14226190476190476, 'auprc': 0.7289034314129508, 'loss_val': 1.3084355227766225, 'psi': 0.3769185154223232}
[S6] START round=3 head_norm_before_train=0.854903 cos_to_last_merge=0.9967 (last merge round=1)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8661970721182617, 'loss_val': 1.2845406337650778, 'psi': 0.4313345980780739}-{'f1_val': 0.14142628205128205, 'auprc': 0.8936827748104191, 'loss_val': 1.3216902215249424, 'psi': 0.4423288791549369}
[S7] START round=3 head_norm_before_train=1.230298 (no previous merge yet)
[S7] round=3 local utility u=0.011939 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7774846570763797, 'loss_val': 1.2465901878930068, 'psi': 0.3962279564680069}-{'f1_val': 0.14205682272909165, 'auprc': 0.7773918889529103, 'loss_val': 1.270189841648819, 'psi': 0.39619084921861913}
[S8] START round=3 head_norm_before_train=1.147043 (no previous merge yet)
[S8] round=3 local utility u=0.021489 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7707910612842184, 'loss_val': 1.2357365487364556, 'psi': 0.39229001394946167}-{'f1_val': 0.13995598239295717, 'auprc': 0.7707153612542342, 'loss_val': 1.2784866165345856, 'psi': 0.39225973393746805}
[S9] START round=3 head_norm_before_train=0.870684 cos_to_last_merge=0.9968 (last merge round=1)
[S9] round=3 local utility u=0.010025 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9862342288052586, 'loss_val': 1.2305746245175224, 'psi': 0.47933246580610106}-{'f1_val': 0.141397957139996, 'auprc': 0.9997339914020063, 'loss_val': 1.2911230523744277, 'psi': 0.48473237084480014}
[S10] START round=3 head_norm_before_train=0.890712 cos_to_last_merge=0.9970 (last merge round=1)
[S10] round=3 local utility u=0.035112 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6430112524201088, 'loss_val': 1.2733822971017386, 'psi': 0.3403774834930779}-{'f1_val': 0.13862163754172394, 'auprc': 0.6303170224097792, 'loss_val': 1.3055235155447125, 'psi': 0.335299791488946}
[S11] START round=3 head_norm_before_train=1.191227 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7843256691582158, 'loss_val': 1.2585171938733724, 'psi': 0.39797847768715267}-{'f1_val': 0.42255365455174765, 'auprc': 0.7893790211222508, 'loss_val': 1.31355085274648, 'psi': 0.5692838011799489}
[S13] START round=3 head_norm_before_train=0.876616 cos_to_last_merge=0.9974 (last merge round=1)
[S13] round=3 local utility u=0.025354 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6664389204604743, 'loss_val': 1.2585225743387025, 'psi': 0.35080702573042155}-{'f1_val': 0.1403857625770531, 'auprc': 0.6622316034362578, 'loss_val': 1.2966089238740823, 'psi': 0.349124098920735}
[S14] START round=3 head_norm_before_train=1.180829 (no previous merge yet)
[S14] round=3 local utility u=0.025864 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7316525920806517, 'loss_val': 1.2964403096005426, 'psi': 0.37687574856188294}-{'f1_val': 0.14035785288270378, 'auprc': 0.7247088888939609, 'loss_val': 1.3273364439547959, 'psi': 0.37409826728720663}
[S15] START round=3 head_norm_before_train=0.838901 cos_to_last_merge=0.9966 (last merge round=1)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7870516810654061, 'loss_val': 1.3034337535249085, 'psi': 0.39866086324309746}-{'f1_val': 0.13973365136155833, 'auprc': 0.8008458814045945, 'loss_val': 1.3311772322778541, 'psi': 0.4041785433787728}
[S16] START round=3 head_norm_before_train=0.842923 cos_to_last_merge=0.9969 (last merge round=1)
[S16] round=3 local utility u=0.019264 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9963434064796614, 'loss_val': 1.2611507812508387, 'psi': 0.4829198327113865}-{'f1_val': 0.14063745019920318, 'auprc': 0.9973483548103423, 'loss_val': 1.3026944596755692, 'psi': 0.48332181204365887}
[S17] START round=3 head_norm_before_train=1.216408 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7505425545394304, 'loss_val': 1.2904211904300844, 'psi': 0.38478639980620283}-{'f1_val': 0.18792789127272927, 'auprc': 0.7244196568902406, 'loss_val': 1.3280820964196267, 'psi': 0.4025245975197338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:61813
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:61813
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61808
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.479)
[S16] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.202556)
[S7] loaded HEAD from S14 (vec_in norm=1.202556)
[S7] cosine check vs S14: cos=0.0756
[S7] BUFFERED delta from S14 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1791) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.905946)
[S13] loaded HEAD from S5 (vec_in norm=0.905946)
[S13] cosine check vs S5: cos=0.9823
[S13] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1803) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.247723)
[S8] loaded HEAD from S7 (vec_in norm=1.247723)
[S8] cosine check vs S7: cos=-0.0146
[S8] DROPPED delta from S7 (cos=-0.0146 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.903653)
[S7] loaded HEAD from S13 (vec_in norm=0.903653)
[S7] cosine check vs S13: cos=0.0483
[S7] BUFFERED delta from S13 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.175840)
[S15] loaded HEAD from S8 (vec_in norm=1.175840)
[S15] cosine check vs S8: cos=0.0354
[S15] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1796) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.223688)
[S13] loaded HEAD from S3 (vec_in norm=1.223688)
[S13] cosine check vs S3: cos=0.0644
[S13] BUFFERED delta from S3 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1796) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.917712)
[S4] loaded HEAD from S10 (vec_in norm=0.917712)
[S4] cosine check vs S10: cos=-0.0364
[S4] DROPPED delta from S10 (cos=-0.0364 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.874026)
[S2] loaded HEAD from S16 (vec_in norm=0.874026)
[S2] cosine check vs S16: cos=-0.0641
[S2] DROPPED delta from S16 (cos=-0.0641 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=1.247723
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.942171e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.752253 delta_norm=0.694217
[S7] aggregate: ACCEPT kept=['S14', 'S13'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.1404 head_norm=0.903653
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.713018e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.758663 delta_norm=0.371302
[S13] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=0.865581
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.176052e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.1397 head_norm=0.742265 delta_norm=0.717605
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.230532 (no previous merge yet)
[S2] round=4 local utility u=0.004515 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7131866946389337, 'loss_val': 1.1825214883881496, 'psi': 0.3703409578887135}-{'f1_val': 0.1417771333885667, 'auprc': 0.728513519435921, 'loss_val': 1.2375309777297008, 'psi': 0.37647168780750845}
[S3] START round=4 head_norm_before_train=1.223688 (no previous merge yet)
[S3] round=4 local utility u=0.022838 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.795847874826228, 'loss_val': 1.1996026518405698, 'psi': 0.4022431892989554}-{'f1_val': 0.13984006561410703, 'auprc': 0.7984014065065883, 'loss_val': 1.2529401114008398, 'psi': 0.4032646019710996}
[S4] START round=4 head_norm_before_train=0.914432 cos_to_last_merge=0.9883 (last merge round=1)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7840078856537118, 'loss_val': 1.2033166456327764, 'psi': 0.39773913159859525}-{'f1_val': 0.34052353472849894, 'auprc': 0.7821813768520188, 'loss_val': 1.2776583738380598, 'psi': 0.5171866715779069}
[S5] START round=4 head_norm_before_train=0.905946 cos_to_last_merge=0.9883 (last merge round=1)
[S5] round=4 local utility u=0.026487 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7305455561906085, 'loss_val': 1.2160049151112151, 'psi': 0.37757536533338626}-{'f1_val': 0.14226190476190476, 'auprc': 0.7291543185572227, 'loss_val': 1.264805214854993, 'psi': 0.37701887028003195}
[S6] START round=4 head_norm_before_train=0.884447 cos_to_last_merge=0.9876 (last merge round=1)
[S6] round=4 local utility u=0.013822 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8572910150479754, 'loss_val': 1.2301785633689695, 'psi': 0.4277721752499594}-{'f1_val': 0.14142628205128205, 'auprc': 0.8661970721182617, 'loss_val': 1.2845406337650778, 'psi': 0.4313345980780739}
[S7] START round=4 head_norm_before_train=0.752253 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775995003592128, 'loss_val': 1.2557328821519287, 'psi': 0.39627389378114014}-{'f1_val': 0.14205682272909165, 'auprc': 0.7774846570763797, 'loss_val': 1.2465901878930068, 'psi': 0.3962279564680069}
[S8] START round=4 head_norm_before_train=1.175840 (no previous merge yet)
[S8] round=4 local utility u=0.028261 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7710780394871771, 'loss_val': 1.180076414732999, 'psi': 0.3924048052306452}-{'f1_val': 0.13995598239295717, 'auprc': 0.7707910612842184, 'loss_val': 1.2357365487364556, 'psi': 0.39229001394946167}
[S9] START round=4 head_norm_before_train=0.904339 cos_to_last_merge=0.9879 (last merge round=1)
[S9] round=4 local utility u=0.003673 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9708678684950103, 'loss_val': 1.177128941807215, 'psi': 0.47318592168200174}-{'f1_val': 0.141397957139996, 'auprc': 0.9862342288052586, 'loss_val': 1.2305746245175224, 'psi': 0.47933246580610106}
[S10] START round=4 head_norm_before_train=0.917712 cos_to_last_merge=0.9910 (last merge round=1)
[S10] round=4 local utility u=0.045344 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6558241432937877, 'loss_val': 1.2211338234004225, 'psi': 0.3455026398425494}-{'f1_val': 0.13862163754172394, 'auprc': 0.6430112524201088, 'loss_val': 1.2733822971017386, 'psi': 0.3403774834930779}
[S11] START round=4 head_norm_before_train=1.216317 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7548668050869786, 'loss_val': 1.2042218512921445, 'psi': 0.3861949320586578}-{'f1_val': 0.14041368337311058, 'auprc': 0.7843256691582158, 'loss_val': 1.2585171938733724, 'psi': 0.39797847768715267}
[S13] START round=4 head_norm_before_train=0.758663 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5995600023770509, 'loss_val': 1.2300534817863704, 'psi': 0.3240554584970522}-{'f1_val': 0.1403857625770531, 'auprc': 0.6664389204604743, 'loss_val': 1.2585225743387025, 'psi': 0.35080702573042155}
[S14] START round=4 head_norm_before_train=1.202556 (no previous merge yet)
[S14] round=4 local utility u=0.009827 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7253711215475176, 'loss_val': 1.2579418907130568, 'psi': 0.3743631603486293}-{'f1_val': 0.14035785288270378, 'auprc': 0.7316525920806517, 'loss_val': 1.2964403096005426, 'psi': 0.37687574856188294}
[S15] START round=4 head_norm_before_train=0.742265 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.116268 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.8632420726790716, 'loss_val': 1.2994690411772924, 'psi': 0.4291370198885637}-{'f1_val': 0.13973365136155833, 'auprc': 0.7870516810654061, 'loss_val': 1.3034337535249085, 'psi': 0.39866086324309746}
[S16] START round=4 head_norm_before_train=0.874026 cos_to_last_merge=0.9879 (last merge round=1)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7217295582083084, 'loss_val': 1.2090124332927505, 'psi': 0.37307429340284526}-{'f1_val': 0.14063745019920318, 'auprc': 0.9963434064796614, 'loss_val': 1.2611507812508387, 'psi': 0.4829198327113865}
[S17] START round=4 head_norm_before_train=1.240609 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7167219610716444, 'loss_val': 1.2236863720595361, 'psi': 0.37125816241908843}-{'f1_val': 0.14094896331738438, 'auprc': 0.7505425545394304, 'loss_val': 1.2904211904300844, 'psi': 0.38478639980620283}
[S3] not sending this round → trigger blocked (psi=0.402)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:61810
[S5] not sending this round → trigger blocked (psi=0.378)
[S8] not sending this round → trigger blocked (psi=0.392)
[S14] not sending this round → trigger blocked (psi=0.374)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:61805
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.346)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61812
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:61804
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.941784)
[S11] loaded HEAD from S9 (vec_in norm=0.941784)
[S11] cosine check vs S9: cos=-0.0518
[S11] DROPPED delta from S9 (cos=-0.0518 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.768605)
[S9] loaded HEAD from S15 (vec_in norm=0.768605)
[S9] cosine check vs S15: cos=0.0039
[S9] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1793) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.921675)
[S5] loaded HEAD from S6 (vec_in norm=0.921675)
[S5] cosine check vs S6: cos=0.1573
[S5] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.267626)
[S4] loaded HEAD from S2 (vec_in norm=1.267626)
[S4] cosine check vs S2: cos=0.0106
[S4] BUFFERED delta from S2 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=0.945667
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.061222e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1423 head_norm=0.710282 delta_norm=0.606122
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.1402 head_norm=0.958129
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.904513e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.1402 head_norm=0.798518 delta_norm=0.790451
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.1414 head_norm=0.941784
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.066353e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.608974 delta_norm=0.606635
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.267626 (no previous merge yet)
[S2] round=5 local utility u=0.569902 metrics={'f1_val': 0.28607587416734226, 'auprc': 0.7776148006969941, 'loss_val': 1.101793705750452, 'psi': 0.482691444779203}-{'f1_val': 0.1417771333885667, 'auprc': 0.7131866946389337, 'loss_val': 1.1825214883881496, 'psi': 0.3703409578887135}
[S3] START round=5 head_norm_before_train=1.255503 (no previous merge yet)
[S3] round=5 local utility u=0.047857 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7957859684971695, 'loss_val': 1.1037027400666173, 'psi': 0.4022184267673321}-{'f1_val': 0.13984006561410703, 'auprc': 0.795847874826228, 'loss_val': 1.1996026518405698, 'psi': 0.4022431892989554}
[S4] START round=5 head_norm_before_train=0.798518 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.003994 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7852447117213327, 'loss_val': 1.199038482137733, 'psi': 0.3982338620256436}-{'f1_val': 0.14022662889518414, 'auprc': 0.7840078856537118, 'loss_val': 1.2033166456327764, 'psi': 0.39773913159859525}
[S5] START round=5 head_norm_before_train=0.710282 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5529879344088646, 'loss_val': 1.1984321562412965, 'psi': 0.3065523166206887}-{'f1_val': 0.14226190476190476, 'auprc': 0.7305455561906085, 'loss_val': 1.2160049151112151, 'psi': 0.37757536533338626}
[S6] START round=5 head_norm_before_train=0.921675 cos_to_last_merge=0.9754 (last merge round=1)
[S6] round=5 local utility u=0.056063 metrics={'f1_val': 0.14737792037230382, 'auprc': 0.8542295477585313, 'loss_val': 1.1445774500508465, 'psi': 0.4301185713267949}-{'f1_val': 0.14142628205128205, 'auprc': 0.8572910150479754, 'loss_val': 1.2301785633689695, 'psi': 0.4277721752499594}
[S7] START round=5 head_norm_before_train=0.771881 cos_to_last_merge=0.9983 (last merge round=3)
[S7] round=5 local utility u=0.018238 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777757606544434, 'loss_val': 1.2197864948944894, 'psi': 0.39634439789923237}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775995003592128, 'loss_val': 1.2557328821519287, 'psi': 0.39627389378114014}
[S8] START round=5 head_norm_before_train=1.204885 (no previous merge yet)
[S8] round=5 local utility u=1.000000 metrics={'f1_val': 0.6196558312016991, 'auprc': 0.7908629366755651, 'loss_val': 1.0806843941216913, 'psi': 0.6881386733912456}-{'f1_val': 0.13995598239295717, 'auprc': 0.7710780394871771, 'loss_val': 1.180076414732999, 'psi': 0.3924048052306452}
[S9] START round=5 head_norm_before_train=0.608974 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.049275 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9999276211654811, 'loss_val': 1.1657584387405118, 'psi': 0.4848098227501901}-{'f1_val': 0.141397957139996, 'auprc': 0.9708678684950103, 'loss_val': 1.177128941807215, 'psi': 0.47318592168200174}
[S10] START round=5 head_norm_before_train=0.953634 cos_to_last_merge=0.9820 (last merge round=1)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6217686166302798, 'loss_val': 1.139128607262158, 'psi': 0.33188042917714633}-{'f1_val': 0.13862163754172394, 'auprc': 0.6558241432937877, 'loss_val': 1.2211338234004225, 'psi': 0.3455026398425494}
[S11] START round=5 head_norm_before_train=1.247593 (no previous merge yet)
[S11] round=5 local utility u=0.028510 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7562281489409615, 'loss_val': 1.151285104969406, 'psi': 0.38673946960025096}-{'f1_val': 0.14041368337311058, 'auprc': 0.7548668050869786, 'loss_val': 1.2042218512921445, 'psi': 0.3861949320586578}
[S13] START round=5 head_norm_before_train=0.786048 cos_to_last_merge=0.9977 (last merge round=3)
[S13] round=5 local utility u=0.151724 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6811179523535108, 'loss_val': 1.17128027835426, 'psi': 0.3566786384876362}-{'f1_val': 0.1403857625770531, 'auprc': 0.5995600023770509, 'loss_val': 1.2300534817863704, 'psi': 0.3240554584970522}
[S14] START round=5 head_norm_before_train=1.228558 (no previous merge yet)
[S14] round=5 local utility u=0.038436 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7291793239295603, 'loss_val': 1.19249441370597, 'psi': 0.3758864413014464}-{'f1_val': 0.14035785288270378, 'auprc': 0.7253711215475176, 'loss_val': 1.2579418907130568, 'psi': 0.3743631603486293}
[S15] START round=5 head_norm_before_train=0.768605 cos_to_last_merge=0.9956 (last merge round=3)
[S15] round=5 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7759671962518092, 'loss_val': 1.2454289320563994, 'psi': 0.3942270693176587}-{'f1_val': 0.13973365136155833, 'auprc': 0.8632420726790716, 'loss_val': 1.2994690411772924, 'psi': 0.4291370198885637}
[S16] START round=5 head_norm_before_train=0.914463 cos_to_last_merge=0.9742 (last merge round=1)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5410120983769292, 'loss_val': 1.1455530700824108, 'psi': 0.30078730947029364}-{'f1_val': 0.14063745019920318, 'auprc': 0.7217295582083084, 'loss_val': 1.2090124332927505, 'psi': 0.37307429340284526}
[S17] START round=5 head_norm_before_train=1.273903 (no previous merge yet)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5658665042784987, 'loss_val': 1.1167937473541887, 'psi': 0.31091597970183016}-{'f1_val': 0.14094896331738438, 'auprc': 0.7167219610716444, 'loss_val': 1.2236863720595361, 'psi': 0.37125816241908843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61808
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61808
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:61805
[S9] not sending this round → trigger blocked (psi=0.485)
[S6] not sending this round → trigger blocked (psi=0.430)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:61812
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.483)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61809
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:61813
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.237905)
[S15] loaded HEAD from S8 (vec_in norm=1.237905)
[S15] cosine check vs S8: cos=0.7430
[S15] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1794) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.292423)
[S13] loaded HEAD from S3 (vec_in norm=1.292423)
[S13] cosine check vs S3: cos=0.4213
[S13] BUFFERED delta from S3 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.798178)
[S8] loaded HEAD from S7 (vec_in norm=0.798178)
[S8] cosine check vs S7: cos=0.0147
[S8] BUFFERED delta from S7 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.826486)
[S11] loaded HEAD from S4 (vec_in norm=0.826486)
[S11] cosine check vs S4: cos=0.0288
[S11] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.814768)
[S7] loaded HEAD from S13 (vec_in norm=0.814768)
[S7] cosine check vs S13: cos=0.2744
[S7] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.261443)
[S7] loaded HEAD from S14 (vec_in norm=1.261443)
[S7] cosine check vs S14: cos=0.4405
[S7] BUFFERED delta from S14 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1798) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.276628)
[S5] loaded HEAD from S11 (vec_in norm=1.276628)
[S5] cosine check vs S11: cos=0.0753
[S5] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.346 → S5@127.0.0.1:61805
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.1397 head_norm=0.806959
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.180818e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.1397 head_norm=0.957603 delta_norm=0.418082
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.347 → S9@127.0.0.1:61810
[S2] ⇄ pheromone p=0.464 → S4@127.0.0.1:61804
[S10] ⇄ pheromone p=0.340 → S4@127.0.0.1:61804
[S9] ⇄ pheromone p=0.340 → S11@127.0.0.1:61812
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.738034
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.128570e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.760968 delta_norm=0.712857
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.352 → S13@127.0.0.1:61813
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.1404 head_norm=0.814768
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.014361e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.897428 delta_norm=0.601436
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.366 → S7@127.0.0.1:61808
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.6197 head_norm=1.237905
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.315285e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.3526 head_norm=0.741360 delta_norm=0.731528
[S8] aggregate: ROLLBACK (f1_val pre=0.620 post=0.353 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.557 → S15@127.0.0.1:61815
[S14] ⇄ pheromone p=0.400 → S7@127.0.0.1:61808
[S3] ⇄ pheromone p=0.373 → S13@127.0.0.1:61813
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=1.276628
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.503490e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.770329 delta_norm=0.750349
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.472 → S5@127.0.0.1:61805
[S4] ⇄ pheromone p=0.432 → S11@127.0.0.1:61812
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.798178
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.720681e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.670372 delta_norm=0.372068
[S7] aggregate: ACCEPT kept=['S13', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.338 → S8@127.0.0.1:61809
[S16] ⇄ pheromone p=0.396 → S2@127.0.0.1:61802
[S17] ⇄ pheromone p=0.410 → S13@127.0.0.1:61813
[S2] START round=6 head_norm_before_train=1.302750 (no previous merge yet)
[S2] round=6 local utility u=0.469621 metrics={'f1_val': 0.4169384018324798, 'auprc': 0.7803812342102701, 'loss_val': 0.9560270319530327, 'psi': 0.562315534783596}-{'f1_val': 0.28607587416734226, 'auprc': 0.7776148006969941, 'loss_val': 1.101793705750452, 'psi': 0.482691444779203}
[S3] START round=6 head_norm_before_train=1.292423 (no previous merge yet)
[S3] round=6 local utility u=0.829424 metrics={'f1_val': 0.3963275517403211, 'auprc': 0.7930745813468418, 'loss_val': 0.975645173623569, 'psi': 0.5550263635829293}-{'f1_val': 0.13984006561410703, 'auprc': 0.7957859684971695, 'loss_val': 1.1037027400666173, 'psi': 0.4022184267673321}
[S4] START round=6 head_norm_before_train=0.826486 cos_to_last_merge=0.9946 (last merge round=4)
[S4] round=6 local utility u=0.891705 metrics={'f1_val': 0.4143997657321641, 'auprc': 0.786735051007148, 'loss_val': 1.0651375552611229, 'psi': 0.5633338798421577}-{'f1_val': 0.14022662889518414, 'auprc': 0.7852447117213327, 'loss_val': 1.199038482137733, 'psi': 0.3982338620256436}
[S5] START round=6 head_norm_before_train=0.760968 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=1.000000 metrics={'f1_val': 0.40724833465534815, 'auprc': 0.7541737423124976, 'loss_val': 1.156138710396102, 'psi': 0.5460184977182079}-{'f1_val': 0.14226190476190476, 'auprc': 0.5529879344088646, 'loss_val': 1.1984321562412965, 'psi': 0.3065523166206887}
[S6] START round=6 head_norm_before_train=0.965700 cos_to_last_merge=0.9617 (last merge round=1)
[S6] round=6 local utility u=0.884133 metrics={'f1_val': 0.41605123052148413, 'auprc': 0.8614017270397606, 'loss_val': 1.0098677602936657, 'psi': 0.5941914291287946}-{'f1_val': 0.14737792037230382, 'auprc': 0.8542295477585313, 'loss_val': 1.1445774500508465, 'psi': 0.4301185713267949}
[S7] START round=6 head_norm_before_train=0.670372 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.002245 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7774285570507458, 'loss_val': 1.2142540058854565, 'psi': 0.3962055164577533}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777757606544434, 'loss_val': 1.2197864948944894, 'psi': 0.39634439789923237}
[S8] START round=6 head_norm_before_train=0.741360 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.4442951108218002, 'auprc': 0.7939569973909902, 'loss_val': 1.0582094143912506, 'psi': 0.5841598654494762}-{'f1_val': 0.6196558312016991, 'auprc': 0.7908629366755651, 'loss_val': 1.0806843941216913, 'psi': 0.6881386733912456}
[S9] START round=6 head_norm_before_train=0.646910 cos_to_last_merge=0.9952 (last merge round=4)
[S9] round=6 local utility u=0.799327 metrics={'f1_val': 0.3975890181247324, 'auprc': 0.9789790454131007, 'loss_val': 1.041404452068713, 'psi': 0.6301450290400797}-{'f1_val': 0.141397957139996, 'auprc': 0.9999276211654811, 'loss_val': 1.1657584387405118, 'psi': 0.4848098227501901}
[S10] START round=6 head_norm_before_train=0.992148 cos_to_last_merge=0.9718 (last merge round=1)
[S10] round=6 local utility u=0.961315 metrics={'f1_val': 0.4170518629654155, 'auprc': 0.6580393217360088, 'loss_val': 0.9958922926252232, 'psi': 0.5134468464736528}-{'f1_val': 0.13862163754172394, 'auprc': 0.6217686166302798, 'loss_val': 1.139128607262158, 'psi': 0.33188042917714633}
[S11] START round=6 head_norm_before_train=0.770329 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.640242 metrics={'f1_val': 0.30791688096462655, 'auprc': 0.8415106350980347, 'loss_val': 1.1316678752010285, 'psi': 0.5213543826179898}-{'f1_val': 0.14041368337311058, 'auprc': 0.7562281489409615, 'loss_val': 1.151285104969406, 'psi': 0.38673946960025096}
[S13] START round=6 head_norm_before_train=0.897428 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.643780 metrics={'f1_val': 0.4158809972763461, 'auprc': 0.5500645731206303, 'loss_val': 1.1435315822598335, 'psi': 0.46955442761405974}-{'f1_val': 0.1403857625770531, 'auprc': 0.6811179523535108, 'loss_val': 1.17128027835426, 'psi': 0.3566786384876362}
[S14] START round=6 head_norm_before_train=1.261443 (no previous merge yet)
[S14] round=6 local utility u=0.072721 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7421799916898298, 'loss_val': 1.0860541974879205, 'psi': 0.3810867084055542}-{'f1_val': 0.14035785288270378, 'auprc': 0.7291793239295603, 'loss_val': 1.19249441370597, 'psi': 0.3758864413014464}
[S15] START round=6 head_norm_before_train=0.957603 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.020604 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7765655797817921, 'loss_val': 1.2060163465423388, 'psi': 0.3944664227296519}-{'f1_val': 0.13973365136155833, 'auprc': 0.7759671962518092, 'loss_val': 1.2454289320563994, 'psi': 0.3942270693176587}
[S16] START round=6 head_norm_before_train=0.948087 cos_to_last_merge=0.9607 (last merge round=1)
[S16] round=6 local utility u=0.873173 metrics={'f1_val': 0.4173069283424069, 'auprc': 0.5438673657448433, 'loss_val': 1.0677901557447764, 'psi': 0.4679311033033815}-{'f1_val': 0.14063745019920318, 'auprc': 0.5410120983769292, 'loss_val': 1.1455530700824108, 'psi': 0.30078730947029364}
[S17] START round=6 head_norm_before_train=1.311527 (no previous merge yet)
[S17] round=6 local utility u=1.000000 metrics={'f1_val': 0.3918227013590554, 'auprc': 0.7806948839669394, 'loss_val': 0.9779512777770223, 'psi': 0.547371574402209}-{'f1_val': 0.14094896331738438, 'auprc': 0.5658665042784987, 'loss_val': 1.1167937473541887, 'psi': 0.31091597970183016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S10] → sending delta(kind=head bytes=1787) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:61805
[S11] not sending this round → trigger blocked (psi=0.521)
[S3] not sending this round → trigger blocked (psi=0.555)
[S13] not sending this round → trigger blocked (psi=0.470)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S15] → sending delta(kind=head bytes=1787) to S9@127.0.0.1:61810
[S7] not sending this round → trigger blocked (psi=0.396)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:61804
[S14] not sending this round → trigger blocked (psi=0.381)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.563)
[S15] sending update (kind=head size=1787 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1787 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.785668)
[S13] loaded HEAD from S5 (vec_in norm=0.785668)
[S13] cosine check vs S5: cos=0.2050
[S13] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.694956)
[S11] loaded HEAD from S9 (vec_in norm=0.694956)
[S11] cosine check vs S9: cos=-0.0167
[S11] DROPPED delta from S9 (cos=-0.0167 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1792) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.010237)
[S5] loaded HEAD from S6 (vec_in norm=1.010237)
[S5] cosine check vs S6: cos=0.3937
[S5] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.343864)
[S4] loaded HEAD from S2 (vec_in norm=1.343864)
[S4] cosine check vs S2: cos=0.7240
[S4] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1787) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.026895)
[S4] loaded HEAD from S10 (vec_in norm=1.026895)
[S4] cosine check vs S10: cos=-0.0578
[S4] DROPPED delta from S10 (cos=-0.0578 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.981143)
[S2] loaded HEAD from S16 (vec_in norm=0.981143)
[S2] cosine check vs S16: cos=-0.0835
[S2] DROPPED delta from S16 (cos=-0.0835 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1787) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.985940)
[S9] loaded HEAD from S15 (vec_in norm=0.985940)
[S9] cosine check vs S15: cos=0.4910
[S9] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.348374)
[S13] loaded HEAD from S17 (vec_in norm=1.348374)
[S13] cosine check vs S17: cos=0.0694
[S13] BUFFERED delta from S17 (total buffered=2)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.4144 head_norm=0.861474
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.668666e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.4157 head_norm=1.027662 delta_norm=0.466867
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.4159 head_norm=0.917631
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.582371e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.4153 head_norm=0.654586 delta_norm=0.558237
[S13] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.3976 head_norm=0.694956
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.422116e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.1481 head_norm=0.729362 delta_norm=0.442212
[S9] aggregate: ROLLBACK (f1_val pre=0.398 post=0.148 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.4072 head_norm=0.785668
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.032207e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.1810 head_norm=0.752127 delta_norm=0.503221
[S5] aggregate: ROLLBACK (f1_val pre=0.407 post=0.181 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=1.343864 (no previous merge yet)
[S2] round=7 local utility u=1.000000 metrics={'f1_val': 0.7135028680326914, 'auprc': 0.7971518106580777, 'loss_val': 0.7433874042995016, 'psi': 0.7469624450828458}-{'f1_val': 0.4169384018324798, 'auprc': 0.7803812342102701, 'loss_val': 0.9560270319530327, 'psi': 0.562315534783596}
[S3] START round=7 head_norm_before_train=1.325281 (no previous merge yet)
[S3] round=7 local utility u=0.071734 metrics={'f1_val': 0.39175772453064783, 'auprc': 0.7949804612335448, 'loss_val': 0.8104752132728872, 'psi': 0.5530468192118067}-{'f1_val': 0.3963275517403211, 'auprc': 0.7930745813468418, 'loss_val': 0.975645173623569, 'psi': 0.5550263635829293}
[S4] START round=7 head_norm_before_train=1.027662 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.079541 metrics={'f1_val': 0.42862312537825936, 'auprc': 0.7883755384105393, 'loss_val': 0.9963164407408295, 'psi': 0.5725240905911714}-{'f1_val': 0.4143997657321641, 'auprc': 0.786735051007148, 'loss_val': 1.0651375552611229, 'psi': 0.5633338798421577}
[S5] START round=7 head_norm_before_train=0.752127 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.091196 metrics={'f1_val': 0.41734838192522206, 'auprc': 0.7703131063368689, 'loss_val': 1.082764925292183, 'psi': 0.5585342716898809}-{'f1_val': 0.40724833465534815, 'auprc': 0.7541737423124976, 'loss_val': 1.156138710396102, 'psi': 0.5460184977182079}
[S6] START round=7 head_norm_before_train=1.010237 cos_to_last_merge=0.9490 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.949
[S6] round=7 local utility u=0.261169 metrics={'f1_val': 0.4173360362516195, 'auprc': 0.9686356153646745, 'loss_val': 0.8169393356486591, 'psi': 0.6378558678968416}-{'f1_val': 0.41605123052148413, 'auprc': 0.8614017270397606, 'loss_val': 1.0098677602936657, 'psi': 0.5941914291287946}
[S7] START round=7 head_norm_before_train=0.693940 cos_to_last_merge=0.9975 (last merge round=5)
[S7] round=7 local utility u=0.037145 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7773765203356701, 'loss_val': 1.13980814383966, 'psi': 0.39618470177172305}-{'f1_val': 0.14205682272909165, 'auprc': 0.7774285570507458, 'loss_val': 1.2142540058854565, 'psi': 0.3962055164577533}
[S8] START round=7 head_norm_before_train=0.785084 cos_to_last_merge=0.9961 (last merge round=5)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.79445816231034, 'loss_val': 0.8903563863367889, 'psi': 0.5415026852374419}-{'f1_val': 0.4442951108218002, 'auprc': 0.7939569973909902, 'loss_val': 1.0582094143912506, 'psi': 0.5841598654494762}
[S9] START round=7 head_norm_before_train=0.729362 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.117184 metrics={'f1_val': 0.41697558078303143, 'auprc': 0.9992376273778645, 'loss_val': 0.9841307326759943, 'psi': 0.6498803994209646}-{'f1_val': 0.3975890181247324, 'auprc': 0.9789790454131007, 'loss_val': 1.041404452068713, 'psi': 0.6301450290400797}
[S10] START round=7 head_norm_before_train=1.026895 cos_to_last_merge=0.9604 (last merge round=1)
[S10] round=7 local utility u=0.256745 metrics={'f1_val': 0.3861561803544076, 'auprc': 0.8248882580572956, 'loss_val': 0.7975759920248926, 'psi': 0.5616490114355628}-{'f1_val': 0.4170518629654155, 'auprc': 0.6580393217360088, 'loss_val': 0.9958922926252232, 'psi': 0.5134468464736528}
[S11] START round=7 head_norm_before_train=0.799568 cos_to_last_merge=0.9970 (last merge round=5)
[S11] round=7 local utility u=0.412265 metrics={'f1_val': 0.40921135774786266, 'auprc': 0.8680254137846859, 'loss_val': 0.9944500251138737, 'psi': 0.592736980162592}-{'f1_val': 0.30791688096462655, 'auprc': 0.8415106350980347, 'loss_val': 1.1316678752010285, 'psi': 0.5213543826179898}
[S13] START round=7 head_norm_before_train=0.654586 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.4163539771616168, 'auprc': 0.5243156512320348, 'loss_val': 1.1068983582252918, 'psi': 0.45953864678978407}-{'f1_val': 0.4158809972763461, 'auprc': 0.5500645731206303, 'loss_val': 1.1435315822598335, 'psi': 0.46955442761405974}
[S14] START round=7 head_norm_before_train=1.302118 (no previous merge yet)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.39649470961585787, 'auprc': 0.9427955319471433, 'loss_val': 0.9626455641899128, 'psi': 0.615015038548372}-{'f1_val': 0.14035785288270378, 'auprc': 0.7421799916898298, 'loss_val': 1.0860541974879205, 'psi': 0.3810867084055542}
[S15] START round=7 head_norm_before_train=0.985940 cos_to_last_merge=0.9961 (last merge round=5)
[S15] round=7 local utility u=0.918552 metrics={'f1_val': 0.41599167481162613, 'auprc': 0.7969812429987801, 'loss_val': 1.0877077928163843, 'psi': 0.5683875020864877}-{'f1_val': 0.13973365136155833, 'auprc': 0.7765655797817921, 'loss_val': 1.2060163465423388, 'psi': 0.3944664227296519}
[S16] START round=7 head_norm_before_train=0.981143 cos_to_last_merge=0.9450 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.945
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.41700358386742975, 'auprc': 0.5229945391961888, 'loss_val': 1.0137474753798499, 'psi': 0.45939996599893335}-{'f1_val': 0.4173069283424069, 'auprc': 0.5438673657448433, 'loss_val': 1.0677901557447764, 'psi': 0.4679311033033815}
[S17] START round=7 head_norm_before_train=1.348374 (no previous merge yet)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.3347124061186395, 'auprc': 0.8520736456373724, 'loss_val': 0.8880161565900733, 'psi': 0.5416569019261327}-{'f1_val': 0.3918227013590554, 'auprc': 0.7806948839669394, 'loss_val': 0.9779512777770223, 'psi': 0.547371574402209}
[S5] not sending this round → trigger blocked (psi=0.559)
[S15] not sending this round → trigger blocked (psi=0.568)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61813
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.562)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.747)
[S9] not sending this round → trigger blocked (psi=0.650)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:61805
[S6] not sending this round → trigger blocked (psi=0.638)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.364855)
[S13] loaded HEAD from S3 (vec_in norm=1.364855)
[S13] cosine check vs S3: cos=0.6372
[S13] BUFFERED delta from S3 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1792) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.048673)
[S11] loaded HEAD from S4 (vec_in norm=1.048673)
[S11] cosine check vs S4: cos=0.5000
[S11] BUFFERED delta from S4 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1796) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.718891)
[S8] loaded HEAD from S7 (vec_in norm=0.718891)
[S8] cosine check vs S7: cos=0.4599
[S8] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.343587)
[S7] loaded HEAD from S14 (vec_in norm=1.343587)
[S7] cosine check vs S14: cos=0.6853
[S7] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.846958)
[S5] loaded HEAD from S11 (vec_in norm=0.846958)
[S5] cosine check vs S11: cos=0.4124
[S5] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.3729 head_norm=0.842764
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.091980e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.3729 head_norm=0.667896 delta_norm=0.409198
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4173 head_norm=0.779487
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.416933e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.4173 head_norm=0.683649 delta_norm=0.441693
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4164 head_norm=0.684099
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.340637e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4164 head_norm=0.938183 delta_norm=0.534064
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.718891
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.995500e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=0.954706 delta_norm=0.499550
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.4092 head_norm=0.846958
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.819051e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.3967 head_norm=0.822371 delta_norm=0.481905
[S11] aggregate: ROLLBACK (f1_val pre=0.409 post=0.397 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=1.393202 (no previous merge yet)
[S2] round=8 local utility u=0.014566 metrics={'f1_val': 0.701470645897668, 'auprc': 0.7581687146686573, 'loss_val': 0.5251137717244961, 'psi': 0.7241498734060637}-{'f1_val': 0.7135028680326914, 'auprc': 0.7971518106580777, 'loss_val': 0.7433874042995016, 'psi': 0.7469624450828458}
[S3] START round=8 head_norm_before_train=1.364855 (no previous merge yet)
[S3] round=8 local utility u=0.187569 metrics={'f1_val': 0.43906488150230427, 'auprc': 0.8267681476971638, 'loss_val': 0.8145435685378494, 'psi': 0.5941461879802481}-{'f1_val': 0.39175772453064783, 'auprc': 0.7949804612335448, 'loss_val': 0.8104752132728872, 'psi': 0.5530468192118067}
[S4] START round=8 head_norm_before_train=1.048673 cos_to_last_merge=0.9960 (last merge round=6)
[S4] round=8 local utility u=0.767416 metrics={'f1_val': 0.6578811153913315, 'auprc': 0.7838009999274547, 'loss_val': 0.8233084157686252, 'psi': 0.7082490692057808}-{'f1_val': 0.42862312537825936, 'auprc': 0.7883755384105393, 'loss_val': 0.9963164407408295, 'psi': 0.5725240905911714}
[S5] START round=8 head_norm_before_train=0.683649 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.023934 metrics={'f1_val': 0.4175873768787894, 'auprc': 0.7774357659176316, 'loss_val': 1.057699751279526, 'psi': 0.5615267324943263}-{'f1_val': 0.41734838192522206, 'auprc': 0.7703131063368689, 'loss_val': 1.082764925292183, 'psi': 0.5585342716898809}
[S6] START round=8 head_norm_before_train=1.052158 cos_to_last_merge=0.9376 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.938
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.41673395620738773, 'auprc': 0.7892032366578703, 'loss_val': 0.7296188274412198, 'psi': 0.5657216683875808}-{'f1_val': 0.4173360362516195, 'auprc': 0.9686356153646745, 'loss_val': 0.8169393356486591, 'psi': 0.6378558678968416}
[S7] START round=8 head_norm_before_train=0.954706 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.302801 metrics={'f1_val': 0.23191535834960372, 'auprc': 0.7768330926559943, 'loss_val': 1.0717277692791694, 'psi': 0.44988245207216}-{'f1_val': 0.14205682272909165, 'auprc': 0.7773765203356701, 'loss_val': 1.13980814383966, 'psi': 0.39618470177172305}
[S8] START round=8 head_norm_before_train=0.667896 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.287764 metrics={'f1_val': 0.37306606018310795, 'auprc': 0.9930712418231602, 'loss_val': 0.9118702371107831, 'psi': 0.6210681328391289}-{'f1_val': 0.3728657005221765, 'auprc': 0.79445816231034, 'loss_val': 0.8903563863367889, 'psi': 0.5415026852374419}
[S9] START round=8 head_norm_before_train=0.760719 cos_to_last_merge=0.9946 (last merge round=6)
[S9] round=8 local utility u=0.961619 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.9986675791442564, 'loss_val': 0.7659642928578496, 'psi': 0.8203305118266755}-{'f1_val': 0.41697558078303143, 'auprc': 0.9992376273778645, 'loss_val': 0.9841307326759943, 'psi': 0.6498803994209646}
[S10] START round=8 head_norm_before_train=1.075838 cos_to_last_merge=0.9449 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.945
[S10] round=8 local utility u=0.642011 metrics={'f1_val': 0.539289200953389, 'auprc': 0.8986666493385721, 'loss_val': 0.6536874545415503, 'psi': 0.6830401803074622}-{'f1_val': 0.3861561803544076, 'auprc': 0.8248882580572956, 'loss_val': 0.7975759920248926, 'psi': 0.5616490114355628}
[S11] START round=8 head_norm_before_train=0.822371 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.087951 metrics={'f1_val': 0.3966199105536595, 'auprc': 0.9414500541639829, 'loss_val': 0.9632736063586055, 'psi': 0.6145519679977889}-{'f1_val': 0.40921135774786266, 'auprc': 0.8680254137846859, 'loss_val': 0.9944500251138737, 'psi': 0.592736980162592}
[S13] START round=8 head_norm_before_train=0.938183 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.031784 metrics={'f1_val': 0.41592377599636055, 'auprc': 0.5158021990982821, 'loss_val': 1.0152082996187808, 'psi': 0.45587514523712913}-{'f1_val': 0.4163539771616168, 'auprc': 0.5243156512320348, 'loss_val': 1.1068983582252918, 'psi': 0.45953864678978407}
[S14] START round=8 head_norm_before_train=1.343587 (no previous merge yet)
[S14] round=8 local utility u=1.000000 metrics={'f1_val': 0.7015782525941663, 'auprc': 0.9940831526425122, 'loss_val': 0.7903262136743608, 'psi': 0.8185802126135047}-{'f1_val': 0.39649470961585787, 'auprc': 0.9427955319471433, 'loss_val': 0.9626455641899128, 'psi': 0.615015038548372}
[S15] START round=8 head_norm_before_train=1.020361 cos_to_last_merge=0.9874 (last merge round=5)
[S15] round=8 local utility u=0.990647 metrics={'f1_val': 0.7157765500306936, 'auprc': 0.8001407790452741, 'loss_val': 0.9146015317978707, 'psi': 0.7495222416365258}-{'f1_val': 0.41599167481162613, 'auprc': 0.7969812429987801, 'loss_val': 1.0877077928163843, 'psi': 0.5683875020864877}
[S16] START round=8 head_norm_before_train=1.023723 cos_to_last_merge=0.9263 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.926
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.30600727759374646, 'auprc': 0.7422467624677468, 'loss_val': 1.047595471123848, 'psi': 0.4805030715433466}-{'f1_val': 0.41700358386742975, 'auprc': 0.5229945391961888, 'loss_val': 1.0137474753798499, 'psi': 0.45939996599893335}
[S17] START round=8 head_norm_before_train=1.395191 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.3557831922654673, 'auprc': 0.7776813164915883, 'loss_val': 0.8187312716957503, 'psi': 0.5245424419559157}-{'f1_val': 0.3347124061186395, 'auprc': 0.8520736456373724, 'loss_val': 0.8880161565900733, 'psi': 0.5416569019261327}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.594)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:61804
[S7] not sending this round → trigger blocked (psi=0.450)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:61804
[S11] not sending this round → trigger blocked (psi=0.615)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:61815
[S4] not sending this round → trigger blocked (psi=0.708)
[S14] not sending this round → trigger blocked (psi=0.819)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1791) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.964522)
[S7] loaded HEAD from S13 (vec_in norm=0.964522)
[S7] cosine check vs S13: cos=0.0505
[S7] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.717559)
[S15] loaded HEAD from S8 (vec_in norm=0.717559)
[S15] cosine check vs S8: cos=0.5563
[S15] BUFFERED delta from S8 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.448716)
[S4] loaded HEAD from S2 (vec_in norm=1.448716)
[S4] cosine check vs S2: cos=0.9048
[S4] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1792) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.126363)
[S4] loaded HEAD from S10 (vec_in norm=1.126363)
[S4] cosine check vs S10: cos=-0.0793
[S4] DROPPED delta from S10 (cos=-0.0793 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1792) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.709589)
[S13] loaded HEAD from S5 (vec_in norm=0.709589)
[S13] cosine check vs S5: cos=0.2902
[S13] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.804634)
[S11] loaded HEAD from S9 (vec_in norm=0.804634)
[S11] cosine check vs S9: cos=-0.0099
[S11] DROPPED delta from S9 (cos=-0.0099 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.059343)
[S9] loaded HEAD from S15 (vec_in norm=1.059343)
[S9] cosine check vs S15: cos=0.8411
[S9] BUFFERED delta from S15 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.2319 head_norm=0.973062
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.675302e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.3980 head_norm=0.702126 delta_norm=0.667530
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.6579 head_norm=1.081094
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.291593e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6704 head_norm=1.235081 delta_norm=0.329159
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.4159 head_norm=0.964522
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.090691e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.4159 head_norm=0.676578 delta_norm=0.509069
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7014 head_norm=0.804634
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.897548e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7014 head_norm=0.894910 delta_norm=0.289755
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.7158 head_norm=1.059343
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.447756e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.5637 head_norm=0.787860 delta_norm=0.444776
[S15] aggregate: ROLLBACK (f1_val pre=0.716 post=0.564 tol_abs=0.005 tol_rel=0.0)
[S2] START round=9 head_norm_before_train=1.448716 (no previous merge yet)
[S2] round=9 local utility u=0.133536 metrics={'f1_val': 0.7015730791798309, 'auprc': 0.7988667207271394, 'loss_val': 0.3807513149251793, 'psi': 0.7404905357987543}-{'f1_val': 0.701470645897668, 'auprc': 0.7581687146686573, 'loss_val': 0.5251137717244961, 'psi': 0.7241498734060637}
[S3] START round=9 head_norm_before_train=1.407331 (no previous merge yet)
[S3] round=9 local utility u=0.546029 metrics={'f1_val': 0.5481320926237119, 'auprc': 0.932119218240071, 'loss_val': 0.6929420454074143, 'psi': 0.7017269428702555}-{'f1_val': 0.43906488150230427, 'auprc': 0.8267681476971638, 'loss_val': 0.8145435685378494, 'psi': 0.5941461879802481}
[S4] START round=9 head_norm_before_train=1.235081 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6671790437433657, 'auprc': 0.664230963365671, 'loss_val': 0.7445840737870957, 'psi': 0.6659998115922878}-{'f1_val': 0.6578811153913315, 'auprc': 0.7838009999274547, 'loss_val': 0.8233084157686252, 'psi': 0.7082490692057808}
[S5] START round=9 head_norm_before_train=0.709589 cos_to_last_merge=0.9920 (last merge round=7)
[S5] round=9 local utility u=0.058517 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.7751498232525077, 'loss_val': 0.9342865795547964, 'psi': 0.5606602406808503}-{'f1_val': 0.4175873768787894, 'auprc': 0.7774357659176316, 'loss_val': 1.057699751279526, 'psi': 0.5615267324943263}
[S6] START round=9 head_norm_before_train=1.101387 cos_to_last_merge=0.9238 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.924
[S6] round=9 local utility u=0.858886 metrics={'f1_val': 0.6751754085672699, 'auprc': 0.8021905545650327, 'loss_val': 0.6014567262312726, 'psi': 0.725981466966375}-{'f1_val': 0.41673395620738773, 'auprc': 0.7892032366578703, 'loss_val': 0.7296188274412198, 'psi': 0.5657216683875808}
[S7] START round=9 head_norm_before_train=0.702126 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=1.000000 metrics={'f1_val': 0.6476429138251839, 'auprc': 0.7939266772206627, 'loss_val': 1.0288023407519342, 'psi': 0.7061564191833754}-{'f1_val': 0.23191535834960372, 'auprc': 0.7768330926559943, 'loss_val': 1.0717277692791694, 'psi': 0.44988245207216}
[S8] START round=9 head_norm_before_train=0.717559 cos_to_last_merge=0.9919 (last merge round=7)
[S8] round=9 local utility u=0.083833 metrics={'f1_val': 0.3726652774371328, 'auprc': 0.9983102151825778, 'loss_val': 0.7575172681159889, 'psi': 0.6229232525353108}-{'f1_val': 0.37306606018310795, 'auprc': 0.9930712418231602, 'loss_val': 0.9118702371107831, 'psi': 0.6210681328391289}
[S9] START round=9 head_norm_before_train=0.894910 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.034580 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9983224881213189, 'loss_val': 0.6968230693936186, 'psi': 0.8202979046794645}-{'f1_val': 0.7014391336149548, 'auprc': 0.9986675791442564, 'loss_val': 0.7659642928578496, 'psi': 0.8203305118266755}
[S10] START round=9 head_norm_before_train=1.126363 cos_to_last_merge=0.9260 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=9 local utility u=0.693654 metrics={'f1_val': 0.7001224412791066, 'auprc': 0.9936724959494588, 'loss_val': 0.516395676482897, 'psi': 0.8175424631472474}-{'f1_val': 0.539289200953389, 'auprc': 0.8986666493385721, 'loss_val': 0.6536874545415503, 'psi': 0.6830401803074622}
[S11] START round=9 head_norm_before_train=0.860709 cos_to_last_merge=0.9939 (last merge round=7)
[S11] round=9 local utility u=0.146560 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9954487744350184, 'loss_val': 0.8317433770571825, 'psi': 0.6361108513297311}-{'f1_val': 0.3966199105536595, 'auprc': 0.9414500541639829, 'loss_val': 0.9632736063586055, 'psi': 0.6145519679977889}
[S13] START round=9 head_norm_before_train=0.676578 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.045927 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.5395755516278972, 'loss_val': 0.9951558088423398, 'psi': 0.4654325404106359}-{'f1_val': 0.41592377599636055, 'auprc': 0.5158021990982821, 'loss_val': 1.0152082996187808, 'psi': 0.45587514523712913}
[S14] START round=9 head_norm_before_train=1.394073 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.39618669657492883, 'auprc': 0.9941907441382642, 'loss_val': 0.6774790669217613, 'psi': 0.635388315600263}-{'f1_val': 0.7015782525941663, 'auprc': 0.9940831526425122, 'loss_val': 0.7903262136743608, 'psi': 0.8185802126135047}
[S15] START round=9 head_norm_before_train=0.787860 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.41816268809449036, 'auprc': 0.7999517421735882, 'loss_val': 0.8745490675579757, 'psi': 0.5708783097261295}-{'f1_val': 0.7157765500306936, 'auprc': 0.8001407790452741, 'loss_val': 0.9146015317978707, 'psi': 0.7495222416365258}
[S16] START round=9 head_norm_before_train=1.063457 cos_to_last_merge=0.9071 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.907
[S16] round=9 local utility u=0.032976 metrics={'f1_val': 0.3278915105570253, 'auprc': 0.7080129906220205, 'loss_val': 1.0102479299453822, 'psi': 0.47994010258302333}-{'f1_val': 0.30600727759374646, 'auprc': 0.7422467624677468, 'loss_val': 1.047595471123848, 'psi': 0.4805030715433466}
[S17] START round=9 head_norm_before_train=1.436180 (no previous merge yet)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.35406388426773305, 'auprc': 0.7567761048231045, 'loss_val': 0.8492044954491476, 'psi': 0.5151487724898817}-{'f1_val': 0.3557831922654673, 'auprc': 0.7776813164915883, 'loss_val': 0.8187312716957503, 'psi': 0.5245424419559157}
[S5] not sending this round → trigger blocked (psi=0.561)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:61813
[S13] not sending this round → trigger blocked (psi=0.465)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:61809
[S8] not sending this round → trigger blocked (psi=0.623)
[S2] not sending this round → trigger blocked (psi=0.740)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S2@127.0.0.1:61802
[S10] not sending this round → trigger blocked (psi=0.818)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:61805
[S9] not sending this round → trigger blocked (psi=0.820)
[S6] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.726521)
[S8] loaded HEAD from S7 (vec_in norm=0.726521)
[S8] cosine check vs S7: cos=0.5357
[S8] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.149532)
[S5] loaded HEAD from S6 (vec_in norm=1.149532)
[S5] cosine check vs S6: cos=0.5077
[S5] BUFFERED delta from S6 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1794) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.454432)
[S13] loaded HEAD from S3 (vec_in norm=1.454432)
[S13] cosine check vs S3: cos=0.7296
[S13] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.913227)
[S5] loaded HEAD from S11 (vec_in norm=0.913227)
[S5] cosine check vs S11: cos=0.6231
[S5] BUFFERED delta from S11 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1788) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.110388)
[S2] loaded HEAD from S16 (vec_in norm=1.110388)
[S2] cosine check vs S16: cos=-0.0993
[S2] DROPPED delta from S16 (cos=-0.0993 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4177 head_norm=0.746581
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.559219e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4177 head_norm=0.704110 delta_norm=0.255922
[S5] aggregate: ACCEPT kept=['S6', 'S11'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.4160 head_norm=0.709611
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.274771e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.4160 head_norm=1.015494 delta_norm=0.527477
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3727 head_norm=0.782004
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.642119e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.3727 head_norm=0.661083 delta_norm=0.364212
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.506902 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.7043791600556158, 'loss_val': 0.323552974218451, 'psi': 0.7026942994453953}-{'f1_val': 0.7015730791798309, 'auprc': 0.7988667207271394, 'loss_val': 0.3807513149251793, 'psi': 0.7404905357987543}
[S3] START round=10 head_norm_before_train=1.454432 (no previous merge yet)
[S3] round=10 local utility u=0.302234 metrics={'f1_val': 0.5976308068603413, 'auprc': 0.993913842560192, 'loss_val': 0.5708495019552174, 'psi': 0.7561440211402817}-{'f1_val': 0.5481320926237119, 'auprc': 0.932119218240071, 'loss_val': 0.6929420454074143, 'psi': 0.7017269428702555}
[S4] START round=10 head_norm_before_train=1.262069 cos_to_last_merge=0.9966 (last merge round=8)
[S4] round=10 local utility u=0.322098 metrics={'f1_val': 0.6669496259936506, 'auprc': 0.8417811857059312, 'loss_val': 0.6316612682543867, 'psi': 0.7368822498785628}-{'f1_val': 0.6671790437433657, 'auprc': 0.664230963365671, 'loss_val': 0.7445840737870957, 'psi': 0.6659998115922878}
[S5] START round=10 head_norm_before_train=0.704110 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.538044 metrics={'f1_val': 0.5452316876583438, 'auprc': 0.8644584618591914, 'loss_val': 0.8915114715455396, 'psi': 0.6729223973386829}-{'f1_val': 0.4176671856330787, 'auprc': 0.7751498232525077, 'loss_val': 0.9342865795547964, 'psi': 0.5606602406808503}
[S6] START round=10 head_norm_before_train=1.149532 cos_to_last_merge=0.9105 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.910
[S6] round=10 local utility u=0.212767 metrics={'f1_val': 0.7110236829497456, 'auprc': 0.8336603055501888, 'loss_val': 0.4854208687708475, 'psi': 0.7600783319899229}-{'f1_val': 0.6751754085672699, 'auprc': 0.8021905545650327, 'loss_val': 0.6014567262312726, 'psi': 0.725981466966375}
[S7] START round=10 head_norm_before_train=0.726521 cos_to_last_merge=0.9958 (last merge round=8)
[S7] round=10 local utility u=0.188198 metrics={'f1_val': 0.6961930609054803, 'auprc': 0.7919399955600407, 'loss_val': 0.9377468579555028, 'psi': 0.7344918347673044}-{'f1_val': 0.6476429138251839, 'auprc': 0.7939266772206627, 'loss_val': 1.0288023407519342, 'psi': 0.7061564191833754}
[S8] START round=10 head_norm_before_train=0.661083 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.3727318090052443, 'auprc': 0.995929145145109, 'loss_val': 0.7789618592629557, 'psi': 0.6220107434611902}-{'f1_val': 0.3726652774371328, 'auprc': 0.9983102151825778, 'loss_val': 0.7575172681159889, 'psi': 0.6229232525353108}
[S9] START round=10 head_norm_before_train=0.931297 cos_to_last_merge=0.9949 (last merge round=8)
[S9] round=10 local utility u=0.087859 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9980380382509302, 'loss_val': 0.5183052947460153, 'psi': 0.8199895054249101}-{'f1_val': 0.7016148490515617, 'auprc': 0.9983224881213189, 'loss_val': 0.6968230693936186, 'psi': 0.8202979046794645}
[S10] START round=10 head_norm_before_train=1.179902 cos_to_last_merge=0.9065 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.907
[S10] round=10 local utility u=0.021170 metrics={'f1_val': 0.6893675901620292, 'auprc': 0.9935009453113508, 'loss_val': 0.4090127655128519, 'psi': 0.8110209322217579}-{'f1_val': 0.7001224412791066, 'auprc': 0.9936724959494588, 'loss_val': 0.516395676482897, 'psi': 0.8175424631472474}
[S11] START round=10 head_norm_before_train=0.913227 cos_to_last_merge=0.9768 (last merge round=7)
[S11] round=10 local utility u=0.287081 metrics={'f1_val': 0.4759264375009276, 'auprc': 0.9935068574186722, 'loss_val': 0.7280014136837545, 'psi': 0.6829586054680254}-{'f1_val': 0.39655223592620625, 'auprc': 0.9954487744350184, 'loss_val': 0.8317433770571825, 'psi': 0.6361108513297311}
[S13] START round=10 head_norm_before_train=1.015494 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.287636 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.6941195333883253, 'loss_val': 0.8823371390193482, 'psi': 0.5271321745467484}-{'f1_val': 0.4160038662657951, 'auprc': 0.5395755516278972, 'loss_val': 0.9951558088423398, 'psi': 0.4654325404106359}
[S14] START round=10 head_norm_before_train=1.446271 (no previous merge yet)
[S14] round=10 local utility u=0.982200 metrics={'f1_val': 0.7018171778232243, 'auprc': 0.9970875849337115, 'loss_val': 0.555552460692391, 'psi': 0.8199253406674192}-{'f1_val': 0.39618669657492883, 'auprc': 0.9941907441382642, 'loss_val': 0.6774790669217613, 'psi': 0.635388315600263}
[S15] START round=10 head_norm_before_train=0.831861 cos_to_last_merge=0.9946 (last merge round=8)
[S15] round=10 local utility u=0.816080 metrics={'f1_val': 0.6384690793341192, 'auprc': 0.8489843237070298, 'loss_val': 0.711325320778709, 'psi': 0.7226751770832835}-{'f1_val': 0.41816268809449036, 'auprc': 0.7999517421735882, 'loss_val': 0.8745490675579757, 'psi': 0.5708783097261295}
[S16] START round=10 head_norm_before_train=1.110388 cos_to_last_merge=0.8879 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.888
[S16] round=10 local utility u=0.290864 metrics={'f1_val': 0.39753143790719087, 'auprc': 0.719570310153296, 'loss_val': 0.881032090457045, 'psi': 0.526346986805633}-{'f1_val': 0.3278915105570253, 'auprc': 0.7080129906220205, 'loss_val': 1.0102479299453822, 'psi': 0.47994010258302333}
[S17] START round=10 head_norm_before_train=1.466360 (no previous merge yet)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.35288084821104426, 'auprc': 0.7639251825541009, 'loss_val': 0.8939902877868159, 'psi': 0.517298581948267}-{'f1_val': 0.35406388426773305, 'auprc': 0.7567761048231045, 'loss_val': 0.8492044954491476, 'psi': 0.5151487724898817}
[S16] not sending this round → trigger blocked (psi=0.526)
[S6] not sending this round → trigger blocked (psi=0.760)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61813
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.756)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61812
[S7] not sending this round → trigger blocked (psi=0.734)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:61804
[S11] not sending this round → trigger blocked (psi=0.683)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:61810
[S13] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.984092)
[S11] loaded HEAD from S9 (vec_in norm=0.984092)
[S11] cosine check vs S9: cos=-0.0285
[S11] DROPPED delta from S9 (cos=-0.0285 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.740061)
[S13] loaded HEAD from S5 (vec_in norm=0.740061)
[S13] cosine check vs S5: cos=0.3698
[S13] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.300849)
[S11] loaded HEAD from S4 (vec_in norm=1.300849)
[S11] cosine check vs S4: cos=0.7607
[S11] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1795) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.889931)
[S9] loaded HEAD from S15 (vec_in norm=0.889931)
[S9] cosine check vs S15: cos=0.8913
[S9] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1805) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.494240)
[S7] loaded HEAD from S14 (vec_in norm=1.494240)
[S7] cosine check vs S14: cos=0.6091
[S7] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1791) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.044231)
[S7] loaded HEAD from S13 (vec_in norm=1.044231)
[S7] cosine check vs S13: cos=0.6622
[S7] BUFFERED delta from S13 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1796) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.236268)
[S4] loaded HEAD from S10 (vec_in norm=1.236268)
[S4] cosine check vs S10: cos=-0.0853
[S4] DROPPED delta from S10 (cos=-0.0853 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.4759 head_norm=0.973296
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.222850e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.6364 head_norm=1.068378 delta_norm=0.422285
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.342 → S5@127.0.0.1:61805
[S3] ⇄ pheromone p=0.369 → S13@127.0.0.1:61813
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.6962 head_norm=0.760899
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.975271e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.6810 head_norm=0.805214 delta_norm=0.197527
[S7] aggregate: ROLLBACK (f1_val pre=0.696 post=0.681 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.351 → S8@127.0.0.1:61809
[S6] ⇄ pheromone p=0.392 → S5@127.0.0.1:61805
[S8] ⇄ pheromone p=0.233 → S15@127.0.0.1:61815
[S2] ⇄ pheromone p=0.316 → S4@127.0.0.1:61804
[S4] ⇄ pheromone p=0.385 → S11@127.0.0.1:61812
[S5] ⇄ pheromone p=0.327 → S13@127.0.0.1:61813
[S10] ⇄ pheromone p=0.414 → S4@127.0.0.1:61804
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.4158 head_norm=1.044231
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.163552e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.4158 head_norm=0.743257 delta_norm=0.516355
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.242 → S7@127.0.0.1:61808
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7013 head_norm=0.984092
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.231456e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7013 head_norm=0.911270 delta_norm=0.223146
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.335 → S11@127.0.0.1:61812
[S14] ⇄ pheromone p=0.564 → S7@127.0.0.1:61808
[S15] ⇄ pheromone p=0.500 → S9@127.0.0.1:61810
[S16] ⇄ pheromone p=0.265 → S2@127.0.0.1:61802
[S17] ⇄ pheromone p=0.216 → S13@127.0.0.1:61813
[S2] START round=11 head_norm_before_train=1.562597 (no previous merge yet)
[S2] round=11 local utility u=0.006314 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.7021631024115125, 'loss_val': 0.30380216394006193, 'psi': 0.7017603307029125}-{'f1_val': 0.7015710590385817, 'auprc': 0.7043791600556158, 'loss_val': 0.323552974218451, 'psi': 0.7026942994453953}
[S3] START round=11 head_norm_before_train=1.501626 (no previous merge yet)
[S3] round=11 local utility u=0.056191 metrics={'f1_val': 0.6054094242862555, 'auprc': 0.992356065734546, 'loss_val': 0.5004660167458251, 'psi': 0.7601880808655718}-{'f1_val': 0.5976308068603413, 'auprc': 0.993913842560192, 'loss_val': 0.5708495019552174, 'psi': 0.7561440211402817}
[S4] START round=11 head_norm_before_train=1.300849 cos_to_last_merge=0.9874 (last merge round=8)
[S4] round=11 local utility u=0.057095 metrics={'f1_val': 0.6658854803042938, 'auprc': 0.856638333589507, 'loss_val': 0.5556573521355568, 'psi': 0.7421866216183791}-{'f1_val': 0.6669496259936506, 'auprc': 0.8417811857059312, 'loss_val': 0.6316612682543867, 'psi': 0.7368822498785628}
[S5] START round=11 head_norm_before_train=0.740061 cos_to_last_merge=0.9925 (last merge round=9)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.41758505646266003, 'auprc': 0.6786197007739679, 'loss_val': 0.8176920500652642, 'psi': 0.5219989141871832}-{'f1_val': 0.5452316876583438, 'auprc': 0.8644584618591914, 'loss_val': 0.8915114715455396, 'psi': 0.6729223973386829}
[S6] START round=11 head_norm_before_train=1.199433 cos_to_last_merge=0.8974 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.897
[S6] round=11 local utility u=0.231863 metrics={'f1_val': 0.7114924432386895, 'auprc': 0.9651818855141887, 'loss_val': 0.41907264190819216, 'psi': 0.8129682201488893}-{'f1_val': 0.7110236829497456, 'auprc': 0.8336603055501888, 'loss_val': 0.4854208687708475, 'psi': 0.7600783319899229}
[S7] START round=11 head_norm_before_train=0.805214 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.057143 metrics={'f1_val': 0.6998647926633503, 'auprc': 0.7915218594188463, 'loss_val': 0.8442366695752181, 'psi': 0.7365276193655488}-{'f1_val': 0.6961930609054803, 'auprc': 0.7919399955600407, 'loss_val': 0.9377468579555028, 'psi': 0.7344918347673044}
[S8] START round=11 head_norm_before_train=0.716988 cos_to_last_merge=0.9883 (last merge round=9)
[S8] round=11 local utility u=0.061809 metrics={'f1_val': 0.3726652774371328, 'auprc': 0.994438806456559, 'loss_val': 0.6504727086350182, 'psi': 0.6213746890449032}-{'f1_val': 0.3727318090052443, 'auprc': 0.995929145145109, 'loss_val': 0.7789618592629557, 'psi': 0.6220107434611902}
[S9] START round=11 head_norm_before_train=0.911270 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.012243 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9979102350229314, 'loss_val': 0.49343547576770963, 'psi': 0.8199383841337107}-{'f1_val': 0.7012904835408967, 'auprc': 0.9980380382509302, 'loss_val': 0.5183052947460153, 'psi': 0.8199895054249101}
[S10] START round=11 head_norm_before_train=1.236268 cos_to_last_merge=0.8884 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.888
[S10] round=11 local utility u=0.003336 metrics={'f1_val': 0.7000537794092287, 'auprc': 0.9572462825576624, 'loss_val': 0.35769355258969, 'psi': 0.8029307806686022}-{'f1_val': 0.6893675901620292, 'auprc': 0.9935009453113508, 'loss_val': 0.4090127655128519, 'psi': 0.8110209322217579}
[S11] START round=11 head_norm_before_train=1.068378 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.313707 metrics={'f1_val': 0.5849876699239802, 'auprc': 0.9876008809707111, 'loss_val': 0.7372377197697372, 'psi': 0.7460329543426726}-{'f1_val': 0.4759264375009276, 'auprc': 0.9935068574186722, 'loss_val': 0.7280014136837545, 'psi': 0.6829586054680254}
[S13] START round=11 head_norm_before_train=0.743257 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.683751920940207, 'loss_val': 0.875336466258595, 'psi': 0.5229851295675011}-{'f1_val': 0.41580726865236384, 'auprc': 0.6941195333883253, 'loss_val': 0.8823371390193482, 'psi': 0.5271321745467484}
[S14] START round=11 head_norm_before_train=1.494240 (no previous merge yet)
[S14] round=11 local utility u=0.202235 metrics={'f1_val': 0.7457378022633468, 'auprc': 0.9957268170009391, 'loss_val': 0.41052364172417566, 'psi': 0.8457334081583838}-{'f1_val': 0.7018171778232243, 'auprc': 0.9970875849337115, 'loss_val': 0.555552460692391, 'psi': 0.8199253406674192}
[S15] START round=11 head_norm_before_train=0.889931 cos_to_last_merge=0.9797 (last merge round=8)
[S15] round=11 local utility u=0.174882 metrics={'f1_val': 0.7050202664573004, 'auprc': 0.8069510758400065, 'loss_val': 0.6347682670332748, 'psi': 0.7457925902103828}-{'f1_val': 0.6384690793341192, 'auprc': 0.8489843237070298, 'loss_val': 0.711325320778709, 'psi': 0.7226751770832835}
[S16] START round=11 head_norm_before_train=1.152336 cos_to_last_merge=0.8705 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.871
[S16] round=11 local utility u=0.048857 metrics={'f1_val': 0.413667303768522, 'auprc': 0.7123161586773818, 'loss_val': 0.8583713782209842, 'psi': 0.5331268457320659}-{'f1_val': 0.39753143790719087, 'auprc': 0.719570310153296, 'loss_val': 0.881032090457045, 'psi': 0.526346986805633}
[S17] START round=11 head_norm_before_train=1.487058 (no previous merge yet)
[S17] round=11 local utility u=0.012792 metrics={'f1_val': 0.347459623992838, 'auprc': 0.7992072723478312, 'loss_val': 0.9417257006008791, 'psi': 0.5281586833348353}-{'f1_val': 0.35288084821104426, 'auprc': 0.7639251825541009, 'loss_val': 0.8939902877868159, 'psi': 0.517298581948267}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61813
[S15] not sending this round → trigger blocked (psi=0.746)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:61804
[S14] not sending this round → trigger blocked (psi=0.846)
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:61805
[S10] not sending this round → trigger blocked (psi=0.803)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.742)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:61805
[S6] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.790810)
[S15] loaded HEAD from S8 (vec_in norm=0.790810)
[S15] cosine check vs S8: cos=0.6593
[S15] BUFFERED delta from S8 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1800) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.190887)
[S2] loaded HEAD from S16 (vec_in norm=1.190887)
[S2] cosine check vs S16: cos=-0.1058
[S2] DROPPED delta from S16 (cos=-0.1058 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.833516)
[S8] loaded HEAD from S7 (vec_in norm=0.833516)
[S8] cosine check vs S7: cos=0.7033
[S8] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.110877)
[S5] loaded HEAD from S11 (vec_in norm=1.110877)
[S5] cosine check vs S11: cos=0.5046
[S5] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.607107)
[S4] loaded HEAD from S2 (vec_in norm=1.607107)
[S4] cosine check vs S2: cos=0.9242
[S4] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.243983)
[S5] loaded HEAD from S6 (vec_in norm=1.243983)
[S5] cosine check vs S6: cos=0.6536
[S5] BUFFERED delta from S6 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1798) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.544369)
[S13] loaded HEAD from S3 (vec_in norm=1.544369)
[S13] cosine check vs S3: cos=0.7451
[S13] BUFFERED delta from S3 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.502837)
[S13] loaded HEAD from S17 (vec_in norm=1.502837)
[S13] cosine check vs S17: cos=0.1179
[S13] BUFFERED delta from S17 (total buffered=2)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.4176 head_norm=0.785253
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.509944e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.4174 head_norm=0.776086 delta_norm=0.250994
[S5] aggregate: ACCEPT kept=['S11', 'S6'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6659 head_norm=1.344878
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.148077e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6649 head_norm=1.447978 delta_norm=0.314808
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.4158 head_norm=0.780782
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.464461e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.4158 head_norm=0.847179 delta_norm=0.446446
[S13] aggregate: ACCEPT kept=['S3', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.3727 head_norm=0.790810
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.134445e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.3727 head_norm=0.749545 delta_norm=0.313445
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.7050 head_norm=0.948175
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.659494e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.7019 head_norm=0.792647 delta_norm=0.365949
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.607107 (no previous merge yet)
[S2] round=12 local utility u=0.052807 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.7407262298017022, 'loss_val': 0.313877379984545, 'psi': 0.7171855816589885}-{'f1_val': 0.7014918162305126, 'auprc': 0.7021631024115125, 'loss_val': 0.30380216394006193, 'psi': 0.7017603307029125}
[S3] START round=12 head_norm_before_train=1.544369 (no previous merge yet)
[S3] round=12 local utility u=0.340166 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9815362535205865, 'loss_val': 0.3572029073609814, 'psi': 0.8128130528201518}-{'f1_val': 0.6054094242862555, 'auprc': 0.992356065734546, 'loss_val': 0.5004660167458251, 'psi': 0.7601880808655718}
[S4] START round=12 head_norm_before_train=1.447978 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.6660580414358933, 'auprc': 0.6579118725871782, 'loss_val': 0.5401191940670543, 'psi': 0.6627995738964072}-{'f1_val': 0.6658854803042938, 'auprc': 0.856638333589507, 'loss_val': 0.5556573521355568, 'psi': 0.7421866216183791}
[S5] START round=12 head_norm_before_train=0.776086 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.620399 metrics={'f1_val': 0.5264485619831626, 'auprc': 0.8585345039077774, 'loss_val': 0.7698192889301946, 'psi': 0.6592829387530086}-{'f1_val': 0.41758505646266003, 'auprc': 0.6786197007739679, 'loss_val': 0.8176920500652642, 'psi': 0.5219989141871832}
[S6] START round=12 head_norm_before_train=1.243983 cos_to_last_merge=0.8865 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.887
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.7073521613480201, 'auprc': 0.801347586819658, 'loss_val': 0.4338342786817015, 'psi': 0.7449503315366752}-{'f1_val': 0.7114924432386895, 'auprc': 0.9651818855141887, 'loss_val': 0.41907264190819216, 'psi': 0.8129682201488893}
[S7] START round=12 head_norm_before_train=0.833516 cos_to_last_merge=0.9972 (last merge round=10)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.38192503381623044, 'auprc': 0.6696574156556078, 'loss_val': 0.957675404342129, 'psi': 0.49701798655198137}-{'f1_val': 0.6998647926633503, 'auprc': 0.7915218594188463, 'loss_val': 0.8442366695752181, 'psi': 0.7365276193655488}
[S8] START round=12 head_norm_before_train=0.749545 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=1.000000 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9939021423601306, 'loss_val': 0.6405344099893993, 'psi': 0.8259321575844397}-{'f1_val': 0.3726652774371328, 'auprc': 0.994438806456559, 'loss_val': 0.6504727086350182, 'psi': 0.6213746890449032}
[S9] START round=12 head_norm_before_train=0.962580 cos_to_last_merge=0.9958 (last merge round=10)
[S9] round=12 local utility u=0.045740 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9979127757994464, 'loss_val': 0.40196225177307593, 'psi': 0.8199394004443166}-{'f1_val': 0.7012904835408967, 'auprc': 0.9979102350229314, 'loss_val': 0.49343547576770963, 'psi': 0.8199383841337107}
[S10] START round=12 head_norm_before_train=1.287954 cos_to_last_merge=0.8728 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.873
[S10] round=12 local utility u=0.094286 metrics={'f1_val': 0.6976888330113893, 'auprc': 0.9979141726532115, 'loss_val': 0.2769364459400693, 'psi': 0.8177789688681181}-{'f1_val': 0.7000537794092287, 'auprc': 0.9572462825576624, 'loss_val': 0.35769355258969, 'psi': 0.8029307806686022}
[S11] START round=12 head_norm_before_train=1.110877 cos_to_last_merge=0.9961 (last merge round=10)
[S11] round=12 local utility u=0.387685 metrics={'f1_val': 0.6846575589938961, 'auprc': 0.9959128631560213, 'loss_val': 0.5848239086012056, 'psi': 0.8091596806587462}-{'f1_val': 0.5849876699239802, 'auprc': 0.9876008809707111, 'loss_val': 0.7372377197697372, 'psi': 0.7460329543426726}
[S13] START round=12 head_norm_before_train=0.847179 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.6112073558129435, 'loss_val': 0.864128682671074, 'psi': 0.4939673035165957}-{'f1_val': 0.41580726865236384, 'auprc': 0.683751920940207, 'loss_val': 0.875336466258595, 'psi': 0.5229851295675011}
[S14] START round=12 head_norm_before_train=1.537187 (no previous merge yet)
[S14] round=12 local utility u=0.095343 metrics={'f1_val': 0.7596177354349513, 'auprc': 0.9970677108759489, 'loss_val': 0.307140310679104, 'psi': 0.8545977256113504}-{'f1_val': 0.7457378022633468, 'auprc': 0.9957268170009391, 'loss_val': 0.41052364172417566, 'psi': 0.8457334081583838}
[S15] START round=12 head_norm_before_train=0.792647 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.332143 metrics={'f1_val': 0.7786855020468466, 'auprc': 0.8707359326553207, 'loss_val': 0.6038289993171311, 'psi': 0.8155056742902362}-{'f1_val': 0.7050202664573004, 'auprc': 0.8069510758400065, 'loss_val': 0.6347682670332748, 'psi': 0.7457925902103828}
[S16] START round=12 head_norm_before_train=1.190887 cos_to_last_merge=0.8561 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.856
[S16] round=12 local utility u=0.479808 metrics={'f1_val': 0.5218007688464541, 'auprc': 0.7850889409008323, 'loss_val': 0.765874451631867, 'psi': 0.6271160376682053}-{'f1_val': 0.413667303768522, 'auprc': 0.7123161586773818, 'loss_val': 0.8583713782209842, 'psi': 0.5331268457320659}
[S17] START round=12 head_norm_before_train=1.502837 (no previous merge yet)
[S17] round=12 local utility u=0.019946 metrics={'f1_val': 0.3518813290806153, 'auprc': 0.7892761750052975, 'loss_val': 0.8985703479286135, 'psi': 0.5268392674504881}-{'f1_val': 0.347459623992838, 'auprc': 0.7992072723478312, 'loss_val': 0.9417257006008791, 'psi': 0.5281586833348353}
[S16] not sending this round → trigger blocked (psi=0.627)
[S8] not sending this round → trigger blocked (psi=0.826)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:61804
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:61808
[S3] not sending this round → trigger blocked (psi=0.813)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:61810
[S2] not sending this round → trigger blocked (psi=0.717)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.809)
[S15] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.814732)
[S13] loaded HEAD from S5 (vec_in norm=0.814732)
[S13] cosine check vs S5: cos=0.4340
[S13] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.019202)
[S11] loaded HEAD from S9 (vec_in norm=1.019202)
[S11] cosine check vs S9: cos=-0.0693
[S11] DROPPED delta from S9 (cos=-0.0693 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1805) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.580002)
[S7] loaded HEAD from S14 (vec_in norm=1.580002)
[S7] cosine check vs S14: cos=0.7186
[S7] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.332179)
[S4] loaded HEAD from S10 (vec_in norm=1.332179)
[S4] cosine check vs S10: cos=-0.0805
[S4] DROPPED delta from S10 (cos=-0.0805 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.845330)
[S9] loaded HEAD from S15 (vec_in norm=0.845330)
[S9] cosine check vs S15: cos=0.8642
[S9] BUFFERED delta from S15 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.527)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.4158 head_norm=0.884445
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.529111e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.4158 head_norm=0.719644 delta_norm=0.452911
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.3819 head_norm=0.863728
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.659381e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.3819 head_norm=1.140583 delta_norm=0.565938
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7013 head_norm=1.019202
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.570199e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7013 head_norm=0.900344 delta_norm=0.257020
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.644897 (no previous merge yet)
[S2] round=13 local utility u=0.020353 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.7528832422366925, 'loss_val': 0.3096426374647154, 'psi': 0.7220483866329845}-{'f1_val': 0.7014918162305126, 'auprc': 0.7407262298017022, 'loss_val': 0.313877379984545, 'psi': 0.7171855816589885}
[S3] START round=13 head_norm_before_train=1.581350 (no previous merge yet)
[S3] round=13 local utility u=0.019371 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9912444697800253, 'loss_val': 0.34608201934387467, 'psi': 0.8165459700681611}-{'f1_val': 0.700330919019862, 'auprc': 0.9815362535205865, 'loss_val': 0.3572029073609814, 'psi': 0.8128130528201518}
[S4] START round=13 head_norm_before_train=1.483523 cos_to_last_merge=0.9984 (last merge round=11)
[S4] round=13 local utility u=0.303822 metrics={'f1_val': 0.6658646024989345, 'auprc': 0.8451028694182763, 'loss_val': 0.49288668059819524, 'psi': 0.7375599092666713}-{'f1_val': 0.6660580414358933, 'auprc': 0.6579118725871782, 'loss_val': 0.5401191940670543, 'psi': 0.6627995738964072}
[S5] START round=13 head_norm_before_train=0.814732 cos_to_last_merge=0.9950 (last merge round=11)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.4267299163209944, 'auprc': 0.8165403751917594, 'loss_val': 0.7378799411609719, 'psi': 0.5826540998693004}-{'f1_val': 0.5264485619831626, 'auprc': 0.8585345039077774, 'loss_val': 0.7698192889301946, 'psi': 0.6592829387530086}
[S6] START round=13 head_norm_before_train=1.280577 cos_to_last_merge=0.8782 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.878
[S6] round=13 local utility u=0.287068 metrics={'f1_val': 0.7049708145700102, 'auprc': 0.9649674500267439, 'loss_val': 0.33626965213818477, 'psi': 0.8089694687527037}-{'f1_val': 0.7073521613480201, 'auprc': 0.801347586819658, 'loss_val': 0.4338342786817015, 'psi': 0.7449503315366752}
[S7] START round=13 head_norm_before_train=1.140583 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.096337 metrics={'f1_val': 0.39787065052289944, 'auprc': 0.6972431115349369, 'loss_val': 0.9434329546087107, 'psi': 0.5176196349277145}-{'f1_val': 0.38192503381623044, 'auprc': 0.6696574156556078, 'loss_val': 0.957675404342129, 'psi': 0.49701798655198137}
[S8] START round=13 head_norm_before_train=0.802990 cos_to_last_merge=0.9910 (last merge round=11)
[S8] round=13 local utility u=0.093226 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.9975734042967669, 'loss_val': 0.46470839674391845, 'psi': 0.8273618417971758}-{'f1_val': 0.7139521677339791, 'auprc': 0.9939021423601306, 'loss_val': 0.6405344099893993, 'psi': 0.8259321575844397}
[S9] START round=13 head_norm_before_train=0.900344 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.997824760509016, 'loss_val': 0.415571971419784, 'psi': 0.8199041943281444}-{'f1_val': 0.7012904835408967, 'auprc': 0.9979127757994464, 'loss_val': 0.40196225177307593, 'psi': 0.8199394004443166}
[S10] START round=13 head_norm_before_train=1.332179 cos_to_last_merge=0.8594 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.859
[S10] round=13 local utility u=0.024092 metrics={'f1_val': 0.7001333186946267, 'auprc': 0.9977557200428677, 'loss_val': 0.24294400374569408, 'psi': 0.8191822792339232}-{'f1_val': 0.6976888330113893, 'auprc': 0.9979141726532115, 'loss_val': 0.2769364459400693, 'psi': 0.8177789688681181}
[S11] START round=13 head_norm_before_train=1.160033 cos_to_last_merge=0.9860 (last merge round=10)
[S11] round=13 local utility u=0.090893 metrics={'f1_val': 0.6919126525625554, 'auprc': 0.995421122434756, 'loss_val': 0.4450932986700901, 'psi': 0.8133160405114357}-{'f1_val': 0.6846575589938961, 'auprc': 0.9959128631560213, 'loss_val': 0.5848239086012056, 'psi': 0.8091596806587462}
[S13] START round=13 head_norm_before_train=0.719644 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.985265 metrics={'f1_val': 0.7019784865494677, 'auprc': 0.6831750505946222, 'loss_val': 0.8265296278631934, 'psi': 0.6944571121675296}-{'f1_val': 0.41580726865236384, 'auprc': 0.6112073558129435, 'loss_val': 0.864128682671074, 'psi': 0.4939673035165957}
[S14] START round=13 head_norm_before_train=1.580002 (no previous merge yet)
[S14] round=13 local utility u=0.769403 metrics={'f1_val': 0.997841853906109, 'auprc': 0.9957233041961915, 'loss_val': 0.1936454021590193, 'psi': 0.996994434022142}-{'f1_val': 0.7596177354349513, 'auprc': 0.9970677108759489, 'loss_val': 0.307140310679104, 'psi': 0.8545977256113504}
[S15] START round=13 head_norm_before_train=0.845330 cos_to_last_merge=0.9947 (last merge round=11)
[S15] round=13 local utility u=0.612462 metrics={'f1_val': 0.8973744976572494, 'auprc': 0.9915786541496235, 'loss_val': 0.45356653392423524, 'psi': 0.935056160254199}-{'f1_val': 0.7786855020468466, 'auprc': 0.8707359326553207, 'loss_val': 0.6038289993171311, 'psi': 0.8155056742902362}
[S16] START round=13 head_norm_before_train=1.223154 cos_to_last_merge=0.8429 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.843
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.4462690707935759, 'auprc': 0.8058434153037661, 'loss_val': 0.6999785425804165, 'psi': 0.590098808597652}-{'f1_val': 0.5218007688464541, 'auprc': 0.7850889409008323, 'loss_val': 0.765874451631867, 'psi': 0.6271160376682053}
[S17] START round=13 head_norm_before_train=1.518405 (no previous merge yet)
[S17] round=13 local utility u=0.008289 metrics={'f1_val': 0.3533640907749881, 'auprc': 0.774295151671335, 'loss_val': 0.8459463356960539, 'psi': 0.5217365151335269}-{'f1_val': 0.3518813290806153, 'auprc': 0.7892761750052975, 'loss_val': 0.8985703479286135, 'psi': 0.5268392674504881}
[S14] not sending this round → trigger blocked (psi=0.997)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:61805
[S10] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:61804
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.935)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:61812
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61809
[S4] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.309497)
[S5] loaded HEAD from S6 (vec_in norm=1.309497)
[S5] cosine check vs S6: cos=0.7059
[S5] BUFFERED delta from S6 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.210254)
[S5] loaded HEAD from S11 (vec_in norm=1.210254)
[S5] cosine check vs S11: cos=0.5870
[S5] BUFFERED delta from S11 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.867257)
[S15] loaded HEAD from S8 (vec_in norm=0.867257)
[S15] cosine check vs S8: cos=0.7570
[S15] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.610283)
[S13] loaded HEAD from S3 (vec_in norm=1.610283)
[S13] cosine check vs S3: cos=0.5906
[S13] BUFFERED delta from S3 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1794) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.518595)
[S11] loaded HEAD from S4 (vec_in norm=1.518595)
[S11] cosine check vs S4: cos=0.8596
[S11] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1796) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.676976)
[S4] loaded HEAD from S2 (vec_in norm=1.676976)
[S4] cosine check vs S2: cos=0.9640
[S4] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.161605)
[S8] loaded HEAD from S7 (vec_in norm=1.161605)
[S8] cosine check vs S7: cos=0.6938
[S8] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.762074)
[S7] loaded HEAD from S13 (vec_in norm=0.762074)
[S7] cosine check vs S13: cos=0.0835
[S7] BUFFERED delta from S13 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1805 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1805) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.536078)
[S13] loaded HEAD from S17 (vec_in norm=1.536078)
[S13] cosine check vs S17: cos=0.3443
[S13] BUFFERED delta from S17 (total buffered=2)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.8974 head_norm=0.907848
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.099284e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.9025 head_norm=0.831929 delta_norm=0.309928
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.4267 head_norm=0.860869
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.914015e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.5217 head_norm=0.860420 delta_norm=0.191402
[S5] aggregate: ACCEPT kept=['S6', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.6919 head_norm=1.210254
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.909011e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7019 head_norm=1.316290 delta_norm=0.390901
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6659 head_norm=1.518595
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.281555e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6660 head_norm=1.583393 delta_norm=0.228155
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.7020 head_norm=0.762074
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.363929e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.6798 head_norm=0.868544 delta_norm=0.436393
[S13] aggregate: ROLLBACK (f1_val pre=0.702 post=0.680 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.3979 head_norm=1.161605
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.674991e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.3946 head_norm=0.720754 delta_norm=0.667499
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.7139 head_norm=0.867257
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.193804e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.9918 head_norm=0.935335 delta_norm=0.419380
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.676976 (no previous merge yet)
[S2] round=14 local utility u=0.120095 metrics={'f1_val': 0.7017413673999814, 'auprc': 0.8393667081791263, 'loss_val': 0.3303998104288778, 'psi': 0.7567915037116393}-{'f1_val': 0.7014918162305126, 'auprc': 0.7528832422366925, 'loss_val': 0.3096426374647154, 'psi': 0.7220483866329845}
[S3] START round=14 head_norm_before_train=1.610283 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.6927498788157274, 'auprc': 0.9907345041689852, 'loss_val': 0.354233057605791, 'psi': 0.8119437289570305}-{'f1_val': 0.7000803035935849, 'auprc': 0.9912444697800253, 'loss_val': 0.34608201934387467, 'psi': 0.8165459700681611}
[S4] START round=14 head_norm_before_train=1.583393 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.6700374654384931, 'auprc': 0.6602768441250881, 'loss_val': 0.4807871001039413, 'psi': 0.6661332169131311}-{'f1_val': 0.6658646024989345, 'auprc': 0.8451028694182763, 'loss_val': 0.49288668059819524, 'psi': 0.7375599092666713}
[S5] START round=14 head_norm_before_train=0.860420 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.807113 metrics={'f1_val': 0.6986036828498998, 'auprc': 0.7696737997950904, 'loss_val': 0.6142975904623751, 'psi': 0.727031729627976}-{'f1_val': 0.4267299163209944, 'auprc': 0.8165403751917594, 'loss_val': 0.7378799411609719, 'psi': 0.5826540998693004}
[S6] START round=14 head_norm_before_train=1.309497 cos_to_last_merge=0.8719 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.872
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.7075105653958144, 'auprc': 0.8441875260839612, 'loss_val': 0.38660700558647215, 'psi': 0.7621813496710731}-{'f1_val': 0.7049708145700102, 'auprc': 0.9649674500267439, 'loss_val': 0.33626965213818477, 'psi': 0.8089694687527037}
[S7] START round=14 head_norm_before_train=0.720754 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=1.000000 metrics={'f1_val': 0.6850087494541502, 'auprc': 0.7915121625828846, 'loss_val': 0.7954122182605415, 'psi': 0.727610114705644}-{'f1_val': 0.39787065052289944, 'auprc': 0.6972431115349369, 'loss_val': 0.9434329546087107, 'psi': 0.5176196349277145}
[S8] START round=14 head_norm_before_train=0.935335 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.9964083359151248, 'loss_val': 0.5409649203584326, 'psi': 0.8269735631503186}-{'f1_val': 0.7138874667974482, 'auprc': 0.9975734042967669, 'loss_val': 0.46470839674391845, 'psi': 0.8273618417971758}
[S9] START round=14 head_norm_before_train=0.955207 cos_to_last_merge=0.9968 (last merge round=12)
[S9] round=14 local utility u=0.027664 metrics={'f1_val': 0.7010401564543445, 'auprc': 0.9977999149414483, 'loss_val': 0.35866696286248184, 'psi': 0.8197440598491861}-{'f1_val': 0.7012904835408967, 'auprc': 0.997824760509016, 'loss_val': 0.415571971419784, 'psi': 0.8199041943281444}
[S10] START round=14 head_norm_before_train=1.366110 cos_to_last_merge=0.8495 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.850
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.5608929146900615, 'auprc': 0.911004658795907, 'loss_val': 0.3996463030335096, 'psi': 0.7009376123323997}-{'f1_val': 0.7001333186946267, 'auprc': 0.9977557200428677, 'loss_val': 0.24294400374569408, 'psi': 0.8191822792339232}
[S11] START round=14 head_norm_before_train=1.316290 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.026878 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.997434316643045, 'loss_val': 0.45606251203914655, 'psi': 0.8199898144093729}-{'f1_val': 0.6919126525625554, 'auprc': 0.995421122434756, 'loss_val': 0.4450932986700901, 'psi': 0.8133160405114357}
[S13] START round=14 head_norm_before_train=0.868544 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5983288381513547, 'auprc': 0.580848525137104, 'loss_val': 0.802271901724239, 'psi': 0.5913367129456545}-{'f1_val': 0.7019784865494677, 'auprc': 0.6831750505946222, 'loss_val': 0.8265296278631934, 'psi': 0.6944571121675296}
[S14] START round=14 head_norm_before_train=1.622158 (no previous merge yet)
[S14] round=14 local utility u=0.028248 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9968700280714834, 'loss_val': 0.14090170698057555, 'psi': 0.9974843146649223}-{'f1_val': 0.997841853906109, 'auprc': 0.9957233041961915, 'loss_val': 0.1936454021590193, 'psi': 0.996994434022142}
[S15] START round=14 head_norm_before_train=0.831929 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.7906393731853099, 'auprc': 0.9429240074598786, 'loss_val': 0.5190219631460963, 'psi': 0.8515532268951373}-{'f1_val': 0.8973744976572494, 'auprc': 0.9915786541496235, 'loss_val': 0.45356653392423524, 'psi': 0.935056160254199}
[S16] START round=14 head_norm_before_train=1.258659 cos_to_last_merge=0.8308 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.831
[S16] round=14 local utility u=0.282303 metrics={'f1_val': 0.5375569605832764, 'auprc': 0.8172283646946374, 'loss_val': 0.7172557026846212, 'psi': 0.6494255222278209}-{'f1_val': 0.4462690707935759, 'auprc': 0.8058434153037661, 'loss_val': 0.6999785425804165, 'psi': 0.590098808597652}
[S17] START round=14 head_norm_before_train=1.536078 (no previous merge yet)
[S17] round=14 local utility u=0.022935 metrics={'f1_val': 0.3546539262393762, 'auprc': 0.7743017255547683, 'loss_val': 0.8078355525946244, 'psi': 0.522513045965533}-{'f1_val': 0.3533640907749881, 'auprc': 0.774295151671335, 'loss_val': 0.8459463356960539, 'psi': 0.5217365151335269}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:61802
[S2] not sending this round → trigger blocked (psi=0.757)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[S7] not sending this round → trigger blocked (psi=0.728)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.663976)
[S7] loaded HEAD from S14 (vec_in norm=1.663976)
[S7] cosine check vs S14: cos=0.7052
[S7] BUFFERED delta from S14 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.013401)
[S11] loaded HEAD from S9 (vec_in norm=1.013401)
[S11] cosine check vs S9: cos=-0.0989
[S11] DROPPED delta from S9 (cos=-0.0989 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.900431)
[S13] loaded HEAD from S5 (vec_in norm=0.900431)
[S13] cosine check vs S5: cos=0.4500
[S13] BUFFERED delta from S5 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1796) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.295282)
[S2] loaded HEAD from S16 (vec_in norm=1.295282)
[S2] cosine check vs S16: cos=-0.1084
[S2] DROPPED delta from S16 (cos=-0.1084 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.523)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.5983 head_norm=0.909030
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.744672e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.4040 head_norm=0.770348 delta_norm=0.474467
[S13] aggregate: ROLLBACK (f1_val pre=0.598 post=0.404 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.6850 head_norm=0.749555
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.268154e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.6847 head_norm=1.128019 delta_norm=0.626815
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.704435 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7381755833038549, 'auprc': 0.7180854381689212, 'loss_val': 0.352711183788164, 'psi': 0.7301395252498815}-{'f1_val': 0.7017413673999814, 'auprc': 0.8393667081791263, 'loss_val': 0.3303998104288778, 'psi': 0.7567915037116393}
[S3] START round=15 head_norm_before_train=1.635259 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.673959222344984, 'auprc': 0.9896991154556523, 'loss_val': 0.36696756271514114, 'psi': 0.8002551795892512}-{'f1_val': 0.6927498788157274, 'auprc': 0.9907345041689852, 'loss_val': 0.354233057605791, 'psi': 0.8119437289570305}
[S4] START round=15 head_norm_before_train=1.612475 cos_to_last_merge=0.9993 (last merge round=13)
[S4] round=15 local utility u=0.288610 metrics={'f1_val': 0.6671962647280949, 'auprc': 0.8542793984953949, 'loss_val': 0.46852821587869203, 'psi': 0.742029518235015}-{'f1_val': 0.6700374654384931, 'auprc': 0.6602768441250881, 'loss_val': 0.4807871001039413, 'psi': 0.6661332169131311}
[S5] START round=15 head_norm_before_train=0.900431 cos_to_last_merge=0.9967 (last merge round=13)
[S5] round=15 local utility u=0.096712 metrics={'f1_val': 0.700320598491359, 'auprc': 0.794776729386592, 'loss_val': 0.5064828988721817, 'psi': 0.7381030508494522}-{'f1_val': 0.6986036828498998, 'auprc': 0.7696737997950904, 'loss_val': 0.6142975904623751, 'psi': 0.727031729627976}
[S6] START round=15 head_norm_before_train=1.335572 cos_to_last_merge=0.8669 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.867
[S6] round=15 local utility u=0.192477 metrics={'f1_val': 0.7075105653958144, 'auprc': 0.9560882407495862, 'loss_val': 0.33735570999690734, 'psi': 0.8069416355373231}-{'f1_val': 0.7075105653958144, 'auprc': 0.8441875260839612, 'loss_val': 0.38660700558647215, 'psi': 0.7621813496710731}
[S7] START round=15 head_norm_before_train=1.128019 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.5109423980434121, 'auprc': 0.7666419274650973, 'loss_val': 0.8602707910534017, 'psi': 0.6132222098120862}-{'f1_val': 0.6850087494541502, 'auprc': 0.7915121625828846, 'loss_val': 0.7954122182605415, 'psi': 0.727610114705644}
[S8] START round=15 head_norm_before_train=0.977634 cos_to_last_merge=0.9949 (last merge round=13)
[S8] round=15 local utility u=0.924007 metrics={'f1_val': 0.9939709389151856, 'auprc': 0.9977229953095207, 'loss_val': 0.37661867293509577, 'psi': 0.9954717614729196}-{'f1_val': 0.7140170479737811, 'auprc': 0.9964083359151248, 'loss_val': 0.5409649203584326, 'psi': 0.8269735631503186}
[S9] START round=15 head_norm_before_train=1.013401 cos_to_last_merge=0.9896 (last merge round=12)
[S9] round=15 local utility u=0.016208 metrics={'f1_val': 0.7010401564543445, 'auprc': 0.9978215905891793, 'loss_val': 0.3263160650578762, 'psi': 0.8197527301082784}-{'f1_val': 0.7010401564543445, 'auprc': 0.9977999149414483, 'loss_val': 0.35866696286248184, 'psi': 0.8197440598491861}
[S10] START round=15 head_norm_before_train=1.393497 cos_to_last_merge=0.8427 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.843
[S10] round=15 local utility u=1.000000 metrics={'f1_val': 0.9575747296007451, 'auprc': 0.9978558520296875, 'loss_val': 0.17277620631921506, 'psi': 0.9736871785723221}-{'f1_val': 0.5608929146900615, 'auprc': 0.911004658795907, 'loss_val': 0.3996463030335096, 'psi': 0.7009376123323997}
[S11] START round=15 head_norm_before_train=1.352700 cos_to_last_merge=0.9982 (last merge round=13)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.6804708744508606, 'auprc': 0.9962056898802364, 'loss_val': 0.3966930421513126, 'psi': 0.8067648006226109}-{'f1_val': 0.7016934795869249, 'auprc': 0.997434316643045, 'loss_val': 0.45606251203914655, 'psi': 0.8199898144093729}
[S13] START round=15 head_norm_before_train=0.770348 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.339840 metrics={'f1_val': 0.6644685406538455, 'auprc': 0.6599736162486126, 'loss_val': 0.7568051881786207, 'psi': 0.6626705708917524}-{'f1_val': 0.5983288381513547, 'auprc': 0.580848525137104, 'loss_val': 0.802271901724239, 'psi': 0.5913367129456545}
[S14] START round=15 head_norm_before_train=1.663976 (no previous merge yet)
[S14] round=15 local utility u=0.018592 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9970264192214601, 'loss_val': 0.10273082833111322, 'psi': 0.9974012385184962}-{'f1_val': 0.9978938390605482, 'auprc': 0.9968700280714834, 'loss_val': 0.14090170698057555, 'psi': 0.9974843146649223}
[S15] START round=15 head_norm_before_train=0.883139 cos_to_last_merge=0.9957 (last merge round=13)
[S15] round=15 local utility u=0.306684 metrics={'f1_val': 0.8450042672698457, 'auprc': 0.9924301493119971, 'loss_val': 0.3803624032444336, 'psi': 0.9039746200867063}-{'f1_val': 0.7906393731853099, 'auprc': 0.9429240074598786, 'loss_val': 0.5190219631460963, 'psi': 0.8515532268951373}
[S16] START round=15 head_norm_before_train=1.295282 cos_to_last_merge=0.8195 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.820
[S16] round=15 local utility u=0.011156 metrics={'f1_val': 0.5386480483437294, 'auprc': 0.8288162615522368, 'loss_val': 0.7362545916049776, 'psi': 0.6547153336271323}-{'f1_val': 0.5375569605832764, 'auprc': 0.8172283646946374, 'loss_val': 0.7172557026846212, 'psi': 0.6494255222278209}
[S17] START round=15 head_norm_before_train=1.556002 (no previous merge yet)
[S17] round=15 local utility u=0.246644 metrics={'f1_val': 0.37048172183551775, 'auprc': 0.868158529354633, 'loss_val': 0.6910846063811346, 'psi': 0.5695524448431639}-{'f1_val': 0.3546539262393762, 'auprc': 0.7743017255547683, 'loss_val': 0.8078355525946244, 'psi': 0.522513045965533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:61804
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.655)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:61810
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:61815
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:61812
[S5] not sending this round → trigger blocked (psi=0.738)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:61805
[S4] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1794) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.028026)
[S15] loaded HEAD from S8 (vec_in norm=1.028026)
[S15] cosine check vs S8: cos=0.7926
[S15] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.945005)
[S9] loaded HEAD from S15 (vec_in norm=0.945005)
[S9] cosine check vs S15: cos=0.8650
[S9] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.812616)
[S7] loaded HEAD from S13 (vec_in norm=0.812616)
[S7] cosine check vs S13: cos=0.1017
[S7] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1790) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.360080)
[S5] loaded HEAD from S6 (vec_in norm=1.360080)
[S5] cosine check vs S6: cos=0.7182
[S5] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.416381)
[S4] loaded HEAD from S10 (vec_in norm=1.416381)
[S4] cosine check vs S10: cos=-0.0735
[S4] DROPPED delta from S10 (cos=-0.0735 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1790) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.634096)
[S11] loaded HEAD from S4 (vec_in norm=1.634096)
[S11] cosine check vs S4: cos=0.9303
[S11] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.574193)
[S13] loaded HEAD from S17 (vec_in norm=1.574193)
[S13] cosine check vs S17: cos=0.3848
[S13] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.6805 head_norm=1.390812
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.066329e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.8648 head_norm=1.486032 delta_norm=0.306633
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.193 → S5@127.0.0.1:61805
[S2] ⇄ pheromone p=0.131 → S4@127.0.0.1:61804
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7010 head_norm=1.066035
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.677174e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7010 head_norm=0.971113 delta_norm=0.267717
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.123 → S11@127.0.0.1:61812
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.5109 head_norm=1.150903
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.698333e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.5345 head_norm=0.737417 delta_norm=0.669833
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.292 → S8@127.0.0.1:61809
[S14] ⇄ pheromone p=0.318 → S7@127.0.0.1:61808
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7003 head_norm=0.945870
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.734789e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7003 head_norm=1.071477 delta_norm=0.473479
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.319 → S13@127.0.0.1:61813
[S3] ⇄ pheromone p=0.163 → S13@127.0.0.1:61813
[S16] ⇄ pheromone p=0.187 → S2@127.0.0.1:61802
[S10] ⇄ pheromone p=0.349 → S4@127.0.0.1:61804
[S4] ⇄ pheromone p=0.228 → S11@127.0.0.1:61812
[S8] ⇄ pheromone p=0.380 → S15@127.0.0.1:61815
[S6] ⇄ pheromone p=0.223 → S5@127.0.0.1:61805
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6645 head_norm=0.812616
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.338242e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6585 head_norm=1.015242 delta_norm=0.733824
[S13] aggregate: ROLLBACK (f1_val pre=0.664 post=0.659 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.273 → S7@127.0.0.1:61808
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.8450 head_norm=0.945005
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.200753e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.8980 head_norm=0.934071 delta_norm=0.320075
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.352 → S9@127.0.0.1:61810
[S17] ⇄ pheromone p=0.128 → S13@127.0.0.1:61813
[S2] START round=16 head_norm_before_train=1.725873 (no previous merge yet)
[S2] round=16 local utility u=0.481851 metrics={'f1_val': 0.8296426746812842, 'auprc': 0.8397224436660649, 'loss_val': 0.3027221987332879, 'psi': 0.8336745822751965}-{'f1_val': 0.7381755833038549, 'auprc': 0.7180854381689212, 'loss_val': 0.352711183788164, 'psi': 0.7301395252498815}
[S3] START round=16 head_norm_before_train=1.658887 (no previous merge yet)
[S3] round=16 local utility u=0.077547 metrics={'f1_val': 0.6927498788157274, 'auprc': 0.9910262198421979, 'loss_val': 0.32859836398375547, 'psi': 0.8120604152263156}-{'f1_val': 0.673959222344984, 'auprc': 0.9896991154556523, 'loss_val': 0.36696756271514114, 'psi': 0.8002551795892512}
[S4] START round=16 head_norm_before_train=1.634096 cos_to_last_merge=0.9982 (last merge round=13)
[S4] round=16 local utility u=0.010846 metrics={'f1_val': 0.6679642385685793, 'auprc': 0.8560082467281029, 'loss_val': 0.45663023580577206, 'psi': 0.7431818418323888}-{'f1_val': 0.6671962647280949, 'auprc': 0.8542793984953949, 'loss_val': 0.46852821587869203, 'psi': 0.742029518235015}
[S5] START round=16 head_norm_before_train=1.071477 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.110972 metrics={'f1_val': 0.700320598491359, 'auprc': 0.861024037207787, 'loss_val': 0.48328052803700106, 'psi': 0.7646019739779302}-{'f1_val': 0.700320598491359, 'auprc': 0.794776729386592, 'loss_val': 0.5064828988721817, 'psi': 0.7381030508494522}
[S6] START round=16 head_norm_before_train=1.360080 cos_to_last_merge=0.8623 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.862
[S6] round=16 local utility u=0.827535 metrics={'f1_val': 0.962881910830564, 'auprc': 0.9648904037270463, 'loss_val': 0.2409199718942877, 'psi': 0.963685307989157}-{'f1_val': 0.7075105653958144, 'auprc': 0.9560882407495862, 'loss_val': 0.33735570999690734, 'psi': 0.8069416355373231}
[S7] START round=16 head_norm_before_train=0.737417 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.033703 metrics={'f1_val': 0.5767877495960295, 'auprc': 0.6657119180738987, 'loss_val': 0.8851476985538733, 'psi': 0.6123574169871773}-{'f1_val': 0.5109423980434121, 'auprc': 0.7666419274650973, 'loss_val': 0.8602707910534017, 'psi': 0.6132222098120862}
[S8] START round=16 head_norm_before_train=1.028026 cos_to_last_merge=0.9830 (last merge round=13)
[S8] round=16 local utility u=0.035225 metrics={'f1_val': 0.9937036553844988, 'auprc': 0.994398202980717, 'loss_val': 0.2945909218427053, 'psi': 0.993981474422986}-{'f1_val': 0.9939709389151856, 'auprc': 0.9977229953095207, 'loss_val': 0.37661867293509577, 'psi': 0.9954717614729196}
[S9] START round=16 head_norm_before_train=0.971113 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.7010401564543445, 'auprc': 0.9981973913397177, 'loss_val': 0.3512519133337455, 'psi': 0.8199030504084939}-{'f1_val': 0.7010401564543445, 'auprc': 0.9978215905891793, 'loss_val': 0.3263160650578762, 'psi': 0.8197527301082784}
[S10] START round=16 head_norm_before_train=1.416381 cos_to_last_merge=0.8379 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.838
[S10] round=16 local utility u=0.124065 metrics={'f1_val': 0.9950680524003758, 'auprc': 0.9977128693409094, 'loss_val': 0.14917763432639325, 'psi': 0.9961259791765893}-{'f1_val': 0.9575747296007451, 'auprc': 0.9978558520296875, 'loss_val': 0.17277620631921506, 'psi': 0.9736871785723221}
[S11] START round=16 head_norm_before_train=1.486032 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.817459 metrics={'f1_val': 0.9534579268320653, 'auprc': 0.9967641374413739, 'loss_val': 0.40137369744411266, 'psi': 0.9707804110757887}-{'f1_val': 0.6804708744508606, 'auprc': 0.9962056898802364, 'loss_val': 0.3966930421513126, 'psi': 0.8067648006226109}
[S13] START round=16 head_norm_before_train=1.015242 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.62688568064273, 'auprc': 0.59781870677909, 'loss_val': 0.8168831133757115, 'psi': 0.6152588910972739}-{'f1_val': 0.6644685406538455, 'auprc': 0.6599736162486126, 'loss_val': 0.7568051881786207, 'psi': 0.6626705708917524}
[S14] START round=16 head_norm_before_train=1.704645 (no previous merge yet)
[S14] round=16 local utility u=0.001520 metrics={'f1_val': 0.9964034173396682, 'auprc': 0.9957228697816252, 'loss_val': 0.08829318076155211, 'psi': 0.9961311983164509}-{'f1_val': 0.9976511180498535, 'auprc': 0.9970264192214601, 'loss_val': 0.10273082833111322, 'psi': 0.9974012385184962}
[S15] START round=16 head_norm_before_train=0.934071 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.404227 metrics={'f1_val': 0.9765996071510167, 'auprc': 0.9979539842659604, 'loss_val': 0.3780522715625086, 'psi': 0.9851413579969942}-{'f1_val': 0.8450042672698457, 'auprc': 0.9924301493119971, 'loss_val': 0.3803624032444336, 'psi': 0.9039746200867063}
[S16] START round=16 head_norm_before_train=1.331179 cos_to_last_merge=0.8088 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.809
[S16] round=16 local utility u=0.348481 metrics={'f1_val': 0.5790821604808681, 'auprc': 0.9099873443638173, 'loss_val': 0.5254099173927345, 'psi': 0.7114442340340479}-{'f1_val': 0.5386480483437294, 'auprc': 0.8288162615522368, 'loss_val': 0.7362545916049776, 'psi': 0.6547153336271323}
[S17] START round=16 head_norm_before_train=1.574193 (no previous merge yet)
[S17] round=16 local utility u=0.231872 metrics={'f1_val': 0.4179148801984831, 'auprc': 0.903595188429791, 'loss_val': 0.6182500041755942, 'psi': 0.6121870034910062}-{'f1_val': 0.37048172183551775, 'auprc': 0.868158529354633, 'loss_val': 0.6910846063811346, 'psi': 0.5695524448431639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:61802
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61808
[S6] not sending this round → trigger blocked (psi=0.964)
[S4] not sending this round → trigger blocked (psi=0.743)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61809
[S8] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:61804
[S15] not sending this round → trigger blocked (psi=0.985)
[S10] not sending this round → trigger blocked (psi=0.996)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:61805
[S11] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.367701)
[S2] loaded HEAD from S16 (vec_in norm=1.367701)
[S2] cosine check vs S16: cos=-0.1083
[S2] DROPPED delta from S16 (cos=-0.1083 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1794) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.681820)
[S13] loaded HEAD from S3 (vec_in norm=1.681820)
[S13] cosine check vs S3: cos=0.2814
[S13] BUFFERED delta from S3 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.766277)
[S8] loaded HEAD from S7 (vec_in norm=0.766277)
[S8] cosine check vs S7: cos=0.8022
[S8] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.743178)
[S7] loaded HEAD from S14 (vec_in norm=1.743178)
[S7] cosine check vs S14: cos=0.6859
[S7] BUFFERED delta from S14 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1793) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.106641)
[S13] loaded HEAD from S5 (vec_in norm=1.106641)
[S13] cosine check vs S5: cos=0.3587
[S13] BUFFERED delta from S5 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.742688)
[S4] loaded HEAD from S2 (vec_in norm=1.742688)
[S4] cosine check vs S2: cos=0.9762
[S4] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.510402)
[S5] loaded HEAD from S11 (vec_in norm=1.510402)
[S5] cosine check vs S11: cos=0.2202
[S5] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.612)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6269 head_norm=1.044147
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.700940e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6321 head_norm=0.882816 delta_norm=0.570094
[S13] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.6680 head_norm=1.654370
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.902288e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.6210 head_norm=1.688421 delta_norm=0.190229
[S4] aggregate: ROLLBACK (f1_val pre=0.668 post=0.621 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9937 head_norm=1.081851
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.269056e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9937 head_norm=0.878592 delta_norm=0.326906
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.5768 head_norm=0.766277
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.695788e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.5336 head_norm=1.168156 delta_norm=0.669579
[S7] aggregate: ROLLBACK (f1_val pre=0.577 post=0.534 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7003 head_norm=1.106641
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.321680e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7004 head_norm=1.029797 delta_norm=0.832168
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.742688 (no previous merge yet)
[S2] round=17 local utility u=0.052960 metrics={'f1_val': 0.8267664077561411, 'auprc': 0.8881227884869869, 'loss_val': 0.3247456223555318, 'psi': 0.8513089600484793}-{'f1_val': 0.8296426746812842, 'auprc': 0.8397224436660649, 'loss_val': 0.3027221987332879, 'psi': 0.8336745822751965}
[S3] START round=17 head_norm_before_train=1.681820 (no previous merge yet)
[S3] round=17 local utility u=0.040380 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9923604714562679, 'loss_val': 0.29582343932667304, 'psi': 0.8169923707386582}-{'f1_val': 0.6927498788157274, 'auprc': 0.9910262198421979, 'loss_val': 0.32859836398375547, 'psi': 0.8120604152263156}
[S4] START round=17 head_norm_before_train=1.688421 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.6154062627622077, 'auprc': 0.949486638768973, 'loss_val': 0.46309621201228635, 'psi': 0.7490384131649138}-{'f1_val': 0.6679642385685793, 'auprc': 0.8560082467281029, 'loss_val': 0.45663023580577206, 'psi': 0.7431818418323888}
[S5] START round=17 head_norm_before_train=1.029797 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.6536529518052631, 'auprc': 0.856783341686802, 'loss_val': 0.6204123693759515, 'psi': 0.7349051077578787}-{'f1_val': 0.700320598491359, 'auprc': 0.861024037207787, 'loss_val': 0.48328052803700106, 'psi': 0.7646019739779302}
[S6] START round=17 head_norm_before_train=1.386905 cos_to_last_merge=0.8571 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.857
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.5927766802068485, 'auprc': 0.7865314073009013, 'loss_val': 0.6705536338673672, 'psi': 0.6702785710444696}-{'f1_val': 0.962881910830564, 'auprc': 0.9648904037270463, 'loss_val': 0.2409199718942877, 'psi': 0.963685307989157}
[S7] START round=17 head_norm_before_train=1.168156 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.334246 metrics={'f1_val': 0.6110803220852046, 'auprc': 0.7772392256722638, 'loss_val': 0.7569929539177819, 'psi': 0.6775438835200283}-{'f1_val': 0.5767877495960295, 'auprc': 0.6657119180738987, 'loss_val': 0.8851476985538733, 'psi': 0.6123574169871773}
[S8] START round=17 head_norm_before_train=0.878592 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9937111453033, 'auprc': 0.9908251051236454, 'loss_val': 0.39470636476714016, 'psi': 0.9925567292314381}-{'f1_val': 0.9937036553844988, 'auprc': 0.994398202980717, 'loss_val': 0.2945909218427053, 'psi': 0.993981474422986}
[S9] START round=17 head_norm_before_train=1.015177 cos_to_last_merge=0.9985 (last merge round=15)
[S9] round=17 local utility u=0.014314 metrics={'f1_val': 0.7010401564543445, 'auprc': 0.9981804799553027, 'loss_val': 0.32257391431679827, 'psi': 0.8198962858547278}-{'f1_val': 0.7010401564543445, 'auprc': 0.9981973913397177, 'loss_val': 0.3512519133337455, 'psi': 0.8199030504084939}
[S10] START round=17 head_norm_before_train=1.438427 cos_to_last_merge=0.8342 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.834
[S10] round=17 local utility u=0.010988 metrics={'f1_val': 0.9956783869468456, 'auprc': 0.9977120334357785, 'loss_val': 0.1308616776315193, 'psi': 0.9964918455424188}-{'f1_val': 0.9950680524003758, 'auprc': 0.9977128693409094, 'loss_val': 0.14917763432639325, 'psi': 0.9961259791765893}
[S11] START round=17 head_norm_before_train=1.510402 cos_to_last_merge=0.9987 (last merge round=15)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.8844619727493046, 'auprc': 0.994286186685115, 'loss_val': 0.4660245062372263, 'psi': 0.9283916583236287}-{'f1_val': 0.9534579268320653, 'auprc': 0.9967641374413739, 'loss_val': 0.40137369744411266, 'psi': 0.9707804110757887}
[S13] START round=17 head_norm_before_train=0.882816 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.050329 metrics={'f1_val': 0.5994045654510167, 'auprc': 0.6615367150989919, 'loss_val': 0.7424923116335375, 'psi': 0.6242574253102068}-{'f1_val': 0.62688568064273, 'auprc': 0.59781870677909, 'loss_val': 0.8168831133757115, 'psi': 0.6152588910972739}
[S14] START round=17 head_norm_before_train=1.743178 (no previous merge yet)
[S14] round=17 local utility u=0.013477 metrics={'f1_val': 0.997841853906109, 'auprc': 0.995723246822922, 'loss_val': 0.06997160829289452, 'psi': 0.9969944110728343}-{'f1_val': 0.9964034173396682, 'auprc': 0.9957228697816252, 'loss_val': 0.08829318076155211, 'psi': 0.9961311983164509}
[S15] START round=17 head_norm_before_train=0.986337 cos_to_last_merge=0.9963 (last merge round=15)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.8359176014024672, 'auprc': 0.9914328995633886, 'loss_val': 0.3389595922250334, 'psi': 0.8981237206668358}-{'f1_val': 0.9765996071510167, 'auprc': 0.9979539842659604, 'loss_val': 0.3780522715625086, 'psi': 0.9851413579969942}
[S16] START round=17 head_norm_before_train=1.367701 cos_to_last_merge=0.8001 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.800
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.5383615314805993, 'auprc': 0.8589514676672405, 'loss_val': 0.8248365812934343, 'psi': 0.6665975059552558}-{'f1_val': 0.5790821604808681, 'auprc': 0.9099873443638173, 'loss_val': 0.5254099173927345, 'psi': 0.7114442340340479}
[S17] START round=17 head_norm_before_train=1.590579 (no previous merge yet)
[S17] round=17 local utility u=1.000000 metrics={'f1_val': 0.8044937472082638, 'auprc': 0.8344689847037792, 'loss_val': 0.5770657028590188, 'psi': 0.81648384220647}-{'f1_val': 0.4179148801984831, 'auprc': 0.903595188429791, 'loss_val': 0.6182500041755942, 'psi': 0.6121870034910062}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61812
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:61808
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.817)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:61804
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → trigger blocked (psi=0.678)
[S2] not sending this round → trigger blocked (psi=0.851)
[S13] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.463369)
[S4] loaded HEAD from S10 (vec_in norm=1.463369)
[S4] cosine check vs S10: cos=-0.0705
[S4] DROPPED delta from S10 (cos=-0.0705 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1791) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.925717)
[S7] loaded HEAD from S13 (vec_in norm=0.925717)
[S7] cosine check vs S13: cos=0.1031
[S7] BUFFERED delta from S13 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.060288)
[S11] loaded HEAD from S9 (vec_in norm=1.060288)
[S11] cosine check vs S9: cos=-0.1254
[S11] DROPPED delta from S9 (cos=-0.1254 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.612435)
[S13] loaded HEAD from S17 (vec_in norm=1.612435)
[S13] cosine check vs S17: cos=0.5646
[S13] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.6111 head_norm=1.194192
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.167879e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.6184 head_norm=0.792299 delta_norm=0.716788
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.5994 head_norm=0.925717
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.654550e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6024 head_norm=1.133852 delta_norm=0.665455
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.757819 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7166805579682028, 'auprc': 0.7716929773923586, 'loss_val': 0.36530605206915745, 'psi': 0.7386855257378652}-{'f1_val': 0.8267664077561411, 'auprc': 0.8881227884869869, 'loss_val': 0.3247456223555318, 'psi': 0.8513089600484793}
[S3] START round=18 head_norm_before_train=1.703015 (no previous merge yet)
[S3] round=18 local utility u=0.016613 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9935916472908698, 'loss_val': 0.270798892727063, 'psi': 0.8179356999316343}-{'f1_val': 0.7000803035935849, 'auprc': 0.9923604714562679, 'loss_val': 0.29582343932667304, 'psi': 0.8169923707386582}
[S4] START round=18 head_norm_before_train=1.706690 cos_to_last_merge=0.9998 (last merge round=16)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.6125026589835885, 'auprc': 0.9468161079713253, 'loss_val': 0.47424774694682703, 'psi': 0.7462280385786833}-{'f1_val': 0.6154062627622077, 'auprc': 0.949486638768973, 'loss_val': 0.46309621201228635, 'psi': 0.7490384131649138}
[S5] START round=18 head_norm_before_train=1.059716 cos_to_last_merge=0.9979 (last merge round=16)
[S5] round=18 local utility u=0.091024 metrics={'f1_val': 0.6462729961951396, 'auprc': 0.9030439250778324, 'loss_val': 0.5328670205181602, 'psi': 0.7489813677482167}-{'f1_val': 0.6536529518052631, 'auprc': 0.856783341686802, 'loss_val': 0.6204123693759515, 'psi': 0.7349051077578787}
[S6] START round=18 head_norm_before_train=1.413896 cos_to_last_merge=0.8520 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.852
[S6] round=18 local utility u=1.000000 metrics={'f1_val': 0.9612149813236942, 'auprc': 0.9660141034308093, 'loss_val': 0.21950489474583798, 'psi': 0.9631346301665402}-{'f1_val': 0.5927766802068485, 'auprc': 0.7865314073009013, 'loss_val': 0.6705536338673672, 'psi': 0.6702785710444696}
[S7] START round=18 head_norm_before_train=0.792299 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.6084618617958303, 'auprc': 0.6602482719554655, 'loss_val': 0.8502765233392806, 'psi': 0.6291764258596844}-{'f1_val': 0.6110803220852046, 'auprc': 0.7772392256722638, 'loss_val': 0.7569929539177819, 'psi': 0.6775438835200283}
[S8] START round=18 head_norm_before_train=0.928457 cos_to_last_merge=0.9968 (last merge round=16)
[S8] round=18 local utility u=0.054309 metrics={'f1_val': 0.9937111453033, 'auprc': 0.9895261521210559, 'loss_val': 0.2821919798890325, 'psi': 0.9920371480304022}-{'f1_val': 0.9937111453033, 'auprc': 0.9908251051236454, 'loss_val': 0.39470636476714016, 'psi': 0.9925567292314381}
[S9] START round=18 head_norm_before_train=1.060288 cos_to_last_merge=0.9951 (last merge round=15)
[S9] round=18 local utility u=0.009559 metrics={'f1_val': 0.7010401564543445, 'auprc': 0.9979846717808482, 'loss_val': 0.3028678949129407, 'psi': 0.819817962584946}-{'f1_val': 0.7010401564543445, 'auprc': 0.9981804799553027, 'loss_val': 0.32257391431679827, 'psi': 0.8198962858547278}
[S10] START round=18 head_norm_before_train=1.463369 cos_to_last_merge=0.8309 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.831
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9969422103471008, 'loss_val': 0.1557962904247207, 'psi': 0.9962242205858867}-{'f1_val': 0.9956783869468456, 'auprc': 0.9977120334357785, 'loss_val': 0.1308616776315193, 'psi': 0.9964918455424188}
[S11] START round=18 head_norm_before_train=1.538821 cos_to_last_merge=0.9950 (last merge round=15)
[S11] round=18 local utility u=0.339782 metrics={'f1_val': 0.9577957292568001, 'auprc': 0.996907053039375, 'loss_val': 0.2343255983564591, 'psi': 0.9734402587698301}-{'f1_val': 0.8844619727493046, 'auprc': 0.994286186685115, 'loss_val': 0.4660245062372263, 'psi': 0.9283916583236287}
[S13] START round=18 head_norm_before_train=1.133852 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5728976723725351, 'auprc': 0.6513723579963443, 'loss_val': 0.862951968048488, 'psi': 0.6042875466220587}-{'f1_val': 0.5994045654510167, 'auprc': 0.6615367150989919, 'loss_val': 0.7424923116335375, 'psi': 0.6242574253102068}
[S14] START round=18 head_norm_before_train=1.780956 (no previous merge yet)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9957445751558393, 'auprc': 0.9957217334947086, 'loss_val': 0.0653084599943137, 'psi': 0.995735438491387}-{'f1_val': 0.997841853906109, 'auprc': 0.995723246822922, 'loss_val': 0.06997160829289452, 'psi': 0.9969944110728343}
[S15] START round=18 head_norm_before_train=1.047647 cos_to_last_merge=0.9874 (last merge round=15)
[S15] round=18 local utility u=0.563031 metrics={'f1_val': 0.9965885588709118, 'auprc': 0.9974467079108947, 'loss_val': 0.19496562229360298, 'psi': 0.9969318184869049}-{'f1_val': 0.8359176014024672, 'auprc': 0.9914328995633886, 'loss_val': 0.3389595922250334, 'psi': 0.8981237206668358}
[S16] START round=18 head_norm_before_train=1.403036 cos_to_last_merge=0.7931 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.793
[S16] round=18 local utility u=0.619057 metrics={'f1_val': 0.637071141224905, 'auprc': 0.9392848474813703, 'loss_val': 0.4199800493197114, 'psi': 0.7579566237274911}-{'f1_val': 0.5383615314805993, 'auprc': 0.8589514676672405, 'loss_val': 0.8248365812934343, 'psi': 0.6665975059552558}
[S17] START round=18 head_norm_before_train=1.612435 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.7468314982140777, 'auprc': 0.7924999595994725, 'loss_val': 0.6572320992687223, 'psi': 0.7650988827682357}-{'f1_val': 0.8044937472082638, 'auprc': 0.8344689847037792, 'loss_val': 0.5770657028590188, 'psi': 0.81648384220647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:61802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:61810
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:61805
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:61813
[S9] not sending this round → trigger blocked (psi=0.820)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.096465)
[S13] loaded HEAD from S5 (vec_in norm=1.096465)
[S13] cosine check vs S5: cos=0.2261
[S13] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.991025)
[S15] loaded HEAD from S8 (vec_in norm=0.991025)
[S15] cosine check vs S8: cos=0.8805
[S15] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1795) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.722100)
[S13] loaded HEAD from S3 (vec_in norm=1.722100)
[S13] cosine check vs S3: cos=0.3293
[S13] BUFFERED delta from S3 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1804) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.432857)
[S5] loaded HEAD from S6 (vec_in norm=1.432857)
[S5] cosine check vs S6: cos=0.5131
[S5] BUFFERED delta from S6 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.567056)
[S5] loaded HEAD from S11 (vec_in norm=1.567056)
[S5] cosine check vs S11: cos=0.8170
[S5] BUFFERED delta from S11 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1793) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.108341)
[S9] loaded HEAD from S15 (vec_in norm=1.108341)
[S9] cosine check vs S15: cos=0.8841
[S9] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1801) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.436613)
[S2] loaded HEAD from S16 (vec_in norm=1.436613)
[S2] cosine check vs S16: cos=-0.1093
[S2] DROPPED delta from S16 (cos=-0.1093 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.5729 head_norm=1.158446
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.124074e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.5754 head_norm=0.920392 delta_norm=0.612407
[S13] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.7010 head_norm=1.101419
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.660313e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.7010 head_norm=1.072380 delta_norm=0.266031
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.6463 head_norm=1.096465
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.608379e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.6566 head_norm=1.063413 delta_norm=0.160838
[S5] aggregate: ACCEPT kept=['S6', 'S11'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.9966 head_norm=1.108341
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.627901e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.9968 head_norm=1.017947 delta_norm=0.262790
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.775376 (no previous merge yet)
[S2] round=19 local utility u=0.475317 metrics={'f1_val': 0.843720771734989, 'auprc': 0.8155555802403576, 'loss_val': 0.3085013809329978, 'psi': 0.8324546951371365}-{'f1_val': 0.7166805579682028, 'auprc': 0.7716929773923586, 'loss_val': 0.36530605206915745, 'psi': 0.7386855257378652}
[S3] START round=19 head_norm_before_train=1.722100 (no previous merge yet)
[S3] round=19 local utility u=0.002807 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9937681576875372, 'loss_val': 0.26571377474677504, 'psi': 0.8180063040903014}-{'f1_val': 0.7008317350254774, 'auprc': 0.9935916472908698, 'loss_val': 0.270798892727063, 'psi': 0.8179356999316343}
[S4] START round=19 head_norm_before_train=1.723939 cos_to_last_merge=0.9993 (last merge round=16)
[S4] round=19 local utility u=0.018335 metrics={'f1_val': 0.6183011087800625, 'auprc': 0.9455085307659539, 'loss_val': 0.4684450320344262, 'psi': 0.749184077574419}-{'f1_val': 0.6125026589835885, 'auprc': 0.9468161079713253, 'loss_val': 0.47424774694682703, 'psi': 0.7462280385786833}
[S5] START round=19 head_norm_before_train=1.063413 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.339797 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9955812696058916, 'loss_val': 0.4551705033461175, 'psi': 0.8184248669371721}-{'f1_val': 0.6462729961951396, 'auprc': 0.9030439250778324, 'loss_val': 0.5328670205181602, 'psi': 0.7489813677482167}
[S6] START round=19 head_norm_before_train=1.432857 cos_to_last_merge=0.8485 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.849
[S6] round=19 local utility u=0.010545 metrics={'f1_val': 0.9615260042899739, 'auprc': 0.9688286902629503, 'loss_val': 0.20872466231603345, 'psi': 0.9644470786791645}-{'f1_val': 0.9612149813236942, 'auprc': 0.9660141034308093, 'loss_val': 0.21950489474583798, 'psi': 0.9631346301665402}
[S7] START round=19 head_norm_before_train=0.825843 cos_to_last_merge=0.9963 (last merge round=17)
[S7] round=19 local utility u=0.336793 metrics={'f1_val': 0.6379627146878417, 'auprc': 0.7805995960904322, 'loss_val': 0.7147504814272979, 'psi': 0.6950174672488778}-{'f1_val': 0.6084618617958303, 'auprc': 0.6602482719554655, 'loss_val': 0.8502765233392806, 'psi': 0.6291764258596844}
[S8] START round=19 head_norm_before_train=0.991025 cos_to_last_merge=0.9878 (last merge round=16)
[S8] round=19 local utility u=0.053060 metrics={'f1_val': 0.9940342119076258, 'auprc': 0.9975075013347074, 'loss_val': 0.2019535184852423, 'psi': 0.9954235276784584}-{'f1_val': 0.9937111453033, 'auprc': 0.9895261521210559, 'loss_val': 0.2821919798890325, 'psi': 0.9920371480304022}
[S9] START round=19 head_norm_before_train=1.072380 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.7010401564543445, 'auprc': 0.9974864338989955, 'loss_val': 0.3204791285268589, 'psi': 0.8196186674322049}-{'f1_val': 0.7010401564543445, 'auprc': 0.9979846717808482, 'loss_val': 0.3028678949129407, 'psi': 0.819817962584946}
[S10] START round=19 head_norm_before_train=1.484935 cos_to_last_merge=0.8286 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.829
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.8227393514709491, 'auprc': 0.9561253554976693, 'loss_val': 0.36933578538352113, 'psi': 0.8760937530816373}-{'f1_val': 0.9957455607450773, 'auprc': 0.9969422103471008, 'loss_val': 0.1557962904247207, 'psi': 0.9962242205858867}
[S11] START round=19 head_norm_before_train=1.567056 cos_to_last_merge=0.9901 (last merge round=15)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.9173972977497449, 'auprc': 0.9976749067567009, 'loss_val': 0.3168247475291031, 'psi': 0.9495083413525273}-{'f1_val': 0.9577957292568001, 'auprc': 0.996907053039375, 'loss_val': 0.2343255983564591, 'psi': 0.9734402587698301}
[S13] START round=19 head_norm_before_train=0.920392 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.141317 metrics={'f1_val': 0.6002366329432909, 'auprc': 0.6532564775960319, 'loss_val': 0.7500035507571807, 'psi': 0.6214445708043872}-{'f1_val': 0.5728976723725351, 'auprc': 0.6513723579963443, 'loss_val': 0.862951968048488, 'psi': 0.6042875466220587}
[S14] START round=19 head_norm_before_train=1.818012 (no previous merge yet)
[S14] round=19 local utility u=0.019650 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9988406926455451, 'loss_val': 0.04534801963208517, 'psi': 0.9979812387592534}-{'f1_val': 0.9957445751558393, 'auprc': 0.9957217334947086, 'loss_val': 0.0653084599943137, 'psi': 0.995735438491387}
[S15] START round=19 head_norm_before_train=1.017947 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.8214035312605074, 'auprc': 0.9957879434544351, 'loss_val': 0.34668292976033005, 'psi': 0.8911572961380785}-{'f1_val': 0.9965885588709118, 'auprc': 0.9974467079108947, 'loss_val': 0.19496562229360298, 'psi': 0.9969318184869049}
[S16] START round=19 head_norm_before_train=1.436613 cos_to_last_merge=0.7874 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.787
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.5353990526951764, 'auprc': 0.7970217049892419, 'loss_val': 1.0429475515023547, 'psi': 0.6400481136128027}-{'f1_val': 0.637071141224905, 'auprc': 0.9392848474813703, 'loss_val': 0.4199800493197114, 'psi': 0.7579566237274911}
[S17] START round=19 head_norm_before_train=1.638254 (no previous merge yet)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.5785413987272828, 'auprc': 0.9174186054051635, 'loss_val': 0.6535264288553132, 'psi': 0.7140922813984352}-{'f1_val': 0.7468314982140777, 'auprc': 0.7924999595994725, 'loss_val': 0.6572320992687223, 'psi': 0.7650988827682357}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.818)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:61812
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.818)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:61804
[S6] not sending this round → trigger blocked (psi=0.964)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61808
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.740876)
[S11] loaded HEAD from S4 (vec_in norm=1.740876)
[S11] cosine check vs S4: cos=0.9382
[S11] BUFFERED delta from S4 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1795) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.867553)
[S8] loaded HEAD from S7 (vec_in norm=0.867553)
[S8] cosine check vs S7: cos=0.8461
[S8] BUFFERED delta from S7 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.795358)
[S4] loaded HEAD from S2 (vec_in norm=1.795358)
[S4] cosine check vs S2: cos=0.9853
[S4] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.951997)
[S7] loaded HEAD from S13 (vec_in norm=0.951997)
[S7] cosine check vs S13: cos=0.6153
[S7] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.847181)
[S7] loaded HEAD from S14 (vec_in norm=1.847181)
[S7] cosine check vs S14: cos=0.6535
[S7] BUFFERED delta from S14 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.964 u=0.0105 p_local=0.3381 f1=0.962 auprc=0.969 bytes=14365
[S3] r=20 psi=0.818 u=0.0028 p_local=0.0831 f1=0.701 auprc=0.994 bytes=16161
[S5] r=20 psi=0.818 u=0.3398 p_local=0.2246 f1=0.700 auprc=0.996 bytes=16156
[S9] r=20 psi=0.820 u=0.0000 p_local=0.0538 f1=0.701 auprc=0.997 bytes=14394
[S10] r=20 psi=0.876 u=0.0000 p_local=0.1569 f1=0.823 auprc=0.956 bytes=14361
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.9174 head_norm=1.595763
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.019270e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.9168 head_norm=1.642375 delta_norm=0.301927
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.950 u=0.0000 p_local=0.2172 f1=0.917 auprc=0.998 bytes=14378
[S15] r=20 psi=0.891 u=0.0000 p_local=0.2756 f1=0.821 auprc=0.996 bytes=14354
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9940 head_norm=1.059940
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.828515e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9933 head_norm=0.926313 delta_norm=0.282852
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.995 u=0.0531 p_local=0.1787 f1=0.994 auprc=0.998 bytes=14367
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.6183 head_norm=1.740876
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.540694e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.6145 head_norm=1.761602 delta_norm=0.154069
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.749 u=0.0183 p_local=0.0980 f1=0.618 auprc=0.946 bytes=12566
[S2] r=20 psi=0.832 u=0.4753 p_local=0.2050 f1=0.844 auprc=0.816 bytes=14392
[S14] r=20 psi=0.998 u=0.0196 p_local=0.1360 f1=0.997 auprc=0.999 bytes=16203
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.6380 head_norm=0.867553
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.076871e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.6282 head_norm=0.905992 delta_norm=0.207687
[S7] aggregate: ROLLBACK (f1_val pre=0.638 post=0.628 tol_abs=0.005 tol_rel=0.0)
[S7] r=20 psi=0.695 u=0.3368 p_local=0.2332 f1=0.638 auprc=0.781 bytes=16183
[S13] r=20 psi=0.621 u=0.1413 p_local=0.1466 f1=0.600 auprc=0.653 bytes=16153
[S16] r=20 psi=0.640 u=0.0000 p_local=0.2114 f1=0.535 auprc=0.797 bytes=14363
[S17] r=20 psi=0.714 u=0.0000 p_local=0.2042 f1=0.579 auprc=0.917 bytes=10795
[S2] START round=20 head_norm_before_train=1.795358 (no previous merge yet)
[S2] round=20 local utility u=0.027584 metrics={'f1_val': 0.8434959663499244, 'auprc': 0.8318525087898958, 'loss_val': 0.300875211377144, 'psi': 0.838838583325913}-{'f1_val': 0.843720771734989, 'auprc': 0.8155555802403576, 'loss_val': 0.3085013809329978, 'psi': 0.8324546951371365}
[S3] START round=20 head_norm_before_train=1.739415 (no previous merge yet)
[S3] round=20 local utility u=0.004636 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9950781341094432, 'loss_val': 0.25991885010963844, 'psi': 0.8184849758849571}-{'f1_val': 0.7008317350254774, 'auprc': 0.9937681576875372, 'loss_val': 0.26571377474677504, 'psi': 0.8180063040903014}
[S4] START round=20 head_norm_before_train=1.761602 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.615707063451578, 'auprc': 0.9455214345990535, 'loss_val': 0.4839449205780343, 'psi': 0.7476328119105682}-{'f1_val': 0.6183011087800625, 'auprc': 0.9455085307659539, 'loss_val': 0.4684450320344262, 'psi': 0.749184077574419}
[S5] START round=20 head_norm_before_train=1.091686 cos_to_last_merge=0.9987 (last merge round=18)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.5326037501927507, 'auprc': 0.7487146903126505, 'loss_val': 0.7658033453148791, 'psi': 0.6190481262407106}-{'f1_val': 0.700320598491359, 'auprc': 0.9955812696058916, 'loss_val': 0.4551705033461175, 'psi': 0.8184248669371721}
[S6] START round=20 head_norm_before_train=1.450006 cos_to_last_merge=0.8454 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.845
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.7779927041104475, 'auprc': 0.8112803563718715, 'loss_val': 0.5081496866371785, 'psi': 0.7913077650150171}-{'f1_val': 0.9615260042899739, 'auprc': 0.9688286902629503, 'loss_val': 0.20872466231603345, 'psi': 0.9644470786791645}
[S7] START round=20 head_norm_before_train=0.905992 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.140288 metrics={'f1_val': 0.6410116475199074, 'auprc': 0.8515017872413779, 'loss_val': 0.6651752666274329, 'psi': 0.7252077034084956}-{'f1_val': 0.6379627146878417, 'auprc': 0.7805995960904322, 'loss_val': 0.7147504814272979, 'psi': 0.6950174672488778}
[S8] START round=20 head_norm_before_train=0.926313 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9944013360228022, 'auprc': 0.988420065863086, 'loss_val': 0.2814108235385045, 'psi': 0.9920088279589157}-{'f1_val': 0.9940342119076258, 'auprc': 0.9975075013347074, 'loss_val': 0.2019535184852423, 'psi': 0.9954235276784584}
[S9] START round=20 head_norm_before_train=1.108233 cos_to_last_merge=0.9993 (last merge round=18)
[S9] round=20 local utility u=0.009323 metrics={'f1_val': 0.7010401564543445, 'auprc': 0.997479776019579, 'loss_val': 0.30181285749607295, 'psi': 0.8196160042804383}-{'f1_val': 0.7010401564543445, 'auprc': 0.9974864338989955, 'loss_val': 0.3204791285268589, 'psi': 0.8196186674322049}
[S10] START round=20 head_norm_before_train=1.505263 cos_to_last_merge=0.8266 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.827
[S10] round=20 local utility u=0.714316 metrics={'f1_val': 0.9952143411512907, 'auprc': 0.9976245403842066, 'loss_val': 0.10005172689043568, 'psi': 0.9961784208444571}-{'f1_val': 0.8227393514709491, 'auprc': 0.9561253554976693, 'loss_val': 0.36933578538352113, 'psi': 0.8760937530816373}
[S11] START round=20 head_norm_before_train=1.642375 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.262385 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9955283688180927, 'loss_val': 0.2590623039067515, 'psi': 0.9959944480085536}-{'f1_val': 0.9173972977497449, 'auprc': 0.9976749067567009, 'loss_val': 0.3168247475291031, 'psi': 0.9495083413525273}
[S13] START round=20 head_norm_before_train=0.951997 cos_to_last_merge=0.9981 (last merge round=18)
[S13] round=20 local utility u=0.025357 metrics={'f1_val': 0.5975526434914551, 'auprc': 0.6683288479985194, 'loss_val': 0.728402554956916, 'psi': 0.6258631252942808}-{'f1_val': 0.6002366329432909, 'auprc': 0.6532564775960319, 'loss_val': 0.7500035507571807, 'psi': 0.6214445708043872}
[S14] START round=20 head_norm_before_train=1.847181 (no previous merge yet)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9954950906765749, 'loss_val': 0.058628476748834576, 'psi': 0.9967439611485808}-{'f1_val': 0.9974082695017256, 'auprc': 0.9988406926455451, 'loss_val': 0.04534801963208517, 'psi': 0.9979812387592534}
[S15] START round=20 head_norm_before_train=1.075676 cos_to_last_merge=0.9977 (last merge round=18)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.7892751596997577, 'auprc': 0.9897193029216642, 'loss_val': 0.28146674195440063, 'psi': 0.8694528169885203}-{'f1_val': 0.8214035312605074, 'auprc': 0.9957879434544351, 'loss_val': 0.34668292976033005, 'psi': 0.8911572961380785}
[S16] START round=20 head_norm_before_train=1.468414 cos_to_last_merge=0.7811 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.781
[S16] round=20 local utility u=1.000000 metrics={'f1_val': 0.922458435180587, 'auprc': 0.9516376145286374, 'loss_val': 0.4390763305705301, 'psi': 0.9341301069198071}-{'f1_val': 0.5353990526951764, 'auprc': 0.7970217049892419, 'loss_val': 1.0429475515023547, 'psi': 0.6400481136128027}
[S17] START round=20 head_norm_before_train=1.668563 (no previous merge yet)
[S17] round=20 local utility u=0.109898 metrics={'f1_val': 0.6531028222971843, 'auprc': 0.816224567573513, 'loss_val': 0.5775172355695917, 'psi': 0.7183515204077158}-{'f1_val': 0.5785413987272828, 'auprc': 0.9174186054051635, 'loss_val': 0.6535264288553132, 'psi': 0.7140922813984352}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.725)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.626)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:61805
[S2] not sending this round → trigger blocked (psi=0.839)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61813
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:61802
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.144014)
[S11] loaded HEAD from S9 (vec_in norm=1.144014)
[S11] cosine check vs S9: cos=-0.1323
[S11] DROPPED delta from S9 (cos=-0.1323 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.664436)
[S5] loaded HEAD from S11 (vec_in norm=1.664436)
[S5] cosine check vs S11: cos=0.7409
[S5] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.522149)
[S4] loaded HEAD from S10 (vec_in norm=1.522149)
[S4] cosine check vs S10: cos=-0.0643
[S4] DROPPED delta from S10 (cos=-0.0643 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.752237)
[S13] loaded HEAD from S3 (vec_in norm=1.752237)
[S13] cosine check vs S3: cos=0.6943
[S13] BUFFERED delta from S3 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1801) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.497842)
[S2] loaded HEAD from S16 (vec_in norm=1.497842)
[S2] cosine check vs S16: cos=-0.1095
[S2] DROPPED delta from S16 (cos=-0.1095 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.698697)
[S13] loaded HEAD from S17 (vec_in norm=1.698697)
[S13] cosine check vs S17: cos=0.5966
[S13] BUFFERED delta from S17 (total buffered=2)
[S7] ⇄ pheromone p=0.215 → S8@127.0.0.1:61809
[S8] ⇄ pheromone p=0.143 → S15@127.0.0.1:61815
[S14] ⇄ pheromone p=0.109 → S7@127.0.0.1:61808
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.5976 head_norm=0.980295
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.873530e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.5976 head_norm=1.084288 delta_norm=0.287353
[S13] aggregate: ACCEPT kept=['S3', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.122 → S7@127.0.0.1:61808
[S6] ⇄ pheromone p=0.270 → S5@127.0.0.1:61805
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.5326 head_norm=1.122277
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.616857e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.5684 head_norm=1.303624 delta_norm=0.561686
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.180 → S13@127.0.0.1:61813
[S2] ⇄ pheromone p=0.169 → S4@127.0.0.1:61804
[S4] ⇄ pheromone p=0.078 → S11@127.0.0.1:61812
[S9] ⇄ pheromone p=0.045 → S11@127.0.0.1:61812
[S11] ⇄ pheromone p=0.226 → S5@127.0.0.1:61805
[S16] ⇄ pheromone p=0.369 → S2@127.0.0.1:61802
[S3] ⇄ pheromone p=0.067 → S13@127.0.0.1:61813
[S10] ⇄ pheromone p=0.268 → S4@127.0.0.1:61804
[S15] ⇄ pheromone p=0.220 → S9@127.0.0.1:61810
[S17] ⇄ pheromone p=0.185 → S13@127.0.0.1:61813
[S2] START round=21 head_norm_before_train=1.816071 (no previous merge yet)
[S2] round=21 local utility u=0.058367 metrics={'f1_val': 0.8322702885586017, 'auprc': 0.9126259790922985, 'loss_val': 0.3591071000736479, 'psi': 0.8644125647720804}-{'f1_val': 0.8434959663499244, 'auprc': 0.8318525087898958, 'loss_val': 0.300875211377144, 'psi': 0.838838583325913}
[S3] START round=21 head_norm_before_train=1.752237 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.99511236901719, 'loss_val': 0.26022674081148545, 'psi': 0.8184986698480559}-{'f1_val': 0.7007562037352997, 'auprc': 0.9950781341094432, 'loss_val': 0.25991885010963844, 'psi': 0.8184849758849571}
[S4] START round=21 head_norm_before_train=1.778044 cos_to_last_merge=0.9998 (last merge round=19)
[S4] round=21 local utility u=0.038857 metrics={'f1_val': 0.6225385300336855, 'auprc': 0.9480278529461903, 'loss_val': 0.45473980559399585, 'psi': 0.7527342591986874}-{'f1_val': 0.615707063451578, 'auprc': 0.9455214345990535, 'loss_val': 0.4839449205780343, 'psi': 0.7476328119105682}
[S5] START round=21 head_norm_before_train=1.303624 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=1.000000 metrics={'f1_val': 0.7000733451188393, 'auprc': 0.9900340897931932, 'loss_val': 0.4695275483942379, 'psi': 0.8160576429885809}-{'f1_val': 0.5326037501927507, 'auprc': 0.7487146903126505, 'loss_val': 0.7658033453148791, 'psi': 0.6190481262407106}
[S6] START round=21 head_norm_before_train=1.470146 cos_to_last_merge=0.8421 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.842
[S6] round=21 local utility u=0.485031 metrics={'f1_val': 0.8230526260742286, 'auprc': 0.9657824393240846, 'loss_val': 0.27195355783692643, 'psi': 0.880144551374171}-{'f1_val': 0.7779927041104475, 'auprc': 0.8112803563718715, 'loss_val': 0.5081496866371785, 'psi': 0.7913077650150171}
[S7] START round=21 head_norm_before_train=0.939983 cos_to_last_merge=0.9983 (last merge round=19)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.5989012716001105, 'auprc': 0.8191109930097238, 'loss_val': 0.7420289163530336, 'psi': 0.6869851601639558}-{'f1_val': 0.6410116475199074, 'auprc': 0.8515017872413779, 'loss_val': 0.6651752666274329, 'psi': 0.7252077034084956}
[S8] START round=21 head_norm_before_train=0.982473 cos_to_last_merge=0.9972 (last merge round=19)
[S8] round=21 local utility u=0.029170 metrics={'f1_val': 0.9932775562128633, 'auprc': 0.9877325584369685, 'loss_val': 0.21426659903889478, 'psi': 0.9910595571025054}-{'f1_val': 0.9944013360228022, 'auprc': 0.988420065863086, 'loss_val': 0.2814108235385045, 'psi': 0.9920088279589157}
[S9] START round=21 head_norm_before_train=1.144014 cos_to_last_merge=0.9976 (last merge round=18)
[S9] round=21 local utility u=0.007257 metrics={'f1_val': 0.7010401564543445, 'auprc': 0.9979108669347962, 'loss_val': 0.28859275072305024, 'psi': 0.8197884406465252}-{'f1_val': 0.7010401564543445, 'auprc': 0.997479776019579, 'loss_val': 0.30181285749607295, 'psi': 0.8196160042804383}
[S10] START round=21 head_norm_before_train=1.522149 cos_to_last_merge=0.8249 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.825
[S10] round=21 local utility u=0.003612 metrics={'f1_val': 0.9951279124444816, 'auprc': 0.9966594265630655, 'loss_val': 0.08941398435747566, 'psi': 0.9957405180919152}-{'f1_val': 0.9952143411512907, 'auprc': 0.9976245403842066, 'loss_val': 0.10005172689043568, 'psi': 0.9961784208444571}
[S11] START round=21 head_norm_before_train=1.664436 cos_to_last_merge=0.9995 (last merge round=19)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9501207977976791, 'auprc': 0.9966794836449266, 'loss_val': 0.2815617973682369, 'psi': 0.9687442721365781}-{'f1_val': 0.996305167468861, 'auprc': 0.9955283688180927, 'loss_val': 0.2590623039067515, 'psi': 0.9959944480085536}
[S13] START round=21 head_norm_before_train=1.084288 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.525784472580896, 'auprc': 0.6935736151035512, 'loss_val': 0.8910655487338383, 'psi': 0.5929001295899581}-{'f1_val': 0.5975526434914551, 'auprc': 0.6683288479985194, 'loss_val': 0.728402554956916, 'psi': 0.6258631252942808}
[S14] START round=21 head_norm_before_train=1.869869 (no previous merge yet)
[S14] round=21 local utility u=0.011579 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9988494475930813, 'loss_val': 0.04205867811588906, 'psi': 0.9977382839318316}-{'f1_val': 0.9975765414632514, 'auprc': 0.9954950906765749, 'loss_val': 0.058628476748834576, 'psi': 0.9967439611485808}
[S15] START round=21 head_norm_before_train=1.137682 cos_to_last_merge=0.9920 (last merge round=18)
[S15] round=21 local utility u=0.688686 metrics={'f1_val': 0.9923425454971697, 'auprc': 0.9990570875661458, 'loss_val': 0.15051313578200637, 'psi': 0.9950283623247601}-{'f1_val': 0.7892751596997577, 'auprc': 0.9897193029216642, 'loss_val': 0.28146674195440063, 'psi': 0.8694528169885203}
[S16] START round=21 head_norm_before_train=1.497842 cos_to_last_merge=0.7756 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.776
[S16] round=21 local utility u=0.225646 metrics={'f1_val': 0.9483262607797714, 'auprc': 0.9842328528234715, 'loss_val': 0.24077616416203654, 'psi': 0.9626888975972514}-{'f1_val': 0.922458435180587, 'auprc': 0.9516376145286374, 'loss_val': 0.4390763305705301, 'psi': 0.9341301069198071}
[S17] START round=21 head_norm_before_train=1.698697 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.5780725396446357, 'auprc': 0.8189830385584472, 'loss_val': 0.6453539673441256, 'psi': 0.6744367392101603}-{'f1_val': 0.6531028222971843, 'auprc': 0.816224567573513, 'loss_val': 0.5775172355695917, 'psi': 0.7183515204077158}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:61812
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:61805
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:61815
[S10] not sending this round → trigger blocked (psi=0.996)
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:61810
[S16] not sending this round → trigger blocked (psi=0.963)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.323638)
[S13] loaded HEAD from S5 (vec_in norm=1.323638)
[S13] cosine check vs S5: cos=0.1855
[S13] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.039741)
[S15] loaded HEAD from S8 (vec_in norm=1.039741)
[S15] cosine check vs S8: cos=0.8996
[S15] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1794) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.793924)
[S11] loaded HEAD from S4 (vec_in norm=1.793924)
[S11] cosine check vs S4: cos=0.9679
[S11] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.889305)
[S7] loaded HEAD from S14 (vec_in norm=1.889305)
[S7] cosine check vs S14: cos=0.7821
[S7] BUFFERED delta from S14 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.189819)
[S9] loaded HEAD from S15 (vec_in norm=1.189819)
[S9] cosine check vs S15: cos=0.9264
[S9] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.488350)
[S5] loaded HEAD from S6 (vec_in norm=1.488350)
[S5] cosine check vs S6: cos=0.2575
[S5] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.840566)
[S4] loaded HEAD from S2 (vec_in norm=1.840566)
[S4] cosine check vs S2: cos=0.9910
[S4] BUFFERED delta from S2 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.5258 head_norm=1.105518
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.796478e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.5369 head_norm=0.937680 delta_norm=0.779648
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.5989 head_norm=0.969226
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.412112e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.5670 head_norm=1.357676 delta_norm=0.641211
[S7] aggregate: ROLLBACK (f1_val pre=0.599 post=0.567 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9501 head_norm=1.690083
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.267432e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9210 head_norm=1.727964 delta_norm=0.226743
[S11] aggregate: ROLLBACK (f1_val pre=0.950 post=0.921 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.7010 head_norm=1.175899
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.270066e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.7010 head_norm=1.160892 delta_norm=0.227007
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.6225 head_norm=1.793924
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.239555e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.6182 head_norm=1.813163 delta_norm=0.123956
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.7001 head_norm=1.323638
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.591430e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.7003 head_norm=1.116008 delta_norm=0.859143
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.9923 head_norm=1.189819
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.602520e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.9926 head_norm=1.086570 delta_norm=0.260252
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.840566 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7311026033820964, 'auprc': 0.8089853461468917, 'loss_val': 0.4317105336560094, 'psi': 0.7622557004880145}-{'f1_val': 0.8322702885586017, 'auprc': 0.9126259790922985, 'loss_val': 0.3591071000736479, 'psi': 0.8644125647720804}
[S3] START round=22 head_norm_before_train=1.762885 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.99511298819574, 'loss_val': 0.26420774700565014, 'psi': 0.8185442362935824}-{'f1_val': 0.7007562037352997, 'auprc': 0.99511236901719, 'loss_val': 0.26022674081148545, 'psi': 0.8184986698480559}
[S4] START round=22 head_norm_before_train=1.813163 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.157508 metrics={'f1_val': 0.6695143367744518, 'auprc': 0.9475870626006277, 'loss_val': 0.4202569366217636, 'psi': 0.7807434271049222}-{'f1_val': 0.6225385300336855, 'auprc': 0.9480278529461903, 'loss_val': 0.45473980559399585, 'psi': 0.7527342591986874}
[S5] START round=22 head_norm_before_train=1.116008 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9063276409733241, 'loss_val': 0.4535211568179689, 'psi': 0.782723415484145}-{'f1_val': 0.7000733451188393, 'auprc': 0.9900340897931932, 'loss_val': 0.4695275483942379, 'psi': 0.8160576429885809}
[S6] START round=22 head_norm_before_train=1.488350 cos_to_last_merge=0.8393 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.839
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.8240533715109488, 'auprc': 0.9634316517814852, 'loss_val': 0.35466003835706056, 'psi': 0.8798046836191633}-{'f1_val': 0.8230526260742286, 'auprc': 0.9657824393240846, 'loss_val': 0.27195355783692643, 'psi': 0.880144551374171}
[S7] START round=22 head_norm_before_train=1.357676 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.463505 metrics={'f1_val': 0.6733012867243583, 'auprc': 0.8944728372654283, 'loss_val': 0.48750406827076004, 'psi': 0.7617699069407863}-{'f1_val': 0.5989012716001105, 'auprc': 0.8191109930097238, 'loss_val': 0.7420289163530336, 'psi': 0.6869851601639558}
[S8] START round=22 head_norm_before_train=1.039741 cos_to_last_merge=0.9907 (last merge round=19)
[S8] round=22 local utility u=0.030865 metrics={'f1_val': 0.9918532151771823, 'auprc': 0.9947375540983334, 'loss_val': 0.16500642413982777, 'psi': 0.9930069507456427}-{'f1_val': 0.9932775562128633, 'auprc': 0.9877325584369685, 'loss_val': 0.21426659903889478, 'psi': 0.9910595571025054}
[S9] START round=22 head_norm_before_train=1.160892 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9982668264416922, 'loss_val': 0.30594967283854285, 'psi': 0.8200810207012149}-{'f1_val': 0.7010401564543445, 'auprc': 0.9979108669347962, 'loss_val': 0.28859275072305024, 'psi': 0.8197884406465252}
[S10] START round=22 head_norm_before_train=1.537600 cos_to_last_merge=0.8234 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.823
[S10] round=22 local utility u=0.001730 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9962001541215014, 'loss_val': 0.0874661630997102, 'psi': 0.9958458537576125}-{'f1_val': 0.9951279124444816, 'auprc': 0.9966594265630655, 'loss_val': 0.08941398435747566, 'psi': 0.9957405180919152}
[S11] START round=22 head_norm_before_train=1.727964 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.171004 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9967404883511468, 'loss_val': 0.21829379978814975, 'psi': 0.9966243980486125}-{'f1_val': 0.9501207977976791, 'auprc': 0.9966794836449266, 'loss_val': 0.2815617973682369, 'psi': 0.9687442721365781}
[S13] START round=22 head_norm_before_train=0.937680 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.293995 metrics={'f1_val': 0.6145568059892406, 'auprc': 0.6589881793578396, 'loss_val': 0.7319538767660055, 'psi': 0.6323293553366802}-{'f1_val': 0.525784472580896, 'auprc': 0.6935736151035512, 'loss_val': 0.8910655487338383, 'psi': 0.5929001295899581}
[S14] START round=22 head_norm_before_train=1.889305 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9642987995902876, 'auprc': 0.9957210978018778, 'loss_val': 0.06479320651604982, 'psi': 0.9768677188749237}-{'f1_val': 0.9969975081576651, 'auprc': 0.9988494475930813, 'loss_val': 0.04205867811588906, 'psi': 0.9977382839318316}
[S15] START round=22 head_norm_before_train=1.086570 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.9903820158877099, 'auprc': 0.9969117020533611, 'loss_val': 0.20350264290744655, 'psi': 0.9929938903539703}-{'f1_val': 0.9923425454971697, 'auprc': 0.9990570875661458, 'loss_val': 0.15051313578200637, 'psi': 0.9950283623247601}
[S16] START round=22 head_norm_before_train=1.529204 cos_to_last_merge=0.7705 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.770
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.9348253946139325, 'auprc': 0.9810781620226231, 'loss_val': 0.3649569912918908, 'psi': 0.9533265015774088}-{'f1_val': 0.9483262607797714, 'auprc': 0.9842328528234715, 'loss_val': 0.24077616416203654, 'psi': 0.9626888975972514}
[S17] START round=22 head_norm_before_train=1.730624 (no previous merge yet)
[S17] round=22 local utility u=0.170092 metrics={'f1_val': 0.6504455161034441, 'auprc': 0.8101700789200179, 'loss_val': 0.7129694236456434, 'psi': 0.7143353412300737}-{'f1_val': 0.5780725396446357, 'auprc': 0.8189830385584472, 'loss_val': 0.6453539673441256, 'psi': 0.6744367392101603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61808
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.781)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:61805
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.993)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.379288)
[S8] loaded HEAD from S7 (vec_in norm=1.379288)
[S8] cosine check vs S7: cos=0.7467
[S8] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.962273)
[S7] loaded HEAD from S13 (vec_in norm=0.962273)
[S7] cosine check vs S13: cos=0.0785
[S7] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.749871)
[S5] loaded HEAD from S11 (vec_in norm=1.749871)
[S5] cosine check vs S11: cos=0.5295
[S5] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.555221)
[S4] loaded HEAD from S10 (vec_in norm=1.555221)
[S4] cosine check vs S10: cos=-0.0607
[S4] DROPPED delta from S10 (cos=-0.0607 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.762769)
[S13] loaded HEAD from S17 (vec_in norm=1.762769)
[S13] cosine check vs S17: cos=0.4092
[S13] BUFFERED delta from S17 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7003 head_norm=1.143095
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.501021e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7001 head_norm=1.273462 delta_norm=0.750102
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9919 head_norm=1.090733
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.597154e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9909 head_norm=1.155305 delta_norm=0.459715
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.6733 head_norm=1.379288
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.093401e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.6791 head_norm=0.871304 delta_norm=0.809340
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.6146 head_norm=0.962273
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.132084e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.6156 head_norm=1.164197 delta_norm=0.813208
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.865583 (no previous merge yet)
[S2] round=23 local utility u=0.460252 metrics={'f1_val': 0.8343289397090933, 'auprc': 0.8836236762585837, 'loss_val': 0.354479632366731, 'psi': 0.8540468343288894}-{'f1_val': 0.7311026033820964, 'auprc': 0.8089853461468917, 'loss_val': 0.4317105336560094, 'psi': 0.7622557004880145}
[S3] START round=23 head_norm_before_train=1.775564 (no previous merge yet)
[S3] round=23 local utility u=0.005710 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.994934954375571, 'loss_val': 0.2518007291601793, 'psi': 0.8184277039914082}-{'f1_val': 0.7008317350254774, 'auprc': 0.99511298819574, 'loss_val': 0.26420774700565014, 'psi': 0.8185442362935824}
[S4] START round=23 head_norm_before_train=1.828345 cos_to_last_merge=0.9998 (last merge round=21)
[S4] round=23 local utility u=0.868323 metrics={'f1_val': 0.9445224467691824, 'auprc': 0.9560098553109496, 'loss_val': 0.3589284576345504, 'psi': 0.9491174101858894}-{'f1_val': 0.6695143367744518, 'auprc': 0.9475870626006277, 'loss_val': 0.4202569366217636, 'psi': 0.7807434271049222}
[S5] START round=23 head_norm_before_train=1.273462 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.143689 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9917821251681443, 'loss_val': 0.42251043521677634, 'psi': 0.8169056405276061}-{'f1_val': 0.700320598491359, 'auprc': 0.9063276409733241, 'loss_val': 0.4535211568179689, 'psi': 0.782723415484145}
[S6] START round=23 head_norm_before_train=1.508808 cos_to_last_merge=0.8365 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.836
[S6] round=23 local utility u=0.602050 metrics={'f1_val': 0.9826293228066864, 'auprc': 0.9707918971748903, 'loss_val': 0.12409722660324322, 'psi': 0.9778943525539678}-{'f1_val': 0.8240533715109488, 'auprc': 0.9634316517814852, 'loss_val': 0.35466003835706056, 'psi': 0.8798046836191633}
[S7] START round=23 head_norm_before_train=0.871304 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.583568947263337, 'auprc': 0.7983622378019699, 'loss_val': 0.8667863045957832, 'psi': 0.6694862634787901}-{'f1_val': 0.6733012867243583, 'auprc': 0.8944728372654283, 'loss_val': 0.48750406827076004, 'psi': 0.7617699069407863}
[S8] START round=23 head_norm_before_train=1.155305 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9935462653440466, 'auprc': 0.9801133415591565, 'loss_val': 0.24418736655039813, 'psi': 0.9881730958300905}-{'f1_val': 0.9918532151771823, 'auprc': 0.9947375540983334, 'loss_val': 0.16500642413982777, 'psi': 0.9930069507456427}
[S9] START round=23 head_norm_before_train=1.188584 cos_to_last_merge=0.9995 (last merge round=21)
[S9] round=23 local utility u=0.007311 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9979141893365309, 'loss_val': 0.29026934449421327, 'psi': 0.8199399658591504}-{'f1_val': 0.7012904835408967, 'auprc': 0.9982668264416922, 'loss_val': 0.30594967283854285, 'psi': 0.8200810207012149}
[S10] START round=23 head_norm_before_train=1.555221 cos_to_last_merge=0.8219 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.822
[S10] round=23 local utility u=0.000904 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9962408736633324, 'loss_val': 0.08577964433163014, 'psi': 0.9958621415743448}-{'f1_val': 0.9956096535150197, 'auprc': 0.9962001541215014, 'loss_val': 0.0874661630997102, 'psi': 0.9958458537576125}
[S11] START round=23 head_norm_before_train=1.749871 cos_to_last_merge=0.9992 (last merge round=21)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9809557750840786, 'auprc': 0.9978177085856543, 'loss_val': 0.20429533628687296, 'psi': 0.9877005484847089}-{'f1_val': 0.9965470045135896, 'auprc': 0.9967404883511468, 'loss_val': 0.21829379978814975, 'psi': 0.9966243980486125}
[S13] START round=23 head_norm_before_train=1.164197 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5407424619656132, 'auprc': 0.6580678597636381, 'loss_val': 0.99820480730758, 'psi': 0.5876726210848231}-{'f1_val': 0.6145568059892406, 'auprc': 0.6589881793578396, 'loss_val': 0.7319538767660055, 'psi': 0.6323293553366802}
[S14] START round=23 head_norm_before_train=1.909293 (no previous merge yet)
[S14] round=23 local utility u=0.109257 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9964654979622103, 'loss_val': 0.04078488438156412, 'psi': 0.996392752248954}-{'f1_val': 0.9642987995902876, 'auprc': 0.9957210978018778, 'loss_val': 0.06479320651604982, 'psi': 0.9768677188749237}
[S15] START round=23 head_norm_before_train=1.134173 cos_to_last_merge=0.9987 (last merge round=21)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.9122528900104387, 'auprc': 0.9968838662257503, 'loss_val': 0.18835896612253267, 'psi': 0.9461052804965634}-{'f1_val': 0.9903820158877099, 'auprc': 0.9969117020533611, 'loss_val': 0.20350264290744655, 'psi': 0.9929938903539703}
[S16] START round=23 head_norm_before_train=1.562423 cos_to_last_merge=0.7654 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.765
[S16] round=23 local utility u=0.292050 metrics={'f1_val': 0.9894940956185294, 'auprc': 0.9856439253938027, 'loss_val': 0.12256699981761394, 'psi': 0.9879540275286387}-{'f1_val': 0.9348253946139325, 'auprc': 0.9810781620226231, 'loss_val': 0.3649569912918908, 'psi': 0.9533265015774088}
[S17] START round=23 head_norm_before_train=1.762769 (no previous merge yet)
[S17] round=23 local utility u=0.131732 metrics={'f1_val': 0.6402358594169826, 'auprc': 0.8900882572984086, 'loss_val': 0.6280019737631254, 'psi': 0.740176818569553}-{'f1_val': 0.6504455161034441, 'auprc': 0.8101700789200179, 'loss_val': 0.7129694236456434, 'psi': 0.7143353412300737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:61805
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[S10] not sending this round → trigger blocked (psi=0.996)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:61813
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.884404)
[S4] loaded HEAD from S2 (vec_in norm=1.884404)
[S4] cosine check vs S2: cos=0.9936
[S4] BUFFERED delta from S2 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.594963)
[S2] loaded HEAD from S16 (vec_in norm=1.594963)
[S2] cosine check vs S16: cos=-0.1110
[S2] DROPPED delta from S16 (cos=-0.1110 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1796) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.296057)
[S13] loaded HEAD from S5 (vec_in norm=1.296057)
[S13] cosine check vs S5: cos=0.3374
[S13] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.846621)
[S11] loaded HEAD from S4 (vec_in norm=1.846621)
[S11] cosine check vs S4: cos=0.9767
[S11] BUFFERED delta from S4 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.217477)
[S11] loaded HEAD from S9 (vec_in norm=1.217477)
[S11] cosine check vs S9: cos=-0.1178
[S11] DROPPED delta from S9 (cos=-0.1178 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.929786)
[S7] loaded HEAD from S14 (vec_in norm=1.929786)
[S7] cosine check vs S14: cos=0.7157
[S7] BUFFERED delta from S14 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.789306)
[S13] loaded HEAD from S3 (vec_in norm=1.789306)
[S13] cosine check vs S3: cos=0.2308
[S13] BUFFERED delta from S3 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1799) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.527198)
[S5] loaded HEAD from S6 (vec_in norm=1.527198)
[S5] cosine check vs S6: cos=0.3565
[S5] BUFFERED delta from S6 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.740)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9810 head_norm=1.779255
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.983965e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9519 head_norm=1.802364 delta_norm=0.198397
[S11] aggregate: ROLLBACK (f1_val pre=0.981 post=0.952 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.5407 head_norm=1.187646
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.372060e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.5394 head_norm=0.954418 delta_norm=0.637206
[S13] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.5836 head_norm=0.890584
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.171528e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.5168 head_norm=1.320719 delta_norm=0.717153
[S7] aggregate: ROLLBACK (f1_val pre=0.584 post=0.517 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.7003 head_norm=1.296057
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.063714e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.7003 head_norm=1.164394 delta_norm=0.806371
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9445 head_norm=1.846621
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.075854e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9088 head_norm=1.862504 delta_norm=0.107585
[S4] aggregate: ROLLBACK (f1_val pre=0.945 post=0.909 tol_abs=0.005 tol_rel=0.0)
[S2] START round=24 head_norm_before_train=1.884404 (no previous merge yet)
[S2] round=24 local utility u=0.014568 metrics={'f1_val': 0.8319540775612623, 'auprc': 0.9078142085626256, 'loss_val': 0.3836669939365559, 'psi': 0.8622981299618075}-{'f1_val': 0.8343289397090933, 'auprc': 0.8836236762585837, 'loss_val': 0.354479632366731, 'psi': 0.8540468343288894}
[S3] START round=24 head_norm_before_train=1.789306 (no previous merge yet)
[S3] round=24 local utility u=0.019288 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9973332517274224, 'loss_val': 0.22041903907448743, 'psi': 0.8193870229321487}-{'f1_val': 0.7007562037352997, 'auprc': 0.994934954375571, 'loss_val': 0.2518007291601793, 'psi': 0.8184277039914082}
[S4] START round=24 head_norm_before_train=1.862504 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.047895 metrics={'f1_val': 0.9460883479464334, 'auprc': 0.9582817014860538, 'loss_val': 0.279348472262168, 'psi': 0.9509656893622815}-{'f1_val': 0.9445224467691824, 'auprc': 0.9560098553109496, 'loss_val': 0.3589284576345504, 'psi': 0.9491174101858894}
[S5] START round=24 head_norm_before_train=1.164394 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8537736206453341, 'loss_val': 0.8124540397112524, 'psi': 0.6035691865613568}-{'f1_val': 0.7003213174339138, 'auprc': 0.9917821251681443, 'loss_val': 0.42251043521677634, 'psi': 0.8169056405276061}
[S6] START round=24 head_norm_before_train=1.527198 cos_to_last_merge=0.8339 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.834
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.597499089096492, 'auprc': 0.8231996675106175, 'loss_val': 0.7915482032329029, 'psi': 0.6877793204621422}-{'f1_val': 0.9826293228066864, 'auprc': 0.9707918971748903, 'loss_val': 0.12409722660324322, 'psi': 0.9778943525539678}
[S7] START round=24 head_norm_before_train=1.320719 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.720418 metrics={'f1_val': 0.6839344181901571, 'auprc': 0.9419453966222638, 'loss_val': 0.45889315436268, 'psi': 0.7871388095629999}-{'f1_val': 0.583568947263337, 'auprc': 0.7983622378019699, 'loss_val': 0.8667863045957832, 'psi': 0.6694862634787901}
[S8] START round=24 head_norm_before_train=1.195355 cos_to_last_merge=0.9985 (last merge round=22)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.7217364429925772, 'auprc': 0.9786334330701961, 'loss_val': 0.30138165251570104, 'psi': 0.8244952390236249}-{'f1_val': 0.9935462653440466, 'auprc': 0.9801133415591565, 'loss_val': 0.24418736655039813, 'psi': 0.9881730958300905}
[S9] START round=24 head_norm_before_train=1.217477 cos_to_last_merge=0.9983 (last merge round=21)
[S9] round=24 local utility u=0.016838 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9982108758573156, 'loss_val': 0.2574830298879557, 'psi': 0.8200586404674644}-{'f1_val': 0.7012904835408967, 'auprc': 0.9979141893365309, 'loss_val': 0.29026934449421327, 'psi': 0.8199399658591504}
[S10] START round=24 head_norm_before_train=1.576194 cos_to_last_merge=0.8201 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.820
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9934779232119333, 'loss_val': 0.11349863228391187, 'psi': 0.9947569613937852}-{'f1_val': 0.9956096535150197, 'auprc': 0.9962408736633324, 'loss_val': 0.08577964433163014, 'psi': 0.9958621415743448}
[S11] START round=24 head_norm_before_train=1.802364 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.073663 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9974607798072488, 'loss_val': 0.14944668152474097, 'psi': 0.9969125146310532}-{'f1_val': 0.9809557750840786, 'auprc': 0.9978177085856543, 'loss_val': 0.20429533628687296, 'psi': 0.9877005484847089}
[S13] START round=24 head_norm_before_train=0.954418 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.185143 metrics={'f1_val': 0.58666378505764, 'auprc': 0.6228798647254584, 'loss_val': 0.7978821938482882, 'psi': 0.6011502169247674}-{'f1_val': 0.5407424619656132, 'auprc': 0.6580678597636381, 'loss_val': 0.99820480730758, 'psi': 0.5876726210848231}
[S14] START round=24 head_norm_before_train=1.929786 (no previous merge yet)
[S14] round=24 local utility u=0.009389 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9988498713264958, 'loss_val': 0.033079247414320126, 'psi': 0.9977384534251974}-{'f1_val': 0.9963442551067831, 'auprc': 0.9964654979622103, 'loss_val': 0.04078488438156412, 'psi': 0.996392752248954}
[S15] START round=24 head_norm_before_train=1.186862 cos_to_last_merge=0.9954 (last merge round=21)
[S15] round=24 local utility u=0.253006 metrics={'f1_val': 0.9853806569964317, 'auprc': 0.9974135293007724, 'loss_val': 0.12270158775091074, 'psi': 0.990193805918168}-{'f1_val': 0.9122528900104387, 'auprc': 0.9968838662257503, 'loss_val': 0.18835896612253267, 'psi': 0.9461052804965634}
[S16] START round=24 head_norm_before_train=1.594963 cos_to_last_merge=0.7613 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.761
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8913453720721409, 'auprc': 0.9912140205987929, 'loss_val': 0.5156709761837699, 'psi': 0.9312928314828017}-{'f1_val': 0.9894940956185294, 'auprc': 0.9856439253938027, 'loss_val': 0.12256699981761394, 'psi': 0.9879540275286387}
[S17] START round=24 head_norm_before_train=1.794985 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.582540130603209, 'auprc': 0.9575216748745856, 'loss_val': 0.7464776577700554, 'psi': 0.7325327483117596}-{'f1_val': 0.6402358594169826, 'auprc': 0.8900882572984086, 'loss_val': 0.6280019737631254, 'psi': 0.740176818569553}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.862)
[S9] not sending this round → trigger blocked (psi=0.820)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61808
[S4] not sending this round → trigger blocked (psi=0.951)
[S3] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61809
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:61805
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:61810
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.235626)
[S9] loaded HEAD from S15 (vec_in norm=1.235626)
[S9] cosine check vs S15: cos=0.9445
[S9] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.830386)
[S5] loaded HEAD from S11 (vec_in norm=1.830386)
[S5] cosine check vs S11: cos=0.4789
[S5] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.338321)
[S8] loaded HEAD from S7 (vec_in norm=1.338321)
[S8] cosine check vs S7: cos=0.8996
[S8] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.983315)
[S7] loaded HEAD from S13 (vec_in norm=0.983315)
[S7] cosine check vs S13: cos=0.1196
[S7] BUFFERED delta from S13 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.7013 head_norm=1.246155
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.067756e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.7013 head_norm=1.223553 delta_norm=0.206776
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.7217 head_norm=1.239316
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.927166e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.7850 head_norm=1.256113 delta_norm=0.292717
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.4368 head_norm=1.189222
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.185040e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.4366 head_norm=1.308561 delta_norm=0.818504
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.6839 head_norm=1.338321
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.815524e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.6898 head_norm=0.876460 delta_norm=0.781552
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.901204 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.7259305153856241, 'auprc': 0.8032887800248263, 'loss_val': 0.6205541135678313, 'psi': 0.756873821241305}-{'f1_val': 0.8319540775612623, 'auprc': 0.9078142085626256, 'loss_val': 0.3836669939365559, 'psi': 0.8622981299618075}
[S3] START round=25 head_norm_before_train=1.803727 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9981973140657023, 'loss_val': 0.25033390820123064, 'psi': 0.8197326478674607}-{'f1_val': 0.7007562037352997, 'auprc': 0.9973332517274224, 'loss_val': 0.22041903907448743, 'psi': 0.8193870229321487}
[S4] START round=25 head_norm_before_train=1.884479 cos_to_last_merge=0.9998 (last merge round=23)
[S4] round=25 local utility u=0.049505 metrics={'f1_val': 0.9554510306023324, 'auprc': 0.9638007835394182, 'loss_val': 0.2530718302653562, 'psi': 0.9587909317771667}-{'f1_val': 0.9460883479464334, 'auprc': 0.9582817014860538, 'loss_val': 0.279348472262168, 'psi': 0.9509656893622815}
[S5] START round=25 head_norm_before_train=1.308561 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=1.000000 metrics={'f1_val': 0.7000733451188393, 'auprc': 0.965121334034632, 'loss_val': 0.45530327404949056, 'psi': 0.8060925406851565}-{'f1_val': 0.43676623050537206, 'auprc': 0.8537736206453341, 'loss_val': 0.8124540397112524, 'psi': 0.6035691865613568}
[S6] START round=25 head_norm_before_train=1.541027 cos_to_last_merge=0.8319 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.832
[S6] round=25 local utility u=1.000000 metrics={'f1_val': 0.8474974087606156, 'auprc': 0.9664486465970744, 'loss_val': 0.2816701624514053, 'psi': 0.8950779038951991}-{'f1_val': 0.597499089096492, 'auprc': 0.8231996675106175, 'loss_val': 0.7915482032329029, 'psi': 0.6877793204621422}
[S7] START round=25 head_norm_before_train=0.876460 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.4684103105639092, 'auprc': 0.7695712156186985, 'loss_val': 0.9589439236710532, 'psi': 0.5888746725858249}-{'f1_val': 0.6839344181901571, 'auprc': 0.9419453966222638, 'loss_val': 0.45889315436268, 'psi': 0.7871388095629999}
[S8] START round=25 head_norm_before_train=1.256113 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.732668 metrics={'f1_val': 0.9649009841450358, 'auprc': 0.987670906716893, 'loss_val': 0.322145971154911, 'psi': 0.9740089531737786}-{'f1_val': 0.7217364429925772, 'auprc': 0.9786334330701961, 'loss_val': 0.30138165251570104, 'psi': 0.8244952390236249}
[S9] START round=25 head_norm_before_train=1.223553 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9986886250381111, 'loss_val': 0.26041636434220805, 'psi': 0.8202497401397825}-{'f1_val': 0.7012904835408967, 'auprc': 0.9982108758573156, 'loss_val': 0.2574830298879557, 'psi': 0.8200586404674644}
[S10] START round=25 head_norm_before_train=1.600091 cos_to_last_merge=0.8177 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.818
[S10] round=25 local utility u=0.030547 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9965451676935149, 'loss_val': 0.06110440509961881, 'psi': 0.995933612031873}-{'f1_val': 0.9956096535150197, 'auprc': 0.9934779232119333, 'loss_val': 0.11349863228391187, 'psi': 0.9947569613937852}
[S11] START round=25 head_norm_before_train=1.830386 cos_to_last_merge=0.9990 (last merge round=23)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9906712181958396, 'auprc': 0.9977671528294847, 'loss_val': 0.12717052604800416, 'psi': 0.9935095920492976}-{'f1_val': 0.9965470045135896, 'auprc': 0.9974607798072488, 'loss_val': 0.14944668152474097, 'psi': 0.9969125146310532}
[S13] START round=25 head_norm_before_train=0.983315 cos_to_last_merge=0.9985 (last merge round=23)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.5589079918536877, 'auprc': 0.6836630425403649, 'loss_val': 0.8314588529692031, 'psi': 0.6088100121283586}-{'f1_val': 0.58666378505764, 'auprc': 0.6228798647254584, 'loss_val': 0.7978821938482882, 'psi': 0.6011502169247674}
[S14] START round=25 head_norm_before_train=1.947261 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9956322635225232, 'loss_val': 0.031833403106130524, 'psi': 0.9966978671100446}-{'f1_val': 0.9969975081576651, 'auprc': 0.9988498713264958, 'loss_val': 0.033079247414320126, 'psi': 0.9977384534251974}
[S15] START round=25 head_norm_before_train=1.235626 cos_to_last_merge=0.9915 (last merge round=21)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.9664471282967964, 'auprc': 0.9970179409042241, 'loss_val': 0.11877296616240568, 'psi': 0.9786754533397675}-{'f1_val': 0.9853806569964317, 'auprc': 0.9974135293007724, 'loss_val': 0.12270158775091074, 'psi': 0.990193805918168}
[S16] START round=25 head_norm_before_train=1.626905 cos_to_last_merge=0.7567 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.757
[S16] round=25 local utility u=0.034600 metrics={'f1_val': 0.8930152688144953, 'auprc': 0.9922597245796598, 'loss_val': 0.4596284089258601, 'psi': 0.9327130511205611}-{'f1_val': 0.8913453720721409, 'auprc': 0.9912140205987929, 'loss_val': 0.5156709761837699, 'psi': 0.9312928314828017}
[S17] START round=25 head_norm_before_train=1.821713 (no previous merge yet)
[S17] round=25 local utility u=0.067819 metrics={'f1_val': 0.6018166609110323, 'auprc': 0.9523036504516085, 'loss_val': 0.7108446879604908, 'psi': 0.7420114567272628}-{'f1_val': 0.582540130603209, 'auprc': 0.9575216748745856, 'loss_val': 0.7464776577700554, 'psi': 0.7325327483117596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:61812
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:61804
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:61805
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1804) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.655803)
[S2] loaded HEAD from S16 (vec_in norm=1.655803)
[S2] cosine check vs S16: cos=-0.1112
[S2] DROPPED delta from S16 (cos=-0.1112 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.287170)
[S15] loaded HEAD from S8 (vec_in norm=1.287170)
[S15] cosine check vs S8: cos=0.8104
[S15] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.904914)
[S11] loaded HEAD from S4 (vec_in norm=1.904914)
[S11] cosine check vs S4: cos=0.9809
[S11] BUFFERED delta from S4 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1799) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.326500)
[S13] loaded HEAD from S5 (vec_in norm=1.326500)
[S13] cosine check vs S5: cos=0.5199
[S13] BUFFERED delta from S5 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.553760)
[S5] loaded HEAD from S6 (vec_in norm=1.553760)
[S5] cosine check vs S6: cos=0.3676
[S5] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.624810)
[S4] loaded HEAD from S10 (vec_in norm=1.624810)
[S4] cosine check vs S10: cos=-0.0557
[S4] DROPPED delta from S10 (cos=-0.0557 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.844732)
[S13] loaded HEAD from S17 (vec_in norm=1.844732)
[S13] cosine check vs S17: cos=0.5766
[S13] BUFFERED delta from S17 (total buffered=2)
[S9] ⇄ pheromone p=0.019 → S11@127.0.0.1:61812
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9907 head_norm=1.858834
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.852900e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9896 head_norm=1.872872 delta_norm=0.185290
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.103 → S5@127.0.0.1:61805
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.5589 head_norm=1.008428
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.685858e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.5590 head_norm=1.009894 delta_norm=0.368586
[S13] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.100 → S7@127.0.0.1:61808
[S2] ⇄ pheromone p=0.122 → S4@127.0.0.1:61804
[S3] ⇄ pheromone p=0.026 → S13@127.0.0.1:61813
[S14] ⇄ pheromone p=0.052 → S7@127.0.0.1:61808
[S7] ⇄ pheromone p=0.233 → S8@127.0.0.1:61809
[S10] ⇄ pheromone p=0.095 → S4@127.0.0.1:61804
[S8] ⇄ pheromone p=0.199 → S15@127.0.0.1:61815
[S6] ⇄ pheromone p=0.405 → S5@127.0.0.1:61805
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.7001 head_norm=1.326500
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.152720e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.7003 head_norm=1.192567 delta_norm=0.815272
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.359 → S13@127.0.0.1:61813
[S16] ⇄ pheromone p=0.184 → S2@127.0.0.1:61802
[S4] ⇄ pheromone p=0.174 → S11@127.0.0.1:61812
[S17] ⇄ pheromone p=0.109 → S13@127.0.0.1:61813
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.9664 head_norm=1.275544
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.945752e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.9646 head_norm=1.219107 delta_norm=0.394575
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.169 → S9@127.0.0.1:61810
[S2] START round=26 head_norm_before_train=1.915756 (no previous merge yet)
[S2] round=26 local utility u=0.566891 metrics={'f1_val': 0.8274164050585436, 'auprc': 0.9223509766806781, 'loss_val': 0.45287431104703796, 'psi': 0.8653902337073974}-{'f1_val': 0.7259305153856241, 'auprc': 0.8032887800248263, 'loss_val': 0.6205541135678313, 'psi': 0.756873821241305}
[S3] START round=26 head_norm_before_train=1.819229 (no previous merge yet)
[S3] round=26 local utility u=0.627841 metrics={'f1_val': 0.9079756720404915, 'auprc': 0.9984917237986632, 'loss_val': 0.2388521361605228, 'psi': 0.9441820927437601}-{'f1_val': 0.7007562037352997, 'auprc': 0.9981973140657023, 'loss_val': 0.25033390820123064, 'psi': 0.8197326478674607}
[S4] START round=26 head_norm_before_train=1.904914 cos_to_last_merge=0.9992 (last merge round=23)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9458874059518223, 'auprc': 0.9662489824617583, 'loss_val': 0.2634064823073804, 'psi': 0.9540320365557966}-{'f1_val': 0.9554510306023324, 'auprc': 0.9638007835394182, 'loss_val': 0.2530718302653562, 'psi': 0.9587909317771667}
[S5] START round=26 head_norm_before_train=1.192567 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.6411228106573237, 'auprc': 0.8560419869460645, 'loss_val': 0.5323192403465191, 'psi': 0.72709048117282}-{'f1_val': 0.7000733451188393, 'auprc': 0.965121334034632, 'loss_val': 0.45530327404949056, 'psi': 0.8060925406851565}
[S6] START round=26 head_norm_before_train=1.553760 cos_to_last_merge=0.8302 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.830
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.7219882549101553, 'auprc': 0.955770203706267, 'loss_val': 0.5881087768601971, 'psi': 0.8155010344286}-{'f1_val': 0.8474974087606156, 'auprc': 0.9664486465970744, 'loss_val': 0.2816701624514053, 'psi': 0.8950779038951991}
[S7] START round=26 head_norm_before_train=0.899802 cos_to_last_merge=0.9986 (last merge round=24)
[S7] round=26 local utility u=0.523229 metrics={'f1_val': 0.5924808208556323, 'auprc': 0.8109176881569746, 'loss_val': 0.7809490266558721, 'psi': 0.6798555677761692}-{'f1_val': 0.4684103105639092, 'auprc': 0.7695712156186985, 'loss_val': 0.9589439236710532, 'psi': 0.5888746725858249}
[S8] START round=26 head_norm_before_train=1.287170 cos_to_last_merge=0.9985 (last merge round=24)
[S8] round=26 local utility u=0.133548 metrics={'f1_val': 0.9930910663870046, 'auprc': 0.9810059740433735, 'loss_val': 0.20419550039675508, 'psi': 0.9882570294495522}-{'f1_val': 0.9649009841450358, 'auprc': 0.987670906716893, 'loss_val': 0.322145971154911, 'psi': 0.9740089531737786}
[S9] START round=26 head_norm_before_train=1.249859 cos_to_last_merge=0.9996 (last merge round=24)
[S9] round=26 local utility u=0.912857 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9981801360061197, 'loss_val': 0.18788673189772692, 'psi': 0.995517359396273}-{'f1_val': 0.7012904835408967, 'auprc': 0.9986886250381111, 'loss_val': 0.26041636434220805, 'psi': 0.8202497401397825}
[S10] START round=26 head_norm_before_train=1.624810 cos_to_last_merge=0.8152 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.815
[S10] round=26 local utility u=0.002424 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9964790258992533, 'loss_val': 0.0560572568341146, 'psi': 0.9959071553141684}-{'f1_val': 0.9955259082574451, 'auprc': 0.9965451676935149, 'loss_val': 0.06110440509961881, 'psi': 0.995933612031873}
[S11] START round=26 head_norm_before_train=1.872872 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9837827660794244, 'auprc': 0.997693894676571, 'loss_val': 0.13205792352496418, 'psi': 0.9893472175182831}-{'f1_val': 0.9906712181958396, 'auprc': 0.9977671528294847, 'loss_val': 0.12717052604800416, 'psi': 0.9935095920492976}
[S13] START round=26 head_norm_before_train=1.009894 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5567913458517806, 'auprc': 0.6710015690660229, 'loss_val': 0.8999974951892808, 'psi': 0.6024754351374775}-{'f1_val': 0.5589079918536877, 'auprc': 0.6836630425403649, 'loss_val': 0.8314588529692031, 'psi': 0.6088100121283586}
[S14] START round=26 head_norm_before_train=1.963984 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9921551826383668, 'auprc': 0.9953309781416548, 'loss_val': 0.05328570987291481, 'psi': 0.993425500839682}-{'f1_val': 0.9974082695017256, 'auprc': 0.9956322635225232, 'loss_val': 0.031833403106130524, 'psi': 0.9966978671100446}
[S15] START round=26 head_norm_before_train=1.219107 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.8038360228273523, 'auprc': 0.9882868315151274, 'loss_val': 0.3284816000946786, 'psi': 0.8776163463024624}-{'f1_val': 0.9664471282967964, 'auprc': 0.9970179409042241, 'loss_val': 0.11877296616240568, 'psi': 0.9786754533397675}
[S16] START round=26 head_norm_before_train=1.655803 cos_to_last_merge=0.7530 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.753
[S16] round=26 local utility u=0.250366 metrics={'f1_val': 0.940028590718364, 'auprc': 0.9926056844627484, 'loss_val': 0.24201401156139393, 'psi': 0.9610594282161178}-{'f1_val': 0.8930152688144953, 'auprc': 0.9922597245796598, 'loss_val': 0.4596284089258601, 'psi': 0.9327130511205611}
[S17] START round=26 head_norm_before_train=1.844732 (no previous merge yet)
[S17] round=26 local utility u=0.314364 metrics={'f1_val': 0.6597557937015563, 'auprc': 0.9751144781315821, 'loss_val': 0.4981841347366112, 'psi': 0.7858992674735668}-{'f1_val': 0.6018166609110323, 'auprc': 0.9523036504516085, 'loss_val': 0.7108446879604908, 'psi': 0.7420114567272628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61809
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:61812
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.961)
[S8] not sending this round → trigger blocked (psi=0.988)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:61804
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.278433)
[S11] loaded HEAD from S9 (vec_in norm=1.278433)
[S11] cosine check vs S9: cos=-0.0991
[S11] DROPPED delta from S9 (cos=-0.0991 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.935865)
[S8] loaded HEAD from S7 (vec_in norm=0.935865)
[S8] cosine check vs S7: cos=0.8533
[S8] BUFFERED delta from S7 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1804) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.835682)
[S13] loaded HEAD from S3 (vec_in norm=1.835682)
[S13] cosine check vs S3: cos=0.3297
[S13] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.928380)
[S4] loaded HEAD from S2 (vec_in norm=1.928380)
[S4] cosine check vs S2: cos=0.9938
[S4] BUFFERED delta from S2 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.786)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9931 head_norm=1.321079
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.574411e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9933 head_norm=1.087558 delta_norm=0.357441
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9459 head_norm=1.921282
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.072871e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9435 head_norm=1.921842 delta_norm=0.107287
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.5568 head_norm=1.036282
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.929188e-01
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.5563 head_norm=1.193525 delta_norm=0.892919
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.928380 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.5237280735379526, 'auprc': 0.7429935527579403, 'loss_val': 1.534815871387413, 'psi': 0.6114342652259477}-{'f1_val': 0.8274164050585436, 'auprc': 0.9223509766806781, 'loss_val': 0.45287431104703796, 'psi': 0.8653902337073974}
[S3] START round=27 head_norm_before_train=1.835682 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.6699237435466909, 'auprc': 0.9799141350624082, 'loss_val': 0.3553513539247409, 'psi': 0.7939199001529779}-{'f1_val': 0.9079756720404915, 'auprc': 0.9984917237986632, 'loss_val': 0.2388521361605228, 'psi': 0.9441820927437601}
[S4] START round=27 head_norm_before_train=1.921842 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.049344 metrics={'f1_val': 0.9560506757199067, 'auprc': 0.9717238171876252, 'loss_val': 0.24212173451336216, 'psi': 0.9623199323069941}-{'f1_val': 0.9458874059518223, 'auprc': 0.9662489824617583, 'loss_val': 0.2634064823073804, 'psi': 0.9540320365557966}
[S5] START round=27 head_norm_before_train=1.216480 cos_to_last_merge=0.9992 (last merge round=25)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.6194984392618743, 'auprc': 0.8590348598563273, 'loss_val': 0.5210085170913523, 'psi': 0.7153130074996555}-{'f1_val': 0.6411228106573237, 'auprc': 0.8560419869460645, 'loss_val': 0.5323192403465191, 'psi': 0.72709048117282}
[S6] START round=27 head_norm_before_train=1.568417 cos_to_last_merge=0.8281 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.828
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.6382796136530449, 'auprc': 0.9543242407931571, 'loss_val': 0.7223683295803925, 'psi': 0.7646974645090898}-{'f1_val': 0.7219882549101553, 'auprc': 0.955770203706267, 'loss_val': 0.5881087768601971, 'psi': 0.8155010344286}
[S7] START round=27 head_norm_before_train=0.935865 cos_to_last_merge=0.9935 (last merge round=24)
[S7] round=27 local utility u=0.122724 metrics={'f1_val': 0.6116702172693709, 'auprc': 0.8249206241984544, 'loss_val': 0.6926466000778433, 'psi': 0.6969703800410043}-{'f1_val': 0.5924808208556323, 'auprc': 0.8109176881569746, 'loss_val': 0.7809490266558721, 'psi': 0.6798555677761692}
[S8] START round=27 head_norm_before_train=1.087558 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.993467150337892, 'auprc': 0.9947290837551337, 'loss_val': 0.2618845257390548, 'psi': 0.9939719237047887}-{'f1_val': 0.9930910663870046, 'auprc': 0.9810059740433735, 'loss_val': 0.20419550039675508, 'psi': 0.9882570294495522}
[S9] START round=27 head_norm_before_train=1.278433 cos_to_last_merge=0.9985 (last merge round=24)
[S9] round=27 local utility u=0.027820 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9984271636698145, 'loss_val': 0.15561723826649568, 'psi': 0.9978791559219724}-{'f1_val': 0.9937421749897083, 'auprc': 0.9981801360061197, 'loss_val': 0.18788673189772692, 'psi': 0.995517359396273}
[S10] START round=27 head_norm_before_train=1.647543 cos_to_last_merge=0.8130 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.813
[S10] round=27 local utility u=0.002136 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9964791662338197, 'loss_val': 0.051785675001780614, 'psi': 0.995907211447995}-{'f1_val': 0.9955259082574451, 'auprc': 0.9964790258992533, 'loss_val': 0.0560572568341146, 'psi': 0.9959071553141684}
[S11] START round=27 head_norm_before_train=1.894961 cos_to_last_merge=0.9995 (last merge round=25)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9631627306067694, 'auprc': 0.9977896232657655, 'loss_val': 0.11043570662025952, 'psi': 0.9770134876703678}-{'f1_val': 0.9837827660794244, 'auprc': 0.997693894676571, 'loss_val': 0.13205792352496418, 'psi': 0.9893472175182831}
[S13] START round=27 head_norm_before_train=1.193525 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5298772688222229, 'auprc': 0.675507914925338, 'loss_val': 0.8369677384731598, 'psi': 0.5881295272634689}-{'f1_val': 0.5567913458517806, 'auprc': 0.6710015690660229, 'loss_val': 0.8999974951892808, 'psi': 0.6024754351374775}
[S14] START round=27 head_norm_before_train=1.975130 (no previous merge yet)
[S14] round=27 local utility u=0.033475 metrics={'f1_val': 0.997842298753406, 'auprc': 0.9971552391122334, 'loss_val': 0.02593023372873732, 'psi': 0.997567474896937}-{'f1_val': 0.9921551826383668, 'auprc': 0.9953309781416548, 'loss_val': 0.05328570987291481, 'psi': 0.993425500839682}
[S15] START round=27 head_norm_before_train=1.255609 cos_to_last_merge=0.9994 (last merge round=25)
[S15] round=27 local utility u=0.695936 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9972820211898317, 'loss_val': 0.11883230481757634, 'psi': 0.9967381166621264}-{'f1_val': 0.8038360228273523, 'auprc': 0.9882868315151274, 'loss_val': 0.3284816000946786, 'psi': 0.8776163463024624}
[S16] START round=27 head_norm_before_train=1.681213 cos_to_last_merge=0.7495 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.750
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.8850308250339528, 'auprc': 0.9898930266337251, 'loss_val': 0.5163226558451508, 'psi': 0.9269757056738618}-{'f1_val': 0.940028590718364, 'auprc': 0.9926056844627484, 'loss_val': 0.24201401156139393, 'psi': 0.9610594282161178}
[S17] START round=27 head_norm_before_train=1.863999 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.5975189378727199, 'auprc': 0.9781047297522755, 'loss_val': 0.664646939984253, 'psi': 0.7497532546245421}-{'f1_val': 0.6597557937015563, 'auprc': 0.9751144781315821, 'loss_val': 0.4981841347366112, 'psi': 0.7858992674735668}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:61809
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:61804
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:61812
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1803) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.304415)
[S11] loaded HEAD from S9 (vec_in norm=1.304415)
[S11] cosine check vs S9: cos=-0.1002
[S11] DROPPED delta from S9 (cos=-0.1002 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.934169)
[S11] loaded HEAD from S4 (vec_in norm=1.934169)
[S11] cosine check vs S4: cos=0.9865
[S11] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.293907)
[S9] loaded HEAD from S15 (vec_in norm=1.293907)
[S9] cosine check vs S15: cos=0.9237
[S9] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1792) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.975960)
[S8] loaded HEAD from S7 (vec_in norm=0.975960)
[S8] cosine check vs S7: cos=0.9385
[S8] BUFFERED delta from S7 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.668585)
[S4] loaded HEAD from S10 (vec_in norm=1.668585)
[S4] cosine check vs S10: cos=-0.0540
[S4] DROPPED delta from S10 (cos=-0.0540 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.986438)
[S7] loaded HEAD from S14 (vec_in norm=1.986438)
[S7] cosine check vs S14: cos=0.6870
[S7] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9935 head_norm=1.127218
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.988138e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9922 head_norm=1.035390 delta_norm=0.198814
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9632 head_norm=1.919886
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.586228e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9754 head_norm=1.920501 delta_norm=0.158623
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9975 head_norm=1.304415
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.538563e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9975 head_norm=1.274129 delta_norm=0.253856
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6117 head_norm=0.975960
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.474687e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.5933 head_norm=1.374957 delta_norm=0.747469
[S7] aggregate: ROLLBACK (f1_val pre=0.612 post=0.593 tol_abs=0.005 tol_rel=0.0)
[S2] START round=28 head_norm_before_train=1.937643 (no previous merge yet)
[S2] round=28 local utility u=1.000000 metrics={'f1_val': 0.8282675256101807, 'auprc': 0.9180954639342601, 'loss_val': 0.44721022594748866, 'psi': 0.8641987009398124}-{'f1_val': 0.5237280735379526, 'auprc': 0.7429935527579403, 'loss_val': 1.534815871387413, 'psi': 0.6114342652259477}
[S3] START round=28 head_norm_before_train=1.853190 (no previous merge yet)
[S3] round=28 local utility u=0.807142 metrics={'f1_val': 0.9069716642784651, 'auprc': 0.9984576952378722, 'loss_val': 0.2189860237764813, 'psi': 0.943566076662228}-{'f1_val': 0.6699237435466909, 'auprc': 0.9799141350624082, 'loss_val': 0.3553513539247409, 'psi': 0.7939199001529779}
[S4] START round=28 head_norm_before_train=1.934169 cos_to_last_merge=0.9999 (last merge round=26)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9485049312917289, 'auprc': 0.9650021700933535, 'loss_val': 0.2618336725118254, 'psi': 0.9551038268123787}-{'f1_val': 0.9560506757199067, 'auprc': 0.9717238171876252, 'loss_val': 0.24212173451336216, 'psi': 0.9623199323069941}
[S5] START round=28 head_norm_before_train=1.241191 cos_to_last_merge=0.9972 (last merge round=25)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.4282576871481686, 'auprc': 0.8297395989668008, 'loss_val': 0.8956441892065021, 'psi': 0.5888504518756215}-{'f1_val': 0.6194984392618743, 'auprc': 0.8590348598563273, 'loss_val': 0.5210085170913523, 'psi': 0.7153130074996555}
[S6] START round=28 head_norm_before_train=1.579779 cos_to_last_merge=0.8267 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.827
[S6] round=28 local utility u=1.000000 metrics={'f1_val': 0.9668463694748206, 'auprc': 0.9826697987180644, 'loss_val': 0.1179645698197649, 'psi': 0.9731757411721181}-{'f1_val': 0.6382796136530449, 'auprc': 0.9543242407931571, 'loss_val': 0.7223683295803925, 'psi': 0.7646974645090898}
[S7] START round=28 head_norm_before_train=1.374957 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.155976 metrics={'f1_val': 0.6363335104200063, 'auprc': 0.8375438452320858, 'loss_val': 0.5665436171150183, 'psi': 0.7168176443448382}-{'f1_val': 0.6116702172693709, 'auprc': 0.8249206241984544, 'loss_val': 0.6926466000778433, 'psi': 0.6969703800410043}
[S8] START round=28 head_norm_before_train=1.035390 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9924515537855688, 'auprc': 0.9961537542080837, 'loss_val': 0.27692616918768004, 'psi': 0.9939324339545748}-{'f1_val': 0.993467150337892, 'auprc': 0.9947290837551337, 'loss_val': 0.2618845257390548, 'psi': 0.9939719237047887}
[S9] START round=28 head_norm_before_train=1.274129 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9870000396042449, 'auprc': 0.9986828247905172, 'loss_val': 0.18643465251924063, 'psi': 0.9916731536787537}-{'f1_val': 0.9975138174234109, 'auprc': 0.9984271636698145, 'loss_val': 0.15561723826649568, 'psi': 0.9978791559219724}
[S10] START round=28 head_norm_before_train=1.668585 cos_to_last_merge=0.8110 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.811
[S10] round=28 local utility u=0.001899 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9963914509466585, 'loss_val': 0.04904310644166792, 'psi': 0.9960039168257098}-{'f1_val': 0.9955259082574451, 'auprc': 0.9964791662338197, 'loss_val': 0.051785675001780614, 'psi': 0.995907211447995}
[S11] START round=28 head_norm_before_train=1.920501 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9583676645452086, 'auprc': 0.9976795720825247, 'loss_val': 0.13332305221355387, 'psi': 0.974092427560135}-{'f1_val': 0.9631627306067694, 'auprc': 0.9977896232657655, 'loss_val': 0.11043570662025952, 'psi': 0.9770134876703678}
[S13] START round=28 head_norm_before_train=1.222104 cos_to_last_merge=0.9993 (last merge round=26)
[S13] round=28 local utility u=0.110168 metrics={'f1_val': 0.5681675160976756, 'auprc': 0.667306297521693, 'loss_val': 0.8217677284173902, 'psi': 0.6078230286672825}-{'f1_val': 0.5298772688222229, 'auprc': 0.675507914925338, 'loss_val': 0.8369677384731598, 'psi': 0.5881295272634689}
[S14] START round=28 head_norm_before_train=1.986438 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9929948985377146, 'auprc': 0.9957222185954199, 'loss_val': 0.04762793120662334, 'psi': 0.9940858265607968}-{'f1_val': 0.997842298753406, 'auprc': 0.9971552391122334, 'loss_val': 0.02593023372873732, 'psi': 0.997567474896937}
[S15] START round=28 head_norm_before_train=1.293907 cos_to_last_merge=0.9978 (last merge round=25)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.8375238334777724, 'auprc': 0.9953977323054812, 'loss_val': 0.2771122536096414, 'psi': 0.900673393008856}-{'f1_val': 0.9963755136436562, 'auprc': 0.9972820211898317, 'loss_val': 0.11883230481757634, 'psi': 0.9967381166621264}
[S16] START round=28 head_norm_before_train=1.701180 cos_to_last_merge=0.7462 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.746
[S16] round=28 local utility u=0.499566 metrics={'f1_val': 0.9855648034830894, 'auprc': 0.983535477367829, 'loss_val': 0.10132266631186077, 'psi': 0.9847530730369852}-{'f1_val': 0.8850308250339528, 'auprc': 0.9898930266337251, 'loss_val': 0.5163226558451508, 'psi': 0.9269757056738618}
[S17] START round=28 head_norm_before_train=1.882195 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5832323358679627, 'auprc': 0.9294256022474614, 'loss_val': 0.7901996239308936, 'psi': 0.7217096424197622}-{'f1_val': 0.5975189378727199, 'auprc': 0.9781047297522755, 'loss_val': 0.664646939984253, 'psi': 0.7497532546245421}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61809
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:61804
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:61805
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.249878)
[S7] loaded HEAD from S13 (vec_in norm=1.249878)
[S7] cosine check vs S13: cos=0.1516
[S7] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.945721)
[S4] loaded HEAD from S2 (vec_in norm=1.945721)
[S4] cosine check vs S2: cos=0.9968
[S4] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.589545)
[S5] loaded HEAD from S6 (vec_in norm=1.589545)
[S5] cosine check vs S6: cos=0.8443
[S5] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.691174)
[S4] loaded HEAD from S10 (vec_in norm=1.691174)
[S4] cosine check vs S10: cos=-0.0528
[S4] DROPPED delta from S10 (cos=-0.0528 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.869984)
[S13] loaded HEAD from S3 (vec_in norm=1.869984)
[S13] cosine check vs S3: cos=0.9002
[S13] BUFFERED delta from S3 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1800) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.722685)
[S2] loaded HEAD from S16 (vec_in norm=1.722685)
[S2] cosine check vs S16: cos=-0.1104
[S2] DROPPED delta from S16 (cos=-0.1104 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.402397)
[S8] loaded HEAD from S7 (vec_in norm=1.402397)
[S8] cosine check vs S7: cos=0.8968
[S8] BUFFERED delta from S7 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.4283 head_norm=1.266739
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.275142e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.4285 head_norm=1.372178 delta_norm=0.427514
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9485 head_norm=1.944311
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.725950e-02
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9464 head_norm=1.943481 delta_norm=0.077260
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9925 head_norm=1.082219
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.223592e-01
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.9925 head_norm=1.210389 delta_norm=0.322359
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.6363 head_norm=1.402397
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.656694e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.6376 head_norm=1.007508 delta_norm=0.865669
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.5682 head_norm=1.249878
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.612719e-01
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.5683 head_norm=1.522086 delta_norm=0.461272
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.945721 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.8573307166158031, 'auprc': 0.8009728701715597, 'loss_val': 0.36443084782571744, 'psi': 0.8347875780381058}-{'f1_val': 0.8282675256101807, 'auprc': 0.9180954639342601, 'loss_val': 0.44721022594748866, 'psi': 0.8641987009398124}
[S3] START round=29 head_norm_before_train=1.869984 (no previous merge yet)
[S3] round=29 local utility u=0.145985 metrics={'f1_val': 0.9419597253635276, 'auprc': 0.9984092935072947, 'loss_val': 0.13679918281900105, 'psi': 0.9645395526210344}-{'f1_val': 0.9069716642784651, 'auprc': 0.9984576952378722, 'loss_val': 0.2189860237764813, 'psi': 0.943566076662228}
[S4] START round=29 head_norm_before_train=1.943481 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.024094 metrics={'f1_val': 0.9566382898945389, 'auprc': 0.9598413033991617, 'loss_val': 0.24696391931263761, 'psi': 0.9579194952963881}-{'f1_val': 0.9485049312917289, 'auprc': 0.9650021700933535, 'loss_val': 0.2618336725118254, 'psi': 0.9551038268123787}
[S5] START round=29 head_norm_before_train=1.372178 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=1.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8763375789894543, 'loss_val': 0.4040518504317926, 'psi': 0.7707273906905971}-{'f1_val': 0.4282576871481686, 'auprc': 0.8297395989668008, 'loss_val': 0.8956441892065021, 'psi': 0.5888504518756215}
[S6] START round=29 head_norm_before_train=1.589545 cos_to_last_merge=0.8256 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.826
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.6162084260833229, 'auprc': 0.813724873056294, 'loss_val': 0.8336825222179831, 'psi': 0.6952150048725114}-{'f1_val': 0.9668463694748206, 'auprc': 0.9826697987180644, 'loss_val': 0.1179645698197649, 'psi': 0.9731757411721181}
[S7] START round=29 head_norm_before_train=1.007508 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.6209945218871358, 'auprc': 0.8226897663830518, 'loss_val': 0.676409774478097, 'psi': 0.7016726196855021}-{'f1_val': 0.6363335104200063, 'auprc': 0.8375438452320858, 'loss_val': 0.5665436171150183, 'psi': 0.7168176443448382}
[S8] START round=29 head_norm_before_train=1.210389 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.000308 metrics={'f1_val': 0.9929762634442646, 'auprc': 0.9822277115802515, 'loss_val': 0.2376808657216567, 'psi': 0.9886768426986594}-{'f1_val': 0.9924515537855688, 'auprc': 0.9961537542080837, 'loss_val': 0.27692616918768004, 'psi': 0.9939324339545748}
[S9] START round=29 head_norm_before_train=1.296772 cos_to_last_merge=0.9997 (last merge round=27)
[S9] round=29 local utility u=0.045811 metrics={'f1_val': 0.9946010516642972, 'auprc': 0.9985638338801451, 'loss_val': 0.14006150696014796, 'psi': 0.9961861645506365}-{'f1_val': 0.9870000396042449, 'auprc': 0.9986828247905172, 'loss_val': 0.18643465251924063, 'psi': 0.9916731536787537}
[S10] START round=29 head_norm_before_train=1.691174 cos_to_last_merge=0.8090 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.809
[S10] round=29 local utility u=0.000886 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.996253818470985, 'loss_val': 0.046858553953971704, 'psi': 0.9959488638354403}-{'f1_val': 0.9957455607450773, 'auprc': 0.9963914509466585, 'loss_val': 0.04904310644166792, 'psi': 0.9960039168257098}
[S11] START round=29 head_norm_before_train=1.944407 cos_to_last_merge=0.9996 (last merge round=27)
[S11] round=29 local utility u=0.142586 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980334519818665, 'loss_val': 0.07828922464812217, 'psi': 0.9971415835009003}-{'f1_val': 0.9583676645452086, 'auprc': 0.9976795720825247, 'loss_val': 0.13332305221355387, 'psi': 0.974092427560135}
[S13] START round=29 head_norm_before_train=1.522086 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5244472593216526, 'auprc': 0.6902631539042394, 'loss_val': 0.9131016671633885, 'psi': 0.5907736171546873}-{'f1_val': 0.5681675160976756, 'auprc': 0.667306297521693, 'loss_val': 0.8217677284173902, 'psi': 0.6078230286672825}
[S14] START round=29 head_norm_before_train=1.996183 (no previous merge yet)
[S14] round=29 local utility u=0.022679 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.995722502232611, 'loss_val': 0.031217617384402666, 'psi': 0.9969807116733754}-{'f1_val': 0.9929948985377146, 'auprc': 0.9957222185954199, 'loss_val': 0.04762793120662334, 'psi': 0.9940858265607968}
[S15] START round=29 head_norm_before_train=1.332575 cos_to_last_merge=0.9954 (last merge round=25)
[S15] round=29 local utility u=0.577313 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.998688761910124, 'loss_val': 0.08991916610334945, 'psi': 0.9977458568809097}-{'f1_val': 0.8375238334777724, 'auprc': 0.9953977323054812, 'loss_val': 0.2771122536096414, 'psi': 0.900673393008856}
[S16] START round=29 head_norm_before_train=1.722685 cos_to_last_merge=0.7443 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.744
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8550236232988973, 'auprc': 0.9869203318026575, 'loss_val': 0.8145228788639716, 'psi': 0.9077823067004014}-{'f1_val': 0.9855648034830894, 'auprc': 0.983535477367829, 'loss_val': 0.10132266631186077, 'psi': 0.9847530730369852}
[S17] START round=29 head_norm_before_train=1.904240 (no previous merge yet)
[S17] round=29 local utility u=0.038116 metrics={'f1_val': 0.6290023033413021, 'auprc': 0.8436868244128303, 'loss_val': 0.731370708132181, 'psi': 0.7148761117699134}-{'f1_val': 0.5832323358679627, 'auprc': 0.9294256022474614, 'loss_val': 0.7901996239308936, 'psi': 0.7217096424197622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61812
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:61804
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:61815
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:61812
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.970367)
[S5] loaded HEAD from S11 (vec_in norm=1.970367)
[S5] cosine check vs S11: cos=0.1905
[S5] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1805) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.714341)
[S4] loaded HEAD from S10 (vec_in norm=1.714341)
[S4] cosine check vs S10: cos=-0.0527
[S4] DROPPED delta from S10 (cos=-0.0527 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.254435)
[S15] loaded HEAD from S8 (vec_in norm=1.254435)
[S15] cosine check vs S8: cos=0.8951
[S15] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.387407)
[S13] loaded HEAD from S5 (vec_in norm=1.387407)
[S13] cosine check vs S5: cos=0.1349
[S13] BUFFERED delta from S5 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.891322)
[S13] loaded HEAD from S3 (vec_in norm=1.891322)
[S13] cosine check vs S3: cos=0.9806
[S13] BUFFERED delta from S3 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.954594)
[S11] loaded HEAD from S4 (vec_in norm=1.954594)
[S11] cosine check vs S4: cos=0.9906
[S11] BUFFERED delta from S4 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.325019)
[S11] loaded HEAD from S9 (vec_in norm=1.325019)
[S11] cosine check vs S9: cos=-0.0621
[S11] DROPPED delta from S9 (cos=-0.0621 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.368353)
[S9] loaded HEAD from S15 (vec_in norm=1.368353)
[S9] cosine check vs S15: cos=0.9770
[S9] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.005434)
[S7] loaded HEAD from S14 (vec_in norm=2.005434)
[S7] cosine check vs S14: cos=0.6292
[S7] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.920873)
[S13] loaded HEAD from S17 (vec_in norm=1.920873)
[S13] cosine check vs S17: cos=0.1594
[S13] BUFFERED delta from S17 (total buffered=3)
[S13] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.5244 head_norm=1.540412
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.478269e-01
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.5251 head_norm=1.185668 delta_norm=0.547827
[S13] aggregate: ACCEPT kept=['S5', 'S3', 'S17'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.6210 head_norm=1.036675
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.874660e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.6137 head_norm=1.388570 delta_norm=0.787466
[S7] aggregate: ROLLBACK (f1_val pre=0.621 post=0.614 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=29 metric=0.9946 head_norm=1.325019
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.459519e-01
[S9] stored merged vector for next round verification (round=29)
[S9] DEBUG after merge:  round=29 metric=0.9929 head_norm=1.338929 delta_norm=0.145952
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.9971 head_norm=1.368353
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.053823e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.9971 head_norm=1.276613 delta_norm=0.305382
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9965 head_norm=1.970367
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.345325e-01
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9965 head_norm=1.957880 delta_norm=0.134532
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.7003 head_norm=1.387407
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.091499e+00
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.7003 head_norm=1.308531 delta_norm=1.091499
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.954602 (no previous merge yet)
[S2] round=30 local utility u=0.047233 metrics={'f1_val': 0.828459097984185, 'auprc': 0.9206723531780238, 'loss_val': 0.4558341756685162, 'psi': 0.8653444000617205}-{'f1_val': 0.8573307166158031, 'auprc': 0.8009728701715597, 'loss_val': 0.36443084782571744, 'psi': 0.8347875780381058}
[S3] START round=30 head_norm_before_train=1.891322 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9261127003129965, 'auprc': 0.9978528944689067, 'loss_val': 0.17688719883719128, 'psi': 0.9548087779753607}-{'f1_val': 0.9419597253635276, 'auprc': 0.9984092935072947, 'loss_val': 0.13679918281900105, 'psi': 0.9645395526210344}
[S4] START round=30 head_norm_before_train=1.954594 cos_to_last_merge=0.9999 (last merge round=28)
[S4] round=30 local utility u=0.000031 metrics={'f1_val': 0.9547399354553701, 'auprc': 0.9645866398769163, 'loss_val': 0.24974777715898178, 'psi': 0.9586786172239885}-{'f1_val': 0.9566382898945389, 'auprc': 0.9598413033991617, 'loss_val': 0.24696391931263761, 'psi': 0.9579194952963881}
[S5] START round=30 head_norm_before_train=1.308531 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.015496 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.9073121943574907, 'loss_val': 0.4644963831729814, 'psi': 0.7829684092433236}-{'f1_val': 0.700320598491359, 'auprc': 0.8763375789894543, 'loss_val': 0.4040518504317926, 'psi': 0.7707273906905971}
[S6] START round=30 head_norm_before_train=1.597061 cos_to_last_merge=0.8241 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.824
[S6] round=30 local utility u=1.000000 metrics={'f1_val': 0.8205578400059952, 'auprc': 0.9309917692853306, 'loss_val': 0.3984102581868539, 'psi': 0.8647314117177294}-{'f1_val': 0.6162084260833229, 'auprc': 0.813724873056294, 'loss_val': 0.8336825222179831, 'psi': 0.6952150048725114}
[S7] START round=30 head_norm_before_train=1.388570 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.6141101817022339, 'auprc': 0.818216475155473, 'loss_val': 0.656202353136922, 'psi': 0.6957526990835295}-{'f1_val': 0.6209945218871358, 'auprc': 0.8226897663830518, 'loss_val': 0.676409774478097, 'psi': 0.7016726196855021}
[S8] START round=30 head_norm_before_train=1.254435 cos_to_last_merge=0.9968 (last merge round=28)
[S8] round=30 local utility u=0.049591 metrics={'f1_val': 0.9894974354721919, 'auprc': 0.9952304832930664, 'loss_val': 0.15663355228660494, 'psi': 0.9917906546005417}-{'f1_val': 0.9929762634442646, 'auprc': 0.9822277115802515, 'loss_val': 0.2376808657216567, 'psi': 0.9886768426986594}
[S9] START round=30 head_norm_before_train=1.338929 cos_to_last_merge=1.0000 (last merge round=29)
[S9] round=30 local utility u=0.012638 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9971106563819563, 'loss_val': 0.12543739066614562, 'psi': 0.9971060100600682}-{'f1_val': 0.9946010516642972, 'auprc': 0.9985638338801451, 'loss_val': 0.14006150696014796, 'psi': 0.9961861645506365}
[S10] START round=30 head_norm_before_train=1.714341 cos_to_last_merge=0.8070 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.807
[S10] round=30 local utility u=0.000428 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9961481242749489, 'loss_val': 0.04568581598741221, 'psi': 0.9959065861570259}-{'f1_val': 0.9957455607450773, 'auprc': 0.996253818470985, 'loss_val': 0.046858553953971704, 'psi': 0.9959488638354403}
[S11] START round=30 head_norm_before_train=1.957880 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9679153621469081, 'auprc': 0.9956762358185528, 'loss_val': 0.14928446594151026, 'psi': 0.979019711615566}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980334519818665, 'loss_val': 0.07828922464812217, 'psi': 0.9971415835009003}
[S13] START round=30 head_norm_before_train=1.185668 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.011342 metrics={'f1_val': 0.5272459101053443, 'auprc': 0.6880959178654678, 'loss_val': 0.9007083153656541, 'psi': 0.5915859132093937}-{'f1_val': 0.5244472593216526, 'auprc': 0.6902631539042394, 'loss_val': 0.9131016671633885, 'psi': 0.5907736171546873}
[S14] START round=30 head_norm_before_train=2.005434 (no previous merge yet)
[S14] round=30 local utility u=0.005617 metrics={'f1_val': 0.997871830388708, 'auprc': 0.9971560085187614, 'loss_val': 0.024597494157511716, 'psi': 0.9975855016407293}-{'f1_val': 0.9978195179672185, 'auprc': 0.995722502232611, 'loss_val': 0.031217617384402666, 'psi': 0.9969807116733754}
[S15] START round=30 head_norm_before_train=1.276613 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.9302876235403376, 'auprc': 0.9974824111773479, 'loss_val': 0.18468708213478058, 'psi': 0.9571655385951416}-{'f1_val': 0.9971172535281002, 'auprc': 0.998688761910124, 'loss_val': 0.08991916610334945, 'psi': 0.9977458568809097}
[S16] START round=30 head_norm_before_train=1.741886 cos_to_last_merge=0.7426 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.743
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8514577099845122, 'auprc': 0.9843489817949979, 'loss_val': 0.8731159761207701, 'psi': 0.9046142187087065}-{'f1_val': 0.8550236232988973, 'auprc': 0.9869203318026575, 'loss_val': 0.8145228788639716, 'psi': 0.9077823067004014}
[S17] START round=30 head_norm_before_train=1.920873 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.5706502341879902, 'auprc': 0.8723979276136002, 'loss_val': 0.9642190011598711, 'psi': 0.6913493115582342}-{'f1_val': 0.6290023033413021, 'auprc': 0.8436868244128303, 'loss_val': 0.731370708132181, 'psi': 0.7148761117699134}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61812
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:61812
[S14] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.305440)
[S15] loaded HEAD from S8 (vec_in norm=1.305440)
[S15] cosine check vs S8: cos=0.9705
[S15] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.324138)
[S13] loaded HEAD from S5 (vec_in norm=1.324138)
[S13] cosine check vs S5: cos=0.2225
[S13] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1803) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.371050)
[S11] loaded HEAD from S9 (vec_in norm=1.371050)
[S11] cosine check vs S9: cos=-0.0449
[S11] DROPPED delta from S9 (cos=-0.0449 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.965343)
[S11] loaded HEAD from S4 (vec_in norm=1.965343)
[S11] cosine check vs S4: cos=0.9959
[S11] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.015363)
[S7] loaded HEAD from S14 (vec_in norm=2.015363)
[S7] cosine check vs S14: cos=0.9532
[S7] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.204506)
[S7] loaded HEAD from S13 (vec_in norm=1.204506)
[S7] cosine check vs S13: cos=0.2035
[S7] BUFFERED delta from S13 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1799) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.605757)
[S5] loaded HEAD from S6 (vec_in norm=1.605757)
[S5] cosine check vs S6: cos=0.4788
[S5] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1796) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.965244)
[S4] loaded HEAD from S2 (vec_in norm=1.965244)
[S4] cosine check vs S2: cos=0.9979
[S4] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.737520)
[S4] loaded HEAD from S10 (vec_in norm=1.737520)
[S4] cosine check vs S10: cos=-0.0513
[S4] DROPPED delta from S10 (cos=-0.0513 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=30 metric=0.9679 head_norm=1.981927
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.944795e-02
[S11] stored merged vector for next round verification (round=30)
[S11] DEBUG after merge:  round=30 metric=0.9335 head_norm=1.971624 delta_norm=0.089448
[S11] aggregate: ROLLBACK (f1_val pre=0.968 post=0.934 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.057 → S5@127.0.0.1:61805
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.6141 head_norm=1.418244
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.338249e-01
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.6132 head_norm=1.261235 delta_norm=0.233825
[S7] aggregate: ACCEPT kept=['S14', 'S13'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.152 → S8@127.0.0.1:61809
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.9303 head_norm=1.313232
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.590830e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.9334 head_norm=1.299642 delta_norm=0.159083
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.219 → S9@127.0.0.1:61810
[S3] ⇄ pheromone p=0.187 → S13@127.0.0.1:61813
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.7001 head_norm=1.324138
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.576129e-01
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.7003 head_norm=1.261714 delta_norm=0.757613
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.281 → S13@127.0.0.1:61813
[S14] ⇄ pheromone p=0.025 → S7@127.0.0.1:61808
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=30 metric=0.5272 head_norm=1.204506
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.896966e-01
[S13] stored merged vector for next round verification (round=30)
[S13] DEBUG after merge:  round=30 metric=0.5416 head_norm=0.989175 delta_norm=0.789697
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.049 → S7@127.0.0.1:61808
[S9] ⇄ pheromone p=0.094 → S11@127.0.0.1:61812
[S10] ⇄ pheromone p=0.032 → S4@127.0.0.1:61804
[S2] ⇄ pheromone p=0.224 → S4@127.0.0.1:61804
[S8] ⇄ pheromone p=0.086 → S15@127.0.0.1:61815
[S6] ⇄ pheromone p=0.461 → S5@127.0.0.1:61805
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9547 head_norm=1.965343
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.374488e-02
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9547 head_norm=1.964260 delta_norm=0.063745
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.066 → S11@127.0.0.1:61812
[S16] ⇄ pheromone p=0.145 → S2@127.0.0.1:61802
[S17] ⇄ pheromone p=0.067 → S13@127.0.0.1:61813
[S2] START round=31 head_norm_before_train=1.965244 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.8198954846883002, 'auprc': 0.8118686165123804, 'loss_val': 0.3770634555905004, 'psi': 0.8166847374179322}-{'f1_val': 0.828459097984185, 'auprc': 0.9206723531780238, 'loss_val': 0.4558341756685162, 'psi': 0.8653444000617205}
[S3] START round=31 head_norm_before_train=1.914847 (no previous merge yet)
[S3] round=31 local utility u=0.091686 metrics={'f1_val': 0.9487454683296638, 'auprc': 0.9988916840012693, 'loss_val': 0.1324283293266882, 'psi': 0.9688039545983059}-{'f1_val': 0.9261127003129965, 'auprc': 0.9978528944689067, 'loss_val': 0.17688719883719128, 'psi': 0.9548087779753607}
[S4] START round=31 head_norm_before_train=1.964260 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9389902765345295, 'auprc': 0.9690499378743331, 'loss_val': 0.28020596047010204, 'psi': 0.9510141410704509}-{'f1_val': 0.9547399354553701, 'auprc': 0.9645866398769163, 'loss_val': 0.24974777715898178, 'psi': 0.9586786172239885}
[S5] START round=31 head_norm_before_train=1.261714 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.653436763854155, 'auprc': 0.8560691237864224, 'loss_val': 0.5325663975642094, 'psi': 0.734489707827062}-{'f1_val': 0.7000725525005456, 'auprc': 0.9073121943574907, 'loss_val': 0.4644963831729814, 'psi': 0.7829684092433236}
[S6] START round=31 head_norm_before_train=1.605757 cos_to_last_merge=0.8229 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.823
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.8173536929164116, 'auprc': 0.9502068265236232, 'loss_val': 0.5041391060248653, 'psi': 0.8704949463592963}-{'f1_val': 0.8205578400059952, 'auprc': 0.9309917692853306, 'loss_val': 0.3984102581868539, 'psi': 0.8647314117177294}
[S7] START round=31 head_norm_before_train=1.261235 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.5217997249259633, 'auprc': 0.7897997681203829, 'loss_val': 0.8448119046528697, 'psi': 0.6289997422037311}-{'f1_val': 0.6141101817022339, 'auprc': 0.818216475155473, 'loss_val': 0.656202353136922, 'psi': 0.6957526990835295}
[S8] START round=31 head_norm_before_train=1.305440 cos_to_last_merge=0.9892 (last merge round=28)
[S8] round=31 local utility u=0.010835 metrics={'f1_val': 0.9933434229799246, 'auprc': 0.9822044823577258, 'loss_val': 0.11896148467330026, 'psi': 0.9888878467310451}-{'f1_val': 0.9894974354721919, 'auprc': 0.9952304832930664, 'loss_val': 0.15663355228660494, 'psi': 0.9917906546005417}
[S9] START round=31 head_norm_before_train=1.371050 cos_to_last_merge=0.9993 (last merge round=29)
[S9] round=31 local utility u=0.014364 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9982234014149028, 'loss_val': 0.10004839822635803, 'psi': 0.9975511080732469}-{'f1_val': 0.9971029125121428, 'auprc': 0.9971106563819563, 'loss_val': 0.12543739066614562, 'psi': 0.9971060100600682}
[S10] START round=31 head_norm_before_train=1.737520 cos_to_last_merge=0.8049 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.805
[S10] round=31 local utility u=0.002516 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9964806792301353, 'loss_val': 0.04165187703158019, 'psi': 0.9960396081391004}-{'f1_val': 0.9957455607450773, 'auprc': 0.9961481242749489, 'loss_val': 0.04568581598741221, 'psi': 0.9959065861570259}
[S11] START round=31 head_norm_before_train=1.971624 cos_to_last_merge=1.0000 (last merge round=30)
[S11] round=31 local utility u=0.094211 metrics={'f1_val': 0.9900847705011178, 'auprc': 0.9980673550205588, 'loss_val': 0.10105299008223557, 'psi': 0.9932778043088941}-{'f1_val': 0.9679153621469081, 'auprc': 0.9956762358185528, 'loss_val': 0.14928446594151026, 'psi': 0.979019711615566}
[S13] START round=31 head_norm_before_train=0.989175 cos_to_last_merge=1.0000 (last merge round=30)
[S13] round=31 local utility u=0.184685 metrics={'f1_val': 0.572430007321765, 'auprc': 0.6865918203691748, 'loss_val': 0.7979305473930332, 'psi': 0.6180947325407289}-{'f1_val': 0.5272459101053443, 'auprc': 0.6880959178654678, 'loss_val': 0.9007083153656541, 'psi': 0.5915859132093937}
[S14] START round=31 head_norm_before_train=2.015363 (no previous merge yet)
[S14] round=31 local utility u=0.001987 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9988512871965176, 'loss_val': 0.024385752715087656, 'psi': 0.9981311857085192}-{'f1_val': 0.997871830388708, 'auprc': 0.9971560085187614, 'loss_val': 0.024597494157511716, 'psi': 0.9975855016407293}
[S15] START round=31 head_norm_before_train=1.299642 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.9010440201688609, 'auprc': 0.9970652450834796, 'loss_val': 0.2503900709028832, 'psi': 0.9394525101347083}-{'f1_val': 0.9302876235403376, 'auprc': 0.9974824111773479, 'loss_val': 0.18468708213478058, 'psi': 0.9571655385951416}
[S16] START round=31 head_norm_before_train=1.761660 cos_to_last_merge=0.7416 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.742
[S16] round=31 local utility u=0.482835 metrics={'f1_val': 0.9245869453206553, 'auprc': 0.9906355517425962, 'loss_val': 0.3650807554392302, 'psi': 0.9510063878894317}-{'f1_val': 0.8514577099845122, 'auprc': 0.9843489817949979, 'loss_val': 0.8731159761207701, 'psi': 0.9046142187087065}
[S17] START round=31 head_norm_before_train=1.936530 (no previous merge yet)
[S17] round=31 local utility u=0.414280 metrics={'f1_val': 0.5975571362578076, 'auprc': 0.9915488434736012, 'loss_val': 0.6545536083651833, 'psi': 0.755153819144125}-{'f1_val': 0.5706502341879902, 'auprc': 0.8723979276136002, 'loss_val': 0.9642190011598711, 'psi': 0.6913493115582342}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:61804
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:61815
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.398713)
[S11] loaded HEAD from S9 (vec_in norm=1.398713)
[S11] cosine check vs S9: cos=-0.0454
[S11] DROPPED delta from S9 (cos=-0.0454 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.993900)
[S5] loaded HEAD from S11 (vec_in norm=1.993900)
[S5] cosine check vs S11: cos=0.4106
[S5] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.935907)
[S13] loaded HEAD from S3 (vec_in norm=1.935907)
[S13] cosine check vs S3: cos=0.5449
[S13] BUFFERED delta from S3 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.012372)
[S7] loaded HEAD from S13 (vec_in norm=1.012372)
[S7] cosine check vs S13: cos=0.2504
[S7] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.023405)
[S7] loaded HEAD from S14 (vec_in norm=2.023405)
[S7] cosine check vs S14: cos=0.9121
[S7] BUFFERED delta from S14 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1797) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.760035)
[S4] loaded HEAD from S10 (vec_in norm=1.760035)
[S4] cosine check vs S10: cos=-0.0518
[S4] DROPPED delta from S10 (cos=-0.0518 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.780510)
[S2] loaded HEAD from S16 (vec_in norm=1.780510)
[S2] cosine check vs S16: cos=-0.1082
[S2] DROPPED delta from S16 (cos=-0.1082 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.356941)
[S15] loaded HEAD from S8 (vec_in norm=1.356941)
[S15] cosine check vs S8: cos=0.9879
[S15] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.949280)
[S13] loaded HEAD from S17 (vec_in norm=1.949280)
[S13] cosine check vs S17: cos=0.2216
[S13] BUFFERED delta from S17 (total buffered=2)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.6534 head_norm=1.280425
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.379181e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.6614 head_norm=1.388478 delta_norm=0.937918
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.5218 head_norm=1.287462
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.020620e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.5267 head_norm=1.179878 delta_norm=0.202062
[S7] aggregate: ACCEPT kept=['S13', 'S14'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.9010 head_norm=1.341810
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.051251e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.9010 head_norm=1.345296 delta_norm=0.105125
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=31 metric=0.5724 head_norm=1.012372
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.973557e-01
[S13] stored merged vector for next round verification (round=31)
[S13] DEBUG after merge:  round=31 metric=0.5769 head_norm=1.053293 delta_norm=0.597356
[S13] aggregate: ACCEPT kept=['S3', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.972402 (no previous merge yet)
[S2] round=32 local utility u=0.161678 metrics={'f1_val': 0.8317588621752648, 'auprc': 0.9124814789567354, 'loss_val': 0.4267271938113773, 'psi': 0.864047908887853}-{'f1_val': 0.8198954846883002, 'auprc': 0.8118686165123804, 'loss_val': 0.3770634555905004, 'psi': 0.8166847374179322}
[S3] START round=32 head_norm_before_train=1.935907 (no previous merge yet)
[S3] round=32 local utility u=0.143913 metrics={'f1_val': 0.9879277725949749, 'auprc': 0.9992054829006619, 'loss_val': 0.08063770461048655, 'psi': 0.9924388567172496}-{'f1_val': 0.9487454683296638, 'auprc': 0.9988916840012693, 'loss_val': 0.1324283293266882, 'psi': 0.9688039545983059}
[S4] START round=32 head_norm_before_train=1.975744 cos_to_last_merge=0.9999 (last merge round=30)
[S4] round=32 local utility u=0.045230 metrics={'f1_val': 0.9508005978451133, 'auprc': 0.966546706348763, 'loss_val': 0.2530986291956524, 'psi': 0.9570990412465732}-{'f1_val': 0.9389902765345295, 'auprc': 0.9690499378743331, 'loss_val': 0.28020596047010204, 'psi': 0.9510141410704509}
[S5] START round=32 head_norm_before_train=1.388478 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.4365551966379383, 'auprc': 0.7381113875184554, 'loss_val': 1.0394213535917696, 'psi': 0.5571776729901452}-{'f1_val': 0.653436763854155, 'auprc': 0.8560691237864224, 'loss_val': 0.5325663975642094, 'psi': 0.734489707827062}
[S6] START round=32 head_norm_before_train=1.614430 cos_to_last_merge=0.8220 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.822
[S6] round=32 local utility u=0.112953 metrics={'f1_val': 0.8234656829100886, 'auprc': 0.9556664283810029, 'loss_val': 0.33128365094114925, 'psi': 0.8763459810984543}-{'f1_val': 0.8173536929164116, 'auprc': 0.9502068265236232, 'loss_val': 0.5041391060248653, 'psi': 0.8704949463592963}
[S7] START round=32 head_norm_before_train=1.179878 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.639651 metrics={'f1_val': 0.6586714463760815, 'auprc': 0.8346301271873869, 'loss_val': 0.5212303606411602, 'psi': 0.7290549187006037}-{'f1_val': 0.5217997249259633, 'auprc': 0.7897997681203829, 'loss_val': 0.8448119046528697, 'psi': 0.6289997422037311}
[S8] START round=32 head_norm_before_train=1.356941 cos_to_last_merge=0.9808 (last merge round=28)
[S8] round=32 local utility u=0.030139 metrics={'f1_val': 0.991372388611257, 'auprc': 0.9971536343139362, 'loss_val': 0.0917053786803427, 'psi': 0.9936848868923287}-{'f1_val': 0.9933434229799246, 'auprc': 0.9822044823577258, 'loss_val': 0.11896148467330026, 'psi': 0.9888878467310451}
[S9] START round=32 head_norm_before_train=1.398713 cos_to_last_merge=0.9979 (last merge round=29)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9917060080596727, 'auprc': 0.9991093740403713, 'loss_val': 0.08776140385935606, 'psi': 0.9946673544519522}-{'f1_val': 0.9971029125121428, 'auprc': 0.9982234014149028, 'loss_val': 0.10004839822635803, 'psi': 0.9975511080732469}
[S10] START round=32 head_norm_before_train=1.760035 cos_to_last_merge=0.8028 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.803
[S10] round=32 local utility u=0.001176 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9965596788512361, 'loss_val': 0.03821818074272049, 'psi': 0.9959394164949615}-{'f1_val': 0.9957455607450773, 'auprc': 0.9964806792301353, 'loss_val': 0.04165187703158019, 'psi': 0.9960396081391004}
[S11] START round=32 head_norm_before_train=1.993900 cos_to_last_merge=0.9997 (last merge round=30)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.981602910314117, 'auprc': 0.9978947447342466, 'loss_val': 0.11167129708008354, 'psi': 0.9881196440821689}-{'f1_val': 0.9900847705011178, 'auprc': 0.9980673550205588, 'loss_val': 0.10105299008223557, 'psi': 0.9932778043088941}
[S13] START round=32 head_norm_before_train=1.053293 cos_to_last_merge=1.0000 (last merge round=31)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5509779659027464, 'auprc': 0.6934646978829092, 'loss_val': 0.9272511440220401, 'psi': 0.6079726586948115}-{'f1_val': 0.572430007321765, 'auprc': 0.6865918203691748, 'loss_val': 0.7979305473930332, 'psi': 0.6180947325407289}
[S14] START round=32 head_norm_before_train=2.023405 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9988512871165309, 'loss_val': 0.025338208429873617, 'psi': 0.9981311856765245}-{'f1_val': 0.9976511180498535, 'auprc': 0.9988512871965176, 'loss_val': 0.024385752715087656, 'psi': 0.9981311857085192}
[S15] START round=32 head_norm_before_train=1.345296 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.287919 metrics={'f1_val': 0.9836632781139562, 'auprc': 0.9968564157198058, 'loss_val': 0.16964166741666967, 'psi': 0.9889405331562959}-{'f1_val': 0.9010440201688609, 'auprc': 0.9970652450834796, 'loss_val': 0.2503900709028832, 'psi': 0.9394525101347083}
[S16] START round=32 head_norm_before_train=1.780510 cos_to_last_merge=0.7407 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.741
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.92294537087489, 'auprc': 0.9908941399344678, 'loss_val': 0.3578731366922117, 'psi': 0.9501248784987212}-{'f1_val': 0.9245869453206553, 'auprc': 0.9906355517425962, 'loss_val': 0.3650807554392302, 'psi': 0.9510063878894317}
[S17] START round=32 head_norm_before_train=1.949280 (no previous merge yet)
[S17] round=32 local utility u=0.202310 metrics={'f1_val': 0.645657772486971, 'auprc': 0.9931511761426446, 'loss_val': 0.5433438063469435, 'psi': 0.7846551339492405}-{'f1_val': 0.5975571362578076, 'auprc': 0.9915488434736012, 'loss_val': 0.6545536083651833, 'psi': 0.755153819144125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61812
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:61810
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:61804
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:61815
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61809
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.399954)
[S15] loaded HEAD from S8 (vec_in norm=1.399954)
[S15] cosine check vs S8: cos=0.9929
[S15] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.957262)
[S13] loaded HEAD from S3 (vec_in norm=1.957262)
[S13] cosine check vs S3: cos=0.7248
[S13] BUFFERED delta from S3 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.989483)
[S11] loaded HEAD from S4 (vec_in norm=1.989483)
[S11] cosine check vs S4: cos=0.9954
[S11] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.384911)
[S9] loaded HEAD from S15 (vec_in norm=1.384911)
[S9] cosine check vs S15: cos=0.9136
[S9] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.206143)
[S8] loaded HEAD from S7 (vec_in norm=1.206143)
[S8] cosine check vs S7: cos=0.9410
[S8] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.624012)
[S5] loaded HEAD from S6 (vec_in norm=1.624012)
[S5] cosine check vs S6: cos=0.3767
[S5] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.780723)
[S4] loaded HEAD from S10 (vec_in norm=1.780723)
[S4] cosine check vs S10: cos=-0.0506
[S4] DROPPED delta from S10 (cos=-0.0506 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1796) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.978829)
[S4] loaded HEAD from S2 (vec_in norm=1.978829)
[S4] cosine check vs S2: cos=0.9983
[S4] BUFFERED delta from S2 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.962894)
[S13] loaded HEAD from S17 (vec_in norm=1.962894)
[S13] cosine check vs S17: cos=0.5713
[S13] BUFFERED delta from S17 (total buffered=2)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.5510 head_norm=1.082447
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.998193e-01
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.5520 head_norm=1.210248 delta_norm=0.299819
[S13] aggregate: ACCEPT kept=['S3', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.4366 head_norm=1.403788
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.500861e-01
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.4366 head_norm=1.257526 delta_norm=0.850086
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=32 metric=0.9917 head_norm=1.428255
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.930453e-01
[S9] stored merged vector for next round verification (round=32)
[S9] DEBUG after merge:  round=32 metric=0.9930 head_norm=1.375889 delta_norm=0.293045
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9816 head_norm=2.016487
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.659969e-02
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9781 head_norm=2.000700 delta_norm=0.096600
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9508 head_norm=1.989483
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.786598e-02
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9502 head_norm=1.983319 delta_norm=0.057866
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.9837 head_norm=1.384911
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.338173e-02
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.9862 head_norm=1.389954 delta_norm=0.083382
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9914 head_norm=1.399954
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.434024e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9913 head_norm=1.283776 delta_norm=0.243402
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.978829 (no previous merge yet)
[S2] round=33 local utility u=0.039395 metrics={'f1_val': 0.8338738789612852, 'auprc': 0.918142930072256, 'loss_val': 0.37761140981600433, 'psi': 0.8675814994056735}-{'f1_val': 0.8317588621752648, 'auprc': 0.9124814789567354, 'loss_val': 0.4267271938113773, 'psi': 0.864047908887853}
[S3] START round=33 head_norm_before_train=1.957262 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.8846275026218483, 'auprc': 0.9988289407466476, 'loss_val': 0.20617696970249422, 'psi': 0.9303080778717681}-{'f1_val': 0.9879277725949749, 'auprc': 0.9992054829006619, 'loss_val': 0.08063770461048655, 'psi': 0.9924388567172496}
[S4] START round=33 head_norm_before_train=1.983319 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.041029 metrics={'f1_val': 0.9577453670135613, 'auprc': 0.9750098770531225, 'loss_val': 0.2380979460322399, 'psi': 0.9646511710293857}-{'f1_val': 0.9508005978451133, 'auprc': 0.966546706348763, 'loss_val': 0.2530986291956524, 'psi': 0.9570990412465732}
[S5] START round=33 head_norm_before_train=1.257526 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=1.000000 metrics={'f1_val': 0.6927848005761511, 'auprc': 0.8975550797507599, 'loss_val': 0.42445941692806516, 'psi': 0.7746929122459947}-{'f1_val': 0.4365551966379383, 'auprc': 0.7381113875184554, 'loss_val': 1.0394213535917696, 'psi': 0.5571776729901452}
[S6] START round=33 head_norm_before_train=1.624012 cos_to_last_merge=0.8209 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.821
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.8233815453261163, 'auprc': 0.9393812273611504, 'loss_val': 0.45922049455750397, 'psi': 0.86978141814013}-{'f1_val': 0.8234656829100886, 'auprc': 0.9556664283810029, 'loss_val': 0.33128365094114925, 'psi': 0.8763459810984543}
[S7] START round=33 head_norm_before_train=1.206143 cos_to_last_merge=0.9994 (last merge round=31)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.5848660262961416, 'auprc': 0.7900535109047443, 'loss_val': 0.7540903448541088, 'psi': 0.6669410201395827}-{'f1_val': 0.6586714463760815, 'auprc': 0.8346301271873869, 'loss_val': 0.5212303606411602, 'psi': 0.7290549187006037}
[S8] START round=33 head_norm_before_train=1.283776 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9935879766866298, 'auprc': 0.9966138571331519, 'loss_val': 0.13406016292524978, 'psi': 0.9947983288652387}-{'f1_val': 0.991372388611257, 'auprc': 0.9971536343139362, 'loss_val': 0.0917053786803427, 'psi': 0.9936848868923287}
[S9] START round=33 head_norm_before_train=1.375889 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=33 local utility u=0.003974 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9991744094467409, 'loss_val': 0.11504208014582518, 'psi': 0.9981966977850826}-{'f1_val': 0.9917060080596727, 'auprc': 0.9991093740403713, 'loss_val': 0.08776140385935606, 'psi': 0.9946673544519522}
[S10] START round=33 head_norm_before_train=1.780723 cos_to_last_merge=0.8009 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.801
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9963058978931338, 'loss_val': 0.03803477058536567, 'psi': 0.9958881512662654}-{'f1_val': 0.9955259082574451, 'auprc': 0.9965596788512361, 'loss_val': 0.03821818074272049, 'psi': 0.9959394164949615}
[S11] START round=33 head_norm_before_train=2.000700 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.066977 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980450581867664, 'loss_val': 0.06783364388855272, 'psi': 0.9971462259828603}-{'f1_val': 0.981602910314117, 'auprc': 0.9978947447342466, 'loss_val': 0.11167129708008354, 'psi': 0.9881196440821689}
[S13] START round=33 head_norm_before_train=1.210248 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.551502830998501, 'auprc': 0.6690814188602969, 'loss_val': 0.9816342393076152, 'psi': 0.5985342661432194}-{'f1_val': 0.5509779659027464, 'auprc': 0.6934646978829092, 'loss_val': 0.9272511440220401, 'psi': 0.6079726586948115}
[S14] START round=33 head_norm_before_train=2.032029 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9551677705862733, 'auprc': 0.9967793170368191, 'loss_val': 0.0654236075629086, 'psi': 0.9718123891664916}-{'f1_val': 0.9976511180498535, 'auprc': 0.9988512871165309, 'loss_val': 0.025338208429873617, 'psi': 0.9981311856765245}
[S15] START round=33 head_norm_before_train=1.389954 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.8248073997610387, 'auprc': 0.9965863930364727, 'loss_val': 0.28559208902892413, 'psi': 0.8935189970712123}-{'f1_val': 0.9836632781139562, 'auprc': 0.9968564157198058, 'loss_val': 0.16964166741666967, 'psi': 0.9889405331562959}
[S16] START round=33 head_norm_before_train=1.796416 cos_to_last_merge=0.7392 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.739
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8408782460677775, 'auprc': 0.9848807701159239, 'loss_val': 0.9825879962485559, 'psi': 0.8984792556870361}-{'f1_val': 0.92294537087489, 'auprc': 0.9908941399344678, 'loss_val': 0.3578731366922117, 'psi': 0.9501248784987212}
[S17] START round=33 head_norm_before_train=1.962894 (no previous merge yet)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.5428561254459382, 'auprc': 0.7857642955844344, 'loss_val': 0.9884486228565864, 'psi': 0.6400193935013367}-{'f1_val': 0.645657772486971, 'auprc': 0.9931511761426446, 'loss_val': 0.5433438063469435, 'psi': 0.7846551339492405}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61813
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:61805
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.403904)
[S11] loaded HEAD from S9 (vec_in norm=1.403904)
[S11] cosine check vs S9: cos=0.0090
[S11] BUFFERED delta from S9 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1802) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.274751)
[S13] loaded HEAD from S5 (vec_in norm=1.274751)
[S13] cosine check vs S5: cos=0.2007
[S13] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1793) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.997721)
[S11] loaded HEAD from S4 (vec_in norm=1.997721)
[S11] cosine check vs S4: cos=0.9972
[S11] BUFFERED delta from S4 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.022047)
[S5] loaded HEAD from S11 (vec_in norm=2.022047)
[S5] cosine check vs S11: cos=0.4695
[S5] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1805) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.988661)
[S4] loaded HEAD from S2 (vec_in norm=1.988661)
[S4] cosine check vs S2: cos=0.9991
[S4] BUFFERED delta from S2 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.5515 head_norm=1.231385
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.923316e-01
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.5541 head_norm=0.971010 delta_norm=0.792332
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=33 metric=0.9577 head_norm=1.997721
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.283585e-02
[S4] stored merged vector for next round verification (round=33)
[S4] DEBUG after merge:  round=33 metric=0.9577 head_norm=1.992736 delta_norm=0.042836
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9965 head_norm=2.022047
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.191754e-01
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9965 head_norm=1.552504 delta_norm=0.619175
[S11] aggregate: ACCEPT kept=['S9', 'S4'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.6928 head_norm=1.274751
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.073989e-01
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.7001 head_norm=1.425994 delta_norm=0.907399
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.988661 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6408633703348154, 'auprc': 0.7999093016743918, 'loss_val': 1.099514834801186, 'psi': 0.704481742870646}-{'f1_val': 0.8338738789612852, 'auprc': 0.918142930072256, 'loss_val': 0.37761140981600433, 'psi': 0.8675814994056735}
[S3] START round=34 head_norm_before_train=1.975019 (no previous merge yet)
[S3] round=34 local utility u=0.273672 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9988902971543723, 'loss_val': 0.11622977747599789, 'psi': 0.976053884244487}-{'f1_val': 0.8846275026218483, 'auprc': 0.9988289407466476, 'loss_val': 0.20617696970249422, 'psi': 0.9303080778717681}
[S4] START round=34 head_norm_before_train=1.992736 cos_to_last_merge=1.0000 (last merge round=33)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9530213502856933, 'auprc': 0.9640442694150626, 'loss_val': 0.24905951784960062, 'psi': 0.9574305179374409}-{'f1_val': 0.9577453670135613, 'auprc': 0.9750098770531225, 'loss_val': 0.2380979460322399, 'psi': 0.9646511710293857}
[S5] START round=34 head_norm_before_train=1.425994 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.6411230375440802, 'auprc': 0.7999060304603958, 'loss_val': 0.6325955175088674, 'psi': 0.7046362347106064}-{'f1_val': 0.6927848005761511, 'auprc': 0.8975550797507599, 'loss_val': 0.42445941692806516, 'psi': 0.7746929122459947}
[S6] START round=34 head_norm_before_train=1.635872 cos_to_last_merge=0.8194 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.819
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.7659282563455864, 'auprc': 0.9522477622586959, 'loss_val': 0.597394254518641, 'psi': 0.8404560587108302}-{'f1_val': 0.8233815453261163, 'auprc': 0.9393812273611504, 'loss_val': 0.45922049455750397, 'psi': 0.86978141814013}
[S7] START round=34 head_norm_before_train=1.230377 cos_to_last_merge=0.9978 (last merge round=31)
[S7] round=34 local utility u=0.217396 metrics={'f1_val': 0.6245280324067932, 'auprc': 0.8100827458101254, 'loss_val': 0.6173573965956001, 'psi': 0.6987499177681261}-{'f1_val': 0.5848660262961416, 'auprc': 0.7900535109047443, 'loss_val': 0.7540903448541088, 'psi': 0.6669410201395827}
[S8] START round=34 head_norm_before_train=1.319727 cos_to_last_merge=0.9993 (last merge round=32)
[S8] round=34 local utility u=0.005624 metrics={'f1_val': 0.9910113370052481, 'auprc': 0.9975736226726095, 'loss_val': 0.11023080942555448, 'psi': 0.9936362512721927}-{'f1_val': 0.9935879766866298, 'auprc': 0.9966138571331519, 'loss_val': 0.13406016292524978, 'psi': 0.9947983288652387}
[S9] START round=34 head_norm_before_train=1.403904 cos_to_last_merge=0.9996 (last merge round=32)
[S9] round=34 local utility u=0.011066 metrics={'f1_val': 0.9975426610709598, 'auprc': 0.9981600883159152, 'loss_val': 0.08985415581841677, 'psi': 0.997789631968942}-{'f1_val': 0.9975448900106438, 'auprc': 0.9991744094467409, 'loss_val': 0.11504208014582518, 'psi': 0.9981966977850826}
[S10] START round=34 head_norm_before_train=1.799989 cos_to_last_merge=0.7991 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.799
[S10] round=34 local utility u=0.000780 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9963754019080134, 'loss_val': 0.035365561009393635, 'psi': 0.995784161379638}-{'f1_val': 0.9956096535150197, 'auprc': 0.9963058978931338, 'loss_val': 0.03803477058536567, 'psi': 0.9958881512662654}
[S11] START round=34 head_norm_before_train=1.552504 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9273176436195846, 'auprc': 0.9946629430021877, 'loss_val': 0.3259331443419198, 'psi': 0.9542557633726259}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980450581867664, 'loss_val': 0.06783364388855272, 'psi': 0.9971462259828603}
[S13] START round=34 head_norm_before_train=0.971010 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5397547440729298, 'auprc': 0.6093255498419983, 'loss_val': 0.8864960555218927, 'psi': 0.5675830663805572}-{'f1_val': 0.551502830998501, 'auprc': 0.6690814188602969, 'loss_val': 0.9816342393076152, 'psi': 0.5985342661432194}
[S14] START round=34 head_norm_before_train=2.040015 (no previous merge yet)
[S14] round=34 local utility u=0.141272 metrics={'f1_val': 0.9967964825856885, 'auprc': 0.9971566379640837, 'loss_val': 0.03378387375881084, 'psi': 0.9969405447370465}-{'f1_val': 0.9551677705862733, 'auprc': 0.9967793170368191, 'loss_val': 0.0654236075629086, 'psi': 0.9718123891664916}
[S15] START round=34 head_norm_before_train=1.430381 cos_to_last_merge=0.9991 (last merge round=32)
[S15] round=34 local utility u=0.386399 metrics={'f1_val': 0.9452943144407326, 'auprc': 0.9989930036013458, 'loss_val': 0.24293508158400764, 'psi': 0.9667737901049779}-{'f1_val': 0.8248073997610387, 'auprc': 0.9965863930364727, 'loss_val': 0.28559208902892413, 'psi': 0.8935189970712123}
[S16] START round=34 head_norm_before_train=1.811415 cos_to_last_merge=0.7381 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.738
[S16] round=34 local utility u=0.718048 metrics={'f1_val': 0.9439918421316751, 'auprc': 0.9902841441202793, 'loss_val': 0.18138332919228176, 'psi': 0.9625087629271167}-{'f1_val': 0.8408782460677775, 'auprc': 0.9848807701159239, 'loss_val': 0.9825879962485559, 'psi': 0.8984792556870361}
[S17] START round=34 head_norm_before_train=1.977124 (no previous merge yet)
[S17] round=34 local utility u=0.753443 metrics={'f1_val': 0.6642872679995707, 'auprc': 0.8826642182338766, 'loss_val': 0.5008492484487999, 'psi': 0.7516380480932932}-{'f1_val': 0.5428561254459382, 'auprc': 0.7857642955844344, 'loss_val': 0.9884486228565864, 'psi': 0.6400193935013367}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61809
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:61810
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.047583)
[S7] loaded HEAD from S14 (vec_in norm=2.047583)
[S7] cosine check vs S14: cos=0.9020
[S7] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1803) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.824255)
[S2] loaded HEAD from S16 (vec_in norm=1.824255)
[S2] cosine check vs S16: cos=-0.1062
[S2] DROPPED delta from S16 (cos=-0.1062 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.816682)
[S4] loaded HEAD from S10 (vec_in norm=1.816682)
[S4] cosine check vs S10: cos=-0.0512
[S4] DROPPED delta from S10 (cos=-0.0512 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S3
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.992550)
[S13] loaded HEAD from S3 (vec_in norm=1.992550)
[S13] cosine check vs S3: cos=0.5023
[S13] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.356257)
[S15] loaded HEAD from S8 (vec_in norm=1.356257)
[S15] cosine check vs S8: cos=0.9849
[S15] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.469360)
[S9] loaded HEAD from S15 (vec_in norm=1.469360)
[S9] cosine check vs S15: cos=0.9696
[S9] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.255635)
[S8] loaded HEAD from S7 (vec_in norm=1.255635)
[S8] cosine check vs S7: cos=0.9716
[S8] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.988489)
[S13] loaded HEAD from S17 (vec_in norm=1.988489)
[S13] cosine check vs S17: cos=0.4313
[S13] BUFFERED delta from S17 (total buffered=2)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=34 metric=0.5398 head_norm=0.993052
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.320678e-01
[S13] stored merged vector for next round verification (round=34)
[S13] DEBUG after merge:  round=34 metric=0.5463 head_norm=1.098115 delta_norm=0.532068
[S13] aggregate: ACCEPT kept=['S3', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=34 metric=0.9975 head_norm=1.438625
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.798795e-01
[S9] stored merged vector for next round verification (round=34)
[S9] DEBUG after merge:  round=34 metric=0.9975 head_norm=1.442905 delta_norm=0.179879
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.9453 head_norm=1.469360
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.349650e-01
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.9330 head_norm=1.407484 delta_norm=0.134965
[S15] aggregate: ROLLBACK (f1_val pre=0.945 post=0.933 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9910 head_norm=1.356257
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.635155e-01
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9907 head_norm=1.296646 delta_norm=0.163515
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.6245 head_norm=1.255635
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.317143e-01
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.6075 head_norm=1.613037 delta_norm=0.531714
[S7] aggregate: ROLLBACK (f1_val pre=0.625 post=0.608 tol_abs=0.005 tol_rel=0.0)
[S2] START round=35 head_norm_before_train=1.997375 (no previous merge yet)
[S2] round=35 local utility u=0.968051 metrics={'f1_val': 0.815151042556463, 'auprc': 0.8932846671348967, 'loss_val': 0.48926506861590013, 'psi': 0.8464044923878364}-{'f1_val': 0.6408633703348154, 'auprc': 0.7999093016743918, 'loss_val': 1.099514834801186, 'psi': 0.704481742870646}
[S3] START round=35 head_norm_before_train=1.992550 (no previous merge yet)
[S3] round=35 local utility u=0.060580 metrics={'f1_val': 0.9724918820927569, 'auprc': 0.9991993110479498, 'loss_val': 0.06597116469679244, 'psi': 0.9831748536748341}-{'f1_val': 0.9608296089712303, 'auprc': 0.9988902971543723, 'loss_val': 0.11622977747599789, 'psi': 0.976053884244487}
[S4] START round=35 head_norm_before_train=2.002547 cos_to_last_merge=1.0000 (last merge round=33)
[S4] round=35 local utility u=0.001625 metrics={'f1_val': 0.9522001826499246, 'auprc': 0.9674765007892044, 'loss_val': 0.2511789041034228, 'psi': 0.9583107099056365}-{'f1_val': 0.9530213502856933, 'auprc': 0.9640442694150626, 'loss_val': 0.24905951784960062, 'psi': 0.9574305179374409}
[S5] START round=35 head_norm_before_train=1.442959 cos_to_last_merge=0.9996 (last merge round=33)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.5423329064229472, 'auprc': 0.7778374884588084, 'loss_val': 0.8303260250086048, 'psi': 0.6365347392372918}-{'f1_val': 0.6411230375440802, 'auprc': 0.7999060304603958, 'loss_val': 0.6325955175088674, 'psi': 0.7046362347106064}
[S6] START round=35 head_norm_before_train=1.645271 cos_to_last_merge=0.8184 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.818
[S6] round=35 local utility u=0.156514 metrics={'f1_val': 0.7769718022237989, 'auprc': 0.9637906575565931, 'loss_val': 0.385255686953051, 'psi': 0.8516993443569165}-{'f1_val': 0.7659282563455864, 'auprc': 0.9522477622586959, 'loss_val': 0.597394254518641, 'psi': 0.8404560587108302}
[S7] START round=35 head_norm_before_train=1.613037 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5042185117403346, 'auprc': 0.78630323532417, 'loss_val': 0.8565299905573465, 'psi': 0.6170524011738687}-{'f1_val': 0.6245280324067932, 'auprc': 0.8100827458101254, 'loss_val': 0.6173573965956001, 'psi': 0.6987499177681261}
[S8] START round=35 head_norm_before_train=1.296646 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9920222688347867, 'auprc': 0.9965017626989323, 'loss_val': 0.13920292975899162, 'psi': 0.9938140663804449}-{'f1_val': 0.9910113370052481, 'auprc': 0.9975736226726095, 'loss_val': 0.11023080942555448, 'psi': 0.9936362512721927}
[S9] START round=35 head_norm_before_train=1.442905 cos_to_last_merge=1.0000 (last merge round=34)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9964322618366963, 'loss_val': 0.10066214284058456, 'psi': 0.9970998387410648}-{'f1_val': 0.9975426610709598, 'auprc': 0.9981600883159152, 'loss_val': 0.08985415581841677, 'psi': 0.997789631968942}
[S10] START round=35 head_norm_before_train=1.816682 cos_to_last_merge=0.7977 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.798
[S10] round=35 local utility u=0.001082 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9965368671303377, 'loss_val': 0.033686241290662965, 'psi': 0.9958487474685678}-{'f1_val': 0.9953900010273877, 'auprc': 0.9963754019080134, 'loss_val': 0.035365561009393635, 'psi': 0.995784161379638}
[S11] START round=35 head_norm_before_train=1.575961 cos_to_last_merge=0.9996 (last merge round=33)
[S11] round=35 local utility u=0.313079 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.996992697373661, 'loss_val': 0.1182101241601106, 'psi': 0.9963321816706128}-{'f1_val': 0.9273176436195846, 'auprc': 0.9946629430021877, 'loss_val': 0.3259331443419198, 'psi': 0.9542557633726259}
[S13] START round=35 head_norm_before_train=1.098115 cos_to_last_merge=1.0000 (last merge round=34)
[S13] round=35 local utility u=0.072787 metrics={'f1_val': 0.5484167742906555, 'auprc': 0.6837175445425634, 'loss_val': 1.0160704963383427, 'psi': 0.6025370823914187}-{'f1_val': 0.5397547440729298, 'auprc': 0.6093255498419983, 'loss_val': 0.8864960555218927, 'psi': 0.5675830663805572}
[S14] START round=35 head_norm_before_train=2.047583 (no previous merge yet)
[S14] round=35 local utility u=0.002890 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.996456693548196, 'loss_val': 0.027129836361616807, 'psi': 0.9967831053478251}-{'f1_val': 0.9967964825856885, 'auprc': 0.9971566379640837, 'loss_val': 0.03378387375881084, 'psi': 0.9969405447370465}
[S15] START round=35 head_norm_before_train=1.407484 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.9010660648665729, 'auprc': 0.996155037492846, 'loss_val': 0.24326536707073299, 'psi': 0.9391016539170821}-{'f1_val': 0.9452943144407326, 'auprc': 0.9989930036013458, 'loss_val': 0.24293508158400764, 'psi': 0.9667737901049779}
[S16] START round=35 head_norm_before_train=1.824255 cos_to_last_merge=0.7377 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.738
[S16] round=35 local utility u=0.197178 metrics={'f1_val': 0.9890467329492871, 'auprc': 0.9919187401591533, 'loss_val': 0.062261131280860464, 'psi': 0.9901955358332336}-{'f1_val': 0.9439918421316751, 'auprc': 0.9902841441202793, 'loss_val': 0.18138332919228176, 'psi': 0.9625087629271167}
[S17] START round=35 head_norm_before_train=1.988489 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.5783648604004117, 'auprc': 0.9378253634848485, 'loss_val': 0.9986524908847835, 'psi': 0.7221490616341864}-{'f1_val': 0.6642872679995707, 'auprc': 0.8826642182338766, 'loss_val': 0.5008492484487999, 'psi': 0.7516380480932932}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:61802
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.605745)
[S9] loaded HEAD from S11 (vec_in norm=1.605745)
[S9] cosine check vs S11: cos=0.2460
[S9] BUFFERED delta from S11 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1804) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.001929)
[S9] loaded HEAD from S2 (vec_in norm=2.001929)
[S9] cosine check vs S2: cos=0.0226
[S9] BUFFERED delta from S2 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1798) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.127077)
[S5] loaded HEAD from S13 (vec_in norm=1.127077)
[S5] cosine check vs S13: cos=0.2482
[S5] BUFFERED delta from S13 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.013328)
[S2] loaded HEAD from S4 (vec_in norm=2.013328)
[S2] cosine check vs S4: cos=0.9991
[S2] BUFFERED delta from S4 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.033 → S7@127.0.0.1:61808
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.5423 head_norm=1.462349
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.047755e-01
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.4448 head_norm=1.027969 delta_norm=0.804775
[S5] aggregate: ROLLBACK (f1_val pre=0.542 post=0.445 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.220 → S6@127.0.0.1:61807
[S15] ⇄ pheromone p=0.163 → S8@127.0.0.1:61809
[S7] ⇄ pheromone p=0.150 → S13@127.0.0.1:61813
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=35 metric=0.9975 head_norm=1.475474
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.087043e+00
[S9] stored merged vector for next round verification (round=35)
[S9] DEBUG after merge:  round=35 metric=0.9973 head_norm=1.227385 delta_norm=1.087043
[S9] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.034 → S15@127.0.0.1:61815
[S4] ⇄ pheromone p=0.032 → S2@127.0.0.1:61802
[S13] ⇄ pheromone p=0.046 → S5@127.0.0.1:61805
[S11] ⇄ pheromone p=0.097 → S9@127.0.0.1:61810
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=35 metric=0.8152 head_norm=2.001929
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.404492e-02
[S2] stored merged vector for next round verification (round=35)
[S2] DEBUG after merge:  round=35 metric=0.8150 head_norm=2.007153 delta_norm=0.044045
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.289 → S16@127.0.0.1:61816
[S2] START round=36 head_norm_before_train=2.007153 cos_to_last_merge=1.0000 (last merge round=35)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.829207859469431, 'auprc': 0.797314874550308, 'loss_val': 0.3872902756739948, 'psi': 0.8164506655017818}-{'f1_val': 0.815151042556463, 'auprc': 0.8932846671348967, 'loss_val': 0.48926506861590013, 'psi': 0.8464044923878364}
[S3] START round=36 head_norm_before_train=2.009176 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.8556228482435104, 'auprc': 0.9982804130750916, 'loss_val': 0.24806947938348226, 'psi': 0.9126858741761429}-{'f1_val': 0.9724918820927569, 'auprc': 0.9991993110479498, 'loss_val': 0.06597116469679244, 'psi': 0.9831748536748341}
[S4] START round=36 head_norm_before_train=2.013328 cos_to_last_merge=0.9998 (last merge round=33)
[S4] round=36 local utility u=0.005158 metrics={'f1_val': 0.9555585568213992, 'auprc': 0.964431832076289, 'loss_val': 0.2518796412687463, 'psi': 0.9591078669233551}-{'f1_val': 0.9522001826499246, 'auprc': 0.9674765007892044, 'loss_val': 0.2511789041034228, 'psi': 0.9583107099056365}
[S5] START round=36 head_norm_before_train=1.027969 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.891331 metrics={'f1_val': 0.703235348071503, 'auprc': 0.929026340990858, 'loss_val': 0.466644963957741, 'psi': 0.7935517452392451}-{'f1_val': 0.5423329064229472, 'auprc': 0.7778374884588084, 'loss_val': 0.8303260250086048, 'psi': 0.6365347392372918}
[S6] START round=36 head_norm_before_train=1.657429 cos_to_last_merge=0.8170 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.817
[S6] round=36 local utility u=0.084856 metrics={'f1_val': 0.8263477162590147, 'auprc': 0.9513478459042785, 'loss_val': 0.47447088253015857, 'psi': 0.8763477681171201}-{'f1_val': 0.7769718022237989, 'auprc': 0.9637906575565931, 'loss_val': 0.385255686953051, 'psi': 0.8516993443569165}
[S7] START round=36 head_norm_before_train=1.628842 cos_to_last_merge=0.9999 (last merge round=34)
[S7] round=36 local utility u=0.324509 metrics={'f1_val': 0.5867593330204215, 'auprc': 0.7933720330202896, 'loss_val': 0.7239631067124582, 'psi': 0.6694044130203687}-{'f1_val': 0.5042185117403346, 'auprc': 0.78630323532417, 'loss_val': 0.8565299905573465, 'psi': 0.6170524011738687}
[S8] START round=36 head_norm_before_train=1.330023 cos_to_last_merge=0.9994 (last merge round=34)
[S8] round=36 local utility u=0.009624 metrics={'f1_val': 0.9931722166739475, 'auprc': 0.9929798939539001, 'loss_val': 0.11628893463055277, 'psi': 0.9930952875859285}-{'f1_val': 0.9920222688347867, 'auprc': 0.9965017626989323, 'loss_val': 0.13920292975899162, 'psi': 0.9938140663804449}
[S9] START round=36 head_norm_before_train=1.227385 cos_to_last_merge=1.0000 (last merge round=35)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9946798336032436, 'loss_val': 0.35725655486958013, 'psi': 0.9963988674476837}-{'f1_val': 0.9975448900106438, 'auprc': 0.9964322618366963, 'loss_val': 0.10066214284058456, 'psi': 0.9970998387410648}
[S10] START round=36 head_norm_before_train=1.828855 cos_to_last_merge=0.7966 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.797
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9965495518419036, 'loss_val': 0.03244657682907525, 'psi': 0.9957220749657718}-{'f1_val': 0.9953900010273877, 'auprc': 0.9965368671303377, 'loss_val': 0.033686241290662965, 'psi': 0.9958487474685678}
[S11] START round=36 head_norm_before_train=1.605745 cos_to_last_merge=0.9982 (last merge round=33)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9884884759578287, 'auprc': 0.9975735731368283, 'loss_val': 0.10677905309124745, 'psi': 0.9921225148294286}-{'f1_val': 0.9958918378685807, 'auprc': 0.996992697373661, 'loss_val': 0.1182101241601106, 'psi': 0.9963321816706128}
[S13] START round=36 head_norm_before_train=1.127077 cos_to_last_merge=0.9992 (last merge round=34)
[S13] round=36 local utility u=0.071046 metrics={'f1_val': 0.5579220945588886, 'auprc': 0.6799970407751031, 'loss_val': 0.9198479098180387, 'psi': 0.6067520730453744}-{'f1_val': 0.5484167742906555, 'auprc': 0.6837175445425634, 'loss_val': 1.0160704963383427, 'psi': 0.6025370823914187}
[S14] START round=36 head_norm_before_train=2.056909 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.995433237369188, 'loss_val': 0.0267463859329394, 'psi': 0.9965194320050985}-{'f1_val': 0.9970007132142444, 'auprc': 0.996456693548196, 'loss_val': 0.027129836361616807, 'psi': 0.9967831053478251}
[S15] START round=36 head_norm_before_train=1.443134 cos_to_last_merge=0.9994 (last merge round=34)
[S15] round=36 local utility u=0.025099 metrics={'f1_val': 0.9027662409683824, 'auprc': 0.9968067379526899, 'loss_val': 0.20522330519204462, 'psi': 0.9403824397621054}-{'f1_val': 0.9010660648665729, 'auprc': 0.996155037492846, 'loss_val': 0.24326536707073299, 'psi': 0.9391016539170821}
[S16] START round=36 head_norm_before_train=1.834433 cos_to_last_merge=0.7381 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.738
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9285248644192834, 'auprc': 0.9933917860831154, 'loss_val': 0.3891725946254729, 'psi': 0.9544716330848162}-{'f1_val': 0.9890467329492871, 'auprc': 0.9919187401591533, 'loss_val': 0.062261131280860464, 'psi': 0.9901955358332336}
[S17] START round=36 head_norm_before_train=1.998074 (no previous merge yet)
[S17] round=36 local utility u=0.222791 metrics={'f1_val': 0.5967906604122235, 'auprc': 0.987501706125094, 'loss_val': 0.8126543734243606, 'psi': 0.7530750786973717}-{'f1_val': 0.5783648604004117, 'auprc': 0.9378253634848485, 'loss_val': 0.9986524908847835, 'psi': 0.7221490616341864}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.959)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.607)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:61809
[S6] not sending this round → trigger blocked (psi=0.876)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:61807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61815
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61813
[S8] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.364371)
[S15] loaded HEAD from S8 (vec_in norm=1.364371)
[S15] cosine check vs S8: cos=0.9824
[S15] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.644843)
[S13] loaded HEAD from S7 (vec_in norm=1.644843)
[S13] cosine check vs S7: cos=0.0492
[S13] BUFFERED delta from S7 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.482395)
[S8] loaded HEAD from S15 (vec_in norm=1.482395)
[S8] cosine check vs S15: cos=0.9824
[S8] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S5
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.057112)
[S6] loaded HEAD from S5 (vec_in norm=1.057112)
[S6] cosine check vs S5: cos=0.4636
[S6] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.8263 head_norm=1.668954
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.528278e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.8197 head_norm=1.176731 delta_norm=0.752828
[S6] aggregate: ROLLBACK (f1_val pre=0.826 post=0.820 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=36 metric=0.5579 head_norm=1.155323
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.815133e-01
[S13] stored merged vector for next round verification (round=36)
[S13] DEBUG after merge:  round=36 metric=0.5559 head_norm=1.027994 delta_norm=0.981513
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.9028 head_norm=1.482395
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.457713e-01
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.9028 head_norm=1.417128 delta_norm=0.145771
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=36 metric=0.9932 head_norm=1.364371
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.457713e-01
[S8] stored merged vector for next round verification (round=36)
[S8] DEBUG after merge:  round=36 metric=0.9937 head_norm=1.417128 delta_norm=0.145771
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=2.012398 cos_to_last_merge=1.0000 (last merge round=35)
[S2] round=37 local utility u=0.117537 metrics={'f1_val': 0.8313749387937176, 'auprc': 0.8809267299530613, 'loss_val': 0.41605407544218226, 'psi': 0.8511956552574551}-{'f1_val': 0.829207859469431, 'auprc': 0.797314874550308, 'loss_val': 0.3872902756739948, 'psi': 0.8164506655017818}
[S3] START round=37 head_norm_before_train=2.024379 (no previous merge yet)
[S3] round=37 local utility u=0.202451 metrics={'f1_val': 0.9110836663512779, 'auprc': 0.99909066413694, 'loss_val': 0.17836308323761146, 'psi': 0.9462864654655427}-{'f1_val': 0.8556228482435104, 'auprc': 0.9982804130750916, 'loss_val': 0.24806947938348226, 'psi': 0.9126858741761429}
[S4] START round=37 head_norm_before_train=2.025950 cos_to_last_merge=0.9995 (last merge round=33)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9559734843737651, 'auprc': 0.9641015496777962, 'loss_val': 0.2536940761604917, 'psi': 0.9592247104953775}-{'f1_val': 0.9555585568213992, 'auprc': 0.964431832076289, 'loss_val': 0.2518796412687463, 'psi': 0.9591078669233551}
[S5] START round=37 head_norm_before_train=1.057112 cos_to_last_merge=0.9987 (last merge round=35)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.8374611308234718, 'loss_val': 0.46949187128744607, 'psi': 0.755177242789737}-{'f1_val': 0.703235348071503, 'auprc': 0.929026340990858, 'loss_val': 0.466644963957741, 'psi': 0.7935517452392451}
[S6] START round=37 head_norm_before_train=1.176731 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.127634 metrics={'f1_val': 0.8482627265739614, 'auprc': 0.9533361953711753, 'loss_val': 0.35665821978158474, 'psi': 0.890292114092847}-{'f1_val': 0.8263477162590147, 'auprc': 0.9513478459042785, 'loss_val': 0.47447088253015857, 'psi': 0.8763477681171201}
[S7] START round=37 head_norm_before_train=1.644843 cos_to_last_merge=0.9996 (last merge round=34)
[S7] round=37 local utility u=0.041158 metrics={'f1_val': 0.5934596255457654, 'auprc': 0.796560753778299, 'loss_val': 0.6914158710031696, 'psi': 0.6747000768387789}-{'f1_val': 0.5867593330204215, 'auprc': 0.7933720330202896, 'loss_val': 0.7239631067124582, 'psi': 0.6694044130203687}
[S8] START round=37 head_norm_before_train=1.417128 cos_to_last_merge=1.0000 (last merge round=36)
[S8] round=37 local utility u=0.024532 metrics={'f1_val': 0.9920979054933599, 'auprc': 0.9984747087220477, 'loss_val': 0.07726385771262256, 'psi': 0.994648626784835}-{'f1_val': 0.9931722166739475, 'auprc': 0.9929798939539001, 'loss_val': 0.11628893463055277, 'psi': 0.9930952875859285}
[S9] START round=37 head_norm_before_train=1.252428 cos_to_last_merge=0.9983 (last merge round=35)
[S9] round=37 local utility u=0.063266 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9949771078888157, 'loss_val': 0.23161574632864415, 'psi': 0.9965177771619125}-{'f1_val': 0.9975448900106438, 'auprc': 0.9946798336032436, 'loss_val': 0.35725655486958013, 'psi': 0.9963988674476837}
[S10] START round=37 head_norm_before_train=1.841347 cos_to_last_merge=0.7955 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.796
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9954434196706116, 'loss_val': 0.03477531958714439, 'psi': 0.9955431599772565}-{'f1_val': 0.9951704237150173, 'auprc': 0.9965495518419036, 'loss_val': 0.03244657682907525, 'psi': 0.9957220749657718}
[S11] START round=37 head_norm_before_train=1.639730 cos_to_last_merge=0.9961 (last merge round=33)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9421550772337604, 'auprc': 0.9971256467283018, 'loss_val': 0.21410190387610226, 'psi': 0.964143305031577}-{'f1_val': 0.9884884759578287, 'auprc': 0.9975735731368283, 'loss_val': 0.10677905309124745, 'psi': 0.9921225148294286}
[S13] START round=37 head_norm_before_train=1.027994 cos_to_last_merge=1.0000 (last merge round=36)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5478483465557522, 'auprc': 0.6589877150749309, 'loss_val': 0.8942084133912691, 'psi': 0.5923040939634237}-{'f1_val': 0.5579220945588886, 'auprc': 0.6799970407751031, 'loss_val': 0.9198479098180387, 'psi': 0.6067520730453744}
[S14] START round=37 head_norm_before_train=2.068631 (no previous merge yet)
[S14] round=37 local utility u=0.005629 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9978426626197641, 'loss_val': 0.025179172855910918, 'psi': 0.9977293707374792}-{'f1_val': 0.9972435617623723, 'auprc': 0.995433237369188, 'loss_val': 0.0267463859329394, 'psi': 0.9965194320050985}
[S15] START round=37 head_norm_before_train=1.417128 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=0.077081 metrics={'f1_val': 0.9207880879017754, 'auprc': 0.9979197217970173, 'loss_val': 0.16253144323352378, 'psi': 0.9516407414598721}-{'f1_val': 0.9027662409683824, 'auprc': 0.9968067379526899, 'loss_val': 0.20522330519204462, 'psi': 0.9403824397621054}
[S16] START round=37 head_norm_before_train=1.844011 cos_to_last_merge=0.7385 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.738
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8314359494141932, 'auprc': 0.8558138789121493, 'loss_val': 1.218471641627949, 'psi': 0.8411871212133757}-{'f1_val': 0.9285248644192834, 'auprc': 0.9933917860831154, 'loss_val': 0.3891725946254729, 'psi': 0.9544716330848162}
[S17] START round=37 head_norm_before_train=2.008404 (no previous merge yet)
[S17] round=37 local utility u=0.481161 metrics={'f1_val': 0.7145470635893465, 'auprc': 0.9842633420227676, 'loss_val': 0.5471553278891278, 'psi': 0.822433574962715}-{'f1_val': 0.5967906604122235, 'auprc': 0.987501706125094, 'loss_val': 0.8126543734243606, 'psi': 0.7530750786973717}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:61805
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:61816
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.017903)
[S16] loaded HEAD from S2 (vec_in norm=2.017903)
[S16] cosine check vs S2: cos=-0.1048
[S16] DROPPED delta from S2 (cos=-0.1048 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.452222)
[S15] loaded HEAD from S8 (vec_in norm=1.452222)
[S15] cosine check vs S8: cos=0.9993
[S15] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.291263)
[S15] loaded HEAD from S9 (vec_in norm=1.291263)
[S15] cosine check vs S9: cos=0.7393
[S15] BUFFERED delta from S9 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.657846)
[S13] loaded HEAD from S7 (vec_in norm=1.657846)
[S13] cosine check vs S7: cos=0.8142
[S13] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1803) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.201344)
[S5] loaded HEAD from S6 (vec_in norm=1.201344)
[S5] cosine check vs S6: cos=0.7785
[S5] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.455251)
[S8] loaded HEAD from S15 (vec_in norm=1.455251)
[S8] cosine check vs S15: cos=0.9993
[S8] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=37 metric=0.7003 head_norm=1.085876
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.844344e-01
[S5] stored merged vector for next round verification (round=37)
[S5] DEBUG after merge:  round=37 metric=0.7003 head_norm=1.078604 delta_norm=0.384434
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=37 metric=0.5478 head_norm=1.052507
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.036611e-01
[S13] stored merged vector for next round verification (round=37)
[S13] DEBUG after merge:  round=37 metric=0.5451 head_norm=1.294001 delta_norm=0.503661
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=37 metric=0.9208 head_norm=1.455251
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.506084e-01
[S15] stored merged vector for next round verification (round=37)
[S15] DEBUG after merge:  round=37 metric=0.9240 head_norm=1.346580 delta_norm=0.250608
[S15] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.9921 head_norm=1.452222
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.782678e-02
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.9917 head_norm=1.453471 delta_norm=0.027827
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=2.017903 cos_to_last_merge=1.0000 (last merge round=35)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.8280413429764488, 'auprc': 0.8656927330758635, 'loss_val': 0.4151948060663705, 'psi': 0.8431018990162147}-{'f1_val': 0.8313749387937176, 'auprc': 0.8809267299530613, 'loss_val': 0.41605407544218226, 'psi': 0.8511956552574551}
[S3] START round=38 head_norm_before_train=2.038206 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.8765800998732931, 'auprc': 0.9984597488307435, 'loss_val': 0.21732902866035153, 'psi': 0.9253319594562732}-{'f1_val': 0.9110836663512779, 'auprc': 0.99909066413694, 'loss_val': 0.17836308323761146, 'psi': 0.9462864654655427}
[S4] START round=38 head_norm_before_train=2.034964 cos_to_last_merge=0.9990 (last merge round=33)
[S4] round=38 local utility u=0.002323 metrics={'f1_val': 0.9566213275235989, 'auprc': 0.9644111453717571, 'loss_val': 0.25386462185474845, 'psi': 0.9597372546628622}-{'f1_val': 0.9559734843737651, 'auprc': 0.9641015496777962, 'loss_val': 0.2536940761604917, 'psi': 0.9592247104953775}
[S5] START round=38 head_norm_before_train=1.078604 cos_to_last_merge=1.0000 (last merge round=37)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.5944685880439048, 'auprc': 0.7351274129120778, 'loss_val': 0.6748657901587952, 'psi': 0.650732117991174}-{'f1_val': 0.7003213174339138, 'auprc': 0.8374611308234718, 'loss_val': 0.46949187128744607, 'psi': 0.755177242789737}
[S6] START round=38 head_norm_before_train=1.201344 cos_to_last_merge=0.9998 (last merge round=36)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.7862870810577615, 'auprc': 0.951290768438275, 'loss_val': 0.5169750868526103, 'psi': 0.8522885560099669}-{'f1_val': 0.8482627265739614, 'auprc': 0.9533361953711753, 'loss_val': 0.35665821978158474, 'psi': 0.890292114092847}
[S7] START round=38 head_norm_before_train=1.657846 cos_to_last_merge=0.9992 (last merge round=34)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.4932905253709011, 'auprc': 0.7835050937390851, 'loss_val': 0.8905348440981732, 'psi': 0.6093763527181747}-{'f1_val': 0.5934596255457654, 'auprc': 0.796560753778299, 'loss_val': 0.6914158710031696, 'psi': 0.6747000768387789}
[S8] START round=38 head_norm_before_train=1.453471 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.003660 metrics={'f1_val': 0.9923740886046254, 'auprc': 0.997665753272418, 'loss_val': 0.06917322075291739, 'psi': 0.9944907544717425}-{'f1_val': 0.9920979054933599, 'auprc': 0.9984747087220477, 'loss_val': 0.07726385771262256, 'psi': 0.994648626784835}
[S9] START round=38 head_norm_before_train=1.291263 cos_to_last_merge=0.9917 (last merge round=35)
[S9] round=38 local utility u=0.046591 metrics={'f1_val': 0.9964645815439231, 'auprc': 0.9993573721062736, 'loss_val': 0.14509298410232083, 'psi': 0.9976216977688633}-{'f1_val': 0.9975448900106438, 'auprc': 0.9949771078888157, 'loss_val': 0.23161574632864415, 'psi': 0.9965177771619125}
[S10] START round=38 head_norm_before_train=1.850246 cos_to_last_merge=0.7947 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.795
[S10] round=38 local utility u=0.002639 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9965424961143907, 'loss_val': 0.031476875752081766, 'psi': 0.9958509990621889}-{'f1_val': 0.9956096535150197, 'auprc': 0.9954434196706116, 'loss_val': 0.03477531958714439, 'psi': 0.9955431599772565}
[S11] START round=38 head_norm_before_train=1.674080 cos_to_last_merge=0.9934 (last merge round=33)
[S11] round=38 local utility u=0.240863 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9967390645875059, 'loss_val': 0.057566977304451615, 'psi': 0.9966238285431561}-{'f1_val': 0.9421550772337604, 'auprc': 0.9971256467283018, 'loss_val': 0.21410190387610226, 'psi': 0.964143305031577}
[S13] START round=38 head_norm_before_train=1.294001 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5357139368699371, 'auprc': 0.5756164289380983, 'loss_val': 0.8913247785698081, 'psi': 0.5516749336972016}-{'f1_val': 0.5478483465557522, 'auprc': 0.6589877150749309, 'loss_val': 0.8942084133912691, 'psi': 0.5923040939634237}
[S14] START round=38 head_norm_before_train=2.079652 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9971571420504575, 'loss_val': 0.0317483594710677, 'psi': 0.9974403226571193}-{'f1_val': 0.9976538428159559, 'auprc': 0.9978426626197641, 'loss_val': 0.025179172855910918, 'psi': 0.9977293707374792}
[S15] START round=38 head_norm_before_train=1.346580 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=38 local utility u=0.170573 metrics={'f1_val': 0.9749723297864531, 'auprc': 0.9954940274165978, 'loss_val': 0.1392145256230756, 'psi': 0.9831810088385109}-{'f1_val': 0.9207880879017754, 'auprc': 0.9979197217970173, 'loss_val': 0.16253144323352378, 'psi': 0.9516407414598721}
[S16] START round=38 head_norm_before_train=1.851733 cos_to_last_merge=0.7390 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.739
[S16] round=38 local utility u=0.636744 metrics={'f1_val': 0.8786173654291694, 'auprc': 0.9930518991464351, 'loss_val': 0.6397869651235781, 'psi': 0.9243911789160757}-{'f1_val': 0.8314359494141932, 'auprc': 0.8558138789121493, 'loss_val': 1.218471641627949, 'psi': 0.8411871212133757}
[S17] START round=38 head_norm_before_train=2.017883 (no previous merge yet)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.5817259347863256, 'auprc': 0.8270793989879056, 'loss_val': 1.0720044934777415, 'psi': 0.6798673204669576}-{'f1_val': 0.7145470635893465, 'auprc': 0.9842633420227676, 'loss_val': 0.5471553278891278, 'psi': 0.822433574962715}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61815
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.483921)
[S15] loaded HEAD from S8 (vec_in norm=1.483921)
[S15] cosine check vs S8: cos=0.9860
[S15] BUFFERED delta from S8 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.044151)
[S2] loaded HEAD from S4 (vec_in norm=2.044151)
[S2] cosine check vs S4: cos=0.9985
[S2] BUFFERED delta from S4 (total buffered=1)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:61810
[S11] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.706545)
[S9] loaded HEAD from S11 (vec_in norm=1.706545)
[S9] cosine check vs S11: cos=0.7837
[S9] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:61815
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1806) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.341040)
[S15] loaded HEAD from S9 (vec_in norm=1.341040)
[S15] cosine check vs S9: cos=0.8434
[S15] BUFFERED delta from S9 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1800) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.386707)
[S8] loaded HEAD from S15 (vec_in norm=1.386707)
[S8] cosine check vs S15: cos=0.9860
[S8] BUFFERED delta from S15 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:61802
[S16] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.861455)
[S2] loaded HEAD from S16 (vec_in norm=1.861455)
[S2] cosine check vs S16: cos=-0.1042
[S2] DROPPED delta from S16 (cos=-0.1042 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=38 metric=0.8280 head_norm=2.023531
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.675849e-02
[S2] stored merged vector for next round verification (round=38)
[S2] DEBUG after merge:  round=38 metric=0.8283 head_norm=2.033075 delta_norm=0.056758
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=38 metric=0.9924 head_norm=1.483921
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.295175e-01
[S8] stored merged vector for next round verification (round=38)
[S8] DEBUG after merge:  round=38 metric=0.9924 head_norm=1.430285 delta_norm=0.129517
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=38 metric=0.9965 head_norm=1.341040
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.300554e-01
[S9] stored merged vector for next round verification (round=38)
[S9] DEBUG after merge:  round=38 metric=0.9965 head_norm=1.440272 delta_norm=0.530055
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.9750 head_norm=1.386707
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.302826e-01
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.9785 head_norm=1.347460 delta_norm=0.130283
[S15] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=2.033075 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.5728573098188738, 'auprc': 0.7667762920266016, 'loss_val': 1.4862378182262899, 'psi': 0.650424902701965}-{'f1_val': 0.8280413429764488, 'auprc': 0.8656927330758635, 'loss_val': 0.4151948060663705, 'psi': 0.8431018990162147}
[S3] START round=39 head_norm_before_train=2.052028 (no previous merge yet)
[S3] round=39 local utility u=0.256555 metrics={'f1_val': 0.9438037858834424, 'auprc': 0.9988591678589512, 'loss_val': 0.10875988410255812, 'psi': 0.9658259386736459}-{'f1_val': 0.8765800998732931, 'auprc': 0.9984597488307435, 'loss_val': 0.21732902866035153, 'psi': 0.9253319594562732}
[S4] START round=39 head_norm_before_train=2.044151 cos_to_last_merge=0.9986 (last merge round=33)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9521753011907641, 'auprc': 0.9514850661321383, 'loss_val': 0.2673274721613216, 'psi': 0.9518992071673138}-{'f1_val': 0.9566213275235989, 'auprc': 0.9644111453717571, 'loss_val': 0.25386462185474845, 'psi': 0.9597372546628622}
[S5] START round=39 head_norm_before_train=1.105550 cos_to_last_merge=0.9994 (last merge round=37)
[S5] round=39 local utility u=0.897233 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9950243695491081, 'loss_val': 0.29520788645318335, 'psi': 0.8182025382799916}-{'f1_val': 0.5944685880439048, 'auprc': 0.7351274129120778, 'loss_val': 0.6748657901587952, 'psi': 0.650732117991174}
[S6] START round=39 head_norm_before_train=1.240595 cos_to_last_merge=0.9990 (last merge round=36)
[S6] round=39 local utility u=0.012600 metrics={'f1_val': 0.7915192782612889, 'auprc': 0.946497171689742, 'loss_val': 0.5087881976888539, 'psi': 0.8535104356326702}-{'f1_val': 0.7862870810577615, 'auprc': 0.951290768438275, 'loss_val': 0.5169750868526103, 'psi': 0.8522885560099669}
[S7] START round=39 head_norm_before_train=1.668613 cos_to_last_merge=0.9988 (last merge round=34)
[S7] round=39 local utility u=0.867221 metrics={'f1_val': 0.6683441865171511, 'auprc': 0.8412179148545093, 'loss_val': 0.37955383869899295, 'psi': 0.7374936778520944}-{'f1_val': 0.4932905253709011, 'auprc': 0.7835050937390851, 'loss_val': 0.8905348440981732, 'psi': 0.6093763527181747}
[S8] START round=39 head_norm_before_train=1.430285 cos_to_last_merge=1.0000 (last merge round=38)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9891389744852626, 'auprc': 0.9962783787653999, 'loss_val': 0.07454116275525667, 'psi': 0.9919947361973175}-{'f1_val': 0.9923740886046254, 'auprc': 0.997665753272418, 'loss_val': 0.06917322075291739, 'psi': 0.9944907544717425}
[S9] START round=39 head_norm_before_train=1.440272 cos_to_last_merge=1.0000 (last merge round=38)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9993037733542764, 'loss_val': 0.2490254925667162, 'psi': 0.9982484433480968}-{'f1_val': 0.9964645815439231, 'auprc': 0.9993573721062736, 'loss_val': 0.14509298410232083, 'psi': 0.9976216977688633}
[S10] START round=39 head_norm_before_train=1.861207 cos_to_last_merge=0.7938 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.794
[S10] round=39 local utility u=0.000035 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9964599489365512, 'loss_val': 0.03115845183646938, 'psi': 0.9958179801910532}-{'f1_val': 0.9953900010273877, 'auprc': 0.9965424961143907, 'loss_val': 0.031476875752081766, 'psi': 0.9958509990621889}
[S11] START round=39 head_norm_before_train=1.706545 cos_to_last_merge=0.9907 (last merge round=33)
[S11] round=39 local utility u=0.004065 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9968933498466103, 'loss_val': 0.04990047554513605, 'psi': 0.9966855426467979}-{'f1_val': 0.9965470045135896, 'auprc': 0.9967390645875059, 'loss_val': 0.057566977304451615, 'psi': 0.9966238285431561}
[S13] START round=39 head_norm_before_train=1.312852 cos_to_last_merge=0.9986 (last merge round=37)
[S13] round=39 local utility u=0.259152 metrics={'f1_val': 0.5576037952774215, 'auprc': 0.6770105161600624, 'loss_val': 0.8085431003987675, 'psi': 0.605366483630478}-{'f1_val': 0.5357139368699371, 'auprc': 0.5756164289380983, 'loss_val': 0.8913247785698081, 'psi': 0.5516749336972016}
[S14] START round=39 head_norm_before_train=2.089217 (no previous merge yet)
[S14] round=39 local utility u=0.005772 metrics={'f1_val': 0.9982830790006876, 'auprc': 0.997157628197453, 'loss_val': 0.02412882418774769, 'psi': 0.9978328986793937}-{'f1_val': 0.9976291097282272, 'auprc': 0.9971571420504575, 'loss_val': 0.0317483594710677, 'psi': 0.9974403226571193}
[S15] START round=39 head_norm_before_train=1.347460 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.013710 metrics={'f1_val': 0.9747865099502397, 'auprc': 0.9979909577730788, 'loss_val': 0.11817073114144824, 'psi': 0.9840682890793754}-{'f1_val': 0.9749723297864531, 'auprc': 0.9954940274165978, 'loss_val': 0.1392145256230756, 'psi': 0.9831810088385109}
[S16] START round=39 head_norm_before_train=1.861455 cos_to_last_merge=0.7391 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.739
[S16] round=39 local utility u=0.631062 metrics={'f1_val': 0.9908306172892938, 'auprc': 0.9925580741305025, 'loss_val': 0.049460495740924385, 'psi': 0.9915216000257772}-{'f1_val': 0.8786173654291694, 'auprc': 0.9930518991464351, 'loss_val': 0.6397869651235781, 'psi': 0.9243911789160757}
[S17] START round=39 head_norm_before_train=2.026326 (no previous merge yet)
[S17] round=39 local utility u=0.161747 metrics={'f1_val': 0.6214464698397624, 'auprc': 0.7972149863575593, 'loss_val': 0.8972394848572242, 'psi': 0.6917538764468811}-{'f1_val': 0.5817259347863256, 'auprc': 0.8270793989879056, 'loss_val': 1.0720044934777415, 'psi': 0.6798673204669576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:61810
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:61807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:61802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1793) from S5
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.123168)
[S6] loaded HEAD from S5 (vec_in norm=1.123168)
[S6] cosine check vs S5: cos=0.9361
[S6] BUFFERED delta from S5 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1801) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.869528)
[S2] loaded HEAD from S16 (vec_in norm=1.869528)
[S2] cosine check vs S16: cos=-0.1037
[S2] DROPPED delta from S16 (cos=-0.1037 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1806) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.343210)
[S5] loaded HEAD from S13 (vec_in norm=1.343210)
[S5] cosine check vs S13: cos=0.2446
[S5] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1797) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.680236)
[S13] loaded HEAD from S7 (vec_in norm=1.680236)
[S13] cosine check vs S7: cos=0.9482
[S13] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.736609)
[S9] loaded HEAD from S11 (vec_in norm=1.736609)
[S9] cosine check vs S11: cos=0.9361
[S9] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1793) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.385900)
[S8] loaded HEAD from S15 (vec_in norm=1.385900)
[S8] cosine check vs S15: cos=0.9845
[S8] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.286251)
[S5] loaded HEAD from S6 (vec_in norm=1.286251)
[S5] cosine check vs S6: cos=0.9361
[S5] BUFFERED delta from S6 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9891 head_norm=1.458469
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.302030e-01
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9891 head_norm=1.416677 delta_norm=0.130203
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] r=40 psi=0.992 u=0.0000 p_local=0.0183 f1=0.989 auprc=0.996 bytes=32353
[S14] r=40 psi=0.998 u=0.0058 p_local=0.0148 f1=0.998 auprc=0.997 bytes=34215
[S10] r=40 psi=0.996 u=0.0000 p_local=0.0050 f1=0.995 auprc=0.996 bytes=37754
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=39 metric=0.9975 head_norm=1.473833
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.147749e-01
[S9] stored merged vector for next round verification (round=39)
[S9] DEBUG after merge:  round=39 metric=0.9973 head_norm=1.579530 delta_norm=0.314775
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] r=40 psi=0.998 u=0.0000 p_local=0.0295 f1=0.998 auprc=0.999 bytes=32399
[S2] r=40 psi=0.650 u=0.0000 p_local=0.1332 f1=0.573 auprc=0.767 bytes=30584
[S3] r=40 psi=0.966 u=0.2566 p_local=0.1343 f1=0.944 auprc=0.999 bytes=35961
[S4] r=40 psi=0.952 u=0.0000 p_local=0.0139 f1=0.952 auprc=0.951 bytes=30551
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=39 metric=0.7003 head_norm=1.123168
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.794097e-01
[S5] stored merged vector for next round verification (round=39)
[S5] DEBUG after merge:  round=39 metric=0.7003 head_norm=1.002341 delta_norm=0.379410
[S5] aggregate: ACCEPT kept=['S13', 'S6'] (k=2/2) mode=median trim_p=0.1
[S5] r=40 psi=0.818 u=0.8972 p_local=0.3608 f1=0.700 auprc=0.995 bytes=30546
[S11] r=40 psi=0.997 u=0.0041 p_local=0.0793 f1=0.997 auprc=0.997 bytes=30587
[S7] r=40 psi=0.737 u=0.8672 p_local=0.2734 f1=0.668 auprc=0.841 bytes=34170
[S16] r=40 psi=0.992 u=0.6311 p_local=0.3269 f1=0.991 auprc=0.993 bytes=30571
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=39 metric=0.7915 head_norm=1.286251
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.297191e-01
[S6] stored merged vector for next round verification (round=39)
[S6] DEBUG after merge:  round=39 metric=0.7865 head_norm=1.185412 delta_norm=0.229719
[S6] aggregate: ROLLBACK (f1_val pre=0.792 post=0.786 tol_abs=0.005 tol_rel=0.0)
[S6] r=40 psi=0.854 u=0.0126 p_local=0.1070 f1=0.792 auprc=0.946 bytes=30556
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=39 metric=0.5576 head_norm=1.343210
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.946411e-01
[S13] stored merged vector for next round verification (round=39)
[S13] DEBUG after merge:  round=39 metric=0.5551 head_norm=1.492276 delta_norm=0.294641
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] r=40 psi=0.605 u=0.2592 p_local=0.0779 f1=0.558 auprc=0.677 bytes=28749
[S15] r=40 psi=0.984 u=0.0137 p_local=0.1093 f1=0.975 auprc=0.998 bytes=32347
[S17] r=40 psi=0.692 u=0.1617 p_local=0.1976 f1=0.621 auprc=0.797 bytes=28794
[S2] START round=40 head_norm_before_train=2.037556 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=40 local utility u=1.000000 metrics={'f1_val': 0.7070018525086271, 'auprc': 0.888945513261543, 'loss_val': 0.6088428343625997, 'psi': 0.7797793168097935}-{'f1_val': 0.5728573098188738, 'auprc': 0.7667762920266016, 'loss_val': 1.4862378182262899, 'psi': 0.650424902701965}
[S3] START round=40 head_norm_before_train=2.064833 (no previous merge yet)
[S3] round=40 local utility u=0.052224 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9988419150842829, 'loss_val': 0.10764833592257379, 'psi': 0.9761579166969794}-{'f1_val': 0.9438037858834424, 'auprc': 0.9988591678589512, 'loss_val': 0.10875988410255812, 'psi': 0.9658259386736459}
[S4] START round=40 head_norm_before_train=2.049941 cos_to_last_merge=0.9982 (last merge round=33)
[S4] round=40 local utility u=0.031243 metrics={'f1_val': 0.9565403334440659, 'auprc': 0.9603018662116511, 'loss_val': 0.25748220237668124, 'psi': 0.9580449465511001}-{'f1_val': 0.9521753011907641, 'auprc': 0.9514850661321383, 'loss_val': 0.2673274721613216, 'psi': 0.9518992071673138}
[S5] START round=40 head_norm_before_train=1.002341 cos_to_last_merge=1.0000 (last merge round=39)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.5008547762155573, 'auprc': 0.8536886619895714, 'loss_val': 0.7892953921052095, 'psi': 0.641988330525163}-{'f1_val': 0.7003213174339138, 'auprc': 0.9950243695491081, 'loss_val': 0.29520788645318335, 'psi': 0.8182025382799916}
[S6] START round=40 head_norm_before_train=1.185412 cos_to_last_merge=1.0000 (last merge round=39)
[S6] round=40 local utility u=0.667507 metrics={'f1_val': 0.9624697435375132, 'auprc': 0.9642349493786251, 'loss_val': 0.2526911372251289, 'psi': 0.963175825873958}-{'f1_val': 0.7915192782612889, 'auprc': 0.946497171689742, 'loss_val': 0.5087881976888539, 'psi': 0.8535104356326702}
[S7] START round=40 head_norm_before_train=1.680236 cos_to_last_merge=0.9982 (last merge round=34)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.47819042051015587, 'auprc': 0.7809385244742197, 'loss_val': 0.9654008219927193, 'psi': 0.5992896620957815}-{'f1_val': 0.6683441865171511, 'auprc': 0.8412179148545093, 'loss_val': 0.37955383869899295, 'psi': 0.7374936778520944}
[S8] START round=40 head_norm_before_train=1.416677 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.017340 metrics={'f1_val': 0.9927378939946618, 'auprc': 0.999180834540842, 'loss_val': 0.07016182421499974, 'psi': 0.9953150702131339}-{'f1_val': 0.9891389744852626, 'auprc': 0.9962783787653999, 'loss_val': 0.07454116275525667, 'psi': 0.9919947361973175}
[S9] START round=40 head_norm_before_train=1.579530 cos_to_last_merge=1.0000 (last merge round=39)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9909934963439547, 'auprc': 0.9860908468980256, 'loss_val': 0.30599952935949654, 'psi': 0.989032436565583}-{'f1_val': 0.9975448900106438, 'auprc': 0.9993037733542764, 'loss_val': 0.2490254925667162, 'psi': 0.9982484433480968}
[S10] START round=40 head_norm_before_train=1.872926 cos_to_last_merge=0.7928 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.793
[S10] round=40 local utility u=0.000256 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.996028333432009, 'loss_val': 0.031484090575555845, 'psi': 0.9958586698198499}-{'f1_val': 0.9953900010273877, 'auprc': 0.9964599489365512, 'loss_val': 0.03115845183646938, 'psi': 0.9958179801910532}
[S11] START round=40 head_norm_before_train=1.736609 cos_to_last_merge=0.9880 (last merge round=33)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9772369964745826, 'auprc': 0.9977593506066407, 'loss_val': 0.10629907042905182, 'psi': 0.9854459381274058}-{'f1_val': 0.9965470045135896, 'auprc': 0.9968933498466103, 'loss_val': 0.04990047554513605, 'psi': 0.9966855426467979}
[S13] START round=40 head_norm_before_train=1.492276 cos_to_last_merge=1.0000 (last merge round=39)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.5615524990473313, 'auprc': 0.6591127627580207, 'loss_val': 0.8322321736462296, 'psi': 0.600576604531607}-{'f1_val': 0.5576037952774215, 'auprc': 0.6770105161600624, 'loss_val': 0.8085431003987675, 'psi': 0.605366483630478}
[S14] START round=40 head_norm_before_train=2.097270 (no previous merge yet)
[S14] round=40 local utility u=0.000169 metrics={'f1_val': 0.998062872566559, 'auprc': 0.9971575627081237, 'loss_val': 0.022468424567795412, 'psi': 0.9977007486231848}-{'f1_val': 0.9982830790006876, 'auprc': 0.997157628197453, 'loss_val': 0.02412882418774769, 'psi': 0.9978328986793937}
[S15] START round=40 head_norm_before_train=1.385900 cos_to_last_merge=0.9994 (last merge round=38)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.8331578732354633, 'auprc': 0.9353225108673604, 'loss_val': 0.30600022145532296, 'psi': 0.8740237282882222}-{'f1_val': 0.9747865099502397, 'auprc': 0.9979909577730788, 'loss_val': 0.11817073114144824, 'psi': 0.9840682890793754}
[S16] START round=40 head_norm_before_train=1.869528 cos_to_last_merge=0.7386 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.739
[S16] round=40 local utility u=0.005504 metrics={'f1_val': 0.9914874062491634, 'auprc': 0.9926056974673583, 'loss_val': 0.0425361198178196, 'psi': 0.9919347227364413}-{'f1_val': 0.9908306172892938, 'auprc': 0.9925580741305025, 'loss_val': 0.049460495740924385, 'psi': 0.9915216000257772}
[S17] START round=40 head_norm_before_train=2.035556 (no previous merge yet)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.5794460928145115, 'auprc': 0.8913328965754802, 'loss_val': 1.127163809260866, 'psi': 0.7042008143188989}-{'f1_val': 0.6214464698397624, 'auprc': 0.7972149863575593, 'loss_val': 0.8972394848572242, 'psi': 0.6917538764468811}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:61816
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1792) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.437998)
[S15] loaded HEAD from S8 (vec_in norm=1.437998)
[S15] cosine check vs S8: cos=0.9949
[S15] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.040752)
[S16] loaded HEAD from S2 (vec_in norm=2.040752)
[S16] cosine check vs S2: cos=-0.1036
[S16] DROPPED delta from S2 (cos=-0.1036 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.238537)
[S5] loaded HEAD from S6 (vec_in norm=1.238537)
[S5] cosine check vs S6: cos=0.9402
[S5] BUFFERED delta from S6 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.056371)
[S2] loaded HEAD from S4 (vec_in norm=2.056371)
[S2] cosine check vs S4: cos=0.9991
[S2] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:61802
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.878298)
[S2] loaded HEAD from S16 (vec_in norm=1.878298)
[S2] cosine check vs S16: cos=-0.1036
[S2] DROPPED delta from S16 (cos=-0.1036 < 0.0)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.063 → S9@127.0.0.1:61810
[S13] ⇄ pheromone p=0.062 → S5@127.0.0.1:61805
[S9] ⇄ pheromone p=0.024 → S15@127.0.0.1:61815
[S7] ⇄ pheromone p=0.219 → S13@127.0.0.1:61813
[S6] ⇄ pheromone p=0.219 → S5@127.0.0.1:61805
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=40 metric=0.7070 head_norm=2.040752
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.333108e-02
[S2] stored merged vector for next round verification (round=40)
[S2] DEBUG after merge:  round=40 metric=0.7070 head_norm=2.048118 delta_norm=0.043331
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.307 → S16@127.0.0.1:61816
[S8] ⇄ pheromone p=0.018 → S15@127.0.0.1:61815
[S4] ⇄ pheromone p=0.017 → S2@127.0.0.1:61802
[S16] ⇄ pheromone p=0.263 → S2@127.0.0.1:61802
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=40 metric=0.5009 head_norm=1.019940
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.229441e-01
[S5] stored merged vector for next round verification (round=40)
[S5] DEBUG after merge:  round=40 metric=0.5343 head_norm=1.112394 delta_norm=0.222944
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.289 → S6@127.0.0.1:61807
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=40 metric=0.8332 head_norm=1.420179
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.253537e-02
[S15] stored merged vector for next round verification (round=40)
[S15] DEBUG after merge:  round=40 metric=0.8383 head_norm=1.427274 delta_norm=0.072535
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.087 → S9@127.0.0.1:61810
[S2] START round=41 head_norm_before_train=2.048118 cos_to_last_merge=1.0000 (last merge round=40)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.7082853381664354, 'auprc': 0.7923693659211588, 'loss_val': 0.5352578160052798, 'psi': 0.7419189492683247}-{'f1_val': 0.7070018525086271, 'auprc': 0.888945513261543, 'loss_val': 0.6088428343625997, 'psi': 0.7797793168097935}
[S3] START round=41 head_norm_before_train=2.075616 (no previous merge yet)
[S3] round=41 local utility u=0.123397 metrics={'f1_val': 0.9893971724872102, 'auprc': 0.999022169067548, 'loss_val': 0.03156642476078681, 'psi': 0.9932471711193454}-{'f1_val': 0.9610352511054436, 'auprc': 0.9988419150842829, 'loss_val': 0.10764833592257379, 'psi': 0.9761579166969794}
[S4] START round=41 head_norm_before_train=2.056371 cos_to_last_merge=0.9978 (last merge round=33)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9482466721580339, 'auprc': 0.9594673610027445, 'loss_val': 0.2653264456532776, 'psi': 0.9527349476959182}-{'f1_val': 0.9565403334440659, 'auprc': 0.9603018662116511, 'loss_val': 0.25748220237668124, 'psi': 0.9580449465511001}
[S5] START round=41 head_norm_before_train=1.112394 cos_to_last_merge=1.0000 (last merge round=40)
[S5] round=41 local utility u=1.000000 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9931247613818384, 'loss_val': 0.2979516542230431, 'psi': 0.8174944374846635}-{'f1_val': 0.5008547762155573, 'auprc': 0.8536886619895714, 'loss_val': 0.7892953921052095, 'psi': 0.641988330525163}
[S6] START round=41 head_norm_before_train=1.238537 cos_to_last_merge=0.9992 (last merge round=39)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.7325445030088859, 'auprc': 0.9550092330929165, 'loss_val': 0.5897236482971462, 'psi': 0.8215303950424981}-{'f1_val': 0.9624697435375132, 'auprc': 0.9642349493786251, 'loss_val': 0.2526911372251289, 'psi': 0.963175825873958}
[S7] START round=41 head_norm_before_train=1.688079 cos_to_last_merge=0.9978 (last merge round=34)
[S7] round=41 local utility u=0.746723 metrics={'f1_val': 0.6486913503202192, 'auprc': 0.8015776243539754, 'loss_val': 0.5568780416561965, 'psi': 0.7098458599337216}-{'f1_val': 0.47819042051015587, 'auprc': 0.7809385244742197, 'loss_val': 0.9654008219927193, 'psi': 0.5992896620957815}
[S8] START round=41 head_norm_before_train=1.437998 cos_to_last_merge=0.9998 (last merge round=39)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9920215160826699, 'auprc': 0.9990295682692067, 'loss_val': 0.06700579074680739, 'psi': 0.9948247369572847}-{'f1_val': 0.9927378939946618, 'auprc': 0.999180834540842, 'loss_val': 0.07016182421499974, 'psi': 0.9953150702131339}
[S9] START round=41 head_norm_before_train=1.604971 cos_to_last_merge=0.9977 (last merge round=39)
[S9] round=41 local utility u=0.114976 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9989451514492074, 'loss_val': 0.15391806722498255, 'psi': 0.9981049945860692}-{'f1_val': 0.9909934963439547, 'auprc': 0.9860908468980256, 'loss_val': 0.30599952935949654, 'psi': 0.989032436565583}
[S10] START round=41 head_norm_before_train=1.884938 cos_to_last_merge=0.7919 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.792
[S10] round=41 local utility u=0.000583 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9965491702851772, 'loss_val': 0.029244774645357345, 'psi': 0.9958034666811157}-{'f1_val': 0.9957455607450773, 'auprc': 0.996028333432009, 'loss_val': 0.031484090575555845, 'psi': 0.9958586698198499}
[S11] START round=41 head_norm_before_train=1.761534 cos_to_last_merge=0.9858 (last merge round=33)
[S11] round=41 local utility u=0.089366 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9979479320953685, 'loss_val': 0.04151256012439949, 'psi': 0.996859377786133}-{'f1_val': 0.9772369964745826, 'auprc': 0.9977593506066407, 'loss_val': 0.10629907042905182, 'psi': 0.9854459381274058}
[S13] START round=41 head_norm_before_train=1.519313 cos_to_last_merge=0.9981 (last merge round=39)
[S13] round=41 local utility u=0.109337 metrics={'f1_val': 0.5679078115775926, 'auprc': 0.7039998309919713, 'loss_val': 0.7863508846625866, 'psi': 0.6223446193433442}-{'f1_val': 0.5615524990473313, 'auprc': 0.6591127627580207, 'loss_val': 0.8322321736462296, 'psi': 0.600576604531607}
[S14] START round=41 head_norm_before_train=2.106476 (no previous merge yet)
[S14] round=41 local utility u=0.000917 metrics={'f1_val': 0.9972183481640888, 'auprc': 0.9988534733154164, 'loss_val': 0.020654291347210627, 'psi': 0.9978723982246198}-{'f1_val': 0.998062872566559, 'auprc': 0.9971575627081237, 'loss_val': 0.022468424567795412, 'psi': 0.9977007486231848}
[S15] START round=41 head_norm_before_train=1.427274 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=41 local utility u=0.701639 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9973028012617395, 'loss_val': 0.06761517280579564, 'psi': 0.9967109832772485}-{'f1_val': 0.8331578732354633, 'auprc': 0.9353225108673604, 'loss_val': 0.30600022145532296, 'psi': 0.8740237282882222}
[S16] START round=41 head_norm_before_train=1.878298 cos_to_last_merge=0.7380 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.738
[S16] round=41 local utility u=0.002003 metrics={'f1_val': 0.9914874062491634, 'auprc': 0.9935652898571845, 'loss_val': 0.0414089646740148, 'psi': 0.9923185596923718}-{'f1_val': 0.9914874062491634, 'auprc': 0.9926056974673583, 'loss_val': 0.0425361198178196, 'psi': 0.9919347227364413}
[S17] START round=41 head_norm_before_train=2.044219 (no previous merge yet)
[S17] round=41 local utility u=0.335840 metrics={'f1_val': 0.6058343060477683, 'auprc': 0.9866527738531435, 'loss_val': 0.8997719061331073, 'psi': 0.7581616931699184}-{'f1_val': 0.5794460928145115, 'auprc': 0.8913328965754802, 'loss_val': 1.127163809260866, 'psi': 0.7042008143188989}
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S16
[S8]  timeout peer S17
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S17
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S4
[S13]  timeout peer S6
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S16
[S9]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:61807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:61810
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:61813
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:61815
[S11] sending update (kind=head size=1788 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.460080)
[S9] loaded HEAD from S15 (vec_in norm=1.460080)
[S9] cosine check vs S15: cos=0.5965
[S9] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S5
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.134819)
[S6] loaded HEAD from S5 (vec_in norm=1.134819)
[S6] cosine check vs S5: cos=0.9856
[S6] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1805) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.638414)
[S15] loaded HEAD from S9 (vec_in norm=1.638414)
[S15] cosine check vs S9: cos=0.5965
[S15] BUFFERED delta from S9 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1805) from S7
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.693901)
[S13] loaded HEAD from S7 (vec_in norm=1.693901)
[S13] cosine check vs S7: cos=0.9698
[S13] BUFFERED delta from S7 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1803) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.888253)
[S2] loaded HEAD from S16 (vec_in norm=1.888253)
[S2] cosine check vs S16: cos=-0.1027
[S2] DROPPED delta from S16 (cos=-0.1027 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1788) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.783527)
[S9] loaded HEAD from S11 (vec_in norm=1.783527)
[S9] cosine check vs S11: cos=0.9583
[S9] BUFFERED delta from S11 (total buffered=2)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=41 metric=0.9963 head_norm=1.460080
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.004305e-01
[S15] stored merged vector for next round verification (round=41)
[S15] DEBUG after merge:  round=41 metric=0.9963 head_norm=1.384743 delta_norm=0.700430
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:61805
[S13] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.550987)
[S5] loaded HEAD from S13 (vec_in norm=1.550987)
[S5] cosine check vs S13: cos=0.3046
[S5] BUFFERED delta from S13 (total buffered=1)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=41 metric=0.9975 head_norm=1.638414
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.826704e-01
[S9] stored merged vector for next round verification (round=41)
[S9] DEBUG after merge:  round=41 metric=0.9975 head_norm=1.481059 delta_norm=0.282670
[S9] aggregate: ACCEPT kept=['S15', 'S11'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=41 metric=0.7325 head_norm=1.286904
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.277901e-01
[S6] stored merged vector for next round verification (round=41)
[S6] DEBUG after merge:  round=41 metric=0.7235 head_norm=1.206498 delta_norm=0.127790
[S6] aggregate: ROLLBACK (f1_val pre=0.733 post=0.724 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=41 metric=0.7004 head_norm=1.134819
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.095028e-01
[S5] stored merged vector for next round verification (round=41)
[S5] DEBUG after merge:  round=41 metric=0.7003 head_norm=1.091510 delta_norm=0.809503
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] CommDone barrier timeout: have=2 need=3 — continuing
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=41 metric=0.5679 head_norm=1.550987
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.115318e-01
[S13] stored merged vector for next round verification (round=41)
[S13] DEBUG after merge:  round=41 metric=0.5786 head_norm=1.610182 delta_norm=0.211532
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=2.049845 cos_to_last_merge=1.0000 (last merge round=40)
[S2] round=42 local utility u=0.536651 metrics={'f1_val': 0.8302093643665346, 'auprc': 0.8737424586221076, 'loss_val': 0.4376197163414428, 'psi': 0.8476226020687638}-{'f1_val': 0.7082853381664354, 'auprc': 0.7923693659211588, 'loss_val': 0.5352578160052798, 'psi': 0.7419189492683247}
[S3] START round=42 head_norm_before_train=2.085629 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.965181981083605, 'auprc': 0.9990197710050104, 'loss_val': 0.07174007695702274, 'psi': 0.978717097052167}-{'f1_val': 0.9893971724872102, 'auprc': 0.999022169067548, 'loss_val': 0.03156642476078681, 'psi': 0.9932471711193454}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=2.064989 cos_to_last_merge=0.9974 (last merge round=33)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9412899371642486, 'auprc': 0.9554667729245279, 'loss_val': 0.3033763222926449, 'psi': 0.9469606714683603}-{'f1_val': 0.9482466721580339, 'auprc': 0.9594673610027445, 'loss_val': 0.2653264456532776, 'psi': 0.9527349476959182}
[S5] START round=42 head_norm_before_train=1.091510 cos_to_last_merge=1.0000 (last merge round=41)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.6265821108029997, 'auprc': 0.6621507751658455, 'loss_val': 0.7401635524708884, 'psi': 0.6408095765481381}-{'f1_val': 0.700407554886547, 'auprc': 0.9931247613818384, 'loss_val': 0.2979516542230431, 'psi': 0.8174944374846635}
[S6] START round=42 head_norm_before_train=1.206498 cos_to_last_merge=1.0000 (last merge round=41)
[S6] round=42 local utility u=0.228187 metrics={'f1_val': 0.7902809178023169, 'auprc': 0.9549969623485215, 'loss_val': 0.47973152339978187, 'psi': 0.8561673356207988}-{'f1_val': 0.7325445030088859, 'auprc': 0.9550092330929165, 'loss_val': 0.5897236482971462, 'psi': 0.8215303950424981}
[S7] START round=42 head_norm_before_train=1.693901 cos_to_last_merge=0.9974 (last merge round=34)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.6249352693412679, 'auprc': 0.7916318913670071, 'loss_val': 0.6341833600037888, 'psi': 0.6916139181515636}-{'f1_val': 0.6486913503202192, 'auprc': 0.8015776243539754, 'loss_val': 0.5568780416561965, 'psi': 0.7098458599337216}
[S8] START round=42 head_norm_before_train=1.459131 cos_to_last_merge=0.9995 (last merge round=39)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9888526342761694, 'auprc': 0.9990934531315752, 'loss_val': 0.06738670235316313, 'psi': 0.9929489618183318}-{'f1_val': 0.9920215160826699, 'auprc': 0.9990295682692067, 'loss_val': 0.06700579074680739, 'psi': 0.9948247369572847}
[S9] START round=42 head_norm_before_train=1.481059 cos_to_last_merge=1.0000 (last merge round=41)
[S9] round=42 local utility u=0.014915 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995422644922595, 'loss_val': 0.12322802767344564, 'psi': 0.9980786533041894}-{'f1_val': 0.9975448900106438, 'auprc': 0.9989451514492074, 'loss_val': 0.15391806722498255, 'psi': 0.9981049945860692}
[S10] START round=42 head_norm_before_train=1.895660 cos_to_last_merge=0.7910 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.791
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9955590492601146, 'loss_val': 0.031242339108392435, 'psi': 0.9955894118130577}-{'f1_val': 0.9953063309450747, 'auprc': 0.9965491702851772, 'loss_val': 0.029244774645357345, 'psi': 0.9958034666811157}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.783527 cos_to_last_merge=0.9837 (last merge round=33)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9927721206646234, 'auprc': 0.9981446867609043, 'loss_val': 0.04689278853247652, 'psi': 0.9949211471031358}-{'f1_val': 0.9961336749133093, 'auprc': 0.9979479320953685, 'loss_val': 0.04151256012439949, 'psi': 0.996859377786133}
[S13] START round=42 head_norm_before_train=1.610182 cos_to_last_merge=1.0000 (last merge round=41)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.5782743419812787, 'auprc': 0.67169466047298, 'loss_val': 0.7951235896055603, 'psi': 0.6156424693779592}-{'f1_val': 0.5679078115775926, 'auprc': 0.7039998309919713, 'loss_val': 0.7863508846625866, 'psi': 0.6223446193433442}
[S14] START round=42 head_norm_before_train=2.115247 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9988529888464981, 'loss_val': 0.023194590347310376, 'psi': 0.9979729525273481}-{'f1_val': 0.9972183481640888, 'auprc': 0.9988534733154164, 'loss_val': 0.020654291347210627, 'psi': 0.9978723982246198}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.384743 cos_to_last_merge=1.0000 (last merge round=41)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.9260358669505683, 'auprc': 0.9868002410111363, 'loss_val': 0.3231649256902906, 'psi': 0.9503416165747955}-{'f1_val': 0.9963164379542544, 'auprc': 0.9973028012617395, 'loss_val': 0.06761517280579564, 'psi': 0.9967109832772485}
[S16] START round=42 head_norm_before_train=1.888253 cos_to_last_merge=0.7375 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.738
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9921238409786317, 'auprc': 0.9905203553605048, 'loss_val': 0.04662059406820774, 'psi': 0.991482446731381}-{'f1_val': 0.9914874062491634, 'auprc': 0.9935652898571845, 'loss_val': 0.0414089646740148, 'psi': 0.9923185596923718}
[S17] START round=42 head_norm_before_train=2.051355 (no previous merge yet)
[S17] round=42 local utility u=0.060311 metrics={'f1_val': 0.6176890611264769, 'auprc': 0.9852757336192053, 'loss_val': 0.8461472838211899, 'psi': 0.7647237301235683}-{'f1_val': 0.6058343060477683, 'auprc': 0.9866527738531435, 'loss_val': 0.8997719061331073, 'psi': 0.7581616931699184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:61805
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:61816
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1798) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.255419)
[S5] loaded HEAD from S6 (vec_in norm=1.255419)
[S5] cosine check vs S6: cos=0.6966
[S5] BUFFERED delta from S6 (total buffered=1)
[S2] sending update (kind=head size=1797 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1797) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.052418)
[S16] loaded HEAD from S2 (vec_in norm=2.052418)
[S16] cosine check vs S2: cos=-0.1024
[S16] DROPPED delta from S2 (cos=-0.1024 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:61815
[S9] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.520360)
[S15] loaded HEAD from S9 (vec_in norm=1.520360)
[S15] cosine check vs S9: cos=0.9545
[S15] BUFFERED delta from S9 (total buffered=1)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=42 metric=0.9260 head_norm=1.416733
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.273014e-01
[S15] stored merged vector for next round verification (round=42)
[S15] DEBUG after merge:  round=42 metric=0.9263 head_norm=1.451774 delta_norm=0.227301
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7]  timeout peer S13
[S7]  timeout peer S14
[S11]  timeout peer S4
[S11]  timeout peer S9
[S5]  timeout peer S11
[S8]  timeout peer S7
[S4]  timeout peer S2
[S4]  timeout peer S10
[S13]  timeout peer S3
[S13]  timeout peer S5
[S13]  timeout peer S17
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=42 metric=0.6266 head_norm=1.113102
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.658654e-01
[S5] stored merged vector for next round verification (round=42)
[S5] DEBUG after merge:  round=42 metric=0.6302 head_norm=1.091104 delta_norm=0.465865
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=2.052418 cos_to_last_merge=1.0000 (last merge round=40)
[S2] round=43 local utility u=0.056333 metrics={'f1_val': 0.8300175772689471, 'auprc': 0.9074010038894909, 'loss_val': 0.4247777684785171, 'psi': 0.8609709479171646}-{'f1_val': 0.8302093643665346, 'auprc': 0.8737424586221076, 'loss_val': 0.4376197163414428, 'psi': 0.8476226020687638}
[S3] START round=43 head_norm_before_train=2.096152 (no previous merge yet)
[S3] round=43 local utility u=0.010646 metrics={'f1_val': 0.9683687067009078, 'auprc': 0.9990095079364961, 'loss_val': 0.06953781829594168, 'psi': 0.9806250271951431}-{'f1_val': 0.965181981083605, 'auprc': 0.9990197710050104, 'loss_val': 0.07174007695702274, 'psi': 0.978717097052167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=43 head_norm_before_train=2.069787 cos_to_last_merge=0.9971 (last merge round=33)
[S4] round=43 local utility u=0.023366 metrics={'f1_val': 0.9428338869387883, 'auprc': 0.9609045900062936, 'loss_val': 0.28222106826631416, 'psi': 0.9500621681657904}-{'f1_val': 0.9412899371642486, 'auprc': 0.9554667729245279, 'loss_val': 0.3033763222926449, 'psi': 0.9469606714683603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=43 head_norm_before_train=1.091104 cos_to_last_merge=1.0000 (last merge round=42)
[S5] round=43 local utility u=0.960472 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9976904543498224, 'loss_val': 0.26827293714982037, 'psi': 0.8192689722002773}-{'f1_val': 0.6265821108029997, 'auprc': 0.6621507751658455, 'loss_val': 0.7401635524708884, 'psi': 0.6408095765481381}
[S6] START round=43 head_norm_before_train=1.255419 cos_to_last_merge=0.9995 (last merge round=41)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.7306542888883033, 'auprc': 0.9516346003515304, 'loss_val': 0.5830938871842783, 'psi': 0.8190464134735942}-{'f1_val': 0.7902809178023169, 'auprc': 0.9549969623485215, 'loss_val': 0.47973152339978187, 'psi': 0.8561673356207988}
[S7] START round=43 head_norm_before_train=1.700593 cos_to_last_merge=0.9971 (last merge round=34)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.6248616489277107, 'auprc': 0.7922471501847763, 'loss_val': 0.6409787270571754, 'psi': 0.6918158494305369}-{'f1_val': 0.6249352693412679, 'auprc': 0.7916318913670071, 'loss_val': 0.6341833600037888, 'psi': 0.6916139181515636}
[S8] START round=43 head_norm_before_train=1.479177 cos_to_last_merge=0.9990 (last merge round=39)
[S8] round=43 local utility u=0.014672 metrics={'f1_val': 0.9920877483955324, 'auprc': 0.9992652825293334, 'loss_val': 0.05796878672123501, 'psi': 0.9949587620490529}-{'f1_val': 0.9888526342761694, 'auprc': 0.9990934531315752, 'loss_val': 0.06738670235316313, 'psi': 0.9929489618183318}
[S9] START round=43 head_norm_before_train=1.520360 cos_to_last_merge=0.9986 (last merge round=41)
[S9] round=43 local utility u=0.005814 metrics={'f1_val': 0.9947734239942433, 'auprc': 0.9995605983753976, 'loss_val': 0.09767711896499996, 'psi': 0.996688293746705}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995422644922595, 'loss_val': 0.12322802767344564, 'psi': 0.9980786533041894}
[S10] START round=43 head_norm_before_train=1.902366 cos_to_last_merge=0.7904 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.790
[S10] round=43 local utility u=0.001882 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9965344454644959, 'loss_val': 0.028585478184471838, 'psi': 0.9957975767528432}-{'f1_val': 0.9956096535150197, 'auprc': 0.9955590492601146, 'loss_val': 0.031242339108392435, 'psi': 0.9955894118130577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=43 head_norm_before_train=1.802997 cos_to_last_merge=0.9819 (last merge round=33)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9703126811010874, 'auprc': 0.997692853005705, 'loss_val': 0.11593346637557399, 'psi': 0.9812647498629344}-{'f1_val': 0.9927721206646234, 'auprc': 0.9981446867609043, 'loss_val': 0.04689278853247652, 'psi': 0.9949211471031358}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.639482 cos_to_last_merge=0.9987 (last merge round=41)
[S13] round=43 local utility u=0.032525 metrics={'f1_val': 0.5819076599469114, 'auprc': 0.7003684916042621, 'loss_val': 0.8378957253170076, 'psi': 0.6292919926098517}-{'f1_val': 0.5782743419812787, 'auprc': 0.67169466047298, 'loss_val': 0.7951235896055603, 'psi': 0.6156424693779592}
[S14] START round=43 head_norm_before_train=2.120557 (no previous merge yet)
[S14] round=43 local utility u=0.002746 metrics={'f1_val': 0.997874693950357, 'auprc': 0.9988535414046843, 'loss_val': 0.020634728484476807, 'psi': 0.9982662329320879}-{'f1_val': 0.9973862616479148, 'auprc': 0.9988529888464981, 'loss_val': 0.023194590347310376, 'psi': 0.9979729525273481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=43 head_norm_before_train=1.451774 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.7277906356620164, 'auprc': 0.8516273690986077, 'loss_val': 0.49384815249923547, 'psi': 0.7773253290366529}-{'f1_val': 0.9260358669505683, 'auprc': 0.9868002410111363, 'loss_val': 0.3231649256902906, 'psi': 0.9503416165747955}
[S16] START round=43 head_norm_before_train=1.898196 cos_to_last_merge=0.7374 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.737
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9445113787757984, 'auprc': 0.9884369527520609, 'loss_val': 0.2266803055930963, 'psi': 0.9620816083663034}-{'f1_val': 0.9921238409786317, 'auprc': 0.9905203553605048, 'loss_val': 0.04662059406820774, 'psi': 0.991482446731381}
[S17] START round=43 head_norm_before_train=2.058584 (no previous merge yet)
[S17] round=43 local utility u=0.019182 metrics={'f1_val': 0.6281306488201169, 'auprc': 0.9792713698587854, 'loss_val': 0.8524203643278797, 'psi': 0.7685869372355842}-{'f1_val': 0.6176890611264769, 'auprc': 0.9852757336192053, 'loss_val': 0.8461472838211899, 'psi': 0.7647237301235683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:61816
[S13] sending update (kind=head size=1796 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.669876)
[S7] loaded HEAD from S13 (vec_in norm=1.669876)
[S7] cosine check vs S13: cos=0.9798
[S7] BUFFERED delta from S13 (total buffered=1)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.057997)
[S16] loaded HEAD from S2 (vec_in norm=2.057997)
[S16] cosine check vs S2: cos=-0.1023
[S16] DROPPED delta from S2 (cos=-0.1023 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:61815
[S9] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.556144)
[S15] loaded HEAD from S9 (vec_in norm=1.556144)
[S15] cosine check vs S9: cos=0.9866
[S15] BUFFERED delta from S9 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:61807
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S5
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.125580)
[S6] loaded HEAD from S5 (vec_in norm=1.125580)
[S6] cosine check vs S5: cos=0.9315
[S6] BUFFERED delta from S5 (total buffered=1)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=43 metric=0.7278 head_norm=1.482521
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.295299e-01
[S15] stored merged vector for next round verification (round=43)
[S15] DEBUG after merge:  round=43 metric=0.7386 head_norm=1.514248 delta_norm=0.129530
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=2.057997 cos_to_last_merge=1.0000 (last merge round=40)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.8497436284953293, 'auprc': 0.8665253762429004, 'loss_val': 0.4531435393891291, 'psi': 0.8564563275943576}-{'f1_val': 0.8300175772689471, 'auprc': 0.9074010038894909, 'loss_val': 0.4247777684785171, 'psi': 0.8609709479171646}
[S3] START round=44 head_norm_before_train=2.105929 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9990073729437758, 'loss_val': 0.122093092225652, 'psi': 0.9762240998407765}-{'f1_val': 0.9683687067009078, 'auprc': 0.9990095079364961, 'loss_val': 0.06953781829594168, 'psi': 0.9806250271951431}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=2.077648 cos_to_last_merge=0.9968 (last merge round=33)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.944345714562533, 'auprc': 0.9557542484635827, 'loss_val': 0.2760933503564012, 'psi': 0.9489091281229529}-{'f1_val': 0.9428338869387883, 'auprc': 0.9609045900062936, 'loss_val': 0.28222106826631416, 'psi': 0.9500621681657904}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.125580 cos_to_last_merge=0.9990 (last merge round=42)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.43944437729600566, 'auprc': 0.8256448871712581, 'loss_val': 0.9526844768741729, 'psi': 0.5939245812461067}-{'f1_val': 0.7003213174339138, 'auprc': 0.9976904543498224, 'loss_val': 0.26827293714982037, 'psi': 0.8192689722002773}
[S6] START round=44 head_norm_before_train=1.301425 cos_to_last_merge=0.9980 (last merge round=41)
[S6] round=44 local utility u=0.021526 metrics={'f1_val': 0.7322367702259267, 'auprc': 0.9515054018470226, 'loss_val': 0.5491487283057243, 'psi': 0.819944222874365}-{'f1_val': 0.7306542888883033, 'auprc': 0.9516346003515304, 'loss_val': 0.5830938871842783, 'psi': 0.8190464134735942}
[S7] START round=44 head_norm_before_train=1.706041 cos_to_last_merge=0.9968 (last merge round=34)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.46262680770958053, 'auprc': 0.7805783610341277, 'loss_val': 0.9959032720518265, 'psi': 0.5898074290393993}-{'f1_val': 0.6248616489277107, 'auprc': 0.7922471501847763, 'loss_val': 0.6409787270571754, 'psi': 0.6918158494305369}
[S8] START round=44 head_norm_before_train=1.497283 cos_to_last_merge=0.9985 (last merge round=39)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9803653013759591, 'auprc': 0.9929945696989756, 'loss_val': 0.07565508329953122, 'psi': 0.9854170087051657}-{'f1_val': 0.9920877483955324, 'auprc': 0.9992652825293334, 'loss_val': 0.05796878672123501, 'psi': 0.9949587620490529}
[S9] START round=44 head_norm_before_train=1.556144 cos_to_last_merge=0.9959 (last merge round=41)
[S9] round=44 local utility u=0.013310 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9962265687245844, 'loss_val': 0.07256848322758673, 'psi': 0.9965061222486911}-{'f1_val': 0.9947734239942433, 'auprc': 0.9995605983753976, 'loss_val': 0.09767711896499996, 'psi': 0.996688293746705}
[S10] START round=44 head_norm_before_train=1.910996 cos_to_last_merge=0.7897 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.790
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9951824980731487, 'loss_val': 0.03018902448145213, 'psi': 0.9954387913382714}-{'f1_val': 0.9953063309450747, 'auprc': 0.9965344454644959, 'loss_val': 0.028585478184471838, 'psi': 0.9957975767528432}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.819908 cos_to_last_merge=0.9804 (last merge round=33)
[S11] round=44 local utility u=0.118167 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978152006332051, 'loss_val': 0.034891914123827736, 'psi': 0.9968062852012676}-{'f1_val': 0.9703126811010874, 'auprc': 0.997692853005705, 'loss_val': 0.11593346637557399, 'psi': 0.9812647498629344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=44 head_norm_before_train=1.669876 cos_to_last_merge=0.9961 (last merge round=41)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5772651924138958, 'auprc': 0.562935926891036, 'loss_val': 0.8754928107675956, 'psi': 0.5715334862047519}-{'f1_val': 0.5819076599469114, 'auprc': 0.7003684916042621, 'loss_val': 0.8378957253170076, 'psi': 0.6292919926098517}
[S14] START round=44 head_norm_before_train=2.125010 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9988527632356085, 'loss_val': 0.020792756994673676, 'psi': 0.9981334109838169}-{'f1_val': 0.997874693950357, 'auprc': 0.9988535414046843, 'loss_val': 0.020634728484476807, 'psi': 0.9982662329320879}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.514248 cos_to_last_merge=1.0000 (last merge round=43)
[S15] round=44 local utility u=1.000000 metrics={'f1_val': 0.951696474221506, 'auprc': 0.9971734400115526, 'loss_val': 0.18085242029413603, 'psi': 0.9698872605375246}-{'f1_val': 0.7277906356620164, 'auprc': 0.8516273690986077, 'loss_val': 0.49384815249923547, 'psi': 0.7773253290366529}
[S16] START round=44 head_norm_before_train=1.903205 cos_to_last_merge=0.7375 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.738
[S16] round=44 local utility u=0.241097 metrics={'f1_val': 0.9917064831279072, 'auprc': 0.992646565743853, 'loss_val': 0.04028641316408899, 'psi': 0.9920825161742854}-{'f1_val': 0.9445113787757984, 'auprc': 0.9884369527520609, 'loss_val': 0.2266803055930963, 'psi': 0.9620816083663034}
[S17] START round=44 head_norm_before_train=2.065878 (no previous merge yet)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.5954470698726109, 'auprc': 0.9565443330720319, 'loss_val': 1.1022788088012434, 'psi': 0.7398859751523792}-{'f1_val': 0.6281306488201169, 'auprc': 0.9792713698587854, 'loss_val': 0.8524203643278797, 'psi': 0.7685869372355842}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:61805
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:61802
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1806 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=44 metric=0.4626 head_norm=1.709921
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.709252e-01
[S7] stored merged vector for next round verification (round=44)
[S7] DEBUG after merge:  round=44 metric=0.4654 head_norm=1.681351 delta_norm=0.170925
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:61810
[S5] RECEIVED delta(kind=head bytes=1804) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.341645)
[S5] loaded HEAD from S6 (vec_in norm=1.341645)
[S5] cosine check vs S6: cos=0.9304
[S5] BUFFERED delta from S6 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1806) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.908190)
[S2] loaded HEAD from S16 (vec_in norm=1.908190)
[S2] cosine check vs S16: cos=-0.1022
[S2] DROPPED delta from S16 (cos=-0.1022 < 0.0)
[S15] sending update (kind=head size=1800 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=44 metric=0.7322 head_norm=1.341645
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.555993e-01
[S6] stored merged vector for next round verification (round=44)
[S6] DEBUG after merge:  round=44 metric=0.7242 head_norm=1.211668 delta_norm=0.255599
[S6] aggregate: ROLLBACK (f1_val pre=0.732 post=0.724 tol_abs=0.005 tol_rel=0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.552229)
[S9] loaded HEAD from S15 (vec_in norm=1.552229)
[S9] cosine check vs S15: cos=0.9931
[S9] BUFFERED delta from S15 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=44 metric=0.4394 head_norm=1.154337
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.504050e-01
[S5] stored merged vector for next round verification (round=44)
[S5] DEBUG after merge:  round=44 metric=0.4394 head_norm=1.226193 delta_norm=0.250405
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] not sending this round → trigger blocked (psi=0.997)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=44 metric=0.9967 head_norm=1.587493
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.375814e-02
[S9] stored merged vector for next round verification (round=44)
[S9] DEBUG after merge:  round=44 metric=0.9967 head_norm=1.567158 delta_norm=0.093758
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=2.062467 cos_to_last_merge=1.0000 (last merge round=40)
[S2] round=45 local utility u=0.044038 metrics={'f1_val': 0.8284153655320053, 'auprc': 0.9297563853450976, 'loss_val': 0.42679061933223394, 'psi': 0.8689517734572423}-{'f1_val': 0.8497436284953293, 'auprc': 0.8665253762429004, 'loss_val': 0.4531435393891291, 'psi': 0.8564563275943576}
[S3] START round=45 head_norm_before_train=2.114728 (no previous merge yet)
[S3] round=45 local utility u=0.009583 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9989910042479895, 'loss_val': 0.10287748642427966, 'psi': 0.9762175523624619}-{'f1_val': 0.9610352511054436, 'auprc': 0.9990073729437758, 'loss_val': 0.122093092225652, 'psi': 0.9762240998407765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=45 head_norm_before_train=2.085322 cos_to_last_merge=0.9963 (last merge round=33)
[S4] round=45 local utility u=0.022132 metrics={'f1_val': 0.9518333674929083, 'auprc': 0.9536574431851284, 'loss_val': 0.2704652567350644, 'psi': 0.9525629977697962}-{'f1_val': 0.944345714562533, 'auprc': 0.9557542484635827, 'loss_val': 0.2760933503564012, 'psi': 0.9489091281229529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=45 head_norm_before_train=1.226193 cos_to_last_merge=1.0000 (last merge round=44)
[S5] round=45 local utility u=1.000000 metrics={'f1_val': 0.7362202063082508, 'auprc': 0.9953846615329237, 'loss_val': 0.21984161666996502, 'psi': 0.83988598839812}-{'f1_val': 0.43944437729600566, 'auprc': 0.8256448871712581, 'loss_val': 0.9526844768741729, 'psi': 0.5939245812461067}
[S6] START round=45 head_norm_before_train=1.211668 cos_to_last_merge=1.0000 (last merge round=44)
[S6] round=45 local utility u=0.540249 metrics={'f1_val': 0.8708489045030833, 'auprc': 0.9620701823430657, 'loss_val': 0.33201884558947853, 'psi': 0.9073374156390762}-{'f1_val': 0.7322367702259267, 'auprc': 0.9515054018470226, 'loss_val': 0.5491487283057243, 'psi': 0.819944222874365}
[S7] START round=45 head_norm_before_train=1.681351 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=45 local utility u=0.230075 metrics={'f1_val': 0.5206868963709745, 'auprc': 0.7817178175983697, 'loss_val': 0.8875331136070798, 'psi': 0.6250992648619326}-{'f1_val': 0.46262680770958053, 'auprc': 0.7805783610341277, 'loss_val': 0.9959032720518265, 'psi': 0.5898074290393993}
[S8] START round=45 head_norm_before_train=1.513404 cos_to_last_merge=0.9979 (last merge round=39)
[S8] round=45 local utility u=0.059457 metrics={'f1_val': 0.9931722166739475, 'auprc': 0.9990050995605183, 'loss_val': 0.05161492591417812, 'psi': 0.9955053698285758}-{'f1_val': 0.9803653013759591, 'auprc': 0.9929945696989756, 'loss_val': 0.07565508329953122, 'psi': 0.9854170087051657}
[S9] START round=45 head_norm_before_train=1.567158 cos_to_last_merge=1.0000 (last merge round=44)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9833144528039904, 'auprc': 0.9994936502148896, 'loss_val': 0.09491469545022992, 'psi': 0.9897861317683501}-{'f1_val': 0.9966924912647621, 'auprc': 0.9962265687245844, 'loss_val': 0.07256848322758673, 'psi': 0.9965061222486911}
[S10] START round=45 head_norm_before_train=1.920659 cos_to_last_merge=0.7890 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.789
[S10] round=45 local utility u=0.002338 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9965266655513495, 'loss_val': 0.027725782048790913, 'psi': 0.9957944647875847}-{'f1_val': 0.9956096535150197, 'auprc': 0.9951824980731487, 'loss_val': 0.03018902448145213, 'psi': 0.9954387913382714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=45 head_norm_before_train=1.834203 cos_to_last_merge=0.9790 (last merge round=33)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9973627827282399, 'loss_val': 0.034305601083323777, 'psi': 0.9964802158124444}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978152006332051, 'loss_val': 0.034891914123827736, 'psi': 0.9968062852012676}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.690515 cos_to_last_merge=0.9937 (last merge round=41)
[S13] round=45 local utility u=0.452453 metrics={'f1_val': 0.6338702669664898, 'auprc': 0.7180758878319506, 'loss_val': 0.7756380036814301, 'psi': 0.6675525153126742}-{'f1_val': 0.5772651924138958, 'auprc': 0.562935926891036, 'loss_val': 0.8754928107675956, 'psi': 0.5715334862047519}
[S14] START round=45 head_norm_before_train=2.130123 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9988531927552465, 'loss_val': 0.023209255191265914, 'psi': 0.9981319479320108}-{'f1_val': 0.9976538428159559, 'auprc': 0.9988527632356085, 'loss_val': 0.020792756994673676, 'psi': 0.9981334109838169}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.552229 cos_to_last_merge=0.9987 (last merge round=43)
[S15] round=45 local utility u=0.171403 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9977631439928264, 'loss_val': 0.11234050079507478, 'psi': 0.9973756097139906}-{'f1_val': 0.951696474221506, 'auprc': 0.9971734400115526, 'loss_val': 0.18085242029413603, 'psi': 0.9698872605375246}
[S16] START round=45 head_norm_before_train=1.908190 cos_to_last_merge=0.7371 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.737
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9302032341033961, 'auprc': 0.9918725135530027, 'loss_val': 0.34931110564648826, 'psi': 0.9548709458832387}-{'f1_val': 0.9917064831279072, 'auprc': 0.992646565743853, 'loss_val': 0.04028641316408899, 'psi': 0.9920825161742854}
[S17] START round=45 head_norm_before_train=2.073404 (no previous merge yet)
[S17] round=45 local utility u=0.055283 metrics={'f1_val': 0.6001089207654347, 'auprc': 0.9756226853858294, 'loss_val': 1.07691877366711, 'psi': 0.7503144266135926}-{'f1_val': 0.5954470698726109, 'auprc': 0.9565443330720319, 'loss_val': 1.1022788088012434, 'psi': 0.7398859751523792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61808
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S16] ⇄ pheromone p=0.125 → S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:61807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:61810
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.704876)
[S7] loaded HEAD from S13 (vec_in norm=1.704876)
[S7] cosine check vs S13: cos=0.9903
[S7] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.253124)
[S5] loaded HEAD from S6 (vec_in norm=1.253124)
[S5] cosine check vs S6: cos=0.9988
[S5] BUFFERED delta from S6 (total buffered=1)
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S6] ⇄ pheromone p=0.207 → S5@127.0.0.1:61805
[S13] ⇄ pheromone p=0.124 → S7@127.0.0.1:61808
[S6] RECEIVED delta(kind=head bytes=1802) from S5
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.246862)
[S6] loaded HEAD from S5 (vec_in norm=1.246862)
[S6] cosine check vs S5: cos=0.9988
[S6] BUFFERED delta from S5 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1804) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.593324)
[S9] loaded HEAD from S15 (vec_in norm=1.593324)
[S9] cosine check vs S15: cos=0.9951
[S9] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.068264)
[S16] loaded HEAD from S2 (vec_in norm=2.068264)
[S16] cosine check vs S2: cos=-0.1019
[S16] DROPPED delta from S2 (cos=-0.1019 < 0.0)
[S15] ⇄ pheromone p=0.280 → S9@127.0.0.1:61810
[S2] ⇄ pheromone p=0.171 → S16@127.0.0.1:61816
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=45 metric=0.7362 head_norm=1.246862
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.132153e-02
[S5] stored merged vector for next round verification (round=45)
[S5] DEBUG after merge:  round=45 metric=0.7557 head_norm=1.249604 delta_norm=0.031322
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.499 → S6@127.0.0.1:61807
[S7]  timeout peer S8
[S8]  timeout peer S15
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=45 metric=0.9833 head_norm=1.592900
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.864521e-02
[S9] stored merged vector for next round verification (round=45)
[S9] DEBUG after merge:  round=45 metric=0.9833 head_norm=1.591169 delta_norm=0.078645
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.022 → S15@127.0.0.1:61815
[S2] START round=46 head_norm_before_train=2.068264 cos_to_last_merge=0.9999 (last merge round=40)
[S2] round=46 local utility u=0.021733 metrics={'f1_val': 0.8321460923662067, 'auprc': 0.9058757308258769, 'loss_val': 0.3340663400007139, 'psi': 0.8616379477500749}-{'f1_val': 0.8284153655320053, 'auprc': 0.9297563853450976, 'loss_val': 0.42679061933223394, 'psi': 0.8689517734572423}
[S3] START round=46 head_norm_before_train=2.124241 (no previous merge yet)
[S3] round=46 local utility u=0.149259 metrics={'f1_val': 0.9973670153333725, 'auprc': 0.9989644604972788, 'loss_val': 0.02227072700286413, 'psi': 0.998005993398935}-{'f1_val': 0.9610352511054436, 'auprc': 0.9989910042479895, 'loss_val': 0.10287748642427966, 'psi': 0.9762175523624619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=46 head_norm_before_train=2.091969 cos_to_last_merge=0.9959 (last merge round=33)
[S4] round=46 local utility u=0.031394 metrics={'f1_val': 0.9571801206766253, 'auprc': 0.9620861438629378, 'loss_val': 0.2650439071362111, 'psi': 0.9591425299511502}-{'f1_val': 0.9518333674929083, 'auprc': 0.9536574431851284, 'loss_val': 0.2704652567350644, 'psi': 0.9525629977697962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=46 head_norm_before_train=1.249604 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.5526744571994174, 'auprc': 0.8532705882887645, 'loss_val': 0.7983032386928307, 'psi': 0.6729129096351563}-{'f1_val': 0.7362202063082508, 'auprc': 0.9953846615329237, 'loss_val': 0.21984161666996502, 'psi': 0.83988598839812}
[S6] START round=46 head_norm_before_train=1.253124 cos_to_last_merge=0.9996 (last merge round=44)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.8695490721378171, 'auprc': 0.9660086653430129, 'loss_val': 0.33643890817314004, 'psi': 0.9081329094198953}-{'f1_val': 0.8708489045030833, 'auprc': 0.9620701823430657, 'loss_val': 0.33201884558947853, 'psi': 0.9073374156390762}
[S7] START round=46 head_norm_before_train=1.685315 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=46 local utility u=0.660886 metrics={'f1_val': 0.6572660977689191, 'auprc': 0.8170120356355526, 'loss_val': 0.49111966139517643, 'psi': 0.7211644729155724}-{'f1_val': 0.5206868963709745, 'auprc': 0.7817178175983697, 'loss_val': 0.8875331136070798, 'psi': 0.6250992648619326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=46 metric=0.6573 head_norm=1.692141
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.189271e-01
[S7] stored merged vector for next round verification (round=46)
[S7] DEBUG after merge:  round=46 metric=0.6588 head_norm=1.694352 delta_norm=0.118927
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] START round=46 head_norm_before_train=1.528775 cos_to_last_merge=0.9973 (last merge round=39)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.8779896192176373, 'auprc': 0.9858788005296786, 'loss_val': 0.15827561740236273, 'psi': 0.9211452917424539}-{'f1_val': 0.9931722166739475, 'auprc': 0.9990050995605183, 'loss_val': 0.05161492591417812, 'psi': 0.9955053698285758}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.591169 cos_to_last_merge=1.0000 (last merge round=45)
[S9] round=46 local utility u=0.052855 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9992052551345492, 'loss_val': 0.05859532227105509, 'psi': 0.9966963527022971}-{'f1_val': 0.9833144528039904, 'auprc': 0.9994936502148896, 'loss_val': 0.09491469545022992, 'psi': 0.9897861317683501}
[S10] START round=46 head_norm_before_train=1.930575 cos_to_last_merge=0.7882 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.788
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9962561574317506, 'loss_val': 0.02835921046538322, 'psi': 0.9958180079271672}-{'f1_val': 0.9953063309450747, 'auprc': 0.9965266655513495, 'loss_val': 0.027725782048790913, 'psi': 0.9957944647875847}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.849149 cos_to_last_merge=0.9776 (last merge round=33)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9408249748615576, 'auprc': 0.9968515050136473, 'loss_val': 0.28816265469939856, 'psi': 0.9632355869223934}-{'f1_val': 0.9958918378685807, 'auprc': 0.9973627827282399, 'loss_val': 0.034305601083323777, 'psi': 0.9964802158124444}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.704876 cos_to_last_merge=0.9919 (last merge round=41)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.5962003095541111, 'auprc': 0.6290940006568161, 'loss_val': 0.8601445217546159, 'psi': 0.6093577859951931}-{'f1_val': 0.6338702669664898, 'auprc': 0.7180758878319506, 'loss_val': 0.7756380036814301, 'psi': 0.6675525153126742}
[S14] START round=46 head_norm_before_train=2.134939 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.972226092842815, 'auprc': 0.997158099919107, 'loss_val': 0.049260163369099275, 'psi': 0.9821988956733319}-{'f1_val': 0.9976511180498535, 'auprc': 0.9988531927552465, 'loss_val': 0.023209255191265914, 'psi': 0.9981319479320108}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.593324 cos_to_last_merge=0.9954 (last merge round=43)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.9029149098201734, 'auprc': 0.9974046443733283, 'loss_val': 0.21846639138823373, 'psi': 0.9407108036414353}-{'f1_val': 0.9971172535281002, 'auprc': 0.9977631439928264, 'loss_val': 0.11234050079507478, 'psi': 0.9973756097139906}
[S16] START round=46 head_norm_before_train=1.913909 cos_to_last_merge=0.7365 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.737
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.8331804952449975, 'auprc': 0.9842670978188183, 'loss_val': 1.0804978560158105, 'psi': 0.8936151362745258}-{'f1_val': 0.9302032341033961, 'auprc': 0.9918725135530027, 'loss_val': 0.34931110564648826, 'psi': 0.9548709458832387}
[S17] START round=46 head_norm_before_train=2.079920 (no previous merge yet)
[S17] round=46 local utility u=0.520033 metrics={'f1_val': 0.7136721449180926, 'auprc': 0.9815690569962029, 'loss_val': 0.7360715524799737, 'psi': 0.8208309097493367}-{'f1_val': 0.6001089207654347, 'auprc': 0.9756226853858294, 'loss_val': 1.07691877366711, 'psi': 0.7503144266135926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=46 metric=0.8695 head_norm=1.288558
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.745232e-02
[S6] stored merged vector for next round verification (round=46)
[S6] DEBUG after merge:  round=46 metric=0.8691 head_norm=1.266993 delta_norm=0.047452
[S6] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:61816
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.073462)
[S16] loaded HEAD from S2 (vec_in norm=2.073462)
[S16] cosine check vs S2: cos=-0.1018
[S16] DROPPED delta from S2 (cos=-0.1018 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:61815
[S9] sending update (kind=head size=1795 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.611435)
[S15] loaded HEAD from S9 (vec_in norm=1.611435)
[S15] cosine check vs S9: cos=0.9967
[S15] BUFFERED delta from S9 (total buffered=1)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=46 metric=0.9029 head_norm=1.630372
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.626129e-02
[S15] stored merged vector for next round verification (round=46)
[S15] DEBUG after merge:  round=46 metric=0.9029 head_norm=1.619576 delta_norm=0.066261
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=2.073462 cos_to_last_merge=0.9999 (last merge round=40)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7535859673332062, 'auprc': 0.8531541409418941, 'loss_val': 0.6632304164313264, 'psi': 0.7934132367766813}-{'f1_val': 0.8321460923662067, 'auprc': 0.9058757308258769, 'loss_val': 0.3340663400007139, 'psi': 0.8616379477500749}
[S3] START round=47 head_norm_before_train=2.134551 (no previous merge yet)
[S3] round=47 local utility u=0.000792 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9989175059927621, 'loss_val': 0.02056164028204252, 'psi': 0.9979888209921571}-{'f1_val': 0.9973670153333725, 'auprc': 0.9989644604972788, 'loss_val': 0.02227072700286413, 'psi': 0.998005993398935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=47 head_norm_before_train=2.097113 cos_to_last_merge=0.9956 (last merge round=33)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9472420900519927, 'auprc': 0.9541883300716578, 'loss_val': 0.2820940740183026, 'psi': 0.9500205860598587}-{'f1_val': 0.9571801206766253, 'auprc': 0.9620861438629378, 'loss_val': 0.2650439071362111, 'psi': 0.9591425299511502}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.267538 cos_to_last_merge=0.9998 (last merge round=45)
[S5] round=47 local utility u=0.911922 metrics={'f1_val': 0.7002457463483669, 'auprc': 0.9907965949584898, 'loss_val': 0.2724646792875602, 'psi': 0.8164660857924161}-{'f1_val': 0.5526744571994174, 'auprc': 0.8532705882887645, 'loss_val': 0.7983032386928307, 'psi': 0.6729129096351563}
[S6] START round=47 head_norm_before_train=1.266993 cos_to_last_merge=1.0000 (last merge round=46)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.7998065149866528, 'auprc': 0.9497032782061128, 'loss_val': 0.48270950230706183, 'psi': 0.8597652202744368}-{'f1_val': 0.8695490721378171, 'auprc': 0.9660086653430129, 'loss_val': 0.33643890817314004, 'psi': 0.9081329094198953}
[S7] START round=47 head_norm_before_train=1.694352 cos_to_last_merge=1.0000 (last merge round=46)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6270631179376813, 'auprc': 0.7896627694180975, 'loss_val': 0.6676232978321252, 'psi': 0.6921029785298478}-{'f1_val': 0.6572660977689191, 'auprc': 0.8170120356355526, 'loss_val': 0.49111966139517643, 'psi': 0.7211644729155724}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.542218 cos_to_last_merge=0.9967 (last merge round=39)
[S8] round=47 local utility u=0.310770 metrics={'f1_val': 0.9669612133911354, 'auprc': 0.996218991877375, 'loss_val': 0.10158485155930254, 'psi': 0.9786643247856313}-{'f1_val': 0.8779896192176373, 'auprc': 0.9858788005296786, 'loss_val': 0.15827561740236273, 'psi': 0.9211452917424539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=47 head_norm_before_train=1.611435 cos_to_last_merge=0.9999 (last merge round=45)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9938533367691214, 'loss_val': 0.05265231017044536, 'psi': 0.9955568294665058}-{'f1_val': 0.9950237510807955, 'auprc': 0.9992052551345492, 'loss_val': 0.05859532227105509, 'psi': 0.9966963527022971}
[S10] START round=47 head_norm_before_train=1.940444 cos_to_last_merge=0.7874 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.787
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9965422700524802, 'loss_val': 0.027470920620853073, 'psi': 0.9957191622500023}-{'f1_val': 0.9955259082574451, 'auprc': 0.9962561574317506, 'loss_val': 0.02835921046538322, 'psi': 0.9958180079271672}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.861976 cos_to_last_merge=0.9764 (last merge round=33)
[S11] round=47 local utility u=0.296573 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981815114912301, 'loss_val': 0.030858375421323192, 'psi': 0.9969528095444776}-{'f1_val': 0.9408249748615576, 'auprc': 0.9968515050136473, 'loss_val': 0.28816265469939856, 'psi': 0.9632355869223934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=47 head_norm_before_train=1.716183 cos_to_last_merge=0.9905 (last merge round=41)
[S13] round=47 local utility u=0.206855 metrics={'f1_val': 0.6277880789988068, 'auprc': 0.6772637615784756, 'loss_val': 0.7804712398457907, 'psi': 0.6475783520306744}-{'f1_val': 0.5962003095541111, 'auprc': 0.6290940006568161, 'loss_val': 0.8601445217546159, 'psi': 0.6093577859951931}
[S14] START round=47 head_norm_before_train=2.140886 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9626647405417732, 'auprc': 0.9971531822926868, 'loss_val': 0.054308190787252714, 'psi': 0.9764601172421387}-{'f1_val': 0.972226092842815, 'auprc': 0.997158099919107, 'loss_val': 0.049260163369099275, 'psi': 0.9821988956733319}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.619576 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.700831603837779, 'auprc': 0.9146390734672943, 'loss_val': 0.47828508456150604, 'psi': 0.7863545916895851}-{'f1_val': 0.9029149098201734, 'auprc': 0.9974046443733283, 'loss_val': 0.21846639138823373, 'psi': 0.9407108036414353}
[S16] START round=47 head_norm_before_train=1.918757 cos_to_last_merge=0.7356 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.736
[S16] round=47 local utility u=1.000000 metrics={'f1_val': 0.9917127277493312, 'auprc': 0.9930951124027687, 'loss_val': 0.03889412290698997, 'psi': 0.9922656816107062}-{'f1_val': 0.8331804952449975, 'auprc': 0.9842670978188183, 'loss_val': 1.0804978560158105, 'psi': 0.8936151362745258}
[S17] START round=47 head_norm_before_train=2.085038 (no previous merge yet)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5862055668377797, 'auprc': 0.9383660678962876, 'loss_val': 1.266258835838731, 'psi': 0.7270697672611829}-{'f1_val': 0.7136721449180926, 'auprc': 0.9815690569962029, 'loss_val': 0.7360715524799737, 'psi': 0.8208309097493367}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:61807
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S5
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.281721)
[S6] loaded HEAD from S5 (vec_in norm=1.281721)
[S6] cosine check vs S5: cos=0.9987
[S6] BUFFERED delta from S5 (total buffered=1)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:61802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1804 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1804) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.925743)
[S2] loaded HEAD from S16 (vec_in norm=1.925743)
[S2] cosine check vs S16: cos=-0.1014
[S2] DROPPED delta from S16 (cos=-0.1014 < 0.0)
[S2] START round=48 head_norm_before_train=2.080409 cos_to_last_merge=0.9999 (last merge round=40)
[S2] round=48 local utility u=0.372991 metrics={'f1_val': 0.8258571195780327, 'auprc': 0.8748524819126987, 'loss_val': 0.4159710392628022, 'psi': 0.8454552645118991}-{'f1_val': 0.7535859673332062, 'auprc': 0.8531541409418941, 'loss_val': 0.6632304164313264, 'psi': 0.7934132367766813}
[S3] START round=48 head_norm_before_train=2.144886 (no previous merge yet)
[S3] round=48 local utility u=0.000449 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9993447736868146, 'loss_val': 0.021116179596426286, 'psi': 0.9981768509423603}-{'f1_val': 0.9973696976584205, 'auprc': 0.9989175059927621, 'loss_val': 0.02056164028204252, 'psi': 0.9979888209921571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=48 head_norm_before_train=2.101940 cos_to_last_merge=0.9953 (last merge round=33)
[S4] round=48 local utility u=0.039896 metrics={'f1_val': 0.9566591063750732, 'auprc': 0.9593163639917359, 'loss_val': 0.2741885899608347, 'psi': 0.9577220094217384}-{'f1_val': 0.9472420900519927, 'auprc': 0.9541883300716578, 'loss_val': 0.2820940740183026, 'psi': 0.9500205860598587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=48 head_norm_before_train=1.281721 cos_to_last_merge=0.9995 (last merge round=45)
[S5] round=48 local utility u=0.951213 metrics={'f1_val': 0.9960975975178937, 'auprc': 0.9982205045982535, 'loss_val': 0.1674205610538254, 'psi': 0.9969467603500377}-{'f1_val': 0.7002457463483669, 'auprc': 0.9907965949584898, 'loss_val': 0.2724646792875602, 'psi': 0.8164660857924161}
[S6] START round=48 head_norm_before_train=1.306252 cos_to_last_merge=0.9997 (last merge round=46)
[S6] round=48 local utility u=0.057413 metrics={'f1_val': 0.8070894065940543, 'auprc': 0.9562238298340623, 'loss_val': 0.43114224254459665, 'psi': 0.8667431758900574}-{'f1_val': 0.7998065149866528, 'auprc': 0.9497032782061128, 'loss_val': 0.48270950230706183, 'psi': 0.8597652202744368}
[S7] START round=48 head_norm_before_train=1.700841 cos_to_last_merge=1.0000 (last merge round=46)
[S7] round=48 local utility u=0.075764 metrics={'f1_val': 0.6375265080318417, 'auprc': 0.7915074345736697, 'loss_val': 0.5844095043518615, 'psi': 0.6991188786485729}-{'f1_val': 0.6270631179376813, 'auprc': 0.7896627694180975, 'loss_val': 0.6676232978321252, 'psi': 0.6921029785298478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=48 head_norm_before_train=1.554435 cos_to_last_merge=0.9962 (last merge round=39)
[S8] round=48 local utility u=0.101768 metrics={'f1_val': 0.9918431215757397, 'auprc': 0.9964982897137026, 'loss_val': 0.048178367182856494, 'psi': 0.9937051888309248}-{'f1_val': 0.9669612133911354, 'auprc': 0.996218991877375, 'loss_val': 0.10158485155930254, 'psi': 0.9786643247856313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=48 head_norm_before_train=1.629970 cos_to_last_merge=0.9997 (last merge round=45)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9988013244841547, 'loss_val': 0.056828786582388914, 'psi': 0.9951312148825807}-{'f1_val': 0.9966924912647621, 'auprc': 0.9938533367691214, 'loss_val': 0.05265231017044536, 'psi': 0.9955568294665058}
[S10] START round=48 head_norm_before_train=1.944751 cos_to_last_merge=0.7870 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.787
[S10] round=48 local utility u=0.000395 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9964182142696444, 'loss_val': 0.027626194616834073, 'psi': 0.9958012863242904}-{'f1_val': 0.9951704237150173, 'auprc': 0.9965422700524802, 'loss_val': 0.027470920620853073, 'psi': 0.9957191622500023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=48 head_norm_before_train=1.873507 cos_to_last_merge=0.9752 (last merge round=33)
[S11] round=48 local utility u=0.000119 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9980958537997079, 'loss_val': 0.03036294327217389, 'psi': 0.9969185464678687}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981815114912301, 'loss_val': 0.030858375421323192, 'psi': 0.9969528095444776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=48 head_norm_before_train=1.726169 cos_to_last_merge=0.9893 (last merge round=41)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.616718579152052, 'auprc': 0.7219391834601331, 'loss_val': 0.8672579356416887, 'psi': 0.6588068208752844}-{'f1_val': 0.6277880789988068, 'auprc': 0.6772637615784756, 'loss_val': 0.7804712398457907, 'psi': 0.6475783520306744}
[S14] START round=48 head_norm_before_train=2.148697 (no previous merge yet)
[S14] round=48 local utility u=0.120033 metrics={'f1_val': 0.9980403583402068, 'auprc': 0.9971529705704805, 'loss_val': 0.02649454444019223, 'psi': 0.9976854032323164}-{'f1_val': 0.9626647405417732, 'auprc': 0.9971531822926868, 'loss_val': 0.054308190787252714, 'psi': 0.9764601172421387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=48 head_norm_before_train=1.651397 cos_to_last_merge=0.9996 (last merge round=46)
[S15] round=48 local utility u=1.000000 metrics={'f1_val': 0.9544481921489063, 'auprc': 0.99582148951887, 'loss_val': 0.12111039446726249, 'psi': 0.9709975110968917}-{'f1_val': 0.700831603837779, 'auprc': 0.9146390734672943, 'loss_val': 0.47828508456150604, 'psi': 0.7863545916895851}
[S16] START round=48 head_norm_before_train=1.925743 cos_to_last_merge=0.7354 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.735
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.8470237421340787, 'auprc': 0.9862572593357198, 'loss_val': 0.534402403563382, 'psi': 0.9027171490147352}-{'f1_val': 0.9917127277493312, 'auprc': 0.9930951124027687, 'loss_val': 0.03889412290698997, 'psi': 0.9922656816107062}
[S17] START round=48 head_norm_before_train=2.090502 (no previous merge yet)
[S17] round=48 local utility u=0.102950 metrics={'f1_val': 0.5940402630786372, 'auprc': 0.9601221812734134, 'loss_val': 1.1726362638357364, 'psi': 0.7404730303565477}-{'f1_val': 0.5862055668377797, 'auprc': 0.9383660678962876, 'loss_val': 1.266258835838731, 'psi': 0.7270697672611829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:61805
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:61807
[S5] RECEIVED delta(kind=head bytes=1799) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.349660)
[S5] loaded HEAD from S6 (vec_in norm=1.349660)
[S5] cosine check vs S6: cos=0.9972
[S5] BUFFERED delta from S6 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=48 metric=0.8071 head_norm=1.349660
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.710615e-02
[S6] stored merged vector for next round verification (round=48)
[S6] DEBUG after merge:  round=48 metric=0.8071 head_norm=1.314890 delta_norm=0.057106
[S6] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S5
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.291208)
[S6] loaded HEAD from S5 (vec_in norm=1.291208)
[S6] cosine check vs S5: cos=0.9991
[S6] BUFFERED delta from S5 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=48 metric=0.9961 head_norm=1.291208
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.754757e-02
[S5] stored merged vector for next round verification (round=48)
[S5] DEBUG after merge:  round=48 metric=0.9961 head_norm=1.319503 delta_norm=0.057548
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:61810
[S15] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S15
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.678382)
[S9] loaded HEAD from S15 (vec_in norm=1.678382)
[S9] cosine check vs S15: cos=0.9963
[S9] BUFFERED delta from S15 (total buffered=1)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=48 metric=0.9927 head_norm=1.644753
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.325721e-02
[S9] stored merged vector for next round verification (round=48)
[S9] DEBUG after merge:  round=48 metric=0.9927 head_norm=1.660037 delta_norm=0.073257
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:61816
[S2] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S2
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.089630)
[S16] loaded HEAD from S2 (vec_in norm=2.089630)
[S16] cosine check vs S2: cos=-0.1008
[S16] DROPPED delta from S2 (cos=-0.1008 < 0.0)
[S2] START round=49 head_norm_before_train=2.089630 cos_to_last_merge=0.9999 (last merge round=40)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.8329149912576829, 'auprc': 0.842120591215081, 'loss_val': 0.38086178540470206, 'psi': 0.8365972312406421}-{'f1_val': 0.8258571195780327, 'auprc': 0.8748524819126987, 'loss_val': 0.4159710392628022, 'psi': 0.8454552645118991}
[S3] START round=49 head_norm_before_train=2.153963 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9907301042406972, 'auprc': 0.9997991455605876, 'loss_val': 0.034779396359378704, 'psi': 0.9943577207686534}-{'f1_val': 0.9973982357793907, 'auprc': 0.9993447736868146, 'loss_val': 0.021116179596426286, 'psi': 0.9981768509423603}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.104197 cos_to_last_merge=0.9948 (last merge round=33)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9440097709994774, 'auprc': 0.9524489595866535, 'loss_val': 0.28571324533519804, 'psi': 0.9473854464343479}-{'f1_val': 0.9566591063750732, 'auprc': 0.9593163639917359, 'loss_val': 0.2741885899608347, 'psi': 0.9577220094217384}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.319503 cos_to_last_merge=1.0000 (last merge round=48)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.6105664236063334, 'auprc': 0.853449289360125, 'loss_val': 0.6524811585557185, 'psi': 0.70771956990785}-{'f1_val': 0.9960975975178937, 'auprc': 0.9982205045982535, 'loss_val': 0.1674205610538254, 'psi': 0.9969467603500377}
[S6] START round=49 head_norm_before_train=1.314890 cos_to_last_merge=1.0000 (last merge round=48)
[S6] round=49 local utility u=0.299447 metrics={'f1_val': 0.873856095505246, 'auprc': 0.9726348838261083, 'loss_val': 0.2820822112711027, 'psi': 0.913367610833591}-{'f1_val': 0.8070894065940543, 'auprc': 0.9562238298340623, 'loss_val': 0.43114224254459665, 'psi': 0.8667431758900574}
[S7] START round=49 head_norm_before_train=1.705542 cos_to_last_merge=1.0000 (last merge round=46)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5466802510133686, 'auprc': 0.781772177116664, 'loss_val': 0.8288358387144829, 'psi': 0.6407170214546868}-{'f1_val': 0.6375265080318417, 'auprc': 0.7915074345736697, 'loss_val': 0.5844095043518615, 'psi': 0.6991188786485729}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.565532 cos_to_last_merge=0.9957 (last merge round=39)
[S8] round=49 local utility u=0.005498 metrics={'f1_val': 0.9920877483955324, 'auprc': 0.9990696164864814, 'loss_val': 0.04636507989597988, 'psi': 0.994880495631912}-{'f1_val': 0.9918431215757397, 'auprc': 0.9964982897137026, 'loss_val': 0.048178367182856494, 'psi': 0.9937051888309248}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=49 head_norm_before_train=1.660037 cos_to_last_merge=1.0000 (last merge round=48)
[S9] round=49 local utility u=0.014556 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9985639641420581, 'loss_val': 0.044557604516236575, 'psi': 0.9967914719306852}-{'f1_val': 0.992684475148198, 'auprc': 0.9988013244841547, 'loss_val': 0.056828786582388914, 'psi': 0.9951312148825807}
[S10] START round=49 head_norm_before_train=1.951374 cos_to_last_merge=0.7865 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.786
[S10] round=49 local utility u=0.000284 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9964519641676065, 'loss_val': 0.027160137716282933, 'psi': 0.9958147862834752}-{'f1_val': 0.9953900010273877, 'auprc': 0.9964182142696444, 'loss_val': 0.027626194616834073, 'psi': 0.9958012863242904}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=49 head_norm_before_train=1.884828 cos_to_last_merge=0.9741 (last merge round=33)
[S11] round=49 local utility u=0.000329 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981007795915668, 'loss_val': 0.02971927807639823, 'psi': 0.9969205167846124}-{'f1_val': 0.9961336749133093, 'auprc': 0.9980958537997079, 'loss_val': 0.03036294327217389, 'psi': 0.9969185464678687}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=49 head_norm_before_train=1.733139 cos_to_last_merge=0.9885 (last merge round=41)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5912124034566618, 'auprc': 0.5972683563978358, 'loss_val': 0.9465730362779431, 'psi': 0.5936347846331315}-{'f1_val': 0.616718579152052, 'auprc': 0.7219391834601331, 'loss_val': 0.8672579356416887, 'psi': 0.6588068208752844}
[S14] START round=49 head_norm_before_train=2.157540 (no previous merge yet)
[S14] round=49 local utility u=0.004101 metrics={'f1_val': 0.9980403583402068, 'auprc': 0.9988529948894449, 'loss_val': 0.02339197170802635, 'psi': 0.998365412959902}-{'f1_val': 0.9980403583402068, 'auprc': 0.9971529705704805, 'loss_val': 0.02649454444019223, 'psi': 0.9976854032323164}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=49 head_norm_before_train=1.678382 cos_to_last_merge=0.9988 (last merge round=46)
[S15] round=49 local utility u=0.099574 metrics={'f1_val': 0.9831984437764486, 'auprc': 0.9990184988315932, 'loss_val': 0.10405553869227344, 'psi': 0.9895264657985063}-{'f1_val': 0.9544481921489063, 'auprc': 0.99582148951887, 'loss_val': 0.12111039446726249, 'psi': 0.9709975110968917}
[S16] START round=49 head_norm_before_train=1.931391 cos_to_last_merge=0.7358 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.736
[S16] round=49 local utility u=0.698171 metrics={'f1_val': 0.9929985203277247, 'auprc': 0.9938951817944859, 'loss_val': 0.03682255942984426, 'psi': 0.9933571849144291}-{'f1_val': 0.8470237421340787, 'auprc': 0.9862572593357198, 'loss_val': 0.534402403563382, 'psi': 0.9027171490147352}
[S17] START round=49 head_norm_before_train=2.093637 (no previous merge yet)
[S17] round=49 local utility u=0.347388 metrics={'f1_val': 0.6430468716056409, 'auprc': 0.9790708220202012, 'loss_val': 0.8287460268481649, 'psi': 0.777456451771465}-{'f1_val': 0.5940402630786372, 'auprc': 0.9601221812734134, 'loss_val': 1.1726362638357364, 'psi': 0.7404730303565477}
[S17] not sending this round → trigger blocked (psi=0.777)
[S9]  timeout peer S11
[S2]  timeout peer S4
[S15]  timeout peer S8
[S5]  timeout peer S13
[S13]  timeout peer S7
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.913)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:61802
[S16] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → trigger blocked (psi=0.990)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=49 metric=0.8739 head_norm=1.361049
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.447040e-02
[S6] stored merged vector for next round verification (round=49)
[S6] DEBUG after merge:  round=49 metric=0.8735 head_norm=1.325469 delta_norm=0.054470
[S6] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:61815
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] RECEIVED delta(kind=head bytes=1800) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.935859)
[S2] loaded HEAD from S16 (vec_in norm=1.935859)
[S2] cosine check vs S16: cos=-0.1003
[S2] DROPPED delta from S16 (cos=-0.1003 < 0.0)
[S9] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.675177)
[S15] loaded HEAD from S9 (vec_in norm=1.675177)
[S15] cosine check vs S9: cos=0.9982
[S15] BUFFERED delta from S9 (total buffered=1)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
