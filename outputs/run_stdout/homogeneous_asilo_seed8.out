[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:61803
[S3] → join 127.0.0.1:61802
[S4] → join 127.0.0.1:61802
[S5] → join 127.0.0.1:61802
[S6] → join 127.0.0.1:61802
[S7] → join 127.0.0.1:61802
[S8] → join 127.0.0.1:61802
[S9] → join 127.0.0.1:61802
[S10] → join 127.0.0.1:61802
[S11] → join 127.0.0.1:61802
[S13] → join 127.0.0.1:61802
[S14] → join 127.0.0.1:61802
[S15] → join 127.0.0.1:61802
[S16] → join 127.0.0.1:61802
[S17] → join 127.0.0.1:61802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.205246 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.088524 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.171584 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.190783 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.180045 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.163007 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.144915 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.134935 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.195726 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.141218 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.172212 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.132286 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.251110 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.114937 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.155219 (no previous merge yet)
[S3]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3] + discovered S4
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S16
[S3] + discovered S5
[S3] + discovered S7
[S3] + discovered S17
[S3] + discovered S15
[S3] + discovered S13
[S3] + discovered S6
[S3] + discovered S14
[S3] + discovered S10
[S3] + discovered S11
[S3] + discovered S9
[S3] + discovered S8
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S16
[S4] + discovered S7
[S4] + discovered S5
[S4] + discovered S15
[S4] + discovered S17
[S4] + discovered S13
[S4] + discovered S6
[S4] + discovered S14
[S4] + discovered S10
[S4] + discovered S8
[S4] + discovered S9
[S4] + discovered S11
[S5] + discovered S17
[S5] + discovered S9
[S5] + discovered S10
[S5] + discovered S14
[S5] + discovered S13
[S5] + discovered S7
[S5] + discovered S16
[S5] + discovered S8
[S5] + discovered S11
[S5] + discovered S6
[S5] + discovered S15
[S6] + discovered S3
[S6] + discovered S2
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S15
[S6] + discovered S11
[S6] + discovered S10
[S6] + discovered S9
[S6] + discovered S8
[S6] + discovered S7
[S6] + discovered S13
[S7] + discovered S4
[S7] + discovered S2
[S6] + discovered S17
[S6] + discovered S14
[S7] + discovered S5
[S7] + discovered S6
[S7] + discovered S3
[S6] + discovered S16
[S7] + discovered S15
[S7] + discovered S16
[S7] + discovered S17
[S8] + discovered S4
[S8] + discovered S2
[S8] + discovered S3
[S8] + discovered S7
[S8] + discovered S5
[S8] + discovered S6
[S7] + discovered S10
[S7] + discovered S9
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S13
[S7] + discovered S11
[S9] + discovered S8
[S9] + discovered S5
[S9] + discovered S4
[S9] + discovered S3
[S8] + discovered S17
[S8] + discovered S16
[S9] + discovered S2
[S8] + discovered S10
[S9] + discovered S6
[S8] + discovered S15
[S8] + discovered S9
[S9] + discovered S7
[S8] + discovered S13
[S8] + discovered S14
[S8] + discovered S11
[S9] + discovered S11
[S9] + discovered S16
[S9] + discovered S13
[S9] + discovered S15
[S9] + discovered S14
[S9] + discovered S10
[S10] + discovered S7
[S10] + discovered S4
[S10] + discovered S2
[S10] + discovered S9
[S10] + discovered S3
[S10] + discovered S6
[S9] + discovered S17
[S10] + discovered S5
[S10] + discovered S8
[S11] + discovered S8
[S11] + discovered S2
[S11] + discovered S3
[S11] + discovered S10
[S11] + discovered S9
[S11] + discovered S5
[S11] + discovered S4
[S10] + discovered S13
[S11] + discovered S7
[S11] + discovered S6
[S10] + discovered S14
[S10] + discovered S11
[S10] + discovered S17
[S10] + discovered S16
[S10] + discovered S15
[S13] + discovered S6
[S13] + discovered S2
[S11] + discovered S14
[S13] + discovered S3
[S13] + discovered S10
[S11] + discovered S15
[S13] + discovered S5
[S13] + discovered S7
[S13] + discovered S9
[S13] + discovered S8
[S13] + discovered S11
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S16
[S13] + discovered S4
[S13] + discovered S15
[S13] + discovered S14
[S13] + discovered S16
[S13] + discovered S17
[S14] + discovered S7
[S14] + discovered S5
[S14] + discovered S3
[S14] + discovered S10
[S14] + discovered S6
[S14] + discovered S11
[S14] + discovered S4
[S14] + discovered S13
[S14] + discovered S8
[S14] + discovered S9
[S14] + discovered S2
[S15] + discovered S10
[S15] + discovered S5
[S15] + discovered S13
[S14] + discovered S17
[S15] + discovered S7
[S15] + discovered S3
[S15] + discovered S14
[S14] + discovered S16
[S15] + discovered S6
[S14] + discovered S15
[S15] + discovered S2
[S15] + discovered S4
[S15] + discovered S9
[S15] + discovered S8
[S15] + discovered S11
[S16] + discovered S2
[S16] + discovered S8
[S16] + discovered S15
[S16] + discovered S14
[S16] + discovered S10
[S16] + discovered S4
[S16] + discovered S13
[S16] + discovered S7
[S16] + discovered S6
[S16] + discovered S3
[S16] + discovered S11
[S16] + discovered S5
[S16] + discovered S9
[S15] + discovered S17
[S15] + discovered S16
[S17] + discovered S4
[S17] + discovered S5
[S17] + discovered S8
[S17] + discovered S11
[S17] + discovered S6
[S17] + discovered S3
[S17] + discovered S7
[S17] + discovered S16
[S17] + discovered S10
[S17] + discovered S14
[S17] + discovered S2
[S17] + discovered S13
[S17] + discovered S9
[S16] + discovered S17
[S17] + discovered S15
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:61815
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:61812
[S15] ⇄ pheromone p=1.000 → S9@127.0.0.1:61810
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:61802
[S11] ⇄ pheromone p=1.000 → S5@127.0.0.1:61805
[S5] ⇄ pheromone p=1.000 → S13@127.0.0.1:61813
[S2] ⇄ pheromone p=1.000 → S9@127.0.0.1:61810
[S9] ⇄ pheromone p=1.000 → S2@127.0.0.1:61802
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:61808
[S3] ⇄ pheromone p=1.000 → S13@127.0.0.1:61813
[S7] ⇄ pheromone p=1.000 → S8@127.0.0.1:61809
[S10] ⇄ pheromone p=1.000 → S4@127.0.0.1:61804
[S6] ⇄ pheromone p=1.000 → S5@127.0.0.1:61805
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:61808
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:61813
[S2] START round=1 head_norm_before_train=1.198909 (no previous merge yet)
[S2] round=1 local utility u=0.167451 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6344815370279452, 'loss_val': 1.3265852429529243, 'psi': 0.33885889484431814}-{'f1_val': 0.1417771333885667, 'auprc': 0.5343288046955474, 'loss_val': 1.3610289365364554, 'psi': 0.298797801911359}
[S3] START round=1 head_norm_before_train=1.087525 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.28710227272727273, 'auprc': 0.8628254322171156, 'loss_val': 1.3256972082399245, 'psi': 0.5173915365232099}-{'f1_val': 0.3714574568087049, 'auprc': 0.8355210324834326, 'loss_val': 1.354811100308333, 'psi': 0.557082887078596}
[S4] START round=1 head_norm_before_train=1.172274 (no previous merge yet)
[S4] round=1 local utility u=0.428386 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7130342858879757, 'loss_val': 1.3221313088218136, 'psi': 0.36934969169230075}-{'f1_val': 0.14022662889518414, 'auprc': 0.43741119779671145, 'loss_val': 1.3520331828922296, 'psi': 0.25910045645579505}
[S5] START round=1 head_norm_before_train=1.199050 (no previous merge yet)
[S5] round=1 local utility u=0.039992 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7577320275126269, 'loss_val': 1.2891513838329118, 'psi': 0.38844995386219366}-{'f1_val': 0.14226190476190476, 'auprc': 0.7417353300225121, 'loss_val': 1.3211445908076338, 'psi': 0.3820512748661477}
[S6] START round=1 head_norm_before_train=1.185391 (no previous merge yet)
[S6] round=1 local utility u=0.244287 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7889424095097213, 'loss_val': 1.3209738624689091, 'psi': 0.40043273303465776}-{'f1_val': 0.14142628205128205, 'auprc': 0.6350064544939973, 'loss_val': 1.3477405411468402, 'psi': 0.33885835102836814}
[S7] START round=1 head_norm_before_train=1.171376 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6205490718889148, 'loss_val': 1.3154175770789596, 'psi': 0.33345372239302096}-{'f1_val': 0.3752124839484, 'auprc': 0.592166461669935, 'loss_val': 1.3517398775456302, 'psi': 0.46199407503701406}
[S8] START round=1 head_norm_before_train=1.146401 (no previous merge yet)
[S8] round=1 local utility u=0.000980 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7659429565682239, 'loss_val': 1.3205065318650966, 'psi': 0.3903507720630639}-{'f1_val': 0.13995598239295717, 'auprc': 0.7763065518002504, 'loss_val': 1.3535582105023836, 'psi': 0.3944962101558745}
[S9] START round=1 head_norm_before_train=1.133029 (no previous merge yet)
[S9] round=1 local utility u=0.316909 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8649101541292368, 'loss_val': 1.3030714457681318, 'psi': 0.43080283593569235}-{'f1_val': 0.141397957139996, 'auprc': 0.6663706241769514, 'loss_val': 1.3412714687649374, 'psi': 0.35138702395477817}
[S10] START round=1 head_norm_before_train=1.198774 (no previous merge yet)
[S10] round=1 local utility u=0.021816 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5789513543261683, 'loss_val': 1.3287049219683909, 'psi': 0.3147535242555017}-{'f1_val': 0.13862163754172394, 'auprc': 0.5761558322142004, 'loss_val': 1.3639493580801412, 'psi': 0.31363531541071454}
[S11] START round=1 head_norm_before_train=1.140729 (no previous merge yet)
[S11] round=1 local utility u=0.181374 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6276974490971785, 'loss_val': 1.337918632241396, 'psi': 0.3353271896627378}-{'f1_val': 0.15641654803672572, 'auprc': 0.4872584194316286, 'loss_val': 1.3753673663654877, 'psi': 0.2887532965946869}
[S13] START round=1 head_norm_before_train=1.174197 (no previous merge yet)
[S13] round=1 local utility u=0.408288 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5929073271231932, 'loss_val': 1.3402545343312904, 'psi': 0.32139438839550916}-{'f1_val': 0.1403857625770531, 'auprc': 0.3310409772887488, 'loss_val': 1.37123164448837, 'psi': 0.2166478484617314}
[S14] START round=1 head_norm_before_train=1.131221 (no previous merge yet)
[S14] round=1 local utility u=0.721944 metrics={'f1_val': 0.2842610593189057, 'auprc': 0.7154641095003818, 'loss_val': 1.355423016417961, 'psi': 0.45674227939149614}-{'f1_val': 0.05498154981549815, 'auprc': 0.7012116025260695, 'loss_val': 1.3808759511912079, 'psi': 0.3134735708997267}
[S15] START round=1 head_norm_before_train=1.250345 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7630556587103341, 'loss_val': 1.3160365363527562, 'psi': 0.38906245430106867}-{'f1_val': 0.3745682713313029, 'auprc': 0.7344763828748428, 'loss_val': 1.3519807827427794, 'psi': 0.5185315159487188}
[S16] START round=1 head_norm_before_train=1.113516 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8638514325846294, 'loss_val': 1.3149482259863232, 'psi': 0.4299230431533737}-{'f1_val': 0.24346312924091362, 'auprc': 0.8087238496976982, 'loss_val': 1.339056595149042, 'psi': 0.4695674174236275}
[S17] START round=1 head_norm_before_train=1.165230 (no previous merge yet)
[S17] round=1 local utility u=0.014851 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5912881937876322, 'loss_val': 1.3221485207971633, 'psi': 0.3210846555054835}-{'f1_val': 0.14094896331738438, 'auprc': 0.5911194561929041, 'loss_val': 1.3513450151766209, 'psi': 0.32101716046759227}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S3@127.0.0.1:61803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S10] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S2] → sending delta(kind=head bytes=1783) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:61811
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S5] → sending delta(kind=head bytes=1784) to S10@127.0.0.1:61811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S6] → sending delta(kind=head bytes=1784) to S16@127.0.0.1:61816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:61803
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:61805
[S2] sending update (kind=head size=1783 to 1 peers)
[S10] sending update (kind=head size=1788 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1784 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S5] sending update (kind=head size=1784 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1789) from S4
[S7] cosine check vs S4: cos=0.0081
[S5] RECEIVED delta(kind=head bytes=1790) from S13
[S5] cosine check vs S13: cos=0.0314
[S16] RECEIVED delta(kind=head bytes=1783) from S2
[S16] cosine check vs S2: cos=0.1050
[S3] RECEIVED delta(kind=head bytes=1789) from S11
[S3] cosine check vs S11: cos=0.0150
[S3] RECEIVED delta(kind=head bytes=1790) from S9
[S3] cosine check vs S9: cos=-0.0063
[S3] DROPPED delta from S9 (cos=-0.0063 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1784) from S6
[S16] cosine check vs S6: cos=0.0034
[S10] RECEIVED delta(kind=head bytes=1784) from S5
[S10] cosine check vs S5: cos=0.0255
[S10] RECEIVED delta(kind=head bytes=1791) from S8
[S10] cosine check vs S8: cos=0.0275
[S11] RECEIVED delta(kind=head bytes=1789) from S14
[S11] cosine check vs S14: cos=0.0174
[S9] RECEIVED delta(kind=head bytes=1788) from S10
[S9] cosine check vs S10: cos=0.0030
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:61812
[S17] sending update (kind=head size=1790 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1790) from S17
[S11] cosine check vs S17: cos=-0.0775
[S11] DROPPED delta from S17 (cos=-0.0775 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.190086
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.365396e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.843341 delta_norm=0.836540
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=1 metric=0.2871 head_norm=1.098220
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.899417e-01
[S3] stored merged vector for next round verification (round=1)
[S3] DEBUG after merge:  round=1 metric=0.0897 head_norm=0.801835 delta_norm=0.789942
[S3] aggregate: ROLLBACK (f1_val pre=0.287 post=0.090 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.121809
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.829914e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.734655 delta_norm=0.682991
[S16] aggregate: ACCEPT kept=['S2', 'S6'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.213751
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.336942e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.860280 delta_norm=0.833694
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.209505
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.079174e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.734233 delta_norm=0.707917
[S10] aggregate: ACCEPT kept=['S5', 'S8'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.152306
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.037515e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.817854 delta_norm=0.803752
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.146033
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.318512e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.834369 delta_norm=0.831851
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.204571 (no previous merge yet)
[S2] round=2 local utility u=0.219590 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7666557262375837, 'loss_val': 1.283927668612387, 'psi': 0.39172857052817356}-{'f1_val': 0.1417771333885667, 'auprc': 0.6344815370279452, 'loss_val': 1.3265852429529243, 'psi': 0.33885889484431814}
[S3] START round=2 head_norm_before_train=0.801835 cos_to_last_merge=1.0000 (last merge round=1)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.18030385215028727, 'auprc': 0.8627371985055664, 'loss_val': 1.3470464199742227, 'psi': 0.45327719069239897}-{'f1_val': 0.28710227272727273, 'auprc': 0.8628254322171156, 'loss_val': 1.3256972082399245, 'psi': 0.5173915365232099}
[S4] START round=2 head_norm_before_train=1.185639 (no previous merge yet)
[S4] round=2 local utility u=0.144818 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7988940569136326, 'loss_val': 1.2900754165833739, 'psi': 0.40369360010256355}-{'f1_val': 0.14022662889518414, 'auprc': 0.7130342858879757, 'loss_val': 1.3221313088218136, 'psi': 0.36934969169230075}
[S5] START round=2 head_norm_before_train=0.860280 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.014119 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7694890931544727, 'loss_val': 1.2961836058047636, 'psi': 0.39315278011893195}-{'f1_val': 0.14226190476190476, 'auprc': 0.7577320275126269, 'loss_val': 1.2891513838329118, 'psi': 0.38844995386219366}
[S6] START round=2 head_norm_before_train=1.199824 (no previous merge yet)
[S6] round=2 local utility u=0.039879 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8051823824275814, 'loss_val': 1.289936515561795, 'psi': 0.4069287222018018}-{'f1_val': 0.14142628205128205, 'auprc': 0.7889424095097213, 'loss_val': 1.3209738624689091, 'psi': 0.40043273303465776}
[S7] START round=2 head_norm_before_train=0.843341 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.258969 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.792805736513354, 'loss_val': 1.3142491815175357, 'psi': 0.40235638824279657}-{'f1_val': 0.14205682272909165, 'auprc': 0.6205490718889148, 'loss_val': 1.3154175770789596, 'psi': 0.33345372239302096}
[S8] START round=2 head_norm_before_train=1.158044 (no previous merge yet)
[S8] round=2 local utility u=0.018627 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7658747365972488, 'loss_val': 1.28304839717094, 'psi': 0.3903234840746739}-{'f1_val': 0.13995598239295717, 'auprc': 0.7659429565682239, 'loss_val': 1.3205065318650966, 'psi': 0.3903507720630639}
[S9] START round=2 head_norm_before_train=0.834369 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8657005694159579, 'loss_val': 1.310350138351101, 'psi': 0.4311190020503808}-{'f1_val': 0.141397957139996, 'auprc': 0.8649101541292368, 'loss_val': 1.3030714457681318, 'psi': 0.43080283593569235}
[S10] START round=2 head_norm_before_train=0.734233 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5760267779759319, 'loss_val': 1.3250177313575107, 'psi': 0.3135836937154072}-{'f1_val': 0.13862163754172394, 'auprc': 0.5789513543261683, 'loss_val': 1.3287049219683909, 'psi': 0.3147535242555017}
[S11] START round=2 head_norm_before_train=0.817854 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.182224 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7439036679075759, 'loss_val': 1.3220895009725402, 'psi': 0.38180967718689673}-{'f1_val': 0.14041368337311058, 'auprc': 0.6276974490971785, 'loss_val': 1.337918632241396, 'psi': 0.3353271896627378}
[S13] START round=2 head_norm_before_train=1.181975 (no previous merge yet)
[S13] round=2 local utility u=0.199482 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7149116494934161, 'loss_val': 1.3073043848945147, 'psi': 0.3701961173435983}-{'f1_val': 0.1403857625770531, 'auprc': 0.5929073271231932, 'loss_val': 1.3402545343312904, 'psi': 0.32139438839550916}
[S14] START round=2 head_norm_before_train=1.141049 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7544021526093516, 'loss_val': 1.3265997102881701, 'psi': 0.3859755727733629}-{'f1_val': 0.2842610593189057, 'auprc': 0.7154641095003818, 'loss_val': 1.355423016417961, 'psi': 0.45674227939149614}
[S15] START round=2 head_norm_before_train=1.258789 (no previous merge yet)
[S15] round=2 local utility u=0.033589 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7716146174330875, 'loss_val': 1.274536223087932, 'psi': 0.39248603779017}-{'f1_val': 0.13973365136155833, 'auprc': 0.7630556587103341, 'loss_val': 1.3160365363527562, 'psi': 0.38906245430106867}
[S16] START round=2 head_norm_before_train=0.734655 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.004901 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8680586775897576, 'loss_val': 1.3177688635800682, 'psi': 0.43160594115542494}-{'f1_val': 0.14063745019920318, 'auprc': 0.8638514325846294, 'loss_val': 1.3149482259863232, 'psi': 0.4299230431533737}
[S17] START round=2 head_norm_before_train=1.183556 (no previous merge yet)
[S17] round=2 local utility u=0.005902 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5825916687825352, 'loss_val': 1.2842557519663929, 'psi': 0.31760604550344473}-{'f1_val': 0.14094896331738438, 'auprc': 0.5912881937876322, 'loss_val': 1.3221485207971633, 'psi': 0.3210846555054835}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.392)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:61811
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S15] → sending delta(kind=head bytes=1788) to S2@127.0.0.1:61802
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.393)
[S11] not sending this round → trigger blocked (psi=0.382)
[S13] not sending this round → trigger blocked (psi=0.370)
[S4] not sending this round → trigger blocked (psi=0.404)
[S6] not sending this round → trigger blocked (psi=0.407)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.390)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:61811
[S15] sending update (kind=head size=1788 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1788) from S15
[S2] cosine check vs S15: cos=0.0350
[S10] RECEIVED delta(kind=head bytes=1794) from S7
[S10] cosine check vs S7: cos=-0.0146
[S10] DROPPED delta from S7 (cos=-0.0146 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S16
[S10] cosine check vs S16: cos=0.0380
[S17] not sending this round → trigger blocked (psi=0.318)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=1.221174
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.680381e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.898940 delta_norm=0.868038
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=0.749899
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.210643e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.541230 delta_norm=0.521064
[S10] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.898940 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.008379 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7691040259825553, 'loss_val': 1.274513574118155, 'psi': 0.3927078904261622}-{'f1_val': 0.1417771333885667, 'auprc': 0.7666557262375837, 'loss_val': 1.283927668612387, 'psi': 0.39172857052817356}
[S3] START round=3 head_norm_before_train=0.813054 cos_to_last_merge=0.9960 (last merge round=1)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8884331748076462, 'loss_val': 1.3066012695712343, 'psi': 0.43927730929152276}-{'f1_val': 0.18030385215028727, 'auprc': 0.8627371985055664, 'loss_val': 1.3470464199742227, 'psi': 0.45327719069239897}
[S4] START round=3 head_norm_before_train=1.209920 (no previous merge yet)
[S4] round=3 local utility u=0.180832 metrics={'f1_val': 0.21882819789388552, 'auprc': 0.7473749279663796, 'loss_val': 1.2454633435153502, 'psi': 0.4302468899228832}-{'f1_val': 0.14022662889518414, 'auprc': 0.7988940569136326, 'loss_val': 1.2900754165833739, 'psi': 0.40369360010256355}
[S5] START round=3 head_norm_before_train=0.877530 cos_to_last_merge=0.9980 (last merge round=1)
[S5] round=3 local utility u=0.021882 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7690957071174759, 'loss_val': 1.2512397225784375, 'psi': 0.3929954257041332}-{'f1_val': 0.14226190476190476, 'auprc': 0.7694890931544727, 'loss_val': 1.2961836058047636, 'psi': 0.39315278011893195}
[S6] START round=3 head_norm_before_train=1.220661 (no previous merge yet)
[S6] round=3 local utility u=0.055288 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8290840804925768, 'loss_val': 1.2510666054409065, 'psi': 0.41648940142779994}-{'f1_val': 0.14142628205128205, 'auprc': 0.8051823824275814, 'loss_val': 1.289936515561795, 'psi': 0.4069287222018018}
[S7] START round=3 head_norm_before_train=0.866275 cos_to_last_merge=0.9969 (last merge round=1)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7772993619146551, 'loss_val': 1.275130987754188, 'psi': 0.396153838403317}-{'f1_val': 0.14205682272909165, 'auprc': 0.792805736513354, 'loss_val': 1.3142491815175357, 'psi': 0.40235638824279657}
[S8] START round=3 head_norm_before_train=1.180375 (no previous merge yet)
[S8] round=3 local utility u=0.022214 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.765446971980677, 'loss_val': 1.2373367170224356, 'psi': 0.39015237822804516}-{'f1_val': 0.13995598239295717, 'auprc': 0.7658747365972488, 'loss_val': 1.28304839717094, 'psi': 0.3903234840746739}
[S9] START round=3 head_norm_before_train=0.845009 cos_to_last_merge=0.9961 (last merge round=1)
[S9] round=3 local utility u=0.022098 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659681239113233, 'loss_val': 1.2669564628949979, 'psi': 0.43122602384852693}-{'f1_val': 0.141397957139996, 'auprc': 0.8657005694159579, 'loss_val': 1.310350138351101, 'psi': 0.4311190020503808}
[S10] START round=3 head_norm_before_train=0.541230 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.000172 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5745034364226621, 'loss_val': 1.3201027509388914, 'psi': 0.3129743570940992}-{'f1_val': 0.13862163754172394, 'auprc': 0.5760267779759319, 'loss_val': 1.3250177313575107, 'psi': 0.3135836937154072}
[S11] START round=3 head_norm_before_train=0.842462 cos_to_last_merge=0.9960 (last merge round=1)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5886444303604625, 'loss_val': 1.277653983505555, 'psi': 0.31970598216805135}-{'f1_val': 0.14041368337311058, 'auprc': 0.7439036679075759, 'loss_val': 1.3220895009725402, 'psi': 0.38180967718689673}
[S13] START round=3 head_norm_before_train=1.196602 (no previous merge yet)
[S13] round=3 local utility u=0.025952 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7216455666784075, 'loss_val': 1.275602855909951, 'psi': 0.3728896842175949}-{'f1_val': 0.1403857625770531, 'auprc': 0.7149116494934161, 'loss_val': 1.3073043848945147, 'psi': 0.3701961173435983}
[S14] START round=3 head_norm_before_train=1.161687 (no previous merge yet)
[S14] round=3 local utility u=0.063745 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7841739816679527, 'loss_val': 1.2884251507343103, 'psi': 0.39788430439680333}-{'f1_val': 0.14035785288270378, 'auprc': 0.7544021526093516, 'loss_val': 1.3265997102881701, 'psi': 0.3859755727733629}
[S15] START round=3 head_norm_before_train=1.277459 (no previous merge yet)
[S15] round=3 local utility u=0.038034 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7827890644531487, 'loss_val': 1.231991978672312, 'psi': 0.3969558165981945}-{'f1_val': 0.13973365136155833, 'auprc': 0.7716146174330875, 'loss_val': 1.274536223087932, 'psi': 0.39248603779017}
[S16] START round=3 head_norm_before_train=0.752681 cos_to_last_merge=0.9966 (last merge round=1)
[S16] round=3 local utility u=0.206024 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9961393229683562, 'loss_val': 1.2899627759940748, 'psi': 0.48283819930686445}-{'f1_val': 0.14063745019920318, 'auprc': 0.8680586775897576, 'loss_val': 1.3177688635800682, 'psi': 0.43160594115542494}
[S17] START round=3 head_norm_before_train=1.210556 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5602151217951099, 'loss_val': 1.231864776594974, 'psi': 0.30865542670847457}-{'f1_val': 0.14094896331738438, 'auprc': 0.5825916687825352, 'loss_val': 1.2842557519663929, 'psi': 0.31760604550344473}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61812
[S15] not sending this round → trigger blocked (psi=0.397)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:61804
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.483)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:61808
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61808
[S14] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1792) from S8
[S15] cosine check vs S8: cos=-0.0674
[S15] DROPPED delta from S8 (cos=-0.0674 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S5
[S13] cosine check vs S5: cos=0.6806
[S11] RECEIVED delta(kind=head bytes=1794) from S4
[S11] cosine check vs S4: cos=-0.0557
[S11] DROPPED delta from S4 (cos=-0.0557 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S9
[S11] cosine check vs S9: cos=-0.0301
[S11] DROPPED delta from S9 (cos=-0.0301 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] cosine check vs S13: cos=-0.0573
[S7] DROPPED delta from S13 (cos=-0.0573 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1794) from S14
[S7] cosine check vs S14: cos=-0.0501
[S7] DROPPED delta from S14 (cos=-0.0501 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S2
[S4] cosine check vs S2: cos=-0.0657
[S4] DROPPED delta from S2 (cos=-0.0657 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S6
[S5] cosine check vs S6: cos=-0.0767
[S5] DROPPED delta from S6 (cos=-0.0767 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=-0.0484
[S4] DROPPED delta from S10 (cos=-0.0484 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.1404 head_norm=1.217144
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.475196e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.974443 delta_norm=0.447520
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.922590 cos_to_last_merge=0.9968 (last merge round=2)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6752870153419499, 'loss_val': 1.214462903003053, 'psi': 0.35518108616992}-{'f1_val': 0.1417771333885667, 'auprc': 0.7691040259825553, 'loss_val': 1.274513574118155, 'psi': 0.3927078904261622}
[S3] START round=4 head_norm_before_train=0.834976 cos_to_last_merge=0.9846 (last merge round=1)
[S3] round=4 local utility u=0.056222 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9061908373890846, 'loss_val': 1.2474298577512961, 'psi': 0.44638037432409805}-{'f1_val': 0.13984006561410703, 'auprc': 0.8884331748076462, 'loss_val': 1.3066012695712343, 'psi': 0.43927730929152276}
[S4] START round=4 head_norm_before_train=1.245571 (no previous merge yet)
[S4] round=4 local utility u=0.648500 metrics={'f1_val': 0.4148091473984988, 'auprc': 0.7635297758467967, 'loss_val': 1.1728136195366945, 'psi': 0.5542973987778179}-{'f1_val': 0.21882819789388552, 'auprc': 0.7473749279663796, 'loss_val': 1.2454633435153502, 'psi': 0.4302468899228832}
[S5] START round=4 head_norm_before_train=0.904537 cos_to_last_merge=0.9918 (last merge round=1)
[S5] round=4 local utility u=0.024413 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7677841308955214, 'loss_val': 1.1984783714146237, 'psi': 0.39247079521535144}-{'f1_val': 0.14226190476190476, 'auprc': 0.7690957071174759, 'loss_val': 1.2512397225784375, 'psi': 0.3929954257041332}
[S6] START round=4 head_norm_before_train=1.247580 (no previous merge yet)
[S6] round=4 local utility u=0.051592 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8452124531254378, 'loss_val': 1.1962674136946763, 'psi': 0.42294075048094437}-{'f1_val': 0.14142628205128205, 'auprc': 0.8290840804925768, 'loss_val': 1.2510666054409065, 'psi': 0.41648940142779994}
[S7] START round=4 head_norm_before_train=0.895410 cos_to_last_merge=0.9892 (last merge round=1)
[S7] round=4 local utility u=0.015990 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7773908160122855, 'loss_val': 1.243426149006344, 'psi': 0.3961904200423692}-{'f1_val': 0.14205682272909165, 'auprc': 0.7772993619146551, 'loss_val': 1.275130987754188, 'psi': 0.396153838403317}
[S8] START round=4 head_norm_before_train=1.209876 (no previous merge yet)
[S8] round=4 local utility u=0.030530 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7692386497148382, 'loss_val': 1.1876519105656829, 'psi': 0.39166904932170965}-{'f1_val': 0.13995598239295717, 'auprc': 0.765446971980677, 'loss_val': 1.2373367170224356, 'psi': 0.39015237822804516}
[S9] START round=4 head_norm_before_train=0.865701 cos_to_last_merge=0.9866 (last merge round=1)
[S9] round=4 local utility u=0.027903 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659934730134056, 'loss_val': 1.2112258357636956, 'psi': 0.43123616348935984}-{'f1_val': 0.141397957139996, 'auprc': 0.8659681239113233, 'loss_val': 1.2669564628949979, 'psi': 0.43122602384852693}
[S10] START round=4 head_norm_before_train=0.560463 cos_to_last_merge=0.9930 (last merge round=2)
[S10] round=4 local utility u=0.120361 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6413765194147555, 'loss_val': 1.279999295439741, 'psi': 0.3397235902909366}-{'f1_val': 0.13862163754172394, 'auprc': 0.5745034364226621, 'loss_val': 1.3201027509388914, 'psi': 0.3129743570940992}
[S11] START round=4 head_norm_before_train=0.872141 cos_to_last_merge=0.9867 (last merge round=1)
[S11] round=4 local utility u=0.025609 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5901088693341632, 'loss_val': 1.2308283828075286, 'psi': 0.3202917577575316}-{'f1_val': 0.14041368337311058, 'auprc': 0.5886444303604625, 'loss_val': 1.277653983505555, 'psi': 0.31970598216805135}
[S13] START round=4 head_norm_before_train=0.974443 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7182745272193338, 'loss_val': 1.266867040851972, 'psi': 0.3715412684339654}-{'f1_val': 0.1403857625770531, 'auprc': 0.7216455666784075, 'loss_val': 1.275602855909951, 'psi': 0.3728896842175949}
[S14] START round=4 head_norm_before_train=1.192774 (no previous merge yet)
[S14] round=4 local utility u=0.013195 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7751458505080091, 'loss_val': 1.234951475454656, 'psi': 0.3942730519328259}-{'f1_val': 0.14035785288270378, 'auprc': 0.7841739816679527, 'loss_val': 1.2884251507343103, 'psi': 0.39788430439680333}
[S15] START round=4 head_norm_before_train=1.300524 (no previous merge yet)
[S15] round=4 local utility u=0.028789 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7893527802683938, 'loss_val': 1.194105516366063, 'psi': 0.39958130292429256}-{'f1_val': 0.13973365136155833, 'auprc': 0.7827890644531487, 'loss_val': 1.231991978672312, 'psi': 0.3969558165981945}
[S16] START round=4 head_norm_before_train=0.777435 cos_to_last_merge=0.9872 (last merge round=1)
[S16] round=4 local utility u=0.023829 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9996621343519758, 'loss_val': 1.252872849839423, 'psi': 0.4842473238603122}-{'f1_val': 0.14063745019920318, 'auprc': 0.9961393229683562, 'loss_val': 1.2899627759940748, 'psi': 0.48283819930686445}
[S17] START round=4 head_norm_before_train=1.247611 (no previous merge yet)
[S17] round=4 local utility u=0.035732 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5564859436930957, 'loss_val': 1.1492131984903147, 'psi': 0.30716375546766894}-{'f1_val': 0.14094896331738438, 'auprc': 0.5602151217951099, 'loss_val': 1.231864776594974, 'psi': 0.30865542670847457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:61802
[S9] not sending this round → trigger blocked (psi=0.431)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:61805
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.423)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:61810
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:61813
[S10] not sending this round → trigger blocked (psi=0.340)
[S4] not sending this round → trigger blocked (psi=0.554)
[S5] not sending this round → trigger blocked (psi=0.392)
[S14] not sending this round → trigger blocked (psi=0.394)
[S8] not sending this round → trigger blocked (psi=0.392)
[S3] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1790) from S11
[S5] cosine check vs S11: cos=-0.0494
[S5] DROPPED delta from S11 (cos=-0.0494 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S15
[S9] cosine check vs S15: cos=-0.0011
[S9] DROPPED delta from S15 (cos=-0.0011 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1794) from S16
[S2] cosine check vs S16: cos=0.3310
[S8] RECEIVED delta(kind=head bytes=1791) from S7
[S8] cosine check vs S7: cos=-0.0400
[S8] DROPPED delta from S7 (cos=-0.0400 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1796) from S3
[S13] cosine check vs S3: cos=-0.0225
[S13] DROPPED delta from S3 (cos=-0.0225 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=-0.0585
[S13] DROPPED delta from S17 (cos=-0.0585 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=4 metric=0.1418 head_norm=0.956645
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.139220e-01
[S2] stored merged vector for next round verification (round=4)
[S2] DEBUG after merge:  round=4 metric=0.1418 head_norm=0.721132 delta_norm=0.513922
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.721132 cos_to_last_merge=1.0000 (last merge round=4)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.607307287014957, 'loss_val': 1.2000913317281914, 'psi': 0.3279891948391228}-{'f1_val': 0.1417771333885667, 'auprc': 0.6752870153419499, 'loss_val': 1.214462903003053, 'psi': 0.35518108616992}
[S3] START round=5 head_norm_before_train=0.866981 cos_to_last_merge=0.9681 (last merge round=1)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8465601502097899, 'loss_val': 1.1889022741254769, 'psi': 0.42252809945238023}-{'f1_val': 0.13984006561410703, 'auprc': 0.9061908373890846, 'loss_val': 1.2474298577512961, 'psi': 0.44638037432409805}
[S4] START round=5 head_norm_before_train=1.288140 (no previous merge yet)
[S4] round=5 local utility u=0.056457 metrics={'f1_val': 0.41570511705214863, 'auprc': 0.7565524579908862, 'loss_val': 1.0443430281335977, 'psi': 0.5520440534276436}-{'f1_val': 0.4148091473984988, 'auprc': 0.7635297758467967, 'loss_val': 1.1728136195366945, 'psi': 0.5542973987778179}
[S5] START round=5 head_norm_before_train=0.934314 cos_to_last_merge=0.9836 (last merge round=1)
[S5] round=5 local utility u=0.248962 metrics={'f1_val': 0.2380057137111733, 'auprc': 0.717503830674614, 'loss_val': 1.1241765544670257, 'psi': 0.4298049604965496}-{'f1_val': 0.14226190476190476, 'auprc': 0.7677841308955214, 'loss_val': 1.1984783714146237, 'psi': 0.39247079521535144}
[S6] START round=5 head_norm_before_train=1.278990 (no previous merge yet)
[S6] round=5 local utility u=0.878460 metrics={'f1_val': 0.41625250229074906, 'auprc': 0.8439967686778902, 'loss_val': 1.0846584558349688, 'psi': 0.5873502088456055}-{'f1_val': 0.14142628205128205, 'auprc': 0.8452124531254378, 'loss_val': 1.1962674136946763, 'psi': 0.42294075048094437}
[S7] START round=5 head_norm_before_train=0.919590 cos_to_last_merge=0.9820 (last merge round=1)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6647586889803994, 'loss_val': 1.2047133273288824, 'psi': 0.35113756922961475}-{'f1_val': 0.14205682272909165, 'auprc': 0.7773908160122855, 'loss_val': 1.243426149006344, 'psi': 0.3961904200423692}
[S8] START round=5 head_norm_before_train=1.239541 (no previous merge yet)
[S8] round=5 local utility u=1.000000 metrics={'f1_val': 0.5660003935260978, 'auprc': 0.7770299896887385, 'loss_val': 1.12639977100161, 'psi': 0.650412231991154}-{'f1_val': 0.13995598239295717, 'auprc': 0.7692386497148382, 'loss_val': 1.1876519105656829, 'psi': 0.39166904932170965}
[S9] START round=5 head_norm_before_train=0.897877 cos_to_last_merge=0.9736 (last merge round=1)
[S9] round=5 local utility u=0.030435 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659935937283533, 'loss_val': 1.1503559182618368, 'psi': 0.43123621177533894}-{'f1_val': 0.141397957139996, 'auprc': 0.8659934730134056, 'loss_val': 1.2112258357636956, 'psi': 0.43123616348935984}
[S10] START round=5 head_norm_before_train=0.592670 cos_to_last_merge=0.9736 (last merge round=2)
[S10] round=5 local utility u=0.217244 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7707970508359772, 'loss_val': 1.2337733346169688, 'psi': 0.39149180285942525}-{'f1_val': 0.13862163754172394, 'auprc': 0.6413765194147555, 'loss_val': 1.279999295439741, 'psi': 0.3397235902909366}
[S11] START round=5 head_norm_before_train=0.899698 cos_to_last_merge=0.9758 (last merge round=1)
[S11] round=5 local utility u=0.045188 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.594623082584412, 'loss_val': 1.1539940705736382, 'psi': 0.32209744305763116}-{'f1_val': 0.14041368337311058, 'auprc': 0.5901088693341632, 'loss_val': 1.2308283828075286, 'psi': 0.3202917577575316}
[S13] START round=5 head_norm_before_train=0.994415 cos_to_last_merge=0.9987 (last merge round=3)
[S13] round=5 local utility u=0.023613 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7244116715532959, 'loss_val': 1.238053425203171, 'psi': 0.37399612616755024}-{'f1_val': 0.1403857625770531, 'auprc': 0.7182745272193338, 'loss_val': 1.266867040851972, 'psi': 0.3715412684339654}
[S14] START round=5 head_norm_before_train=1.229954 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7324711993306283, 'loss_val': 1.1575578776783015, 'psi': 0.3772031914618736}-{'f1_val': 0.14035785288270378, 'auprc': 0.7751458505080091, 'loss_val': 1.234951475454656, 'psi': 0.3942730519328259}
[S15] START round=5 head_norm_before_train=1.319266 (no previous merge yet)
[S15] round=5 local utility u=0.862200 metrics={'f1_val': 0.41599167481162613, 'auprc': 0.7929002188706725, 'loss_val': 1.1378958981876226, 'psi': 0.5667550924352447}-{'f1_val': 0.13973365136155833, 'auprc': 0.7893527802683938, 'loss_val': 1.194105516366063, 'psi': 0.39958130292429256}
[S16] START round=5 head_norm_before_train=0.808161 cos_to_last_merge=0.9739 (last merge round=1)
[S16] round=5 local utility u=0.032895 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9996849967954748, 'loss_val': 1.1871516396941433, 'psi': 0.4842564688377119}-{'f1_val': 0.14063745019920318, 'auprc': 0.9996621343519758, 'loss_val': 1.252872849839423, 'psi': 0.4842473238603122}
[S17] START round=5 head_norm_before_train=1.282069 (no previous merge yet)
[S17] round=5 local utility u=0.927089 metrics={'f1_val': 0.39064656672707854, 'auprc': 0.6301598145548075, 'loss_val': 1.014242678367918, 'psi': 0.48645186585817013}-{'f1_val': 0.14094896331738438, 'auprc': 0.5564859436930957, 'loss_val': 1.1492131984903147, 'psi': 0.30716375546766894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:61808
[S11] not sending this round → trigger blocked (psi=0.322)
[S16] not sending this round → trigger blocked (psi=0.484)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:61815
[S15] not sending this round → trigger blocked (psi=0.567)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:61804
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=-0.0655
[S15] DROPPED delta from S8 (cos=-0.0655 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S5
[S13] cosine check vs S5: cos=0.8513
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=-0.0644
[S11] DROPPED delta from S4 (cos=-0.0644 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S9
[S11] cosine check vs S9: cos=-0.0347
[S11] DROPPED delta from S9 (cos=-0.0347 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S6
[S5] cosine check vs S6: cos=-0.0711
[S5] DROPPED delta from S6 (cos=-0.0711 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1791) from S13
[S7] cosine check vs S13: cos=-0.0301
[S7] DROPPED delta from S13 (cos=-0.0301 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1796) from S10
[S4] cosine check vs S10: cos=-0.0686
[S4] DROPPED delta from S10 (cos=-0.0686 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.486)
[S11] ⇄ pheromone p=0.374 → S5@127.0.0.1:61805
[S7] ⇄ pheromone p=0.357 → S8@127.0.0.1:61809
[S14] ⇄ pheromone p=0.397 → S7@127.0.0.1:61808
[S15] ⇄ pheromone p=0.513 → S9@127.0.0.1:61810
[S2] ⇄ pheromone p=0.365 → S4@127.0.0.1:61804
[S3] ⇄ pheromone p=0.337 → S13@127.0.0.1:61813
[S5] ⇄ pheromone p=0.389 → S13@127.0.0.1:61813
[S10] ⇄ pheromone p=0.392 → S4@127.0.0.1:61804
[S6] ⇄ pheromone p=0.543 → S5@127.0.0.1:61805
[S4] ⇄ pheromone p=0.516 → S11@127.0.0.1:61812
[S8] ⇄ pheromone p=0.537 → S15@127.0.0.1:61815
[S9] ⇄ pheromone p=0.367 → S11@127.0.0.1:61812
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.1404 head_norm=1.021895
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.722650e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.955861 delta_norm=0.272265
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.390 → S7@127.0.0.1:61808
[S17] ⇄ pheromone p=0.521 → S13@127.0.0.1:61813
[S16] ⇄ pheromone p=0.365 → S2@127.0.0.1:61802
[S2] START round=6 head_norm_before_train=0.750661 cos_to_last_merge=0.9969 (last merge round=4)
[S2] round=6 local utility u=0.271947 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7688490442821226, 'loss_val': 1.1408219676166047, 'psi': 0.39260589774598914}-{'f1_val': 0.1417771333885667, 'auprc': 0.607307287014957, 'loss_val': 1.2000913317281914, 'psi': 0.3279891948391228}
[S3] START round=6 head_norm_before_train=0.901576 cos_to_last_merge=0.9520 (last merge round=1)
[S3] round=6 local utility u=0.323612 metrics={'f1_val': 0.2306557706309156, 'auprc': 0.8398230068600652, 'loss_val': 1.0663603860451893, 'psi': 0.4743226651225755}-{'f1_val': 0.13984006561410703, 'auprc': 0.8465601502097899, 'loss_val': 1.1889022741254769, 'psi': 0.42252809945238023}
[S4] START round=6 head_norm_before_train=1.338466 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.41550149173126444, 'auprc': 0.6597744990738007, 'loss_val': 0.84356919402516, 'psi': 0.513210694668279}-{'f1_val': 0.41570511705214863, 'auprc': 0.7565524579908862, 'loss_val': 1.0443430281335977, 'psi': 0.5520440534276436}
[S5] START round=6 head_norm_before_train=0.965054 cos_to_last_merge=0.9744 (last merge round=1)
[S5] round=6 local utility u=0.673022 metrics={'f1_val': 0.41803043574602833, 'auprc': 0.7778216127413566, 'loss_val': 1.0392350728399116, 'psi': 0.5619469065441597}-{'f1_val': 0.2380057137111733, 'auprc': 0.717503830674614, 'loss_val': 1.1241765544670257, 'psi': 0.4298049604965496}
[S6] START round=6 head_norm_before_train=1.314918 (no previous merge yet)
[S6] round=6 local utility u=0.071840 metrics={'f1_val': 0.41745618053540323, 'auprc': 0.8326276728833382, 'loss_val': 0.9140933380249135, 'psi': 0.5835247774745772}-{'f1_val': 0.41625250229074906, 'auprc': 0.8439967686778902, 'loss_val': 1.0846584558349688, 'psi': 0.5873502088456055}
[S7] START round=6 head_norm_before_train=0.943676 cos_to_last_merge=0.9748 (last merge round=1)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.587261747331285, 'loss_val': 1.1321494846804132, 'psi': 0.320138792569969}-{'f1_val': 0.14205682272909165, 'auprc': 0.6647586889803994, 'loss_val': 1.2047133273288824, 'psi': 0.35113756922961475}
[S8] START round=6 head_norm_before_train=1.270515 (no previous merge yet)
[S8] round=6 local utility u=0.504715 metrics={'f1_val': 0.7155418933751417, 'auprc': 0.7771090966788997, 'loss_val': 1.0144556893872794, 'psi': 0.740168774696645}-{'f1_val': 0.5660003935260978, 'auprc': 0.7770299896887385, 'loss_val': 1.12639977100161, 'psi': 0.650412231991154}
[S9] START round=6 head_norm_before_train=0.935560 cos_to_last_merge=0.9601 (last merge round=1)
[S9] round=6 local utility u=0.073889 metrics={'f1_val': 0.141397957139996, 'auprc': 0.866107900668759, 'loss_val': 1.0029209617273742, 'psi': 0.4312819345515012}-{'f1_val': 0.141397957139996, 'auprc': 0.8659935937283533, 'loss_val': 1.1503559182618368, 'psi': 0.43123621177533894}
[S10] START round=6 head_norm_before_train=0.634118 cos_to_last_merge=0.9458 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.946
[S10] round=6 local utility u=0.031411 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7711291152624618, 'loss_val': 1.1719471815037175, 'psi': 0.39162462863001907}-{'f1_val': 0.13862163754172394, 'auprc': 0.7707970508359772, 'loss_val': 1.2337733346169688, 'psi': 0.39149180285942525}
[S11] START round=6 head_norm_before_train=0.929063 cos_to_last_merge=0.9632 (last merge round=1)
[S11] round=6 local utility u=0.896057 metrics={'f1_val': 0.41636731828208257, 'auprc': 0.599193514870882, 'loss_val': 1.0313131701827891, 'psi': 0.4894977969176023}-{'f1_val': 0.14041368337311058, 'auprc': 0.594623082584412, 'loss_val': 1.1539940705736382, 'psi': 0.32209744305763116}
[S13] START round=6 head_norm_before_train=0.955861 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.018537 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7266355271718639, 'loss_val': 1.207651518445695, 'psi': 0.3748856684149774}-{'f1_val': 0.1403857625770531, 'auprc': 0.7244116715532959, 'loss_val': 1.238053425203171, 'psi': 0.37399612616755024}
[S14] START round=6 head_norm_before_train=1.268930 (no previous merge yet)
[S14] round=6 local utility u=0.383340 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9474627994712305, 'loss_val': 1.0358528247770864, 'psi': 0.46319983151811445}-{'f1_val': 0.14035785288270378, 'auprc': 0.7324711993306283, 'loss_val': 1.1575578776783015, 'psi': 0.3772031914618736}
[S15] START round=6 head_norm_before_train=1.343151 (no previous merge yet)
[S15] round=6 local utility u=0.059043 metrics={'f1_val': 0.41599167481162613, 'auprc': 0.787748433773404, 'loss_val': 1.0043553630637192, 'psi': 0.5646943783963373}-{'f1_val': 0.41599167481162613, 'auprc': 0.7929002188706725, 'loss_val': 1.1378958981876226, 'psi': 0.5667550924352447}
[S16] START round=6 head_norm_before_train=0.846959 cos_to_last_merge=0.9569 (last merge round=1)
[S16] round=6 local utility u=0.827126 metrics={'f1_val': 0.41625059973887696, 'auprc': 0.9572498497647469, 'loss_val': 1.0592725741133757, 'psi': 0.6326502997492249}-{'f1_val': 0.14063745019920318, 'auprc': 0.9996849967954748, 'loss_val': 1.1871516396941433, 'psi': 0.4842564688377119}
[S17] START round=6 head_norm_before_train=1.319613 (no previous merge yet)
[S17] round=6 local utility u=0.324425 metrics={'f1_val': 0.4812904534579271, 'auprc': 0.6134944512589511, 'loss_val': 0.8592592691852403, 'psi': 0.5341720525783367}-{'f1_val': 0.39064656672707854, 'auprc': 0.6301598145548075, 'loss_val': 1.014242678367918, 'psi': 0.48645186585817013}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:61810
[S13] not sending this round → trigger blocked (psi=0.375)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:61804
[S6] not sending this round → trigger blocked (psi=0.584)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61808
[S8] not sending this round → trigger blocked (psi=0.740)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:61805
[S9] not sending this round → trigger blocked (psi=0.431)
[S5] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[S10] not sending this round → trigger blocked (psi=0.392)
[S11] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1790) from S11
[S5] cosine check vs S11: cos=-0.0311
[S5] DROPPED delta from S11 (cos=-0.0311 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S16
[S2] cosine check vs S16: cos=0.7353
[S13] RECEIVED delta(kind=head bytes=1797) from S3
[S13] cosine check vs S3: cos=-0.0073
[S13] DROPPED delta from S3 (cos=-0.0073 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=-0.0657
[S7] DROPPED delta from S14 (cos=-0.0657 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] cosine check vs S2: cos=-0.0897
[S4] DROPPED delta from S2 (cos=-0.0897 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S15
[S9] cosine check vs S15: cos=-0.0008
[S9] DROPPED delta from S15 (cos=-0.0008 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=-0.0470
[S13] DROPPED delta from S17 (cos=-0.0470 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.1418 head_norm=0.773753
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.061236e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.1418 head_norm=0.772793 delta_norm=0.306124
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.772793 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.854215 metrics={'f1_val': 0.4160938496492347, 'auprc': 0.7748925234902568, 'loss_val': 1.0964235136701619, 'psi': 0.5596133191856436}-{'f1_val': 0.1417771333885667, 'auprc': 0.7688490442821226, 'loss_val': 1.1408219676166047, 'psi': 0.39260589774598914}
[S3] START round=7 head_norm_before_train=0.937592 cos_to_last_merge=0.9362 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=7 local utility u=0.582992 metrics={'f1_val': 0.39638969140647473, 'auprc': 0.8451381967873581, 'loss_val': 0.9107264752404891, 'psi': 0.5758890935588281}-{'f1_val': 0.2306557706309156, 'auprc': 0.8398230068600652, 'loss_val': 1.0663603860451893, 'psi': 0.4743226651225755}
[S4] START round=7 head_norm_before_train=1.393692 (no previous merge yet)
[S4] round=7 local utility u=0.932599 metrics={'f1_val': 0.6670990376855706, 'auprc': 0.7175403174760535, 'loss_val': 0.6612545804217341, 'psi': 0.6872755496017637}-{'f1_val': 0.41550149173126444, 'auprc': 0.6597744990738007, 'loss_val': 0.84356919402516, 'psi': 0.513210694668279}
[S5] START round=7 head_norm_before_train=0.986746 cos_to_last_merge=0.9668 (last merge round=1)
[S5] round=7 local utility u=0.066442 metrics={'f1_val': 0.4175873768787894, 'auprc': 0.7778196308598023, 'loss_val': 0.9036863874841855, 'psi': 0.5616802784711945}-{'f1_val': 0.41803043574602833, 'auprc': 0.7778216127413566, 'loss_val': 1.0392350728399116, 'psi': 0.5619469065441597}
[S6] START round=7 head_norm_before_train=1.353569 (no previous merge yet)
[S6] round=7 local utility u=0.037401 metrics={'f1_val': 0.4164535851642239, 'auprc': 0.8300556689212906, 'loss_val': 0.8255588093070941, 'psi': 0.5818944186670506}-{'f1_val': 0.41745618053540323, 'auprc': 0.8326276728833382, 'loss_val': 0.9140933380249135, 'psi': 0.5835247774745772}
[S7] START round=7 head_norm_before_train=0.974950 cos_to_last_merge=0.9654 (last merge round=1)
[S7] round=7 local utility u=0.856025 metrics={'f1_val': 0.4170778520170104, 'auprc': 0.575315376728891, 'loss_val': 1.0343864278799806, 'psi': 0.48037286190176265}-{'f1_val': 0.14205682272909165, 'auprc': 0.587261747331285, 'loss_val': 1.1321494846804132, 'psi': 0.320138792569969}
[S8] START round=7 head_norm_before_train=1.303478 (no previous merge yet)
[S8] round=7 local utility u=0.106067 metrics={'f1_val': 0.7156066922694875, 'auprc': 0.7771065099426413, 'loss_val': 0.8027031314165466, 'psi': 0.7402066193387491}-{'f1_val': 0.7155418933751417, 'auprc': 0.7771090966788997, 'loss_val': 1.0144556893872794, 'psi': 0.740168774696645}
[S9] START round=7 head_norm_before_train=0.978494 cos_to_last_merge=0.9460 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.946
[S9] round=7 local utility u=1.000000 metrics={'f1_val': 0.6044187615357601, 'auprc': 0.8662394280145734, 'loss_val': 0.7991683736805604, 'psi': 0.7091470281272855}-{'f1_val': 0.141397957139996, 'auprc': 0.866107900668759, 'loss_val': 1.0029209617273742, 'psi': 0.4312819345515012}
[S10] START round=7 head_norm_before_train=0.672266 cos_to_last_merge=0.9234 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.923
[S10] round=7 local utility u=0.532677 metrics={'f1_val': 0.37769537665723146, 'auprc': 0.6302545581527855, 'loss_val': 1.1184121441086123, 'psi': 0.4787190492554531}-{'f1_val': 0.13862163754172394, 'auprc': 0.7711291152624618, 'loss_val': 1.1719471815037175, 'psi': 0.39162462863001907}
[S11] START round=7 head_norm_before_train=0.967057 cos_to_last_merge=0.9480 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.948
[S11] round=7 local utility u=0.358839 metrics={'f1_val': 0.39658602128368947, 'auprc': 0.8290343805565127, 'loss_val': 0.8844697011747346, 'psi': 0.5695653649928187}-{'f1_val': 0.41636731828208257, 'auprc': 0.599193514870882, 'loss_val': 1.0313131701827891, 'psi': 0.4894977969176023}
[S13] START round=7 head_norm_before_train=0.976884 cos_to_last_merge=0.9988 (last merge round=5)
[S13] round=7 local utility u=0.877338 metrics={'f1_val': 0.415486691627877, 'auprc': 0.7390507480333677, 'loss_val': 1.1408264889810225, 'psi': 0.5449123141900732}-{'f1_val': 0.1403857625770531, 'auprc': 0.7266355271718639, 'loss_val': 1.207651518445695, 'psi': 0.3748856684149774}
[S14] START round=7 head_norm_before_train=1.308289 (no previous merge yet)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.9974936690910665, 'auprc': 0.9974579826221402, 'loss_val': 0.8937663958747885, 'psi': 0.997479394503496}-{'f1_val': 0.14035785288270378, 'auprc': 0.9474627994712305, 'loss_val': 1.0358528247770864, 'psi': 0.46319983151811445}
[S15] START round=7 head_norm_before_train=1.377480 (no previous merge yet)
[S15] round=7 local utility u=0.588025 metrics={'f1_val': 0.5826660403993796, 'auprc': 0.7950925029194025, 'loss_val': 0.8503843681463313, 'psi': 0.6676366254073888}-{'f1_val': 0.41599167481162613, 'auprc': 0.787748433773404, 'loss_val': 1.0043553630637192, 'psi': 0.5646943783963373}
[S16] START round=7 head_norm_before_train=0.884957 cos_to_last_merge=0.9388 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.939
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.4170779150236796, 'auprc': 0.7464398906630683, 'loss_val': 0.9089750674588827, 'psi': 0.548822705279435}-{'f1_val': 0.41625059973887696, 'auprc': 0.9572498497647469, 'loss_val': 1.0592725741133757, 'psi': 0.6326502997492249}
[S17] START round=7 head_norm_before_train=1.364500 (no previous merge yet)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.362066398746721, 'auprc': 0.7654126646918529, 'loss_val': 0.9229823388964692, 'psi': 0.5234049051247738}-{'f1_val': 0.4812904534579271, 'auprc': 0.6134944512589511, 'loss_val': 0.8592592691852403, 'psi': 0.5341720525783367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:61815
[S11] not sending this round → trigger blocked (psi=0.570)
[S15] not sending this round → trigger blocked (psi=0.668)
[S14] not sending this round → trigger blocked (psi=0.997)
[S2] not sending this round → trigger blocked (psi=0.560)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:61805
[S3] not sending this round → trigger blocked (psi=0.576)
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=-0.0706
[S11] DROPPED delta from S4 (cos=-0.0706 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S6
[S5] cosine check vs S6: cos=-0.0608
[S5] DROPPED delta from S6 (cos=-0.0608 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=-0.0862
[S4] DROPPED delta from S10 (cos=-0.0862 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1793) from S7
[S8] cosine check vs S7: cos=-0.0261
[S8] DROPPED delta from S7 (cos=-0.0261 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=-0.0584
[S15] DROPPED delta from S8 (cos=-0.0584 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S5
[S13] cosine check vs S5: cos=0.9338
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] cosine check vs S9: cos=-0.0320
[S11] DROPPED delta from S9 (cos=-0.0320 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1793) from S13
[S7] cosine check vs S13: cos=-0.0167
[S7] DROPPED delta from S13 (cos=-0.0167 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4155 head_norm=0.997734
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.834156e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4155 head_norm=0.990191 delta_norm=0.183416
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.799061 cos_to_last_merge=0.9972 (last merge round=6)
[S2] round=8 local utility u=0.021440 metrics={'f1_val': 0.4169384018324798, 'auprc': 0.7649377561432176, 'loss_val': 1.0287459914224955, 'psi': 0.5561381435567749}-{'f1_val': 0.4160938496492347, 'auprc': 0.7748925234902568, 'loss_val': 1.0964235136701619, 'psi': 0.5596133191856436}
[S3] START round=8 head_norm_before_train=0.979892 cos_to_last_merge=0.9175 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.918
[S3] round=8 local utility u=0.268379 metrics={'f1_val': 0.39369281728104477, 'auprc': 0.9965481140731897, 'loss_val': 0.8120169249170881, 'psi': 0.6348349359979027}-{'f1_val': 0.39638969140647473, 'auprc': 0.8451381967873581, 'loss_val': 0.9107264752404891, 'psi': 0.5758890935588281}
[S4] START round=8 head_norm_before_train=1.453573 (no previous merge yet)
[S4] round=8 local utility u=0.233464 metrics={'f1_val': 0.662718949044586, 'auprc': 0.8350513050699633, 'loss_val': 0.5205793319546942, 'psi': 0.7316518914547369}-{'f1_val': 0.6670990376855706, 'auprc': 0.7175403174760535, 'loss_val': 0.6612545804217341, 'psi': 0.6872755496017637}
[S5] START round=8 head_norm_before_train=1.016251 cos_to_last_merge=0.9554 (last merge round=1)
[S5] round=8 local utility u=0.855760 metrics={'f1_val': 0.7082060265219696, 'auprc': 0.7371924989112353, 'loss_val': 0.8139963126035742, 'psi': 0.7198006154776759}-{'f1_val': 0.4175873768787894, 'auprc': 0.7778196308598023, 'loss_val': 0.9036863874841855, 'psi': 0.5616802784711945}
[S6] START round=8 head_norm_before_train=1.389469 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.4166544795555117, 'auprc': 0.7894660909480966, 'loss_val': 0.765468213713695, 'psi': 0.5657791241125456}-{'f1_val': 0.4164535851642239, 'auprc': 0.8300556689212906, 'loss_val': 0.8255588093070941, 'psi': 0.5818944186670506}
[S7] START round=8 head_norm_before_train=1.006589 cos_to_last_merge=0.9561 (last merge round=1)
[S7] round=8 local utility u=0.041981 metrics={'f1_val': 0.41711588266717814, 'auprc': 0.57496033783444, 'loss_val': 0.9495874503273263, 'psi': 0.4802536647340829}-{'f1_val': 0.4170778520170104, 'auprc': 0.575315376728891, 'loss_val': 1.0343864278799806, 'psi': 0.48037286190176265}
[S8] START round=8 head_norm_before_train=1.345118 (no previous merge yet)
[S8] round=8 local utility u=0.064605 metrics={'f1_val': 0.7022401689734421, 'auprc': 0.7826716819133962, 'loss_val': 0.6099896763091432, 'psi': 0.7344127741494237}-{'f1_val': 0.7156066922694875, 'auprc': 0.7771065099426413, 'loss_val': 0.8027031314165466, 'psi': 0.7402066193387491}
[S9] START round=8 head_norm_before_train=1.031643 cos_to_last_merge=0.9302 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.930
[S9] round=8 local utility u=0.606605 metrics={'f1_val': 0.7016893154854569, 'auprc': 0.9997544447149314, 'loss_val': 0.5701258648097653, 'psi': 0.8209153671772467}-{'f1_val': 0.6044187615357601, 'auprc': 0.8662394280145734, 'loss_val': 0.7991683736805604, 'psi': 0.7091470281272855}
[S10] START round=8 head_norm_before_train=0.699250 cos_to_last_merge=0.9087 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.909
[S10] round=8 local utility u=0.220854 metrics={'f1_val': 0.41239788579266046, 'auprc': 0.6543239434914165, 'loss_val': 0.957126766804494, 'psi': 0.5091683088721628}-{'f1_val': 0.37769537665723146, 'auprc': 0.6302545581527855, 'loss_val': 1.1184121441086123, 'psi': 0.4787190492554531}
[S11] START round=8 head_norm_before_train=1.012746 cos_to_last_merge=0.9300 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.930
[S11] round=8 local utility u=0.299393 metrics={'f1_val': 0.3934871178936461, 'auprc': 0.9977242133405373, 'loss_val': 0.7731588042940672, 'psi': 0.6351819560724026}-{'f1_val': 0.39658602128368947, 'auprc': 0.8290343805565127, 'loss_val': 0.8844697011747346, 'psi': 0.5695653649928187}
[S13] START round=8 head_norm_before_train=0.990191 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.052660 metrics={'f1_val': 0.4164711099175653, 'auprc': 0.7384352036092777, 'loss_val': 1.0395668330109604, 'psi': 0.5452567473942502}-{'f1_val': 0.415486691627877, 'auprc': 0.7390507480333677, 'loss_val': 1.1408264889810225, 'psi': 0.5449123141900732}
[S14] START round=8 head_norm_before_train=1.352822 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.6203499721647384, 'auprc': 0.9929927945702892, 'loss_val': 0.7274236587726342, 'psi': 0.7694071011269588}-{'f1_val': 0.9974936690910665, 'auprc': 0.9974579826221402, 'loss_val': 0.8937663958747885, 'psi': 0.997479394503496}
[S15] START round=8 head_norm_before_train=1.411853 (no previous merge yet)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.41785984133495074, 'auprc': 0.7950114678150667, 'loss_val': 0.6916401534566735, 'psi': 0.5687204919269971}-{'f1_val': 0.5826660403993796, 'auprc': 0.7950925029194025, 'loss_val': 0.8503843681463313, 'psi': 0.6676366254073888}
[S16] START round=8 head_norm_before_train=0.935183 cos_to_last_merge=0.9162 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.916
[S16] round=8 local utility u=0.010457 metrics={'f1_val': 0.4168497394733136, 'auprc': 0.74178070518558, 'loss_val': 0.8727145292717348, 'psi': 0.5468221257582202}-{'f1_val': 0.4170779150236796, 'auprc': 0.7464398906630683, 'loss_val': 0.9089750674588827, 'psi': 0.548822705279435}
[S17] START round=8 head_norm_before_train=1.404680 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.15959690715788277, 'auprc': 0.8059947667215211, 'loss_val': 1.429939757605668, 'psi': 0.41815605098333813}-{'f1_val': 0.362066398746721, 'auprc': 0.7654126646918529, 'loss_val': 0.9229823388964692, 'psi': 0.5234049051247738}
[S7] not sending this round → trigger blocked (psi=0.480)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61813
[S8] not sending this round → trigger blocked (psi=0.734)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:61802
[S10] not sending this round → trigger blocked (psi=0.509)
[S4] not sending this round → trigger blocked (psi=0.732)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:61805
[S5] not sending this round → trigger blocked (psi=0.720)
[S9] not sending this round → trigger blocked (psi=0.821)
[S13] not sending this round → trigger blocked (psi=0.545)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:61804
[S2] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S2
[S4] cosine check vs S2: cos=-0.0922
[S4] DROPPED delta from S2 (cos=-0.0922 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S11
[S5] cosine check vs S11: cos=-0.0221
[S5] DROPPED delta from S11 (cos=-0.0221 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S16
[S2] cosine check vs S16: cos=0.8915
[S13] RECEIVED delta(kind=head bytes=1798) from S3
[S13] cosine check vs S3: cos=-0.0029
[S13] DROPPED delta from S3 (cos=-0.0029 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.4169 head_norm=0.832904
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.228744e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.4169 head_norm=0.881692 delta_norm=0.222874
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.881692 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.050699 metrics={'f1_val': 0.41635303811560054, 'auprc': 0.7706556930879167, 'loss_val': 0.9409897312352035, 'psi': 0.5580741001045271}-{'f1_val': 0.4169384018324798, 'auprc': 0.7649377561432176, 'loss_val': 1.0287459914224955, 'psi': 0.5561381435567749}
[S3] START round=9 head_norm_before_train=1.030293 cos_to_last_merge=0.8966 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.897
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.401708470248874, 'auprc': 0.7493601636276658, 'loss_val': 0.8468303666519597, 'psi': 0.5407691476003906}-{'f1_val': 0.39369281728104477, 'auprc': 0.9965481140731897, 'loss_val': 0.8120169249170881, 'psi': 0.6348349359979027}
[S4] START round=9 head_norm_before_train=1.510494 (no previous merge yet)
[S4] round=9 local utility u=0.025468 metrics={'f1_val': 0.6586165714205532, 'auprc': 0.8361499025283622, 'loss_val': 0.44832523632858656, 'psi': 0.7296299038636769}-{'f1_val': 0.662718949044586, 'auprc': 0.8350513050699633, 'loss_val': 0.5205793319546942, 'psi': 0.7316518914547369}
[S5] START round=9 head_norm_before_train=1.047224 cos_to_last_merge=0.9418 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.942
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.6464977594982918, 'auprc': 0.7790269245092919, 'loss_val': 0.7369674227373608, 'psi': 0.6995094255026919}-{'f1_val': 0.7082060265219696, 'auprc': 0.7371924989112353, 'loss_val': 0.8139963126035742, 'psi': 0.7198006154776759}
[S6] START round=9 head_norm_before_train=1.424721 (no previous merge yet)
[S6] round=9 local utility u=0.021129 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.7902584051007002, 'loss_val': 0.7279937568655879, 'psi': 0.5663367847648004}-{'f1_val': 0.4166544795555117, 'auprc': 0.7894660909480966, 'loss_val': 0.765468213713695, 'psi': 0.5657791241125456}
[S7] START round=9 head_norm_before_train=1.041737 cos_to_last_merge=0.9443 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.944
[S7] round=9 local utility u=0.365304 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.789359280654346, 'loss_val': 0.8604748161178145, 'psi': 0.5658431919208025}-{'f1_val': 0.41711588266717814, 'auprc': 0.57496033783444, 'loss_val': 0.9495874503273263, 'psi': 0.4802536647340829}
[S8] START round=9 head_norm_before_train=1.389901 (no previous merge yet)
[S8] round=9 local utility u=0.113047 metrics={'f1_val': 0.7147473519913303, 'auprc': 0.7946432175893561, 'loss_val': 0.49485368691942, 'psi': 0.7467056982305407}-{'f1_val': 0.7022401689734421, 'auprc': 0.7826716819133962, 'loss_val': 0.6099896763091432, 'psi': 0.7344127741494237}
[S9] START round=9 head_norm_before_train=1.095778 cos_to_last_merge=0.9120 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.912
[S9] round=9 local utility u=0.088669 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9988521804003934, 'loss_val': 0.3896341981207886, 'psi': 0.8205097815910944}-{'f1_val': 0.7016893154854569, 'auprc': 0.9997544447149314, 'loss_val': 0.5701258648097653, 'psi': 0.8209153671772467}
[S10] START round=9 head_norm_before_train=0.738691 cos_to_last_merge=0.8839 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.884
[S10] round=9 local utility u=0.262422 metrics={'f1_val': 0.3777272621068422, 'auprc': 0.8644787668447651, 'loss_val': 0.8547231566133143, 'psi': 0.5724278640020113}-{'f1_val': 0.41239788579266046, 'auprc': 0.6543239434914165, 'loss_val': 0.957126766804494, 'psi': 0.5091683088721628}
[S11] START round=9 head_norm_before_train=1.064012 cos_to_last_merge=0.9092 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.909
[S11] round=9 local utility u=0.661311 metrics={'f1_val': 0.5987197064223851, 'auprc': 0.9979585285473739, 'loss_val': 0.6826361076414686, 'psi': 0.7584152352723806}-{'f1_val': 0.3934871178936461, 'auprc': 0.9977242133405373, 'loss_val': 0.7731588042940672, 'psi': 0.6351819560724026}
[S13] START round=9 head_norm_before_train=1.017557 cos_to_last_merge=0.9979 (last merge round=7)
[S13] round=9 local utility u=0.328476 metrics={'f1_val': 0.5004187774902322, 'auprc': 0.7433766499719208, 'loss_val': 0.9011250578171831, 'psi': 0.5976019264829076}-{'f1_val': 0.4164711099175653, 'auprc': 0.7384352036092777, 'loss_val': 1.0395668330109604, 'psi': 0.5452567473942502}
[S14] START round=9 head_norm_before_train=1.408536 (no previous merge yet)
[S14] round=9 local utility u=0.087532 metrics={'f1_val': 0.6205042005312631, 'auprc': 0.990607159638748, 'loss_val': 0.5461285903483297, 'psi': 0.7685453841742571}-{'f1_val': 0.6203499721647384, 'auprc': 0.9929927945702892, 'loss_val': 0.7274236587726342, 'psi': 0.7694071011269588}
[S15] START round=9 head_norm_before_train=1.450663 (no previous merge yet)
[S15] round=9 local utility u=1.000000 metrics={'f1_val': 0.7011404614748801, 'auprc': 0.9974717762603972, 'loss_val': 0.6068295171780689, 'psi': 0.8196729873890869}-{'f1_val': 0.41785984133495074, 'auprc': 0.7950114678150667, 'loss_val': 0.6916401534566735, 'psi': 0.5687204919269971}
[S16] START round=9 head_norm_before_train=0.979989 cos_to_last_merge=0.8929 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.893
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.34374883989520716, 'auprc': 0.7379482968274458, 'loss_val': 0.9016426152697705, 'psi': 0.5014286226681026}-{'f1_val': 0.4168497394733136, 'auprc': 0.74178070518558, 'loss_val': 0.8727145292717348, 'psi': 0.5468221257582202}
[S17] START round=9 head_norm_before_train=1.434577 (no previous merge yet)
[S17] round=9 local utility u=0.821821 metrics={'f1_val': 0.349756242568371, 'auprc': 0.8073172800883529, 'loss_val': 0.9312212709058338, 'psi': 0.5327806575763638}-{'f1_val': 0.15959690715788277, 'auprc': 0.8059947667215211, 'loss_val': 1.429939757605668, 'psi': 0.41815605098333813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:61809
[S2] not sending this round → trigger blocked (psi=0.558)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:61812
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:61805
[S11] not sending this round → trigger blocked (psi=0.758)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61808
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S15
[S9] cosine check vs S15: cos=-0.0051
[S9] DROPPED delta from S15 (cos=-0.0051 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S6
[S5] cosine check vs S6: cos=-0.0512
[S5] DROPPED delta from S6 (cos=-0.0512 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=-0.0960
[S4] DROPPED delta from S10 (cos=-0.0960 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S7
[S8] cosine check vs S7: cos=-0.0239
[S8] DROPPED delta from S7 (cos=-0.0239 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=-0.0495
[S15] DROPPED delta from S8 (cos=-0.0495 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1803) from S4
[S11] cosine check vs S4: cos=-0.0695
[S11] DROPPED delta from S4 (cos=-0.0695 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S9
[S11] cosine check vs S9: cos=-0.0211
[S11] DROPPED delta from S9 (cos=-0.0211 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] cosine check vs S13: cos=-0.0167
[S7] DROPPED delta from S13 (cos=-0.0167 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=-0.0753
[S7] DROPPED delta from S14 (cos=-0.0753 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S17
[S13] cosine check vs S17: cos=-0.0399
[S13] DROPPED delta from S17 (cos=-0.0399 < 0.0)
[S2] START round=10 head_norm_before_train=0.914673 cos_to_last_merge=0.9969 (last merge round=8)
[S2] round=10 local utility u=0.537488 metrics={'f1_val': 0.5793536851087723, 'auprc': 0.7775659915606947, 'loss_val': 0.8647488329471696, 'psi': 0.6586386076895412}-{'f1_val': 0.41635303811560054, 'auprc': 0.7706556930879167, 'loss_val': 0.9409897312352035, 'psi': 0.5580741001045271}
[S3] START round=10 head_norm_before_train=1.079173 cos_to_last_merge=0.8772 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.877
[S3] round=10 local utility u=0.940888 metrics={'f1_val': 0.5601733712236956, 'auprc': 0.9975509733289561, 'loss_val': 0.6604158067814496, 'psi': 0.7351244120657998}-{'f1_val': 0.401708470248874, 'auprc': 0.7493601636276658, 'loss_val': 0.8468303666519597, 'psi': 0.5407691476003906}
[S4] START round=10 head_norm_before_train=1.567371 (no previous merge yet)
[S4] round=10 local utility u=0.009388 metrics={'f1_val': 0.6609137963988241, 'auprc': 0.8421699003902289, 'loss_val': 0.4613917828963895, 'psi': 0.7334162379953859}-{'f1_val': 0.6586165714205532, 'auprc': 0.8361499025283622, 'loss_val': 0.44832523632858656, 'psi': 0.7296299038636769}
[S5] START round=10 head_norm_before_train=1.073366 cos_to_last_merge=0.9291 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.929
[S5] round=10 local utility u=0.197462 metrics={'f1_val': 0.7009900236517009, 'auprc': 0.7681662349082142, 'loss_val': 0.6364144783942339, 'psi': 0.7278605081543063}-{'f1_val': 0.6464977594982918, 'auprc': 0.7790269245092919, 'loss_val': 0.7369674227373608, 'psi': 0.6995094255026919}
[S6] START round=10 head_norm_before_train=1.455712 (no previous merge yet)
[S6] round=10 local utility u=0.005903 metrics={'f1_val': 0.41657277187194597, 'auprc': 0.7854851745769589, 'loss_val': 0.6989697356709975, 'psi': 0.5641377329539512}-{'f1_val': 0.41705570454086727, 'auprc': 0.7902584051007002, 'loss_val': 0.7279937568655879, 'psi': 0.5663367847648004}
[S7] START round=10 head_norm_before_train=1.079038 cos_to_last_merge=0.9303 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.930
[S7] round=10 local utility u=0.004866 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7752809536828688, 'loss_val': 0.8089924802491288, 'psi': 0.5602602397346221}-{'f1_val': 0.41683246609844005, 'auprc': 0.789359280654346, 'loss_val': 0.8604748161178145, 'psi': 0.5658431919208025}
[S8] START round=10 head_norm_before_train=1.441578 (no previous merge yet)
[S8] round=10 local utility u=0.376267 metrics={'f1_val': 0.7019438452544433, 'auprc': 0.9983701554226561, 'loss_val': 0.27667866240123795, 'psi': 0.8205143693217284}-{'f1_val': 0.7147473519913303, 'auprc': 0.7946432175893561, 'loss_val': 0.49485368691942, 'psi': 0.7467056982305407}
[S9] START round=10 head_norm_before_train=1.164545 cos_to_last_merge=0.8928 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.893
[S9] round=10 local utility u=0.039829 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9989108249465508, 'loss_val': 0.3086518932124311, 'psi': 0.8203831306101259}-{'f1_val': 0.7016148490515617, 'auprc': 0.9988521804003934, 'loss_val': 0.3896341981207886, 'psi': 0.8205097815910944}
[S10] START round=10 head_norm_before_train=0.784705 cos_to_last_merge=0.8557 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.856
[S10] round=10 local utility u=0.054390 metrics={'f1_val': 0.38872135333834135, 'auprc': 0.860439344931285, 'loss_val': 0.7997900783216499, 'psi': 0.5774085499755188}-{'f1_val': 0.3777272621068422, 'auprc': 0.8644787668447651, 'loss_val': 0.8547231566133143, 'psi': 0.5724278640020113}
[S11] START round=10 head_norm_before_train=1.117608 cos_to_last_merge=0.8877 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.888
[S11] round=10 local utility u=0.370835 metrics={'f1_val': 0.7018246587012323, 'auprc': 0.9977605366009965, 'loss_val': 0.5590020714862197, 'psi': 0.820199009861138}-{'f1_val': 0.5987197064223851, 'auprc': 0.9979585285473739, 'loss_val': 0.6826361076414686, 'psi': 0.7584152352723806}
[S13] START round=10 head_norm_before_train=1.057018 cos_to_last_merge=0.9913 (last merge round=7)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.3864179011578751, 'auprc': 0.756658959081237, 'loss_val': 0.8201658965992077, 'psi': 0.5345143243272199}-{'f1_val': 0.5004187774902322, 'auprc': 0.7433766499719208, 'loss_val': 0.9011250578171831, 'psi': 0.5976019264829076}
[S14] START round=10 head_norm_before_train=1.465953 (no previous merge yet)
[S14] round=10 local utility u=1.000000 metrics={'f1_val': 0.9968485079658588, 'auprc': 0.9929024436449456, 'loss_val': 0.3602338895341453, 'psi': 0.9952700822374936}-{'f1_val': 0.6205042005312631, 'auprc': 0.990607159638748, 'loss_val': 0.5461285903483297, 'psi': 0.7685453841742571}
[S15] START round=10 head_norm_before_train=1.486980 (no previous merge yet)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.7050818700257637, 'auprc': 0.7952536449999407, 'loss_val': 0.5432427622012419, 'psi': 0.7411505800154345}-{'f1_val': 0.7011404614748801, 'auprc': 0.9974717762603972, 'loss_val': 0.6068295171780689, 'psi': 0.8196729873890869}
[S16] START round=10 head_norm_before_train=1.011283 cos_to_last_merge=0.8721 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.872
[S16] round=10 local utility u=0.321238 metrics={'f1_val': 0.43573585497612677, 'auprc': 0.73985535154991, 'loss_val': 0.8168106770561446, 'psi': 0.55738365360564}-{'f1_val': 0.34374883989520716, 'auprc': 0.7379482968274458, 'loss_val': 0.9016426152697705, 'psi': 0.5014286226681026}
[S17] START round=10 head_norm_before_train=1.461390 (no previous merge yet)
[S17] round=10 local utility u=0.084398 metrics={'f1_val': 0.35535064662882343, 'auprc': 0.8221117996271351, 'loss_val': 0.8403750944461831, 'psi': 0.5420551078281481}-{'f1_val': 0.349756242568371, 'auprc': 0.8073172800883529, 'loss_val': 0.9312212709058338, 'psi': 0.5327806575763638}
[S7] not sending this round → trigger blocked (psi=0.560)
[S9] not sending this round → trigger blocked (psi=0.820)
[S4] not sending this round → trigger blocked (psi=0.733)
[S14] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:61813
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.577)
[S6] not sending this round → trigger blocked (psi=0.564)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:61802
[S8] not sending this round → trigger blocked (psi=0.821)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:61805
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S11
[S5] cosine check vs S11: cos=-0.0205
[S5] DROPPED delta from S11 (cos=-0.0205 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S16
[S2] cosine check vs S16: cos=0.9350
[S4] RECEIVED delta(kind=head bytes=1796) from S2
[S4] cosine check vs S2: cos=-0.0831
[S4] DROPPED delta from S2 (cos=-0.0831 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S5
[S13] cosine check vs S5: cos=0.9328
[S13] RECEIVED delta(kind=head bytes=1795) from S3
[S13] cosine check vs S3: cos=-0.0140
[S13] DROPPED delta from S3 (cos=-0.0140 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.542)
[S8] ⇄ pheromone p=0.330 → S15@127.0.0.1:61815
[S7] ⇄ pheromone p=0.269 → S8@127.0.0.1:61809
[S10] ⇄ pheromone p=0.267 → S4@127.0.0.1:61804
[S9] ⇄ pheromone p=0.329 → S11@127.0.0.1:61812
[S4] ⇄ pheromone p=0.300 → S11@127.0.0.1:61812
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.3864 head_norm=1.103810
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.022775e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.3830 head_norm=1.084675 delta_norm=0.202278
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.278 → S7@127.0.0.1:61808
[S6] ⇄ pheromone p=0.192 → S5@127.0.0.1:61805
[S14] ⇄ pheromone p=0.478 → S7@127.0.0.1:61808
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.5794 head_norm=0.957774
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.838973e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.4185 head_norm=0.980961 delta_norm=0.183897
[S2] aggregate: ROLLBACK (f1_val pre=0.579 post=0.419 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.348 → S4@127.0.0.1:61804
[S3] ⇄ pheromone p=0.419 → S13@127.0.0.1:61813
[S5] ⇄ pheromone p=0.338 → S13@127.0.0.1:61813
[S16] ⇄ pheromone p=0.253 → S2@127.0.0.1:61802
[S11] ⇄ pheromone p=0.451 → S5@127.0.0.1:61805
[S15] ⇄ pheromone p=0.393 → S9@127.0.0.1:61810
[S17] ⇄ pheromone p=0.346 → S13@127.0.0.1:61813
[S2] START round=11 head_norm_before_train=0.980961 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.189128 metrics={'f1_val': 0.635011651888818, 'auprc': 0.7752254739926687, 'loss_val': 0.8134195154093015, 'psi': 0.6910971807303583}-{'f1_val': 0.5793536851087723, 'auprc': 0.7775659915606947, 'loss_val': 0.8647488329471696, 'psi': 0.6586386076895412}
[S3] START round=11 head_norm_before_train=1.124094 cos_to_last_merge=0.8608 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.861
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.4360195449515215, 'auprc': 0.9164020543078141, 'loss_val': 0.7135467639965616, 'psi': 0.6281725486940386}-{'f1_val': 0.5601733712236956, 'auprc': 0.9975509733289561, 'loss_val': 0.6604158067814496, 'psi': 0.7351244120657998}
[S4] START round=11 head_norm_before_train=1.619587 (no previous merge yet)
[S4] round=11 local utility u=0.075358 metrics={'f1_val': 0.6646239145624306, 'auprc': 0.9018518971337657, 'loss_val': 0.5119824845245782, 'psi': 0.7595151075909647}-{'f1_val': 0.6609137963988241, 'auprc': 0.8421699003902289, 'loss_val': 0.4613917828963895, 'psi': 0.7334162379953859}
[S5] START round=11 head_norm_before_train=1.102940 cos_to_last_merge=0.9152 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.915
[S5] round=11 local utility u=0.102517 metrics={'f1_val': 0.7130108750890668, 'auprc': 0.7947417230431388, 'loss_val': 0.5832319009588987, 'psi': 0.7457032142706956}-{'f1_val': 0.7009900236517009, 'auprc': 0.7681662349082142, 'loss_val': 0.6364144783942339, 'psi': 0.7278605081543063}
[S6] START round=11 head_norm_before_train=1.483185 (no previous merge yet)
[S6] round=11 local utility u=0.640151 metrics={'f1_val': 0.6107831137523461, 'auprc': 0.7973535549717393, 'loss_val': 0.6195357169239903, 'psi': 0.6854112902401034}-{'f1_val': 0.41657277187194597, 'auprc': 0.7854851745769589, 'loss_val': 0.6989697356709975, 'psi': 0.5641377329539512}
[S7] START round=11 head_norm_before_train=1.115447 cos_to_last_merge=0.9156 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.916
[S7] round=11 local utility u=0.019206 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7812305715261685, 'loss_val': 0.7872122258151658, 'psi': 0.5625182994770814}-{'f1_val': 0.4169130971024577, 'auprc': 0.7752809536828688, 'loss_val': 0.8089924802491288, 'psi': 0.5602602397346221}
[S8] START round=11 head_norm_before_train=1.486360 (no previous merge yet)
[S8] round=11 local utility u=0.059822 metrics={'f1_val': 0.714395945848483, 'auprc': 0.9973000409507615, 'loss_val': 0.22853612430225217, 'psi': 0.8275575838893944}-{'f1_val': 0.7019438452544433, 'auprc': 0.9983701554226561, 'loss_val': 0.27667866240123795, 'psi': 0.8205143693217284}
[S9] START round=11 head_norm_before_train=1.231271 cos_to_last_merge=0.8748 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.875
[S9] round=11 local utility u=0.028974 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9989785075778633, 'loss_val': 0.25046131690395246, 'psi': 0.8203656931556834}-{'f1_val': 0.7013646677191758, 'auprc': 0.9989108249465508, 'loss_val': 0.3086518932124311, 'psi': 0.8203831306101259}
[S10] START round=11 head_norm_before_train=0.834770 cos_to_last_merge=0.8261 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.826
[S10] round=11 local utility u=0.084025 metrics={'f1_val': 0.39727872311158635, 'auprc': 0.8652033490507618, 'loss_val': 0.6973753996035423, 'psi': 0.5844485734872565}-{'f1_val': 0.38872135333834135, 'auprc': 0.860439344931285, 'loss_val': 0.7997900783216499, 'psi': 0.5774085499755188}
[S11] START round=11 head_norm_before_train=1.173423 cos_to_last_merge=0.8664 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.866
[S11] round=11 local utility u=0.043494 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9978919139365583, 'loss_val': 0.47201431933185617, 'psi': 0.820212128571502}-{'f1_val': 0.7018246587012323, 'auprc': 0.9977605366009965, 'loss_val': 0.5590020714862197, 'psi': 0.820199009861138}
[S13] START round=11 head_norm_before_train=1.084675 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.971499 metrics={'f1_val': 0.7009573970576414, 'auprc': 0.7545745235522741, 'loss_val': 0.758150848086434, 'psi': 0.7224042476554944}-{'f1_val': 0.3864179011578751, 'auprc': 0.756658959081237, 'loss_val': 0.8201658965992077, 'psi': 0.5345143243272199}
[S14] START round=11 head_norm_before_train=1.524122 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.9215416716117122, 'auprc': 0.9968988043714192, 'loss_val': 0.23710223185232182, 'psi': 0.951684524715595}-{'f1_val': 0.9968485079658588, 'auprc': 0.9929024436449456, 'loss_val': 0.3602338895341453, 'psi': 0.9952700822374936}
[S15] START round=11 head_norm_before_train=1.525321 (no previous merge yet)
[S15] round=11 local utility u=0.338126 metrics={'f1_val': 0.7004985614300305, 'auprc': 0.9975146194136335, 'loss_val': 0.4462728938142756, 'psi': 0.8193049846234717}-{'f1_val': 0.7050818700257637, 'auprc': 0.7952536449999407, 'loss_val': 0.5432427622012419, 'psi': 0.7411505800154345}
[S16] START round=11 head_norm_before_train=1.036762 cos_to_last_merge=0.8550 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.855
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.4184257172635836, 'auprc': 0.7396609471646154, 'loss_val': 0.8107194193739031, 'psi': 0.5469198092239963}-{'f1_val': 0.43573585497612677, 'auprc': 0.73985535154991, 'loss_val': 0.8168106770561446, 'psi': 0.55738365360564}
[S17] START round=11 head_norm_before_train=1.484377 (no previous merge yet)
[S17] round=11 local utility u=0.198294 metrics={'f1_val': 0.3901059603858388, 'auprc': 0.8329092149658928, 'loss_val': 0.6847118698173124, 'psi': 0.5672272622178605}-{'f1_val': 0.35535064662882343, 'auprc': 0.8221117996271351, 'loss_val': 0.8403750944461831, 'psi': 0.5420551078281481}
[S2] not sending this round → trigger blocked (psi=0.691)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:61815
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:61804
[S5] not sending this round → trigger blocked (psi=0.746)
[S11] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61809
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S6
[S5] cosine check vs S6: cos=-0.0455
[S5] DROPPED delta from S6 (cos=-0.0455 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S10
[S4] cosine check vs S10: cos=-0.0971
[S4] DROPPED delta from S10 (cos=-0.0971 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=-0.0229
[S8] DROPPED delta from S7 (cos=-0.0229 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=-0.0486
[S15] DROPPED delta from S8 (cos=-0.0486 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=-0.0663
[S11] DROPPED delta from S4 (cos=-0.0663 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S9
[S11] cosine check vs S9: cos=-0.0162
[S11] DROPPED delta from S9 (cos=-0.0162 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=-0.0121
[S9] DROPPED delta from S15 (cos=-0.0121 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=-0.0173
[S7] DROPPED delta from S13 (cos=-0.0173 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] cosine check vs S17: cos=-0.0310
[S13] DROPPED delta from S17 (cos=-0.0310 < 0.0)
[S2] START round=12 head_norm_before_train=1.025747 cos_to_last_merge=0.9968 (last merge round=10)
[S2] round=12 local utility u=0.123396 metrics={'f1_val': 0.658531207823805, 'auprc': 0.7762755055728225, 'loss_val': 0.7108957105001427, 'psi': 0.7056289269234121}-{'f1_val': 0.635011651888818, 'auprc': 0.7752254739926687, 'loss_val': 0.8134195154093015, 'psi': 0.6910971807303583}
[S3] START round=12 head_norm_before_train=1.168337 cos_to_last_merge=0.8459 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.846
[S3] round=12 local utility u=1.000000 metrics={'f1_val': 0.69982954919712, 'auprc': 0.9968731455726564, 'loss_val': 0.4710926246374345, 'psi': 0.8186469877473346}-{'f1_val': 0.4360195449515215, 'auprc': 0.9164020543078141, 'loss_val': 0.7135467639965616, 'psi': 0.6281725486940386}
[S4] START round=12 head_norm_before_train=1.664287 (no previous merge yet)
[S4] round=12 local utility u=0.039951 metrics={'f1_val': 0.6628792772228698, 'auprc': 0.9284014312410307, 'loss_val': 0.5012613278304938, 'psi': 0.7690881388301342}-{'f1_val': 0.6646239145624306, 'auprc': 0.9018518971337657, 'loss_val': 0.5119824845245782, 'psi': 0.7595151075909647}
[S5] START round=12 head_norm_before_train=1.135271 cos_to_last_merge=0.9019 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.902
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.6949379165188928, 'auprc': 0.7922489079417077, 'loss_val': 0.571764340692197, 'psi': 0.7338623130880189}-{'f1_val': 0.7130108750890668, 'auprc': 0.7947417230431388, 'loss_val': 0.5832319009588987, 'psi': 0.7457032142706956}
[S6] START round=12 head_norm_before_train=1.508884 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.5676353081923017, 'auprc': 0.7870811477956621, 'loss_val': 0.5768498913954164, 'psi': 0.6554136440336458}-{'f1_val': 0.6107831137523461, 'auprc': 0.7973535549717393, 'loss_val': 0.6195357169239903, 'psi': 0.6854112902401034}
[S7] START round=12 head_norm_before_train=1.148032 cos_to_last_merge=0.9027 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.903
[S7] round=12 local utility u=0.905719 metrics={'f1_val': 0.7122767772434913, 'auprc': 0.781217985399829, 'loss_val': 0.7491361301597887, 'psi': 0.7398532605060264}-{'f1_val': 0.41671011811102343, 'auprc': 0.7812305715261685, 'loss_val': 0.7872122258151658, 'psi': 0.5625182994770814}
[S8] START round=12 head_norm_before_train=1.529488 (no previous merge yet)
[S8] round=12 local utility u=0.872249 metrics={'f1_val': 0.9946727274656557, 'auprc': 0.9957186073221541, 'loss_val': 0.16095476928544228, 'psi': 0.995091079408255}-{'f1_val': 0.714395945848483, 'auprc': 0.9973000409507615, 'loss_val': 0.22853612430225217, 'psi': 0.8275575838893944}
[S9] START round=12 head_norm_before_train=1.289847 cos_to_last_merge=0.8604 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.860
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.5501951656522659, 'auprc': 0.8656124752057268, 'loss_val': 0.42603368487545, 'psi': 0.6763620894736503}-{'f1_val': 0.7012904835408967, 'auprc': 0.9989785075778633, 'loss_val': 0.25046131690395246, 'psi': 0.8203656931556834}
[S10] START round=12 head_norm_before_train=0.888857 cos_to_last_merge=0.7978 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.798
[S10] round=12 local utility u=0.055028 metrics={'f1_val': 0.404344630174583, 'auprc': 0.8653341556841965, 'loss_val': 0.6301069736072197, 'psi': 0.5887404403784284}-{'f1_val': 0.39727872311158635, 'auprc': 0.8652033490507618, 'loss_val': 0.6973753996035423, 'psi': 0.5844485734872565}
[S11] START round=12 head_norm_before_train=1.227135 cos_to_last_merge=0.8480 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.848
[S11] round=12 local utility u=0.052772 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9978462351803035, 'loss_val': 0.3673920604459488, 'psi': 0.8202996840511134}-{'f1_val': 0.7017589383281313, 'auprc': 0.9978919139365583, 'loss_val': 0.47201431933185617, 'psi': 0.820212128571502}
[S13] START round=12 head_norm_before_train=1.123905 cos_to_last_merge=0.9974 (last merge round=10)
[S13] round=12 local utility u=0.098866 metrics={'f1_val': 0.7015295017757731, 'auprc': 0.7731212549104091, 'loss_val': 0.6194907871503147, 'psi': 0.7301662030296274}-{'f1_val': 0.7009573970576414, 'auprc': 0.7545745235522741, 'loss_val': 0.758150848086434, 'psi': 0.7224042476554944}
[S14] START round=12 head_norm_before_train=1.575225 (no previous merge yet)
[S14] round=12 local utility u=0.183555 metrics={'f1_val': 0.9686502645147309, 'auprc': 0.998648590677721, 'loss_val': 0.15789405149869537, 'psi': 0.980649594979927}-{'f1_val': 0.9215416716117122, 'auprc': 0.9968988043714192, 'loss_val': 0.23710223185232182, 'psi': 0.951684524715595}
[S15] START round=12 head_norm_before_train=1.564611 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.7054758173685163, 'auprc': 0.9568724983549199, 'loss_val': 0.39716175381397734, 'psi': 0.8060344897630778}-{'f1_val': 0.7004985614300305, 'auprc': 0.9975146194136335, 'loss_val': 0.4462728938142756, 'psi': 0.8193049846234717}
[S16] START round=12 head_norm_before_train=1.072418 cos_to_last_merge=0.8378 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.838
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.3930629373796359, 'auprc': 0.7404113451329095, 'loss_val': 0.806501064684755, 'psi': 0.5320023004809453}-{'f1_val': 0.4184257172635836, 'auprc': 0.7396609471646154, 'loss_val': 0.8107194193739031, 'psi': 0.5469198092239963}
[S17] START round=12 head_norm_before_train=1.497923 (no previous merge yet)
[S17] round=12 local utility u=0.099109 metrics={'f1_val': 0.41604594676241236, 'auprc': 0.8391250194836364, 'loss_val': 0.6607811301946804, 'psi': 0.5852775758509019}-{'f1_val': 0.3901059603858388, 'auprc': 0.8329092149658928, 'loss_val': 0.6847118698173124, 'psi': 0.5672272622178605}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.589)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.769)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:61805
[S13] not sending this round → trigger blocked (psi=0.730)
[S8] not sending this round → trigger blocked (psi=0.995)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:61804
[S7] not sending this round → trigger blocked (psi=0.740)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:61808
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S14
[S7] cosine check vs S14: cos=-0.0683
[S7] DROPPED delta from S14 (cos=-0.0683 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S2
[S4] cosine check vs S2: cos=-0.0695
[S4] DROPPED delta from S2 (cos=-0.0695 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S3
[S13] cosine check vs S3: cos=-0.0104
[S13] DROPPED delta from S3 (cos=-0.0104 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S11
[S5] cosine check vs S11: cos=-0.0183
[S5] DROPPED delta from S11 (cos=-0.0183 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.585)
[S2] START round=13 head_norm_before_train=1.079852 cos_to_last_merge=0.9885 (last merge round=10)
[S2] round=13 local utility u=0.211027 metrics={'f1_val': 0.6994820146387307, 'auprc': 0.7841542340050405, 'loss_val': 0.5581828637543483, 'psi': 0.7333509023852547}-{'f1_val': 0.658531207823805, 'auprc': 0.7762755055728225, 'loss_val': 0.7108957105001427, 'psi': 0.7056289269234121}
[S3] START round=13 head_norm_before_train=1.210467 cos_to_last_merge=0.8331 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.833
[S3] round=13 local utility u=0.023590 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9953351547464504, 'loss_val': 0.4208035215528123, 'psi': 0.8181822440547311}-{'f1_val': 0.69982954919712, 'auprc': 0.9968731455726564, 'loss_val': 0.4710926246374345, 'psi': 0.8186469877473346}
[S4] START round=13 head_norm_before_train=1.694129 (no previous merge yet)
[S4] round=13 local utility u=0.019952 metrics={'f1_val': 0.6635168575385294, 'auprc': 0.939343135374463, 'loss_val': 0.4980083799288883, 'psi': 0.7738473686729028}-{'f1_val': 0.6628792772228698, 'auprc': 0.9284014312410307, 'loss_val': 0.5012613278304938, 'psi': 0.7690881388301342}
[S5] START round=13 head_norm_before_train=1.163675 cos_to_last_merge=0.8908 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.891
[S5] round=13 local utility u=0.050828 metrics={'f1_val': 0.7008162875368863, 'auprc': 0.7828731550007779, 'loss_val': 0.47725095642477644, 'psi': 0.733639034522443}-{'f1_val': 0.6949379165188928, 'auprc': 0.7922489079417077, 'loss_val': 0.571764340692197, 'psi': 0.7338623130880189}
[S6] START round=13 head_norm_before_train=1.537099 (no previous merge yet)
[S6] round=13 local utility u=0.482946 metrics={'f1_val': 0.7082494834376265, 'auprc': 0.7966504495468232, 'loss_val': 0.4833516588597083, 'psi': 0.7436098698813052}-{'f1_val': 0.5676353081923017, 'auprc': 0.7870811477956621, 'loss_val': 0.5768498913954164, 'psi': 0.6554136440336458}
[S7] START round=13 head_norm_before_train=1.177901 cos_to_last_merge=0.8926 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.893
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.5230681466165608, 'auprc': 0.7837498143805977, 'loss_val': 0.7709264030952453, 'psi': 0.6273408137221754}-{'f1_val': 0.7122767772434913, 'auprc': 0.781217985399829, 'loss_val': 0.7491361301597887, 'psi': 0.7398532605060264}
[S8] START round=13 head_norm_before_train=1.570353 (no previous merge yet)
[S8] round=13 local utility u=0.026265 metrics={'f1_val': 0.9950789820710053, 'auprc': 0.9986663860488, 'loss_val': 0.11970477014718964, 'psi': 0.9965139436621231}-{'f1_val': 0.9946727274656557, 'auprc': 0.9957186073221541, 'loss_val': 0.16095476928544228, 'psi': 0.995091079408255}
[S9] START round=13 head_norm_before_train=1.339350 cos_to_last_merge=0.8493 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.849
[S9] round=13 local utility u=0.783464 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9989674679278898, 'loss_val': 0.16574234999414442, 'psi': 0.820361277295694}-{'f1_val': 0.5501951656522659, 'auprc': 0.8656124752057268, 'loss_val': 0.42603368487545, 'psi': 0.6763620894736503}
[S10] START round=13 head_norm_before_train=0.945684 cos_to_last_merge=0.7706 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.771
[S10] round=13 local utility u=1.000000 metrics={'f1_val': 0.701426608464677, 'auprc': 0.9402846506013627, 'loss_val': 0.5328742087188733, 'psi': 0.7969698253193513}-{'f1_val': 0.404344630174583, 'auprc': 0.8653341556841965, 'loss_val': 0.6301069736072197, 'psi': 0.5887404403784284}
[S11] START round=13 head_norm_before_train=1.283625 cos_to_last_merge=0.8316 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.832
[S11] round=13 local utility u=0.030202 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9962316093297336, 'loss_val': 0.3021450831950432, 'psi': 0.8196538337108855}-{'f1_val': 0.7019353166316534, 'auprc': 0.9978462351803035, 'loss_val': 0.3673920604459488, 'psi': 0.8202996840511134}
[S13] START round=13 head_norm_before_train=1.169418 cos_to_last_merge=0.9915 (last merge round=10)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6488623681742822, 'auprc': 0.7479496557865885, 'loss_val': 0.5891073366893103, 'psi': 0.6884972832192047}-{'f1_val': 0.7015295017757731, 'auprc': 0.7731212549104091, 'loss_val': 0.6194907871503147, 'psi': 0.7301662030296274}
[S14] START round=13 head_norm_before_train=1.612486 (no previous merge yet)
[S14] round=13 local utility u=0.095599 metrics={'f1_val': 0.9966527066798861, 'auprc': 0.997036851077094, 'loss_val': 0.12987597210848742, 'psi': 0.9968063644387694}-{'f1_val': 0.9686502645147309, 'auprc': 0.998648590677721, 'loss_val': 0.15789405149869537, 'psi': 0.980649594979927}
[S15] START round=13 head_norm_before_train=1.606990 (no previous merge yet)
[S15] round=13 local utility u=0.041929 metrics={'f1_val': 0.6964441812601452, 'auprc': 0.9871226751414228, 'loss_val': 0.3498654287890742, 'psi': 0.8127155788126563}-{'f1_val': 0.7054758173685163, 'auprc': 0.9568724983549199, 'loss_val': 0.39716175381397734, 'psi': 0.8060344897630778}
[S16] START round=13 head_norm_before_train=1.116034 cos_to_last_merge=0.8201 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.820
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.3585232729819556, 'auprc': 0.7401300211545292, 'loss_val': 0.8412659587963064, 'psi': 0.511165972250985}-{'f1_val': 0.3930629373796359, 'auprc': 0.7404113451329095, 'loss_val': 0.806501064684755, 'psi': 0.5320023004809453}
[S17] START round=13 head_norm_before_train=1.504844 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.4161762625280291, 'auprc': 0.8251808237477449, 'loss_val': 0.6524916241978919, 'psi': 0.5797780870159155}-{'f1_val': 0.41604594676241236, 'auprc': 0.8391250194836364, 'loss_val': 0.6607811301946804, 'psi': 0.5852775758509019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:61804
[S11] not sending this round → trigger blocked (psi=0.820)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S2] not sending this round → trigger blocked (psi=0.733)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61812
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:61805
[S3] not sending this round → trigger blocked (psi=0.818)
[S6] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S6
[S5] cosine check vs S6: cos=-0.0420
[S5] DROPPED delta from S6 (cos=-0.0420 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=-0.0949
[S4] DROPPED delta from S10 (cos=-0.0949 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=-0.0507
[S15] DROPPED delta from S8 (cos=-0.0507 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S5
[S13] cosine check vs S5: cos=0.9335
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=-0.0626
[S11] DROPPED delta from S4 (cos=-0.0626 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1793) from S9
[S11] cosine check vs S9: cos=-0.0163
[S11] DROPPED delta from S9 (cos=-0.0163 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=-0.0135
[S9] DROPPED delta from S15 (cos=-0.0135 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.6489 head_norm=1.214079
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.193894e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.6811 head_norm=1.180958 delta_norm=0.219389
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.137324 cos_to_last_merge=0.9782 (last merge round=10)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.712272365106297, 'auprc': 0.778158137521313, 'loss_val': 0.6370321894261085, 'psi': 0.7386266740723034}-{'f1_val': 0.6994820146387307, 'auprc': 0.7841542340050405, 'loss_val': 0.5581828637543483, 'psi': 0.7333509023852547}
[S3] START round=14 head_norm_before_train=1.253742 cos_to_last_merge=0.8210 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.821
[S3] round=14 local utility u=0.028199 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9952308742895422, 'loss_val': 0.36710001324080244, 'psi': 0.8184411873110699}-{'f1_val': 0.7000803035935849, 'auprc': 0.9953351547464504, 'loss_val': 0.4208035215528123, 'psi': 0.8181822440547311}
[S4] START round=14 head_norm_before_train=1.717095 (no previous merge yet)
[S4] round=14 local utility u=0.892552 metrics={'f1_val': 0.953377049310415, 'auprc': 0.9538609646653112, 'loss_val': 0.49561824637115964, 'psi': 0.9535706154523734}-{'f1_val': 0.6635168575385294, 'auprc': 0.939343135374463, 'loss_val': 0.4980083799288883, 'psi': 0.7738473686729028}
[S5] START round=14 head_norm_before_train=1.188108 cos_to_last_merge=0.8802 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.880
[S5] round=14 local utility u=0.123437 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.8431913052595864, 'loss_val': 0.4115711002734301, 'psi': 0.7577903156397612}-{'f1_val': 0.7008162875368863, 'auprc': 0.7828731550007779, 'loss_val': 0.47725095642477644, 'psi': 0.733639034522443}
[S6] START round=14 head_norm_before_train=1.563519 (no previous merge yet)
[S6] round=14 local utility u=0.252523 metrics={'f1_val': 0.6964287039037185, 'auprc': 0.9620370067737246, 'loss_val': 0.40354002583253196, 'psi': 0.802672025051721}-{'f1_val': 0.7082494834376265, 'auprc': 0.7966504495468232, 'loss_val': 0.4833516588597083, 'psi': 0.7436098698813052}
[S7] START round=14 head_norm_before_train=1.205697 cos_to_last_merge=0.8853 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.885
[S7] round=14 local utility u=0.599160 metrics={'f1_val': 0.6667822060429337, 'auprc': 0.8339975617493413, 'loss_val': 0.5856335858580647, 'psi': 0.7336683483254967}-{'f1_val': 0.5230681466165608, 'auprc': 0.7837498143805977, 'loss_val': 0.7709264030952453, 'psi': 0.6273408137221754}
[S8] START round=14 head_norm_before_train=1.606368 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.9937111453033, 'auprc': 0.9980645278736825, 'loss_val': 0.11036557371666088, 'psi': 0.995452498331453}-{'f1_val': 0.9950789820710053, 'auprc': 0.9986663860488, 'loss_val': 0.11970477014718964, 'psi': 0.9965139436621231}
[S9] START round=14 head_norm_before_train=1.378998 cos_to_last_merge=0.8412 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.841
[S9] round=14 local utility u=0.877236 metrics={'f1_val': 0.990399656971262, 'auprc': 0.998464418767058, 'loss_val': 0.14441719691641808, 'psi': 0.9936255616895804}-{'f1_val': 0.7012904835408967, 'auprc': 0.9989674679278898, 'loss_val': 0.16574234999414442, 'psi': 0.820361277295694}
[S10] START round=14 head_norm_before_train=1.006158 cos_to_last_merge=0.7470 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.747
[S10] round=14 local utility u=0.111012 metrics={'f1_val': 0.6989653006711487, 'auprc': 0.9899682619905128, 'loss_val': 0.4451336709176424, 'psi': 0.8153664851988944}-{'f1_val': 0.701426608464677, 'auprc': 0.9402846506013627, 'loss_val': 0.5328742087188733, 'psi': 0.7969698253193513}
[S11] START round=14 head_norm_before_train=1.339313 cos_to_last_merge=0.8177 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.818
[S11] round=14 local utility u=0.026499 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.996269981472886, 'loss_val': 0.2478119804415641, 'psi': 0.8195240803413093}-{'f1_val': 0.7019353166316534, 'auprc': 0.9962316093297336, 'loss_val': 0.3021450831950432, 'psi': 0.8196538337108855}
[S13] START round=14 head_norm_before_train=1.180958 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.061834 metrics={'f1_val': 0.69390838912925, 'auprc': 0.6976242190314681, 'loss_val': 0.5847384588996498, 'psi': 0.6953947210901372}-{'f1_val': 0.6488623681742822, 'auprc': 0.7479496557865885, 'loss_val': 0.5891073366893103, 'psi': 0.6884972832192047}
[S14] START round=14 head_norm_before_train=1.644610 (no previous merge yet)
[S14] round=14 local utility u=0.017310 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.9968435252619303, 'loss_val': 0.09719660433952836, 'psi': 0.9969810908065159}-{'f1_val': 0.9966527066798861, 'auprc': 0.997036851077094, 'loss_val': 0.12987597210848742, 'psi': 0.9968063644387694}
[S15] START round=14 head_norm_before_train=1.645687 (no previous merge yet)
[S15] round=14 local utility u=0.085540 metrics={'f1_val': 0.7054084985345972, 'auprc': 0.9941980424296408, 'loss_val': 0.2537980042359987, 'psi': 0.8209243160926147}-{'f1_val': 0.6964441812601452, 'auprc': 0.9871226751414228, 'loss_val': 0.3498654287890742, 'psi': 0.8127155788126563}
[S16] START round=14 head_norm_before_train=1.166227 cos_to_last_merge=0.8030 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.803
[S16] round=14 local utility u=0.243419 metrics={'f1_val': 0.43250463484029295, 'auprc': 0.7468367428739127, 'loss_val': 0.818437154888828, 'psi': 0.5582374780537409}-{'f1_val': 0.3585232729819556, 'auprc': 0.7401300211545292, 'loss_val': 0.8412659587963064, 'psi': 0.511165972250985}
[S17] START round=14 head_norm_before_train=1.509859 (no previous merge yet)
[S17] round=14 local utility u=0.403012 metrics={'f1_val': 0.5612114084127303, 'auprc': 0.8011153678801637, 'loss_val': 0.6444817437833471, 'psi': 0.6571729921997036}-{'f1_val': 0.4161762625280291, 'auprc': 0.8251808237477449, 'loss_val': 0.6524916241978919, 'psi': 0.5797780870159155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:61802
[S5] not sending this round → trigger blocked (psi=0.758)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[S15] not sending this round → trigger blocked (psi=0.821)
[S10] not sending this round → trigger blocked (psi=0.815)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:61805
[S6] not sending this round → trigger blocked (psi=0.803)
[S4] not sending this round → trigger blocked (psi=0.954)
[S9] not sending this round → trigger blocked (psi=0.994)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61809
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S11
[S5] cosine check vs S11: cos=-0.0185
[S5] DROPPED delta from S11 (cos=-0.0185 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S13
[S7] cosine check vs S13: cos=-0.0197
[S7] DROPPED delta from S13 (cos=-0.0197 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S16
[S2] cosine check vs S16: cos=0.9046
[S8] RECEIVED delta(kind=head bytes=1801) from S7
[S8] cosine check vs S7: cos=-0.0128
[S8] DROPPED delta from S7 (cos=-0.0128 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1804) from S3
[S13] cosine check vs S3: cos=-0.0011
[S13] DROPPED delta from S3 (cos=-0.0011 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=-0.0661
[S7] DROPPED delta from S14 (cos=-0.0661 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=-0.0264
[S13] DROPPED delta from S17 (cos=-0.0264 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7123 head_norm=1.194312
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.631084e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.7123 head_norm=1.174795 delta_norm=0.263108
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.174795 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.015562 metrics={'f1_val': 0.6990222623410081, 'auprc': 0.7572224368269743, 'loss_val': 0.46360045694893887, 'psi': 0.7223023321353945}-{'f1_val': 0.712272365106297, 'auprc': 0.778158137521313, 'loss_val': 0.6370321894261085, 'psi': 0.7386266740723034}
[S3] START round=15 head_norm_before_train=1.296604 cos_to_last_merge=0.8094 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.809
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.6664025028901451, 'auprc': 0.9929384865018026, 'loss_val': 0.4126256190946336, 'psi': 0.7970168963348081}-{'f1_val': 0.7005813959920884, 'auprc': 0.9952308742895422, 'loss_val': 0.36710001324080244, 'psi': 0.8184411873110699}
[S4] START round=15 head_norm_before_train=1.734061 (no previous merge yet)
[S4] round=15 local utility u=0.000843 metrics={'f1_val': 0.9442115133712492, 'auprc': 0.954772506819155, 'loss_val': 0.4416736662993414, 'psi': 0.9484359107504116}-{'f1_val': 0.953377049310415, 'auprc': 0.9538609646653112, 'loss_val': 0.49561824637115964, 'psi': 0.9535706154523734}
[S5] START round=15 head_norm_before_train=1.224718 cos_to_last_merge=0.8673 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.867
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7015262300300319, 'auprc': 0.7922858457592151, 'loss_val': 0.39046380930466323, 'psi': 0.7378300763217052}-{'f1_val': 0.7008563225598777, 'auprc': 0.8431913052595864, 'loss_val': 0.4115711002734301, 'psi': 0.7577903156397612}
[S6] START round=15 head_norm_before_train=1.594591 (no previous merge yet)
[S6] round=15 local utility u=0.036716 metrics={'f1_val': 0.7040927595581359, 'auprc': 0.962740149056995, 'loss_val': 0.37820120058824336, 'psi': 0.8075517153576796}-{'f1_val': 0.6964287039037185, 'auprc': 0.9620370067737246, 'loss_val': 0.40354002583253196, 'psi': 0.802672025051721}
[S7] START round=15 head_norm_before_train=1.229578 cos_to_last_merge=0.8793 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.879
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.3966842419382176, 'auprc': 0.6219097898710164, 'loss_val': 0.9576767821829998, 'psi': 0.48677446111133715}-{'f1_val': 0.6667822060429337, 'auprc': 0.8339975617493413, 'loss_val': 0.5856335858580647, 'psi': 0.7336683483254967}
[S8] START round=15 head_norm_before_train=1.636024 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.7138880036303916, 'auprc': 0.9875518576747426, 'loss_val': 0.17660836547511014, 'psi': 0.823353545248132}-{'f1_val': 0.9937111453033, 'auprc': 0.9980645278736825, 'loss_val': 0.11036557371666088, 'psi': 0.995452498331453}
[S9] START round=15 head_norm_before_train=1.414517 cos_to_last_merge=0.8338 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.834
[S9] round=15 local utility u=0.024323 metrics={'f1_val': 0.9929267706419841, 'auprc': 0.9988420409359046, 'loss_val': 0.11206772082739486, 'psi': 0.9952928787595523}-{'f1_val': 0.990399656971262, 'auprc': 0.998464418767058, 'loss_val': 0.14441719691641808, 'psi': 0.9936255616895804}
[S10] START round=15 head_norm_before_train=1.066473 cos_to_last_merge=0.7276 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.728
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.6997044604318361, 'auprc': 0.9207693921332869, 'loss_val': 0.3784831431858952, 'psi': 0.7881304331124164}-{'f1_val': 0.6989653006711487, 'auprc': 0.9899682619905128, 'loss_val': 0.4451336709176424, 'psi': 0.8153664851988944}
[S11] START round=15 head_norm_before_train=1.391588 cos_to_last_merge=0.8066 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.807
[S11] round=15 local utility u=0.742059 metrics={'f1_val': 0.9407183136971592, 'auprc': 0.9978894973763526, 'loss_val': 0.2027020647747303, 'psi': 0.9635867871688366}-{'f1_val': 0.7016934795869249, 'auprc': 0.996269981472886, 'loss_val': 0.2478119804415641, 'psi': 0.8195240803413093}
[S13] START round=15 head_norm_before_train=1.213337 cos_to_last_merge=0.9989 (last merge round=13)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6361563625785609, 'auprc': 0.6120993002733812, 'loss_val': 0.6125947857570021, 'psi': 0.6265335376564891}-{'f1_val': 0.69390838912925, 'auprc': 0.6976242190314681, 'loss_val': 0.5847384588996498, 'psi': 0.6953947210901372}
[S14] START round=15 head_norm_before_train=1.672719 (no previous merge yet)
[S14] round=15 local utility u=0.008814 metrics={'f1_val': 0.9969987740343681, 'auprc': 0.9968982196354843, 'loss_val': 0.07928937081266774, 'psi': 0.9969585522748146}-{'f1_val': 0.9970728011695729, 'auprc': 0.9968435252619303, 'loss_val': 0.09719660433952836, 'psi': 0.9969810908065159}
[S15] START round=15 head_norm_before_train=1.679898 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.7006870857840772, 'auprc': 0.9923536375642368, 'loss_val': 0.2418796112740782, 'psi': 0.817353706496141}-{'f1_val': 0.7054084985345972, 'auprc': 0.9941980424296408, 'loss_val': 0.2537980042359987, 'psi': 0.8209243160926147}
[S16] START round=15 head_norm_before_train=1.213407 cos_to_last_merge=0.7865 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.786
[S16] round=15 local utility u=0.050150 metrics={'f1_val': 0.4330979367556688, 'auprc': 0.7620270214997467, 'loss_val': 0.7672682109866535, 'psi': 0.5646695706533}-{'f1_val': 0.43250463484029295, 'auprc': 0.7468367428739127, 'loss_val': 0.818437154888828, 'psi': 0.5582374780537409}
[S17] START round=15 head_norm_before_train=1.514740 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.4193923663146778, 'auprc': 0.7775740710065007, 'loss_val': 0.6291375516616676, 'psi': 0.562665048191407}-{'f1_val': 0.5612114084127303, 'auprc': 0.8011153678801637, 'loss_val': 0.6444817437833471, 'psi': 0.6571729921997036}
[S14] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.565)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:61805
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:61812
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:61804
[S11] not sending this round → trigger blocked (psi=0.964)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=-0.0628
[S11] DROPPED delta from S4 (cos=-0.0628 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=-0.0485
[S4] DROPPED delta from S2 (cos=-0.0485 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S6
[S5] cosine check vs S6: cos=-0.0370
[S5] DROPPED delta from S6 (cos=-0.0370 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1795) from S9
[S11] cosine check vs S9: cos=-0.0187
[S11] DROPPED delta from S9 (cos=-0.0187 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.146 → S13@127.0.0.1:61813
[S14] ⇄ pheromone p=0.192 → S7@127.0.0.1:61808
[S8] ⇄ pheromone p=0.206 → S15@127.0.0.1:61815
[S11] ⇄ pheromone p=0.313 → S5@127.0.0.1:61805
[S7] ⇄ pheromone p=0.278 → S8@127.0.0.1:61809
[S10] ⇄ pheromone p=0.246 → S4@127.0.0.1:61804
[S3] ⇄ pheromone p=0.247 → S13@127.0.0.1:61813
[S15] ⇄ pheromone p=0.176 → S9@127.0.0.1:61810
[S13] ⇄ pheromone p=0.191 → S7@127.0.0.1:61808
[S9] ⇄ pheromone p=0.356 → S11@127.0.0.1:61812
[S2] ⇄ pheromone p=0.172 → S4@127.0.0.1:61804
[S4] ⇄ pheromone p=0.254 → S11@127.0.0.1:61812
[S6] ⇄ pheromone p=0.225 → S5@127.0.0.1:61805
[S17] ⇄ pheromone p=0.204 → S13@127.0.0.1:61813
[S16] ⇄ pheromone p=0.132 → S2@127.0.0.1:61802
[S2] START round=16 head_norm_before_train=1.225214 cos_to_last_merge=0.9983 (last merge round=14)
[S2] round=16 local utility u=0.016325 metrics={'f1_val': 0.704896070910819, 'auprc': 0.7703752669853294, 'loss_val': 0.505652347383871, 'psi': 0.7310877493406231}-{'f1_val': 0.6990222623410081, 'auprc': 0.7572224368269743, 'loss_val': 0.46360045694893887, 'psi': 0.7223023321353945}
[S3] START round=16 head_norm_before_train=1.334542 cos_to_last_merge=0.7996 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.800
[S3] round=16 local utility u=0.157976 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9940004233146041, 'loss_val': 0.30598253486240473, 'psi': 0.8180538915670215}-{'f1_val': 0.6664025028901451, 'auprc': 0.9929384865018026, 'loss_val': 0.4126256190946336, 'psi': 0.7970168963348081}
[S4] START round=16 head_norm_before_train=1.754245 (no previous merge yet)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9379472590256802, 'auprc': 0.9461420170629623, 'loss_val': 0.4154966095770371, 'psi': 0.9412251622405932}-{'f1_val': 0.9442115133712492, 'auprc': 0.954772506819155, 'loss_val': 0.4416736662993414, 'psi': 0.9484359107504116}
[S5] START round=16 head_norm_before_train=1.263476 cos_to_last_merge=0.8554 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.855
[S5] round=16 local utility u=0.338334 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9957950330429612, 'loss_val': 0.3188165327053244, 'psi': 0.8186830488147891}-{'f1_val': 0.7015262300300319, 'auprc': 0.7922858457592151, 'loss_val': 0.39046380930466323, 'psi': 0.7378300763217052}
[S6] START round=16 head_norm_before_train=1.625744 (no previous merge yet)
[S6] round=16 local utility u=0.401838 metrics={'f1_val': 0.8350667151206446, 'auprc': 0.9550992237887918, 'loss_val': 0.3374470430343378, 'psi': 0.8830797185879035}-{'f1_val': 0.7040927595581359, 'auprc': 0.962740149056995, 'loss_val': 0.37820120058824336, 'psi': 0.8075517153576796}
[S7] START round=16 head_norm_before_train=1.248213 cos_to_last_merge=0.8741 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.874
[S7] round=16 local utility u=1.000000 metrics={'f1_val': 0.6576633177245688, 'auprc': 0.8063932523713118, 'loss_val': 0.5829634910317284, 'psi': 0.717155291583266}-{'f1_val': 0.3966842419382176, 'auprc': 0.6219097898710164, 'loss_val': 0.9576767821829998, 'psi': 0.48677446111133715}
[S8] START round=16 head_norm_before_train=1.664229 (no previous merge yet)
[S8] round=16 local utility u=0.903299 metrics={'f1_val': 0.9928898770479506, 'auprc': 0.9991236030522604, 'loss_val': 0.07873601612170968, 'psi': 0.9953833674496745}-{'f1_val': 0.7138880036303916, 'auprc': 0.9875518576747426, 'loss_val': 0.17660836547511014, 'psi': 0.823353545248132}
[S9] START round=16 head_norm_before_train=1.450057 cos_to_last_merge=0.8274 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.827
[S9] round=16 local utility u=0.007668 metrics={'f1_val': 0.9925069029958717, 'auprc': 0.9988387513884811, 'loss_val': 0.09420188973257099, 'psi': 0.9950396423529154}-{'f1_val': 0.9929267706419841, 'auprc': 0.9988420409359046, 'loss_val': 0.11206772082739486, 'psi': 0.9952928787595523}
[S10] START round=16 head_norm_before_train=1.122718 cos_to_last_merge=0.7122 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.712
[S10] round=16 local utility u=0.089310 metrics={'f1_val': 0.6983870813889781, 'auprc': 0.9645998858485563, 'loss_val': 0.32345042937651347, 'psi': 0.8048722031728094}-{'f1_val': 0.6997044604318361, 'auprc': 0.9207693921332869, 'loss_val': 0.3784831431858952, 'psi': 0.7881304331124164}
[S11] START round=16 head_norm_before_train=1.435436 cos_to_last_merge=0.7984 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.798
[S11] round=16 local utility u=0.154706 metrics={'f1_val': 0.9871629613279302, 'auprc': 0.9979757288694269, 'loss_val': 0.1722166576649237, 'psi': 0.9914880683445289}-{'f1_val': 0.9407183136971592, 'auprc': 0.9978894973763526, 'loss_val': 0.2027020647747303, 'psi': 0.9635867871688366}
[S13] START round=16 head_norm_before_train=1.246444 cos_to_last_merge=0.9962 (last merge round=13)
[S13] round=16 local utility u=0.080833 metrics={'f1_val': 0.6306626612021119, 'auprc': 0.6555764696509735, 'loss_val': 0.5483971558300537, 'psi': 0.6406281845816565}-{'f1_val': 0.6361563625785609, 'auprc': 0.6120993002733812, 'loss_val': 0.6125947857570021, 'psi': 0.6265335376564891}
[S14] START round=16 head_norm_before_train=1.695283 (no previous merge yet)
[S14] round=16 local utility u=0.003500 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969102429864052, 'loss_val': 0.07377513305073592, 'psi': 0.9971083112180379}-{'f1_val': 0.9969987740343681, 'auprc': 0.9968982196354843, 'loss_val': 0.07928937081266774, 'psi': 0.9969585522748146}
[S15] START round=16 head_norm_before_train=1.707878 (no previous merge yet)
[S15] round=16 local utility u=0.950933 metrics={'f1_val': 0.9969420788283408, 'auprc': 0.9970258213246833, 'loss_val': 0.13155934516638904, 'psi': 0.9969755758268779}-{'f1_val': 0.7006870857840772, 'auprc': 0.9923536375642368, 'loss_val': 0.2418796112740782, 'psi': 0.817353706496141}
[S16] START round=16 head_norm_before_train=1.255474 cos_to_last_merge=0.7710 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.771
[S16] round=16 local utility u=1.000000 metrics={'f1_val': 0.7662189063274015, 'auprc': 0.7955417873605365, 'loss_val': 0.6815450737964114, 'psi': 0.7779480587406555}-{'f1_val': 0.4330979367556688, 'auprc': 0.7620270214997467, 'loss_val': 0.7672682109866535, 'psi': 0.5646695706533}
[S17] START round=16 head_norm_before_train=1.520433 (no previous merge yet)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.4119235206182829, 'auprc': 0.763723950209837, 'loss_val': 0.6087497419434829, 'psi': 0.5526436924549045}-{'f1_val': 0.4193923663146778, 'auprc': 0.7775740710065007, 'loss_val': 0.6291375516616676, 'psi': 0.562665048191407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:61802
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.883)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S2] not sending this round → trigger blocked (psi=0.731)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61808
[S9] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61808
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=-0.0135
[S9] DROPPED delta from S15 (cos=-0.0135 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] cosine check vs S11: cos=-0.0181
[S5] DROPPED delta from S11 (cos=-0.0181 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=-0.0523
[S15] DROPPED delta from S8 (cos=-0.0523 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S16
[S2] cosine check vs S16: cos=0.9463
[S13] RECEIVED delta(kind=head bytes=1801) from S5
[S13] cosine check vs S5: cos=0.9443
[S13] RECEIVED delta(kind=head bytes=1795) from S3
[S13] cosine check vs S3: cos=-0.0091
[S13] DROPPED delta from S3 (cos=-0.0091 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=-0.0652
[S7] DROPPED delta from S14 (cos=-0.0652 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1793) from S10
[S4] cosine check vs S10: cos=-0.0831
[S4] DROPPED delta from S10 (cos=-0.0831 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=-0.0109
[S8] DROPPED delta from S7 (cos=-0.0109 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S13
[S7] cosine check vs S13: cos=-0.0229
[S7] DROPPED delta from S13 (cos=-0.0229 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.7049 head_norm=1.276067
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.107525e-01
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.7049 head_norm=1.267740 delta_norm=0.210753
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6307 head_norm=1.274805
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.149787e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6434 head_norm=1.268270 delta_norm=0.214979
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.267740 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.6870123676467184, 'auprc': 0.7712500515625067, 'loss_val': 0.7560034063491028, 'psi': 0.7207074412130337}-{'f1_val': 0.704896070910819, 'auprc': 0.7703752669853294, 'loss_val': 0.505652347383871, 'psi': 0.7310877493406231}
[S3] START round=17 head_norm_before_train=1.367831 cos_to_last_merge=0.7923 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.792
[S3] round=17 local utility u=0.009123 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9953214030750825, 'loss_val': 0.2916993533778655, 'psi': 0.8185822834712129}-{'f1_val': 0.7007562037352997, 'auprc': 0.9940004233146041, 'loss_val': 0.30598253486240473, 'psi': 0.8180538915670215}
[S4] START round=17 head_norm_before_train=1.777954 (no previous merge yet)
[S4] round=17 local utility u=0.108110 metrics={'f1_val': 0.9519616190220022, 'auprc': 0.9623234262850252, 'loss_val': 0.33190671653378745, 'psi': 0.9561063419272113}-{'f1_val': 0.9379472590256802, 'auprc': 0.9461420170629623, 'loss_val': 0.4154966095770371, 'psi': 0.9412251622405932}
[S5] START round=17 head_norm_before_train=1.297814 cos_to_last_merge=0.8450 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.845
[S5] round=17 local utility u=0.009611 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9956251702550254, 'loss_val': 0.29908445605201356, 'psi': 0.8186151036996148}-{'f1_val': 0.7006083926626743, 'auprc': 0.9957950330429612, 'loss_val': 0.3188165327053244, 'psi': 0.8186830488147891}
[S6] START round=17 head_norm_before_train=1.653791 (no previous merge yet)
[S6] round=17 local utility u=0.397312 metrics={'f1_val': 0.9610522388390114, 'auprc': 0.9605054252099334, 'loss_val': 0.31495526104993954, 'psi': 0.9608335133873802}-{'f1_val': 0.8350667151206446, 'auprc': 0.9550992237887918, 'loss_val': 0.3374470430343378, 'psi': 0.8830797185879035}
[S7] START round=17 head_norm_before_train=1.262415 cos_to_last_merge=0.8702 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.870
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.5746476862664079, 'auprc': 0.7677905672489055, 'loss_val': 0.6904439701373175, 'psi': 0.651904838659407}-{'f1_val': 0.6576633177245688, 'auprc': 0.8063932523713118, 'loss_val': 0.5829634910317284, 'psi': 0.717155291583266}
[S8] START round=17 head_norm_before_train=1.685799 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.947578437843974, 'auprc': 0.9867877736580534, 'loss_val': 0.12511708704055, 'psi': 0.9632621721696057}-{'f1_val': 0.9928898770479506, 'auprc': 0.9991236030522604, 'loss_val': 0.07873601612170968, 'psi': 0.9953833674496745}
[S9] START round=17 head_norm_before_train=1.485676 cos_to_last_merge=0.8208 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.821
[S9] round=17 local utility u=0.025674 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9988334789925477, 'loss_val': 0.06542360841703143, 'psi': 0.9972960090352627}-{'f1_val': 0.9925069029958717, 'auprc': 0.9988387513884811, 'loss_val': 0.09420188973257099, 'psi': 0.9950396423529154}
[S10] START round=17 head_norm_before_train=1.175988 cos_to_last_merge=0.7000 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.700
[S10] round=17 local utility u=0.075944 metrics={'f1_val': 0.699260083987036, 'auprc': 0.9941690071073062, 'loss_val': 0.2655081639528958, 'psi': 0.817223653235144}-{'f1_val': 0.6983870813889781, 'auprc': 0.9645998858485563, 'loss_val': 0.32345042937651347, 'psi': 0.8048722031728094}
[S11] START round=17 head_norm_before_train=1.476642 cos_to_last_merge=0.7921 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.792
[S11] round=17 local utility u=0.043011 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9979918674790924, 'loss_val': 0.1424264789455376, 'psi': 0.9971128658890162}-{'f1_val': 0.9871629613279302, 'auprc': 0.9979757288694269, 'loss_val': 0.1722166576649237, 'psi': 0.9914880683445289}
[S13] START round=17 head_norm_before_train=1.268270 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.132604 metrics={'f1_val': 0.644794547622733, 'auprc': 0.7103798361394725, 'loss_val': 0.5323913760616469, 'psi': 0.6710286630294289}-{'f1_val': 0.6306626612021119, 'auprc': 0.6555764696509735, 'loss_val': 0.5483971558300537, 'psi': 0.6406281845816565}
[S14] START round=17 head_norm_before_train=1.712129 (no previous merge yet)
[S14] round=17 local utility u=0.005983 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9969096749120876, 'loss_val': 0.06326412968038443, 'psi': 0.9972537165947276}-{'f1_val': 0.997240356705793, 'auprc': 0.9969102429864052, 'loss_val': 0.07377513305073592, 'psi': 0.9971083112180379}
[S15] START round=17 head_norm_before_train=1.737974 (no previous merge yet)
[S15] round=17 local utility u=0.018107 metrics={'f1_val': 0.9964380514320631, 'auprc': 0.9982412865777103, 'loss_val': 0.0959678001268663, 'psi': 0.997159345490322}-{'f1_val': 0.9969420788283408, 'auprc': 0.9970258213246833, 'loss_val': 0.13155934516638904, 'psi': 0.9969755758268779}
[S16] START round=17 head_norm_before_train=1.294148 cos_to_last_merge=0.7595 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.759
[S16] round=17 local utility u=0.428357 metrics={'f1_val': 0.8635309633886786, 'auprc': 0.8478804922011186, 'loss_val': 0.5657199085380985, 'psi': 0.8572707749136546}-{'f1_val': 0.7662189063274015, 'auprc': 0.7955417873605365, 'loss_val': 0.6815450737964114, 'psi': 0.7779480587406555}
[S17] START round=17 head_norm_before_train=1.531243 (no previous merge yet)
[S17] round=17 local utility u=0.023940 metrics={'f1_val': 0.4118497644937277, 'auprc': 0.7745146552498652, 'loss_val': 0.592798566487949, 'psi': 0.5569157207961827}-{'f1_val': 0.4119235206182829, 'auprc': 0.763723950209837, 'loss_val': 0.6087497419434829, 'psi': 0.5526436924549045}
[S10] not sending this round → trigger blocked (psi=0.817)
[S11] not sending this round → trigger blocked (psi=0.997)
[S16] not sending this round → trigger blocked (psi=0.857)
[S5] not sending this round → trigger blocked (psi=0.819)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61812
[S13] not sending this round → trigger blocked (psi=0.671)
[S15] not sending this round → trigger blocked (psi=0.997)
[S3] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:61805
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=-0.0670
[S11] DROPPED delta from S4 (cos=-0.0670 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S6
[S5] cosine check vs S6: cos=-0.0317
[S5] DROPPED delta from S6 (cos=-0.0317 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] cosine check vs S9: cos=-0.0224
[S11] DROPPED delta from S9 (cos=-0.0224 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] cosine check vs S17: cos=-0.0165
[S13] DROPPED delta from S17 (cos=-0.0165 < 0.0)
[S2] START round=18 head_norm_before_train=1.312797 cos_to_last_merge=0.9989 (last merge round=16)
[S2] round=18 local utility u=0.056800 metrics={'f1_val': 0.6917040660022902, 'auprc': 0.7027589371067364, 'loss_val': 0.46508060393688183, 'psi': 0.6961260144440686}-{'f1_val': 0.6870123676467184, 'auprc': 0.7712500515625067, 'loss_val': 0.7560034063491028, 'psi': 0.7207074412130337}
[S3] START round=18 head_norm_before_train=1.396980 cos_to_last_merge=0.7865 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.786
[S3] round=18 local utility u=0.003816 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9953205386417187, 'loss_val': 0.28406390018416644, 'psi': 0.8185819376978672}-{'f1_val': 0.7007562037352997, 'auprc': 0.9953214030750825, 'loss_val': 0.2916993533778655, 'psi': 0.8185822834712129}
[S4] START round=18 head_norm_before_train=1.797980 (no previous merge yet)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9352084279242026, 'auprc': 0.9478947501575826, 'loss_val': 0.36489224968244255, 'psi': 0.9402829568175546}-{'f1_val': 0.9519616190220022, 'auprc': 0.9623234262850252, 'loss_val': 0.33190671653378745, 'psi': 0.9561063419272113}
[S5] START round=18 head_norm_before_train=1.328665 cos_to_last_merge=0.8364 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.836
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9397883894142882, 'loss_val': 0.296930139005842, 'psi': 0.7962803913633199}-{'f1_val': 0.7006083926626743, 'auprc': 0.9956251702550254, 'loss_val': 0.29908445605201356, 'psi': 0.8186151036996148}
[S6] START round=18 head_norm_before_train=1.676508 (no previous merge yet)
[S6] round=18 local utility u=0.018957 metrics={'f1_val': 0.9609282591939198, 'auprc': 0.9619323169405415, 'loss_val': 0.28057763903894195, 'psi': 0.9613298822925684}-{'f1_val': 0.9610522388390114, 'auprc': 0.9605054252099334, 'loss_val': 0.31495526104993954, 'psi': 0.9608335133873802}
[S7] START round=18 head_norm_before_train=1.277392 cos_to_last_merge=0.8664 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.866
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.41540856956294603, 'auprc': 0.618892244468147, 'loss_val': 1.02250402858263, 'psi': 0.4968020395250264}-{'f1_val': 0.5746476862664079, 'auprc': 0.7677905672489055, 'loss_val': 0.6904439701373175, 'psi': 0.651904838659407}
[S8] START round=18 head_norm_before_train=1.706017 (no previous merge yet)
[S8] round=18 local utility u=0.169189 metrics={'f1_val': 0.9933434229799246, 'auprc': 0.9908146748749793, 'loss_val': 0.07340907147352801, 'psi': 0.9923319237379465}-{'f1_val': 0.947578437843974, 'auprc': 0.9867877736580534, 'loss_val': 0.12511708704055, 'psi': 0.9632621721696057}
[S9] START round=18 head_norm_before_train=1.518802 cos_to_last_merge=0.8150 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.815
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.990399656971262, 'auprc': 0.9988414585592972, 'loss_val': 0.06388022710677571, 'psi': 0.9937763776064761}-{'f1_val': 0.9962710290637395, 'auprc': 0.9988334789925477, 'loss_val': 0.06542360841703143, 'psi': 0.9972960090352627}
[S10] START round=18 head_norm_before_train=1.222420 cos_to_last_merge=0.6892 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.689
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.6401572672179583, 'auprc': 0.9649591522301788, 'loss_val': 0.2993577262307488, 'psi': 0.7700780212228465}-{'f1_val': 0.699260083987036, 'auprc': 0.9941690071073062, 'loss_val': 0.2655081639528958, 'psi': 0.817223653235144}
[S11] START round=18 head_norm_before_train=1.513500 cos_to_last_merge=0.7864 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.786
[S11] round=18 local utility u=0.015120 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9979902155905288, 'loss_val': 0.1121813415627753, 'psi': 0.9971122051335908}-{'f1_val': 0.9965268648289654, 'auprc': 0.9979918674790924, 'loss_val': 0.1424264789455376, 'psi': 0.9971128658890162}
[S13] START round=18 head_norm_before_train=1.293127 cos_to_last_merge=0.9990 (last merge round=16)
[S13] round=18 local utility u=0.044417 metrics={'f1_val': 0.663993932205815, 'auprc': 0.6913574011411978, 'loss_val': 0.501686518489861, 'psi': 0.6749393197799681}-{'f1_val': 0.644794547622733, 'auprc': 0.7103798361394725, 'loss_val': 0.5323913760616469, 'psi': 0.6710286630294289}
[S14] START round=18 head_norm_before_train=1.733581 (no previous merge yet)
[S14] round=18 local utility u=0.003018 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.996946295176099, 'loss_val': 0.05487648165235399, 'psi': 0.9970221987721833}-{'f1_val': 0.9974830777164877, 'auprc': 0.9969096749120876, 'loss_val': 0.06326412968038443, 'psi': 0.9972537165947276}
[S15] START round=18 head_norm_before_train=1.768164 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.8060077517017925, 'auprc': 0.9900598115581264, 'loss_val': 0.17068209468302162, 'psi': 0.8796285756443261}-{'f1_val': 0.9964380514320631, 'auprc': 0.9982412865777103, 'loss_val': 0.0959678001268663, 'psi': 0.997159345490322}
[S16] START round=18 head_norm_before_train=1.334347 cos_to_last_merge=0.7494 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.749
[S16] round=18 local utility u=0.349947 metrics={'f1_val': 0.9144807299045006, 'auprc': 0.9279350962950804, 'loss_val': 0.4116876112350943, 'psi': 0.9198624764607325}-{'f1_val': 0.8635309633886786, 'auprc': 0.8478804922011186, 'loss_val': 0.5657199085380985, 'psi': 0.8572707749136546}
[S17] START round=18 head_norm_before_train=1.544071 (no previous merge yet)
[S17] round=18 local utility u=0.032404 metrics={'f1_val': 0.41662448074534797, 'auprc': 0.7850668207439722, 'loss_val': 0.5882950838209091, 'psi': 0.5640014167447976}-{'f1_val': 0.4118497644937277, 'auprc': 0.7745146552498652, 'loss_val': 0.592798566487949, 'psi': 0.5569157207961827}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[S6] not sending this round → trigger blocked (psi=0.961)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:61808
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:61805
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61808
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=-0.0537
[S15] DROPPED delta from S8 (cos=-0.0537 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] cosine check vs S11: cos=-0.0155
[S5] DROPPED delta from S11 (cos=-0.0155 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S3
[S13] cosine check vs S3: cos=0.0056
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=-0.0638
[S7] DROPPED delta from S14 (cos=-0.0638 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S16
[S2] cosine check vs S16: cos=0.9671
[S4] RECEIVED delta(kind=head bytes=1803) from S2
[S4] cosine check vs S2: cos=-0.0453
[S4] DROPPED delta from S2 (cos=-0.0453 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1794) from S13
[S7] cosine check vs S13: cos=-0.0226
[S7] DROPPED delta from S13 (cos=-0.0226 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.564)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.6640 head_norm=1.322684
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.679024e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.6681 head_norm=0.973302 delta_norm=0.967902
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.6917 head_norm=1.357369
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.753564e-01
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.6905 head_norm=1.354018 delta_norm=0.175356
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.354018 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.6130196856854545, 'auprc': 0.6481405147704755, 'loss_val': 0.6442075426179895, 'psi': 0.6270680173194629}-{'f1_val': 0.6917040660022902, 'auprc': 0.7027589371067364, 'loss_val': 0.46508060393688183, 'psi': 0.6961260144440686}
[S3] START round=19 head_norm_before_train=1.420849 cos_to_last_merge=0.7819 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.782
[S3] round=19 local utility u=0.002395 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9953384089503647, 'loss_val': 0.2788762340139401, 'psi': 0.8185439393793468}-{'f1_val': 0.7007562037352997, 'auprc': 0.9953205386417187, 'loss_val': 0.28406390018416644, 'psi': 0.8185819376978672}
[S4] START round=19 head_norm_before_train=1.815331 (no previous merge yet)
[S4] round=19 local utility u=0.056632 metrics={'f1_val': 0.9390339168445061, 'auprc': 0.9641479602388289, 'loss_val': 0.3233415068816489, 'psi': 0.9490795342022352}-{'f1_val': 0.9352084279242026, 'auprc': 0.9478947501575826, 'loss_val': 0.36489224968244255, 'psi': 0.9402829568175546}
[S5] START round=19 head_norm_before_train=1.357515 cos_to_last_merge=0.8278 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.828
[S5] round=19 local utility u=0.098034 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9946943048075356, 'loss_val': 0.26557975487438473, 'psi': 0.8182427575206188}-{'f1_val': 0.7006083926626743, 'auprc': 0.9397883894142882, 'loss_val': 0.296930139005842, 'psi': 0.7962803913633199}
[S6] START round=19 head_norm_before_train=1.694432 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.9365152591107543, 'auprc': 0.9446545178472745, 'loss_val': 0.3629546414441701, 'psi': 0.9397709626053624}-{'f1_val': 0.9609282591939198, 'auprc': 0.9619323169405415, 'loss_val': 0.28057763903894195, 'psi': 0.9613298822925684}
[S7] START round=19 head_norm_before_train=1.292224 cos_to_last_merge=0.8629 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.863
[S7] round=19 local utility u=0.757392 metrics={'f1_val': 0.5558017909458717, 'auprc': 0.7650431996352498, 'loss_val': 0.7885331367731061, 'psi': 0.639498354421623}-{'f1_val': 0.41540856956294603, 'auprc': 0.618892244468147, 'loss_val': 1.02250402858263, 'psi': 0.4968020395250264}
[S8] START round=19 head_norm_before_train=1.722476 (no previous merge yet)
[S8] round=19 local utility u=0.016753 metrics={'f1_val': 0.9927475182363883, 'auprc': 0.9990556919866495, 'loss_val': 0.06105113840035065, 'psi': 0.9952707877364927}-{'f1_val': 0.9933434229799246, 'auprc': 0.9908146748749793, 'loss_val': 0.07340907147352801, 'psi': 0.9923319237379465}
[S9] START round=19 head_norm_before_train=1.550559 cos_to_last_merge=0.8098 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.810
[S9] round=19 local utility u=0.026263 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9968448521093929, 'loss_val': 0.04558417254879381, 'psi': 0.9969996883510428}-{'f1_val': 0.990399656971262, 'auprc': 0.9988414585592972, 'loss_val': 0.06388022710677571, 'psi': 0.9937763776064761}
[S10] START round=19 head_norm_before_train=1.261537 cos_to_last_merge=0.6806 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.681
[S10] round=19 local utility u=0.286941 metrics={'f1_val': 0.7011968147504745, 'auprc': 0.997780775704411, 'loss_val': 0.19017758822878852, 'psi': 0.819830399132049}-{'f1_val': 0.6401572672179583, 'auprc': 0.9649591522301788, 'loss_val': 0.2993577262307488, 'psi': 0.7700780212228465}
[S11] START round=19 head_norm_before_train=1.553271 cos_to_last_merge=0.7814 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.781
[S11] round=19 local utility u=0.009410 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9979899456855897, 'loss_val': 0.09190897526440137, 'psi': 0.9969669953566094}-{'f1_val': 0.9965268648289654, 'auprc': 0.9979902155905288, 'loss_val': 0.1121813415627753, 'psi': 0.9971122051335908}
[S13] START round=19 head_norm_before_train=0.973302 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6830210805902464, 'auprc': 0.6670297131457351, 'loss_val': 0.6280817570853594, 'psi': 0.6766245336124419}-{'f1_val': 0.663993932205815, 'auprc': 0.6913574011411978, 'loss_val': 0.501686518489861, 'psi': 0.6749393197799681}
[S14] START round=19 head_norm_before_train=1.758586 (no previous merge yet)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9954275476720225, 'loss_val': 0.05867510060237457, 'psi': 0.9965152330922848}-{'f1_val': 0.9970728011695729, 'auprc': 0.996946295176099, 'loss_val': 0.05487648165235399, 'psi': 0.9970221987721833}
[S15] START round=19 head_norm_before_train=1.796473 (no previous merge yet)
[S15] round=19 local utility u=0.324481 metrics={'f1_val': 0.9026154261732742, 'auprc': 0.9979880639360388, 'loss_val': 0.12515153275605728, 'psi': 0.9407644812783801}-{'f1_val': 0.8060077517017925, 'auprc': 0.9900598115581264, 'loss_val': 0.17068209468302162, 'psi': 0.8796285756443261}
[S16] START round=19 head_norm_before_train=1.373237 cos_to_last_merge=0.7417 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.742
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8764656956857408, 'auprc': 0.9295048393732346, 'loss_val': 0.5252534626971997, 'psi': 0.8976813531607384}-{'f1_val': 0.9144807299045006, 'auprc': 0.9279350962950804, 'loss_val': 0.4116876112350943, 'psi': 0.9198624764607325}
[S17] START round=19 head_norm_before_train=1.559004 (no previous merge yet)
[S17] round=19 local utility u=0.547446 metrics={'f1_val': 0.5793784450218915, 'auprc': 0.7984764491558333, 'loss_val': 0.5101563050865136, 'psi': 0.6670176466754683}-{'f1_val': 0.41662448074534797, 'auprc': 0.7850668207439722, 'loss_val': 0.5882950838209091, 'psi': 0.5640014167447976}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S13@127.0.0.1:61813
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:61810
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:61805
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1807 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=-0.0098
[S9] DROPPED delta from S15 (cos=-0.0098 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] cosine check vs S11: cos=-0.0142
[S5] DROPPED delta from S11 (cos=-0.0142 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=-0.0091
[S8] DROPPED delta from S7 (cos=-0.0091 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1796) from S10
[S4] cosine check vs S10: cos=-0.0743
[S4] DROPPED delta from S10 (cos=-0.0743 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=-0.0548
[S15] DROPPED delta from S8 (cos=-0.0548 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1805) from S3
[S13] cosine check vs S3: cos=0.7067
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] cosine check vs S9: cos=-0.0239
[S11] DROPPED delta from S9 (cos=-0.0239 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1807) from S5
[S13] cosine check vs S5: cos=0.6942
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=-0.0741
[S11] DROPPED delta from S4 (cos=-0.0741 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=-0.0040
[S13] DROPPED delta from S17 (cos=-0.0040 < 0.0)
[S2] r=20 psi=0.627 u=0.0000 p_local=0.0813 f1=0.613 auprc=0.648 bytes=14374
[S14] r=20 psi=0.997 u=0.0000 p_local=0.0803 f1=0.997 auprc=0.995 bytes=14390
[S6] r=20 psi=0.940 u=0.0000 p_local=0.1872 f1=0.937 auprc=0.945 bytes=16182
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.6830 head_norm=1.003013
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.184220e-01
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.6891 head_norm=1.004106 delta_norm=0.118422
[S13] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S13] r=20 psi=0.677 u=0.0000 p_local=0.1105 f1=0.683 auprc=0.667 bytes=16165
[S10] r=20 psi=0.820 u=0.2869 p_local=0.1769 f1=0.701 auprc=0.998 bytes=16162
[S9] r=20 psi=0.997 u=0.0263 p_local=0.1549 f1=0.997 auprc=0.997 bytes=17968
[S4] r=20 psi=0.949 u=0.0566 p_local=0.1293 f1=0.939 auprc=0.964 bytes=17982
[S5] r=20 psi=0.818 u=0.0980 p_local=0.1151 f1=0.701 auprc=0.995 bytes=14389
[S11] r=20 psi=0.997 u=0.0094 p_local=0.1540 f1=0.996 auprc=0.998 bytes=17952
[S15] r=20 psi=0.941 u=0.3245 p_local=0.2365 f1=0.903 auprc=0.998 bytes=14367
[S3] r=20 psi=0.819 u=0.0024 p_local=0.1197 f1=0.701 auprc=0.995 bytes=16184
[S8] r=20 psi=0.995 u=0.0168 p_local=0.2072 f1=0.993 auprc=0.999 bytes=17980
[S7] r=20 psi=0.639 u=0.7574 p_local=0.3679 f1=0.556 auprc=0.765 bytes=14375
[S17] r=20 psi=0.667 u=0.5474 p_local=0.2013 f1=0.579 auprc=0.798 bytes=14384
[S16] r=20 psi=0.898 u=0.0000 p_local=0.2672 f1=0.876 auprc=0.930 bytes=14377
[S2] START round=20 head_norm_before_train=1.392620 cos_to_last_merge=0.9994 (last merge round=18)
[S2] round=20 local utility u=0.427849 metrics={'f1_val': 0.7119611706552956, 'auprc': 0.7696733733098563, 'loss_val': 0.7467566754697627, 'psi': 0.7350460517171199}-{'f1_val': 0.6130196856854545, 'auprc': 0.6481405147704755, 'loss_val': 0.6442075426179895, 'psi': 0.6270680173194629}
[S3] START round=20 head_norm_before_train=1.441816 cos_to_last_merge=0.7781 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.778
[S3] round=20 local utility u=0.002479 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9956580894662664, 'loss_val': 0.27532897115551824, 'psi': 0.8187169580276863}-{'f1_val': 0.7006809596653347, 'auprc': 0.9953384089503647, 'loss_val': 0.2788762340139401, 'psi': 0.8185439393793468}
[S4] START round=20 head_norm_before_train=1.834979 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9395023027333722, 'auprc': 0.9627181122954207, 'loss_val': 0.32218400884456727, 'psi': 0.9487886265581915}-{'f1_val': 0.9390339168445061, 'auprc': 0.9641479602388289, 'loss_val': 0.3233415068816489, 'psi': 0.9490795342022352}
[S5] START round=20 head_norm_before_train=1.387934 cos_to_last_merge=0.8210 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.821
[S5] round=20 local utility u=0.010674 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9957227635491701, 'loss_val': 0.24731735194694152, 'psi': 0.8186541410172726}-{'f1_val': 0.7006083926626743, 'auprc': 0.9946943048075356, 'loss_val': 0.26557975487438473, 'psi': 0.8182427575206188}
[S6] START round=20 head_norm_before_train=1.713460 (no previous merge yet)
[S6] round=20 local utility u=0.157343 metrics={'f1_val': 0.9603203754498881, 'auprc': 0.9596780697159758, 'loss_val': 0.2361708236319174, 'psi': 0.9600634531563232}-{'f1_val': 0.9365152591107543, 'auprc': 0.9446545178472745, 'loss_val': 0.3629546414441701, 'psi': 0.9397709626053624}
[S7] START round=20 head_norm_before_train=1.303399 cos_to_last_merge=0.8601 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.860
[S7] round=20 local utility u=0.348869 metrics={'f1_val': 0.6292121762155808, 'auprc': 0.7909509524884628, 'loss_val': 0.6089801967125107, 'psi': 0.6939076867247336}-{'f1_val': 0.5558017909458717, 'auprc': 0.7650431996352498, 'loss_val': 0.7885331367731061, 'psi': 0.639498354421623}
[S8] START round=20 head_norm_before_train=1.739326 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9904982261837202, 'auprc': 0.9869606011097118, 'loss_val': 0.0964394517935614, 'psi': 0.9890831761541168}-{'f1_val': 0.9927475182363883, 'auprc': 0.9990556919866495, 'loss_val': 0.06105113840035065, 'psi': 0.9952707877364927}
[S9] START round=20 head_norm_before_train=1.576643 cos_to_last_merge=0.8056 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.806
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9895530216146718, 'auprc': 0.9987643247566527, 'loss_val': 0.054004475593698524, 'psi': 0.9932375428714642}-{'f1_val': 0.9971029125121428, 'auprc': 0.9968448521093929, 'loss_val': 0.04558417254879381, 'psi': 0.9969996883510428}
[S10] START round=20 head_norm_before_train=1.291277 cos_to_last_merge=0.6744 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.674
[S10] round=20 local utility u=0.879634 metrics={'f1_val': 0.9949140915418154, 'auprc': 0.9966792563584059, 'loss_val': 0.18990909732673927, 'psi': 0.9956201574684516}-{'f1_val': 0.7011968147504745, 'auprc': 0.997780775704411, 'loss_val': 0.19017758822878852, 'psi': 0.819830399132049}
[S11] START round=20 head_norm_before_train=1.592470 cos_to_last_merge=0.7762 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.776
[S11] round=20 local utility u=0.005408 metrics={'f1_val': 0.9963061018870393, 'auprc': 0.9981261480844404, 'loss_val': 0.0816271328136398, 'psi': 0.9970341203659998}-{'f1_val': 0.9962850284706224, 'auprc': 0.9979899456855897, 'loss_val': 0.09190897526440137, 'psi': 0.9969669953566094}
[S13] START round=20 head_norm_before_train=1.004106 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.6288214935644817, 'auprc': 0.6747967253017942, 'loss_val': 0.6899465488551183, 'psi': 0.6472115862594068}-{'f1_val': 0.6830210805902464, 'auprc': 0.6670297131457351, 'loss_val': 0.6280817570853594, 'psi': 0.6766245336124419}
[S14] START round=20 head_norm_before_train=1.781547 (no previous merge yet)
[S14] round=20 local utility u=0.007543 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9970766813647453, 'loss_val': 0.04607445955551269, 'psi': 0.996928720641225}-{'f1_val': 0.997240356705793, 'auprc': 0.9954275476720225, 'loss_val': 0.05867510060237457, 'psi': 0.9965152330922848}
[S15] START round=20 head_norm_before_train=1.821712 (no previous merge yet)
[S15] round=20 local utility u=0.312587 metrics={'f1_val': 0.9966587743411154, 'auprc': 0.9970172792502432, 'loss_val': 0.06132494465327675, 'psi': 0.9968021763047665}-{'f1_val': 0.9026154261732742, 'auprc': 0.9979880639360388, 'loss_val': 0.12515153275605728, 'psi': 0.9407644812783801}
[S16] START round=20 head_norm_before_train=1.413914 cos_to_last_merge=0.7345 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.735
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8352940596161267, 'auprc': 0.846812786869598, 'loss_val': 0.8548895594618389, 'psi': 0.8399015505175151}-{'f1_val': 0.8764656956857408, 'auprc': 0.9295048393732346, 'loss_val': 0.5252534626971997, 'psi': 0.8976813531607384}
[S17] START round=20 head_norm_before_train=1.578760 (no previous merge yet)
[S17] round=20 local utility u=0.207108 metrics={'f1_val': 0.6208042528223863, 'auprc': 0.847211528148905, 'loss_val': 0.490699745750331, 'psi': 0.7113671629529938}-{'f1_val': 0.5793784450218915, 'auprc': 0.7984764491558333, 'loss_val': 0.5101563050865136, 'psi': 0.6670176466754683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:61804
[S15] not sending this round → trigger blocked (psi=0.997)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:61805
[S5] not sending this round → trigger blocked (psi=0.819)
[S3] not sending this round → trigger blocked (psi=0.819)
[S11] not sending this round → trigger blocked (psi=0.997)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.694)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:61808
[S14] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1806 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S14
[S7] cosine check vs S14: cos=-0.0628
[S7] DROPPED delta from S14 (cos=-0.0628 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1806) from S2
[S4] cosine check vs S2: cos=-0.0478
[S4] DROPPED delta from S2 (cos=-0.0478 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S6
[S5] cosine check vs S6: cos=-0.0280
[S5] DROPPED delta from S6 (cos=-0.0280 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.711)
[S4] ⇄ pheromone p=0.103 → S11@127.0.0.1:61812
[S11] ⇄ pheromone p=0.124 → S5@127.0.0.1:61805
[S10] ⇄ pheromone p=0.317 → S4@127.0.0.1:61804
[S9] ⇄ pheromone p=0.124 → S11@127.0.0.1:61812
[S5] ⇄ pheromone p=0.094 → S13@127.0.0.1:61813
[S13] ⇄ pheromone p=0.088 → S7@127.0.0.1:61808
[S8] ⇄ pheromone p=0.166 → S15@127.0.0.1:61815
[S7] ⇄ pheromone p=0.364 → S8@127.0.0.1:61809
[S15] ⇄ pheromone p=0.252 → S9@127.0.0.1:61810
[S3] ⇄ pheromone p=0.096 → S13@127.0.0.1:61813
[S14] ⇄ pheromone p=0.066 → S7@127.0.0.1:61808
[S2] ⇄ pheromone p=0.151 → S4@127.0.0.1:61804
[S6] ⇄ pheromone p=0.181 → S5@127.0.0.1:61805
[S17] ⇄ pheromone p=0.202 → S13@127.0.0.1:61813
[S16] ⇄ pheromone p=0.214 → S2@127.0.0.1:61802
[S2] START round=21 head_norm_before_train=1.426959 cos_to_last_merge=0.9981 (last merge round=18)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.717042480666183, 'auprc': 0.7647901181753064, 'loss_val': 0.7761547705820738, 'psi': 0.7361415356698324}-{'f1_val': 0.7119611706552956, 'auprc': 0.7696733733098563, 'loss_val': 0.7467566754697627, 'psi': 0.7350460517171199}
[S3] START round=21 head_norm_before_train=1.462487 cos_to_last_merge=0.7745 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.775
[S3] round=21 local utility u=0.002567 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9953656315157279, 'loss_val': 0.2693185245367243, 'psi': 0.8185999748474709}-{'f1_val': 0.7007562037352997, 'auprc': 0.9956580894662664, 'loss_val': 0.27532897115551824, 'psi': 0.8187169580276863}
[S4] START round=21 head_norm_before_train=1.851272 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9365152546291506, 'auprc': 0.9437886750830912, 'loss_val': 0.34404840780809093, 'psi': 0.9394246228107268}-{'f1_val': 0.9395023027333722, 'auprc': 0.9627181122954207, 'loss_val': 0.32218400884456727, 'psi': 0.9487886265581915}
[S5] START round=21 head_norm_before_train=1.415914 cos_to_last_merge=0.8155 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.815
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.7066915053029961, 'auprc': 0.8888051545482802, 'loss_val': 0.31186213505352933, 'psi': 0.7795369650011097}-{'f1_val': 0.7006083926626743, 'auprc': 0.9957227635491701, 'loss_val': 0.24731735194694152, 'psi': 0.8186541410172726}
[S6] START round=21 head_norm_before_train=1.730955 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.8405725850178889, 'auprc': 0.9530333432084539, 'loss_val': 0.484608863456384, 'psi': 0.8855568882941149}-{'f1_val': 0.9603203754498881, 'auprc': 0.9596780697159758, 'loss_val': 0.2361708236319174, 'psi': 0.9600634531563232}
[S7] START round=21 head_norm_before_train=1.314470 cos_to_last_merge=0.8575 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.857
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.48618585940223447, 'auprc': 0.7738963536949598, 'loss_val': 0.8961746170009008, 'psi': 0.6012700571193246}-{'f1_val': 0.6292121762155808, 'auprc': 0.7909509524884628, 'loss_val': 0.6089801967125107, 'psi': 0.6939076867247336}
[S8] START round=21 head_norm_before_train=1.760242 (no previous merge yet)
[S8] round=21 local utility u=0.044134 metrics={'f1_val': 0.9921626576418076, 'auprc': 0.9990495505584833, 'loss_val': 0.05442535644896784, 'psi': 0.9949174148084778}-{'f1_val': 0.9904982261837202, 'auprc': 0.9869606011097118, 'loss_val': 0.0964394517935614, 'psi': 0.9890831761541168}
[S9] START round=21 head_norm_before_train=1.600712 cos_to_last_merge=0.8021 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.802
[S9] round=21 local utility u=0.028644 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9969335512693009, 'loss_val': 0.03652275680195555, 'psi': 0.997035168015006}-{'f1_val': 0.9895530216146718, 'auprc': 0.9987643247566527, 'loss_val': 0.054004475593698524, 'psi': 0.9932375428714642}
[S10] START round=21 head_norm_before_train=1.315873 cos_to_last_merge=0.6695 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.669
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.6826309977054833, 'auprc': 0.8627831133556323, 'loss_val': 0.7581750990484943, 'psi': 0.754691843965543}-{'f1_val': 0.9949140915418154, 'auprc': 0.9966792563584059, 'loss_val': 0.18990909732673927, 'psi': 0.9956201574684516}
[S11] START round=21 head_norm_before_train=1.628340 cos_to_last_merge=0.7722 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.772
[S11] round=21 local utility u=0.006085 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981270744918288, 'loss_val': 0.06842481958126237, 'psi': 0.9969310347447171}-{'f1_val': 0.9963061018870393, 'auprc': 0.9981261480844404, 'loss_val': 0.0816271328136398, 'psi': 0.9970341203659998}
[S13] START round=21 head_norm_before_train=1.039423 cos_to_last_merge=0.9967 (last merge round=19)
[S13] round=21 local utility u=0.143074 metrics={'f1_val': 0.6617432757090685, 'auprc': 0.6677659614574132, 'loss_val': 0.5802372534775132, 'psi': 0.6641523500084063}-{'f1_val': 0.6288214935644817, 'auprc': 0.6747967253017942, 'loss_val': 0.6899465488551183, 'psi': 0.6472115862594068}
[S14] START round=21 head_norm_before_train=1.802455 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9954874513280245, 'loss_val': 0.045637314181454336, 'psi': 0.9965391945546856}-{'f1_val': 0.9968300801588782, 'auprc': 0.9970766813647453, 'loss_val': 0.04607445955551269, 'psi': 0.996928720641225}
[S15] START round=21 head_norm_before_train=1.847543 (no previous merge yet)
[S15] round=21 local utility u=0.005373 metrics={'f1_val': 0.9954167099292686, 'auprc': 0.9988750540170174, 'loss_val': 0.04869948548078409, 'psi': 0.9968000475643681}-{'f1_val': 0.9966587743411154, 'auprc': 0.9970172792502432, 'loss_val': 0.06132494465327675, 'psi': 0.9968021763047665}
[S16] START round=21 head_norm_before_train=1.454005 cos_to_last_merge=0.7279 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.728
[S16] round=21 local utility u=0.441875 metrics={'f1_val': 0.8804597080865744, 'auprc': 0.9441444083883167, 'loss_val': 0.5341279372999261, 'psi': 0.9059335882072712}-{'f1_val': 0.8352940596161267, 'auprc': 0.846812786869598, 'loss_val': 0.8548895594618389, 'psi': 0.8399015505175151}
[S17] START round=21 head_norm_before_train=1.600587 (no previous merge yet)
[S17] round=21 local utility u=0.295597 metrics={'f1_val': 0.6730666165787971, 'auprc': 0.9310313779328561, 'loss_val': 0.46453895835493075, 'psi': 0.7762525211204206}-{'f1_val': 0.6208042528223863, 'auprc': 0.847211528148905, 'loss_val': 0.490699745750331, 'psi': 0.7113671629529938}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:61802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:61805
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:61810
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1789 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S8
[S15] cosine check vs S8: cos=-0.0568
[S15] DROPPED delta from S8 (cos=-0.0568 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S3
[S13] cosine check vs S3: cos=0.6663
[S11] RECEIVED delta(kind=head bytes=1789) from S9
[S11] cosine check vs S9: cos=-0.0252
[S11] DROPPED delta from S9 (cos=-0.0252 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S13
[S7] cosine check vs S13: cos=0.0189
[S9] RECEIVED delta(kind=head bytes=1796) from S15
[S9] cosine check vs S15: cos=-0.0091
[S9] DROPPED delta from S15 (cos=-0.0091 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S11
[S5] cosine check vs S11: cos=-0.0128
[S5] DROPPED delta from S11 (cos=-0.0128 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S16
[S2] cosine check vs S16: cos=0.9721
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S17
[S13] cosine check vs S17: cos=-0.0008
[S13] DROPPED delta from S17 (cos=-0.0008 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.7170 head_norm=1.454129
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.747388e-01
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.7172 head_norm=1.462161 delta_norm=0.174739
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.4862 head_norm=1.322716
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.461351e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.4554 head_norm=0.861929 delta_norm=0.846135
[S7] aggregate: ROLLBACK (f1_val pre=0.486 post=0.455 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.6617 head_norm=1.080811
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.532476e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.6632 head_norm=1.170745 delta_norm=0.553248
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.462161 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.6244856559712271, 'auprc': 0.7606008860450559, 'loss_val': 1.025477186294944, 'psi': 0.6789317480007586}-{'f1_val': 0.717042480666183, 'auprc': 0.7647901181753064, 'loss_val': 0.7761547705820738, 'psi': 0.7361415356698324}
[S3] START round=22 head_norm_before_train=1.478276 cos_to_last_merge=0.7713 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.771
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.995328341356736, 'loss_val': 0.2695795353953674, 'psi': 0.8185850587838741}-{'f1_val': 0.7007562037352997, 'auprc': 0.9953656315157279, 'loss_val': 0.2693185245367243, 'psi': 0.8185999748474709}
[S4] START round=22 head_norm_before_train=1.867235 (no previous merge yet)
[S4] round=22 local utility u=0.087932 metrics={'f1_val': 0.9543975021137211, 'auprc': 0.9555972373617502, 'loss_val': 0.3109044481203725, 'psi': 0.9548773962129328}-{'f1_val': 0.9365152546291506, 'auprc': 0.9437886750830912, 'loss_val': 0.34404840780809093, 'psi': 0.9394246228107268}
[S5] START round=22 head_norm_before_train=1.438737 cos_to_last_merge=0.8108 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.811
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7141735531619898, 'auprc': 0.7919443874000933, 'loss_val': 0.5124226897373728, 'psi': 0.7452818868572313}-{'f1_val': 0.7066915053029961, 'auprc': 0.8888051545482802, 'loss_val': 0.31186213505352933, 'psi': 0.7795369650011097}
[S6] START round=22 head_norm_before_train=1.743038 (no previous merge yet)
[S6] round=22 local utility u=0.431801 metrics={'f1_val': 0.9402083426702348, 'auprc': 0.9623974214027944, 'loss_val': 0.24691294290381388, 'psi': 0.9490839741632586}-{'f1_val': 0.8405725850178889, 'auprc': 0.9530333432084539, 'loss_val': 0.484608863456384, 'psi': 0.8855568882941149}
[S7] START round=22 head_norm_before_train=0.861929 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.446006 metrics={'f1_val': 0.6033142270903613, 'auprc': 0.7875024188500833, 'loss_val': 0.7477506042777659, 'psi': 0.6769895037942502}-{'f1_val': 0.48618585940223447, 'auprc': 0.7738963536949598, 'loss_val': 0.8961746170009008, 'psi': 0.6012700571193246}
[S8] START round=22 head_norm_before_train=1.783177 (no previous merge yet)
[S8] round=22 local utility u=0.004141 metrics={'f1_val': 0.9936536506497753, 'auprc': 0.9962981191492359, 'loss_val': 0.0468346521623886, 'psi': 0.9947114380495595}-{'f1_val': 0.9921626576418076, 'auprc': 0.9990495505584833, 'loss_val': 0.05442535644896784, 'psi': 0.9949174148084778}
[S9] START round=22 head_norm_before_train=1.622919 cos_to_last_merge=0.7984 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.798
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9954400132154921, 'auprc': 0.9988109283665294, 'loss_val': 0.034655187112196374, 'psi': 0.996788379275907}-{'f1_val': 0.9971029125121428, 'auprc': 0.9969335512693009, 'loss_val': 0.03652275680195555, 'psi': 0.997035168015006}
[S10] START round=22 head_norm_before_train=1.339296 cos_to_last_merge=0.6651 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.665
[S10] round=22 local utility u=1.000000 metrics={'f1_val': 0.9573551604261951, 'auprc': 0.9929137853913729, 'loss_val': 0.19947147309455718, 'psi': 0.9715786104122661}-{'f1_val': 0.6826309977054833, 'auprc': 0.8627831133556323, 'loss_val': 0.7581750990484943, 'psi': 0.754691843965543}
[S11] START round=22 head_norm_before_train=1.663810 cos_to_last_merge=0.7686 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.769
[S11] round=22 local utility u=0.001083 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978897681456121, 'loss_val': 0.06554645285931779, 'psi': 0.9968361122062305}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981270744918288, 'loss_val': 0.06842481958126237, 'psi': 0.9969310347447171}
[S13] START round=22 head_norm_before_train=1.170745 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.6113446353858197, 'auprc': 0.6581927869617163, 'loss_val': 0.8167478854177826, 'psi': 0.6300838960161784}-{'f1_val': 0.6617432757090685, 'auprc': 0.6677659614574132, 'loss_val': 0.5802372534775132, 'psi': 0.6641523500084063}
[S14] START round=22 head_norm_before_train=1.820680 (no previous merge yet)
[S14] round=22 local utility u=0.007049 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9973266845742593, 'loss_val': 0.03705723665391575, 'psi': 0.9972748878531796}-{'f1_val': 0.997240356705793, 'auprc': 0.9954874513280245, 'loss_val': 0.045637314181454336, 'psi': 0.9965391945546856}
[S15] START round=22 head_norm_before_train=1.873114 (no previous merge yet)
[S15] round=22 local utility u=0.005376 metrics={'f1_val': 0.9969591438543248, 'auprc': 0.9986571568963207, 'loss_val': 0.04654870960833399, 'psi': 0.9976383490711231}-{'f1_val': 0.9954167099292686, 'auprc': 0.9988750540170174, 'loss_val': 0.04869948548078409, 'psi': 0.9968000475643681}
[S16] START round=22 head_norm_before_train=1.490773 cos_to_last_merge=0.7222 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.722
[S16] round=22 local utility u=0.019724 metrics={'f1_val': 0.8513435335219482, 'auprc': 0.9709275289714269, 'loss_val': 0.4003327389709801, 'psi': 0.8991771317017397}-{'f1_val': 0.8804597080865744, 'auprc': 0.9441444083883167, 'loss_val': 0.5341279372999261, 'psi': 0.9059335882072712}
[S17] START round=22 head_norm_before_train=1.623074 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.6370940077631388, 'auprc': 0.7286292967757775, 'loss_val': 0.6279338413766085, 'psi': 0.6737081233681943}-{'f1_val': 0.6730666165787971, 'auprc': 0.9310313779328561, 'loss_val': 0.46453895835493075, 'psi': 0.7762525211204206}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61809
[S8] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:61804
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:61808
[S15] not sending this round → trigger blocked (psi=0.998)
[S16] not sending this round → trigger blocked (psi=0.899)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:61805
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=-0.0197
[S7] DROPPED delta from S14 (cos=-0.0197 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S6
[S5] cosine check vs S6: cos=-0.0280
[S5] DROPPED delta from S6 (cos=-0.0280 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S10
[S4] cosine check vs S10: cos=-0.0688
[S4] DROPPED delta from S10 (cos=-0.0688 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=-0.0857
[S11] DROPPED delta from S4 (cos=-0.0857 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S7
[S8] cosine check vs S7: cos=-0.0572
[S8] DROPPED delta from S7 (cos=-0.0572 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=23 head_norm_before_train=1.485167 cos_to_last_merge=0.9998 (last merge round=21)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.5498822486338588, 'auprc': 0.6198014798175371, 'loss_val': 1.1362223616540883, 'psi': 0.5778499411073301}-{'f1_val': 0.6244856559712271, 'auprc': 0.7606008860450559, 'loss_val': 1.025477186294944, 'psi': 0.6789317480007586}
[S3] START round=23 head_norm_before_train=1.493651 cos_to_last_merge=0.7677 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.768
[S3] round=23 local utility u=0.002312 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9954184410491054, 'loss_val': 0.2656797742604544, 'psi': 0.8186664174349285}-{'f1_val': 0.7007562037352997, 'auprc': 0.995328341356736, 'loss_val': 0.2695795353953674, 'psi': 0.8185850587838741}
[S4] START round=23 head_norm_before_train=1.877348 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9383825476215979, 'auprc': 0.9588010628652688, 'loss_val': 0.3093195668430027, 'psi': 0.9465499537190663}-{'f1_val': 0.9543975021137211, 'auprc': 0.9555972373617502, 'loss_val': 0.3109044481203725, 'psi': 0.9548773962129328}
[S5] START round=23 head_norm_before_train=1.459191 cos_to_last_merge=0.8070 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.807
[S5] round=23 local utility u=0.045772 metrics={'f1_val': 0.7141735531619898, 'auprc': 0.7958946167190296, 'loss_val': 0.4327295902733901, 'psi': 0.7468619785848057}-{'f1_val': 0.7141735531619898, 'auprc': 0.7919443874000933, 'loss_val': 0.5124226897373728, 'psi': 0.7452818868572313}
[S6] START round=23 head_norm_before_train=1.756811 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.8588829729535181, 'auprc': 0.9563760473196932, 'loss_val': 0.38614094854775954, 'psi': 0.8978802026999881}-{'f1_val': 0.9402083426702348, 'auprc': 0.9623974214027944, 'loss_val': 0.24691294290381388, 'psi': 0.9490839741632586}
[S7] START round=23 head_norm_before_train=0.880994 cos_to_last_merge=0.9995 (last merge round=21)
[S7] round=23 local utility u=0.128564 metrics={'f1_val': 0.6286874663113409, 'auprc': 0.7969756111769839, 'loss_val': 0.6712817926071147, 'psi': 0.6960027242575981}-{'f1_val': 0.6033142270903613, 'auprc': 0.7875024188500833, 'loss_val': 0.7477506042777659, 'psi': 0.6769895037942502}
[S8] START round=23 head_norm_before_train=1.808112 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9909365638023653, 'auprc': 0.9990069554467272, 'loss_val': 0.04768904645517094, 'psi': 0.9941647204601101}-{'f1_val': 0.9936536506497753, 'auprc': 0.9962981191492359, 'loss_val': 0.0468346521623886, 'psi': 0.9947114380495595}
[S9] START round=23 head_norm_before_train=1.645473 cos_to_last_merge=0.7953 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.795
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9878532334303461, 'auprc': 0.9939176040697193, 'loss_val': 0.05496375586258562, 'psi': 0.9902789816860955}-{'f1_val': 0.9954400132154921, 'auprc': 0.9988109283665294, 'loss_val': 0.034655187112196374, 'psi': 0.996788379275907}
[S10] START round=23 head_norm_before_train=1.359498 cos_to_last_merge=0.6619 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.662
[S10] round=23 local utility u=0.159834 metrics={'f1_val': 0.9944916649516913, 'auprc': 0.9952300823409679, 'loss_val': 0.10957074967983897, 'psi': 0.9947870319074019}-{'f1_val': 0.9573551604261951, 'auprc': 0.9929137853913729, 'loss_val': 0.19947147309455718, 'psi': 0.9715786104122661}
[S11] START round=23 head_norm_before_train=1.695210 cos_to_last_merge=0.7658 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.766
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9889629007642831, 'auprc': 0.9977350915653189, 'loss_val': 0.09613164887182299, 'psi': 0.9924717770846974}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978897681456121, 'loss_val': 0.06554645285931779, 'psi': 0.9968361122062305}
[S13] START round=23 head_norm_before_train=1.199600 cos_to_last_merge=0.9971 (last merge round=21)
[S13] round=23 local utility u=0.128777 metrics={'f1_val': 0.6326951358773787, 'auprc': 0.6631734561725608, 'loss_val': 0.7022395632372889, 'psi': 0.6448864639954516}-{'f1_val': 0.6113446353858197, 'auprc': 0.6581927869617163, 'loss_val': 0.8167478854177826, 'psi': 0.6300838960161784}
[S14] START round=23 head_norm_before_train=1.840132 (no previous merge yet)
[S14] round=23 local utility u=0.000360 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969735092983094, 'loss_val': 0.03527712813354437, 'psi': 0.9971336177427996}-{'f1_val': 0.997240356705793, 'auprc': 0.9973266845742593, 'loss_val': 0.03705723665391575, 'psi': 0.9972748878531796}
[S15] START round=23 head_norm_before_train=1.894434 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.9062905389040063, 'auprc': 0.9979581238957727, 'loss_val': 0.09966644459460908, 'psi': 0.9429575729007129}-{'f1_val': 0.9969591438543248, 'auprc': 0.9986571568963207, 'loss_val': 0.04654870960833399, 'psi': 0.9976383490711231}
[S16] START round=23 head_norm_before_train=1.524380 cos_to_last_merge=0.7178 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.718
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8590753018372242, 'auprc': 0.9501029051435034, 'loss_val': 0.720941842964289, 'psi': 0.8954863431597359}-{'f1_val': 0.8513435335219482, 'auprc': 0.9709275289714269, 'loss_val': 0.4003327389709801, 'psi': 0.8991771317017397}
[S17] START round=23 head_norm_before_train=1.649497 (no previous merge yet)
[S17] round=23 local utility u=0.009790 metrics={'f1_val': 0.6238836984467818, 'auprc': 0.772968732217661, 'loss_val': 0.6621107749498938, 'psi': 0.6835177119551334}-{'f1_val': 0.6370940077631388, 'auprc': 0.7286292967757775, 'loss_val': 0.6279338413766085, 'psi': 0.6737081233681943}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61808
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:61804
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61809
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S10
[S4] cosine check vs S10: cos=-0.0668
[S4] DROPPED delta from S10 (cos=-0.0668 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S7
[S8] cosine check vs S7: cos=-0.0534
[S8] DROPPED delta from S7 (cos=-0.0534 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1805) from S5
[S13] cosine check vs S5: cos=0.4125
[S13] RECEIVED delta(kind=head bytes=1801) from S3
[S13] cosine check vs S3: cos=0.8934
[S7] RECEIVED delta(kind=head bytes=1800) from S13
[S7] cosine check vs S13: cos=0.5730
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=-0.0206
[S7] DROPPED delta from S14 (cos=-0.0206 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=0.0050
[S13] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.6327 head_norm=1.235712
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.091739e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.6321 head_norm=1.006428 delta_norm=0.409174
[S13] aggregate: ACCEPT kept=['S5', 'S3', 'S17'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.6287 head_norm=0.913225
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.166398e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.6158 head_norm=0.955807 delta_norm=0.516640
[S7] aggregate: ROLLBACK (f1_val pre=0.629 post=0.616 tol_abs=0.005 tol_rel=0.0)
[S2] START round=24 head_norm_before_train=1.504718 cos_to_last_merge=0.9995 (last merge round=21)
[S2] round=24 local utility u=0.764202 metrics={'f1_val': 0.7021652666409677, 'auprc': 0.7207059076179868, 'loss_val': 0.8242302027449424, 'psi': 0.7095815230317754}-{'f1_val': 0.5498822486338588, 'auprc': 0.6198014798175371, 'loss_val': 1.1362223616540883, 'psi': 0.5778499411073301}
[S3] START round=24 head_norm_before_train=1.510385 cos_to_last_merge=0.7655 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.765
[S3] round=24 local utility u=0.000097 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9953231507140621, 'loss_val': 0.2642942790068417, 'psi': 0.8185378360848257}-{'f1_val': 0.7008317350254774, 'auprc': 0.9954184410491054, 'loss_val': 0.2656797742604544, 'psi': 0.8186664174349285}
[S4] START round=24 head_norm_before_train=1.883906 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9376226353976016, 'auprc': 0.9487216843567748, 'loss_val': 0.35127848163858627, 'psi': 0.9420622549812709}-{'f1_val': 0.9383825476215979, 'auprc': 0.9588010628652688, 'loss_val': 0.3093195668430027, 'psi': 0.9465499537190663}
[S5] START round=24 head_norm_before_train=1.474415 cos_to_last_merge=0.8041 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.804
[S5] round=24 local utility u=0.361279 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9972279451256486, 'loss_val': 0.2310546514175425, 'psi': 0.8190835371450749}-{'f1_val': 0.7141735531619898, 'auprc': 0.7958946167190296, 'loss_val': 0.4327295902733901, 'psi': 0.7468619785848057}
[S6] START round=24 head_norm_before_train=1.771672 (no previous merge yet)
[S6] round=24 local utility u=0.398912 metrics={'f1_val': 0.9610310590589646, 'auprc': 0.9612671518572674, 'loss_val': 0.2158792006319567, 'psi': 0.9611254961782857}-{'f1_val': 0.8588829729535181, 'auprc': 0.9563760473196932, 'loss_val': 0.38614094854775954, 'psi': 0.8978802026999881}
[S7] START round=24 head_norm_before_train=0.955807 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5602927198495693, 'auprc': 0.7231672614577723, 'loss_val': 0.8971845183794637, 'psi': 0.6254425364928505}-{'f1_val': 0.6286874663113409, 'auprc': 0.7969756111769839, 'loss_val': 0.6712817926071147, 'psi': 0.6960027242575981}
[S8] START round=24 head_norm_before_train=1.832712 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9931648515513533, 'auprc': 0.9858047526562757, 'loss_val': 0.0481953452649372, 'psi': 0.9902208119933222}-{'f1_val': 0.9909365638023653, 'auprc': 0.9990069554467272, 'loss_val': 0.04768904645517094, 'psi': 0.9941647204601101}
[S9] START round=24 head_norm_before_train=1.665458 cos_to_last_merge=0.7927 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.793
[S9] round=24 local utility u=0.037949 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9932878534922489, 'loss_val': 0.030211293104130666, 'psi': 0.9953306361557569}-{'f1_val': 0.9878532334303461, 'auprc': 0.9939176040697193, 'loss_val': 0.05496375586258562, 'psi': 0.9902789816860955}
[S10] START round=24 head_norm_before_train=1.384757 cos_to_last_merge=0.6588 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.659
[S10] round=24 local utility u=0.009943 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9949415392461337, 'loss_val': 0.09380717407829604, 'psi': 0.9951704880366916}-{'f1_val': 0.9944916649516913, 'auprc': 0.9952300823409679, 'loss_val': 0.10957074967983897, 'psi': 0.9947870319074019}
[S11] START round=24 head_norm_before_train=1.722495 cos_to_last_merge=0.7634 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.763
[S11] round=24 local utility u=0.044766 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.997868420609034, 'loss_val': 0.04857236138288204, 'psi': 0.996682470964762}-{'f1_val': 0.9889629007642831, 'auprc': 0.9977350915653189, 'loss_val': 0.09613164887182299, 'psi': 0.9924717770846974}
[S13] START round=24 head_norm_before_train=1.006428 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.100595 metrics={'f1_val': 0.665366381944358, 'auprc': 0.6440838161252279, 'loss_val': 0.6398074579878508, 'psi': 0.656853355616706}-{'f1_val': 0.6326951358773787, 'auprc': 0.6631734561725608, 'loss_val': 0.7022395632372889, 'psi': 0.6448864639954516}
[S14] START round=24 head_norm_before_train=1.858544 (no previous merge yet)
[S14] round=24 local utility u=0.002812 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9976562263645996, 'loss_val': 0.03170046821611856, 'psi': 0.9974067045693157}-{'f1_val': 0.997240356705793, 'auprc': 0.9969735092983094, 'loss_val': 0.03527712813354437, 'psi': 0.9971336177427996}
[S15] START round=24 head_norm_before_train=1.913521 (no previous merge yet)
[S15] round=24 local utility u=0.306523 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9983787057495072, 'loss_val': 0.032318258289400006, 'psi': 0.9975694397507907}-{'f1_val': 0.9062905389040063, 'auprc': 0.9979581238957727, 'loss_val': 0.09966644459460908, 'psi': 0.9429575729007129}
[S16] START round=24 head_norm_before_train=1.553597 cos_to_last_merge=0.7147 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.715
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8431592913821766, 'auprc': 0.8898191489313172, 'loss_val': 0.8717307133988393, 'psi': 0.8618232344018328}-{'f1_val': 0.8590753018372242, 'auprc': 0.9501029051435034, 'loss_val': 0.720941842964289, 'psi': 0.8954863431597359}
[S17] START round=24 head_norm_before_train=1.680032 (no previous merge yet)
[S17] round=24 local utility u=0.211921 metrics={'f1_val': 0.5881579810757235, 'auprc': 0.9461034197974866, 'loss_val': 0.5433192188358281, 'psi': 0.7313361565644287}-{'f1_val': 0.6238836984467818, 'auprc': 0.772968732217661, 'loss_val': 0.6621107749498938, 'psi': 0.6835177119551334}
[S13] not sending this round → trigger blocked (psi=0.657)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S3] not sending this round → trigger blocked (psi=0.819)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:61805
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:61805
[S15] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] cosine check vs S9: cos=-0.0250
[S11] DROPPED delta from S9 (cos=-0.0250 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] cosine check vs S2: cos=-0.0510
[S4] DROPPED delta from S2 (cos=-0.0510 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] cosine check vs S11: cos=-0.0130
[S5] DROPPED delta from S11 (cos=-0.0130 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S6
[S5] cosine check vs S6: cos=-0.0277
[S5] DROPPED delta from S6 (cos=-0.0277 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=-0.0075
[S9] DROPPED delta from S15 (cos=-0.0075 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.731)
[S2] START round=25 head_norm_before_train=1.517602 cos_to_last_merge=0.9991 (last merge round=21)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6633264927175586, 'auprc': 0.7384942260527121, 'loss_val': 0.9319438474660278, 'psi': 0.69339358605162}-{'f1_val': 0.7021652666409677, 'auprc': 0.7207059076179868, 'loss_val': 0.8242302027449424, 'psi': 0.7095815230317754}
[S3] START round=25 head_norm_before_train=1.527864 cos_to_last_merge=0.7636 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.764
[S3] round=25 local utility u=0.007154 metrics={'f1_val': 0.7010108237857944, 'auprc': 0.9970765245128936, 'loss_val': 0.2572262268162274, 'psi': 0.8194371040766342}-{'f1_val': 0.7006809596653347, 'auprc': 0.9953231507140621, 'loss_val': 0.2642942790068417, 'psi': 0.8185378360848257}
[S4] START round=25 head_norm_before_train=1.888964 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9117082609444459, 'auprc': 0.9424771345905874, 'loss_val': 0.41358170572965613, 'psi': 0.9240158104029025}-{'f1_val': 0.9376226353976016, 'auprc': 0.9487216843567748, 'loss_val': 0.35127848163858627, 'psi': 0.9420622549812709}
[S5] START round=25 head_norm_before_train=1.492244 cos_to_last_merge=0.8010 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.801
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.714306097623075, 'auprc': 0.7936430413240904, 'loss_val': 0.622603751225707, 'psi': 0.746040875103481}-{'f1_val': 0.700320598491359, 'auprc': 0.9972279451256486, 'loss_val': 0.2310546514175425, 'psi': 0.8190835371450749}
[S6] START round=25 head_norm_before_train=1.788431 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.8217054104753099, 'auprc': 0.9490142768459519, 'loss_val': 0.4643002587124981, 'psi': 0.8726289570235667}-{'f1_val': 0.9610310590589646, 'auprc': 0.9612671518572674, 'loss_val': 0.2158792006319567, 'psi': 0.9611254961782857}
[S7] START round=25 head_norm_before_train=0.988407 cos_to_last_merge=0.9965 (last merge round=23)
[S7] round=25 local utility u=0.556937 metrics={'f1_val': 0.6483021982503728, 'auprc': 0.823000151947653, 'loss_val': 0.6108669436900155, 'psi': 0.7181813797292849}-{'f1_val': 0.5602927198495693, 'auprc': 0.7231672614577723, 'loss_val': 0.8971845183794637, 'psi': 0.6254425364928505}
[S8] START round=25 head_norm_before_train=1.857119 (no previous merge yet)
[S8] round=25 local utility u=0.021955 metrics={'f1_val': 0.9927378939946618, 'auprc': 0.9982952823168575, 'loss_val': 0.03919578285159139, 'psi': 0.9949608493235401}-{'f1_val': 0.9931648515513533, 'auprc': 0.9858047526562757, 'loss_val': 0.0481953452649372, 'psi': 0.9902208119933222}
[S9] START round=25 head_norm_before_train=1.680966 cos_to_last_merge=0.7906 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.791
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9908221688527771, 'auprc': 0.9957936100083362, 'loss_val': 0.042716632894295475, 'psi': 0.9928107453150008}-{'f1_val': 0.9966924912647621, 'auprc': 0.9932878534922489, 'loss_val': 0.030211293104130666, 'psi': 0.9953306361557569}
[S10] START round=25 head_norm_before_train=1.414276 cos_to_last_merge=0.6551 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.655
[S10] round=25 local utility u=0.002663 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9938275524051949, 'loss_val': 0.08513922504660854, 'psi': 0.9947248933003161}-{'f1_val': 0.9953231205637304, 'auprc': 0.9949415392461337, 'loss_val': 0.09380717407829604, 'psi': 0.9951704880366916}
[S11] START round=25 head_norm_before_train=1.746238 cos_to_last_merge=0.7613 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.761
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9899092654906836, 'auprc': 0.9982956909310764, 'loss_val': 0.06104860511802153, 'psi': 0.9932638356668407}-{'f1_val': 0.9958918378685807, 'auprc': 0.997868420609034, 'loss_val': 0.04857236138288204, 'psi': 0.996682470964762}
[S13] START round=25 head_norm_before_train=1.039717 cos_to_last_merge=0.9973 (last merge round=23)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.5905755421587014, 'auprc': 0.6828559818117106, 'loss_val': 0.8142045073622294, 'psi': 0.6274877180199051}-{'f1_val': 0.665366381944358, 'auprc': 0.6440838161252279, 'loss_val': 0.6398074579878508, 'psi': 0.656853355616706}
[S14] START round=25 head_norm_before_train=1.877151 (no previous merge yet)
[S14] round=25 local utility u=0.000920 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9969652690300426, 'loss_val': 0.030251432018109484, 'psi': 0.9973767784419292}-{'f1_val': 0.997240356705793, 'auprc': 0.9976562263645996, 'loss_val': 0.03170046821611856, 'psi': 0.9974067045693157}
[S15] START round=25 head_norm_before_train=1.934183 (no previous merge yet)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.908560796167607, 'auprc': 0.9959262091424433, 'loss_val': 0.10271599042489978, 'psi': 0.9435069613575415}-{'f1_val': 0.9970299290849798, 'auprc': 0.9983787057495072, 'loss_val': 0.032318258289400006, 'psi': 0.9975694397507907}
[S16] START round=25 head_norm_before_train=1.579927 cos_to_last_merge=0.7118 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.712
[S16] round=25 local utility u=0.963913 metrics={'f1_val': 0.9824121980207495, 'auprc': 0.9925531191814957, 'loss_val': 0.08762474995164152, 'psi': 0.986468566485048}-{'f1_val': 0.8431592913821766, 'auprc': 0.8898191489313172, 'loss_val': 0.8717307133988393, 'psi': 0.8618232344018328}
[S17] START round=25 head_norm_before_train=1.711066 (no previous merge yet)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.5796433598654294, 'auprc': 0.9011288551354495, 'loss_val': 0.6408499123896729, 'psi': 0.7082375579734375}-{'f1_val': 0.5881579810757235, 'auprc': 0.9461034197974866, 'loss_val': 0.5433192188358281, 'psi': 0.7313361565644287}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:61804
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:61802
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S16
[S2] cosine check vs S16: cos=0.9814
[S8] RECEIVED delta(kind=head bytes=1795) from S7
[S8] cosine check vs S7: cos=-0.0700
[S8] DROPPED delta from S7 (cos=-0.0700 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S8
[S15] cosine check vs S8: cos=-0.0615
[S15] DROPPED delta from S8 (cos=-0.0615 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.0052
[S4] RECEIVED delta(kind=head bytes=1795) from S10
[S4] cosine check vs S10: cos=-0.0640
[S4] DROPPED delta from S10 (cos=-0.0640 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S3
[S13] cosine check vs S3: cos=0.7830
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.095 → S13@127.0.0.1:61813
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.5906 head_norm=1.065769
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.855522e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.5908 head_norm=1.234580 delta_norm=0.485552
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.073 → S7@127.0.0.1:61808
[S6] ⇄ pheromone p=0.167 → S5@127.0.0.1:61805
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=25 metric=0.6633 head_norm=1.527685
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.556496e-01
[S2] stored merged vector for next round verification (round=25)
[S2] DEBUG after merge:  round=25 metric=0.6672 head_norm=1.558517 delta_norm=0.155650
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.172 → S4@127.0.0.1:61804
[S4] ⇄ pheromone p=0.043 → S11@127.0.0.1:61812
[S9] ⇄ pheromone p=0.049 → S11@127.0.0.1:61812
[S11] ⇄ pheromone p=0.048 → S5@127.0.0.1:61805
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.6483 head_norm=1.037732
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.076219e+00
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.6771 head_norm=1.080960 delta_norm=1.076219
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.293 → S8@127.0.0.1:61809
[S8] ⇄ pheromone p=0.063 → S15@127.0.0.1:61815
[S14] ⇄ pheromone p=0.023 → S7@127.0.0.1:61808
[S10] ⇄ pheromone p=0.229 → S4@127.0.0.1:61804
[S16] ⇄ pheromone p=0.301 → S2@127.0.0.1:61802
[S3] ⇄ pheromone p=0.033 → S13@127.0.0.1:61813
[S15] ⇄ pheromone p=0.133 → S9@127.0.0.1:61810
[S17] ⇄ pheromone p=0.126 → S13@127.0.0.1:61813
[S2] START round=26 head_norm_before_train=1.558517 cos_to_last_merge=1.0000 (last merge round=25)
[S2] round=26 local utility u=0.181159 metrics={'f1_val': 0.7137124013059197, 'auprc': 0.7246338758448926, 'loss_val': 0.8303609638051433, 'psi': 0.7180809911215089}-{'f1_val': 0.6633264927175586, 'auprc': 0.7384942260527121, 'loss_val': 0.9319438474660278, 'psi': 0.69339358605162}
[S3] START round=26 head_norm_before_train=1.544033 cos_to_last_merge=0.7619 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.762
[S3] round=26 local utility u=0.016988 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9971458685669945, 'loss_val': 0.22193066789895657, 'psi': 0.8193120696679776}-{'f1_val': 0.7010108237857944, 'auprc': 0.9970765245128936, 'loss_val': 0.2572262268162274, 'psi': 0.8194371040766342}
[S4] START round=26 head_norm_before_train=1.892908 (no previous merge yet)
[S4] round=26 local utility u=0.084447 metrics={'f1_val': 0.934746480833684, 'auprc': 0.9422094701445554, 'loss_val': 0.3821144626840505, 'psi': 0.9377316765580326}-{'f1_val': 0.9117082609444459, 'auprc': 0.9424771345905874, 'loss_val': 0.41358170572965613, 'psi': 0.9240158104029025}
[S5] START round=26 head_norm_before_train=1.503310 cos_to_last_merge=0.7989 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.799
[S5] round=26 local utility u=0.483512 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9974057650682189, 'loss_val': 0.1829545492077199, 'psi': 0.8191546651221029}-{'f1_val': 0.714306097623075, 'auprc': 0.7936430413240904, 'loss_val': 0.622603751225707, 'psi': 0.746040875103481}
[S6] START round=26 head_norm_before_train=1.804432 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.6576751249857969, 'auprc': 0.9338610090414583, 'loss_val': 0.7171997013533421, 'psi': 0.7681494786080616}-{'f1_val': 0.8217054104753099, 'auprc': 0.9490142768459519, 'loss_val': 0.4643002587124981, 'psi': 0.8726289570235667}
[S7] START round=26 head_norm_before_train=1.080960 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.6317820245796992, 'auprc': 0.8008841914984816, 'loss_val': 0.8165302900792204, 'psi': 0.6994228913472121}-{'f1_val': 0.6483021982503728, 'auprc': 0.823000151947653, 'loss_val': 0.6108669436900155, 'psi': 0.7181813797292849}
[S8] START round=26 head_norm_before_train=1.877372 (no previous merge yet)
[S8] round=26 local utility u=0.001760 metrics={'f1_val': 0.9940197241108746, 'auprc': 0.9964415796580484, 'loss_val': 0.0378059375514808, 'psi': 0.994988466329744}-{'f1_val': 0.9927378939946618, 'auprc': 0.9982952823168575, 'loss_val': 0.03919578285159139, 'psi': 0.9949608493235401}
[S9] START round=26 head_norm_before_train=1.695319 cos_to_last_merge=0.7888 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.789
[S9] round=26 local utility u=0.020557 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9988017432146314, 'loss_val': 0.03083273920185086, 'psi': 0.9960345211361922}-{'f1_val': 0.9908221688527771, 'auprc': 0.9957936100083362, 'loss_val': 0.042716632894295475, 'psi': 0.9928107453150008}
[S10] START round=26 head_norm_before_train=1.440650 cos_to_last_merge=0.6522 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.652
[S10] round=26 local utility u=0.005059 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9935159262470997, 'loss_val': 0.0766216692549334, 'psi': 0.9948537069458863}-{'f1_val': 0.9953231205637304, 'auprc': 0.9938275524051949, 'loss_val': 0.08513922504660854, 'psi': 0.9947248933003161}
[S11] START round=26 head_norm_before_train=1.766282 cos_to_last_merge=0.7587 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.759
[S11] round=26 local utility u=0.029011 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981072015846708, 'loss_val': 0.03980660123442367, 'psi': 0.9969230855818539}-{'f1_val': 0.9899092654906836, 'auprc': 0.9982956909310764, 'loss_val': 0.06104860511802153, 'psi': 0.9932638356668407}
[S13] START round=26 head_norm_before_train=1.234580 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.143945 metrics={'f1_val': 0.6342416852451483, 'auprc': 0.6545002208154161, 'loss_val': 0.7032442110189728, 'psi': 0.6423450994732555}-{'f1_val': 0.5905755421587014, 'auprc': 0.6828559818117106, 'loss_val': 0.8142045073622294, 'psi': 0.6274877180199051}
[S14] START round=26 head_norm_before_train=1.891178 (no previous merge yet)
[S14] round=26 local utility u=0.002144 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.997287070915738, 'loss_val': 0.0293955890177279, 'psi': 0.997752248275503}-{'f1_val': 0.9976511180498535, 'auprc': 0.9969652690300426, 'loss_val': 0.030251432018109484, 'psi': 0.9973767784419292}
[S15] START round=26 head_norm_before_train=1.954330 (no previous merge yet)
[S15] round=26 local utility u=0.154261 metrics={'f1_val': 0.9532543072573596, 'auprc': 0.9975222601024393, 'loss_val': 0.06714300845266845, 'psi': 0.9709614883953914}-{'f1_val': 0.908560796167607, 'auprc': 0.9959262091424433, 'loss_val': 0.10271599042489978, 'psi': 0.9435069613575415}
[S16] START round=26 head_norm_before_train=1.603928 cos_to_last_merge=0.7097 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.710
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.9769971063446706, 'auprc': 0.9901398638746467, 'loss_val': 0.09218123173960037, 'psi': 0.9822542093566611}-{'f1_val': 0.9824121980207495, 'auprc': 0.9925531191814957, 'loss_val': 0.08762474995164152, 'psi': 0.986468566485048}
[S17] START round=26 head_norm_before_train=1.737719 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.4862324391788039, 'auprc': 0.6688559464730393, 'loss_val': 1.0378734127267348, 'psi': 0.559281842096498}-{'f1_val': 0.5796433598654294, 'auprc': 0.9011288551354495, 'loss_val': 0.6408499123896729, 'psi': 0.7082375579734375}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:61804
[S8] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:61805
[S3] not sending this round → trigger blocked (psi=0.819)
[S10] not sending this round → trigger blocked (psi=0.995)
[S14] not sending this round → trigger blocked (psi=0.998)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:61813
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61812
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] cosine check vs S13: cos=0.4122
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=-0.0959
[S11] DROPPED delta from S4 (cos=-0.0959 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S15
[S9] cosine check vs S15: cos=-0.0066
[S9] DROPPED delta from S15 (cos=-0.0066 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] cosine check vs S11: cos=-0.0123
[S5] DROPPED delta from S11 (cos=-0.0123 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] cosine check vs S2: cos=-0.0511
[S4] DROPPED delta from S2 (cos=-0.0511 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S9
[S11] cosine check vs S9: cos=-0.0260
[S11] DROPPED delta from S9 (cos=-0.0260 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1794) from S5
[S13] cosine check vs S5: cos=0.2820
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.6318 head_norm=1.110989
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.443933e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.6002 head_norm=0.995117 delta_norm=0.644393
[S7] aggregate: ROLLBACK (f1_val pre=0.632 post=0.600 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.6342 head_norm=1.255669
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.341234e-01
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.6419 head_norm=1.108920 delta_norm=0.834123
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.571229 cos_to_last_merge=1.0000 (last merge round=25)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6396208967509392, 'auprc': 0.724741891160461, 'loss_val': 1.0503768076269888, 'psi': 0.673669294514748}-{'f1_val': 0.7137124013059197, 'auprc': 0.7246338758448926, 'loss_val': 0.8303609638051433, 'psi': 0.7180809911215089}
[S3] START round=27 head_norm_before_train=1.557304 cos_to_last_merge=0.7597 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.760
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.7003512381127298, 'auprc': 0.9981026756231091, 'loss_val': 0.2389257116816176, 'psi': 0.8194518131168815}-{'f1_val': 0.7007562037352997, 'auprc': 0.9971458685669945, 'loss_val': 0.22193066789895657, 'psi': 0.8193120696679776}
[S4] START round=27 head_norm_before_train=1.896105 (no previous merge yet)
[S4] round=27 local utility u=0.017011 metrics={'f1_val': 0.9371238744633152, 'auprc': 0.9417058427310376, 'loss_val': 0.36084639439854227, 'psi': 0.9389566617704042}-{'f1_val': 0.934746480833684, 'auprc': 0.9422094701445554, 'loss_val': 0.3821144626840505, 'psi': 0.9377316765580326}
[S5] START round=27 head_norm_before_train=1.508055 cos_to_last_merge=0.7978 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.798
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.7143049231465757, 'auprc': 0.7951319114216091, 'loss_val': 0.417400716182046, 'psi': 0.746635718456589}-{'f1_val': 0.700320598491359, 'auprc': 0.9974057650682189, 'loss_val': 0.1829545492077199, 'psi': 0.8191546651221029}
[S6] START round=27 head_norm_before_train=1.818664 (no previous merge yet)
[S6] round=27 local utility u=0.993891 metrics={'f1_val': 0.9086913666556865, 'auprc': 0.9475858196527783, 'loss_val': 0.2766886853140318, 'psi': 0.9242491478545233}-{'f1_val': 0.6576751249857969, 'auprc': 0.9338610090414583, 'loss_val': 0.7171997013533421, 'psi': 0.7681494786080616}
[S7] START round=27 head_norm_before_train=0.995117 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.5727930624769287, 'auprc': 0.6604363044831896, 'loss_val': 0.9048060721677889, 'psi': 0.6078503592794331}-{'f1_val': 0.6317820245796992, 'auprc': 0.8008841914984816, 'loss_val': 0.8165302900792204, 'psi': 0.6994228913472121}
[S8] START round=27 head_norm_before_train=1.893881 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9927378939946618, 'auprc': 0.9988210466187987, 'loss_val': 0.03726736746235993, 'psi': 0.9951711550443165}-{'f1_val': 0.9940197241108746, 'auprc': 0.9964415796580484, 'loss_val': 0.0378059375514808, 'psi': 0.994988466329744}
[S9] START round=27 head_norm_before_train=1.708825 cos_to_last_merge=0.7872 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.787
[S9] round=27 local utility u=0.009419 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.997440320873338, 'loss_val': 0.02539049778247895, 'psi': 0.9972378758566209}-{'f1_val': 0.9941897064172326, 'auprc': 0.9988017432146314, 'loss_val': 0.03083273920185086, 'psi': 0.9960345211361922}
[S10] START round=27 head_norm_before_train=1.468867 cos_to_last_merge=0.6490 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.649
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9944916649516913, 'auprc': 0.9923608802194659, 'loss_val': 0.06951554592441207, 'psi': 0.9936393510588011}-{'f1_val': 0.9957455607450773, 'auprc': 0.9935159262470997, 'loss_val': 0.0766216692549334, 'psi': 0.9948537069458863}
[S11] START round=27 head_norm_before_train=1.784520 cos_to_last_merge=0.7567 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.757
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9956519930682886, 'auprc': 0.9982222486698473, 'loss_val': 0.039451084513183736, 'psi': 0.9966800953089121}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981072015846708, 'loss_val': 0.03980660123442367, 'psi': 0.9969230855818539}
[S13] START round=27 head_norm_before_train=1.108920 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6034390574053783, 'auprc': 0.6828073546459037, 'loss_val': 0.7719780023174191, 'psi': 0.6351863763015885}-{'f1_val': 0.6342416852451483, 'auprc': 0.6545002208154161, 'loss_val': 0.7032442110189728, 'psi': 0.6423450994732555}
[S14] START round=27 head_norm_before_train=1.906327 (no previous merge yet)
[S14] round=27 local utility u=0.000731 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9979147254318437, 'loss_val': 0.027348107363650474, 'psi': 0.9977565610026496}-{'f1_val': 0.9980623665153463, 'auprc': 0.997287070915738, 'loss_val': 0.0293955890177279, 'psi': 0.997752248275503}
[S15] START round=27 head_norm_before_train=1.972905 (no previous merge yet)
[S15] round=27 local utility u=0.156162 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.999296307193783, 'loss_val': 0.02331812326737586, 'psi': 0.9979888749943733}-{'f1_val': 0.9532543072573596, 'auprc': 0.9975222601024393, 'loss_val': 0.06714300845266845, 'psi': 0.9709614883953914}
[S16] START round=27 head_norm_before_train=1.623930 cos_to_last_merge=0.7087 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.709
[S16] round=27 local utility u=0.048271 metrics={'f1_val': 0.9891201829290821, 'auprc': 0.9909980256077183, 'loss_val': 0.07095293981074192, 'psi': 0.9898713200005366}-{'f1_val': 0.9769971063446706, 'auprc': 0.9901398638746467, 'loss_val': 0.09218123173960037, 'psi': 0.9822542093566611}
[S17] START round=27 head_norm_before_train=1.762399 (no previous merge yet)
[S17] round=27 local utility u=0.756711 metrics={'f1_val': 0.5820043215199723, 'auprc': 0.901115535921736, 'loss_val': 0.7958619335052689, 'psi': 0.7096488072806777}-{'f1_val': 0.4862324391788039, 'auprc': 0.6688559464730393, 'loss_val': 1.0378734127267348, 'psi': 0.559281842096498}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:61805
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.997)
[S4] not sending this round → trigger blocked (psi=0.939)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.998)
[S6] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.4775
[S5] RECEIVED delta(kind=head bytes=1800) from S6
[S5] cosine check vs S6: cos=-0.0283
[S5] DROPPED delta from S6 (cos=-0.0283 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S16
[S2] cosine check vs S16: cos=0.9928
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1806 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1806) from S17
[S13] cosine check vs S17: cos=0.0624
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.5728 head_norm=1.027526
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.464594e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6189 head_norm=1.288323 delta_norm=0.846459
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.6034 head_norm=1.143569
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.029327e+00
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.5851 head_norm=1.089432 delta_norm=1.029327
[S13] aggregate: ROLLBACK (f1_val pre=0.603 post=0.585 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.6396 head_norm=1.586492
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.010781e-01
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.6407 head_norm=1.612440 delta_norm=0.101078
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.612440 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.6370305664724873, 'auprc': 0.7127275749042716, 'loss_val': 1.0592105044567308, 'psi': 0.6673093698452011}-{'f1_val': 0.6396208967509392, 'auprc': 0.724741891160461, 'loss_val': 1.0503768076269888, 'psi': 0.673669294514748}
[S3] START round=28 head_norm_before_train=1.571420 cos_to_last_merge=0.7582 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.758
[S3] round=28 local utility u=0.006569 metrics={'f1_val': 0.7009355793019081, 'auprc': 0.9985260968198829, 'loss_val': 0.23056366779858106, 'psi': 0.8199717863090981}-{'f1_val': 0.7003512381127298, 'auprc': 0.9981026756231091, 'loss_val': 0.2389257116816176, 'psi': 0.8194518131168815}
[S4] START round=28 head_norm_before_train=1.901192 (no previous merge yet)
[S4] round=28 local utility u=0.061554 metrics={'f1_val': 0.9398571140218519, 'auprc': 0.9614134731252316, 'loss_val': 0.31326155237064235, 'psi': 0.9484796576632037}-{'f1_val': 0.9371238744633152, 'auprc': 0.9417058427310376, 'loss_val': 0.36084639439854227, 'psi': 0.9389566617704042}
[S5] START round=28 head_norm_before_train=1.510280 cos_to_last_merge=0.7972 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.797
[S5] round=28 local utility u=1.000000 metrics={'f1_val': 0.9083501074385794, 'auprc': 0.9975107821278619, 'loss_val': 0.14082633112740112, 'psi': 0.9440143773142924}-{'f1_val': 0.7143049231465757, 'auprc': 0.7951319114216091, 'loss_val': 0.417400716182046, 'psi': 0.746635718456589}
[S6] START round=28 head_norm_before_train=1.827547 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6069603898706043, 'auprc': 0.9319823372330944, 'loss_val': 0.862061431115854, 'psi': 0.7369691688156004}-{'f1_val': 0.9086913666556865, 'auprc': 0.9475858196527783, 'loss_val': 0.2766886853140318, 'psi': 0.9242491478545233}
[S7] START round=28 head_norm_before_train=1.288323 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.290533 metrics={'f1_val': 0.6268176583308851, 'auprc': 0.730060388269745, 'loss_val': 0.8567601865104797, 'psi': 0.6681147503064291}-{'f1_val': 0.5727930624769287, 'auprc': 0.6604363044831896, 'loss_val': 0.9048060721677889, 'psi': 0.6078503592794331}
[S8] START round=28 head_norm_before_train=1.911898 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9940123495215525, 'auprc': 0.9956865926691179, 'loss_val': 0.03743927674825963, 'psi': 0.9946820467805786}-{'f1_val': 0.9927378939946618, 'auprc': 0.9988210466187987, 'loss_val': 0.03726736746235993, 'psi': 0.9951711550443165}
[S9] START round=28 head_norm_before_train=1.721780 cos_to_last_merge=0.7860 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.786
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9987968113871579, 'loss_val': 0.026463860314059662, 'psi': 0.9972813419931068}-{'f1_val': 0.9971029125121428, 'auprc': 0.997440320873338, 'loss_val': 0.02539049778247895, 'psi': 0.9972378758566209}
[S10] START round=28 head_norm_before_train=1.498701 cos_to_last_merge=0.6456 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.646
[S10] round=28 local utility u=0.013541 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9955102888842533, 'loss_val': 0.059405317257004105, 'psi': 0.9956514520007476}-{'f1_val': 0.9944916649516913, 'auprc': 0.9923608802194659, 'loss_val': 0.06951554592441207, 'psi': 0.9936393510588011}
[S11] START round=28 head_norm_before_train=1.800033 cos_to_last_merge=0.7542 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.754
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9979497985881345, 'loss_val': 0.048249582855500676, 'psi': 0.9968601243832393}-{'f1_val': 0.9956519930682886, 'auprc': 0.9982222486698473, 'loss_val': 0.039451084513183736, 'psi': 0.9966800953089121}
[S13] START round=28 head_norm_before_train=1.089432 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.095269 metrics={'f1_val': 0.6272605482393511, 'auprc': 0.6993806364149175, 'loss_val': 0.7740892336120335, 'psi': 0.6561085835095777}-{'f1_val': 0.6034390574053783, 'auprc': 0.6828073546459037, 'loss_val': 0.7719780023174191, 'psi': 0.6351863763015885}
[S14] START round=28 head_norm_before_train=1.922688 (no previous merge yet)
[S14] round=28 local utility u=0.000011 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9986598137593783, 'loss_val': 0.027096094817798278, 'psi': 0.9978081395272271}-{'f1_val': 0.9976511180498535, 'auprc': 0.9979147254318437, 'loss_val': 0.027348107363650474, 'psi': 0.9977565610026496}
[S15] START round=28 head_norm_before_train=1.990972 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.9890719333561755, 'auprc': 0.99860893547944, 'loss_val': 0.04623533786141638, 'psi': 0.9928867342054812}-{'f1_val': 0.9971172535281002, 'auprc': 0.999296307193783, 'loss_val': 0.02331812326737586, 'psi': 0.9979888749943733}
[S16] START round=28 head_norm_before_train=1.644202 cos_to_last_merge=0.7077 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.708
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8418396518337332, 'auprc': 0.9886595458809373, 'loss_val': 0.4526072220758971, 'psi': 0.9005676094526149}-{'f1_val': 0.9891201829290821, 'auprc': 0.9909980256077183, 'loss_val': 0.07095293981074192, 'psi': 0.9898713200005366}
[S17] START round=28 head_norm_before_train=1.784656 (no previous merge yet)
[S17] round=28 local utility u=0.108564 metrics={'f1_val': 0.5846973842384255, 'auprc': 0.9694510333239593, 'loss_val': 0.7998978375920142, 'psi': 0.7385988438726391}-{'f1_val': 0.5820043215199723, 'auprc': 0.901115535921736, 'loss_val': 0.7958619335052689, 'psi': 0.7096488072806777}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:61809
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:61808
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61812
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=-0.0612
[S4] DROPPED delta from S10 (cos=-0.0612 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1793) from S7
[S8] cosine check vs S7: cos=-0.0401
[S8] DROPPED delta from S7 (cos=-0.0401 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S3
[S13] cosine check vs S3: cos=0.3037
[S13] RECEIVED delta(kind=head bytes=1803) from S5
[S13] cosine check vs S5: cos=0.4722
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=-0.0994
[S11] DROPPED delta from S4 (cos=-0.0994 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S13
[S7] cosine check vs S13: cos=0.1570
[S17] not sending this round → trigger blocked (psi=0.739)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.6273 head_norm=1.112499
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.358483e-01
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.6307 head_norm=0.975738 delta_norm=0.535848
[S13] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.6268 head_norm=1.312689
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.909350e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.5823 head_norm=0.924568 delta_norm=0.790935
[S7] aggregate: ROLLBACK (f1_val pre=0.627 post=0.582 tol_abs=0.005 tol_rel=0.0)
[S2] START round=29 head_norm_before_train=1.626489 cos_to_last_merge=0.9999 (last merge round=27)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.6350971817700655, 'auprc': 0.6781777965364646, 'loss_val': 1.0792623588987909, 'psi': 0.6523294276766252}-{'f1_val': 0.6370305664724873, 'auprc': 0.7127275749042716, 'loss_val': 1.0592105044567308, 'psi': 0.6673093698452011}
[S3] START round=29 head_norm_before_train=1.582247 cos_to_last_merge=0.7570 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.757
[S3] round=29 local utility u=0.696489 metrics={'f1_val': 0.9202569748955776, 'auprc': 0.9988682120922565, 'loss_val': 0.1545405809920819, 'psi': 0.9517014697742491}-{'f1_val': 0.7009355793019081, 'auprc': 0.9985260968198829, 'loss_val': 0.23056366779858106, 'psi': 0.8199717863090981}
[S4] START round=29 head_norm_before_train=1.909080 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9373029092620069, 'auprc': 0.9466525146697862, 'loss_val': 0.3284826062826429, 'psi': 0.9410427514251186}-{'f1_val': 0.9398571140218519, 'auprc': 0.9614134731252316, 'loss_val': 0.31326155237064235, 'psi': 0.9484796576632037}
[S5] START round=29 head_norm_before_train=1.513976 cos_to_last_merge=0.7966 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.797
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7143712450552575, 'auprc': 0.7939992578160342, 'loss_val': 0.4609200244825815, 'psi': 0.7462224501595682}-{'f1_val': 0.9083501074385794, 'auprc': 0.9975107821278619, 'loss_val': 0.14082633112740112, 'psi': 0.9440143773142924}
[S6] START round=29 head_norm_before_train=1.834687 (no previous merge yet)
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.9637198255809097, 'auprc': 0.9633897725723163, 'loss_val': 0.1552263448432284, 'psi': 0.9635878043774724}-{'f1_val': 0.6069603898706043, 'auprc': 0.9319823372330944, 'loss_val': 0.862061431115854, 'psi': 0.7369691688156004}
[S7] START round=29 head_norm_before_train=0.924568 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.135092 metrics={'f1_val': 0.6491905809226753, 'auprc': 0.7672647269766929, 'loss_val': 0.8324261048745707, 'psi': 0.6964202393442824}-{'f1_val': 0.6268176583308851, 'auprc': 0.730060388269745, 'loss_val': 0.8567601865104797, 'psi': 0.6681147503064291}
[S8] START round=29 head_norm_before_train=1.925390 (no previous merge yet)
[S8] round=29 local utility u=0.000682 metrics={'f1_val': 0.9927378939946618, 'auprc': 0.9986542664678738, 'loss_val': 0.03733075150304628, 'psi': 0.9951044429839466}-{'f1_val': 0.9940123495215525, 'auprc': 0.9956865926691179, 'loss_val': 0.03743927674825963, 'psi': 0.9946820467805786}
[S9] START round=29 head_norm_before_train=1.733044 cos_to_last_merge=0.7851 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.785
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9988025872260327, 'loss_val': 0.029185052413778452, 'psi': 0.9960348587407526}-{'f1_val': 0.9962710290637395, 'auprc': 0.9987968113871579, 'loss_val': 0.026463860314059662, 'psi': 0.9972813419931068}
[S10] START round=29 head_norm_before_train=1.525932 cos_to_last_merge=0.6426 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.643
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9935753796918921, 'loss_val': 0.055337206560796014, 'psi': 0.9948774883238032}-{'f1_val': 0.9957455607450773, 'auprc': 0.9955102888842533, 'loss_val': 0.059405317257004105, 'psi': 0.9956514520007476}
[S11] START round=29 head_norm_before_train=1.814483 cos_to_last_merge=0.7525 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.753
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9977831917305551, 'loss_val': 0.049869939551664126, 'psi': 0.9967934816402076}-{'f1_val': 0.9961336749133093, 'auprc': 0.9979497985881345, 'loss_val': 0.048249582855500676, 'psi': 0.9968601243832393}
[S13] START round=29 head_norm_before_train=0.975738 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.6119849034630727, 'auprc': 0.6821186543202578, 'loss_val': 0.7579944580228644, 'psi': 0.6400384038059467}-{'f1_val': 0.6272605482393511, 'auprc': 0.6993806364149175, 'loss_val': 0.7740892336120335, 'psi': 0.6561085835095777}
[S14] START round=29 head_norm_before_train=1.937854 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9968768960459942, 'loss_val': 0.026348173345724247, 'psi': 0.9973414292483098}-{'f1_val': 0.997240356705793, 'auprc': 0.9986598137593783, 'loss_val': 0.027096094817798278, 'psi': 0.9978081395272271}
[S15] START round=29 head_norm_before_train=2.007978 (no previous merge yet)
[S15] round=29 local utility u=0.017023 metrics={'f1_val': 0.9962438818154523, 'auprc': 0.996457913506506, 'loss_val': 0.04876835022413282, 'psi': 0.9963294944918738}-{'f1_val': 0.9890719333561755, 'auprc': 0.99860893547944, 'loss_val': 0.04623533786141638, 'psi': 0.9928867342054812}
[S16] START round=29 head_norm_before_train=1.664059 cos_to_last_merge=0.7066 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.707
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8515242514007767, 'auprc': 0.9889680694937768, 'loss_val': 0.866641800619407, 'psi': 0.9065017786379768}-{'f1_val': 0.8418396518337332, 'auprc': 0.9886595458809373, 'loss_val': 0.4526072220758971, 'psi': 0.9005676094526149}
[S17] START round=29 head_norm_before_train=1.804063 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5771372614929491, 'auprc': 0.7529069240021349, 'loss_val': 1.1068770697364607, 'psi': 0.6474451264966234}-{'f1_val': 0.5846973842384255, 'auprc': 0.9694510333239593, 'loss_val': 0.7998978375920142, 'psi': 0.7385988438726391}
[S7] not sending this round → trigger blocked (psi=0.696)
[S3] not sending this round → trigger blocked (psi=0.952)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:61805
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1807 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=-0.0663
[S15] DROPPED delta from S8 (cos=-0.0663 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1807) from S6
[S5] cosine check vs S6: cos=-0.0283
[S5] DROPPED delta from S6 (cos=-0.0283 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S15
[S9] cosine check vs S15: cos=-0.0046
[S9] DROPPED delta from S15 (cos=-0.0046 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=30 head_norm_before_train=1.644918 cos_to_last_merge=0.9997 (last merge round=27)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.6067557294474355, 'auprc': 0.6562811153274751, 'loss_val': 1.2363113520492035, 'psi': 0.6265658837994513}-{'f1_val': 0.6350971817700655, 'auprc': 0.6781777965364646, 'loss_val': 1.0792623588987909, 'psi': 0.6523294276766252}
[S3] START round=30 head_norm_before_train=1.591098 cos_to_last_merge=0.7559 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.756
[S3] round=30 local utility u=0.012905 metrics={'f1_val': 0.925509206165209, 'auprc': 0.9985125673239725, 'loss_val': 0.159177417574458, 'psi': 0.9547105506287145}-{'f1_val': 0.9202569748955776, 'auprc': 0.9988682120922565, 'loss_val': 0.1545405809920819, 'psi': 0.9517014697742491}
[S4] START round=30 head_norm_before_train=1.918187 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9365043609618672, 'auprc': 0.9417924415564703, 'loss_val': 0.32453094575766106, 'psi': 0.9386195931997084}-{'f1_val': 0.9373029092620069, 'auprc': 0.9466525146697862, 'loss_val': 0.3284826062826429, 'psi': 0.9410427514251186}
[S5] START round=30 head_norm_before_train=1.518144 cos_to_last_merge=0.7957 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.796
[S5] round=30 local utility u=0.404564 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9977793733880045, 'loss_val': 0.18055563826604357, 'psi': 0.8194767849528064}-{'f1_val': 0.7143712450552575, 'auprc': 0.7939992578160342, 'loss_val': 0.4609200244825815, 'psi': 0.7462224501595682}
[S6] START round=30 head_norm_before_train=1.841875 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.62850088083739, 'auprc': 0.9460699520833116, 'loss_val': 0.7322890074483569, 'psi': 0.7555285093357587}-{'f1_val': 0.9637198255809097, 'auprc': 0.9633897725723163, 'loss_val': 0.1552263448432284, 'psi': 0.9635878043774724}
[S7] START round=30 head_norm_before_train=0.951914 cos_to_last_merge=0.9924 (last merge round=28)
[S7] round=30 local utility u=0.092473 metrics={'f1_val': 0.6516736652478998, 'auprc': 0.7751111212723704, 'loss_val': 0.6859183875961447, 'psi': 0.701048647657688}-{'f1_val': 0.6491905809226753, 'auprc': 0.7672647269766929, 'loss_val': 0.8324261048745707, 'psi': 0.6964202393442824}
[S8] START round=30 head_norm_before_train=1.936108 (no previous merge yet)
[S8] round=30 local utility u=0.002125 metrics={'f1_val': 0.9931022471969293, 'auprc': 0.9989186094894174, 'loss_val': 0.036060523616335265, 'psi': 0.9954287921139244}-{'f1_val': 0.9927378939946618, 'auprc': 0.9986542664678738, 'loss_val': 0.03733075150304628, 'psi': 0.9951044429839466}
[S9] START round=30 head_norm_before_train=1.743950 cos_to_last_merge=0.7839 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.784
[S9] round=30 local utility u=0.008386 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9967217553615092, 'loss_val': 0.023649320112879495, 'psi': 0.9969504496518894}-{'f1_val': 0.9941897064172326, 'auprc': 0.9988025872260327, 'loss_val': 0.029185052413778452, 'psi': 0.9960348587407526}
[S10] START round=30 head_norm_before_train=1.549826 cos_to_last_merge=0.6402 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.640
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9944916649516913, 'auprc': 0.9922844717838779, 'loss_val': 0.05435282332190757, 'psi': 0.993608787684566}-{'f1_val': 0.9957455607450773, 'auprc': 0.9935753796918921, 'loss_val': 0.055337206560796014, 'psi': 0.9948774883238032}
[S11] START round=30 head_norm_before_train=1.831322 cos_to_last_merge=0.7512 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.751
[S11] round=30 local utility u=0.006779 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9979540530451629, 'loss_val': 0.03682540942413921, 'psi': 0.9968618261660508}-{'f1_val': 0.9961336749133093, 'auprc': 0.9977831917305551, 'loss_val': 0.049869939551664126, 'psi': 0.9967934816402076}
[S13] START round=30 head_norm_before_train=1.017472 cos_to_last_merge=0.9964 (last merge round=28)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6082548240707488, 'auprc': 0.688255803270624, 'loss_val': 0.7647393200544539, 'psi': 0.6402552157506989}-{'f1_val': 0.6119849034630727, 'auprc': 0.6821186543202578, 'loss_val': 0.7579944580228644, 'psi': 0.6400384038059467}
[S14] START round=30 head_norm_before_train=1.950108 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9959874237039671, 'auprc': 0.9969712707505372, 'loss_val': 0.03147357024260845, 'psi': 0.9963809625225952}-{'f1_val': 0.9976511180498535, 'auprc': 0.9968768960459942, 'loss_val': 0.026348173345724247, 'psi': 0.9973414292483098}
[S15] START round=30 head_norm_before_train=2.021877 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.9031776131021474, 'auprc': 0.9979565230027412, 'loss_val': 0.15406520613644215, 'psi': 0.9410891770623849}-{'f1_val': 0.9962438818154523, 'auprc': 0.996457913506506, 'loss_val': 0.04876835022413282, 'psi': 0.9963294944918738}
[S16] START round=30 head_norm_before_train=1.682198 cos_to_last_merge=0.7058 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.706
[S16] round=30 local utility u=0.207964 metrics={'f1_val': 0.8818383251236998, 'auprc': 0.9854011385628402, 'loss_val': 0.6218978915952381, 'psi': 0.923263450499356}-{'f1_val': 0.8515242514007767, 'auprc': 0.9889680694937768, 'loss_val': 0.866641800619407, 'psi': 0.9065017786379768}
[S17] START round=30 head_norm_before_train=1.823133 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.5789782821126864, 'auprc': 0.7602142453688153, 'loss_val': 1.1780275829357536, 'psi': 0.6514726674151381}-{'f1_val': 0.5771372614929491, 'auprc': 0.7529069240021349, 'loss_val': 1.1068770697364607, 'psi': 0.6474451264966234}
[S8] not sending this round → trigger blocked (psi=0.995)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:61805
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1805) from S11
[S5] cosine check vs S11: cos=-0.0106
[S5] DROPPED delta from S11 (cos=-0.0106 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S16
[S2] cosine check vs S16: cos=0.9953
[S8] RECEIVED delta(kind=head bytes=1796) from S7
[S8] cosine check vs S7: cos=-0.0233
[S8] DROPPED delta from S7 (cos=-0.0233 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S9
[S11] cosine check vs S9: cos=-0.0252
[S11] DROPPED delta from S9 (cos=-0.0252 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S3
[S13] cosine check vs S3: cos=0.5729
[S13] RECEIVED delta(kind=head bytes=1799) from S5
[S13] cosine check vs S5: cos=0.6870
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.008 → S7@127.0.0.1:61808
[S6] ⇄ pheromone p=0.317 → S5@127.0.0.1:61805
[S8] ⇄ pheromone p=0.021 → S15@127.0.0.1:61815
[S10] ⇄ pheromone p=0.077 → S4@127.0.0.1:61804
[S4] ⇄ pheromone p=0.031 → S11@127.0.0.1:61812
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=30 metric=0.6068 head_norm=1.667413
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.287460e-02
[S2] stored merged vector for next round verification (round=30)
[S2] DEBUG after merge:  round=30 metric=0.6060 head_norm=1.680686 delta_norm=0.082875
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.071 → S4@127.0.0.1:61804
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=30 metric=0.6083 head_norm=1.055394
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.757522e-01
[S13] stored merged vector for next round verification (round=30)
[S13] DEBUG after merge:  round=30 metric=0.6087 head_norm=1.055478 delta_norm=0.275752
[S13] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.048 → S7@127.0.0.1:61808
[S7] ⇄ pheromone p=0.173 → S8@127.0.0.1:61809
[S5] ⇄ pheromone p=0.279 → S13@127.0.0.1:61813
[S9] ⇄ pheromone p=0.020 → S11@127.0.0.1:61812
[S16] ⇄ pheromone p=0.145 → S2@127.0.0.1:61802
[S11] ⇄ pheromone p=0.020 → S5@127.0.0.1:61805
[S3] ⇄ pheromone p=0.127 → S13@127.0.0.1:61813
[S17] ⇄ pheromone p=0.133 → S13@127.0.0.1:61813
[S15] ⇄ pheromone p=0.075 → S9@127.0.0.1:61810
[S2] START round=31 head_norm_before_train=1.680686 cos_to_last_merge=1.0000 (last merge round=30)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.554850500365316, 'auprc': 0.6524998953327005, 'loss_val': 1.3986616658255269, 'psi': 0.5939102583522697}-{'f1_val': 0.6067557294474355, 'auprc': 0.6562811153274751, 'loss_val': 1.2363113520492035, 'psi': 0.6265658837994513}
[S3] START round=31 head_norm_before_train=1.607548 cos_to_last_merge=0.7548 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.755
[S3] round=31 local utility u=0.250661 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9987242282152642, 'loss_val': 0.09229536765376947, 'psi': 0.9981757118466814}-{'f1_val': 0.925509206165209, 'auprc': 0.9985125673239725, 'loss_val': 0.159177417574458, 'psi': 0.9547105506287145}
[S4] START round=31 head_norm_before_train=1.918803 (no previous merge yet)
[S4] round=31 local utility u=0.069165 metrics={'f1_val': 0.9418470489968054, 'auprc': 0.9680438109174303, 'loss_val': 0.29701163428154337, 'psi': 0.9523257537650553}-{'f1_val': 0.9365043609618672, 'auprc': 0.9417924415564703, 'loss_val': 0.32453094575766106, 'psi': 0.9386195931997084}
[S5] START round=31 head_norm_before_train=1.522651 cos_to_last_merge=0.7948 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.795
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7143712450552575, 'auprc': 0.8405316773208265, 'loss_val': 0.37242787017530704, 'psi': 0.7648354179614851}-{'f1_val': 0.7006083926626743, 'auprc': 0.9977793733880045, 'loss_val': 0.18055563826604357, 'psi': 0.8194767849528064}
[S6] START round=31 head_norm_before_train=1.848770 (no previous merge yet)
[S6] round=31 local utility u=0.928826 metrics={'f1_val': 0.8673424450365699, 'auprc': 0.9642988462385415, 'loss_val': 0.362373319198307, 'psi': 0.9061250055173585}-{'f1_val': 0.62850088083739, 'auprc': 0.9460699520833116, 'loss_val': 0.7322890074483569, 'psi': 0.7555285093357587}
[S7] START round=31 head_norm_before_train=0.997196 cos_to_last_merge=0.9716 (last merge round=28)
[S7] round=31 local utility u=0.241958 metrics={'f1_val': 0.6814651523267499, 'auprc': 0.8293988164751418, 'loss_val': 0.5436149385460449, 'psi': 0.7406386179861066}-{'f1_val': 0.6516736652478998, 'auprc': 0.7751111212723704, 'loss_val': 0.6859183875961447, 'psi': 0.701048647657688}
[S8] START round=31 head_norm_before_train=1.949526 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.7139758603458082, 'auprc': 0.9760480523768164, 'loss_val': 0.638799915480859, 'psi': 0.8188047371582114}-{'f1_val': 0.9931022471969293, 'auprc': 0.9989186094894174, 'loss_val': 0.036060523616335265, 'psi': 0.9954287921139244}
[S9] START round=31 head_norm_before_train=1.756315 cos_to_last_merge=0.7827 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.783
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9952712799396866, 'loss_val': 0.023649650674017912, 'psi': 0.9963702594831603}-{'f1_val': 0.9971029125121428, 'auprc': 0.9967217553615092, 'loss_val': 0.023649320112879495, 'psi': 0.9969504496518894}
[S10] START round=31 head_norm_before_train=1.573282 cos_to_last_merge=0.6378 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.638
[S10] round=31 local utility u=0.002066 metrics={'f1_val': 0.9944916649516913, 'auprc': 0.9923580516890675, 'loss_val': 0.050441714520341366, 'psi': 0.9936382196466418}-{'f1_val': 0.9944916649516913, 'auprc': 0.9922844717838779, 'loss_val': 0.05435282332190757, 'psi': 0.993608787684566}
[S11] START round=31 head_norm_before_train=1.849497 cos_to_last_merge=0.7499 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.750
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9733612070122191, 'auprc': 0.9977581265776144, 'loss_val': 0.11300020778135529, 'psi': 0.9831199748383772}-{'f1_val': 0.9961336749133093, 'auprc': 0.9979540530451629, 'loss_val': 0.03682540942413921, 'psi': 0.9968618261660508}
[S13] START round=31 head_norm_before_train=1.055478 cos_to_last_merge=1.0000 (last merge round=30)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6075595980630802, 'auprc': 0.6767246922149994, 'loss_val': 0.7856149107869049, 'psi': 0.6352256357238479}-{'f1_val': 0.6082548240707488, 'auprc': 0.688255803270624, 'loss_val': 0.7647393200544539, 'psi': 0.6402552157506989}
[S14] START round=31 head_norm_before_train=1.962010 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9722560477198628, 'auprc': 0.9969373608069592, 'loss_val': 0.05296952381143547, 'psi': 0.9821285729547014}-{'f1_val': 0.9959874237039671, 'auprc': 0.9969712707505372, 'loss_val': 0.03147357024260845, 'psi': 0.9963809625225952}
[S15] START round=31 head_norm_before_train=2.033457 (no previous merge yet)
[S15] round=31 local utility u=0.349887 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9987244726343192, 'loss_val': 0.02023358453609934, 'psi': 0.9977601411705878}-{'f1_val': 0.9031776131021474, 'auprc': 0.9979565230027412, 'loss_val': 0.15406520613644215, 'psi': 0.9410891770623849}
[S16] START round=31 head_norm_before_train=1.697905 cos_to_last_merge=0.7051 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.705
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8350870840222622, 'auprc': 0.9700469067239754, 'loss_val': 0.621042489365329, 'psi': 0.8890710131029476}-{'f1_val': 0.8818383251236998, 'auprc': 0.9854011385628402, 'loss_val': 0.6218978915952381, 'psi': 0.923263450499356}
[S17] START round=31 head_norm_before_train=1.842039 (no previous merge yet)
[S17] round=31 local utility u=0.273229 metrics={'f1_val': 0.5925053694373837, 'auprc': 0.8668329193737702, 'loss_val': 1.0325883231194568, 'psi': 0.7022363894119383}-{'f1_val': 0.5789782821126864, 'auprc': 0.7602142453688153, 'loss_val': 1.1780275829357536, 'psi': 0.6514726674151381}
[S7] not sending this round → trigger blocked (psi=0.741)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:61805
[S3] not sending this round → trigger blocked (psi=0.998)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:61804
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1805) from S6
[S5] cosine check vs S6: cos=-0.0290
[S5] DROPPED delta from S6 (cos=-0.0290 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1794) from S10
[S4] cosine check vs S10: cos=-0.0573
[S4] DROPPED delta from S10 (cos=-0.0573 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=-0.1049
[S11] DROPPED delta from S4 (cos=-0.1049 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S15
[S9] cosine check vs S15: cos=-0.0040
[S9] DROPPED delta from S15 (cos=-0.0040 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=0.2211
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=31 metric=0.6076 head_norm=1.090504
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.686017e-01
[S13] stored merged vector for next round verification (round=31)
[S13] DEBUG after merge:  round=31 metric=0.5927 head_norm=1.177543 delta_norm=0.968602
[S13] aggregate: ROLLBACK (f1_val pre=0.608 post=0.593 tol_abs=0.005 tol_rel=0.0)
[S2] START round=32 head_norm_before_train=1.697921 cos_to_last_merge=0.9999 (last merge round=30)
[S2] round=32 local utility u=0.187863 metrics={'f1_val': 0.5976568898447423, 'auprc': 0.6595452938968271, 'loss_val': 1.3009093092486603, 'psi': 0.6224122514655762}-{'f1_val': 0.554850500365316, 'auprc': 0.6524998953327005, 'loss_val': 1.3986616658255269, 'psi': 0.5939102583522697}
[S3] START round=32 head_norm_before_train=1.629168 cos_to_last_merge=0.7532 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.753
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.959640262947856, 'auprc': 0.9989009333468071, 'loss_val': 0.1307188289723891, 'psi': 0.9753445311074365}-{'f1_val': 0.9978100342676263, 'auprc': 0.9987242282152642, 'loss_val': 0.09229536765376947, 'psi': 0.9981757118466814}
[S4] START round=32 head_norm_before_train=1.923585 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9394712124086543, 'auprc': 0.9548617753203825, 'loss_val': 0.3136572797953356, 'psi': 0.9456274375733456}-{'f1_val': 0.9418470489968054, 'auprc': 0.9680438109174303, 'loss_val': 0.29701163428154337, 'psi': 0.9523257537650553}
[S5] START round=32 head_norm_before_train=1.526066 cos_to_last_merge=0.7940 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.794
[S5] round=32 local utility u=0.127317 metrics={'f1_val': 0.7144364317802219, 'auprc': 0.9157510300445545, 'loss_val': 0.34384219830706253, 'psi': 0.794962271085955}-{'f1_val': 0.7143712450552575, 'auprc': 0.8405316773208265, 'loss_val': 0.37242787017530704, 'psi': 0.7648354179614851}
[S6] START round=32 head_norm_before_train=1.855396 (no previous merge yet)
[S6] round=32 local utility u=0.098152 metrics={'f1_val': 0.8834728446123157, 'auprc': 0.9674722941444345, 'loss_val': 0.2723711655702907, 'psi': 0.9170726244251632}-{'f1_val': 0.8673424450365699, 'auprc': 0.9642988462385415, 'loss_val': 0.362373319198307, 'psi': 0.9061250055173585}
[S7] START round=32 head_norm_before_train=1.047730 cos_to_last_merge=0.9469 (last merge round=28)
[S7] ⚠️ Model drifted since last merge! cos=0.947
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5726240980083475, 'auprc': 0.7847270900221055, 'loss_val': 0.766703374805599, 'psi': 0.6574652948138506}-{'f1_val': 0.6814651523267499, 'auprc': 0.8293988164751418, 'loss_val': 0.5436149385460449, 'psi': 0.7406386179861066}
[S8] START round=32 head_norm_before_train=1.957195 (no previous merge yet)
[S8] round=32 local utility u=1.000000 metrics={'f1_val': 0.9580688370844459, 'auprc': 0.9990732112851178, 'loss_val': 0.10447779417342778, 'psi': 0.9744705867647148}-{'f1_val': 0.7139758603458082, 'auprc': 0.9760480523768164, 'loss_val': 0.638799915480859, 'psi': 0.8188047371582114}
[S9] START round=32 head_norm_before_train=1.768149 cos_to_last_merge=0.7812 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.781
[S9] round=32 local utility u=0.005671 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9986985905959493, 'loss_val': 0.022590466428727134, 'psi': 0.9977411837456654}-{'f1_val': 0.9971029125121428, 'auprc': 0.9952712799396866, 'loss_val': 0.023649650674017912, 'psi': 0.9963702594831603}
[S10] START round=32 head_norm_before_train=1.596551 cos_to_last_merge=0.6354 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.635
[S10] round=32 local utility u=0.008753 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9950995407162938, 'loss_val': 0.04483169076363501, 'psi': 0.9951018971321764}-{'f1_val': 0.9944916649516913, 'auprc': 0.9923580516890675, 'loss_val': 0.050441714520341366, 'psi': 0.9936382196466418}
[S11] START round=32 head_norm_before_train=1.865211 cos_to_last_merge=0.7486 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.749
[S11] round=32 local utility u=0.105714 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9977965886758848, 'loss_val': 0.03832324272229753, 'psi': 0.9967988404183395}-{'f1_val': 0.9733612070122191, 'auprc': 0.9977581265776144, 'loss_val': 0.11300020778135529, 'psi': 0.9831199748383772}
[S13] START round=32 head_norm_before_train=1.177543 cos_to_last_merge=1.0000 (last merge round=31)
[S13] round=32 local utility u=0.041571 metrics={'f1_val': 0.6121061058542738, 'auprc': 0.680482241635618, 'loss_val': 0.7410247533287823, 'psi': 0.6394565601668115}-{'f1_val': 0.6075595980630802, 'auprc': 0.6767246922149994, 'loss_val': 0.7856149107869049, 'psi': 0.6352256357238479}
[S14] START round=32 head_norm_before_train=1.972597 (no previous merge yet)
[S14] round=32 local utility u=0.092253 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.997353393200349, 'loss_val': 0.024549404479942687, 'psi': 0.9977787771893474}-{'f1_val': 0.9722560477198628, 'auprc': 0.9969373608069592, 'loss_val': 0.05296952381143547, 'psi': 0.9821285729547014}
[S15] START round=32 head_norm_before_train=2.044420 (no previous merge yet)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.9036003573672852, 'auprc': 0.9979951377357357, 'loss_val': 0.1170717833517162, 'psi': 0.9413582695146654}-{'f1_val': 0.9971172535281002, 'auprc': 0.9987244726343192, 'loss_val': 0.02023358453609934, 'psi': 0.9977601411705878}
[S16] START round=32 head_norm_before_train=1.710952 cos_to_last_merge=0.7051 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.705
[S16] round=32 local utility u=0.800098 metrics={'f1_val': 0.9922158355346136, 'auprc': 0.9958881980606361, 'loss_val': 0.04114319147104396, 'psi': 0.9936847805450226}-{'f1_val': 0.8350870840222622, 'auprc': 0.9700469067239754, 'loss_val': 0.621042489365329, 'psi': 0.8890710131029476}
[S17] START round=32 head_norm_before_train=1.860214 (no previous merge yet)
[S17] round=32 local utility u=0.312898 metrics={'f1_val': 0.5966076226772178, 'auprc': 0.9985848366680488, 'loss_val': 0.8266622957435205, 'psi': 0.7573985082735502}-{'f1_val': 0.5925053694373837, 'auprc': 0.8668329193737702, 'loss_val': 1.0325883231194568, 'psi': 0.7022363894119383}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:61804
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.917)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61808
[S2] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S5
[S13] cosine check vs S5: cos=0.3629
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] cosine check vs S9: cos=-0.0252
[S11] DROPPED delta from S9 (cos=-0.0252 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=0.5720
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.5886
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] cosine check vs S2: cos=-0.0535
[S4] DROPPED delta from S2 (cos=-0.0535 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] cosine check vs S11: cos=-0.0100
[S5] DROPPED delta from S11 (cos=-0.0100 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1805) from S16
[S2] cosine check vs S16: cos=0.9975
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=-0.0662
[S15] DROPPED delta from S8 (cos=-0.0662 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.757)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.5726 head_norm=1.091105
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.536377e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.5747 head_norm=1.065735 delta_norm=0.353638
[S7] aggregate: ACCEPT kept=['S13', 'S14'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.6121 head_norm=1.201040
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.826195e-01
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.6270 head_norm=1.131060 delta_norm=0.782619
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=32 metric=0.5977 head_norm=1.709949
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.062486e-02
[S2] stored merged vector for next round verification (round=32)
[S2] DEBUG after merge:  round=32 metric=0.5981 head_norm=1.714552 delta_norm=0.060625
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.714552 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.5818758562497502, 'auprc': 0.6567822337466841, 'loss_val': 1.2741076003606637, 'psi': 0.6118384072485238}-{'f1_val': 0.5976568898447423, 'auprc': 0.6595452938968271, 'loss_val': 1.3009093092486603, 'psi': 0.6224122514655762}
[S3] START round=33 head_norm_before_train=1.655762 cos_to_last_merge=0.7515 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.752
[S3] round=33 local utility u=0.148086 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9988839727018658, 'loss_val': 0.061044255392647497, 'psi': 0.9979925305483808}-{'f1_val': 0.959640262947856, 'auprc': 0.9989009333468071, 'loss_val': 0.1307188289723891, 'psi': 0.9753445311074365}
[S4] START round=33 head_norm_before_train=1.928734 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.930671351002447, 'auprc': 0.9488682355804596, 'loss_val': 0.38892550750623345, 'psi': 0.937950104833652}-{'f1_val': 0.9394712124086543, 'auprc': 0.9548617753203825, 'loss_val': 0.3136572797953356, 'psi': 0.9456274375733456}
[S5] START round=33 head_norm_before_train=1.530059 cos_to_last_merge=0.7931 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.793
[S5] round=33 local utility u=1.000000 metrics={'f1_val': 0.9951172740136609, 'auprc': 0.9980561185708856, 'loss_val': 0.12070187453343055, 'psi': 0.9962928118365508}-{'f1_val': 0.7144364317802219, 'auprc': 0.9157510300445545, 'loss_val': 0.34384219830706253, 'psi': 0.794962271085955}
[S6] START round=33 head_norm_before_train=1.860169 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.6771607475361208, 'auprc': 0.9524436039544767, 'loss_val': 0.7442614655154091, 'psi': 0.7872738901034632}-{'f1_val': 0.8834728446123157, 'auprc': 0.9674722941444345, 'loss_val': 0.2723711655702907, 'psi': 0.9170726244251632}
[S7] START round=33 head_norm_before_train=1.065735 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.362988 metrics={'f1_val': 0.6659335396123048, 'auprc': 0.7997996878341992, 'loss_val': 0.6458015062432314, 'psi': 0.7194799989010625}-{'f1_val': 0.5726240980083475, 'auprc': 0.7847270900221055, 'loss_val': 0.766703374805599, 'psi': 0.6574652948138506}
[S8] START round=33 head_norm_before_train=1.961026 (no previous merge yet)
[S8] round=33 local utility u=0.115362 metrics={'f1_val': 0.9929205408612032, 'auprc': 0.9867829948123757, 'loss_val': 0.04599322146359893, 'psi': 0.9904655224416722}-{'f1_val': 0.9580688370844459, 'auprc': 0.9990732112851178, 'loss_val': 0.10447779417342778, 'psi': 0.9744705867647148}
[S9] START round=33 head_norm_before_train=1.779819 cos_to_last_merge=0.7799 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.780
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9988033802592056, 'loss_val': 0.026818909900090202, 'psi': 0.9960351759540218}-{'f1_val': 0.9971029125121428, 'auprc': 0.9986985905959493, 'loss_val': 0.022590466428727134, 'psi': 0.9977411837456654}
[S10] START round=33 head_norm_before_train=1.618217 cos_to_last_merge=0.6332 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.633
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.993524144292747, 'loss_val': 0.04292303616153809, 'psi': 0.9944717385627577}-{'f1_val': 0.9951034680760983, 'auprc': 0.9950995407162938, 'loss_val': 0.04483169076363501, 'psi': 0.9951018971321764}
[S11] START round=33 head_norm_before_train=1.878860 cos_to_last_merge=0.7474 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.747
[S11] round=33 local utility u=0.006627 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981450335827919, 'loss_val': 0.028595142118723528, 'psi': 0.9971862161412706}-{'f1_val': 0.9961336749133093, 'auprc': 0.9977965886758848, 'loss_val': 0.03832324272229753, 'psi': 0.9967988404183395}
[S13] START round=33 head_norm_before_train=1.131060 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5893941856154107, 'auprc': 0.6829961915604197, 'loss_val': 0.8139431445514428, 'psi': 0.6268349879934143}-{'f1_val': 0.6121061058542738, 'auprc': 0.680482241635618, 'loss_val': 0.7410247533287823, 'psi': 0.6394565601668115}
[S14] START round=33 head_norm_before_train=1.980524 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9991277218397997, 'loss_val': 0.024988059546083543, 'psi': 0.9977491368312468}-{'f1_val': 0.9980623665153463, 'auprc': 0.997353393200349, 'loss_val': 0.024549404479942687, 'psi': 0.9977787771893474}
[S15] START round=33 head_norm_before_train=2.054681 (no previous merge yet)
[S15] round=33 local utility u=0.321908 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9978443608916278, 'loss_val': 0.03168166385500205, 'psi': 0.9971857453891635}-{'f1_val': 0.9036003573672852, 'auprc': 0.9979951377357357, 'loss_val': 0.1170717833517162, 'psi': 0.9413582695146654}
[S16] START round=33 head_norm_before_train=1.721280 cos_to_last_merge=0.7053 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.705
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8485534491787189, 'auprc': 0.9285718346797456, 'loss_val': 1.0026321413873116, 'psi': 0.8805608033791296}-{'f1_val': 0.9922158355346136, 'auprc': 0.9958881980606361, 'loss_val': 0.04114319147104396, 'psi': 0.9936847805450226}
[S17] START round=33 head_norm_before_train=1.879252 (no previous merge yet)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.5872865257697067, 'auprc': 0.8326962118801438, 'loss_val': 1.1418313550658865, 'psi': 0.6854504002138816}-{'f1_val': 0.5966076226772178, 'auprc': 0.9985848366680488, 'loss_val': 0.8266622957435205, 'psi': 0.7573985082735502}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61809
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:61810
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.990)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S15
[S9] cosine check vs S15: cos=-0.0032
[S9] DROPPED delta from S15 (cos=-0.0032 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=-0.0155
[S8] DROPPED delta from S7 (cos=-0.0155 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S3
[S13] cosine check vs S3: cos=0.1954
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.5894 head_norm=1.163383
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.248973e-01
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.5873 head_norm=1.112716 delta_norm=0.924897
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.725526 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=34 local utility u=0.133102 metrics={'f1_val': 0.6144500313079992, 'auprc': 0.6724364531232702, 'loss_val': 1.2503121104412969, 'psi': 0.6376446000341076}-{'f1_val': 0.5818758562497502, 'auprc': 0.6567822337466841, 'loss_val': 1.2741076003606637, 'psi': 0.6118384072485238}
[S3] START round=34 head_norm_before_train=1.683354 cos_to_last_merge=0.7496 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.750
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.983004208656469, 'auprc': 0.9990621161356882, 'loss_val': 0.06800702557393763, 'psi': 0.9894273716481566}-{'f1_val': 0.9973982357793907, 'auprc': 0.9988839727018658, 'loss_val': 0.061044255392647497, 'psi': 0.9979925305483808}
[S4] START round=34 head_norm_before_train=1.934866 (no previous merge yet)
[S4] round=34 local utility u=0.053799 metrics={'f1_val': 0.9388473517716055, 'auprc': 0.9511545691916419, 'loss_val': 0.3372423793556311, 'psi': 0.9437702387396201}-{'f1_val': 0.930671351002447, 'auprc': 0.9488682355804596, 'loss_val': 0.38892550750623345, 'psi': 0.937950104833652}
[S5] START round=34 head_norm_before_train=1.533424 cos_to_last_merge=0.7922 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.792
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.7144364317802219, 'auprc': 0.9915110169246799, 'loss_val': 0.244058281680193, 'psi': 0.825266265838005}-{'f1_val': 0.9951172740136609, 'auprc': 0.9980561185708856, 'loss_val': 0.12070187453343055, 'psi': 0.9962928118365508}
[S6] START round=34 head_norm_before_train=1.864557 (no previous merge yet)
[S6] round=34 local utility u=0.547566 metrics={'f1_val': 0.8147766561612049, 'auprc': 0.9552042034011378, 'loss_val': 0.48310695513245305, 'psi': 0.8709476750571781}-{'f1_val': 0.6771607475361208, 'auprc': 0.9524436039544767, 'loss_val': 0.7442614655154091, 'psi': 0.7872738901034632}
[S7] START round=34 head_norm_before_train=1.095279 cos_to_last_merge=0.9982 (last merge round=32)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5815685235987462, 'auprc': 0.7858279060951259, 'loss_val': 0.7708763470607375, 'psi': 0.663272276597298}-{'f1_val': 0.6659335396123048, 'auprc': 0.7997996878341992, 'loss_val': 0.6458015062432314, 'psi': 0.7194799989010625}
[S8] START round=34 head_norm_before_train=1.966437 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9839092979549603, 'auprc': 0.9989263377609783, 'loss_val': 0.05392124079226555, 'psi': 0.9899161138773674}-{'f1_val': 0.9929205408612032, 'auprc': 0.9867829948123757, 'loss_val': 0.04599322146359893, 'psi': 0.9904655224416722}
[S9] START round=34 head_norm_before_train=1.790706 cos_to_last_merge=0.7789 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.779
[S9] round=34 local utility u=0.000273 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9924172854655913, 'loss_val': 0.02213210365735704, 'psi': 0.9949824089450938}-{'f1_val': 0.9941897064172326, 'auprc': 0.9988033802592056, 'loss_val': 0.026818909900090202, 'psi': 0.9960351759540218}
[S10] START round=34 head_norm_before_train=1.637518 cos_to_last_merge=0.6314 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.631
[S10] round=34 local utility u=0.000281 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.992930111570637, 'loss_val': 0.0418971961883361, 'psi': 0.994365916966493}-{'f1_val': 0.9951034680760983, 'auprc': 0.993524144292747, 'loss_val': 0.04292303616153809, 'psi': 0.9944717385627577}
[S11] START round=34 head_norm_before_train=1.892806 cos_to_last_merge=0.7463 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.746
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998483011046025, 'loss_val': 0.028262772543606676, 'psi': 0.9970734093663955}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981450335827919, 'loss_val': 0.028595142118723528, 'psi': 0.9971862161412706}
[S13] START round=34 head_norm_before_train=1.112716 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.072114 metrics={'f1_val': 0.6088870453705274, 'auprc': 0.6654841220899681, 'loss_val': 0.7341357095243707, 'psi': 0.6315258760583037}-{'f1_val': 0.5893941856154107, 'auprc': 0.6829961915604197, 'loss_val': 0.8139431445514428, 'psi': 0.6268349879934143}
[S14] START round=34 head_norm_before_train=1.989441 (no previous merge yet)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9969752954841031, 'loss_val': 0.029242797816130234, 'psi': 0.9967424571600915}-{'f1_val': 0.9968300801588782, 'auprc': 0.9991277218397997, 'loss_val': 0.024988059546083543, 'psi': 0.9977491368312468}
[S15] START round=34 head_norm_before_train=2.064359 (no previous merge yet)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.9571746326116914, 'auprc': 0.997843400394623, 'loss_val': 0.061196774068240686, 'psi': 0.973442139724864}-{'f1_val': 0.9967466683875206, 'auprc': 0.9978443608916278, 'loss_val': 0.03168166385500205, 'psi': 0.9971857453891635}
[S16] START round=34 head_norm_before_train=1.732714 cos_to_last_merge=0.7052 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.705
[S16] round=34 local utility u=0.240016 metrics={'f1_val': 0.8660373324884834, 'auprc': 0.9886175615928421, 'loss_val': 0.8076409915952865, 'psi': 0.9150694241302268}-{'f1_val': 0.8485534491787189, 'auprc': 0.9285718346797456, 'loss_val': 1.0026321413873116, 'psi': 0.8805608033791296}
[S17] START round=34 head_norm_before_train=1.891725 (no previous merge yet)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6015694921758068, 'auprc': 0.7909103186246281, 'loss_val': 1.2030892571599159, 'psi': 0.6773058227553354}-{'f1_val': 0.5872865257697067, 'auprc': 0.8326962118801438, 'loss_val': 1.1418313550658865, 'psi': 0.6854504002138816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:61805
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61812
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:61802
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:61804
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S9
[S11] cosine check vs S9: cos=-0.0241
[S11] DROPPED delta from S9 (cos=-0.0241 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=-0.1083
[S11] DROPPED delta from S4 (cos=-0.1083 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S16
[S2] cosine check vs S16: cos=0.9987
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] cosine check vs S13: cos=0.5071
[S4] RECEIVED delta(kind=head bytes=1797) from S10
[S4] cosine check vs S10: cos=-0.0557
[S4] DROPPED delta from S10 (cos=-0.0557 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S6
[S5] cosine check vs S6: cos=-0.0327
[S5] DROPPED delta from S6 (cos=-0.0327 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] cosine check vs S2: cos=-0.0511
[S4] DROPPED delta from S2 (cos=-0.0511 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.5816 head_norm=1.128746
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.622407e-01
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.5720 head_norm=0.983152 delta_norm=0.562241
[S7] aggregate: ROLLBACK (f1_val pre=0.582 post=0.572 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=34 metric=0.6145 head_norm=1.734594
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.544576e-02
[S2] stored merged vector for next round verification (round=34)
[S2] DEBUG after merge:  round=34 metric=0.6153 head_norm=1.739185 delta_norm=0.045446
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.739185 cos_to_last_merge=1.0000 (last merge round=34)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.5986983842605746, 'auprc': 0.6835307052810824, 'loss_val': 1.3112097931461133, 'psi': 0.6326313126687777}-{'f1_val': 0.6144500313079992, 'auprc': 0.6724364531232702, 'loss_val': 1.2503121104412969, 'psi': 0.6376446000341076}
[S3] START round=35 head_norm_before_train=1.709550 cos_to_last_merge=0.7480 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.748
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9654335934562016, 'auprc': 0.9990623253498067, 'loss_val': 0.12569900689836044, 'psi': 0.9788850862136436}-{'f1_val': 0.983004208656469, 'auprc': 0.9990621161356882, 'loss_val': 0.06800702557393763, 'psi': 0.9894273716481566}
[S4] START round=35 head_norm_before_train=1.941871 (no previous merge yet)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9391349546461081, 'auprc': 0.9446790459743467, 'loss_val': 0.3546551082042175, 'psi': 0.9413525911774036}-{'f1_val': 0.9388473517716055, 'auprc': 0.9511545691916419, 'loss_val': 0.3372423793556311, 'psi': 0.9437702387396201}
[S5] START round=35 head_norm_before_train=1.536407 cos_to_last_merge=0.7913 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=35 local utility u=0.931869 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9974574186882523, 'loss_val': 0.08953639759204501, 'psi': 0.9967825220685952}-{'f1_val': 0.7144364317802219, 'auprc': 0.9915110169246799, 'loss_val': 0.244058281680193, 'psi': 0.825266265838005}
[S6] START round=35 head_norm_before_train=1.871323 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.7982934742209578, 'auprc': 0.9521465436797949, 'loss_val': 0.597844303590553, 'psi': 0.8598347020044925}-{'f1_val': 0.8147766561612049, 'auprc': 0.9552042034011378, 'loss_val': 0.48310695513245305, 'psi': 0.8709476750571781}
[S7] START round=35 head_norm_before_train=0.983152 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.373144 metrics={'f1_val': 0.6676839275665608, 'auprc': 0.8131141208329093, 'loss_val': 0.6231390805730664, 'psi': 0.7258560048731002}-{'f1_val': 0.5815685235987462, 'auprc': 0.7858279060951259, 'loss_val': 0.7708763470607375, 'psi': 0.663272276597298}
[S8] START round=35 head_norm_before_train=1.973318 (no previous merge yet)
[S8] round=35 local utility u=0.030521 metrics={'f1_val': 0.9936377668526739, 'auprc': 0.9935522514781424, 'loss_val': 0.03512704191240672, 'psi': 0.9936035607028614}-{'f1_val': 0.9839092979549603, 'auprc': 0.9989263377609783, 'loss_val': 0.05392124079226555, 'psi': 0.9899161138773674}
[S9] START round=35 head_norm_before_train=1.801390 cos_to_last_merge=0.7779 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.778
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9901493298847097, 'auprc': 0.9991752551936146, 'loss_val': 0.03803609308304407, 'psi': 0.9937597000082716}-{'f1_val': 0.9966924912647621, 'auprc': 0.9924172854655913, 'loss_val': 0.02213210365735704, 'psi': 0.9949824089450938}
[S10] START round=35 head_norm_before_train=1.652249 cos_to_last_merge=0.6301 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.630
[S10] round=35 local utility u=0.001135 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9935440281841799, 'loss_val': 0.04015148717723322, 'psi': 0.9944796921193308}-{'f1_val': 0.9953231205637304, 'auprc': 0.992930111570637, 'loss_val': 0.0418971961883361, 'psi': 0.994365916966493}
[S11] START round=35 head_norm_before_train=1.907041 cos_to_last_merge=0.7454 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.745
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9951708032261593, 'auprc': 0.998267469860509, 'loss_val': 0.03132075779327409, 'psi': 0.9964094698798991}-{'f1_val': 0.9961336749133093, 'auprc': 0.998483011046025, 'loss_val': 0.028262772543606676, 'psi': 0.9970734093663955}
[S13] START round=35 head_norm_before_train=1.136370 cos_to_last_merge=0.9987 (last merge round=33)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5851365128833294, 'auprc': 0.6915193147023909, 'loss_val': 0.8345127851505781, 'psi': 0.627689633610954}-{'f1_val': 0.6088870453705274, 'auprc': 0.6654841220899681, 'loss_val': 0.7341357095243707, 'psi': 0.6315258760583037}
[S14] START round=35 head_norm_before_train=1.997868 (no previous merge yet)
[S14] round=35 local utility u=0.003356 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969755258275557, 'loss_val': 0.024993192608433426, 'psi': 0.9969887152256214}-{'f1_val': 0.9965872316107504, 'auprc': 0.9969752954841031, 'loss_val': 0.029242797816130234, 'psi': 0.9967424571600915}
[S15] START round=35 head_norm_before_train=2.074027 (no previous merge yet)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.9053075289709317, 'auprc': 0.9982954572088469, 'loss_val': 0.10173271656038786, 'psi': 0.9425027002660978}-{'f1_val': 0.9571746326116914, 'auprc': 0.997843400394623, 'loss_val': 0.061196774068240686, 'psi': 0.973442139724864}
[S16] START round=35 head_norm_before_train=1.744949 cos_to_last_merge=0.7048 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.705
[S16] round=35 local utility u=0.767999 metrics={'f1_val': 0.9915530147387, 'auprc': 0.9949363992940514, 'loss_val': 0.04369282868812967, 'psi': 0.9929063685608406}-{'f1_val': 0.8660373324884834, 'auprc': 0.9886175615928421, 'loss_val': 0.8076409915952865, 'psi': 0.9150694241302268}
[S17] START round=35 head_norm_before_train=1.898492 (no previous merge yet)
[S17] round=35 local utility u=0.507549 metrics={'f1_val': 0.6282181824514445, 'auprc': 0.9099028879965063, 'loss_val': 0.7048609347443765, 'psi': 0.7408920646694692}-{'f1_val': 0.6015694921758068, 'auprc': 0.7909103186246281, 'loss_val': 1.2030892571599159, 'psi': 0.6773058227553354}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61809
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:61815
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.994)
[S16] not sending this round → trigger blocked (psi=0.993)
[S5] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S5
[S13] cosine check vs S5: cos=0.4958
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.4412
[S8] RECEIVED delta(kind=head bytes=1804) from S7
[S8] cosine check vs S7: cos=-0.0330
[S8] DROPPED delta from S7 (cos=-0.0330 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S8
[S15] cosine check vs S8: cos=-0.0659
[S15] DROPPED delta from S8 (cos=-0.0659 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S17
[S13] cosine check vs S17: cos=0.2455
[S6] ⇄ pheromone p=0.278 → S5@127.0.0.1:61805
[S10] ⇄ pheromone p=0.027 → S4@127.0.0.1:61804
[S4] ⇄ pheromone p=0.024 → S11@127.0.0.1:61812
[S11] ⇄ pheromone p=0.018 → S5@127.0.0.1:61805
[S3] ⇄ pheromone p=0.081 → S13@127.0.0.1:61813
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=35 metric=0.5851 head_norm=1.164977
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.986131e-01
[S13] stored merged vector for next round verification (round=35)
[S13] DEBUG after merge:  round=35 metric=0.5886 head_norm=1.036900 delta_norm=0.598613
[S13] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.032 → S7@127.0.0.1:61808
[S15] ⇄ pheromone p=0.094 → S9@127.0.0.1:61810
[S2] ⇄ pheromone p=0.064 → S4@127.0.0.1:61804
[S9] ⇄ pheromone p=0.007 → S11@127.0.0.1:61812
[S14] ⇄ pheromone p=0.013 → S7@127.0.0.1:61808
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.6677 head_norm=1.010105
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.018196e-01
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.6798 head_norm=1.306477 delta_norm=0.901820
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.198 → S8@127.0.0.1:61809
[S8] ⇄ pheromone p=0.130 → S15@127.0.0.1:61815
[S5] ⇄ pheromone p=0.419 → S13@127.0.0.1:61813
[S16] ⇄ pheromone p=0.322 → S2@127.0.0.1:61802
[S17] ⇄ pheromone p=0.199 → S13@127.0.0.1:61813
[S2] START round=36 head_norm_before_train=1.746927 cos_to_last_merge=1.0000 (last merge round=34)
[S2] round=36 local utility u=0.047087 metrics={'f1_val': 0.6132876822792197, 'auprc': 0.6745001341611456, 'loss_val': 1.2774793268376403, 'psi': 0.63777266303199}-{'f1_val': 0.5986983842605746, 'auprc': 0.6835307052810824, 'loss_val': 1.3112097931461133, 'psi': 0.6326313126687777}
[S3] START round=36 head_norm_before_train=1.733056 cos_to_last_merge=0.7465 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.747
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9614692806076618, 'auprc': 0.9988839636501359, 'loss_val': 0.1126117815648519, 'psi': 0.9764351538246514}-{'f1_val': 0.9654335934562016, 'auprc': 0.9990623253498067, 'loss_val': 0.12569900689836044, 'psi': 0.9788850862136436}
[S4] START round=36 head_norm_before_train=1.947682 (no previous merge yet)
[S4] round=36 local utility u=0.020219 metrics={'f1_val': 0.9404326764892855, 'auprc': 0.943578753832126, 'loss_val': 0.31870289814476904, 'psi': 0.9416911074264217}-{'f1_val': 0.9391349546461081, 'auprc': 0.9446790459743467, 'loss_val': 0.3546551082042175, 'psi': 0.9413525911774036}
[S5] START round=36 head_norm_before_train=1.539177 cos_to_last_merge=0.7907 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.8510697959409556, 'auprc': 0.9915383427554083, 'loss_val': 0.15610401473045557, 'psi': 0.9072572146667367}-{'f1_val': 0.9963325909888239, 'auprc': 0.9974574186882523, 'loss_val': 0.08953639759204501, 'psi': 0.9967825220685952}
[S6] START round=36 head_norm_before_train=1.883062 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.5973898833972691, 'auprc': 0.9352476532887498, 'loss_val': 0.9364928560033606, 'psi': 0.7325329913538614}-{'f1_val': 0.7982934742209578, 'auprc': 0.9521465436797949, 'loss_val': 0.597844303590553, 'psi': 0.8598347020044925}
[S7] START round=36 head_norm_before_train=1.306477 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.621181345298714, 'auprc': 0.7885188573914017, 'loss_val': 0.7648362412584161, 'psi': 0.6881163501357892}-{'f1_val': 0.6676839275665608, 'auprc': 0.8131141208329093, 'loss_val': 0.6231390805730664, 'psi': 0.7258560048731002}
[S8] START round=36 head_norm_before_train=1.977710 (no previous merge yet)
[S8] round=36 local utility u=0.000641 metrics={'f1_val': 0.9936377668526739, 'auprc': 0.9937779025108371, 'loss_val': 0.03452195279683348, 'psi': 0.9936938211159392}-{'f1_val': 0.9936377668526739, 'auprc': 0.9935522514781424, 'loss_val': 0.03512704191240672, 'psi': 0.9936035607028614}
[S9] START round=36 head_norm_before_train=1.809404 cos_to_last_merge=0.7775 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.778
[S9] round=36 local utility u=0.025495 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9995550078017186, 'loss_val': 0.023414041470702543, 'psi': 0.9974344243069997}-{'f1_val': 0.9901493298847097, 'auprc': 0.9991752551936146, 'loss_val': 0.03803609308304407, 'psi': 0.9937597000082716}
[S10] START round=36 head_norm_before_train=1.667420 cos_to_last_merge=0.6287 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.629
[S10] round=36 local utility u=0.000939 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.993433320198081, 'loss_val': 0.03925926735565382, 'psi': 0.9945672004174706}-{'f1_val': 0.9951034680760983, 'auprc': 0.9935440281841799, 'loss_val': 0.04015148717723322, 'psi': 0.9944796921193308}
[S11] START round=36 head_norm_before_train=1.921207 cos_to_last_merge=0.7447 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.745
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.8198645146080938, 'auprc': 0.9962551544245701, 'loss_val': 0.28578453682055555, 'psi': 0.8904207705346843}-{'f1_val': 0.9951708032261593, 'auprc': 0.998267469860509, 'loss_val': 0.03132075779327409, 'psi': 0.9964094698798991}
[S13] START round=36 head_norm_before_train=1.036900 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=36 local utility u=0.160384 metrics={'f1_val': 0.6270826150096225, 'auprc': 0.6702035172828, 'loss_val': 0.7014745878617141, 'psi': 0.6443309759188935}-{'f1_val': 0.5851365128833294, 'auprc': 0.6915193147023909, 'loss_val': 0.8345127851505781, 'psi': 0.627689633610954}
[S14] START round=36 head_norm_before_train=2.004996 (no previous merge yet)
[S14] round=36 local utility u=0.003854 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9987693081401876, 'loss_val': 0.022667516655603577, 'psi': 0.9977062281506741}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969755258275557, 'loss_val': 0.024993192608433426, 'psi': 0.9969887152256214}
[S15] START round=36 head_norm_before_train=2.084626 (no previous merge yet)
[S15] round=36 local utility u=0.248193 metrics={'f1_val': 0.9788928787035713, 'auprc': 0.9980921908320963, 'loss_val': 0.046248110623737564, 'psi': 0.9865726035549813}-{'f1_val': 0.9053075289709317, 'auprc': 0.9982954572088469, 'loss_val': 0.10173271656038786, 'psi': 0.9425027002660978}
[S16] START round=36 head_norm_before_train=1.754758 cos_to_last_merge=0.7042 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.704
[S16] round=36 local utility u=0.003779 metrics={'f1_val': 0.9925772959938264, 'auprc': 0.9942123856136551, 'loss_val': 0.04010819982795786, 'psi': 0.9932313318417578}-{'f1_val': 0.9915530147387, 'auprc': 0.9949363992940514, 'loss_val': 0.04369282868812967, 'psi': 0.9929063685608406}
[S17] START round=36 head_norm_before_train=1.904206 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6009615872541716, 'auprc': 0.8192096068266316, 'loss_val': 1.1318024231433792, 'psi': 0.6882607950831556}-{'f1_val': 0.6282181824514445, 'auprc': 0.9099028879965063, 'loss_val': 0.7048609347443765, 'psi': 0.7408920646694692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61808
[S8] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:61804
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61812
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S10] → sending delta(kind=head bytes=1787) to S4@127.0.0.1:61804
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:61810
[S10] sending update (kind=head size=1787 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S16
[S2] cosine check vs S16: cos=0.9992
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=-0.1106
[S11] DROPPED delta from S4 (cos=-0.1106 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S9
[S11] cosine check vs S9: cos=-0.0220
[S11] DROPPED delta from S9 (cos=-0.0220 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] cosine check vs S13: cos=0.3394
[S9] RECEIVED delta(kind=head bytes=1795) from S15
[S9] cosine check vs S15: cos=-0.0016
[S9] DROPPED delta from S15 (cos=-0.0016 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1787) from S10
[S4] cosine check vs S10: cos=-0.0552
[S4] DROPPED delta from S10 (cos=-0.0552 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] cosine check vs S2: cos=-0.0491
[S4] DROPPED delta from S2 (cos=-0.0491 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=36 metric=0.6212 head_norm=1.330099
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.969131e-01
[S7] stored merged vector for next round verification (round=36)
[S7] DEBUG after merge:  round=36 metric=0.6081 head_norm=0.983309 delta_norm=0.696913
[S7] aggregate: ROLLBACK (f1_val pre=0.621 post=0.608 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=36 metric=0.6133 head_norm=1.754540
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.457544e-02
[S2] stored merged vector for next round verification (round=36)
[S2] DEBUG after merge:  round=36 metric=0.6130 head_norm=1.759310 delta_norm=0.034575
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.759310 cos_to_last_merge=1.0000 (last merge round=36)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.5978844584893945, 'auprc': 0.6733126078914479, 'loss_val': 1.2108157631025864, 'psi': 0.6280557182502159}-{'f1_val': 0.6132876822792197, 'auprc': 0.6745001341611456, 'loss_val': 1.2774793268376403, 'psi': 0.63777266303199}
[S3] START round=37 head_norm_before_train=1.756065 cos_to_last_merge=0.7453 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.745
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9596804739176257, 'auprc': 0.9989062398503272, 'loss_val': 0.14538963723387233, 'psi': 0.9753707802907063}-{'f1_val': 0.9614692806076618, 'auprc': 0.9988839636501359, 'loss_val': 0.1126117815648519, 'psi': 0.9764351538246514}
[S4] START round=37 head_norm_before_train=1.954230 (no previous merge yet)
[S4] round=37 local utility u=0.056490 metrics={'f1_val': 0.9524536818825674, 'auprc': 0.9557289053432714, 'loss_val': 0.31429982559531444, 'psi': 0.953763771266849}-{'f1_val': 0.9404326764892855, 'auprc': 0.943578753832126, 'loss_val': 0.31870289814476904, 'psi': 0.9416911074264217}
[S5] START round=37 head_norm_before_train=1.544412 cos_to_last_merge=0.7900 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=37 local utility u=0.479822 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9979626971377651, 'loss_val': 0.0873089599002715, 'psi': 0.9969846334484003}-{'f1_val': 0.8510697959409556, 'auprc': 0.9915383427554083, 'loss_val': 0.15610401473045557, 'psi': 0.9072572146667367}
[S6] START round=37 head_norm_before_train=1.891162 (no previous merge yet)
[S6] round=37 local utility u=0.986420 metrics={'f1_val': 0.8234590782046727, 'auprc': 0.9655418157548274, 'loss_val': 0.4109505193610299, 'psi': 0.8802921732247346}-{'f1_val': 0.5973898833972691, 'auprc': 0.9352476532887498, 'loss_val': 0.9364928560033606, 'psi': 0.7325329913538614}
[S7] START round=37 head_norm_before_train=0.983309 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=37 local utility u=0.629892 metrics={'f1_val': 0.6993098473500494, 'auprc': 0.9772160971107475, 'loss_val': 0.539914593384827, 'psi': 0.8104723472543287}-{'f1_val': 0.621181345298714, 'auprc': 0.7885188573914017, 'loss_val': 0.7648362412584161, 'psi': 0.6881163501357892}
[S8] START round=37 head_norm_before_train=1.985358 (no previous merge yet)
[S8] round=37 local utility u=0.004893 metrics={'f1_val': 0.9927378939946618, 'auprc': 0.9989572536194777, 'loss_val': 0.0348737856320197, 'psi': 0.9952256378445883}-{'f1_val': 0.9936377668526739, 'auprc': 0.9937779025108371, 'loss_val': 0.03452195279683348, 'psi': 0.9936938211159392}
[S9] START round=37 head_norm_before_train=1.818679 cos_to_last_merge=0.7769 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.777
[S9] round=37 local utility u=0.003240 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9992048090145262, 'loss_val': 0.02087478613262225, 'psi': 0.9977934748611648}-{'f1_val': 0.9960207019771873, 'auprc': 0.9995550078017186, 'loss_val': 0.023414041470702543, 'psi': 0.9974344243069997}
[S10] START round=37 head_norm_before_train=1.682398 cos_to_last_merge=0.6273 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.627
[S10] round=37 local utility u=0.000007 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9935255588587757, 'loss_val': 0.03820470522623073, 'psi': 0.9944723043891692}-{'f1_val': 0.9953231205637304, 'auprc': 0.993433320198081, 'loss_val': 0.03925926735565382, 'psi': 0.9945672004174706}
[S11] START round=37 head_norm_before_train=1.933748 cos_to_last_merge=0.7440 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.744
[S11] round=37 local utility u=0.206001 metrics={'f1_val': 0.865658805387005, 'auprc': 0.9979319778779461, 'loss_val': 0.15357871235645812, 'psi': 0.9185680743833814}-{'f1_val': 0.8198645146080938, 'auprc': 0.9962551544245701, 'loss_val': 0.28578453682055555, 'psi': 0.8904207705346843}
[S13] START round=37 head_norm_before_train=1.065834 cos_to_last_merge=0.9991 (last merge round=35)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6126633667850789, 'auprc': 0.6847263901191188, 'loss_val': 0.773001859774192, 'psi': 0.6414885761186949}-{'f1_val': 0.6270826150096225, 'auprc': 0.6702035172828, 'loss_val': 0.7014745878617141, 'psi': 0.6443309759188935}
[S14] START round=37 head_norm_before_train=2.015858 (no previous merge yet)
[S14] round=37 local utility u=0.000530 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9982022219893963, 'loss_val': 0.02236998930691215, 'psi': 0.9977258504967939}-{'f1_val': 0.9969975081576651, 'auprc': 0.9987693081401876, 'loss_val': 0.022667516655603577, 'psi': 0.9977062281506741}
[S15] START round=37 head_norm_before_train=2.095370 (no previous merge yet)
[S15] round=37 local utility u=0.047861 metrics={'f1_val': 0.9949962073872634, 'auprc': 0.9964984665778516, 'loss_val': 0.042365574794545724, 'psi': 0.9955971110634987}-{'f1_val': 0.9788928787035713, 'auprc': 0.9980921908320963, 'loss_val': 0.046248110623737564, 'psi': 0.9865726035549813}
[S16] START round=37 head_norm_before_train=1.764744 cos_to_last_merge=0.7036 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.704
[S16] round=37 local utility u=0.000549 metrics={'f1_val': 0.9926487153609478, 'auprc': 0.9935887365907788, 'loss_val': 0.03756853617642573, 'psi': 0.9930247238528802}-{'f1_val': 0.9925772959938264, 'auprc': 0.9942123856136551, 'loss_val': 0.04010819982795786, 'psi': 0.9932313318417578}
[S17] START round=37 head_norm_before_train=1.909339 (no previous merge yet)
[S17] round=37 local utility u=0.196786 metrics={'f1_val': 0.6032633272016794, 'auprc': 0.8795720627446241, 'loss_val': 0.9331281009747328, 'psi': 0.7137868214188572}-{'f1_val': 0.6009615872541716, 'auprc': 0.8192096068266316, 'loss_val': 1.1318024231433792, 'psi': 0.6882607950831556}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:61808
[S4] not sending this round → trigger blocked (psi=0.954)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:61805
[S9] not sending this round → trigger blocked (psi=0.998)
[S16] not sending this round → trigger blocked (psi=0.993)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61813
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:61805
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.994)
[S15] not sending this round → trigger blocked (psi=0.996)
[S7] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S11
[S5] cosine check vs S11: cos=-0.0109
[S5] DROPPED delta from S11 (cos=-0.0109 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=-0.0293
[S8] DROPPED delta from S7 (cos=-0.0293 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=-0.0657
[S15] DROPPED delta from S8 (cos=-0.0657 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S5
[S13] cosine check vs S5: cos=0.6604
[S7] RECEIVED delta(kind=head bytes=1794) from S14
[S7] cosine check vs S14: cos=0.6396
[S5] RECEIVED delta(kind=head bytes=1800) from S6
[S5] cosine check vs S6: cos=-0.0325
[S5] DROPPED delta from S6 (cos=-0.0325 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S17
[S13] cosine check vs S17: cos=0.5809
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=37 metric=0.6127 head_norm=1.092660
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.116181e-01
[S13] stored merged vector for next round verification (round=37)
[S13] DEBUG after merge:  round=37 metric=0.6137 head_norm=1.124281 delta_norm=0.311618
[S13] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.6993 head_norm=1.006466
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.925549e-01
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.7870 head_norm=1.390396 delta_norm=0.792555
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.764957 cos_to_last_merge=1.0000 (last merge round=36)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.5652317132535147, 'auprc': 0.6030935734090394, 'loss_val': 1.5580741609511624, 'psi': 0.5803764573157246}-{'f1_val': 0.5978844584893945, 'auprc': 0.6733126078914479, 'loss_val': 1.2108157631025864, 'psi': 0.6280557182502159}
[S3] START round=38 head_norm_before_train=1.776332 cos_to_last_merge=0.7445 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.744
[S3] round=38 local utility u=0.109044 metrics={'f1_val': 0.9831778518186238, 'auprc': 0.9992408362646292, 'loss_val': 0.06928889091004323, 'psi': 0.989603045597026}-{'f1_val': 0.9596804739176257, 'auprc': 0.9989062398503272, 'loss_val': 0.14538963723387233, 'psi': 0.9753707802907063}
[S4] START round=38 head_norm_before_train=1.962893 (no previous merge yet)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9458925463249688, 'auprc': 0.9608477032904935, 'loss_val': 0.30974542283005446, 'psi': 0.9518746091111787}-{'f1_val': 0.9524536818825674, 'auprc': 0.9557289053432714, 'loss_val': 0.31429982559531444, 'psi': 0.953763771266849}
[S5] START round=38 head_norm_before_train=1.549362 cos_to_last_merge=0.7894 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.789
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9931035977097047, 'loss_val': 0.09680488252408156, 'psi': 0.9949530530694685}-{'f1_val': 0.9963325909888239, 'auprc': 0.9979626971377651, 'loss_val': 0.0873089599002715, 'psi': 0.9969846334484003}
[S6] START round=38 head_norm_before_train=1.898311 (no previous merge yet)
[S6] round=38 local utility u=0.559705 metrics={'f1_val': 0.9637455389668697, 'auprc': 0.9787333181367042, 'loss_val': 0.1728330692046072, 'psi': 0.9697406506348034}-{'f1_val': 0.8234590782046727, 'auprc': 0.9655418157548274, 'loss_val': 0.4109505193610299, 'psi': 0.8802921732247346}
[S7] START round=38 head_norm_before_train=1.390396 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.4554118445493782, 'auprc': 0.6461224879566916, 'loss_val': 1.1041297313013738, 'psi': 0.5316961019123037}-{'f1_val': 0.6993098473500494, 'auprc': 0.9772160971107475, 'loss_val': 0.539914593384827, 'psi': 0.8104723472543287}
[S8] START round=38 head_norm_before_train=1.994239 (no previous merge yet)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9923946006913721, 'auprc': 0.9865479839511531, 'loss_val': 0.0527951358817003, 'psi': 0.9900559539952845}-{'f1_val': 0.9927378939946618, 'auprc': 0.9989572536194777, 'loss_val': 0.0348737856320197, 'psi': 0.9952256378445883}
[S9] START round=38 head_norm_before_train=1.828249 cos_to_last_merge=0.7762 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.776
[S9] round=38 local utility u=0.000459 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9995555037732553, 'loss_val': 0.021009073468316757, 'psi': 0.9979337527646565}-{'f1_val': 0.9968525854255906, 'auprc': 0.9992048090145262, 'loss_val': 0.02087478613262225, 'psi': 0.9977934748611648}
[S10] START round=38 head_norm_before_train=1.694148 cos_to_last_merge=0.6263 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.626
[S10] round=38 local utility u=0.000356 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9934919563818645, 'loss_val': 0.037391956628129566, 'psi': 0.9944588633984047}-{'f1_val': 0.9951034680760983, 'auprc': 0.9935255588587757, 'loss_val': 0.03820470522623073, 'psi': 0.9944723043891692}
[S11] START round=38 head_norm_before_train=1.946247 cos_to_last_merge=0.7433 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.743
[S11] round=38 local utility u=0.455077 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998130871683679, 'loss_val': 0.02687117519277453, 'psi': 0.9969325536214572}-{'f1_val': 0.865658805387005, 'auprc': 0.9979319778779461, 'loss_val': 0.15357871235645812, 'psi': 0.9185680743833814}
[S13] START round=38 head_norm_before_train=1.124281 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6108675559789705, 'auprc': 0.6816327157797011, 'loss_val': 0.7682763454286129, 'psi': 0.6391736198992628}-{'f1_val': 0.6126633667850789, 'auprc': 0.6847263901191188, 'loss_val': 0.773001859774192, 'psi': 0.6414885761186949}
[S14] START round=38 head_norm_before_train=2.027243 (no previous merge yet)
[S14] round=38 local utility u=0.003013 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9991382049871997, 'loss_val': 0.020608909395255788, 'psi': 0.998245952824792}-{'f1_val': 0.9974082695017256, 'auprc': 0.9982022219893963, 'loss_val': 0.02236998930691215, 'psi': 0.9977258504967939}
[S15] START round=38 head_norm_before_train=2.105852 (no previous merge yet)
[S15] round=38 local utility u=0.021844 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9989823255392669, 'loss_val': 0.01885630366727867, 'psi': 0.9978632823325668}-{'f1_val': 0.9949962073872634, 'auprc': 0.9964984665778516, 'loss_val': 0.042365574794545724, 'psi': 0.9955971110634987}
[S16] START round=38 head_norm_before_train=1.775712 cos_to_last_merge=0.7030 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.703
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9919965598033159, 'auprc': 0.9904203072764667, 'loss_val': 0.03767246123291927, 'psi': 0.9913660587925762}-{'f1_val': 0.9926487153609478, 'auprc': 0.9935887365907788, 'loss_val': 0.03756853617642573, 'psi': 0.9930247238528802}
[S17] START round=38 head_norm_before_train=1.915559 (no previous merge yet)
[S17] round=38 local utility u=0.028183 metrics={'f1_val': 0.595736434684612, 'auprc': 0.9148709311652727, 'loss_val': 0.9374964473096069, 'psi': 0.7233902332768762}-{'f1_val': 0.6032633272016794, 'auprc': 0.8795720627446241, 'loss_val': 0.9331281009747328, 'psi': 0.7137868214188572}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:61810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61812
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:61804
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1792) from S15
[S9] cosine check vs S15: cos=-0.0004
[S9] DROPPED delta from S15 (cos=-0.0004 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S6
[S5] cosine check vs S6: cos=-0.0328
[S5] DROPPED delta from S6 (cos=-0.0328 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S11
[S5] cosine check vs S11: cos=-0.0110
[S5] DROPPED delta from S11 (cos=-0.0110 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1793) from S10
[S4] cosine check vs S10: cos=-0.0541
[S4] DROPPED delta from S10 (cos=-0.0541 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.9562
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.7021
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S9
[S11] cosine check vs S9: cos=-0.0197
[S11] DROPPED delta from S9 (cos=-0.0197 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S3
[S13] cosine check vs S3: cos=0.2513
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=38 metric=0.4554 head_norm=1.406262
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.027499e-01
[S7] stored merged vector for next round verification (round=38)
[S7] DEBUG after merge:  round=38 metric=0.4445 head_norm=1.703343 delta_norm=0.402750
[S7] aggregate: ROLLBACK (f1_val pre=0.455 post=0.444 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=38 metric=0.6109 head_norm=1.144950
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.006153e-01
[S13] stored merged vector for next round verification (round=38)
[S13] DEBUG after merge:  round=38 metric=0.6096 head_norm=1.131842 delta_norm=0.500615
[S13] aggregate: ACCEPT kept=['S17', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.769723 cos_to_last_merge=1.0000 (last merge round=36)
[S2] round=39 local utility u=0.410255 metrics={'f1_val': 0.6064112681808769, 'auprc': 0.7115484267723886, 'loss_val': 1.3100056520296495, 'psi': 0.6484661316174816}-{'f1_val': 0.5652317132535147, 'auprc': 0.6030935734090394, 'loss_val': 1.5580741609511624, 'psi': 0.5803764573157246}
[S3] START round=39 head_norm_before_train=1.793042 cos_to_last_merge=0.7438 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.744
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.927464983158058, 'auprc': 0.9996010421879156, 'loss_val': 0.14676466481150932, 'psi': 0.956319406770001}-{'f1_val': 0.9831778518186238, 'auprc': 0.9992408362646292, 'loss_val': 0.06928889091004323, 'psi': 0.989603045597026}
[S4] START round=39 head_norm_before_train=1.972280 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9409030692523885, 'auprc': 0.9642623613097535, 'loss_val': 0.3228698271357944, 'psi': 0.9502467860753345}-{'f1_val': 0.9458925463249688, 'auprc': 0.9608477032904935, 'loss_val': 0.30974542283005446, 'psi': 0.9518746091111787}
[S5] START round=39 head_norm_before_train=1.552418 cos_to_last_merge=0.7890 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.789
[S5] round=39 local utility u=0.002447 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9937039001020378, 'loss_val': 0.09371142256810111, 'psi': 0.9951931740264017}-{'f1_val': 0.996186023309311, 'auprc': 0.9931035977097047, 'loss_val': 0.09680488252408156, 'psi': 0.9949530530694685}
[S6] START round=39 head_norm_before_train=1.905417 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.598692188911485, 'auprc': 0.9445408542985287, 'loss_val': 0.9676487872329196, 'psi': 0.7370316550663025}-{'f1_val': 0.9637455389668697, 'auprc': 0.9787333181367042, 'loss_val': 0.1728330692046072, 'psi': 0.9697406506348034}
[S7] START round=39 head_norm_before_train=1.703343 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=39 local utility u=1.000000 metrics={'f1_val': 0.6613131225629757, 'auprc': 0.7975712448718368, 'loss_val': 0.6850602995611671, 'psi': 0.7158163714865202}-{'f1_val': 0.4554118445493782, 'auprc': 0.6461224879566916, 'loss_val': 1.1041297313013738, 'psi': 0.5316961019123037}
[S8] START round=39 head_norm_before_train=2.003279 (no previous merge yet)
[S8] round=39 local utility u=0.031022 metrics={'f1_val': 0.9932458209383426, 'auprc': 0.9990328573642359, 'loss_val': 0.03331358037628283, 'psi': 0.9955606355086999}-{'f1_val': 0.9923946006913721, 'auprc': 0.9865479839511531, 'loss_val': 0.0527951358817003, 'psi': 0.9900559539952845}
[S9] START round=39 head_norm_before_train=1.837489 cos_to_last_merge=0.7757 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.776
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9963987700172448, 'loss_val': 0.019787630867205724, 'psi': 0.9965750027657552}-{'f1_val': 0.9968525854255906, 'auprc': 0.9995555037732553, 'loss_val': 0.021009073468316757, 'psi': 0.9979337527646565}
[S10] START round=39 head_norm_before_train=1.705682 cos_to_last_merge=0.6253 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.625
[S10] round=39 local utility u=0.000336 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9934637903718805, 'loss_val': 0.036634510783864795, 'psi': 0.9944475969944111}-{'f1_val': 0.9951034680760983, 'auprc': 0.9934919563818645, 'loss_val': 0.037391956628129566, 'psi': 0.9944588633984047}
[S11] START round=39 head_norm_before_train=1.957065 cos_to_last_merge=0.7429 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.743
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9980911025878689, 'loss_val': 0.026446028666086464, 'psi': 0.9967715437562961}-{'f1_val': 0.9961336749133093, 'auprc': 0.998130871683679, 'loss_val': 0.02687117519277453, 'psi': 0.9969325536214572}
[S13] START round=39 head_norm_before_train=1.131842 cos_to_last_merge=1.0000 (last merge round=38)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6122138417516966, 'auprc': 0.6643682653379253, 'loss_val': 0.7760524917474584, 'psi': 0.633075611186188}-{'f1_val': 0.6108675559789705, 'auprc': 0.6816327157797011, 'loss_val': 0.7682763454286129, 'psi': 0.6391736198992628}
[S14] START round=39 head_norm_before_train=2.037055 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9992265103077372, 'loss_val': 0.020669120972716167, 'psi': 0.9981355658241302}-{'f1_val': 0.9976511180498535, 'auprc': 0.9991382049871997, 'loss_val': 0.020608909395255788, 'psi': 0.998245952824792}
[S15] START round=39 head_norm_before_train=2.115484 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.8968059487778223, 'auprc': 0.9973652693410103, 'loss_val': 0.28610691413511996, 'psi': 0.9370296770030975}-{'f1_val': 0.9971172535281002, 'auprc': 0.9989823255392669, 'loss_val': 0.01885630366727867, 'psi': 0.9978632823325668}
[S16] START round=39 head_norm_before_train=1.785508 cos_to_last_merge=0.7023 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.702
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9919746802055263, 'auprc': 0.9886134351173756, 'loss_val': 0.038968576992173314, 'psi': 0.9906301821702661}-{'f1_val': 0.9919965598033159, 'auprc': 0.9904203072764667, 'loss_val': 0.03767246123291927, 'psi': 0.9913660587925762}
[S17] START round=39 head_norm_before_train=1.921933 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.590875799237077, 'auprc': 0.9236762917798254, 'loss_val': 0.9373465598868451, 'psi': 0.7239959962541763}-{'f1_val': 0.595736434684612, 'auprc': 0.9148709311652727, 'loss_val': 0.9374964473096069, 'psi': 0.7233902332768762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:61815
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61813
[S5] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S5
[S13] cosine check vs S5: cos=0.3631
[S15] RECEIVED delta(kind=head bytes=1793) from S8
[S15] cosine check vs S8: cos=-0.0662
[S15] DROPPED delta from S8 (cos=-0.0662 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=-0.0534
[S4] DROPPED delta from S10 (cos=-0.0534 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S2
[S4] cosine check vs S2: cos=-0.0474
[S4] DROPPED delta from S2 (cos=-0.0474 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61809
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=-0.0248
[S8] DROPPED delta from S7 (cos=-0.0248 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.737 u=0.0000 p_local=0.3295 f1=0.599 auprc=0.945 bytes=32398
[S4] r=40 psi=0.950 u=0.0000 p_local=0.0193 f1=0.941 auprc=0.964 bytes=28765
[S5] r=40 psi=0.995 u=0.0024 p_local=0.2335 f1=0.996 auprc=0.994 bytes=28791
[S8] r=40 psi=0.996 u=0.0310 p_local=0.0602 f1=0.993 auprc=0.999 bytes=30559
[S2] r=40 psi=0.648 u=0.4103 p_local=0.1130 f1=0.606 auprc=0.712 bytes=26979
[S3] r=40 psi=0.956 u=0.0000 p_local=0.0507 f1=0.927 auprc=1.000 bytes=28778
[S7] r=40 psi=0.716 u=1.0000 p_local=0.3616 f1=0.661 auprc=0.798 bytes=30560
[S14] r=40 psi=0.998 u=0.0000 p_local=0.0061 f1=0.997 auprc=0.999 bytes=30592
[S9] r=40 psi=0.997 u=0.0000 p_local=0.0061 f1=0.997 auprc=0.996 bytes=32353
[S16] r=40 psi=0.991 u=0.0000 p_local=0.1321 f1=0.992 auprc=0.989 bytes=26965
[S15] r=40 psi=0.937 u=0.0000 p_local=0.0737 f1=0.897 auprc=0.997 bytes=28728
[S11] r=40 psi=0.997 u=0.0000 p_local=0.1066 f1=0.996 auprc=0.998 bytes=30554
[S10] r=40 psi=0.994 u=0.0003 p_local=0.0111 f1=0.995 auprc=0.993 bytes=32313
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=39 metric=0.6122 head_norm=1.149658
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.823375e-01
[S13] stored merged vector for next round verification (round=39)
[S13] DEBUG after merge:  round=39 metric=0.6263 head_norm=1.123567 delta_norm=0.782338
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] r=40 psi=0.633 u=0.0000 p_local=0.0293 f1=0.612 auprc=0.664 bytes=28755
[S17] r=40 psi=0.724 u=0.0000 p_local=0.1114 f1=0.591 auprc=0.924 bytes=26985
[S2] START round=40 head_norm_before_train=1.774694 cos_to_last_merge=0.9999 (last merge round=36)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.6062879565259661, 'auprc': 0.6950120312435968, 'loss_val': 1.2903695006434328, 'psi': 0.6417775864130184}-{'f1_val': 0.6064112681808769, 'auprc': 0.7115484267723886, 'loss_val': 1.3100056520296495, 'psi': 0.6484661316174816}
[S3] START round=40 head_norm_before_train=1.809283 cos_to_last_merge=0.7431 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.743
[S3] round=40 local utility u=0.051734 metrics={'f1_val': 0.9461314245343283, 'auprc': 0.9996137301665928, 'loss_val': 0.1553341807009484, 'psi': 0.9675243467872341}-{'f1_val': 0.927464983158058, 'auprc': 0.9996010421879156, 'loss_val': 0.14676466481150932, 'psi': 0.956319406770001}
[S4] START round=40 head_norm_before_train=1.981987 (no previous merge yet)
[S4] round=40 local utility u=0.012436 metrics={'f1_val': 0.9414649149775631, 'auprc': 0.9713977534398628, 'loss_val': 0.3227749089538903, 'psi': 0.9534380503624831}-{'f1_val': 0.9409030692523885, 'auprc': 0.9642623613097535, 'loss_val': 0.3228698271357944, 'psi': 0.9502467860753345}
[S5] START round=40 head_norm_before_train=1.557945 cos_to_last_merge=0.7881 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=40 local utility u=0.016223 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9975637975368279, 'loss_val': 0.07372488446031081, 'psi': 0.9968250736080254}-{'f1_val': 0.996186023309311, 'auprc': 0.9937039001020378, 'loss_val': 0.09371142256810111, 'psi': 0.9951931740264017}
[S6] START round=40 head_norm_before_train=1.911404 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.5981452794261869, 'auprc': 0.8399055841937575, 'loss_val': 1.0194842972955502, 'psi': 0.6948494013332152}-{'f1_val': 0.598692188911485, 'auprc': 0.9445408542985287, 'loss_val': 0.9676487872329196, 'psi': 0.7370316550663025}
[S7] START round=40 head_norm_before_train=1.714674 cos_to_last_merge=0.9996 (last merge round=38)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5977817415284061, 'auprc': 0.7870848487943297, 'loss_val': 0.7576831580212938, 'psi': 0.6735029844347755}-{'f1_val': 0.6613131225629757, 'auprc': 0.7975712448718368, 'loss_val': 0.6850602995611671, 'psi': 0.7158163714865202}
[S8] START round=40 head_norm_before_train=2.011199 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9989033105386462, 'loss_val': 0.03310186076798606, 'psi': 0.995362398907131}-{'f1_val': 0.9932458209383426, 'auprc': 0.9990328573642359, 'loss_val': 0.03331358037628283, 'psi': 0.9955606355086999}
[S9] START round=40 head_norm_before_train=1.846730 cos_to_last_merge=0.7749 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.775
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.99575162027939, 'loss_val': 0.01959254424272132, 'psi': 0.9963161428706133}-{'f1_val': 0.9966924912647621, 'auprc': 0.9963987700172448, 'loss_val': 0.019787630867205724, 'psi': 0.9965750027657552}
[S10] START round=40 head_norm_before_train=1.717986 cos_to_last_merge=0.6242 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.624
[S10] round=40 local utility u=0.001064 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9935021343069584, 'loss_val': 0.03593976517414608, 'psi': 0.9945947260610215}-{'f1_val': 0.9951034680760983, 'auprc': 0.9934637903718805, 'loss_val': 0.036634510783864795, 'psi': 0.9944475969944111}
[S11] START round=40 head_norm_before_train=1.967198 cos_to_last_merge=0.7424 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.742
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9899092654906836, 'auprc': 0.9985455103340692, 'loss_val': 0.045207435221681164, 'psi': 0.9933637634280379}-{'f1_val': 0.9958918378685807, 'auprc': 0.9980911025878689, 'loss_val': 0.026446028666086464, 'psi': 0.9967715437562961}
[S13] START round=40 head_norm_before_train=1.123567 cos_to_last_merge=1.0000 (last merge round=39)
[S13] round=40 local utility u=0.021498 metrics={'f1_val': 0.6142760417757506, 'auprc': 0.6361882222972035, 'loss_val': 0.6608886034538538, 'psi': 0.6230409139843318}-{'f1_val': 0.6122138417516966, 'auprc': 0.6643682653379253, 'loss_val': 0.7760524917474584, 'psi': 0.633075611186188}
[S14] START round=40 head_norm_before_train=2.045575 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9976262314423188, 'auprc': 0.9970667524577725, 'loss_val': 0.02311374381607424, 'psi': 0.9974024398485003}-{'f1_val': 0.9974082695017256, 'auprc': 0.9992265103077372, 'loss_val': 0.020669120972716167, 'psi': 0.9981355658241302}
[S15] START round=40 head_norm_before_train=2.124703 (no previous merge yet)
[S15] round=40 local utility u=0.082002 metrics={'f1_val': 0.9026206440979526, 'auprc': 0.9975366155407426, 'loss_val': 0.15750543877596493, 'psi': 0.9405870326750687}-{'f1_val': 0.8968059487778223, 'auprc': 0.9973652693410103, 'loss_val': 0.28610691413511996, 'psi': 0.9370296770030975}
[S16] START round=40 head_norm_before_train=1.791424 cos_to_last_merge=0.7022 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.702
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8747799747842457, 'auprc': 0.8470984827814451, 'loss_val': 0.7825676386884839, 'psi': 0.8637073779831255}-{'f1_val': 0.9919746802055263, 'auprc': 0.9886134351173756, 'loss_val': 0.038968576992173314, 'psi': 0.9906301821702661}
[S17] START round=40 head_norm_before_train=1.931299 (no previous merge yet)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.5971071694747124, 'auprc': 0.8963447052047993, 'loss_val': 0.9996004315079167, 'psi': 0.7168021837667471}-{'f1_val': 0.590875799237077, 'auprc': 0.9236762917798254, 'loss_val': 0.9373465598868451, 'psi': 0.7239959962541763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61812
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61813
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:61804
[S10] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] cosine check vs S10: cos=-0.0526
[S4] DROPPED delta from S10 (cos=-0.0526 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=-0.1136
[S11] DROPPED delta from S4 (cos=-0.1136 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S3
[S13] cosine check vs S3: cos=0.2874
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:61808
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1792 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1792) from S13
[S7] cosine check vs S13: cos=0.1620
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:61810
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:61813
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S15
[S9] cosine check vs S15: cos=0.0001
[S5] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S5
[S13] cosine check vs S5: cos=0.8767
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.048 → S15@127.0.0.1:61815
[S6] ⇄ pheromone p=0.264 → S5@127.0.0.1:61805
[S2] ⇄ pheromone p=0.090 → S4@127.0.0.1:61804
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=40 metric=0.9967 head_norm=1.857403
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.414424e+00
[S9] stored merged vector for next round verification (round=40)
[S9] DEBUG after merge:  round=40 metric=0.9967 head_norm=1.414515 delta_norm=1.414424
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.005 → S11@127.0.0.1:61812
[S3] ⇄ pheromone p=0.051 → S13@127.0.0.1:61813
[S10] ⇄ pheromone p=0.009 → S4@127.0.0.1:61804
[S4] ⇄ pheromone p=0.018 → S11@127.0.0.1:61812
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=40 metric=0.5978 head_norm=1.730443
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.576517e-01
[S7] stored merged vector for next round verification (round=40)
[S7] DEBUG after merge:  round=40 metric=0.5968 head_norm=1.113061 delta_norm=0.957652
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.289 → S8@127.0.0.1:61809
[S11] ⇄ pheromone p=0.085 → S5@127.0.0.1:61805
[S5] ⇄ pheromone p=0.190 → S13@127.0.0.1:61813
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=40 metric=0.6143 head_norm=1.147855
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.921492e-01
[S13] stored merged vector for next round verification (round=40)
[S13] DEBUG after merge:  round=40 metric=0.6168 head_norm=1.115661 delta_norm=0.392149
[S13] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.028 → S7@127.0.0.1:61808
[S17] ⇄ pheromone p=0.089 → S13@127.0.0.1:61813
[S15] ⇄ pheromone p=0.075 → S9@127.0.0.1:61810
[S16] ⇄ pheromone p=0.106 → S2@127.0.0.1:61802
[S14] ⇄ pheromone p=0.005 → S7@127.0.0.1:61808
[S2] START round=41 head_norm_before_train=1.779105 cos_to_last_merge=0.9999 (last merge round=36)
[S2] round=41 local utility u=0.335284 metrics={'f1_val': 0.6658546896390478, 'auprc': 0.7167237942616602, 'loss_val': 1.0423379349406605, 'psi': 0.6862023314880927}-{'f1_val': 0.6062879565259661, 'auprc': 0.6950120312435968, 'loss_val': 1.2903695006434328, 'psi': 0.6417775864130184}
[S3] START round=41 head_norm_before_train=1.824900 cos_to_last_merge=0.7425 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.743
[S3] round=41 local utility u=0.078299 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9995823515988309, 'loss_val': 0.08854465131364449, 'psi': 0.9765020949802239}-{'f1_val': 0.9461314245343283, 'auprc': 0.9996137301665928, 'loss_val': 0.1553341807009484, 'psi': 0.9675243467872341}
[S4] START round=41 head_norm_before_train=1.994638 (no previous merge yet)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9418098652018118, 'auprc': 0.9703418396419036, 'loss_val': 0.3220963416011758, 'psi': 0.9532226549778485}-{'f1_val': 0.9414649149775631, 'auprc': 0.9713977534398628, 'loss_val': 0.3227749089538903, 'psi': 0.9534380503624831}
[S5] START round=41 head_norm_before_train=1.569747 cos_to_last_merge=0.7860 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.786
[S5] round=41 local utility u=0.004364 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.997578940722888, 'loss_val': 0.06504231004538999, 'psi': 0.9968311308824495}-{'f1_val': 0.9963325909888239, 'auprc': 0.9975637975368279, 'loss_val': 0.07372488446031081, 'psi': 0.9968250736080254}
[S6] START round=41 head_norm_before_train=1.917206 (no previous merge yet)
[S6] round=41 local utility u=0.816599 metrics={'f1_val': 0.6949968308138015, 'auprc': 0.9756661377906679, 'loss_val': 0.37467654479494233, 'psi': 0.8072645536045481}-{'f1_val': 0.5981452794261869, 'auprc': 0.8399055841937575, 'loss_val': 1.0194842972955502, 'psi': 0.6948494013332152}
[S7] START round=41 head_norm_before_train=1.113061 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5632989303239317, 'auprc': 0.7754416160993414, 'loss_val': 0.8920369608197659, 'psi': 0.6481560046340956}-{'f1_val': 0.5977817415284061, 'auprc': 0.7870848487943297, 'loss_val': 0.7576831580212938, 'psi': 0.6735029844347755}
[S8] START round=41 head_norm_before_train=2.020239 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9866443177218471, 'auprc': 0.9989468828497277, 'loss_val': 0.044463783531595226, 'psi': 0.9915653437729993}-{'f1_val': 0.9930017911527874, 'auprc': 0.9989033105386462, 'loss_val': 0.03310186076798606, 'psi': 0.995362398907131}
[S9] START round=41 head_norm_before_train=1.414515 cos_to_last_merge=1.0000 (last merge round=40)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9995354153650853, 'loss_val': 0.10805740724940681, 'psi': 0.9964281596637243}-{'f1_val': 0.9966924912647621, 'auprc': 0.99575162027939, 'loss_val': 0.01959254424272132, 'psi': 0.9963161428706133}
[S10] START round=41 head_norm_before_train=1.728663 cos_to_last_merge=0.6233 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.623
[S10] round=41 local utility u=0.000097 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9934107910954979, 'loss_val': 0.03547232849281184, 'psi': 0.9945581887764374}-{'f1_val': 0.9953231205637304, 'auprc': 0.9935021343069584, 'loss_val': 0.03593976517414608, 'psi': 0.9945947260610215}
[S11] START round=41 head_norm_before_train=1.977690 cos_to_last_merge=0.7418 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.742
[S11] round=41 local utility u=0.028722 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9983156527463966, 'loss_val': 0.02442089962659957, 'psi': 0.9970064660465442}-{'f1_val': 0.9899092654906836, 'auprc': 0.9985455103340692, 'loss_val': 0.045207435221681164, 'psi': 0.9933637634280379}
[S13] START round=41 head_norm_before_train=1.115661 cos_to_last_merge=1.0000 (last merge round=40)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6117179849462208, 'auprc': 0.6820552734174202, 'loss_val': 0.7891216019182, 'psi': 0.6398529003347005}-{'f1_val': 0.6142760417757506, 'auprc': 0.6361882222972035, 'loss_val': 0.6608886034538538, 'psi': 0.6230409139843318}
[S14] START round=41 head_norm_before_train=2.050908 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9894424265578219, 'auprc': 0.9974481851091107, 'loss_val': 0.04021666530067515, 'psi': 0.9926447299783374}-{'f1_val': 0.9976262314423188, 'auprc': 0.9970667524577725, 'loss_val': 0.02311374381607424, 'psi': 0.9974024398485003}
[S15] START round=41 head_norm_before_train=2.133764 (no previous merge yet)
[S15] round=41 local utility u=0.349121 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9978786766812661, 'loss_val': 0.02504490926227871, 'psi': 0.9971994717050188}-{'f1_val': 0.9026206440979526, 'auprc': 0.9975366155407426, 'loss_val': 0.15750543877596493, 'psi': 0.9405870326750687}
[S16] START round=41 head_norm_before_train=1.798666 cos_to_last_merge=0.7017 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.702
[S16] round=41 local utility u=0.939657 metrics={'f1_val': 0.9916748123662961, 'auprc': 0.9919487146067705, 'loss_val': 0.039173406319295695, 'psi': 0.9917843732624858}-{'f1_val': 0.8747799747842457, 'auprc': 0.8470984827814451, 'loss_val': 0.7825676386884839, 'psi': 0.8637073779831255}
[S17] START round=41 head_norm_before_train=1.940903 (no previous merge yet)
[S17] round=41 local utility u=0.092842 metrics={'f1_val': 0.600285316303081, 'auprc': 0.9226396870546021, 'loss_val': 0.91186948860588, 'psi': 0.7292270646036895}-{'f1_val': 0.5971071694747124, 'auprc': 0.8963447052047993, 'loss_val': 0.9996004315079167, 'psi': 0.7168021837667471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:61804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:61809
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:61816
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:61807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S5
[S6] cosine check vs S5: cos=-0.0335
[S6] DROPPED delta from S5 (cos=-0.0335 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] cosine check vs S11: cos=-0.1143
[S4] DROPPED delta from S11 (cos=-0.1143 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] cosine check vs S15: cos=-0.0677
[S8] DROPPED delta from S15 (cos=-0.0677 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S2
[S16] cosine check vs S2: cos=0.9988
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.9917 head_norm=1.805293
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.591020e-02
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.9917 head_norm=1.794060 delta_norm=0.045910
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.783938 cos_to_last_merge=0.9998 (last merge round=36)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.6431127635984414, 'auprc': 0.7141651723423111, 'loss_val': 1.161231156773747, 'psi': 0.6715337270959894}-{'f1_val': 0.6658546896390478, 'auprc': 0.7167237942616602, 'loss_val': 1.0423379349406605, 'psi': 0.6862023314880927}
[S3] START round=42 head_norm_before_train=1.840701 cos_to_last_merge=0.7420 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.742
[S3] round=42 local utility u=0.101039 metrics={'f1_val': 0.9869061557238606, 'auprc': 0.9996106865668464, 'loss_val': 0.04129612255924339, 'psi': 0.9919879680610549}-{'f1_val': 0.9611152572344858, 'auprc': 0.9995823515988309, 'loss_val': 0.08854465131364449, 'psi': 0.9765020949802239}
[S4] START round=42 head_norm_before_train=2.001863 (no previous merge yet)
[S4] round=42 local utility u=0.040061 metrics={'f1_val': 0.9501227932545636, 'auprc': 0.976913991846894, 'loss_val': 0.311568211797978, 'psi': 0.9608392726914958}-{'f1_val': 0.9418098652018118, 'auprc': 0.9703418396419036, 'loss_val': 0.3220963416011758, 'psi': 0.9532226549778485}
[S5] START round=42 head_norm_before_train=1.579869 cos_to_last_merge=0.7841 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.784
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9942594389854104, 'loss_val': 0.06377219842050152, 'psi': 0.9954153895797507}-{'f1_val': 0.9963325909888239, 'auprc': 0.997578940722888, 'loss_val': 0.06504231004538999, 'psi': 0.9968311308824495}
[S6] START round=42 head_norm_before_train=1.921700 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7260017029756225, 'auprc': 0.9235198934993555, 'loss_val': 0.770299573628771, 'psi': 0.8050089791851156}-{'f1_val': 0.6949968308138015, 'auprc': 0.9756661377906679, 'loss_val': 0.37467654479494233, 'psi': 0.8072645536045481}
[S7] START round=42 head_norm_before_train=1.139352 cos_to_last_merge=0.9985 (last merge round=40)
[S7] round=42 local utility u=0.576118 metrics={'f1_val': 0.6780736620867689, 'auprc': 0.8175002756183372, 'loss_val': 0.5546250887436002, 'psi': 0.7338443074993962}-{'f1_val': 0.5632989303239317, 'auprc': 0.7754416160993414, 'loss_val': 0.8920369608197659, 'psi': 0.6481560046340956}
[S8] START round=42 head_norm_before_train=2.029962 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9715944828492281, 'auprc': 0.9988833532597814, 'loss_val': 0.0711733592797277, 'psi': 0.9825100310134494}-{'f1_val': 0.9866443177218471, 'auprc': 0.9989468828497277, 'loss_val': 0.044463783531595226, 'psi': 0.9915653437729993}
[S9] START round=42 head_norm_before_train=1.448026 cos_to_last_merge=0.9993 (last merge round=40)
[S9] round=42 local utility u=0.024907 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.997155541925029, 'loss_val': 0.07023315683927038, 'psi': 0.9973891507763979}-{'f1_val': 0.994356655862817, 'auprc': 0.9995354153650853, 'loss_val': 0.10805740724940681, 'psi': 0.9964281596637243}
[S10] START round=42 head_norm_before_train=1.737288 cos_to_last_merge=0.6226 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.623
[S10] round=42 local utility u=0.000462 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9935103892970467, 'loss_val': 0.03484730496560319, 'psi': 0.9945980280570569}-{'f1_val': 0.9953231205637304, 'auprc': 0.9934107910954979, 'loss_val': 0.03547232849281184, 'psi': 0.9945581887764374}
[S11] START round=42 head_norm_before_train=1.988168 cos_to_last_merge=0.7413 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.741
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9896714409008375, 'auprc': 0.9985041227679844, 'loss_val': 0.05065037504934068, 'psi': 0.9932045136476962}-{'f1_val': 0.9961336749133093, 'auprc': 0.9983156527463966, 'loss_val': 0.02442089962659957, 'psi': 0.9970064660465442}
[S13] START round=42 head_norm_before_train=1.133650 cos_to_last_merge=0.9994 (last merge round=40)
[S13] round=42 local utility u=0.045366 metrics={'f1_val': 0.6132704034632916, 'auprc': 0.6867884340574932, 'loss_val': 0.7219036525248715, 'psi': 0.6426776157009723}-{'f1_val': 0.6117179849462208, 'auprc': 0.6820552734174202, 'loss_val': 0.7891216019182, 'psi': 0.6398529003347005}
[S14] START round=42 head_norm_before_train=2.057080 (no previous merge yet)
[S14] round=42 local utility u=0.035280 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.999225652258032, 'loss_val': 0.021479855467642382, 'psi': 0.9980047338633051}-{'f1_val': 0.9894424265578219, 'auprc': 0.9974481851091107, 'loss_val': 0.04021666530067515, 'psi': 0.9926447299783374}
[S15] START round=42 head_norm_before_train=2.141938 (no previous merge yet)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.9028842147678221, 'auprc': 0.9918746974010777, 'loss_val': 0.1624840709544306, 'psi': 0.9384804078211244}-{'f1_val': 0.9967466683875206, 'auprc': 0.9978786766812661, 'loss_val': 0.02504490926227871, 'psi': 0.9971994717050188}
[S16] START round=42 head_norm_before_train=1.794060 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9907813356731983, 'auprc': 0.9914466858800077, 'loss_val': 0.04691403048816561, 'psi': 0.991047475755922}-{'f1_val': 0.9916748123662961, 'auprc': 0.9919487146067705, 'loss_val': 0.039173406319295695, 'psi': 0.9917843732624858}
[S17] START round=42 head_norm_before_train=1.949552 (no previous merge yet)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.5963694737816825, 'auprc': 0.8571730522940032, 'loss_val': 1.0122304885065536, 'psi': 0.7006909051866108}-{'f1_val': 0.600285316303081, 'auprc': 0.9226396870546021, 'loss_val': 0.91186948860588, 'psi': 0.7292270646036895}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:61805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:61802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:61813
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S9
[S15] cosine check vs S9: cos=0.7077
[S13] RECEIVED delta(kind=head bytes=1794) from S7
[S13] cosine check vs S7: cos=0.6166
[S5] RECEIVED delta(kind=head bytes=1796) from S13
[S5] cosine check vs S13: cos=0.8091
[S2] RECEIVED delta(kind=head bytes=1794) from S4
[S2] cosine check vs S4: cos=-0.0493
[S2] DROPPED delta from S4 (cos=-0.0493 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=42 metric=0.9029 head_norm=2.150191
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.596231e-01
[S15] stored merged vector for next round verification (round=42)
[S15] DEBUG after merge:  round=42 metric=0.9023 head_norm=1.691825 delta_norm=0.759623
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=42 metric=0.6133 head_norm=1.155966
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.080861e-01
[S13] stored merged vector for next round verification (round=42)
[S13] DEBUG after merge:  round=42 metric=0.6126 head_norm=1.043276 delta_norm=0.508086
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=42 metric=0.9962 head_norm=1.589702
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.716704e-01
[S5] stored merged vector for next round verification (round=42)
[S5] DEBUG after merge:  round=42 metric=0.9962 head_norm=1.307376 delta_norm=0.471670
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.792375 cos_to_last_merge=0.9997 (last merge round=36)
[S2] round=43 local utility u=0.104869 metrics={'f1_val': 0.6636528480991677, 'auprc': 0.705284230544347, 'loss_val': 1.0480918160576436, 'psi': 0.6803054010772394}-{'f1_val': 0.6431127635984414, 'auprc': 0.7141651723423111, 'loss_val': 1.161231156773747, 'psi': 0.6715337270959894}
[S3] START round=43 head_norm_before_train=1.855340 cos_to_last_merge=0.7414 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.741
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9834700229051168, 'auprc': 0.9996072520355073, 'loss_val': 0.04855352772398436, 'psi': 0.9899249145572729}-{'f1_val': 0.9869061557238606, 'auprc': 0.9996106865668464, 'loss_val': 0.04129612255924339, 'psi': 0.9919879680610549}
[S4] START round=43 head_norm_before_train=1.997401 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9395004838272746, 'auprc': 0.9513397402605326, 'loss_val': 0.33234911077287127, 'psi': 0.9442361864005777}-{'f1_val': 0.9501227932545636, 'auprc': 0.976913991846894, 'loss_val': 0.311568211797978, 'psi': 0.9608392726914958}
[S5] START round=43 head_norm_before_train=1.307376 cos_to_last_merge=1.0000 (last merge round=42)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9950106081032215, 'loss_val': 0.10282555971578143, 'psi': 0.9958037978345828}-{'f1_val': 0.996186023309311, 'auprc': 0.9942594389854104, 'loss_val': 0.06377219842050152, 'psi': 0.9954153895797507}
[S6] START round=43 head_norm_before_train=1.924736 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.727693035391688, 'auprc': 0.7749056401400807, 'loss_val': 0.8082586640650575, 'psi': 0.7465780772910451}-{'f1_val': 0.7260017029756225, 'auprc': 0.9235198934993555, 'loss_val': 0.770299573628771, 'psi': 0.8050089791851156}
[S7] START round=43 head_norm_before_train=1.164859 cos_to_last_merge=0.9952 (last merge round=40)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.6417290179985091, 'auprc': 0.7950611020821281, 'loss_val': 0.6468876557746224, 'psi': 0.7030618516319567}-{'f1_val': 0.6780736620867689, 'auprc': 0.8175002756183372, 'loss_val': 0.5546250887436002, 'psi': 0.7338443074993962}
[S8] START round=43 head_norm_before_train=2.039713 (no previous merge yet)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9634981096906562, 'auprc': 0.9857880875920034, 'loss_val': 0.0895650999809964, 'psi': 0.9724141008511951}-{'f1_val': 0.9715944828492281, 'auprc': 0.9988833532597814, 'loss_val': 0.0711733592797277, 'psi': 0.9825100310134494}
[S9] START round=43 head_norm_before_train=1.501757 cos_to_last_merge=0.9958 (last merge round=40)
[S9] round=43 local utility u=0.007484 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9967766426236432, 'loss_val': 0.051666040746789675, 'psi': 0.9969913362080922}-{'f1_val': 0.9975448900106438, 'auprc': 0.997155541925029, 'loss_val': 0.07023315683927038, 'psi': 0.9973891507763979}
[S10] START round=43 head_norm_before_train=1.747473 cos_to_last_merge=0.6217 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.622
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9932274200841411, 'loss_val': 0.03457386123362677, 'psi': 0.9944848403718947}-{'f1_val': 0.9953231205637304, 'auprc': 0.9935103892970467, 'loss_val': 0.03484730496560319, 'psi': 0.9945980280570569}
[S11] START round=43 head_norm_before_train=1.997597 cos_to_last_merge=0.7408 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.741
[S11] round=43 local utility u=0.031815 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981942028783786, 'loss_val': 0.02486441472559026, 'psi': 0.996957886099337}-{'f1_val': 0.9896714409008375, 'auprc': 0.9985041227679844, 'loss_val': 0.05065037504934068, 'psi': 0.9932045136476962}
[S13] START round=43 head_norm_before_train=1.043276 cos_to_last_merge=1.0000 (last merge round=42)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6107262616282862, 'auprc': 0.6339947371154855, 'loss_val': 0.6939914759621708, 'psi': 0.6200336518231659}-{'f1_val': 0.6132704034632916, 'auprc': 0.6867884340574932, 'loss_val': 0.7219036525248715, 'psi': 0.6426776157009723}
[S14] START round=43 head_norm_before_train=2.064163 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9970668003848504, 'loss_val': 0.023927101035602107, 'psi': 0.997273316714637}-{'f1_val': 0.9971907882668205, 'auprc': 0.999225652258032, 'loss_val': 0.021479855467642382, 'psi': 0.9980047338633051}
[S15] START round=43 head_norm_before_train=1.691825 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=43 local utility u=0.024079 metrics={'f1_val': 0.903170176196454, 'auprc': 0.9973457714141514, 'loss_val': 0.1324556424885352, 'psi': 0.9408404142835329}-{'f1_val': 0.9028842147678221, 'auprc': 0.9918746974010777, 'loss_val': 0.1624840709544306, 'psi': 0.9384804078211244}
[S16] START round=43 head_norm_before_train=1.800105 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.8683644197012763, 'auprc': 0.8824416919098411, 'loss_val': 0.8471949930097918, 'psi': 0.8739953285847022}-{'f1_val': 0.9907813356731983, 'auprc': 0.9914466858800077, 'loss_val': 0.04691403048816561, 'psi': 0.991047475755922}
[S17] START round=43 head_norm_before_train=1.960573 (no previous merge yet)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.5823119059463455, 'auprc': 0.8703052292756466, 'loss_val': 0.9764500296709083, 'psi': 0.697509235278066}-{'f1_val': 0.5963694737816825, 'auprc': 0.8571730522940032, 'loss_val': 1.0122304885065536, 'psi': 0.7006909051866108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:61816
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:61815
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:61804
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S11
[S4] cosine check vs S11: cos=-0.1170
[S4] DROPPED delta from S11 (cos=-0.1170 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S15
[S8] cosine check vs S15: cos=-0.0623
[S8] DROPPED delta from S15 (cos=-0.0623 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S2
[S16] cosine check vs S2: cos=0.9992
[S15] RECEIVED delta(kind=head bytes=1804) from S9
[S15] cosine check vs S9: cos=0.8745
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=43 metric=0.9032 head_norm=1.705601
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.151440e-01
[S15] stored merged vector for next round verification (round=43)
[S15] DEBUG after merge:  round=43 metric=0.9032 head_norm=1.581462 delta_norm=0.415144
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=43 metric=0.8684 head_norm=1.806565
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.558509e-02
[S16] stored merged vector for next round verification (round=43)
[S16] DEBUG after merge:  round=43 metric=0.8686 head_norm=1.804700 delta_norm=0.035585
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.803537 cos_to_last_merge=0.9995 (last merge round=36)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.6287806151799218, 'auprc': 0.6956197354800634, 'loss_val': 1.211127703057555, 'psi': 0.6555162632999785}-{'f1_val': 0.6636528480991677, 'auprc': 0.705284230544347, 'loss_val': 1.0480918160576436, 'psi': 0.6803054010772394}
[S3] START round=44 head_norm_before_train=1.869185 cos_to_last_merge=0.7408 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.741
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9996122080098819, 'loss_val': 0.08329615126396847, 'psi': 0.9764899344436251}-{'f1_val': 0.9834700229051168, 'auprc': 0.9996072520355073, 'loss_val': 0.04855352772398436, 'psi': 0.9899249145572729}
[S4] START round=44 head_norm_before_train=1.992013 (no previous merge yet)
[S4] round=44 local utility u=0.030051 metrics={'f1_val': 0.9426255405854556, 'auprc': 0.9596627653059571, 'loss_val': 0.31596697921170475, 'psi': 0.9494404304736561}-{'f1_val': 0.9395004838272746, 'auprc': 0.9513397402605326, 'loss_val': 0.33234911077287127, 'psi': 0.9442361864005777}
[S5] START round=44 head_norm_before_train=1.322430 cos_to_last_merge=0.9999 (last merge round=42)
[S5] round=44 local utility u=0.010038 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9968449202536104, 'loss_val': 0.08825196046330333, 'psi': 0.9965375226947384}-{'f1_val': 0.9963325909888239, 'auprc': 0.9950106081032215, 'loss_val': 0.10282555971578143, 'psi': 0.9958037978345828}
[S6] START round=44 head_norm_before_train=1.931268 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6208045922472165, 'auprc': 0.9498648758722361, 'loss_val': 0.8673638588564194, 'psi': 0.7524287056972243}-{'f1_val': 0.727693035391688, 'auprc': 0.7749056401400807, 'loss_val': 0.8082586640650575, 'psi': 0.7465780772910451}
[S7] START round=44 head_norm_before_train=1.194020 cos_to_last_merge=0.9902 (last merge round=40)
[S7] round=44 local utility u=0.021074 metrics={'f1_val': 0.6397446339019096, 'auprc': 0.7980066748529369, 'loss_val': 0.6016701153501297, 'psi': 0.7030494502823206}-{'f1_val': 0.6417290179985091, 'auprc': 0.7950611020821281, 'loss_val': 0.6468876557746224, 'psi': 0.7030618516319567}
[S8] START round=44 head_norm_before_train=2.045318 (no previous merge yet)
[S8] round=44 local utility u=0.137136 metrics={'f1_val': 0.9931022471969293, 'auprc': 0.9989978850088166, 'loss_val': 0.03254803092247646, 'psi': 0.9954605023216841}-{'f1_val': 0.9634981096906562, 'auprc': 0.9857880875920034, 'loss_val': 0.0895650999809964, 'psi': 0.9724141008511951}
[S9] START round=44 head_norm_before_train=1.561301 cos_to_last_merge=0.9904 (last merge round=40)
[S9] round=44 local utility u=0.002194 metrics={'f1_val': 0.99518968612894, 'auprc': 0.998802976611954, 'loss_val': 0.0416890411518882, 'psi': 0.9966350023221456}-{'f1_val': 0.9971344652643916, 'auprc': 0.9967766426236432, 'loss_val': 0.051666040746789675, 'psi': 0.9969913362080922}
[S10] START round=44 head_norm_before_train=1.758190 cos_to_last_merge=0.6207 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.621
[S10] round=44 local utility u=0.000257 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9935741220821976, 'loss_val': 0.0337811864021154, 'psi': 0.994491729678538}-{'f1_val': 0.9953231205637304, 'auprc': 0.9932274200841411, 'loss_val': 0.03457386123362677, 'psi': 0.9944848403718947}
[S11] START round=44 head_norm_before_train=2.006134 cos_to_last_merge=0.7404 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.740
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9980939911064535, 'loss_val': 0.025248521437236732, 'psi': 0.9967726991637298}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981942028783786, 'loss_val': 0.02486441472559026, 'psi': 0.996957886099337}
[S13] START round=44 head_norm_before_train=1.067497 cos_to_last_merge=0.9994 (last merge round=42)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.571094405363501, 'auprc': 0.6891584797624848, 'loss_val': 0.9211470313303542, 'psi': 0.6183200351230945}-{'f1_val': 0.6107262616282862, 'auprc': 0.6339947371154855, 'loss_val': 0.6939914759621708, 'psi': 0.6200336518231659}
[S14] START round=44 head_norm_before_train=2.069524 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9966112661484454, 'loss_val': 0.022681702358867798, 'psi': 0.9968449343879249}-{'f1_val': 0.9974109942678281, 'auprc': 0.9970668003848504, 'loss_val': 0.023927101035602107, 'psi': 0.997273316714637}
[S15] START round=44 head_norm_before_train=1.581462 cos_to_last_merge=1.0000 (last merge round=43)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.9004902338179431, 'auprc': 0.9965575543615852, 'loss_val': 0.16737538707093766, 'psi': 0.9389171620354}-{'f1_val': 0.903170176196454, 'auprc': 0.9973457714141514, 'loss_val': 0.1324556424885352, 'psi': 0.9408404142835329}
[S16] START round=44 head_norm_before_train=1.804700 cos_to_last_merge=1.0000 (last merge round=43)
[S16] round=44 local utility u=0.927821 metrics={'f1_val': 0.991098354850005, 'auprc': 0.988032473217731, 'loss_val': 0.04472929489152868, 'psi': 0.9898720021970955}-{'f1_val': 0.8683644197012763, 'auprc': 0.8824416919098411, 'loss_val': 0.8471949930097918, 'psi': 0.8739953285847022}
[S17] START round=44 head_norm_before_train=1.972798 (no previous merge yet)
[S17] round=44 local utility u=0.112837 metrics={'f1_val': 0.5946895959873261, 'auprc': 0.9014696978919252, 'loss_val': 0.9185359665494394, 'psi': 0.7174016367491658}-{'f1_val': 0.5823119059463455, 'auprc': 0.8703052292756466, 'loss_val': 0.9764500296709083, 'psi': 0.697509235278066}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:61802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:61807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:61815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S8
[S7] cosine check vs S8: cos=-0.0243
[S7] DROPPED delta from S8 (cos=-0.0243 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S5
[S6] cosine check vs S5: cos=-0.0322
[S6] DROPPED delta from S5 (cos=-0.0322 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] cosine check vs S4: cos=-0.0508
[S2] DROPPED delta from S4 (cos=-0.0508 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S9
[S15] cosine check vs S9: cos=0.9536
[S13] RECEIVED delta(kind=head bytes=1800) from S7
[S13] cosine check vs S7: cos=0.8832
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=44 metric=0.9005 head_norm=1.611245
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.457441e-01
[S15] stored merged vector for next round verification (round=44)
[S15] DEBUG after merge:  round=44 metric=0.9006 head_norm=1.594035 delta_norm=0.245744
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=44 metric=0.5711 head_norm=1.091230
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.863442e-01
[S13] stored merged vector for next round verification (round=44)
[S13] DEBUG after merge:  round=44 metric=0.5726 head_norm=1.121904 delta_norm=0.286344
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.814176 cos_to_last_merge=0.9994 (last merge round=36)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.6067721780402094, 'auprc': 0.6830486901850432, 'loss_val': 1.3925197336463562, 'psi': 0.6372827828981429}-{'f1_val': 0.6287806151799218, 'auprc': 0.6956197354800634, 'loss_val': 1.211127703057555, 'psi': 0.6555162632999785}
[S3] START round=45 head_norm_before_train=1.881637 cos_to_last_merge=0.7403 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.740
[S3] round=45 local utility u=0.139069 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9996088661058086, 'loss_val': 0.02308780730554341, 'psi': 0.9982824879099579}-{'f1_val': 0.9610750853994537, 'auprc': 0.9996122080098819, 'loss_val': 0.08329615126396847, 'psi': 0.9764899344436251}
[S4] START round=45 head_norm_before_train=1.984214 (no previous merge yet)
[S4] round=45 local utility u=0.064900 metrics={'f1_val': 0.9537905565480476, 'auprc': 0.9744517859983969, 'loss_val': 0.29752330427709117, 'psi': 0.9620550483281873}-{'f1_val': 0.9426255405854556, 'auprc': 0.9596627653059571, 'loss_val': 0.31596697921170475, 'psi': 0.9494404304736561}
[S5] START round=45 head_norm_before_train=1.347438 cos_to_last_merge=0.9993 (last merge round=42)
[S5] round=45 local utility u=0.005423 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9973681323352874, 'loss_val': 0.07897572690230974, 'psi': 0.9967468075274093}-{'f1_val': 0.9963325909888239, 'auprc': 0.9968449202536104, 'loss_val': 0.08825196046330333, 'psi': 0.9965375226947384}
[S6] START round=45 head_norm_before_train=1.938228 (no previous merge yet)
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.8676193568901986, 'auprc': 0.9683968235070755, 'loss_val': 0.39333228532089365, 'psi': 0.9079303435369493}-{'f1_val': 0.6208045922472165, 'auprc': 0.9498648758722361, 'loss_val': 0.8673638588564194, 'psi': 0.7524287056972243}
[S7] START round=45 head_norm_before_train=1.220877 cos_to_last_merge=0.9849 (last merge round=40)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5359000324834051, 'auprc': 0.7757291683926593, 'loss_val': 0.9266431010899003, 'psi': 0.6318316868471068}-{'f1_val': 0.6397446339019096, 'auprc': 0.7980066748529369, 'loss_val': 0.6016701153501297, 'psi': 0.7030494502823206}
[S8] START round=45 head_norm_before_train=2.049626 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9931113357884451, 'auprc': 0.999003864494269, 'loss_val': 0.033230162682020475, 'psi': 0.9954683472707746}-{'f1_val': 0.9931022471969293, 'auprc': 0.9989978850088166, 'loss_val': 0.03254803092247646, 'psi': 0.9954605023216841}
[S9] START round=45 head_norm_before_train=1.614487 cos_to_last_merge=0.9850 (last merge round=40)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.991254331540241, 'auprc': 0.9987853053544913, 'loss_val': 0.04428351627224669, 'psi': 0.994266721065941}-{'f1_val': 0.99518968612894, 'auprc': 0.998802976611954, 'loss_val': 0.0416890411518882, 'psi': 0.9966350023221456}
[S10] START round=45 head_norm_before_train=1.769201 cos_to_last_merge=0.6197 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.620
[S10] round=45 local utility u=0.000751 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9935158267094941, 'loss_val': 0.03342237745355337, 'psi': 0.9946002030220358}-{'f1_val': 0.9951034680760983, 'auprc': 0.9935741220821976, 'loss_val': 0.0337811864021154, 'psi': 0.994491729678538}
[S11] START round=45 head_norm_before_train=2.012639 cos_to_last_merge=0.7392 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.739
[S11] round=45 local utility u=0.000390 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9981296357061458, 'loss_val': 0.024575961636154692, 'psi': 0.9967869570036068}-{'f1_val': 0.9958918378685807, 'auprc': 0.9980939911064535, 'loss_val': 0.025248521437236732, 'psi': 0.9967726991637298}
[S13] START round=45 head_norm_before_train=1.121904 cos_to_last_merge=1.0000 (last merge round=44)
[S13] round=45 local utility u=0.077168 metrics={'f1_val': 0.6099355448894592, 'auprc': 0.6018343643003831, 'loss_val': 0.7378853101062648, 'psi': 0.6066950726538287}-{'f1_val': 0.571094405363501, 'auprc': 0.6891584797624848, 'loss_val': 0.9211470313303542, 'psi': 0.6183200351230945}
[S14] START round=45 head_norm_before_train=2.078496 (no previous merge yet)
[S14] round=45 local utility u=0.005688 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9990528356738517, 'loss_val': 0.020086893453549907, 'psi': 0.9979672713269641}-{'f1_val': 0.9970007132142444, 'auprc': 0.9966112661484454, 'loss_val': 0.022681702358867798, 'psi': 0.9968449343879249}
[S15] START round=45 head_norm_before_train=1.594035 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=45 local utility u=0.347003 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9983298236976637, 'loss_val': 0.056223991734272095, 'psi': 0.9973799305115778}-{'f1_val': 0.9004902338179431, 'auprc': 0.9965575543615852, 'loss_val': 0.16737538707093766, 'psi': 0.9389171620354}
[S16] START round=45 head_norm_before_train=1.812639 cos_to_last_merge=1.0000 (last merge round=43)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9460398987564612, 'auprc': 0.9808818712527421, 'loss_val': 0.21742202589360363, 'psi': 0.9599766877549736}-{'f1_val': 0.991098354850005, 'auprc': 0.988032473217731, 'loss_val': 0.04472929489152868, 'psi': 0.9898720021970955}
[S17] START round=45 head_norm_before_train=1.981068 (no previous merge yet)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.549536986592918, 'auprc': 0.7392635660448045, 'loss_val': 1.2908080974794975, 'psi': 0.6254276183736727}-{'f1_val': 0.5946895959873261, 'auprc': 0.9014696978919252, 'loss_val': 0.9185359665494394, 'psi': 0.7174016367491658}
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S16
[S9]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S17
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S4
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:61805
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:61807
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:61802
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:61809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:61804
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.071 → S16@127.0.0.1:61816
[S13] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S8] ⇄ pheromone p=0.038 → S7@127.0.0.1:61808
[S11] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S9] ⇄ pheromone p=0.005 → S15@127.0.0.1:61815
[S5] sending update (kind=head size=1794 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] cosine check vs S11: cos=-0.1196
[S4] DROPPED delta from S11 (cos=-0.1196 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S13
[S5] cosine check vs S13: cos=0.7575
[S6] RECEIVED delta(kind=head bytes=1794) from S5
[S6] cosine check vs S5: cos=-0.0318
[S6] DROPPED delta from S5 (cos=-0.0318 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S4
[S2] cosine check vs S4: cos=-0.0519
[S2] DROPPED delta from S4 (cos=-0.0519 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1806) from S15
[S8] cosine check vs S15: cos=-0.0501
[S8] DROPPED delta from S15 (cos=-0.0501 < 0.0)
[S15] ⇄ pheromone p=0.126 → S8@127.0.0.1:61809
[S4] ⇄ pheromone p=0.028 → S2@127.0.0.1:61802
[S11] ⇄ pheromone p=0.034 → S4@127.0.0.1:61804
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=45 metric=0.9963 head_norm=1.369573
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.500431e-01
[S5] stored merged vector for next round verification (round=45)
[S5] DEBUG after merge:  round=45 metric=0.9963 head_norm=1.177659 delta_norm=0.450043
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.065 → S6@127.0.0.1:61807
[S7] ⇄ pheromone p=0.157 → S13@127.0.0.1:61813
[S13] CommDone barrier timeout: have=1 need=2 — continuing
[S13] ⇄ pheromone p=0.029 → S5@127.0.0.1:61805
[S2] START round=46 head_norm_before_train=1.824702 cos_to_last_merge=0.9991 (last merge round=36)
[S2] round=46 local utility u=0.146455 metrics={'f1_val': 0.6340724452107382, 'auprc': 0.683522443301064, 'loss_val': 1.2648334302471338, 'psi': 0.6538524444468685}-{'f1_val': 0.6067721780402094, 'auprc': 0.6830486901850432, 'loss_val': 1.3925197336463562, 'psi': 0.6372827828981429}
[S3] START round=46 head_norm_before_train=1.893618 cos_to_last_merge=0.7397 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.740
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9522165639571257, 'auprc': 0.9999751317249075, 'loss_val': 0.1257427753266039, 'psi': 0.9713199910642384}-{'f1_val': 0.9973982357793907, 'auprc': 0.9996088661058086, 'loss_val': 0.02308780730554341, 'psi': 0.9982824879099579}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.982126 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9514167210124225, 'auprc': 0.9747247510706329, 'loss_val': 0.3036766347296764, 'psi': 0.9607399330357067}-{'f1_val': 0.9537905565480476, 'auprc': 0.9744517859983969, 'loss_val': 0.29752330427709117, 'psi': 0.9620550483281873}
[S5] START round=46 head_norm_before_train=1.177659 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9962287614375678, 'loss_val': 0.12805026184386598, 'psi': 0.9962031185606137}-{'f1_val': 0.9963325909888239, 'auprc': 0.9973681323352874, 'loss_val': 0.07897572690230974, 'psi': 0.9967468075274093}
[S6] START round=46 head_norm_before_train=1.942528 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.5800033121530591, 'auprc': 0.6758335622121568, 'loss_val': 1.1928592283976838, 'psi': 0.6183354121766982}-{'f1_val': 0.8676193568901986, 'auprc': 0.9683968235070755, 'loss_val': 0.39333228532089365, 'psi': 0.9079303435369493}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.241334 cos_to_last_merge=0.9805 (last merge round=40)
[S7] round=46 local utility u=0.651637 metrics={'f1_val': 0.6587359519893418, 'auprc': 0.8230879150971652, 'loss_val': 0.502460407701412, 'psi': 0.7244767372324712}-{'f1_val': 0.5359000324834051, 'auprc': 0.7757291683926593, 'loss_val': 0.9266431010899003, 'psi': 0.6318316868471068}
[S8] START round=46 head_norm_before_train=2.055504 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9867122114722444, 'auprc': 0.9979971457679028, 'loss_val': 0.04224564062818462, 'psi': 0.9912261851905078}-{'f1_val': 0.9931113357884451, 'auprc': 0.999003864494269, 'loss_val': 0.033230162682020475, 'psi': 0.9954683472707746}
[S9] START round=46 head_norm_before_train=1.658740 cos_to_last_merge=0.9804 (last merge round=40)
[S9] round=46 local utility u=0.018551 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9945068290010926, 'loss_val': 0.029437809811122043, 'psi': 0.9960644791077227}-{'f1_val': 0.991254331540241, 'auprc': 0.9987853053544913, 'loss_val': 0.04428351627224669, 'psi': 0.994266721065941}
[S10] START round=46 head_norm_before_train=1.776832 cos_to_last_merge=0.6191 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.619
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9932329801961586, 'loss_val': 0.03320035562773845, 'psi': 0.9944870644167016}-{'f1_val': 0.9953231205637304, 'auprc': 0.9935158267094941, 'loss_val': 0.03342237745355337, 'psi': 0.9946002030220358}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=2.019569 cos_to_last_merge=0.7381 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.738
[S11] round=46 local utility u=0.001499 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9984589361768945, 'loss_val': 0.0240167655151226, 'psi': 0.9970637794187434}-{'f1_val': 0.9958918378685807, 'auprc': 0.9981296357061458, 'loss_val': 0.024575961636154692, 'psi': 0.9967869570036068}
[S13] START round=46 head_norm_before_train=1.141537 cos_to_last_merge=0.9994 (last merge round=44)
[S13] round=46 local utility u=0.027618 metrics={'f1_val': 0.5948724281255525, 'auprc': 0.6787721818615577, 'loss_val': 0.8230833910035283, 'psi': 0.6284323296199545}-{'f1_val': 0.6099355448894592, 'auprc': 0.6018343643003831, 'loss_val': 0.7378853101062648, 'psi': 0.6066950726538287}
[S14] START round=46 head_norm_before_train=2.089092 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9972183481640888, 'auprc': 0.9986716702048806, 'loss_val': 0.019212748823838506, 'psi': 0.9977996769804055}-{'f1_val': 0.9972435617623723, 'auprc': 0.9990528356738517, 'loss_val': 0.020086893453549907, 'psi': 0.9979672713269641}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.632668 cos_to_last_merge=0.9996 (last merge round=44)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.9596657944499365, 'auprc': 0.998457271629529, 'loss_val': 0.0793276095296274, 'psi': 0.9751823853217736}-{'f1_val': 0.9967466683875206, 'auprc': 0.9983298236976637, 'loss_val': 0.056223991734272095, 'psi': 0.9973799305115778}
[S16] START round=46 head_norm_before_train=1.822231 cos_to_last_merge=1.0000 (last merge round=43)
[S16] round=46 local utility u=0.163162 metrics={'f1_val': 0.9776118187697102, 'auprc': 0.9848831775113344, 'loss_val': 0.09253430984377459, 'psi': 0.9805203622663599}-{'f1_val': 0.9460398987564612, 'auprc': 0.9808818712527421, 'loss_val': 0.21742202589360363, 'psi': 0.9599766877549736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=46 head_norm_before_train=1.984635 (no previous merge yet)
[S17] round=46 local utility u=0.442316 metrics={'f1_val': 0.5772555243121994, 'auprc': 0.9158974641974468, 'loss_val': 1.1023890524452526, 'psi': 0.7127123002662983}-{'f1_val': 0.549536986592918, 'auprc': 0.7392635660448045, 'loss_val': 1.2908080974794975, 'psi': 0.6254276183736727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:61816
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61813
[S16] RECEIVED delta(kind=head bytes=1804) from S2
[S16] cosine check vs S2: cos=0.9992
[S7] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] cosine check vs S7: cos=0.9602
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:61804
[S11] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S11
[S4] cosine check vs S11: cos=-0.1204
[S4] DROPPED delta from S11 (cos=-0.1204 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:61815
[S9] sending update (kind=head size=1806 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1806) from S9
[S15] cosine check vs S9: cos=0.9721
[S2]  timeout peer S16
[S9]  timeout peer S15
[S15]  timeout peer S8
[S8]  timeout peer S7
[S11]  timeout peer S4
[S11]  timeout peer S9
[S5]  timeout peer S6
[S5]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S4]  timeout peer S2
[S4]  timeout peer S10
[S13]  timeout peer S3
[S13]  timeout peer S5
[S13]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] sending update (kind=head size=1792 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=46 metric=0.5949 head_norm=1.158612
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.778197e-01
[S13] stored merged vector for next round verification (round=46)
[S13] DEBUG after merge:  round=46 metric=0.5979 head_norm=1.197366 delta_norm=0.177820
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=1.833871 cos_to_last_merge=0.9989 (last merge round=36)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.6133858417479097, 'auprc': 0.6791130820600787, 'loss_val': 1.4295157557563398, 'psi': 0.6396767378727772}-{'f1_val': 0.6340724452107382, 'auprc': 0.683522443301064, 'loss_val': 1.2648334302471338, 'psi': 0.6538524444468685}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.903175 cos_to_last_merge=0.7391 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.739
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9051603538790813, 'auprc': 0.9999497880627236, 'loss_val': 0.19500677973841357, 'psi': 0.9430761275525382}-{'f1_val': 0.9522165639571257, 'auprc': 0.9999751317249075, 'loss_val': 0.1257427753266039, 'psi': 0.9713199910642384}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.976405 (no previous merge yet)
[S4] round=47 local utility u=0.000084 metrics={'f1_val': 0.9503150051823525, 'auprc': 0.9768649867258182, 'loss_val': 0.3033185584936941, 'psi': 0.9609349977997388}-{'f1_val': 0.9514167210124225, 'auprc': 0.9747247510706329, 'loss_val': 0.3036766347296764, 'psi': 0.9607399330357067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=47 head_norm_before_train=1.204933 cos_to_last_merge=0.9996 (last merge round=45)
[S5] round=47 local utility u=0.008524 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9933800992854842, 'loss_val': 0.10245676563356404, 'psi': 0.9950636536997803}-{'f1_val': 0.996186023309311, 'auprc': 0.9962287614375678, 'loss_val': 0.12805026184386598, 'psi': 0.9962031185606137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=47 head_norm_before_train=1.947308 (no previous merge yet)
[S6] round=47 local utility u=1.000000 metrics={'f1_val': 0.7979818312458713, 'auprc': 0.9397425058668925, 'loss_val': 0.4671752856091104, 'psi': 0.8546861010942797}-{'f1_val': 0.5800033121530591, 'auprc': 0.6758335622121568, 'loss_val': 1.1928592283976838, 'psi': 0.6183354121766982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=47 head_norm_before_train=1.260249 cos_to_last_merge=0.9767 (last merge round=40)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5660137145789388, 'auprc': 0.7897452352719035, 'loss_val': 0.795743298780571, 'psi': 0.6555063228561246}-{'f1_val': 0.6587359519893418, 'auprc': 0.8230879150971652, 'loss_val': 0.502460407701412, 'psi': 0.7244767372324712}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.063500 (no previous merge yet)
[S8] round=47 local utility u=0.016835 metrics={'f1_val': 0.9941873288509412, 'auprc': 0.992338008285078, 'loss_val': 0.0364487329372875, 'psi': 0.9934476006245959}-{'f1_val': 0.9867122114722444, 'auprc': 0.9979971457679028, 'loss_val': 0.04224564062818462, 'psi': 0.9912261851905078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=47 head_norm_before_train=1.693251 cos_to_last_merge=0.9768 (last merge round=40)
[S9] round=47 local utility u=0.005489 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9974390656819352, 'loss_val': 0.027255884940537423, 'psi': 0.9972373737800597}-{'f1_val': 0.9971029125121428, 'auprc': 0.9945068290010926, 'loss_val': 0.029437809811122043, 'psi': 0.9960644791077227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=47 head_norm_before_train=1.784719 cos_to_last_merge=0.6185 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.619
[S10] round=47 local utility u=0.001334 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9943802518283731, 'loss_val': 0.03265587964125863, 'psi': 0.9948141815770082}-{'f1_val': 0.9953231205637304, 'auprc': 0.9932329801961586, 'loss_val': 0.03320035562773845, 'psi': 0.9944870644167016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=47 head_norm_before_train=2.026705 cos_to_last_merge=0.7374 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.737
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9983613870839405, 'loss_val': 0.023842361154711902, 'psi': 0.9970247597815618}-{'f1_val': 0.9961336749133093, 'auprc': 0.9984589361768945, 'loss_val': 0.0240167655151226, 'psi': 0.9970637794187434}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.197366 cos_to_last_merge=1.0000 (last merge round=46)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.5981778981106438, 'auprc': 0.6039688835819483, 'loss_val': 0.8327934955490423, 'psi': 0.6004942922991656}-{'f1_val': 0.5948724281255525, 'auprc': 0.6787721818615577, 'loss_val': 0.8230833910035283, 'psi': 0.6284323296199545}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.100497 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9989612411562707, 'loss_val': 0.0198806915584529, 'psi': 0.9977830013571074}-{'f1_val': 0.9972183481640888, 'auprc': 0.9986716702048806, 'loss_val': 0.019212748823838506, 'psi': 0.9977996769804055}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.683278 cos_to_last_merge=0.9981 (last merge round=44)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.9010440201688609, 'auprc': 0.997036610347773, 'loss_val': 0.16150056058098156, 'psi': 0.9394410562404256}-{'f1_val': 0.9596657944499365, 'auprc': 0.998457271629529, 'loss_val': 0.0793276095296274, 'psi': 0.9751823853217736}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=47 metric=0.9010 head_norm=1.733725
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.236774e-01
[S15] stored merged vector for next round verification (round=47)
[S15] DEBUG after merge:  round=47 metric=0.9010 head_norm=1.698946 delta_norm=0.223677
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] START round=47 head_norm_before_train=1.832413 cos_to_last_merge=0.9999 (last merge round=43)
[S16] round=47 local utility u=0.087743 metrics={'f1_val': 0.9934846877988823, 'auprc': 0.9920072523096517, 'loss_val': 0.033657247908919496, 'psi': 0.9928937136031901}-{'f1_val': 0.9776118187697102, 'auprc': 0.9848831775113344, 'loss_val': 0.09253430984377459, 'psi': 0.9805203622663599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=47 metric=0.9935 head_norm=1.842796
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.800413e-02
[S16] stored merged vector for next round verification (round=47)
[S16] DEBUG after merge:  round=47 metric=0.9935 head_norm=1.837946 delta_norm=0.038004
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] START round=47 head_norm_before_train=1.990564 (no previous merge yet)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5642208252463464, 'auprc': 0.9053057908735997, 'loss_val': 1.1980656849572793, 'psi': 0.7006548114972477}-{'f1_val': 0.5772555243121994, 'auprc': 0.9158974641974468, 'loss_val': 1.1023890524452526, 'psi': 0.7127123002662983}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.843565 cos_to_last_merge=0.9987 (last merge round=36)
[S2] round=48 local utility u=0.140048 metrics={'f1_val': 0.6317270805419208, 'auprc': 0.6911900598849041, 'loss_val': 1.2956974827671688, 'psi': 0.6555122722791141}-{'f1_val': 0.6133858417479097, 'auprc': 0.6791130820600787, 'loss_val': 1.4295157557563398, 'psi': 0.6396767378727772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=48 head_norm_before_train=1.911367 cos_to_last_merge=0.7387 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.739
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.8480057973346564, 'auprc': 0.9998605130591365, 'loss_val': 0.2087733626501432, 'psi': 0.9087476836244485}-{'f1_val': 0.9051603538790813, 'auprc': 0.9999497880627236, 'loss_val': 0.19500677973841357, 'psi': 0.9430761275525382}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.972714 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9488374905999293, 'auprc': 0.9677918173081934, 'loss_val': 0.3017527646405577, 'psi': 0.9564192212832349}-{'f1_val': 0.9503150051823525, 'auprc': 0.9768649867258182, 'loss_val': 0.3033185584936941, 'psi': 0.9609349977997388}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.259793 cos_to_last_merge=0.9975 (last merge round=45)
[S5] round=48 local utility u=0.016687 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9966310522060439, 'loss_val': 0.07883517510178496, 'psi': 0.9963640348680042}-{'f1_val': 0.996186023309311, 'auprc': 0.9933800992854842, 'loss_val': 0.10245676563356404, 'psi': 0.9950636536997803}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=48 head_norm_before_train=1.952619 (no previous merge yet)
[S6] round=48 local utility u=0.242764 metrics={'f1_val': 0.865924889659748, 'auprc': 0.9653021927659483, 'loss_val': 0.465984757138233, 'psi': 0.9056758109022282}-{'f1_val': 0.7979818312458713, 'auprc': 0.9397425058668925, 'loss_val': 0.4671752856091104, 'psi': 0.8546861010942797}
[S6] not sending this round → trigger blocked (psi=0.906)
[S7] START round=48 head_norm_before_train=1.275178 cos_to_last_merge=0.9738 (last merge round=40)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5558673500507079, 'auprc': 0.7873343347763144, 'loss_val': 0.796945736865594, 'psi': 0.6484541439409506}-{'f1_val': 0.5660137145789388, 'auprc': 0.7897452352719035, 'loss_val': 0.795743298780571, 'psi': 0.6555063228561246}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.072954 (no previous merge yet)
[S8] round=48 local utility u=0.012143 metrics={'f1_val': 0.9943863538992247, 'auprc': 0.9982737311567151, 'loss_val': 0.031164366329872458, 'psi': 0.9959413048022209}-{'f1_val': 0.9941873288509412, 'auprc': 0.992338008285078, 'loss_val': 0.0364487329372875, 'psi': 0.9934476006245959}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=48 head_norm_before_train=1.717916 cos_to_last_merge=0.9744 (last merge round=40)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.998408751954551, 'loss_val': 0.031449789544884595, 'psi': 0.9961276905514418}-{'f1_val': 0.9971029125121428, 'auprc': 0.9974390656819352, 'loss_val': 0.027255884940537423, 'psi': 0.9972373737800597}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.793658 cos_to_last_merge=0.6177 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.618
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9935075259431372, 'loss_val': 0.032389168546017456, 'psi': 0.9945968827154931}-{'f1_val': 0.9951034680760983, 'auprc': 0.9943802518283731, 'loss_val': 0.03265587964125863, 'psi': 0.9948141815770082}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=2.034172 cos_to_last_merge=0.7369 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.737
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9984706644577284, 'loss_val': 0.02445544143034394, 'psi': 0.997068470731077}-{'f1_val': 0.9961336749133093, 'auprc': 0.9983613870839405, 'loss_val': 0.023842361154711902, 'psi': 0.9970247597815618}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.215673 cos_to_last_merge=0.9993 (last merge round=46)
[S13] round=48 local utility u=0.101456 metrics={'f1_val': 0.5986767880615609, 'auprc': 0.6656694493630115, 'loss_val': 0.8179761479395324, 'psi': 0.625473852582141}-{'f1_val': 0.5981778981106438, 'auprc': 0.6039688835819483, 'loss_val': 0.8327934955490423, 'psi': 0.6004942922991656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] sending update (kind=head size=1790 to 1 peers)
[S14] START round=48 head_norm_before_train=2.109945 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9530551459702319, 'auprc': 0.996269753758077, 'loss_val': 0.07525575336618164, 'psi': 0.97034098908537}-{'f1_val': 0.9969975081576651, 'auprc': 0.9989612411562707, 'loss_val': 0.0198806915584529, 'psi': 0.9977830013571074}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.698946 cos_to_last_merge=1.0000 (last merge round=47)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.8833982062854017, 'auprc': 0.9961224085852712, 'loss_val': 0.21773782671849906, 'psi': 0.9284878872053495}-{'f1_val': 0.9010440201688609, 'auprc': 0.997036610347773, 'loss_val': 0.16150056058098156, 'psi': 0.9394410562404256}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.837946 cos_to_last_merge=1.0000 (last merge round=47)
[S16] round=48 local utility u=0.001762 metrics={'f1_val': 0.9930717466151068, 'auprc': 0.993478972604773, 'loss_val': 0.03207128914583268, 'psi': 0.9932346370109733}-{'f1_val': 0.9934846877988823, 'auprc': 0.9920072523096517, 'loss_val': 0.033657247908919496, 'psi': 0.9928937136031901}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=48 head_norm_before_train=1.999732 (no previous merge yet)
[S17] round=48 local utility u=0.125346 metrics={'f1_val': 0.5821931517752412, 'auprc': 0.9433419911945988, 'loss_val': 1.1693161298382635, 'psi': 0.7266526875429843}-{'f1_val': 0.5642208252463464, 'auprc': 0.9053057908735997, 'loss_val': 1.1980656849572793, 'psi': 0.7006548114972477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=49 head_norm_before_train=1.854269 cos_to_last_merge=0.9985 (last merge round=36)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.5801321260892626, 'auprc': 0.7041231557072494, 'loss_val': 1.6091023668727438, 'psi': 0.6297285379364572}-{'f1_val': 0.6317270805419208, 'auprc': 0.6911900598849041, 'loss_val': 1.2956974827671688, 'psi': 0.6555122722791141}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.919656 cos_to_last_merge=0.7383 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.738
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.8493394554997328, 'auprc': 0.9999531506342068, 'loss_val': 0.2585765705381603, 'psi': 0.9095849335535224}-{'f1_val': 0.8480057973346564, 'auprc': 0.9998605130591365, 'loss_val': 0.2087733626501432, 'psi': 0.9087476836244485}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.970180 (no previous merge yet)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9450942631496637, 'auprc': 0.945482664386375, 'loss_val': 0.3065765069245171, 'psi': 0.9452496236443483}-{'f1_val': 0.9488374905999293, 'auprc': 0.9677918173081934, 'loss_val': 0.3017527646405577, 'psi': 0.9564192212832349}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.315238 cos_to_last_merge=0.9942 (last merge round=45)
[S5] round=49 local utility u=0.001823 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9934409832279524, 'loss_val': 0.06561963836195014, 'psi': 0.9950880072767676}-{'f1_val': 0.996186023309311, 'auprc': 0.9966310522060439, 'loss_val': 0.07883517510178496, 'psi': 0.9963640348680042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=49 head_norm_before_train=1.957655 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.7500020595515057, 'auprc': 0.9569528252047113, 'loss_val': 0.6887422815362801, 'psi': 0.832782365812788}-{'f1_val': 0.865924889659748, 'auprc': 0.9653021927659483, 'loss_val': 0.465984757138233, 'psi': 0.9056758109022282}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.292985 cos_to_last_merge=0.9709 (last merge round=40)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5496230856535235, 'auprc': 0.7840205944410571, 'loss_val': 0.8219376611067737, 'psi': 0.6433820891685369}-{'f1_val': 0.5558673500507079, 'auprc': 0.7873343347763144, 'loss_val': 0.796945736865594, 'psi': 0.6484541439409506}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=2.081959 (no previous merge yet)
[S8] round=49 local utility u=0.000514 metrics={'f1_val': 0.9941986149874398, 'auprc': 0.9991193955551775, 'loss_val': 0.03154665023995996, 'psi': 0.9961669272145348}-{'f1_val': 0.9943863538992247, 'auprc': 0.9982737311567151, 'loss_val': 0.031164366329872458, 'psi': 0.9959413048022209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=49 head_norm_before_train=1.740395 cos_to_last_merge=0.9723 (last merge round=40)
[S9] round=49 local utility u=0.007525 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9987886575696219, 'loss_val': 0.025058060306187853, 'psi': 0.997031545553642}-{'f1_val': 0.9946069829493691, 'auprc': 0.998408751954551, 'loss_val': 0.031449789544884595, 'psi': 0.9961276905514418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=49 head_norm_before_train=1.802685 cos_to_last_merge=0.6169 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.617
[S10] round=49 local utility u=0.000153 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9935158091943689, 'loss_val': 0.03210870931098974, 'psi': 0.9946001960159858}-{'f1_val': 0.9953231205637304, 'auprc': 0.9935075259431372, 'loss_val': 0.032389168546017456, 'psi': 0.9945968827154931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=49 head_norm_before_train=2.038716 cos_to_last_merge=0.7360 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.736
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9982237536437362, 'loss_val': 0.025235756819973733, 'psi': 0.9969697064054801}-{'f1_val': 0.9961336749133093, 'auprc': 0.9984706644577284, 'loss_val': 0.02445544143034394, 'psi': 0.997068470731077}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.232629 cos_to_last_merge=0.9975 (last merge round=46)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5716240053304914, 'auprc': 0.6865459925849231, 'loss_val': 0.8954680403785013, 'psi': 0.617592800232264}-{'f1_val': 0.5986767880615609, 'auprc': 0.6656694493630115, 'loss_val': 0.8179761479395324, 'psi': 0.625473852582141}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=2.114660 (no previous merge yet)
[S14] round=49 local utility u=0.034089 metrics={'f1_val': 0.9592331134893162, 'auprc': 0.9992300409324952, 'loss_val': 0.053025931277662, 'psi': 0.9752318844665878}-{'f1_val': 0.9530551459702319, 'auprc': 0.996269753758077, 'loss_val': 0.07525575336618164, 'psi': 0.97034098908537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=49 head_norm_before_train=1.742718 cos_to_last_merge=0.9996 (last merge round=47)
[S15] round=49 local utility u=0.366830 metrics={'f1_val': 0.9791243154268778, 'auprc': 0.9992714514925118, 'loss_val': 0.06788137798614725, 'psi': 0.9871831698531315}-{'f1_val': 0.8833982062854017, 'auprc': 0.9961224085852712, 'loss_val': 0.21773782671849906, 'psi': 0.9284878872053495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S15] sending update (kind=head size=1808 to 1 peers)
[S16] START round=49 head_norm_before_train=1.842251 cos_to_last_merge=1.0000 (last merge round=47)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9928494489053377, 'auprc': 0.9939499534874272, 'loss_val': 0.03609660360002016, 'psi': 0.9932896507381734}-{'f1_val': 0.9930717466151068, 'auprc': 0.993478972604773, 'loss_val': 0.03207128914583268, 'psi': 0.9932346370109733}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=2.009568 (no previous merge yet)
[S17] round=49 local utility u=0.473486 metrics={'f1_val': 0.7357587874043167, 'auprc': 0.8669506351513191, 'loss_val': 0.9145637385947055, 'psi': 0.7882355265031176}-{'f1_val': 0.5821931517752412, 'auprc': 0.9433419911945988, 'loss_val': 1.1693161298382635, 'psi': 0.7266526875429843}
[S17] not sending this round → trigger blocked (psi=0.788)
[runner] rounds complete.
[runner] all agents stopped.
