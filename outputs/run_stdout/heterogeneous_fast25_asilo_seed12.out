[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:57003
[S3] → join 127.0.0.1:57002
[S4] → join 127.0.0.1:57002
[S5] → join 127.0.0.1:57002
[S6] → join 127.0.0.1:57002
[S7] → join 127.0.0.1:57002
[S8] → join 127.0.0.1:57002
[S9] → join 127.0.0.1:57002
[S10] → join 127.0.0.1:57002
[S11] → join 127.0.0.1:57002
[S13] → join 127.0.0.1:57002
[S14] → join 127.0.0.1:57002
[S15] → join 127.0.0.1:57002
[S16] → join 127.0.0.1:57002
[S17] → join 127.0.0.1:57002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.156146 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.178004 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.188624 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.173541 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.149280 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.156856 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.151560 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.160963 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.170810 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.172720 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.188433 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.190313 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.110721 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.189670 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.222103 (no previous merge yet)
[S16]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S3] + discovered S13
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S10
[S3] + discovered S16
[S3] + discovered S5
[S3] + discovered S8
[S3] + discovered S15
[S3] + discovered S14
[S3] + discovered S9
[S3] + discovered S11
[S3] + discovered S17
[S3] + discovered S7
[S3] + discovered S4
[S3] + discovered S6
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S10
[S4] + discovered S16
[S4] + discovered S8
[S4] + discovered S5
[S4] + discovered S15
[S4] + discovered S14
[S4] + discovered S11
[S4] + discovered S9
[S4] + discovered S17
[S4] + discovered S6
[S4] + discovered S7
[S4] + discovered S13
[S5] + discovered S7
[S5] + discovered S6
[S5] + discovered S17
[S5] + discovered S14
[S5] + discovered S16
[S5] + discovered S13
[S5] + discovered S9
[S5] + discovered S11
[S5] + discovered S15
[S5] + discovered S8
[S5] + discovered S10
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S2
[S6] + discovered S5
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S3
[S7] + discovered S5
[S7] + discovered S6
[S6] + discovered S15
[S6] + discovered S11
[S6] + discovered S13
[S6] + discovered S10
[S6] + discovered S8
[S6] + discovered S9
[S6] + discovered S16
[S6] + discovered S17
[S6] + discovered S14
[S6] + discovered S7
[S8] + discovered S5
[S8] + discovered S3
[S8] + discovered S7
[S8] + discovered S6
[S8] + discovered S4
[S8] + discovered S2
[S7] + discovered S14
[S7] + discovered S17
[S7] + discovered S9
[S7] + discovered S10
[S7] + discovered S11
[S7] + discovered S8
[S7] + discovered S16
[S7] + discovered S13
[S7] + discovered S15
[S8] + discovered S11
[S8] + discovered S14
[S9] + discovered S7
[S9] + discovered S2
[S9] + discovered S3
[S9] + discovered S6
[S9] + discovered S5
[S9] + discovered S4
[S8] + discovered S15
[S8] + discovered S10
[S8] + discovered S9
[S8] + discovered S17
[S8] + discovered S13
[S9] + discovered S8
[S8] + discovered S16
[S9] + discovered S14
[S9] + discovered S17
[S9] + discovered S10
[S9] + discovered S13
[S9] + discovered S11
[S9] + discovered S16
[S9] + discovered S15
[S10] + discovered S3
[S10] + discovered S8
[S10] + discovered S2
[S10] + discovered S7
[S10] + discovered S4
[S10] + discovered S5
[S10] + discovered S9
[S10] + discovered S6
[S11] + discovered S5
[S11] + discovered S8
[S11] + discovered S6
[S11] + discovered S9
[S11] + discovered S10
[S11] + discovered S4
[S11] + discovered S2
[S11] + discovered S7
[S11] + discovered S3
[S10] + discovered S13
[S10] + discovered S11
[S10] + discovered S14
[S10] + discovered S15
[S10] + discovered S17
[S10] + discovered S16
[S13] + discovered S4
[S13] + discovered S10
[S13] + discovered S3
[S13] + discovered S7
[S13] + discovered S2
[S13] + discovered S9
[S13] + discovered S6
[S13] + discovered S8
[S13] + discovered S11
[S13] + discovered S5
[S11] + discovered S17
[S11] + discovered S16
[S11] + discovered S15
[S11] + discovered S14
[S11] + discovered S13
[S13] + discovered S15
[S13] + discovered S16
[S13] + discovered S14
[S13] + discovered S17
[S14] + discovered S13
[S14] + discovered S8
[S14] + discovered S3
[S14] + discovered S10
[S14] + discovered S5
[S14] + discovered S2
[S14] + discovered S6
[S14] + discovered S9
[S14] + discovered S7
[S14] + discovered S11
[S14] + discovered S4
[S14] + discovered S15
[S15] + discovered S10
[S15] + discovered S2
[S15] + discovered S5
[S15] + discovered S6
[S15] + discovered S9
[S15] + discovered S7
[S15] + discovered S4
[S14] + discovered S16
[S14] + discovered S17
[S15] + discovered S13
[S15] + discovered S8
[S15] + discovered S14
[S15] + discovered S3
[S15] + discovered S11
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S8
[S16] + discovered S13
[S16] + discovered S14
[S16] + discovered S3
[S16] + discovered S11
[S16] + discovered S15
[S16] + discovered S10
[S16] + discovered S2
[S16] + discovered S5
[S16] + discovered S6
[S16] + discovered S9
[S16] + discovered S7
[S16] + discovered S4
[S17] + discovered S13
[S16] + discovered S17
[S17] + discovered S10
[S17] + discovered S2
[S17] + discovered S6
[S17] + discovered S14
[S17] + discovered S7
[S17] + discovered S8
[S17] + discovered S4
[S17] + discovered S11
[S17] + discovered S9
[S17] + discovered S5
[S17] + discovered S16
[S17] + discovered S15
[S17] + discovered S3
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=1.000 → S10@127.0.0.1:57011
[S7] ⇄ pheromone p=1.000 → S15@127.0.0.1:57015
[S8] ⇄ pheromone p=1.000 → S3@127.0.0.1:57003
[S11] ⇄ pheromone p=1.000 → S7@127.0.0.1:57008
[S13] ⇄ pheromone p=1.000 → S15@127.0.0.1:57015
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:57010
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:57007
[S9] ⇄ pheromone p=1.000 → S3@127.0.0.1:57003
[S14] ⇄ pheromone p=1.000 → S6@127.0.0.1:57007
[S15] ⇄ pheromone p=1.000 → S10@127.0.0.1:57011
[S4] ⇄ pheromone p=1.000 → S2@127.0.0.1:57002
[S3] ⇄ pheromone p=1.000 → S15@127.0.0.1:57015
[S6] ⇄ pheromone p=1.000 → S8@127.0.0.1:57009
[S10] ⇄ pheromone p=1.000 → S7@127.0.0.1:57008
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:57009
[S2] START round=1 head_norm_before_train=1.157584 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.15353639080418632, 'auprc': 0.8400288583169667, 'loss_val': 1.3204850769716463, 'psi': 0.4281333778092985}-{'f1_val': 0.16723758257890872, 'auprc': 0.9230435511754437, 'loss_val': 1.355478139700744, 'psi': 0.4695599700175227}
[S3] START round=1 head_norm_before_train=1.175194 (no previous merge yet)
[S3] round=1 local utility u=0.563519 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.99862716632247, 'loss_val': 1.3175752368536144, 'psi': 0.4833549058974522}-{'f1_val': 0.08969866853538892, 'auprc': 0.7413714782597747, 'loss_val': 1.371996989444197, 'psi': 0.3503677924251432}
[S4] START round=1 head_norm_before_train=1.187269 (no previous merge yet)
[S4] round=1 local utility u=0.729694 metrics={'f1_val': 0.36140926124527867, 'auprc': 0.5918263954081006, 'loss_val': 1.3306797575330556, 'psi': 0.4535761149104074}-{'f1_val': 0.08833063209076175, 'auprc': 0.6658669727653483, 'loss_val': 1.3737170925655025, 'psi': 0.3193451683605964}
[S5] START round=1 head_norm_before_train=1.182453 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.731282244301011, 'loss_val': 1.2768806772193761, 'psi': 0.37787004057754725}-{'f1_val': 0.2595296126103459, 'auprc': 0.6214154228304447, 'loss_val': 1.3528265381044537, 'psi': 0.4042839366983854}
[S6] START round=1 head_norm_before_train=1.150911 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7988315287641342, 'loss_val': 1.31536933943032, 'psi': 0.4043883807364229}-{'f1_val': 0.3462469205047498, 'auprc': 0.7539419099625858, 'loss_val': 1.3492690172157762, 'psi': 0.5093249162878842}
[S7] START round=1 head_norm_before_train=1.171148 (no previous merge yet)
[S7] round=1 local utility u=0.032767 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7700570082698053, 'loss_val': 1.2757772544027863, 'psi': 0.39325689694537713}-{'f1_val': 0.14205682272909165, 'auprc': 0.7664802344136905, 'loss_val': 1.3305813593786584, 'psi': 0.39182618740293124}
[S8] START round=1 head_norm_before_train=1.157981 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6572706711724521, 'loss_val': 1.3228888204895703, 'psi': 0.3468818579047552}-{'f1_val': 0.39142700823716925, 'auprc': 0.3224396162442581, 'loss_val': 1.3573506614341908, 'psi': 0.36383205144000474}
[S9] START round=1 head_norm_before_train=1.182672 (no previous merge yet)
[S9] round=1 local utility u=0.320004 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9761323282197325, 'loss_val': 1.2208086975442574, 'psi': 0.47529170557189065}-{'f1_val': 0.141397957139996, 'auprc': 0.7942596301946157, 'loss_val': 1.3151978761013412, 'psi': 0.4025426263618439}
[S10] START round=1 head_norm_before_train=1.177736 (no previous merge yet)
[S10] round=1 local utility u=0.027862 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5804218586714461, 'loss_val': 1.3415309098387038, 'psi': 0.3153417259936128}-{'f1_val': 0.13862163754172394, 'auprc': 0.5688517445867327, 'loss_val': 1.362543681391864, 'psi': 0.31071368035972746}
[S11] START round=1 head_norm_before_train=1.178408 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8281514830741957, 'loss_val': 1.3403524552022248, 'psi': 0.41550880325354467}-{'f1_val': 0.29071292101938306, 'auprc': 0.6986610429302148, 'loss_val': 1.3734622363649454, 'psi': 0.4538921697837157}
[S13] START round=1 head_norm_before_train=1.192562 (no previous merge yet)
[S13] round=1 local utility u=0.983424 metrics={'f1_val': 0.41662964849357986, 'auprc': 0.5216256412766741, 'loss_val': 1.3252953511607057, 'psi': 0.4586280456068176}-{'f1_val': 0.09037372593431484, 'auprc': 0.5310767819426512, 'loss_val': 1.3629614405250727, 'psi': 0.2666549483376494}
[S14] START round=1 head_norm_before_train=1.189772 (no previous merge yet)
[S14] round=1 local utility u=0.349640 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.43946432529403867, 'loss_val': 1.3595616310794223, 'psi': 0.26000044184723775}-{'f1_val': 0.1038107752956636, 'auprc': 0.2886793348544226, 'loss_val': 1.3872032224403832, 'psi': 0.1777581991191672}
[S15] START round=1 head_norm_before_train=1.119258 (no previous merge yet)
[S15] round=1 local utility u=0.203293 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7109652350684674, 'loss_val': 1.3317024173855205, 'psi': 0.36822628484432196}-{'f1_val': 0.13061713261873167, 'auprc': 0.6042460206659248, 'loss_val': 1.36343124568179, 'psi': 0.32006868783760895}
[S16] START round=1 head_norm_before_train=1.199473 (no previous merge yet)
[S16] round=1 local utility u=0.147957 metrics={'f1_val': 0.14066547120940426, 'auprc': 0.8250481637012339, 'loss_val': 1.309309545756837, 'psi': 0.41441854820613616}-{'f1_val': 0.10386473429951691, 'auprc': 0.8113522837768181, 'loss_val': 1.343331003282138, 'psi': 0.38685975409043744}
[S17] START round=1 head_norm_before_train=1.227363 (no previous merge yet)
[S17] round=1 local utility u=0.047724 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7255108371319077, 'loss_val': 1.3277778343843785, 'psi': 0.3747737128431937}-{'f1_val': 0.14094896331738438, 'auprc': 0.7017352148957077, 'loss_val': 1.3518984705847634, 'psi': 0.36526346394871373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:57017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:57015
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:57017
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:57005
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:57008
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S16] → sending delta(kind=head bytes=1787) to S17@127.0.0.1:57017
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S15] → sending delta(kind=head bytes=1787) to S16@127.0.0.1:57016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:57007
[S15] sending update (kind=head size=1787 to 1 peers)
[S16] sending update (kind=head size=1787 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1789 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1790) from S7
[S5] cosine check vs S7: cos=0.0497
[S5] RECEIVED delta(kind=head bytes=1791) from S4
[S5] cosine check vs S4: cos=0.1181
[S6] RECEIVED delta(kind=head bytes=1794) from S10
[S6] cosine check vs S10: cos=-0.0289
[S6] DROPPED delta from S10 (cos=-0.0289 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1789) from S3
[S15] cosine check vs S3: cos=0.0185
[S7] RECEIVED delta(kind=head bytes=1795) from S9
[S7] cosine check vs S9: cos=-0.0269
[S7] DROPPED delta from S9 (cos=-0.0269 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1787) from S15
[S16] cosine check vs S15: cos=0.0890
[S17] RECEIVED delta(kind=head bytes=1787) from S16
[S17] cosine check vs S16: cos=0.0241
[S17] RECEIVED delta(kind=head bytes=1792) from S14
[S17] cosine check vs S14: cos=-0.1538
[S17] DROPPED delta from S14 (cos=-0.1538 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1789) from S13
[S17] cosine check vs S13: cos=-0.0140
[S17] DROPPED delta from S13 (cos=-0.0140 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S17] → sending delta(kind=head bytes=1783) to S9@127.0.0.1:57010
[S17] sending update (kind=head size=1783 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1783) from S17
[S9] cosine check vs S17: cos=0.0066
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.218618
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.944793e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.777683 delta_norm=0.694479
[S5] aggregate: ACCEPT kept=['S7', 'S4'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.228456
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.706411e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.876392 delta_norm=0.870641
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.132785
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.163186e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.0927 head_norm=0.831513 delta_norm=0.816319
[S15] aggregate: ROLLBACK (f1_val pre=0.140 post=0.093 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1407 head_norm=1.218682
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.941459e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.868059 delta_norm=0.794146
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.242196
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.595451e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.880512 delta_norm=0.859545
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.172036 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.8403436841173221, 'loss_val': 1.27873781082147, 'psi': 0.4212037536800689}-{'f1_val': 0.15353639080418632, 'auprc': 0.8400288583169667, 'loss_val': 1.3204850769716463, 'psi': 0.4281333778092985}
[S3] START round=2 head_norm_before_train=1.196820 (no previous merge yet)
[S3] round=2 local utility u=0.011481 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9770823951150994, 'loss_val': 1.2299794226460323, 'psi': 0.47473699741450404}-{'f1_val': 0.13984006561410703, 'auprc': 0.99862716632247, 'loss_val': 1.3175752368536144, 'psi': 0.4833549058974522}
[S4] START round=2 head_norm_before_train=1.194984 (no previous merge yet)
[S4] round=2 local utility u=0.049831 metrics={'f1_val': 0.3687705109895312, 'auprc': 0.5946948735771629, 'loss_val': 1.2837910705049076, 'psi': 0.45914025602458386}-{'f1_val': 0.36140926124527867, 'auprc': 0.5918263954081006, 'loss_val': 1.3306797575330556, 'psi': 0.4535761149104074}
[S5] START round=2 head_norm_before_train=0.777683 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7214892532058463, 'loss_val': 1.248442253795689, 'psi': 0.3739528441394814}-{'f1_val': 0.14226190476190476, 'auprc': 0.731282244301011, 'loss_val': 1.2768806772193761, 'psi': 0.37787004057754725}
[S6] START round=2 head_norm_before_train=1.161045 (no previous merge yet)
[S6] round=2 local utility u=0.019966 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7999770998059156, 'loss_val': 1.2788733522267466, 'psi': 0.4048466091531355}-{'f1_val': 0.14142628205128205, 'auprc': 0.7988315287641342, 'loss_val': 1.31536933943032, 'psi': 0.4043883807364229}
[S7] START round=2 head_norm_before_train=1.203306 (no previous merge yet)
[S7] round=2 local utility u=0.027892 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7766816702071018, 'loss_val': 1.2398679019856405, 'psi': 0.3959067617202957}-{'f1_val': 0.14205682272909165, 'auprc': 0.7700570082698053, 'loss_val': 1.2757772544027863, 'psi': 0.39325689694537713}
[S8] START round=2 head_norm_before_train=1.176542 (no previous merge yet)
[S8] round=2 local utility u=0.037647 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6705487979825414, 'loss_val': 1.2874282594127378, 'psi': 0.3521931086287909}-{'f1_val': 0.13995598239295717, 'auprc': 0.6572706711724521, 'loss_val': 1.3228888204895703, 'psi': 0.3468818579047552}
[S9] START round=2 head_norm_before_train=0.876392 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8658801442873872, 'loss_val': 1.1902491937542294, 'psi': 0.43119083199895253}-{'f1_val': 0.141397957139996, 'auprc': 0.9761323282197325, 'loss_val': 1.2208086975442574, 'psi': 0.47529170557189065}
[S10] START round=2 head_norm_before_train=1.193120 (no previous merge yet)
[S10] round=2 local utility u=0.080137 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6246921915248015, 'loss_val': 1.3140687380150269, 'psi': 0.333049859134955}-{'f1_val': 0.13862163754172394, 'auprc': 0.5804218586714461, 'loss_val': 1.3415309098387038, 'psi': 0.3153417259936128}
[S11] START round=2 head_norm_before_train=1.194248 (no previous merge yet)
[S11] round=2 local utility u=0.039775 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8413476779215922, 'loss_val': 1.3003904199322736, 'psi': 0.42078728119250325}-{'f1_val': 0.14041368337311058, 'auprc': 0.8281514830741957, 'loss_val': 1.3403524552022248, 'psi': 0.41550880325354467}
[S13] START round=2 head_norm_before_train=1.201697 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5211321806616284, 'loss_val': 1.2846194575312915, 'psi': 0.2926843298108832}-{'f1_val': 0.41662964849357986, 'auprc': 0.5216256412766741, 'loss_val': 1.3252953511607057, 'psi': 0.4586280456068176}
[S14] START round=2 head_norm_before_train=1.198556 (no previous merge yet)
[S14] round=2 local utility u=0.335437 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6532262351651448, 'loss_val': 1.329973703782368, 'psi': 0.34550520579568017}-{'f1_val': 0.14035785288270378, 'auprc': 0.43946432529403867, 'loss_val': 1.3595616310794223, 'psi': 0.26000044184723775}
[S15] START round=2 head_norm_before_train=0.831513 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.900989 metrics={'f1_val': 0.41584914540957585, 'auprc': 0.7644832278911452, 'loss_val': 1.346970651366089, 'psi': 0.5553027784022035}-{'f1_val': 0.13973365136155833, 'auprc': 0.7109652350684674, 'loss_val': 1.3317024173855205, 'psi': 0.36822628484432196}
[S16] START round=2 head_norm_before_train=0.868059 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8074513235450467, 'loss_val': 1.3055376577463322, 'psi': 0.4073629995375406}-{'f1_val': 0.14066547120940426, 'auprc': 0.8250481637012339, 'loss_val': 1.309309545756837, 'psi': 0.41441854820613616}
[S17] START round=2 head_norm_before_train=0.880512 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6923380521408431, 'loss_val': 1.3375081401256077, 'psi': 0.3615045988467679}-{'f1_val': 0.14094896331738438, 'auprc': 0.7255108371319077, 'loss_val': 1.3277778343843785, 'psi': 0.3747737128431937}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:57009
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:57012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:57012
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:57002
[S4] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S10
[S8] cosine check vs S10: cos=0.0966
[S8] RECEIVED delta(kind=head bytes=1794) from S11
[S8] cosine check vs S11: cos=0.1120
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=-0.0226
[S11] DROPPED delta from S4 (cos=-0.0226 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1790) from S8
[S3] cosine check vs S8: cos=-0.1315
[S3] DROPPED delta from S8 (cos=-0.1315 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1792) from S3
[S2] cosine check vs S3: cos=-0.0237
[S2] DROPPED delta from S3 (cos=-0.0237 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1794) from S14
[S2] cosine check vs S14: cos=-0.0572
[S2] DROPPED delta from S14 (cos=-0.0572 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S15
[S2] cosine check vs S15: cos=-0.0589
[S2] DROPPED delta from S15 (cos=-0.0589 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1790) from S6
[S11] cosine check vs S6: cos=0.0728
[S2] RECEIVED delta(kind=head bytes=1798) from S7
[S2] cosine check vs S7: cos=-0.0948
[S2] DROPPED delta from S7 (cos=-0.0948 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=2 metric=0.1400 head_norm=1.199871
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.702328e-01
[S8] stored merged vector for next round verification (round=2)
[S8] DEBUG after merge:  round=2 metric=0.1400 head_norm=0.775508 delta_norm=0.670233
[S8] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1404 head_norm=1.217086
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.153413e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.877025 delta_norm=0.815341
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.194441 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7613360084026553, 'loss_val': 1.2253326955768127, 'psi': 0.3896006833942022}-{'f1_val': 0.1417771333885667, 'auprc': 0.8403436841173221, 'loss_val': 1.27873781082147, 'psi': 0.4212037536800689}
[S3] START round=3 head_norm_before_train=1.243357 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8413866299905801, 'loss_val': 1.107926500841959, 'psi': 0.42045869136469627}-{'f1_val': 0.13984006561410703, 'auprc': 0.9770823951150994, 'loss_val': 1.2299794226460323, 'psi': 0.47473699741450404}
[S4] START round=3 head_norm_before_train=1.214440 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.15339709159205397, 'auprc': 0.6454179614990131, 'loss_val': 1.2191566386234671, 'psi': 0.3502054395548376}-{'f1_val': 0.3687705109895312, 'auprc': 0.5946948735771629, 'loss_val': 1.2837910705049076, 'psi': 0.45914025602458386}
[S5] START round=3 head_norm_before_train=0.828761 cos_to_last_merge=0.9929 (last merge round=1)
[S5] round=3 local utility u=0.885883 metrics={'f1_val': 0.41694544507090897, 'auprc': 0.7289141228920626, 'loss_val': 1.1470530671686903, 'psi': 0.5417329161993705}-{'f1_val': 0.14226190476190476, 'auprc': 0.7214892532058463, 'loss_val': 1.248442253795689, 'psi': 0.3739528441394814}
[S6] START round=3 head_norm_before_train=1.177544 (no previous merge yet)
[S6] round=3 local utility u=0.013924 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7933329263253837, 'loss_val': 1.231092019855421, 'psi': 0.4021889397609227}-{'f1_val': 0.14142628205128205, 'auprc': 0.7999770998059156, 'loss_val': 1.2788733522267466, 'psi': 0.4048466091531355}
[S7] START round=3 head_norm_before_train=1.238891 (no previous merge yet)
[S7] round=3 local utility u=0.025216 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7774319085824372, 'loss_val': 1.1916872618866217, 'psi': 0.39620685707042985}-{'f1_val': 0.14205682272909165, 'auprc': 0.7766816702071018, 'loss_val': 1.2398679019856405, 'psi': 0.3959067617202957}
[S8] START round=3 head_norm_before_train=0.775508 cos_to_last_merge=1.0000 (last merge round=2)
[S8] round=3 local utility u=0.139403 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7658229287730712, 'loss_val': 1.294444654637711, 'psi': 0.3903027609450028}-{'f1_val': 0.13995598239295717, 'auprc': 0.6705487979825414, 'loss_val': 1.2874282594127378, 'psi': 0.3521931086287909}
[S9] START round=3 head_norm_before_train=0.923248 cos_to_last_merge=0.9933 (last merge round=1)
[S9] round=3 local utility u=0.142900 metrics={'f1_val': 0.15509666080843584, 'auprc': 0.8660493184677562, 'loss_val': 0.9871481703612681, 'psi': 0.43947772387216405}-{'f1_val': 0.141397957139996, 'auprc': 0.8658801442873872, 'loss_val': 1.1902491937542294, 'psi': 0.43119083199895253}
[S10] START round=3 head_norm_before_train=1.214824 (no previous merge yet)
[S10] round=3 local utility u=0.214198 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7544564212948058, 'loss_val': 1.2749659638042952, 'psi': 0.3849555510429567}-{'f1_val': 0.13862163754172394, 'auprc': 0.6246921915248015, 'loss_val': 1.3140687380150269, 'psi': 0.333049859134955}
[S11] START round=3 head_norm_before_train=0.877025 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.005636 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8383890738906268, 'loss_val': 1.2802426461907859, 'psi': 0.4196038395801171}-{'f1_val': 0.14041368337311058, 'auprc': 0.8413476779215922, 'loss_val': 1.3003904199322736, 'psi': 0.42078728119250325}
[S13] START round=3 head_norm_before_train=1.221406 (no previous merge yet)
[S13] round=3 local utility u=0.020977 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5187967616180872, 'loss_val': 1.2356600333889505, 'psi': 0.2917501621934667}-{'f1_val': 0.1403857625770531, 'auprc': 0.5211321806616284, 'loss_val': 1.2846194575312915, 'psi': 0.2926843298108832}
[S14] START round=3 head_norm_before_train=1.213735 (no previous merge yet)
[S14] round=3 local utility u=0.182425 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7624885115749548, 'loss_val': 1.2929101150623041, 'psi': 0.3892101163596042}-{'f1_val': 0.14035785288270378, 'auprc': 0.6532262351651448, 'loss_val': 1.329973703782368, 'psi': 0.34550520579568017}
[S15] START round=3 head_norm_before_train=0.843747 cos_to_last_merge=0.9966 (last merge round=1)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7606098840042534, 'loss_val': 1.315859126004591, 'psi': 0.3880841444186364}-{'f1_val': 0.41584914540957585, 'auprc': 0.7644832278911452, 'loss_val': 1.346970651366089, 'psi': 0.5553027784022035}
[S16] START round=3 head_norm_before_train=0.890958 cos_to_last_merge=0.9972 (last merge round=1)
[S16] round=3 local utility u=0.023423 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8055823447368374, 'loss_val': 1.2530845014669638, 'psi': 0.4066154080142569}-{'f1_val': 0.14063745019920318, 'auprc': 0.8074513235450467, 'loss_val': 1.3055376577463322, 'psi': 0.4073629995375406}
[S17] START round=3 head_norm_before_train=0.899862 cos_to_last_merge=0.9971 (last merge round=1)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6811114558019147, 'loss_val': 1.3048311670341681, 'psi': 0.35701396031119653}-{'f1_val': 0.14094896331738438, 'auprc': 0.6923380521408431, 'loss_val': 1.3375081401256077, 'psi': 0.3615045988467679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:57009
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:57015
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:57007
[S11] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=-0.0224
[S8] DROPPED delta from S6 (cos=-0.0224 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1789) from S5
[S9] cosine check vs S5: cos=0.0318
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=-0.0143
[S3] DROPPED delta from S9 (cos=-0.0143 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] cosine check vs S8: cos=-0.0722
[S3] DROPPED delta from S8 (cos=-0.0722 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S7
[S15] cosine check vs S7: cos=0.0551
[S15] RECEIVED delta(kind=head bytes=1797) from S13
[S15] cosine check vs S13: cos=0.0885
[S7] RECEIVED delta(kind=head bytes=1793) from S11
[S7] cosine check vs S11: cos=-0.0002
[S7] DROPPED delta from S11 (cos=-0.0002 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S10
[S7] cosine check vs S10: cos=-0.0556
[S7] DROPPED delta from S10 (cos=-0.0556 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S16
[S6] cosine check vs S16: cos=-0.0190
[S6] DROPPED delta from S16 (cos=-0.0190 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S14
[S6] cosine check vs S14: cos=-0.0149
[S6] DROPPED delta from S14 (cos=-0.0149 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1551 head_norm=0.982159
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.472921e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.3985 head_norm=0.668064 delta_norm=0.647292
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=0.864335
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.965074e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.1397 head_norm=0.658329 delta_norm=0.596507
[S15] aggregate: ACCEPT kept=['S7', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.217624 (no previous merge yet)
[S2] round=4 local utility u=0.121828 metrics={'f1_val': 0.19653284223198603, 'auprc': 0.7083737771393988, 'loss_val': 1.1513234856695433, 'psi': 0.4012692161949511}-{'f1_val': 0.1417771333885667, 'auprc': 0.7613360084026553, 'loss_val': 1.2253326955768127, 'psi': 0.3896006833942022}
[S3] START round=4 head_norm_before_train=1.300196 (no previous merge yet)
[S3] round=4 local utility u=0.959927 metrics={'f1_val': 0.39623514491051715, 'auprc': 0.8768213811907961, 'loss_val': 0.8327482140740388, 'psi': 0.5884696394226288}-{'f1_val': 0.13984006561410703, 'auprc': 0.8413866299905801, 'loss_val': 1.107926500841959, 'psi': 0.42045869136469627}
[S4] START round=4 head_norm_before_train=1.245854 (no previous merge yet)
[S4] round=4 local utility u=0.128769 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7301823353873826, 'loss_val': 1.136889076082911, 'psi': 0.37620891149206354}-{'f1_val': 0.15339709159205397, 'auprc': 0.6454179614990131, 'loss_val': 1.2191566386234671, 'psi': 0.3502054395548376}
[S5] START round=4 head_norm_before_train=0.875189 cos_to_last_merge=0.9799 (last merge round=1)
[S5] round=4 local utility u=0.139010 metrics={'f1_val': 0.41782980503278466, 'auprc': 0.7566439852066092, 'loss_val': 0.957528054480906, 'psi': 0.5533554771023145}-{'f1_val': 0.41694544507090897, 'auprc': 0.7289141228920626, 'loss_val': 1.1470530671686903, 'psi': 0.5417329161993705}
[S6] START round=4 head_norm_before_train=1.205756 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6434919774405881, 'loss_val': 1.1884900881737626, 'psi': 0.34225256020700445}-{'f1_val': 0.14142628205128205, 'auprc': 0.7933329263253837, 'loss_val': 1.231092019855421, 'psi': 0.4021889397609227}
[S7] START round=4 head_norm_before_train=1.255747 (no previous merge yet)
[S7] round=4 local utility u=0.049935 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7770514478268139, 'loss_val': 1.0906762515223025, 'psi': 0.39605467276818057}-{'f1_val': 0.14205682272909165, 'auprc': 0.7774319085824372, 'loss_val': 1.1916872618866217, 'psi': 0.39620685707042985}
[S8] START round=4 head_norm_before_train=0.801732 cos_to_last_merge=0.9975 (last merge round=2)
[S8] round=4 local utility u=0.024276 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7658531561006567, 'loss_val': 1.2459842215839139, 'psi': 0.39031485187603704}-{'f1_val': 0.13995598239295717, 'auprc': 0.7658229287730712, 'loss_val': 1.294444654637711, 'psi': 0.3903027609450028}
[S9] START round=4 head_norm_before_train=0.668064 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=1.000000 metrics={'f1_val': 0.5917163705213886, 'auprc': 0.9994929911804568, 'loss_val': 0.858372422292552, 'psi': 0.7548270187850159}-{'f1_val': 0.15509666080843584, 'auprc': 0.8660493184677562, 'loss_val': 0.9871481703612681, 'psi': 0.43947772387216405}
[S10] START round=4 head_norm_before_train=1.244609 (no previous merge yet)
[S10] round=4 local utility u=0.080560 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7854413618634347, 'loss_val': 1.206800914065805, 'psi': 0.3973495272704083}-{'f1_val': 0.13862163754172394, 'auprc': 0.7544564212948058, 'loss_val': 1.2749659638042952, 'psi': 0.3849555510429567}
[S11] START round=4 head_norm_before_train=0.907108 cos_to_last_merge=0.9972 (last merge round=2)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6603562459795338, 'loss_val': 1.2226400569036557, 'psi': 0.3483907084156799}-{'f1_val': 0.14041368337311058, 'auprc': 0.8383890738906268, 'loss_val': 1.2802426461907859, 'psi': 0.4196038395801171}
[S13] START round=4 head_norm_before_train=1.246972 (no previous merge yet)
[S13] round=4 local utility u=0.422457 metrics={'f1_val': 0.24292793554732772, 'auprc': 0.5718618428328306, 'loss_val': 1.1651933829431576, 'psi': 0.3745014984615289}-{'f1_val': 0.1403857625770531, 'auprc': 0.5187967616180872, 'loss_val': 1.2356600333889505, 'psi': 0.2917501621934667}
[S14] START round=4 head_norm_before_train=1.236984 (no previous merge yet)
[S14] round=4 local utility u=0.042650 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7746317642342221, 'loss_val': 1.2440406950080216, 'psi': 0.3940674174233111}-{'f1_val': 0.14035785288270378, 'auprc': 0.7624885115749548, 'loss_val': 1.2929101150623041, 'psi': 0.3892101163596042}
[S15] START round=4 head_norm_before_train=0.658329 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.745945733172877, 'loss_val': 1.301055011392183, 'psi': 0.38221848408608583}-{'f1_val': 0.13973365136155833, 'auprc': 0.7606098840042534, 'loss_val': 1.315859126004591, 'psi': 0.3880841444186364}
[S16] START round=4 head_norm_before_train=0.923051 cos_to_last_merge=0.9895 (last merge round=1)
[S16] round=4 local utility u=0.019033 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7948027156433901, 'loss_val': 1.1826787787602235, 'psi': 0.402303556376878}-{'f1_val': 0.14063745019920318, 'auprc': 0.8055823447368374, 'loss_val': 1.2530845014669638, 'psi': 0.4066154080142569}
[S17] START round=4 head_norm_before_train=0.931104 cos_to_last_merge=0.9885 (last merge round=1)
[S17] round=4 local utility u=0.133904 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7487970059461535, 'loss_val': 1.240079601048013, 'psi': 0.38408818036889203}-{'f1_val': 0.14094896331738438, 'auprc': 0.6811114558019147, 'loss_val': 1.3048311670341681, 'psi': 0.35701396031119653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:57015
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:57011
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:57007
[S14] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.5943
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=-0.0698
[S3] DROPPED delta from S8 (cos=-0.0698 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=-0.0241
[S3] DROPPED delta from S9 (cos=-0.0241 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] cosine check vs S7: cos=0.5306
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] cosine check vs S4: cos=-0.0689
[S2] DROPPED delta from S4 (cos=-0.0689 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S14
[S6] cosine check vs S14: cos=-0.0138
[S6] DROPPED delta from S14 (cos=-0.0138 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S3
[S15] cosine check vs S3: cos=0.3870
[S7] RECEIVED delta(kind=head bytes=1793) from S10
[S7] cosine check vs S10: cos=-0.0565
[S7] DROPPED delta from S10 (cos=-0.0565 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S13
[S15] cosine check vs S13: cos=0.5531
[S10] RECEIVED delta(kind=head bytes=1803) from S2
[S10] cosine check vs S2: cos=-0.0127
[S10] DROPPED delta from S2 (cos=-0.0127 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S16
[S6] cosine check vs S16: cos=-0.0253
[S6] DROPPED delta from S16 (cos=-0.0253 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=-0.0573
[S8] DROPPED delta from S17 (cos=-0.0573 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.5917 head_norm=0.744127
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.830637e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.7005 head_norm=0.744175 delta_norm=0.383064
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=4 metric=0.1397 head_norm=0.685104
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.060663e-01
[S15] stored merged vector for next round verification (round=4)
[S15] DEBUG after merge:  round=4 metric=0.4220 head_norm=0.695268 delta_norm=0.206066
[S15] aggregate: ACCEPT kept=['S7', 'S3', 'S13'] (k=3/3) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.248358 (no previous merge yet)
[S2] round=5 local utility u=0.700524 metrics={'f1_val': 0.41592297122298333, 'auprc': 0.6995393052001224, 'loss_val': 1.0401135978773839, 'psi': 0.5293695048138389}-{'f1_val': 0.19653284223198603, 'auprc': 0.7083737771393988, 'loss_val': 1.1513234856695433, 'psi': 0.4012692161949511}
[S3] START round=5 head_norm_before_train=1.351362 (no previous merge yet)
[S3] round=5 local utility u=0.424666 metrics={'f1_val': 0.45632761016807893, 'auprc': 0.9906909938182553, 'loss_val': 0.685579341650626, 'psi': 0.6700729636281495}-{'f1_val': 0.39623514491051715, 'auprc': 0.8768213811907961, 'loss_val': 0.8327482140740388, 'psi': 0.5884696394226288}
[S4] START round=5 head_norm_before_train=1.283388 (no previous merge yet)
[S4] round=5 local utility u=0.806958 metrics={'f1_val': 0.3737917214373826, 'auprc': 0.7631659758810986, 'loss_val': 1.0233148948397548, 'psi': 0.529541423214869}-{'f1_val': 0.14022662889518414, 'auprc': 0.7301823353873826, 'loss_val': 1.136889076082911, 'psi': 0.37620891149206354}
[S5] START round=5 head_norm_before_train=0.920514 cos_to_last_merge=0.9590 (last merge round=1)
[S5] round=5 local utility u=0.330398 metrics={'f1_val': 0.4181537288170242, 'auprc': 0.9322304998569317, 'loss_val': 0.8254348429357815, 'psi': 0.6237844372329873}-{'f1_val': 0.41782980503278466, 'auprc': 0.7566439852066092, 'loss_val': 0.957528054480906, 'psi': 0.5533554771023145}
[S6] START round=5 head_norm_before_train=1.238637 (no previous merge yet)
[S6] round=5 local utility u=0.017945 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6207895543745604, 'loss_val': 1.0844936780392322, 'psi': 0.3331715909805934}-{'f1_val': 0.14142628205128205, 'auprc': 0.6434919774405881, 'loss_val': 1.1884900881737626, 'psi': 0.34225256020700445}
[S7] START round=5 head_norm_before_train=1.289637 (no previous merge yet)
[S7] round=5 local utility u=0.988700 metrics={'f1_val': 0.4423802103049064, 'auprc': 0.7771719572959258, 'loss_val': 0.9155774616118599, 'psi': 0.5762969091013141}-{'f1_val': 0.14205682272909165, 'auprc': 0.7770514478268139, 'loss_val': 1.0906762515223025, 'psi': 0.39605467276818057}
[S8] START round=5 head_norm_before_train=0.837258 cos_to_last_merge=0.9916 (last merge round=2)
[S8] round=5 local utility u=0.036160 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7660500768470255, 'loss_val': 1.174254203483053, 'psi': 0.39039362017458457}-{'f1_val': 0.13995598239295717, 'auprc': 0.7658531561006567, 'loss_val': 1.2459842215839139, 'psi': 0.39031485187603704}
[S9] START round=5 head_norm_before_train=0.744175 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.373871 metrics={'f1_val': 0.7005173584196973, 'auprc': 0.9993752613169565, 'loss_val': 0.763082427077592, 'psi': 0.820060519578601}-{'f1_val': 0.5917163705213886, 'auprc': 0.9994929911804568, 'loss_val': 0.858372422292552, 'psi': 0.7548270187850159}
[S10] START round=5 head_norm_before_train=1.281014 (no previous merge yet)
[S10] round=5 local utility u=0.035505 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7755790735601763, 'loss_val': 1.1062046640754224, 'psi': 0.3934046119491049}-{'f1_val': 0.13862163754172394, 'auprc': 0.7854413618634347, 'loss_val': 1.206800914065805, 'psi': 0.3973495272704083}
[S11] START round=5 head_norm_before_train=0.945965 cos_to_last_merge=0.9897 (last merge round=2)
[S11] round=5 local utility u=0.012357 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6437285426445996, 'loss_val': 1.1480437024233785, 'psi': 0.3417396270817062}-{'f1_val': 0.14041368337311058, 'auprc': 0.6603562459795338, 'loss_val': 1.2226400569036557, 'psi': 0.3483907084156799}
[S13] START round=5 head_norm_before_train=1.279546 (no previous merge yet)
[S13] round=5 local utility u=0.628503 metrics={'f1_val': 0.41607788054795825, 'auprc': 0.6117245381713332, 'loss_val': 1.066676075825258, 'psi': 0.4943365435973082}-{'f1_val': 0.24292793554732772, 'auprc': 0.5718618428328306, 'loss_val': 1.1651933829431576, 'psi': 0.3745014984615289}
[S14] START round=5 head_norm_before_train=1.263118 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7310701667460243, 'loss_val': 1.1655538412094772, 'psi': 0.376642778428032}-{'f1_val': 0.14035785288270378, 'auprc': 0.7746317642342221, 'loss_val': 1.2440406950080216, 'psi': 0.3940674174233111}
[S15] START round=5 head_norm_before_train=0.695268 cos_to_last_merge=1.0000 (last merge round=4)
[S15] round=5 local utility u=0.013131 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7491132324007487, 'loss_val': 1.284295071402996, 'psi': 0.38348548377723446}-{'f1_val': 0.13973365136155833, 'auprc': 0.745945733172877, 'loss_val': 1.301055011392183, 'psi': 0.38221848408608583}
[S16] START round=5 head_norm_before_train=0.964117 cos_to_last_merge=0.9785 (last merge round=1)
[S16] round=5 local utility u=0.621646 metrics={'f1_val': 0.41467924219943564, 'auprc': 0.6285072115141587, 'loss_val': 1.0847516067829868, 'psi': 0.5002104299253248}-{'f1_val': 0.14063745019920318, 'auprc': 0.7948027156433901, 'loss_val': 1.1826787787602235, 'psi': 0.402303556376878}
[S17] START round=5 head_norm_before_train=0.972271 cos_to_last_merge=0.9751 (last merge round=1)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.15049359436525983, 'auprc': 0.5865869313233765, 'loss_val': 1.1064550840976428, 'psi': 0.3249309291485065}-{'f1_val': 0.14094896331738438, 'auprc': 0.7487970059461535, 'loss_val': 1.240079601048013, 'psi': 0.38408818036889203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:57011
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[S13] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=-0.0713
[S2] DROPPED delta from S4 (cos=-0.0713 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S2
[S10] cosine check vs S2: cos=-0.0194
[S10] DROPPED delta from S2 (cos=-0.0194 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=-0.0301
[S6] DROPPED delta from S16 (cos=-0.0301 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] cosine check vs S6: cos=-0.0397
[S8] DROPPED delta from S6 (cos=-0.0397 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S9
[S3] cosine check vs S9: cos=-0.0283
[S3] DROPPED delta from S9 (cos=-0.0283 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S11
[S7] cosine check vs S11: cos=-0.0123
[S7] DROPPED delta from S11 (cos=-0.0123 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1805) from S15
[S10] cosine check vs S15: cos=0.0128
[S15] RECEIVED delta(kind=head bytes=1796) from S7
[S15] cosine check vs S7: cos=0.5824
[S3] RECEIVED delta(kind=head bytes=1792) from S8
[S3] cosine check vs S8: cos=-0.0630
[S3] DROPPED delta from S8 (cos=-0.0630 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S13
[S15] cosine check vs S13: cos=0.6123
[S15] RECEIVED delta(kind=head bytes=1802) from S3
[S15] cosine check vs S3: cos=0.4462
[S7] RECEIVED delta(kind=head bytes=1789) from S10
[S7] cosine check vs S10: cos=-0.0586
[S7] DROPPED delta from S10 (cos=-0.0586 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.8271
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.421 → S6@127.0.0.1:57007
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.1386 head_norm=1.317762
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.467096e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.1991 head_norm=0.754773 delta_norm=0.746710
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.386 → S7@127.0.0.1:57008
[S6] ⇄ pheromone p=0.335 → S8@127.0.0.1:57009
[S4] ⇄ pheromone p=0.575 → S2@127.0.0.1:57002
[S13] ⇄ pheromone p=0.604 → S15@127.0.0.1:57015
[S16] ⇄ pheromone p=0.470 → S6@127.0.0.1:57007
[S11] ⇄ pheromone p=0.335 → S7@127.0.0.1:57008
[S2] ⇄ pheromone p=0.487 → S10@127.0.0.1:57011
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.1397 head_norm=0.719735
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.394952e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.4221 head_norm=0.745266 delta_norm=0.139495
[S15] aggregate: ACCEPT kept=['S7', 'S13', 'S3'] (k=3/3) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.439 → S10@127.0.0.1:57011
[S7] ⇄ pheromone p=0.542 → S15@127.0.0.1:57015
[S8] ⇄ pheromone p=0.360 → S3@127.0.0.1:57003
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.7005 head_norm=0.819446
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.775638e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.7013 head_norm=0.863944 delta_norm=0.277564
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.607 → S3@127.0.0.1:57003
[S3] ⇄ pheromone p=0.614 → S15@127.0.0.1:57015
[S5] ⇄ pheromone p=0.529 → S9@127.0.0.1:57010
[S17] ⇄ pheromone p=0.353 → S8@127.0.0.1:57009
[S2] START round=6 head_norm_before_train=1.290540 (no previous merge yet)
[S2] round=6 local utility u=0.194797 metrics={'f1_val': 0.41698116645107436, 'auprc': 0.7765340591634543, 'loss_val': 0.8878522384191155, 'psi': 0.5608023235360264}-{'f1_val': 0.41592297122298333, 'auprc': 0.6995393052001224, 'loss_val': 1.0401135978773839, 'psi': 0.5293695048138389}
[S3] START round=6 head_norm_before_train=1.419348 (no previous merge yet)
[S3] round=6 local utility u=0.513280 metrics={'f1_val': 0.5952462550464983, 'auprc': 0.9956812419054888, 'loss_val': 0.5075016883970167, 'psi': 0.7554202497900946}-{'f1_val': 0.45632761016807893, 'auprc': 0.9906909938182553, 'loss_val': 0.685579341650626, 'psi': 0.6700729636281495}
[S4] START round=6 head_norm_before_train=1.318446 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.3798890012721833, 'auprc': 0.640648335016219, 'loss_val': 0.9145362818628451, 'psi': 0.4841927347697975}-{'f1_val': 0.3737917214373826, 'auprc': 0.7631659758810986, 'loss_val': 1.0233148948397548, 'psi': 0.529541423214869}
[S5] START round=6 head_norm_before_train=0.987618 cos_to_last_merge=0.9275 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.927
[S5] round=6 local utility u=0.000000 metrics={'f1_val': 0.43138322137533114, 'auprc': 0.8620506623420563, 'loss_val': 0.7211407526424699, 'psi': 0.6036501977620212}-{'f1_val': 0.4181537288170242, 'auprc': 0.9322304998569317, 'loss_val': 0.8254348429357815, 'psi': 0.6237844372329873}
[S6] START round=6 head_norm_before_train=1.268042 (no previous merge yet)
[S6] round=6 local utility u=0.919325 metrics={'f1_val': 0.41693470025384477, 'auprc': 0.6279893663645605, 'loss_val': 0.920492895282682, 'psi': 0.501356566698131}-{'f1_val': 0.14142628205128205, 'auprc': 0.6207895543745604, 'loss_val': 1.0844936780392322, 'psi': 0.3331715909805934}
[S7] START round=6 head_norm_before_train=1.340194 (no previous merge yet)
[S7] round=6 local utility u=0.687895 metrics={'f1_val': 0.6510913427949556, 'auprc': 0.7843079511205049, 'loss_val': 0.8134630007823088, 'psi': 0.7043779861251753}-{'f1_val': 0.4423802103049064, 'auprc': 0.7771719572959258, 'loss_val': 0.9155774616118599, 'psi': 0.5762969091013141}
[S8] START round=6 head_norm_before_train=0.877618 cos_to_last_merge=0.9831 (last merge round=2)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7147473519913303, 'auprc': 0.7731584689696042, 'loss_val': 1.0890126243041607, 'psi': 0.7381117987826398}-{'f1_val': 0.13995598239295717, 'auprc': 0.7660500768470255, 'loss_val': 1.174254203483053, 'psi': 0.39039362017458457}
[S9] START round=6 head_norm_before_train=0.863944 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.076919 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.9986178936115354, 'loss_val': 0.6125019760103748, 'psi': 0.820310637613587}-{'f1_val': 0.7005173584196973, 'auprc': 0.9993752613169565, 'loss_val': 0.763082427077592, 'psi': 0.820060519578601}
[S10] START round=6 head_norm_before_train=0.754773 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.851313 metrics={'f1_val': 0.37769537665723146, 'auprc': 0.8422187891702393, 'loss_val': 1.0379393809691768, 'psi': 0.5635047416624346}-{'f1_val': 0.13862163754172394, 'auprc': 0.7755790735601763, 'loss_val': 1.1062046640754224, 'psi': 0.3934046119491049}
[S11] START round=6 head_norm_before_train=0.986188 cos_to_last_merge=0.9810 (last merge round=2)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.41575190755414737, 'auprc': 0.8657075696606177, 'loss_val': 1.0318048995809161, 'psi': 0.5957341723967355}-{'f1_val': 0.14041368337311058, 'auprc': 0.6437285426445996, 'loss_val': 1.1480437024233785, 'psi': 0.3417396270817062}
[S13] START round=6 head_norm_before_train=1.311972 (no previous merge yet)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.37550612554840956, 'auprc': 0.5475449006996695, 'loss_val': 0.9826052943214858, 'psi': 0.4443216356089136}-{'f1_val': 0.41607788054795825, 'auprc': 0.6117245381713332, 'loss_val': 1.066676075825258, 'psi': 0.4943365435973082}
[S14] START round=6 head_norm_before_train=1.291919 (no previous merge yet)
[S14] round=6 local utility u=0.098666 metrics={'f1_val': 0.1543059899945361, 'auprc': 0.7331250620938757, 'loss_val': 1.0580762816531888, 'psi': 0.385833618834272}-{'f1_val': 0.14035785288270378, 'auprc': 0.7310701667460243, 'loss_val': 1.1655538412094772, 'psi': 0.376642778428032}
[S15] START round=6 head_norm_before_train=0.745266 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.037641 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7670005852180107, 'loss_val': 1.262674673397775, 'psi': 0.3906404249041393}-{'f1_val': 0.13973365136155833, 'auprc': 0.7491132324007487, 'loss_val': 1.284295071402996, 'psi': 0.38348548377723446}
[S16] START round=6 head_norm_before_train=1.003387 cos_to_last_merge=0.9676 (last merge round=1)
[S16] round=6 local utility u=0.013586 metrics={'f1_val': 0.4170779150236796, 'auprc': 0.5873747508417582, 'loss_val': 0.948573459557036, 'psi': 0.485196649350911}-{'f1_val': 0.41467924219943564, 'auprc': 0.6285072115141587, 'loss_val': 1.0847516067829868, 'psi': 0.5002104299253248}
[S17] START round=6 head_norm_before_train=1.021622 cos_to_last_merge=0.9582 (last merge round=1)
[S17] round=6 local utility u=1.000000 metrics={'f1_val': 0.3731567405281726, 'auprc': 0.7962815580109449, 'loss_val': 0.9189842075094476, 'psi': 0.5424066675212815}-{'f1_val': 0.15049359436525983, 'auprc': 0.5865869313233765, 'loss_val': 1.1064550840976428, 'psi': 0.3249309291485065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:57003
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:57015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S8] → sending delta(kind=head bytes=1789) to S3@127.0.0.1:57003
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S14
[S6] cosine check vs S14: cos=-0.0155
[S6] DROPPED delta from S14 (cos=-0.0155 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1793) from S2
[S10] cosine check vs S2: cos=-0.0886
[S10] DROPPED delta from S2 (cos=-0.0886 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S7
[S15] cosine check vs S7: cos=0.5943
[S15] RECEIVED delta(kind=head bytes=1806) from S3
[S15] cosine check vs S3: cos=0.4663
[S7] RECEIVED delta(kind=head bytes=1793) from S11
[S7] cosine check vs S11: cos=-0.0178
[S7] DROPPED delta from S11 (cos=-0.0178 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] cosine check vs S6: cos=-0.0471
[S8] DROPPED delta from S6 (cos=-0.0471 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.2091
[S3] RECEIVED delta(kind=head bytes=1789) from S8
[S3] cosine check vs S8: cos=-0.0576
[S3] DROPPED delta from S8 (cos=-0.0576 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1804) from S15
[S10] cosine check vs S15: cos=0.4419
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] cosine check vs S9: cos=-0.0269
[S3] DROPPED delta from S9 (cos=-0.0269 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=-0.0323
[S6] DROPPED delta from S16 (cos=-0.0323 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=-0.0702
[S8] DROPPED delta from S17 (cos=-0.0702 < 0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.1397 head_norm=0.767389
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.279931e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.4136 head_norm=0.831337 delta_norm=0.327993
[S15] aggregate: ACCEPT kept=['S7', 'S3'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.3777 head_norm=0.799627
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.140993e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.3882 head_norm=0.665332 delta_norm=0.414099
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.6511 head_norm=1.391403
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.262933e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.3745 head_norm=0.871895 delta_norm=0.726293
[S7] aggregate: ROLLBACK (f1_val pre=0.651 post=0.374 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=1.335428 (no previous merge yet)
[S2] round=7 local utility u=0.789299 metrics={'f1_val': 0.6544217502967571, 'auprc': 0.778889812016828, 'loss_val': 0.740964999343035, 'psi': 0.7042089749847855}-{'f1_val': 0.41698116645107436, 'auprc': 0.7765340591634543, 'loss_val': 0.8878522384191155, 'psi': 0.5608023235360264}
[S3] START round=7 head_norm_before_train=1.488334 (no previous merge yet)
[S3] round=7 local utility u=0.344320 metrics={'f1_val': 0.6876278322539591, 'auprc': 0.9944533122220484, 'loss_val': 0.36946736565151195, 'psi': 0.8103580242411947}-{'f1_val': 0.5952462550464983, 'auprc': 0.9956812419054888, 'loss_val': 0.5075016883970167, 'psi': 0.7554202497900946}
[S4] START round=7 head_norm_before_train=1.355722 (no previous merge yet)
[S4] round=7 local utility u=0.092241 metrics={'f1_val': 0.3792109219950884, 'auprc': 0.6597391094756635, 'loss_val': 0.7832584952569763, 'psi': 0.4914221969873184}-{'f1_val': 0.3798890012721833, 'auprc': 0.640648335016219, 'loss_val': 0.9145362818628451, 'psi': 0.4841927347697975}
[S5] START round=7 head_norm_before_train=1.057685 cos_to_last_merge=0.8989 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.899
[S5] round=7 local utility u=0.685897 metrics={'f1_val': 0.6446507664755308, 'auprc': 0.8605143615527219, 'loss_val': 0.6243439452484718, 'psi': 0.7309962045064072}-{'f1_val': 0.43138322137533114, 'auprc': 0.8620506623420563, 'loss_val': 0.7211407526424699, 'psi': 0.6036501977620212}
[S6] START round=7 head_norm_before_train=1.300272 (no previous merge yet)
[S6] round=7 local utility u=0.475500 metrics={'f1_val': 0.4882779443765037, 'auprc': 0.7542642381295603, 'loss_val': 0.776376476173088, 'psi': 0.5946724618777264}-{'f1_val': 0.41693470025384477, 'auprc': 0.6279893663645605, 'loss_val': 0.920492895282682, 'psi': 0.501356566698131}
[S7] START round=7 head_norm_before_train=0.871895 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.149240 metrics={'f1_val': 0.692297564355313, 'auprc': 0.7812256075335021, 'loss_val': 0.7529730720732125, 'psi': 0.7278687816265887}-{'f1_val': 0.6510913427949556, 'auprc': 0.7843079511205049, 'loss_val': 0.8134630007823088, 'psi': 0.7043779861251753}
[S8] START round=7 head_norm_before_train=0.912518 cos_to_last_merge=0.9746 (last merge round=2)
[S8] round=7 local utility u=0.081171 metrics={'f1_val': 0.7146827657388013, 'auprc': 0.776939147399424, 'loss_val': 0.9376260201138495, 'psi': 0.7395853184030504}-{'f1_val': 0.7147473519913303, 'auprc': 0.7731584689696042, 'loss_val': 1.0890126243041607, 'psi': 0.7381117987826398}
[S9] START round=7 head_norm_before_train=0.942186 cos_to_last_merge=0.9819 (last merge round=5)
[S9] round=7 local utility u=0.113110 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9986138464264308, 'loss_val': 0.385822077525563, 'psi': 0.8202643392020779}-{'f1_val': 0.7014391336149548, 'auprc': 0.9986178936115354, 'loss_val': 0.6125019760103748, 'psi': 0.820310637613587}
[S10] START round=7 head_norm_before_train=0.665332 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.067489 metrics={'f1_val': 0.40360764365655943, 'auprc': 0.8269838452458942, 'loss_val': 1.012729206593296, 'psi': 0.5729581242922934}-{'f1_val': 0.37769537665723146, 'auprc': 0.8422187891702393, 'loss_val': 1.0379393809691768, 'psi': 0.5635047416624346}
[S11] START round=7 head_norm_before_train=1.026498 cos_to_last_merge=0.9725 (last merge round=2)
[S11] round=7 local utility u=0.226019 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9977958918286782, 'loss_val': 0.8606324577749099, 'psi': 0.637029489376971}-{'f1_val': 0.41575190755414737, 'auprc': 0.8657075696606177, 'loss_val': 1.0318048995809161, 'psi': 0.5957341723967355}
[S13] START round=7 head_norm_before_train=1.340319 (no previous merge yet)
[S13] round=7 local utility u=0.021627 metrics={'f1_val': 0.3716616846250217, 'auprc': 0.5454840352114237, 'loss_val': 0.9101014349226488, 'psi': 0.4411906248595825}-{'f1_val': 0.37550612554840956, 'auprc': 0.5475449006996695, 'loss_val': 0.9826052943214858, 'psi': 0.4443216356089136}
[S14] START round=7 head_norm_before_train=1.326070 (no previous merge yet)
[S14] round=7 local utility u=0.965766 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.8633675854498676, 'loss_val': 0.9706011881669799, 'psi': 0.5832635768271017}-{'f1_val': 0.1543059899945361, 'auprc': 0.7331250620938757, 'loss_val': 1.0580762816531888, 'psi': 0.385833618834272}
[S15] START round=7 head_norm_before_train=0.831337 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.051888 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7864273678426649, 'loss_val': 1.2171794772810205, 'psi': 0.39841113795400096}-{'f1_val': 0.13973365136155833, 'auprc': 0.7670005852180107, 'loss_val': 1.262674673397775, 'psi': 0.3906404249041393}
[S16] START round=7 head_norm_before_train=1.038968 cos_to_last_merge=0.9564 (last merge round=1)
[S16] round=7 local utility u=0.236861 metrics={'f1_val': 0.38366666529125115, 'auprc': 0.7793915338531041, 'loss_val': 0.8504338608600146, 'psi': 0.5419566127159924}-{'f1_val': 0.4170779150236796, 'auprc': 0.5873747508417582, 'loss_val': 0.948573459557036, 'psi': 0.485196649350911}
[S17] START round=7 head_norm_before_train=1.080425 cos_to_last_merge=0.9384 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.938
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.34631625230250496, 'auprc': 0.6282620113844171, 'loss_val': 0.9823865164791552, 'psi': 0.4590945559352698}-{'f1_val': 0.3731567405281726, 'auprc': 0.7962815580109449, 'loss_val': 0.9189842075094476, 'psi': 0.5424066675212815}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:57008
[S9] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S14
[S6] cosine check vs S14: cos=-0.0183
[S6] DROPPED delta from S14 (cos=-0.0183 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] cosine check vs S6: cos=-0.0532
[S8] DROPPED delta from S6 (cos=-0.0532 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1789) from S5
[S9] cosine check vs S5: cos=0.8298
[S3] RECEIVED delta(kind=head bytes=1793) from S9
[S3] cosine check vs S9: cos=-0.0293
[S3] DROPPED delta from S9 (cos=-0.0293 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1792) from S7
[S15] cosine check vs S7: cos=0.7104
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] cosine check vs S8: cos=-0.0567
[S3] DROPPED delta from S8 (cos=-0.0567 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1792) from S16
[S6] cosine check vs S16: cos=-0.0333
[S6] DROPPED delta from S16 (cos=-0.0333 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S13
[S15] cosine check vs S13: cos=0.3305
[S7] RECEIVED delta(kind=head bytes=1794) from S11
[S7] cosine check vs S11: cos=-0.0619
[S7] DROPPED delta from S11 (cos=-0.0619 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=0.7266
[S2] RECEIVED delta(kind=head bytes=1793) from S4
[S2] cosine check vs S4: cos=-0.0730
[S2] DROPPED delta from S4 (cos=-0.0730 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S15
[S10] cosine check vs S15: cos=0.7168
[S10] RECEIVED delta(kind=head bytes=1800) from S2
[S10] cosine check vs S2: cos=-0.1402
[S10] DROPPED delta from S2 (cos=-0.1402 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S3
[S15] cosine check vs S3: cos=0.6301
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7014 head_norm=1.044268
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.157061e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.7014 head_norm=1.030208 delta_norm=0.315706
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.6923 head_norm=0.945707
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.249297e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.5767 head_norm=0.766413 delta_norm=0.324930
[S7] aggregate: ROLLBACK (f1_val pre=0.692 post=0.577 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.1397 head_norm=0.852064
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.950395e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.2790 head_norm=0.785409 delta_norm=0.195039
[S15] aggregate: ACCEPT kept=['S7', 'S13', 'S3'] (k=3/3) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.4036 head_norm=0.701124
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.004804e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.4103 head_norm=0.720073 delta_norm=0.300480
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.387181 (no previous merge yet)
[S2] round=8 local utility u=0.090369 metrics={'f1_val': 0.676529405514389, 'auprc': 0.7755710537867481, 'loss_val': 0.6829167849364283, 'psi': 0.7161460648233327}-{'f1_val': 0.6544217502967571, 'auprc': 0.778889812016828, 'loss_val': 0.740964999343035, 'psi': 0.7042089749847855}
[S3] START round=8 head_norm_before_train=1.553339 (no previous merge yet)
[S3] round=8 local utility u=0.093913 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9968980200556585, 'loss_val': 0.26774660900677777, 'psi': 0.8192129302634432}-{'f1_val': 0.6876278322539591, 'auprc': 0.9944533122220484, 'loss_val': 0.36946736565151195, 'psi': 0.8103580242411947}
[S4] START round=8 head_norm_before_train=1.405397 (no previous merge yet)
[S4] round=8 local utility u=0.382704 metrics={'f1_val': 0.37654696532808385, 'auprc': 0.9077164691867505, 'loss_val': 0.7457997163268834, 'psi': 0.5890147668715505}-{'f1_val': 0.3792109219950884, 'auprc': 0.6597391094756635, 'loss_val': 0.7832584952569763, 'psi': 0.4914221969873184}
[S5] START round=8 head_norm_before_train=1.109730 cos_to_last_merge=0.8797 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.880
[S5] round=8 local utility u=0.087860 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.7564000297626742, 'loss_val': 0.47351861124300165, 'psi': 0.723074181994589}-{'f1_val': 0.6446507664755308, 'auprc': 0.8605143615527219, 'loss_val': 0.6243439452484718, 'psi': 0.7309962045064072}
[S6] START round=8 head_norm_before_train=1.337774 (no previous merge yet)
[S6] round=8 local utility u=0.366928 metrics={'f1_val': 0.5723658755643661, 'auprc': 0.8113227288198372, 'loss_val': 0.7182234723645556, 'psi': 0.6679486168665546}-{'f1_val': 0.4882779443765037, 'auprc': 0.7542642381295603, 'loss_val': 0.776376476173088, 'psi': 0.5946724618777264}
[S7] START round=8 head_norm_before_train=0.766413 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.6662566915090548, 'auprc': 0.7819494686718004, 'loss_val': 0.7489265906848622, 'psi': 0.712533802374153}-{'f1_val': 0.692297564355313, 'auprc': 0.7812256075335021, 'loss_val': 0.7529730720732125, 'psi': 0.7278687816265887}
[S8] START round=8 head_norm_before_train=0.951394 cos_to_last_merge=0.9645 (last merge round=2)
[S8] round=8 local utility u=0.114266 metrics={'f1_val': 0.714395945848483, 'auprc': 0.794418554847265, 'loss_val': 0.7598105495222591, 'psi': 0.7464049894479958}-{'f1_val': 0.7146827657388013, 'auprc': 0.776939147399424, 'loss_val': 0.9376260201138495, 'psi': 0.7395853184030504}
[S9] START round=8 head_norm_before_train=1.030208 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.017421 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9983238958213558, 'loss_val': 0.3496654787430745, 'psi': 0.8201038484530804}-{'f1_val': 0.7013646677191758, 'auprc': 0.9986138464264308, 'loss_val': 0.385822077525563, 'psi': 0.8202643392020779}
[S10] START round=8 head_norm_before_train=0.720073 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.701973 metrics={'f1_val': 0.7015611960235535, 'auprc': 0.6896054156280697, 'loss_val': 0.9843698522609887, 'psi': 0.6967788838653599}-{'f1_val': 0.40360764365655943, 'auprc': 0.8269838452458942, 'loss_val': 1.012729206593296, 'psi': 0.5729581242922934}
[S11] START round=8 head_norm_before_train=1.076787 cos_to_last_merge=0.9621 (last merge round=2)
[S11] round=8 local utility u=0.057972 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.995788056183234, 'loss_val': 0.7591056774885505, 'psi': 0.6382704741547568}-{'f1_val': 0.39651855440916606, 'auprc': 0.9977958918286782, 'loss_val': 0.8606324577749099, 'psi': 0.637029489376971}
[S13] START round=8 head_norm_before_train=1.378164 (no previous merge yet)
[S13] round=8 local utility u=0.304818 metrics={'f1_val': 0.37715456763657795, 'auprc': 0.7065228034019586, 'loss_val': 0.816538136510271, 'psi': 0.5089018619427302}-{'f1_val': 0.3716616846250217, 'auprc': 0.5454840352114237, 'loss_val': 0.9101014349226488, 'psi': 0.4411906248595825}
[S14] START round=8 head_norm_before_train=1.364915 (no previous merge yet)
[S14] round=8 local utility u=0.127530 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.8977207847602859, 'loss_val': 0.8186001085381981, 'psi': 0.597004856551269}-{'f1_val': 0.39652757107859105, 'auprc': 0.8633675854498676, 'loss_val': 0.9706011881669799, 'psi': 0.5832635768271017}
[S15] START round=8 head_norm_before_train=0.785409 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.872369 metrics={'f1_val': 0.4161838404121786, 'auprc': 0.78919321142551, 'loss_val': 1.1394409136171333, 'psi': 0.5653875888175112}-{'f1_val': 0.13973365136155833, 'auprc': 0.7864273678426649, 'loss_val': 1.2171794772810205, 'psi': 0.39841113795400096}
[S16] START round=8 head_norm_before_train=1.076933 cos_to_last_merge=0.9437 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.944
[S16] round=8 local utility u=0.033970 metrics={'f1_val': 0.38485646397217216, 'auprc': 0.7934217784004794, 'loss_val': 0.8317225771685631, 'psi': 0.5482825897434951}-{'f1_val': 0.38366666529125115, 'auprc': 0.7793915338531041, 'loss_val': 0.8504338608600146, 'psi': 0.5419566127159924}
[S17] START round=8 head_norm_before_train=1.138270 cos_to_last_merge=0.9177 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.918
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.33842095576375353, 'auprc': 0.6293362632958157, 'loss_val': 0.9658345177290679, 'psi': 0.4547870787765784}-{'f1_val': 0.34631625230250496, 'auprc': 0.6282620113844171, 'loss_val': 0.9823865164791552, 'psi': 0.4590945559352698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:57008
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:57003
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1791) from S8
[S3] cosine check vs S8: cos=-0.0587
[S3] DROPPED delta from S8 (cos=-0.0587 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=0.9173
[S6] RECEIVED delta(kind=head bytes=1797) from S14
[S6] cosine check vs S14: cos=-0.0195
[S6] DROPPED delta from S14 (cos=-0.0195 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S15
[S10] cosine check vs S15: cos=0.9423
[S10] RECEIVED delta(kind=head bytes=1799) from S2
[S10] cosine check vs S2: cos=-0.1495
[S10] DROPPED delta from S2 (cos=-0.1495 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=-0.0262
[S3] DROPPED delta from S9 (cos=-0.0262 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] cosine check vs S16: cos=-0.0328
[S6] DROPPED delta from S16 (cos=-0.0328 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S13
[S15] cosine check vs S13: cos=0.4966
[S15] RECEIVED delta(kind=head bytes=1797) from S3
[S15] cosine check vs S3: cos=0.5735
[S7] RECEIVED delta(kind=head bytes=1797) from S11
[S7] cosine check vs S11: cos=-0.0708
[S7] DROPPED delta from S11 (cos=-0.0708 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] cosine check vs S10: cos=0.8766
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=-0.0581
[S8] DROPPED delta from S6 (cos=-0.0581 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1805) from S4
[S2] cosine check vs S4: cos=-0.0749
[S2] DROPPED delta from S4 (cos=-0.0749 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.6663 head_norm=0.857351
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.062674e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.6582 head_norm=0.777856 delta_norm=0.206267
[S7] aggregate: ROLLBACK (f1_val pre=0.666 post=0.658 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7013 head_norm=1.117384
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.322196e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7013 head_norm=1.114156 delta_norm=0.232220
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.7016 head_norm=0.748441
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.365095e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.7012 head_norm=0.769779 delta_norm=0.136509
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.4162 head_norm=0.813772
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.511416e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.7153 head_norm=0.884711 delta_norm=0.351142
[S15] aggregate: ACCEPT kept=['S13', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.437741 (no previous merge yet)
[S2] round=9 local utility u=0.205461 metrics={'f1_val': 0.713112628785628, 'auprc': 0.7928651744164417, 'loss_val': 0.5433755962896762, 'psi': 0.7450136470379534}-{'f1_val': 0.676529405514389, 'auprc': 0.7755710537867481, 'loss_val': 0.6829167849364283, 'psi': 0.7161460648233327}
[S3] START round=9 head_norm_before_train=1.603344 (no previous merge yet)
[S3] round=9 local utility u=0.024294 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9986263489426035, 'loss_val': 0.22389134018738624, 'psi': 0.8198591153762422}-{'f1_val': 0.7007562037352997, 'auprc': 0.9968980200556585, 'loss_val': 0.26774660900677777, 'psi': 0.8192129302634432}
[S4] START round=9 head_norm_before_train=1.457902 (no previous merge yet)
[S4] round=9 local utility u=0.047261 metrics={'f1_val': 0.3763933322295893, 'auprc': 0.9296764623547041, 'loss_val': 0.7162350648013398, 'psi': 0.5977065842796353}-{'f1_val': 0.37654696532808385, 'auprc': 0.9077164691867505, 'loss_val': 0.7457997163268834, 'psi': 0.5890147668715505}
[S5] START round=9 head_norm_before_train=1.158443 cos_to_last_merge=0.8641 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.864
[S5] round=9 local utility u=0.046291 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.7588962402347041, 'loss_val': 0.3884253422848469, 'psi': 0.7240726661834009}-{'f1_val': 0.7008569501491988, 'auprc': 0.7564000297626742, 'loss_val': 0.47351861124300165, 'psi': 0.723074181994589}
[S6] START round=9 head_norm_before_train=1.372028 (no previous merge yet)
[S6] round=9 local utility u=0.555673 metrics={'f1_val': 0.6698320619602365, 'auprc': 0.9567840854595422, 'loss_val': 0.6280590915348142, 'psi': 0.7846128713599587}-{'f1_val': 0.5723658755643661, 'auprc': 0.8113227288198372, 'loss_val': 0.7182234723645556, 'psi': 0.6679486168665546}
[S7] START round=9 head_norm_before_train=0.777856 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.042725 metrics={'f1_val': 0.6659198371802499, 'auprc': 0.7831785413852781, 'loss_val': 0.6651429159449849, 'psi': 0.7128233188622612}-{'f1_val': 0.6662566915090548, 'auprc': 0.7819494686718004, 'loss_val': 0.7489265906848622, 'psi': 0.712533802374153}
[S8] START round=9 head_norm_before_train=0.999566 cos_to_last_merge=0.9515 (last merge round=2)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.40674693719942434, 'auprc': 0.8665275592342403, 'loss_val': 0.6652859630065431, 'psi': 0.5906591860133508}-{'f1_val': 0.714395945848483, 'auprc': 0.794418554847265, 'loss_val': 0.7598105495222591, 'psi': 0.7464049894479958}
[S9] START round=9 head_norm_before_train=1.114156 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9838392255914523, 'loss_val': 0.3384580456816437, 'psi': 0.814309980361119}-{'f1_val': 0.7012904835408967, 'auprc': 0.9983238958213558, 'loss_val': 0.3496654787430745, 'psi': 0.8201038484530804}
[S10] START round=9 head_norm_before_train=0.769779 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.124987 metrics={'f1_val': 0.6058975534006521, 'auprc': 0.9368811201332516, 'loss_val': 0.902241072738453, 'psi': 0.7382909800936919}-{'f1_val': 0.7015611960235535, 'auprc': 0.6896054156280697, 'loss_val': 0.9843698522609887, 'psi': 0.6967788838653599}
[S11] START round=9 head_norm_before_train=1.126948 cos_to_last_merge=0.9508 (last merge round=2)
[S11] round=9 local utility u=0.998855 metrics={'f1_val': 0.7016501368687256, 'auprc': 0.9966889952910497, 'loss_val': 0.5744472084189801, 'psi': 0.8196656802376552}-{'f1_val': 0.39992541946910537, 'auprc': 0.995788056183234, 'loss_val': 0.7591056774885505, 'psi': 0.6382704741547568}
[S13] START round=9 head_norm_before_train=1.411707 (no previous merge yet)
[S13] round=9 local utility u=1.000000 metrics={'f1_val': 0.68877170567594, 'auprc': 0.7589848015799993, 'loss_val': 0.7190742198432342, 'psi': 0.7168569440375638}-{'f1_val': 0.37715456763657795, 'auprc': 0.7065228034019586, 'loss_val': 0.816538136510271, 'psi': 0.5089018619427302}
[S14] START round=9 head_norm_before_train=1.412349 (no previous merge yet)
[S14] round=9 local utility u=0.880110 metrics={'f1_val': 0.6221747983226349, 'auprc': 0.9931694553779475, 'loss_val': 0.698609858333662, 'psi': 0.77057266114476}-{'f1_val': 0.39652757107859105, 'auprc': 0.8977207847602859, 'loss_val': 0.8186001085381981, 'psi': 0.597004856551269}
[S15] START round=9 head_norm_before_train=0.884711 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=1.000000 metrics={'f1_val': 0.7057324324254148, 'auprc': 0.9750442109187674, 'loss_val': 0.9896705100847204, 'psi': 0.8134571438227558}-{'f1_val': 0.4161838404121786, 'auprc': 0.78919321142551, 'loss_val': 1.1394409136171333, 'psi': 0.5653875888175112}
[S16] START round=9 head_norm_before_train=1.116021 cos_to_last_merge=0.9313 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.931
[S16] round=9 local utility u=0.025571 metrics={'f1_val': 0.384863682881596, 'auprc': 0.7915947875275701, 'loss_val': 0.7751422475636034, 'psi': 0.5475561247399856}-{'f1_val': 0.38485646397217216, 'auprc': 0.7934217784004794, 'loss_val': 0.8317225771685631, 'psi': 0.5482825897434951}
[S17] START round=9 head_norm_before_train=1.189481 cos_to_last_merge=0.8986 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.899
[S17] round=9 local utility u=0.009960 metrics={'f1_val': 0.3406611989204915, 'auprc': 0.6468829247986048, 'loss_val': 1.0119969155986306, 'psi': 0.46314988927173684}-{'f1_val': 0.33842095576375353, 'auprc': 0.6293362632958157, 'loss_val': 0.9658345177290679, 'psi': 0.4547870787765784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:57008
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:57008
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:57011
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S11
[S7] cosine check vs S11: cos=-0.0616
[S7] DROPPED delta from S11 (cos=-0.0616 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=0.9271
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=0.9509
[S15] RECEIVED delta(kind=head bytes=1798) from S7
[S15] cosine check vs S7: cos=0.6891
[S15] RECEIVED delta(kind=head bytes=1805) from S13
[S15] cosine check vs S13: cos=0.6285
[S10] RECEIVED delta(kind=head bytes=1804) from S15
[S10] cosine check vs S15: cos=0.8705
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=-0.0320
[S6] DROPPED delta from S16 (cos=-0.0320 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1804) from S2
[S10] cosine check vs S2: cos=-0.1470
[S10] DROPPED delta from S2 (cos=-0.1470 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S14
[S6] cosine check vs S14: cos=-0.0191
[S6] DROPPED delta from S14 (cos=-0.0191 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=-0.0626
[S8] DROPPED delta from S6 (cos=-0.0626 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S3
[S15] cosine check vs S3: cos=0.7019
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] cosine check vs S4: cos=-0.0756
[S2] DROPPED delta from S4 (cos=-0.0756 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=-0.0674
[S8] DROPPED delta from S17 (cos=-0.0674 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.7013 head_norm=1.190809
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.879468e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7013 head_norm=1.183414 delta_norm=0.187947
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.7057 head_norm=0.919439
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.546584e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.6914 head_norm=0.855199 delta_norm=0.154658
[S15] aggregate: ROLLBACK (f1_val pre=0.706 post=0.691 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.6059 head_norm=0.801378
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.262427e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.6800 head_norm=0.832227 delta_norm=0.226243
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.6659 head_norm=0.866668
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.624099e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.6636 head_norm=0.818708 delta_norm=0.162410
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.486194 (no previous merge yet)
[S2] round=10 local utility u=0.015486 metrics={'f1_val': 0.6998404497248482, 'auprc': 0.7921287308249136, 'loss_val': 0.43056155664574847, 'psi': 0.7367557621648744}-{'f1_val': 0.713112628785628, 'auprc': 0.7928651744164417, 'loss_val': 0.5433755962896762, 'psi': 0.7450136470379534}
[S3] START round=10 head_norm_before_train=1.648977 (no previous merge yet)
[S3] round=10 local utility u=0.619152 metrics={'f1_val': 0.8955690257978923, 'auprc': 0.9984528362274205, 'loss_val': 0.1543958696951704, 'psi': 0.9367225499697036}-{'f1_val': 0.7006809596653347, 'auprc': 0.9986263489426035, 'loss_val': 0.22389134018738624, 'psi': 0.8198591153762422}
[S4] START round=10 head_norm_before_train=1.510319 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.3760367776072795, 'auprc': 0.8631280591800183, 'loss_val': 0.6699801547167898, 'psi': 0.570873290236375}-{'f1_val': 0.3763933322295893, 'auprc': 0.9296764623547041, 'loss_val': 0.7162350648013398, 'psi': 0.5977065842796353}
[S5] START round=10 head_norm_before_train=1.205637 cos_to_last_merge=0.8509 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.851
[S5] round=10 local utility u=0.131792 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.8296124214901262, 'loss_val': 0.33698965388188035, 'psi': 0.7523591386855697}-{'f1_val': 0.7008569501491988, 'auprc': 0.7588962402347041, 'loss_val': 0.3884253422848469, 'psi': 0.7240726661834009}
[S6] START round=10 head_norm_before_train=1.400671 (no previous merge yet)
[S6] round=10 local utility u=0.143674 metrics={'f1_val': 0.7101639028673369, 'auprc': 0.955648156277435, 'loss_val': 0.5792946464688533, 'psi': 0.8083576042313761}-{'f1_val': 0.6698320619602365, 'auprc': 0.9567840854595422, 'loss_val': 0.6280590915348142, 'psi': 0.7846128713599587}
[S7] START round=10 head_norm_before_train=0.818708 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.40902985349407106, 'auprc': 0.7384456680906607, 'loss_val': 0.849910258488198, 'psi': 0.540796179332707}-{'f1_val': 0.6659198371802499, 'auprc': 0.7831785413852781, 'loss_val': 0.6651429159449849, 'psi': 0.7128233188622612}
[S8] START round=10 head_norm_before_train=1.050395 cos_to_last_merge=0.9352 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.935
[S8] round=10 local utility u=1.000000 metrics={'f1_val': 0.7141742661762565, 'auprc': 0.9973539062616747, 'loss_val': 0.48866024142977665, 'psi': 0.8274461222104238}-{'f1_val': 0.40674693719942434, 'auprc': 0.8665275592342403, 'loss_val': 0.6652859630065431, 'psi': 0.5906591860133508}
[S9] START round=10 head_norm_before_train=1.183414 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.6999961944937237, 'auprc': 0.8981496773832289, 'loss_val': 0.35844947566846197, 'psi': 0.7792575876495258}-{'f1_val': 0.7012904835408967, 'auprc': 0.9838392255914523, 'loss_val': 0.3384580456816437, 'psi': 0.814309980361119}
[S10] START round=10 head_norm_before_train=0.832227 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.438473 metrics={'f1_val': 0.7014667009264342, 'auprc': 0.995364517221491, 'loss_val': 0.7741598389695594, 'psi': 0.8190258274444568}-{'f1_val': 0.6058975534006521, 'auprc': 0.9368811201332516, 'loss_val': 0.902241072738453, 'psi': 0.7382909800936919}
[S11] START round=10 head_norm_before_train=1.182628 cos_to_last_merge=0.9380 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=10 local utility u=0.055245 metrics={'f1_val': 0.7020664967782734, 'auprc': 0.9966409000630838, 'loss_val': 0.4663117053112866, 'psi': 0.8198962580921976}-{'f1_val': 0.7016501368687256, 'auprc': 0.9966889952910497, 'loss_val': 0.5744472084189801, 'psi': 0.8196656802376552}
[S13] START round=10 head_norm_before_train=1.441137 (no previous merge yet)
[S13] round=10 local utility u=0.096469 metrics={'f1_val': 0.7114425853893016, 'auprc': 0.7538686239610131, 'loss_val': 0.6468123953383902, 'psi': 0.7284130008179862}-{'f1_val': 0.68877170567594, 'auprc': 0.7589848015799993, 'loss_val': 0.7190742198432342, 'psi': 0.7168569440375638}
[S14] START round=10 head_norm_before_train=1.464240 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9953441727002398, 'loss_val': 0.5843263623147602, 'psi': 0.636073990466291}-{'f1_val': 0.6221747983226349, 'auprc': 0.9931694553779475, 'loss_val': 0.698609858333662, 'psi': 0.77057266114476}
[S15] START round=10 head_norm_before_train=0.855199 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.7100794492199505, 'auprc': 0.8371304685183869, 'loss_val': 0.8193471445381019, 'psi': 0.760899856939325}-{'f1_val': 0.7057324324254148, 'auprc': 0.9750442109187674, 'loss_val': 0.9896705100847204, 'psi': 0.8134571438227558}
[S16] START round=10 head_norm_before_train=1.150289 cos_to_last_merge=0.9209 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.921
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.3859941923687586, 'auprc': 0.765859207714956, 'loss_val': 0.7593935100251079, 'psi': 0.5379401985072376}-{'f1_val': 0.384863682881596, 'auprc': 0.7915947875275701, 'loss_val': 0.7751422475636034, 'psi': 0.5475561247399856}
[S17] START round=10 head_norm_before_train=1.227452 cos_to_last_merge=0.8838 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.884
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.33418998847178305, 'auprc': 0.6619406180919433, 'loss_val': 1.0915274216142545, 'psi': 0.46529024031984717}-{'f1_val': 0.3406611989204915, 'auprc': 0.6468829247986048, 'loss_val': 1.0119969155986306, 'psi': 0.46314988927173684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:57003
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:57010
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] → sending delta(kind=head bytes=1808) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:57015
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:57008
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1808 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=-0.0654
[S8] DROPPED delta from S6 (cos=-0.0654 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.9658
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=0.8939
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=-0.0649
[S3] DROPPED delta from S8 (cos=-0.0649 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S3
[S15] cosine check vs S3: cos=0.6233
[S15] RECEIVED delta(kind=head bytes=1808) from S13
[S15] cosine check vs S13: cos=0.6279
[S10] RECEIVED delta(kind=head bytes=1799) from S2
[S10] cosine check vs S2: cos=-0.1340
[S10] DROPPED delta from S2 (cos=-0.1340 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S11
[S7] cosine check vs S11: cos=-0.0518
[S7] DROPPED delta from S11 (cos=-0.0518 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4090 head_norm=0.886104
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.015833e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.3952 head_norm=0.850146 delta_norm=0.201583
[S7] aggregate: ROLLBACK (f1_val pre=0.409 post=0.395 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.256 → S15@127.0.0.1:57015
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.7101 head_norm=0.897376
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.754971e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.6677 head_norm=0.981305 delta_norm=0.275497
[S15] aggregate: ROLLBACK (f1_val pre=0.710 post=0.668 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.424 → S10@127.0.0.1:57011
[S14] ⇄ pheromone p=0.402 → S6@127.0.0.1:57007
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7000 head_norm=1.253737
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.635856e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7013 head_norm=1.239302 delta_norm=0.163586
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.219 → S3@127.0.0.1:57003
[S4] ⇄ pheromone p=0.254 → S2@127.0.0.1:57002
[S10] ⇄ pheromone p=0.401 → S7@127.0.0.1:57008
[S6] ⇄ pheromone p=0.398 → S8@127.0.0.1:57009
[S5] ⇄ pheromone p=0.289 → S9@127.0.0.1:57010
[S2] ⇄ pheromone p=0.304 → S10@127.0.0.1:57011
[S11] ⇄ pheromone p=0.393 → S7@127.0.0.1:57008
[S13] ⇄ pheromone p=0.419 → S15@127.0.0.1:57015
[S8] ⇄ pheromone p=0.423 → S3@127.0.0.1:57003
[S3] ⇄ pheromone p=0.418 → S15@127.0.0.1:57015
[S17] ⇄ pheromone p=0.199 → S8@127.0.0.1:57009
[S16] ⇄ pheromone p=0.188 → S6@127.0.0.1:57007
[S2] START round=11 head_norm_before_train=1.536411 (no previous merge yet)
[S2] round=11 local utility u=0.032931 metrics={'f1_val': 0.701690457086531, 'auprc': 0.7916458748702884, 'loss_val': 0.37435090297018275, 'psi': 0.737672624200034}-{'f1_val': 0.6998404497248482, 'auprc': 0.7921287308249136, 'loss_val': 0.43056155664574847, 'psi': 0.7367557621648744}
[S3] START round=11 head_norm_before_train=1.690537 (no previous merge yet)
[S3] round=11 local utility u=0.337459 metrics={'f1_val': 0.9973386888198309, 'auprc': 0.99850540482559, 'loss_val': 0.09025341760908684, 'psi': 0.9978053752221345}-{'f1_val': 0.8955690257978923, 'auprc': 0.9984528362274205, 'loss_val': 0.1543958696951704, 'psi': 0.9367225499697036}
[S4] START round=11 head_norm_before_train=1.559955 (no previous merge yet)
[S4] round=11 local utility u=0.484683 metrics={'f1_val': 0.5538152263712111, 'auprc': 0.7919443260241952, 'loss_val': 0.5537343834997777, 'psi': 0.6490668662324047}-{'f1_val': 0.3760367776072795, 'auprc': 0.8631280591800183, 'loss_val': 0.6699801547167898, 'psi': 0.570873290236375}
[S5] START round=11 head_norm_before_train=1.246356 cos_to_last_merge=0.8403 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=11 local utility u=0.265431 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.991826341902455, 'loss_val': 0.2927686688458477, 'psi': 0.8172447068505013}-{'f1_val': 0.7008569501491988, 'auprc': 0.8296124214901262, 'loss_val': 0.33698965388188035, 'psi': 0.7523591386855697}
[S6] START round=11 head_norm_before_train=1.434514 (no previous merge yet)
[S6] round=11 local utility u=0.020136 metrics={'f1_val': 0.7100570731403014, 'auprc': 0.9550382115571863, 'loss_val': 0.5365518945930742, 'psi': 0.8080495285070554}-{'f1_val': 0.7101639028673369, 'auprc': 0.955648156277435, 'loss_val': 0.5792946464688533, 'psi': 0.8083576042313761}
[S7] START round=11 head_norm_before_train=0.850146 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.44256310121475145, 'auprc': 0.6365956599363909, 'loss_val': 0.8559506365451561, 'psi': 0.5201761247034072}-{'f1_val': 0.40902985349407106, 'auprc': 0.7384456680906607, 'loss_val': 0.849910258488198, 'psi': 0.540796179332707}
[S8] START round=11 head_norm_before_train=1.101538 cos_to_last_merge=0.9184 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.918
[S8] round=11 local utility u=0.061267 metrics={'f1_val': 0.7141092833849391, 'auprc': 0.9980518743109872, 'loss_val': 0.3678294792321305, 'psi': 0.8276863197553583}-{'f1_val': 0.7141742661762565, 'auprc': 0.9973539062616747, 'loss_val': 0.48866024142977665, 'psi': 0.8274461222104238}
[S9] START round=11 head_norm_before_train=1.239302 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.8709306707847403, 'loss_val': 0.34705948945429316, 'psi': 0.7691465584384342}-{'f1_val': 0.6999961944937237, 'auprc': 0.8981496773832289, 'loss_val': 0.35844947566846197, 'psi': 0.7792575876495258}
[S10] START round=11 head_norm_before_train=0.861154 cos_to_last_merge=0.9937 (last merge round=9)
[S10] round=11 local utility u=0.091951 metrics={'f1_val': 0.700942136646399, 'auprc': 0.9973068229745798, 'loss_val': 0.5929375700067098, 'psi': 0.8194880111776714}-{'f1_val': 0.7014667009264342, 'auprc': 0.995364517221491, 'loss_val': 0.7741598389695594, 'psi': 0.8190258274444568}
[S11] START round=11 head_norm_before_train=1.240872 cos_to_last_merge=0.9261 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.926
[S11] round=11 local utility u=0.049795 metrics={'f1_val': 0.7020664967782734, 'auprc': 0.9967590555298267, 'loss_val': 0.3670758844065542, 'psi': 0.8199435202788947}-{'f1_val': 0.7020664967782734, 'auprc': 0.9966409000630838, 'loss_val': 0.4663117053112866, 'psi': 0.8198962580921976}
[S13] START round=11 head_norm_before_train=1.470509 (no previous merge yet)
[S13] round=11 local utility u=0.014719 metrics={'f1_val': 0.7131602690408223, 'auprc': 0.747910883840022, 'loss_val': 0.6098066563658414, 'psi': 0.7270605149605023}-{'f1_val': 0.7114425853893016, 'auprc': 0.7538686239610131, 'loss_val': 0.6468123953383902, 'psi': 0.7284130008179862}
[S14] START round=11 head_norm_before_train=1.507930 (no previous merge yet)
[S14] round=11 local utility u=1.000000 metrics={'f1_val': 0.9873127628365806, 'auprc': 0.9955108120066158, 'loss_val': 0.49789946865925366, 'psi': 0.9905919825045947}-{'f1_val': 0.39656053564365834, 'auprc': 0.9953441727002398, 'loss_val': 0.5843263623147602, 'psi': 0.636073990466291}
[S15] START round=11 head_norm_before_train=0.981305 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.005823 metrics={'f1_val': 0.7081920662959945, 'auprc': 0.813227754232056, 'loss_val': 0.724669539275248, 'psi': 0.7502063414704191}-{'f1_val': 0.7100794492199505, 'auprc': 0.8371304685183869, 'loss_val': 0.8193471445381019, 'psi': 0.760899856939325}
[S16] START round=11 head_norm_before_train=1.179345 cos_to_last_merge=0.9125 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.913
[S16] round=11 local utility u=0.053232 metrics={'f1_val': 0.39837973049839176, 'auprc': 0.7664104304432882, 'loss_val': 0.7288954314767627, 'psi': 0.5455920104763503}-{'f1_val': 0.3859941923687586, 'auprc': 0.765859207714956, 'loss_val': 0.7593935100251079, 'psi': 0.5379401985072376}
[S17] START round=11 head_norm_before_train=1.251009 cos_to_last_merge=0.8725 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.872
[S17] round=11 local utility u=0.023293 metrics={'f1_val': 0.3495644201695682, 'auprc': 0.6936838150079959, 'loss_val': 1.2324170110416781, 'psi': 0.4872121781049392}-{'f1_val': 0.33418998847178305, 'auprc': 0.6619406180919433, 'loss_val': 1.0915274216142545, 'psi': 0.46529024031984717}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:57003
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:57009
[S2] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1807 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.9748
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=-0.0675
[S3] DROPPED delta from S8 (cos=-0.0675 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S14
[S6] cosine check vs S14: cos=-0.0163
[S6] DROPPED delta from S14 (cos=-0.0163 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S15
[S10] cosine check vs S15: cos=0.8983
[S15] RECEIVED delta(kind=head bytes=1807) from S13
[S15] cosine check vs S13: cos=0.6671
[S15] RECEIVED delta(kind=head bytes=1799) from S3
[S15] cosine check vs S3: cos=0.7047
[S7] RECEIVED delta(kind=head bytes=1796) from S11
[S7] cosine check vs S11: cos=-0.0339
[S7] DROPPED delta from S11 (cos=-0.0339 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S2
[S10] cosine check vs S2: cos=-0.1333
[S10] DROPPED delta from S2 (cos=-0.1333 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=-0.0754
[S2] DROPPED delta from S4 (cos=-0.0754 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] cosine check vs S6: cos=-0.0679
[S8] DROPPED delta from S6 (cos=-0.0679 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1804) from S10
[S7] cosine check vs S10: cos=0.9499
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=-0.0294
[S6] DROPPED delta from S16 (cos=-0.0294 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] cosine check vs S17: cos=-0.0602
[S8] DROPPED delta from S17 (cos=-0.0602 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7013 head_norm=1.300657
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.453061e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7013 head_norm=1.283388 delta_norm=0.145306
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4426 head_norm=0.903198
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.428172e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4189 head_norm=0.890932 delta_norm=0.142817
[S7] aggregate: ROLLBACK (f1_val pre=0.443 post=0.419 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.7082 head_norm=1.016573
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.668438e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.6958 head_norm=1.075084 delta_norm=0.166844
[S15] aggregate: ROLLBACK (f1_val pre=0.708 post=0.696 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.7009 head_norm=0.901415
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.234188e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.6983 head_norm=0.934381 delta_norm=0.223419
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.588185 (no previous merge yet)
[S2] round=12 local utility u=0.022494 metrics={'f1_val': 0.7009244439520341, 'auprc': 0.7910147070280428, 'loss_val': 0.3228725893117602, 'psi': 0.7369605491824376}-{'f1_val': 0.701690457086531, 'auprc': 0.7916458748702884, 'loss_val': 0.37435090297018275, 'psi': 0.737672624200034}
[S3] START round=12 head_norm_before_train=1.730183 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.7009355793019081, 'auprc': 0.9988176850908744, 'loss_val': 0.2937007772313831, 'psi': 0.8200884216174946}-{'f1_val': 0.9973386888198309, 'auprc': 0.99850540482559, 'loss_val': 0.09025341760908684, 'psi': 0.9978053752221345}
[S4] START round=12 head_norm_before_train=1.611125 (no previous merge yet)
[S4] round=12 local utility u=0.521996 metrics={'f1_val': 0.6801619471108769, 'auprc': 0.868414064381874, 'loss_val': 0.49723237480245425, 'psi': 0.7554627940192757}-{'f1_val': 0.5538152263712111, 'auprc': 0.7919443260241952, 'loss_val': 0.5537343834997777, 'psi': 0.6490668662324047}
[S5] START round=12 head_norm_before_train=1.282454 cos_to_last_merge=0.8311 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.831
[S5] round=12 local utility u=0.011025 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9923428964652206, 'loss_val': 0.2705412560161881, 'psi': 0.8172786516922466}-{'f1_val': 0.7008569501491988, 'auprc': 0.991826341902455, 'loss_val': 0.2927686688458477, 'psi': 0.8172447068505013}
[S6] START round=12 head_norm_before_train=1.467584 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.7067291555330241, 'auprc': 0.8216782366268756, 'loss_val': 0.518309801166597, 'psi': 0.7527087879705647}-{'f1_val': 0.7100570731403014, 'auprc': 0.9550382115571863, 'loss_val': 0.5365518945930742, 'psi': 0.8080495285070554}
[S7] START round=12 head_norm_before_train=0.890932 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.399467 metrics={'f1_val': 0.5589905250150915, 'auprc': 0.6391726525958208, 'loss_val': 0.7633123073512423, 'psi': 0.5910633760473831}-{'f1_val': 0.44256310121475145, 'auprc': 0.6365956599363909, 'loss_val': 0.8559506365451561, 'psi': 0.5201761247034072}
[S8] START round=12 head_norm_before_train=1.152109 cos_to_last_merge=0.9015 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.902
[S8] round=12 local utility u=0.046303 metrics={'f1_val': 0.7141092833849391, 'auprc': 0.9986752361988918, 'loss_val': 0.2770934949110978, 'psi': 0.8279356645105201}-{'f1_val': 0.7141092833849391, 'auprc': 0.9980518743109872, 'loss_val': 0.3678294792321305, 'psi': 0.8276863197553583}
[S9] START round=12 head_norm_before_train=1.283388 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.238702 metrics={'f1_val': 0.7024932145862333, 'auprc': 0.9979224027518269, 'loss_val': 0.25784669841889934, 'psi': 0.8206648898524707}-{'f1_val': 0.7012904835408967, 'auprc': 0.8709306707847403, 'loss_val': 0.34705948945429316, 'psi': 0.7691465584384342}
[S10] START round=12 head_norm_before_train=0.934381 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.021743 metrics={'f1_val': 0.6994893462768893, 'auprc': 0.9966951235904853, 'loss_val': 0.5388996615978293, 'psi': 0.8183716572023276}-{'f1_val': 0.700942136646399, 'auprc': 0.9973068229745798, 'loss_val': 0.5929375700067098, 'psi': 0.8194880111776714}
[S11] START round=12 head_norm_before_train=1.299060 cos_to_last_merge=0.9154 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.915
[S11] round=12 local utility u=0.052298 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9981371174331541, 'loss_val': 0.2643769144031215, 'psi': 0.8202709347254166}-{'f1_val': 0.7020664967782734, 'auprc': 0.9967590555298267, 'loss_val': 0.3670758844065542, 'psi': 0.8199435202788947}
[S13] START round=12 head_norm_before_train=1.498921 (no previous merge yet)
[S13] round=12 local utility u=0.016101 metrics={'f1_val': 0.7125715761958091, 'auprc': 0.7485760089881187, 'loss_val': 0.5760680165476666, 'psi': 0.7269733493127329}-{'f1_val': 0.7131602690408223, 'auprc': 0.747910883840022, 'loss_val': 0.6098066563658414, 'psi': 0.7270605149605023}
[S14] START round=12 head_norm_before_train=1.544096 (no previous merge yet)
[S14] round=12 local utility u=0.084898 metrics={'f1_val': 0.990852688572518, 'auprc': 0.9971576195660676, 'loss_val': 0.3542831164288497, 'psi': 0.9933746609699379}-{'f1_val': 0.9873127628365806, 'auprc': 0.9955108120066158, 'loss_val': 0.49789946865925366, 'psi': 0.9905919825045947}
[S15] START round=12 head_norm_before_train=1.075084 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.6845405213905417, 'auprc': 0.7507354472924659, 'loss_val': 0.6780042419000061, 'psi': 0.7110184917513114}-{'f1_val': 0.7081920662959945, 'auprc': 0.813227754232056, 'loss_val': 0.724669539275248, 'psi': 0.7502063414704191}
[S16] START round=12 head_norm_before_train=1.212995 cos_to_last_merge=0.9041 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.904
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.3607701831032129, 'auprc': 0.759211473358853, 'loss_val': 0.7455185013312583, 'psi': 0.520146699205469}-{'f1_val': 0.39837973049839176, 'auprc': 0.7664104304432882, 'loss_val': 0.7288954314767627, 'psi': 0.5455920104763503}
[S17] START round=12 head_norm_before_train=1.274107 cos_to_last_merge=0.8640 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.864
[S17] round=12 local utility u=0.236577 metrics={'f1_val': 0.392338913566055, 'auprc': 0.6960922052350174, 'loss_val': 1.023135023464407, 'psi': 0.51384023023364}-{'f1_val': 0.3495644201695682, 'auprc': 0.6936838150079959, 'loss_val': 1.2324170110416781, 'psi': 0.4872121781049392}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:57010
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:57008
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:57011
[S2] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S14
[S6] cosine check vs S14: cos=-0.0149
[S6] DROPPED delta from S14 (cos=-0.0149 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.9812
[S10] RECEIVED delta(kind=head bytes=1797) from S2
[S10] cosine check vs S2: cos=-0.1232
[S10] DROPPED delta from S2 (cos=-0.1232 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1806) from S9
[S3] cosine check vs S9: cos=-0.0129
[S3] DROPPED delta from S9 (cos=-0.0129 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=-0.0682
[S3] DROPPED delta from S8 (cos=-0.0682 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S13
[S15] cosine check vs S13: cos=0.6720
[S15] RECEIVED delta(kind=head bytes=1798) from S7
[S15] cosine check vs S7: cos=0.7759
[S7] RECEIVED delta(kind=head bytes=1804) from S10
[S7] cosine check vs S10: cos=0.9316
[S7] RECEIVED delta(kind=head bytes=1797) from S11
[S7] cosine check vs S11: cos=-0.0281
[S7] DROPPED delta from S11 (cos=-0.0281 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] cosine check vs S4: cos=-0.0735
[S2] DROPPED delta from S4 (cos=-0.0735 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=-0.0561
[S8] DROPPED delta from S17 (cos=-0.0561 < 0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.6845 head_norm=1.106539
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.286822e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.6918 head_norm=1.039458 delta_norm=0.328682
[S15] aggregate: ACCEPT kept=['S13', 'S7'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7025 head_norm=1.338405
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.291407e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7025 head_norm=1.316772 delta_norm=0.129141
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.5590 head_norm=0.944558
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.779505e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.5488 head_norm=0.942565 delta_norm=0.177950
[S7] aggregate: ROLLBACK (f1_val pre=0.559 post=0.549 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.636266 (no previous merge yet)
[S2] round=13 local utility u=0.031278 metrics={'f1_val': 0.700928966771822, 'auprc': 0.8021845730772538, 'loss_val': 0.2938541816154235, 'psi': 0.7414312092939948}-{'f1_val': 0.7009244439520341, 'auprc': 0.7910147070280428, 'loss_val': 0.3228725893117602, 'psi': 0.7369605491824376}
[S3] START round=13 head_norm_before_train=1.766725 (no previous merge yet)
[S3] round=13 local utility u=1.000000 metrics={'f1_val': 0.9971149325810758, 'auprc': 0.9988861895625092, 'loss_val': 0.04966204664803457, 'psi': 0.9978234353736491}-{'f1_val': 0.7009355793019081, 'auprc': 0.9988176850908744, 'loss_val': 0.2937007772313831, 'psi': 0.8200884216174946}
[S4] START round=13 head_norm_before_train=1.655986 (no previous merge yet)
[S4] round=13 local utility u=0.076272 metrics={'f1_val': 0.6843582414147258, 'auprc': 0.8804709543534348, 'loss_val': 0.4060374492214632, 'psi': 0.7628033265902094}-{'f1_val': 0.6801619471108769, 'auprc': 0.868414064381874, 'loss_val': 0.49723237480245425, 'psi': 0.7554627940192757}
[S5] START round=13 head_norm_before_train=1.307594 cos_to_last_merge=0.8245 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.824
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.6587755797980551, 'auprc': 0.8578360960335765, 'loss_val': 0.363577138911819, 'psi': 0.7383997862922637}-{'f1_val': 0.7005691551769304, 'auprc': 0.9923428964652206, 'loss_val': 0.2705412560161881, 'psi': 0.8172786516922466}
[S6] START round=13 head_norm_before_train=1.506723 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.6240424426802698, 'auprc': 0.8188476772855878, 'loss_val': 0.5103970441349939, 'psi': 0.701964536522397}-{'f1_val': 0.7067291555330241, 'auprc': 0.8216782366268756, 'loss_val': 0.518309801166597, 'psi': 0.7527087879705647}
[S7] START round=13 head_norm_before_train=0.942565 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.414751 metrics={'f1_val': 0.6145624193462169, 'auprc': 0.7829533648999188, 'loss_val': 0.6985839865549999, 'psi': 0.6819187975676977}-{'f1_val': 0.5589905250150915, 'auprc': 0.6391726525958208, 'loss_val': 0.7633123073512423, 'psi': 0.5910633760473831}
[S8] START round=13 head_norm_before_train=1.200361 cos_to_last_merge=0.8842 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.884
[S8] round=13 local utility u=0.017516 metrics={'f1_val': 0.7141738056351523, 'auprc': 0.9956386618625968, 'loss_val': 0.23333801018803021, 'psi': 0.8267597481261301}-{'f1_val': 0.7141092833849391, 'auprc': 0.9986752361988918, 'loss_val': 0.2770934949110978, 'psi': 0.8279356645105201}
[S9] START round=13 head_norm_before_train=1.316772 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.891723 metrics={'f1_val': 0.9891606134579545, 'auprc': 0.9992275481482095, 'loss_val': 0.19832026781146447, 'psi': 0.9931873873340564}-{'f1_val': 0.7024932145862333, 'auprc': 0.9979224027518269, 'loss_val': 0.25784669841889934, 'psi': 0.8206648898524707}
[S10] START round=13 head_norm_before_train=0.973654 cos_to_last_merge=0.9955 (last merge round=11)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.6757288248332004, 'auprc': 0.9774163254403904, 'loss_val': 0.4715726062090235, 'psi': 0.7964038250760764}-{'f1_val': 0.6994893462768893, 'auprc': 0.9966951235904853, 'loss_val': 0.5388996615978293, 'psi': 0.8183716572023276}
[S11] START round=13 head_norm_before_train=1.354306 cos_to_last_merge=0.9058 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.906
[S11] round=13 local utility u=0.797969 metrics={'f1_val': 0.9578276111022713, 'auprc': 0.9978963211124744, 'loss_val': 0.20452126697870293, 'psi': 0.9738550951063526}-{'f1_val': 0.7016934795869249, 'auprc': 0.9981371174331541, 'loss_val': 0.2643769144031215, 'psi': 0.8202709347254166}
[S13] START round=13 head_norm_before_train=1.524919 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6157090179925957, 'auprc': 0.7616075820900077, 'loss_val': 0.5793859040868483, 'psi': 0.6740684436315605}-{'f1_val': 0.7125715761958091, 'auprc': 0.7485760089881187, 'loss_val': 0.5760680165476666, 'psi': 0.7269733493127329}
[S14] START round=13 head_norm_before_train=1.579029 (no previous merge yet)
[S14] round=13 local utility u=0.055859 metrics={'f1_val': 0.9974535255208126, 'auprc': 0.997156743945915, 'loss_val': 0.28216792128425894, 'psi': 0.9973348128908536}-{'f1_val': 0.990852688572518, 'auprc': 0.9971576195660676, 'loss_val': 0.3542831164288497, 'psi': 0.9933746609699379}
[S15] START round=13 head_norm_before_train=1.039458 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.098005 metrics={'f1_val': 0.7021533329675385, 'auprc': 0.7714447208584662, 'loss_val': 0.6497994026345943, 'psi': 0.7298698881239096}-{'f1_val': 0.6845405213905417, 'auprc': 0.7507354472924659, 'loss_val': 0.6780042419000061, 'psi': 0.7110184917513114}
[S16] START round=13 head_norm_before_train=1.252993 cos_to_last_merge=0.8943 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.894
[S16] round=13 local utility u=0.439437 metrics={'f1_val': 0.5135970081099499, 'auprc': 0.7703427987104365, 'loss_val': 0.8169986435479476, 'psi': 0.6162953243501446}-{'f1_val': 0.3607701831032129, 'auprc': 0.759211473358853, 'loss_val': 0.7455185013312583, 'psi': 0.520146699205469}
[S17] START round=13 head_norm_before_train=1.294344 cos_to_last_merge=0.8563 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.856
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.34758010827649444, 'auprc': 0.7702248558899041, 'loss_val': 0.9849120033425747, 'psi': 0.5166380073218583}-{'f1_val': 0.392338913566055, 'auprc': 0.6960922052350174, 'loss_val': 1.023135023464407, 'psi': 0.51384023023364}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:57002
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:57011
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1804) from S4
[S2] cosine check vs S4: cos=-0.0708
[S2] DROPPED delta from S4 (cos=-0.0708 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S2
[S10] cosine check vs S2: cos=-0.1213
[S10] DROPPED delta from S2 (cos=-0.1213 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S15
[S10] cosine check vs S15: cos=0.9201
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] cosine check vs S8: cos=-0.0686
[S3] DROPPED delta from S8 (cos=-0.0686 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1806) from S9
[S3] cosine check vs S9: cos=-0.0089
[S3] DROPPED delta from S9 (cos=-0.0089 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S16
[S6] cosine check vs S16: cos=-0.0281
[S6] DROPPED delta from S16 (cos=-0.0281 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] cosine check vs S7: cos=0.8777
[S15] RECEIVED delta(kind=head bytes=1802) from S3
[S15] cosine check vs S3: cos=0.5061
[S6] RECEIVED delta(kind=head bytes=1803) from S14
[S6] cosine check vs S14: cos=-0.0139
[S6] DROPPED delta from S14 (cos=-0.0139 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S11
[S7] cosine check vs S11: cos=-0.0120
[S7] DROPPED delta from S11 (cos=-0.0120 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.6757 head_norm=1.024493
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.112361e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.7056 head_norm=1.028588 delta_norm=0.211236
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.7022 head_norm=1.075008
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.409497e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6973 head_norm=1.071963 delta_norm=0.440950
[S15] aggregate: ACCEPT kept=['S7', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.673759 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.7014631231975678, 'auprc': 0.7942060457185047, 'loss_val': 0.2899335559993071, 'psi': 0.7385602922059425}-{'f1_val': 0.700928966771822, 'auprc': 0.8021845730772538, 'loss_val': 0.2938541816154235, 'psi': 0.7414312092939948}
[S3] START round=14 head_norm_before_train=1.785699 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.797330831924963, 'auprc': 0.9986928356633059, 'loss_val': 0.20315004732836617, 'psi': 0.8778756334203002}-{'f1_val': 0.9971149325810758, 'auprc': 0.9988861895625092, 'loss_val': 0.04966204664803457, 'psi': 0.9978234353736491}
[S4] START round=14 head_norm_before_train=1.696279 (no previous merge yet)
[S4] round=14 local utility u=0.837212 metrics={'f1_val': 0.9156995051545866, 'auprc': 0.9617431955618823, 'loss_val': 0.3634780184874818, 'psi': 0.934116981317505}-{'f1_val': 0.6843582414147258, 'auprc': 0.8804709543534348, 'loss_val': 0.4060374492214632, 'psi': 0.7628033265902094}
[S5] START round=14 head_norm_before_train=1.331001 cos_to_last_merge=0.8204 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.820
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.6298830552697261, 'auprc': 0.8538163257813525, 'loss_val': 0.426813901816294, 'psi': 0.7194563634743767}-{'f1_val': 0.6587755797980551, 'auprc': 0.8578360960335765, 'loss_val': 0.363577138911819, 'psi': 0.7383997862922637}
[S6] START round=14 head_norm_before_train=1.540560 (no previous merge yet)
[S6] round=14 local utility u=0.567839 metrics={'f1_val': 0.7101393473424199, 'auprc': 0.9700074908529418, 'loss_val': 0.34477914389040154, 'psi': 0.8140866047466286}-{'f1_val': 0.6240424426802698, 'auprc': 0.8188476772855878, 'loss_val': 0.5103970441349939, 'psi': 0.701964536522397}
[S7] START round=14 head_norm_before_train=0.994018 cos_to_last_merge=0.9956 (last merge round=12)
[S7] round=14 local utility u=0.069494 metrics={'f1_val': 0.6183997599998805, 'auprc': 0.8014165241609236, 'loss_val': 0.6380102825800356, 'psi': 0.6916064656642977}-{'f1_val': 0.6145624193462169, 'auprc': 0.7829533648999188, 'loss_val': 0.6985839865549999, 'psi': 0.6819187975676977}
[S8] START round=14 head_norm_before_train=1.248373 cos_to_last_merge=0.8688 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.869
[S8] round=14 local utility u=0.115222 metrics={'f1_val': 0.7439321776486054, 'auprc': 0.9982614647482715, 'loss_val': 0.18931187692424864, 'psi': 0.8456638924884718}-{'f1_val': 0.7141738056351523, 'auprc': 0.9956386618625968, 'loss_val': 0.23333801018803021, 'psi': 0.8267597481261301}
[S9] START round=14 head_norm_before_train=1.366049 cos_to_last_merge=0.9975 (last merge round=12)
[S9] round=14 local utility u=0.054679 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9992333961044879, 'loss_val': 0.13928522422568043, 'psi': 0.9982202924481814}-{'f1_val': 0.9891606134579545, 'auprc': 0.9992275481482095, 'loss_val': 0.19832026781146447, 'psi': 0.9931873873340564}
[S10] START round=14 head_norm_before_train=1.028588 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.938663 metrics={'f1_val': 0.9643531656882355, 'auprc': 0.9966488442230231, 'loss_val': 0.3836895442118306, 'psi': 0.9772714371021505}-{'f1_val': 0.6757288248332004, 'auprc': 0.9774163254403904, 'loss_val': 0.4715726062090235, 'psi': 0.7964038250760764}
[S11] START round=14 head_norm_before_train=1.403524 cos_to_last_merge=0.8983 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.898
[S11] round=14 local utility u=0.125274 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9981390997544419, 'loss_val': 0.18950137286605534, 'psi': 0.9974321377485535}-{'f1_val': 0.9578276111022713, 'auprc': 0.9978963211124744, 'loss_val': 0.20452126697870293, 'psi': 0.9738550951063526}
[S13] START round=14 head_norm_before_train=1.552393 (no previous merge yet)
[S13] round=14 local utility u=0.017829 metrics={'f1_val': 0.6314286327161311, 'auprc': 0.7335288444641318, 'loss_val': 0.5538097789215759, 'psi': 0.6722687174153315}-{'f1_val': 0.6157090179925957, 'auprc': 0.7616075820900077, 'loss_val': 0.5793859040868483, 'psi': 0.6740684436315605}
[S14] START round=14 head_norm_before_train=1.612901 (no previous merge yet)
[S14] round=14 local utility u=0.047965 metrics={'f1_val': 0.9977165309073976, 'auprc': 0.9971566636284408, 'loss_val': 0.1878153580306811, 'psi': 0.9974925839958149}-{'f1_val': 0.9974535255208126, 'auprc': 0.997156743945915, 'loss_val': 0.28216792128425894, 'psi': 0.9973348128908536}
[S15] START round=14 head_norm_before_train=1.071963 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6937728655652661, 'auprc': 0.7538993321448059, 'loss_val': 0.6140512733403941, 'psi': 0.717823452197082}-{'f1_val': 0.7021533329675385, 'auprc': 0.7714447208584662, 'loss_val': 0.6497994026345943, 'psi': 0.7298698881239096}
[S16] START round=14 head_norm_before_train=1.292832 cos_to_last_merge=0.8846 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.885
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.39133547253279144, 'auprc': 0.7933388694351102, 'loss_val': 0.769462092106475, 'psi': 0.5521368312937189}-{'f1_val': 0.5135970081099499, 'auprc': 0.7703427987104365, 'loss_val': 0.8169986435479476, 'psi': 0.6162953243501446}
[S17] START round=14 head_norm_before_train=1.311411 cos_to_last_merge=0.8489 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.849
[S17] round=14 local utility u=0.025514 metrics={'f1_val': 0.35236581484865914, 'auprc': 0.7693750689770946, 'loss_val': 0.960047900179135, 'psi': 0.5191695165000334}-{'f1_val': 0.34758010827649444, 'auprc': 0.7702248558899041, 'loss_val': 0.9849120033425747, 'psi': 0.5166380073218583}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S13] → sending delta(kind=head bytes=1811) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:57009
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:57003
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1811 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S14
[S6] cosine check vs S14: cos=-0.0129
[S6] DROPPED delta from S14 (cos=-0.0129 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] cosine check vs S6: cos=-0.0732
[S8] DROPPED delta from S6 (cos=-0.0732 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=-0.0083
[S3] DROPPED delta from S9 (cos=-0.0083 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=-0.0688
[S3] DROPPED delta from S8 (cos=-0.0688 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S7
[S15] cosine check vs S7: cos=0.8870
[S15] RECEIVED delta(kind=head bytes=1811) from S13
[S15] cosine check vs S13: cos=0.5527
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=0.9265
[S7] RECEIVED delta(kind=head bytes=1803) from S11
[S7] cosine check vs S11: cos=-0.0200
[S7] DROPPED delta from S11 (cos=-0.0200 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] cosine check vs S4: cos=-0.0677
[S2] DROPPED delta from S4 (cos=-0.0677 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=-0.0456
[S8] DROPPED delta from S17 (cos=-0.0456 < 0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6938 head_norm=1.106430
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.745725e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.7028 head_norm=1.065932 delta_norm=0.374573
[S15] aggregate: ACCEPT kept=['S7', 'S13'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.6184 head_norm=1.047020
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.035369e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.6014 head_norm=1.039839 delta_norm=0.203537
[S7] aggregate: ROLLBACK (f1_val pre=0.618 post=0.601 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.703030 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7014579280860084, 'auprc': 0.7935221831831776, 'loss_val': 0.3014329532749199, 'psi': 0.7382836301248761}-{'f1_val': 0.7014631231975678, 'auprc': 0.7942060457185047, 'loss_val': 0.2899335559993071, 'psi': 0.7385602922059425}
[S3] START round=15 head_norm_before_train=1.801890 (no previous merge yet)
[S3] round=15 local utility u=0.673862 metrics={'f1_val': 0.9973670153333725, 'auprc': 0.998940775623488, 'loss_val': 0.056387254966472414, 'psi': 0.9979965194494187}-{'f1_val': 0.797330831924963, 'auprc': 0.9986928356633059, 'loss_val': 0.20315004732836617, 'psi': 0.8778756334203002}
[S4] START round=15 head_norm_before_train=1.733769 (no previous merge yet)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.6820074565947354, 'auprc': 0.9631555995597024, 'loss_val': 0.4020380411642896, 'psi': 0.7944667137807222}-{'f1_val': 0.9156995051545866, 'auprc': 0.9617431955618823, 'loss_val': 0.3634780184874818, 'psi': 0.934116981317505}
[S5] START round=15 head_norm_before_train=1.359313 cos_to_last_merge=0.8167 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.817
[S5] round=15 local utility u=0.432048 metrics={'f1_val': 0.7006947214685414, 'auprc': 0.9529514829669808, 'loss_val': 0.2849924304337367, 'psi': 0.8015974260679172}-{'f1_val': 0.6298830552697261, 'auprc': 0.8538163257813525, 'loss_val': 0.426813901816294, 'psi': 0.7194563634743767}
[S6] START round=15 head_norm_before_train=1.571821 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.6088184227486033, 'auprc': 0.801867015630505, 'loss_val': 0.5867523269264363, 'psi': 0.686037859901364}-{'f1_val': 0.7101393473424199, 'auprc': 0.9700074908529418, 'loss_val': 0.34477914389040154, 'psi': 0.8140866047466286}
[S7] START round=15 head_norm_before_train=1.039839 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.219263 metrics={'f1_val': 0.6703439539114948, 'auprc': 0.8169082230739734, 'loss_val': 0.5576248402682986, 'psi': 0.7289696615764862}-{'f1_val': 0.6183997599998805, 'auprc': 0.8014165241609236, 'loss_val': 0.6380102825800356, 'psi': 0.6916064656642977}
[S8] START round=15 head_norm_before_train=1.295562 cos_to_last_merge=0.8547 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.855
[S8] round=15 local utility u=0.640090 metrics={'f1_val': 0.9524146265300153, 'auprc': 0.9982890982159035, 'loss_val': 0.16010878919309776, 'psi': 0.9707644152043706}-{'f1_val': 0.7439321776486054, 'auprc': 0.9982614647482715, 'loss_val': 0.18931187692424864, 'psi': 0.8456638924884718}
[S9] START round=15 head_norm_before_train=1.408192 cos_to_last_merge=0.9930 (last merge round=12)
[S9] round=15 local utility u=0.016035 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9975004686229253, 'loss_val': 0.10201702751518445, 'psi': 0.9975271214555563}-{'f1_val': 0.9975448900106438, 'auprc': 0.9992333961044879, 'loss_val': 0.13928522422568043, 'psi': 0.9982202924481814}
[S10] START round=15 head_norm_before_train=1.071976 cos_to_last_merge=0.9976 (last merge round=13)
[S10] round=15 local utility u=0.121337 metrics={'f1_val': 0.9944887801351068, 'auprc': 0.9945741596904109, 'loss_val': 0.3156058695912938, 'psi': 0.9945229319572284}-{'f1_val': 0.9643531656882355, 'auprc': 0.9966488442230231, 'loss_val': 0.3836895442118306, 'psi': 0.9772714371021505}
[S11] START round=15 head_norm_before_train=1.446205 cos_to_last_merge=0.8926 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.893
[S11] round=15 local utility u=0.014917 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981741580934663, 'loss_val': 0.15729003774653857, 'psi': 0.9971978659455403}-{'f1_val': 0.996960829744628, 'auprc': 0.9981390997544419, 'loss_val': 0.18950137286605534, 'psi': 0.9974321377485535}
[S13] START round=15 head_norm_before_train=1.576834 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6261838214442073, 'auprc': 0.6730891310124076, 'loss_val': 0.5799698928643836, 'psi': 0.6449459452714874}-{'f1_val': 0.6314286327161311, 'auprc': 0.7335288444641318, 'loss_val': 0.5538097789215759, 'psi': 0.6722687174153315}
[S14] START round=15 head_norm_before_train=1.650476 (no previous merge yet)
[S14] round=15 local utility u=0.027058 metrics={'f1_val': 0.9974535255208126, 'auprc': 0.9971558238447888, 'loss_val': 0.13211880180640356, 'psi': 0.9973344448504031}-{'f1_val': 0.9977165309073976, 'auprc': 0.9971566636284408, 'loss_val': 0.1878153580306811, 'psi': 0.9974925839958149}
[S15] START round=15 head_norm_before_train=1.065932 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6914472659088748, 'auprc': 0.737145156143297, 'loss_val': 0.5888518845729582, 'psi': 0.7097264220026438}-{'f1_val': 0.6937728655652661, 'auprc': 0.7538993321448059, 'loss_val': 0.6140512733403941, 'psi': 0.717823452197082}
[S16] START round=15 head_norm_before_train=1.327411 cos_to_last_merge=0.8769 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.877
[S16] round=15 local utility u=0.536896 metrics={'f1_val': 0.5458406198120127, 'auprc': 0.8117334375126677, 'loss_val': 0.6778853017589412, 'psi': 0.6521977468922747}-{'f1_val': 0.39133547253279144, 'auprc': 0.7933388694351102, 'loss_val': 0.769462092106475, 'psi': 0.5521368312937189}
[S17] START round=15 head_norm_before_train=1.329080 cos_to_last_merge=0.8431 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.843
[S17] round=15 local utility u=0.104323 metrics={'f1_val': 0.3818370295456187, 'auprc': 0.7754370410075122, 'loss_val': 0.9464157917440129, 'psi': 0.5392770341303761}-{'f1_val': 0.35236581484865914, 'auprc': 0.7693750689770946, 'loss_val': 0.960047900179135, 'psi': 0.5191695165000334}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:57003
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:57003
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:57015
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.9669
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] cosine check vs S8: cos=-0.0681
[S3] DROPPED delta from S8 (cos=-0.0681 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] cosine check vs S9: cos=-0.0077
[S3] DROPPED delta from S9 (cos=-0.0077 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S3
[S15] cosine check vs S3: cos=0.5458
[S15] RECEIVED delta(kind=head bytes=1804) from S7
[S15] cosine check vs S7: cos=0.9512
[S7] RECEIVED delta(kind=head bytes=1800) from S11
[S7] cosine check vs S11: cos=0.0039
[S6] RECEIVED delta(kind=head bytes=1803) from S16
[S6] cosine check vs S16: cos=-0.0272
[S6] DROPPED delta from S16 (cos=-0.0272 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.9727
[S6] RECEIVED delta(kind=head bytes=1805) from S14
[S6] cosine check vs S14: cos=-0.0121
[S6] DROPPED delta from S14 (cos=-0.0121 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1806 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1806) from S17
[S8] cosine check vs S17: cos=-0.0445
[S8] DROPPED delta from S17 (cos=-0.0445 < 0.0)
[S2] ⇄ pheromone p=0.109 → S10@127.0.0.1:57011
[S13] ⇄ pheromone p=0.143 → S15@127.0.0.1:57015
[S4] ⇄ pheromone p=0.320 → S2@127.0.0.1:57002
[S6] ⇄ pheromone p=0.223 → S8@127.0.0.1:57009
[S11] ⇄ pheromone p=0.263 → S7@127.0.0.1:57008
[S8] ⇄ pheromone p=0.297 → S3@127.0.0.1:57003
[S16] ⇄ pheromone p=0.230 → S6@127.0.0.1:57007
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.9975 head_norm=1.454050
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.856975e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.9975 head_norm=1.408815 delta_norm=0.185697
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.222 → S3@127.0.0.1:57003
[S14] ⇄ pheromone p=0.243 → S6@127.0.0.1:57007
[S5] ⇄ pheromone p=0.204 → S9@127.0.0.1:57010
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.6703 head_norm=1.077341
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.667257e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.6763 head_norm=0.897619 delta_norm=0.466726
[S7] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.233 → S15@127.0.0.1:57015
[S10] ⇄ pheromone p=0.315 → S7@127.0.0.1:57008
[S3] ⇄ pheromone p=0.427 → S15@127.0.0.1:57015
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.6914 head_norm=1.103886
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.970547e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.6823 head_norm=1.126459 delta_norm=0.397055
[S15] aggregate: ROLLBACK (f1_val pre=0.691 post=0.682 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.152 → S10@127.0.0.1:57011
[S17] ⇄ pheromone p=0.116 → S8@127.0.0.1:57009
[S2] START round=16 head_norm_before_train=1.727379 (no previous merge yet)
[S2] round=16 local utility u=0.005619 metrics={'f1_val': 0.7013039002817787, 'auprc': 0.7927233629596654, 'loss_val': 0.28687482995642494, 'psi': 0.7378716853529333}-{'f1_val': 0.7014579280860084, 'auprc': 0.7935221831831776, 'loss_val': 0.3014329532749199, 'psi': 0.7382836301248761}
[S3] START round=16 head_norm_before_train=1.811123 (no previous merge yet)
[S3] round=16 local utility u=0.002032 metrics={'f1_val': 0.9973670153333725, 'auprc': 0.9992112580282951, 'loss_val': 0.053135602007012374, 'psi': 0.9981047124113416}-{'f1_val': 0.9973670153333725, 'auprc': 0.998940775623488, 'loss_val': 0.056387254966472414, 'psi': 0.9979965194494187}
[S4] START round=16 head_norm_before_train=1.764489 (no previous merge yet)
[S4] round=16 local utility u=0.018076 metrics={'f1_val': 0.682311552967467, 'auprc': 0.9677054968674673, 'loss_val': 0.3813610381524094, 'psi': 0.7964691305274672}-{'f1_val': 0.6820074565947354, 'auprc': 0.9631555995597024, 'loss_val': 0.4020380411642896, 'psi': 0.7944667137807222}
[S5] START round=16 head_norm_before_train=1.387164 cos_to_last_merge=0.8142 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.814
[S5] round=16 local utility u=0.067460 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9858174537353905, 'loss_val': 0.24815695702122942, 'psi': 0.8146924378976247}-{'f1_val': 0.7006947214685414, 'auprc': 0.9529514829669808, 'loss_val': 0.2849924304337367, 'psi': 0.8015974260679172}
[S6] START round=16 head_norm_before_train=1.594488 (no previous merge yet)
[S6] round=16 local utility u=0.405289 metrics={'f1_val': 0.6506723132916823, 'auprc': 0.9326333049449942, 'loss_val': 0.419596243562802, 'psi': 0.763456709953007}-{'f1_val': 0.6088184227486033, 'auprc': 0.801867015630505, 'loss_val': 0.5867523269264363, 'psi': 0.686037859901364}
[S7] START round=16 head_norm_before_train=0.897619 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.5376743827867067, 'auprc': 0.77592498513619, 'loss_val': 0.8057676325770271, 'psi': 0.6329746237264999}-{'f1_val': 0.6703439539114948, 'auprc': 0.8169082230739734, 'loss_val': 0.5576248402682986, 'psi': 0.7289696615764862}
[S8] START round=16 head_norm_before_train=1.338819 cos_to_last_merge=0.8425 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.842
[S8] round=16 local utility u=0.154163 metrics={'f1_val': 0.9967901605898053, 'auprc': 0.9984110011839332, 'loss_val': 0.11840141940829718, 'psi': 0.9974384968274566}-{'f1_val': 0.9524146265300153, 'auprc': 0.9982890982159035, 'loss_val': 0.16010878919309776, 'psi': 0.9707644152043706}
[S9] START round=16 head_norm_before_train=1.408815 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9967149094376494, 'auprc': 0.998672110977213, 'loss_val': 0.11588362497081141, 'psi': 0.9974977900534747}-{'f1_val': 0.9975448900106438, 'auprc': 0.9975004686229253, 'loss_val': 0.10201702751518445, 'psi': 0.9975271214555563}
[S10] START round=16 head_norm_before_train=1.116023 cos_to_last_merge=0.9921 (last merge round=13)
[S10] round=16 local utility u=0.011158 metrics={'f1_val': 0.9951941773951698, 'auprc': 0.9941437559993602, 'loss_val': 0.29623084354150603, 'psi': 0.994774008836846}-{'f1_val': 0.9944887801351068, 'auprc': 0.9945741596904109, 'loss_val': 0.3156058695912938, 'psi': 0.9945229319572284}
[S11] START round=16 head_norm_before_train=1.482625 cos_to_last_merge=0.8881 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.888
[S11] round=16 local utility u=0.022546 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980252069239838, 'loss_val': 0.11175063343026867, 'psi': 0.9971382854777473}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981741580934663, 'loss_val': 0.15729003774653857, 'psi': 0.9971978659455403}
[S13] START round=16 head_norm_before_train=1.601804 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.607407657101626, 'auprc': 0.6757310012004248, 'loss_val': 0.6369108682166932, 'psi': 0.6347369947411455}-{'f1_val': 0.6261838214442073, 'auprc': 0.6730891310124076, 'loss_val': 0.5799698928643836, 'psi': 0.6449459452714874}
[S14] START round=16 head_norm_before_train=1.687190 (no previous merge yet)
[S14] round=16 local utility u=0.010239 metrics={'f1_val': 0.9965760575063591, 'auprc': 0.9968881948259171, 'loss_val': 0.10557337246766206, 'psi': 0.9967009124341824}-{'f1_val': 0.9974535255208126, 'auprc': 0.9971558238447888, 'loss_val': 0.13211880180640356, 'psi': 0.9973344448504031}
[S15] START round=16 head_norm_before_train=1.126459 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.115486 metrics={'f1_val': 0.6978866398925341, 'auprc': 0.7856723013634447, 'loss_val': 0.5420967545894017, 'psi': 0.7330009044808983}-{'f1_val': 0.6914472659088748, 'auprc': 0.737145156143297, 'loss_val': 0.5888518845729582, 'psi': 0.7097264220026438}
[S16] START round=16 head_norm_before_train=1.360501 cos_to_last_merge=0.8703 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.870
[S16] round=16 local utility u=0.844375 metrics={'f1_val': 0.827867279069247, 'auprc': 0.8272184413567876, 'loss_val': 0.7277505334948309, 'psi': 0.8276077439842632}-{'f1_val': 0.5458406198120127, 'auprc': 0.8117334375126677, 'loss_val': 0.6778853017589412, 'psi': 0.6521977468922747}
[S17] START round=16 head_norm_before_train=1.344456 cos_to_last_merge=0.8415 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.842
[S17] round=16 local utility u=0.608328 metrics={'f1_val': 0.5814538302525607, 'auprc': 0.7692571125915332, 'loss_val': 0.9089202621650819, 'psi': 0.6565751431881497}-{'f1_val': 0.3818370295456187, 'auprc': 0.7754370410075122, 'loss_val': 0.9464157917440129, 'psi': 0.5392770341303761}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:57002
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[S16] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=-0.0672
[S3] DROPPED delta from S8 (cos=-0.0672 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S3
[S15] cosine check vs S3: cos=0.7889
[S7] RECEIVED delta(kind=head bytes=1804) from S11
[S7] cosine check vs S11: cos=0.4012
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.9028
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=-0.0764
[S8] DROPPED delta from S6 (cos=-0.0764 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.9829
[S2] RECEIVED delta(kind=head bytes=1796) from S4
[S2] cosine check vs S4: cos=-0.0638
[S2] DROPPED delta from S4 (cos=-0.0638 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S14
[S6] cosine check vs S14: cos=-0.0114
[S6] DROPPED delta from S14 (cos=-0.0114 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=-0.0263
[S6] DROPPED delta from S16 (cos=-0.0263 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S2
[S10] cosine check vs S2: cos=-0.1176
[S10] DROPPED delta from S2 (cos=-0.1176 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S15
[S10] cosine check vs S15: cos=0.9178
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=-0.0423
[S8] DROPPED delta from S17 (cos=-0.0423 < 0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.5377 head_norm=0.938127
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.576008e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.5449 head_norm=0.918338 delta_norm=0.257601
[S7] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.9967 head_norm=1.452555
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.342618e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.9967 head_norm=1.422912 delta_norm=0.134262
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.6979 head_norm=1.160168
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.782485e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.6487 head_norm=1.416110 delta_norm=0.578249
[S15] aggregate: ROLLBACK (f1_val pre=0.698 post=0.649 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.9952 head_norm=1.158054
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.349693e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.9952 head_norm=1.135046 delta_norm=0.234969
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.745514 (no previous merge yet)
[S2] round=17 local utility u=0.212516 metrics={'f1_val': 0.7001902662436843, 'auprc': 0.9303407512622025, 'loss_val': 0.2680134963309536, 'psi': 0.7922504602510916}-{'f1_val': 0.7013039002817787, 'auprc': 0.7927233629596654, 'loss_val': 0.28687482995642494, 'psi': 0.7378716853529333}
[S3] START round=17 head_norm_before_train=1.825784 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.9944816393083035, 'auprc': 0.999227239480817, 'loss_val': 0.051395274824319145, 'psi': 0.9963798793773089}-{'f1_val': 0.9973670153333725, 'auprc': 0.9992112580282951, 'loss_val': 0.053135602007012374, 'psi': 0.9981047124113416}
[S4] START round=17 head_norm_before_train=1.789356 (no previous merge yet)
[S4] round=17 local utility u=0.922162 metrics={'f1_val': 0.9710251945986424, 'auprc': 0.9614598064604993, 'loss_val': 0.25058212854945955, 'psi': 0.9671990393433851}-{'f1_val': 0.682311552967467, 'auprc': 0.9677054968674673, 'loss_val': 0.3813610381524094, 'psi': 0.7964691305274672}
[S5] START round=17 head_norm_before_train=1.405522 cos_to_last_merge=0.8135 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.814
[S5] round=17 local utility u=0.030563 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.9913709075748165, 'loss_val': 0.205178597638649, 'psi': 0.8170625331194459}-{'f1_val': 0.7006090940057808, 'auprc': 0.9858174537353905, 'loss_val': 0.24815695702122942, 'psi': 0.8146924378976247}
[S6] START round=17 head_norm_before_train=1.611224 (no previous merge yet)
[S6] round=17 local utility u=0.274916 metrics={'f1_val': 0.7095936103268953, 'auprc': 0.9655976990349208, 'loss_val': 0.3221842341965278, 'psi': 0.8119952458101054}-{'f1_val': 0.6506723132916823, 'auprc': 0.9326333049449942, 'loss_val': 0.419596243562802, 'psi': 0.763456709953007}
[S7] START round=17 head_norm_before_train=0.918338 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.073301 metrics={'f1_val': 0.553423535074671, 'auprc': 0.7876806672213591, 'loss_val': 0.7889283099551002, 'psi': 0.6471263879333462}-{'f1_val': 0.5376743827867067, 'auprc': 0.77592498513619, 'loss_val': 0.8057676325770271, 'psi': 0.6329746237264999}
[S8] START round=17 head_norm_before_train=1.378951 cos_to_last_merge=0.8325 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.833
[S8] round=17 local utility u=0.009567 metrics={'f1_val': 0.9966821822742694, 'auprc': 0.9983849242348932, 'loss_val': 0.0985421464744659, 'psi': 0.997363279058519}-{'f1_val': 0.9967901605898053, 'auprc': 0.9984110011839332, 'loss_val': 0.11840141940829718, 'psi': 0.9974384968274566}
[S9] START round=17 head_norm_before_train=1.422912 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.002058 metrics={'f1_val': 0.9967149094376494, 'auprc': 0.9984210756770422, 'loss_val': 0.11101417827519497, 'psi': 0.9973973759334065}-{'f1_val': 0.9967149094376494, 'auprc': 0.998672110977213, 'loss_val': 0.11588362497081141, 'psi': 0.9974977900534747}
[S10] START round=17 head_norm_before_train=1.135046 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.014448 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9964879459067153, 'loss_val': 0.2776759399916334, 'psi': 0.9960425148097325}-{'f1_val': 0.9951941773951698, 'auprc': 0.9941437559993602, 'loss_val': 0.29623084354150603, 'psi': 0.994774008836846}
[S11] START round=17 head_norm_before_train=1.523045 cos_to_last_merge=0.8834 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.883
[S11] round=17 local utility u=0.008764 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982497031780381, 'loss_val': 0.0948969864032659, 'psi': 0.997228083979369}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980252069239838, 'loss_val': 0.11175063343026867, 'psi': 0.9971382854777473}
[S13] START round=17 head_norm_before_train=1.622053 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6129296763203718, 'auprc': 0.6534259274536638, 'loss_val': 0.6503790116994589, 'psi': 0.6291281767736886}-{'f1_val': 0.607407657101626, 'auprc': 0.6757310012004248, 'loss_val': 0.6369108682166932, 'psi': 0.6347369947411455}
[S14] START round=17 head_norm_before_train=1.723261 (no previous merge yet)
[S14] round=17 local utility u=0.013671 metrics={'f1_val': 0.9983050875260411, 'auprc': 0.9971530413991685, 'loss_val': 0.08939952223768996, 'psi': 0.9978442690752921}-{'f1_val': 0.9965760575063591, 'auprc': 0.9968881948259171, 'loss_val': 0.10557337246766206, 'psi': 0.9967009124341824}
[S15] START round=17 head_norm_before_train=1.416110 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.100280 metrics={'f1_val': 0.7134400801566743, 'auprc': 0.8005016035770174, 'loss_val': 0.47934528743652155, 'psi': 0.7482646895248115}-{'f1_val': 0.6978866398925341, 'auprc': 0.7856723013634447, 'loss_val': 0.5420967545894017, 'psi': 0.7330009044808983}
[S16] START round=17 head_norm_before_train=1.399560 cos_to_last_merge=0.8640 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.864
[S16] round=17 local utility u=0.008504 metrics={'f1_val': 0.8259100582448003, 'auprc': 0.8533080061478908, 'loss_val': 0.7772682875752915, 'psi': 0.8368692374060366}-{'f1_val': 0.827867279069247, 'auprc': 0.8272184413567876, 'loss_val': 0.7277505334948309, 'psi': 0.8276077439842632}
[S17] START round=17 head_norm_before_train=1.360750 cos_to_last_merge=0.8395 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.840
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.37073514077163716, 'auprc': 0.6949639988132019, 'loss_val': 1.0032930097225643, 'psi': 0.5004266839882631}-{'f1_val': 0.5814538302525607, 'auprc': 0.7692571125915332, 'loss_val': 0.9089202621650819, 'psi': 0.6565751431881497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:57003
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:57011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:57002
[S14] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.9878
[S3] RECEIVED delta(kind=head bytes=1803) from S8
[S3] cosine check vs S8: cos=-0.0665
[S3] DROPPED delta from S8 (cos=-0.0665 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] cosine check vs S9: cos=0.0005
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=0.6034
[S7] RECEIVED delta(kind=head bytes=1804) from S10
[S7] cosine check vs S10: cos=0.7986
[S10] RECEIVED delta(kind=head bytes=1802) from S2
[S10] cosine check vs S2: cos=-0.1030
[S10] DROPPED delta from S2 (cos=-0.1030 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1804) from S15
[S10] cosine check vs S15: cos=0.8355
[S7] RECEIVED delta(kind=head bytes=1797) from S11
[S7] cosine check vs S11: cos=0.5857
[S6] RECEIVED delta(kind=head bytes=1803) from S14
[S6] cosine check vs S14: cos=-0.0115
[S6] DROPPED delta from S14 (cos=-0.0115 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=-0.0636
[S2] DROPPED delta from S4 (cos=-0.0636 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] cosine check vs S16: cos=-0.0255
[S6] DROPPED delta from S16 (cos=-0.0255 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] cosine check vs S6: cos=-0.0782
[S8] DROPPED delta from S6 (cos=-0.0782 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.9945 head_norm=1.849144
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.181235e+00
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.9877 head_norm=1.181834 delta_norm=1.181235
[S3] aggregate: ROLLBACK (f1_val pre=0.994 post=0.988 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9967 head_norm=1.471311
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.162011e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9963 head_norm=1.439452 delta_norm=0.116201
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9957 head_norm=1.174000
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.952942e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9952 head_norm=1.251606 delta_norm=0.395294
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.7134 head_norm=1.437803
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.756744e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.7140 head_norm=1.084110 delta_norm=0.575674
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.5534 head_norm=0.972683
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.833416e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.5552 head_norm=0.966733 delta_norm=0.183342
[S7] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.758118 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7005365566033099, 'auprc': 0.8018219958600418, 'loss_val': 0.28722073654909414, 'psi': 0.7410507323060027}-{'f1_val': 0.7001902662436843, 'auprc': 0.9303407512622025, 'loss_val': 0.2680134963309536, 'psi': 0.7922504602510916}
[S3] START round=18 head_norm_before_train=1.181834 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9991688968416484, 'loss_val': 0.17589398645667975, 'psi': 0.9763126099763316}-{'f1_val': 0.9944816393083035, 'auprc': 0.999227239480817, 'loss_val': 0.051395274824319145, 'psi': 0.9963798793773089}
[S4] START round=18 head_norm_before_train=1.812305 (no previous merge yet)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.8598847665219174, 'auprc': 0.966856734416994, 'loss_val': 0.29918044016232637, 'psi': 0.902673553679948}-{'f1_val': 0.9710251945986424, 'auprc': 0.9614598064604993, 'loss_val': 0.25058212854945955, 'psi': 0.9671990393433851}
[S5] START round=18 head_norm_before_train=1.416436 cos_to_last_merge=0.8111 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.811
[S5] round=18 local utility u=0.009257 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.9917007039253933, 'loss_val': 0.1876539232975769, 'psi': 0.8171944516596765}-{'f1_val': 0.7008569501491988, 'auprc': 0.9913709075748165, 'loss_val': 0.205178597638649, 'psi': 0.8170625331194459}
[S6] START round=18 head_norm_before_train=1.631043 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.5825519834491806, 'auprc': 0.7944406283945588, 'loss_val': 0.6233341079498358, 'psi': 0.6673074414273319}-{'f1_val': 0.7095936103268953, 'auprc': 0.9655976990349208, 'loss_val': 0.3221842341965278, 'psi': 0.8119952458101054}
[S7] START round=18 head_norm_before_train=0.966733 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.115967 metrics={'f1_val': 0.5771120083840926, 'auprc': 0.7962209808197228, 'loss_val': 0.7247461607654142, 'psi': 0.6647555973583448}-{'f1_val': 0.553423535074671, 'auprc': 0.7876806672213591, 'loss_val': 0.7889283099551002, 'psi': 0.6471263879333462}
[S8] START round=18 head_norm_before_train=1.413493 cos_to_last_merge=0.8246 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.825
[S8] round=18 local utility u=0.007265 metrics={'f1_val': 0.9967904835007894, 'auprc': 0.9984133506845947, 'loss_val': 0.08474710506544898, 'psi': 0.9974396303743116}-{'f1_val': 0.9966821822742694, 'auprc': 0.9983849242348932, 'loss_val': 0.0985421464744659, 'psi': 0.997363279058519}
[S9] START round=18 head_norm_before_train=1.439452 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.010226 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9987590141906549, 'loss_val': 0.09655658814206795, 'psi': 0.9980305396826482}-{'f1_val': 0.9967149094376494, 'auprc': 0.9984210756770422, 'loss_val': 0.11101417827519497, 'psi': 0.9973973759334065}
[S10] START round=18 head_norm_before_train=1.251606 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9920904578277144, 'loss_val': 0.2965771198412444, 'psi': 0.9936996051406891}-{'f1_val': 0.9957455607450773, 'auprc': 0.9964879459067153, 'loss_val': 0.2776759399916334, 'psi': 0.9960425148097325}
[S11] START round=18 head_norm_before_train=1.562137 cos_to_last_merge=0.8787 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.879
[S11] round=18 local utility u=0.008600 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9983024899564722, 'loss_val': 0.07640367799686035, 'psi': 0.9971040964639055}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982497031780381, 'loss_val': 0.0948969864032659, 'psi': 0.997228083979369}
[S13] START round=18 head_norm_before_train=1.639124 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.6029016951034337, 'auprc': 0.6801837400055555, 'loss_val': 0.7037387048780799, 'psi': 0.6338145130642825}-{'f1_val': 0.6129296763203718, 'auprc': 0.6534259274536638, 'loss_val': 0.6503790116994589, 'psi': 0.6291281767736886}
[S14] START round=18 head_norm_before_train=1.755308 (no previous merge yet)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9418524567338815, 'auprc': 0.9956542364832535, 'loss_val': 0.12269345399879836, 'psi': 0.9633731686336303}-{'f1_val': 0.9983050875260411, 'auprc': 0.9971530413991685, 'loss_val': 0.08939952223768996, 'psi': 0.9978442690752921}
[S15] START round=18 head_norm_before_train=1.084110 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.401192 metrics={'f1_val': 0.7723298252827594, 'auprc': 0.9349739535061394, 'loss_val': 0.4337164519391509, 'psi': 0.8373874765721114}-{'f1_val': 0.7134400801566743, 'auprc': 0.8005016035770174, 'loss_val': 0.47934528743652155, 'psi': 0.7482646895248115}
[S16] START round=18 head_norm_before_train=1.435061 cos_to_last_merge=0.8593 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.859
[S16] round=18 local utility u=0.250709 metrics={'f1_val': 0.8196336027425714, 'auprc': 0.9153909510904052, 'loss_val': 0.4244401153445802, 'psi': 0.8579365420817049}-{'f1_val': 0.8259100582448003, 'auprc': 0.8533080061478908, 'loss_val': 0.7772682875752915, 'psi': 0.8368692374060366}
[S17] START round=18 head_norm_before_train=1.375485 cos_to_last_merge=0.8374 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.837
[S17] round=18 local utility u=0.113129 metrics={'f1_val': 0.3736609215231632, 'auprc': 0.7446571546688373, 'loss_val': 0.9436684876344796, 'psi': 0.5220594147814328}-{'f1_val': 0.37073514077163716, 'auprc': 0.6949639988132019, 'loss_val': 1.0032930097225643, 'psi': 0.5004266839882631}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:57010
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:57008
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:57003
[S11] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S11
[S7] cosine check vs S11: cos=0.6683
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=-0.0842
[S3] DROPPED delta from S8 (cos=-0.0842 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1804) from S9
[S3] cosine check vs S9: cos=0.5743
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.9893
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:57011
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S15
[S10] cosine check vs S15: cos=0.9610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:57009
[S7] sending update (kind=head size=1803 to 1 peers)
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] cosine check vs S7: cos=0.8351
[S6] RECEIVED delta(kind=head bytes=1804) from S16
[S6] cosine check vs S16: cos=-0.0247
[S6] DROPPED delta from S16 (cos=-0.0247 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=-0.0342
[S8] DROPPED delta from S17 (cos=-0.0342 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.9611 head_norm=1.276518
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.453287e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.9606 head_norm=1.228494 delta_norm=0.645329
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9975 head_norm=1.490569
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.111333e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9975 head_norm=1.454841 delta_norm=0.111133
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.9948 head_norm=1.288329
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.892211e-01
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.9948 head_norm=1.187858 delta_norm=0.189221
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.7723 head_norm=1.110778
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.091106e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.7017 head_norm=1.021082 delta_norm=0.309111
[S15] aggregate: ROLLBACK (f1_val pre=0.772 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.5771 head_norm=1.021023
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.959771e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.6775 head_norm=1.203195 delta_norm=0.595977
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.768539 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7053578949029095, 'auprc': 0.7938109799129598, 'loss_val': 0.3528819489562215, 'psi': 0.7407391289069296}-{'f1_val': 0.7005365566033099, 'auprc': 0.8018219958600418, 'loss_val': 0.28722073654909414, 'psi': 0.7410507323060027}
[S3] START round=19 head_norm_before_train=1.228494 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9981071630001559, 'loss_val': 0.23926369336592115, 'psi': 0.9758879164397346}-{'f1_val': 0.9610750853994537, 'auprc': 0.9991688968416484, 'loss_val': 0.17589398645667975, 'psi': 0.9763126099763316}
[S4] START round=19 head_norm_before_train=1.837187 (no previous merge yet)
[S4] round=19 local utility u=0.311204 metrics={'f1_val': 0.9537028828072927, 'auprc': 0.9640977020837612, 'loss_val': 0.23140449844511385, 'psi': 0.9578608105178801}-{'f1_val': 0.8598847665219174, 'auprc': 0.966856734416994, 'loss_val': 0.29918044016232637, 'psi': 0.902673553679948}
[S5] START round=19 head_norm_before_train=1.426896 cos_to_last_merge=0.8097 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.810
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7007406076076139, 'auprc': 0.9875859859487695, 'loss_val': 0.20190564741199737, 'psi': 0.8154787589440762}-{'f1_val': 0.7008569501491988, 'auprc': 0.9917007039253933, 'loss_val': 0.1876539232975769, 'psi': 0.8171944516596765}
[S6] START round=19 head_norm_before_train=1.652336 (no previous merge yet)
[S6] round=19 local utility u=1.000000 metrics={'f1_val': 0.9613228944302573, 'auprc': 0.9678416966422889, 'loss_val': 0.2551423582463289, 'psi': 0.96393041531507}-{'f1_val': 0.5825519834491806, 'auprc': 0.7944406283945588, 'loss_val': 0.6233341079498358, 'psi': 0.6673074414273319}
[S7] START round=19 head_norm_before_train=1.203195 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.436471 metrics={'f1_val': 0.670866405603155, 'auprc': 0.8800757011922018, 'loss_val': 0.6658939114341275, 'psi': 0.7545501238387737}-{'f1_val': 0.5771120083840926, 'auprc': 0.7962209808197228, 'loss_val': 0.7247461607654142, 'psi': 0.6647555973583448}
[S8] START round=19 head_norm_before_train=1.445768 cos_to_last_merge=0.8186 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.819
[S8] round=19 local utility u=0.005146 metrics={'f1_val': 0.9966821822742694, 'auprc': 0.9982546325176677, 'loss_val': 0.07332888366569905, 'psi': 0.9973111623716288}-{'f1_val': 0.9967904835007894, 'auprc': 0.9984133506845947, 'loss_val': 0.08474710506544898, 'psi': 0.9974396303743116}
[S9] START round=19 head_norm_before_train=1.454841 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000202 metrics={'f1_val': 0.9960499618648996, 'auprc': 0.9991390131411058, 'loss_val': 0.08832342046049795, 'psi': 0.9972855823753821}-{'f1_val': 0.9975448900106438, 'auprc': 0.9987590141906549, 'loss_val': 0.09655658814206795, 'psi': 0.9980305396826482}
[S10] START round=19 head_norm_before_train=1.187858 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.991500162660446, 'loss_val': 0.29783565133488177, 'psi': 0.9932139040912312}-{'f1_val': 0.9947723700160056, 'auprc': 0.9920904578277144, 'loss_val': 0.2965771198412444, 'psi': 0.9936996051406891}
[S11] START round=19 head_norm_before_train=1.601014 cos_to_last_merge=0.8739 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.874
[S11] round=19 local utility u=0.007752 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9986361867092737, 'loss_val': 0.06335270371585879, 'psi': 0.9973826773918633}-{'f1_val': 0.996305167468861, 'auprc': 0.9983024899564722, 'loss_val': 0.07640367799686035, 'psi': 0.9971040964639055}
[S13] START round=19 head_norm_before_train=1.651752 (no previous merge yet)
[S13] round=19 local utility u=0.169697 metrics={'f1_val': 0.6352209808318278, 'auprc': 0.6711236767513297, 'loss_val': 0.5310810570654909, 'psi': 0.6495820591996285}-{'f1_val': 0.6029016951034337, 'auprc': 0.6801837400055555, 'loss_val': 0.7037387048780799, 'psi': 0.6338145130642825}
[S14] START round=19 head_norm_before_train=1.783247 (no previous merge yet)
[S14] round=19 local utility u=0.002853 metrics={'f1_val': 0.9418524567338815, 'auprc': 0.9957169192610138, 'loss_val': 0.11717628373785362, 'psi': 0.9633982417447344}-{'f1_val': 0.9418524567338815, 'auprc': 0.9956542364832535, 'loss_val': 0.12269345399879836, 'psi': 0.9633731686336303}
[S15] START round=19 head_norm_before_train=1.021082 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6953862226956249, 'auprc': 0.9113955559081794, 'loss_val': 0.4820593527716391, 'psi': 0.7817899559806467}-{'f1_val': 0.7723298252827594, 'auprc': 0.9349739535061394, 'loss_val': 0.4337164519391509, 'psi': 0.8373874765721114}
[S16] START round=19 head_norm_before_train=1.462062 cos_to_last_merge=0.8571 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.857
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8446624395176539, 'auprc': 0.9045895232352568, 'loss_val': 0.6597417232956178, 'psi': 0.8686332730046951}-{'f1_val': 0.8196336027425714, 'auprc': 0.9153909510904052, 'loss_val': 0.4244401153445802, 'psi': 0.8579365420817049}
[S17] START round=19 head_norm_before_train=1.394754 cos_to_last_merge=0.8348 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.835
[S17] round=19 local utility u=0.091841 metrics={'f1_val': 0.3765712733314141, 'auprc': 0.7953574569215429, 'loss_val': 0.9295494865570264, 'psi': 0.5440857467674656}-{'f1_val': 0.3736609215231632, 'auprc': 0.7446571546688373, 'loss_val': 0.9436684876344796, 'psi': 0.5220594147814328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:57002
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S4
[S2] cosine check vs S4: cos=-0.0613
[S2] DROPPED delta from S4 (cos=-0.0613 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:57007
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S13] → sending delta(kind=head bytes=1810) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:57009
[S13] sending update (kind=head size=1810 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=-0.0821
[S8] DROPPED delta from S6 (cos=-0.0821 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] cosine check vs S9: cos=0.8374
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=-0.0796
[S3] DROPPED delta from S8 (cos=-0.0796 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1810) from S13
[S15] cosine check vs S13: cos=0.4946
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] cosine check vs S7: cos=0.7648
[S7] RECEIVED delta(kind=head bytes=1791) from S11
[S7] cosine check vs S11: cos=0.9188
[S6] RECEIVED delta(kind=head bytes=1804) from S14
[S6] cosine check vs S14: cos=-0.0121
[S6] DROPPED delta from S14 (cos=-0.0121 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=-0.0310
[S8] DROPPED delta from S17 (cos=-0.0310 < 0.0)
[S4] r=20 psi=0.958 u=0.3112 p_local=0.3133 f1=0.954 auprc=0.964 bytes=25189
[S5] r=20 psi=0.815 u=0.0000 p_local=0.0958 f1=0.701 auprc=0.988 bytes=23382
[S10] r=20 psi=0.993 u=0.0000 p_local=0.1322 f1=0.994 auprc=0.992 bytes=28783
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.9611 head_norm=1.329452
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.131895e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.9607 head_norm=1.359537 delta_norm=0.413190
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] r=20 psi=0.976 u=0.0000 p_local=0.1753 f1=0.961 auprc=0.998 bytes=23375
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.6954 head_norm=1.049013
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.954383e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.6954 head_norm=1.042249 delta_norm=0.395438
[S15] aggregate: ACCEPT kept=['S13', 'S7'] (k=2/2) mode=median trim_p=0.1
[S15] r=20 psi=0.782 u=0.0000 p_local=0.1511 f1=0.695 auprc=0.911 bytes=21595
[S2] r=20 psi=0.741 u=0.0000 p_local=0.0723 f1=0.705 auprc=0.794 bytes=21600
[S16] r=20 psi=0.869 u=0.0000 p_local=0.2217 f1=0.845 auprc=0.905 bytes=25157
[S14] r=20 psi=0.963 u=0.0029 p_local=0.1027 f1=0.942 auprc=0.996 bytes=28790
[S13] r=20 psi=0.650 u=0.1697 p_local=0.0924 f1=0.635 auprc=0.671 bytes=21630
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.6709 head_norm=1.243291
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.472811e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.6884 head_norm=1.409626 delta_norm=0.347281
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.755 u=0.4365 p_local=0.2106 f1=0.671 auprc=0.880 bytes=26970
[S11] r=20 psi=0.997 u=0.0078 p_local=0.1143 f1=0.997 auprc=0.999 bytes=30558
[S9] r=20 psi=0.997 u=0.0002 p_local=0.0930 f1=0.996 auprc=0.999 bytes=25210
[S6] r=20 psi=0.964 u=1.0000 p_local=0.3681 f1=0.961 auprc=0.968 bytes=23371
[S8] r=20 psi=0.997 u=0.0051 p_local=0.1409 f1=0.997 auprc=0.998 bytes=30534
[S17] r=20 psi=0.544 u=0.0918 p_local=0.1464 f1=0.377 auprc=0.795 bytes=19787
[S2] START round=20 head_norm_before_train=1.777176 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7077495821900016, 'auprc': 0.7950294178671371, 'loss_val': 0.4040771240153953, 'psi': 0.7426615164608559}-{'f1_val': 0.7053578949029095, 'auprc': 0.7938109799129598, 'loss_val': 0.3528819489562215, 'psi': 0.7407391289069296}
[S3] START round=20 head_norm_before_train=1.359537 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.131342 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9971679048673985, 'loss_val': 0.1941707031928588, 'psi': 0.9975531825075352}-{'f1_val': 0.9610750853994537, 'auprc': 0.9981071630001559, 'loss_val': 0.23926369336592115, 'psi': 0.9758879164397346}
[S4] START round=20 head_norm_before_train=1.860731 (no previous merge yet)
[S4] round=20 local utility u=0.056848 metrics={'f1_val': 0.968262074459892, 'auprc': 0.9589510719526786, 'loss_val': 0.18962301819160016, 'psi': 0.9645376734570066}-{'f1_val': 0.9537028828072927, 'auprc': 0.9640977020837612, 'loss_val': 0.23140449844511385, 'psi': 0.9578608105178801}
[S5] START round=20 head_norm_before_train=1.439933 cos_to_last_merge=0.8071 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.807
[S5] round=20 local utility u=0.925415 metrics={'f1_val': 0.9963182384411008, 'auprc': 0.9923302909889432, 'loss_val': 0.1387749948252899, 'psi': 0.9947230594602376}-{'f1_val': 0.7007406076076139, 'auprc': 0.9875859859487695, 'loss_val': 0.20190564741199737, 'psi': 0.8154787589440762}
[S6] START round=20 head_norm_before_train=1.670662 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.4868393018888084, 'auprc': 0.7886996590491481, 'loss_val': 0.6635162325225015, 'psi': 0.6075834447529442}-{'f1_val': 0.9613228944302573, 'auprc': 0.9678416966422889, 'loss_val': 0.2551423582463289, 'psi': 0.96393041531507}
[S7] START round=20 head_norm_before_train=1.409626 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.5815895777305737, 'auprc': 0.80328566655168, 'loss_val': 0.7574862272506931, 'psi': 0.6702680132590162}-{'f1_val': 0.670866405603155, 'auprc': 0.8800757011922018, 'loss_val': 0.6658939114341275, 'psi': 0.7545501238387737}
[S8] START round=20 head_norm_before_train=1.472768 cos_to_last_merge=0.8141 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.814
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.995160954146866, 'auprc': 0.9983638822498575, 'loss_val': 0.06477566976837124, 'psi': 0.9964421253880625}-{'f1_val': 0.9966821822742694, 'auprc': 0.9982546325176677, 'loss_val': 0.07332888366569905, 'psi': 0.9973111623716288}
[S9] START round=20 head_norm_before_train=1.506881 cos_to_last_merge=0.9980 (last merge round=18)
[S9] round=20 local utility u=0.017127 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9992934289064006, 'loss_val': 0.06103982524117437, 'psi': 0.9979980507211952}-{'f1_val': 0.9960499618648996, 'auprc': 0.9991390131411058, 'loss_val': 0.08832342046049795, 'psi': 0.9972855823753821}
[S10] START round=20 head_norm_before_train=1.221001 cos_to_last_merge=0.9983 (last merge round=18)
[S10] round=20 local utility u=0.048448 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9959970295537359, 'loss_val': 0.22059093870992696, 'psi': 0.9956286221465137}-{'f1_val': 0.9943563983784213, 'auprc': 0.991500162660446, 'loss_val': 0.29783565133488177, 'psi': 0.9932139040912312}
[S11] START round=20 head_norm_before_train=1.633868 cos_to_last_merge=0.8700 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.870
[S11] round=20 local utility u=0.006131 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998597832639164, 'loss_val': 0.05097643037016952, 'psi': 0.9973673357638193}-{'f1_val': 0.9965470045135896, 'auprc': 0.9986361867092737, 'loss_val': 0.06335270371585879, 'psi': 0.9973826773918633}
[S13] START round=20 head_norm_before_train=1.662157 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5901555627414503, 'auprc': 0.6864607347214527, 'loss_val': 0.7788752576410232, 'psi': 0.6286776315334512}-{'f1_val': 0.6352209808318278, 'auprc': 0.6711236767513297, 'loss_val': 0.5310810570654909, 'psi': 0.6495820591996285}
[S14] START round=20 head_norm_before_train=1.810282 (no previous merge yet)
[S14] round=20 local utility u=0.066077 metrics={'f1_val': 0.9573223154717229, 'auprc': 0.9974704433991881, 'loss_val': 0.0831024757112969, 'psi': 0.973381566642709}-{'f1_val': 0.9418524567338815, 'auprc': 0.9957169192610138, 'loss_val': 0.11717628373785362, 'psi': 0.9633982417447344}
[S15] START round=20 head_norm_before_train=1.042249 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.755352 metrics={'f1_val': 0.8987492888578916, 'auprc': 0.989460264617486, 'loss_val': 0.4257269812681834, 'psi': 0.9350336791617294}-{'f1_val': 0.6953862226956249, 'auprc': 0.9113955559081794, 'loss_val': 0.4820593527716391, 'psi': 0.7817899559806467}
[S16] START round=20 head_norm_before_train=1.494961 cos_to_last_merge=0.8540 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.854
[S16] round=20 local utility u=0.198045 metrics={'f1_val': 0.8725247145811585, 'auprc': 0.9318319775734711, 'loss_val': 0.5125521892596567, 'psi': 0.8962476197780836}-{'f1_val': 0.8446624395176539, 'auprc': 0.9045895232352568, 'loss_val': 0.6597417232956178, 'psi': 0.8686332730046951}
[S17] START round=20 head_norm_before_train=1.418896 cos_to_last_merge=0.8325 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.833
[S17] round=20 local utility u=0.589337 metrics={'f1_val': 0.5865426202641727, 'auprc': 0.7926139233570265, 'loss_val': 1.0024723488935152, 'psi': 0.6689711415013142}-{'f1_val': 0.3765712733314141, 'auprc': 0.7953574569215429, 'loss_val': 0.9295494865570264, 'psi': 0.5440857467674656}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:57010
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:57011
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:57007
[S16] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.9839
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=0.3340
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] cosine check vs S9: cos=0.9115
[S7] RECEIVED delta(kind=head bytes=1797) from S11
[S7] cosine check vs S11: cos=0.9662
[S15] RECEIVED delta(kind=head bytes=1798) from S3
[S15] cosine check vs S3: cos=0.2738
[S2] RECEIVED delta(kind=head bytes=1796) from S4
[S2] cosine check vs S4: cos=-0.0604
[S2] DROPPED delta from S4 (cos=-0.0604 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1804) from S14
[S6] cosine check vs S14: cos=-0.0130
[S6] DROPPED delta from S14 (cos=-0.0130 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1804) from S16
[S6] cosine check vs S16: cos=-0.0226
[S6] DROPPED delta from S16 (cos=-0.0226 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S15
[S10] cosine check vs S15: cos=0.7874
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=-0.0279
[S8] DROPPED delta from S17 (cos=-0.0279 < 0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.5816 head_norm=1.445614
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.171630e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.5741 head_norm=1.250264 delta_norm=0.317163
[S7] aggregate: ROLLBACK (f1_val pre=0.582 post=0.574 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.168 → S15@127.0.0.1:57015
[S8] ⇄ pheromone p=0.113 → S3@127.0.0.1:57003
[S2] ⇄ pheromone p=0.058 → S10@127.0.0.1:57011
[S6] ⇄ pheromone p=0.294 → S8@127.0.0.1:57009
[S13] ⇄ pheromone p=0.074 → S15@127.0.0.1:57015
[S4] ⇄ pheromone p=0.262 → S2@127.0.0.1:57002
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9971 head_norm=1.552934
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.435582e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9971 head_norm=1.498140 delta_norm=0.143558
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.078 → S3@127.0.0.1:57003
[S14] ⇄ pheromone p=0.095 → S6@127.0.0.1:57007
[S11] ⇄ pheromone p=0.093 → S7@127.0.0.1:57008
[S16] ⇄ pheromone p=0.217 → S6@127.0.0.1:57007
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9954 head_norm=1.246914
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.873014e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9954 head_norm=1.098905 delta_norm=0.387301
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.115 → S7@127.0.0.1:57008
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.9978 head_norm=1.449341
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.197694e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.9978 head_norm=1.467598 delta_norm=0.319769
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.166 → S15@127.0.0.1:57015
[S5] ⇄ pheromone p=0.262 → S9@127.0.0.1:57010
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.8987 head_norm=1.077216
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.755883e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.8010 head_norm=1.014374 delta_norm=0.775588
[S15] aggregate: ROLLBACK (f1_val pre=0.899 post=0.801 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.272 → S10@127.0.0.1:57011
[S17] ⇄ pheromone p=0.235 → S8@127.0.0.1:57009
[S2] START round=21 head_norm_before_train=1.787192 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7143930075596566, 'auprc': 0.7934689609807751, 'loss_val': 0.5836303005597415, 'psi': 0.746023388928104}-{'f1_val': 0.7077495821900016, 'auprc': 0.7950294178671371, 'loss_val': 0.4040771240153953, 'psi': 0.7426615164608559}
[S3] START round=21 head_norm_before_train=1.467598 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9975743617589796, 'loss_val': 0.20390779774887122, 'psi': 0.9756747959432641}-{'f1_val': 0.9978100342676263, 'auprc': 0.9971679048673985, 'loss_val': 0.1941707031928588, 'psi': 0.9975531825075352}
[S4] START round=21 head_norm_before_train=1.879205 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9455767654748228, 'auprc': 0.975692126405073, 'loss_val': 0.17882307561677302, 'psi': 0.9576229098469229}-{'f1_val': 0.968262074459892, 'auprc': 0.9589510719526786, 'loss_val': 0.18962301819160016, 'psi': 0.9645376734570066}
[S5] START round=21 head_norm_before_train=1.455494 cos_to_last_merge=0.8047 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.805
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.7006953490578625, 'auprc': 0.9002997130132484, 'loss_val': 0.357578759603649, 'psi': 0.7805370946400167}-{'f1_val': 0.9963182384411008, 'auprc': 0.9923302909889432, 'loss_val': 0.1387749948252899, 'psi': 0.9947230594602376}
[S6] START round=21 head_norm_before_train=1.688579 (no previous merge yet)
[S6] round=21 local utility u=1.000000 metrics={'f1_val': 0.9611620321387073, 'auprc': 0.9652087451207897, 'loss_val': 0.24348765080592502, 'psi': 0.9627807173315402}-{'f1_val': 0.4868393018888084, 'auprc': 0.7886996590491481, 'loss_val': 0.6635162325225015, 'psi': 0.6075834447529442}
[S7] START round=21 head_norm_before_train=1.250264 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.302874 metrics={'f1_val': 0.6463751258249402, 'auprc': 0.8259857888017658, 'loss_val': 0.6085512723325003, 'psi': 0.7182193910156704}-{'f1_val': 0.5815895777305737, 'auprc': 0.80328566655168, 'loss_val': 0.7574862272506931, 'psi': 0.6702680132590162}
[S8] START round=21 head_norm_before_train=1.500455 cos_to_last_merge=0.8090 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.809
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9987075235511735, 'loss_val': 0.07601627523640124, 'psi': 0.9959430176345484}-{'f1_val': 0.995160954146866, 'auprc': 0.9983638822498575, 'loss_val': 0.06477566976837124, 'psi': 0.9964421253880625}
[S9] START round=21 head_norm_before_train=1.498140 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9960499618648996, 'auprc': 0.9991335366722432, 'loss_val': 0.07234514562875081, 'psi': 0.997283391787837}-{'f1_val': 0.9971344652643916, 'auprc': 0.9992934289064006, 'loss_val': 0.06103982524117437, 'psi': 0.9979980507211952}
[S10] START round=21 head_norm_before_train=1.098905 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956827965282513, 'loss_val': 0.2847651229938951, 'psi': 0.9952540305303462}-{'f1_val': 0.9953830172083656, 'auprc': 0.9959970295537359, 'loss_val': 0.22059093870992696, 'psi': 0.9956286221465137}
[S11] START round=21 head_norm_before_train=1.663259 cos_to_last_merge=0.8667 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.867
[S11] round=21 local utility u=0.003294 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9985509118569008, 'loss_val': 0.04424687310427285, 'psi': 0.997348567450914}-{'f1_val': 0.9965470045135896, 'auprc': 0.998597832639164, 'loss_val': 0.05097643037016952, 'psi': 0.9973673357638193}
[S13] START round=21 head_norm_before_train=1.671432 (no previous merge yet)
[S13] round=21 local utility u=0.077611 metrics={'f1_val': 0.6086080378677108, 'auprc': 0.6825244380837858, 'loss_val': 0.7225591455378599, 'psi': 0.6381745979541408}-{'f1_val': 0.5901555627414503, 'auprc': 0.6864607347214527, 'loss_val': 0.7788752576410232, 'psi': 0.6286776315334512}
[S14] START round=21 head_norm_before_train=1.839391 (no previous merge yet)
[S14] round=21 local utility u=0.108369 metrics={'f1_val': 0.9902896058779449, 'auprc': 0.9959363606802853, 'loss_val': 0.05956684827392397, 'psi': 0.992548307798881}-{'f1_val': 0.9573223154717229, 'auprc': 0.9974704433991881, 'loss_val': 0.0831024757112969, 'psi': 0.973381566642709}
[S15] START round=21 head_norm_before_train=1.014374 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.8878639730917448, 'auprc': 0.9603364046395759, 'loss_val': 0.44125717976048534, 'psi': 0.9168529457108773}-{'f1_val': 0.8987492888578916, 'auprc': 0.989460264617486, 'loss_val': 0.4257269812681834, 'psi': 0.9350336791617294}
[S16] START round=21 head_norm_before_train=1.531971 cos_to_last_merge=0.8500 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.850
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8658770654990949, 'auprc': 0.9365792887381097, 'loss_val': 0.5697131826526448, 'psi': 0.8941579547947008}-{'f1_val': 0.8725247145811585, 'auprc': 0.9318319775734711, 'loss_val': 0.5125521892596567, 'psi': 0.8962476197780836}
[S17] START round=21 head_norm_before_train=1.446751 cos_to_last_merge=0.8304 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.830
[S17] round=21 local utility u=0.214678 metrics={'f1_val': 0.6276748487283651, 'auprc': 0.8055040095441772, 'loss_val': 0.8585798167674773, 'psi': 0.69880651305469}-{'f1_val': 0.5865426202641727, 'auprc': 0.7926139233570265, 'loss_val': 1.0024723488935152, 'psi': 0.6689711415013142}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:57015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] → sending delta(kind=head bytes=1808) to S15@127.0.0.1:57015
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[S14] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1808 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S6
[S8] cosine check vs S6: cos=-0.0853
[S8] DROPPED delta from S6 (cos=-0.0853 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1808) from S13
[S15] cosine check vs S13: cos=0.4647
[S15] RECEIVED delta(kind=head bytes=1795) from S7
[S15] cosine check vs S7: cos=0.5873
[S7] RECEIVED delta(kind=head bytes=1799) from S11
[S7] cosine check vs S11: cos=0.9082
[S6] RECEIVED delta(kind=head bytes=1802) from S14
[S6] cosine check vs S14: cos=-0.0135
[S6] DROPPED delta from S14 (cos=-0.0135 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:57009
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=-0.0265
[S8] DROPPED delta from S17 (cos=-0.0265 < 0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.8879 head_norm=1.054053
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.775783e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.8990 head_norm=1.019299 delta_norm=0.477578
[S15] aggregate: ACCEPT kept=['S13', 'S7'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.6464 head_norm=1.290379
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.745908e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.6684 head_norm=1.456821 delta_norm=0.374591
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.797974 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.6998346996584628, 'auprc': 0.6918807460209538, 'loss_val': 0.2725996417057023, 'psi': 0.6966531182034592}-{'f1_val': 0.7143930075596566, 'auprc': 0.7934689609807751, 'loss_val': 0.5836303005597415, 'psi': 0.746023388928104}
[S3] START round=22 head_norm_before_train=1.562081 cos_to_last_merge=0.9888 (last merge round=20)
[S3] round=22 local utility u=0.046636 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9988051441170066, 'loss_val': 0.11432754897526129, 'psi': 0.976167108886475}-{'f1_val': 0.9610750853994537, 'auprc': 0.9975743617589796, 'loss_val': 0.20390779774887122, 'psi': 0.9756747959432641}
[S4] START round=22 head_norm_before_train=1.893577 (no previous merge yet)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9472367943196739, 'auprc': 0.9670390216132215, 'loss_val': 0.18294513449958888, 'psi': 0.955157685237093}-{'f1_val': 0.9455767654748228, 'auprc': 0.975692126405073, 'loss_val': 0.17882307561677302, 'psi': 0.9576229098469229}
[S5] START round=22 head_norm_before_train=1.464714 cos_to_last_merge=0.8053 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.805
[S5] round=22 local utility u=0.022896 metrics={'f1_val': 0.6705870949054142, 'auprc': 0.9524848966059487, 'loss_val': 0.28769273455231587, 'psi': 0.7833462155856281}-{'f1_val': 0.7006953490578625, 'auprc': 0.9002997130132484, 'loss_val': 0.357578759603649, 'psi': 0.7805370946400167}
[S6] START round=22 head_norm_before_train=1.706598 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.8127392346896724, 'auprc': 0.8149453152159176, 'loss_val': 0.4457827304654763, 'psi': 0.8136216669001705}-{'f1_val': 0.9611620321387073, 'auprc': 0.9652087451207897, 'loss_val': 0.24348765080592502, 'psi': 0.9627807173315402}
[S7] START round=22 head_norm_before_train=1.456821 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.6453956540522345, 'auprc': 0.8076705232069321, 'loss_val': 0.6493789284532802, 'psi': 0.7103056017141136}-{'f1_val': 0.6463751258249402, 'auprc': 0.8259857888017658, 'loss_val': 0.6085512723325003, 'psi': 0.7182193910156704}
[S8] START round=22 head_norm_before_train=1.523216 cos_to_last_merge=0.8051 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.805
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9924309654389881, 'auprc': 0.9985964821047921, 'loss_val': 0.07430743249111946, 'psi': 0.9948971721053097}-{'f1_val': 0.9941000136901317, 'auprc': 0.9987075235511735, 'loss_val': 0.07601627523640124, 'psi': 0.9959430176345484}
[S9] START round=22 head_norm_before_train=1.536271 cos_to_last_merge=0.9993 (last merge round=20)
[S9] round=22 local utility u=0.013635 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9992241559887021, 'loss_val': 0.05431696370039414, 'psi': 0.9982165964018671}-{'f1_val': 0.9960499618648996, 'auprc': 0.9991335366722432, 'loss_val': 0.07234514562875081, 'psi': 0.997283391787837}
[S10] START round=22 head_norm_before_train=1.121202 cos_to_last_merge=0.9993 (last merge round=20)
[S10] round=22 local utility u=0.027253 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9958627933696189, 'loss_val': 0.2307988491608744, 'psi': 0.9953260292668933}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956827965282513, 'loss_val': 0.2847651229938951, 'psi': 0.9952540305303462}
[S11] START round=22 head_norm_before_train=1.691216 cos_to_last_merge=0.8637 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.864
[S11] round=22 local utility u=0.002232 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9986216242595263, 'loss_val': 0.03999576144639511, 'psi': 0.9973768524119643}-{'f1_val': 0.9965470045135896, 'auprc': 0.9985509118569008, 'loss_val': 0.04424687310427285, 'psi': 0.997348567450914}
[S13] START round=22 head_norm_before_train=1.680362 (no previous merge yet)
[S13] round=22 local utility u=0.252517 metrics={'f1_val': 0.6608634017487273, 'auprc': 0.66573189993192, 'loss_val': 0.4806806996071307, 'psi': 0.6628108010220043}-{'f1_val': 0.6086080378677108, 'auprc': 0.6825244380837858, 'loss_val': 0.7225591455378599, 'psi': 0.6381745979541408}
[S14] START round=22 head_norm_before_train=1.869689 (no previous merge yet)
[S14] round=22 local utility u=0.032200 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9966869738859606, 'loss_val': 0.04259760809763946, 'psi': 0.9973665003347153}-{'f1_val': 0.9902896058779449, 'auprc': 0.9959363606802853, 'loss_val': 0.05956684827392397, 'psi': 0.992548307798881}
[S15] START round=22 head_norm_before_train=1.019299 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.8299223630711648, 'auprc': 0.9906985405499561, 'loss_val': 0.3515852006556034, 'psi': 0.8942328340626813}-{'f1_val': 0.8878639730917448, 'auprc': 0.9603364046395759, 'loss_val': 0.44125717976048534, 'psi': 0.9168529457108773}
[S16] START round=22 head_norm_before_train=1.563506 cos_to_last_merge=0.8467 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.847
[S16] round=22 local utility u=0.199714 metrics={'f1_val': 0.8996790501042295, 'auprc': 0.959784105336114, 'loss_val': 0.44271061435031733, 'psi': 0.9237210721969833}-{'f1_val': 0.8658770654990949, 'auprc': 0.9365792887381097, 'loss_val': 0.5697131826526448, 'psi': 0.8941579547947008}
[S17] START round=22 head_norm_before_train=1.472887 cos_to_last_merge=0.8296 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.830
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.6133734189318331, 'auprc': 0.8036324314292502, 'loss_val': 0.9768237669838773, 'psi': 0.6894770239307999}-{'f1_val': 0.6276748487283651, 'auprc': 0.8055040095441772, 'loss_val': 0.8585798167674773, 'psi': 0.69880651305469}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:57015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:57010
[S3] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=0.9031
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] cosine check vs S16: cos=-0.0208
[S6] DROPPED delta from S16 (cos=-0.0208 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S14
[S6] cosine check vs S14: cos=-0.0131
[S6] DROPPED delta from S14 (cos=-0.0131 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S3
[S15] cosine check vs S3: cos=0.5271
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.5105
[S7] RECEIVED delta(kind=head bytes=1805) from S11
[S7] cosine check vs S11: cos=0.9732
[S15] RECEIVED delta(kind=head bytes=1805) from S13
[S15] cosine check vs S13: cos=0.7369
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.9865
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.6454 head_norm=1.481753
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.485659e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.6410 head_norm=1.317863 delta_norm=0.248566
[S7] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.8299 head_norm=1.073613
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.168730e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.8833 head_norm=1.112841 delta_norm=0.316873
[S15] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9975 head_norm=1.573598
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.343969e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9975 head_norm=1.519893 delta_norm=0.134397
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.9611 head_norm=1.661732
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.586660e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.9611 head_norm=1.578018 delta_norm=0.358666
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.805660 (no previous merge yet)
[S2] round=23 local utility u=0.321140 metrics={'f1_val': 0.6951523040005374, 'auprc': 0.9171100950033447, 'loss_val': 0.27791417494852116, 'psi': 0.7839354204016604}-{'f1_val': 0.6998346996584628, 'auprc': 0.6918807460209538, 'loss_val': 0.2725996417057023, 'psi': 0.6966531182034592}
[S3] START round=23 head_norm_before_train=1.578018 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.068826 metrics={'f1_val': 0.9842660191206474, 'auprc': 0.9978651471872861, 'loss_val': 0.11300123036929018, 'psi': 0.989705670347303}-{'f1_val': 0.9610750853994537, 'auprc': 0.9988051441170066, 'loss_val': 0.11432754897526129, 'psi': 0.976167108886475}
[S4] START round=23 head_norm_before_train=1.909635 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9440109653582811, 'auprc': 0.9676361676069838, 'loss_val': 0.22885027645211642, 'psi': 0.9534610462577622}-{'f1_val': 0.9472367943196739, 'auprc': 0.9670390216132215, 'loss_val': 0.18294513449958888, 'psi': 0.955157685237093}
[S5] START round=23 head_norm_before_train=1.476503 cos_to_last_merge=0.8037 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.804
[S5] round=23 local utility u=0.440566 metrics={'f1_val': 0.8242651547647615, 'auprc': 0.9582836451388593, 'loss_val': 0.34602449539988783, 'psi': 0.8778725509144005}-{'f1_val': 0.6705870949054142, 'auprc': 0.9524848966059487, 'loss_val': 0.28769273455231587, 'psi': 0.7833462155856281}
[S6] START round=23 head_norm_before_train=1.729935 (no previous merge yet)
[S6] round=23 local utility u=0.316738 metrics={'f1_val': 0.8246720535675519, 'auprc': 0.9592434810051493, 'loss_val': 0.31679717035961347, 'psi': 0.8785006245425908}-{'f1_val': 0.8127392346896724, 'auprc': 0.8149453152159176, 'loss_val': 0.4457827304654763, 'psi': 0.8136216669001705}
[S7] START round=23 head_norm_before_train=1.317863 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.567690 metrics={'f1_val': 0.7001397550937472, 'auprc': 0.9945808060788223, 'loss_val': 0.403193393721701, 'psi': 0.8179161754877773}-{'f1_val': 0.6453956540522345, 'auprc': 0.8076705232069321, 'loss_val': 0.6493789284532802, 'psi': 0.7103056017141136}
[S8] START round=23 head_norm_before_train=1.544957 cos_to_last_merge=0.8025 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.803
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.992328149429227, 'auprc': 0.9863138139106502, 'loss_val': 0.0684799581827096, 'psi': 0.9899224152217962}-{'f1_val': 0.9924309654389881, 'auprc': 0.9985964821047921, 'loss_val': 0.07430743249111946, 'psi': 0.9948971721053097}
[S9] START round=23 head_norm_before_train=1.519893 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9990603013033182, 'loss_val': 0.06484547823229686, 'psi': 0.9981510545277136}-{'f1_val': 0.9975448900106438, 'auprc': 0.9992241559887021, 'loss_val': 0.05431696370039414, 'psi': 0.9982165964018671}
[S10] START round=23 head_norm_before_train=1.158916 cos_to_last_merge=0.9962 (last merge round=20)
[S10] round=23 local utility u=0.024966 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9959267081922484, 'loss_val': 0.18354754552410418, 'psi': 0.9956004936019187}-{'f1_val': 0.9949681865317428, 'auprc': 0.9958627933696189, 'loss_val': 0.2307988491608744, 'psi': 0.9953260292668933}
[S11] START round=23 head_norm_before_train=1.715104 cos_to_last_merge=0.8612 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.861
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9987098820940612, 'loss_val': 0.04351935466469953, 'psi': 0.9971764376840717}-{'f1_val': 0.9965470045135896, 'auprc': 0.9986216242595263, 'loss_val': 0.03999576144639511, 'psi': 0.9973768524119643}
[S13] START round=23 head_norm_before_train=1.688336 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5862546739066385, 'auprc': 0.6882248704762731, 'loss_val': 0.8330610344976778, 'psi': 0.6270427525344924}-{'f1_val': 0.6608634017487273, 'auprc': 0.66573189993192, 'loss_val': 0.4806806996071307, 'psi': 0.6628108010220043}
[S14] START round=23 head_norm_before_train=1.893921 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.986031725211497, 'auprc': 0.9974069123113835, 'loss_val': 0.05374728766099983, 'psi': 0.9905818000514516}-{'f1_val': 0.9978195179672185, 'auprc': 0.9966869738859606, 'loss_val': 0.04259760809763946, 'psi': 0.9973665003347153}
[S15] START round=23 head_norm_before_train=1.112841 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.764880673972884, 'auprc': 0.9913273229761788, 'loss_val': 0.3490527582249577, 'psi': 0.8554593335742018}-{'f1_val': 0.8299223630711648, 'auprc': 0.9906985405499561, 'loss_val': 0.3515852006556034, 'psi': 0.8942328340626813}
[S16] START round=23 head_norm_before_train=1.595796 cos_to_last_merge=0.8435 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.844
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8583638130986396, 'auprc': 0.9103447337992017, 'loss_val': 0.6820297513594671, 'psi': 0.8791561813788644}-{'f1_val': 0.8996790501042295, 'auprc': 0.959784105336114, 'loss_val': 0.44271061435031733, 'psi': 0.9237210721969833}
[S17] START round=23 head_norm_before_train=1.497353 cos_to_last_merge=0.8286 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.829
[S17] round=23 local utility u=0.040703 metrics={'f1_val': 0.6188665173841217, 'auprc': 0.8048104441496058, 'loss_val': 0.9319099968836881, 'psi': 0.6932440880903153}-{'f1_val': 0.6133734189318331, 'auprc': 0.8036324314292502, 'loss_val': 0.9768237669838773, 'psi': 0.6894770239307999}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:57016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:57004
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:57015
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:57011
[S7] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S10
[S15] cosine check vs S10: cos=0.7702
[S4] RECEIVED delta(kind=head bytes=1803) from S2
[S4] cosine check vs S2: cos=-0.0582
[S4] DROPPED delta from S2 (cos=-0.0582 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S6
[S16] cosine check vs S6: cos=-0.0206
[S16] DROPPED delta from S6 (cos=-0.0206 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1792) from S7
[S10] cosine check vs S7: cos=0.6155
[S8] RECEIVED delta(kind=head bytes=1801) from S3
[S8] cosine check vs S3: cos=-0.0726
[S8] DROPPED delta from S3 (cos=-0.0726 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.7649 head_norm=1.161457
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.015662e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.7035 head_norm=1.113190 delta_norm=0.401566
[S15] aggregate: ROLLBACK (f1_val pre=0.765 post=0.703 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9954 head_norm=1.204953
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.618833e-01
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9952 head_norm=1.145115 delta_norm=0.561883
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.812389 (no previous merge yet)
[S2] round=24 local utility u=0.048437 metrics={'f1_val': 0.6986960636059153, 'auprc': 0.9343454582873094, 'loss_val': 0.2540086395925775, 'psi': 0.792955821478473}-{'f1_val': 0.6951523040005374, 'auprc': 0.9171100950033447, 'loss_val': 0.27791417494852116, 'psi': 0.7839354204016604}
[S3] START round=24 head_norm_before_train=1.649122 cos_to_last_merge=0.9966 (last merge round=22)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9981764878875383, 'loss_val': 0.11951289896454968, 'psi': 0.9758917458182814}-{'f1_val': 0.9842660191206474, 'auprc': 0.9978651471872861, 'loss_val': 0.11300123036929018, 'psi': 0.989705670347303}
[S4] START round=24 head_norm_before_train=1.923002 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9495467297492904, 'auprc': 0.9415423454932499, 'loss_val': 0.1986006418232468, 'psi': 0.9463449760468743}-{'f1_val': 0.9440109653582811, 'auprc': 0.9676361676069838, 'loss_val': 0.22885027645211642, 'psi': 0.9534610462577622}
[S5] START round=24 head_norm_before_train=1.487023 cos_to_last_merge=0.8010 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.801
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.6311682200263845, 'auprc': 0.8566871277239909, 'loss_val': 0.5248451849051667, 'psi': 0.721375783105427}-{'f1_val': 0.8242651547647615, 'auprc': 0.9582836451388593, 'loss_val': 0.34602449539988783, 'psi': 0.8778725509144005}
[S6] START round=24 head_norm_before_train=1.750935 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.8029056187071631, 'auprc': 0.818084579825824, 'loss_val': 0.48751466591392206, 'psi': 0.8089772031546275}-{'f1_val': 0.8246720535675519, 'auprc': 0.9592434810051493, 'loss_val': 0.31679717035961347, 'psi': 0.8785006245425908}
[S7] START round=24 head_norm_before_train=1.342420 cos_to_last_merge=0.9990 (last merge round=22)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.6822013013238079, 'auprc': 0.8435172791425625, 'loss_val': 0.493908979857489, 'psi': 0.7467276924513098}-{'f1_val': 0.7001397550937472, 'auprc': 0.9945808060788223, 'loss_val': 0.403193393721701, 'psi': 0.8179161754877773}
[S8] START round=24 head_norm_before_train=1.562477 cos_to_last_merge=0.8006 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.801
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.7338351801531956, 'auprc': 0.9812502152621988, 'loss_val': 0.17027089778649387, 'psi': 0.8328011941967969}-{'f1_val': 0.992328149429227, 'auprc': 0.9863138139106502, 'loss_val': 0.0684799581827096, 'psi': 0.9899224152217962}
[S9] START round=24 head_norm_before_train=1.554538 cos_to_last_merge=0.9995 (last merge round=22)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9948030989548464, 'auprc': 0.9991273854396847, 'loss_val': 0.057447743108891565, 'psi': 0.9965328135487818}-{'f1_val': 0.9975448900106438, 'auprc': 0.9990603013033182, 'loss_val': 0.06484547823229686, 'psi': 0.9981510545277136}
[S10] START round=24 head_norm_before_train=1.145115 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.993002677249188, 'loss_val': 0.280587704974672, 'psi': 0.9943137743113}-{'f1_val': 0.9953830172083656, 'auprc': 0.9959267081922484, 'loss_val': 0.18354754552410418, 'psi': 0.9956004936019187}
[S11] START round=24 head_norm_before_train=1.730954 cos_to_last_merge=0.8592 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.859
[S11] round=24 local utility u=0.003186 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9988667796114233, 'loss_val': 0.037618456543589876, 'psi': 0.9972391966910166}-{'f1_val': 0.9961541414107454, 'auprc': 0.9987098820940612, 'loss_val': 0.04351935466469953, 'psi': 0.9971764376840717}
[S13] START round=24 head_norm_before_train=1.694525 (no previous merge yet)
[S13] round=24 local utility u=0.158391 metrics={'f1_val': 0.6166146650964994, 'auprc': 0.6779234230868637, 'loss_val': 0.667533794385126, 'psi': 0.6411381682926451}-{'f1_val': 0.5862546739066385, 'auprc': 0.6882248704762731, 'loss_val': 0.8330610344976778, 'psi': 0.6270427525344924}
[S14] START round=24 head_norm_before_train=1.915585 (no previous merge yet)
[S14] round=24 local utility u=0.041474 metrics={'f1_val': 0.9969452255660185, 'auprc': 0.9971219106375255, 'loss_val': 0.03542526376011896, 'psi': 0.9970158995946213}-{'f1_val': 0.986031725211497, 'auprc': 0.9974069123113835, 'loss_val': 0.05374728766099983, 'psi': 0.9905818000514516}
[S15] START round=24 head_norm_before_train=1.113190 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.777029 metrics={'f1_val': 0.996178282323997, 'auprc': 0.9948360907830076, 'loss_val': 0.19330584362706965, 'psi': 0.9956414057076013}-{'f1_val': 0.764880673972884, 'auprc': 0.9913273229761788, 'loss_val': 0.3490527582249577, 'psi': 0.8554593335742018}
[S16] START round=24 head_norm_before_train=1.624422 cos_to_last_merge=0.8403 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.840
[S16] round=24 local utility u=0.259604 metrics={'f1_val': 0.8835739203935848, 'auprc': 0.9712733281360403, 'loss_val': 0.4968677690052644, 'psi': 0.918653683490567}-{'f1_val': 0.8583638130986396, 'auprc': 0.9103447337992017, 'loss_val': 0.6820297513594671, 'psi': 0.8791561813788644}
[S17] START round=24 head_norm_before_train=1.525188 cos_to_last_merge=0.8279 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.828
[S17] round=24 local utility u=0.090954 metrics={'f1_val': 0.6405354257924472, 'auprc': 0.8138741785986434, 'loss_val': 0.9072066617803533, 'psi': 0.7098709269149257}-{'f1_val': 0.6188665173841217, 'auprc': 0.8048104441496058, 'loss_val': 0.9319099968836881, 'psi': 0.6932440880903153}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:57008
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] cosine check vs S2: cos=-0.0579
[S4] DROPPED delta from S2 (cos=-0.0579 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] cosine check vs S15: cos=0.6156
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.6822 head_norm=1.362731
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.607275e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.6747 head_norm=1.135414 delta_norm=0.560727
[S7] aggregate: ROLLBACK (f1_val pre=0.682 post=0.675 tol_abs=0.005 tol_rel=0.0)
[S2] START round=25 head_norm_before_train=1.821807 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.700711204130061, 'auprc': 0.7205785560434217, 'loss_val': 0.2915862097562711, 'psi': 0.7086581448954054}-{'f1_val': 0.6986960636059153, 'auprc': 0.9343454582873094, 'loss_val': 0.2540086395925775, 'psi': 0.792955821478473}
[S3] START round=25 head_norm_before_train=1.725040 cos_to_last_merge=0.9892 (last merge round=22)
[S3] round=25 local utility u=0.015372 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9983643808499543, 'loss_val': 0.09235207624294765, 'psi': 0.9762688655129902}-{'f1_val': 0.9610352511054436, 'auprc': 0.9981764878875383, 'loss_val': 0.11951289896454968, 'psi': 0.9758917458182814}
[S4] START round=25 head_norm_before_train=1.935018 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9412884240623042, 'auprc': 0.9558025459077045, 'loss_val': 0.19861847430247917, 'psi': 0.9470940728004643}-{'f1_val': 0.9495467297492904, 'auprc': 0.9415423454932499, 'loss_val': 0.1986006418232468, 'psi': 0.9463449760468743}
[S5] START round=25 head_norm_before_train=1.494713 cos_to_last_merge=0.8012 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.801
[S5] round=25 local utility u=0.283269 metrics={'f1_val': 0.7005667553507534, 'auprc': 0.8638678541647383, 'loss_val': 0.39624060587025567, 'psi': 0.7658871948763474}-{'f1_val': 0.6311682200263845, 'auprc': 0.8566871277239909, 'loss_val': 0.5248451849051667, 'psi': 0.721375783105427}
[S6] START round=25 head_norm_before_train=1.771736 (no previous merge yet)
[S6] round=25 local utility u=0.497790 metrics={'f1_val': 0.859186875629706, 'auprc': 0.964279504535142, 'loss_val': 0.2682074948519732, 'psi': 0.9012239271918804}-{'f1_val': 0.8029056187071631, 'auprc': 0.818084579825824, 'loss_val': 0.48751466591392206, 'psi': 0.8089772031546275}
[S7] START round=25 head_norm_before_train=1.135414 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.6511922372098488, 'auprc': 0.8198178968419172, 'loss_val': 0.5459964717445036, 'psi': 0.7186425010626762}-{'f1_val': 0.6822013013238079, 'auprc': 0.8435172791425625, 'loss_val': 0.493908979857489, 'psi': 0.7467276924513098}
[S8] START round=25 head_norm_before_train=1.581221 cos_to_last_merge=0.7992 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.799
[S8] round=25 local utility u=0.790483 metrics={'f1_val': 0.9757487977292285, 'auprc': 0.9990431846876804, 'loss_val': 0.09416541168088159, 'psi': 0.9850665525126092}-{'f1_val': 0.7338351801531956, 'auprc': 0.9812502152621988, 'loss_val': 0.17027089778649387, 'psi': 0.8328011941967969}
[S9] START round=25 head_norm_before_train=1.587838 cos_to_last_merge=0.9983 (last merge round=22)
[S9] round=25 local utility u=0.005168 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9940426722668358, 'loss_val': 0.045845511948898326, 'psi': 0.9958977480653692}-{'f1_val': 0.9948030989548464, 'auprc': 0.9991273854396847, 'loss_val': 0.057447743108891565, 'psi': 0.9965328135487818}
[S10] START round=25 head_norm_before_train=1.181398 cos_to_last_merge=0.9985 (last merge round=23)
[S10] round=25 local utility u=0.027018 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9913933962348087, 'loss_val': 0.2192311716926023, 'psi': 0.9934207805035268}-{'f1_val': 0.9951878390193748, 'auprc': 0.993002677249188, 'loss_val': 0.280587704974672, 'psi': 0.9943137743113}
[S11] START round=25 head_norm_before_train=1.746412 cos_to_last_merge=0.8575 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.857
[S11] round=25 local utility u=0.003086 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9984688268896229, 'loss_val': 0.03260976997132279, 'psi': 0.9973157334640029}-{'f1_val': 0.9961541414107454, 'auprc': 0.9988667796114233, 'loss_val': 0.037618456543589876, 'psi': 0.9972391966910166}
[S13] START round=25 head_norm_before_train=1.700173 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6106887086672186, 'auprc': 0.6918582718830038, 'loss_val': 0.7021469070263711, 'psi': 0.6431565339535327}-{'f1_val': 0.6166146650964994, 'auprc': 0.6779234230868637, 'loss_val': 0.667533794385126, 'psi': 0.6411381682926451}
[S14] START round=25 head_norm_before_train=1.935427 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9970600146511799, 'loss_val': 0.04069206095142631, 'psi': 0.9973699307384227}-{'f1_val': 0.9969452255660185, 'auprc': 0.9971219106375255, 'loss_val': 0.03542526376011896, 'psi': 0.9970158995946213}
[S15] START round=25 head_norm_before_train=1.161948 cos_to_last_merge=0.9990 (last merge round=23)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.7044227752071006, 'auprc': 0.9881361610263812, 'loss_val': 0.3296160770559574, 'psi': 0.8179081295348128}-{'f1_val': 0.996178282323997, 'auprc': 0.9948360907830076, 'loss_val': 0.19330584362706965, 'psi': 0.9956414057076013}
[S16] START round=25 head_norm_before_train=1.651995 cos_to_last_merge=0.8379 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.838
[S16] round=25 local utility u=0.058014 metrics={'f1_val': 0.896840083323994, 'auprc': 0.9761688369071567, 'loss_val': 0.4751242240542991, 'psi': 0.9285715847572591}-{'f1_val': 0.8835739203935848, 'auprc': 0.9712733281360403, 'loss_val': 0.4968677690052644, 'psi': 0.918653683490567}
[S17] START round=25 head_norm_before_train=1.550036 cos_to_last_merge=0.8273 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.827
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.6288211471332315, 'auprc': 0.8152726180774177, 'loss_val': 0.9354560656867655, 'psi': 0.7034017355109059}-{'f1_val': 0.6405354257924472, 'auprc': 0.8138741785986434, 'loss_val': 0.9072066617803533, 'psi': 0.7098709269149257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] → sending delta(kind=head bytes=1808) to S16@127.0.0.1:57016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:57009
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1808 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S9
[S5] cosine check vs S9: cos=0.9864
[S16] RECEIVED delta(kind=head bytes=1808) from S6
[S16] cosine check vs S6: cos=-0.0216
[S16] DROPPED delta from S6 (cos=-0.0216 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S10
[S15] cosine check vs S10: cos=0.8622
[S8] RECEIVED delta(kind=head bytes=1805) from S3
[S8] cosine check vs S3: cos=-0.0794
[S8] DROPPED delta from S3 (cos=-0.0794 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=-0.0905
[S6] DROPPED delta from S8 (cos=-0.0905 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=0.153 → S10@127.0.0.1:57011
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.7006 head_norm=1.500135
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.411982e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.6863 head_norm=1.553820 delta_norm=0.141198
[S5] aggregate: ROLLBACK (f1_val pre=0.701 post=0.686 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.7044 head_norm=1.203158
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.177254e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.7016 head_norm=1.167617 delta_norm=0.317725
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.213 → S7@127.0.0.1:57008
[S2] ⇄ pheromone p=0.068 → S4@127.0.0.1:57004
[S6] ⇄ pheromone p=0.319 → S16@127.0.0.1:57016
[S3] ⇄ pheromone p=0.071 → S8@127.0.0.1:57009
[S10] ⇄ pheromone p=0.049 → S15@127.0.0.1:57015
[S9] ⇄ pheromone p=0.028 → S5@127.0.0.1:57005
[S8] ⇄ pheromone p=0.195 → S6@127.0.0.1:57007
[S2] START round=26 head_norm_before_train=1.833164 (no previous merge yet)
[S2] round=26 local utility u=0.092832 metrics={'f1_val': 0.7091324986000889, 'auprc': 0.7808091107514279, 'loss_val': 0.33714218690402364, 'psi': 0.7378031434606245}-{'f1_val': 0.700711204130061, 'auprc': 0.7205785560434217, 'loss_val': 0.2915862097562711, 'psi': 0.7086581448954054}
[S3] START round=26 head_norm_before_train=1.783196 cos_to_last_merge=0.9826 (last merge round=22)
[S3] round=26 local utility u=0.048642 metrics={'f1_val': 0.9784018864092348, 'auprc': 0.997710419835372, 'loss_val': 0.0942871420195197, 'psi': 0.9861252997796897}-{'f1_val': 0.9615385219550141, 'auprc': 0.9983643808499543, 'loss_val': 0.09235207624294765, 'psi': 0.9762688655129902}
[S4] START round=26 head_norm_before_train=1.937705 (no previous merge yet)
[S4] round=26 local utility u=0.020878 metrics={'f1_val': 0.9437245975977823, 'auprc': 0.9720366651413589, 'loss_val': 0.2201809034203411, 'psi': 0.9550494246152129}-{'f1_val': 0.9412884240623042, 'auprc': 0.9558025459077045, 'loss_val': 0.19861847430247917, 'psi': 0.9470940728004643}
[S5] START round=26 head_norm_before_train=1.553820 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.4346886061385853, 'auprc': 0.8533504150936726, 'loss_val': 0.9854315786780867, 'psi': 0.6021533297206203}-{'f1_val': 0.7005667553507534, 'auprc': 0.8638678541647383, 'loss_val': 0.39624060587025567, 'psi': 0.7658871948763474}
[S6] START round=26 head_norm_before_train=1.785701 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.7886470389528373, 'auprc': 0.9522933998645493, 'loss_val': 0.4224162806096695, 'psi': 0.8541055833175222}-{'f1_val': 0.859186875629706, 'auprc': 0.964279504535142, 'loss_val': 0.2682074948519732, 'psi': 0.9012239271918804}
[S7] START round=26 head_norm_before_train=1.169111 cos_to_last_merge=0.9992 (last merge round=24)
[S7] round=26 local utility u=0.184673 metrics={'f1_val': 0.6811169322883373, 'auprc': 0.8479556698373731, 'loss_val': 0.44061100581252943, 'psi': 0.7478524273079517}-{'f1_val': 0.6511922372098488, 'auprc': 0.8198178968419172, 'loss_val': 0.5459964717445036, 'psi': 0.7186425010626762}
[S8] START round=26 head_norm_before_train=1.598639 cos_to_last_merge=0.7984 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.798
[S8] round=26 local utility u=0.047419 metrics={'f1_val': 0.9927806433552421, 'auprc': 0.9865222510790684, 'loss_val': 0.06395553467634005, 'psi': 0.9902772864447726}-{'f1_val': 0.9757487977292285, 'auprc': 0.9990431846876804, 'loss_val': 0.09416541168088159, 'psi': 0.9850665525126092}
[S9] START round=26 head_norm_before_train=1.618080 cos_to_last_merge=0.9967 (last merge round=22)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9858942912577657, 'auprc': 0.9824834925428622, 'loss_val': 0.07166777135142693, 'psi': 0.9845299717718042}-{'f1_val': 0.9971344652643916, 'auprc': 0.9940426722668358, 'loss_val': 0.045845511948898326, 'psi': 0.9958977480653692}
[S10] START round=26 head_norm_before_train=1.216951 cos_to_last_merge=0.9950 (last merge round=23)
[S10] round=26 local utility u=0.031110 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9942387136527255, 'loss_val': 0.165405384803525, 'psi': 0.9945446509927137}-{'f1_val': 0.9947723700160056, 'auprc': 0.9913933962348087, 'loss_val': 0.2192311716926023, 'psi': 0.9934207805035268}
[S11] START round=26 head_norm_before_train=1.762875 cos_to_last_merge=0.8558 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.856
[S11] round=26 local utility u=0.000378 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983094035809241, 'loss_val': 0.031375952140331266, 'psi': 0.9972519641405234}-{'f1_val': 0.9965470045135896, 'auprc': 0.9984688268896229, 'loss_val': 0.03260976997132279, 'psi': 0.9973157334640029}
[S13] START round=26 head_norm_before_train=1.706247 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5784920866042759, 'auprc': 0.6929817635679775, 'loss_val': 0.885335026546448, 'psi': 0.6242879573897565}-{'f1_val': 0.6106887086672186, 'auprc': 0.6918582718830038, 'loss_val': 0.7021469070263711, 'psi': 0.6431565339535327}
[S14] START round=26 head_norm_before_train=1.952072 (no previous merge yet)
[S14] round=26 local utility u=0.007300 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9990754597541884, 'loss_val': 0.03359537132921116, 'psi': 0.9983218946820064}-{'f1_val': 0.9975765414632514, 'auprc': 0.9970600146511799, 'loss_val': 0.04069206095142631, 'psi': 0.9973699307384227}
[S15] START round=26 head_norm_before_train=1.167617 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.959052 metrics={'f1_val': 0.9966196520233872, 'auprc': 0.9911553227899701, 'loss_val': 0.17375037406482047, 'psi': 0.9944339203300203}-{'f1_val': 0.7044227752071006, 'auprc': 0.9881361610263812, 'loss_val': 0.3296160770559574, 'psi': 0.8179081295348128}
[S16] START round=26 head_norm_before_train=1.677764 cos_to_last_merge=0.8358 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.836
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8643309269501549, 'auprc': 0.9598465676998857, 'loss_val': 0.666389941681926, 'psi': 0.9025371832500472}-{'f1_val': 0.896840083323994, 'auprc': 0.9761688369071567, 'loss_val': 0.4751242240542991, 'psi': 0.9285715847572591}
[S17] START round=26 head_norm_before_train=1.569646 cos_to_last_merge=0.8259 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.826
[S17] round=26 local utility u=0.059420 metrics={'f1_val': 0.6432837775528093, 'auprc': 0.8191869993448497, 'loss_val': 0.9151340005436337, 'psi': 0.7136450662696254}-{'f1_val': 0.6288211471332315, 'auprc': 0.8152726180774177, 'loss_val': 0.9354560656867655, 'psi': 0.7034017355109059}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:57009
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:57015
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:57008
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S7
[S15] cosine check vs S7: cos=0.9538
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=-0.0914
[S6] DROPPED delta from S8 (cos=-0.0914 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1806) from S10
[S15] cosine check vs S10: cos=0.9624
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] cosine check vs S2: cos=-0.0551
[S4] DROPPED delta from S2 (cos=-0.0551 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S3
[S8] cosine check vs S3: cos=-0.0815
[S8] DROPPED delta from S3 (cos=-0.0815 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] cosine check vs S15: cos=0.9538
[S2] RECEIVED delta(kind=head bytes=1796) from S4
[S2] cosine check vs S4: cos=-0.0551
[S2] DROPPED delta from S4 (cos=-0.0551 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.9966 head_norm=1.203857
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.548981e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.9966 head_norm=1.202175 delta_norm=0.154898
[S15] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.6811 head_norm=1.207160
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.832614e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.6751 head_norm=1.191498 delta_norm=0.183261
[S7] aggregate: ROLLBACK (f1_val pre=0.681 post=0.675 tol_abs=0.005 tol_rel=0.0)
[S2] START round=27 head_norm_before_train=1.844657 (no previous merge yet)
[S2] round=27 local utility u=0.003696 metrics={'f1_val': 0.7112704911829124, 'auprc': 0.808484216735667, 'loss_val': 0.4256037981666378, 'psi': 0.7501559814040142}-{'f1_val': 0.7091324986000889, 'auprc': 0.7808091107514279, 'loss_val': 0.33714218690402364, 'psi': 0.7378031434606245}
[S3] START round=27 head_norm_before_train=1.823666 cos_to_last_merge=0.9777 (last merge round=22)
[S3] round=27 local utility u=0.086655 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9983315161026346, 'loss_val': 0.03946285098198014, 'psi': 0.9980359629209411}-{'f1_val': 0.9784018864092348, 'auprc': 0.997710419835372, 'loss_val': 0.0942871420195197, 'psi': 0.9861252997796897}
[S4] START round=27 head_norm_before_train=1.938463 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9432412793075415, 'auprc': 0.9555775751919018, 'loss_val': 0.18762538544026758, 'psi': 0.9481757976612857}-{'f1_val': 0.9437245975977823, 'auprc': 0.9720366651413589, 'loss_val': 0.2201809034203411, 'psi': 0.9550494246152129}
[S5] START round=27 head_norm_before_train=1.561243 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=27 local utility u=1.000000 metrics={'f1_val': 0.7019303961221056, 'auprc': 0.9744223436842486, 'loss_val': 0.2569788070597331, 'psi': 0.8109271751469629}-{'f1_val': 0.4346886061385853, 'auprc': 0.8533504150936726, 'loss_val': 0.9854315786780867, 'psi': 0.6021533297206203}
[S6] START round=27 head_norm_before_train=1.797938 (no previous merge yet)
[S6] round=27 local utility u=0.138714 metrics={'f1_val': 0.8238787723643841, 'auprc': 0.95773522831073, 'loss_val': 0.3727036801931976, 'psi': 0.8774213547429224}-{'f1_val': 0.7886470389528373, 'auprc': 0.9522933998645493, 'loss_val': 0.4224162806096695, 'psi': 0.8541055833175222}
[S7] START round=27 head_norm_before_train=1.191498 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.4166900667990512, 'auprc': 0.7787154449497844, 'loss_val': 1.0819901873948856, 'psi': 0.5615002180593445}-{'f1_val': 0.6811169322883373, 'auprc': 0.8479556698373731, 'loss_val': 0.44061100581252943, 'psi': 0.7478524273079517}
[S8] START round=27 head_norm_before_train=1.617191 cos_to_last_merge=0.7969 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.797
[S8] round=27 local utility u=0.019544 metrics={'f1_val': 0.9906502235932722, 'auprc': 0.9986757169128143, 'loss_val': 0.04854565402531756, 'psi': 0.9938604209210891}-{'f1_val': 0.9927806433552421, 'auprc': 0.9865222510790684, 'loss_val': 0.06395553467634005, 'psi': 0.9902772864447726}
[S9] START round=27 head_norm_before_train=1.639610 cos_to_last_merge=0.9954 (last merge round=22)
[S9] round=27 local utility u=0.073779 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9978968861095975, 'loss_val': 0.03760187820093556, 'psi': 0.9974205019511246}-{'f1_val': 0.9858942912577657, 'auprc': 0.9824834925428622, 'loss_val': 0.07166777135142693, 'psi': 0.9845299717718042}
[S10] START round=27 head_norm_before_train=1.257086 cos_to_last_merge=0.9901 (last merge round=23)
[S10] round=27 local utility u=0.012263 metrics={'f1_val': 0.9931477914946747, 'auprc': 0.9965437890618558, 'loss_val': 0.13818875889471482, 'psi': 0.9945061905215471}-{'f1_val': 0.9947486092193725, 'auprc': 0.9942387136527255, 'loss_val': 0.165405384803525, 'psi': 0.9945446509927137}
[S11] START round=27 head_norm_before_train=1.778080 cos_to_last_merge=0.8542 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.854
[S11] round=27 local utility u=0.001413 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9985866878723113, 'loss_val': 0.029381641831396445, 'psi': 0.9973628778570782}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983094035809241, 'loss_val': 0.031375952140331266, 'psi': 0.9972519641405234}
[S13] START round=27 head_norm_before_train=1.710118 (no previous merge yet)
[S13] round=27 local utility u=0.105663 metrics={'f1_val': 0.631037817139968, 'auprc': 0.6001341773453155, 'loss_val': 0.7107411884454182, 'psi': 0.618676361222107}-{'f1_val': 0.5784920866042759, 'auprc': 0.6929817635679775, 'loss_val': 0.885335026546448, 'psi': 0.6242879573897565}
[S14] START round=27 head_norm_before_train=1.969676 (no previous merge yet)
[S14] round=27 local utility u=0.000002 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9991477924300014, 'loss_val': 0.0300199936509912, 'psi': 0.9979720381741146}-{'f1_val': 0.9978195179672185, 'auprc': 0.9990754597541884, 'loss_val': 0.03359537132921116, 'psi': 0.9983218946820064}
[S15] START round=27 head_norm_before_train=1.202175 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.897035745960012, 'auprc': 0.986285554969324, 'loss_val': 0.253846239752616, 'psi': 0.9327356695637368}-{'f1_val': 0.9966196520233872, 'auprc': 0.9911553227899701, 'loss_val': 0.17375037406482047, 'psi': 0.9944339203300203}
[S16] START round=27 head_norm_before_train=1.698927 cos_to_last_merge=0.8344 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.834
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.8376928815108609, 'auprc': 0.8641815661712756, 'loss_val': 0.9395529381400103, 'psi': 0.8482883553750268}-{'f1_val': 0.8643309269501549, 'auprc': 0.9598465676998857, 'loss_val': 0.666389941681926, 'psi': 0.9025371832500472}
[S17] START round=27 head_norm_before_train=1.594096 cos_to_last_merge=0.8241 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.824
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.6402730752065392, 'auprc': 0.8142708727102863, 'loss_val': 1.0311989429813406, 'psi': 0.709872194208038}-{'f1_val': 0.6432837775528093, 'auprc': 0.8191869993448497, 'loss_val': 0.9151340005436337, 'psi': 0.7136450662696254}
[S2]  timeout peer S3
[S3]  timeout peer S2
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:57009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:57016
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:57004
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S9
[S5] cosine check vs S9: cos=0.9946
[S8] RECEIVED delta(kind=head bytes=1802) from S3
[S8] cosine check vs S3: cos=-0.0832
[S8] DROPPED delta from S3 (cos=-0.0832 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1806) from S5
[S9] cosine check vs S5: cos=0.9946
[S15] RECEIVED delta(kind=head bytes=1805) from S10
[S15] cosine check vs S10: cos=0.9799
[S4] RECEIVED delta(kind=head bytes=1797) from S2
[S4] cosine check vs S2: cos=-0.0545
[S4] DROPPED delta from S2 (cos=-0.0545 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=-0.0232
[S16] DROPPED delta from S6 (cos=-0.0232 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=-0.0924
[S6] DROPPED delta from S8 (cos=-0.0924 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.8970 head_norm=1.235287
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.303724e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.8965 head_norm=1.259126 delta_norm=0.130372
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9971 head_norm=1.656231
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.456089e-02
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9971 head_norm=1.610427 delta_norm=0.094561
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.7019 head_norm=1.568991
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.456090e-02
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.7019 head_norm=1.610427 delta_norm=0.094561
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.854053 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7194630877033652, 'auprc': 0.7969319113099296, 'loss_val': 0.5486599385349762, 'psi': 0.750450617145991}-{'f1_val': 0.7112704911829124, 'auprc': 0.808484216735667, 'loss_val': 0.4256037981666378, 'psi': 0.7501559814040142}
[S3] START round=28 head_norm_before_train=1.856570 cos_to_last_merge=0.9738 (last merge round=22)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9948994170532618, 'auprc': 0.9986368275135635, 'loss_val': 0.03329020965437074, 'psi': 0.9963943812373826}-{'f1_val': 0.9978389274664787, 'auprc': 0.9983315161026346, 'loss_val': 0.03946285098198014, 'psi': 0.9980359629209411}
[S4] START round=28 head_norm_before_train=1.943064 (no previous merge yet)
[S4] round=28 local utility u=0.009149 metrics={'f1_val': 0.9460342485922731, 'auprc': 0.9678216822560145, 'loss_val': 0.22281766711434162, 'psi': 0.9547492220577697}-{'f1_val': 0.9432412793075415, 'auprc': 0.9555775751919018, 'loss_val': 0.18762538544026758, 'psi': 0.9481757976612857}
[S5] START round=28 head_norm_before_train=1.610427 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.6995207906982899, 'auprc': 0.889587682662658, 'loss_val': 0.3648044925931197, 'psi': 0.7755475474840372}-{'f1_val': 0.7019303961221056, 'auprc': 0.9744223436842486, 'loss_val': 0.2569788070597331, 'psi': 0.8109271751469629}
[S6] START round=28 head_norm_before_train=1.811356 (no previous merge yet)
[S6] round=28 local utility u=0.036640 metrics={'f1_val': 0.8237097410596265, 'auprc': 0.94769588814248, 'loss_val': 0.2682915977484785, 'psi': 0.8733041998927679}-{'f1_val': 0.8238787723643841, 'auprc': 0.95773522831073, 'loss_val': 0.3727036801931976, 'psi': 0.8774213547429224}
[S7] START round=28 head_norm_before_train=1.218154 cos_to_last_merge=0.9996 (last merge round=26)
[S7] round=28 local utility u=1.000000 metrics={'f1_val': 0.7497138695815688, 'auprc': 0.9958440506884912, 'loss_val': 0.27812963079868697, 'psi': 0.8481659420243378}-{'f1_val': 0.4166900667990512, 'auprc': 0.7787154449497844, 'loss_val': 1.0819901873948856, 'psi': 0.5615002180593445}
[S8] START round=28 head_norm_before_train=1.633513 cos_to_last_merge=0.7951 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.795
[S8] round=28 local utility u=0.009073 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9986855503717215, 'loss_val': 0.04234870891360402, 'psi': 0.9950563144846568}-{'f1_val': 0.9906502235932722, 'auprc': 0.9986757169128143, 'loss_val': 0.04854565402531756, 'psi': 0.9938604209210891}
[S9] START round=28 head_norm_before_train=1.610427 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9987536309479154, 'loss_val': 0.04479860554180568, 'psi': 0.9977805061634315}-{'f1_val': 0.9971029125121428, 'auprc': 0.9978968861095975, 'loss_val': 0.03760187820093556, 'psi': 0.9974205019511246}
[S10] START round=28 head_norm_before_train=1.295707 cos_to_last_merge=0.9850 (last merge round=23)
[S10] round=28 local utility u=0.011359 metrics={'f1_val': 0.9941183616473943, 'auprc': 0.9966127206385647, 'loss_val': 0.12150153624103929, 'psi': 0.9951161052438624}-{'f1_val': 0.9931477914946747, 'auprc': 0.9965437890618558, 'loss_val': 0.13818875889471482, 'psi': 0.9945061905215471}
[S11] START round=28 head_norm_before_train=1.792220 cos_to_last_merge=0.8527 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.853
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9935108478447253, 'auprc': 0.9990501147623857, 'loss_val': 0.03525029690051889, 'psi': 0.9957265546117895}-{'f1_val': 0.9965470045135896, 'auprc': 0.9985866878723113, 'loss_val': 0.029381641831396445, 'psi': 0.9973628778570782}
[S13] START round=28 head_norm_before_train=1.715485 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5996983866127723, 'auprc': 0.6850561692138905, 'loss_val': 0.8321769875185696, 'psi': 0.6338414996532196}-{'f1_val': 0.631037817139968, 'auprc': 0.6001341773453155, 'loss_val': 0.7107411884454182, 'psi': 0.618676361222107}
[S14] START round=28 head_norm_before_train=1.986345 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9898416821095001, 'auprc': 0.9987003978090253, 'loss_val': 0.04468304172577507, 'psi': 0.9933851683893101}-{'f1_val': 0.9971882020035234, 'auprc': 0.9991477924300014, 'loss_val': 0.0300199936509912, 'psi': 0.9979720381741146}
[S15] START round=28 head_norm_before_train=1.259126 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.328551 metrics={'f1_val': 0.9884437777312602, 'auprc': 0.9904754492352054, 'loss_val': 0.1577619577977521, 'psi': 0.9892564463328384}-{'f1_val': 0.897035745960012, 'auprc': 0.986285554969324, 'loss_val': 0.253846239752616, 'psi': 0.9327356695637368}
[S16] START round=28 head_norm_before_train=1.718506 cos_to_last_merge=0.8330 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.833
[S16] round=28 local utility u=0.940940 metrics={'f1_val': 0.9576478091453792, 'auprc': 0.9857999063254578, 'loss_val': 0.1422565744756655, 'psi': 0.9689086480174107}-{'f1_val': 0.8376928815108609, 'auprc': 0.8641815661712756, 'loss_val': 0.9395529381400103, 'psi': 0.8482883553750268}
[S17] START round=28 head_norm_before_train=1.614745 cos_to_last_merge=0.8226 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.823
[S17] round=28 local utility u=0.091260 metrics={'f1_val': 0.6462516609925744, 'auprc': 0.8264536223782806, 'loss_val': 0.9210996368249494, 'psi': 0.7183324455468569}-{'f1_val': 0.6402730752065392, 'auprc': 0.8142708727102863, 'loss_val': 1.0311989429813406, 'psi': 0.709872194208038}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:57016
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:57002
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:57007
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:57008
[S8] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S10
[S15] cosine check vs S10: cos=0.9916
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=0.9871
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=0.9871
[S16] RECEIVED delta(kind=head bytes=1804) from S6
[S16] cosine check vs S6: cos=-0.0240
[S16] DROPPED delta from S6 (cos=-0.0240 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] cosine check vs S8: cos=-0.0928
[S6] DROPPED delta from S8 (cos=-0.0928 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] cosine check vs S4: cos=-0.0545
[S2] DROPPED delta from S4 (cos=-0.0545 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S16
[S6] cosine check vs S16: cos=-0.0240
[S6] DROPPED delta from S16 (cos=-0.0240 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.7497 head_norm=1.233618
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.060992e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.7265 head_norm=1.260885 delta_norm=0.106099
[S7] aggregate: ROLLBACK (f1_val pre=0.750 post=0.726 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.9884 head_norm=1.296288
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.785678e-02
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.9859 head_norm=1.282651 delta_norm=0.037857
[S15] aggregate: ACCEPT kept=['S10', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.864740 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.6666047135261526, 'auprc': 0.715128965028738, 'loss_val': 0.33139804664948125, 'psi': 0.6860144141271868}-{'f1_val': 0.7194630877033652, 'auprc': 0.7969319113099296, 'loss_val': 0.5486599385349762, 'psi': 0.750450617145991}
[S3] START round=29 head_norm_before_train=1.881888 cos_to_last_merge=0.9709 (last merge round=22)
[S3] round=29 local utility u=0.001350 metrics={'f1_val': 0.9948994170532618, 'auprc': 0.9986748987352931, 'loss_val': 0.030703818589814365, 'psi': 0.9964096097260744}-{'f1_val': 0.9948994170532618, 'auprc': 0.9986368275135635, 'loss_val': 0.03329020965437074, 'psi': 0.9963943812373826}
[S4] START round=29 head_norm_before_train=1.948057 (no previous merge yet)
[S4] round=29 local utility u=0.045637 metrics={'f1_val': 0.9649055690936659, 'auprc': 0.9434332813199099, 'loss_val': 0.17160689888005137, 'psi': 0.9563166539841634}-{'f1_val': 0.9460342485922731, 'auprc': 0.9678216822560145, 'loss_val': 0.22281766711434162, 'psi': 0.9547492220577697}
[S5] START round=29 head_norm_before_train=1.627264 cos_to_last_merge=0.9999 (last merge round=27)
[S5] round=29 local utility u=0.166229 metrics={'f1_val': 0.7289864783073213, 'auprc': 0.9171953182760737, 'loss_val': 0.29196323123877316, 'psi': 0.8042700142948223}-{'f1_val': 0.6995207906982899, 'auprc': 0.889587682662658, 'loss_val': 0.3648044925931197, 'psi': 0.7755475474840372}
[S6] START round=29 head_norm_before_train=1.825321 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.5799144964067104, 'auprc': 0.7774712810528533, 'loss_val': 0.9605260026860265, 'psi': 0.6589372102651676}-{'f1_val': 0.8237097410596265, 'auprc': 0.94769588814248, 'loss_val': 0.2682915977484785, 'psi': 0.8733041998927679}
[S7] START round=29 head_norm_before_train=1.260885 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5135926780179204, 'auprc': 0.7806138179408528, 'loss_val': 0.9145635359290716, 'psi': 0.6204011339870934}-{'f1_val': 0.7497138695815688, 'auprc': 0.9958440506884912, 'loss_val': 0.27812963079868697, 'psi': 0.8481659420243378}
[S8] START round=29 head_norm_before_train=1.647365 cos_to_last_merge=0.7945 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.795
[S8] round=29 local utility u=0.001817 metrics={'f1_val': 0.992959481021298, 'auprc': 0.998624551894172, 'loss_val': 0.04046745943985868, 'psi': 0.9952255093704476}-{'f1_val': 0.9926368238932805, 'auprc': 0.9986855503717215, 'loss_val': 0.04234870891360402, 'psi': 0.9950563144846568}
[S9] START round=29 head_norm_before_train=1.627232 cos_to_last_merge=0.9999 (last merge round=27)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9889102855642282, 'auprc': 0.9991148368357021, 'loss_val': 0.05841293646181574, 'psi': 0.9929921060728178}-{'f1_val': 0.9971317563071089, 'auprc': 0.9987536309479154, 'loss_val': 0.04479860554180568, 'psi': 0.9977805061634315}
[S10] START round=29 head_norm_before_train=1.329546 cos_to_last_merge=0.9804 (last merge round=23)
[S10] round=29 local utility u=0.006470 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9928436650577889, 'loss_val': 0.10103513176300793, 'psi': 0.993986631554739}-{'f1_val': 0.9941183616473943, 'auprc': 0.9966127206385647, 'loss_val': 0.12150153624103929, 'psi': 0.9951161052438624}
[S11] START round=29 head_norm_before_train=1.806390 cos_to_last_merge=0.8513 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.851
[S11] round=29 local utility u=0.011318 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9989442077098101, 'loss_val': 0.028156788253704365, 'psi': 0.9972701679303713}-{'f1_val': 0.9935108478447253, 'auprc': 0.9990501147623857, 'loss_val': 0.03525029690051889, 'psi': 0.9957265546117895}
[S13] START round=29 head_norm_before_train=1.718687 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5875143823594757, 'auprc': 0.6884117623889802, 'loss_val': 0.8875454171494578, 'psi': 0.6278733343712775}-{'f1_val': 0.5996983866127723, 'auprc': 0.6850561692138905, 'loss_val': 0.8321769875185696, 'psi': 0.6338414996532196}
[S14] START round=29 head_norm_before_train=2.000330 (no previous merge yet)
[S14] round=29 local utility u=0.030564 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9987561075328505, 'loss_val': 0.026656656798674072, 'psi': 0.9977009479077392}-{'f1_val': 0.9898416821095001, 'auprc': 0.9987003978090253, 'loss_val': 0.04468304172577507, 'psi': 0.9933851683893101}
[S15] START round=29 head_norm_before_train=1.282651 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.7046342939148718, 'auprc': 0.9866710776871214, 'loss_val': 0.3822046403708933, 'psi': 0.8174490074237716}-{'f1_val': 0.9884437777312602, 'auprc': 0.9904754492352054, 'loss_val': 0.1577619577977521, 'psi': 0.9892564463328384}
[S16] START round=29 head_norm_before_train=1.734596 cos_to_last_merge=0.8324 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.832
[S16] round=29 local utility u=0.050297 metrics={'f1_val': 0.970930871492832, 'auprc': 0.9860745950816983, 'loss_val': 0.122185122392966, 'psi': 0.9769883609283785}-{'f1_val': 0.9576478091453792, 'auprc': 0.9857999063254578, 'loss_val': 0.1422565744756655, 'psi': 0.9689086480174107}
[S17] START round=29 head_norm_before_train=1.635608 cos_to_last_merge=0.8207 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=29 local utility u=0.120508 metrics={'f1_val': 0.6486041600181383, 'auprc': 0.8485207937190686, 'loss_val': 0.7603991655964618, 'psi': 0.7285708134985104}-{'f1_val': 0.6462516609925744, 'auprc': 0.8264536223782806, 'loss_val': 0.9210996368249494, 'psi': 0.7183324455468569}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:57009
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1796 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:57010
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:57002
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] cosine check vs S3: cos=-0.0855
[S8] DROPPED delta from S3 (cos=-0.0855 < 0.0)
[S16] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] cosine check vs S8: cos=-0.0935
[S6] DROPPED delta from S8 (cos=-0.0935 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.9994
[S15] RECEIVED delta(kind=head bytes=1797) from S10
[S15] cosine check vs S10: cos=0.9881
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] cosine check vs S16: cos=-0.0252
[S6] DROPPED delta from S16 (cos=-0.0252 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=-0.0552
[S2] DROPPED delta from S4 (cos=-0.0552 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=29 metric=0.9889 head_norm=1.648896
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.871292e-02
[S9] stored merged vector for next round verification (round=29)
[S9] DEBUG after merge:  round=29 metric=0.9889 head_norm=1.643005 delta_norm=0.028713
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.7046 head_norm=1.317046
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.055688e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.7046 head_norm=1.334962 delta_norm=0.105569
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.876826 (no previous merge yet)
[S2] round=30 local utility u=0.474765 metrics={'f1_val': 0.7085157958602355, 'auprc': 0.9577429538845222, 'loss_val': 0.36117624384611774, 'psi': 0.8082066590699502}-{'f1_val': 0.6666047135261526, 'auprc': 0.715128965028738, 'loss_val': 0.33139804664948125, 'psi': 0.6860144141271868}
[S3] START round=30 head_norm_before_train=1.906023 cos_to_last_merge=0.9682 (last merge round=22)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9987023031665301, 'loss_val': 0.12304740205377607, 'psi': 0.9761020719298782}-{'f1_val': 0.9948994170532618, 'auprc': 0.9986748987352931, 'loss_val': 0.030703818589814365, 'psi': 0.9964096097260744}
[S4] START round=30 head_norm_before_train=1.954861 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.94833855740145, 'auprc': 0.9100101451207377, 'loss_val': 0.25979991086158816, 'psi': 0.9330071924891652}-{'f1_val': 0.9649055690936659, 'auprc': 0.9434332813199099, 'loss_val': 0.17160689888005137, 'psi': 0.9563166539841634}
[S5] START round=30 head_norm_before_train=1.637597 cos_to_last_merge=0.9998 (last merge round=27)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.700781124122831, 'auprc': 0.9561446247585828, 'loss_val': 0.4271978835842039, 'psi': 0.8029265243771317}-{'f1_val': 0.7289864783073213, 'auprc': 0.9171953182760737, 'loss_val': 0.29196323123877316, 'psi': 0.8042700142948223}
[S6] START round=30 head_norm_before_train=1.835207 (no previous merge yet)
[S6] round=30 local utility u=1.000000 metrics={'f1_val': 0.7894119743127607, 'auprc': 0.9541933117672307, 'loss_val': 0.49760074034553764, 'psi': 0.8553245092945487}-{'f1_val': 0.5799144964067104, 'auprc': 0.7774712810528533, 'loss_val': 0.9605260026860265, 'psi': 0.6589372102651676}
[S7] START round=30 head_norm_before_train=1.270958 cos_to_last_merge=0.9999 (last merge round=28)
[S7] round=30 local utility u=0.289820 metrics={'f1_val': 0.575646378210793, 'auprc': 0.7891809989079697, 'loss_val': 0.7329473924239088, 'psi': 0.6610602264896637}-{'f1_val': 0.5135926780179204, 'auprc': 0.7806138179408528, 'loss_val': 0.9145635359290716, 'psi': 0.6204011339870934}
[S8] START round=30 head_norm_before_train=1.663784 cos_to_last_merge=0.7928 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.793
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9925945134171912, 'auprc': 0.998680010699043, 'loss_val': 0.039499556459352506, 'psi': 0.995028712329932}-{'f1_val': 0.992959481021298, 'auprc': 0.998624551894172, 'loss_val': 0.04046745943985868, 'psi': 0.9952255093704476}
[S9] START round=30 head_norm_before_train=1.643005 cos_to_last_merge=1.0000 (last merge round=29)
[S9] round=30 local utility u=0.031886 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9972362221915714, 'loss_val': 0.038161779479190694, 'psi': 0.9971562363839143}-{'f1_val': 0.9889102855642282, 'auprc': 0.9991148368357021, 'loss_val': 0.05841293646181574, 'psi': 0.9929921060728178}
[S10] START round=30 head_norm_before_train=1.360855 cos_to_last_merge=0.9761 (last merge round=23)
[S10] round=30 local utility u=0.008759 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9947296421869212, 'loss_val': 0.08785739177750294, 'psi': 0.994609320953805}-{'f1_val': 0.9947486092193725, 'auprc': 0.9928436650577889, 'loss_val': 0.10103513176300793, 'psi': 0.993986631554739}
[S11] START round=30 head_norm_before_train=1.818284 cos_to_last_merge=0.8501 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.850
[S11] round=30 local utility u=0.000667 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9991130847099068, 'loss_val': 0.027329657731641286, 'psi': 0.99733771873041}-{'f1_val': 0.9961541414107454, 'auprc': 0.9989442077098101, 'loss_val': 0.028156788253704365, 'psi': 0.9972701679303713}
[S13] START round=30 head_norm_before_train=1.723731 (no previous merge yet)
[S13] round=30 local utility u=0.094819 metrics={'f1_val': 0.6018999159579553, 'auprc': 0.6912049802173391, 'loss_val': 0.7926003194260778, 'psi': 0.6376219416617088}-{'f1_val': 0.5875143823594757, 'auprc': 0.6884117623889802, 'loss_val': 0.8875454171494578, 'psi': 0.6278733343712775}
[S14] START round=30 head_norm_before_train=2.012007 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9971625532153504, 'auprc': 0.9970147122199899, 'loss_val': 0.037814409617618394, 'psi': 0.9971034168172062}-{'f1_val': 0.9969975081576651, 'auprc': 0.9987561075328505, 'loss_val': 0.026656656798674072, 'psi': 0.9977009479077392}
[S15] START round=30 head_norm_before_train=1.334962 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.999129 metrics={'f1_val': 0.9965488630946432, 'auprc': 0.9935432375966537, 'loss_val': 0.15605134992768302, 'psi': 0.9953466128954475}-{'f1_val': 0.7046342939148718, 'auprc': 0.9866710776871214, 'loss_val': 0.3822046403708933, 'psi': 0.8174490074237716}
[S16] START round=30 head_norm_before_train=1.750644 cos_to_last_merge=0.8315 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.832
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8269288417040941, 'auprc': 0.880785388006606, 'loss_val': 1.1068269230334296, 'psi': 0.8484714602250989}-{'f1_val': 0.970930871492832, 'auprc': 0.9860745950816983, 'loss_val': 0.122185122392966, 'psi': 0.9769883609283785}
[S17] START round=30 head_norm_before_train=1.655070 cos_to_last_merge=0.8196 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.820
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6387595823419969, 'auprc': 0.8320587213050855, 'loss_val': 0.8928935307020294, 'psi': 0.7160792379272324}-{'f1_val': 0.6486041600181383, 'auprc': 0.8485207937190686, 'loss_val': 0.7603991655964618, 'psi': 0.7285708134985104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:57004
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:57005
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:57016
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=-0.0548
[S4] DROPPED delta from S2 (cos=-0.0548 < 0.0)
[S15] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S9
[S5] cosine check vs S9: cos=0.9995
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=0.9910
[S15] RECEIVED delta(kind=head bytes=1795) from S10
[S15] cosine check vs S10: cos=0.9948
[S7] RECEIVED delta(kind=head bytes=1806) from S15
[S7] cosine check vs S15: cos=0.9910
[S16] RECEIVED delta(kind=head bytes=1797) from S6
[S16] cosine check vs S6: cos=-0.0261
[S16] DROPPED delta from S6 (cos=-0.0261 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.036 → S8@127.0.0.1:57009
[S2] ⇄ pheromone p=0.125 → S4@127.0.0.1:57004
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.7008 head_norm=1.643943
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.879880e-02
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.7008 head_norm=1.653123 delta_norm=0.028799
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.195 → S9@127.0.0.1:57010
[S4] ⇄ pheromone p=0.038 → S2@127.0.0.1:57002
[S8] ⇄ pheromone p=0.071 → S6@127.0.0.1:57007
[S10] ⇄ pheromone p=0.024 → S15@127.0.0.1:57015
[S9] ⇄ pheromone p=0.023 → S5@127.0.0.1:57005
[S6] ⇄ pheromone p=0.323 → S16@127.0.0.1:57016
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.9965 head_norm=1.363415
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.192019e-02
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.9965 head_norm=1.345492 delta_norm=0.031920
[S15] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.390 → S7@127.0.0.1:57008
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.5756 head_norm=1.282202
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.754043e-02
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.5741 head_norm=1.319832 delta_norm=0.097540
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.251 → S15@127.0.0.1:57015
[S16] ⇄ pheromone p=0.176 → S6@127.0.0.1:57007
[S2] START round=31 head_norm_before_train=1.889543 (no previous merge yet)
[S2] round=31 local utility u=0.006823 metrics={'f1_val': 0.7157078623562025, 'auprc': 0.9264252841676572, 'loss_val': 0.2967298197479667, 'psi': 0.7999948310807845}-{'f1_val': 0.7085157958602355, 'auprc': 0.9577429538845222, 'loss_val': 0.36117624384611774, 'psi': 0.8082066590699502}
[S3] START round=31 head_norm_before_train=1.925106 cos_to_last_merge=0.9660 (last merge round=22)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9225716782548247, 'auprc': 0.9970987969863225, 'loss_val': 0.13518664021258908, 'psi': 0.9523825257474239}-{'f1_val': 0.9610352511054436, 'auprc': 0.9987023031665301, 'loss_val': 0.12304740205377607, 'psi': 0.9761020719298782}
[S4] START round=31 head_norm_before_train=1.960645 (no previous merge yet)
[S4] round=31 local utility u=0.187450 metrics={'f1_val': 0.9646275360515656, 'auprc': 0.9643502710016282, 'loss_val': 0.1456545402420536, 'psi': 0.9645166300315906}-{'f1_val': 0.94833855740145, 'auprc': 0.9100101451207377, 'loss_val': 0.25979991086158816, 'psi': 0.9330071924891652}
[S5] START round=31 head_norm_before_train=1.653123 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=1.000000 metrics={'f1_val': 0.9710003098093832, 'auprc': 0.9923140384358643, 'loss_val': 0.09739345269968762, 'psi': 0.9795258012599757}-{'f1_val': 0.700781124122831, 'auprc': 0.9561446247585828, 'loss_val': 0.4271978835842039, 'psi': 0.8029265243771317}
[S6] START round=31 head_norm_before_train=1.843965 (no previous merge yet)
[S6] round=31 local utility u=0.713549 metrics={'f1_val': 0.9614783823188969, 'auprc': 0.9722159141629205, 'loss_val': 0.15696800694358257, 'psi': 0.9657733950565064}-{'f1_val': 0.7894119743127607, 'auprc': 0.9541933117672307, 'loss_val': 0.49760074034553764, 'psi': 0.8553245092945487}
[S7] START round=31 head_norm_before_train=1.319832 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.516316 metrics={'f1_val': 0.6789666712282914, 'auprc': 0.8296317827402999, 'loss_val': 0.44158921055953254, 'psi': 0.7392327158330947}-{'f1_val': 0.575646378210793, 'auprc': 0.7891809989079697, 'loss_val': 0.7329473924239088, 'psi': 0.6610602264896637}
[S8] START round=31 head_norm_before_train=1.682226 cos_to_last_merge=0.7902 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.790
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9894208216881261, 'auprc': 0.998851432363552, 'loss_val': 0.044633375586932145, 'psi': 0.9931930659582964}-{'f1_val': 0.9925945134171912, 'auprc': 0.998680010699043, 'loss_val': 0.039499556459352506, 'psi': 0.995028712329932}
[S9] START round=31 head_norm_before_train=1.662752 cos_to_last_merge=0.9999 (last merge round=29)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9986585753478872, 'loss_val': 0.040333014384925474, 'psi': 0.9959772539894944}-{'f1_val': 0.9971029125121428, 'auprc': 0.9972362221915714, 'loss_val': 0.038161779479190694, 'psi': 0.9971562363839143}
[S10] START round=31 head_norm_before_train=1.390623 cos_to_last_merge=0.9721 (last merge round=23)
[S10] round=31 local utility u=0.001306 metrics={'f1_val': 0.9934769336626772, 'auprc': 0.9966222890221295, 'loss_val': 0.08460963760660785, 'psi': 0.9947350758064581}-{'f1_val': 0.9945291067983943, 'auprc': 0.9947296421869212, 'loss_val': 0.08785739177750294, 'psi': 0.994609320953805}
[S11] START round=31 head_norm_before_train=1.830662 cos_to_last_merge=0.8489 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.849
[S11] round=31 local utility u=0.001003 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9991120826918931, 'loss_val': 0.02532021626674709, 'psi': 0.9973373179232045}-{'f1_val': 0.9961541414107454, 'auprc': 0.9991130847099068, 'loss_val': 0.027329657731641286, 'psi': 0.99733771873041}
[S13] START round=31 head_norm_before_train=1.728497 (no previous merge yet)
[S13] round=31 local utility u=0.040488 metrics={'f1_val': 0.6098850486397748, 'auprc': 0.6894343209442231, 'loss_val': 0.7542241123873574, 'psi': 0.6417047575615541}-{'f1_val': 0.6018999159579553, 'auprc': 0.6912049802173391, 'loss_val': 0.7926003194260778, 'psi': 0.6376219416617088}
[S14] START round=31 head_norm_before_train=2.023437 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9784191812840943, 'auprc': 0.9969660015854735, 'loss_val': 0.04932744029835477, 'psi': 0.985837909404646}-{'f1_val': 0.9971625532153504, 'auprc': 0.9970147122199899, 'loss_val': 0.037814409617618394, 'psi': 0.9971034168172062}
[S15] START round=31 head_norm_before_train=1.345492 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.9402365689619439, 'auprc': 0.9969032998612173, 'loss_val': 0.14521649793720456, 'psi': 0.9629032613216533}-{'f1_val': 0.9965488630946432, 'auprc': 0.9935432375966537, 'loss_val': 0.15605134992768302, 'psi': 0.9953466128954475}
[S16] START round=31 head_norm_before_train=1.765358 cos_to_last_merge=0.8306 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.831
[S16] round=31 local utility u=0.158684 metrics={'f1_val': 0.8432240402844744, 'auprc': 0.892999828254891, 'loss_val': 0.9238742820961834, 'psi': 0.863134355472641}-{'f1_val': 0.8269288417040941, 'auprc': 0.880785388006606, 'loss_val': 1.1068269230334296, 'psi': 0.8484714602250989}
[S17] START round=31 head_norm_before_train=1.676535 cos_to_last_merge=0.8187 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.819
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6404573551545871, 'auprc': 0.8228145907937905, 'loss_val': 0.9691451931744267, 'psi': 0.7134002494102685}-{'f1_val': 0.6387595823419969, 'auprc': 0.8320587213050855, 'loss_val': 0.8928935307020294, 'psi': 0.7160792379272324}
[S15]  timeout peer S2
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S11
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S15
[S6]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S7]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S16
[S10]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:57004
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:57002
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:57016
[S2] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:57015
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1797) from S2
[S4] cosine check vs S2: cos=-0.0537
[S4] DROPPED delta from S2 (cos=-0.0537 < 0.0)
[S16] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S4
[S2] cosine check vs S4: cos=-0.0537
[S2] DROPPED delta from S4 (cos=-0.0537 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=-0.0274
[S6] DROPPED delta from S16 (cos=-0.0274 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S7
[S15] cosine check vs S7: cos=0.9983
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.9996
[S16] RECEIVED delta(kind=head bytes=1798) from S6
[S16] cosine check vs S6: cos=-0.0274
[S16] DROPPED delta from S6 (cos=-0.0274 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S10
[S15] cosine check vs S10: cos=0.9926
[S15] CommDone barrier timeout: have=2 need=3 — continuing
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.9402 head_norm=1.370642
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.030682e-02
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.9362 head_norm=1.369677 delta_norm=0.030307
[S15] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.900058 (no previous merge yet)
[S2] round=32 local utility u=0.310047 metrics={'f1_val': 0.8220163688234897, 'auprc': 0.910904103088622, 'loss_val': 0.26792343734456664, 'psi': 0.8575714625295426}-{'f1_val': 0.7157078623562025, 'auprc': 0.9264252841676572, 'loss_val': 0.2967298197479667, 'psi': 0.7999948310807845}
[S3] START round=32 head_norm_before_train=1.939959 cos_to_last_merge=0.9642 (last merge round=22)
[S3] round=32 local utility u=0.117160 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9983382989253049, 'loss_val': 0.13560544684453923, 'psi': 0.9759803708097943}-{'f1_val': 0.9225716782548247, 'auprc': 0.9970987969863225, 'loss_val': 0.13518664021258908, 'psi': 0.9523825257474239}
[S4] START round=32 head_norm_before_train=1.968121 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9501641210673252, 'auprc': 0.9906764241688586, 'loss_val': 0.17755331508816727, 'psi': 0.9663690423079385}-{'f1_val': 0.9646275360515656, 'auprc': 0.9643502710016282, 'loss_val': 0.1456545402420536, 'psi': 0.9645166300315906}
[S5] START round=32 head_norm_before_train=1.658112 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=32 local utility u=0.080714 metrics={'f1_val': 0.9942459107345576, 'auprc': 0.9945102699899243, 'loss_val': 0.08202724402100554, 'psi': 0.9943516544367043}-{'f1_val': 0.9710003098093832, 'auprc': 0.9923140384358643, 'loss_val': 0.09739345269968762, 'psi': 0.9795258012599757}
[S6] START round=32 head_norm_before_train=1.856573 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.597308561327172, 'auprc': 0.7950864045986472, 'loss_val': 0.9543365901796146, 'psi': 0.676419698635762}-{'f1_val': 0.9614783823188969, 'auprc': 0.9722159141629205, 'loss_val': 0.15696800694358257, 'psi': 0.9657733950565064}
[S7] START round=32 head_norm_before_train=1.332243 cos_to_last_merge=0.9999 (last merge round=30)
[S7] round=32 local utility u=0.292744 metrics={'f1_val': 0.6990918104110357, 'auprc': 0.9404804153951567, 'loss_val': 0.30939814211968175, 'psi': 0.7956472524046841}-{'f1_val': 0.6789666712282914, 'auprc': 0.8296317827402999, 'loss_val': 0.44158921055953254, 'psi': 0.7392327158330947}
[S8] START round=32 head_norm_before_train=1.700741 cos_to_last_merge=0.7874 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.787
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9741065401273652, 'auprc': 0.999106589253367, 'loss_val': 0.0743046053293312, 'psi': 0.984106559777766}-{'f1_val': 0.9894208216881261, 'auprc': 0.998851432363552, 'loss_val': 0.044633375586932145, 'psi': 0.9931930659582964}
[S9] START round=32 head_norm_before_train=1.681784 cos_to_last_merge=0.9996 (last merge round=29)
[S9] round=32 local utility u=0.012938 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987491570174549, 'loss_val': 0.03220755561526702, 'psi': 0.9977614103142677}-{'f1_val': 0.9941897064172326, 'auprc': 0.9986585753478872, 'loss_val': 0.040333014384925474, 'psi': 0.9959772539894944}
[S10] START round=32 head_norm_before_train=1.416657 cos_to_last_merge=0.9686 (last merge round=23)
[S10] round=32 local utility u=0.000949 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9919749229480886, 'loss_val': 0.07404694193936624, 'psi': 0.9934038082062883}-{'f1_val': 0.9934769336626772, 'auprc': 0.9966222890221295, 'loss_val': 0.08460963760660785, 'psi': 0.9947350758064581}
[S11] START round=32 head_norm_before_train=1.843065 cos_to_last_merge=0.8477 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.848
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9989366903205653, 'loss_val': 0.02473534593657352, 'psi': 0.9972548810762117}-{'f1_val': 0.9961541414107454, 'auprc': 0.9991120826918931, 'loss_val': 0.02532021626674709, 'psi': 0.9973373179232045}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=1.735258 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6006773453229821, 'auprc': 0.6906504924248311, 'loss_val': 0.8308798515335604, 'psi': 0.6366666041637217}-{'f1_val': 0.6098850486397748, 'auprc': 0.6894343209442231, 'loss_val': 0.7542241123873574, 'psi': 0.6417047575615541}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=2.035573 (no previous merge yet)
[S14] round=32 local utility u=0.068054 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9970312046831475, 'loss_val': 0.026045621855818806, 'psi': 0.9971269548333513}-{'f1_val': 0.9784191812840943, 'auprc': 0.9969660015854735, 'loss_val': 0.04932744029835477, 'psi': 0.985837909404646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=32 head_norm_before_train=1.369677 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.9013277441892558, 'auprc': 0.9915861379506355, 'loss_val': 0.2175031983533566, 'psi': 0.9374311016938077}-{'f1_val': 0.9402365689619439, 'auprc': 0.9969032998612173, 'loss_val': 0.14521649793720456, 'psi': 0.9629032613216533}
[S16] START round=32 head_norm_before_train=1.776960 cos_to_last_merge=0.8293 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.829
[S16] round=32 local utility u=0.056500 metrics={'f1_val': 0.8569520619610027, 'auprc': 0.8640811491318118, 'loss_val': 0.8064856417221883, 'psi': 0.8598036968293263}-{'f1_val': 0.8432240402844744, 'auprc': 0.892999828254891, 'loss_val': 0.9238742820961834, 'psi': 0.863134355472641}
[S17] START round=32 head_norm_before_train=1.697167 cos_to_last_merge=0.8172 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.817
[S17] round=32 local utility u=0.037786 metrics={'f1_val': 0.6501279767444352, 'auprc': 0.8338291249210095, 'loss_val': 0.9846408512684462, 'psi': 0.723608436015065}-{'f1_val': 0.6404573551545871, 'auprc': 0.8228145907937905, 'loss_val': 0.9691451931744267, 'psi': 0.7134002494102685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:57005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:57004
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S16
[S6] cosine check vs S16: cos=-0.0283
[S6] DROPPED delta from S16 (cos=-0.0283 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S9
[S5] cosine check vs S9: cos=0.9991
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.9991
[S4] RECEIVED delta(kind=head bytes=1796) from S2
[S4] cosine check vs S2: cos=-0.0528
[S4] DROPPED delta from S2 (cos=-0.0528 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:57015
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=32 metric=0.9971 head_norm=1.700388
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.938708e-02
[S9] stored merged vector for next round verification (round=32)
[S9] DEBUG after merge:  round=32 metric=0.9971 head_norm=1.680503 delta_norm=0.039387
[S9] aggregate: ACCEPT kept=['S5', 'S5'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.9942 head_norm=1.664535
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.961286e-02
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.9905 head_norm=1.682091 delta_norm=0.039613
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S7
[S15] cosine check vs S7: cos=0.9971
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:57008
[S10] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] cosine check vs S10: cos=0.9831
[S3]  timeout peer S8
[S3]  timeout peer S9
[S8]  timeout peer S6
[S8]  timeout peer S17
[S7]  timeout peer S10
[S7]  timeout peer S11
[S6]  timeout peer S14
[S15]  timeout peer S3
[S15]  timeout peer S13
[S10]  timeout peer S2
[S10]  timeout peer S15
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.6991 head_norm=1.342974
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.367161e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.6990 head_norm=1.385205 delta_norm=0.136716
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.9013 head_norm=1.397760
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.853833e-02
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.9013 head_norm=1.369390 delta_norm=0.058538
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.914319 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.7266700303404473, 'auprc': 0.7967478290148433, 'loss_val': 0.3417514810555739, 'psi': 0.7547011498102056}-{'f1_val': 0.8220163688234897, 'auprc': 0.910904103088622, 'loss_val': 0.26792343734456664, 'psi': 0.8575714625295426}
[S3] START round=33 head_norm_before_train=1.954318 cos_to_last_merge=0.9627 (last merge round=22)
[S3] round=33 local utility u=0.109314 metrics={'f1_val': 0.982537901173439, 'auprc': 0.9982128565918131, 'loss_val': 0.045378513391357754, 'psi': 0.9888078833407887}-{'f1_val': 0.9610750853994537, 'auprc': 0.9983382989253049, 'loss_val': 0.13560544684453923, 'psi': 0.9759803708097943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=33 head_norm_before_train=1.977181 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9472026093458792, 'auprc': 0.9830794451988691, 'loss_val': 0.22040996808347355, 'psi': 0.9615533436870751}-{'f1_val': 0.9501641210673252, 'auprc': 0.9906764241688586, 'loss_val': 0.17755331508816727, 'psi': 0.9663690423079385}
[S5] START round=33 head_norm_before_train=1.682091 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.700781124122831, 'auprc': 0.9394071031143281, 'loss_val': 0.4092583720864473, 'psi': 0.7962315157194297}-{'f1_val': 0.9942459107345576, 'auprc': 0.9945102699899243, 'loss_val': 0.08202724402100554, 'psi': 0.9943516544367043}
[S6] START round=33 head_norm_before_train=1.864651 (no previous merge yet)
[S6] round=33 local utility u=0.224239 metrics={'f1_val': 0.6183632114854098, 'auprc': 0.803746148898166, 'loss_val': 0.6581658957361316, 'psi': 0.6925163864505124}-{'f1_val': 0.597308561327172, 'auprc': 0.7950864045986472, 'loss_val': 0.9543365901796146, 'psi': 0.676419698635762}
[S7] START round=33 head_norm_before_train=1.385205 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.6945860247541111, 'auprc': 0.885332620989394, 'loss_val': 0.34143909214342266, 'psi': 0.7708846632482242}-{'f1_val': 0.6990918104110357, 'auprc': 0.9404804153951567, 'loss_val': 0.30939814211968175, 'psi': 0.7956472524046841}
[S8] START round=33 head_norm_before_train=1.714675 cos_to_last_merge=0.7856 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.786
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.7958825286733965, 'auprc': 0.984807835706779, 'loss_val': 0.17582622156176655, 'psi': 0.8714526514867496}-{'f1_val': 0.9741065401273652, 'auprc': 0.999106589253367, 'loss_val': 0.0743046053293312, 'psi': 0.984106559777766}
[S9] START round=33 head_norm_before_train=1.680503 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987493712233491, 'loss_val': 0.032590486472383606, 'psi': 0.9977614959966253}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987491570174549, 'loss_val': 0.03220755561526702, 'psi': 0.9977614103142677}
[S10] START round=33 head_norm_before_train=1.439232 cos_to_last_merge=0.9657 (last merge round=23)
[S10] round=33 local utility u=0.010812 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9958089732022181, 'loss_val': 0.06627901986573975, 'psi': 0.9951727548125107}-{'f1_val': 0.9943563983784213, 'auprc': 0.9919749229480886, 'loss_val': 0.07404694193936624, 'psi': 0.9934038082062883}
[S11] START round=33 head_norm_before_train=1.855356 cos_to_last_merge=0.8465 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.847
[S11] round=33 local utility u=0.000819 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9991090964271331, 'loss_val': 0.02373765001723382, 'psi': 0.9973361234173005}-{'f1_val': 0.9961336749133093, 'auprc': 0.9989366903205653, 'loss_val': 0.02473534593657352, 'psi': 0.9972548810762117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=33 head_norm_before_train=1.742400 (no previous merge yet)
[S13] round=33 local utility u=0.094098 metrics={'f1_val': 0.6062948444423542, 'auprc': 0.7187706420798381, 'loss_val': 0.7607489353979335, 'psi': 0.6512851634973478}-{'f1_val': 0.6006773453229821, 'auprc': 0.6906504924248311, 'loss_val': 0.8308798515335604, 'psi': 0.6366666041637217}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] sending update (kind=head size=1808 to 1 peers)
[S14] START round=33 head_norm_before_train=2.048670 (no previous merge yet)
[S14] round=33 local utility u=0.002276 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9983795663376509, 'loss_val': 0.024397680587271393, 'psi': 0.9975522544636071}-{'f1_val': 0.9971907882668205, 'auprc': 0.9970312046831475, 'loss_val': 0.026045621855818806, 'psi': 0.9971269548333513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] sending update (kind=head size=1807 to 1 peers)
[S15] START round=33 head_norm_before_train=1.369390 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.289265 metrics={'f1_val': 0.9778917855730656, 'auprc': 0.9969869146118291, 'loss_val': 0.11455973439410744, 'psi': 0.985529837188571}-{'f1_val': 0.9013277441892558, 'auprc': 0.9915861379506355, 'loss_val': 0.2175031983533566, 'psi': 0.9374311016938077}
[S16] START round=33 head_norm_before_train=1.787059 cos_to_last_merge=0.8277 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.828
[S16] round=33 local utility u=0.299788 metrics={'f1_val': 0.8818237357661568, 'auprc': 0.9427951861695418, 'loss_val': 0.5922813196211273, 'psi': 0.9062123159275108}-{'f1_val': 0.8569520619610027, 'auprc': 0.8640811491318118, 'loss_val': 0.8064856417221883, 'psi': 0.8598036968293263}
[S17] START round=33 head_norm_before_train=1.715140 cos_to_last_merge=0.8158 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6424607098546, 'auprc': 0.8411937316732793, 'loss_val': 1.0323149103120783, 'psi': 0.7219539185820717}-{'f1_val': 0.6501279767444352, 'auprc': 0.8338291249210095, 'loss_val': 0.9846408512684462, 'psi': 0.723608436015065}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:57007
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:57016
[S16] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] cosine check vs S16: cos=-0.0295
[S6] DROPPED delta from S16 (cos=-0.0295 < 0.0)
[S6] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S15
[S7] cosine check vs S15: cos=0.9973
[S16] RECEIVED delta(kind=head bytes=1802) from S6
[S16] cosine check vs S6: cos=-0.0295
[S16] DROPPED delta from S6 (cos=-0.0295 < 0.0)
[S2] START round=34 head_norm_before_train=1.929800 (no previous merge yet)
[S2] round=34 local utility u=0.318374 metrics={'f1_val': 0.7663228081594139, 'auprc': 0.915625729315565, 'loss_val': 0.2995544148824777, 'psi': 0.8260439766218743}-{'f1_val': 0.7266700303404473, 'auprc': 0.7967478290148433, 'loss_val': 0.3417514810555739, 'psi': 0.7547011498102056}
[S3] START round=34 head_norm_before_train=1.967218 cos_to_last_merge=0.9612 (last merge round=22)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.8935429762810793, 'auprc': 0.9973846811137975, 'loss_val': 0.16032989891733615, 'psi': 0.9350796582141666}-{'f1_val': 0.982537901173439, 'auprc': 0.9982128565918131, 'loss_val': 0.045378513391357754, 'psi': 0.9888078833407887}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.984892 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.941981166305629, 'auprc': 0.9742521040342575, 'loss_val': 0.20913408334800979, 'psi': 0.9548895413970804}-{'f1_val': 0.9472026093458792, 'auprc': 0.9830794451988691, 'loss_val': 0.22040996808347355, 'psi': 0.9615533436870751}
[S5] START round=34 head_norm_before_train=1.684850 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=34 local utility u=0.404008 metrics={'f1_val': 0.7818683060499352, 'auprc': 0.9843131077450992, 'loss_val': 0.22248255483959492, 'psi': 0.8628462267280008}-{'f1_val': 0.700781124122831, 'auprc': 0.9394071031143281, 'loss_val': 0.4092583720864473, 'psi': 0.7962315157194297}
[S6] START round=34 head_norm_before_train=1.873951 (no previous merge yet)
[S6] round=34 local utility u=0.931947 metrics={'f1_val': 0.8169964076808647, 'auprc': 0.9506434409733373, 'loss_val': 0.42676323511481745, 'psi': 0.8704552209978538}-{'f1_val': 0.6183632114854098, 'auprc': 0.803746148898166, 'loss_val': 0.6581658957361316, 'psi': 0.6925163864505124}
[S7] START round=34 head_norm_before_train=1.396812 cos_to_last_merge=0.9999 (last merge round=32)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5696125732429571, 'auprc': 0.7877417476399996, 'loss_val': 0.7277811774097993, 'psi': 0.6568642430017742}-{'f1_val': 0.6945860247541111, 'auprc': 0.885332620989394, 'loss_val': 0.34143909214342266, 'psi': 0.7708846632482242}
[S8] START round=34 head_norm_before_train=1.726212 cos_to_last_merge=0.7848 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.785
[S8] round=34 local utility u=0.675728 metrics={'f1_val': 0.9913729870729182, 'auprc': 0.998769536748142, 'loss_val': 0.03919709930653849, 'psi': 0.9943316069430077}-{'f1_val': 0.7958825286733965, 'auprc': 0.984807835706779, 'loss_val': 0.17582622156176655, 'psi': 0.8714526514867496}
[S9] START round=34 head_norm_before_train=1.699262 cos_to_last_merge=0.9999 (last merge round=32)
[S9] round=34 local utility u=0.001122 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.998746584507898, 'loss_val': 0.030337835957381792, 'psi': 0.9977603813104449}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987493712233491, 'loss_val': 0.032590486472383606, 'psi': 0.9977614959966253}
[S10] START round=34 head_norm_before_train=1.459303 cos_to_last_merge=0.9631 (last merge round=23)
[S10] round=34 local utility u=0.004889 metrics={'f1_val': 0.9952985899745774, 'auprc': 0.9965337148800337, 'loss_val': 0.06197608351562826, 'psi': 0.9957926399367599}-{'f1_val': 0.9947486092193725, 'auprc': 0.9958089732022181, 'loss_val': 0.06627901986573975, 'psi': 0.9951727548125107}
[S11] START round=34 head_norm_before_train=1.864685 cos_to_last_merge=0.8455 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.846
[S11] round=34 local utility u=0.000462 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9990865391285462, 'loss_val': 0.02274621113641568, 'psi': 0.9973271004978657}-{'f1_val': 0.9961541414107454, 'auprc': 0.9991090964271331, 'loss_val': 0.02373765001723382, 'psi': 0.9973361234173005}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=34 head_norm_before_train=1.748981 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.590860608571422, 'auprc': 0.6919802771740352, 'loss_val': 0.8795799805740173, 'psi': 0.6313084760124672}-{'f1_val': 0.6062948444423542, 'auprc': 0.7187706420798381, 'loss_val': 0.7607489353979335, 'psi': 0.6512851634973478}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=2.059998 (no previous merge yet)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9977294656954889, 'loss_val': 0.024933231018260726, 'psi': 0.997392596936512}-{'f1_val': 0.9970007132142444, 'auprc': 0.9983795663376509, 'loss_val': 0.024397680587271393, 'psi': 0.9975522544636071}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.398872 cos_to_last_merge=0.9998 (last merge round=32)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.8925912038657148, 'auprc': 0.9906511273972933, 'loss_val': 0.2398410920594015, 'psi': 0.9318151732783462}-{'f1_val': 0.9778917855730656, 'auprc': 0.9969869146118291, 'loss_val': 0.11455973439410744, 'psi': 0.985529837188571}
[S16] START round=34 head_norm_before_train=1.798179 cos_to_last_merge=0.8267 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.827
[S16] round=34 local utility u=0.318355 metrics={'f1_val': 0.9239810330960107, 'auprc': 0.9933943864314092, 'loss_val': 0.36031264701969185, 'psi': 0.9517463744301701}-{'f1_val': 0.8818237357661568, 'auprc': 0.9427951861695418, 'loss_val': 0.5922813196211273, 'psi': 0.9062123159275108}
[S17] START round=34 head_norm_before_train=1.732165 cos_to_last_merge=0.8147 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6442566893428372, 'auprc': 0.8246379907388787, 'loss_val': 1.1553374455053764, 'psi': 0.7164092099012538}-{'f1_val': 0.6424607098546, 'auprc': 0.8411937316732793, 'loss_val': 1.0323149103120783, 'psi': 0.7219539185820717}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:57004
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:57003
[S16] not sending this round → trigger blocked (psi=0.952)
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:57005
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.870)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.5696 head_norm=1.410414
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.149513e-02
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.5755 head_norm=1.403711 delta_norm=0.051495
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1803 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.9997
[S5] RECEIVED delta(kind=head bytes=1803) from S9
[S5] cosine check vs S9: cos=0.9997
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=-0.0887
[S3] DROPPED delta from S8 (cos=-0.0887 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] cosine check vs S2: cos=-0.0523
[S4] DROPPED delta from S2 (cos=-0.0523 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=34 metric=0.7819 head_norm=1.687681
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.577441e-02
[S5] stored merged vector for next round verification (round=34)
[S5] DEBUG after merge:  round=34 metric=0.7801 head_norm=1.702259 delta_norm=0.025774
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=34 metric=0.9971 head_norm=1.717099
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.577441e-02
[S9] stored merged vector for next round verification (round=34)
[S9] DEBUG after merge:  round=34 metric=0.9971 head_norm=1.702259 delta_norm=0.025774
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.943186 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7156616655983694, 'auprc': 0.9720090362580432, 'loss_val': 0.42413315801010887, 'psi': 0.818200613862239}-{'f1_val': 0.7663228081594139, 'auprc': 0.915625729315565, 'loss_val': 0.2995544148824777, 'psi': 0.8260439766218743}
[S3] START round=35 head_norm_before_train=1.975596 cos_to_last_merge=0.9601 (last merge round=22)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.8943589272967922, 'auprc': 0.9925175890793367, 'loss_val': 0.2107147118515603, 'psi': 0.9336223920098101}-{'f1_val': 0.8935429762810793, 'auprc': 0.9973846811137975, 'loss_val': 0.16032989891733615, 'psi': 0.9350796582141666}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.993293 (no previous merge yet)
[S4] round=35 local utility u=0.000347 metrics={'f1_val': 0.9414540098592545, 'auprc': 0.9713423868506244, 'loss_val': 0.19654765551514186, 'psi': 0.9534093606558024}-{'f1_val': 0.941981166305629, 'auprc': 0.9742521040342575, 'loss_val': 0.20913408334800979, 'psi': 0.9548895413970804}
[S5] START round=35 head_norm_before_train=1.702259 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.7150597362695597, 'auprc': 0.9834417548278857, 'loss_val': 0.29485498245260994, 'psi': 0.82241254369289}-{'f1_val': 0.7818683060499352, 'auprc': 0.9843131077450992, 'loss_val': 0.22248255483959492, 'psi': 0.8628462267280008}
[S6] START round=35 head_norm_before_train=1.884940 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.7921302261059564, 'auprc': 0.9562144632789601, 'loss_val': 0.4776127393714743, 'psi': 0.8577639209751579}-{'f1_val': 0.8169964076808647, 'auprc': 0.9506434409733373, 'loss_val': 0.42676323511481745, 'psi': 0.8704552209978538}
[S7] START round=35 head_norm_before_train=1.403711 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5630510840763086, 'auprc': 0.7858298143459079, 'loss_val': 0.785170527735118, 'psi': 0.6521625761841483}-{'f1_val': 0.5696125732429571, 'auprc': 0.7877417476399996, 'loss_val': 0.7277811774097993, 'psi': 0.6568642430017742}
[S8] START round=35 head_norm_before_train=1.736149 cos_to_last_merge=0.7846 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.785
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.7135780681239317, 'auprc': 0.9818413056486109, 'loss_val': 0.5424799682920604, 'psi': 0.8208833631338034}-{'f1_val': 0.9913729870729182, 'auprc': 0.998769536748142, 'loss_val': 0.03919709930653849, 'psi': 0.9943316069430077}
[S9] START round=35 head_norm_before_train=1.702259 cos_to_last_merge=1.0000 (last merge round=34)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9958557717480525, 'auprc': 0.9986612919993667, 'loss_val': 0.032751304573583544, 'psi': 0.9969779798485782}-{'f1_val': 0.9971029125121428, 'auprc': 0.998746584507898, 'loss_val': 0.030337835957381792, 'psi': 0.9977603813104449}
[S10] START round=35 head_norm_before_train=1.479311 cos_to_last_merge=0.9606 (last merge round=23)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921625766400579, 'loss_val': 0.06496313094579127, 'psi': 0.993977734067648}-{'f1_val': 0.9952985899745774, 'auprc': 0.9965337148800337, 'loss_val': 0.06197608351562826, 'psi': 0.9957926399367599}
[S11] START round=35 head_norm_before_train=1.875440 cos_to_last_merge=0.8444 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.844
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9991207778401233, 'loss_val': 0.023927258379055637, 'psi': 0.9973407959824966}-{'f1_val': 0.9961541414107454, 'auprc': 0.9990865391285462, 'loss_val': 0.02274621113641568, 'psi': 0.9973271004978657}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.757950 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.57562430510591, 'auprc': 0.6941082117477939, 'loss_val': 1.043874852905322, 'psi': 0.6230178677626637}-{'f1_val': 0.590860608571422, 'auprc': 0.6919802771740352, 'loss_val': 0.8795799805740173, 'psi': 0.6313084760124672}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=2.066990 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9983645152748845, 'loss_val': 0.025274683227336874, 'psi': 0.9974141106142371}-{'f1_val': 0.9971680177638609, 'auprc': 0.9977294656954889, 'loss_val': 0.024933231018260726, 'psi': 0.997392596936512}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.429046 cos_to_last_merge=0.9992 (last merge round=32)
[S15] round=35 local utility u=0.404628 metrics={'f1_val': 0.9966196520233872, 'auprc': 0.9968667306968165, 'loss_val': 0.0734016148687615, 'psi': 0.9967184834927589}-{'f1_val': 0.8925912038657148, 'auprc': 0.9906511273972933, 'loss_val': 0.2398410920594015, 'psi': 0.9318151732783462}
[S16] START round=35 head_norm_before_train=1.809305 cos_to_last_merge=0.8260 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.826
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8557362131885942, 'auprc': 0.9783027659471086, 'loss_val': 0.825868756090806, 'psi': 0.904762834292}-{'f1_val': 0.9239810330960107, 'auprc': 0.9933943864314092, 'loss_val': 0.36031264701969185, 'psi': 0.9517463744301701}
[S17] START round=35 head_norm_before_train=1.745659 cos_to_last_merge=0.8142 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.814
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6384508266350457, 'auprc': 0.8313476275118199, 'loss_val': 1.162448583020801, 'psi': 0.7156095469857554}-{'f1_val': 0.6442566893428372, 'auprc': 0.8246379907388787, 'loss_val': 1.1553374455053764, 'psi': 0.7164092099012538}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:57002
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.219 → S9@127.0.0.1:57010
[S8] ⇄ pheromone p=0.131 → S3@127.0.0.1:57003
[S2] ⇄ pheromone p=0.124 → S4@127.0.0.1:57004
[S4] sending update (kind=head size=1792 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=0.166 → S6@127.0.0.1:57007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:57008
[S7] ⇄ pheromone p=0.155 → S15@127.0.0.1:57015
[S9] ⇄ pheromone p=0.009 → S5@127.0.0.1:57005
[S2] RECEIVED delta(kind=head bytes=1792) from S4
[S2] cosine check vs S4: cos=-0.0525
[S2] DROPPED delta from S4 (cos=-0.0525 < 0.0)
[S15] sending update (kind=head size=1802 to 1 peers)
[S4] ⇄ pheromone p=0.028 → S2@127.0.0.1:57002
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] cosine check vs S15: cos=0.9976
[S6] ⇄ pheromone p=0.342 → S16@127.0.0.1:57016
[S15] ⇄ pheromone p=0.246 → S7@127.0.0.1:57008
[S2] START round=36 head_norm_before_train=1.957881 (no previous merge yet)
[S2] round=36 local utility u=0.328892 metrics={'f1_val': 0.8255237006804561, 'auprc': 0.9311348729581584, 'loss_val': 0.30289985456138896, 'psi': 0.8677681695915371}-{'f1_val': 0.7156616655983694, 'auprc': 0.9720090362580432, 'loss_val': 0.42413315801010887, 'psi': 0.818200613862239}
[S3] START round=36 head_norm_before_train=1.984488 cos_to_last_merge=0.9592 (last merge round=22)
[S3] round=36 local utility u=0.415271 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9987205983613122, 'loss_val': 0.019488020801355296, 'psi': 0.9981742599051007}-{'f1_val': 0.8943589272967922, 'auprc': 0.9925175890793367, 'loss_val': 0.2107147118515603, 'psi': 0.9336223920098101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=36 head_norm_before_train=2.000603 (no previous merge yet)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9441240291102267, 'auprc': 0.972578167403615, 'loss_val': 0.23411363337185348, 'psi': 0.955505684427582}-{'f1_val': 0.9414540098592545, 'auprc': 0.9713423868506244, 'loss_val': 0.19654765551514186, 'psi': 0.9534093606558024}
[S5] START round=36 head_norm_before_train=1.714576 cos_to_last_merge=0.9999 (last merge round=34)
[S5] round=36 local utility u=0.967165 metrics={'f1_val': 0.9967280377725878, 'auprc': 0.9975579874801288, 'loss_val': 0.09288381955339793, 'psi': 0.9970600176556041}-{'f1_val': 0.7150597362695597, 'auprc': 0.9834417548278857, 'loss_val': 0.29485498245260994, 'psi': 0.82241254369289}
[S6] START round=36 head_norm_before_train=1.899623 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.663932422501974, 'auprc': 0.8104012042797255, 'loss_val': 0.7775794227686322, 'psi': 0.7225199352130747}-{'f1_val': 0.7921302261059564, 'auprc': 0.9562144632789601, 'loss_val': 0.4776127393714743, 'psi': 0.8577639209751579}
[S7] START round=36 head_norm_before_train=1.421046 cos_to_last_merge=0.9998 (last merge round=34)
[S7] round=36 local utility u=0.038215 metrics={'f1_val': 0.5698986063879539, 'auprc': 0.7868628180540568, 'loss_val': 0.7529251345097902, 'psi': 0.6566842910543951}-{'f1_val': 0.5630510840763086, 'auprc': 0.7858298143459079, 'loss_val': 0.785170527735118, 'psi': 0.6521625761841483}
[S8] START round=36 head_norm_before_train=1.746667 cos_to_last_merge=0.7845 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.785
[S8] round=36 local utility u=1.000000 metrics={'f1_val': 0.9931648515513533, 'auprc': 0.9983882001194224, 'loss_val': 0.03687034321310184, 'psi': 0.9952541909785809}-{'f1_val': 0.7135780681239317, 'auprc': 0.9818413056486109, 'loss_val': 0.5424799682920604, 'psi': 0.8208833631338034}
[S9] START round=36 head_norm_before_train=1.722120 cos_to_last_merge=0.9999 (last merge round=34)
[S9] round=36 local utility u=0.006381 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987580018745468, 'loss_val': 0.027762627239452112, 'psi': 0.9977649482571044}-{'f1_val': 0.9958557717480525, 'auprc': 0.9986612919993667, 'loss_val': 0.032751304573583544, 'psi': 0.9969779798485782}
[S10] START round=36 head_norm_before_train=1.499350 cos_to_last_merge=0.9581 (last merge round=23)
[S10] round=36 local utility u=0.011302 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9960277819067699, 'loss_val': 0.0534475447375018, 'psi': 0.995473193608367}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921625766400579, 'loss_val': 0.06496313094579127, 'psi': 0.993977734067648}
[S11] START round=36 head_norm_before_train=1.885111 cos_to_last_merge=0.8432 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.843
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9986796220625345, 'loss_val': 0.058450365282450525, 'psi': 0.9974145976922886}-{'f1_val': 0.9961541414107454, 'auprc': 0.9991207778401233, 'loss_val': 0.023927258379055637, 'psi': 0.9973407959824966}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.766627 (no previous merge yet)
[S13] round=36 local utility u=0.060965 metrics={'f1_val': 0.5780903740361552, 'auprc': 0.7019086974977162, 'loss_val': 0.9601426179880386, 'psi': 0.6276177034207795}-{'f1_val': 0.57562430510591, 'auprc': 0.6941082117477939, 'loss_val': 1.043874852905322, 'psi': 0.6230178677626637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=36 head_norm_before_train=2.076210 (no previous merge yet)
[S14] round=36 local utility u=0.003472 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9981780126415843, 'loss_val': 0.02153765183539141, 'psi': 0.997716166757669}-{'f1_val': 0.9967805075071389, 'auprc': 0.9983645152748845, 'loss_val': 0.025274683227336874, 'psi': 0.9974141106142371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=36 head_norm_before_train=1.455219 cos_to_last_merge=0.9985 (last merge round=32)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.9200370113069691, 'auprc': 0.9958340389877602, 'loss_val': 0.11743969548751233, 'psi': 0.9503558223792856}-{'f1_val': 0.9966196520233872, 'auprc': 0.9968667306968165, 'loss_val': 0.0734016148687615, 'psi': 0.9967184834927589}
[S16] START round=36 head_norm_before_train=1.820920 cos_to_last_merge=0.8252 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.825
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.8443668406630844, 'auprc': 0.9672245614143499, 'loss_val': 0.9516829867006056, 'psi': 0.8935099289635906}-{'f1_val': 0.8557362131885942, 'auprc': 0.9783027659471086, 'loss_val': 0.825868756090806, 'psi': 0.904762834292}
[S17] START round=36 head_norm_before_train=1.759937 cos_to_last_merge=0.8139 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.814
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5917997479312155, 'auprc': 0.794528995735877, 'loss_val': 1.4253433160452973, 'psi': 0.67289144705308}-{'f1_val': 0.6384508266350457, 'auprc': 0.8313476275118199, 'loss_val': 1.162448583020801, 'psi': 0.7156095469857554}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:57005
[S9] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] RECEIVED delta(kind=head bytes=1807) from S5
[S9] cosine check vs S5: cos=0.9994
[S3] RECEIVED delta(kind=head bytes=1803) from S8
[S3] cosine check vs S8: cos=-0.0891
[S3] DROPPED delta from S8 (cos=-0.0891 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] cosine check vs S7: cos=0.9964
[S4] RECEIVED delta(kind=head bytes=1795) from S2
[S4] cosine check vs S2: cos=-0.0527
[S4] DROPPED delta from S2 (cos=-0.0527 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S9
[S5] cosine check vs S9: cos=0.9994
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=36 metric=0.5699 head_norm=1.434652
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.389069e-02
[S7] stored merged vector for next round verification (round=36)
[S7] DEBUG after merge:  round=36 metric=0.5722 head_norm=1.443967 delta_norm=0.053891
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=36 metric=0.9967 head_norm=1.722771
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.146153e-02
[S5] stored merged vector for next round verification (round=36)
[S5] DEBUG after merge:  round=36 metric=0.9967 head_norm=1.730781 delta_norm=0.031462
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=36 metric=0.9971 head_norm=1.739324
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.146153e-02
[S9] stored merged vector for next round verification (round=36)
[S9] DEBUG after merge:  round=36 metric=0.9971 head_norm=1.730781 delta_norm=0.031462
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.9200 head_norm=1.481302
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.638998e-02
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.9150 head_norm=1.456651 delta_norm=0.066390
[S15] aggregate: ROLLBACK (f1_val pre=0.920 post=0.915 tol_abs=0.005 tol_rel=0.0)
[S2] START round=37 head_norm_before_train=1.971224 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.8270775629050464, 'auprc': 0.930537254347505, 'loss_val': 0.3177327804879582, 'psi': 0.8684614394820298}-{'f1_val': 0.8255237006804561, 'auprc': 0.9311348729581584, 'loss_val': 0.30289985456138896, 'psi': 0.8677681695915371}
[S3] START round=37 head_norm_before_train=1.997377 cos_to_last_merge=0.9579 (last merge round=22)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9516094519048026, 'auprc': 0.9983469816003445, 'loss_val': 0.15484492228408678, 'psi': 0.9703044637830194}-{'f1_val': 0.9978100342676263, 'auprc': 0.9987205983613122, 'loss_val': 0.019488020801355296, 'psi': 0.9981742599051007}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=2.009011 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9420225952317174, 'auprc': 0.9589114367583119, 'loss_val': 0.2228202973897027, 'psi': 0.9487781318423552}-{'f1_val': 0.9441240291102267, 'auprc': 0.972578167403615, 'loss_val': 0.23411363337185348, 'psi': 0.955505684427582}
[S5] START round=37 head_norm_before_train=1.730781 cos_to_last_merge=1.0000 (last merge round=36)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.8318008732747625, 'auprc': 0.9882770637970505, 'loss_val': 0.20846793607085065, 'psi': 0.8943913494836777}-{'f1_val': 0.9967280377725878, 'auprc': 0.9975579874801288, 'loss_val': 0.09288381955339793, 'psi': 0.9970600176556041}
[S6] START round=37 head_norm_before_train=1.908216 (no previous merge yet)
[S6] round=37 local utility u=0.892445 metrics={'f1_val': 0.8203650484314211, 'auprc': 0.9509781471194158, 'loss_val': 0.35301655181483466, 'psi': 0.8726102879066189}-{'f1_val': 0.663932422501974, 'auprc': 0.8104012042797255, 'loss_val': 0.7775794227686322, 'psi': 0.7225199352130747}
[S7] START round=37 head_norm_before_train=1.443967 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5112780561007222, 'auprc': 0.7797839818641308, 'loss_val': 0.9248799415100688, 'psi': 0.6186804264060857}-{'f1_val': 0.5698986063879539, 'auprc': 0.7868628180540568, 'loss_val': 0.7529251345097902, 'psi': 0.6566842910543951}
[S8] START round=37 head_norm_before_train=1.753225 cos_to_last_merge=0.7840 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.784
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9487658713557141, 'auprc': 0.9990888278734229, 'loss_val': 0.13339380457871555, 'psi': 0.9688950539627976}-{'f1_val': 0.9931648515513533, 'auprc': 0.9983882001194224, 'loss_val': 0.03687034321310184, 'psi': 0.9952541909785809}
[S9] START round=37 head_norm_before_train=1.730781 cos_to_last_merge=1.0000 (last merge round=36)
[S9] round=37 local utility u=0.001490 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.998754666886227, 'loss_val': 0.027424270444518797, 'psi': 0.9980288007608771}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987580018745468, 'loss_val': 0.027762627239452112, 'psi': 0.9977649482571044}
[S10] START round=37 head_norm_before_train=1.520595 cos_to_last_merge=0.9557 (last merge round=23)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921190757596321, 'loss_val': 0.05325350952497691, 'psi': 0.9939603337154777}-{'f1_val': 0.9951034680760983, 'auprc': 0.9960277819067699, 'loss_val': 0.0534475447375018, 'psi': 0.995473193608367}
[S11] START round=37 head_norm_before_train=1.894189 cos_to_last_merge=0.8421 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.842
[S11] round=37 local utility u=0.017436 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9991284426057205, 'loss_val': 0.022422225060003378, 'psi': 0.9973438618887355}-{'f1_val': 0.9965712481121245, 'auprc': 0.9986796220625345, 'loss_val': 0.058450365282450525, 'psi': 0.9974145976922886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=37 head_norm_before_train=1.764562 (no previous merge yet)
[S13] round=37 local utility u=0.141011 metrics={'f1_val': 0.5993515020913607, 'auprc': 0.6897142905640474, 'loss_val': 0.769103954495193, 'psi': 0.6354966174804353}-{'f1_val': 0.5780903740361552, 'auprc': 0.7019086974977162, 'loss_val': 0.9601426179880386, 'psi': 0.6276177034207795}
[S13] not sending this round → trigger blocked (psi=0.635)
[S14] START round=37 head_norm_before_train=2.084961 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9408191126826042, 'auprc': 0.9960973137736161, 'loss_val': 0.08702926522888646, 'psi': 0.962930393119009}-{'f1_val': 0.9974082695017256, 'auprc': 0.9981780126415843, 'loss_val': 0.02153765183539141, 'psi': 0.997716166757669}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.456651 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.9011788291299299, 'auprc': 0.9931821924874917, 'loss_val': 0.20537619100159563, 'psi': 0.9379801744729546}-{'f1_val': 0.9200370113069691, 'auprc': 0.9958340389877602, 'loss_val': 0.11743969548751233, 'psi': 0.9503558223792856}
[S16] START round=37 head_norm_before_train=1.831712 cos_to_last_merge=0.8245 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.825
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8118433262494411, 'auprc': 0.9418323783896658, 'loss_val': 0.8283687023064812, 'psi': 0.863838947105531}-{'f1_val': 0.8443668406630844, 'auprc': 0.9672245614143499, 'loss_val': 0.9516829867006056, 'psi': 0.8935099289635906}
[S17] START round=37 head_norm_before_train=1.770746 cos_to_last_merge=0.8133 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.5818956460148395, 'auprc': 0.7972087619224753, 'loss_val': 1.419846723562834, 'psi': 0.6680208923778939}-{'f1_val': 0.5917997479312155, 'auprc': 0.794528995735877, 'loss_val': 1.4253433160452973, 'psi': 0.67289144705308}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.998)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:57016
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S6
[S16] cosine check vs S6: cos=-0.0345
[S16] DROPPED delta from S6 (cos=-0.0345 < 0.0)
[S2] START round=38 head_norm_before_train=1.981748 (no previous merge yet)
[S2] round=38 local utility u=0.002413 metrics={'f1_val': 0.8272809153149181, 'auprc': 0.9319605168850484, 'loss_val': 0.3183963613344408, 'psi': 0.8691527559429703}-{'f1_val': 0.8270775629050464, 'auprc': 0.930537254347505, 'loss_val': 0.3177327804879582, 'psi': 0.8684614394820298}
[S3] START round=38 head_norm_before_train=2.009203 cos_to_last_merge=0.9567 (last merge round=22)
[S3] round=38 local utility u=0.205616 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9985910991258349, 'loss_val': 0.01890718961764061, 'psi': 0.9978582582453863}-{'f1_val': 0.9516094519048026, 'auprc': 0.9983469816003445, 'loss_val': 0.15484492228408678, 'psi': 0.9703044637830194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=38 head_norm_before_train=2.018271 (no previous merge yet)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9408798288371841, 'auprc': 0.9450060719965503, 'loss_val': 0.208036893647457, 'psi': 0.9425303261009306}-{'f1_val': 0.9420225952317174, 'auprc': 0.9589114367583119, 'loss_val': 0.2228202973897027, 'psi': 0.9487781318423552}
[S5] START round=38 head_norm_before_train=1.735710 cos_to_last_merge=1.0000 (last merge round=36)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.7541942904834094, 'auprc': 0.9791459046551018, 'loss_val': 0.29726883886046346, 'psi': 0.8441749361520863}-{'f1_val': 0.8318008732747625, 'auprc': 0.9882770637970505, 'loss_val': 0.20846793607085065, 'psi': 0.8943913494836777}
[S6] START round=38 head_norm_before_train=1.916539 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.8091509030721773, 'auprc': 0.9471336441662037, 'loss_val': 0.4872386656199722, 'psi': 0.8643439995097879}-{'f1_val': 0.8203650484314211, 'auprc': 0.9509781471194158, 'loss_val': 0.35301655181483466, 'psi': 0.8726102879066189}
[S7] START round=38 head_norm_before_train=1.454058 cos_to_last_merge=0.9999 (last merge round=36)
[S7] round=38 local utility u=0.345208 metrics={'f1_val': 0.5907440586602697, 'auprc': 0.7868348951560078, 'loss_val': 0.7324123258114315, 'psi': 0.6691803932585649}-{'f1_val': 0.5112780561007222, 'auprc': 0.7797839818641308, 'loss_val': 0.9248799415100688, 'psi': 0.6186804264060857}
[S8] START round=38 head_norm_before_train=1.759631 cos_to_last_merge=0.7826 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.783
[S8] round=38 local utility u=0.116147 metrics={'f1_val': 0.9831512712398986, 'auprc': 0.9872276048546311, 'loss_val': 0.07182911329791593, 'psi': 0.9847818046857917}-{'f1_val': 0.9487658713557141, 'auprc': 0.9990888278734229, 'loss_val': 0.13339380457871555, 'psi': 0.9688950539627976}
[S9] START round=38 head_norm_before_train=1.743811 cos_to_last_merge=1.0000 (last merge round=36)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9987561025513314, 'loss_val': 0.028512775650857823, 'psi': 0.9972650584587762}-{'f1_val': 0.9975448900106438, 'auprc': 0.998754666886227, 'loss_val': 0.027424270444518797, 'psi': 0.9980288007608771}
[S10] START round=38 head_norm_before_train=1.541103 cos_to_last_merge=0.9534 (last merge round=23)
[S10] round=38 local utility u=0.006745 metrics={'f1_val': 0.9944204775781598, 'auprc': 0.9965738621424935, 'loss_val': 0.04852426058359867, 'psi': 0.9952818314038933}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921190757596321, 'loss_val': 0.05325350952497691, 'psi': 0.9939603337154777}
[S11] START round=38 head_norm_before_train=1.902447 cos_to_last_merge=0.8410 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.841
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9988133457734183, 'loss_val': 0.04086037542462587, 'psi': 0.997468087176642}-{'f1_val': 0.9961541414107454, 'auprc': 0.9991284426057205, 'loss_val': 0.022422225060003378, 'psi': 0.9973438618887355}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.766861 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5277179246789316, 'auprc': 0.6957520459906266, 'loss_val': 1.0476787170285735, 'psi': 0.5949315732036096}-{'f1_val': 0.5993515020913607, 'auprc': 0.6897142905640474, 'loss_val': 0.769103954495193, 'psi': 0.6354966174804353}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=2.095273 (no previous merge yet)
[S14] round=38 local utility u=0.206596 metrics={'f1_val': 0.9975994502496334, 'auprc': 0.9991369748973029, 'loss_val': 0.02363787809377259, 'psi': 0.9982144601087011}-{'f1_val': 0.9408191126826042, 'auprc': 0.9960973137736161, 'loss_val': 0.08702926522888646, 'psi': 0.962930393119009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=38 head_norm_before_train=1.478346 cos_to_last_merge=0.9999 (last merge round=36)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.8976830179802231, 'auprc': 0.9931307669914454, 'loss_val': 0.2368972069949441, 'psi': 0.935862117584712}-{'f1_val': 0.9011788291299299, 'auprc': 0.9931821924874917, 'loss_val': 0.20537619100159563, 'psi': 0.9379801744729546}
[S16] START round=38 head_norm_before_train=1.841710 cos_to_last_merge=0.8239 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.824
[S16] round=38 local utility u=0.289232 metrics={'f1_val': 0.8705508604307338, 'auprc': 0.9773332874275388, 'loss_val': 0.708651923572327, 'psi': 0.9132638312294559}-{'f1_val': 0.8118433262494411, 'auprc': 0.9418323783896658, 'loss_val': 0.8283687023064812, 'psi': 0.863838947105531}
[S17] START round=38 head_norm_before_train=1.779623 cos_to_last_merge=0.8121 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=38 local utility u=0.394000 metrics={'f1_val': 0.6172908707520659, 'auprc': 0.8661911787727066, 'loss_val': 1.0511644012815122, 'psi': 0.7168509939603223}-{'f1_val': 0.5818956460148395, 'auprc': 0.7972087619224753, 'loss_val': 1.419846723562834, 'psi': 0.6680208923778939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:57003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:57007
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:57004
[S7] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=-0.0895
[S3] DROPPED delta from S8 (cos=-0.0895 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S7
[S15] cosine check vs S7: cos=0.9992
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=-0.0532
[S4] DROPPED delta from S2 (cos=-0.0532 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] cosine check vs S16: cos=-0.0353
[S6] DROPPED delta from S16 (cos=-0.0353 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.8977 head_norm=1.502230
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.463086e-02
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.8977 head_norm=1.482870 delta_norm=0.034631
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.993664 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.8129988199607754, 'auprc': 0.9461670323959572, 'loss_val': 0.3813587627961827, 'psi': 0.8662661049348481}-{'f1_val': 0.8272809153149181, 'auprc': 0.9319605168850484, 'loss_val': 0.3183963613344408, 'psi': 0.8691527559429703}
[S3] START round=39 head_norm_before_train=2.015630 cos_to_last_merge=0.9558 (last merge round=22)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9746816052812316, 'auprc': 0.9988234200300057, 'loss_val': 0.06275365616275791, 'psi': 0.9843383311807412}-{'f1_val': 0.9973696976584205, 'auprc': 0.9985910991258349, 'loss_val': 0.01890718961764061, 'psi': 0.9978582582453863}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.984 u=0.0000 p_local=0.0910 f1=0.975 auprc=0.999 bytes=43183
[S4] START round=39 head_norm_before_train=2.026018 (no previous merge yet)
[S4] round=39 local utility u=0.010464 metrics={'f1_val': 0.9418331493458874, 'auprc': 0.9553801853581206, 'loss_val': 0.22395203805955324, 'psi': 0.9472519637507807}-{'f1_val': 0.9408798288371841, 'auprc': 0.9450060719965503, 'loss_val': 0.208036893647457, 'psi': 0.9425303261009306}
[S5] START round=39 head_norm_before_train=1.739461 cos_to_last_merge=0.9999 (last merge round=36)
[S5] round=39 local utility u=0.859237 metrics={'f1_val': 0.9946556757733153, 'auprc': 0.993458151919141, 'loss_val': 0.06449927179975616, 'psi': 0.9941766662316456}-{'f1_val': 0.7541942904834094, 'auprc': 0.9791459046551018, 'loss_val': 0.29726883886046346, 'psi': 0.8441749361520863}
[S6] START round=39 head_norm_before_train=1.922847 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.5978094736815813, 'auprc': 0.8038953187649275, 'loss_val': 0.926877101173758, 'psi': 0.6802438117149199}-{'f1_val': 0.8091509030721773, 'auprc': 0.9471336441662037, 'loss_val': 0.4872386656199722, 'psi': 0.8643439995097879}
[S7] START round=39 head_norm_before_train=1.464074 cos_to_last_merge=0.9998 (last merge round=36)
[S7] round=39 local utility u=0.134280 metrics={'f1_val': 0.6150272245473616, 'auprc': 0.7942728425331997, 'loss_val': 0.6318645950673903, 'psi': 0.6867254717416968}-{'f1_val': 0.5907440586602697, 'auprc': 0.7868348951560078, 'loss_val': 0.7324123258114315, 'psi': 0.6691803932585649}
[S8] START round=39 head_norm_before_train=1.763505 cos_to_last_merge=0.7827 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.783
[S8] round=39 local utility u=0.055477 metrics={'f1_val': 0.990427915806497, 'auprc': 0.998941442532951, 'loss_val': 0.039675926623107316, 'psi': 0.9938333264970787}-{'f1_val': 0.9831512712398986, 'auprc': 0.9872276048546311, 'loss_val': 0.07182911329791593, 'psi': 0.9847818046857917}
[S9] START round=39 head_norm_before_train=1.755736 cos_to_last_merge=0.9999 (last merge round=36)
[S9] round=39 local utility u=0.003220 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9982101556324703, 'loss_val': 0.025427121974333233, 'psi': 0.9975458097602738}-{'f1_val': 0.9962710290637395, 'auprc': 0.9987561025513314, 'loss_val': 0.028512775650857823, 'psi': 0.9972650584587762}
[S10] START round=39 head_norm_before_train=1.559672 cos_to_last_merge=0.9515 (last merge round=23)
[S10] round=39 local utility u=0.001016 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.995675061786452, 'loss_val': 0.0457636610926678, 'psi': 0.9951191902462043}-{'f1_val': 0.9944204775781598, 'auprc': 0.9965738621424935, 'loss_val': 0.04852426058359867, 'psi': 0.9952818314038933}
[S11] START round=39 head_norm_before_train=1.910907 cos_to_last_merge=0.8399 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.840
[S11] round=39 local utility u=0.010018 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9989583882655722, 'loss_val': 0.021113486235451256, 'psi': 0.9975115580143826}-{'f1_val': 0.9965712481121245, 'auprc': 0.9988133457734183, 'loss_val': 0.04086037542462587, 'psi': 0.997468087176642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S11] r=40 psi=0.998 u=0.0100 p_local=0.0060 f1=0.997 auprc=0.999 bytes=53952
[S13] START round=39 head_norm_before_train=1.771732 (no previous merge yet)
[S13] round=39 local utility u=0.268555 metrics={'f1_val': 0.5767073365157452, 'auprc': 0.6929032920410567, 'loss_val': 0.79595872103015, 'psi': 0.6231857187258698}-{'f1_val': 0.5277179246789316, 'auprc': 0.6957520459906266, 'loss_val': 1.0476787170285735, 'psi': 0.5949315732036096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S13] r=40 psi=0.623 u=0.2686 p_local=0.0919 f1=0.577 auprc=0.693 bytes=37872
[S14] START round=39 head_norm_before_train=2.105095 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9969706583433163, 'auprc': 0.9992001990143774, 'loss_val': 0.022467565362560706, 'psi': 0.9978624746117408}-{'f1_val': 0.9975994502496334, 'auprc': 0.9991369748973029, 'loss_val': 0.02363787809377259, 'psi': 0.9982144601087011}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.998 u=0.0000 p_local=0.0393 f1=0.997 auprc=0.999 bytes=48606
[S15] START round=39 head_norm_before_train=1.482870 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.389019 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.994684573371724, 'loss_val': 0.05790308930673771, 'psi': 0.995921830381202}-{'f1_val': 0.8976830179802231, 'auprc': 0.9931307669914454, 'loss_val': 0.2368972069949441, 'psi': 0.935862117584712}
[S16] START round=39 head_norm_before_train=1.850540 cos_to_last_merge=0.8233 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.823
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.849218063236525, 'auprc': 0.9307502553214337, 'loss_val': 0.9300155896327111, 'psi': 0.8818309400704885}-{'f1_val': 0.8705508604307338, 'auprc': 0.9773332874275388, 'loss_val': 0.708651923572327, 'psi': 0.9132638312294559}
[S17] START round=39 head_norm_before_train=1.786927 cos_to_last_merge=0.8114 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6001408935421474, 'auprc': 0.8303423698429978, 'loss_val': 1.1608988581344293, 'psi': 0.6922214840624876}-{'f1_val': 0.6172908707520659, 'auprc': 0.8661911787727066, 'loss_val': 1.0511644012815122, 'psi': 0.7168509939603223}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.692 u=0.0000 p_local=0.0745 f1=0.600 auprc=0.830 bytes=35973
[S7] not sending this round → trigger blocked (psi=0.687)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:57005
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:57002
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.994)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.882 u=0.0000 p_local=0.1142 f1=0.849 auprc=0.931 bytes=43168
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:57008
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S2] r=40 psi=0.866 u=0.0000 p_local=0.0850 f1=0.813 auprc=0.946 bytes=39585
[S9] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.994 u=0.0555 p_local=0.1859 f1=0.990 auprc=0.999 bytes=44948
[S10] r=40 psi=0.995 u=0.0010 p_local=0.0067 f1=0.995 auprc=0.996 bytes=53970
[S7] r=40 psi=0.687 u=0.1343 p_local=0.1493 f1=0.615 auprc=0.794 bytes=43172
[S9] RECEIVED delta(kind=head bytes=1805) from S5
[S9] cosine check vs S5: cos=0.9995
[S2] RECEIVED delta(kind=head bytes=1793) from S4
[S2] cosine check vs S4: cos=-0.0529
[S2] DROPPED delta from S4 (cos=-0.0529 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S9
[S5] cosine check vs S9: cos=0.9995
[S4] r=40 psi=0.947 u=0.0105 p_local=0.0136 f1=0.942 auprc=0.955 bytes=37759
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=39 metric=0.9971 head_norm=1.770358
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.136924e-02
[S9] stored merged vector for next round verification (round=39)
[S9] DEBUG after merge:  round=39 metric=0.9971 head_norm=1.755480 delta_norm=0.031369
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] r=40 psi=0.998 u=0.0032 p_local=0.0052 f1=0.997 auprc=0.998 bytes=41424
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=39 metric=0.9947 head_norm=1.741040
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.136924e-02
[S5] stored merged vector for next round verification (round=39)
[S5] DEBUG after merge:  round=39 metric=0.9926 head_norm=1.755480 delta_norm=0.031369
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] r=40 psi=0.994 u=0.8592 p_local=0.3605 f1=0.995 auprc=0.993 bytes=43199
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] cosine check vs S15: cos=0.9994
[S6] r=40 psi=0.680 u=0.0000 p_local=0.2544 f1=0.598 auprc=0.804 bytes=39582
[S15] r=40 psi=0.996 u=0.3890 p_local=0.1785 f1=0.997 auprc=0.995 bytes=36012
[S2] START round=40 head_norm_before_train=2.005249 (no previous merge yet)
[S2] round=40 local utility u=0.150436 metrics={'f1_val': 0.8640587443695211, 'auprc': 0.9072659918310015, 'loss_val': 0.27014234359739414, 'psi': 0.8813416433541134}-{'f1_val': 0.8129988199607754, 'auprc': 0.9461670323959572, 'loss_val': 0.3813587627961827, 'psi': 0.8662661049348481}
[S3] START round=40 head_norm_before_train=2.023320 cos_to_last_merge=0.9549 (last merge round=22)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.8583688206388813, 'auprc': 0.9980251964123252, 'loss_val': 0.20205181978726947, 'psi': 0.9142313709482588}-{'f1_val': 0.9746816052812316, 'auprc': 0.9988234200300057, 'loss_val': 0.06275365616275791, 'psi': 0.9843383311807412}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=2.032831 (no previous merge yet)
[S4] round=40 local utility u=0.012655 metrics={'f1_val': 0.9437466576471761, 'auprc': 0.968612516195623, 'loss_val': 0.2498204286025848, 'psi': 0.953693001066555}-{'f1_val': 0.9418331493458874, 'auprc': 0.9553801853581206, 'loss_val': 0.22395203805955324, 'psi': 0.9472519637507807}
[S5] START round=40 head_norm_before_train=1.755480 cos_to_last_merge=1.0000 (last merge round=39)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.9857699432506757, 'auprc': 0.9928586873138762, 'loss_val': 0.0678574555218537, 'psi': 0.9886054408759558}-{'f1_val': 0.9946556757733153, 'auprc': 0.993458151919141, 'loss_val': 0.06449927179975616, 'psi': 0.9941766662316456}
[S6] START round=40 head_norm_before_train=1.927993 (no previous merge yet)
[S6] round=40 local utility u=0.929384 metrics={'f1_val': 0.7689225336574772, 'auprc': 0.9597060965687466, 'loss_val': 0.5622201326248354, 'psi': 0.8452359588219849}-{'f1_val': 0.5978094736815813, 'auprc': 0.8038953187649275, 'loss_val': 0.926877101173758, 'psi': 0.6802438117149199}
[S7] START round=40 head_norm_before_train=1.476809 cos_to_last_merge=0.9996 (last merge round=36)
[S7] round=40 local utility u=0.033710 metrics={'f1_val': 0.6185358930857813, 'auprc': 0.7990241340477122, 'loss_val': 0.5997497741194555, 'psi': 0.6907311894705537}-{'f1_val': 0.6150272245473616, 'auprc': 0.7942728425331997, 'loss_val': 0.6318645950673903, 'psi': 0.6867254717416968}
[S8] START round=40 head_norm_before_train=1.768004 cos_to_last_merge=0.7826 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.783
[S8] round=40 local utility u=0.010869 metrics={'f1_val': 0.9931022471969293, 'auprc': 0.998614003509622, 'loss_val': 0.03300254221776456, 'psi': 0.9953069497220064}-{'f1_val': 0.990427915806497, 'auprc': 0.998941442532951, 'loss_val': 0.039675926623107316, 'psi': 0.9938333264970787}
[S9] START round=40 head_norm_before_train=1.755480 cos_to_last_merge=1.0000 (last merge round=39)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9931032914010764, 'auprc': 0.9986404702462721, 'loss_val': 0.03408358536923163, 'psi': 0.9953181629391548}-{'f1_val': 0.9971029125121428, 'auprc': 0.9982101556324703, 'loss_val': 0.025427121974333233, 'psi': 0.9975458097602738}
[S10] START round=40 head_norm_before_train=1.575412 cos_to_last_merge=0.9497 (last merge round=23)
[S10] ⚠️ Model drifted since last merge! cos=0.950
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9920648469550997, 'loss_val': 0.04463747932481562, 'psi': 0.9939386421936647}-{'f1_val': 0.9947486092193725, 'auprc': 0.995675061786452, 'loss_val': 0.0457636610926678, 'psi': 0.9951191902462043}
[S11] START round=40 head_norm_before_train=1.921002 cos_to_last_merge=0.8391 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.839
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9984364333455154, 'loss_val': 0.0214952875233837, 'psi': 0.9973027760463599}-{'f1_val': 0.9965470045135896, 'auprc': 0.9989583882655722, 'loss_val': 0.021113486235451256, 'psi': 0.9975115580143826}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.776027 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.562683945451281, 'auprc': 0.7040483380372252, 'loss_val': 1.0283246435305382, 'psi': 0.6192297024856587}-{'f1_val': 0.5767073365157452, 'auprc': 0.6929032920410567, 'loss_val': 0.79595872103015, 'psi': 0.6231857187258698}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=2.108687 (no previous merge yet)
[S14] round=40 local utility u=0.002200 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9989979328880403, 'loss_val': 0.02010186394168572, 'psi': 0.9980457697159131}-{'f1_val': 0.9969706583433163, 'auprc': 0.9992001990143774, 'loss_val': 0.022467565362560706, 'psi': 0.9978624746117408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=40 head_norm_before_train=1.506938 cos_to_last_merge=0.9999 (last merge round=38)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7187325666880624, 'auprc': 0.9909668063237556, 'loss_val': 0.3517843929537109, 'psi': 0.8276262625423396}-{'f1_val': 0.9967466683875206, 'auprc': 0.994684573371724, 'loss_val': 0.05790308930673771, 'psi': 0.995921830381202}
[S16] START round=40 head_norm_before_train=1.857681 cos_to_last_merge=0.8229 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.823
[S16] round=40 local utility u=0.868233 metrics={'f1_val': 0.9699191063111201, 'auprc': 0.991132806136916, 'loss_val': 0.09890315735115884, 'psi': 0.9784045862414386}-{'f1_val': 0.849218063236525, 'auprc': 0.9307502553214337, 'loss_val': 0.9300155896327111, 'psi': 0.8818309400704885}
[S17] START round=40 head_norm_before_train=1.792259 cos_to_last_merge=0.8110 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=40 local utility u=0.349522 metrics={'f1_val': 0.6313014060000179, 'auprc': 0.9077800223391448, 'loss_val': 0.8811311712967885, 'psi': 0.7418928525356687}-{'f1_val': 0.6001408935421474, 'auprc': 0.8303423698429978, 'loss_val': 1.1608988581344293, 'psi': 0.6922214840624876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S10]  timeout peer S7
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] not sending this round → trigger blocked (psi=0.954)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:57004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:57015
[S2] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:57016
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.288 → S9@127.0.0.1:57010
[S9] ⇄ pheromone p=0.004 → S5@127.0.0.1:57005
[S4] ⇄ pheromone p=0.013 → S2@127.0.0.1:57002
[S15] RECEIVED delta(kind=head bytes=1801) from S7
[S15] cosine check vs S7: cos=0.9988
[S4] RECEIVED delta(kind=head bytes=1796) from S2
[S4] cosine check vs S2: cos=-0.0525
[S4] DROPPED delta from S2 (cos=-0.0525 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] cosine check vs S16: cos=-0.0363
[S6] DROPPED delta from S16 (cos=-0.0363 < 0.0)
[S6] sending update (kind=head size=1802 to 1 peers)
[S2] ⇄ pheromone p=0.098 → S4@127.0.0.1:57004
[S16] ⇄ pheromone p=0.265 → S6@127.0.0.1:57007
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=40 metric=0.6185 head_norm=1.490619
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.211704e-02
[S7] stored merged vector for next round verification (round=40)
[S7] DEBUG after merge:  round=40 metric=0.6182 head_norm=1.498456 delta_norm=0.032117
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.126 → S15@127.0.0.1:57015
[S16] RECEIVED delta(kind=head bytes=1802) from S6
[S16] cosine check vs S6: cos=-0.0363
[S16] DROPPED delta from S6 (cos=-0.0363 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=40 metric=0.7187 head_norm=1.528882
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.217714e-02
[S15] stored merged vector for next round verification (round=40)
[S15] DEBUG after merge:  round=40 metric=0.7187 head_norm=1.509282 delta_norm=0.042177
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.143 → S7@127.0.0.1:57008
[S6] ⇄ pheromone p=0.389 → S16@127.0.0.1:57016
[S2] START round=41 head_norm_before_train=2.015058 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.8288250616624077, 'auprc': 0.9318595951789798, 'loss_val': 0.3275167156846762, 'psi': 0.8700388750690365}-{'f1_val': 0.8640587443695211, 'auprc': 0.9072659918310015, 'loss_val': 0.27014234359739414, 'psi': 0.8813416433541134}
[S3] START round=41 head_norm_before_train=2.033752 cos_to_last_merge=0.9537 (last merge round=22)
[S3] round=41 local utility u=0.343842 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9987181375929086, 'loss_val': 0.13268395794215088, 'psi': 0.9761323062768357}-{'f1_val': 0.8583688206388813, 'auprc': 0.9980251964123252, 'loss_val': 0.20205181978726947, 'psi': 0.9142313709482588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=41 head_norm_before_train=2.038686 (no previous merge yet)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.941614304897894, 'auprc': 0.9545008013664553, 'loss_val': 0.22513041082205418, 'psi': 0.9467689034853186}-{'f1_val': 0.9437466576471761, 'auprc': 0.968612516195623, 'loss_val': 0.2498204286025848, 'psi': 0.953693001066555}
[S5] START round=41 head_norm_before_train=1.760975 cos_to_last_merge=0.9999 (last merge round=39)
[S5] round=41 local utility u=0.044754 metrics={'f1_val': 0.9962536157793602, 'auprc': 0.9994086583355876, 'loss_val': 0.06090212295705185, 'psi': 0.9975156328018512}-{'f1_val': 0.9857699432506757, 'auprc': 0.9928586873138762, 'loss_val': 0.0678574555218537, 'psi': 0.9886054408759558}
[S6] START round=41 head_norm_before_train=1.935157 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.7278033270196754, 'auprc': 0.9555541395304279, 'loss_val': 0.6526640676953948, 'psi': 0.8189036520239764}-{'f1_val': 0.7689225336574772, 'auprc': 0.9597060965687466, 'loss_val': 0.5622201326248354, 'psi': 0.8452359588219849}
[S7] START round=41 head_norm_before_train=1.498456 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=41 local utility u=0.505022 metrics={'f1_val': 0.6913771803394029, 'auprc': 0.8877462183812375, 'loss_val': 0.2929205954969175, 'psi': 0.7699247955561367}-{'f1_val': 0.6185358930857813, 'auprc': 0.7990241340477122, 'loss_val': 0.5997497741194555, 'psi': 0.6907311894705537}
[S8] START round=41 head_norm_before_train=1.776491 cos_to_last_merge=0.7819 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.782
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9927378939946618, 'auprc': 0.9985057811318173, 'loss_val': 0.03372025582341746, 'psi': 0.995045048849524}-{'f1_val': 0.9931022471969293, 'auprc': 0.998614003509622, 'loss_val': 0.03300254221776456, 'psi': 0.9953069497220064}
[S9] START round=41 head_norm_before_train=1.770684 cos_to_last_merge=1.0000 (last merge round=39)
[S9] round=41 local utility u=0.017837 metrics={'f1_val': 0.9972945621169176, 'auprc': 0.998846430988946, 'loss_val': 0.024174096784926213, 'psi': 0.997915309665729}-{'f1_val': 0.9931032914010764, 'auprc': 0.9986404702462721, 'loss_val': 0.03408358536923163, 'psi': 0.9953181629391548}
[S10] START round=41 head_norm_before_train=1.589452 cos_to_last_merge=0.9482 (last merge round=23)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=41 local utility u=0.004268 metrics={'f1_val': 0.9942851896505369, 'auprc': 0.996456559552483, 'loss_val': 0.04386044626019781, 'psi': 0.9951537376113153}-{'f1_val': 0.9951878390193748, 'auprc': 0.9920648469550997, 'loss_val': 0.04463747932481562, 'psi': 0.9939386421936647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=41 head_norm_before_train=1.931115 cos_to_last_merge=0.8384 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.838
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9984336986053057, 'loss_val': 0.021526006804306823, 'psi': 0.997301682150276}-{'f1_val': 0.9965470045135896, 'auprc': 0.9984364333455154, 'loss_val': 0.0214952875233837, 'psi': 0.9973027760463599}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.780617 (no previous merge yet)
[S13] round=41 local utility u=0.164462 metrics={'f1_val': 0.5831282338446803, 'auprc': 0.7232493892960421, 'loss_val': 0.8796694199599032, 'psi': 0.639176696025225}-{'f1_val': 0.562683945451281, 'auprc': 0.7040483380372252, 'loss_val': 1.0283246435305382, 'psi': 0.6192297024856587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=41 head_norm_before_train=2.114812 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9968214666600486, 'loss_val': 0.02402885021014909, 'psi': 0.9974070928199561}-{'f1_val': 0.9974109942678281, 'auprc': 0.9989979328880403, 'loss_val': 0.02010186394168572, 'psi': 0.9980457697159131}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.509282 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=41 local utility u=0.987806 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9965408121316465, 'loss_val': 0.06097823619260081, 'psi': 0.996664325885171}-{'f1_val': 0.7187325666880624, 'auprc': 0.9909668063237556, 'loss_val': 0.3517843929537109, 'psi': 0.8276262625423396}
[S16] START round=41 head_norm_before_train=1.862563 cos_to_last_merge=0.8221 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.822
[S16] round=41 local utility u=0.099650 metrics={'f1_val': 0.9925941054199462, 'auprc': 0.9901856271864813, 'loss_val': 0.03281204127294155, 'psi': 0.9916307141265601}-{'f1_val': 0.9699191063111201, 'auprc': 0.991132806136916, 'loss_val': 0.09890315735115884, 'psi': 0.9784045862414386}
[S17] START round=41 head_norm_before_train=1.797914 cos_to_last_merge=0.8108 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6056239696281283, 'auprc': 0.8508885195165858, 'loss_val': 0.9720127384909589, 'psi': 0.7037297895835113}-{'f1_val': 0.6313014060000179, 'auprc': 0.9077800223391448, 'loss_val': 0.8811311712967885, 'psi': 0.7418928525356687}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.770)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:57005
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.992)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:57010
[S9] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:57008
[S5] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S5
[S9] cosine check vs S5: cos=0.9995
[S5] RECEIVED delta(kind=head bytes=1802) from S9
[S5] cosine check vs S9: cos=0.9995
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=41 metric=0.9963 head_norm=1.772681
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.756397e-02
[S5] stored merged vector for next round verification (round=41)
[S5] DEBUG after merge:  round=41 metric=0.9963 head_norm=1.778821 delta_norm=0.027564
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1804 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=41 metric=0.9973 head_norm=1.785365
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.756396e-02
[S9] stored merged vector for next round verification (round=41)
[S9] DEBUG after merge:  round=41 metric=0.9973 head_norm=1.778821 delta_norm=0.027564
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1804) from S15
[S7] cosine check vs S15: cos=0.9998
[S2] START round=42 head_norm_before_train=2.022645 (no previous merge yet)
[S2] round=42 local utility u=0.032304 metrics={'f1_val': 0.8329270698750388, 'auprc': 0.9279149881626965, 'loss_val': 0.2756876023080467, 'psi': 0.8709222371901019}-{'f1_val': 0.8288250616624077, 'auprc': 0.9318595951789798, 'loss_val': 0.3275167156846762, 'psi': 0.8700388750690365}
[S3] START round=42 head_norm_before_train=2.043964 cos_to_last_merge=0.9527 (last merge round=22)
[S3] round=42 local utility u=0.110763 metrics={'f1_val': 0.98807547432066, 'auprc': 0.9972329343712254, 'loss_val': 0.0687046856159725, 'psi': 0.9917384583408861}-{'f1_val': 0.9610750853994537, 'auprc': 0.9987181375929086, 'loss_val': 0.13268395794215088, 'psi': 0.9761323062768357}
[S3] not sending this round → trigger blocked (psi=0.992)
[S4] START round=42 head_norm_before_train=2.040769 (no previous merge yet)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9403215393465587, 'auprc': 0.9450168971328778, 'loss_val': 0.205423210110563, 'psi': 0.9421996824610863}-{'f1_val': 0.941614304897894, 'auprc': 0.9545008013664553, 'loss_val': 0.22513041082205418, 'psi': 0.9467689034853186}
[S5] START round=42 head_norm_before_train=1.778821 cos_to_last_merge=1.0000 (last merge round=41)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.9901238792924291, 'auprc': 0.9983872566683005, 'loss_val': 0.08627617880334082, 'psi': 0.9934292302427776}-{'f1_val': 0.9962536157793602, 'auprc': 0.9994086583355876, 'loss_val': 0.06090212295705185, 'psi': 0.9975156328018512}
[S6] START round=42 head_norm_before_train=1.942878 (no previous merge yet)
[S6] round=42 local utility u=0.457440 metrics={'f1_val': 0.8220392748689056, 'auprc': 0.9599239153818895, 'loss_val': 0.3163094011914385, 'psi': 0.8771931310740991}-{'f1_val': 0.7278033270196754, 'auprc': 0.9555541395304279, 'loss_val': 0.6526640676953948, 'psi': 0.8189036520239764}
[S7] START round=42 head_norm_before_train=1.510438 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.6344722424014035, 'auprc': 0.8014387015929673, 'loss_val': 0.6001631627341801, 'psi': 0.701258826078029}-{'f1_val': 0.6913771803394029, 'auprc': 0.8877462183812375, 'loss_val': 0.2929205954969175, 'psi': 0.7699247955561367}
[S8] START round=42 head_norm_before_train=1.784833 cos_to_last_merge=0.7815 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.782
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.991372388611257, 'auprc': 0.9986115261039746, 'loss_val': 0.036353724193994276, 'psi': 0.994268043608344}-{'f1_val': 0.9927378939946618, 'auprc': 0.9985057811318173, 'loss_val': 0.03372025582341746, 'psi': 0.995045048849524}
[S9] START round=42 head_norm_before_train=1.778821 cos_to_last_merge=1.0000 (last merge round=41)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988415516924036, 'loss_val': 0.023723888142457517, 'psi': 0.9977983681842472}-{'f1_val': 0.9972945621169176, 'auprc': 0.998846430988946, 'loss_val': 0.024174096784926213, 'psi': 0.997915309665729}
[S10] START round=42 head_norm_before_train=1.603693 cos_to_last_merge=0.9466 (last merge round=23)
[S10] ⚠️ Model drifted since last merge! cos=0.947
[S10] round=42 local utility u=0.001052 metrics={'f1_val': 0.9944204775781598, 'auprc': 0.996162949654124, 'loss_val': 0.04168805772120397, 'psi': 0.9951174664085455}-{'f1_val': 0.9942851896505369, 'auprc': 0.996456559552483, 'loss_val': 0.04386044626019781, 'psi': 0.9951537376113153}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=42 head_norm_before_train=1.941003 cos_to_last_merge=0.8376 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.838
[S11] round=42 local utility u=0.000187 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9984348241717045, 'loss_val': 0.021156085109139047, 'psi': 0.9973021323768355}-{'f1_val': 0.9965470045135896, 'auprc': 0.9984336986053057, 'loss_val': 0.021526006804306823, 'psi': 0.997301682150276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=42 head_norm_before_train=1.784657 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.5787527790601046, 'auprc': 0.7384712970165506, 'loss_val': 1.1307348939976356, 'psi': 0.6426401862426829}-{'f1_val': 0.5831282338446803, 'auprc': 0.7232493892960421, 'loss_val': 0.8796694199599032, 'psi': 0.639176696025225}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=2.121494 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9917345356532364, 'auprc': 0.9991050165379384, 'loss_val': 0.03455019727995404, 'psi': 0.9946827280071172}-{'f1_val': 0.9977975102598944, 'auprc': 0.9968214666600486, 'loss_val': 0.02402885021014909, 'psi': 0.9974070928199561}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.527612 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=42 local utility u=0.000963 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9968866118790649, 'loss_val': 0.06009061115393543, 'psi': 0.9968026457841384}-{'f1_val': 0.9967466683875206, 'auprc': 0.9965408121316465, 'loss_val': 0.06097823619260081, 'psi': 0.996664325885171}
[S16] START round=42 head_norm_before_train=1.870381 cos_to_last_merge=0.8214 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.821
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9913271636925884, 'auprc': 0.9898802394478983, 'loss_val': 0.038281859731224666, 'psi': 0.9907483939947124}-{'f1_val': 0.9925941054199462, 'auprc': 0.9901856271864813, 'loss_val': 0.03281204127294155, 'psi': 0.9916307141265601}
[S17] START round=42 head_norm_before_train=1.803122 cos_to_last_merge=0.8104 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=42 local utility u=0.003873 metrics={'f1_val': 0.6535513282017211, 'auprc': 0.8214978419289496, 'loss_val': 1.1636598269344625, 'psi': 0.7207299336926125}-{'f1_val': 0.6056239696281283, 'auprc': 0.8508885195165858, 'loss_val': 0.9720127384909589, 'psi': 0.7037297895835113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:57004
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:57016
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=42 metric=0.6345 head_norm=1.518148
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.796666e-02
[S7] stored merged vector for next round verification (round=42)
[S7] DEBUG after merge:  round=42 metric=0.6362 head_norm=1.522782 delta_norm=0.017967
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1802 to 1 peers)
[S15] not sending this round → trigger blocked (psi=0.997)
[S4] RECEIVED delta(kind=head bytes=1802) from S2
[S4] cosine check vs S2: cos=-0.0510
[S4] DROPPED delta from S2 (cos=-0.0510 < 0.0)
[S6] sending update (kind=head size=1805 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S6
[S16] cosine check vs S6: cos=-0.0383
[S16] DROPPED delta from S6 (cos=-0.0383 < 0.0)
[S2] START round=43 head_norm_before_train=2.028794 (no previous merge yet)
[S2] round=43 local utility u=0.010351 metrics={'f1_val': 0.8304434237320605, 'auprc': 0.9433024790770316, 'loss_val': 0.28624644513858133, 'psi': 0.875587045870049}-{'f1_val': 0.8329270698750388, 'auprc': 0.9279149881626965, 'loss_val': 0.2756876023080467, 'psi': 0.8709222371901019}
[S3] START round=43 head_norm_before_train=2.049787 cos_to_last_merge=0.9520 (last merge round=22)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9337725786194248, 'auprc': 0.9684418775382346, 'loss_val': 0.22905100549237364, 'psi': 0.9476402981869487}-{'f1_val': 0.98807547432066, 'auprc': 0.9972329343712254, 'loss_val': 0.0687046856159725, 'psi': 0.9917384583408861}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=2.041412 (no previous merge yet)
[S4] round=43 local utility u=0.020838 metrics={'f1_val': 0.9431966209436238, 'auprc': 0.9677958212738331, 'loss_val': 0.24933408164387316, 'psi': 0.9530363010757075}-{'f1_val': 0.9403215393465587, 'auprc': 0.9450168971328778, 'loss_val': 0.205423210110563, 'psi': 0.9421996824610863}
[S5] START round=43 head_norm_before_train=1.791303 cos_to_last_merge=0.9998 (last merge round=41)
[S5] round=43 local utility u=0.045209 metrics={'f1_val': 0.9965856912065586, 'auprc': 0.998367853576843, 'loss_val': 0.03457144599267981, 'psi': 0.9972985561546723}-{'f1_val': 0.9901238792924291, 'auprc': 0.9983872566683005, 'loss_val': 0.08627617880334082, 'psi': 0.9934292302427776}
[S6] START round=43 head_norm_before_train=1.952097 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.7632558462310335, 'auprc': 0.9235702850806597, 'loss_val': 0.6081182256168162, 'psi': 0.827381621770884}-{'f1_val': 0.8220392748689056, 'auprc': 0.9599239153818895, 'loss_val': 0.3163094011914385, 'psi': 0.8771931310740991}
[S7] START round=43 head_norm_before_train=1.522782 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=43 local utility u=0.294770 metrics={'f1_val': 0.6726089446937846, 'auprc': 0.8444975712828564, 'loss_val': 0.3686192289664063, 'psi': 0.7413643953294133}-{'f1_val': 0.6344722424014035, 'auprc': 0.8014387015929673, 'loss_val': 0.6001631627341801, 'psi': 0.701258826078029}
[S8] START round=43 head_norm_before_train=1.793884 cos_to_last_merge=0.7810 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.781
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.7137538225988359, 'auprc': 0.9823962450021883, 'loss_val': 0.5847684878155037, 'psi': 0.821210791560177}-{'f1_val': 0.991372388611257, 'auprc': 0.9986115261039746, 'loss_val': 0.036353724193994276, 'psi': 0.994268043608344}
[S9] START round=43 head_norm_before_train=1.792293 cos_to_last_merge=1.0000 (last merge round=41)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9983868690517176, 'loss_val': 0.023099593888968872, 'psi': 0.9976164951279727}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988415516924036, 'loss_val': 0.023723888142457517, 'psi': 0.9977983681842472}
[S10] START round=43 head_norm_before_train=1.617974 cos_to_last_merge=0.9450 (last merge round=23)
[S10] ⚠️ Model drifted since last merge! cos=0.945
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921434477019306, 'loss_val': 0.03945126560320544, 'psi': 0.9939700824923972}-{'f1_val': 0.9944204775781598, 'auprc': 0.996162949654124, 'loss_val': 0.04168805772120397, 'psi': 0.9951174664085455}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.949790 cos_to_last_merge=0.8369 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.837
[S11] round=43 local utility u=0.002395 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9989477823556276, 'loss_val': 0.019478114985752276, 'psi': 0.9976646227979984}-{'f1_val': 0.9965470045135896, 'auprc': 0.9984348241717045, 'loss_val': 0.021156085109139047, 'psi': 0.9973021323768355}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=43 head_norm_before_train=1.790668 (no previous merge yet)
[S13] round=43 local utility u=0.281003 metrics={'f1_val': 0.6183545559956358, 'auprc': 0.7123818846216481, 'loss_val': 0.7280722459724811, 'psi': 0.6559654874460408}-{'f1_val': 0.5787527790601046, 'auprc': 0.7384712970165506, 'loss_val': 1.1307348939976356, 'psi': 0.6426401862426829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=43 head_norm_before_train=2.127481 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9550181733440125, 'auprc': 0.999184700243951, 'loss_val': 0.05703117862320093, 'psi': 0.972684784103988}-{'f1_val': 0.9917345356532364, 'auprc': 0.9991050165379384, 'loss_val': 0.03455019727995404, 'psi': 0.9946827280071172}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.547934 cos_to_last_merge=0.9998 (last merge round=40)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.9013277441892558, 'auprc': 0.9848250725052685, 'loss_val': 0.20085987352722423, 'psi': 0.9347266755156609}-{'f1_val': 0.9967466683875206, 'auprc': 0.9968866118790649, 'loss_val': 0.06009061115393543, 'psi': 0.9968026457841384}
[S16] START round=43 head_norm_before_train=1.876235 cos_to_last_merge=0.8208 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.821
[S16] round=43 local utility u=0.011019 metrics={'f1_val': 0.9923930148400706, 'auprc': 0.9931309362563117, 'loss_val': 0.0323918438658619, 'psi': 0.9926881834065671}-{'f1_val': 0.9913271636925884, 'auprc': 0.9898802394478983, 'loss_val': 0.038281859731224666, 'psi': 0.9907483939947124}
[S17] START round=43 head_norm_before_train=1.810967 cos_to_last_merge=0.8099 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.595684252632833, 'auprc': 0.7985668178394951, 'loss_val': 1.4398128217006012, 'psi': 0.6768372787154978}-{'f1_val': 0.6535513282017211, 'auprc': 0.8214978419289496, 'loss_val': 1.1636598269344625, 'psi': 0.7207299336926125}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:57002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:57015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:57010
[S2] not sending this round → trigger blocked (psi=0.876)
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S4
[S2] cosine check vs S4: cos=-0.0506
[S2] DROPPED delta from S4 (cos=-0.0506 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.9992
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=-0.0390
[S6] DROPPED delta from S16 (cos=-0.0390 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1805) from S7
[S15] cosine check vs S7: cos=0.9995
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=43 metric=0.9013 head_norm=1.568968
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.079532e-02
[S15] stored merged vector for next round verification (round=43)
[S15] DEBUG after merge:  round=43 metric=0.9013 head_norm=1.549857 delta_norm=0.030795
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=2.036352 (no previous merge yet)
[S2] round=44 local utility u=0.049505 metrics={'f1_val': 0.827372807501176, 'auprc': 0.9902835287146712, 'loss_val': 0.30975608898346363, 'psi': 0.8925370959865742}-{'f1_val': 0.8304434237320605, 'auprc': 0.9433024790770316, 'loss_val': 0.28624644513858133, 'psi': 0.875587045870049}
[S3] START round=44 head_norm_before_train=2.054177 cos_to_last_merge=0.9516 (last merge round=22)
[S3] round=44 local utility u=0.291298 metrics={'f1_val': 0.983867992857389, 'auprc': 0.9994129959479814, 'loss_val': 0.03994160387781473, 'psi': 0.990085994093626}-{'f1_val': 0.9337725786194248, 'auprc': 0.9684418775382346, 'loss_val': 0.22905100549237364, 'psi': 0.9476402981869487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=44 head_norm_before_train=2.048357 (no previous merge yet)
[S4] round=44 local utility u=0.000608 metrics={'f1_val': 0.9414089593161689, 'auprc': 0.9626844564331523, 'loss_val': 0.2220577206268888, 'psi': 0.9499191581629622}-{'f1_val': 0.9431966209436238, 'auprc': 0.9677958212738331, 'loss_val': 0.24933408164387316, 'psi': 0.9530363010757075}
[S5] START round=44 head_norm_before_train=1.804903 cos_to_last_merge=0.9993 (last merge round=41)
[S5] round=44 local utility u=0.001108 metrics={'f1_val': 0.9969211904316372, 'auprc': 0.9986521786152524, 'loss_val': 0.03522071448093151, 'psi': 0.9976135857050833}-{'f1_val': 0.9965856912065586, 'auprc': 0.998367853576843, 'loss_val': 0.03457144599267981, 'psi': 0.9972985561546723}
[S6] START round=44 head_norm_before_train=1.959746 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.596641330399331, 'auprc': 0.7810891392848562, 'loss_val': 0.8213484498348964, 'psi': 0.670420453953541}-{'f1_val': 0.7632558462310335, 'auprc': 0.9235702850806597, 'loss_val': 0.6081182256168162, 'psi': 0.827381621770884}
[S7] START round=44 head_norm_before_train=1.531127 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=44 local utility u=0.013866 metrics={'f1_val': 0.6718902755971174, 'auprc': 0.8509187691935103, 'loss_val': 0.3558386244776914, 'psi': 0.7435016730356746}-{'f1_val': 0.6726089446937846, 'auprc': 0.8444975712828564, 'loss_val': 0.3686192289664063, 'psi': 0.7413643953294133}
[S8] START round=44 head_norm_before_train=1.800708 cos_to_last_merge=0.7813 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.781
[S8] round=44 local utility u=1.000000 metrics={'f1_val': 0.9724085296311684, 'auprc': 0.9990729261844727, 'loss_val': 0.07273236618526109, 'psi': 0.9830742882524901}-{'f1_val': 0.7137538225988359, 'auprc': 0.9823962450021883, 'loss_val': 0.5847684878155037, 'psi': 0.821210791560177}
[S9] START round=44 head_norm_before_train=1.802928 cos_to_last_merge=0.9999 (last merge round=41)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9931032914010764, 'auprc': 0.9988465774305835, 'loss_val': 0.03157681132900632, 'psi': 0.9954006058128793}-{'f1_val': 0.9971029125121428, 'auprc': 0.9983868690517176, 'loss_val': 0.023099593888968872, 'psi': 0.9976164951279727}
[S10] START round=44 head_norm_before_train=1.631769 cos_to_last_merge=0.9436 (last merge round=23)
[S10] ⚠️ Model drifted since last merge! cos=0.944
[S10] round=44 local utility u=0.004613 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9961600375774048, 'loss_val': 0.03913353772666208, 'psi': 0.9952626480366118}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921434477019306, 'loss_val': 0.03945126560320544, 'psi': 0.9939700824923972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=44 head_norm_before_train=1.953797 cos_to_last_merge=0.8360 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.836
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9991016238804191, 'loss_val': 0.01975755311271532, 'psi': 0.9973331343986149}-{'f1_val': 0.9968091830929121, 'auprc': 0.9989477823556276, 'loss_val': 0.019478114985752276, 'psi': 0.9976646227979984}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.794472 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5990634004326395, 'auprc': 0.7625102362217445, 'loss_val': 0.9028732567201435, 'psi': 0.6644421347482815}-{'f1_val': 0.6183545559956358, 'auprc': 0.7123818846216481, 'loss_val': 0.7280722459724811, 'psi': 0.6559654874460408}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=2.134852 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9365963680643237, 'auprc': 0.9981532410972583, 'loss_val': 0.10256149183328912, 'psi': 0.9612191172774975}-{'f1_val': 0.9550181733440125, 'auprc': 0.999184700243951, 'loss_val': 0.05703117862320093, 'psi': 0.972684784103988}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.549857 cos_to_last_merge=1.0000 (last merge round=43)
[S15] round=44 local utility u=0.372605 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9976248596296682, 'loss_val': 0.06878723486254597, 'psi': 0.9973202959687274}-{'f1_val': 0.9013277441892558, 'auprc': 0.9848250725052685, 'loss_val': 0.20085987352722423, 'psi': 0.9347266755156609}
[S16] START round=44 head_norm_before_train=1.884336 cos_to_last_merge=0.8203 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.820
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9410615181288396, 'auprc': 0.9941949840590087, 'loss_val': 0.2022456226439624, 'psi': 0.9623149045009072}-{'f1_val': 0.9923930148400706, 'auprc': 0.9931309362563117, 'loss_val': 0.0323918438658619, 'psi': 0.9926881834065671}
[S17] START round=44 head_norm_before_train=1.820366 cos_to_last_merge=0.8093 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.809
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.5957032337176049, 'auprc': 0.8053625634741538, 'loss_val': 1.4962732424224827, 'psi': 0.6795669656202246}-{'f1_val': 0.595684252632833, 'auprc': 0.7985668178394951, 'loss_val': 1.4398128217006012, 'psi': 0.6768372787154978}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.744)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S5] not sending this round → trigger blocked (psi=0.998)
[S4] not sending this round → trigger blocked (psi=0.950)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:57004
[S2] sending update (kind=head size=1797 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:57008
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=44 metric=0.9931 head_norm=1.814750
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.976684e-02
[S9] stored merged vector for next round verification (round=44)
[S9] DEBUG after merge:  round=44 metric=0.9931 head_norm=1.809396 delta_norm=0.039767
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1797) from S2
[S4] cosine check vs S2: cos=-0.0507
[S4] DROPPED delta from S2 (cos=-0.0507 < 0.0)
[S15] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] cosine check vs S15: cos=0.9996
[S2] START round=45 head_norm_before_train=2.045286 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.8037203110730511, 'auprc': 0.9927833713297384, 'loss_val': 0.36210655393802266, 'psi': 0.879345535175726}-{'f1_val': 0.827372807501176, 'auprc': 0.9902835287146712, 'loss_val': 0.30975608898346363, 'psi': 0.8925370959865742}
[S3] START round=45 head_norm_before_train=2.059175 cos_to_last_merge=0.9512 (last merge round=22)
[S3] round=45 local utility u=0.048399 metrics={'f1_val': 0.9974985492286463, 'auprc': 0.9975211962152408, 'loss_val': 0.01925151442507175, 'psi': 0.9975076080232841}-{'f1_val': 0.983867992857389, 'auprc': 0.9994129959479814, 'loss_val': 0.03994160387781473, 'psi': 0.990085994093626}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=45 head_norm_before_train=2.059816 (no previous merge yet)
[S4] round=45 local utility u=0.004647 metrics={'f1_val': 0.9429344187114558, 'auprc': 0.9720271756855284, 'loss_val': 0.2499440430372623, 'psi': 0.9545715215010848}-{'f1_val': 0.9414089593161689, 'auprc': 0.9626844564331523, 'loss_val': 0.2220577206268888, 'psi': 0.9499191581629622}
[S5] START round=45 head_norm_before_train=1.821880 cos_to_last_merge=0.9987 (last merge round=41)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.9966005625004375, 'auprc': 0.999216595196903, 'loss_val': 0.04894161594922029, 'psi': 0.9976469755790236}-{'f1_val': 0.9969211904316372, 'auprc': 0.9986521786152524, 'loss_val': 0.03522071448093151, 'psi': 0.9976135857050833}
[S6] START round=45 head_norm_before_train=1.966314 (no previous merge yet)
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.8236743303175849, 'auprc': 0.9602500511255903, 'loss_val': 0.4314594410275844, 'psi': 0.878304618640787}-{'f1_val': 0.596641330399331, 'auprc': 0.7810891392848562, 'loss_val': 0.8213484498348964, 'psi': 0.670420453953541}
[S7] START round=45 head_norm_before_train=1.538979 cos_to_last_merge=0.9999 (last merge round=42)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6225884520557661, 'auprc': 0.799462788535132, 'loss_val': 0.6741958577228138, 'psi': 0.6933381866475125}-{'f1_val': 0.6718902755971174, 'auprc': 0.8509187691935103, 'loss_val': 0.3558386244776914, 'psi': 0.7435016730356746}
[S8] START round=45 head_norm_before_train=1.804915 cos_to_last_merge=0.7805 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.781
[S8] round=45 local utility u=0.087182 metrics={'f1_val': 0.9947112329003273, 'auprc': 0.9981255467375196, 'loss_val': 0.02934247590254957, 'psi': 0.9960769584352042}-{'f1_val': 0.9724085296311684, 'auprc': 0.9990729261844727, 'loss_val': 0.07273236618526109, 'psi': 0.9830742882524901}
[S9] START round=45 head_norm_before_train=1.809396 cos_to_last_merge=1.0000 (last merge round=44)
[S9] round=45 local utility u=0.016232 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984972436609625, 'loss_val': 0.022062081471148902, 'psi': 0.9976606449716707}-{'f1_val': 0.9931032914010764, 'auprc': 0.9988465774305835, 'loss_val': 0.03157681132900632, 'psi': 0.9954006058128793}
[S10] START round=45 head_norm_before_train=1.644437 cos_to_last_merge=0.9423 (last merge round=23)
[S10] ⚠️ Model drifted since last merge! cos=0.942
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9940077261066997, 'loss_val': 0.0372728956135317, 'psi': 0.9946651712883389}-{'f1_val': 0.9946643883427498, 'auprc': 0.9961600375774048, 'loss_val': 0.03913353772666208, 'psi': 0.9952626480366118}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.959075 cos_to_last_merge=0.8353 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.835
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9831937740927896, 'auprc': 0.9987021708504206, 'loss_val': 0.08039681027856614, 'psi': 0.9893971327958421}-{'f1_val': 0.9961541414107454, 'auprc': 0.9991016238804191, 'loss_val': 0.01975755311271532, 'psi': 0.9973331343986149}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.795847 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.5808270938563603, 'auprc': 0.6954028045165164, 'loss_val': 1.1419357534504184, 'psi': 0.6266573781204228}-{'f1_val': 0.5990634004326395, 'auprc': 0.7625102362217445, 'loss_val': 0.9028732567201435, 'psi': 0.6644421347482815}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=2.140481 (no previous merge yet)
[S14] round=45 local utility u=0.223502 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9984303117327081, 'loss_val': 0.022269888622598988, 'psi': 0.997918049571034}-{'f1_val': 0.9365963680643237, 'auprc': 0.9981532410972583, 'loss_val': 0.10256149183328912, 'psi': 0.9612191172774975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=45 head_norm_before_train=1.568925 cos_to_last_merge=1.0000 (last merge round=43)
[S15] round=45 local utility u=0.005081 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9976777671846571, 'loss_val': 0.058784829278086544, 'psi': 0.9973414589907229}-{'f1_val': 0.9971172535281002, 'auprc': 0.9976248596296682, 'loss_val': 0.06878723486254597, 'psi': 0.9973202959687274}
[S16] START round=45 head_norm_before_train=1.893159 cos_to_last_merge=0.8197 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.820
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8324858899885399, 'auprc': 0.8932630976055438, 'loss_val': 1.1879027533928677, 'psi': 0.8567967730353414}-{'f1_val': 0.9410615181288396, 'auprc': 0.9941949840590087, 'loss_val': 0.2022456226439624, 'psi': 0.9623149045009072}
[S17] START round=45 head_norm_before_train=1.827967 cos_to_last_merge=0.8082 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=45 local utility u=0.381831 metrics={'f1_val': 0.6452303422017828, 'auprc': 0.8649007989076464, 'loss_val': 1.2083876794584514, 'psi': 0.7330985248841282}-{'f1_val': 0.5957032337176049, 'auprc': 0.8053625634741538, 'loss_val': 1.4962732424224827, 'psi': 0.6795669656202246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:57005
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:57002
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1793 to 1 peers)
[S16] ⇄ pheromone p=0.096 → S6@127.0.0.1:57007
[S5] ⇄ pheromone p=0.104 → S9@127.0.0.1:57010
[S9] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:57016
[S15] not sending this round → trigger blocked (psi=0.997)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=45 metric=0.6226 head_norm=1.553073
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.657481e-02
[S7] stored merged vector for next round verification (round=45)
[S7] DEBUG after merge:  round=45 metric=0.6238 head_norm=1.560793 delta_norm=0.026575
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.123 → S15@127.0.0.1:57015
[S2] ⇄ pheromone p=0.045 → S4@127.0.0.1:57004
[S5] RECEIVED delta(kind=head bytes=1804) from S9
[S5] cosine check vs S9: cos=0.9988
[S2] RECEIVED delta(kind=head bytes=1793) from S4
[S2] cosine check vs S4: cos=-0.0507
[S2] DROPPED delta from S4 (cos=-0.0507 < 0.0)
[S6] sending update (kind=head size=1801 to 1 peers)
[S9] ⇄ pheromone p=0.006 → S5@127.0.0.1:57005
[S4] ⇄ pheromone p=0.008 → S2@127.0.0.1:57002
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=-0.0406
[S16] DROPPED delta from S6 (cos=-0.0406 < 0.0)
[S15] ⇄ pheromone p=0.188 → S7@127.0.0.1:57008
[S6] ⇄ pheromone p=0.374 → S16@127.0.0.1:57016
[S2] START round=46 head_norm_before_train=2.053541 (no previous merge yet)
[S2] round=46 local utility u=0.122536 metrics={'f1_val': 0.872720946130829, 'auprc': 0.9047461425613006, 'loss_val': 0.2669262073623803, 'psi': 0.8855310247030176}-{'f1_val': 0.8037203110730511, 'auprc': 0.9927833713297384, 'loss_val': 0.36210655393802266, 'psi': 0.879345535175726}
[S3] START round=46 head_norm_before_train=2.065129 cos_to_last_merge=0.9507 (last merge round=22)
[S3] round=46 local utility u=0.003414 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9996878442928504, 'loss_val': 0.01815104495560954, 'psi': 0.9982969563121924}-{'f1_val': 0.9974985492286463, 'auprc': 0.9975211962152408, 'loss_val': 0.01925151442507175, 'psi': 0.9975076080232841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=46 head_norm_before_train=2.066887 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9409784289612058, 'auprc': 0.9576461516438264, 'loss_val': 0.2085669344119912, 'psi': 0.947645518034254}-{'f1_val': 0.9429344187114558, 'auprc': 0.9720271756855284, 'loss_val': 0.2499440430372623, 'psi': 0.9545715215010848}
[S5] START round=46 head_norm_before_train=1.836313 cos_to_last_merge=0.9979 (last merge round=41)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.9160611914978705, 'auprc': 0.9993885765441741, 'loss_val': 0.146014445806966, 'psi': 0.9493921455163918}-{'f1_val': 0.9966005625004375, 'auprc': 0.999216595196903, 'loss_val': 0.04894161594922029, 'psi': 0.9976469755790236}
[S6] START round=46 head_norm_before_train=1.971047 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7240696454417462, 'auprc': 0.8987411224501273, 'loss_val': 0.6948411503339886, 'psi': 0.7939382362450986}-{'f1_val': 0.8236743303175849, 'auprc': 0.9602500511255903, 'loss_val': 0.4314594410275844, 'psi': 0.878304618640787}
[S7] START round=46 head_norm_before_train=1.560793 cos_to_last_merge=1.0000 (last merge round=45)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.6194369855615592, 'auprc': 0.8028306955579926, 'loss_val': 0.6933980326608262, 'psi': 0.6927944695601326}-{'f1_val': 0.6225884520557661, 'auprc': 0.799462788535132, 'loss_val': 0.6741958577228138, 'psi': 0.6933381866475125}
[S8] START round=46 head_norm_before_train=1.810717 cos_to_last_merge=0.7795 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.779
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9944248929832828, 'auprc': 0.9981425961220642, 'loss_val': 0.029195698906959656, 'psi': 0.9959119742387954}-{'f1_val': 0.9947112329003273, 'auprc': 0.9981255467375196, 'loss_val': 0.02934247590254957, 'psi': 0.9960769584352042}
[S9] START round=46 head_norm_before_train=1.822335 cos_to_last_merge=1.0000 (last merge round=44)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9962748907591257, 'auprc': 0.99884087120013, 'loss_val': 0.022493014570252268, 'psi': 0.9973012829355274}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984972436609625, 'loss_val': 0.022062081471148902, 'psi': 0.9976606449716707}
[S10] START round=46 head_norm_before_train=1.657689 cos_to_last_merge=0.9410 (last merge round=23)
[S10] ⚠️ Model drifted since last merge! cos=0.941
[S10] round=46 local utility u=0.000309 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9938440404101935, 'loss_val': 0.03616348691522842, 'psi': 0.9945996970097364}-{'f1_val': 0.9951034680760983, 'auprc': 0.9940077261066997, 'loss_val': 0.0372728956135317, 'psi': 0.9946651712883389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=46 head_norm_before_train=1.961827 cos_to_last_merge=0.8345 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.835
[S11] round=46 local utility u=0.069732 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9991092981801798, 'loss_val': 0.019915682244327007, 'psi': 0.9973362041185192}-{'f1_val': 0.9831937740927896, 'auprc': 0.9987021708504206, 'loss_val': 0.08039681027856614, 'psi': 0.9893971327958421}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=46 head_norm_before_train=1.803090 (no previous merge yet)
[S13] round=46 local utility u=0.639997 metrics={'f1_val': 0.6600085824628333, 'auprc': 0.783070337657862, 'loss_val': 0.6000330970258126, 'psi': 0.7092332845408449}-{'f1_val': 0.5808270938563603, 'auprc': 0.6954028045165164, 'loss_val': 1.1419357534504184, 'psi': 0.6266573781204228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=46 head_norm_before_train=2.143813 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9932143541495477, 'auprc': 0.9978699419580254, 'loss_val': 0.03249521524817598, 'psi': 0.9950765892729387}-{'f1_val': 0.9975765414632514, 'auprc': 0.9984303117327081, 'loss_val': 0.022269888622598988, 'psi': 0.997918049571034}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.584801 cos_to_last_merge=0.9999 (last merge round=43)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.8171696067694322, 'auprc': 0.9933042198058919, 'loss_val': 0.3046769667143451, 'psi': 0.887623451984016}-{'f1_val': 0.9971172535281002, 'auprc': 0.9976777671846571, 'loss_val': 0.058784829278086544, 'psi': 0.9973414589907229}
[S16] START round=46 head_norm_before_train=1.902094 cos_to_last_merge=0.8192 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.819
[S16] round=46 local utility u=0.223928 metrics={'f1_val': 0.850704081111256, 'auprc': 0.9286230376434359, 'loss_val': 0.9554354683735145, 'psi': 0.881871663724128}-{'f1_val': 0.8324858899885399, 'auprc': 0.8932630976055438, 'loss_val': 1.1879027533928677, 'psi': 0.8567967730353414}
[S17] START round=46 head_norm_before_train=1.835219 cos_to_last_merge=0.8080 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.5937368951574268, 'auprc': 0.8245139007350266, 'loss_val': 1.487805741379952, 'psi': 0.6860476973884667}-{'f1_val': 0.6452303422017828, 'auprc': 0.8649007989076464, 'loss_val': 1.2083876794584514, 'psi': 0.7330985248841282}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:57007
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:57004
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1794 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=46 metric=0.9161 head_norm=1.848097
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.957103e-02
[S5] stored merged vector for next round verification (round=46)
[S5] DEBUG after merge:  round=46 metric=0.9156 head_norm=1.834294 delta_norm=0.059571
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1802 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] cosine check vs S16: cos=-0.0415
[S6] DROPPED delta from S16 (cos=-0.0415 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1794) from S2
[S4] cosine check vs S2: cos=-0.0506
[S4] DROPPED delta from S2 (cos=-0.0506 < 0.0)
[S2] START round=47 head_norm_before_train=2.058511 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.8296661576820741, 'auprc': 0.930165244901044, 'loss_val': 0.3237017030230895, 'psi': 0.869865792569662}-{'f1_val': 0.872720946130829, 'auprc': 0.9047461425613006, 'loss_val': 0.2669262073623803, 'psi': 0.8855310247030176}
[S3] START round=47 head_norm_before_train=2.065819 cos_to_last_merge=0.9503 (last merge round=22)
[S3] round=47 local utility u=0.000426 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.999727006704661, 'loss_val': 0.019888119644156543, 'psi': 0.9985597005088229}-{'f1_val': 0.9973696976584205, 'auprc': 0.9996878442928504, 'loss_val': 0.01815104495560954, 'psi': 0.9982969563121924}
[S3] not sending this round → trigger blocked (psi=0.999)
[S4] START round=47 head_norm_before_train=2.072196 (no previous merge yet)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9415004033544723, 'auprc': 0.9592513948430046, 'loss_val': 0.2472981373441955, 'psi': 0.9486007999498851}-{'f1_val': 0.9409784289612058, 'auprc': 0.9576461516438264, 'loss_val': 0.2085669344119912, 'psi': 0.947645518034254}
[S5] START round=47 head_norm_before_train=1.834294 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=47 local utility u=0.280045 metrics={'f1_val': 0.9954773793602816, 'auprc': 0.995219486089315, 'loss_val': 0.04991354260925334, 'psi': 0.9953742220518949}-{'f1_val': 0.9160611914978705, 'auprc': 0.9993885765441741, 'loss_val': 0.146014445806966, 'psi': 0.9493921455163918}
[S6] START round=47 head_norm_before_train=1.979370 (no previous merge yet)
[S6] round=47 local utility u=0.031267 metrics={'f1_val': 0.7162935377786308, 'auprc': 0.9450145566345397, 'loss_val': 0.7244709615284349, 'psi': 0.8077819453209943}-{'f1_val': 0.7240696454417462, 'auprc': 0.8987411224501273, 'loss_val': 0.6948411503339886, 'psi': 0.7939382362450986}
[S7] START round=47 head_norm_before_train=1.571185 cos_to_last_merge=1.0000 (last merge round=45)
[S7] round=47 local utility u=0.162530 metrics={'f1_val': 0.6416059763480652, 'auprc': 0.8073000840779401, 'loss_val': 0.5147593594153486, 'psi': 0.7078836194400151}-{'f1_val': 0.6194369855615592, 'auprc': 0.8028306955579926, 'loss_val': 0.6933980326608262, 'psi': 0.6927944695601326}
[S8] START round=47 head_norm_before_train=1.817792 cos_to_last_merge=0.7782 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.778
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9939009886418481, 'auprc': 0.9980702275937342, 'loss_val': 0.03173340102181384, 'psi': 0.9955686842226025}-{'f1_val': 0.9944248929832828, 'auprc': 0.9981425961220642, 'loss_val': 0.029195698906959656, 'psi': 0.9959119742387954}
[S9] START round=47 head_norm_before_train=1.835250 cos_to_last_merge=0.9999 (last merge round=44)
[S9] round=47 local utility u=0.003086 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988430513036062, 'loss_val': 0.02129594713963876, 'psi': 0.9977989680287281}-{'f1_val': 0.9962748907591257, 'auprc': 0.99884087120013, 'loss_val': 0.022493014570252268, 'psi': 0.9973012829355274}
[S10] START round=47 head_norm_before_train=1.671009 cos_to_last_merge=0.9397 (last merge round=23)
[S10] ⚠️ Model drifted since last merge! cos=0.940
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9961676483381258, 'loss_val': 0.036786704821502834, 'psi': 0.9948708558921906}-{'f1_val': 0.9951034680760983, 'auprc': 0.9938440404101935, 'loss_val': 0.03616348691522842, 'psi': 0.9945996970097364}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.966407 cos_to_last_merge=0.8341 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.834
[S11] round=47 local utility u=0.000823 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9989906115637732, 'loss_val': 0.020270738585390583, 'psi': 0.9975244473336631}-{'f1_val': 0.9961541414107454, 'auprc': 0.9991092981801798, 'loss_val': 0.019915682244327007, 'psi': 0.9973362041185192}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=47 head_norm_before_train=1.809708 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6470161925015616, 'auprc': 0.7618695323338547, 'loss_val': 0.9978305012313395, 'psi': 0.6929575284344789}-{'f1_val': 0.6600085824628333, 'auprc': 0.783070337657862, 'loss_val': 0.6000330970258126, 'psi': 0.7092332845408449}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.146636 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9406140284682626, 'auprc': 0.9971121550016402, 'loss_val': 0.1079754496757822, 'psi': 0.9632132790816137}-{'f1_val': 0.9932143541495477, 'auprc': 0.9978699419580254, 'loss_val': 0.03249521524817598, 'psi': 0.9950765892729387}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.599964 cos_to_last_merge=0.9997 (last merge round=43)
[S15] round=47 local utility u=0.665202 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.991902396597914, 'loss_val': 0.047530026728193925, 'psi': 0.9948089596716779}-{'f1_val': 0.8171696067694322, 'auprc': 0.9933042198058919, 'loss_val': 0.3046769667143451, 'psi': 0.887623451984016}
[S16] START round=47 head_norm_before_train=1.907397 cos_to_last_merge=0.8190 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.819
[S16] round=47 local utility u=0.657146 metrics={'f1_val': 0.9399696977578765, 'auprc': 0.9764860569452378, 'loss_val': 0.3203264849795782, 'psi': 0.9545762414328209}-{'f1_val': 0.850704081111256, 'auprc': 0.9286230376434359, 'loss_val': 0.9554354683735145, 'psi': 0.881871663724128}
[S17] START round=47 head_norm_before_train=1.840523 cos_to_last_merge=0.8078 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5363232520963035, 'auprc': 0.8016274452016796, 'loss_val': 1.6193120621343415, 'psi': 0.642444929338454}-{'f1_val': 0.5937368951574268, 'auprc': 0.8245139007350266, 'loss_val': 1.487805741379952, 'psi': 0.6860476973884667}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:57010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:57015
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:57005
[S16] not sending this round → trigger blocked (psi=0.955)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:57008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:57016
[S5] RECEIVED delta(kind=head bytes=1803) from S9
[S5] cosine check vs S9: cos=0.9989
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.9989
[S15] RECEIVED delta(kind=head bytes=1802) from S7
[S15] cosine check vs S7: cos=0.9991
[S6] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=47 metric=0.9971 head_norm=1.845087
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.244477e-02
[S9] stored merged vector for next round verification (round=47)
[S9] DEBUG after merge:  round=47 metric=0.9971 head_norm=1.843467 delta_norm=0.042445
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=47 metric=0.9955 head_norm=1.842823
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.244474e-02
[S5] stored merged vector for next round verification (round=47)
[S5] DEBUG after merge:  round=47 metric=0.9955 head_norm=1.843467 delta_norm=0.042445
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1798) from S15
[S7] cosine check vs S15: cos=0.9991
[S16] RECEIVED delta(kind=head bytes=1804) from S6
[S16] cosine check vs S6: cos=-0.0418
[S16] DROPPED delta from S6 (cos=-0.0418 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=47 metric=0.9967 head_norm=1.614874
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.872617e-02
[S15] stored merged vector for next round verification (round=47)
[S15] DEBUG after merge:  round=47 metric=0.9967 head_norm=1.596210 delta_norm=0.038726
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=2.065360 (no previous merge yet)
[S2] round=48 local utility u=0.052148 metrics={'f1_val': 0.828387266821488, 'auprc': 0.9682038234035748, 'loss_val': 0.3258477727775741, 'psi': 0.8843138894543228}-{'f1_val': 0.8296661576820741, 'auprc': 0.930165244901044, 'loss_val': 0.3237017030230895, 'psi': 0.869865792569662}
[S3] START round=48 head_norm_before_train=2.068835 cos_to_last_merge=0.9498 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.950
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.9944816393083035, 'auprc': 0.9995888764294645, 'loss_val': 0.025323515533175932, 'psi': 0.9965245341567679}-{'f1_val': 0.9977814963782642, 'auprc': 0.999727006704661, 'loss_val': 0.019888119644156543, 'psi': 0.9985597005088229}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.068785 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9404170672481837, 'auprc': 0.9495121198065627, 'loss_val': 0.21501072673699506, 'psi': 0.9440550882715353}-{'f1_val': 0.9415004033544723, 'auprc': 0.9592513948430046, 'loss_val': 0.2472981373441955, 'psi': 0.9486007999498851}
[S5] START round=48 head_norm_before_train=1.843467 cos_to_last_merge=1.0000 (last merge round=47)
[S5] round=48 local utility u=0.015625 metrics={'f1_val': 0.9969947366280233, 'auprc': 0.9959205648905084, 'loss_val': 0.029870233360573734, 'psi': 0.9965650679330174}-{'f1_val': 0.9954773793602816, 'auprc': 0.995219486089315, 'loss_val': 0.04991354260925334, 'psi': 0.9953742220518949}
[S6] START round=48 head_norm_before_train=1.983234 (no previous merge yet)
[S6] round=48 local utility u=0.551408 metrics={'f1_val': 0.8407046424817313, 'auprc': 0.9543766580799748, 'loss_val': 0.3962088751468177, 'psi': 0.8861734487210287}-{'f1_val': 0.7162935377786308, 'auprc': 0.9450145566345397, 'loss_val': 0.7244709615284349, 'psi': 0.8077819453209943}
[S7] START round=48 head_norm_before_train=1.578275 cos_to_last_merge=0.9998 (last merge round=45)
[S7] round=48 local utility u=0.098267 metrics={'f1_val': 0.657391402428553, 'auprc': 0.8176531279171181, 'loss_val': 0.44399801217474405, 'psi': 0.7214960926239791}-{'f1_val': 0.6416059763480652, 'auprc': 0.8073000840779401, 'loss_val': 0.5147593594153486, 'psi': 0.7078836194400151}
[S8] START round=48 head_norm_before_train=1.823285 cos_to_last_merge=0.7777 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.778
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9870848001833279, 'auprc': 0.9991016476373579, 'loss_val': 0.04672669337833717, 'psi': 0.9918915391649399}-{'f1_val': 0.9939009886418481, 'auprc': 0.9980702275937342, 'loss_val': 0.03173340102181384, 'psi': 0.9955686842226025}
[S9] START round=48 head_norm_before_train=1.843467 cos_to_last_merge=1.0000 (last merge round=47)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9983139146722902, 'loss_val': 0.02099857777871285, 'psi': 0.9975873133762018}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988430513036062, 'loss_val': 0.02129594713963876, 'psi': 0.9977989680287281}
[S10] START round=48 head_norm_before_train=1.684353 cos_to_last_merge=0.9383 (last merge round=23)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921948118787646, 'loss_val': 0.03607982828486934, 'psi': 0.9939906281631307}-{'f1_val': 0.9940063275949004, 'auprc': 0.9961676483381258, 'loss_val': 0.036786704821502834, 'psi': 0.9948708558921906}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.972587 cos_to_last_merge=0.8337 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.834
[S11] round=48 local utility u=0.000247 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9988322461876742, 'loss_val': 0.019423746865647747, 'psi': 0.9974733808587979}-{'f1_val': 0.9965470045135896, 'auprc': 0.9989906115637732, 'loss_val': 0.020270738585390583, 'psi': 0.9975244473336631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=48 head_norm_before_train=1.815339 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.5870584315542017, 'auprc': 0.6916809387336804, 'loss_val': 1.156282610623121, 'psi': 0.6289074344259932}-{'f1_val': 0.6470161925015616, 'auprc': 0.7618695323338547, 'loss_val': 0.9978305012313395, 'psi': 0.6929575284344789}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.152671 (no previous merge yet)
[S14] round=48 local utility u=0.047664 metrics={'f1_val': 0.949725527618807, 'auprc': 0.99914193298634, 'loss_val': 0.07340529265690442, 'psi': 0.9694920897658201}-{'f1_val': 0.9406140284682626, 'auprc': 0.9971121550016402, 'loss_val': 0.1079754496757822, 'psi': 0.9632132790816137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=48 head_norm_before_train=1.596210 cos_to_last_merge=1.0000 (last merge round=47)
[S15] round=48 local utility u=0.004539 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9937710630853118, 'loss_val': 0.0440574693015877, 'psi': 0.9955564262666371}-{'f1_val': 0.9967466683875206, 'auprc': 0.991902396597914, 'loss_val': 0.047530026728193925, 'psi': 0.9948089596716779}
[S16] START round=48 head_norm_before_train=1.911729 cos_to_last_merge=0.8183 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.818
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.8870252897544046, 'auprc': 0.9937142164107332, 'loss_val': 0.276694431591192, 'psi': 0.929700860416936}-{'f1_val': 0.9399696977578765, 'auprc': 0.9764860569452378, 'loss_val': 0.3203264849795782, 'psi': 0.9545762414328209}
[S17] START round=48 head_norm_before_train=1.845371 cos_to_last_merge=0.8073 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.807
[S17] round=48 local utility u=0.412215 metrics={'f1_val': 0.6051569497127146, 'auprc': 0.862311688668383, 'loss_val': 1.3899369924259917, 'psi': 0.708018845294982}-{'f1_val': 0.5363232520963035, 'auprc': 0.8016274452016796, 'loss_val': 1.6193120621343415, 'psi': 0.642444929338454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S6]  timeout peer S8
[S8]  timeout peer S3
[S15]  timeout peer S10
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:57004
[S5] not sending this round → trigger blocked (psi=0.997)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.721)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=48 metric=0.6574 head_norm=1.585532
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.877181e-02
[S7] stored merged vector for next round verification (round=48)
[S7] DEBUG after merge:  round=48 metric=0.6578 head_norm=1.599800 delta_norm=0.038772
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.886)
[S15] not sending this round → trigger blocked (psi=0.996)
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] cosine check vs S2: cos=-0.0498
[S4] DROPPED delta from S2 (cos=-0.0498 < 0.0)
[S2] START round=49 head_norm_before_train=2.074076 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.8252030247646096, 'auprc': 0.9750542437363394, 'loss_val': 0.3738793831775455, 'psi': 0.8851435123533016}-{'f1_val': 0.828387266821488, 'auprc': 0.9682038234035748, 'loss_val': 0.3258477727775741, 'psi': 0.8843138894543228}
[S3] START round=49 head_norm_before_train=2.076301 cos_to_last_merge=0.9491 (last merge round=22)
[S3] ⚠️ Model drifted since last merge! cos=0.949
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9992131017552156, 'loss_val': 0.08270141793504612, 'psi': 0.9763302919417585}-{'f1_val': 0.9944816393083035, 'auprc': 0.9995888764294645, 'loss_val': 0.025323515533175932, 'psi': 0.9965245341567679}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.073328 (no previous merge yet)
[S4] round=49 local utility u=0.055671 metrics={'f1_val': 0.9438389177784855, 'auprc': 0.9831644547624966, 'loss_val': 0.22515657791247462, 'psi': 0.9595691325720899}-{'f1_val': 0.9404170672481837, 'auprc': 0.9495121198065627, 'loss_val': 0.21501072673699506, 'psi': 0.9440550882715353}
[S5] START round=49 head_norm_before_train=1.855950 cos_to_last_merge=1.0000 (last merge round=47)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9969947366280233, 'auprc': 0.9938990098272958, 'loss_val': 0.033025523535667886, 'psi': 0.9957564459077324}-{'f1_val': 0.9969947366280233, 'auprc': 0.9959205648905084, 'loss_val': 0.029870233360573734, 'psi': 0.9965650679330174}
[S6] START round=49 head_norm_before_train=1.992578 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.8256513427584238, 'auprc': 0.9457737718650241, 'loss_val': 0.3920555356246567, 'psi': 0.8737003144010639}-{'f1_val': 0.8407046424817313, 'auprc': 0.9543766580799748, 'loss_val': 0.3962088751468177, 'psi': 0.8861734487210287}
[S7] START round=49 head_norm_before_train=1.599800 cos_to_last_merge=1.0000 (last merge round=48)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6261312736407466, 'auprc': 0.8000455102963573, 'loss_val': 0.6246983196884884, 'psi': 0.6956969683029909}-{'f1_val': 0.657391402428553, 'auprc': 0.8176531279171181, 'loss_val': 0.44399801217474405, 'psi': 0.7214960926239791}
[S8] START round=49 head_norm_before_train=1.827802 cos_to_last_merge=0.7770 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.777
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9442012215899931, 'auprc': 0.9991993048685865, 'loss_val': 0.1332613830907991, 'psi': 0.9662004549014305}-{'f1_val': 0.9870848001833279, 'auprc': 0.9991016476373579, 'loss_val': 0.04672669337833717, 'psi': 0.9918915391649399}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.853489 cos_to_last_merge=1.0000 (last merge round=47)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9988437603247439, 'loss_val': 0.021283325206897, 'psi': 0.997649055385252}-{'f1_val': 0.9971029125121428, 'auprc': 0.9983139146722902, 'loss_val': 0.02099857777871285, 'psi': 0.9975873133762018}
[S10] START round=49 head_norm_before_train=1.696277 cos_to_last_merge=0.9371 (last merge round=23)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=49 local utility u=0.007250 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9958279737594453, 'loss_val': 0.033291495696392386, 'psi': 0.9955250618420164}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921948118787646, 'loss_val': 0.03607982828486934, 'psi': 0.9939906281631307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=49 head_norm_before_train=1.979681 cos_to_last_merge=0.8332 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.833
[S11] round=49 local utility u=0.000973 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9988189932301212, 'loss_val': 0.018888543398500296, 'psi': 0.9976131071477958}-{'f1_val': 0.996567470639547, 'auprc': 0.9988322461876742, 'loss_val': 0.019423746865647747, 'psi': 0.9974733808587979}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=49 head_norm_before_train=1.821636 (no previous merge yet)
[S13] round=49 local utility u=0.623161 metrics={'f1_val': 0.6841215044941745, 'auprc': 0.7973691897183608, 'loss_val': 0.8094039152577048, 'psi': 0.729420578583849}-{'f1_val': 0.5870584315542017, 'auprc': 0.6916809387336804, 'loss_val': 1.156282610623121, 'psi': 0.6289074344259932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=49 head_norm_before_train=2.160991 (no previous merge yet)
[S14] round=49 local utility u=0.170139 metrics={'f1_val': 0.9973814229168628, 'auprc': 0.9991751565634042, 'loss_val': 0.01916296954962949, 'psi': 0.9980989163754794}-{'f1_val': 0.949725527618807, 'auprc': 0.99914193298634, 'loss_val': 0.07340529265690442, 'psi': 0.9694920897658201}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=49 head_norm_before_train=1.611366 cos_to_last_merge=1.0000 (last merge round=47)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.9013277441892558, 'auprc': 0.9630180706392573, 'loss_val': 0.20675067888766296, 'psi': 0.9260038747692563}-{'f1_val': 0.9967466683875206, 'auprc': 0.9937710630853118, 'loss_val': 0.0440574693015877, 'psi': 0.9955564262666371}
[S16] START round=49 head_norm_before_train=1.918790 cos_to_last_merge=0.8178 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.818
[S16] round=49 local utility u=0.438275 metrics={'f1_val': 0.9931718136311698, 'auprc': 0.9946868694174864, 'loss_val': 0.03994146750353239, 'psi': 0.9937778359456965}-{'f1_val': 0.8870252897544046, 'auprc': 0.9937142164107332, 'loss_val': 0.276694431591192, 'psi': 0.929700860416936}
[S17] START round=49 head_norm_before_train=1.851568 cos_to_last_merge=0.8067 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.807
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.5839857494120942, 'auprc': 0.8088680882526875, 'loss_val': 1.5089050264880008, 'psi': 0.6739386849483315}-{'f1_val': 0.6051569497127146, 'auprc': 0.862311688668383, 'loss_val': 1.3899369924259917, 'psi': 0.708018845294982}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:57002
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:57007
[S16] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S4
[S2] cosine check vs S4: cos=-0.0502
[S2] DROPPED delta from S4 (cos=-0.0502 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=-0.0429
[S6] DROPPED delta from S16 (cos=-0.0429 < 0.0)
[runner] rounds complete.
[runner] all agents stopped.
