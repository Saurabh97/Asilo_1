[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:38503
[S3] → join 127.0.0.1:38502
[S4] → join 127.0.0.1:38502
[S5] → join 127.0.0.1:38502
[S6] → join 127.0.0.1:38502
[S7] → join 127.0.0.1:38502
[S8] → join 127.0.0.1:38502
[S9] → join 127.0.0.1:38502
[S10] → join 127.0.0.1:38502
[S11] → join 127.0.0.1:38502
[S13] → join 127.0.0.1:38502
[S14] → join 127.0.0.1:38502
[S15] → join 127.0.0.1:38502
[S16] → join 127.0.0.1:38502
[S17] → join 127.0.0.1:38502
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.211775 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.144581 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.164267 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.160159 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.153047 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.136433 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.159391 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.123205 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.142548 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.192782 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.127094 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.115617 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.157192 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.208065 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.097664 (no previous merge yet)
[S6]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S3] + discovered S15
[S3] + discovered S6
[S3] + discovered S10
[S3] + discovered S14
[S3] + discovered S16
[S3] + discovered S9
[S3] + discovered S17
[S3] + discovered S7
[S3] + discovered S8
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S4
[S3] + discovered S11
[S3] + discovered S5
[S3] + discovered S13
[S5] + discovered S2
[S5] + discovered S4
[S5] + discovered S3
[S4] + discovered S11
[S4] + discovered S5
[S4] + discovered S13
[S4] + discovered S7
[S4] + discovered S15
[S4] + discovered S6
[S4] + discovered S14
[S4] + discovered S9
[S4] + discovered S16
[S4] + discovered S17
[S4] + discovered S10
[S4] + discovered S8
[S5] + discovered S9
[S5] + discovered S17
[S5] + discovered S13
[S5] + discovered S15
[S5] + discovered S8
[S5] + discovered S7
[S5] + discovered S6
[S5] + discovered S16
[S5] + discovered S14
[S5] + discovered S11
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S5
[S5] + discovered S10
[S6] + discovered S2
[S7] + discovered S5
[S7] + discovered S6
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S3
[S6] + discovered S10
[S6] + discovered S16
[S6] + discovered S11
[S6] + discovered S14
[S6] + discovered S8
[S6] + discovered S9
[S6] + discovered S15
[S6] + discovered S13
[S6] + discovered S7
[S6] + discovered S17
[S8] + discovered S4
[S8] + discovered S7
[S8] + discovered S6
[S8] + discovered S3
[S8] + discovered S2
[S8] + discovered S5
[S7] + discovered S16
[S7] + discovered S15
[S7] + discovered S9
[S7] + discovered S11
[S7] + discovered S17
[S7] + discovered S13
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S10
[S9] + discovered S7
[S9] + discovered S2
[S9] + discovered S8
[S8] + discovered S14
[S9] + discovered S5
[S9] + discovered S6
[S8] + discovered S10
[S9] + discovered S4
[S8] + discovered S17
[S8] + discovered S9
[S8] + discovered S11
[S8] + discovered S13
[S8] + discovered S15
[S8] + discovered S16
[S9] + discovered S3
[S9] + discovered S10
[S9] + discovered S13
[S10] + discovered S9
[S9] + discovered S15
[S9] + discovered S16
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S17
[S10] + discovered S3
[S10] + discovered S7
[S10] + discovered S6
[S10] + discovered S4
[S10] + discovered S5
[S10] + discovered S8
[S10] + discovered S2
[S11] + discovered S3
[S11] + discovered S7
[S11] + discovered S4
[S11] + discovered S9
[S11] + discovered S6
[S11] + discovered S5
[S11] + discovered S8
[S11] + discovered S10
[S10] + discovered S14
[S11] + discovered S2
[S10] + discovered S15
[S10] + discovered S11
[S10] + discovered S13
[S10] + discovered S17
[S10] + discovered S16
[S13] + discovered S8
[S13] + discovered S11
[S13] + discovered S2
[S13] + discovered S4
[S13] + discovered S9
[S13] + discovered S6
[S13] + discovered S7
[S13] + discovered S3
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S15
[S11] + discovered S14
[S11] + discovered S16
[S13] + discovered S10
[S13] + discovered S5
[S13] + discovered S16
[S14] + discovered S13
[S13] + discovered S17
[S14] + discovered S9
[S13] + discovered S14
[S14] + discovered S6
[S13] + discovered S15
[S14] + discovered S10
[S14] + discovered S4
[S14] + discovered S7
[S14] + discovered S8
[S14] + discovered S5
[S14] + discovered S2
[S14] + discovered S11
[S14] + discovered S3
[S15] + discovered S4
[S15] + discovered S7
[S15] + discovered S5
[S14] + discovered S15
[S14] + discovered S16
[S14] + discovered S17
[S15] + discovered S10
[S15] + discovered S9
[S15] + discovered S3
[S15] + discovered S6
[S15] + discovered S14
[S15] + discovered S11
[S15] + discovered S2
[S15] + discovered S8
[S15] + discovered S13
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S11
[S16] + discovered S14
[S16] + discovered S2
[S16] + discovered S8
[S16] + discovered S4
[S16] + discovered S15
[S16] + discovered S6
[S16] + discovered S3
[S16] + discovered S7
[S16] + discovered S13
[S16] + discovered S10
[S16] + discovered S9
[S16] + discovered S5
[S17] + discovered S5
[S17] + discovered S7
[S17] + discovered S16
[S17] + discovered S6
[S17] + discovered S11
[S17] + discovered S2
[S17] + discovered S14
[S17] + discovered S10
[S17] + discovered S4
[S16] + discovered S17
[S17] + discovered S8
[S17] + discovered S15
[S17] + discovered S3
[S17] + discovered S9
[S17] + discovered S13
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:38512
[S11] ⇄ pheromone p=1.000 → S14@127.0.0.1:38514
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:38516
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:38514
[S9] ⇄ pheromone p=1.000 → S6@127.0.0.1:38507
[S10] ⇄ pheromone p=1.000 → S13@127.0.0.1:38513
[S6] ⇄ pheromone p=1.000 → S9@127.0.0.1:38510
[S2] ⇄ pheromone p=1.000 → S5@127.0.0.1:38505
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:38512
[S8] ⇄ pheromone p=1.000 → S7@127.0.0.1:38508
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:38507
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:38511
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:38505
[S3] ⇄ pheromone p=1.000 → S5@127.0.0.1:38505
[S17] ⇄ pheromone p=1.000 → S9@127.0.0.1:38510
[S2] START round=1 head_norm_before_train=1.216448 (no previous merge yet)
[S2] round=1 local utility u=0.030807 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6235367110308967, 'loss_val': 1.2997335538440757, 'psi': 0.33448096444549874}-{'f1_val': 0.1417771333885667, 'auprc': 0.6151511108916999, 'loss_val': 1.3361915802922275, 'psi': 0.33112672438982}
[S3] START round=1 head_norm_before_train=1.164544 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8082372702565976, 'loss_val': 1.2638635548406405, 'psi': 0.4071989474711033}-{'f1_val': 0.13984006561410703, 'auprc': 0.9198134276251292, 'loss_val': 1.3285709208092649, 'psi': 0.4518294104185159}
[S4] START round=1 head_norm_before_train=1.168683 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7804569427376779, 'loss_val': 1.3292969129634504, 'psi': 0.3963187544321816}-{'f1_val': 0.3065553042884599, 'auprc': 0.7889490996098354, 'loss_val': 1.3655167153175791, 'psi': 0.4995128224170101}
[S5] START round=1 head_norm_before_train=1.171317 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.3112711433159977, 'auprc': 0.7687380205106406, 'loss_val': 1.2703348584657161, 'psi': 0.49425789419385485}-{'f1_val': 0.3936173862252974, 'auprc': 0.7633735153117318, 'loss_val': 1.328177259553898, 'psi': 0.5415198378598711}
[S6] START round=1 head_norm_before_train=1.148434 (no previous merge yet)
[S6] round=1 local utility u=0.842929 metrics={'f1_val': 0.16992046276211134, 'auprc': 0.6125677048331151, 'loss_val': 1.355919019839842, 'psi': 0.34697935959051285}-{'f1_val': 0.0015323199365994723, 'auprc': 0.3991134476928571, 'loss_val': 1.3910847069407049, 'psi': 0.16056477103910252}
[S7] START round=1 head_norm_before_train=1.154590 (no previous merge yet)
[S7] round=1 local utility u=0.043675 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7748919691768423, 'loss_val': 1.2868984713407652, 'psi': 0.39519088130819197}-{'f1_val': 0.14205682272909165, 'auprc': 0.7599781089916018, 'loss_val': 1.3295078112116152, 'psi': 0.38922533723409575}
[S8] START round=1 head_norm_before_train=1.165725 (no previous merge yet)
[S8] round=1 local utility u=1.000000 metrics={'f1_val': 0.7146988268482762, 'auprc': 0.7826910513429564, 'loss_val': 1.3349701616507306, 'psi': 0.7418957166461483}-{'f1_val': 0.2562225396177651, 'auprc': 0.6284809634079325, 'loss_val': 1.3654206675687686, 'psi': 0.40512590913383206}
[S9] START round=1 head_norm_before_train=1.128514 (no previous merge yet)
[S9] round=1 local utility u=0.182475 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9591997137185564, 'loss_val': 1.2294546269418323, 'psi': 0.4685186597714202}-{'f1_val': 0.141397957139996, 'auprc': 0.8662029339465165, 'loss_val': 1.3154145704011262, 'psi': 0.43131994786260425}
[S10] START round=1 head_norm_before_train=1.152993 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5076307261728062, 'loss_val': 1.316622462200915, 'psi': 0.2862252729941569}-{'f1_val': 0.13862163754172394, 'auprc': 0.54968027305982, 'loss_val': 1.3483422258148565, 'psi': 0.3030450917489624}
[S11] START round=1 head_norm_before_train=1.193289 (no previous merge yet)
[S11] round=1 local utility u=1.000000 metrics={'f1_val': 0.39127458302215584, 'auprc': 0.7056851807248931, 'loss_val': 1.3409538326738129, 'psi': 0.5170388221032507}-{'f1_val': 0.07124394184168013, 'auprc': 0.4769611369725, 'loss_val': 1.3789514614104261, 'psi': 0.2335308198940081}
[S13] START round=1 head_norm_before_train=1.140516 (no previous merge yet)
[S13] round=1 local utility u=0.161315 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5323982909278568, 'loss_val': 1.3030533978241179, 'psi': 0.2971907739173746}-{'f1_val': 0.10586126316463396, 'auprc': 0.507852220347773, 'loss_val': 1.3448983821295346, 'psi': 0.2666576460378896}
[S14] START round=1 head_norm_before_train=1.121412 (no previous merge yet)
[S14] round=1 local utility u=0.283876 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7425920984916964, 'loss_val': 1.3353058299942788, 'psi': 0.3812515511263008}-{'f1_val': 0.14035785288270378, 'auprc': 0.5609763148032291, 'loss_val': 1.3582113620015863, 'psi': 0.3086052376509139}
[S15] START round=1 head_norm_before_train=1.157798 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7447018033243225, 'loss_val': 1.3492640685354007, 'psi': 0.381720912146664}-{'f1_val': 0.21606802534803762, 'auprc': 0.6966576915355853, 'loss_val': 1.374489804975811, 'psi': 0.4083038918230567}
[S16] START round=1 head_norm_before_train=1.213629 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6431786243117644, 'loss_val': 1.3157419639239007, 'psi': 0.34165391984422766}-{'f1_val': 0.14063745019920318, 'auprc': 0.6750561350839257, 'loss_val': 1.3405779781791127, 'psi': 0.3544049241530922}
[S17] START round=1 head_norm_before_train=1.098039 (no previous merge yet)
[S17] round=1 local utility u=0.328050 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6614846382380173, 'loss_val': 1.3400758772626777, 'psi': 0.34916323328563753}-{'f1_val': 0.14094896331738438, 'auprc': 0.4501939581494818, 'loss_val': 1.3623037928155812, 'psi': 0.26464696125022336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:38502
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:38517
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:38509
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:38507
[S6] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S13
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.163731)
[S8] loaded HEAD from S13 (vec_in norm=1.163731)
[S8] cosine check vs S13: cos=-0.1556
[S8] DROPPED delta from S13 (cos=-0.1556 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.185474)
[S16] loaded HEAD from S7 (vec_in norm=1.185474)
[S16] cosine check vs S7: cos=0.0606
[S16] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1794) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.180442)
[S6] loaded HEAD from S8 (vec_in norm=1.180442)
[S6] cosine check vs S8: cos=-0.0114
[S6] DROPPED delta from S8 (cos=-0.0114 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1790) from S14
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.134124)
[S6] loaded HEAD from S14 (vec_in norm=1.134124)
[S6] cosine check vs S14: cos=-0.0204
[S6] DROPPED delta from S14 (cos=-0.0204 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1791) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.202981)
[S2] loaded HEAD from S11 (vec_in norm=1.202981)
[S2] cosine check vs S11: cos=0.0885
[S2] BUFFERED delta from S11 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.167302)
[S17] loaded HEAD from S9 (vec_in norm=1.167302)
[S17] cosine check vs S9: cos=0.0259
[S17] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1792) from S2
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.229060)
[S14] loaded HEAD from S2 (vec_in norm=1.229060)
[S14] cosine check vs S2: cos=0.1412
[S14] BUFFERED delta from S2 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1791) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.153919)
[S16] loaded HEAD from S6 (vec_in norm=1.153919)
[S16] cosine check vs S6: cos=-0.0279
[S16] DROPPED delta from S6 (cos=-0.0279 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:38513
[S17] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.107172)
[S13] loaded HEAD from S17 (vec_in norm=1.107172)
[S13] cosine check vs S17: cos=0.1210
[S13] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.1404 head_norm=1.163731
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.530302e-01
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.4159 head_norm=0.850291 delta_norm=0.753030
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.229060
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.209989e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.897127 delta_norm=0.820999
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.1404 head_norm=1.134124
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.750908e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.893111 delta_norm=0.775091
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.227545
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.270026e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.878734 delta_norm=0.827003
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.107172
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.939560e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.814768 delta_norm=0.793956
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.897127 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.010573 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6339118757866478, 'loss_val': 1.3097134350688235, 'psi': 0.3386310303477992}-{'f1_val': 0.1417771333885667, 'auprc': 0.6235367110308967, 'loss_val': 1.2997335538440757, 'psi': 0.33448096444549874}
[S3] START round=2 head_norm_before_train=1.207032 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6205058023578032, 'loss_val': 1.1838484198151866, 'psi': 0.33210636031158547}-{'f1_val': 0.13984006561410703, 'auprc': 0.8082372702565976, 'loss_val': 1.2638635548406405, 'psi': 0.4071989474711033}
[S4] START round=2 head_norm_before_train=1.184474 (no previous merge yet)
[S4] round=2 local utility u=0.028053 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7834812576439673, 'loss_val': 1.2822637748395853, 'psi': 0.3975284803946974}-{'f1_val': 0.14022662889518414, 'auprc': 0.7804569427376779, 'loss_val': 1.3292969129634504, 'psi': 0.3963187544321816}
[S5] START round=2 head_norm_before_train=1.209344 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7535192224528495, 'loss_val': 1.1653415985539082, 'psi': 0.3867648318382827}-{'f1_val': 0.3112711433159977, 'auprc': 0.7687380205106406, 'loss_val': 1.2703348584657161, 'psi': 0.49425789419385485}
[S6] START round=2 head_norm_before_train=1.153919 (no previous merge yet)
[S6] round=2 local utility u=0.068189 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7019184733620876, 'loss_val': 1.3166279912270835, 'psi': 0.36562315857560423}-{'f1_val': 0.16992046276211134, 'auprc': 0.6125677048331151, 'loss_val': 1.355919019839842, 'psi': 0.34697935959051285}
[S7] START round=2 head_norm_before_train=1.185474 (no previous merge yet)
[S7] round=2 local utility u=0.024129 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776808883300861, 'loss_val': 1.2470079051373122, 'psi': 0.39630644896948947}-{'f1_val': 0.14205682272909165, 'auprc': 0.7748919691768423, 'loss_val': 1.2868984713407652, 'psi': 0.39519088130819197}
[S8] START round=2 head_norm_before_train=1.180442 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7826933573900605, 'loss_val': 1.2974945085472531, 'psi': 0.39705093239179856}-{'f1_val': 0.7146988268482762, 'auprc': 0.7826910513429564, 'loss_val': 1.3349701616507306, 'psi': 0.7418957166461483}
[S9] START round=2 head_norm_before_train=1.167302 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.866330317537661, 'loss_val': 1.1148161695267567, 'psi': 0.431370901299062}-{'f1_val': 0.141397957139996, 'auprc': 0.9591997137185564, 'loss_val': 1.2294546269418323, 'psi': 0.4685186597714202}
[S10] START round=2 head_norm_before_train=1.172591 (no previous merge yet)
[S10] round=2 local utility u=0.213873 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6387982951838901, 'loss_val': 1.2823788167382768, 'psi': 0.3386923005985904}-{'f1_val': 0.13862163754172394, 'auprc': 0.5076307261728062, 'loss_val': 1.316622462200915, 'psi': 0.2862252729941569}
[S11] START round=2 head_norm_before_train=1.202981 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8202486679823402, 'loss_val': 1.2929453731895875, 'psi': 0.41234767721680243}-{'f1_val': 0.39127458302215584, 'auprc': 0.7056851807248931, 'loss_val': 1.3409538326738129, 'psi': 0.5170388221032507}
[S13] START round=2 head_norm_before_train=0.850291 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.059541 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5723731167699372, 'loss_val': 1.303896646073415, 'psi': 0.31318070425420674}-{'f1_val': 0.1403857625770531, 'auprc': 0.5323982909278568, 'loss_val': 1.3030533978241179, 'psi': 0.2971907739173746}
[S14] START round=2 head_norm_before_train=0.893111 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7405194191428173, 'loss_val': 1.3351785218276204, 'psi': 0.38042247938674917}-{'f1_val': 0.14035785288270378, 'auprc': 0.7425920984916964, 'loss_val': 1.3353058299942788, 'psi': 0.3812515511263008}
[S15] START round=2 head_norm_before_train=1.164306 (no previous merge yet)
[S15] round=2 local utility u=0.025768 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7514983313041923, 'loss_val': 1.3181180015735983, 'psi': 0.3844395233386119}-{'f1_val': 0.13973365136155833, 'auprc': 0.7447018033243225, 'loss_val': 1.3492640685354007, 'psi': 0.381720912146664}
[S16] START round=2 head_norm_before_train=0.878734 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.337455 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8658560868435428, 'loss_val': 1.308863440699138, 'psi': 0.43072490485693904}-{'f1_val': 0.14063745019920318, 'auprc': 0.6431786243117644, 'loss_val': 1.3157419639239007, 'psi': 0.34165391984422766}
[S17] START round=2 head_norm_before_train=0.814768 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6567062774048014, 'loss_val': 1.3414635962370767, 'psi': 0.3472518889523512}-{'f1_val': 0.14094896331738438, 'auprc': 0.6614846382380173, 'loss_val': 1.3400758772626777, 'psi': 0.34916323328563753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:38515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38516
[S6] not sending this round → trigger blocked (psi=0.366)
[S13] not sending this round → trigger blocked (psi=0.313)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:38502
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S15] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:38513
[S7] not sending this round → trigger blocked (psi=0.396)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.339)
[S15] sending update (kind=head size=1788 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S10
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.197549)
[S16] loaded HEAD from S10 (vec_in norm=1.197549)
[S16] cosine check vs S10: cos=0.0458
[S16] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1791) from S4
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.211406)
[S15] loaded HEAD from S4 (vec_in norm=1.211406)
[S15] cosine check vs S4: cos=0.0850
[S15] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1797) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.904271)
[S2] loaded HEAD from S16 (vec_in norm=0.904271)
[S2] cosine check vs S16: cos=-0.0990
[S2] DROPPED delta from S16 (cos=-0.0990 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1788) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.181243)
[S13] loaded HEAD from S15 (vec_in norm=1.181243)
[S13] cosine check vs S15: cos=-0.0180
[S13] DROPPED delta from S15 (cos=-0.0180 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=0.904271
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.336071e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.766639 delta_norm=0.733607
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=2 metric=0.1397 head_norm=1.181243
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.092757e-01
[S15] stored merged vector for next round verification (round=2)
[S15] DEBUG after merge:  round=2 metric=0.1397 head_norm=0.881188 delta_norm=0.809276
[S15] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.910798 cos_to_last_merge=0.9973 (last merge round=1)
[S2] round=3 local utility u=0.114751 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.693802455652872, 'loss_val': 1.2598832300699754, 'psi': 0.36258726229428884}-{'f1_val': 0.1417771333885667, 'auprc': 0.6339118757866478, 'loss_val': 1.3097134350688235, 'psi': 0.3386310303477992}
[S3] START round=3 head_norm_before_train=1.258591 (no previous merge yet)
[S3] round=3 local utility u=0.340555 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7949030125333805, 'loss_val': 1.025930984826804, 'psi': 0.4018652443818165}-{'f1_val': 0.13984006561410703, 'auprc': 0.6205058023578032, 'loss_val': 1.1838484198151866, 'psi': 0.33210636031158547}
[S4] START round=3 head_norm_before_train=1.211406 (no previous merge yet)
[S4] round=3 local utility u=0.031884 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7827978496122986, 'loss_val': 1.2164456284650933, 'psi': 0.39725511718202994}-{'f1_val': 0.14022662889518414, 'auprc': 0.7834812576439673, 'loss_val': 1.2822637748395853, 'psi': 0.3975284803946974}
[S5] START round=3 head_norm_before_train=1.259348 (no previous merge yet)
[S5] round=3 local utility u=0.949644 metrics={'f1_val': 0.4192835091012374, 'auprc': 0.770179676096723, 'loss_val': 0.9781639063430811, 'psi': 0.5596419758994317}-{'f1_val': 0.14226190476190476, 'auprc': 0.7535192224528495, 'loss_val': 1.1653415985539082, 'psi': 0.3867648318382827}
[S6] START round=3 head_norm_before_train=1.172081 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6337989153646826, 'loss_val': 1.2717741551833728, 'psi': 0.33837533537664227}-{'f1_val': 0.14142628205128205, 'auprc': 0.7019184733620876, 'loss_val': 1.3166279912270835, 'psi': 0.36562315857560423}
[S7] START round=3 head_norm_before_train=1.214525 (no previous merge yet)
[S7] round=3 local utility u=0.024799 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778261697586298, 'loss_val': 1.1978452670651711, 'psi': 0.39636456154090693}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776808883300861, 'loss_val': 1.2470079051373122, 'psi': 0.39630644896948947}
[S8] START round=3 head_norm_before_train=1.205909 (no previous merge yet)
[S8] round=3 local utility u=0.005172 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.771017556480539, 'loss_val': 1.2521224330151217, 'psi': 0.39238061202798996}-{'f1_val': 0.13995598239295717, 'auprc': 0.7826933573900605, 'loss_val': 1.2974945085472531, 'psi': 0.39705093239179856}
[S9] START round=3 head_norm_before_train=1.222955 (no previous merge yet)
[S9] round=3 local utility u=1.000000 metrics={'f1_val': 0.4165724968026165, 'auprc': 0.9797562944295893, 'loss_val': 0.8421352354652447, 'psi': 0.6418460158534056}-{'f1_val': 0.141397957139996, 'auprc': 0.866330317537661, 'loss_val': 1.1148161695267567, 'psi': 0.431370901299062}
[S10] START round=3 head_norm_before_train=1.197549 (no previous merge yet)
[S10] round=3 local utility u=0.017370 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6388792793616727, 'loss_val': 1.247881339464716, 'psi': 0.3387246942697034}-{'f1_val': 0.13862163754172394, 'auprc': 0.6387982951838901, 'loss_val': 1.2823788167382768, 'psi': 0.3386923005985904}
[S11] START round=3 head_norm_before_train=1.221792 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7977924242933003, 'loss_val': 1.225600264743971, 'psi': 0.4033651797411865}-{'f1_val': 0.14041368337311058, 'auprc': 0.8202486679823402, 'loss_val': 1.2929453731895875, 'psi': 0.41234767721680243}
[S13] START round=3 head_norm_before_train=0.872364 cos_to_last_merge=0.9971 (last merge round=1)
[S13] round=3 local utility u=0.196888 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6879438526765205, 'loss_val': 1.2568335351238287, 'psi': 0.35940899861684006}-{'f1_val': 0.1403857625770531, 'auprc': 0.5723731167699372, 'loss_val': 1.303896646073415, 'psi': 0.31318070425420674}
[S14] START round=3 head_norm_before_train=0.908807 cos_to_last_merge=0.9971 (last merge round=1)
[S14] round=3 local utility u=0.013447 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7404440190927086, 'loss_val': 1.308058579599794, 'psi': 0.3803923193667057}-{'f1_val': 0.14035785288270378, 'auprc': 0.7405194191428173, 'loss_val': 1.3351785218276204, 'psi': 0.38042247938674917}
[S15] START round=3 head_norm_before_train=0.881188 cos_to_last_merge=1.0000 (last merge round=2)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7357645622912886, 'loss_val': 1.3145760451873183, 'psi': 0.37814601573345047}-{'f1_val': 0.13973365136155833, 'auprc': 0.7514983313041923, 'loss_val': 1.3181180015735983, 'psi': 0.3844395233386119}
[S16] START round=3 head_norm_before_train=0.766639 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.172940 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.977460987165285, 'loss_val': 1.297797603782431, 'psi': 0.47536686498563596}-{'f1_val': 0.14063745019920318, 'auprc': 0.8658560868435428, 'loss_val': 1.308863440699138, 'psi': 0.43072490485693904}
[S17] START round=3 head_norm_before_train=0.825791 cos_to_last_merge=0.9964 (last merge round=1)
[S17] round=3 local utility u=0.269687 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8270097994763541, 'loss_val': 1.313000316732212, 'psi': 0.4153732977809723}-{'f1_val': 0.14094896331738438, 'auprc': 0.6567062774048014, 'loss_val': 1.3414635962370767, 'psi': 0.3472518889523512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:38514
[S4] not sending this round → trigger blocked (psi=0.397)
[S16] not sending this round → trigger blocked (psi=0.475)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.339)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:38505
[S8] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.241925)
[S14] loaded HEAD from S7 (vec_in norm=1.241925)
[S14] cosine check vs S7: cos=-0.0239
[S14] DROPPED delta from S7 (cos=-0.0239 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.287854)
[S14] loaded HEAD from S9 (vec_in norm=1.287854)
[S14] cosine check vs S9: cos=-0.0553
[S14] DROPPED delta from S9 (cos=-0.0553 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.310247)
[S16] loaded HEAD from S5 (vec_in norm=1.310247)
[S16] cosine check vs S5: cos=0.0461
[S16] BUFFERED delta from S5 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.933088)
[S5] loaded HEAD from S2 (vec_in norm=0.933088)
[S5] cosine check vs S2: cos=0.0367
[S5] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.932869)
[S5] loaded HEAD from S14 (vec_in norm=0.932869)
[S5] cosine check vs S14: cos=0.0498
[S5] BUFFERED delta from S14 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1795) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.303229)
[S5] loaded HEAD from S3 (vec_in norm=1.303229)
[S5] cosine check vs S3: cos=0.0115
[S5] BUFFERED delta from S3 (total buffered=3)
[S9] RECEIVED delta(kind=head bytes=1793) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.902101)
[S9] loaded HEAD from S13 (vec_in norm=0.902101)
[S9] cosine check vs S13: cos=0.0597
[S9] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.238508)
[S7] loaded HEAD from S8 (vec_in norm=1.238508)
[S7] cosine check vs S8: cos=-0.0361
[S7] DROPPED delta from S8 (cos=-0.0361 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.848009)
[S9] loaded HEAD from S17 (vec_in norm=0.848009)
[S9] cosine check vs S17: cos=0.6925
[S9] BUFFERED delta from S17 (total buffered=2)
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.4193 head_norm=1.310247
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.284659e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.4189 head_norm=0.760346 delta_norm=0.728466
[S5] aggregate: ACCEPT kept=['S2', 'S14', 'S3'] (k=3/3) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.4166 head_norm=1.287854
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.942377e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.4362 head_norm=0.875181 delta_norm=0.594238
[S9] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=0.792140
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.497578e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1864 head_norm=0.781012 delta_norm=0.749758
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.933088 cos_to_last_merge=0.9899 (last merge round=1)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6204584548687191, 'loss_val': 1.2005101935438902, 'psi': 0.33324966198062766}-{'f1_val': 0.1417771333885667, 'auprc': 0.693802455652872, 'loss_val': 1.2598832300699754, 'psi': 0.36258726229428884}
[S3] START round=4 head_norm_before_train=1.303229 (no previous merge yet)
[S3] round=4 local utility u=1.000000 metrics={'f1_val': 0.6978131995858821, 'auprc': 0.9968870187252621, 'loss_val': 0.7627221931732586, 'psi': 0.817442727241634}-{'f1_val': 0.13984006561410703, 'auprc': 0.7949030125333805, 'loss_val': 1.025930984826804, 'psi': 0.4018652443818165}
[S4] START round=4 head_norm_before_train=1.246218 (no previous merge yet)
[S4] round=4 local utility u=0.053180 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.782132984533276, 'loss_val': 1.1080917587249794, 'psi': 0.39698917115042087}-{'f1_val': 0.14022662889518414, 'auprc': 0.7827978496122986, 'loss_val': 1.2164456284650933, 'psi': 0.39725511718202994}
[S5] START round=4 head_norm_before_train=0.760346 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.342962 metrics={'f1_val': 0.5077442146045499, 'auprc': 0.7863013463205595, 'loss_val': 0.8713687303462665, 'psi': 0.6191670672909537}-{'f1_val': 0.4192835091012374, 'auprc': 0.770179676096723, 'loss_val': 0.9781639063430811, 'psi': 0.5596419758994317}
[S6] START round=4 head_norm_before_train=1.198773 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6168639032739984, 'loss_val': 1.2442427986423883, 'psi': 0.3316013305403686}-{'f1_val': 0.14142628205128205, 'auprc': 0.6337989153646826, 'loss_val': 1.2717741551833728, 'psi': 0.33837533537664227}
[S7] START round=4 head_norm_before_train=1.241925 (no previous merge yet)
[S7] round=4 local utility u=0.065698 metrics={'f1_val': 0.1440851473234893, 'auprc': 0.7775668804485404, 'loss_val': 1.0778406586904146, 'psi': 0.39747784057350977}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778261697586298, 'loss_val': 1.1978452670651711, 'psi': 0.39636456154090693}
[S8] START round=4 head_norm_before_train=1.238508 (no previous merge yet)
[S8] round=4 local utility u=0.026645 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7710299822908112, 'loss_val': 1.1988689491479387, 'psi': 0.3923855823520988}-{'f1_val': 0.13995598239295717, 'auprc': 0.771017556480539, 'loss_val': 1.2521224330151217, 'psi': 0.39238061202798996}
[S9] START round=4 head_norm_before_train=0.875181 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.278170 metrics={'f1_val': 0.5358109789164107, 'auprc': 0.8655965887442193, 'loss_val': 0.6587479612922268, 'psi': 0.6677252228475341}-{'f1_val': 0.4165724968026165, 'auprc': 0.9797562944295893, 'loss_val': 0.8421352354652447, 'psi': 0.6418460158534056}
[S10] START round=4 head_norm_before_train=1.222129 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6190005713904663, 'loss_val': 1.2042192912424083, 'psi': 0.3307732110812209}-{'f1_val': 0.13862163754172394, 'auprc': 0.6388792793616727, 'loss_val': 1.247881339464716, 'psi': 0.3387246942697034}
[S11] START round=4 head_norm_before_train=1.251255 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7455711578158039, 'loss_val': 1.1565559012131472, 'psi': 0.3824766731501879}-{'f1_val': 0.14041368337311058, 'auprc': 0.7977924242933003, 'loss_val': 1.225600264743971, 'psi': 0.4033651797411865}
[S13] START round=4 head_norm_before_train=0.902101 cos_to_last_merge=0.9898 (last merge round=1)
[S13] round=4 local utility u=0.053678 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7063580036879069, 'loss_val': 1.2047190159255536, 'psi': 0.3667746590213946}-{'f1_val': 0.1403857625770531, 'auprc': 0.6879438526765205, 'loss_val': 1.2568335351238287, 'psi': 0.35940899861684006}
[S14] START round=4 head_norm_before_train=0.932869 cos_to_last_merge=0.9891 (last merge round=1)
[S14] round=4 local utility u=0.017560 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7395784276598215, 'loss_val': 1.2703418446121983, 'psi': 0.38004608279355084}-{'f1_val': 0.14035785288270378, 'auprc': 0.7404440190927086, 'loss_val': 1.308058579599794, 'psi': 0.3803923193667057}
[S15] START round=4 head_norm_before_train=0.901460 cos_to_last_merge=0.9973 (last merge round=2)
[S15] round=4 local utility u=0.052833 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.760187555011738, 'loss_val': 1.2821781573499462, 'psi': 0.3879152128216302}-{'f1_val': 0.13973365136155833, 'auprc': 0.7357645622912886, 'loss_val': 1.3145760451873183, 'psi': 0.37814601573345047}
[S16] START round=4 head_norm_before_train=0.781012 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.167458432304038, 'auprc': 0.6498375030021154, 'loss_val': 1.3087939414968361, 'psi': 0.36041006058326897}-{'f1_val': 0.14063745019920318, 'auprc': 0.977460987165285, 'loss_val': 1.297797603782431, 'psi': 0.47536686498563596}
[S17] START round=4 head_norm_before_train=0.848009 cos_to_last_merge=0.9858 (last merge round=1)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6024332674473576, 'loss_val': 1.2558908936028388, 'psi': 0.32554268496937366}-{'f1_val': 0.14094896331738438, 'auprc': 0.8270097994763541, 'loss_val': 1.313000316732212, 'psi': 0.4153732977809723}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S15] → sending delta(kind=head bytes=1787) to S5@127.0.0.1:38505
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:38512
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.817)
[S7] not sending this round → trigger blocked (psi=0.397)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.367)
[S5] not sending this round → trigger blocked (psi=0.619)
[S14] not sending this round → trigger blocked (psi=0.380)
[S8] not sending this round → trigger blocked (psi=0.392)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.668)
[S4] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1787 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1791) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.291076)
[S11] loaded HEAD from S4 (vec_in norm=1.291076)
[S11] cosine check vs S4: cos=0.0072
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1787) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.929852)
[S5] loaded HEAD from S15 (vec_in norm=0.929852)
[S5] cosine check vs S15: cos=-0.0084
[S5] DROPPED delta from S15 (cos=-0.0084 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=1.284200
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.072183e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.913772 delta_norm=0.907218
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.961267 cos_to_last_merge=0.9790 (last merge round=1)
[S2] round=5 local utility u=0.113469 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6745120358801061, 'loss_val': 1.1357332741550226, 'psi': 0.3548710943851825}-{'f1_val': 0.1417771333885667, 'auprc': 0.6204584548687191, 'loss_val': 1.2005101935438902, 'psi': 0.33324966198062766}
[S3] START round=5 head_norm_before_train=1.369980 (no previous merge yet)
[S3] round=5 local utility u=0.090489 metrics={'f1_val': 0.6995786553134029, 'auprc': 0.9988286389154065, 'loss_val': 0.5981610925564594, 'psi': 0.8192786487542043}-{'f1_val': 0.6978131995858821, 'auprc': 0.9968870187252621, 'loss_val': 0.7627221931732586, 'psi': 0.817442727241634}
[S4] START round=5 head_norm_before_train=1.291076 (no previous merge yet)
[S4] round=5 local utility u=0.904088 metrics={'f1_val': 0.4148091473984988, 'auprc': 0.7847817201901817, 'loss_val': 0.9553562095543924, 'psi': 0.5627981765151719}-{'f1_val': 0.14022662889518414, 'auprc': 0.782132984533276, 'loss_val': 1.1080917587249794, 'psi': 0.39698917115042087}
[S5] START round=5 head_norm_before_train=0.829324 cos_to_last_merge=0.9914 (last merge round=3)
[S5] round=5 local utility u=0.727196 metrics={'f1_val': 0.7146275168069246, 'auprc': 0.7946219170841236, 'loss_val': 0.6832387357471832, 'psi': 0.7466252769178041}-{'f1_val': 0.5077442146045499, 'auprc': 0.7863013463205595, 'loss_val': 0.8713687303462665, 'psi': 0.6191670672909537}
[S6] START round=5 head_norm_before_train=1.224666 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.5979404838864367, 'loss_val': 1.2184254719685697, 'psi': 0.3240319627853439}-{'f1_val': 0.14142628205128205, 'auprc': 0.6168639032739984, 'loss_val': 1.2442427986423883, 'psi': 0.3316013305403686}
[S7] START round=5 head_norm_before_train=1.270103 (no previous merge yet)
[S7] round=5 local utility u=1.000000 metrics={'f1_val': 0.6747278758406737, 'auprc': 0.7770165648906456, 'loss_val': 0.9053128930902852, 'psi': 0.7156433514606626}-{'f1_val': 0.1440851473234893, 'auprc': 0.7775668804485404, 'loss_val': 1.0778406586904146, 'psi': 0.39747784057350977}
[S8] START round=5 head_norm_before_train=1.274528 (no previous merge yet)
[S8] round=5 local utility u=0.128763 metrics={'f1_val': 0.15813806076717563, 'auprc': 0.7941308647259037, 'loss_val': 1.1197382130861457, 'psi': 0.4125351823506669}-{'f1_val': 0.13995598239295717, 'auprc': 0.7710299822908112, 'loss_val': 1.1988689491479387, 'psi': 0.3923855823520988}
[S9] START round=5 head_norm_before_train=0.969106 cos_to_last_merge=0.9921 (last merge round=3)
[S9] round=5 local utility u=0.829135 metrics={'f1_val': 0.7017906989076834, 'auprc': 0.998853961943493, 'loss_val': 0.39612848913493703, 'psi': 0.8206160041220072}-{'f1_val': 0.5358109789164107, 'auprc': 0.8655965887442193, 'loss_val': 0.6587479612922268, 'psi': 0.6677252228475341}
[S10] START round=5 head_norm_before_train=1.244429 (no previous merge yet)
[S10] round=5 local utility u=0.067249 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6432490380256162, 'loss_val': 1.142465866457978, 'psi': 0.3404725977352808}-{'f1_val': 0.13862163754172394, 'auprc': 0.6190005713904663, 'loss_val': 1.2042192912424083, 'psi': 0.3307732110812209}
[S11] START round=5 head_norm_before_train=0.913772 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6470522387400999, 'loss_val': 1.1262070391364047, 'psi': 0.3430691055199063}-{'f1_val': 0.14041368337311058, 'auprc': 0.7455711578158039, 'loss_val': 1.1565559012131472, 'psi': 0.3824766731501879}
[S13] START round=5 head_norm_before_train=0.935472 cos_to_last_merge=0.9805 (last merge round=1)
[S13] round=5 local utility u=0.732948 metrics={'f1_val': 0.4152892684755862, 'auprc': 0.6233950611264845, 'loss_val': 1.1393544469351926, 'psi': 0.4985315855359455}-{'f1_val': 0.1403857625770531, 'auprc': 0.7063580036879069, 'loss_val': 1.2047190159255536, 'psi': 0.3667746590213946}
[S14] START round=5 head_norm_before_train=0.965529 cos_to_last_merge=0.9773 (last merge round=1)
[S14] round=5 local utility u=0.031774 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7374783389862573, 'loss_val': 1.200494445382633, 'psi': 0.37920604732412516}-{'f1_val': 0.14035785288270378, 'auprc': 0.7395784276598215, 'loss_val': 1.2703418446121983, 'psi': 0.38004608279355084}
[S15] START round=5 head_norm_before_train=0.929852 cos_to_last_merge=0.9898 (last merge round=2)
[S15] round=5 local utility u=0.029369 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7747573047679371, 'loss_val': 1.2671490972561223, 'psi': 0.3937431127241099}-{'f1_val': 0.13973365136155833, 'auprc': 0.760187555011738, 'loss_val': 1.2821781573499462, 'psi': 0.3879152128216302}
[S16] START round=5 head_norm_before_train=0.800076 cos_to_last_merge=0.9951 (last merge round=3)
[S16] round=5 local utility u=0.773727 metrics={'f1_val': 0.41543156524429936, 'auprc': 0.641841369712636, 'loss_val': 1.2251898676729933, 'psi': 0.505995487031634}-{'f1_val': 0.167458432304038, 'auprc': 0.6498375030021154, 'loss_val': 1.3087939414968361, 'psi': 0.36041006058326897}
[S17] START round=5 head_norm_before_train=0.882662 cos_to_last_merge=0.9687 (last merge round=1)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5676393835183227, 'loss_val': 1.1542582323439536, 'psi': 0.3116251313977597}-{'f1_val': 0.14094896331738438, 'auprc': 0.6024332674473576, 'loss_val': 1.2558908936028388, 'psi': 0.32554268496937366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:38514
[S15] not sending this round → trigger blocked (psi=0.394)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:38507
[S4] not sending this round → trigger blocked (psi=0.563)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1792) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.308830)
[S7] loaded HEAD from S8 (vec_in norm=1.308830)
[S7] cosine check vs S8: cos=-0.0323
[S7] DROPPED delta from S8 (cos=-0.0323 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.902833)
[S16] loaded HEAD from S5 (vec_in norm=0.902833)
[S16] cosine check vs S5: cos=0.7413
[S16] BUFFERED delta from S5 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1793) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.832905)
[S6] loaded HEAD from S16 (vec_in norm=0.832905)
[S6] cosine check vs S16: cos=0.0171
[S6] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.312748)
[S14] loaded HEAD from S7 (vec_in norm=1.312748)
[S14] cosine check vs S7: cos=-0.0224
[S14] DROPPED delta from S7 (cos=-0.0224 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.265561)
[S5] loaded HEAD from S10 (vec_in norm=1.265561)
[S5] cosine check vs S10: cos=0.0997
[S5] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1793) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.994343)
[S5] loaded HEAD from S2 (vec_in norm=0.994343)
[S5] cosine check vs S2: cos=0.3541
[S5] BUFFERED delta from S2 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1802) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.008987)
[S5] loaded HEAD from S14 (vec_in norm=1.008987)
[S5] cosine check vs S14: cos=0.3828
[S5] BUFFERED delta from S14 (total buffered=3)
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.965817)
[S9] loaded HEAD from S13 (vec_in norm=0.965817)
[S9] cosine check vs S13: cos=0.3325
[S9] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1790) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.088571)
[S14] loaded HEAD from S9 (vec_in norm=1.088571)
[S14] cosine check vs S9: cos=-0.0329
[S14] DROPPED delta from S9 (cos=-0.0329 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.449759)
[S5] loaded HEAD from S3 (vec_in norm=1.449759)
[S5] cosine check vs S3: cos=0.1192
[S5] BUFFERED delta from S3 (total buffered=4)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.410 → S9@127.0.0.1:38510
[S4] ⇄ pheromone p=0.524 → S11@127.0.0.1:38512
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=1.243001
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.421955e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.754014 delta_norm=0.742196
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.404 → S4@127.0.0.1:38504
[S7] ⇄ pheromone p=0.547 → S14@127.0.0.1:38514
[S10] ⇄ pheromone p=0.365 → S5@127.0.0.1:38505
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.7018 head_norm=1.088571
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.955166e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.7018 head_norm=0.839199 delta_norm=0.595517
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.681 → S14@127.0.0.1:38514
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.4154 head_norm=0.832905
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.138404e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1863 head_norm=0.809891 delta_norm=0.313840
[S16] aggregate: ROLLBACK (f1_val pre=0.415 post=0.186 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.539 → S6@127.0.0.1:38507
[S2] ⇄ pheromone p=0.369 → S5@127.0.0.1:38505
[S14] ⇄ pheromone p=0.362 → S5@127.0.0.1:38505
[S8] ⇄ pheromone p=0.440 → S7@127.0.0.1:38508
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.7146 head_norm=0.902833
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.251507e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.7146 head_norm=0.665406 delta_norm=0.425151
[S5] aggregate: ACCEPT kept=['S10', 'S2', 'S14', 'S3'] (k=4/4) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.650 → S16@127.0.0.1:38516
[S13] ⇄ pheromone p=0.527 → S9@127.0.0.1:38510
[S3] ⇄ pheromone p=0.549 → S5@127.0.0.1:38505
[S15] ⇄ pheromone p=0.345 → S5@127.0.0.1:38505
[S17] ⇄ pheromone p=0.389 → S9@127.0.0.1:38510
[S2] START round=6 head_norm_before_train=0.994343 cos_to_last_merge=0.9660 (last merge round=1)
[S2] round=6 local utility u=1.000000 metrics={'f1_val': 0.4162163375000623, 'auprc': 0.7788712570176802, 'loss_val': 1.0582249352932498, 'psi': 0.5612783053071095}-{'f1_val': 0.1417771333885667, 'auprc': 0.6745120358801061, 'loss_val': 1.1357332741550226, 'psi': 0.3548710943851825}
[S3] START round=6 head_norm_before_train=1.449759 (no previous merge yet)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.7003355634446948, 'auprc': 0.8748218354679338, 'loss_val': 0.47833100819869656, 'psi': 0.7701300722539903}-{'f1_val': 0.6995786553134029, 'auprc': 0.9988286389154065, 'loss_val': 0.5981610925564594, 'psi': 0.8192786487542043}
[S4] START round=6 head_norm_before_train=1.338029 (no previous merge yet)
[S4] round=6 local utility u=0.661272 metrics={'f1_val': 0.6681172398875189, 'auprc': 0.6583070984392275, 'loss_val': 0.7732377505437598, 'psi': 0.6641931833082024}-{'f1_val': 0.4148091473984988, 'auprc': 0.7847817201901817, 'loss_val': 0.9553562095543924, 'psi': 0.5627981765151719}
[S5] START round=6 head_norm_before_train=0.665406 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.000000 metrics={'f1_val': 0.7005699347162762, 'auprc': 0.6616890165918299, 'loss_val': 0.6553398187355365, 'psi': 0.6850175674664976}-{'f1_val': 0.7146275168069246, 'auprc': 0.7946219170841236, 'loss_val': 0.6832387357471832, 'psi': 0.7466252769178041}
[S6] START round=6 head_norm_before_train=0.754014 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.5949016921810721, 'loss_val': 1.2254802275420091, 'psi': 0.3228164461031981}-{'f1_val': 0.14142628205128205, 'auprc': 0.5979404838864367, 'loss_val': 1.2184254719685697, 'psi': 0.3240319627853439}
[S7] START round=6 head_norm_before_train=1.312748 (no previous merge yet)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.4121488202156975, 'auprc': 0.79236722983405, 'loss_val': 0.8266453460558834, 'psi': 0.5642361840630385}-{'f1_val': 0.6747278758406737, 'auprc': 0.7770165648906456, 'loss_val': 0.9053128930902852, 'psi': 0.7156433514606626}
[S8] START round=6 head_norm_before_train=1.308830 (no previous merge yet)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7155418933751417, 'auprc': 0.7945886844416329, 'loss_val': 0.995508739896154, 'psi': 0.7471606098017383}-{'f1_val': 0.15813806076717563, 'auprc': 0.7941308647259037, 'loss_val': 1.1197382130861457, 'psi': 0.4125351823506669}
[S9] START round=6 head_norm_before_train=0.839199 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9987953989908434, 'loss_val': 0.4495868272435659, 'psi': 0.8202924497208754}-{'f1_val': 0.7017906989076834, 'auprc': 0.998853961943493, 'loss_val': 0.39612848913493703, 'psi': 0.8206160041220072}
[S10] START round=6 head_norm_before_train=1.265561 (no previous merge yet)
[S10] round=6 local utility u=0.220971 metrics={'f1_val': 0.18598524762908325, 'auprc': 0.6501845948726942, 'loss_val': 1.0055123411360753, 'psi': 0.37166498652652763}-{'f1_val': 0.13862163754172394, 'auprc': 0.6432490380256162, 'loss_val': 1.142465866457978, 'psi': 0.3404725977352808}
[S11] START round=6 head_norm_before_train=0.945971 cos_to_last_merge=0.9970 (last merge round=4)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.4149909032149046, 'auprc': 0.9364615713064222, 'loss_val': 0.9679152847819104, 'psi': 0.6235791704515117}-{'f1_val': 0.14041368337311058, 'auprc': 0.6470522387400999, 'loss_val': 1.1262070391364047, 'psi': 0.3430691055199063}
[S13] START round=6 head_norm_before_train=0.965817 cos_to_last_merge=0.9726 (last merge round=1)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.41643344272875704, 'auprc': 0.5570988150123484, 'loss_val': 1.0593965009137587, 'psi': 0.47269959164219355}-{'f1_val': 0.4152892684755862, 'auprc': 0.6233950611264845, 'loss_val': 1.1393544469351926, 'psi': 0.4985315855359455}
[S14] START round=6 head_norm_before_train=1.008987 cos_to_last_merge=0.9630 (last merge round=1)
[S14] round=6 local utility u=0.134533 metrics={'f1_val': 0.14044161527750149, 'auprc': 0.786360466344638, 'loss_val': 1.0785775295332145, 'psi': 0.3988091557043561}-{'f1_val': 0.14035785288270378, 'auprc': 0.7374783389862573, 'loss_val': 1.200494445382633, 'psi': 0.37920604732412516}
[S15] START round=6 head_norm_before_train=0.952661 cos_to_last_merge=0.9821 (last merge round=2)
[S15] round=6 local utility u=0.018956 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7769432234815581, 'loss_val': 1.2357942002825657, 'psi': 0.3946174802095583}-{'f1_val': 0.13973365136155833, 'auprc': 0.7747573047679371, 'loss_val': 1.2671490972561223, 'psi': 0.3937431127241099}
[S16] START round=6 head_norm_before_train=0.809891 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.038239 metrics={'f1_val': 0.4168802231040131, 'auprc': 0.6272883508156321, 'loss_val': 1.1137457524020238, 'psi': 0.5010434741886607}-{'f1_val': 0.41543156524429936, 'auprc': 0.641841369712636, 'loss_val': 1.2251898676729933, 'psi': 0.505995487031634}
[S17] START round=6 head_norm_before_train=0.927615 cos_to_last_merge=0.9461 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.946
[S17] round=6 local utility u=0.848353 metrics={'f1_val': 0.38544462782553757, 'auprc': 0.6015164644309383, 'loss_val': 1.0261572509456296, 'psi': 0.47187336246769784}-{'f1_val': 0.14094896331738438, 'auprc': 0.5676393835183227, 'loss_val': 1.1542582323439536, 'psi': 0.3116251313977597}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:38512
[S8] not sending this round → trigger blocked (psi=0.747)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:38510
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S15] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:38505
[S10] not sending this round → trigger blocked (psi=0.372)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.561)
[S16] not sending this round → trigger blocked (psi=0.501)
[S14] not sending this round → trigger blocked (psi=0.399)
[S15] sending update (kind=head size=1788 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.987699)
[S9] loaded HEAD from S11 (vec_in norm=0.987699)
[S9] cosine check vs S11: cos=-0.0734
[S9] DROPPED delta from S11 (cos=-0.0734 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.384518)
[S11] loaded HEAD from S4 (vec_in norm=1.384518)
[S11] cosine check vs S4: cos=0.6616
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1788) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.967346)
[S5] loaded HEAD from S15 (vec_in norm=0.967346)
[S5] cosine check vs S15: cos=0.0227
[S5] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.972352)
[S9] loaded HEAD from S17 (vec_in norm=0.972352)
[S9] cosine check vs S17: cos=0.7363
[S9] BUFFERED delta from S17 (total buffered=1)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.7013 head_norm=0.941594
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.477764e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.7013 head_norm=0.891676 delta_norm=0.347776
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.7006 head_norm=0.748668
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.048658e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.7008 head_norm=0.618278 delta_norm=0.604866
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.4150 head_norm=0.987699
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.203300e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.4151 head_norm=1.084194 delta_norm=0.520330
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.021500 cos_to_last_merge=0.9545 (last merge round=1)
[S2] round=7 local utility u=0.454932 metrics={'f1_val': 0.5460327962283789, 'auprc': 0.7768479543545606, 'loss_val': 0.9211890450852747, 'psi': 0.6383588594788516}-{'f1_val': 0.4162163375000623, 'auprc': 0.7788712570176802, 'loss_val': 1.0582249352932498, 'psi': 0.5612783053071095}
[S3] START round=7 head_norm_before_train=1.522191 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.6010394467814366, 'auprc': 0.9931879670965873, 'loss_val': 0.46944103926998065, 'psi': 0.757898854907497}-{'f1_val': 0.7003355634446948, 'auprc': 0.8748218354679338, 'loss_val': 0.47833100819869656, 'psi': 0.7701300722539903}
[S4] START round=7 head_norm_before_train=1.384518 (no previous merge yet)
[S4] round=7 local utility u=0.078413 metrics={'f1_val': 0.6644576105940516, 'auprc': 0.65925508779154, 'loss_val': 0.5972981645333844, 'psi': 0.662376601473047}-{'f1_val': 0.6681172398875189, 'auprc': 0.6583070984392275, 'loss_val': 0.7732377505437598, 'psi': 0.6641931833082024}
[S5] START round=7 head_norm_before_train=0.618278 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.6440794544316835, 'loss_val': 0.7324309550595898, 'psi': 0.6778245722330216}-{'f1_val': 0.7005699347162762, 'auprc': 0.6616890165918299, 'loss_val': 0.6553398187355365, 'psi': 0.6850175674664976}
[S6] START round=7 head_norm_before_train=0.776835 cos_to_last_merge=0.9983 (last merge round=5)
[S6] round=7 local utility u=0.034905 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.5952627637066944, 'loss_val': 1.156754285624902, 'psi': 0.322960874713447}-{'f1_val': 0.14142628205128205, 'auprc': 0.5949016921810721, 'loss_val': 1.2254802275420091, 'psi': 0.3228164461031981}
[S7] START round=7 head_norm_before_train=1.362189 (no previous merge yet)
[S7] round=7 local utility u=1.000000 metrics={'f1_val': 0.684700339259235, 'auprc': 0.9950446698257464, 'loss_val': 0.4521350055599577, 'psi': 0.8088380714858396}-{'f1_val': 0.4121488202156975, 'auprc': 0.79236722983405, 'loss_val': 0.8266453460558834, 'psi': 0.5642361840630385}
[S8] START round=7 head_norm_before_train=1.338071 (no previous merge yet)
[S8] round=7 local utility u=0.113033 metrics={'f1_val': 0.7155419475775954, 'auprc': 0.7949539526194533, 'loss_val': 0.7705397121653732, 'psi': 0.7473067495943386}-{'f1_val': 0.7155418933751417, 'auprc': 0.7945886844416329, 'loss_val': 0.995508739896154, 'psi': 0.7471606098017383}
[S9] START round=7 head_norm_before_train=0.891676 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.036142 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9987357357277702, 'loss_val': 0.377123316918929, 'psi': 0.8202685844156461}-{'f1_val': 0.7012904835408967, 'auprc': 0.9987953989908434, 'loss_val': 0.4495868272435659, 'psi': 0.8202924497208754}
[S10] START round=7 head_norm_before_train=1.301427 (no previous merge yet)
[S10] round=7 local utility u=0.926626 metrics={'f1_val': 0.39217959040136224, 'auprc': 0.8109410434979449, 'loss_val': 0.8716951677115541, 'psi': 0.5596841716399954}-{'f1_val': 0.18598524762908325, 'auprc': 0.6501845948726942, 'loss_val': 1.0055123411360753, 'psi': 0.37166498652652763}
[S11] START round=7 head_norm_before_train=1.084194 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.007090 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9616190541296723, 'loss_val': 0.9185765336420489, 'psi': 0.6225789632075927}-{'f1_val': 0.4149909032149046, 'auprc': 0.9364615713064222, 'loss_val': 0.9679152847819104, 'psi': 0.6235791704515117}
[S13] START round=7 head_norm_before_train=0.998052 cos_to_last_merge=0.9643 (last merge round=1)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.5061281841175952, 'loss_val': 0.9736866472271506, 'psi': 0.45205359340651513}-{'f1_val': 0.41643344272875704, 'auprc': 0.5570988150123484, 'loss_val': 1.0593965009137587, 'psi': 0.47269959164219355}
[S14] START round=7 head_norm_before_train=1.058360 cos_to_last_merge=0.9481 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.948
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.5075807895463558, 'auprc': 0.976194721553947, 'loss_val': 0.9334371488212434, 'psi': 0.6950263623493923}-{'f1_val': 0.14044161527750149, 'auprc': 0.786360466344638, 'loss_val': 1.0785775295332145, 'psi': 0.3988091557043561}
[S15] START round=7 head_norm_before_train=0.967346 cos_to_last_merge=0.9759 (last merge round=2)
[S15] round=7 local utility u=0.049453 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7927728709707323, 'loss_val': 1.1843774227511095, 'psi': 0.40094933920522796}-{'f1_val': 0.13973365136155833, 'auprc': 0.7769432234815581, 'loss_val': 1.2357942002825657, 'psi': 0.3946174802095583}
[S16] START round=7 head_norm_before_train=0.844902 cos_to_last_merge=0.9936 (last merge round=5)
[S16] round=7 local utility u=0.106147 metrics={'f1_val': 0.41700358386742975, 'auprc': 0.6432393685712806, 'loss_val': 0.9500456704674263, 'psi': 0.5074978977489701}-{'f1_val': 0.4168802231040131, 'auprc': 0.6272883508156321, 'loss_val': 1.1137457524020238, 'psi': 0.5010434741886607}
[S17] START round=7 head_norm_before_train=0.972352 cos_to_last_merge=0.9247 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.925
[S17] round=7 local utility u=0.317651 metrics={'f1_val': 0.3909979250331579, 'auprc': 0.787048005506522, 'loss_val': 0.9807703323898205, 'psi': 0.5494179572225035}-{'f1_val': 0.38544462782553757, 'auprc': 0.6015164644309383, 'loss_val': 1.0261572509456296, 'psi': 0.47187336246769784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[S4] not sending this round → trigger blocked (psi=0.662)
[S15] not sending this round → trigger blocked (psi=0.401)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38508
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:38507
[S11] not sending this round → trigger blocked (psi=0.623)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:38514
[S9] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1793) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.995724)
[S14] loaded HEAD from S9 (vec_in norm=0.995724)
[S14] cosine check vs S9: cos=-0.0276
[S14] DROPPED delta from S9 (cos=-0.0276 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.373906)
[S7] loaded HEAD from S8 (vec_in norm=1.373906)
[S7] cosine check vs S8: cos=-0.0260
[S7] DROPPED delta from S8 (cos=-0.0260 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.894971)
[S6] loaded HEAD from S16 (vec_in norm=0.894971)
[S6] cosine check vs S16: cos=0.5109
[S6] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.403449)
[S14] loaded HEAD from S7 (vec_in norm=1.403449)
[S14] cosine check vs S7: cos=-0.0307
[S14] DROPPED delta from S7 (cos=-0.0307 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.057884)
[S5] loaded HEAD from S2 (vec_in norm=1.057884)
[S5] cosine check vs S2: cos=0.3875
[S5] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.342154)
[S5] loaded HEAD from S10 (vec_in norm=1.342154)
[S5] cosine check vs S10: cos=0.1361
[S5] BUFFERED delta from S10 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1799) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.112516)
[S5] loaded HEAD from S14 (vec_in norm=1.112516)
[S5] cosine check vs S14: cos=0.4296
[S5] BUFFERED delta from S14 (total buffered=3)
[S4] RECEIVED delta(kind=head bytes=1794) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.815883)
[S4] loaded HEAD from S6 (vec_in norm=0.815883)
[S4] cosine check vs S6: cos=0.0204
[S4] BUFFERED delta from S6 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.549)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.6645 head_norm=1.439149
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.198773e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6661 head_norm=0.834392 delta_norm=0.819877
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.7003 head_norm=0.678346
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.732138e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.7006 head_norm=0.635582 delta_norm=0.373214
[S5] aggregate: ACCEPT kept=['S2', 'S10', 'S14'] (k=3/3) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.1414 head_norm=0.815883
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.244095e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.1414 head_norm=0.743772 delta_norm=0.424410
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.057884 cos_to_last_merge=0.9417 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.942
[S2] round=8 local utility u=0.453626 metrics={'f1_val': 0.6774026766694503, 'auprc': 0.7770047547483432, 'loss_val': 0.8026277204201914, 'psi': 0.7172435079010075}-{'f1_val': 0.5460327962283789, 'auprc': 0.7768479543545606, 'loss_val': 0.9211890450852747, 'psi': 0.6383588594788516}
[S3] START round=8 head_norm_before_train=1.583437 (no previous merge yet)
[S3] round=8 local utility u=0.392631 metrics={'f1_val': 0.7003264167718803, 'auprc': 0.9939589224382841, 'loss_val': 0.282213487848913, 'psi': 0.8177794190384419}-{'f1_val': 0.6010394467814366, 'auprc': 0.9931879670965873, 'loss_val': 0.46944103926998065, 'psi': 0.757898854907497}
[S4] START round=8 head_norm_before_train=0.834392 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.6623209616927124, 'auprc': 0.658235167974006, 'loss_val': 0.6510794469413833, 'psi': 0.6606866442052298}-{'f1_val': 0.6644576105940516, 'auprc': 0.65925508779154, 'loss_val': 0.5972981645333844, 'psi': 0.662376601473047}
[S5] START round=8 head_norm_before_train=0.635582 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.248107 metrics={'f1_val': 0.7104028285001727, 'auprc': 0.7770066748808974, 'loss_val': 0.6954885953446351, 'psi': 0.7370443670524625}-{'f1_val': 0.7003213174339138, 'auprc': 0.6440794544316835, 'loss_val': 0.7324309550595898, 'psi': 0.6778245722330216}
[S6] START round=8 head_norm_before_train=0.743772 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.014881 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6015867283936873, 'loss_val': 1.1459644636470034, 'psi': 0.32549046058824416}-{'f1_val': 0.14142628205128205, 'auprc': 0.5952627637066944, 'loss_val': 1.156754285624902, 'psi': 0.322960874713447}
[S7] START round=8 head_norm_before_train=1.403449 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.3764585045080646, 'auprc': 0.7546924637587606, 'loss_val': 1.1336576790383057, 'psi': 0.5277520882083431}-{'f1_val': 0.684700339259235, 'auprc': 0.9950446698257464, 'loss_val': 0.4521350055599577, 'psi': 0.8088380714858396}
[S8] START round=8 head_norm_before_train=1.373906 (no previous merge yet)
[S8] round=8 local utility u=0.399114 metrics={'f1_val': 0.7147756253726463, 'auprc': 0.9987373804102899, 'loss_val': 0.5790638613212676, 'psi': 0.8283603273877038}-{'f1_val': 0.7155419475775954, 'auprc': 0.7949539526194533, 'loss_val': 0.7705397121653732, 'psi': 0.7473067495943386}
[S9] START round=8 head_norm_before_train=0.995724 cos_to_last_merge=0.9862 (last merge round=6)
[S9] round=8 local utility u=0.036424 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9980890486123917, 'loss_val': 0.3018916520114999, 'psi': 0.8199655679089678}-{'f1_val': 0.7012904835408967, 'auprc': 0.9987357357277702, 'loss_val': 0.377123316918929, 'psi': 0.8202685844156461}
[S10] START round=8 head_norm_before_train=1.342154 (no previous merge yet)
[S10] round=8 local utility u=0.069159 metrics={'f1_val': 0.3913615140868787, 'auprc': 0.8244149787718649, 'loss_val': 0.768891279982393, 'psi': 0.5645828999608732}-{'f1_val': 0.39217959040136224, 'auprc': 0.8109410434979449, 'loss_val': 0.8716951677115541, 'psi': 0.5596841716399954}
[S11] START round=8 head_norm_before_train=1.114799 cos_to_last_merge=0.9961 (last merge round=6)
[S11] round=8 local utility u=1.000000 metrics={'f1_val': 0.6999523942279149, 'auprc': 0.9816481491849766, 'loss_val': 0.740086164088745, 'psi': 0.8126306962107395}-{'f1_val': 0.39655223592620625, 'auprc': 0.9616190541296723, 'loss_val': 0.9185765336420489, 'psi': 0.6225789632075927}
[S13] START round=8 head_norm_before_train=1.038132 cos_to_last_merge=0.9530 (last merge round=1)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.41584628052631434, 'auprc': 0.466463647065531, 'loss_val': 0.9268396421583132, 'psi': 0.436093227142001}-{'f1_val': 0.4160038662657951, 'auprc': 0.5061281841175952, 'loss_val': 0.9736866472271506, 'psi': 0.45205359340651513}
[S14] START round=8 head_norm_before_train=1.112516 cos_to_last_merge=0.9342 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.934
[S14] round=8 local utility u=0.726552 metrics={'f1_val': 0.7016467554509178, 'auprc': 0.9944999706433668, 'loss_val': 0.6996445384613103, 'psi': 0.8187880415278974}-{'f1_val': 0.5075807895463558, 'auprc': 0.976194721553947, 'loss_val': 0.9334371488212434, 'psi': 0.6950263623493923}
[S15] START round=8 head_norm_before_train=0.991027 cos_to_last_merge=0.9669 (last merge round=2)
[S15] round=8 local utility u=0.542546 metrics={'f1_val': 0.31872937742826324, 'auprc': 0.7626843843739384, 'loss_val': 1.0829934060988475, 'psi': 0.4963113802065333}-{'f1_val': 0.13973365136155833, 'auprc': 0.7927728709707323, 'loss_val': 1.1843774227511095, 'psi': 0.40094933920522796}
[S16] START round=8 head_norm_before_train=0.894971 cos_to_last_merge=0.9771 (last merge round=5)
[S16] round=8 local utility u=0.081926 metrics={'f1_val': 0.41696372269722326, 'auprc': 0.6737765780427671, 'loss_val': 0.8775651798707428, 'psi': 0.5196888648354409}-{'f1_val': 0.41700358386742975, 'auprc': 0.6432393685712806, 'loss_val': 0.9500456704674263, 'psi': 0.5074978977489701}
[S17] START round=8 head_norm_before_train=1.026337 cos_to_last_merge=0.8999 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.900
[S17] round=8 local utility u=0.077916 metrics={'f1_val': 0.3554295805843129, 'auprc': 0.8765913708893472, 'loss_val': 0.8801577014511553, 'psi': 0.5638942967063266}-{'f1_val': 0.3909979250331579, 'auprc': 0.787048005506522, 'loss_val': 0.9807703323898205, 'psi': 0.5494179572225035}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.828)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.565)
[S9] not sending this round → trigger blocked (psi=0.820)
[S14] not sending this round → trigger blocked (psi=0.819)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S16] not sending this round → trigger blocked (psi=0.520)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38516
[S2] not sending this round → trigger blocked (psi=0.717)
[S6] not sending this round → trigger blocked (psi=0.325)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:38505
[S11] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.158525)
[S9] loaded HEAD from S11 (vec_in norm=1.158525)
[S9] cosine check vs S11: cos=-0.1483
[S9] DROPPED delta from S11 (cos=-0.1483 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.021271)
[S5] loaded HEAD from S15 (vec_in norm=1.021271)
[S5] cosine check vs S15: cos=0.3770
[S5] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.650028)
[S5] loaded HEAD from S3 (vec_in norm=1.650028)
[S5] cosine check vs S3: cos=0.0741
[S5] BUFFERED delta from S3 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.710335)
[S16] loaded HEAD from S5 (vec_in norm=0.710335)
[S16] cosine check vs S5: cos=0.5703
[S16] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1793 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.084986)
[S9] loaded HEAD from S17 (vec_in norm=1.084986)
[S9] cosine check vs S17: cos=0.8250
[S9] BUFFERED delta from S17 (total buffered=1)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7012 head_norm=1.093120
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.221987e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7012 head_norm=1.040308 delta_norm=0.322199
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.7104 head_norm=0.710335
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.279073e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.7143 head_norm=0.677388 delta_norm=0.527907
[S5] aggregate: ACCEPT kept=['S15', 'S3'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4170 head_norm=0.951445
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.996825e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4234 head_norm=0.738353 delta_norm=0.399683
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.098457 cos_to_last_merge=0.9278 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.928
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.7012695509994898, 'auprc': 0.667656189027152, 'loss_val': 0.686093101640646, 'psi': 0.6878242062105546}-{'f1_val': 0.6774026766694503, 'auprc': 0.7770047547483432, 'loss_val': 0.8026277204201914, 'psi': 0.7172435079010075}
[S3] START round=9 head_norm_before_train=1.650028 (no previous merge yet)
[S3] round=9 local utility u=0.019800 metrics={'f1_val': 0.7010108237857944, 'auprc': 0.9969698291171242, 'loss_val': 0.2557518997741095, 'psi': 0.8193944259183263}-{'f1_val': 0.7003264167718803, 'auprc': 0.9939589224382841, 'loss_val': 0.282213487848913, 'psi': 0.8177794190384419}
[S4] START round=9 head_norm_before_train=0.897308 cos_to_last_merge=0.9960 (last merge round=7)
[S4] round=9 local utility u=0.034359 metrics={'f1_val': 0.6612565364425014, 'auprc': 0.655513651469963, 'loss_val': 0.5678110614601277, 'psi': 0.6589593824534861}-{'f1_val': 0.6623209616927124, 'auprc': 0.658235167974006, 'loss_val': 0.6510794469413833, 'psi': 0.6606866442052298}
[S5] START round=9 head_norm_before_train=0.677388 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.7754436047632574, 'loss_val': 0.6455287945335637, 'psi': 0.7303698010001183}-{'f1_val': 0.7104028285001727, 'auprc': 0.7770066748808974, 'loss_val': 0.6954885953446351, 'psi': 0.7370443670524625}
[S6] START round=9 head_norm_before_train=0.773893 cos_to_last_merge=0.9955 (last merge round=7)
[S6] round=9 local utility u=1.000000 metrics={'f1_val': 0.4171352566691459, 'auprc': 0.7553599960599959, 'loss_val': 0.9704113449343668, 'psi': 0.552425152425486}-{'f1_val': 0.14142628205128205, 'auprc': 0.6015867283936873, 'loss_val': 1.1459644636470034, 'psi': 0.32549046058824416}
[S7] START round=9 head_norm_before_train=1.428638 (no previous merge yet)
[S7] round=9 local utility u=0.727939 metrics={'f1_val': 0.542919650769345, 'auprc': 0.784977735682966, 'loss_val': 0.7674016452944564, 'psi': 0.6397428847347935}-{'f1_val': 0.3764585045080646, 'auprc': 0.7546924637587606, 'loss_val': 1.1336576790383057, 'psi': 0.5277520882083431}
[S8] START round=9 head_norm_before_train=1.410504 (no previous merge yet)
[S8] round=9 local utility u=0.048126 metrics={'f1_val': 0.7146827657388013, 'auprc': 0.9987382634099954, 'loss_val': 0.4822574173368379, 'psi': 0.8283049648072789}-{'f1_val': 0.7147756253726463, 'auprc': 0.9987373804102899, 'loss_val': 0.5790638613212676, 'psi': 0.8283603273877038}
[S9] START round=9 head_norm_before_train=1.040308 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.000567 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9980786215139126, 'loss_val': 0.3007263521969312, 'psi': 0.8199613970695762}-{'f1_val': 0.7012165807733519, 'auprc': 0.9980890486123917, 'loss_val': 0.3018916520114999, 'psi': 0.8199655679089678}
[S10] START round=9 head_norm_before_train=1.388953 (no previous merge yet)
[S10] round=9 local utility u=1.000000 metrics={'f1_val': 0.6854224731729088, 'auprc': 0.9695024609759797, 'loss_val': 0.6202296310310698, 'psi': 0.7990544682941372}-{'f1_val': 0.3913615140868787, 'auprc': 0.8244149787718649, 'loss_val': 0.768891279982393, 'psi': 0.5645828999608732}
[S11] START round=9 head_norm_before_train=1.158525 cos_to_last_merge=0.9851 (last merge round=6)
[S11] round=9 local utility u=0.000000 metrics={'f1_val': 0.5944791027533908, 'auprc': 0.9919273924986256, 'loss_val': 0.6711339635610503, 'psi': 0.7534584186514848}-{'f1_val': 0.6999523942279149, 'auprc': 0.9816481491849766, 'loss_val': 0.740086164088745, 'psi': 0.8126306962107395}
[S13] START round=9 head_norm_before_train=1.082286 cos_to_last_merge=0.9402 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.940
[S13] round=9 local utility u=1.000000 metrics={'f1_val': 0.6459736188182972, 'auprc': 0.6632619353685603, 'loss_val': 0.7916093020720549, 'psi': 0.6528889454384024}-{'f1_val': 0.41584628052631434, 'auprc': 0.466463647065531, 'loss_val': 0.9268396421583132, 'psi': 0.436093227142001}
[S14] START round=9 head_norm_before_train=1.177713 cos_to_last_merge=0.9190 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.919
[S14] round=9 local utility u=0.102329 metrics={'f1_val': 0.701365099548425, 'auprc': 0.9931426566161148, 'loss_val': 0.48922482850801974, 'psi': 0.8180761223755009}-{'f1_val': 0.7016467554509178, 'auprc': 0.9944999706433668, 'loss_val': 0.6996445384613103, 'psi': 0.8187880415278974}
[S15] START round=9 head_norm_before_train=1.021271 cos_to_last_merge=0.9544 (last merge round=2)
[S15] round=9 local utility u=0.275790 metrics={'f1_val': 0.4169508412658852, 'auprc': 0.7058030985510373, 'loss_val': 0.9500977355767611, 'psi': 0.532491744179946}-{'f1_val': 0.31872937742826324, 'auprc': 0.7626843843739384, 'loss_val': 1.0829934060988475, 'psi': 0.4963113802065333}
[S16] START round=9 head_norm_before_train=0.738353 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.3170582169345215, 'auprc': 0.6985934103606319, 'loss_val': 1.0039320943232506, 'psi': 0.4696722943049657}-{'f1_val': 0.41696372269722326, 'auprc': 0.6737765780427671, 'loss_val': 0.8775651798707428, 'psi': 0.5196888648354409}
[S17] START round=9 head_norm_before_train=1.084986 cos_to_last_merge=0.8740 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.874
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.35421148646982936, 'auprc': 0.6951707967341736, 'loss_val': 0.8514583125794037, 'psi': 0.49059521057556704}-{'f1_val': 0.3554295805843129, 'auprc': 0.8765913708893472, 'loss_val': 0.8801577014511553, 'psi': 0.5638942967063266}
[S3] not sending this round → trigger blocked (psi=0.819)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:38505
[S15] not sending this round → trigger blocked (psi=0.532)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S4] → sending delta(kind=head bytes=1785) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:38504
[S14] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1785 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1785) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.973504)
[S11] loaded HEAD from S4 (vec_in norm=0.973504)
[S11] cosine check vs S4: cos=0.7425
[S11] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.113063)
[S14] loaded HEAD from S9 (vec_in norm=1.113063)
[S14] cosine check vs S9: cos=-0.0319
[S14] DROPPED delta from S9 (cos=-0.0319 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.448010)
[S14] loaded HEAD from S7 (vec_in norm=1.448010)
[S14] cosine check vs S7: cos=-0.0271
[S14] DROPPED delta from S7 (cos=-0.0271 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.813362)
[S4] loaded HEAD from S6 (vec_in norm=0.813362)
[S4] cosine check vs S6: cos=0.3830
[S4] BUFFERED delta from S6 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1793) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.247328)
[S5] loaded HEAD from S14 (vec_in norm=1.247328)
[S5] cosine check vs S14: cos=0.3672
[S5] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.435901)
[S5] loaded HEAD from S10 (vec_in norm=1.435901)
[S5] cosine check vs S10: cos=0.1901
[S5] BUFFERED delta from S10 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.123717)
[S9] loaded HEAD from S13 (vec_in norm=1.123717)
[S9] cosine check vs S13: cos=0.4866
[S9] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.450536)
[S7] loaded HEAD from S8 (vec_in norm=1.450536)
[S7] cosine check vs S8: cos=-0.0227
[S7] DROPPED delta from S8 (cos=-0.0227 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.5945 head_norm=1.207853
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.063369e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.6890 head_norm=1.018921 delta_norm=0.406337
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.7003 head_norm=0.742362
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.901676e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.7005 head_norm=0.715254 delta_norm=0.490168
[S5] aggregate: ACCEPT kept=['S14', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.7012 head_norm=1.113063
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.666825e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7012 head_norm=0.964207 delta_norm=0.566682
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6613 head_norm=0.973504
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.006936e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6621 head_norm=0.744271 delta_norm=0.500694
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.143322 cos_to_last_merge=0.9130 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.913
[S2] round=10 local utility u=0.215166 metrics={'f1_val': 0.7017174579892737, 'auprc': 0.7783748838555926, 'loss_val': 0.5906043282054247, 'psi': 0.7323804283358013}-{'f1_val': 0.7012695509994898, 'auprc': 0.667656189027152, 'loss_val': 0.686093101640646, 'psi': 0.6878242062105546}
[S3] START round=10 head_norm_before_train=1.699776 (no previous merge yet)
[S3] round=10 local utility u=0.007202 metrics={'f1_val': 0.7004261945879899, 'auprc': 0.9984512918666977, 'loss_val': 0.2422854968604394, 'psi': 0.819636233499473}-{'f1_val': 0.7010108237857944, 'auprc': 0.9969698291171242, 'loss_val': 0.2557518997741095, 'psi': 0.8193944259183263}
[S4] START round=10 head_norm_before_train=0.744271 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.661047380176963, 'auprc': 0.6502732192004882, 'loss_val': 0.6428596443769218, 'psi': 0.6567377157863731}-{'f1_val': 0.6612565364425014, 'auprc': 0.655513651469963, 'loss_val': 0.5678110614601277, 'psi': 0.6589593824534861}
[S5] START round=10 head_norm_before_train=0.715254 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.018571 metrics={'f1_val': 0.710966508815667, 'auprc': 0.7749874322980251, 'loss_val': 0.6708939166208143, 'psi': 0.7365748782086103}-{'f1_val': 0.700320598491359, 'auprc': 0.7754436047632574, 'loss_val': 0.6455287945335637, 'psi': 0.7303698010001183}
[S6] START round=10 head_norm_before_train=0.813362 cos_to_last_merge=0.9838 (last merge round=7)
[S6] round=10 local utility u=0.707302 metrics={'f1_val': 0.6206103660722324, 'auprc': 0.7699444908490283, 'loss_val': 0.8204112697358276, 'psi': 0.6803440159829508}-{'f1_val': 0.4171352566691459, 'auprc': 0.7553599960599959, 'loss_val': 0.9704113449343668, 'psi': 0.552425152425486}
[S7] START round=10 head_norm_before_train=1.448010 (no previous merge yet)
[S7] round=10 local utility u=0.704495 metrics={'f1_val': 0.6781854829807731, 'auprc': 0.8733718766495713, 'loss_val': 0.4351885411650849, 'psi': 0.7562600404482924}-{'f1_val': 0.542919650769345, 'auprc': 0.784977735682966, 'loss_val': 0.7674016452944564, 'psi': 0.6397428847347935}
[S8] START round=10 head_norm_before_train=1.450536 (no previous merge yet)
[S8] round=10 local utility u=0.040738 metrics={'f1_val': 0.7014252940836996, 'auprc': 0.9987282292166546, 'loss_val': 0.32120572973792116, 'psi': 0.8203464681368816}-{'f1_val': 0.7146827657388013, 'auprc': 0.9987382634099954, 'loss_val': 0.4822574173368379, 'psi': 0.8283049648072789}
[S9] START round=10 head_norm_before_train=0.964207 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9987815839435358, 'loss_val': 0.3367425067797711, 'psi': 0.8202425820414254}-{'f1_val': 0.7012165807733519, 'auprc': 0.9980786215139126, 'loss_val': 0.3007263521969312, 'psi': 0.8199613970695762}
[S10] START round=10 head_norm_before_train=1.435901 (no previous merge yet)
[S10] round=10 local utility u=0.119507 metrics={'f1_val': 0.6911213758960627, 'auprc': 0.9828774483120395, 'loss_val': 0.4555334793844073, 'psi': 0.8078238048624534}-{'f1_val': 0.6854224731729088, 'auprc': 0.9695024609759797, 'loss_val': 0.6202296310310698, 'psi': 0.7990544682941372}
[S11] START round=10 head_norm_before_train=1.018921 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.328415 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9719791656935788, 'loss_val': 0.597745975847979, 'psi': 0.8098077540295865}-{'f1_val': 0.5944791027533908, 'auprc': 0.9919273924986256, 'loss_val': 0.6711339635610503, 'psi': 0.7534584186514848}
[S13] START round=10 head_norm_before_train=1.123717 cos_to_last_merge=0.9285 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.929
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.5776951112771891, 'auprc': 0.6827809349431553, 'loss_val': 0.7496900845138676, 'psi': 0.6197294407435756}-{'f1_val': 0.6459736188182972, 'auprc': 0.6632619353685603, 'loss_val': 0.7916093020720549, 'psi': 0.6528889454384024}
[S14] START round=10 head_norm_before_train=1.247328 cos_to_last_merge=0.9039 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.904
[S14] round=10 local utility u=0.087653 metrics={'f1_val': 0.7019946786572225, 'auprc': 0.9970732463912179, 'loss_val': 0.32948757612786506, 'psi': 0.8200261057508207}-{'f1_val': 0.701365099548425, 'auprc': 0.9931426566161148, 'loss_val': 0.48922482850801974, 'psi': 0.8180761223755009}
[S15] START round=10 head_norm_before_train=1.059443 cos_to_last_merge=0.9398 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.940
[S15] round=10 local utility u=0.163513 metrics={'f1_val': 0.4051017529887089, 'auprc': 0.7925381240131738, 'loss_val': 0.8121828686655855, 'psi': 0.5600763013984948}-{'f1_val': 0.4169508412658852, 'auprc': 0.7058030985510373, 'loss_val': 0.9500977355767611, 'psi': 0.532491744179946}
[S16] START round=10 head_norm_before_train=0.790957 cos_to_last_merge=0.9953 (last merge round=8)
[S16] round=10 local utility u=0.305988 metrics={'f1_val': 0.43364809294133805, 'auprc': 0.6194315591528997, 'loss_val': 0.8540102425790618, 'psi': 0.5079614794259627}-{'f1_val': 0.3170582169345215, 'auprc': 0.6985934103606319, 'loss_val': 1.0039320943232506, 'psi': 0.4696722943049657}
[S17] START round=10 head_norm_before_train=1.137404 cos_to_last_merge=0.8511 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.851
[S17] round=10 local utility u=0.001170 metrics={'f1_val': 0.35450650733504196, 'auprc': 0.6973923367339911, 'loss_val': 0.8575528694311072, 'psi': 0.49166083909462166}-{'f1_val': 0.35421148646982936, 'auprc': 0.6951707967341736, 'loss_val': 0.8514583125794037, 'psi': 0.49059521057556704}
[S7] not sending this round → trigger blocked (psi=0.756)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:38516
[S8] not sending this round → trigger blocked (psi=0.820)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:38505
[S10] not sending this round → trigger blocked (psi=0.808)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:38505
[S6] not sending this round → trigger blocked (psi=0.680)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:38510
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.820)
[S11] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1790) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.736695)
[S5] loaded HEAD from S3 (vec_in norm=1.736695)
[S5] cosine check vs S3: cos=0.3186
[S5] BUFFERED delta from S3 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1793) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.838917)
[S6] loaded HEAD from S16 (vec_in norm=0.838917)
[S6] cosine check vs S16: cos=0.7203
[S6] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1803) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.195284)
[S5] loaded HEAD from S2 (vec_in norm=1.195284)
[S5] cosine check vs S2: cos=0.3515
[S5] BUFFERED delta from S2 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1791) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.061128)
[S9] loaded HEAD from S11 (vec_in norm=1.061128)
[S9] cosine check vs S11: cos=-0.1115
[S9] DROPPED delta from S11 (cos=-0.1115 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1792) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.101789)
[S5] loaded HEAD from S15 (vec_in norm=1.101789)
[S5] cosine check vs S15: cos=0.2771
[S5] BUFFERED delta from S15 (total buffered=3)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.785054)
[S16] loaded HEAD from S5 (vec_in norm=0.785054)
[S16] cosine check vs S5: cos=0.7520
[S16] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.178328)
[S9] loaded HEAD from S17 (vec_in norm=1.178328)
[S9] cosine check vs S17: cos=0.7585
[S9] BUFFERED delta from S17 (total buffered=1)
[S14] ⇄ pheromone p=0.359 → S5@127.0.0.1:38505
[S8] ⇄ pheromone p=0.305 → S7@127.0.0.1:38508
[S7] ⇄ pheromone p=0.539 → S14@127.0.0.1:38514
[S4] ⇄ pheromone p=0.239 → S11@127.0.0.1:38512
[S10] ⇄ pheromone p=0.425 → S5@127.0.0.1:38505
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7012 head_norm=1.034859
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.903613e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7012 head_norm=1.037937 delta_norm=0.390361
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.232 → S14@127.0.0.1:38514
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.6206 head_norm=0.862257
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.182918e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.7103 head_norm=0.788875 delta_norm=0.318292
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.439 → S4@127.0.0.1:38504
[S13] ⇄ pheromone p=0.333 → S9@127.0.0.1:38510
[S2] ⇄ pheromone p=0.350 → S5@127.0.0.1:38505
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.4336 head_norm=0.838917
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.870592e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.4355 head_norm=0.760028 delta_norm=0.287059
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.262 → S6@127.0.0.1:38507
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7110 head_norm=0.785054
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.742665e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7092 head_norm=0.675388 delta_norm=0.374266
[S5] aggregate: ACCEPT kept=['S3', 'S2', 'S15'] (k=3/3) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.248 → S16@127.0.0.1:38516
[S3] ⇄ pheromone p=0.235 → S5@127.0.0.1:38505
[S11] ⇄ pheromone p=0.411 → S9@127.0.0.1:38510
[S15] ⇄ pheromone p=0.266 → S5@127.0.0.1:38505
[S17] ⇄ pheromone p=0.240 → S9@127.0.0.1:38510
[S2] START round=11 head_norm_before_train=1.195284 cos_to_last_merge=0.8974 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.897
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.7012918442638041, 'auprc': 0.6697542178335778, 'loss_val': 0.4464158358533569, 'psi': 0.6886767936917135}-{'f1_val': 0.7017174579892737, 'auprc': 0.7783748838555926, 'loss_val': 0.5906043282054247, 'psi': 0.7323804283358013}
[S3] START round=11 head_norm_before_train=1.736695 (no previous merge yet)
[S3] round=11 local utility u=0.031113 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9986898488822904, 'loss_val': 0.18185458455941322, 'psi': 0.8198395410530395}-{'f1_val': 0.7004261945879899, 'auprc': 0.9984512918666977, 'loss_val': 0.2422854968604394, 'psi': 0.819636233499473}
[S4] START round=11 head_norm_before_train=0.812517 cos_to_last_merge=0.9927 (last merge round=9)
[S4] round=11 local utility u=0.045965 metrics={'f1_val': 0.6637960452632422, 'auprc': 0.6514452117836523, 'loss_val': 0.5709384284556528, 'psi': 0.6588557118714062}-{'f1_val': 0.661047380176963, 'auprc': 0.6502732192004882, 'loss_val': 0.6428596443769218, 'psi': 0.6567377157863731}
[S5] START round=11 head_norm_before_train=0.675388 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.6877165406984389, 'auprc': 0.7726654135568101, 'loss_val': 0.6782657652742679, 'psi': 0.7216960898417873}-{'f1_val': 0.710966508815667, 'auprc': 0.7749874322980251, 'loss_val': 0.6708939166208143, 'psi': 0.7365748782086103}
[S6] START round=11 head_norm_before_train=0.788875 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.48422782150857857, 'auprc': 0.7147353037456725, 'loss_val': 0.8823781341863233, 'psi': 0.5764308144034161}-{'f1_val': 0.6206103660722324, 'auprc': 0.7699444908490283, 'loss_val': 0.8204112697358276, 'psi': 0.6803440159829508}
[S7] START round=11 head_norm_before_train=1.471305 (no previous merge yet)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.6721668187195573, 'auprc': 0.8268128742859853, 'loss_val': 0.46525374621748683, 'psi': 0.7340252409461285}-{'f1_val': 0.6781854829807731, 'auprc': 0.8733718766495713, 'loss_val': 0.4351885411650849, 'psi': 0.7562600404482924}
[S8] START round=11 head_norm_before_train=1.491980 (no previous merge yet)
[S8] round=11 local utility u=0.078368 metrics={'f1_val': 0.714460606093301, 'auprc': 0.9984747357467098, 'loss_val': 0.2419201411896321, 'psi': 0.8280662579546645}-{'f1_val': 0.7014252940836996, 'auprc': 0.9987282292166546, 'loss_val': 0.32120572973792116, 'psi': 0.8203464681368816}
[S9] START round=11 head_norm_before_train=1.037937 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.045609 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9980901371202623, 'loss_val': 0.2434508986811683, 'psi': 0.8199660033121161}-{'f1_val': 0.7012165807733519, 'auprc': 0.9987815839435358, 'loss_val': 0.3367425067797711, 'psi': 0.8202425820414254}
[S10] START round=11 head_norm_before_train=1.482877 (no previous merge yet)
[S10] round=11 local utility u=0.048805 metrics={'f1_val': 0.6880161071413572, 'auprc': 0.9808962957112924, 'loss_val': 0.3333474503632262, 'psi': 0.8051681825693313}-{'f1_val': 0.6911213758960627, 'auprc': 0.9828774483120395, 'loss_val': 0.4555334793844073, 'psi': 0.8078238048624534}
[S11] START round=11 head_norm_before_train=1.061128 cos_to_last_merge=0.9967 (last merge round=9)
[S11] round=11 local utility u=0.081030 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9935248096285522, 'loss_val': 0.5021667076577414, 'psi': 0.81861038941896}-{'f1_val': 0.7016934795869249, 'auprc': 0.9719791656935788, 'loss_val': 0.597745975847979, 'psi': 0.8098077540295865}
[S13] START round=11 head_norm_before_train=1.163372 cos_to_last_merge=0.9178 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.918
[S13] round=11 local utility u=0.027949 metrics={'f1_val': 0.6024561843181917, 'auprc': 0.6393106680538128, 'loss_val': 0.7119478476834914, 'psi': 0.6171979778124401}-{'f1_val': 0.5776951112771891, 'auprc': 0.6827809349431553, 'loss_val': 0.7496900845138676, 'psi': 0.6197294407435756}
[S14] START round=11 head_norm_before_train=1.309521 cos_to_last_merge=0.8920 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.892
[S14] round=11 local utility u=0.890919 metrics={'f1_val': 0.9974763286352906, 'auprc': 0.9956764033146043, 'loss_val': 0.3163490908167849, 'psi': 0.996756358507016}-{'f1_val': 0.7019946786572225, 'auprc': 0.9970732463912179, 'loss_val': 0.32948757612786506, 'psi': 0.8200261057508207}
[S15] START round=11 head_norm_before_train=1.101789 cos_to_last_merge=0.9237 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.924
[S15] round=11 local utility u=0.047466 metrics={'f1_val': 0.40930714744298147, 'auprc': 0.7861350621361067, 'loss_val': 0.7232740672325058, 'psi': 0.5600383133202316}-{'f1_val': 0.4051017529887089, 'auprc': 0.7925381240131738, 'loss_val': 0.8121828686655855, 'psi': 0.5600763013984948}
[S16] START round=11 head_norm_before_train=0.760028 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.3064217928505239, 'auprc': 0.7395109780109812, 'loss_val': 0.9891154936858586, 'psi': 0.47965746691470684}-{'f1_val': 0.43364809294133805, 'auprc': 0.6194315591528997, 'loss_val': 0.8540102425790618, 'psi': 0.5079614794259627}
[S17] START round=11 head_norm_before_train=1.178328 cos_to_last_merge=0.8324 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.832
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.35332495072624465, 'auprc': 0.6952621511267447, 'loss_val': 0.8903289186593953, 'psi': 0.49009983088644465}-{'f1_val': 0.35450650733504196, 'auprc': 0.6973923367339911, 'loss_val': 0.8575528694311072, 'psi': 0.49166083909462166}
[S15] not sending this round → trigger blocked (psi=0.560)
[S11] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:38510
[S3] not sending this round → trigger blocked (psi=0.820)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:38514
[S9] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.893462)
[S11] loaded HEAD from S4 (vec_in norm=0.893462)
[S11] cosine check vs S4: cos=0.7194
[S11] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.201803)
[S9] loaded HEAD from S13 (vec_in norm=1.201803)
[S9] cosine check vs S13: cos=0.6179
[S9] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.521567)
[S5] loaded HEAD from S10 (vec_in norm=1.521567)
[S5] cosine check vs S10: cos=0.3292
[S5] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.358815)
[S5] loaded HEAD from S14 (vec_in norm=1.358815)
[S5] cosine check vs S14: cos=0.4913
[S5] BUFFERED delta from S14 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.532437)
[S7] loaded HEAD from S8 (vec_in norm=1.532437)
[S7] cosine check vs S8: cos=-0.0178
[S7] DROPPED delta from S8 (cos=-0.0178 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.114822)
[S14] loaded HEAD from S9 (vec_in norm=1.114822)
[S14] cosine check vs S9: cos=-0.0320
[S14] DROPPED delta from S9 (cos=-0.0320 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.6877 head_norm=0.740565
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.396463e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7067 head_norm=0.791165 delta_norm=0.439646
[S5] aggregate: ACCEPT kept=['S10', 'S14'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7020 head_norm=1.111303
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.887863e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7022 head_norm=0.930311 delta_norm=0.388786
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7012 head_norm=1.114822
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.077874e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7012 head_norm=1.041984 delta_norm=0.507787
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.249662 cos_to_last_merge=0.8808 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.881
[S2] round=12 local utility u=0.188252 metrics={'f1_val': 0.7012900746650139, 'auprc': 0.7698600523059715, 'loss_val': 0.3702188720381494, 'psi': 0.728718065721397}-{'f1_val': 0.7012918442638041, 'auprc': 0.6697542178335778, 'loss_val': 0.4464158358533569, 'psi': 0.6886767936917135}
[S3] START round=12 head_norm_before_train=1.778182 (no previous merge yet)
[S3] round=12 local utility u=0.856999 metrics={'f1_val': 0.9831153850244005, 'auprc': 0.996947783523715, 'loss_val': 0.15768589174959383, 'psi': 0.9886483444241263}-{'f1_val': 0.7006060025002057, 'auprc': 0.9986898488822904, 'loss_val': 0.18185458455941322, 'psi': 0.8198395410530395}
[S4] START round=12 head_norm_before_train=0.893462 cos_to_last_merge=0.9759 (last merge round=9)
[S4] round=12 local utility u=0.028812 metrics={'f1_val': 0.663653370273114, 'auprc': 0.6568075616592789, 'loss_val': 0.5285444943909743, 'psi': 0.66091504682758}-{'f1_val': 0.6637960452632422, 'auprc': 0.6514452117836523, 'loss_val': 0.5709384284556528, 'psi': 0.6588557118714062}
[S5] START round=12 head_norm_before_train=0.791165 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.140783 metrics={'f1_val': 0.700320598491359, 'auprc': 0.797519064895885, 'loss_val': 0.5468845024757079, 'psi': 0.7391999850531694}-{'f1_val': 0.6877165406984389, 'auprc': 0.7726654135568101, 'loss_val': 0.6782657652742679, 'psi': 0.7216960898417873}
[S6] START round=12 head_norm_before_train=0.833770 cos_to_last_merge=0.9957 (last merge round=10)
[S6] round=12 local utility u=0.456574 metrics={'f1_val': 0.6052435710287982, 'auprc': 0.7416478477550689, 'loss_val': 0.7760623027588532, 'psi': 0.6598052817193065}-{'f1_val': 0.48422782150857857, 'auprc': 0.7147353037456725, 'loss_val': 0.8823781341863233, 'psi': 0.5764308144034161}
[S7] START round=12 head_norm_before_train=1.498070 (no previous merge yet)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.6181388682164156, 'auprc': 0.797973802643999, 'loss_val': 0.6140224949617185, 'psi': 0.690072841987449}-{'f1_val': 0.6721668187195573, 'auprc': 0.8268128742859853, 'loss_val': 0.46525374621748683, 'psi': 0.7340252409461285}
[S8] START round=12 head_norm_before_train=1.532437 (no previous merge yet)
[S8] round=12 local utility u=0.024705 metrics={'f1_val': 0.7145919771750338, 'auprc': 0.9986887242443869, 'loss_val': 0.19394063660557717, 'psi': 0.8282306760027751}-{'f1_val': 0.714460606093301, 'auprc': 0.9984747357467098, 'loss_val': 0.2419201411896321, 'psi': 0.8280662579546645}
[S9] START round=12 head_norm_before_train=1.041984 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.857257 metrics={'f1_val': 0.9924766112057334, 'auprc': 0.9980793703998868, 'loss_val': 0.27646557088820367, 'psi': 0.9947177148833948}-{'f1_val': 0.7012165807733519, 'auprc': 0.9980901371202623, 'loss_val': 0.2434508986811683, 'psi': 0.8199660033121161}
[S10] START round=12 head_norm_before_train=1.521567 (no previous merge yet)
[S10] round=12 local utility u=0.071972 metrics={'f1_val': 0.6967486908852889, 'auprc': 0.9842794433242414, 'loss_val': 0.25194816944969206, 'psi': 0.8117609918608699}-{'f1_val': 0.6880161071413572, 'auprc': 0.9808962957112924, 'loss_val': 0.3333474503632262, 'psi': 0.8051681825693313}
[S11] START round=12 head_norm_before_train=0.930311 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9980104610145119, 'loss_val': 0.5199466974724951, 'psi': 0.8202202721579597}-{'f1_val': 0.7020007759458987, 'auprc': 0.9935248096285522, 'loss_val': 0.5021667076577414, 'psi': 0.81861038941896}
[S13] START round=12 head_norm_before_train=1.201803 cos_to_last_merge=0.9087 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.909
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.5549301425694305, 'auprc': 0.675940113197508, 'loss_val': 0.7479139323188135, 'psi': 0.6033341308206615}-{'f1_val': 0.6024561843181917, 'auprc': 0.6393106680538128, 'loss_val': 0.7119478476834914, 'psi': 0.6171979778124401}
[S14] START round=12 head_norm_before_train=1.358815 cos_to_last_merge=0.8822 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.882
[S14] round=12 local utility u=0.013657 metrics={'f1_val': 0.9961046970925179, 'auprc': 0.9969096160093323, 'loss_val': 0.28450538231239, 'psi': 0.9964266646592437}-{'f1_val': 0.9974763286352906, 'auprc': 0.9956764033146043, 'loss_val': 0.3163490908167849, 'psi': 0.996756358507016}
[S15] START round=12 head_norm_before_train=1.147060 cos_to_last_merge=0.9070 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.907
[S15] round=12 local utility u=0.921391 metrics={'f1_val': 0.6939225851819375, 'auprc': 0.8124150302611425, 'loss_val': 0.6670253962144056, 'psi': 0.7413195632136196}-{'f1_val': 0.40930714744298147, 'auprc': 0.7861350621361067, 'loss_val': 0.7232740672325058, 'psi': 0.5600383133202316}
[S16] START round=12 head_norm_before_train=0.800790 cos_to_last_merge=0.9978 (last merge round=10)
[S16] round=12 local utility u=0.432347 metrics={'f1_val': 0.4274662057528728, 'auprc': 0.737815150120427, 'loss_val': 0.8456008396697989, 'psi': 0.5516057834998944}-{'f1_val': 0.3064217928505239, 'auprc': 0.7395109780109812, 'loss_val': 0.9891154936858586, 'psi': 0.47965746691470684}
[S17] START round=12 head_norm_before_train=1.210132 cos_to_last_merge=0.8186 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.819
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.35228783858720547, 'auprc': 0.6827567620456203, 'loss_val': 0.927835526993991, 'psi': 0.4844754079705714}-{'f1_val': 0.35332495072624465, 'auprc': 0.6952621511267447, 'loss_val': 0.8903289186593953, 'psi': 0.49009983088644465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38516
[S8] not sending this round → trigger blocked (psi=0.828)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:38507
[S4] not sending this round → trigger blocked (psi=0.661)
[S9] not sending this round → trigger blocked (psi=0.995)
[S14] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:38504
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.812)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.301047)
[S5] loaded HEAD from S2 (vec_in norm=1.301047)
[S5] cosine check vs S2: cos=0.3864
[S5] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.193035)
[S5] loaded HEAD from S15 (vec_in norm=1.193035)
[S5] cosine check vs S15: cos=0.2437
[S5] BUFFERED delta from S15 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.844797)
[S6] loaded HEAD from S16 (vec_in norm=0.844797)
[S6] cosine check vs S16: cos=0.8125
[S6] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.828913)
[S5] loaded HEAD from S3 (vec_in norm=1.828913)
[S5] cosine check vs S3: cos=0.2214
[S5] BUFFERED delta from S3 (total buffered=3)
[S4] RECEIVED delta(kind=head bytes=1793) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.885395)
[S4] loaded HEAD from S6 (vec_in norm=0.885395)
[S4] cosine check vs S6: cos=0.6295
[S4] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.848508)
[S16] loaded HEAD from S5 (vec_in norm=0.848508)
[S16] cosine check vs S5: cos=0.8855
[S16] BUFFERED delta from S5 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6637 head_norm=0.967734
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.005139e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6638 head_norm=0.836543 delta_norm=0.400514
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.4275 head_norm=0.844797
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.025578e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4082 head_norm=0.822067 delta_norm=0.202558
[S16] aggregate: ROLLBACK (f1_val pre=0.427 post=0.408 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.6052 head_norm=0.885395
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.655960e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.6167 head_norm=0.823567 delta_norm=0.265596
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7003 head_norm=0.848508
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.247080e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7003 head_norm=0.715336 delta_norm=0.424708
[S5] aggregate: ACCEPT kept=['S2', 'S15', 'S3'] (k=3/3) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.301047 cos_to_last_merge=0.8652 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.865
[S2] round=13 local utility u=0.017243 metrics={'f1_val': 0.7015730791798309, 'auprc': 0.7676167441989484, 'loss_val': 0.3307004591580693, 'psi': 0.727990545187478}-{'f1_val': 0.7012900746650139, 'auprc': 0.7698600523059715, 'loss_val': 0.3702188720381494, 'psi': 0.728718065721397}
[S3] START round=13 head_norm_before_train=1.828913 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.9349425606302957, 'auprc': 0.9979084623603904, 'loss_val': 0.13390187959739872, 'psi': 0.9601289213223336}-{'f1_val': 0.9831153850244005, 'auprc': 0.996947783523715, 'loss_val': 0.15768589174959383, 'psi': 0.9886483444241263}
[S4] START round=13 head_norm_before_train=0.836543 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.283478 metrics={'f1_val': 0.6654156760218007, 'auprc': 0.8571325948743652, 'loss_val': 0.5731383868874403, 'psi': 0.7421024435628265}-{'f1_val': 0.663653370273114, 'auprc': 0.6568075616592789, 'loss_val': 0.5285444943909743, 'psi': 0.66091504682758}
[S5] START round=13 head_norm_before_train=0.715336 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.020266 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8063482292141491, 'loss_val': 0.5328390043651001, 'psi': 0.7427316507804751}-{'f1_val': 0.700320598491359, 'auprc': 0.797519064895885, 'loss_val': 0.5468845024757079, 'psi': 0.7391999850531694}
[S6] START round=13 head_norm_before_train=0.823567 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.080044 metrics={'f1_val': 0.6177966124664775, 'auprc': 0.7645582741561701, 'loss_val': 0.7600235291848901, 'psi': 0.6765012771423546}-{'f1_val': 0.6052435710287982, 'auprc': 0.7416478477550689, 'loss_val': 0.7760623027588532, 'psi': 0.6598052817193065}
[S7] START round=13 head_norm_before_train=1.518804 (no previous merge yet)
[S7] round=13 local utility u=0.328641 metrics={'f1_val': 0.6781373073838544, 'auprc': 0.8323884553068213, 'loss_val': 0.4199755253043129, 'psi': 0.7398377665530411}-{'f1_val': 0.6181388682164156, 'auprc': 0.797973802643999, 'loss_val': 0.6140224949617185, 'psi': 0.690072841987449}
[S8] START round=13 head_norm_before_train=1.573507 (no previous merge yet)
[S8] round=13 local utility u=0.364578 metrics={'f1_val': 0.8352939270654207, 'auprc': 0.9933569202803803, 'loss_val': 0.17300112566935952, 'psi': 0.8985191243514046}-{'f1_val': 0.7145919771750338, 'auprc': 0.9986887242443869, 'loss_val': 0.19394063660557717, 'psi': 0.8282306760027751}
[S9] START round=13 head_norm_before_train=1.109097 cos_to_last_merge=0.9924 (last merge round=11)
[S9] round=13 local utility u=0.061285 metrics={'f1_val': 0.9962421144756511, 'auprc': 0.9980825965755392, 'loss_val': 0.17649825504418665, 'psi': 0.9969783073156064}-{'f1_val': 0.9924766112057334, 'auprc': 0.9980793703998868, 'loss_val': 0.27646557088820367, 'psi': 0.9947177148833948}
[S10] START round=13 head_norm_before_train=1.557007 (no previous merge yet)
[S10] round=13 local utility u=0.058768 metrics={'f1_val': 0.7010599328168543, 'auprc': 0.997511107890639, 'loss_val': 0.19997361678249115, 'psi': 0.8196404028463682}-{'f1_val': 0.6967486908852889, 'auprc': 0.9842794433242414, 'loss_val': 0.25194816944969206, 'psi': 0.8117609918608699}
[S11] START round=13 head_norm_before_train=0.975583 cos_to_last_merge=0.9967 (last merge round=11)
[S11] round=13 local utility u=0.053096 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9963218078063956, 'loss_val': 0.4101393228987757, 'psi': 0.8196899131015503}-{'f1_val': 0.7016934795869249, 'auprc': 0.9980104610145119, 'loss_val': 0.5199466974724951, 'psi': 0.8202202721579597}
[S13] START round=13 head_norm_before_train=1.236550 cos_to_last_merge=0.9004 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.900
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.5660329279968884, 'auprc': 0.6548088962020405, 'loss_val': 0.7649562729399729, 'psi': 0.6015433152789493}-{'f1_val': 0.5549301425694305, 'auprc': 0.675940113197508, 'loss_val': 0.7479139323188135, 'psi': 0.6033341308206615}
[S14] START round=13 head_norm_before_train=1.403821 cos_to_last_merge=0.8741 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.874
[S14] round=13 local utility u=0.018548 metrics={'f1_val': 0.9975054147531532, 'auprc': 0.9970655850685449, 'loss_val': 0.2562811437348112, 'psi': 0.9973294828793099}-{'f1_val': 0.9961046970925179, 'auprc': 0.9969096160093323, 'loss_val': 0.28450538231239, 'psi': 0.9964266646592437}
[S15] START round=13 head_norm_before_train=1.193035 cos_to_last_merge=0.8922 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.892
[S15] round=13 local utility u=0.067927 metrics={'f1_val': 0.688819191815917, 'auprc': 0.8389472371984038, 'loss_val': 0.5801468715069797, 'psi': 0.7488704099689117}-{'f1_val': 0.6939225851819375, 'auprc': 0.8124150302611425, 'loss_val': 0.6670253962144056, 'psi': 0.7413195632136196}
[S16] START round=13 head_norm_before_train=0.822067 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.37385091533906545, 'auprc': 0.7379109546184816, 'loss_val': 0.9124539896205611, 'psi': 0.5194749310508319}-{'f1_val': 0.4274662057528728, 'auprc': 0.737815150120427, 'loss_val': 0.8456008396697989, 'psi': 0.5516057834998944}
[S17] START round=13 head_norm_before_train=1.232384 cos_to_last_merge=0.8096 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=13 local utility u=0.084079 metrics={'f1_val': 0.35333358580286955, 'auprc': 0.7350710543714798, 'loss_val': 0.9228958855015377, 'psi': 0.5060285732303137}-{'f1_val': 0.35228783858720547, 'auprc': 0.6827567620456203, 'loss_val': 0.927835526993991, 'psi': 0.4844754079705714}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.749)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:38514
[S2] not sending this round → trigger blocked (psi=0.728)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:38510
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.677)
[S5] not sending this round → trigger blocked (psi=0.743)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:38512
[S7] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.895383)
[S11] loaded HEAD from S4 (vec_in norm=0.895383)
[S11] cosine check vs S4: cos=0.7525
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.441573)
[S5] loaded HEAD from S14 (vec_in norm=1.441573)
[S5] cosine check vs S14: cos=0.5088
[S5] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.584917)
[S5] loaded HEAD from S10 (vec_in norm=1.584917)
[S5] cosine check vs S10: cos=0.3583
[S5] BUFFERED delta from S10 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.036057)
[S9] loaded HEAD from S11 (vec_in norm=1.036057)
[S9] cosine check vs S11: cos=-0.1285
[S9] DROPPED delta from S11 (cos=-0.1285 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.612045)
[S7] loaded HEAD from S8 (vec_in norm=1.612045)
[S7] cosine check vs S8: cos=-0.0122
[S7] DROPPED delta from S8 (cos=-0.0122 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.548344)
[S14] loaded HEAD from S7 (vec_in norm=1.548344)
[S14] cosine check vs S7: cos=-0.0207
[S14] DROPPED delta from S7 (cos=-0.0207 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.191500)
[S14] loaded HEAD from S9 (vec_in norm=1.191500)
[S14] cosine check vs S9: cos=-0.0249
[S14] DROPPED delta from S9 (cos=-0.0249 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.253000)
[S9] loaded HEAD from S17 (vec_in norm=1.253000)
[S9] cosine check vs S17: cos=0.7117
[S9] BUFFERED delta from S17 (total buffered=1)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.7003 head_norm=0.788732
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.442380e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.7003 head_norm=0.842931 delta_norm=0.444238
[S5] aggregate: ACCEPT kept=['S14', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.9962 head_norm=1.191500
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.649522e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.9937 head_norm=1.130778 delta_norm=0.464952
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7019 head_norm=1.036057
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.460487e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7019 head_norm=0.904330 delta_norm=0.346049
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.352346 cos_to_last_merge=0.8510 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.851
[S2] round=14 local utility u=0.041061 metrics={'f1_val': 0.7015674550926407, 'auprc': 0.7970088588934328, 'loss_val': 0.336721341637203, 'psi': 0.7397440166129575}-{'f1_val': 0.7015730791798309, 'auprc': 0.7676167441989484, 'loss_val': 0.3307004591580693, 'psi': 0.727990545187478}
[S3] START round=14 head_norm_before_train=1.877965 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.9341576875086368, 'auprc': 0.9988357417297646, 'loss_val': 0.14388254531419212, 'psi': 0.9600289091970879}-{'f1_val': 0.9349425606302957, 'auprc': 0.9979084623603904, 'loss_val': 0.13390187959739872, 'psi': 0.9601289213223336}
[S4] START round=14 head_norm_before_train=0.895383 cos_to_last_merge=0.9956 (last merge round=12)
[S4] round=14 local utility u=0.002616 metrics={'f1_val': 0.664335721679402, 'auprc': 0.8515299445517169, 'loss_val': 0.5446180451128702, 'psi': 0.739213410828328}-{'f1_val': 0.6654156760218007, 'auprc': 0.8571325948743652, 'loss_val': 0.5731383868874403, 'psi': 0.7421024435628265}
[S5] START round=14 head_norm_before_train=0.842931 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.296150 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9814986031878243, 'loss_val': 0.46599078341743316, 'psi': 0.8127918003699451}-{'f1_val': 0.700320598491359, 'auprc': 0.8063482292141491, 'loss_val': 0.5328390043651001, 'psi': 0.7427316507804751}
[S6] START round=14 head_norm_before_train=0.866964 cos_to_last_merge=0.9964 (last merge round=12)
[S6] round=14 local utility u=0.029324 metrics={'f1_val': 0.6064809260840576, 'auprc': 0.7805322768569768, 'loss_val': 0.6814038290377055, 'psi': 0.6761014663932252}-{'f1_val': 0.6177966124664775, 'auprc': 0.7645582741561701, 'loss_val': 0.7600235291848901, 'psi': 0.6765012771423546}
[S7] START round=14 head_norm_before_train=1.548344 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.6479650011280652, 'auprc': 0.8046030485636657, 'loss_val': 0.5338530677827401, 'psi': 0.7106202201023054}-{'f1_val': 0.6781373073838544, 'auprc': 0.8323884553068213, 'loss_val': 0.4199755253043129, 'psi': 0.7398377665530411}
[S8] START round=14 head_norm_before_train=1.612045 (no previous merge yet)
[S8] round=14 local utility u=0.465527 metrics={'f1_val': 0.9825188297729, 'auprc': 0.9987089989027746, 'loss_val': 0.14135239015702245, 'psi': 0.9889948974248498}-{'f1_val': 0.8352939270654207, 'auprc': 0.9933569202803803, 'loss_val': 0.17300112566935952, 'psi': 0.8985191243514046}
[S9] START round=14 head_norm_before_train=1.130778 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.9918057569863781, 'auprc': 0.998036355113583, 'loss_val': 0.1612313213999787, 'psi': 0.99429799623726}-{'f1_val': 0.9962421144756511, 'auprc': 0.9980825965755392, 'loss_val': 0.17649825504418665, 'psi': 0.9969783073156064}
[S10] START round=14 head_norm_before_train=1.584917 (no previous merge yet)
[S10] round=14 local utility u=0.787400 metrics={'f1_val': 0.9571057076100404, 'auprc': 0.9975819327146013, 'loss_val': 0.1616607145514489, 'psi': 0.9732961976518647}-{'f1_val': 0.7010599328168543, 'auprc': 0.997511107890639, 'loss_val': 0.19997361678249115, 'psi': 0.8196404028463682}
[S11] START round=14 head_norm_before_train=0.904330 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9978459533192766, 'loss_val': 0.43970845443112666, 'psi': 0.8202995713067027}-{'f1_val': 0.7019353166316534, 'auprc': 0.9963218078063956, 'loss_val': 0.4101393228987757, 'psi': 0.8196899131015503}
[S13] START round=14 head_norm_before_train=1.267067 cos_to_last_merge=0.8934 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.893
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5649990245907148, 'auprc': 0.6625968515821086, 'loss_val': 0.8238834672334587, 'psi': 0.6040381553872723}-{'f1_val': 0.5660329279968884, 'auprc': 0.6548088962020405, 'loss_val': 0.7649562729399729, 'psi': 0.6015433152789493}
[S14] START round=14 head_norm_before_train=1.441573 cos_to_last_merge=0.8677 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.868
[S14] round=14 local utility u=0.021289 metrics={'f1_val': 0.9979161758042404, 'auprc': 0.9956334320089003, 'loss_val': 0.2118707535059486, 'psi': 0.9970030782861043}-{'f1_val': 0.9975054147531532, 'auprc': 0.9970655850685449, 'loss_val': 0.2562811437348112, 'psi': 0.9973294828793099}
[S15] START round=14 head_norm_before_train=1.237318 cos_to_last_merge=0.8800 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.880
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6868993290383668, 'auprc': 0.7953774756506151, 'loss_val': 0.5323987492843839, 'psi': 0.7302905876832662}-{'f1_val': 0.688819191815917, 'auprc': 0.8389472371984038, 'loss_val': 0.5801468715069797, 'psi': 0.7488704099689117}
[S16] START round=14 head_norm_before_train=0.870508 cos_to_last_merge=0.9977 (last merge round=12)
[S16] round=14 local utility u=0.249280 metrics={'f1_val': 0.45487013276385635, 'auprc': 0.7402326691085921, 'loss_val': 0.9069748336152685, 'psi': 0.5690151473017506}-{'f1_val': 0.37385091533906545, 'auprc': 0.7379109546184816, 'loss_val': 0.9124539896205611, 'psi': 0.5194749310508319}
[S17] START round=14 head_norm_before_train=1.253000 cos_to_last_merge=0.8026 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.803
[S17] round=14 local utility u=0.030442 metrics={'f1_val': 0.35556039850560395, 'auprc': 0.7459860933357023, 'loss_val': 0.9081186376248123, 'psi': 0.5117306764376433}-{'f1_val': 0.35333358580286955, 'auprc': 0.7350710543714798, 'loss_val': 0.9228958855015377, 'psi': 0.5060285732303137}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:38504
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.989)
[S10] not sending this round → trigger blocked (psi=0.973)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:38516
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:38507
[S4] not sending this round → trigger blocked (psi=0.739)
[S2] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.915771)
[S4] loaded HEAD from S6 (vec_in norm=0.915771)
[S4] cosine check vs S6: cos=0.7993
[S4] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.914288)
[S16] loaded HEAD from S5 (vec_in norm=0.914288)
[S16] cosine check vs S5: cos=0.9371
[S16] BUFFERED delta from S5 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1793) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.927644)
[S6] loaded HEAD from S16 (vec_in norm=0.927644)
[S6] cosine check vs S16: cos=0.8582
[S6] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.400047)
[S5] loaded HEAD from S2 (vec_in norm=1.400047)
[S5] cosine check vs S2: cos=0.3816
[S5] BUFFERED delta from S2 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.512)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.6643 head_norm=0.950273
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.960271e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.6643 head_norm=0.884984 delta_norm=0.296027
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7003 head_norm=0.914288
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.743572e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7003 head_norm=0.971221 delta_norm=0.674357
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.4549 head_norm=0.927644
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.634831e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.5374 head_norm=0.906365 delta_norm=0.163483
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.6065 head_norm=0.915771
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.454513e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.6123 head_norm=0.888445 delta_norm=0.245451
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.400047 cos_to_last_merge=0.8385 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.839
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7004901558019874, 'auprc': 0.7877548095646624, 'loss_val': 0.3032315354269115, 'psi': 0.7353960173070574}-{'f1_val': 0.7015674550926407, 'auprc': 0.7970088588934328, 'loss_val': 0.336721341637203, 'psi': 0.7397440166129575}
[S3] START round=15 head_norm_before_train=1.916087 (no previous merge yet)
[S3] round=15 local utility u=0.201445 metrics={'f1_val': 0.9861587958890066, 'auprc': 0.9978181041712986, 'loss_val': 0.049946704082137666, 'psi': 0.9908225192019233}-{'f1_val': 0.9341576875086368, 'auprc': 0.9988357417297646, 'loss_val': 0.14388254531419212, 'psi': 0.9600289091970879}
[S4] START round=15 head_norm_before_train=0.884984 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.6640448762620724, 'auprc': 0.8391859367841159, 'loss_val': 0.5962091257453511, 'psi': 0.7341013004708898}-{'f1_val': 0.664335721679402, 'auprc': 0.8515299445517169, 'loss_val': 0.5446180451128702, 'psi': 0.739213410828328}
[S5] START round=15 head_norm_before_train=0.971221 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8344588228514079, 'loss_val': 0.469743752237707, 'psi': 0.7539758882353786}-{'f1_val': 0.700320598491359, 'auprc': 0.9814986031878243, 'loss_val': 0.46599078341743316, 'psi': 0.8127918003699451}
[S6] START round=15 head_norm_before_train=0.888445 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.099622 metrics={'f1_val': 0.6186182015943924, 'auprc': 0.8136018497949489, 'loss_val': 0.6541917026202971, 'psi': 0.696611660874615}-{'f1_val': 0.6064809260840576, 'auprc': 0.7805322768569768, 'loss_val': 0.6814038290377055, 'psi': 0.6761014663932252}
[S7] START round=15 head_norm_before_train=1.565888 (no previous merge yet)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.538123976749842, 'auprc': 0.7811451011275776, 'loss_val': 0.8594773200208814, 'psi': 0.6353324265009364}-{'f1_val': 0.6479650011280652, 'auprc': 0.8046030485636657, 'loss_val': 0.5338530677827401, 'psi': 0.7106202201023054}
[S8] START round=15 head_norm_before_train=1.639403 (no previous merge yet)
[S8] round=15 local utility u=0.061063 metrics={'f1_val': 0.9955157775999612, 'auprc': 0.9988963472072409, 'loss_val': 0.09776918724937254, 'psi': 0.9968680054428731}-{'f1_val': 0.9825188297729, 'auprc': 0.9987089989027746, 'loss_val': 0.14135239015702245, 'psi': 0.9889948974248498}
[S9] START round=15 head_norm_before_train=1.204122 cos_to_last_merge=0.9961 (last merge round=13)
[S9] round=15 local utility u=0.029566 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9980868773898808, 'loss_val': 0.11487482354329161, 'psi': 0.995580615291624}-{'f1_val': 0.9918057569863781, 'auprc': 0.998036355113583, 'loss_val': 0.1612313213999787, 'psi': 0.99429799623726}
[S10] START round=15 head_norm_before_train=1.607332 (no previous merge yet)
[S10] round=15 local utility u=0.065712 metrics={'f1_val': 0.9941284342670456, 'auprc': 0.9856937281867604, 'loss_val': 0.21670838815905089, 'psi': 0.9907545518349314}-{'f1_val': 0.9571057076100404, 'auprc': 0.9975819327146013, 'loss_val': 0.1616607145514489, 'psi': 0.9732961976518647}
[S11] START round=15 head_norm_before_train=0.959949 cos_to_last_merge=0.9954 (last merge round=13)
[S11] round=15 local utility u=0.043269 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.997861339418542, 'loss_val': 0.3517659237860109, 'psi': 0.8201606235195718}-{'f1_val': 0.7019353166316534, 'auprc': 0.9978459533192766, 'loss_val': 0.43970845443112666, 'psi': 0.8202995713067027}
[S13] START round=15 head_norm_before_train=1.296867 cos_to_last_merge=0.8860 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.886
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5662562144338745, 'auprc': 0.6693917438211737, 'loss_val': 0.856141155627855, 'psi': 0.6075104261887943}-{'f1_val': 0.5649990245907148, 'auprc': 0.6625968515821086, 'loss_val': 0.8238834672334587, 'psi': 0.6040381553872723}
[S14] START round=15 head_norm_before_train=1.477273 cos_to_last_merge=0.8619 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.862
[S14] round=15 local utility u=0.006470 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9970662573076275, 'loss_val': 0.20063056947978156, 'psi': 0.9973163495529436}-{'f1_val': 0.9979161758042404, 'auprc': 0.9956334320089003, 'loss_val': 0.2118707535059486, 'psi': 0.9970030782861043}
[S15] START round=15 head_norm_before_train=1.281027 cos_to_last_merge=0.8697 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.870
[S15] round=15 local utility u=0.140635 metrics={'f1_val': 0.6900702488629559, 'auprc': 0.8499023313694313, 'loss_val': 0.4337289280708871, 'psi': 0.7540030818655461}-{'f1_val': 0.6868993290383668, 'auprc': 0.7953774756506151, 'loss_val': 0.5323987492843839, 'psi': 0.7302905876832662}
[S16] START round=15 head_norm_before_train=0.906365 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.034613 metrics={'f1_val': 0.44930504999638304, 'auprc': 0.7532853790931779, 'loss_val': 0.8435170347828403, 'psi': 0.570897181635101}-{'f1_val': 0.45487013276385635, 'auprc': 0.7402326691085921, 'loss_val': 0.9069748336152685, 'psi': 0.5690151473017506}
[S17] START round=15 head_norm_before_train=1.270556 cos_to_last_merge=0.7965 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.796
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.36145805984198415, 'auprc': 0.7213058881304023, 'loss_val': 0.884300454475541, 'psi': 0.5053971911573514}-{'f1_val': 0.35556039850560395, 'auprc': 0.7459860933357023, 'loss_val': 0.9081186376248123, 'psi': 0.5117306764376433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38508
[S16] not sending this round → trigger blocked (psi=0.571)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:38514
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:38510
[S6] not sending this round → trigger blocked (psi=0.697)
[S11] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.023998)
[S9] loaded HEAD from S11 (vec_in norm=1.023998)
[S9] cosine check vs S11: cos=-0.1561
[S9] DROPPED delta from S11 (cos=-0.1561 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.662262)
[S7] loaded HEAD from S8 (vec_in norm=1.662262)
[S7] cosine check vs S8: cos=-0.0104
[S7] DROPPED delta from S8 (cos=-0.0104 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.274746)
[S14] loaded HEAD from S9 (vec_in norm=1.274746)
[S14] cosine check vs S9: cos=-0.0399
[S14] DROPPED delta from S9 (cos=-0.0399 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.628270)
[S5] loaded HEAD from S10 (vec_in norm=1.628270)
[S5] cosine check vs S10: cos=0.2577
[S5] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.515276)
[S5] loaded HEAD from S14 (vec_in norm=1.515276)
[S5] cosine check vs S14: cos=0.5769
[S5] BUFFERED delta from S14 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.327693)
[S5] loaded HEAD from S15 (vec_in norm=1.327693)
[S5] cosine check vs S15: cos=0.1576
[S5] BUFFERED delta from S15 (total buffered=3)
[S5] RECEIVED delta(kind=head bytes=1801) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.949071)
[S5] loaded HEAD from S3 (vec_in norm=1.949071)
[S5] cosine check vs S3: cos=0.0707
[S5] BUFFERED delta from S3 (total buffered=4)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.111 → S9@127.0.0.1:38510
[S2] ⇄ pheromone p=0.143 → S5@127.0.0.1:38505
[S4] ⇄ pheromone p=0.122 → S11@127.0.0.1:38512
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7003 head_norm=1.030064
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.643552e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7003 head_norm=0.802131 delta_norm=0.464355
[S5] aggregate: ACCEPT kept=['S10', 'S14', 'S15', 'S3'] (k=4/4) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.146 → S16@127.0.0.1:38516
[S7] ⇄ pheromone p=0.219 → S14@127.0.0.1:38514
[S6] ⇄ pheromone p=0.226 → S4@127.0.0.1:38504
[S3] ⇄ pheromone p=0.208 → S5@127.0.0.1:38505
[S15] ⇄ pheromone p=0.222 → S5@127.0.0.1:38505
[S10] ⇄ pheromone p=0.297 → S5@127.0.0.1:38505
[S14] ⇄ pheromone p=0.199 → S5@127.0.0.1:38505
[S11] ⇄ pheromone p=0.157 → S9@127.0.0.1:38510
[S8] ⇄ pheromone p=0.242 → S7@127.0.0.1:38508
[S9] ⇄ pheromone p=0.181 → S14@127.0.0.1:38514
[S17] ⇄ pheromone p=0.094 → S9@127.0.0.1:38510
[S16] ⇄ pheromone p=0.177 → S6@127.0.0.1:38507
[S2] START round=16 head_norm_before_train=1.436966 cos_to_last_merge=0.8288 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.829
[S2] round=16 local utility u=0.072690 metrics={'f1_val': 0.6907471674281055, 'auprc': 0.8585696204596169, 'loss_val': 0.31183741244154134, 'psi': 0.7578761486407101}-{'f1_val': 0.7004901558019874, 'auprc': 0.7877548095646624, 'loss_val': 0.3032315354269115, 'psi': 0.7353960173070574}
[S3] START round=16 head_norm_before_train=1.949071 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.9834363840689774, 'auprc': 0.9973533289528336, 'loss_val': 0.05008913592166068, 'psi': 0.9890031620225198}-{'f1_val': 0.9861587958890066, 'auprc': 0.9978181041712986, 'loss_val': 0.049946704082137666, 'psi': 0.9908225192019233}
[S4] START round=16 head_norm_before_train=0.928790 cos_to_last_merge=0.9971 (last merge round=14)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.6641185879372196, 'auprc': 0.657878588851966, 'loss_val': 0.5544742196943144, 'psi': 0.6616225883031182}-{'f1_val': 0.6640448762620724, 'auprc': 0.8391859367841159, 'loss_val': 0.5962091257453511, 'psi': 0.7341013004708898}
[S5] START round=16 head_norm_before_train=0.802131 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.6538956905780527, 'auprc': 0.8807491584072837, 'loss_val': 0.5068803529661347, 'psi': 0.7446370777097451}-{'f1_val': 0.700320598491359, 'auprc': 0.8344588228514079, 'loss_val': 0.469743752237707, 'psi': 0.7539758882353786}
[S6] START round=16 head_norm_before_train=0.933781 cos_to_last_merge=0.9968 (last merge round=14)
[S6] round=16 local utility u=0.556214 metrics={'f1_val': 0.703393254069226, 'auprc': 0.9641622225901414, 'loss_val': 0.5020946357345765, 'psi': 0.8077008414775921}-{'f1_val': 0.6186182015943924, 'auprc': 0.8136018497949489, 'loss_val': 0.6541917026202971, 'psi': 0.696611660874615}
[S7] START round=16 head_norm_before_train=1.575582 (no previous merge yet)
[S7] round=16 local utility u=0.112529 metrics={'f1_val': 0.564337572198317, 'auprc': 0.7827883840915375, 'loss_val': 0.7966306315104613, 'psi': 0.6517178969556052}-{'f1_val': 0.538123976749842, 'auprc': 0.7811451011275776, 'loss_val': 0.8594773200208814, 'psi': 0.6353324265009364}
[S8] START round=16 head_norm_before_train=1.662262 (no previous merge yet)
[S8] round=16 local utility u=0.006604 metrics={'f1_val': 0.9950130515203403, 'auprc': 0.9986423218881344, 'loss_val': 0.08078226851723169, 'psi': 0.9964647596674578}-{'f1_val': 0.9955157775999612, 'auprc': 0.9988963472072409, 'loss_val': 0.09776918724937254, 'psi': 0.9968680054428731}
[S9] START round=16 head_norm_before_train=1.274746 cos_to_last_merge=0.9884 (last merge round=13)
[S9] round=16 local utility u=0.017213 metrics={'f1_val': 0.9947440946163844, 'auprc': 0.9980772176719617, 'loss_val': 0.08542480129788887, 'psi': 0.9960773438386152}-{'f1_val': 0.993909773892786, 'auprc': 0.9980868773898808, 'loss_val': 0.11487482354329161, 'psi': 0.995580615291624}
[S10] START round=16 head_norm_before_train=1.628270 (no previous merge yet)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9673663384514392, 'auprc': 0.9938444403290405, 'loss_val': 0.1325129049481626, 'psi': 0.9779575792024797}-{'f1_val': 0.9941284342670456, 'auprc': 0.9856937281867604, 'loss_val': 0.21670838815905089, 'psi': 0.9907545518349314}
[S11] START round=16 head_norm_before_train=1.023998 cos_to_last_merge=0.9846 (last merge round=13)
[S11] round=16 local utility u=0.018352 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9964296345928513, 'loss_val': 0.3122171534316616, 'psi': 0.8197330438161325}-{'f1_val': 0.7016934795869249, 'auprc': 0.997861339418542, 'loss_val': 0.3517659237860109, 'psi': 0.8201606235195718}
[S13] START round=16 head_norm_before_train=1.324613 cos_to_last_merge=0.8782 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.878
[S13] round=16 local utility u=0.140131 metrics={'f1_val': 0.6042743136110241, 'auprc': 0.6509998415255545, 'loss_val': 0.7488116940156049, 'psi': 0.6229645247768363}-{'f1_val': 0.5662562144338745, 'auprc': 0.6693917438211737, 'loss_val': 0.856141155627855, 'psi': 0.6075104261887943}
[S14] START round=16 head_norm_before_train=1.515276 cos_to_last_merge=0.8562 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.856
[S14] round=16 local utility u=0.026475 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9970661439691251, 'loss_val': 0.14768045867411897, 'psi': 0.9973163042175426}-{'f1_val': 0.9974830777164877, 'auprc': 0.9970662573076275, 'loss_val': 0.20063056947978156, 'psi': 0.9973163495529436}
[S15] START round=16 head_norm_before_train=1.327693 cos_to_last_merge=0.8607 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.861
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6962922066933737, 'auprc': 0.791486413631824, 'loss_val': 0.4435817528029204, 'psi': 0.7343698894687538}-{'f1_val': 0.6900702488629559, 'auprc': 0.8499023313694313, 'loss_val': 0.4337289280708871, 'psi': 0.7540030818655461}
[S16] START round=16 head_norm_before_train=0.962394 cos_to_last_merge=0.9978 (last merge round=14)
[S16] round=16 local utility u=0.175245 metrics={'f1_val': 0.4745636200470725, 'auprc': 0.7812422133139899, 'loss_val': 0.7284483774827994, 'psi': 0.5972350573538394}-{'f1_val': 0.44930504999638304, 'auprc': 0.7532853790931779, 'loss_val': 0.8435170347828403, 'psi': 0.570897181635101}
[S17] START round=16 head_norm_before_train=1.284114 cos_to_last_merge=0.7918 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.792
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.3591420129695714, 'auprc': 0.6902351092871163, 'loss_val': 0.895171149990573, 'psi': 0.4915792514965893}-{'f1_val': 0.36145805984198415, 'auprc': 0.7213058881304023, 'loss_val': 0.884300454475541, 'psi': 0.5053971911573514}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.996)
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:38504
[S11] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[S8] not sending this round → trigger blocked (psi=0.996)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:38507
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.468218)
[S5] loaded HEAD from S2 (vec_in norm=1.468218)
[S5] cosine check vs S2: cos=0.6019
[S5] BUFFERED delta from S2 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.348664)
[S9] loaded HEAD from S13 (vec_in norm=1.348664)
[S9] cosine check vs S13: cos=0.6341
[S9] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.983447)
[S4] loaded HEAD from S6 (vec_in norm=0.983447)
[S4] cosine check vs S6: cos=0.8652
[S4] BUFFERED delta from S6 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.021663)
[S6] loaded HEAD from S16 (vec_in norm=1.021663)
[S6] cosine check vs S16: cos=0.8957
[S6] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.588521)
[S14] loaded HEAD from S7 (vec_in norm=1.588521)
[S14] cosine check vs S7: cos=-0.0209
[S14] DROPPED delta from S7 (cos=-0.0209 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.6641 head_norm=0.983644
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.553638e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.6641 head_norm=0.949816 delta_norm=0.255364
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.9947 head_norm=1.338779
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.747451e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.9950 head_norm=1.214611 delta_norm=0.574745
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.6539 head_norm=0.884210
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.862622e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.6700 head_norm=1.060680 delta_norm=0.586262
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.7034 head_norm=0.983447
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.297274e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.7070 head_norm=0.976067 delta_norm=0.229727
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.468218 cos_to_last_merge=0.8215 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.822
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.6750510426950543, 'auprc': 0.8228251662790504, 'loss_val': 0.38390274103409366, 'psi': 0.7341606921286528}-{'f1_val': 0.6907471674281055, 'auprc': 0.8585696204596169, 'loss_val': 0.31183741244154134, 'psi': 0.7578761486407101}
[S3] START round=17 head_norm_before_train=1.971163 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9972667170485393, 'loss_val': 0.07018545885113112, 'psi': 0.9758297999924243}-{'f1_val': 0.9834363840689774, 'auprc': 0.9973533289528336, 'loss_val': 0.05008913592166068, 'psi': 0.9890031620225198}
[S4] START round=17 head_norm_before_train=0.949816 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.250582 metrics={'f1_val': 0.6634029801070097, 'auprc': 0.8402900013711753, 'loss_val': 0.5962517897947394, 'psi': 0.734157788612676}-{'f1_val': 0.6641185879372196, 'auprc': 0.657878588851966, 'loss_val': 0.5544742196943144, 'psi': 0.6616225883031182}
[S5] START round=17 head_norm_before_train=1.060680 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.251579 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9168642744962526, 'loss_val': 0.3906167170060809, 'psi': 0.7869380688933165}-{'f1_val': 0.6538956905780527, 'auprc': 0.8807491584072837, 'loss_val': 0.5068803529661347, 'psi': 0.7446370777097451}
[S6] START round=17 head_norm_before_train=0.976067 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.7024256533903673, 'auprc': 0.9568001962387068, 'loss_val': 0.5243893420303158, 'psi': 0.8041754705297031}-{'f1_val': 0.703393254069226, 'auprc': 0.9641622225901414, 'loss_val': 0.5020946357345765, 'psi': 0.8077008414775921}
[S7] START round=17 head_norm_before_train=1.588521 (no previous merge yet)
[S7] round=17 local utility u=0.491375 metrics={'f1_val': 0.6606511009147912, 'auprc': 0.8043535605987985, 'loss_val': 0.4564571148833464, 'psi': 0.7181320847883941}-{'f1_val': 0.564337572198317, 'auprc': 0.7827883840915375, 'loss_val': 0.7966306315104613, 'psi': 0.6517178969556052}
[S8] START round=17 head_norm_before_train=1.688668 (no previous merge yet)
[S8] round=17 local utility u=0.003592 metrics={'f1_val': 0.9942782421240355, 'auprc': 0.998634186775184, 'loss_val': 0.0691654681032787, 'psi': 0.9960206199844949}-{'f1_val': 0.9950130515203403, 'auprc': 0.9986423218881344, 'loss_val': 0.08078226851723169, 'psi': 0.9964647596674578}
[S9] START round=17 head_norm_before_train=1.214611 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9981577315857688, 'loss_val': 0.14264575173556726, 'psi': 0.9966089279648163}-{'f1_val': 0.9947440946163844, 'auprc': 0.9980772176719617, 'loss_val': 0.08542480129788887, 'psi': 0.9960773438386152}
[S10] START round=17 head_norm_before_train=1.644779 (no previous merge yet)
[S10] round=17 local utility u=0.094730 metrics={'f1_val': 0.9949464558722565, 'auprc': 0.9973953384513367, 'loss_val': 0.11918611747157165, 'psi': 0.9959260089038886}-{'f1_val': 0.9673663384514392, 'auprc': 0.9938444403290405, 'loss_val': 0.1325129049481626, 'psi': 0.9779575792024797}
[S11] START round=17 head_norm_before_train=1.084391 cos_to_last_merge=0.9733 (last merge round=13)
[S11] round=17 local utility u=0.025722 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9978239335504466, 'loss_val': 0.26350543146716343, 'psi': 0.8201456611723336}-{'f1_val': 0.7019353166316534, 'auprc': 0.9964296345928513, 'loss_val': 0.3122171534316616, 'psi': 0.8197330438161325}
[S13] START round=17 head_norm_before_train=1.348664 cos_to_last_merge=0.8726 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.873
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5678958799023821, 'auprc': 0.6935065130458051, 'loss_val': 0.8959652399561169, 'psi': 0.6181401331597514}-{'f1_val': 0.6042743136110241, 'auprc': 0.6509998415255545, 'loss_val': 0.7488116940156049, 'psi': 0.6229645247768363}
[S14] START round=17 head_norm_before_train=1.557952 cos_to_last_merge=0.8506 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.851
[S14] round=17 local utility u=0.015118 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9969758284860835, 'loss_val': 0.11717366082412221, 'psi': 0.997280178024326}-{'f1_val': 0.9974830777164877, 'auprc': 0.9970661439691251, 'loss_val': 0.14768045867411897, 'psi': 0.9973163042175426}
[S15] START round=17 head_norm_before_train=1.371035 cos_to_last_merge=0.8530 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.853
[S15] round=17 local utility u=0.631839 metrics={'f1_val': 0.793056327924051, 'auprc': 0.9679602881849263, 'loss_val': 0.28991099425845196, 'psi': 0.8630179120284012}-{'f1_val': 0.6962922066933737, 'auprc': 0.791486413631824, 'loss_val': 0.4435817528029204, 'psi': 0.7343698894687538}
[S16] START round=17 head_norm_before_train=1.021663 cos_to_last_merge=0.9926 (last merge round=14)
[S16] round=17 local utility u=1.000000 metrics={'f1_val': 0.8169318299874174, 'auprc': 0.8070067205361555, 'loss_val': 0.8445837824152191, 'psi': 0.8129617862069127}-{'f1_val': 0.4745636200470725, 'auprc': 0.7812422133139899, 'loss_val': 0.7284483774827994, 'psi': 0.5972350573538394}
[S17] START round=17 head_norm_before_train=1.288262 cos_to_last_merge=0.7901 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.790
[S17] round=17 local utility u=0.118502 metrics={'f1_val': 0.3724902430469169, 'auprc': 0.7279237548435539, 'loss_val': 0.8513215558469452, 'psi': 0.5146636477655717}-{'f1_val': 0.3591420129695714, 'auprc': 0.6902351092871163, 'loss_val': 0.895171149990573, 'psi': 0.4915792514965893}
[S16] not sending this round → trigger blocked (psi=0.813)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:38510
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:38512
[S7] not sending this round → trigger blocked (psi=0.718)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38505
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1807 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.130256)
[S9] loaded HEAD from S11 (vec_in norm=1.130256)
[S9] cosine check vs S11: cos=-0.1104
[S9] DROPPED delta from S11 (cos=-0.1104 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1807) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.715189)
[S7] loaded HEAD from S8 (vec_in norm=1.715189)
[S7] cosine check vs S8: cos=-0.0092
[S7] DROPPED delta from S8 (cos=-0.0092 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.130266)
[S16] loaded HEAD from S5 (vec_in norm=1.130266)
[S16] cosine check vs S5: cos=0.6664
[S16] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1789) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.990185)
[S11] loaded HEAD from S4 (vec_in norm=0.990185)
[S11] cosine check vs S4: cos=0.7233
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.662519)
[S5] loaded HEAD from S10 (vec_in norm=1.662519)
[S5] cosine check vs S10: cos=0.1495
[S5] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.403088)
[S5] loaded HEAD from S15 (vec_in norm=1.403088)
[S5] cosine check vs S15: cos=0.1874
[S5] BUFFERED delta from S15 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1799) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.598621)
[S5] loaded HEAD from S14 (vec_in norm=1.598621)
[S5] cosine check vs S14: cos=0.5019
[S5] BUFFERED delta from S14 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.297140)
[S9] loaded HEAD from S17 (vec_in norm=1.297140)
[S9] cosine check vs S17: cos=0.7011
[S9] BUFFERED delta from S17 (total buffered=1)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9956 head_norm=1.279237
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.980666e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9956 head_norm=1.188040 delta_norm=0.498067
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.7003 head_norm=1.130266
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.298860e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7002 head_norm=0.882582 delta_norm=0.529886
[S5] aggregate: ACCEPT kept=['S10', 'S15', 'S14'] (k=3/3) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7017 head_norm=1.130256
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.996831e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.7017 head_norm=0.984493 delta_norm=0.399683
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.8169 head_norm=1.083313
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.525380e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.8172 head_norm=1.010318 delta_norm=0.452538
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.494101 cos_to_last_merge=0.8168 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.817
[S2] round=18 local utility u=0.043580 metrics={'f1_val': 0.7014937575602418, 'auprc': 0.7657921530387823, 'loss_val': 0.28430061820933983, 'psi': 0.7272131157516579}-{'f1_val': 0.6750510426950543, 'auprc': 0.8228251662790504, 'loss_val': 0.38390274103409366, 'psi': 0.7341606921286528}
[S3] START round=18 head_norm_before_train=1.993583 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.9228669540946113, 'auprc': 0.9971496045277237, 'loss_val': 0.13344423411295375, 'psi': 0.9525800142678562}-{'f1_val': 0.9615385219550141, 'auprc': 0.9972667170485393, 'loss_val': 0.07018545885113112, 'psi': 0.9758297999924243}
[S4] START round=18 head_norm_before_train=0.990185 cos_to_last_merge=0.9976 (last merge round=16)
[S4] round=18 local utility u=0.003182 metrics={'f1_val': 0.6616177979539618, 'auprc': 0.8324027799538534, 'loss_val': 0.5555152871539295, 'psi': 0.7299317907539185}-{'f1_val': 0.6634029801070097, 'auprc': 0.8402900013711753, 'loss_val': 0.5962517897947394, 'psi': 0.734157788612676}
[S5] START round=18 head_norm_before_train=0.882582 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.6483525178771191, 'auprc': 0.830131121249341, 'loss_val': 0.4948272761474523, 'psi': 0.7210639592260079}-{'f1_val': 0.700320598491359, 'auprc': 0.9168642744962526, 'loss_val': 0.3906167170060809, 'psi': 0.7869380688933165}
[S6] START round=18 head_norm_before_train=1.018072 cos_to_last_merge=0.9978 (last merge round=16)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.6979249424183415, 'auprc': 0.8738455558343114, 'loss_val': 0.4755826822919088, 'psi': 0.7682931877847294}-{'f1_val': 0.7024256533903673, 'auprc': 0.9568001962387068, 'loss_val': 0.5243893420303158, 'psi': 0.8041754705297031}
[S7] START round=18 head_norm_before_train=1.597273 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5431295327587422, 'auprc': 0.7834045521843521, 'loss_val': 0.9368879349651966, 'psi': 0.6392395405289861}-{'f1_val': 0.6606511009147912, 'auprc': 0.8043535605987985, 'loss_val': 0.4564571148833464, 'psi': 0.7181320847883941}
[S8] START round=18 head_norm_before_train=1.715189 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9938941842030629, 'auprc': 0.9985502829549313, 'loss_val': 0.07195836356759136, 'psi': 0.9957566237038102}-{'f1_val': 0.9942782421240355, 'auprc': 0.998634186775184, 'loss_val': 0.0691654681032787, 'psi': 0.9960206199844949}
[S9] START round=18 head_norm_before_train=1.188040 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.008717 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9950982194733486, 'loss_val': 0.12253866759821379, 'psi': 0.9960355948776743}-{'f1_val': 0.9955763922175147, 'auprc': 0.9981577315857688, 'loss_val': 0.14264575173556726, 'psi': 0.9966089279648163}
[S10] START round=18 head_norm_before_train=1.662519 (no previous merge yet)
[S10] round=18 local utility u=0.006129 metrics={'f1_val': 0.9950844032597497, 'auprc': 0.9976115313906063, 'loss_val': 0.10840509883112613, 'psi': 0.9960952545120924}-{'f1_val': 0.9949464558722565, 'auprc': 0.9973953384513367, 'loss_val': 0.11918611747157165, 'psi': 0.9959260089038886}
[S11] START round=18 head_norm_before_train=0.984493 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9977607838737835, 'loss_val': 0.33034519255031275, 'psi': 0.8202263847030621}-{'f1_val': 0.7016934795869249, 'auprc': 0.9978239335504466, 'loss_val': 0.26350543146716343, 'psi': 0.8201456611723336}
[S13] START round=18 head_norm_before_train=1.368416 cos_to_last_merge=0.8682 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.868
[S13] round=18 local utility u=0.216453 metrics={'f1_val': 0.6162900256553235, 'auprc': 0.668284000459413, 'loss_val': 0.6777570983007501, 'psi': 0.6370876155769594}-{'f1_val': 0.5678958799023821, 'auprc': 0.6935065130458051, 'loss_val': 0.8959652399561169, 'psi': 0.6181401331597514}
[S14] START round=18 head_norm_before_train=1.598621 cos_to_last_merge=0.8453 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.845
[S14] round=18 local utility u=0.012040 metrics={'f1_val': 0.9972408627570057, 'auprc': 0.9969713767767756, 'loss_val': 0.09162762321969868, 'psi': 0.9971330683649137}-{'f1_val': 0.9974830777164877, 'auprc': 0.9969758284860835, 'loss_val': 0.11717366082412221, 'psi': 0.997280178024326}
[S15] START round=18 head_norm_before_train=1.403088 cos_to_last_merge=0.8475 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.848
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.7054644103980756, 'auprc': 0.9028328088860085, 'loss_val': 0.3190940059801273, 'psi': 0.7844117697932488}-{'f1_val': 0.793056327924051, 'auprc': 0.9679602881849263, 'loss_val': 0.28991099425845196, 'psi': 0.8630179120284012}
[S16] START round=18 head_norm_before_train=1.010318 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.5432781117054172, 'auprc': 0.8621429448257488, 'loss_val': 0.613624374268903, 'psi': 0.6708240449535499}-{'f1_val': 0.8169318299874174, 'auprc': 0.8070067205361555, 'loss_val': 0.8445837824152191, 'psi': 0.8129617862069127}
[S17] START round=18 head_norm_before_train=1.297140 cos_to_last_merge=0.7866 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.787
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.3708509630185485, 'auprc': 0.6951123907310304, 'loss_val': 0.8681969736120301, 'psi': 0.5005555341035413}-{'f1_val': 0.3724902430469169, 'auprc': 0.7279237548435539, 'loss_val': 0.8513215558469452, 'psi': 0.5146636477655717}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:38514
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:38510
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.730)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.515801)
[S5] loaded HEAD from S2 (vec_in norm=1.515801)
[S5] cosine check vs S2: cos=0.6709
[S5] BUFFERED delta from S2 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1805) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.389014)
[S9] loaded HEAD from S13 (vec_in norm=1.389014)
[S9] cosine check vs S13: cos=0.6788
[S9] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.255472)
[S14] loaded HEAD from S9 (vec_in norm=1.255472)
[S14] cosine check vs S9: cos=-0.0485
[S14] DROPPED delta from S9 (cos=-0.0485 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.6484 head_norm=0.959883
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.627701e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.6657 head_norm=1.137016 delta_norm=0.562770
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9967 head_norm=1.255472
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.334322e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9967 head_norm=1.211708 delta_norm=0.533432
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.515801 cos_to_last_merge=0.8139 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.814
[S2] round=19 local utility u=0.008846 metrics={'f1_val': 0.7060455623100799, 'auprc': 0.7638453778696368, 'loss_val': 0.2880796863304698, 'psi': 0.7291654885339027}-{'f1_val': 0.7014937575602418, 'auprc': 0.7657921530387823, 'loss_val': 0.28430061820933983, 'psi': 0.7272131157516579}
[S3] START round=19 head_norm_before_train=2.020116 (no previous merge yet)
[S3] round=19 local utility u=0.040075 metrics={'f1_val': 0.9417528620058282, 'auprc': 0.9971040053681521, 'loss_val': 0.1664724031826206, 'psi': 0.9638933193507577}-{'f1_val': 0.9228669540946113, 'auprc': 0.9971496045277237, 'loss_val': 0.13344423411295375, 'psi': 0.9525800142678562}
[S4] START round=19 head_norm_before_train=1.034887 cos_to_last_merge=0.9913 (last merge round=16)
[S4] round=19 local utility u=0.157442 metrics={'f1_val': 0.6615407198663327, 'auprc': 0.9280826632275841, 'loss_val': 0.527207552879569, 'psi': 0.7681574972108333}-{'f1_val': 0.6616177979539618, 'auprc': 0.8324027799538534, 'loss_val': 0.5555152871539295, 'psi': 0.7299317907539185}
[S5] START round=19 head_norm_before_train=1.137016 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.476015 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9895004438559362, 'loss_val': 0.3327176885814484, 'psi': 0.8159929680027227}-{'f1_val': 0.6483525178771191, 'auprc': 0.830131121249341, 'loss_val': 0.4948272761474523, 'psi': 0.7210639592260079}
[S6] START round=19 head_norm_before_train=1.063774 cos_to_last_merge=0.9922 (last merge round=16)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.6475441210965729, 'auprc': 0.9429000765328119, 'loss_val': 0.4841862207825363, 'psi': 0.7656865032710685}-{'f1_val': 0.6979249424183415, 'auprc': 0.8738455558343114, 'loss_val': 0.4755826822919088, 'psi': 0.7682931877847294}
[S7] START round=19 head_norm_before_train=1.618811 (no previous merge yet)
[S7] round=19 local utility u=0.507796 metrics={'f1_val': 0.6414585724371215, 'auprc': 0.8072278726062128, 'loss_val': 0.582740391611525, 'psi': 0.707766292504758}-{'f1_val': 0.5431295327587422, 'auprc': 0.7834045521843521, 'loss_val': 0.9368879349651966, 'psi': 0.6392395405289861}
[S8] START round=19 head_norm_before_train=1.740801 (no previous merge yet)
[S8] round=19 local utility u=0.002359 metrics={'f1_val': 0.9924605795656339, 'auprc': 0.9986612214067321, 'loss_val': 0.05897135772019154, 'psi': 0.9949408363020731}-{'f1_val': 0.9938941842030629, 'auprc': 0.9985502829549313, 'loss_val': 0.07195836356759136, 'psi': 0.9957566237038102}
[S9] START round=19 head_norm_before_train=1.211708 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9981318335248613, 'loss_val': 0.14374832795674983, 'psi': 0.9967487644284558}-{'f1_val': 0.9966605118138915, 'auprc': 0.9950982194733486, 'loss_val': 0.12253866759821379, 'psi': 0.9960355948776743}
[S10] START round=19 head_norm_before_train=1.678094 (no previous merge yet)
[S10] round=19 local utility u=0.007772 metrics={'f1_val': 0.9957844306164259, 'auprc': 0.9975717908473087, 'loss_val': 0.09694194699726282, 'psi': 0.9964993747087789}-{'f1_val': 0.9950844032597497, 'auprc': 0.9976115313906063, 'loss_val': 0.10840509883112613, 'psi': 0.9960952545120924}
[S11] START round=19 head_norm_before_train=1.028239 cos_to_last_merge=0.9984 (last merge round=17)
[S11] round=19 local utility u=0.029128 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9977644677250387, 'loss_val': 0.27210110231607043, 'psi': 0.8202278582435641}-{'f1_val': 0.7018701185892477, 'auprc': 0.9977607838737835, 'loss_val': 0.33034519255031275, 'psi': 0.8202263847030621}
[S13] START round=19 head_norm_before_train=1.389014 cos_to_last_merge=0.8650 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.865
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5717088643128359, 'auprc': 0.6902452376699874, 'loss_val': 0.9488234537206424, 'psi': 0.6191234136556965}-{'f1_val': 0.6162900256553235, 'auprc': 0.668284000459413, 'loss_val': 0.6777570983007501, 'psi': 0.6370876155769594}
[S14] START round=19 head_norm_before_train=1.637811 cos_to_last_merge=0.8406 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.841
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9938997974446084, 'auprc': 0.9969755288088541, 'loss_val': 0.08294471024015664, 'psi': 0.9951300899903067}-{'f1_val': 0.9972408627570057, 'auprc': 0.9969713767767756, 'loss_val': 0.09162762321969868, 'psi': 0.9971330683649137}
[S15] START round=19 head_norm_before_train=1.437486 cos_to_last_merge=0.8422 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.842
[S15] round=19 local utility u=0.116730 metrics={'f1_val': 0.7521107552483546, 'auprc': 0.887610390673389, 'loss_val': 0.3198450042920867, 'psi': 0.8063106094183683}-{'f1_val': 0.7054644103980756, 'auprc': 0.9028328088860085, 'loss_val': 0.3190940059801273, 'psi': 0.7844117697932488}
[S16] START round=19 head_norm_before_train=1.060390 cos_to_last_merge=0.9986 (last merge round=17)
[S16] round=19 local utility u=0.810811 metrics={'f1_val': 0.8401601696053451, 'auprc': 0.8497375119214159, 'loss_val': 0.7360788151047942, 'psi': 0.8439911065317734}-{'f1_val': 0.5432781117054172, 'auprc': 0.8621429448257488, 'loss_val': 0.613624374268903, 'psi': 0.6708240449535499}
[S17] START round=19 head_norm_before_train=1.308950 cos_to_last_merge=0.7835 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.783
[S17] round=19 local utility u=0.032081 metrics={'f1_val': 0.37208226158238433, 'auprc': 0.6989759124116999, 'loss_val': 0.8230126589842606, 'psi': 0.5028397219141105}-{'f1_val': 0.3708509630185485, 'auprc': 0.6951123907310304, 'loss_val': 0.8681969736120301, 'psi': 0.5005555341035413}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:38512
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:38514
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.198871)
[S16] loaded HEAD from S5 (vec_in norm=1.198871)
[S16] cosine check vs S5: cos=0.8675
[S16] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1805) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.639337)
[S14] loaded HEAD from S7 (vec_in norm=1.639337)
[S14] cosine check vs S7: cos=-0.0217
[S14] DROPPED delta from S7 (cos=-0.0217 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.466669)
[S5] loaded HEAD from S15 (vec_in norm=1.466669)
[S5] cosine check vs S15: cos=0.2084
[S5] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.074129)
[S11] loaded HEAD from S4 (vec_in norm=1.074129)
[S11] cosine check vs S4: cos=0.8986
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.695518)
[S5] loaded HEAD from S10 (vec_in norm=1.695518)
[S5] cosine check vs S10: cos=0.1269
[S5] BUFFERED delta from S10 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1805) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.083209)
[S9] loaded HEAD from S11 (vec_in norm=1.083209)
[S9] cosine check vs S11: cos=-0.0967
[S9] DROPPED delta from S11 (cos=-0.0967 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.048054)
[S5] loaded HEAD from S3 (vec_in norm=2.048054)
[S5] cosine check vs S3: cos=0.0095
[S5] BUFFERED delta from S3 (total buffered=3)
[S7] RECEIVED delta(kind=head bytes=1797) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.764431)
[S7] loaded HEAD from S8 (vec_in norm=1.764431)
[S7] cosine check vs S8: cos=-0.0054
[S7] DROPPED delta from S8 (cos=-0.0054 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:38507
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.324819)
[S9] loaded HEAD from S17 (vec_in norm=1.324819)
[S9] cosine check vs S17: cos=0.7019
[S9] BUFFERED delta from S17 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.113957)
[S6] loaded HEAD from S16 (vec_in norm=1.113957)
[S6] cosine check vs S16: cos=0.8570
[S6] BUFFERED delta from S16 (total buffered=1)
[S2] not sending this round → trigger blocked (psi=0.729)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.6475 head_norm=1.103342
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.965126e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.9011 head_norm=1.068275 delta_norm=0.296513
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] r=20 psi=0.766 u=0.0000 p_local=0.1493 f1=0.648 auprc=0.943 bytes=10775
[S13] r=20 psi=0.619 u=0.0000 p_local=0.0946 f1=0.572 auprc=0.690 bytes=12591
[S7] r=20 psi=0.708 u=0.5078 p_local=0.2656 f1=0.641 auprc=0.807 bytes=14400
[S3] r=20 psi=0.964 u=0.0401 p_local=0.0930 f1=0.942 auprc=0.997 bytes=12583
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9958 head_norm=1.276940
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.027316e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9958 head_norm=1.200051 delta_norm=0.502732
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.997 u=0.0000 p_local=0.0774 f1=0.996 auprc=0.998 bytes=16163
[S10] r=20 psi=0.996 u=0.0078 p_local=0.1365 f1=0.996 auprc=0.998 bytes=16213
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.7019 head_norm=1.083209
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.429248e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.7019 head_norm=1.050969 delta_norm=0.242925
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.820 u=0.0291 p_local=0.0751 f1=0.702 auprc=0.998 bytes=14380
[S8] r=20 psi=0.995 u=0.0024 p_local=0.1008 f1=0.992 auprc=0.999 bytes=17999
[S15] r=20 psi=0.806 u=0.1167 p_local=0.1952 f1=0.752 auprc=0.888 bytes=16147
[S14] r=20 psi=0.995 u=0.0000 p_local=0.0881 f1=0.994 auprc=0.997 bytes=16175
[S4] r=20 psi=0.768 u=0.1574 p_local=0.1140 f1=0.662 auprc=0.928 bytes=14350
[S2] r=20 psi=0.729 u=0.0088 p_local=0.0747 f1=0.706 auprc=0.764 bytes=16180
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.7003 head_norm=1.198871
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.144589e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.7003 head_norm=0.859797 delta_norm=0.714459
[S5] aggregate: ACCEPT kept=['S15', 'S10', 'S3'] (k=3/3) mode=median trim_p=0.1
[S5] r=20 psi=0.816 u=0.4760 p_local=0.1871 f1=0.700 auprc=0.990 bytes=14372
[S17] r=20 psi=0.503 u=0.0321 p_local=0.0602 f1=0.372 auprc=0.699 bytes=14371
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.8402 head_norm=1.113957
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.004400e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.8331 head_norm=1.117511 delta_norm=0.300440
[S16] aggregate: ROLLBACK (f1_val pre=0.840 post=0.833 tol_abs=0.005 tol_rel=0.0)
[S16] r=20 psi=0.844 u=0.8108 p_local=0.3806 f1=0.840 auprc=0.850 bytes=14364
[S2] START round=20 head_norm_before_train=1.534083 cos_to_last_merge=0.8119 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.812
[S2] round=20 local utility u=0.414081 metrics={'f1_val': 0.8145883240372498, 'auprc': 0.8331076829842088, 'loss_val': 0.31896180924089856, 'psi': 0.8219960676160334}-{'f1_val': 0.7060455623100799, 'auprc': 0.7638453778696368, 'loss_val': 0.2880796863304698, 'psi': 0.7291654885339027}
[S3] START round=20 head_norm_before_train=2.048054 (no previous merge yet)
[S3] round=20 local utility u=0.179685 metrics={'f1_val': 0.9818804275164165, 'auprc': 0.9971840320826851, 'loss_val': 0.04810718733049479, 'psi': 0.988001869342924}-{'f1_val': 0.9417528620058282, 'auprc': 0.9971040053681521, 'loss_val': 0.1664724031826206, 'psi': 0.9638933193507577}
[S4] START round=20 head_norm_before_train=1.074129 cos_to_last_merge=0.9842 (last merge round=16)
[S4] round=20 local utility u=0.884375 metrics={'f1_val': 0.94537259038957, 'auprc': 0.9399497635321645, 'loss_val': 0.4970495275920262, 'psi': 0.9432034596466078}-{'f1_val': 0.6615407198663327, 'auprc': 0.9280826632275841, 'loss_val': 0.527207552879569, 'psi': 0.7681574972108333}
[S5] START round=20 head_norm_before_train=0.859797 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.626335710044275, 'auprc': 0.867477005191819, 'loss_val': 0.5057054541036291, 'psi': 0.7227922281032926}-{'f1_val': 0.7003213174339138, 'auprc': 0.9895004438559362, 'loss_val': 0.3327176885814484, 'psi': 0.8159929680027227}
[S6] START round=20 head_norm_before_train=1.068275 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.993527 metrics={'f1_val': 0.9554324098185474, 'auprc': 0.968569342895164, 'loss_val': 0.4214697100122544, 'psi': 0.9606871830491941}-{'f1_val': 0.6475441210965729, 'auprc': 0.9429000765328119, 'loss_val': 0.4841862207825363, 'psi': 0.7656865032710685}
[S7] START round=20 head_norm_before_train=1.639337 (no previous merge yet)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.6089894496496454, 'auprc': 0.7984303294721157, 'loss_val': 0.6562172810222476, 'psi': 0.6847658015786335}-{'f1_val': 0.6414585724371215, 'auprc': 0.8072278726062128, 'loss_val': 0.582740391611525, 'psi': 0.707766292504758}
[S8] START round=20 head_norm_before_train=1.764431 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9935252750776847, 'auprc': 0.988840484506814, 'loss_val': 0.06298971326267579, 'psi': 0.9916513588493364}-{'f1_val': 0.9924605795656339, 'auprc': 0.9986612214067321, 'loss_val': 0.05897135772019154, 'psi': 0.9949408363020731}
[S9] START round=20 head_norm_before_train=1.200051 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.013173 metrics={'f1_val': 0.9947440946163844, 'auprc': 0.9983731235766482, 'loss_val': 0.11163091424086295, 'psi': 0.9961957062004899}-{'f1_val': 0.9958267183641853, 'auprc': 0.9981318335248613, 'loss_val': 0.14374832795674983, 'psi': 0.9967487644284558}
[S10] START round=20 head_norm_before_train=1.695518 (no previous merge yet)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.9956047769386365, 'auprc': 0.9933938468621135, 'loss_val': 0.0883707352308578, 'psi': 0.9947204049080274}-{'f1_val': 0.9957844306164259, 'auprc': 0.9975717908473087, 'loss_val': 0.09694194699726282, 'psi': 0.9964993747087789}
[S11] START round=20 head_norm_before_train=1.050969 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.997698056915718, 'loss_val': 0.29475904832417477, 'psi': 0.8202012939198359}-{'f1_val': 0.7018701185892477, 'auprc': 0.9977644677250387, 'loss_val': 0.27210110231607043, 'psi': 0.8202278582435641}
[S13] START round=20 head_norm_before_train=1.406800 cos_to_last_merge=0.8624 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.862
[S13] round=20 local utility u=0.081089 metrics={'f1_val': 0.5921110798316149, 'auprc': 0.6859459014996975, 'loss_val': 0.896161220709388, 'psi': 0.629645008498848}-{'f1_val': 0.5717088643128359, 'auprc': 0.6902452376699874, 'loss_val': 0.9488234537206424, 'psi': 0.6191234136556965}
[S14] START round=20 head_norm_before_train=1.672461 cos_to_last_merge=0.8368 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.837
[S14] round=20 local utility u=0.016097 metrics={'f1_val': 0.9974306056599991, 'auprc': 0.9956287568206182, 'loss_val': 0.06789537995703306, 'psi': 0.9967098661242468}-{'f1_val': 0.9938997974446084, 'auprc': 0.9969755288088541, 'loss_val': 0.08294471024015664, 'psi': 0.9951300899903067}
[S15] START round=20 head_norm_before_train=1.466669 cos_to_last_merge=0.8376 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.838
[S15] round=20 local utility u=0.821321 metrics={'f1_val': 0.9556728523559667, 'auprc': 0.9828400792840473, 'loss_val': 0.18426515367004828, 'psi': 0.9665397431271989}-{'f1_val': 0.7521107552483546, 'auprc': 0.887610390673389, 'loss_val': 0.3198450042920867, 'psi': 0.8063106094183683}
[S16] START round=20 head_norm_before_train=1.117511 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.644298 metrics={'f1_val': 0.9350072890691288, 'auprc': 0.9741144315864283, 'loss_val': 0.38969641487562234, 'psi': 0.9506501460760486}-{'f1_val': 0.8401601696053451, 'auprc': 0.8497375119214159, 'loss_val': 0.7360788151047942, 'psi': 0.8439911065317734}
[S17] START round=20 head_norm_before_train=1.324819 cos_to_last_merge=0.7804 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.780
[S17] round=20 local utility u=0.826312 metrics={'f1_val': 0.6256777714685414, 'auprc': 0.737578955489216, 'loss_val': 0.8077715531151631, 'psi': 0.6704382450768113}-{'f1_val': 0.37208226158238433, 'auprc': 0.6989759124116999, 'loss_val': 0.8230126589842606, 'psi': 0.5028397219141105}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:38510
[S6] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.099225)
[S4] loaded HEAD from S6 (vec_in norm=1.099225)
[S4] cosine check vs S6: cos=0.8136
[S4] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:38512
[S14] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:38505
[S5] RECEIVED delta(kind=head bytes=1798) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.699561)
[S5] loaded HEAD from S14 (vec_in norm=1.699561)
[S5] cosine check vs S14: cos=0.3669
[S5] BUFFERED delta from S14 (total buffered=1)
[S13] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.071560)
[S5] loaded HEAD from S3 (vec_in norm=2.071560)
[S5] cosine check vs S3: cos=0.3915
[S5] BUFFERED delta from S3 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1798) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.417102)
[S9] loaded HEAD from S13 (vec_in norm=1.417102)
[S9] cosine check vs S13: cos=0.6889
[S9] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.273632)
[S14] loaded HEAD from S9 (vec_in norm=1.273632)
[S14] cosine check vs S9: cos=-0.0530
[S14] DROPPED delta from S9 (cos=-0.0530 < 0.0)
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.112987)
[S11] loaded HEAD from S4 (vec_in norm=1.112987)
[S11] cosine check vs S4: cos=0.9602
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.553976)
[S5] loaded HEAD from S2 (vec_in norm=1.553976)
[S5] cosine check vs S2: cos=0.6096
[S5] BUFFERED delta from S2 (total buffered=3)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:38507
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.496597)
[S5] loaded HEAD from S15 (vec_in norm=1.496597)
[S5] cosine check vs S15: cos=0.4519
[S5] BUFFERED delta from S15 (total buffered=4)
[S16] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.163874)
[S6] loaded HEAD from S16 (vec_in norm=1.163874)
[S6] cosine check vs S16: cos=0.8848
[S6] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.343025)
[S9] loaded HEAD from S17 (vec_in norm=1.343025)
[S9] cosine check vs S17: cos=0.9148
[S9] BUFFERED delta from S17 (total buffered=2)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.6263 head_norm=0.922773
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.618782e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.6295 head_norm=0.880290 delta_norm=0.261878
[S5] aggregate: ACCEPT kept=['S14', 'S3', 'S2', 'S15'] (k=4/4) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.150 → S16@127.0.0.1:38516
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.9554 head_norm=1.099225
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.733326e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.9585 head_norm=1.098516 delta_norm=0.273333
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.318 → S4@127.0.0.1:38504
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9947 head_norm=1.273632
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.876758e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9947 head_norm=1.199696 delta_norm=0.187676
[S9] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.065 → S14@127.0.0.1:38514
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.7019 head_norm=1.102008
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.563404e-01
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.7875 head_norm=1.096421 delta_norm=0.156340
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.060 → S9@127.0.0.1:38510
[S13] ⇄ pheromone p=0.092 → S9@127.0.0.1:38510
[S14] ⇄ pheromone p=0.074 → S5@127.0.0.1:38505
[S10] ⇄ pheromone p=0.109 → S5@127.0.0.1:38505
[S2] ⇄ pheromone p=0.143 → S5@127.0.0.1:38505
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9454 head_norm=1.112987
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.377334e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9445 head_norm=1.053306 delta_norm=0.337733
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.268 → S11@127.0.0.1:38512
[S3] ⇄ pheromone p=0.110 → S5@127.0.0.1:38505
[S15] ⇄ pheromone p=0.320 → S5@127.0.0.1:38505
[S7] ⇄ pheromone p=0.212 → S14@127.0.0.1:38514
[S8] ⇄ pheromone p=0.081 → S7@127.0.0.1:38508
[S16] ⇄ pheromone p=0.433 → S6@127.0.0.1:38507
[S17] ⇄ pheromone p=0.213 → S9@127.0.0.1:38510
[S2] START round=21 head_norm_before_train=1.553976 cos_to_last_merge=0.8101 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.810
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.8275713670988855, 'auprc': 0.8241266131051167, 'loss_val': 0.38035923410336536, 'psi': 0.826193465501378}-{'f1_val': 0.8145883240372498, 'auprc': 0.8331076829842088, 'loss_val': 0.31896180924089856, 'psi': 0.8219960676160334}
[S3] START round=21 head_norm_before_train=2.071560 (no previous merge yet)
[S3] round=21 local utility u=0.062125 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9981080082786794, 'loss_val': 0.022379545904847933, 'psi': 0.997946559791359}-{'f1_val': 0.9818804275164165, 'auprc': 0.9971840320826851, 'loss_val': 0.04810718733049479, 'psi': 0.988001869342924}
[S4] START round=21 head_norm_before_train=1.053306 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.005333 metrics={'f1_val': 0.9433281850976717, 'auprc': 0.9506210963760613, 'loss_val': 0.5061307851731197, 'psi': 0.9462453496090275}-{'f1_val': 0.94537259038957, 'auprc': 0.9399497635321645, 'loss_val': 0.4970495275920262, 'psi': 0.9432034596466078}
[S5] START round=21 head_norm_before_train=0.880290 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.051955 metrics={'f1_val': 0.653194093782734, 'auprc': 0.8410554067946625, 'loss_val': 0.4836816640890733, 'psi': 0.7283386189875054}-{'f1_val': 0.626335710044275, 'auprc': 0.867477005191819, 'loss_val': 0.5057054541036291, 'psi': 0.7227922281032926}
[S6] START round=21 head_norm_before_train=1.098516 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.000637 metrics={'f1_val': 0.9590162012283787, 'auprc': 0.9701855261963253, 'loss_val': 0.4465476046693606, 'psi': 0.9634839312155574}-{'f1_val': 0.9554324098185474, 'auprc': 0.968569342895164, 'loss_val': 0.4214697100122544, 'psi': 0.9606871830491941}
[S7] START round=21 head_norm_before_train=1.648731 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.5666120863186364, 'auprc': 0.7854301724482495, 'loss_val': 0.8049479952618885, 'psi': 0.6541393207704816}-{'f1_val': 0.6089894496496454, 'auprc': 0.7984303294721157, 'loss_val': 0.6562172810222476, 'psi': 0.6847658015786335}
[S8] START round=21 head_norm_before_train=1.784493 (no previous merge yet)
[S8] round=21 local utility u=0.011336 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9927002376287561, 'loss_val': 0.050949371590704506, 'psi': 0.9931004813159117}-{'f1_val': 0.9935252750776847, 'auprc': 0.988840484506814, 'loss_val': 0.06298971326267579, 'psi': 0.9916513588493364}
[S9] START round=21 head_norm_before_train=1.199696 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.007714 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9978904299751704, 'loss_val': 0.10623290321837525, 'psi': 0.9971503791697149}-{'f1_val': 0.9947440946163844, 'auprc': 0.9983731235766482, 'loss_val': 0.11163091424086295, 'psi': 0.9961957062004899}
[S10] START round=21 head_norm_before_train=1.715038 (no previous merge yet)
[S10] round=21 local utility u=0.012233 metrics={'f1_val': 0.9958006069973493, 'auprc': 0.9966650095145704, 'loss_val': 0.07489407544040456, 'psi': 0.9961463680042377}-{'f1_val': 0.9956047769386365, 'auprc': 0.9933938468621135, 'loss_val': 0.0883707352308578, 'psi': 0.9947204049080274}
[S11] START round=21 head_norm_before_train=1.096421 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.750008 metrics={'f1_val': 0.9488814211398046, 'auprc': 0.9976328090439681, 'loss_val': 0.27661532393943683, 'psi': 0.9683819763014699}-{'f1_val': 0.7018701185892477, 'auprc': 0.997698056915718, 'loss_val': 0.29475904832417477, 'psi': 0.8202012939198359}
[S13] START round=21 head_norm_before_train=1.417102 cos_to_last_merge=0.8603 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.860
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5834284353538295, 'auprc': 0.6857504479469656, 'loss_val': 0.8650669081845497, 'psi': 0.624357240391084}-{'f1_val': 0.5921110798316149, 'auprc': 0.6859459014996975, 'loss_val': 0.896161220709388, 'psi': 0.629645008498848}
[S14] START round=21 head_norm_before_train=1.699561 cos_to_last_merge=0.8335 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.833
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9962301447146618, 'auprc': 0.9958247720997953, 'loss_val': 0.06247531003052651, 'psi': 0.9960679956687152}-{'f1_val': 0.9974306056599991, 'auprc': 0.9956287568206182, 'loss_val': 0.06789537995703306, 'psi': 0.9967098661242468}
[S15] START round=21 head_norm_before_train=1.496597 cos_to_last_merge=0.8330 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.833
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.765345582471525, 'auprc': 0.9000104385222268, 'loss_val': 0.32644502951168225, 'psi': 0.8192115248918057}-{'f1_val': 0.9556728523559667, 'auprc': 0.9828400792840473, 'loss_val': 0.18426515367004828, 'psi': 0.9665397431271989}
[S16] START round=21 head_norm_before_train=1.163874 cos_to_last_merge=0.9985 (last merge round=19)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8746952091600867, 'auprc': 0.9498964971984852, 'loss_val': 0.5405753778619493, 'psi': 0.9047757243754461}-{'f1_val': 0.9350072890691288, 'auprc': 0.9741144315864283, 'loss_val': 0.38969641487562234, 'psi': 0.9506501460760486}
[S17] START round=21 head_norm_before_train=1.343025 cos_to_last_merge=0.7770 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.777
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.4025035160275955, 'auprc': 0.7259190240112767, 'loss_val': 0.7164293133557484, 'psi': 0.531869719221068}-{'f1_val': 0.6256777714685414, 'auprc': 0.737578955489216, 'loss_val': 0.8077715531151631, 'psi': 0.6704382450768113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:38516
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38508
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:38514
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.801757)
[S7] loaded HEAD from S8 (vec_in norm=1.801757)
[S7] cosine check vs S8: cos=-0.0070
[S7] DROPPED delta from S8 (cos=-0.0070 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.948307)
[S16] loaded HEAD from S5 (vec_in norm=0.948307)
[S16] cosine check vs S5: cos=0.8866
[S16] BUFFERED delta from S5 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.147832)
[S9] loaded HEAD from S11 (vec_in norm=1.147832)
[S9] cosine check vs S11: cos=-0.1227
[S9] DROPPED delta from S11 (cos=-0.1227 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.272161)
[S14] loaded HEAD from S9 (vec_in norm=1.272161)
[S14] cosine check vs S9: cos=-0.0550
[S14] DROPPED delta from S9 (cos=-0.0550 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.091406)
[S11] loaded HEAD from S4 (vec_in norm=1.091406)
[S11] cosine check vs S4: cos=0.9362
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.741265)
[S5] loaded HEAD from S10 (vec_in norm=1.741265)
[S5] cosine check vs S10: cos=0.2329
[S5] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.096372)
[S5] loaded HEAD from S3 (vec_in norm=2.096372)
[S5] cosine check vs S3: cos=0.3682
[S5] BUFFERED delta from S3 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.129302)
[S4] loaded HEAD from S6 (vec_in norm=1.129302)
[S4] cosine check vs S6: cos=0.8855
[S4] BUFFERED delta from S6 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.6532 head_norm=0.948307
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.709678e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.6477 head_norm=1.004232 delta_norm=0.670968
[S5] aggregate: ROLLBACK (f1_val pre=0.653 post=0.648 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9433 head_norm=1.091406
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.663004e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9436 head_norm=1.078114 delta_norm=0.266300
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9489 head_norm=1.147832
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.018456e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9578 head_norm=1.101636 delta_norm=0.201846
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.8747 head_norm=1.220526
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.900992e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8673 head_norm=1.053721 delta_norm=0.290099
[S16] aggregate: ROLLBACK (f1_val pre=0.875 post=0.867 tol_abs=0.005 tol_rel=0.0)
[S2] START round=22 head_norm_before_train=1.574337 cos_to_last_merge=0.8086 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.809
[S2] round=22 local utility u=0.194834 metrics={'f1_val': 0.8366574700199303, 'auprc': 0.900259915411865, 'loss_val': 0.2736081612920258, 'psi': 0.8620984481767042}-{'f1_val': 0.8275713670988855, 'auprc': 0.8241266131051167, 'loss_val': 0.38035923410336536, 'psi': 0.826193465501378}
[S3] START round=22 head_norm_before_train=2.096372 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9599721348864418, 'auprc': 0.9969577956942981, 'loss_val': 0.15464853755213812, 'psi': 0.9747663992095844}-{'f1_val': 0.9978389274664787, 'auprc': 0.9981080082786794, 'loss_val': 0.022379545904847933, 'psi': 0.997946559791359}
[S4] START round=22 head_norm_before_train=1.078114 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.021028 metrics={'f1_val': 0.9441247417862938, 'auprc': 0.9539138034672697, 'loss_val': 0.47873180723887776, 'psi': 0.9480403664586842}-{'f1_val': 0.9433281850976717, 'auprc': 0.9506210963760613, 'loss_val': 0.5061307851731197, 'psi': 0.9462453496090275}
[S5] START round=22 head_norm_before_train=1.004232 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.411707 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9873845638749446, 'loss_val': 0.38201784315048065, 'psi': 0.815146616010326}-{'f1_val': 0.653194093782734, 'auprc': 0.8410554067946625, 'loss_val': 0.4836816640890733, 'psi': 0.7283386189875054}
[S6] START round=22 head_norm_before_train=1.129302 cos_to_last_merge=0.9987 (last merge round=20)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.9045048851543454, 'auprc': 0.9635026513911233, 'loss_val': 0.4433620872443341, 'psi': 0.9281039916490565}-{'f1_val': 0.9590162012283787, 'auprc': 0.9701855261963253, 'loss_val': 0.4465476046693606, 'psi': 0.9634839312155574}
[S7] START round=22 head_norm_before_train=1.660154 (no previous merge yet)
[S7] round=22 local utility u=0.446487 metrics={'f1_val': 0.6534077077671054, 'auprc': 0.8083490730878965, 'loss_val': 0.5015041294095957, 'psi': 0.7153842538954218}-{'f1_val': 0.5666120863186364, 'auprc': 0.7854301724482495, 'loss_val': 0.8049479952618885, 'psi': 0.6541393207704816}
[S8] START round=22 head_norm_before_train=1.801757 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9935252750776847, 'auprc': 0.9874042920623964, 'loss_val': 0.05999927622365034, 'psi': 0.9910768818715694}-{'f1_val': 0.9933673104406822, 'auprc': 0.9927002376287561, 'loss_val': 0.050949371590704506, 'psi': 0.9931004813159117}
[S9] START round=22 head_norm_before_train=1.272161 cos_to_last_merge=0.9974 (last merge round=20)
[S9] round=22 local utility u=0.013440 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9966960968546541, 'loss_val': 0.07428862157899994, 'psi': 0.9965245501421942}-{'f1_val': 0.9966570119660778, 'auprc': 0.9978904299751704, 'loss_val': 0.10623290321837525, 'psi': 0.9971503791697149}
[S10] START round=22 head_norm_before_train=1.741265 (no previous merge yet)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9947034632575507, 'auprc': 0.9956686039136833, 'loss_val': 0.0664412876972953, 'psi': 0.9950895195200037}-{'f1_val': 0.9958006069973493, 'auprc': 0.9966650095145704, 'loss_val': 0.07489407544040456, 'psi': 0.9961463680042377}
[S11] START round=22 head_norm_before_train=1.101636 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.029147 metrics={'f1_val': 0.9568449083119597, 'auprc': 0.9977244721975971, 'loss_val': 0.26637779873687223, 'psi': 0.9731967338662146}-{'f1_val': 0.9488814211398046, 'auprc': 0.9976328090439681, 'loss_val': 0.27661532393943683, 'psi': 0.9683819763014699}
[S13] START round=22 head_norm_before_train=1.425686 cos_to_last_merge=0.8585 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.858
[S13] round=22 local utility u=0.011257 metrics={'f1_val': 0.5896883482399305, 'auprc': 0.6796263996193556, 'loss_val': 0.8617407553821095, 'psi': 0.6256635687917006}-{'f1_val': 0.5834284353538295, 'auprc': 0.6857504479469656, 'loss_val': 0.8650669081845497, 'psi': 0.624357240391084}
[S14] START round=22 head_norm_before_train=1.723104 cos_to_last_merge=0.8307 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.831
[S14] round=22 local utility u=0.004458 metrics={'f1_val': 0.9959926947843114, 'auprc': 0.9958099854313299, 'loss_val': 0.052090333825004956, 'psi': 0.9959196110431188}-{'f1_val': 0.9962301447146618, 'auprc': 0.9958247720997953, 'loss_val': 0.06247531003052651, 'psi': 0.9960679956687152}
[S15] START round=22 head_norm_before_train=1.529662 cos_to_last_merge=0.8284 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.828
[S15] round=22 local utility u=0.586630 metrics={'f1_val': 0.8953542294717008, 'auprc': 0.980098590311255, 'loss_val': 0.1735004380252142, 'psi': 0.9292519738075224}-{'f1_val': 0.765345582471525, 'auprc': 0.9000104385222268, 'loss_val': 0.32644502951168225, 'psi': 0.8192115248918057}
[S16] START round=22 head_norm_before_train=1.053721 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8243677261605784, 'auprc': 0.920404690684578, 'loss_val': 0.5432104664122442, 'psi': 0.8627825119701782}-{'f1_val': 0.8746952091600867, 'auprc': 0.9498964971984852, 'loss_val': 0.5405753778619493, 'psi': 0.9047757243754461}
[S17] START round=22 head_norm_before_train=1.364317 cos_to_last_merge=0.7746 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.775
[S17] round=22 local utility u=0.287347 metrics={'f1_val': 0.4168935174949638, 'auprc': 0.8558598486256113, 'loss_val': 0.6178985817324858, 'psi': 0.5924800499472228}-{'f1_val': 0.4025035160275955, 'auprc': 0.7259190240112767, 'loss_val': 0.7164293133557484, 'psi': 0.531869719221068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:38514
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38516
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:38512
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.114715)
[S11] loaded HEAD from S4 (vec_in norm=1.114715)
[S11] cosine check vs S4: cos=0.9275
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1803) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.598234)
[S5] loaded HEAD from S2 (vec_in norm=1.598234)
[S5] cosine check vs S2: cos=0.2599
[S5] BUFFERED delta from S2 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.342517)
[S14] loaded HEAD from S9 (vec_in norm=1.342517)
[S14] cosine check vs S9: cos=-0.0603
[S14] DROPPED delta from S9 (cos=-0.0603 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.067029)
[S16] loaded HEAD from S5 (vec_in norm=1.067029)
[S16] cosine check vs S5: cos=0.7176
[S16] BUFFERED delta from S5 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1797) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.154744)
[S9] loaded HEAD from S11 (vec_in norm=1.154744)
[S9] cosine check vs S11: cos=-0.1204
[S9] DROPPED delta from S11 (cos=-0.1204 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.435545)
[S9] loaded HEAD from S13 (vec_in norm=1.435545)
[S9] cosine check vs S13: cos=0.7509
[S9] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.748528)
[S5] loaded HEAD from S14 (vec_in norm=1.748528)
[S5] cosine check vs S14: cos=0.2320
[S5] BUFFERED delta from S14 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:38514
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.558258)
[S5] loaded HEAD from S15 (vec_in norm=1.558258)
[S5] cosine check vs S15: cos=0.2499
[S5] BUFFERED delta from S15 (total buffered=3)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.674219)
[S14] loaded HEAD from S7 (vec_in norm=1.674219)
[S14] cosine check vs S7: cos=-0.0215
[S14] DROPPED delta from S7 (cos=-0.0215 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.386602)
[S9] loaded HEAD from S17 (vec_in norm=1.386602)
[S9] cosine check vs S17: cos=0.8685
[S9] BUFFERED delta from S17 (total buffered=2)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9964 head_norm=1.342517
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.778023e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9967 head_norm=1.250426 delta_norm=0.177802
[S9] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7003 head_norm=1.067029
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.106399e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7003 head_norm=0.897129 delta_norm=0.610640
[S5] aggregate: ACCEPT kept=['S2', 'S14', 'S15'] (k=3/3) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.9568 head_norm=1.154744
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.169494e-01
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.9574 head_norm=1.113977 delta_norm=0.216949
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.8244 head_norm=1.116137
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.107942e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.8259 head_norm=1.011635 delta_norm=0.410794
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.598234 cos_to_last_merge=0.8070 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.807
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.8321563968403461, 'auprc': 0.913109510353994, 'loss_val': 0.3047248471909463, 'psi': 0.8645376422458053}-{'f1_val': 0.8366574700199303, 'auprc': 0.900259915411865, 'loss_val': 0.2736081612920258, 'psi': 0.8620984481767042}
[S3] START round=23 head_norm_before_train=2.114153 (no previous merge yet)
[S3] round=23 local utility u=0.129761 metrics={'f1_val': 0.987778990782964, 'auprc': 0.9971401918453621, 'loss_val': 0.06251428830180417, 'psi': 0.9915234712079233}-{'f1_val': 0.9599721348864418, 'auprc': 0.9969577956942981, 'loss_val': 0.15464853755213812, 'psi': 0.9747663992095844}
[S4] START round=23 head_norm_before_train=1.114715 cos_to_last_merge=0.9978 (last merge round=21)
[S4] round=23 local utility u=0.046466 metrics={'f1_val': 0.9450502496787939, 'auprc': 0.9572337072748324, 'loss_val': 0.40131270553381787, 'psi': 0.9499236327172093}-{'f1_val': 0.9441247417862938, 'auprc': 0.9539138034672697, 'loss_val': 0.47873180723887776, 'psi': 0.9480403664586842}
[S5] START round=23 head_norm_before_train=0.897129 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.032582 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9879845683707107, 'loss_val': 0.31865460697024567, 'psi': 0.8153866178086325}-{'f1_val': 0.7003213174339138, 'auprc': 0.9873845638749446, 'loss_val': 0.38201784315048065, 'psi': 0.815146616010326}
[S6] START round=23 head_norm_before_train=1.163921 cos_to_last_merge=0.9948 (last merge round=20)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.653214318308793, 'auprc': 0.7963757822355235, 'loss_val': 0.518232163638409, 'psi': 0.7104789038794852}-{'f1_val': 0.9045048851543454, 'auprc': 0.9635026513911233, 'loss_val': 0.4433620872443341, 'psi': 0.9281039916490565}
[S7] START round=23 head_norm_before_train=1.674219 (no previous merge yet)
[S7] round=23 local utility u=0.037715 metrics={'f1_val': 0.6560153834720095, 'auprc': 0.8122403609950292, 'loss_val': 0.45339434020381814, 'psi': 0.7185053744812173}-{'f1_val': 0.6534077077671054, 'auprc': 0.8083490730878965, 'loss_val': 0.5015041294095957, 'psi': 0.7153842538954218}
[S8] START round=23 head_norm_before_train=1.821199 (no previous merge yet)
[S8] round=23 local utility u=0.019983 metrics={'f1_val': 0.9922300956824643, 'auprc': 0.9988055970243855, 'loss_val': 0.04646639154479075, 'psi': 0.9948602962192328}-{'f1_val': 0.9935252750776847, 'auprc': 0.9874042920623964, 'loss_val': 0.05999927622365034, 'psi': 0.9910768818715694}
[S9] START round=23 head_norm_before_train=1.250426 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9946093097360054, 'loss_val': 0.08626383774322072, 'psi': 0.995840030982737}-{'f1_val': 0.9964101856672208, 'auprc': 0.9966960968546541, 'loss_val': 0.07428862157899994, 'psi': 0.9965245501421942}
[S10] START round=23 head_norm_before_train=1.771347 (no previous merge yet)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.993593908338861, 'auprc': 0.9956200061116535, 'loss_val': 0.06420671932683349, 'psi': 0.994404347447978}-{'f1_val': 0.9947034632575507, 'auprc': 0.9956686039136833, 'loss_val': 0.0664412876972953, 'psi': 0.9950895195200037}
[S11] START round=23 head_norm_before_train=1.113977 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.010032 metrics={'f1_val': 0.9574493080804242, 'auprc': 0.9977624081879192, 'loss_val': 0.2500530718710694, 'psi': 0.9735745481234221}-{'f1_val': 0.9568449083119597, 'auprc': 0.9977244721975971, 'loss_val': 0.26637779873687223, 'psi': 0.9731967338662146}
[S13] START round=23 head_norm_before_train=1.435545 cos_to_last_merge=0.8579 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.858
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5646385327636947, 'auprc': 0.6907745857794378, 'loss_val': 0.9741766809301973, 'psi': 0.6150929539699919}-{'f1_val': 0.5896883482399305, 'auprc': 0.6796263996193556, 'loss_val': 0.8617407553821095, 'psi': 0.6256635687917006}
[S14] START round=23 head_norm_before_train=1.748528 cos_to_last_merge=0.8277 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.828
[S14] round=23 local utility u=0.007061 metrics={'f1_val': 0.9976516241010662, 'auprc': 0.9969709027019413, 'loss_val': 0.05140392810590195, 'psi': 0.9973793355414162}-{'f1_val': 0.9959926947843114, 'auprc': 0.9958099854313299, 'loss_val': 0.052090333825004956, 'psi': 0.9959196110431188}
[S15] START round=23 head_norm_before_train=1.558258 cos_to_last_merge=0.8245 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.825
[S15] round=23 local utility u=0.145101 metrics={'f1_val': 0.9375335990558198, 'auprc': 0.9806575455920433, 'loss_val': 0.1380520984570979, 'psi': 0.9547831776703093}-{'f1_val': 0.8953542294717008, 'auprc': 0.980098590311255, 'loss_val': 0.1735004380252142, 'psi': 0.9292519738075224}
[S16] START round=23 head_norm_before_train=1.011635 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.719580 metrics={'f1_val': 0.9836643569348136, 'auprc': 0.9926426834620856, 'loss_val': 0.2765446075290726, 'psi': 0.9872556875457223}-{'f1_val': 0.8243677261605784, 'auprc': 0.920404690684578, 'loss_val': 0.5432104664122442, 'psi': 0.8627825119701782}
[S17] START round=23 head_norm_before_train=1.386602 cos_to_last_merge=0.7726 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.773
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.41170853781876515, 'auprc': 0.7988480255219437, 'loss_val': 0.6407339352258239, 'psi': 0.5665643329000366}-{'f1_val': 0.4168935174949638, 'auprc': 0.8558598486256113, 'loss_val': 0.6178985817324858, 'psi': 0.5924800499472228}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38508
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:38510
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:38514
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.158319)
[S11] loaded HEAD from S4 (vec_in norm=1.158319)
[S11] cosine check vs S4: cos=0.9771
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.585037)
[S5] loaded HEAD from S15 (vec_in norm=1.585037)
[S5] cosine check vs S15: cos=0.4118
[S5] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.128463)
[S5] loaded HEAD from S3 (vec_in norm=2.128463)
[S5] cosine check vs S3: cos=0.3594
[S5] BUFFERED delta from S3 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1798) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.767712)
[S5] loaded HEAD from S14 (vec_in norm=1.767712)
[S5] cosine check vs S14: cos=0.5993
[S5] BUFFERED delta from S14 (total buffered=3)
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.163178)
[S9] loaded HEAD from S11 (vec_in norm=1.163178)
[S9] cosine check vs S11: cos=-0.1040
[S9] DROPPED delta from S11 (cos=-0.1040 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.840178)
[S7] loaded HEAD from S8 (vec_in norm=1.840178)
[S7] cosine check vs S8: cos=-0.0062
[S7] DROPPED delta from S8 (cos=-0.0062 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.963500)
[S16] loaded HEAD from S5 (vec_in norm=0.963500)
[S16] cosine check vs S5: cos=0.9539
[S16] BUFFERED delta from S5 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.076055)
[S6] loaded HEAD from S16 (vec_in norm=1.076055)
[S6] cosine check vs S16: cos=0.8831
[S6] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1805) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.686983)
[S14] loaded HEAD from S7 (vec_in norm=1.686983)
[S14] cosine check vs S7: cos=-0.0207
[S14] DROPPED delta from S7 (cos=-0.0207 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.6532 head_norm=1.195288
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.805472e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.7932 head_norm=1.102087 delta_norm=0.280547
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.7003 head_norm=0.963500
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.376270e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.7003 head_norm=0.945780 delta_norm=0.337627
[S5] aggregate: ACCEPT kept=['S15', 'S3', 'S14'] (k=3/3) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9574 head_norm=1.163178
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.241121e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9574 head_norm=1.154097 delta_norm=0.124112
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9837 head_norm=1.076055
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.645837e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9780 head_norm=1.007981 delta_norm=0.164584
[S16] aggregate: ROLLBACK (f1_val pre=0.984 post=0.978 tol_abs=0.005 tol_rel=0.0)
[S2] START round=24 head_norm_before_train=1.625525 cos_to_last_merge=0.8050 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.805
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.8325235144385165, 'auprc': 0.8750946017218071, 'loss_val': 0.3270721571668491, 'psi': 0.8495519493518326}-{'f1_val': 0.8321563968403461, 'auprc': 0.913109510353994, 'loss_val': 0.3047248471909463, 'psi': 0.8645376422458053}
[S3] START round=24 head_norm_before_train=2.128463 (no previous merge yet)
[S3] round=24 local utility u=0.040539 metrics={'f1_val': 0.9972450390152456, 'auprc': 0.9971451736262998, 'loss_val': 0.0382482549231955, 'psi': 0.9972050928596673}-{'f1_val': 0.987778990782964, 'auprc': 0.9971401918453621, 'loss_val': 0.06251428830180417, 'psi': 0.9915234712079233}
[S4] START round=24 head_norm_before_train=1.158319 cos_to_last_merge=0.9916 (last merge round=21)
[S4] round=24 local utility u=0.016602 metrics={'f1_val': 0.9430138235932285, 'auprc': 0.9601204207261064, 'loss_val': 0.36455124507859266, 'psi': 0.9498564624463797}-{'f1_val': 0.9450502496787939, 'auprc': 0.9572337072748324, 'loss_val': 0.40131270553381787, 'psi': 0.9499236327172093}
[S5] START round=24 head_norm_before_train=0.945780 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9887575030378308, 'loss_val': 0.34624448787457424, 'psi': 0.8156957916754806}-{'f1_val': 0.7003213174339138, 'auprc': 0.9879845683707107, 'loss_val': 0.31865460697024567, 'psi': 0.8153866178086325}
[S6] START round=24 head_norm_before_train=1.102087 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.927320 metrics={'f1_val': 0.8855102217295064, 'auprc': 0.9246939933738908, 'loss_val': 0.4423218549123688, 'psi': 0.9011837303872601}-{'f1_val': 0.653214318308793, 'auprc': 0.7963757822355235, 'loss_val': 0.518232163638409, 'psi': 0.7104789038794852}
[S7] START round=24 head_norm_before_train=1.686983 (no previous merge yet)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.6231855370707703, 'auprc': 0.8014239465887045, 'loss_val': 0.5267336362077902, 'psi': 0.694480900877944}-{'f1_val': 0.6560153834720095, 'auprc': 0.8122403609950292, 'loss_val': 0.45339434020381814, 'psi': 0.7185053744812173}
[S8] START round=24 head_norm_before_train=1.840178 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.7138880036303916, 'auprc': 0.9861646041748444, 'loss_val': 0.47966147742046583, 'psi': 0.8227986438481727}-{'f1_val': 0.9922300956824643, 'auprc': 0.9988055970243855, 'loss_val': 0.04646639154479075, 'psi': 0.9948602962192328}
[S9] START round=24 head_norm_before_train=1.313480 cos_to_last_merge=0.9985 (last merge round=22)
[S9] round=24 local utility u=0.012648 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9981463350625032, 'loss_val': 0.06657617649263091, 'psi': 0.9967545650435126}-{'f1_val': 0.9966605118138915, 'auprc': 0.9946093097360054, 'loss_val': 0.08626383774322072, 'psi': 0.995840030982737}
[S10] START round=24 head_norm_before_train=1.802132 (no previous merge yet)
[S10] round=24 local utility u=0.010261 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9956489074398184, 'loss_val': 0.053231197407086574, 'psi': 0.9953618172049377}-{'f1_val': 0.993593908338861, 'auprc': 0.9956200061116535, 'loss_val': 0.06420671932683349, 'psi': 0.994404347447978}
[S11] START round=24 head_norm_before_train=1.154097 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.100250 metrics={'f1_val': 0.9869537791545326, 'auprc': 0.9964519674358853, 'loss_val': 0.22264831794486836, 'psi': 0.9907530544670737}-{'f1_val': 0.9574493080804242, 'auprc': 0.9977624081879192, 'loss_val': 0.2500530718710694, 'psi': 0.9735745481234221}
[S13] START round=24 head_norm_before_train=1.447365 cos_to_last_merge=0.8576 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.858
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5228951047345569, 'auprc': 0.6986201889508099, 'loss_val': 1.031641028836516, 'psi': 0.5931851384210581}-{'f1_val': 0.5646385327636947, 'auprc': 0.6907745857794378, 'loss_val': 0.9741766809301973, 'psi': 0.6150929539699919}
[S14] START round=24 head_norm_before_train=1.767712 cos_to_last_merge=0.8256 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.826
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9963391065268734, 'auprc': 0.9969741642633122, 'loss_val': 0.0490212761406521, 'psi': 0.996593129621449}-{'f1_val': 0.9976516241010662, 'auprc': 0.9969709027019413, 'loss_val': 0.05140392810590195, 'psi': 0.9973793355414162}
[S15] START round=24 head_norm_before_train=1.585037 cos_to_last_merge=0.8211 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.821
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.9020108777735717, 'auprc': 0.9739194383667975, 'loss_val': 0.1595693707318191, 'psi': 0.9307743020108621}-{'f1_val': 0.9375335990558198, 'auprc': 0.9806575455920433, 'loss_val': 0.1380520984570979, 'psi': 0.9547831776703093}
[S16] START round=24 head_norm_before_train=1.007981 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.9203179004874738, 'auprc': 0.9947486102669021, 'loss_val': 0.4054770200540459, 'psi': 0.9500901843992451}-{'f1_val': 0.9836643569348136, 'auprc': 0.9926426834620856, 'loss_val': 0.2765446075290726, 'psi': 0.9872556875457223}
[S17] START round=24 head_norm_before_train=1.410953 cos_to_last_merge=0.7713 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.771
[S17] round=24 local utility u=0.103183 metrics={'f1_val': 0.4756669850851452, 'auprc': 0.7500563580363422, 'loss_val': 0.6717431563721947, 'psi': 0.585422734265624}-{'f1_val': 0.41170853781876515, 'auprc': 0.7988480255219437, 'loss_val': 0.6407339352258239, 'psi': 0.5665643329000366}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:38504
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:38512
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:38514
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.204002)
[S11] loaded HEAD from S4 (vec_in norm=1.204002)
[S11] cosine check vs S4: cos=0.9880
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.139886)
[S5] loaded HEAD from S3 (vec_in norm=2.139886)
[S5] cosine check vs S3: cos=0.4537
[S5] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.828609)
[S5] loaded HEAD from S10 (vec_in norm=1.828609)
[S5] cosine check vs S10: cos=0.1918
[S5] BUFFERED delta from S10 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1797) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.199626)
[S9] loaded HEAD from S11 (vec_in norm=1.199626)
[S9] cosine check vs S11: cos=-0.1041
[S9] DROPPED delta from S11 (cos=-0.1041 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.131407)
[S4] loaded HEAD from S6 (vec_in norm=1.131407)
[S4] cosine check vs S6: cos=0.9116
[S4] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.372321)
[S14] loaded HEAD from S9 (vec_in norm=1.372321)
[S14] cosine check vs S9: cos=-0.0623
[S14] DROPPED delta from S9 (cos=-0.0623 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.442535)
[S9] loaded HEAD from S17 (vec_in norm=1.442535)
[S9] cosine check vs S17: cos=0.8514
[S9] BUFFERED delta from S17 (total buffered=1)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.7003 head_norm=0.997275
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.760342e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7003 head_norm=1.056391 delta_norm=0.676034
[S5] aggregate: ACCEPT kept=['S3', 'S10'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9430 head_norm=1.204002
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.480956e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9426 head_norm=1.141622 delta_norm=0.248096
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9870 head_norm=1.199626
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.294260e-02
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9870 head_norm=1.198217 delta_norm=0.092943
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9958 head_norm=1.372321
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.850764e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9950 head_norm=1.354180 delta_norm=0.385076
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.649301 cos_to_last_merge=0.8029 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.803
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.8094394463521006, 'auprc': 0.795965668881642, 'loss_val': 0.382652249001071, 'psi': 0.8040499353639172}-{'f1_val': 0.8325235144385165, 'auprc': 0.8750946017218071, 'loss_val': 0.3270721571668491, 'psi': 0.8495519493518326}
[S3] START round=25 head_norm_before_train=2.139886 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.8495682531689078, 'auprc': 0.9971060666250806, 'loss_val': 0.28728766250160453, 'psi': 0.908583378551377}-{'f1_val': 0.9972450390152456, 'auprc': 0.9971451736262998, 'loss_val': 0.0382482549231955, 'psi': 0.9972050928596673}
[S4] START round=25 head_norm_before_train=1.141622 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.007190 metrics={'f1_val': 0.9470043804867517, 'auprc': 0.9620408035839918, 'loss_val': 0.37987596768309084, 'psi': 0.9530189497256478}-{'f1_val': 0.9430138235932285, 'auprc': 0.9601204207261064, 'loss_val': 0.36455124507859266, 'psi': 0.9498564624463797}
[S5] START round=25 head_norm_before_train=1.056391 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9874417980528054, 'loss_val': 0.34818505842045044, 'psi': 0.8152212521530504}-{'f1_val': 0.7003213174339138, 'auprc': 0.9887575030378308, 'loss_val': 0.34624448787457424, 'psi': 0.8156957916754806}
[S6] START round=25 head_norm_before_train=1.131407 cos_to_last_merge=0.9991 (last merge round=23)
[S6] round=25 local utility u=0.351966 metrics={'f1_val': 0.9610105505236874, 'auprc': 0.9703056246432784, 'loss_val': 0.3282259258385895, 'psi': 0.9647285801715239}-{'f1_val': 0.8855102217295064, 'auprc': 0.9246939933738908, 'loss_val': 0.4423218549123688, 'psi': 0.9011837303872601}
[S7] START round=25 head_norm_before_train=1.696200 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.5659779949345536, 'auprc': 0.7848330300062982, 'loss_val': 0.8344797677596959, 'psi': 0.6535200089632515}-{'f1_val': 0.6231855370707703, 'auprc': 0.8014239465887045, 'loss_val': 0.5267336362077902, 'psi': 0.694480900877944}
[S8] START round=25 head_norm_before_train=1.859011 (no previous merge yet)
[S8] round=25 local utility u=1.000000 metrics={'f1_val': 0.9882719985577009, 'auprc': 0.9988881075462667, 'loss_val': 0.04966942377027474, 'psi': 0.9925184421531272}-{'f1_val': 0.7138880036303916, 'auprc': 0.9861646041748444, 'loss_val': 0.47966147742046583, 'psi': 0.8227986438481727}
[S9] START round=25 head_norm_before_train=1.354180 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9958312226609984, 'auprc': 0.9983991854936237, 'loss_val': 0.06783277179228535, 'psi': 0.9968584077940486}-{'f1_val': 0.9958267183641853, 'auprc': 0.9981463350625032, 'loss_val': 0.06657617649263091, 'psi': 0.9967545650435126}
[S10] START round=25 head_norm_before_train=1.828609 (no previous merge yet)
[S10] round=25 local utility u=0.001953 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9936494517658697, 'loss_val': 0.04842513885669558, 'psi': 0.9950719366593518}-{'f1_val': 0.9951704237150173, 'auprc': 0.9956489074398184, 'loss_val': 0.053231197407086574, 'psi': 0.9953618172049377}
[S11] START round=25 head_norm_before_train=1.198217 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.036195 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9959940418607467, 'loss_val': 0.2064431962950288, 'psi': 0.9963258194524525}-{'f1_val': 0.9869537791545326, 'auprc': 0.9964519674358853, 'loss_val': 0.22264831794486836, 'psi': 0.9907530544670737}
[S13] START round=25 head_norm_before_train=1.452180 cos_to_last_merge=0.8564 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.856
[S13] round=25 local utility u=0.267598 metrics={'f1_val': 0.601136278938625, 'auprc': 0.6241761776506167, 'loss_val': 0.7425609658401848, 'psi': 0.6103522384234217}-{'f1_val': 0.5228951047345569, 'auprc': 0.6986201889508099, 'loss_val': 1.031641028836516, 'psi': 0.5931851384210581}
[S14] START round=25 head_norm_before_train=1.787296 cos_to_last_merge=0.8235 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.824
[S14] round=25 local utility u=0.003976 metrics={'f1_val': 0.9966461383503629, 'auprc': 0.9969733643495033, 'loss_val': 0.042908655463679675, 'psi': 0.9967770287500191}-{'f1_val': 0.9963391065268734, 'auprc': 0.9969741642633122, 'loss_val': 0.0490212761406521, 'psi': 0.996593129621449}
[S15] START round=25 head_norm_before_train=1.615270 cos_to_last_merge=0.8177 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.818
[S15] round=25 local utility u=0.310951 metrics={'f1_val': 0.991132104788312, 'auprc': 0.9812268989072765, 'loss_val': 0.09431672730602789, 'psi': 0.9871700224358979}-{'f1_val': 0.9020108777735717, 'auprc': 0.9739194383667975, 'loss_val': 0.1595693707318191, 'psi': 0.9307743020108621}
[S16] START round=25 head_norm_before_train=1.077544 cos_to_last_merge=0.9971 (last merge round=23)
[S16] round=25 local utility u=0.089856 metrics={'f1_val': 0.9326321753792596, 'auprc': 0.9952614633272333, 'loss_val': 0.3011897924298406, 'psi': 0.957683890558449}-{'f1_val': 0.9203179004874738, 'auprc': 0.9947486102669021, 'loss_val': 0.4054770200540459, 'psi': 0.9500901843992451}
[S17] START round=25 head_norm_before_train=1.442535 cos_to_last_merge=0.7703 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.770
[S17] round=25 local utility u=0.675289 metrics={'f1_val': 0.6135817238769659, 'auprc': 0.891116149947168, 'loss_val': 0.5718325113488517, 'psi': 0.7245954943050468}-{'f1_val': 0.4756669850851452, 'auprc': 0.7500563580363422, 'loss_val': 0.6717431563721947, 'psi': 0.585422734265624}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:38504
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:38505
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:38512
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S13] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.851397)
[S5] loaded HEAD from S10 (vec_in norm=1.851397)
[S5] cosine check vs S10: cos=0.5608
[S5] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.244134)
[S9] loaded HEAD from S11 (vec_in norm=1.244134)
[S9] cosine check vs S11: cos=-0.1325
[S9] DROPPED delta from S11 (cos=-0.1325 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.161153)
[S4] loaded HEAD from S6 (vec_in norm=1.161153)
[S4] cosine check vs S6: cos=0.9670
[S4] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.869993)
[S7] loaded HEAD from S8 (vec_in norm=1.869993)
[S7] cosine check vs S8: cos=-0.0057
[S7] DROPPED delta from S8 (cos=-0.0057 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.147096)
[S6] loaded HEAD from S16 (vec_in norm=1.147096)
[S6] cosine check vs S16: cos=0.9613
[S6] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.638556)
[S5] loaded HEAD from S15 (vec_in norm=1.638556)
[S5] cosine check vs S15: cos=0.2921
[S5] BUFFERED delta from S15 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.181390)
[S11] loaded HEAD from S4 (vec_in norm=1.181390)
[S11] cosine check vs S4: cos=0.9748
[S11] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1795) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.457184)
[S9] loaded HEAD from S13 (vec_in norm=1.457184)
[S9] cosine check vs S13: cos=0.6105
[S9] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1805) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.808646)
[S5] loaded HEAD from S14 (vec_in norm=1.808646)
[S5] cosine check vs S14: cos=0.2523
[S5] BUFFERED delta from S14 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.477704)
[S9] loaded HEAD from S17 (vec_in norm=1.477704)
[S9] cosine check vs S17: cos=0.9592
[S9] BUFFERED delta from S17 (total buffered=2)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9958 head_norm=1.401513
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.443373e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9958 head_norm=1.294728 delta_norm=0.244337
[S9] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.025 → S14@127.0.0.1:38514
[S2] ⇄ pheromone p=0.067 → S5@127.0.0.1:38505
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.7004 head_norm=1.098583
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.666709e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.7006 head_norm=0.960836 delta_norm=0.466671
[S5] aggregate: ACCEPT kept=['S10', 'S15', 'S14'] (k=3/3) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.100 → S16@127.0.0.1:38516
[S7] ⇄ pheromone p=0.120 → S14@127.0.0.1:38514
[S3] ⇄ pheromone p=0.064 → S5@127.0.0.1:38505
[S10] ⇄ pheromone p=0.039 → S5@127.0.0.1:38505
[S13] ⇄ pheromone p=0.085 → S9@127.0.0.1:38510
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9965 head_norm=1.244134
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.396170e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9965 head_norm=1.205107 delta_norm=0.139617
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.109 → S9@127.0.0.1:38510
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.9610 head_norm=1.161153
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.606371e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.9610 head_norm=1.142912 delta_norm=0.160637
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.323 → S4@127.0.0.1:38504
[S14] ⇄ pheromone p=0.026 → S5@127.0.0.1:38505
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=25 metric=0.9470 head_norm=1.181390
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.508794e-01
[S4] stored merged vector for next round verification (round=25)
[S4] DEBUG after merge:  round=25 metric=0.9469 head_norm=1.161557 delta_norm=0.150879
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.100 → S11@127.0.0.1:38512
[S16] ⇄ pheromone p=0.252 → S6@127.0.0.1:38507
[S8] ⇄ pheromone p=0.230 → S7@127.0.0.1:38508
[S15] ⇄ pheromone p=0.246 → S5@127.0.0.1:38505
[S17] ⇄ pheromone p=0.251 → S9@127.0.0.1:38510
[S2] START round=26 head_norm_before_train=1.673227 cos_to_last_merge=0.8006 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.801
[S2] round=26 local utility u=0.137057 metrics={'f1_val': 0.8249653534527586, 'auprc': 0.8686036897486946, 'loss_val': 0.41960815334733986, 'psi': 0.842420687971133}-{'f1_val': 0.8094394463521006, 'auprc': 0.795965668881642, 'loss_val': 0.382652249001071, 'psi': 0.8040499353639172}
[S3] START round=26 head_norm_before_train=2.152876 (no previous merge yet)
[S3] round=26 local utility u=0.331163 metrics={'f1_val': 0.9306047805229252, 'auprc': 0.9985900516391331, 'loss_val': 0.11563255067982815, 'psi': 0.9577988889694082}-{'f1_val': 0.8495682531689078, 'auprc': 0.9971060666250806, 'loss_val': 0.28728766250160453, 'psi': 0.908583378551377}
[S4] START round=26 head_norm_before_train=1.161557 cos_to_last_merge=1.0000 (last merge round=25)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9384800445087587, 'auprc': 0.9237522844502826, 'loss_val': 0.4216294115460042, 'psi': 0.9325889404853682}-{'f1_val': 0.9470043804867517, 'auprc': 0.9620408035839918, 'loss_val': 0.37987596768309084, 'psi': 0.9530189497256478}
[S5] START round=26 head_norm_before_train=0.960836 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.945329630290687, 'loss_val': 0.4113745192483247, 'psi': 0.7983759979448358}-{'f1_val': 0.700407554886547, 'auprc': 0.9874417980528054, 'loss_val': 0.34818505842045044, 'psi': 0.8152212521530504}
[S6] START round=26 head_norm_before_train=1.142912 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.8159862970148675, 'auprc': 0.8863392429956062, 'loss_val': 0.4685033803752021, 'psi': 0.844127475407163}-{'f1_val': 0.9610105505236874, 'auprc': 0.9703056246432784, 'loss_val': 0.3282259258385895, 'psi': 0.9647285801715239}
[S7] START round=26 head_norm_before_train=1.704587 (no previous merge yet)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.4896611940147092, 'auprc': 0.781823754830113, 'loss_val': 1.0662638988469997, 'psi': 0.6065262183408707}-{'f1_val': 0.5659779949345536, 'auprc': 0.7848330300062982, 'loss_val': 0.8344797677596959, 'psi': 0.6535200089632515}
[S8] START round=26 head_norm_before_train=1.869993 (no previous merge yet)
[S8] round=26 local utility u=0.000075 metrics={'f1_val': 0.9939009886418481, 'auprc': 0.986705105629887, 'loss_val': 0.04674442842040291, 'psi': 0.9910226354370636}-{'f1_val': 0.9882719985577009, 'auprc': 0.9988881075462667, 'loss_val': 0.04966942377027474, 'psi': 0.9925184421531272}
[S9] START round=26 head_norm_before_train=1.294728 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981292884261039, 'loss_val': 0.0742312534257227, 'psi': 0.9972480224587764}-{'f1_val': 0.9958312226609984, 'auprc': 0.9983991854936237, 'loss_val': 0.06783277179228535, 'psi': 0.9968584077940486}
[S10] START round=26 head_norm_before_train=1.851397 (no previous merge yet)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.995529245581552, 'loss_val': 0.04706146750470905, 'psi': 0.9950608637642443}-{'f1_val': 0.9960202599216732, 'auprc': 0.9936494517658697, 'loss_val': 0.04842513885669558, 'psi': 0.9950719366593518}
[S11] START round=26 head_norm_before_train=1.205107 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.011570 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9972199075520818, 'loss_val': 0.18685994234976863, 'psi': 0.9968040819182119}-{'f1_val': 0.9965470045135896, 'auprc': 0.9959940418607467, 'loss_val': 0.2064431962950288, 'psi': 0.9963258194524525}
[S13] START round=26 head_norm_before_train=1.457184 cos_to_last_merge=0.8565 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.857
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.537539799945035, 'auprc': 0.6913778673285467, 'loss_val': 0.9664373987566286, 'psi': 0.5990750268984397}-{'f1_val': 0.601136278938625, 'auprc': 0.6241761776506167, 'loss_val': 0.7425609658401848, 'psi': 0.6103522384234217}
[S14] START round=26 head_norm_before_train=1.808646 cos_to_last_merge=0.8214 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.821
[S14] round=26 local utility u=0.001604 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9962363690326654, 'loss_val': 0.04105441781492253, 'psi': 0.996838761636542}-{'f1_val': 0.9966461383503629, 'auprc': 0.9969733643495033, 'loss_val': 0.042908655463679675, 'psi': 0.9967770287500191}
[S15] START round=26 head_norm_before_train=1.638556 cos_to_last_merge=0.8154 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.815
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.8262792581628061, 'auprc': 0.9478535067614214, 'loss_val': 0.25785355197245213, 'psi': 0.8749089576022522}-{'f1_val': 0.991132104788312, 'auprc': 0.9812268989072765, 'loss_val': 0.09431672730602789, 'psi': 0.9871700224358979}
[S16] START round=26 head_norm_before_train=1.147096 cos_to_last_merge=0.9906 (last merge round=23)
[S16] round=26 local utility u=0.214612 metrics={'f1_val': 0.9850964666280954, 'auprc': 0.9920454331506914, 'loss_val': 0.17710250136253275, 'psi': 0.9878760532371338}-{'f1_val': 0.9326321753792596, 'auprc': 0.9952614633272333, 'loss_val': 0.3011897924298406, 'psi': 0.957683890558449}
[S17] START round=26 head_norm_before_train=1.477704 cos_to_last_merge=0.7693 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.769
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.4991614751815931, 'auprc': 0.7015915084636751, 'loss_val': 0.851109670627768, 'psi': 0.5801334884944259}-{'f1_val': 0.6135817238769659, 'auprc': 0.891116149947168, 'loss_val': 0.5718325113488517, 'psi': 0.7245954943050468}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:38507
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:38508
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.164067)
[S5] loaded HEAD from S3 (vec_in norm=2.164067)
[S5] cosine check vs S3: cos=0.4269
[S5] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.828754)
[S5] loaded HEAD from S14 (vec_in norm=1.828754)
[S5] cosine check vs S14: cos=0.4945
[S5] BUFFERED delta from S14 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.251958)
[S9] loaded HEAD from S11 (vec_in norm=1.251958)
[S9] cosine check vs S11: cos=-0.1099
[S9] DROPPED delta from S11 (cos=-0.1099 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1805) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.881958)
[S7] loaded HEAD from S8 (vec_in norm=1.881958)
[S7] cosine check vs S8: cos=-0.0049
[S7] DROPPED delta from S8 (cos=-0.0049 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1805) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.210356)
[S6] loaded HEAD from S16 (vec_in norm=1.210356)
[S6] cosine check vs S16: cos=0.9861
[S6] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.692422)
[S5] loaded HEAD from S2 (vec_in norm=1.692422)
[S5] cosine check vs S2: cos=0.1952
[S5] BUFFERED delta from S2 (total buffered=3)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.7004 head_norm=1.008933
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.064728e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.7004 head_norm=0.965869 delta_norm=0.506473
[S5] aggregate: ACCEPT kept=['S3', 'S14', 'S2'] (k=3/3) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.8160 head_norm=1.166069
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.013638e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.8204 head_norm=1.184088 delta_norm=0.101364
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.692422 cos_to_last_merge=0.7984 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.798
[S2] round=27 local utility u=0.078160 metrics={'f1_val': 0.8301222780813782, 'auprc': 0.8957078183076017, 'loss_val': 0.3755426383558233, 'psi': 0.8563564941718675}-{'f1_val': 0.8249653534527586, 'auprc': 0.8686036897486946, 'loss_val': 0.41960815334733986, 'psi': 0.842420687971133}
[S3] START round=27 head_norm_before_train=2.164067 (no previous merge yet)
[S3] round=27 local utility u=0.098968 metrics={'f1_val': 0.9612927942165166, 'auprc': 0.9972158700287753, 'loss_val': 0.09770301095030086, 'psi': 0.97566202454142}-{'f1_val': 0.9306047805229252, 'auprc': 0.9985900516391331, 'loss_val': 0.11563255067982815, 'psi': 0.9577988889694082}
[S4] START round=27 head_norm_before_train=1.203111 cos_to_last_merge=0.9976 (last merge round=25)
[S4] round=27 local utility u=0.115814 metrics={'f1_val': 0.9450893759325766, 'auprc': 0.961675493069623, 'loss_val': 0.34342797327657915, 'psi': 0.9517238227873952}-{'f1_val': 0.9384800445087587, 'auprc': 0.9237522844502826, 'loss_val': 0.4216294115460042, 'psi': 0.9325889404853682}
[S5] START round=27 head_norm_before_train=0.965869 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.6938793792718873, 'auprc': 0.95470639113752, 'loss_val': 0.41627419316292674, 'psi': 0.7982101840181404}-{'f1_val': 0.7004069097142683, 'auprc': 0.945329630290687, 'loss_val': 0.4113745192483247, 'psi': 0.7983759979448358}
[S6] START round=27 head_norm_before_train=1.184088 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.514628 metrics={'f1_val': 0.939469630269705, 'auprc': 0.9605256038263931, 'loss_val': 0.4027070191193884, 'psi': 0.9478920196923802}-{'f1_val': 0.8159862970148675, 'auprc': 0.8863392429956062, 'loss_val': 0.4685033803752021, 'psi': 0.844127475407163}
[S7] START round=27 head_norm_before_train=1.713966 (no previous merge yet)
[S7] round=27 local utility u=0.420385 metrics={'f1_val': 0.5783286370098544, 'auprc': 0.7857196571893016, 'loss_val': 0.7691871334657814, 'psi': 0.6612850450816332}-{'f1_val': 0.4896611940147092, 'auprc': 0.781823754830113, 'loss_val': 1.0662638988469997, 'psi': 0.6065262183408707}
[S8] START round=27 head_norm_before_train=1.881958 (no previous merge yet)
[S8] round=27 local utility u=0.014984 metrics={'f1_val': 0.993467150337892, 'auprc': 0.9951574674484098, 'loss_val': 0.03953119927682037, 'psi': 0.9941432771820992}-{'f1_val': 0.9939009886418481, 'auprc': 0.986705105629887, 'loss_val': 0.04674442842040291, 'psi': 0.9910226354370636}
[S9] START round=27 head_norm_before_train=1.348943 cos_to_last_merge=0.9990 (last merge round=25)
[S9] round=27 local utility u=0.003540 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9954877058790342, 'loss_val': 0.059227120216366544, 'psi': 0.9961913894399486}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981292884261039, 'loss_val': 0.0742312534257227, 'psi': 0.9972480224587764}
[S10] START round=27 head_norm_before_train=1.869022 (no previous merge yet)
[S10] round=27 local utility u=0.006214 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9964292448860741, 'loss_val': 0.04250017101202644, 'psi': 0.9959374900634415}-{'f1_val': 0.9947486092193725, 'auprc': 0.995529245581552, 'loss_val': 0.04706146750470905, 'psi': 0.9950608637642443}
[S11] START round=27 head_norm_before_train=1.251958 cos_to_last_merge=0.9984 (last merge round=25)
[S11] round=27 local utility u=0.020364 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9977334312558844, 'loss_val': 0.1462223507000486, 'psi': 0.9968643895847272}-{'f1_val': 0.9965268648289654, 'auprc': 0.9972199075520818, 'loss_val': 0.18685994234976863, 'psi': 0.9968040819182119}
[S13] START round=27 head_norm_before_train=1.462038 cos_to_last_merge=0.8561 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.856
[S13] round=27 local utility u=0.292407 metrics={'f1_val': 0.5994169557856728, 'auprc': 0.678232304787356, 'loss_val': 0.713449839446171, 'psi': 0.6309430953863461}-{'f1_val': 0.537539799945035, 'auprc': 0.6913778673285467, 'loss_val': 0.9664373987566286, 'psi': 0.5990750268984397}
[S14] START round=27 head_norm_before_train=1.828754 cos_to_last_merge=0.8192 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.819
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.9948233426933917, 'loss_val': 0.03733991856066046, 'psi': 0.9961730177791004}-{'f1_val': 0.997240356705793, 'auprc': 0.9962363690326654, 'loss_val': 0.04105441781492253, 'psi': 0.996838761636542}
[S15] START round=27 head_norm_before_train=1.659857 cos_to_last_merge=0.8134 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.813
[S15] round=27 local utility u=0.612098 metrics={'f1_val': 0.9869817378693825, 'auprc': 0.9808762999524776, 'loss_val': 0.09694008494336621, 'psi': 0.9845395627026206}-{'f1_val': 0.8262792581628061, 'auprc': 0.9478535067614214, 'loss_val': 0.25785355197245213, 'psi': 0.8749089576022522}
[S16] START round=27 head_norm_before_train=1.210356 cos_to_last_merge=0.9833 (last merge round=23)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.8947199170136475, 'auprc': 0.994050508903445, 'loss_val': 0.43269910557715463, 'psi': 0.9344521537695666}-{'f1_val': 0.9850964666280954, 'auprc': 0.9920454331506914, 'loss_val': 0.17710250136253275, 'psi': 0.9878760532371338}
[S17] START round=27 head_norm_before_train=1.516671 cos_to_last_merge=0.7687 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.769
[S17] round=27 local utility u=0.448343 metrics={'f1_val': 0.5911708302546959, 'auprc': 0.7827150557767381, 'loss_val': 0.7498502883841855, 'psi': 0.6677885204635128}-{'f1_val': 0.4991614751815931, 'auprc': 0.7015915084636751, 'loss_val': 0.851109670627768, 'psi': 0.5801334884944259}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.994)
[S2] not sending this round → trigger blocked (psi=0.856)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:38504
[S3] not sending this round → trigger blocked (psi=0.976)
[S11] not sending this round → trigger blocked (psi=0.997)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1807 to 1 peers)
[S15] sending update (kind=head size=1807 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1807) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.682053)
[S5] loaded HEAD from S15 (vec_in norm=1.682053)
[S5] cosine check vs S15: cos=0.2920
[S5] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.887370)
[S5] loaded HEAD from S10 (vec_in norm=1.887370)
[S5] cosine check vs S10: cos=0.3231
[S5] BUFFERED delta from S10 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1797) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.468455)
[S9] loaded HEAD from S13 (vec_in norm=1.468455)
[S9] cosine check vs S13: cos=0.7198
[S9] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1803) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.208873)
[S4] loaded HEAD from S6 (vec_in norm=1.208873)
[S4] cosine check vs S6: cos=0.9445
[S4] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.253177)
[S11] loaded HEAD from S4 (vec_in norm=1.253177)
[S11] cosine check vs S4: cos=0.9734
[S11] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.402243)
[S14] loaded HEAD from S9 (vec_in norm=1.402243)
[S14] cosine check vs S9: cos=-0.0600
[S14] DROPPED delta from S9 (cos=-0.0600 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1807) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.719210)
[S14] loaded HEAD from S7 (vec_in norm=1.719210)
[S14] cosine check vs S7: cos=-0.0212
[S14] DROPPED delta from S7 (cos=-0.0212 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.550688)
[S9] loaded HEAD from S17 (vec_in norm=1.550688)
[S9] cosine check vs S17: cos=0.9094
[S9] BUFFERED delta from S17 (total buffered=2)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.6939 head_norm=1.007828
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.016917e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.6894 head_norm=0.957505 delta_norm=0.601692
[S5] aggregate: ACCEPT kept=['S15', 'S10'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9451 head_norm=1.253177
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.061931e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9441 head_norm=1.213836 delta_norm=0.206193
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9967 head_norm=1.402243
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.639591e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9967 head_norm=1.325385 delta_norm=0.163959
[S9] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9963 head_norm=1.300944
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.492053e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9963 head_norm=1.268539 delta_norm=0.149205
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.707255 cos_to_last_merge=0.7967 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.797
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.8340771544100023, 'auprc': 0.8349310004704232, 'loss_val': 0.303896770970736, 'psi': 0.8344186928341707}-{'f1_val': 0.8301222780813782, 'auprc': 0.8957078183076017, 'loss_val': 0.3755426383558233, 'psi': 0.8563564941718675}
[S3] START round=28 head_norm_before_train=2.174334 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9972247337193878, 'loss_val': 0.11806579749366274, 'psi': 0.9755590478284466}-{'f1_val': 0.9612927942165166, 'auprc': 0.9972158700287753, 'loss_val': 0.09770301095030086, 'psi': 0.97566202454142}
[S4] START round=28 head_norm_before_train=1.213836 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9446660962405844, 'auprc': 0.9593558855342028, 'loss_val': 0.367894091644655, 'psi': 0.9505420119580317}-{'f1_val': 0.9450893759325766, 'auprc': 0.961675493069623, 'loss_val': 0.34342797327657915, 'psi': 0.9517238227873952}
[S5] START round=28 head_norm_before_train=0.957505 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.105029 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9892335032880188, 'loss_val': 0.3489670314753623, 'psi': 0.8159379342471358}-{'f1_val': 0.6938793792718873, 'auprc': 0.95470639113752, 'loss_val': 0.41627419316292674, 'psi': 0.7982101840181404}
[S6] START round=28 head_norm_before_train=1.208873 cos_to_last_merge=0.9990 (last merge round=26)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.7942849976465719, 'auprc': 0.7987004567448994, 'loss_val': 0.4916033812821001, 'psi': 0.7960511812859029}-{'f1_val': 0.939469630269705, 'auprc': 0.9605256038263931, 'loss_val': 0.4027070191193884, 'psi': 0.9478920196923802}
[S7] START round=28 head_norm_before_train=1.719210 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.5618219175253436, 'auprc': 0.7840277023083775, 'loss_val': 0.8583620894946548, 'psi': 0.6507042314385572}-{'f1_val': 0.5783286370098544, 'auprc': 0.7857196571893016, 'loss_val': 0.7691871334657814, 'psi': 0.6612850450816332}
[S8] START round=28 head_norm_before_train=1.895343 (no previous merge yet)
[S8] round=28 local utility u=0.001638 metrics={'f1_val': 0.992087149933871, 'auprc': 0.9988611554521688, 'loss_val': 0.039085701579549104, 'psi': 0.9947967521411902}-{'f1_val': 0.993467150337892, 'auprc': 0.9951574674484098, 'loss_val': 0.03953119927682037, 'psi': 0.9941432771820992}
[S9] START round=28 head_norm_before_train=1.325385 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9931490168142493, 'loss_val': 0.07225324898875146, 'psi': 0.9950096635932663}-{'f1_val': 0.9966605118138915, 'auprc': 0.9954877058790342, 'loss_val': 0.059227120216366544, 'psi': 0.9961913894399486}
[S10] START round=28 head_norm_before_train=1.887370 (no previous merge yet)
[S10] round=28 local utility u=0.000067 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9959604406198469, 'loss_val': 0.0409594576364818, 'psi': 0.9957499683569506}-{'f1_val': 0.9956096535150197, 'auprc': 0.9964292448860741, 'loss_val': 0.04250017101202644, 'psi': 0.9959374900634415}
[S11] START round=28 head_norm_before_train=1.268539 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9977795780922701, 'loss_val': 0.14982742311009808, 'psi': 0.9970279501342872}-{'f1_val': 0.9962850284706224, 'auprc': 0.9977334312558844, 'loss_val': 0.1462223507000486, 'psi': 0.9968643895847272}
[S13] START round=28 head_norm_before_train=1.468455 cos_to_last_merge=0.8561 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.856
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5507134364280601, 'auprc': 0.6890487805298228, 'loss_val': 0.9136152190842587, 'psi': 0.6060475740687652}-{'f1_val': 0.5994169557856728, 'auprc': 0.678232304787356, 'loss_val': 0.713449839446171, 'psi': 0.6309430953863461}
[S14] START round=28 head_norm_before_train=1.846316 cos_to_last_merge=0.8173 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.817
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.9926616926012184, 'loss_val': 0.03776362528713052, 'psi': 0.995308357742231}-{'f1_val': 0.9970728011695729, 'auprc': 0.9948233426933917, 'loss_val': 0.03733991856066046, 'psi': 0.9961730177791004}
[S15] START round=28 head_norm_before_train=1.682053 cos_to_last_merge=0.8114 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.811
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.701389660954442, 'auprc': 0.9470204907855423, 'loss_val': 0.44438415674535336, 'psi': 0.7996419928868821}-{'f1_val': 0.9869817378693825, 'auprc': 0.9808762999524776, 'loss_val': 0.09694008494336621, 'psi': 0.9845395627026206}
[S16] START round=28 head_norm_before_train=1.263119 cos_to_last_merge=0.9767 (last merge round=23)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8328846150991406, 'auprc': 0.9654360813329446, 'loss_val': 0.8403115482416045, 'psi': 0.8859052015926622}-{'f1_val': 0.8947199170136475, 'auprc': 0.994050508903445, 'loss_val': 0.43269910557715463, 'psi': 0.9344521537695666}
[S17] START round=28 head_norm_before_train=1.550688 cos_to_last_merge=0.7678 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.768
[S17] round=28 local utility u=0.437105 metrics={'f1_val': 0.6194372103080024, 'auprc': 0.9661015391377565, 'loss_val': 0.5953980905993663, 'psi': 0.758102941839904}-{'f1_val': 0.5911708302546959, 'auprc': 0.7827150557767381, 'loss_val': 0.7498502883841855, 'psi': 0.6677885204635128}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.901494)
[S5] loaded HEAD from S10 (vec_in norm=1.901494)
[S5] cosine check vs S10: cos=0.6362
[S5] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.909731)
[S7] loaded HEAD from S8 (vec_in norm=1.909731)
[S7] cosine check vs S8: cos=-0.0042
[S7] DROPPED delta from S8 (cos=-0.0042 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.992366)
[S16] loaded HEAD from S5 (vec_in norm=0.992366)
[S16] cosine check vs S5: cos=0.8351
[S16] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.582352)
[S9] loaded HEAD from S17 (vec_in norm=1.582352)
[S9] cosine check vs S17: cos=0.8847
[S9] BUFFERED delta from S17 (total buffered=1)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.9963 head_norm=1.370993
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.690937e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.9967 head_norm=1.433702 delta_norm=0.369094
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.7004 head_norm=0.992366
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.415345e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.9341 head_norm=1.323012 delta_norm=0.741534
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.8329 head_norm=1.308175
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.632825e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.8315 head_norm=1.102761 delta_norm=0.363282
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.723693 cos_to_last_merge=0.7951 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.795
[S2] round=29 local utility u=0.101887 metrics={'f1_val': 0.8322702885586017, 'auprc': 0.9211377355892147, 'loss_val': 0.3479013297167214, 'psi': 0.8678172673708469}-{'f1_val': 0.8340771544100023, 'auprc': 0.8349310004704232, 'loss_val': 0.303896770970736, 'psi': 0.8344186928341707}
[S3] START round=29 head_norm_before_train=2.182806 (no previous merge yet)
[S3] round=29 local utility u=0.157790 metrics={'f1_val': 0.9973956967430226, 'auprc': 0.997375794630188, 'loss_val': 0.020622387220764597, 'psi': 0.9973877358978888}-{'f1_val': 0.9611152572344858, 'auprc': 0.9972247337193878, 'loss_val': 0.11806579749366274, 'psi': 0.9755590478284466}
[S4] START round=29 head_norm_before_train=1.245430 cos_to_last_merge=0.9988 (last merge round=27)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9389466129465517, 'auprc': 0.9345523559909457, 'loss_val': 0.3572790421960923, 'psi': 0.9371889101643093}-{'f1_val': 0.9446660962405844, 'auprc': 0.9593558855342028, 'loss_val': 0.367894091644655, 'psi': 0.9505420119580317}
[S5] START round=29 head_norm_before_train=1.323012 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7001587899531788, 'auprc': 0.9269449707137333, 'loss_val': 0.5094119156948097, 'psi': 0.7908732622574006}-{'f1_val': 0.700407554886547, 'auprc': 0.9892335032880188, 'loss_val': 0.3489670314753623, 'psi': 0.8159379342471358}
[S6] START round=29 head_norm_before_train=1.231516 cos_to_last_merge=0.9970 (last merge round=26)
[S6] round=29 local utility u=0.726531 metrics={'f1_val': 0.9327451414728213, 'auprc': 0.961850526260672, 'loss_val': 0.3587527586207859, 'psi': 0.9443872953879615}-{'f1_val': 0.7942849976465719, 'auprc': 0.7987004567448994, 'loss_val': 0.4916033812821001, 'psi': 0.7960511812859029}
[S7] START round=29 head_norm_before_train=1.728257 (no previous merge yet)
[S7] round=29 local utility u=0.306865 metrics={'f1_val': 0.6149987855249441, 'auprc': 0.7954945694146662, 'loss_val': 0.5980933303660171, 'psi': 0.6871970990808329}-{'f1_val': 0.5618219175253436, 'auprc': 0.7840277023083775, 'loss_val': 0.8583620894946548, 'psi': 0.6507042314385572}
[S8] START round=29 head_norm_before_train=1.909731 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9935252750776847, 'auprc': 0.9862968806801772, 'loss_val': 0.04974469542037064, 'psi': 0.9906339173186817}-{'f1_val': 0.992087149933871, 'auprc': 0.9988611554521688, 'loss_val': 0.039085701579549104, 'psi': 0.9947967521411902}
[S9] START round=29 head_norm_before_train=1.433702 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9901297741397954, 'auprc': 0.999508443663107, 'loss_val': 0.06607899834022378, 'psi': 0.9938812419491201}-{'f1_val': 0.9962500947792776, 'auprc': 0.9931490168142493, 'loss_val': 0.07225324898875146, 'psi': 0.9950096635932663}
[S10] START round=29 head_norm_before_train=1.901494 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9950598176645743, 'loss_val': 0.041553776938938455, 'psi': 0.995253737390849}-{'f1_val': 0.9956096535150197, 'auprc': 0.9959604406198469, 'loss_val': 0.0409594576364818, 'psi': 0.9957499683569506}
[S11] START round=29 head_norm_before_train=1.312966 cos_to_last_merge=0.9989 (last merge round=27)
[S11] round=29 local utility u=0.011088 metrics={'f1_val': 0.9958728184308341, 'auprc': 0.9976796303079482, 'loss_val': 0.1234276632511396, 'psi': 0.9965955431816798}-{'f1_val': 0.9965268648289654, 'auprc': 0.9977795780922701, 'loss_val': 0.14982742311009808, 'psi': 0.9970279501342872}
[S13] START round=29 head_norm_before_train=1.473897 cos_to_last_merge=0.8563 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.856
[S13] round=29 local utility u=0.088775 metrics={'f1_val': 0.5680534014381948, 'auprc': 0.6864687245622568, 'loss_val': 0.8323653721727631, 'psi': 0.6154195306878196}-{'f1_val': 0.5507134364280601, 'auprc': 0.6890487805298228, 'loss_val': 0.9136152190842587, 'psi': 0.6060475740687652}
[S14] START round=29 head_norm_before_train=1.860778 cos_to_last_merge=0.8158 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.816
[S14] round=29 local utility u=0.008651 metrics={'f1_val': 0.9968226520993302, 'auprc': 0.9970821459467059, 'loss_val': 0.03222121795137074, 'psi': 0.9969264496382804}-{'f1_val': 0.9970728011695729, 'auprc': 0.9926616926012184, 'loss_val': 0.03776362528713052, 'psi': 0.995308357742231}
[S15] START round=29 head_norm_before_train=1.702083 cos_to_last_merge=0.8097 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.810
[S15] round=29 local utility u=0.397259 metrics={'f1_val': 0.8061882459474831, 'auprc': 0.9552975925134543, 'loss_val': 0.303489565842856, 'psi': 0.8658319845738716}-{'f1_val': 0.701389660954442, 'auprc': 0.9470204907855423, 'loss_val': 0.44438415674535336, 'psi': 0.7996419928868821}
[S16] START round=29 head_norm_before_train=1.102761 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.646728 metrics={'f1_val': 0.9337553820070152, 'auprc': 0.9919510523777095, 'loss_val': 0.23162592795682696, 'psi': 0.957033650155293}-{'f1_val': 0.8328846150991406, 'auprc': 0.9654360813329446, 'loss_val': 0.8403115482416045, 'psi': 0.8859052015926622}
[S17] START round=29 head_norm_before_train=1.582352 cos_to_last_merge=0.7667 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.767
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.616962641984865, 'auprc': 0.8406197897171372, 'loss_val': 0.703024517897816, 'psi': 0.7064255010777739}-{'f1_val': 0.6194372103080024, 'auprc': 0.9661015391377565, 'loss_val': 0.5953980905993663, 'psi': 0.758102941839904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:38504
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S11] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.188723)
[S5] loaded HEAD from S3 (vec_in norm=2.188723)
[S5] cosine check vs S3: cos=0.1729
[S5] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.742928)
[S5] loaded HEAD from S2 (vec_in norm=1.742928)
[S5] cosine check vs S2: cos=0.0771
[S5] BUFFERED delta from S2 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.734853)
[S14] loaded HEAD from S7 (vec_in norm=1.734853)
[S14] cosine check vs S7: cos=-0.0210
[S14] DROPPED delta from S7 (cos=-0.0210 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.717885)
[S5] loaded HEAD from S15 (vec_in norm=1.717885)
[S5] cosine check vs S15: cos=0.1921
[S5] BUFFERED delta from S15 (total buffered=3)
[S5] RECEIVED delta(kind=head bytes=1798) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.875098)
[S5] loaded HEAD from S14 (vec_in norm=1.875098)
[S5] cosine check vs S14: cos=0.1839
[S5] BUFFERED delta from S14 (total buffered=4)
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.354299)
[S9] loaded HEAD from S11 (vec_in norm=1.354299)
[S9] cosine check vs S11: cos=-0.1233
[S9] DROPPED delta from S11 (cos=-0.1233 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1804) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.479380)
[S9] loaded HEAD from S13 (vec_in norm=1.479380)
[S9] cosine check vs S13: cos=0.5943
[S9] BUFFERED delta from S13 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.141921)
[S6] loaded HEAD from S16 (vec_in norm=1.141921)
[S6] cosine check vs S16: cos=0.9601
[S6] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.251719)
[S4] loaded HEAD from S6 (vec_in norm=1.251719)
[S4] cosine check vs S6: cos=0.9734
[S4] BUFFERED delta from S6 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.7002 head_norm=1.340703
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.130837e-01
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.6906 head_norm=0.945016 delta_norm=0.713084
[S5] aggregate: ROLLBACK (f1_val pre=0.700 post=0.691 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=29 metric=0.9901 head_norm=1.475807
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.655279e-01
[S9] stored merged vector for next round verification (round=29)
[S9] DEBUG after merge:  round=29 metric=0.9906 head_norm=1.319227 delta_norm=0.665528
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9389 head_norm=1.278183
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.465737e-01
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9388 head_norm=1.256500 delta_norm=0.146574
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.9327 head_norm=1.251719
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.775239e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.9333 head_norm=1.184853 delta_norm=0.177524
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.742928 cos_to_last_merge=0.7934 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.793
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.8320781520098349, 'auprc': 0.914255602114511, 'loss_val': 0.3765533328288061, 'psi': 0.8649491320517053}-{'f1_val': 0.8322702885586017, 'auprc': 0.9211377355892147, 'loss_val': 0.3479013297167214, 'psi': 0.8678172673708469}
[S3] START round=30 head_norm_before_train=2.188723 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.8964094489964101, 'auprc': 0.9972744266301569, 'loss_val': 0.1522348475112276, 'psi': 0.9367554400499088}-{'f1_val': 0.9973956967430226, 'auprc': 0.997375794630188, 'loss_val': 0.020622387220764597, 'psi': 0.9973877358978888}
[S4] START round=30 head_norm_before_train=1.256500 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.012860 metrics={'f1_val': 0.9406601640538944, 'auprc': 0.9409285000427797, 'loss_val': 0.36096848306924423, 'psi': 0.9407674984494485}-{'f1_val': 0.9389466129465517, 'auprc': 0.9345523559909457, 'loss_val': 0.3572790421960923, 'psi': 0.9371889101643093}
[S5] START round=30 head_norm_before_train=0.945016 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.7002451011760882, 'auprc': 0.8550047502661, 'loss_val': 0.4446722694032393, 'psi': 0.7621489608120929}-{'f1_val': 0.7001587899531788, 'auprc': 0.9269449707137333, 'loss_val': 0.5094119156948097, 'psi': 0.7908732622574006}
[S6] START round=30 head_norm_before_train=1.184853 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.8218219187260031, 'auprc': 0.8019657303631555, 'loss_val': 0.48621475977797907, 'psi': 0.813879443380864}-{'f1_val': 0.9327451414728213, 'auprc': 0.961850526260672, 'loss_val': 0.3587527586207859, 'psi': 0.9443872953879615}
[S7] START round=30 head_norm_before_train=1.734853 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5823421047027615, 'auprc': 0.7837010307931622, 'loss_val': 0.8100129241730479, 'psi': 0.6628856751389218}-{'f1_val': 0.6149987855249441, 'auprc': 0.7954945694146662, 'loss_val': 0.5980933303660171, 'psi': 0.6871970990808329}
[S8] START round=30 head_norm_before_train=1.920779 (no previous merge yet)
[S8] round=30 local utility u=0.020657 metrics={'f1_val': 0.9922300956824643, 'auprc': 0.9988559864162381, 'loss_val': 0.03833677594577688, 'psi': 0.9948804519759737}-{'f1_val': 0.9935252750776847, 'auprc': 0.9862968806801772, 'loss_val': 0.04974469542037064, 'psi': 0.9906339173186817}
[S9] START round=30 head_norm_before_train=1.319227 cos_to_last_merge=1.0000 (last merge round=29)
[S9] round=30 local utility u=0.002153 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.997954069237062, 'loss_val': 0.09380807035094074, 'psi': 0.9969292966743563}-{'f1_val': 0.9901297741397954, 'auprc': 0.999508443663107, 'loss_val': 0.06607899834022378, 'psi': 0.9938812419491201}
[S10] START round=30 head_norm_before_train=1.916782 (no previous merge yet)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9919609183195204, 'loss_val': 0.038758632313334374, 'psi': 0.9936477893374115}-{'f1_val': 0.9953830172083656, 'auprc': 0.9950598176645743, 'loss_val': 0.041553776938938455, 'psi': 0.995253737390849}
[S11] START round=30 head_norm_before_train=1.354299 cos_to_last_merge=0.9965 (last merge round=27)
[S11] round=30 local utility u=0.011295 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9975982449758998, 'loss_val': 0.1045172812628224, 'psi': 0.996955416887739}-{'f1_val': 0.9958728184308341, 'auprc': 0.9976796303079482, 'loss_val': 0.1234276632511396, 'psi': 0.9965955431816798}
[S13] START round=30 head_norm_before_train=1.479380 cos_to_last_merge=0.8548 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.855
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5321060126281338, 'auprc': 0.694088910268839, 'loss_val': 0.9930800361134069, 'psi': 0.5968991716844159}-{'f1_val': 0.5680534014381948, 'auprc': 0.6864687245622568, 'loss_val': 0.8323653721727631, 'psi': 0.6154195306878196}
[S14] START round=30 head_norm_before_train=1.875098 cos_to_last_merge=0.8144 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.814
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9959874237039671, 'auprc': 0.9956514889969976, 'loss_val': 0.0372431236779528, 'psi': 0.9958530498211793}-{'f1_val': 0.9968226520993302, 'auprc': 0.9970821459467059, 'loss_val': 0.03222121795137074, 'psi': 0.9969264496382804}
[S15] START round=30 head_norm_before_train=1.717885 cos_to_last_merge=0.8084 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.808
[S15] round=30 local utility u=0.666669 metrics={'f1_val': 0.9856393783531143, 'auprc': 0.9721087181961543, 'loss_val': 0.09729165797567249, 'psi': 0.9802271142903303}-{'f1_val': 0.8061882459474831, 'auprc': 0.9552975925134543, 'loss_val': 0.303489565842856, 'psi': 0.8658319845738716}
[S16] START round=30 head_norm_before_train=1.141921 cos_to_last_merge=0.9995 (last merge round=28)
[S16] round=30 local utility u=0.199111 metrics={'f1_val': 0.987469733543175, 'auprc': 0.9923514843032812, 'loss_val': 0.15689105715607848, 'psi': 0.9894224338472175}-{'f1_val': 0.9337553820070152, 'auprc': 0.9919510523777095, 'loss_val': 0.23162592795682696, 'psi': 0.957033650155293}
[S17] START round=30 head_norm_before_train=1.610429 cos_to_last_merge=0.7662 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.766
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.5816428522355335, 'auprc': 0.7929765739918847, 'loss_val': 0.8757957557044332, 'psi': 0.666176340938074}-{'f1_val': 0.616962641984865, 'auprc': 0.8406197897171372, 'loss_val': 0.703024517897816, 'psi': 0.7064255010777739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:38514
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:38507
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38508
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.355582)
[S14] loaded HEAD from S9 (vec_in norm=1.355582)
[S14] cosine check vs S9: cos=-0.0583
[S14] DROPPED delta from S9 (cos=-0.0583 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.388119)
[S9] loaded HEAD from S11 (vec_in norm=1.388119)
[S9] cosine check vs S11: cos=-0.0665
[S9] DROPPED delta from S11 (cos=-0.0665 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.933956)
[S7] loaded HEAD from S8 (vec_in norm=1.933956)
[S7] cosine check vs S8: cos=-0.0061
[S7] DROPPED delta from S8 (cos=-0.0061 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.289691)
[S11] loaded HEAD from S4 (vec_in norm=1.289691)
[S11] cosine check vs S4: cos=0.9493
[S11] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.187553)
[S6] loaded HEAD from S16 (vec_in norm=1.187553)
[S6] cosine check vs S16: cos=0.9882
[S6] BUFFERED delta from S16 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.731209)
[S5] loaded HEAD from S15 (vec_in norm=1.731209)
[S5] cosine check vs S15: cos=0.4045
[S5] BUFFERED delta from S15 (total buffered=1)
[S3] ⇄ pheromone p=0.084 → S5@127.0.0.1:38505
[S13] ⇄ pheromone p=0.072 → S9@127.0.0.1:38510
[S7] ⇄ pheromone p=0.132 → S14@127.0.0.1:38514
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.7002 head_norm=0.968969
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.029686e-01
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.7002 head_norm=1.150319 delta_norm=0.802969
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.046 → S16@127.0.0.1:38516
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.8218 head_norm=1.201805
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.199391e-02
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.8218 head_norm=1.191153 delta_norm=0.091994
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.275 → S4@127.0.0.1:38504
[S10] ⇄ pheromone p=0.013 → S5@127.0.0.1:38505
[S2] ⇄ pheromone p=0.057 → S5@127.0.0.1:38505
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=30 metric=0.9965 head_norm=1.388119
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.186825e-01
[S11] stored merged vector for next round verification (round=30)
[S11] DEBUG after merge:  round=30 metric=0.9961 head_norm=1.321842 delta_norm=0.218683
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.043 → S9@127.0.0.1:38510
[S8] ⇄ pheromone p=0.081 → S7@127.0.0.1:38508
[S4] ⇄ pheromone p=0.047 → S11@127.0.0.1:38512
[S9] ⇄ pheromone p=0.009 → S14@127.0.0.1:38514
[S14] ⇄ pheromone p=0.010 → S5@127.0.0.1:38505
[S17] ⇄ pheromone p=0.184 → S9@127.0.0.1:38510
[S15] ⇄ pheromone p=0.340 → S5@127.0.0.1:38505
[S16] ⇄ pheromone p=0.243 → S6@127.0.0.1:38507
[S2] START round=31 head_norm_before_train=1.762969 cos_to_last_merge=0.7916 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.792
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.8311778472864755, 'auprc': 0.8125187804946792, 'loss_val': 0.3583900147132147, 'psi': 0.823714220569757}-{'f1_val': 0.8320781520098349, 'auprc': 0.914255602114511, 'loss_val': 0.3765533328288061, 'psi': 0.8649491320517053}
[S3] START round=31 head_norm_before_train=2.193452 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.8642756363225915, 'auprc': 0.9970920516391114, 'loss_val': 0.2516436394094779, 'psi': 0.9174022024491995}-{'f1_val': 0.8964094489964101, 'auprc': 0.9972744266301569, 'loss_val': 0.1522348475112276, 'psi': 0.9367554400499088}
[S4] START round=31 head_norm_before_train=1.289691 cos_to_last_merge=0.9989 (last merge round=29)
[S4] round=31 local utility u=0.026258 metrics={'f1_val': 0.9529498490425301, 'auprc': 0.9215743673852098, 'loss_val': 0.32412800470216846, 'psi': 0.940399656379602}-{'f1_val': 0.9406601640538944, 'auprc': 0.9409285000427797, 'loss_val': 0.36096848306924423, 'psi': 0.9407674984494485}
[S5] START round=31 head_norm_before_train=1.150319 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.185762 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9739273562242614, 'loss_val': 0.4308860989999888, 'psi': 0.8098150883182655}-{'f1_val': 0.7002451011760882, 'auprc': 0.8550047502661, 'loss_val': 0.4446722694032393, 'psi': 0.7621489608120929}
[S6] START round=31 head_norm_before_train=1.191153 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.8047112206868159, 'auprc': 0.8018857805674694, 'loss_val': 0.4895022029671773, 'psi': 0.8035810446390773}-{'f1_val': 0.8218219187260031, 'auprc': 0.8019657303631555, 'loss_val': 0.48621475977797907, 'psi': 0.813879443380864}
[S7] START round=31 head_norm_before_train=1.745044 (no previous merge yet)
[S7] round=31 local utility u=0.417282 metrics={'f1_val': 0.6446240258893282, 'auprc': 0.8066198903569078, 'loss_val': 0.41789635536425296, 'psi': 0.7094223716763601}-{'f1_val': 0.5823421047027615, 'auprc': 0.7837010307931622, 'loss_val': 0.8100129241730479, 'psi': 0.6628856751389218}
[S8] START round=31 head_norm_before_train=1.933956 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9929848166558567, 'auprc': 0.9877446101843101, 'loss_val': 0.038007645479644185, 'psi': 0.9908887340672381}-{'f1_val': 0.9922300956824643, 'auprc': 0.9988559864162381, 'loss_val': 0.03833677594577688, 'psi': 0.9948804519759737}
[S9] START round=31 head_norm_before_train=1.355582 cos_to_last_merge=0.9993 (last merge round=29)
[S9] round=31 local utility u=0.008308 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9947331598345666, 'loss_val': 0.0700158559670286, 'psi': 0.9958895710221615}-{'f1_val': 0.9962461149658858, 'auprc': 0.997954069237062, 'loss_val': 0.09380807035094074, 'psi': 0.9969292966743563}
[S10] START round=31 head_norm_before_train=1.930982 (no previous merge yet)
[S10] round=31 local utility u=0.005291 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.995043559980163, 'loss_val': 0.038599369376848026, 'psi': 0.994998335911111}-{'f1_val': 0.9947723700160056, 'auprc': 0.9919609183195204, 'loss_val': 0.038758632313334374, 'psi': 0.9936477893374115}
[S11] START round=31 head_norm_before_train=1.321842 cos_to_last_merge=1.0000 (last merge round=30)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9974987837289648, 'loss_val': 0.12895625257392207, 'psi': 0.9967705305739594}-{'f1_val': 0.9965268648289654, 'auprc': 0.9975982449758998, 'loss_val': 0.1045172812628224, 'psi': 0.996955416887739}
[S13] START round=31 head_norm_before_train=1.487791 cos_to_last_merge=0.8531 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.853
[S13] round=31 local utility u=0.105014 metrics={'f1_val': 0.5594134452762646, 'auprc': 0.6894780987857377, 'loss_val': 0.9330642436626484, 'psi': 0.6114393066800539}-{'f1_val': 0.5321060126281338, 'auprc': 0.694088910268839, 'loss_val': 0.9930800361134069, 'psi': 0.5968991716844159}
[S14] START round=31 head_norm_before_train=1.885844 cos_to_last_merge=0.8136 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.814
[S14] round=31 local utility u=0.008214 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9966543523943173, 'loss_val': 0.0313419567785493, 'psi': 0.9970059549812027}-{'f1_val': 0.9959874237039671, 'auprc': 0.9956514889969976, 'loss_val': 0.0372431236779528, 'psi': 0.9958530498211793}
[S15] START round=31 head_norm_before_train=1.731209 cos_to_last_merge=0.8068 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.807
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7705817792814156, 'auprc': 0.9563910021640314, 'loss_val': 0.3567728878781982, 'psi': 0.8449054684344619}-{'f1_val': 0.9856393783531143, 'auprc': 0.9721087181961543, 'loss_val': 0.09729165797567249, 'psi': 0.9802271142903303}
[S16] START round=31 head_norm_before_train=1.187553 cos_to_last_merge=0.9978 (last merge round=28)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9702964325049989, 'auprc': 0.9917721096884412, 'loss_val': 0.15053023046940855, 'psi': 0.9788867033783758}-{'f1_val': 0.987469733543175, 'auprc': 0.9923514843032812, 'loss_val': 0.15689105715607848, 'psi': 0.9894224338472175}
[S17] START round=31 head_norm_before_train=1.638706 cos_to_last_merge=0.7658 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.766
[S17] round=31 local utility u=0.519193 metrics={'f1_val': 0.6266086252319948, 'auprc': 0.9807684804384333, 'loss_val': 0.6705808925093999, 'psi': 0.7682725673145703}-{'f1_val': 0.5816428522355335, 'auprc': 0.7929765739918847, 'loss_val': 0.8757957557044332, 'psi': 0.666176340938074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S11@127.0.0.1:38512
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:38516
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1807 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1807) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.329485)
[S11] loaded HEAD from S4 (vec_in norm=1.329485)
[S11] cosine check vs S4: cos=0.9846
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S14
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.898104)
[S5] loaded HEAD from S14 (vec_in norm=1.898104)
[S5] cosine check vs S14: cos=0.2561
[S5] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.945523)
[S5] loaded HEAD from S10 (vec_in norm=1.945523)
[S5] cosine check vs S10: cos=0.2566
[S5] BUFFERED delta from S10 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1802) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.497072)
[S9] loaded HEAD from S13 (vec_in norm=1.497072)
[S9] cosine check vs S13: cos=0.8740
[S9] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.751651)
[S14] loaded HEAD from S7 (vec_in norm=1.751651)
[S14] cosine check vs S7: cos=-0.0217
[S14] DROPPED delta from S7 (cos=-0.0217 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.669381)
[S9] loaded HEAD from S17 (vec_in norm=1.669381)
[S9] cosine check vs S17: cos=0.7830
[S9] BUFFERED delta from S17 (total buffered=2)
[S5] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.403106)
[S14] loaded HEAD from S9 (vec_in norm=1.403106)
[S14] cosine check vs S9: cos=-0.0606
[S14] DROPPED delta from S9 (cos=-0.0606 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.179582)
[S16] loaded HEAD from S5 (vec_in norm=1.179582)
[S16] cosine check vs S5: cos=0.7277
[S16] BUFFERED delta from S5 (total buffered=1)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.7004 head_norm=1.179582
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.292606e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.7005 head_norm=1.055004 delta_norm=0.729261
[S5] aggregate: ACCEPT kept=['S14', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.9967 head_norm=1.403106
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.259046e-01
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.9967 head_norm=1.360441 delta_norm=0.125905
[S9] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.9703 head_norm=1.233252
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.458304e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.9658 head_norm=1.121338 delta_norm=0.445830
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.9963 head_norm=1.355758
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.186827e-01
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.9963 head_norm=1.337430 delta_norm=0.118683
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.781540 cos_to_last_merge=0.7899 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.790
[S2] round=32 local utility u=0.034809 metrics={'f1_val': 0.8377334497962321, 'auprc': 0.8147325541425782, 'loss_val': 0.33474629431600456, 'psi': 0.8285330915347705}-{'f1_val': 0.8311778472864755, 'auprc': 0.8125187804946792, 'loss_val': 0.3583900147132147, 'psi': 0.823714220569757}
[S3] START round=32 head_norm_before_train=2.207576 (no previous merge yet)
[S3] round=32 local utility u=0.471047 metrics={'f1_val': 0.9880003466241639, 'auprc': 0.9973027560386717, 'loss_val': 0.05252964641464809, 'psi': 0.9917213103899669}-{'f1_val': 0.8642756363225915, 'auprc': 0.9970920516391114, 'loss_val': 0.2516436394094779, 'psi': 0.9174022024491995}
[S4] START round=32 head_norm_before_train=1.329485 cos_to_last_merge=0.9954 (last merge round=29)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9392347764902301, 'auprc': 0.9240891397863542, 'loss_val': 0.32495462135623626, 'psi': 0.9331765218086798}-{'f1_val': 0.9529498490425301, 'auprc': 0.9215743673852098, 'loss_val': 0.32412800470216846, 'psi': 0.940399656379602}
[S5] START round=32 head_norm_before_train=1.055004 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.567660 metrics={'f1_val': 0.8724559108313696, 'auprc': 0.988895227045094, 'loss_val': 0.3727636399524299, 'psi': 0.9190316373168593}-{'f1_val': 0.7004069097142683, 'auprc': 0.9739273562242614, 'loss_val': 0.4308860989999888, 'psi': 0.8098150883182655}
[S6] START round=32 head_norm_before_train=1.213182 cos_to_last_merge=0.9995 (last merge round=30)
[S6] round=32 local utility u=0.724223 metrics={'f1_val': 0.9398326861377071, 'auprc': 0.9681953143662516, 'loss_val': 0.35071447625674834, 'psi': 0.9511777374291249}-{'f1_val': 0.8047112206868159, 'auprc': 0.8018857805674694, 'loss_val': 0.4895022029671773, 'psi': 0.8035810446390773}
[S7] START round=32 head_norm_before_train=1.751651 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.624900632460925, 'auprc': 0.8025029288613326, 'loss_val': 0.4962096085487175, 'psi': 0.695941551021088}-{'f1_val': 0.6446240258893282, 'auprc': 0.8066198903569078, 'loss_val': 0.41789635536425296, 'psi': 0.7094223716763601}
[S8] START round=32 head_norm_before_train=1.943610 (no previous merge yet)
[S8] round=32 local utility u=0.001952 metrics={'f1_val': 0.9929848166558567, 'auprc': 0.9889845588827172, 'loss_val': 0.03782337607333763, 'psi': 0.991384713546601}-{'f1_val': 0.9929848166558567, 'auprc': 0.9877446101843101, 'loss_val': 0.038007645479644185, 'psi': 0.9908887340672381}
[S9] START round=32 head_norm_before_train=1.360441 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.006450 metrics={'f1_val': 0.9958312226609984, 'auprc': 0.9979435619109979, 'loss_val': 0.061772046397045234, 'psi': 0.9966761583609982}-{'f1_val': 0.9966605118138915, 'auprc': 0.9947331598345666, 'loss_val': 0.0700158559670286, 'psi': 0.9958895710221615}
[S10] START round=32 head_norm_before_train=1.945523 (no previous merge yet)
[S10] round=32 local utility u=0.003020 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954233561072636, 'loss_val': 0.03501613132112043, 'psi': 0.9952820458545303}-{'f1_val': 0.9949681865317428, 'auprc': 0.995043559980163, 'loss_val': 0.038599369376848026, 'psi': 0.994998335911111}
[S11] START round=32 head_norm_before_train=1.337430 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9973322609505866, 'loss_val': 0.13191281013247466, 'psi': 0.9967039214626081}-{'f1_val': 0.9962850284706224, 'auprc': 0.9974987837289648, 'loss_val': 0.12895625257392207, 'psi': 0.9967705305739594}
[S13] START round=32 head_norm_before_train=1.497072 cos_to_last_merge=0.8508 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.851
[S13] round=32 local utility u=0.161426 metrics={'f1_val': 0.5968949117336806, 'auprc': 0.6857900342043534, 'loss_val': 0.8240374692186522, 'psi': 0.6324529607219497}-{'f1_val': 0.5594134452762646, 'auprc': 0.6894780987857377, 'loss_val': 0.9330642436626484, 'psi': 0.6114393066800539}
[S14] START round=32 head_norm_before_train=1.898104 cos_to_last_merge=0.8126 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.813
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9925454825350106, 'loss_val': 0.032874054267165824, 'psi': 0.9951162411093311}-{'f1_val': 0.997240356705793, 'auprc': 0.9966543523943173, 'loss_val': 0.0313419567785493, 'psi': 0.9970059549812027}
[S15] START round=32 head_norm_before_train=1.744185 cos_to_last_merge=0.8052 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.805
[S15] round=32 local utility u=0.688912 metrics={'f1_val': 0.9473383459782005, 'auprc': 0.9792307772777606, 'loss_val': 0.10800761362224745, 'psi': 0.9600953184980245}-{'f1_val': 0.7705817792814156, 'auprc': 0.9563910021640314, 'loss_val': 0.3567728878781982, 'psi': 0.8449054684344619}
[S16] START round=32 head_norm_before_train=1.121338 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9401525503695323, 'auprc': 0.9940811880066127, 'loss_val': 0.269800540789809, 'psi': 0.9617240054243644}-{'f1_val': 0.9702964325049989, 'auprc': 0.9917721096884412, 'loss_val': 0.15053023046940855, 'psi': 0.9788867033783758}
[S17] START round=32 head_norm_before_train=1.669381 cos_to_last_merge=0.7652 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=32 local utility u=0.026021 metrics={'f1_val': 0.636373963739641, 'auprc': 0.9749064559165666, 'loss_val': 0.6595446208944511, 'psi': 0.7717869606104112}-{'f1_val': 0.6266086252319948, 'auprc': 0.9807684804384333, 'loss_val': 0.6705808925093999, 'psi': 0.7682725673145703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38514
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38505
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[S9] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.795372)
[S5] loaded HEAD from S2 (vec_in norm=1.795372)
[S5] cosine check vs S2: cos=0.2473
[S5] BUFFERED delta from S2 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.502167)
[S9] loaded HEAD from S13 (vec_in norm=1.502167)
[S9] cosine check vs S13: cos=0.8386
[S9] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.954384)
[S5] loaded HEAD from S10 (vec_in norm=1.954384)
[S5] cosine check vs S10: cos=0.6117
[S5] BUFFERED delta from S10 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.080179)
[S16] loaded HEAD from S5 (vec_in norm=1.080179)
[S16] cosine check vs S5: cos=0.8996
[S16] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.952403)
[S7] loaded HEAD from S8 (vec_in norm=1.952403)
[S7] cosine check vs S8: cos=-0.0062
[S7] DROPPED delta from S8 (cos=-0.0062 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.757138)
[S5] loaded HEAD from S15 (vec_in norm=1.757138)
[S5] cosine check vs S15: cos=0.5095
[S5] BUFFERED delta from S15 (total buffered=3)
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.412950)
[S14] loaded HEAD from S9 (vec_in norm=1.412950)
[S14] cosine check vs S9: cos=-0.0599
[S14] DROPPED delta from S9 (cos=-0.0599 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.692334)
[S9] loaded HEAD from S17 (vec_in norm=1.692334)
[S9] cosine check vs S17: cos=0.8273
[S9] BUFFERED delta from S17 (total buffered=2)
[S3] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.223090)
[S5] loaded HEAD from S3 (vec_in norm=2.223090)
[S5] cosine check vs S3: cos=0.0956
[S5] BUFFERED delta from S3 (total buffered=4)
[S4] RECEIVED delta(kind=head bytes=1802) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.234432)
[S4] loaded HEAD from S6 (vec_in norm=1.234432)
[S4] cosine check vs S6: cos=0.9567
[S4] BUFFERED delta from S6 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9392 head_norm=1.364896
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.018881e-01
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9393 head_norm=1.285544 delta_norm=0.201888
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.8725 head_norm=1.080179
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.696564e-01
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.7004 head_norm=0.948439 delta_norm=0.369656
[S5] aggregate: ROLLBACK (f1_val pre=0.872 post=0.700 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=32 metric=0.9958 head_norm=1.412950
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.273448e-02
[S9] stored merged vector for next round verification (round=32)
[S9] DEBUG after merge:  round=32 metric=0.9958 head_norm=1.373897 delta_norm=0.092734
[S9] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9402 head_norm=1.166933
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.552629e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9399 head_norm=1.095034 delta_norm=0.255263
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.795372 cos_to_last_merge=0.7882 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.788
[S2] round=33 local utility u=0.106739 metrics={'f1_val': 0.8294010845227359, 'auprc': 0.9271836413613489, 'loss_val': 0.40862821279293515, 'psi': 0.868514107258181}-{'f1_val': 0.8377334497962321, 'auprc': 0.8147325541425782, 'loss_val': 0.33474629431600456, 'psi': 0.8285330915347705}
[S3] START round=33 head_norm_before_train=2.223090 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9973557873267185, 'loss_val': 0.13917981589284825, 'psi': 0.9754400803134256}-{'f1_val': 0.9880003466241639, 'auprc': 0.9973027560386717, 'loss_val': 0.05252964641464809, 'psi': 0.9917213103899669}
[S4] START round=33 head_norm_before_train=1.285544 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9351326336829643, 'auprc': 0.8707122933158026, 'loss_val': 0.3633240182182839, 'psi': 0.9093644975360996}-{'f1_val': 0.9392347764902301, 'auprc': 0.9240891397863542, 'loss_val': 0.32495462135623626, 'psi': 0.9331765218086798}
[S5] START round=33 head_norm_before_train=0.948439 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.43671700517611844, 'auprc': 0.8554989489839633, 'loss_val': 0.8765584510383901, 'psi': 0.6042297826992564}-{'f1_val': 0.8724559108313696, 'auprc': 0.988895227045094, 'loss_val': 0.3727636399524299, 'psi': 0.9190316373168593}
[S6] START round=33 head_norm_before_train=1.234432 cos_to_last_merge=0.9982 (last merge round=30)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.9310416638002295, 'auprc': 0.9647628431214452, 'loss_val': 0.34197234941476107, 'psi': 0.9445301355287158}-{'f1_val': 0.9398326861377071, 'auprc': 0.9681953143662516, 'loss_val': 0.35071447625674834, 'psi': 0.9511777374291249}
[S7] START round=33 head_norm_before_train=1.762813 (no previous merge yet)
[S7] round=33 local utility u=0.525733 metrics={'f1_val': 0.7004476721765679, 'auprc': 0.9119536911872157, 'loss_val': 0.22637802668613044, 'psi': 0.7850500797808271}-{'f1_val': 0.624900632460925, 'auprc': 0.8025029288613326, 'loss_val': 0.4962096085487175, 'psi': 0.695941551021088}
[S8] START round=33 head_norm_before_train=1.952403 (no previous merge yet)
[S8] round=33 local utility u=0.012170 metrics={'f1_val': 0.9920877483955324, 'auprc': 0.9987790300914636, 'loss_val': 0.03748424831065257, 'psi': 0.9947642610739049}-{'f1_val': 0.9929848166558567, 'auprc': 0.9889845588827172, 'loss_val': 0.03782337607333763, 'psi': 0.991384713546601}
[S9] START round=33 head_norm_before_train=1.373897 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9944606409105489, 'loss_val': 0.05992690117840216, 'psi': 0.9957805634525544}-{'f1_val': 0.9958312226609984, 'auprc': 0.9979435619109979, 'loss_val': 0.061772046397045234, 'psi': 0.9966761583609982}
[S10] START round=33 head_norm_before_train=1.954384 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9929807479547368, 'loss_val': 0.035158020755756116, 'psi': 0.9943050025935196}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954233561072636, 'loss_val': 0.03501613132112043, 'psi': 0.9952820458545303}
[S11] START round=33 head_norm_before_train=1.374748 cos_to_last_merge=0.9993 (last merge round=31)
[S11] round=33 local utility u=0.008434 metrics={'f1_val': 0.9953245089364587, 'auprc': 0.9973500991012414, 'loss_val': 0.10933549683778568, 'psi': 0.9961347450023719}-{'f1_val': 0.9962850284706224, 'auprc': 0.9973322609505866, 'loss_val': 0.13191281013247466, 'psi': 0.9967039214626081}
[S13] START round=33 head_norm_before_train=1.502167 cos_to_last_merge=0.8507 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.851
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5275544629743985, 'auprc': 0.6962250608834273, 'loss_val': 1.0956165944307592, 'psi': 0.59502270213801}-{'f1_val': 0.5968949117336806, 'auprc': 0.6857900342043534, 'loss_val': 0.8240374692186522, 'psi': 0.6324529607219497}
[S14] START round=33 head_norm_before_train=1.911453 cos_to_last_merge=0.8114 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.811
[S14] round=33 local utility u=0.007480 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9952691665602093, 'loss_val': 0.03000334032302762, 'psi': 0.9965975132539763}-{'f1_val': 0.9968300801588782, 'auprc': 0.9925454825350106, 'loss_val': 0.032874054267165824, 'psi': 0.9951162411093311}
[S15] START round=33 head_norm_before_train=1.757138 cos_to_last_merge=0.8041 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.804
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.8085350577946582, 'auprc': 0.9653098500235295, 'loss_val': 0.31835503764246603, 'psi': 0.8712449746862068}-{'f1_val': 0.9473383459782005, 'auprc': 0.9792307772777606, 'loss_val': 0.10800761362224745, 'psi': 0.9600953184980245}
[S16] START round=33 head_norm_before_train=1.095034 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.188702 metrics={'f1_val': 0.9879571663258052, 'auprc': 0.9943083265955046, 'loss_val': 0.1799063162641559, 'psi': 0.990497630433685}-{'f1_val': 0.9401525503695323, 'auprc': 0.9940811880066127, 'loss_val': 0.269800540789809, 'psi': 0.9617240054243644}
[S17] START round=33 head_norm_before_train=1.692334 cos_to_last_merge=0.7648 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.5853333158081343, 'auprc': 0.8522655176194991, 'loss_val': 0.8993996140260855, 'psi': 0.6921061965326802}-{'f1_val': 0.636373963739641, 'auprc': 0.9749064559165666, 'loss_val': 0.6595446208944511, 'psi': 0.7717869606104112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:38504
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:38509
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38508
[S7] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.149924)
[S5] loaded HEAD from S16 (vec_in norm=1.149924)
[S5] cosine check vs S16: cos=0.9662
[S5] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.770992)
[S8] loaded HEAD from S7 (vec_in norm=1.770992)
[S8] cosine check vs S7: cos=-0.0055
[S8] DROPPED delta from S7 (cos=-0.0055 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1807) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.413030)
[S4] loaded HEAD from S11 (vec_in norm=1.413030)
[S4] cosine check vs S11: cos=0.9807
[S4] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.921617)
[S7] loaded HEAD from S14 (vec_in norm=1.921617)
[S7] cosine check vs S14: cos=-0.0216
[S7] DROPPED delta from S14 (cos=-0.0216 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.4367 head_norm=0.979665
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.621038e-01
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.4363 head_norm=1.055821 delta_norm=0.162104
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=33 metric=0.9351 head_norm=1.322628
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.417622e-01
[S4] stored merged vector for next round verification (round=33)
[S4] DEBUG after merge:  round=33 metric=0.9351 head_norm=1.361214 delta_norm=0.141762
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.809174 cos_to_last_merge=0.7869 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.787
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.8305333893234529, 'auprc': 0.9130783956317798, 'loss_val': 0.42178614891299304, 'psi': 0.8635513918467836}-{'f1_val': 0.8294010845227359, 'auprc': 0.9271836413613489, 'loss_val': 0.40862821279293515, 'psi': 0.868514107258181}
[S3] START round=34 head_norm_before_train=2.236974 (no previous merge yet)
[S3] round=34 local utility u=0.113045 metrics={'f1_val': 0.9821721926833316, 'auprc': 0.9973697057690433, 'loss_val': 0.04118609034580925, 'psi': 0.9882511979176163}-{'f1_val': 0.9608296089712303, 'auprc': 0.9973557873267185, 'loss_val': 0.13917981589284825, 'psi': 0.9754400803134256}
[S4] START round=34 head_norm_before_train=1.361214 cos_to_last_merge=1.0000 (last merge round=33)
[S4] round=34 local utility u=0.205530 metrics={'f1_val': 0.9537445843059367, 'auprc': 0.9515697977446815, 'loss_val': 0.3065080195139148, 'psi': 0.9528746696814346}-{'f1_val': 0.9351326336829643, 'auprc': 0.8707122933158026, 'loss_val': 0.3633240182182839, 'psi': 0.9093644975360996}
[S5] START round=34 head_norm_before_train=1.055821 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.550349 metrics={'f1_val': 0.5803346641923356, 'auprc': 0.8556665777653842, 'loss_val': 0.6380701046826055, 'psi': 0.6904674296215552}-{'f1_val': 0.43671700517611844, 'auprc': 0.8554989489839633, 'loss_val': 0.8765584510383901, 'psi': 0.6042297826992564}
[S6] START round=34 head_norm_before_train=1.261751 cos_to_last_merge=0.9961 (last merge round=30)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.8957457474317712, 'auprc': 0.9610947474998245, 'loss_val': 0.3435319949716576, 'psi': 0.9218853474589925}-{'f1_val': 0.9310416638002295, 'auprc': 0.9647628431214452, 'loss_val': 0.34197234941476107, 'psi': 0.9445301355287158}
[S7] START round=34 head_norm_before_train=1.770992 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6386210887765404, 'auprc': 0.8002217957055422, 'loss_val': 0.5695856728926362, 'psi': 0.7032613715481412}-{'f1_val': 0.7004476721765679, 'auprc': 0.9119536911872157, 'loss_val': 0.22637802668613044, 'psi': 0.7850500797808271}
[S8] START round=34 head_norm_before_train=1.959312 (no previous merge yet)
[S8] round=34 local utility u=0.001550 metrics={'f1_val': 0.9924515537855688, 'auprc': 0.9987758782043458, 'loss_val': 0.036557074256983235, 'psi': 0.9949812835530796}-{'f1_val': 0.9920877483955324, 'auprc': 0.9987790300914636, 'loss_val': 0.03748424831065257, 'psi': 0.9947642610739049}
[S9] START round=34 head_norm_before_train=1.422910 cos_to_last_merge=0.9991 (last merge round=32)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9915213934655529, 'loss_val': 0.053094369629269944, 'psi': 0.9943586142537877}-{'f1_val': 0.9966605118138915, 'auprc': 0.9944606409105489, 'loss_val': 0.05992690117840216, 'psi': 0.9957805634525544}
[S10] START round=34 head_norm_before_train=1.963532 (no previous merge yet)
[S10] round=34 local utility u=0.001090 metrics={'f1_val': 0.9948336929542084, 'auprc': 0.9946138287076887, 'loss_val': 0.03575159731976723, 'psi': 0.9947457472556005}-{'f1_val': 0.9951878390193748, 'auprc': 0.9929807479547368, 'loss_val': 0.035158020755756116, 'psi': 0.9943050025935196}
[S11] START round=34 head_norm_before_train=1.413030 cos_to_last_merge=0.9976 (last merge round=31)
[S11] round=34 local utility u=0.012829 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9971679008120449, 'loss_val': 0.09034481563789894, 'psi': 0.9967832792221971}-{'f1_val': 0.9953245089364587, 'auprc': 0.9973500991012414, 'loss_val': 0.10933549683778568, 'psi': 0.9961347450023719}
[S13] START round=34 head_norm_before_train=1.509807 cos_to_last_merge=0.8518 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.852
[S13] round=34 local utility u=0.161163 metrics={'f1_val': 0.5549383665818876, 'auprc': 0.6895169098996877, 'loss_val': 0.9174696624719406, 'psi': 0.6087697839090076}-{'f1_val': 0.5275544629743985, 'auprc': 0.6962250608834273, 'loss_val': 1.0956165944307592, 'psi': 0.59502270213801}
[S14] START round=34 head_norm_before_train=1.921617 cos_to_last_merge=0.8103 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.810
[S14] round=34 local utility u=0.001751 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9961806914957784, 'loss_val': 0.027778773204925212, 'psi': 0.9968164906217871}-{'f1_val': 0.9974830777164877, 'auprc': 0.9952691665602093, 'loss_val': 0.03000334032302762, 'psi': 0.9965975132539763}
[S15] START round=34 head_norm_before_train=1.770097 cos_to_last_merge=0.8032 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.803
[S15] round=34 local utility u=0.672736 metrics={'f1_val': 0.9884964728348961, 'auprc': 0.9752955485160748, 'loss_val': 0.0826089311460189, 'psi': 0.9832161031073676}-{'f1_val': 0.8085350577946582, 'auprc': 0.9653098500235295, 'loss_val': 0.31835503764246603, 'psi': 0.8712449746862068}
[S16] START round=34 head_norm_before_train=1.149924 cos_to_last_merge=0.9983 (last merge round=32)
[S16] round=34 local utility u=0.026634 metrics={'f1_val': 0.9897244304195453, 'auprc': 0.992532098766243, 'loss_val': 0.13191253915650955, 'psi': 0.9908474977582243}-{'f1_val': 0.9879571663258052, 'auprc': 0.9943083265955046, 'loss_val': 0.1799063162641559, 'psi': 0.990497630433685}
[S17] START round=34 head_norm_before_train=1.709266 cos_to_last_merge=0.7645 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.5613053487180494, 'auprc': 0.7541334147321692, 'loss_val': 0.9749741743522855, 'psi': 0.6384365751236973}-{'f1_val': 0.5853333158081343, 'auprc': 0.8522655176194991, 'loss_val': 0.8993996140260855, 'psi': 0.6921061965326802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:38515
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.991)
[S11] not sending this round → trigger blocked (psi=0.997)
[S8] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.997)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.093105)
[S15] loaded HEAD from S5 (vec_in norm=1.093105)
[S15] cosine check vs S5: cos=0.5748
[S15] BUFFERED delta from S5 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.401807)
[S6] loaded HEAD from S4 (vec_in norm=1.401807)
[S6] cosine check vs S4: cos=0.9632
[S6] BUFFERED delta from S4 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.9885 head_norm=1.780199
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.291945e-01
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.9881 head_norm=1.284628 delta_norm=0.729195
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.8957 head_norm=1.295895
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.904153e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.9077 head_norm=1.336393 delta_norm=0.190415
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.819865 cos_to_last_merge=0.7859 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.786
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6954379827543696, 'auprc': 0.7672834241928526, 'loss_val': 0.882009672308872, 'psi': 0.7241761593297629}-{'f1_val': 0.8305333893234529, 'auprc': 0.9130783956317798, 'loss_val': 0.42178614891299304, 'psi': 0.8635513918467836}
[S3] START round=35 head_norm_before_train=2.252555 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9615785680382265, 'auprc': 0.9973554509466854, 'loss_val': 0.0835514778080062, 'psi': 0.97588932120161}-{'f1_val': 0.9821721926833316, 'auprc': 0.9973697057690433, 'loss_val': 0.04118609034580925, 'psi': 0.9882511979176163}
[S4] START round=35 head_norm_before_train=1.401807 cos_to_last_merge=0.9992 (last merge round=33)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9416364033208959, 'auprc': 0.9603544160514828, 'loss_val': 0.3023650070079173, 'psi': 0.9491236084131307}-{'f1_val': 0.9537445843059367, 'auprc': 0.9515697977446815, 'loss_val': 0.3065080195139148, 'psi': 0.9528746696814346}
[S5] START round=35 head_norm_before_train=1.093105 cos_to_last_merge=0.9989 (last merge round=33)
[S5] round=35 local utility u=0.509433 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.8684491604727957, 'loss_val': 0.37798520535343305, 'psi': 0.7676238100176793}-{'f1_val': 0.5803346641923356, 'auprc': 0.8556665777653842, 'loss_val': 0.6380701046826055, 'psi': 0.6904674296215552}
[S6] START round=35 head_norm_before_train=1.336393 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.7982108066363106, 'auprc': 0.7969115761597976, 'loss_val': 0.48499713847066717, 'psi': 0.7976911144457054}-{'f1_val': 0.8957457474317712, 'auprc': 0.9610947474998245, 'loss_val': 0.3435319949716576, 'psi': 0.9218853474589925}
[S7] START round=35 head_norm_before_train=1.771120 (no previous merge yet)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.47236387102303223, 'auprc': 0.7791726772092473, 'loss_val': 1.206797551025967, 'psi': 0.5950873934975183}-{'f1_val': 0.6386210887765404, 'auprc': 0.8002217957055422, 'loss_val': 0.5695856728926362, 'psi': 0.7032613715481412}
[S8] START round=35 head_norm_before_train=1.969493 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9929848166558567, 'auprc': 0.9925961252543978, 'loss_val': 0.03512232689495449, 'psi': 0.9928293400952732}-{'f1_val': 0.9924515537855688, 'auprc': 0.9987758782043458, 'loss_val': 0.036557074256983235, 'psi': 0.9949812835530796}
[S9] START round=35 head_norm_before_train=1.460956 cos_to_last_merge=0.9975 (last merge round=32)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9449281472011873, 'auprc': 0.9677113899684714, 'loss_val': 0.13191510802896025, 'psi': 0.9540414443081009}-{'f1_val': 0.9962500947792776, 'auprc': 0.9915213934655529, 'loss_val': 0.053094369629269944, 'psi': 0.9943586142537877}
[S10] START round=35 head_norm_before_train=1.973293 (no previous merge yet)
[S10] round=35 local utility u=0.003652 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956306749882106, 'loss_val': 0.03362377256371332, 'psi': 0.995364973406909}-{'f1_val': 0.9948336929542084, 'auprc': 0.9946138287076887, 'loss_val': 0.03575159731976723, 'psi': 0.9947457472556005}
[S11] START round=35 head_norm_before_train=1.446689 cos_to_last_merge=0.9954 (last merge round=31)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9974873702045898, 'loss_val': 0.09729981669873673, 'psi': 0.9966630690404534}-{'f1_val': 0.9965268648289654, 'auprc': 0.9971679008120449, 'loss_val': 0.09034481563789894, 'psi': 0.9967832792221971}
[S13] START round=35 head_norm_before_train=1.517507 cos_to_last_merge=0.8502 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.850
[S13] round=35 local utility u=0.058004 metrics={'f1_val': 0.5636763385222202, 'auprc': 0.6873047184786011, 'loss_val': 0.8472531337499078, 'psi': 0.6131276905047726}-{'f1_val': 0.5549383665818876, 'auprc': 0.6895169098996877, 'loss_val': 0.9174696624719406, 'psi': 0.6087697839090076}
[S14] START round=35 head_norm_before_train=1.931572 cos_to_last_merge=0.8095 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.809
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9957445751558393, 'auprc': 0.9962328086311019, 'loss_val': 0.03271677723111511, 'psi': 0.9959398685459442}-{'f1_val': 0.997240356705793, 'auprc': 0.9961806914957784, 'loss_val': 0.027778773204925212, 'psi': 0.9968164906217871}
[S15] START round=35 head_norm_before_train=1.284628 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7680712948589394, 'auprc': 0.9287939164686623, 'loss_val': 0.3482148658727503, 'psi': 0.8323603435028286}-{'f1_val': 0.9884964728348961, 'auprc': 0.9752955485160748, 'loss_val': 0.0826089311460189, 'psi': 0.9832161031073676}
[S16] START round=35 head_norm_before_train=1.208490 cos_to_last_merge=0.9938 (last merge round=32)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9311631753597254, 'auprc': 0.9905879750590332, 'loss_val': 0.340633760521038, 'psi': 0.9549330952394485}-{'f1_val': 0.9897244304195453, 'auprc': 0.992532098766243, 'loss_val': 0.13191253915650955, 'psi': 0.9908474977582243}
[S17] START round=35 head_norm_before_train=1.722064 cos_to_last_merge=0.7642 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=35 local utility u=0.382843 metrics={'f1_val': 0.6104076708638699, 'auprc': 0.830996398642736, 'loss_val': 0.7344916127892676, 'psi': 0.6986431619754163}-{'f1_val': 0.5613053487180494, 'auprc': 0.7541334147321692, 'loss_val': 0.9749741743522855, 'psi': 0.6384365751236973}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:38515
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.127657)
[S15] loaded HEAD from S5 (vec_in norm=1.127657)
[S15] cosine check vs S5: cos=0.8138
[S15] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=35 metric=0.7681 head_norm=1.310256
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.819632e-01
[S15] stored merged vector for next round verification (round=35)
[S15] DEBUG after merge:  round=35 metric=0.7667 head_norm=1.161161 delta_norm=0.381963
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.164 → S16@127.0.0.1:38516
[S11] ⇄ pheromone p=0.017 → S4@127.0.0.1:38504
[S9] ⇄ pheromone p=0.004 → S17@127.0.0.1:38517
[S14] ⇄ pheromone p=0.005 → S7@127.0.0.1:38508
[S7] ⇄ pheromone p=0.145 → S8@127.0.0.1:38509
[S4] ⇄ pheromone p=0.051 → S6@127.0.0.1:38507
[S5] ⇄ pheromone p=0.278 → S15@127.0.0.1:38515
[S17] ⇄ pheromone p=0.182 → S9@127.0.0.1:38510
[S16] ⇄ pheromone p=0.108 → S6@127.0.0.1:38507
[S2] START round=36 head_norm_before_train=1.827144 cos_to_last_merge=0.7854 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.785
[S2] round=36 local utility u=0.402860 metrics={'f1_val': 0.7268540182291123, 'auprc': 0.8589664815239317, 'loss_val': 0.5398345318254311, 'psi': 0.7796990035470401}-{'f1_val': 0.6954379827543696, 'auprc': 0.7672834241928526, 'loss_val': 0.882009672308872, 'psi': 0.7241761593297629}
[S3] START round=36 head_norm_before_train=2.266946 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.8807333927904727, 'auprc': 0.9972653449443325, 'loss_val': 0.19572016526848104, 'psi': 0.9273461736520165}-{'f1_val': 0.9615785680382265, 'auprc': 0.9973554509466854, 'loss_val': 0.0835514778080062, 'psi': 0.97588932120161}
[S4] START round=36 head_norm_before_train=1.429520 cos_to_last_merge=0.9979 (last merge round=33)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9384468861413744, 'auprc': 0.9393462281794924, 'loss_val': 0.3124573169938509, 'psi': 0.9388066229566217}-{'f1_val': 0.9416364033208959, 'auprc': 0.9603544160514828, 'loss_val': 0.3023650070079173, 'psi': 0.9491236084131307}
[S5] START round=36 head_norm_before_train=1.127657 cos_to_last_merge=0.9968 (last merge round=33)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.4407802569859576, 'auprc': 0.856517152469348, 'loss_val': 0.8637187016773228, 'psi': 0.6070750151793138}-{'f1_val': 0.7004069097142683, 'auprc': 0.8684491604727957, 'loss_val': 0.37798520535343305, 'psi': 0.7676238100176793}
[S6] START round=36 head_norm_before_train=1.366380 cos_to_last_merge=0.9995 (last merge round=34)
[S6] round=36 local utility u=0.368366 metrics={'f1_val': 0.7994975617237408, 'auprc': 0.9841061851771115, 'loss_val': 0.3175695491253509, 'psi': 0.873341011105089}-{'f1_val': 0.7982108066363106, 'auprc': 0.7969115761597976, 'loss_val': 0.48499713847066717, 'psi': 0.7976911144457054}
[S7] START round=36 head_norm_before_train=1.776322 (no previous merge yet)
[S7] round=36 local utility u=1.000000 metrics={'f1_val': 0.6765403787527475, 'auprc': 0.8213801879904675, 'loss_val': 0.3609731647949783, 'psi': 0.7344763024478356}-{'f1_val': 0.47236387102303223, 'auprc': 0.7791726772092473, 'loss_val': 1.206797551025967, 'psi': 0.5950873934975183}
[S8] START round=36 head_norm_before_train=1.981926 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9881366849483916, 'auprc': 0.9986142459632222, 'loss_val': 0.04378286046244188, 'psi': 0.9923277093543239}-{'f1_val': 0.9929848166558567, 'auprc': 0.9925961252543978, 'loss_val': 0.03512232689495449, 'psi': 0.9928293400952732}
[S9] START round=36 head_norm_before_train=1.487271 cos_to_last_merge=0.9961 (last merge round=32)
[S9] round=36 local utility u=0.237273 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9926438460778784, 'loss_val': 0.04256073402017668, 'psi': 0.9950538455194862}-{'f1_val': 0.9449281472011873, 'auprc': 0.9677113899684714, 'loss_val': 0.13191510802896025, 'psi': 0.9540414443081009}
[S10] START round=36 head_norm_before_train=1.985338 (no previous merge yet)
[S10] round=36 local utility u=0.000687 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957084160400554, 'loss_val': 0.03248270609264666, 'psi': 0.995396069827647}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956306749882106, 'loss_val': 0.03362377256371332, 'psi': 0.995364973406909}
[S11] START round=36 head_norm_before_train=1.476965 cos_to_last_merge=0.9931 (last merge round=31)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.7850975591693095, 'auprc': 0.995222085744977, 'loss_val': 0.3705956717852888, 'psi': 0.8691473697995764}-{'f1_val': 0.9961135349310292, 'auprc': 0.9974873702045898, 'loss_val': 0.09729981669873673, 'psi': 0.9966630690404534}
[S13] START round=36 head_norm_before_train=1.521928 cos_to_last_merge=0.8489 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.849
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5574201274185245, 'auprc': 0.6996831580581195, 'loss_val': 1.1258548916796411, 'psi': 0.6143253396743625}-{'f1_val': 0.5636763385222202, 'auprc': 0.6873047184786011, 'loss_val': 0.8472531337499078, 'psi': 0.6131276905047726}
[S14] START round=36 head_norm_before_train=1.940494 cos_to_last_merge=0.8091 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.809
[S14] round=36 local utility u=0.010667 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971521202591764, 'loss_val': 0.025580397766813492, 'psi': 0.9974515189335827}-{'f1_val': 0.9957445751558393, 'auprc': 0.9962328086311019, 'loss_val': 0.03271677723111511, 'psi': 0.9959398685459442}
[S15] START round=36 head_norm_before_train=1.161161 cos_to_last_merge=1.0000 (last merge round=35)
[S15] round=36 local utility u=0.841082 metrics={'f1_val': 0.9909399874182179, 'auprc': 0.9804218892291795, 'loss_val': 0.1581464468787025, 'psi': 0.9867327481426025}-{'f1_val': 0.7680712948589394, 'auprc': 0.9287939164686623, 'loss_val': 0.3482148658727503, 'psi': 0.8323603435028286}
[S16] START round=36 head_norm_before_train=1.261603 cos_to_last_merge=0.9886 (last merge round=32)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.8565722867668895, 'auprc': 0.98671357944217, 'loss_val': 0.6298590354212212, 'psi': 0.9086288038370016}-{'f1_val': 0.9311631753597254, 'auprc': 0.9905879750590332, 'loss_val': 0.340633760521038, 'psi': 0.9549330952394485}
[S17] START round=36 head_norm_before_train=1.733770 cos_to_last_merge=0.7638 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5939642626959941, 'auprc': 0.916833255547703, 'loss_val': 0.9320229843073119, 'psi': 0.7231118598366777}-{'f1_val': 0.6104076708638699, 'auprc': 0.830996398642736, 'loss_val': 0.7344916127892676, 'psi': 0.6986431619754163}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:38509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38505
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:38517
[S15] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.507723)
[S17] loaded HEAD from S9 (vec_in norm=1.507723)
[S17] cosine check vs S9: cos=0.8485
[S17] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.388332)
[S16] loaded HEAD from S6 (vec_in norm=1.388332)
[S16] cosine check vs S6: cos=0.9144
[S16] BUFFERED delta from S6 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.207100)
[S5] loaded HEAD from S15 (vec_in norm=1.207100)
[S5] cosine check vs S15: cos=0.9312
[S5] BUFFERED delta from S15 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.950938)
[S7] loaded HEAD from S14 (vec_in norm=1.950938)
[S7] cosine check vs S14: cos=-0.0231
[S7] DROPPED delta from S14 (cos=-0.0231 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1805) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.778817)
[S8] loaded HEAD from S7 (vec_in norm=1.778817)
[S8] cosine check vs S7: cos=-0.0052
[S8] DROPPED delta from S7 (cos=-0.0052 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=36 metric=0.4408 head_norm=1.157516
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.206865e-01
[S5] stored merged vector for next round verification (round=36)
[S5] DEBUG after merge:  round=36 metric=0.4415 head_norm=1.161793 delta_norm=0.220686
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.8566 head_norm=1.305760
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.815808e-01
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.8570 head_norm=1.317934 delta_norm=0.281581
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=36 metric=0.5940 head_norm=1.744620
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.617702e-01
[S17] stored merged vector for next round verification (round=36)
[S17] DEBUG after merge:  round=36 metric=0.5931 head_norm=1.563724 delta_norm=0.461770
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.832052 cos_to_last_merge=0.7848 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.785
[S2] round=37 local utility u=0.325093 metrics={'f1_val': 0.8474700911252687, 'auprc': 0.7981858124225827, 'loss_val': 0.43100205976487116, 'psi': 0.8277563796441942}-{'f1_val': 0.7268540182291123, 'auprc': 0.8589664815239317, 'loss_val': 0.5398345318254311, 'psi': 0.7796990035470401}
[S3] START round=37 head_norm_before_train=2.275288 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.8244966061802149, 'auprc': 0.9970917672278756, 'loss_val': 0.3544344869739555, 'psi': 0.8935346705992792}-{'f1_val': 0.8807333927904727, 'auprc': 0.9972653449443325, 'loss_val': 0.19572016526848104, 'psi': 0.9273461736520165}
[S4] START round=37 head_norm_before_train=1.452500 cos_to_last_merge=0.9966 (last merge round=33)
[S4] round=37 local utility u=0.052982 metrics={'f1_val': 0.940599157154554, 'auprc': 0.9662231984682065, 'loss_val': 0.30003873873461295, 'psi': 0.950848773680015}-{'f1_val': 0.9384468861413744, 'auprc': 0.9393462281794924, 'loss_val': 0.3124573169938509, 'psi': 0.9388066229566217}
[S5] START round=37 head_norm_before_train=1.161793 cos_to_last_merge=1.0000 (last merge round=36)
[S5] round=37 local utility u=0.827160 metrics={'f1_val': 0.6601364917103301, 'auprc': 0.8538254000083039, 'loss_val': 0.5174616446960913, 'psi': 0.7376120550295195}-{'f1_val': 0.4407802569859576, 'auprc': 0.856517152469348, 'loss_val': 0.8637187016773228, 'psi': 0.6070750151793138}
[S6] START round=37 head_norm_before_train=1.388332 cos_to_last_merge=0.9986 (last merge round=34)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.5702543595124863, 'auprc': 0.7551194654517661, 'loss_val': 0.8205250605007491, 'psi': 0.6442004018881982}-{'f1_val': 0.7994975617237408, 'auprc': 0.9841061851771115, 'loss_val': 0.3175695491253509, 'psi': 0.873341011105089}
[S7] START round=37 head_norm_before_train=1.778817 (no previous merge yet)
[S7] round=37 local utility u=0.141717 metrics={'f1_val': 0.6908732862208826, 'auprc': 0.8559035241217998, 'loss_val': 0.26710756840656336, 'psi': 0.7568853813812495}-{'f1_val': 0.6765403787527475, 'auprc': 0.8213801879904675, 'loss_val': 0.3609731647949783, 'psi': 0.7344763024478356}
[S8] START round=37 head_norm_before_train=1.992739 (no previous merge yet)
[S8] round=37 local utility u=0.006951 metrics={'f1_val': 0.9939009886418481, 'auprc': 0.9892938124324746, 'loss_val': 0.0365052202152188, 'psi': 0.9920581181580986}-{'f1_val': 0.9881366849483916, 'auprc': 0.9986142459632222, 'loss_val': 0.04378286046244188, 'psi': 0.9923277093543239}
[S9] START round=37 head_norm_before_train=1.507723 cos_to_last_merge=0.9948 (last merge round=32)
[S9] round=37 local utility u=0.009293 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9969492524771406, 'loss_val': 0.03689107735417626, 'psi': 0.9967760080791911}-{'f1_val': 0.9966605118138915, 'auprc': 0.9926438460778784, 'loss_val': 0.04256073402017668, 'psi': 0.9950538455194862}
[S10] START round=37 head_norm_before_train=1.998448 (no previous merge yet)
[S10] round=37 local utility u=0.000336 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957430422746053, 'loss_val': 0.031913673773371926, 'psi': 0.995409920321467}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957084160400554, 'loss_val': 0.03248270609264666, 'psi': 0.995396069827647}
[S11] START round=37 head_norm_before_train=1.505055 cos_to_last_merge=0.9909 (last merge round=31)
[S11] round=37 local utility u=0.457485 metrics={'f1_val': 0.9002233496706653, 'auprc': 0.9970939242075976, 'loss_val': 0.1519962171403994, 'psi': 0.9389715794854382}-{'f1_val': 0.7850975591693095, 'auprc': 0.995222085744977, 'loss_val': 0.3705956717852888, 'psi': 0.8691473697995764}
[S13] START round=37 head_norm_before_train=1.526990 cos_to_last_merge=0.8487 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.849
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5570648160720315, 'auprc': 0.7007868510490665, 'loss_val': 1.1563134929661238, 'psi': 0.6145536300628456}-{'f1_val': 0.5574201274185245, 'auprc': 0.6996831580581195, 'loss_val': 1.1258548916796411, 'psi': 0.6143253396743625}
[S14] START round=37 head_norm_before_train=1.950938 cos_to_last_merge=0.8084 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.808
[S14] round=37 local utility u=0.001477 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.997031101685245, 'loss_val': 0.02371874677983716, 'psi': 0.9975487441104269}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971521202591764, 'loss_val': 0.025580397766813492, 'psi': 0.9974515189335827}
[S15] START round=37 head_norm_before_train=1.207100 cos_to_last_merge=0.9992 (last merge round=35)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7256005359502156, 'auprc': 0.9662273910042338, 'loss_val': 0.38388241436244475, 'psi': 0.8218512779718229}-{'f1_val': 0.9909399874182179, 'auprc': 0.9804218892291795, 'loss_val': 0.1581464468787025, 'psi': 0.9867327481426025}
[S16] START round=37 head_norm_before_train=1.317934 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.448607 metrics={'f1_val': 0.9395187990221541, 'auprc': 0.9929909279232259, 'loss_val': 0.24915517640370388, 'psi': 0.9609076505825829}-{'f1_val': 0.8565722867668895, 'auprc': 0.98671357944217, 'loss_val': 0.6298590354212212, 'psi': 0.9086288038370016}
[S17] START round=37 head_norm_before_train=1.563724 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=37 local utility u=0.322379 metrics={'f1_val': 0.6291640696991315, 'auprc': 0.9888118913088957, 'loss_val': 0.7144005731530885, 'psi': 0.7730231983430371}-{'f1_val': 0.5939642626959941, 'auprc': 0.916833255547703, 'loss_val': 0.9320229843073119, 'psi': 0.7231118598366777}
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S16
[S5]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:38517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:38504
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38508
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:38515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:38509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:38507
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.475147)
[S6] loaded HEAD from S4 (vec_in norm=1.475147)
[S6] cosine check vs S4: cos=0.9819
[S6] BUFFERED delta from S4 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.536557)
[S17] loaded HEAD from S9 (vec_in norm=1.536557)
[S17] cosine check vs S9: cos=0.9546
[S17] BUFFERED delta from S9 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.184686)
[S15] loaded HEAD from S5 (vec_in norm=1.184686)
[S15] cosine check vs S5: cos=0.9736
[S15] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.784161)
[S8] loaded HEAD from S7 (vec_in norm=1.784161)
[S8] cosine check vs S7: cos=-0.0043
[S8] DROPPED delta from S7 (cos=-0.0043 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.576158)
[S9] loaded HEAD from S17 (vec_in norm=1.576158)
[S9] cosine check vs S17: cos=0.9546
[S9] BUFFERED delta from S17 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.529299)
[S4] loaded HEAD from S11 (vec_in norm=1.529299)
[S4] cosine check vs S11: cos=0.9851
[S4] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.001682)
[S7] loaded HEAD from S8 (vec_in norm=2.001682)
[S7] cosine check vs S8: cos=-0.0043
[S7] DROPPED delta from S8 (cos=-0.0043 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.962305)
[S7] loaded HEAD from S14 (vec_in norm=1.962305)
[S7] cosine check vs S14: cos=-0.0227
[S7] DROPPED delta from S14 (cos=-0.0227 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.357147)
[S6] loaded HEAD from S16 (vec_in norm=1.357147)
[S6] cosine check vs S16: cos=0.9785
[S6] BUFFERED delta from S16 (total buffered=2)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=37 metric=0.6292 head_norm=1.576158
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.353281e-01
[S17] stored merged vector for next round verification (round=37)
[S17] DEBUG after merge:  round=37 metric=0.6308 head_norm=1.538591 delta_norm=0.235328
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=37 metric=0.9406 head_norm=1.475147
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.322528e-01
[S4] stored merged vector for next round verification (round=37)
[S4] DEBUG after merge:  round=37 metric=0.9406 head_norm=1.496635 delta_norm=0.132253
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=37 metric=0.5703 head_norm=1.403500
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.525360e-02
[S6] stored merged vector for next round verification (round=37)
[S6] DEBUG after merge:  round=37 metric=0.5585 head_norm=1.398437 delta_norm=0.085254
[S6] aggregate: ROLLBACK (f1_val pre=0.570 post=0.558 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=37 metric=0.9967 head_norm=1.536557
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.353281e-01
[S9] stored merged vector for next round verification (round=37)
[S9] DEBUG after merge:  round=37 metric=0.9967 head_norm=1.538591 delta_norm=0.235328
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] CommDone barrier timeout: have=2 need=4 — continuing
[S2] START round=38 head_norm_before_train=1.836261 cos_to_last_merge=0.7842 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=38 local utility u=0.030276 metrics={'f1_val': 0.8282773602691782, 'auprc': 0.8649862822591264, 'loss_val': 0.4556955071628303, 'psi': 0.8429609290651574}-{'f1_val': 0.8474700911252687, 'auprc': 0.7981858124225827, 'loss_val': 0.43100205976487116, 'psi': 0.8277563796441942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=38 head_norm_before_train=2.282930 (no previous merge yet)
[S3] round=38 local utility u=0.318579 metrics={'f1_val': 0.8977810559741665, 'auprc': 0.9986884641168299, 'loss_val': 0.16177426577859158, 'psi': 0.9381440192312318}-{'f1_val': 0.8244966061802149, 'auprc': 0.9970917672278756, 'loss_val': 0.3544344869739555, 'psi': 0.8935346705992792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=38 head_norm_before_train=1.496635 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=38 local utility u=0.029348 metrics={'f1_val': 0.9454202145432212, 'auprc': 0.9727244092473682, 'loss_val': 0.28977303182931463, 'psi': 0.95634189242488}-{'f1_val': 0.940599157154554, 'auprc': 0.9662231984682065, 'loss_val': 0.30003873873461295, 'psi': 0.950848773680015}
[S5] START round=38 head_norm_before_train=1.184686 cos_to_last_merge=0.9998 (last merge round=36)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.6218657642776286, 'auprc': 0.8535002203537314, 'loss_val': 0.608619533261841, 'psi': 0.7145195467080698}-{'f1_val': 0.6601364917103301, 'auprc': 0.8538254000083039, 'loss_val': 0.5174616446960913, 'psi': 0.7376120550295195}
[S6] START round=38 head_norm_before_train=1.398437 cos_to_last_merge=1.0000 (last merge round=37)
[S6] round=38 local utility u=1.000000 metrics={'f1_val': 0.8801269692372937, 'auprc': 0.9758249578826814, 'loss_val': 0.3036366071869796, 'psi': 0.9184061646954489}-{'f1_val': 0.5702543595124863, 'auprc': 0.7551194654517661, 'loss_val': 0.8205250605007491, 'psi': 0.6442004018881982}
[S7] START round=38 head_norm_before_train=1.784161 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6529396009559857, 'auprc': 0.8047273499672798, 'loss_val': 0.45938620534905567, 'psi': 0.7136547005605034}-{'f1_val': 0.6908732862208826, 'auprc': 0.8559035241217998, 'loss_val': 0.26710756840656336, 'psi': 0.7568853813812495}
[S8] START round=38 head_norm_before_train=2.001682 (no previous merge yet)
[S8] round=38 local utility u=0.001464 metrics={'f1_val': 0.993955390846457, 'auprc': 0.9888864229551052, 'loss_val': 0.03268135042024136, 'psi': 0.9919278036899163}-{'f1_val': 0.9939009886418481, 'auprc': 0.9892938124324746, 'loss_val': 0.0365052202152188, 'psi': 0.9920581181580986}
[S9] START round=38 head_norm_before_train=1.538591 cos_to_last_merge=1.0000 (last merge round=37)
[S9] round=38 local utility u=0.002799 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9994868262107313, 'loss_val': 0.03491810050419821, 'psi': 0.9973922037758216}-{'f1_val': 0.9966605118138915, 'auprc': 0.9969492524771406, 'loss_val': 0.03689107735417626, 'psi': 0.9967760080791911}
[S10] START round=38 head_norm_before_train=2.007317 (no previous merge yet)
[S10] round=38 local utility u=0.000305 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956819286483983, 'loss_val': 0.031119760193601607, 'psi': 0.9953854748709842}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957430422746053, 'loss_val': 0.031913673773371926, 'psi': 0.995409920321467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=38 head_norm_before_train=1.529299 cos_to_last_merge=0.9888 (last merge round=31)
[S11] round=38 local utility u=0.336957 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9977615473303428, 'loss_val': 0.055426872946706125, 'psi': 0.9967727398907547}-{'f1_val': 0.9002233496706653, 'auprc': 0.9970939242075976, 'loss_val': 0.1519962171403994, 'psi': 0.9389715794854382}
[S13] START round=38 head_norm_before_train=1.534168 cos_to_last_merge=0.8473 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.847
[S13] round=38 local utility u=0.351298 metrics={'f1_val': 0.6135602401020436, 'auprc': 0.6631425216572211, 'loss_val': 0.6797578589479303, 'psi': 0.6333931527241146}-{'f1_val': 0.5570648160720315, 'auprc': 0.7007868510490665, 'loss_val': 1.1563134929661238, 'psi': 0.6145536300628456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=38 head_norm_before_train=1.962305 cos_to_last_merge=0.8076 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.808
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971510914713153, 'loss_val': 0.023839881325049734, 'psi': 0.9974511074184382}-{'f1_val': 0.9978938390605482, 'auprc': 0.997031101685245, 'loss_val': 0.02371874677983716, 'psi': 0.9975487441104269}
[S15] START round=38 head_norm_before_train=1.266281 cos_to_last_merge=0.9964 (last merge round=35)
[S15] round=38 local utility u=0.130316 metrics={'f1_val': 0.7658214904861154, 'auprc': 0.9670413310730105, 'loss_val': 0.36701810878979507, 'psi': 0.8463094267208734}-{'f1_val': 0.7256005359502156, 'auprc': 0.9662273910042338, 'loss_val': 0.38388241436244475, 'psi': 0.8218512779718229}
[S16] START round=38 head_norm_before_train=1.357147 cos_to_last_merge=0.9998 (last merge round=36)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9376110357846283, 'auprc': 0.9916253378967105, 'loss_val': 0.3064320665000489, 'psi': 0.9592167566294612}-{'f1_val': 0.9395187990221541, 'auprc': 0.9929909279232259, 'loss_val': 0.24915517640370388, 'psi': 0.9609076505825829}
[S17] START round=38 head_norm_before_train=1.538591 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=38 local utility u=0.116537 metrics={'f1_val': 0.6453958405400742, 'auprc': 0.999292748103792, 'loss_val': 0.6101591689620259, 'psi': 0.7869546035655612}-{'f1_val': 0.6291640696991315, 'auprc': 0.9888118913088957, 'loss_val': 0.7144005731530885, 'psi': 0.7730231983430371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:38507
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38516
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1803) from S11
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.552026)
[S4] loaded HEAD from S11 (vec_in norm=1.552026)
[S4] cosine check vs S11: cos=0.9949
[S4] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.007396)
[S7] loaded HEAD from S8 (vec_in norm=2.007396)
[S7] cosine check vs S8: cos=-0.0043
[S7] DROPPED delta from S8 (cos=-0.0043 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.327120)
[S5] loaded HEAD from S15 (vec_in norm=1.327120)
[S5] cosine check vs S15: cos=0.9625
[S5] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.549538)
[S9] loaded HEAD from S17 (vec_in norm=1.549538)
[S9] cosine check vs S17: cos=0.9998
[S9] BUFFERED delta from S17 (total buffered=1)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.7658 head_norm=1.327120
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.796175e-01
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.7658 head_norm=1.245031 delta_norm=0.179617
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:38517
[S16] RECEIVED delta(kind=head bytes=1799) from S6
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.408165)
[S16] loaded HEAD from S6 (vec_in norm=1.408165)
[S16] cosine check vs S6: cos=0.9833
[S16] BUFFERED delta from S6 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.516674)
[S6] loaded HEAD from S4 (vec_in norm=1.516674)
[S6] cosine check vs S4: cos=0.9814
[S6] BUFFERED delta from S4 (total buffered=1)
[S9] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.568056)
[S17] loaded HEAD from S9 (vec_in norm=1.568056)
[S17] cosine check vs S9: cos=0.9998
[S17] BUFFERED delta from S9 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=38 metric=0.8801 head_norm=1.408165
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.508744e-01
[S6] stored merged vector for next round verification (round=38)
[S6] DEBUG after merge:  round=38 metric=0.8311 head_norm=1.455627 delta_norm=0.150874
[S6] aggregate: ROLLBACK (f1_val pre=0.880 post=0.831 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=38 metric=0.9454 head_norm=1.516674
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.958100e-02
[S4] stored merged vector for next round verification (round=38)
[S4] DEBUG after merge:  round=38 metric=0.9457 head_norm=1.532387 delta_norm=0.079581
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.9376 head_norm=1.388956
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.281197e-01
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.9376 head_norm=1.392713 delta_norm=0.128120
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=38 metric=0.9960 head_norm=1.568056
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.644246e-02
[S9] stored merged vector for next round verification (round=38)
[S9] DEBUG after merge:  round=38 metric=0.9960 head_norm=1.558738 delta_norm=0.016442
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14]  timeout peer S7
[S14]  timeout peer S9
[S7]  timeout peer S8
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S10
[S5]  timeout peer S14
[S5]  timeout peer S15
[S16]  timeout peer S5
[S11]  timeout peer S4
[S9]  timeout peer S11
[S9]  timeout peer S13
[S4]  timeout peer S6
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.6219 head_norm=1.207133
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.834492e-01
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.6224 head_norm=1.255211 delta_norm=0.183449
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.842786 cos_to_last_merge=0.7837 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=39 local utility u=0.042623 metrics={'f1_val': 0.8305333893234529, 'auprc': 0.877722227577129, 'loss_val': 0.4221941861657981, 'psi': 0.8494089246249233}-{'f1_val': 0.8282773602691782, 'auprc': 0.8649862822591264, 'loss_val': 0.4556955071628303, 'psi': 0.8429609290651574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S2] r=40 psi=0.849 u=0.0426 p_local=0.1110 f1=0.831 auprc=0.878 bytes=34201
[S3] START round=39 head_norm_before_train=2.291426 (no previous merge yet)
[S3] round=39 local utility u=0.306258 metrics={'f1_val': 0.9815885840555931, 'auprc': 0.9973388328534811, 'loss_val': 0.04805463054987576, 'psi': 0.9878886835747482}-{'f1_val': 0.8977810559741665, 'auprc': 0.9986884641168299, 'loss_val': 0.16177426577859158, 'psi': 0.9381440192312318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S3] r=40 psi=0.988 u=0.3063 p_local=0.1506 f1=0.982 auprc=0.997 bytes=30555
[S4] START round=39 head_norm_before_train=1.532387 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9392566443281266, 'auprc': 0.9638592445942177, 'loss_val': 0.2982199273465463, 'psi': 0.9490976844345631}-{'f1_val': 0.9454202145432212, 'auprc': 0.9727244092473682, 'loss_val': 0.28977303182931463, 'psi': 0.95634189242488}
[S5] START round=39 head_norm_before_train=1.255211 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=1.000000 metrics={'f1_val': 0.9955828046023766, 'auprc': 0.9966823894083146, 'loss_val': 0.1830349331556582, 'psi': 0.9960226385247518}-{'f1_val': 0.6218657642776286, 'auprc': 0.8535002203537314, 'loss_val': 0.608619533261841, 'psi': 0.7145195467080698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S5] r=40 psi=0.996 u=1.0000 p_local=0.4199 f1=0.996 auprc=0.997 bytes=32364
[S6] START round=39 head_norm_before_train=1.455627 cos_to_last_merge=1.0000 (last merge round=38)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.5965977259147285, 'auprc': 0.7847573846654085, 'loss_val': 0.6419869476433839, 'psi': 0.6718615894150004}-{'f1_val': 0.8801269692372937, 'auprc': 0.9758249578826814, 'loss_val': 0.3036366071869796, 'psi': 0.9184061646954489}
[S7] START round=39 head_norm_before_train=1.786914 (no previous merge yet)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5832709918584041, 'auprc': 0.7825919561276296, 'loss_val': 0.7486957356472844, 'psi': 0.6629993775660943}-{'f1_val': 0.6529396009559857, 'auprc': 0.8047273499672798, 'loss_val': 0.45938620534905567, 'psi': 0.7136547005605034}
[S8] START round=39 head_norm_before_train=2.007396 (no previous merge yet)
[S8] round=39 local utility u=0.015152 metrics={'f1_val': 0.99397741430663, 'auprc': 0.9985814676275503, 'loss_val': 0.031593852672813574, 'psi': 0.9958190356349981}-{'f1_val': 0.993955390846457, 'auprc': 0.9888864229551052, 'loss_val': 0.03268135042024136, 'psi': 0.9919278036899163}
[S9] START round=39 head_norm_before_train=1.558738 cos_to_last_merge=1.0000 (last merge round=38)
[S9] round=39 local utility u=0.001706 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9993728623119179, 'loss_val': 0.03268933648357199, 'psi': 0.9974992017923338}-{'f1_val': 0.9959957888192151, 'auprc': 0.9994868262107313, 'loss_val': 0.03491810050419821, 'psi': 0.9973922037758216}
[S10] START round=39 head_norm_before_train=2.016566 (no previous merge yet)
[S10] round=39 local utility u=0.000361 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956966497224551, 'loss_val': 0.03044146806528517, 'psi': 0.9953913633006068}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956819286483983, 'loss_val': 0.031119760193601607, 'psi': 0.9953854748709842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S10] r=40 psi=0.995 u=0.0004 p_local=0.0027 f1=0.995 auprc=0.996 bytes=39607
[S11] START round=39 head_norm_before_train=1.552026 cos_to_last_merge=0.9867 (last merge round=31)
[S11] round=39 local utility u=0.003514 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.997569694308774, 'loss_val': 0.050302416031825496, 'psi': 0.9969439966208888}-{'f1_val': 0.9961135349310292, 'auprc': 0.9977615473303428, 'loss_val': 0.055426872946706125, 'psi': 0.9967727398907547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S11] r=40 psi=0.997 u=0.0035 p_local=0.1202 f1=0.997 auprc=0.998 bytes=35983
[S13] START round=39 head_norm_before_train=1.538416 cos_to_last_merge=0.8466 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.847
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.5502348343312149, 'auprc': 0.6931283874641074, 'loss_val': 1.0006471783197952, 'psi': 0.6073922555843718}-{'f1_val': 0.6135602401020436, 'auprc': 0.6631425216572211, 'loss_val': 0.6797578589479303, 'psi': 0.6333931527241146}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.607 u=0.0000 p_local=0.0915 f1=0.550 auprc=0.693 bytes=30599
[S14] START round=39 head_norm_before_train=1.972190 cos_to_last_merge=0.8066 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.807
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9957445751558393, 'auprc': 0.9957395516088963, 'loss_val': 0.030414971296365768, 'psi': 0.995742565737062}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971510914713153, 'loss_val': 0.023839881325049734, 'psi': 0.9974511074184382}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.996 u=0.0000 p_local=0.0034 f1=0.996 auprc=0.996 bytes=34176
[S15] START round=39 head_norm_before_train=1.245031 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.731238 metrics={'f1_val': 0.9667017954903089, 'auprc': 0.9794864401653532, 'loss_val': 0.14715846952431194, 'psi': 0.9718156533603266}-{'f1_val': 0.7658214904861154, 'auprc': 0.9670413310730105, 'loss_val': 0.36701810878979507, 'psi': 0.8463094267208734}
[S16] START round=39 head_norm_before_train=1.392713 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9367515528868917, 'auprc': 0.9917950220478533, 'loss_val': 0.3173177498803383, 'psi': 0.9587689405512764}-{'f1_val': 0.9376110357846283, 'auprc': 0.9916253378967105, 'loss_val': 0.3064320665000489, 'psi': 0.9592167566294612}
[S17] START round=39 head_norm_before_train=1.549538 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6028202225691539, 'auprc': 0.9208817293390645, 'loss_val': 0.8159531259814728, 'psi': 0.7300448252771181}-{'f1_val': 0.6453958405400742, 'auprc': 0.999292748103792, 'loss_val': 0.6101591689620259, 'psi': 0.7869546035655612}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] r=40 psi=0.996 u=0.0152 p_local=0.0159 f1=0.994 auprc=0.999 bytes=37809
[S9] r=40 psi=0.997 u=0.0017 p_local=0.0280 f1=0.996 auprc=0.999 bytes=37743
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.663 u=0.0000 p_local=0.1798 f1=0.583 auprc=0.783 bytes=28822
[S15] r=40 psi=0.972 u=0.7312 p_local=0.3719 f1=0.967 auprc=0.979 bytes=37761
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=39 metric=0.6028 head_norm=1.564744
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.977651e-02
[S17] stored merged vector for next round verification (round=39)
[S17] DEBUG after merge:  round=39 metric=0.6034 head_norm=1.566276 delta_norm=0.019777
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] r=40 psi=0.730 u=0.0000 p_local=0.1345 f1=0.603 auprc=0.921 bytes=34181
[S4] r=40 psi=0.949 u=0.0000 p_local=0.0322 f1=0.939 auprc=0.964 bytes=35959
[S16] r=40 psi=0.959 u=0.0000 p_local=0.1017 f1=0.937 auprc=0.992 bytes=28764
[S6] r=40 psi=0.672 u=0.0000 p_local=0.2650 f1=0.597 auprc=0.785 bytes=26971
[S2] START round=40 head_norm_before_train=1.852349 cos_to_last_merge=0.7830 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.783
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.8320781520098349, 'auprc': 0.8311082595489165, 'loss_val': 0.38718397903240226, 'psi': 0.8316901950254676}-{'f1_val': 0.8305333893234529, 'auprc': 0.877722227577129, 'loss_val': 0.4221941861657981, 'psi': 0.8494089246249233}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.303891 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9971051673084039, 'loss_val': 0.14427903631192904, 'psi': 0.9753398323060998}-{'f1_val': 0.9815885840555931, 'auprc': 0.9973388328534811, 'loss_val': 0.04805463054987576, 'psi': 0.9878886835747482}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.549026 cos_to_last_merge=0.9999 (last merge round=38)
[S4] round=40 local utility u=0.024735 metrics={'f1_val': 0.9418143409304138, 'auprc': 0.9722615252993562, 'loss_val': 0.28930366309926425, 'psi': 0.9539932146779908}-{'f1_val': 0.9392566443281266, 'auprc': 0.9638592445942177, 'loss_val': 0.2982199273465463, 'psi': 0.9490976844345631}
[S5] START round=40 head_norm_before_train=1.276121 cos_to_last_merge=0.9998 (last merge round=38)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.6542871676035878, 'auprc': 0.9116160001687198, 'loss_val': 0.44699509727313286, 'psi': 0.7572187006296407}-{'f1_val': 0.9955828046023766, 'auprc': 0.9966823894083146, 'loss_val': 0.1830349331556582, 'psi': 0.9960226385247518}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.463240 cos_to_last_merge=1.0000 (last merge round=38)
[S6] round=40 local utility u=1.000000 metrics={'f1_val': 0.8227576121396041, 'auprc': 0.964848532222539, 'loss_val': 0.37523219454894124, 'psi': 0.8795939801727781}-{'f1_val': 0.5965977259147285, 'auprc': 0.7847573846654085, 'loss_val': 0.6419869476433839, 'psi': 0.6718615894150004}
[S7] START round=40 head_norm_before_train=1.789773 (no previous merge yet)
[S7] round=40 local utility u=0.122367 metrics={'f1_val': 0.6144525967124701, 'auprc': 0.7867378769549095, 'loss_val': 0.7034887247946648, 'psi': 0.6833667088094458}-{'f1_val': 0.5832709918584041, 'auprc': 0.7825919561276296, 'loss_val': 0.7486957356472844, 'psi': 0.6629993775660943}
[S8] START round=40 head_norm_before_train=2.013543 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.9986248394271773, 'loss_val': 0.03689720824162535, 'psi': 0.9947083199898901}-{'f1_val': 0.99397741430663, 'auprc': 0.9985814676275503, 'loss_val': 0.031593852672813574, 'psi': 0.9958190356349981}
[S9] START round=40 head_norm_before_train=1.584046 cos_to_last_merge=0.9999 (last merge round=38)
[S9] round=40 local utility u=0.000698 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9983445419837325, 'loss_val': 0.030671574913910316, 'psi': 0.9973341238818278}-{'f1_val': 0.9962500947792776, 'auprc': 0.9993728623119179, 'loss_val': 0.03268933648357199, 'psi': 0.9974992017923338}
[S10] START round=40 head_norm_before_train=2.027434 (no previous merge yet)
[S10] round=40 local utility u=0.001962 metrics={'f1_val': 0.9956028077628096, 'auprc': 0.9959426352880207, 'loss_val': 0.02974447980229559, 'psi': 0.9957387387728941}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956966497224551, 'loss_val': 0.03044146806528517, 'psi': 0.9953913633006068}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=40 head_norm_before_train=1.572556 cos_to_last_merge=0.9849 (last merge round=31)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9970859000503649, 'loss_val': 0.04776533167781861, 'psi': 0.9966053771025194}-{'f1_val': 0.9965268648289654, 'auprc': 0.997569694308774, 'loss_val': 0.050302416031825496, 'psi': 0.9969439966208888}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.541767 cos_to_last_merge=0.8460 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.846
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.5340449580130323, 'auprc': 0.7022233853302711, 'loss_val': 1.2744010248218653, 'psi': 0.6013163289399278}-{'f1_val': 0.5502348343312149, 'auprc': 0.6931283874641074, 'loss_val': 1.0006471783197952, 'psi': 0.6073922555843718}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.982135 cos_to_last_merge=0.8055 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.806
[S14] round=40 local utility u=0.009018 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971493945370317, 'loss_val': 0.024126854049521102, 'psi': 0.9970582627094118}-{'f1_val': 0.9957445751558393, 'auprc': 0.9957395516088963, 'loss_val': 0.030414971296365768, 'psi': 0.995742565737062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=40 head_norm_before_train=1.296729 cos_to_last_merge=0.9993 (last merge round=38)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7824697685305955, 'auprc': 0.9676923218006757, 'loss_val': 0.32574721044324917, 'psi': 0.8565587898386275}-{'f1_val': 0.9667017954903089, 'auprc': 0.9794864401653532, 'loss_val': 0.14715846952431194, 'psi': 0.9718156533603266}
[S16] START round=40 head_norm_before_train=1.418223 cos_to_last_merge=0.9999 (last merge round=38)
[S16] round=40 local utility u=0.077478 metrics={'f1_val': 0.9415812984483454, 'auprc': 0.9919381833543099, 'loss_val': 0.19177022458543425, 'psi': 0.9617240524107312}-{'f1_val': 0.9367515528868917, 'auprc': 0.9917950220478533, 'loss_val': 0.3173177498803383, 'psi': 0.9587689405512764}
[S17] START round=40 head_norm_before_train=1.566276 cos_to_last_merge=1.0000 (last merge round=39)
[S17] round=40 local utility u=0.273890 metrics={'f1_val': 0.7353535650361097, 'auprc': 0.7748899169597102, 'loss_val': 0.6253968765639629, 'psi': 0.7511681058055499}-{'f1_val': 0.6028202225691539, 'auprc': 0.9208817293390645, 'loss_val': 0.8159531259814728, 'psi': 0.7300448252771181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] START round=41 head_norm_before_train=1.859605 cos_to_last_merge=0.7823 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.782
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.8269198913320617, 'auprc': 0.8677935983482917, 'loss_val': 0.4681904809770429, 'psi': 0.8432693741385537}-{'f1_val': 0.8320781520098349, 'auprc': 0.8311082595489165, 'loss_val': 0.38718397903240226, 'psi': 0.8316901950254676}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.317451 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.7672041754019291, 'auprc': 0.996507632665503, 'loss_val': 0.40509490444601604, 'psi': 0.8589255583073587}-{'f1_val': 0.9608296089712303, 'auprc': 0.9971051673084039, 'loss_val': 0.14427903631192904, 'psi': 0.9753398323060998}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.563500 cos_to_last_merge=0.9997 (last merge round=38)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9361771997017364, 'auprc': 0.9262704947317824, 'loss_val': 0.32357040756190525, 'psi': 0.9322145177137547}-{'f1_val': 0.9418143409304138, 'auprc': 0.9722615252993562, 'loss_val': 0.28930366309926425, 'psi': 0.9539932146779908}
[S5] START round=41 head_norm_before_train=1.288257 cos_to_last_merge=0.9995 (last merge round=38)
[S5] round=41 local utility u=0.643176 metrics={'f1_val': 0.7927116354394296, 'auprc': 0.9917262712620044, 'loss_val': 0.23152161680482905, 'psi': 0.8723174897684596}-{'f1_val': 0.6542871676035878, 'auprc': 0.9116160001687198, 'loss_val': 0.44699509727313286, 'psi': 0.7572187006296407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=41 head_norm_before_train=1.470401 cos_to_last_merge=0.9999 (last merge round=38)
[S6] round=41 local utility u=0.214053 metrics={'f1_val': 0.8780745779919699, 'auprc': 0.970162936411709, 'loss_val': 0.2949708945597039, 'psi': 0.9149099213598655}-{'f1_val': 0.8227576121396041, 'auprc': 0.964848532222539, 'loss_val': 0.37523219454894124, 'psi': 0.8795939801727781}
[S7] START round=41 head_norm_before_train=1.797107 (no previous merge yet)
[S7] round=41 local utility u=0.285210 metrics={'f1_val': 0.6608004878660274, 'auprc': 0.8013166508921847, 'loss_val': 0.4548932470466868, 'psi': 0.7170069530764904}-{'f1_val': 0.6144525967124701, 'auprc': 0.7867378769549095, 'loss_val': 0.7034887247946648, 'psi': 0.6833667088094458}
[S8] START round=41 head_norm_before_train=2.019420 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9938116152867777, 'auprc': 0.9887349590919, 'loss_val': 0.04071569761572448, 'psi': 0.9917809528088266}-{'f1_val': 0.9920973070316986, 'auprc': 0.9986248394271773, 'loss_val': 0.03689720824162535, 'psi': 0.9947083199898901}
[S9] START round=41 head_norm_before_train=1.606382 cos_to_last_merge=0.9997 (last merge round=38)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.992904783397339, 'auprc': 0.9981340490263364, 'loss_val': 0.03613596993286202, 'psi': 0.994996489648938}-{'f1_val': 0.9966605118138915, 'auprc': 0.9983445419837325, 'loss_val': 0.030671574913910316, 'psi': 0.9973341238818278}
[S10] START round=41 head_norm_before_train=2.038956 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9933951779722761, 'loss_val': 0.03039233846665706, 'psi': 0.9944707746005352}-{'f1_val': 0.9956028077628096, 'auprc': 0.9959426352880207, 'loss_val': 0.02974447980229559, 'psi': 0.9957387387728941}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.592210 cos_to_last_merge=0.9831 (last merge round=31)
[S11] round=41 local utility u=0.002195 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9975433882661505, 'loss_val': 0.04371864703105953, 'psi': 0.9966854762650776}-{'f1_val': 0.9962850284706224, 'auprc': 0.9970859000503649, 'loss_val': 0.04776533167781861, 'psi': 0.9966053771025194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=41 head_norm_before_train=1.547666 cos_to_last_merge=0.8453 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.845
[S13] round=41 local utility u=0.107380 metrics={'f1_val': 0.5399550434513143, 'auprc': 0.6928712562974817, 'loss_val': 1.067044583262653, 'psi': 0.6011215285897813}-{'f1_val': 0.5340449580130323, 'auprc': 0.7022233853302711, 'loss_val': 1.2744010248218653, 'psi': 0.6013163289399278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=41 head_norm_before_train=1.989732 cos_to_last_merge=0.8049 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.805
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.996364515649224, 'loss_val': 0.02372036834310009, 'psi': 0.9968900202831654}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971493945370317, 'loss_val': 0.024126854049521102, 'psi': 0.9970582627094118}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.351820 cos_to_last_merge=0.9973 (last merge round=38)
[S15] round=41 local utility u=0.784652 metrics={'f1_val': 0.9937414413930615, 'auprc': 0.9893544227861485, 'loss_val': 0.0890605472917642, 'psi': 0.9919866339502963}-{'f1_val': 0.7824697685305955, 'auprc': 0.9676923218006757, 'loss_val': 0.32574721044324917, 'psi': 0.8565587898386275}
[S16] START round=41 head_norm_before_train=1.440954 cos_to_last_merge=0.9996 (last merge round=38)
[S16] round=41 local utility u=0.195389 metrics={'f1_val': 0.9868468582153355, 'auprc': 0.9942747149876752, 'loss_val': 0.07959574912125449, 'psi': 0.9898180009242713}-{'f1_val': 0.9415812984483454, 'auprc': 0.9919381833543099, 'loss_val': 0.19177022458543425, 'psi': 0.9617240524107312}
[S17] START round=41 head_norm_before_train=1.587296 cos_to_last_merge=0.9999 (last merge round=39)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.5659945404478346, 'auprc': 0.7915795854310823, 'loss_val': 0.9438989053831542, 'psi': 0.6562285584411337}-{'f1_val': 0.7353535650361097, 'auprc': 0.7748899169597102, 'loss_val': 0.6253968765639629, 'psi': 0.7511681058055499}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.990)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.717)
[S6] not sending this round → trigger blocked (psi=0.915)
[S2] START round=42 head_norm_before_train=1.865602 cos_to_last_merge=0.7816 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.782
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.6454176410896622, 'auprc': 0.754046979623568, 'loss_val': 1.31821398315463, 'psi': 0.6888693765032246}-{'f1_val': 0.8269198913320617, 'auprc': 0.8677935983482917, 'loss_val': 0.4681904809770429, 'psi': 0.8432693741385537}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=2.329500 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.64877467660442, 'auprc': 0.996855840713589, 'loss_val': 0.7092198141611337, 'psi': 0.7880071422480877}-{'f1_val': 0.7672041754019291, 'auprc': 0.996507632665503, 'loss_val': 0.40509490444601604, 'psi': 0.8589255583073587}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.578553 cos_to_last_merge=0.9994 (last merge round=38)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9348233639400644, 'auprc': 0.9145920911215151, 'loss_val': 0.32827109742784955, 'psi': 0.9267308548126447}-{'f1_val': 0.9361771997017364, 'auprc': 0.9262704947317824, 'loss_val': 0.32357040756190525, 'psi': 0.9322145177137547}
[S5] START round=42 head_norm_before_train=1.300317 cos_to_last_merge=0.9991 (last merge round=38)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.7709230057020922, 'auprc': 0.9015184275470747, 'loss_val': 0.5220320982381572, 'psi': 0.8231611744400852}-{'f1_val': 0.7927116354394296, 'auprc': 0.9917262712620044, 'loss_val': 0.23152161680482905, 'psi': 0.8723174897684596}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.477372 cos_to_last_merge=0.9998 (last merge round=38)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7771898966142315, 'auprc': 0.9313607617394888, 'loss_val': 0.4883301367596634, 'psi': 0.8388582426643345}-{'f1_val': 0.8780745779919699, 'auprc': 0.970162936411709, 'loss_val': 0.2949708945597039, 'psi': 0.9149099213598655}
[S7] START round=42 head_norm_before_train=1.802505 (no previous merge yet)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.623698731552464, 'auprc': 0.7881961687352059, 'loss_val': 0.6255419845645277, 'psi': 0.6894977064255607}-{'f1_val': 0.6608004878660274, 'auprc': 0.8013166508921847, 'loss_val': 0.4548932470466868, 'psi': 0.7170069530764904}
[S8] START round=42 head_norm_before_train=2.024574 (no previous merge yet)
[S8] round=42 local utility u=0.010672 metrics={'f1_val': 0.9917345774119155, 'auprc': 0.9987534437406442, 'loss_val': 0.036964112135626545, 'psi': 0.994542123943407}-{'f1_val': 0.9938116152867777, 'auprc': 0.9887349590919, 'loss_val': 0.04071569761572448, 'psi': 0.9917809528088266}
[S9] START round=42 head_norm_before_train=1.627284 cos_to_last_merge=0.9994 (last merge round=38)
[S9] round=42 local utility u=0.013238 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9976122033797585, 'loss_val': 0.02814188727764552, 'psi': 0.9967925503314349}-{'f1_val': 0.992904783397339, 'auprc': 0.9981340490263364, 'loss_val': 0.03613596993286202, 'psi': 0.994996489648938}
[S10] START round=42 head_norm_before_train=2.050962 (no previous merge yet)
[S10] round=42 local utility u=0.000163 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9936418958287677, 'loss_val': 0.029998540539374716, 'psi': 0.9944887655966115}-{'f1_val': 0.9951878390193748, 'auprc': 0.9933951779722761, 'loss_val': 0.03039233846665706, 'psi': 0.9944707746005352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=42 head_norm_before_train=1.610404 cos_to_last_merge=0.9814 (last merge round=31)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.995391754225302, 'auprc': 0.9980235947702389, 'loss_val': 0.042556881835839215, 'psi': 0.9964444904432768}-{'f1_val': 0.9961135349310292, 'auprc': 0.9975433882661505, 'loss_val': 0.04371864703105953, 'psi': 0.9966854762650776}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.552198 cos_to_last_merge=0.8454 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.845
[S13] round=42 local utility u=0.256540 metrics={'f1_val': 0.5841688233310265, 'auprc': 0.6846402472348513, 'loss_val': 0.7945537806415387, 'psi': 0.6243573928925564}-{'f1_val': 0.5399550434513143, 'auprc': 0.6928712562974817, 'loss_val': 1.067044583262653, 'psi': 0.6011215285897813}
[S13] not sending this round → trigger blocked (psi=0.624)
[S14] START round=42 head_norm_before_train=1.997585 cos_to_last_merge=0.8041 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.804
[S14] round=42 local utility u=0.003438 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9971523132731861, 'loss_val': 0.020664985889821318, 'psi': 0.997350771939167}-{'f1_val': 0.997240356705793, 'auprc': 0.996364515649224, 'loss_val': 0.02372036834310009, 'psi': 0.9968900202831654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=42 head_norm_before_train=1.392485 cos_to_last_merge=0.9954 (last merge round=38)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7564375002060796, 'auprc': 0.8901748589456386, 'loss_val': 0.4263416705013004, 'psi': 0.8099324437019032}-{'f1_val': 0.9937414413930615, 'auprc': 0.9893544227861485, 'loss_val': 0.0890605472917642, 'psi': 0.9919866339502963}
[S16] START round=42 head_norm_before_train=1.461754 cos_to_last_merge=0.9993 (last merge round=38)
[S16] round=42 local utility u=0.017462 metrics={'f1_val': 0.9901219658419581, 'auprc': 0.9941351782440939, 'loss_val': 0.0639043619382956, 'psi': 0.9917272508028123}-{'f1_val': 0.9868468582153355, 'auprc': 0.9942747149876752, 'loss_val': 0.07959574912125449, 'psi': 0.9898180009242713}
[S17] START round=42 head_norm_before_train=1.603274 cos_to_last_merge=0.9997 (last merge round=39)
[S17] round=42 local utility u=0.358819 metrics={'f1_val': 0.5986146909915626, 'auprc': 0.9392566642022693, 'loss_val': 0.8650132582833121, 'psi': 0.7348714802758453}-{'f1_val': 0.5659945404478346, 'auprc': 0.7915795854310823, 'loss_val': 0.9438989053831542, 'psi': 0.6562285584411337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.871316 cos_to_last_merge=0.7810 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.781
[S2] round=43 local utility u=1.000000 metrics={'f1_val': 0.8271377166736356, 'auprc': 0.8745251130854222, 'loss_val': 0.4668669067101025, 'psi': 0.8460926752383502}-{'f1_val': 0.6454176410896622, 'auprc': 0.754046979623568, 'loss_val': 1.31821398315463, 'psi': 0.6888693765032246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=43 head_norm_before_train=2.339116 (no previous merge yet)
[S3] round=43 local utility u=1.000000 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9984462159367332, 'loss_val': 0.01667451455158619, 'psi': 0.9978347639466278}-{'f1_val': 0.64877467660442, 'auprc': 0.996855840713589, 'loss_val': 0.7092198141611337, 'psi': 0.7880071422480877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=43 head_norm_before_train=1.589252 cos_to_last_merge=0.9992 (last merge round=38)
[S4] round=43 local utility u=0.083829 metrics={'f1_val': 0.9388394728368563, 'auprc': 0.9542510741150494, 'loss_val': 0.3036864386806572, 'psi': 0.9450041133481336}-{'f1_val': 0.9348233639400644, 'auprc': 0.9145920911215151, 'loss_val': 0.32827109742784955, 'psi': 0.9267308548126447}
[S5] START round=43 head_norm_before_train=1.314839 cos_to_last_merge=0.9985 (last merge round=38)
[S5] round=43 local utility u=0.987009 metrics={'f1_val': 0.9935079921035903, 'auprc': 0.9973496184564619, 'loss_val': 0.171017369124924, 'psi': 0.995044642644739}-{'f1_val': 0.7709230057020922, 'auprc': 0.9015184275470747, 'loss_val': 0.5220320982381572, 'psi': 0.8231611744400852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=43 head_norm_before_train=1.488840 cos_to_last_merge=0.9993 (last merge round=38)
[S6] round=43 local utility u=0.207313 metrics={'f1_val': 0.8223837375530249, 'auprc': 0.9540734153924637, 'loss_val': 0.41300440184139237, 'psi': 0.8750596086888004}-{'f1_val': 0.7771898966142315, 'auprc': 0.9313607617394888, 'loss_val': 0.4883301367596634, 'psi': 0.8388582426643345}
[S7] START round=43 head_norm_before_train=1.812764 (no previous merge yet)
[S7] round=43 local utility u=0.205254 metrics={'f1_val': 0.6635975182668499, 'auprc': 0.7986909593228473, 'loss_val': 0.485910445629526, 'psi': 0.7176348946892488}-{'f1_val': 0.623698731552464, 'auprc': 0.7881961687352059, 'loss_val': 0.6255419845645277, 'psi': 0.6894977064255607}
[S8] START round=43 head_norm_before_train=2.028315 (no previous merge yet)
[S8] round=43 local utility u=0.004354 metrics={'f1_val': 0.9927378939946618, 'auprc': 0.9986940963060496, 'loss_val': 0.03409782660690942, 'psi': 0.995120374919217}-{'f1_val': 0.9917345774119155, 'auprc': 0.9987534437406442, 'loss_val': 0.036964112135626545, 'psi': 0.994542123943407}
[S9] START round=43 head_norm_before_train=1.646931 cos_to_last_merge=0.9989 (last merge round=38)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9915703779462836, 'loss_val': 0.0285237970288376, 'psi': 0.99437820804608}-{'f1_val': 0.9962461149658858, 'auprc': 0.9976122033797585, 'loss_val': 0.02814188727764552, 'psi': 0.9967925503314349}
[S10] START round=43 head_norm_before_train=2.062859 (no previous merge yet)
[S10] round=43 local utility u=0.001665 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9947527527397291, 'loss_val': 0.030001896179388626, 'psi': 0.994933108360996}-{'f1_val': 0.9950533454418405, 'auprc': 0.9936418958287677, 'loss_val': 0.029998540539374716, 'psi': 0.9944887655966115}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=43 head_norm_before_train=1.627289 cos_to_last_merge=0.9798 (last merge round=31)
[S11] round=43 local utility u=0.001617 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9973464721979467, 'loss_val': 0.04017104141108163, 'psi': 0.9964616080227904}-{'f1_val': 0.995391754225302, 'auprc': 0.9980235947702389, 'loss_val': 0.042556881835839215, 'psi': 0.9964444904432768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] sending update (kind=head size=1807 to 1 peers)
[S13] START round=43 head_norm_before_train=1.557164 cos_to_last_merge=0.8447 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.845
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5435274533548895, 'auprc': 0.6963201381204749, 'loss_val': 0.9552217608118201, 'psi': 0.6046445272611236}-{'f1_val': 0.5841688233310265, 'auprc': 0.6846402472348513, 'loss_val': 0.7945537806415387, 'psi': 0.6243573928925564}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.004786 cos_to_last_merge=0.8035 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.803
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9947363892425176, 'auprc': 0.9960737444168787, 'loss_val': 0.03361950339686556, 'psi': 0.9952713313122621}-{'f1_val': 0.9974830777164877, 'auprc': 0.9971523132731861, 'loss_val': 0.020664985889821318, 'psi': 0.997350771939167}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.423664 cos_to_last_merge=0.9938 (last merge round=38)
[S15] round=43 local utility u=0.907006 metrics={'f1_val': 0.9661934327821808, 'auprc': 0.9728771630998063, 'loss_val': 0.11897261521787868, 'psi': 0.968866924909231}-{'f1_val': 0.7564375002060796, 'auprc': 0.8901748589456386, 'loss_val': 0.4263416705013004, 'psi': 0.8099324437019032}
[S16] START round=43 head_norm_before_train=1.480954 cos_to_last_merge=0.9989 (last merge round=38)
[S16] round=43 local utility u=0.005032 metrics={'f1_val': 0.9907789150840707, 'auprc': 0.9937586636680593, 'loss_val': 0.05665223467878689, 'psi': 0.9919708145176662}-{'f1_val': 0.9901219658419581, 'auprc': 0.9941351782440939, 'loss_val': 0.0639043619382956, 'psi': 0.9917272508028123}
[S17] START round=43 head_norm_before_train=1.618800 cos_to_last_merge=0.9994 (last merge round=39)
[S17] round=43 local utility u=0.280529 metrics={'f1_val': 0.6472994765008655, 'auprc': 0.9721658180103634, 'loss_val': 0.6947905696746276, 'psi': 0.7772460131046647}-{'f1_val': 0.5986146909915626, 'auprc': 0.9392566642022693, 'loss_val': 0.8650132582833121, 'psi': 0.7348714802758453}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] not sending this round → trigger blocked (psi=0.777)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S6] sending update (kind=head size=1788 to 1 peers)
[S2] START round=44 head_norm_before_train=1.879563 cos_to_last_merge=0.7806 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.781
[S2] round=44 local utility u=0.065385 metrics={'f1_val': 0.8320572088576086, 'auprc': 0.868774843831299, 'loss_val': 0.34836304674733226, 'psi': 0.8467442628470847}-{'f1_val': 0.8271377166736356, 'auprc': 0.8745251130854222, 'loss_val': 0.4668669067101025, 'psi': 0.8460926752383502}
[S2] not sending this round → trigger blocked (psi=0.847)
[S3] START round=44 head_norm_before_train=2.347778 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9975711490720289, 'loss_val': 0.016891488010238417, 'psi': 0.9976973574557702}-{'f1_val': 0.9974271292865575, 'auprc': 0.9984462159367332, 'loss_val': 0.01667451455158619, 'psi': 0.9978347639466278}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.600880 cos_to_last_merge=0.9988 (last merge round=38)
[S4] round=44 local utility u=0.083035 metrics={'f1_val': 0.9540354796646321, 'auprc': 0.972067632014944, 'loss_val': 0.2822415331855087, 'psi': 0.9612483406047568}-{'f1_val': 0.9388394728368563, 'auprc': 0.9542510741150494, 'loss_val': 0.3036864386806572, 'psi': 0.9450041133481336}
[S5] START round=44 head_norm_before_train=1.331273 cos_to_last_merge=0.9978 (last merge round=38)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9179415921613497, 'loss_val': 0.3561321721400474, 'psi': 0.7874729565302138}-{'f1_val': 0.9935079921035903, 'auprc': 0.9973496184564619, 'loss_val': 0.171017369124924, 'psi': 0.995044642644739}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.500619 cos_to_last_merge=0.9987 (last merge round=38)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6729932707230064, 'auprc': 0.7977953768440524, 'loss_val': 0.6372817993195803, 'psi': 0.7229141131714248}-{'f1_val': 0.8223837375530249, 'auprc': 0.9540734153924637, 'loss_val': 0.41300440184139237, 'psi': 0.8750596086888004}
[S7] START round=44 head_norm_before_train=1.824741 (no previous merge yet)
[S7] round=44 local utility u=1.000000 metrics={'f1_val': 0.9127158603816932, 'auprc': 0.9534180560379191, 'loss_val': 0.22129245886752158, 'psi': 0.9289967386441835}-{'f1_val': 0.6635975182668499, 'auprc': 0.7986909593228473, 'loss_val': 0.485910445629526, 'psi': 0.7176348946892488}
[S8] START round=44 head_norm_before_train=2.033476 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9934511917604464, 'auprc': 0.9889055199647094, 'loss_val': 0.035096219127272205, 'psi': 0.9916329230421517}-{'f1_val': 0.9927378939946618, 'auprc': 0.9986940963060496, 'loss_val': 0.03409782660690942, 'psi': 0.995120374919217}
[S9] START round=44 head_norm_before_train=1.666771 cos_to_last_merge=0.9985 (last merge round=38)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9980892654656732, 'loss_val': 0.036256437781915, 'psi': 0.9944748983143052}-{'f1_val': 0.9962500947792776, 'auprc': 0.9915703779462836, 'loss_val': 0.0285237970288376, 'psi': 0.99437820804608}
[S10] START round=44 head_norm_before_train=2.068229 (no previous merge yet)
[S10] round=44 local utility u=0.001214 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9952384356337433, 'loss_val': 0.029030252501253885, 'psi': 0.9951273815186017}-{'f1_val': 0.9950533454418405, 'auprc': 0.9947527527397291, 'loss_val': 0.030001896179388626, 'psi': 0.994933108360996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=44 head_norm_before_train=1.643643 cos_to_last_merge=0.9783 (last merge round=31)
[S11] round=44 local utility u=0.003119 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9979944363225709, 'loss_val': 0.03732756865159877, 'psi': 0.9968658954876458}-{'f1_val': 0.9958716985726862, 'auprc': 0.9973464721979467, 'loss_val': 0.04017104141108163, 'psi': 0.9964616080227904}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=44 head_norm_before_train=1.562766 cos_to_last_merge=0.8432 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.843
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5565495388659933, 'auprc': 0.5405068932129736, 'loss_val': 1.0480727051768086, 'psi': 0.5501324806047854}-{'f1_val': 0.5435274533548895, 'auprc': 0.6963201381204749, 'loss_val': 0.9552217608118201, 'psi': 0.6046445272611236}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=2.010041 cos_to_last_merge=0.8033 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.803
[S14] round=44 local utility u=0.013310 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971494582389411, 'loss_val': 0.023794335413516436, 'psi': 0.9970582881901755}-{'f1_val': 0.9947363892425176, 'auprc': 0.9960737444168787, 'loss_val': 0.03361950339686556, 'psi': 0.9952713313122621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=44 head_norm_before_train=1.458489 cos_to_last_merge=0.9918 (last merge round=38)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6984351374852946, 'auprc': 0.9329515020564954, 'loss_val': 0.4484188277346412, 'psi': 0.7922416833137749}-{'f1_val': 0.9661934327821808, 'auprc': 0.9728771630998063, 'loss_val': 0.11897261521787868, 'psi': 0.968866924909231}
[S16] START round=44 head_norm_before_train=1.497784 cos_to_last_merge=0.9985 (last merge round=38)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.8914506951231856, 'auprc': 0.9862483715119416, 'loss_val': 0.5174466407260352, 'psi': 0.929369765678688}-{'f1_val': 0.9907789150840707, 'auprc': 0.9937586636680593, 'loss_val': 0.05665223467878689, 'psi': 0.9919708145176662}
[S17] START round=44 head_norm_before_train=1.632530 cos_to_last_merge=0.9991 (last merge round=39)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6255258800903547, 'auprc': 0.9343900415187905, 'loss_val': 0.8574913142658507, 'psi': 0.7490715446617291}-{'f1_val': 0.6472994765008655, 'auprc': 0.9721658180103634, 'loss_val': 0.6947905696746276, 'psi': 0.7772460131046647}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.929)
[S4] not sending this round → trigger blocked (psi=0.961)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.885490 cos_to_last_merge=0.7800 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.780
[S2] round=45 local utility u=0.101451 metrics={'f1_val': 0.8254920313912745, 'auprc': 0.983471781668759, 'loss_val': 0.45016060882316244, 'psi': 0.8886839315022683}-{'f1_val': 0.8320572088576086, 'auprc': 0.868774843831299, 'loss_val': 0.34836304674733226, 'psi': 0.8467442628470847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=45 head_norm_before_train=2.358550 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9807668776533067, 'auprc': 0.9970117842500793, 'loss_val': 0.051544002393737194, 'psi': 0.9872648402920157}-{'f1_val': 0.9977814963782642, 'auprc': 0.9975711490720289, 'loss_val': 0.016891488010238417, 'psi': 0.9976973574557702}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.608424 cos_to_last_merge=0.9985 (last merge round=38)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.938179511455299, 'auprc': 0.9470809238532071, 'loss_val': 0.3117461989739029, 'psi': 0.9417400764144622}-{'f1_val': 0.9540354796646321, 'auprc': 0.972067632014944, 'loss_val': 0.2822415331855087, 'psi': 0.9612483406047568}
[S5] START round=45 head_norm_before_train=1.349992 cos_to_last_merge=0.9967 (last merge round=38)
[S5] round=45 local utility u=1.000000 metrics={'f1_val': 0.9698207337696795, 'auprc': 0.9907512458695894, 'loss_val': 0.1548653500598059, 'psi': 0.9781929386096434}-{'f1_val': 0.7004938661094564, 'auprc': 0.9179415921613497, 'loss_val': 0.3561321721400474, 'psi': 0.7874729565302138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=45 head_norm_before_train=1.511843 cos_to_last_merge=0.9982 (last merge round=38)
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.9178646910578512, 'auprc': 0.9662683145832744, 'loss_val': 0.25114707532730324, 'psi': 0.9372261404680206}-{'f1_val': 0.6729932707230064, 'auprc': 0.7977953768440524, 'loss_val': 0.6372817993195803, 'psi': 0.7229141131714248}
[S7] START round=45 head_norm_before_train=1.832550 (no previous merge yet)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.8022696097010813, 'auprc': 0.8485444064580032, 'loss_val': 0.29731237769438973, 'psi': 0.8207795284038502}-{'f1_val': 0.9127158603816932, 'auprc': 0.9534180560379191, 'loss_val': 0.22129245886752158, 'psi': 0.9289967386441835}
[S8] START round=45 head_norm_before_train=2.035089 (no previous merge yet)
[S8] round=45 local utility u=0.010390 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.9988436814590964, 'loss_val': 0.03600737821936599, 'psi': 0.9947958568026577}-{'f1_val': 0.9934511917604464, 'auprc': 0.9889055199647094, 'loss_val': 0.035096219127272205, 'psi': 0.9916329230421517}
[S9] START round=45 head_norm_before_train=1.682403 cos_to_last_merge=0.9982 (last merge round=38)
[S9] round=45 local utility u=0.015699 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9956818741959489, 'loss_val': 0.025207287750898703, 'psi': 0.9962690567667144}-{'f1_val': 0.9920653202133933, 'auprc': 0.9980892654656732, 'loss_val': 0.036256437781915, 'psi': 0.9944748983143052}
[S10] START round=45 head_norm_before_train=2.075713 (no previous merge yet)
[S10] round=45 local utility u=0.001189 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9959292304328616, 'loss_val': 0.028212775945603702, 'psi': 0.9953526040921903}-{'f1_val': 0.9950533454418405, 'auprc': 0.9952384356337433, 'loss_val': 0.029030252501253885, 'psi': 0.9951273815186017}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=45 head_norm_before_train=1.658280 cos_to_last_merge=0.9769 (last merge round=31)
[S11] round=45 local utility u=0.000566 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9979424846194156, 'loss_val': 0.036039023313262045, 'psi': 0.9968451148063837}-{'f1_val': 0.9961135349310292, 'auprc': 0.9979944363225709, 'loss_val': 0.03732756865159877, 'psi': 0.9968658954876458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=45 head_norm_before_train=1.569027 cos_to_last_merge=0.8419 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.842
[S13] round=45 local utility u=0.317309 metrics={'f1_val': 0.5707389002459007, 'auprc': 0.6939665234701351, 'loss_val': 0.9589690556042961, 'psi': 0.6200299495355945}-{'f1_val': 0.5565495388659933, 'auprc': 0.5405068932129736, 'loss_val': 1.0480727051768086, 'psi': 0.5501324806047854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=45 head_norm_before_train=2.016510 cos_to_last_merge=0.8029 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.803
[S14] round=45 local utility u=0.000188 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971517945851427, 'loss_val': 0.02342462260706629, 'psi': 0.9970592227286561}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971494582389411, 'loss_val': 0.023794335413516436, 'psi': 0.9970582881901755}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=45 head_norm_before_train=1.492520 cos_to_last_merge=0.9897 (last merge round=38)
[S15] round=45 local utility u=0.427725 metrics={'f1_val': 0.7872830334654324, 'auprc': 0.9881414768321748, 'loss_val': 0.29162627479347963, 'psi': 0.8676264108121294}-{'f1_val': 0.6984351374852946, 'auprc': 0.9329515020564954, 'loss_val': 0.4484188277346412, 'psi': 0.7922416833137749}
[S16] START round=45 head_norm_before_train=1.510870 cos_to_last_merge=0.9981 (last merge round=38)
[S16] round=45 local utility u=0.544120 metrics={'f1_val': 0.9911662550103195, 'auprc': 0.9939552467834476, 'loss_val': 0.0506206150650419, 'psi': 0.9922818517195708}-{'f1_val': 0.8914506951231856, 'auprc': 0.9862483715119416, 'loss_val': 0.5174466407260352, 'psi': 0.929369765678688}
[S17] START round=45 head_norm_before_train=1.654305 cos_to_last_merge=0.9985 (last merge round=39)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6101194171745474, 'auprc': 0.909027014091172, 'loss_val': 0.9604066354612973, 'psi': 0.7296824559411973}-{'f1_val': 0.6255258800903547, 'auprc': 0.9343900415187905, 'loss_val': 0.8574913142658507, 'psi': 0.7490715446617291}
[S7]  timeout peer S14
[S17]  timeout peer S9
[S15]  timeout peer S5
[S6]  timeout peer S4
[S6]  timeout peer S16
[S8]  timeout peer S7
[S9]  timeout peer S17
[S16]  timeout peer S6
[S4]  timeout peer S11
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S2] START round=46 head_norm_before_train=1.891055 cos_to_last_merge=0.7795 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.779
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6737969439258498, 'auprc': 0.7495869306299394, 'loss_val': 1.132807085213321, 'psi': 0.7041129386074856}-{'f1_val': 0.8254920313912745, 'auprc': 0.983471781668759, 'loss_val': 0.45016060882316244, 'psi': 0.8886839315022683}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.369871 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9966650616559571, 'loss_val': 0.12755282707310553, 'psi': 0.975287175325649}-{'f1_val': 0.9807668776533067, 'auprc': 0.9970117842500793, 'loss_val': 0.051544002393737194, 'psi': 0.9872648402920157}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.615425 cos_to_last_merge=0.9982 (last merge round=38)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9364323401359606, 'auprc': 0.9281837048551272, 'loss_val': 0.33674191343013826, 'psi': 0.9331328860236272}-{'f1_val': 0.938179511455299, 'auprc': 0.9470809238532071, 'loss_val': 0.3117461989739029, 'psi': 0.9417400764144622}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.366858 cos_to_last_merge=0.9956 (last merge round=38)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.9191919658280343, 'auprc': 0.9874578733451956, 'loss_val': 0.1786329658415556, 'psi': 0.9464983288348989}-{'f1_val': 0.9698207337696795, 'auprc': 0.9907512458695894, 'loss_val': 0.1548653500598059, 'psi': 0.9781929386096434}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.520288 cos_to_last_merge=0.9977 (last merge round=38)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.8035161116746189, 'auprc': 0.9396272766266835, 'loss_val': 0.48957545436236016, 'psi': 0.8579605776554448}-{'f1_val': 0.9178646910578512, 'auprc': 0.9662683145832744, 'loss_val': 0.25114707532730324, 'psi': 0.9372261404680206}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.842210 (no previous merge yet)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.6314550450423279, 'auprc': 0.7975595885174126, 'loss_val': 0.6297800212473897, 'psi': 0.6978968624323618}-{'f1_val': 0.8022696097010813, 'auprc': 0.8485444064580032, 'loss_val': 0.29731237769438973, 'psi': 0.8207795284038502}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=2.036610 (no previous merge yet)
[S8] round=46 local utility u=0.002861 metrics={'f1_val': 0.9927378939946618, 'auprc': 0.9988105827684888, 'loss_val': 0.034029596453542255, 'psi': 0.9951669695041927}-{'f1_val': 0.9920973070316986, 'auprc': 0.9988436814590964, 'loss_val': 0.03600737821936599, 'psi': 0.9947958568026577}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=46 head_norm_before_train=1.696975 cos_to_last_merge=0.9978 (last merge round=38)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9932162784341079, 'loss_val': 0.02480317314663206, 'psi': 0.995282818461978}-{'f1_val': 0.9966605118138915, 'auprc': 0.9956818741959489, 'loss_val': 0.025207287750898703, 'psi': 0.9962690567667144}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.084505 (no previous merge yet)
[S10] round=46 local utility u=0.000767 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958010042240002, 'loss_val': 0.027612640551535585, 'psi': 0.9954331051012248}-{'f1_val': 0.9949681865317428, 'auprc': 0.9959292304328616, 'loss_val': 0.028212775945603702, 'psi': 0.9953526040921903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=46 head_norm_before_train=1.671270 cos_to_last_merge=0.9757 (last merge round=31)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9975880751343092, 'loss_val': 0.03522673836582148, 'psi': 0.9967033510123411}-{'f1_val': 0.9961135349310292, 'auprc': 0.9979424846194156, 'loss_val': 0.036039023313262045, 'psi': 0.9968451148063837}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.573489 cos_to_last_merge=0.8418 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.842
[S13] round=46 local utility u=0.038416 metrics={'f1_val': 0.5832495204998418, 'auprc': 0.6971599323794514, 'loss_val': 0.9667809351733624, 'psi': 0.6288136852516857}-{'f1_val': 0.5707389002459007, 'auprc': 0.6939665234701351, 'loss_val': 0.9589690556042961, 'psi': 0.6200299495355945}
[S13] not sending this round → trigger blocked (psi=0.629)
[S14] START round=46 head_norm_before_train=2.023805 cos_to_last_merge=0.8025 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.802
[S14] round=46 local utility u=0.001773 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971524493268321, 'loss_val': 0.02380305179519717, 'psi': 0.997451650560645}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971517945851427, 'loss_val': 0.02342462260706629, 'psi': 0.9970592227286561}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=46 head_norm_before_train=1.524419 cos_to_last_merge=0.9878 (last merge round=38)
[S15] round=46 local utility u=0.693293 metrics={'f1_val': 0.9890325064975944, 'auprc': 0.9735785884960915, 'loss_val': 0.07184878445231829, 'psi': 0.9828509392969933}-{'f1_val': 0.7872830334654324, 'auprc': 0.9881414768321748, 'loss_val': 0.29162627479347963, 'psi': 0.8676264108121294}
[S15] not sending this round → trigger blocked (psi=0.983)
[S16] START round=46 head_norm_before_train=1.522641 cos_to_last_merge=0.9977 (last merge round=38)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9133985198284085, 'auprc': 0.9926307633080869, 'loss_val': 0.45945459624779583, 'psi': 0.9450914172202798}-{'f1_val': 0.9911662550103195, 'auprc': 0.9939552467834476, 'loss_val': 0.0506206150650419, 'psi': 0.9922818517195708}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.679499 cos_to_last_merge=0.9976 (last merge round=39)
[S17] round=46 local utility u=0.035443 metrics={'f1_val': 0.6275485891633672, 'auprc': 0.8995516244676905, 'loss_val': 0.9656701790017631, 'psi': 0.7363498032850966}-{'f1_val': 0.6101194171745474, 'auprc': 0.909027014091172, 'loss_val': 0.9604066354612973, 'psi': 0.7296824559411973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=47 head_norm_before_train=1.895686 cos_to_last_merge=0.7791 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.779
[S2] round=47 local utility u=0.679133 metrics={'f1_val': 0.800402012799041, 'auprc': 0.7533492364620795, 'loss_val': 0.5454586651483284, 'psi': 0.7815809022642564}-{'f1_val': 0.6737969439258498, 'auprc': 0.7495869306299394, 'loss_val': 1.132807085213321, 'psi': 0.7041129386074856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=47 head_norm_before_train=2.374727 (no previous merge yet)
[S3] round=47 local utility u=0.162110 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9966792182735261, 'loss_val': 0.021552411443929664, 'psi': 0.9971106287770449}-{'f1_val': 0.9610352511054436, 'auprc': 0.9966650616559571, 'loss_val': 0.12755282707310553, 'psi': 0.975287175325649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=47 head_norm_before_train=1.626132 cos_to_last_merge=0.9978 (last merge round=38)
[S4] round=47 local utility u=0.078386 metrics={'f1_val': 0.943059561292078, 'auprc': 0.9541300177271681, 'loss_val': 0.2975718425972251, 'psi': 0.947487743866114}-{'f1_val': 0.9364323401359606, 'auprc': 0.9281837048551272, 'loss_val': 0.33674191343013826, 'psi': 0.9331328860236272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=47 head_norm_before_train=1.386952 cos_to_last_merge=0.9939 (last merge round=38)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.700492413045297, 'auprc': 0.9815788026537698, 'loss_val': 0.3280907527349482, 'psi': 0.8129269688886861}-{'f1_val': 0.9191919658280343, 'auprc': 0.9874578733451956, 'loss_val': 0.1786329658415556, 'psi': 0.9464983288348989}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.527420 cos_to_last_merge=0.9972 (last merge round=38)
[S6] round=47 local utility u=0.575994 metrics={'f1_val': 0.9363364550396667, 'auprc': 0.969471485410552, 'loss_val': 0.22404133666883116, 'psi': 0.9495904671880209}-{'f1_val': 0.8035161116746189, 'auprc': 0.9396272766266835, 'loss_val': 0.48957545436236016, 'psi': 0.8579605776554448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=47 head_norm_before_train=1.851535 (no previous merge yet)
[S7] round=47 local utility u=0.112886 metrics={'f1_val': 0.6423780758719694, 'auprc': 0.8054001451607806, 'loss_val': 0.4930678865569816, 'psi': 0.7075869035874939}-{'f1_val': 0.6314550450423279, 'auprc': 0.7975595885174126, 'loss_val': 0.6297800212473897, 'psi': 0.6978968624323618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=47 head_norm_before_train=2.041441 (no previous merge yet)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9931648515513533, 'auprc': 0.9880537964049019, 'loss_val': 0.03554128275303205, 'psi': 0.9911204294927727}-{'f1_val': 0.9927378939946618, 'auprc': 0.9988105827684888, 'loss_val': 0.034029596453542255, 'psi': 0.9951669695041927}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.711432 cos_to_last_merge=0.9972 (last merge round=38)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9888602739236441, 'auprc': 0.9984760938399126, 'loss_val': 0.043661324379938145, 'psi': 0.9927066018901516}-{'f1_val': 0.9966605118138915, 'auprc': 0.9932162784341079, 'loss_val': 0.02480317314663206, 'psi': 0.995282818461978}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.093836 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957196031881764, 'loss_val': 0.02758176175042954, 'psi': 0.9954005446868954}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958010042240002, 'loss_val': 0.027612640551535585, 'psi': 0.9954331051012248}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.682855 cos_to_last_merge=0.9747 (last merge round=31)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9956519930682886, 'auprc': 0.998022478353212, 'loss_val': 0.034887299649181476, 'psi': 0.996600187182258}-{'f1_val': 0.9961135349310292, 'auprc': 0.9975880751343092, 'loss_val': 0.03522673836582148, 'psi': 0.9967033510123411}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.577771 cos_to_last_merge=0.8418 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.842
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.5687472002082451, 'auprc': 0.6981394479874066, 'loss_val': 0.9356033801053681, 'psi': 0.6205040993199097}-{'f1_val': 0.5832495204998418, 'auprc': 0.6971599323794514, 'loss_val': 0.9667809351733624, 'psi': 0.6288136852516857}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.031391 cos_to_last_merge=0.8020 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.802
[S14] round=47 local utility u=0.000118 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971532846528632, 'loss_val': 0.02110468674291711, 'psi': 0.9972055278846211}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971524493268321, 'loss_val': 0.02380305179519717, 'psi': 0.997451650560645}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=47 head_norm_before_train=1.554136 cos_to_last_merge=0.9859 (last merge round=38)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.8269419481827601, 'auprc': 0.9708052403222768, 'loss_val': 0.3121585467095992, 'psi': 0.8844872650385668}-{'f1_val': 0.9890325064975944, 'auprc': 0.9735785884960915, 'loss_val': 0.07184878445231829, 'psi': 0.9828509392969933}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.533671 cos_to_last_merge=0.9973 (last merge round=38)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.8358735789703386, 'auprc': 0.8882072552275838, 'loss_val': 1.0600959485687458, 'psi': 0.8568070494732367}-{'f1_val': 0.9133985198284085, 'auprc': 0.9926307633080869, 'loss_val': 0.45945459624779583, 'psi': 0.9450914172202798}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.703171 cos_to_last_merge=0.9965 (last merge round=39)
[S17] round=47 local utility u=0.060784 metrics={'f1_val': 0.6394084047585133, 'auprc': 0.9152698903402772, 'loss_val': 0.9624165515266168, 'psi': 0.7497529989912188}-{'f1_val': 0.6275485891633672, 'auprc': 0.8995516244676905, 'loss_val': 0.9656701790017631, 'psi': 0.7363498032850966}
[S17] not sending this round → trigger blocked (psi=0.750)
[S2] START round=48 head_norm_before_train=1.903951 cos_to_last_merge=0.7785 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.779
[S2] round=48 local utility u=0.167720 metrics={'f1_val': 0.8303271820456994, 'auprc': 0.7721148725741074, 'loss_val': 0.4458665179443173, 'psi': 0.8070422582570627}-{'f1_val': 0.800402012799041, 'auprc': 0.7533492364620795, 'loss_val': 0.5454586651483284, 'psi': 0.7815809022642564}
[S2] not sending this round → trigger blocked (psi=0.807)
[S3] START round=48 head_norm_before_train=2.380292 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9969124130211536, 'loss_val': 0.09862346589406364, 'psi': 0.975664253372413}-{'f1_val': 0.9973982357793907, 'auprc': 0.9966792182735261, 'loss_val': 0.021552411443929664, 'psi': 0.9971106287770449}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.635423 cos_to_last_merge=0.9974 (last merge round=38)
[S4] round=48 local utility u=0.015875 metrics={'f1_val': 0.9527647913161634, 'auprc': 0.9421716882409358, 'loss_val': 0.28817908732442254, 'psi': 0.9485275500860724}-{'f1_val': 0.943059561292078, 'auprc': 0.9541300177271681, 'loss_val': 0.2975718425972251, 'psi': 0.947487743866114}
[S4] not sending this round → trigger blocked (psi=0.949)
[S5] START round=48 head_norm_before_train=1.406494 cos_to_last_merge=0.9919 (last merge round=38)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.5294601614203447, 'auprc': 0.8532466150019625, 'loss_val': 0.7897394087916129, 'psi': 0.6589747428529918}-{'f1_val': 0.700492413045297, 'auprc': 0.9815788026537698, 'loss_val': 0.3280907527349482, 'psi': 0.8129269688886861}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.539883 cos_to_last_merge=0.9965 (last merge round=38)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.5966549803958248, 'auprc': 0.8783764933217226, 'loss_val': 0.8029072159174974, 'psi': 0.7093435855661839}-{'f1_val': 0.9363364550396667, 'auprc': 0.969471485410552, 'loss_val': 0.22404133666883116, 'psi': 0.9495904671880209}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.856799 (no previous merge yet)
[S7] round=48 local utility u=0.040316 metrics={'f1_val': 0.6502719732499392, 'auprc': 0.8074550403698744, 'loss_val': 0.46596392778999546, 'psi': 0.7131452000979133}-{'f1_val': 0.6423780758719694, 'auprc': 0.8054001451607806, 'loss_val': 0.4930678865569816, 'psi': 0.7075869035874939}
[S7] not sending this round → trigger blocked (psi=0.713)
[S8] START round=48 head_norm_before_train=2.045635 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9852959365610916, 'auprc': 0.9986106779070894, 'loss_val': 0.05263095544863092, 'psi': 0.9906218330994907}-{'f1_val': 0.9931648515513533, 'auprc': 0.9880537964049019, 'loss_val': 0.03554128275303205, 'psi': 0.9911204294927727}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.724244 cos_to_last_merge=0.9968 (last merge round=38)
[S9] round=48 local utility u=0.023524 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9931860168104506, 'loss_val': 0.02508108315629209, 'psi': 0.9950244635917468}-{'f1_val': 0.9888602739236441, 'auprc': 0.9984760938399126, 'loss_val': 0.043661324379938145, 'psi': 0.9927066018901516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=48 head_norm_before_train=2.103501 (no previous merge yet)
[S10] round=48 local utility u=0.000016 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957214578435234, 'loss_val': 0.027554747954265595, 'psi': 0.9954012865490343}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957196031881764, 'loss_val': 0.02758176175042954, 'psi': 0.9954005446868954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=48 head_norm_before_train=1.694609 cos_to_last_merge=0.9735 (last merge round=31)
[S11] round=48 local utility u=0.002355 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9979479134693747, 'loss_val': 0.032723193732339936, 'psi': 0.9968472863463673}-{'f1_val': 0.9956519930682886, 'auprc': 0.998022478353212, 'loss_val': 0.034887299649181476, 'psi': 0.996600187182258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=48 head_norm_before_train=1.578917 cos_to_last_merge=0.8427 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.843
[S13] round=48 local utility u=0.043342 metrics={'f1_val': 0.5839640595231013, 'auprc': 0.6976621480729857, 'loss_val': 0.9387890084882982, 'psi': 0.6294432949430551}-{'f1_val': 0.5687472002082451, 'auprc': 0.6981394479874066, 'loss_val': 0.9356033801053681, 'psi': 0.6205040993199097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] sending update (kind=head size=1808 to 1 peers)
[S14] START round=48 head_norm_before_train=2.040868 cos_to_last_merge=0.8014 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.801
[S14] round=48 local utility u=0.000206 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971529636011887, 'loss_val': 0.02069144293929451, 'psi': 0.9972053994639514}-{'f1_val': 0.997240356705793, 'auprc': 0.9971532846528632, 'loss_val': 0.02110468674291711, 'psi': 0.9972055278846211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=48 head_norm_before_train=1.578877 cos_to_last_merge=0.9844 (last merge round=38)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.7567206471206688, 'auprc': 0.9803158677201607, 'loss_val': 0.430862467981897, 'psi': 0.8461587353604655}-{'f1_val': 0.8269419481827601, 'auprc': 0.9708052403222768, 'loss_val': 0.3121585467095992, 'psi': 0.8844872650385668}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.544654 cos_to_last_merge=0.9970 (last merge round=38)
[S16] round=48 local utility u=0.616285 metrics={'f1_val': 0.8760086826744837, 'auprc': 0.9920776390741908, 'loss_val': 0.37994690087140087, 'psi': 0.9224362652343666}-{'f1_val': 0.8358735789703386, 'auprc': 0.8882072552275838, 'loss_val': 1.0600959485687458, 'psi': 0.8568070494732367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=48 head_norm_before_train=1.723414 cos_to_last_merge=0.9956 (last merge round=39)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.61294008287502, 'auprc': 0.8619270216311928, 'loss_val': 1.1005796529902447, 'psi': 0.7125348583774891}-{'f1_val': 0.6394084047585133, 'auprc': 0.9152698903402772, 'loss_val': 0.9624165515266168, 'psi': 0.7497529989912188}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.911731 cos_to_last_merge=0.7778 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.778
[S2] round=49 local utility u=0.093229 metrics={'f1_val': 0.8274164050585436, 'auprc': 0.8503458156920747, 'loss_val': 0.47663763672026405, 'psi': 0.8365881693119561}-{'f1_val': 0.8303271820456994, 'auprc': 0.7721148725741074, 'loss_val': 0.4458665179443173, 'psi': 0.8070422582570627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=49 head_norm_before_train=2.387913 (no previous merge yet)
[S3] round=49 local utility u=0.148983 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9969586137772637, 'loss_val': 0.01619318911013893, 'psi': 0.9972223869785399}-{'f1_val': 0.961498813606586, 'auprc': 0.9969124130211536, 'loss_val': 0.09862346589406364, 'psi': 0.975664253372413}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=49 head_norm_before_train=1.641154 cos_to_last_merge=0.9972 (last merge round=38)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.938024008352904, 'auprc': 0.9424043626283913, 'loss_val': 0.33463343406099844, 'psi': 0.939776150063099}-{'f1_val': 0.9527647913161634, 'auprc': 0.9421716882409358, 'loss_val': 0.28817908732442254, 'psi': 0.9485275500860724}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.422629 cos_to_last_merge=0.9903 (last merge round=38)
[S5] round=49 local utility u=1.000000 metrics={'f1_val': 0.9223490747021487, 'auprc': 0.9891268288120568, 'loss_val': 0.15831002222882384, 'psi': 0.949060176346112}-{'f1_val': 0.5294601614203447, 'auprc': 0.8532466150019625, 'loss_val': 0.7897394087916129, 'psi': 0.6589747428529918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=49 head_norm_before_train=1.553761 cos_to_last_merge=0.9958 (last merge round=38)
[S6] round=49 local utility u=1.000000 metrics={'f1_val': 0.835534458323486, 'auprc': 0.9578488061895141, 'loss_val': 0.33650727293841703, 'psi': 0.8844601974698972}-{'f1_val': 0.5966549803958248, 'auprc': 0.8783764933217226, 'loss_val': 0.8029072159174974, 'psi': 0.7093435855661839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=49 head_norm_before_train=1.861929 (no previous merge yet)
[S7] round=49 local utility u=0.017120 metrics={'f1_val': 0.6541181310239009, 'auprc': 0.8074247775836901, 'loss_val': 0.4547095596017596, 'psi': 0.7154407896478165}-{'f1_val': 0.6502719732499392, 'auprc': 0.8074550403698744, 'loss_val': 0.46596392778999546, 'psi': 0.7131452000979133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=49 head_norm_before_train=2.051022 (no previous merge yet)
[S8] round=49 local utility u=0.027327 metrics={'f1_val': 0.9937260093124592, 'auprc': 0.9931913176787555, 'loss_val': 0.0322999075041979, 'psi': 0.9935121326589778}-{'f1_val': 0.9852959365610916, 'auprc': 0.9986106779070894, 'loss_val': 0.05263095544863092, 'psi': 0.9906218330994907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=49 head_norm_before_train=1.736178 cos_to_last_merge=0.9964 (last merge round=38)
[S9] round=49 local utility u=0.005563 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9980655584926205, 'loss_val': 0.0260527556123822, 'psi': 0.9967222544155594}-{'f1_val': 0.9962500947792776, 'auprc': 0.9931860168104506, 'loss_val': 0.02508108315629209, 'psi': 0.9950244635917468}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=49 head_norm_before_train=2.110455 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9957752673561608, 'loss_val': 0.027516721512064513, 'psi': 0.9952910188615101}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957214578435234, 'loss_val': 0.027554747954265595, 'psi': 0.9954012865490343}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.705136 cos_to_last_merge=0.9725 (last merge round=31)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9970111297434135, 'loss_val': 0.03316086032219526, 'psi': 0.9963274710409772}-{'f1_val': 0.9961135349310292, 'auprc': 0.9979479134693747, 'loss_val': 0.032723193732339936, 'psi': 0.9968472863463673}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.584419 cos_to_last_merge=0.8418 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.842
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5767363414726563, 'auprc': 0.7034108780086614, 'loss_val': 1.022051489033462, 'psi': 0.6274061560870583}-{'f1_val': 0.5839640595231013, 'auprc': 0.6976621480729857, 'loss_val': 0.9387890084882982, 'psi': 0.6294432949430551}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=2.051180 cos_to_last_merge=0.8006 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.801
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971547762351012, 'loss_val': 0.02210315825485366, 'psi': 0.9970604153886395}-{'f1_val': 0.997240356705793, 'auprc': 0.9971529636011887, 'loss_val': 0.02069144293929451, 'psi': 0.9972053994639514}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.601446 cos_to_last_merge=0.9829 (last merge round=38)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6990122587105905, 'auprc': 0.9908079612359437, 'loss_val': 0.4462620459867437, 'psi': 0.8157305397207317}-{'f1_val': 0.7567206471206688, 'auprc': 0.9803158677201607, 'loss_val': 0.430862467981897, 'psi': 0.8461587353604655}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.554160 cos_to_last_merge=0.9967 (last merge round=38)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.8113330740848017, 'auprc': 0.9413201748432265, 'loss_val': 0.7732143584344506, 'psi': 0.8633279143881716}-{'f1_val': 0.8760086826744837, 'auprc': 0.9920776390741908, 'loss_val': 0.37994690087140087, 'psi': 0.9224362652343666}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.742846 cos_to_last_merge=0.9946 (last merge round=39)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6256513150861328, 'auprc': 0.8292177878146305, 'loss_val': 1.0863952282101086, 'psi': 0.7070779041775319}-{'f1_val': 0.61294008287502, 'auprc': 0.8619270216311928, 'loss_val': 1.1005796529902447, 'psi': 0.7125348583774891}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
