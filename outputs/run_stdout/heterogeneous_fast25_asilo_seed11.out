[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:38503
[S3] → join 127.0.0.1:38502
[S4] → join 127.0.0.1:38502
[S5] → join 127.0.0.1:38502
[S6] → join 127.0.0.1:38502
[S7] → join 127.0.0.1:38502
[S8] → join 127.0.0.1:38502
[S9] → join 127.0.0.1:38502
[S10] → join 127.0.0.1:38502
[S11] → join 127.0.0.1:38502
[S13] → join 127.0.0.1:38502
[S14] → join 127.0.0.1:38502
[S15] → join 127.0.0.1:38502
[S16] → join 127.0.0.1:38502
[S17] → join 127.0.0.1:38502
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.102816 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.175515 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.172067 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.164911 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.210530 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.193505 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.176670 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.242339 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.177992 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.138841 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.142929 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.160078 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.206191 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.152537 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.138960 (no previous merge yet)
[S2]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S4] + discovered S2
[S3] + discovered S17
[S3] + discovered S10
[S3] + discovered S9
[S3] + discovered S8
[S3] + discovered S16
[S3] + discovered S4
[S3] + discovered S6
[S3] + discovered S7
[S3] + discovered S11
[S3] + discovered S14
[S3] + discovered S5
[S3] + discovered S15
[S3] + discovered S13
[S4] + discovered S3
[S4] + discovered S10
[S4] + discovered S9
[S4] + discovered S17
[S4] + discovered S16
[S4] + discovered S8
[S4] + discovered S7
[S4] + discovered S14
[S4] + discovered S5
[S4] + discovered S11
[S5] + discovered S2
[S4] + discovered S15
[S4] + discovered S13
[S5] + discovered S3
[S4] + discovered S6
[S5] + discovered S4
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S3
[S6] + discovered S2
[S5] + discovered S14
[S5] + discovered S8
[S5] + discovered S7
[S5] + discovered S17
[S5] + discovered S10
[S5] + discovered S13
[S5] + discovered S15
[S5] + discovered S11
[S5] + discovered S6
[S5] + discovered S16
[S5] + discovered S9
[S6] + discovered S9
[S6] + discovered S15
[S6] + discovered S13
[S6] + discovered S14
[S6] + discovered S16
[S6] + discovered S11
[S6] + discovered S10
[S6] + discovered S17
[S6] + discovered S7
[S6] + discovered S8
[S7] + discovered S4
[S7] + discovered S6
[S7] + discovered S3
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S15
[S7] + discovered S17
[S7] + discovered S10
[S7] + discovered S8
[S7] + discovered S11
[S7] + discovered S16
[S7] + discovered S14
[S7] + discovered S13
[S7] + discovered S9
[S8] + discovered S7
[S8] + discovered S3
[S8] + discovered S2
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S4
[S9] + discovered S6
[S9] + discovered S8
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S4
[S9] + discovered S5
[S9] + discovered S2
[S8] + discovered S9
[S8] + discovered S10
[S8] + discovered S14
[S8] + discovered S16
[S8] + discovered S13
[S8] + discovered S11
[S8] + discovered S17
[S8] + discovered S15
[S9] + discovered S17
[S9] + discovered S15
[S9] + discovered S11
[S9] + discovered S14
[S9] + discovered S16
[S9] + discovered S10
[S9] + discovered S13
[S10] + discovered S7
[S10] + discovered S2
[S10] + discovered S5
[S10] + discovered S3
[S10] + discovered S8
[S10] + discovered S6
[S10] + discovered S4
[S10] + discovered S9
[S11] + discovered S9
[S11] + discovered S5
[S11] + discovered S6
[S11] + discovered S8
[S11] + discovered S2
[S11] + discovered S4
[S11] + discovered S10
[S11] + discovered S3
[S11] + discovered S7
[S10] + discovered S14
[S10] + discovered S11
[S10] + discovered S17
[S10] + discovered S13
[S10] + discovered S16
[S10] + discovered S15
[S11] + discovered S15
[S11] + discovered S16
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S14
[S13] + discovered S8
[S13] + discovered S4
[S13] + discovered S2
[S13] + discovered S6
[S13] + discovered S9
[S13] + discovered S7
[S13] + discovered S3
[S13] + discovered S10
[S13] + discovered S11
[S13] + discovered S5
[S14] + discovered S9
[S14] + discovered S8
[S13] + discovered S17
[S13] + discovered S15
[S14] + discovered S13
[S14] + discovered S2
[S14] + discovered S11
[S14] + discovered S6
[S14] + discovered S5
[S14] + discovered S4
[S13] + discovered S14
[S14] + discovered S10
[S13] + discovered S16
[S14] + discovered S3
[S14] + discovered S7
[S14] + discovered S17
[S14] + discovered S16
[S14] + discovered S15
[S15] + discovered S8
[S15] + discovered S3
[S15] + discovered S11
[S15] + discovered S13
[S15] + discovered S7
[S15] + discovered S2
[S15] + discovered S6
[S15] + discovered S9
[S15] + discovered S14
[S15] + discovered S4
[S15] + discovered S10
[S15] + discovered S5
[S16] + discovered S14
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S3
[S16] + discovered S13
[S16] + discovered S10
[S16] + discovered S9
[S16] + discovered S2
[S16] + discovered S5
[S16] + discovered S11
[S16] + discovered S7
[S16] + discovered S6
[S16] + discovered S4
[S16] + discovered S15
[S16] + discovered S8
[S16] + discovered S17
[S17] + discovered S3
[S17] + discovered S9
[S17] + discovered S2
[S17] + discovered S10
[S17] + discovered S7
[S17] + discovered S4
[S17] + discovered S8
[S17] + discovered S13
[S17] + discovered S6
[S17] + discovered S5
[S17] + discovered S11
[S17] + discovered S15
[S17] + discovered S16
[S17] + discovered S14
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=1.000 → S5@127.0.0.1:38505
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:38505
[S11] ⇄ pheromone p=1.000 → S14@127.0.0.1:38514
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:38507
[S8] ⇄ pheromone p=1.000 → S7@127.0.0.1:38508
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:38516
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:38512
[S6] ⇄ pheromone p=1.000 → S9@127.0.0.1:38510
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:38514
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:38512
[S2] ⇄ pheromone p=1.000 → S5@127.0.0.1:38505
[S10] ⇄ pheromone p=1.000 → S13@127.0.0.1:38513
[S9] ⇄ pheromone p=1.000 → S6@127.0.0.1:38507
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:38511
[S17] ⇄ pheromone p=1.000 → S9@127.0.0.1:38510
[S2] START round=1 head_norm_before_train=1.103415 (no previous merge yet)
[S2] round=1 local utility u=0.184120 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.5468388182277352, 'loss_val': 1.3371308748943074, 'psi': 0.3038018073242341}-{'f1_val': 0.13151146134577135, 'auprc': 0.4564807845097199, 'loss_val': 1.3727021276239073, 'psi': 0.26149919061135074}
[S3] START round=1 head_norm_before_train=1.190110 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8468956574104982, 'loss_val': 1.2648919696351888, 'psi': 0.42266230233266355}-{'f1_val': 0.40071406678232513, 'auprc': 0.860583635610588, 'loss_val': 1.3381848009223163, 'psi': 0.5846618943136304}
[S4] START round=1 head_norm_before_train=1.180892 (no previous merge yet)
[S4] round=1 local utility u=0.045069 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7778258272327067, 'loss_val': 1.314032285866056, 'psi': 0.39526630823019315}-{'f1_val': 0.14022662889518414, 'auprc': 0.7594525239245157, 'loss_val': 1.3490500523391589, 'psi': 0.3879169869069168}
[S5] START round=1 head_norm_before_train=1.169184 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7553503688196745, 'loss_val': 1.2788085235240478, 'psi': 0.3874972903850127}-{'f1_val': 0.4173865207428088, 'auprc': 0.5889987251811404, 'loss_val': 1.3494171003956736, 'psi': 0.4860314025181414}
[S6] START round=1 head_norm_before_train=1.216842 (no previous merge yet)
[S6] round=1 local utility u=0.314098 metrics={'f1_val': 0.10398230088495575, 'auprc': 0.8788120432863952, 'loss_val': 1.3405420931460141, 'psi': 0.4139141978455315}-{'f1_val': 0.10398230088495575, 'auprc': 0.681082939456848, 'loss_val': 1.3755504691633162, 'psi': 0.3348225563137126}
[S7] START round=1 head_norm_before_train=1.195696 (no previous merge yet)
[S7] round=1 local utility u=0.043921 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7800040500766409, 'loss_val': 1.2826094205568082, 'psi': 0.39723571366811133}-{'f1_val': 0.14205682272909165, 'auprc': 0.768417572280054, 'loss_val': 1.3356920046413998, 'psi': 0.3926011225494766}
[S8] START round=1 head_norm_before_train=1.187797 (no previous merge yet)
[S8] round=1 local utility u=0.018225 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.45386321003575153, 'loss_val': 1.311679726971001, 'psi': 0.2655188734500749}-{'f1_val': 0.13995598239295717, 'auprc': 0.45252153010418233, 'loss_val': 1.344104652615452, 'psi': 0.2649822014774473}
[S9] START round=1 head_norm_before_train=1.248703 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8655408768563243, 'loss_val': 1.257382016082337, 'psi': 0.4310551250265274}-{'f1_val': 0.33224352015638986, 'auprc': 0.6318363907034725, 'loss_val': 1.34610442507155, 'psi': 0.4520806683752229}
[S10] START round=1 head_norm_before_train=1.182606 (no previous merge yet)
[S10] round=1 local utility u=0.869110 metrics={'f1_val': 0.3872771875330909, 'auprc': 0.7763546128464821, 'loss_val': 1.3311863076041228, 'psi': 0.5429081576584474}-{'f1_val': 0.103250345114341, 'auprc': 0.7759578326001793, 'loss_val': 1.3640545430492295, 'psi': 0.3723333401086763}
[S11] START round=1 head_norm_before_train=1.146841 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7061069722716602, 'loss_val': 1.3012888992513443, 'psi': 0.36669099893253043}-{'f1_val': 0.14041368337311058, 'auprc': 0.7241148341987462, 'loss_val': 1.3325680433517066, 'psi': 0.3738941437033648}
[S13] START round=1 head_norm_before_train=1.146889 (no previous merge yet)
[S13] round=1 local utility u=0.538171 metrics={'f1_val': 0.24683092371576215, 'auprc': 0.5050896843080837, 'loss_val': 1.3278200564351847, 'psi': 0.3501344279526908}-{'f1_val': 0.09149524746194926, 'auprc': 0.4690436099809089, 'loss_val': 1.3640104442913015, 'psi': 0.24251459246953314}
[S14] START round=1 head_norm_before_train=1.157837 (no previous merge yet)
[S14] round=1 local utility u=0.419837 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5418274226456127, 'loss_val': 1.3475276179307545, 'psi': 0.3009456807878673}-{'f1_val': 0.14035785288270378, 'auprc': 0.26966738663033796, 'loss_val': 1.3707212103674693, 'psi': 0.19208166638175744}
[S15] START round=1 head_norm_before_train=1.204224 (no previous merge yet)
[S15] round=1 local utility u=0.771383 metrics={'f1_val': 0.5705269950852018, 'auprc': 0.6957798045900299, 'loss_val': 1.3380433814785537, 'psi': 0.620628118887133}-{'f1_val': 0.3751864077669903, 'auprc': 0.5824775180207116, 'loss_val': 1.368858797105091, 'psi': 0.4581028518684788}
[S16] START round=1 head_norm_before_train=1.153350 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8293695196913701, 'loss_val': 1.3273388187428983, 'psi': 0.41613027799606994}-{'f1_val': 0.434530051358917, 'auprc': 0.6509006473154556, 'loss_val': 1.361135038107568, 'psi': 0.5210782897415325}
[S17] START round=1 head_norm_before_train=1.140808 (no previous merge yet)
[S17] round=1 local utility u=0.287227 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6558662740293179, 'loss_val': 1.351039564335281, 'psi': 0.3469158876021578}-{'f1_val': 0.14094896331738438, 'auprc': 0.47142911221158573, 'loss_val': 1.3721830622170834, 'psi': 0.2731410228750649}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:38513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:38503
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S4] → sending delta(kind=head bytes=1787) to S16@127.0.0.1:38516
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S15] → sending delta(kind=head bytes=1783) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:38517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:38510
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S6] → sending delta(kind=head bytes=1787) to S14@127.0.0.1:38514
[S13] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1783 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1787 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1787 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1783) from S15
[S16] cosine check vs S15: cos=-0.0193
[S16] DROPPED delta from S15 (cos=-0.0193 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1787) from S6
[S14] cosine check vs S6: cos=-0.0858
[S14] DROPPED delta from S6 (cos=-0.0858 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S13
[S6] cosine check vs S13: cos=0.0171
[S6] RECEIVED delta(kind=head bytes=1791) from S10
[S6] cosine check vs S10: cos=0.0278
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] cosine check vs S8: cos=-0.0117
[S9] DROPPED delta from S8 (cos=-0.0117 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1792) from S2
[S3] cosine check vs S2: cos=0.0687
[S17] RECEIVED delta(kind=head bytes=1791) from S7
[S17] cosine check vs S7: cos=-0.0094
[S17] DROPPED delta from S7 (cos=-0.0094 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1792) from S14
[S13] cosine check vs S14: cos=-0.0540
[S13] DROPPED delta from S14 (cos=-0.0540 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1787) from S4
[S16] cosine check vs S4: cos=-0.0097
[S16] DROPPED delta from S4 (cos=-0.0097 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:38504
[S17] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S17
[S4] cosine check vs S17: cos=0.0468
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=1 metric=0.1398 head_norm=1.232720
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.019664e-01
[S3] stored merged vector for next round verification (round=1)
[S3] DEBUG after merge:  round=1 metric=0.1398 head_norm=0.858775 delta_norm=0.801966
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1402 head_norm=1.198844
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.109667e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1402 head_norm=0.849839 delta_norm=0.810967
[S4] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1040 head_norm=1.228943
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.353494e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.3555 head_norm=0.757185 delta_norm=0.735349
[S6] aggregate: ACCEPT kept=['S13', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.114312 (no previous merge yet)
[S2] round=2 local utility u=0.073184 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.5804379206487834, 'loss_val': 1.2915592835297631, 'psi': 0.3172414482926534}-{'f1_val': 0.1417771333885667, 'auprc': 0.5468388182277352, 'loss_val': 1.3371308748943074, 'psi': 0.3038018073242341}
[S3] START round=2 head_norm_before_train=0.858775 cos_to_last_merge=1.0000 (last merge round=1)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.5992114374374494, 'loss_val': 1.2216164385865185, 'psi': 0.323588614343444}-{'f1_val': 0.13984006561410703, 'auprc': 0.8468956574104982, 'loss_val': 1.2648919696351888, 'psi': 0.42266230233266355}
[S4] START round=2 head_norm_before_train=0.849839 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7732343863633885, 'loss_val': 1.3207053783480973, 'psi': 0.3934297318824659}-{'f1_val': 0.14022662889518414, 'auprc': 0.7778258272327067, 'loss_val': 1.314032285866056, 'psi': 0.39526630823019315}
[S5] START round=2 head_norm_before_train=1.199814 (no previous merge yet)
[S5] round=2 local utility u=0.044241 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7466707445773583, 'loss_val': 1.1642884656529864, 'psi': 0.3840254406880862}-{'f1_val': 0.14226190476190476, 'auprc': 0.7553503688196745, 'loss_val': 1.2788085235240478, 'psi': 0.3874972903850127}
[S6] START round=2 head_norm_before_train=0.757185 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.914724 metrics={'f1_val': 0.4143622864039477, 'auprc': 0.8624195834701546, 'loss_val': 1.3241969799589823, 'psi': 0.5935852052304305}-{'f1_val': 0.10398230088495575, 'auprc': 0.8788120432863952, 'loss_val': 1.3405420931460141, 'psi': 0.4139141978455315}
[S7] START round=2 head_norm_before_train=1.225400 (no previous merge yet)
[S7] round=2 local utility u=0.041920 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7881083882116632, 'loss_val': 1.2230831659081773, 'psi': 0.4004774489221203}-{'f1_val': 0.14205682272909165, 'auprc': 0.7800040500766409, 'loss_val': 1.2826094205568082, 'psi': 0.39723571366811133}
[S8] START round=2 head_norm_before_train=1.204095 (no previous merge yet)
[S8] round=2 local utility u=0.123645 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.5232543013521556, 'loss_val': 1.2725636629293204, 'psi': 0.29327530997663653}-{'f1_val': 0.13995598239295717, 'auprc': 0.45386321003575153, 'loss_val': 1.311679726971001, 'psi': 0.2655188734500749}
[S9] START round=2 head_norm_before_train=1.284900 (no previous merge yet)
[S9] round=2 local utility u=0.060210 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8657533688717534, 'loss_val': 1.1375996548138014, 'psi': 0.43114012183269895}-{'f1_val': 0.141397957139996, 'auprc': 0.8655408768563243, 'loss_val': 1.257382016082337, 'psi': 0.4310551250265274}
[S10] START round=2 head_norm_before_train=1.197497 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7773549587390918, 'loss_val': 1.2923444483384539, 'psi': 0.3941149660206711}-{'f1_val': 0.3872771875330909, 'auprc': 0.7763546128464821, 'loss_val': 1.3311863076041228, 'psi': 0.5429081576584474}
[S11] START round=2 head_norm_before_train=1.161805 (no previous merge yet)
[S11] round=2 local utility u=0.263791 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8702841137950103, 'loss_val': 1.2662374215726597, 'psi': 0.43236185554187045}-{'f1_val': 0.14041368337311058, 'auprc': 0.7061069722716602, 'loss_val': 1.3012888992513443, 'psi': 0.36669099893253043}
[S13] START round=2 head_norm_before_train=1.160875 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5411270672744426, 'loss_val': 1.2844259819483197, 'psi': 0.3006822844560089}-{'f1_val': 0.24683092371576215, 'auprc': 0.5050896843080837, 'loss_val': 1.3278200564351847, 'psi': 0.3501344279526908}
[S14] START round=2 head_norm_before_train=1.164198 (no previous merge yet)
[S14] round=2 local utility u=0.300498 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7339998171678637, 'loss_val': 1.323048518871207, 'psi': 0.3778146385967677}-{'f1_val': 0.14035785288270378, 'auprc': 0.5418274226456127, 'loss_val': 1.3475276179307545, 'psi': 0.3009456807878673}
[S15] START round=2 head_norm_before_train=1.213201 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7761186550694605, 'loss_val': 1.3041366778867292, 'psi': 0.3942876528447192}-{'f1_val': 0.5705269950852018, 'auprc': 0.6957798045900299, 'loss_val': 1.3380433814785537, 'psi': 0.620628118887133}
[S16] START round=2 head_norm_before_train=1.164905 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8086086883250813, 'loss_val': 1.2901771202499632, 'psi': 0.4078259454495544}-{'f1_val': 0.14063745019920318, 'auprc': 0.8293695196913701, 'loss_val': 1.3273388187428983, 'psi': 0.41613027799606994}
[S17] START round=2 head_norm_before_train=1.150026 (no previous merge yet)
[S17] round=2 local utility u=0.066693 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6911597380973536, 'loss_val': 1.3235332200079197, 'psi': 0.3610332732293721}-{'f1_val': 0.14094896331738438, 'auprc': 0.6558662740293179, 'loss_val': 1.351039564335281, 'psi': 0.3469158876021578}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:38508
[S14] not sending this round → trigger blocked (psi=0.378)
[S8] not sending this round → trigger blocked (psi=0.293)
[S2] not sending this round → trigger blocked (psi=0.317)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:38502
[S7] not sending this round → trigger blocked (psi=0.400)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:38504
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.594)
[S11] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1789 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1791) from S11
[S4] cosine check vs S11: cos=0.0478
[S7] RECEIVED delta(kind=head bytes=1789) from S9
[S7] cosine check vs S9: cos=-0.1290
[S7] DROPPED delta from S9 (cos=-0.1290 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1790) from S5
[S2] cosine check vs S5: cos=0.0833
[S17] not sending this round → trigger blocked (psi=0.361)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=1.136345
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.096552e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.879842 delta_norm=0.809655
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=2 metric=0.1402 head_norm=0.871710
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.177292e-01
[S4] stored merged vector for next round verification (round=2)
[S4] DEBUG after merge:  round=2 metric=0.1402 head_norm=0.751274 delta_norm=0.717729
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.879842 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.272681 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7560980395291201, 'loss_val': 1.2731769829320954, 'psi': 0.3875054958447881}-{'f1_val': 0.1417771333885667, 'auprc': 0.5804379206487834, 'loss_val': 1.2915592835297631, 'psi': 0.3172414482926534}
[S3] START round=3 head_norm_before_train=0.914270 cos_to_last_merge=0.9914 (last merge round=1)
[S3] round=3 local utility u=0.355161 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7957897022478836, 'loss_val': 1.101029948992164, 'psi': 0.40221992026761766}-{'f1_val': 0.13984006561410703, 'auprc': 0.5992114374374494, 'loss_val': 1.2216164385865185, 'psi': 0.323588614343444}
[S4] START round=3 head_norm_before_train=0.751274 cos_to_last_merge=1.0000 (last merge round=2)
[S4] round=3 local utility u=0.011609 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.776037805258746, 'loss_val': 1.3058977900231132, 'psi': 0.3945510994406089}-{'f1_val': 0.14022662889518414, 'auprc': 0.7732343863633885, 'loss_val': 1.3207053783480973, 'psi': 0.3934297318824659}
[S5] START round=3 head_norm_before_train=1.252218 (no previous merge yet)
[S5] round=3 local utility u=0.967205 metrics={'f1_val': 0.41803043574602833, 'auprc': 0.7776404593395887, 'loss_val': 0.9773979240842667, 'psi': 0.5618744451834525}-{'f1_val': 0.14226190476190476, 'auprc': 0.7466707445773583, 'loss_val': 1.1642884656529864, 'psi': 0.3840254406880862}
[S6] START round=3 head_norm_before_train=0.781643 cos_to_last_merge=0.9958 (last merge round=1)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8626817947589643, 'loss_val': 1.2814632514058082, 'psi': 0.42992848713435494}-{'f1_val': 0.4143622864039477, 'auprc': 0.8624195834701546, 'loss_val': 1.3241969799589823, 'psi': 0.5935852052304305}
[S7] START round=3 head_norm_before_train=1.266930 (no previous merge yet)
[S7] round=3 local utility u=0.854737 metrics={'f1_val': 0.4166714190153544, 'auprc': 0.7666459155005014, 'loss_val': 1.096910121604363, 'psi': 0.5566612176094132}-{'f1_val': 0.14205682272909165, 'auprc': 0.7881083882116632, 'loss_val': 1.2230831659081773, 'psi': 0.4004774489221203}
[S8] START round=3 head_norm_before_train=1.230215 (no previous merge yet)
[S8] round=3 local utility u=0.321685 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7227014124523631, 'loss_val': 1.2275341649474947, 'psi': 0.3730541544167196}-{'f1_val': 0.13995598239295717, 'auprc': 0.5232543013521556, 'loss_val': 1.2725636629293204, 'psi': 0.29327530997663653}
[S9] START round=3 head_norm_before_train=1.344037 (no previous merge yet)
[S9] round=3 local utility u=0.914137 metrics={'f1_val': 0.39839774825087854, 'auprc': 0.8660567042441236, 'loss_val': 0.852234798614986, 'psi': 0.5854613306481766}-{'f1_val': 0.141397957139996, 'auprc': 0.8657533688717534, 'loss_val': 1.1375996548138014, 'psi': 0.43114012183269895}
[S10] START round=3 head_norm_before_train=1.222876 (no previous merge yet)
[S10] round=3 local utility u=0.025020 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7773198725555062, 'loss_val': 1.2421982932764697, 'psi': 0.39410093154723685}-{'f1_val': 0.13862163754172394, 'auprc': 0.7773549587390918, 'loss_val': 1.2923444483384539, 'psi': 0.3941149660206711}
[S11] START round=3 head_norm_before_train=1.182885 (no previous merge yet)
[S11] round=3 local utility u=0.099559 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9199080153954091, 'loss_val': 1.2159909500759942, 'psi': 0.45221141618203003}-{'f1_val': 0.14041368337311058, 'auprc': 0.8702841137950103, 'loss_val': 1.2662374215726597, 'psi': 0.43236185554187045}
[S13] START round=3 head_norm_before_train=1.182646 (no previous merge yet)
[S13] round=3 local utility u=0.046243 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5555628522865041, 'loss_val': 1.23524640978412, 'psi': 0.3064565984608335}-{'f1_val': 0.1403857625770531, 'auprc': 0.5411270672744426, 'loss_val': 1.2844259819483197, 'psi': 0.3006822844560089}
[S14] START round=3 head_norm_before_train=1.179140 (no previous merge yet)
[S14] round=3 local utility u=0.022402 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7396266952558165, 'loss_val': 1.2951252719063924, 'psi': 0.3800653898319489}-{'f1_val': 0.14035785288270378, 'auprc': 0.7339998171678637, 'loss_val': 1.323048518871207, 'psi': 0.3778146385967677}
[S15] START round=3 head_norm_before_train=1.231548 (no previous merge yet)
[S15] round=3 local utility u=0.018962 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7746704893701103, 'loss_val': 1.2618690259553198, 'psi': 0.39370838656497914}-{'f1_val': 0.13973365136155833, 'auprc': 0.7761186550694605, 'loss_val': 1.3041366778867292, 'psi': 0.3942876528447192}
[S16] START round=3 head_norm_before_train=1.184583 (no previous merge yet)
[S16] round=3 local utility u=0.026165 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8086309453338311, 'loss_val': 1.2379138740187423, 'psi': 0.4078348482530544}-{'f1_val': 0.14063745019920318, 'auprc': 0.8086086883250813, 'loss_val': 1.2901771202499632, 'psi': 0.4078259454495544}
[S17] START round=3 head_norm_before_train=1.170841 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6627343057758874, 'loss_val': 1.2829558952359246, 'psi': 0.3496631003007856}-{'f1_val': 0.14094896331738438, 'auprc': 0.6911597380973536, 'loss_val': 1.3235332200079197, 'psi': 0.3610332732293721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:38510
[S11] not sending this round → trigger blocked (psi=0.452)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:38505
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.585)
[S5] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S16] → sending delta(kind=head bytes=1787) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[S8] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1787 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.0719
[S6] RECEIVED delta(kind=head bytes=1787) from S16
[S6] cosine check vs S16: cos=0.0006
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] cosine check vs S8: cos=-0.0412
[S7] DROPPED delta from S8 (cos=-0.0412 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1793) from S13
[S9] cosine check vs S13: cos=0.0611
[S5] RECEIVED delta(kind=head bytes=1791) from S3
[S5] cosine check vs S3: cos=0.0331
[S5] RECEIVED delta(kind=head bytes=1794) from S15
[S5] cosine check vs S15: cos=0.0576
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] cosine check vs S10: cos=0.0964
[S5] RECEIVED delta(kind=head bytes=1792) from S2
[S5] cosine check vs S2: cos=0.7445
[S5] RECEIVED delta(kind=head bytes=1798) from S14
[S5] cosine check vs S14: cos=0.0784
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] cosine check vs S4: cos=0.7959
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=0.815118
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.309345e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.3998 head_norm=0.731316 delta_norm=0.730935
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.3984 head_norm=1.407299
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.993509e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.4369 head_norm=0.955389 delta_norm=0.899351
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.201541
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.559604e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.919626 delta_norm=0.855960
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=1.212652
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.792583e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.944187 delta_norm=0.379258
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=5 kept=5 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.4180 head_norm=1.306518
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.940589e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.4180 head_norm=0.816122 delta_norm=0.594059
[S5] aggregate: ACCEPT kept=['S3', 'S15', 'S10', 'S2', 'S14'] (k=5/5) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.902750 cos_to_last_merge=0.9969 (last merge round=2)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6075389948546862, 'loss_val': 1.212329913245718, 'psi': 0.32808187797501454}-{'f1_val': 0.1417771333885667, 'auprc': 0.7560980395291201, 'loss_val': 1.2731769829320954, 'psi': 0.3875054958447881}
[S3] START round=4 head_norm_before_train=0.952881 cos_to_last_merge=0.9782 (last merge round=1)
[S3] round=4 local utility u=0.883684 metrics={'f1_val': 0.39635856801559805, 'auprc': 0.7961477599487756, 'loss_val': 0.8738464775663272, 'psi': 0.5562742447888691}-{'f1_val': 0.13984006561410703, 'auprc': 0.7957897022478836, 'loss_val': 1.101029948992164, 'psi': 0.40221992026761766}
[S4] START round=4 head_norm_before_train=0.774678 cos_to_last_merge=0.9960 (last merge round=2)
[S4] round=4 local utility u=0.031832 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7804463658281747, 'loss_val': 1.255459291099406, 'psi': 0.3963145236683804}-{'f1_val': 0.14022662889518414, 'auprc': 0.776037805258746, 'loss_val': 1.3058977900231132, 'psi': 0.3945510994406089}
[S5] START round=4 head_norm_before_train=0.816122 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.045838 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.7771678083541446, 'loss_val': 0.8821251519988115, 'psi': 0.5614674347215051}-{'f1_val': 0.41803043574602833, 'auprc': 0.7776404593395887, 'loss_val': 0.9773979240842667, 'psi': 0.5618744451834525}
[S6] START round=4 head_norm_before_train=0.731316 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8343706088153973, 'loss_val': 1.2913238498239965, 'psi': 0.41860401275692816}-{'f1_val': 0.14142628205128205, 'auprc': 0.8626817947589643, 'loss_val': 1.2814632514058082, 'psi': 0.42992848713435494}
[S7] START round=4 head_norm_before_train=1.308838 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.4172381946317165, 'auprc': 0.6869770844785981, 'loss_val': 0.8707112244532578, 'psi': 0.5251337505704692}-{'f1_val': 0.4166714190153544, 'auprc': 0.7666459155005014, 'loss_val': 1.096910121604363, 'psi': 0.5566612176094132}
[S8] START round=4 head_norm_before_train=1.261523 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.14445731714379856, 'auprc': 0.6331216099108699, 'loss_val': 1.1791317109383586, 'psi': 0.3399230342506271}-{'f1_val': 0.13995598239295717, 'auprc': 0.7227014124523631, 'loss_val': 1.2275341649474947, 'psi': 0.3730541544167196}
[S9] START round=4 head_norm_before_train=0.955389 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=1.000000 metrics={'f1_val': 0.7010149576827939, 'auprc': 0.9898162555837013, 'loss_val': 0.6657928078780112, 'psi': 0.816535476843157}-{'f1_val': 0.39839774825087854, 'auprc': 0.8660567042441236, 'loss_val': 0.852234798614986, 'psi': 0.5854613306481766}
[S10] START round=4 head_norm_before_train=1.255845 (no previous merge yet)
[S10] round=4 local utility u=0.024112 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7746515074729876, 'loss_val': 1.1859689861478397, 'psi': 0.3930335855142294}-{'f1_val': 0.13862163754172394, 'auprc': 0.7773198725555062, 'loss_val': 1.2421982932764697, 'psi': 0.39410093154723685}
[S11] START round=4 head_norm_before_train=0.944187 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7827333619025307, 'loss_val': 1.1761269202593418, 'psi': 0.39734155478487865}-{'f1_val': 0.14041368337311058, 'auprc': 0.9199080153954091, 'loss_val': 1.2159909500759942, 'psi': 0.45221141618203003}
[S13] START round=4 head_norm_before_train=1.209424 (no previous merge yet)
[S13] round=4 local utility u=0.076259 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5897074553243956, 'loss_val': 1.1851621668543828, 'psi': 0.3201144396759901}-{'f1_val': 0.1403857625770531, 'auprc': 0.5555628522865041, 'loss_val': 1.23524640978412, 'psi': 0.3064565984608335}
[S14] START round=4 head_norm_before_train=0.919626 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.009145 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7487038557993692, 'loss_val': 1.304066545872135, 'psi': 0.3836962540493699}-{'f1_val': 0.14035785288270378, 'auprc': 0.7396266952558165, 'loss_val': 1.2951252719063924, 'psi': 0.3800653898319489}
[S15] START round=4 head_norm_before_train=1.258936 (no previous merge yet)
[S15] round=4 local utility u=0.026786 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7769162793414149, 'loss_val': 1.2150336390073542, 'psi': 0.394606702553501}-{'f1_val': 0.13973365136155833, 'auprc': 0.7746704893701103, 'loss_val': 1.2618690259553198, 'psi': 0.39370838656497914}
[S16] START round=4 head_norm_before_train=1.213985 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6148412277883332, 'loss_val': 1.1906939895721351, 'psi': 0.33031896123485516}-{'f1_val': 0.14063745019920318, 'auprc': 0.8086309453338311, 'loss_val': 1.2379138740187423, 'psi': 0.4078348482530544}
[S17] START round=4 head_norm_before_train=1.201443 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5992824851882468, 'loss_val': 1.2354310861232338, 'psi': 0.32428237206572935}-{'f1_val': 0.14094896331738438, 'auprc': 0.6627343057758874, 'loss_val': 1.2829558952359246, 'psi': 0.3496631003007856}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S5] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:38512
[S10] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1788 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1788) from S5
[S16] cosine check vs S5: cos=0.0187
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=0.2133
[S4] sending update (kind=head size=1804 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] cosine check vs S4: cos=0.8969
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:38505
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=0.1882
[S5] RECEIVED delta(kind=head bytes=1793) from S14
[S5] cosine check vs S14: cos=0.1120
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] cosine check vs S3: cos=0.2288
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] cosine check vs S9: cos=-0.1348
[S14] DROPPED delta from S9 (cos=-0.1348 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=0.6281
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.4177 head_norm=0.881796
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.341082e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.4177 head_norm=0.609840 delta_norm=0.434108
[S5] aggregate: ACCEPT kept=['S10', 'S15', 'S14', 'S3'] (k=4/4) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=0.977947
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.189783e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.869707 delta_norm=0.218978
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.7010 head_norm=1.050098
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.010870e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.7014 head_norm=1.033787 delta_norm=0.501087
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=1.248380
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.574315e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.770913 delta_norm=0.757432
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.929801 cos_to_last_merge=0.9895 (last merge round=2)
[S2] round=5 local utility u=0.181878 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7040925297239049, 'loss_val': 1.1382338988724645, 'psi': 0.366703291922702}-{'f1_val': 0.1417771333885667, 'auprc': 0.6075389948546862, 'loss_val': 1.212329913245718, 'psi': 0.32808187797501454}
[S3] START round=5 head_norm_before_train=1.020595 cos_to_last_merge=0.9550 (last merge round=1)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.4024484509855121, 'auprc': 0.7087510675547088, 'loss_val': 0.7654378255951505, 'psi': 0.5249694976131908}-{'f1_val': 0.39635856801559805, 'auprc': 0.7961477599487756, 'loss_val': 0.8738464775663272, 'psi': 0.5562742447888691}
[S4] START round=5 head_norm_before_train=0.807653 cos_to_last_merge=0.9848 (last merge round=2)
[S4] round=5 local utility u=0.044901 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7839509260689419, 'loss_val': 1.1761705524654305, 'psi': 0.3977163477646873}-{'f1_val': 0.14022662889518414, 'auprc': 0.7804463658281747, 'loss_val': 1.255459291099406, 'psi': 0.3963145236683804}
[S5] START round=5 head_norm_before_train=0.609840 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.008604 metrics={'f1_val': 0.41750600063402926, 'auprc': 0.7887289423622401, 'loss_val': 0.8986336539126983, 'psi': 0.5659951773253136}-{'f1_val': 0.4176671856330787, 'auprc': 0.7771678083541446, 'loss_val': 0.8821251519988115, 'psi': 0.5614674347215051}
[S6] START round=5 head_norm_before_train=0.755811 cos_to_last_merge=0.9956 (last merge round=3)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8102014330724616, 'loss_val': 1.2470187801502908, 'psi': 0.40893634245975385}-{'f1_val': 0.14142628205128205, 'auprc': 0.8343706088153973, 'loss_val': 1.2913238498239965, 'psi': 0.41860401275692816}
[S7] START round=5 head_norm_before_train=1.365362 (no previous merge yet)
[S7] round=5 local utility u=0.168117 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.7774664112662891, 'loss_val': 0.8035113942287627, 'psi': 0.5610860441655797}-{'f1_val': 0.4172381946317165, 'auprc': 0.6869770844785981, 'loss_val': 0.8707112244532578, 'psi': 0.5251337505704692}
[S8] START round=5 head_norm_before_train=1.282614 (no previous merge yet)
[S8] round=5 local utility u=0.748599 metrics={'f1_val': 0.4165552843179967, 'auprc': 0.575134399884796, 'loss_val': 1.140559518623327, 'psi': 0.4799869305447164}-{'f1_val': 0.14445731714379856, 'auprc': 0.6331216099108699, 'loss_val': 1.1791317109383586, 'psi': 0.3399230342506271}
[S9] START round=5 head_norm_before_train=1.033787 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.082660 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.9992294299578593, 'loss_val': 0.5312568490152959, 'psi': 0.8205552521521167}-{'f1_val': 0.7010149576827939, 'auprc': 0.9898162555837013, 'loss_val': 0.6657928078780112, 'psi': 0.816535476843157}
[S10] START round=5 head_norm_before_train=1.290789 (no previous merge yet)
[S10] round=5 local utility u=0.700151 metrics={'f1_val': 0.41615846728099787, 'auprc': 0.6580910629477366, 'loss_val': 1.1012067526645073, 'psi': 0.5129315055476933}-{'f1_val': 0.13862163754172394, 'auprc': 0.7746515074729876, 'loss_val': 1.1859689861478397, 'psi': 0.3930335855142294}
[S11] START round=5 head_norm_before_train=0.869707 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.020181 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7684846888877969, 'loss_val': 1.093019769811673, 'psi': 0.3916420855789851}-{'f1_val': 0.14041368337311058, 'auprc': 0.7827333619025307, 'loss_val': 1.1761269202593418, 'psi': 0.39734155478487865}
[S13] START round=5 head_norm_before_train=1.239720 (no previous merge yet)
[S13] round=5 local utility u=0.836793 metrics={'f1_val': 0.4156839344320697, 'auprc': 0.5791340057311674, 'loss_val': 1.131645207545034, 'psi': 0.4810639629517087}-{'f1_val': 0.1403857625770531, 'auprc': 0.5897074553243956, 'loss_val': 1.1851621668543828, 'psi': 0.3201144396759901}
[S14] START round=5 head_norm_before_train=0.938725 cos_to_last_merge=0.9974 (last merge round=3)
[S14] round=5 local utility u=0.064242 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7749194050318268, 'loss_val': 1.254230094592081, 'psi': 0.394182473742353}-{'f1_val': 0.14035785288270378, 'auprc': 0.7487038557993692, 'loss_val': 1.304066545872135, 'psi': 0.3836962540493699}
[S15] START round=5 head_norm_before_train=1.291512 (no previous merge yet)
[S15] round=5 local utility u=0.868855 metrics={'f1_val': 0.4164559415260807, 'auprc': 0.783906683435108, 'loss_val': 1.1586284702523266, 'psi': 0.5634362382896916}-{'f1_val': 0.13973365136155833, 'auprc': 0.7769162793414149, 'loss_val': 1.2150336390073542, 'psi': 0.394606702553501}
[S16] START round=5 head_norm_before_train=0.770913 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6066732638115901, 'loss_val': 1.1879335171086638, 'psi': 0.327051775644158}-{'f1_val': 0.14063745019920318, 'auprc': 0.6148412277883332, 'loss_val': 1.1906939895721351, 'psi': 0.33031896123485516}
[S17] START round=5 head_norm_before_train=1.241636 (no previous merge yet)
[S17] round=5 local utility u=0.022775 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5865554803073553, 'loss_val': 1.1517009065647055, 'psi': 0.31919157011337274}-{'f1_val': 0.14094896331738438, 'auprc': 0.5992824851882468, 'loss_val': 1.2354310861232338, 'psi': 0.32428237206572935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:38510
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:38505
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38514
[S11] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.4944
[S9] RECEIVED delta(kind=head bytes=1789) from S11
[S9] cosine check vs S11: cos=0.0957
[S5] RECEIVED delta(kind=head bytes=1793) from S2
[S5] cosine check vs S2: cos=0.7252
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.7097
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] cosine check vs S8: cos=-0.0478
[S7] DROPPED delta from S8 (cos=-0.0478 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=-0.0875
[S14] DROPPED delta from S9 (cos=-0.0875 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:38505
[S14] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1792) from S14
[S5] cosine check vs S14: cos=0.2638
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=0.8615
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:38512
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] cosine check vs S15: cos=0.3727
[S10] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9458
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] cosine check vs S10: cos=0.3563
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1792 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1792) from S17
[S9] cosine check vs S17: cos=0.1261
[S3] ⇄ pheromone p=0.515 → S5@127.0.0.1:38505
[S6] ⇄ pheromone p=0.447 → S4@127.0.0.1:38504
[S2] ⇄ pheromone p=0.422 → S5@127.0.0.1:38505
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.7014 head_norm=1.121492
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.866541e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.7014 head_norm=0.812525 delta_norm=0.486654
[S9] aggregate: ACCEPT kept=['S11', 'S13', 'S17'] (k=3/3) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.627 → S14@127.0.0.1:38514
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.4175 head_norm=0.672139
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.020780e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.4175 head_norm=0.605145 delta_norm=0.202078
[S5] aggregate: ACCEPT kept=['S2', 'S14', 'S15', 'S10'] (k=4/4) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.465 → S16@127.0.0.1:38516
[S7] ⇄ pheromone p=0.479 → S14@127.0.0.1:38514
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.907557
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.474328e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.867146 delta_norm=0.147433
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.371 → S9@127.0.0.1:38510
[S8] ⇄ pheromone p=0.533 → S7@127.0.0.1:38508
[S13] ⇄ pheromone p=0.557 → S9@127.0.0.1:38510
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.968006
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.014629e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=1.108444 delta_norm=0.501463
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.410 → S5@127.0.0.1:38505
[S15] ⇄ pheromone p=0.571 → S5@127.0.0.1:38505
[S10] ⇄ pheromone p=0.546 → S5@127.0.0.1:38505
[S4] ⇄ pheromone p=0.347 → S11@127.0.0.1:38512
[S17] ⇄ pheromone p=0.363 → S9@127.0.0.1:38510
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.802602
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.750019e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1673 head_norm=0.638235 delta_norm=0.375002
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.331 → S6@127.0.0.1:38507
[S2] START round=6 head_norm_before_train=0.957106 cos_to_last_merge=0.9801 (last merge round=2)
[S2] round=6 local utility u=0.985747 metrics={'f1_val': 0.41650965113631266, 'auprc': 0.7751173865972394, 'loss_val': 1.0282086003222821, 'psi': 0.5599527453206834}-{'f1_val': 0.1417771333885667, 'auprc': 0.7040925297239049, 'loss_val': 1.1382338988724645, 'psi': 0.366703291922702}
[S3] START round=6 head_norm_before_train=1.105331 cos_to_last_merge=0.9269 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=6 local utility u=1.000000 metrics={'f1_val': 0.6891653956046963, 'auprc': 0.7961275371026829, 'loss_val': 0.5570833844581355, 'psi': 0.731950252203891}-{'f1_val': 0.4024484509855121, 'auprc': 0.7087510675547088, 'loss_val': 0.7654378255951505, 'psi': 0.5249694976131908}
[S4] START round=6 head_norm_before_train=0.850705 cos_to_last_merge=0.9691 (last merge round=2)
[S4] round=6 local utility u=0.070855 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7880110622030556, 'loss_val': 1.0466418194824396, 'psi': 0.3993404022183327}-{'f1_val': 0.14022662889518414, 'auprc': 0.7839509260689419, 'loss_val': 1.1761705524654305, 'psi': 0.3977163477646873}
[S5] START round=6 head_norm_before_train=0.605145 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.327964 metrics={'f1_val': 0.5736686460980216, 'auprc': 0.6649002467290847, 'loss_val': 0.8081962162411329, 'psi': 0.6101612863504469}-{'f1_val': 0.41750600063402926, 'auprc': 0.7887289423622401, 'loss_val': 0.8986336539126983, 'psi': 0.5659951773253136}
[S6] START round=6 head_norm_before_train=0.789018 cos_to_last_merge=0.9842 (last merge round=3)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6492135188885214, 'loss_val': 1.211235620251626, 'psi': 0.3445411767861778}-{'f1_val': 0.14142628205128205, 'auprc': 0.8102014330724616, 'loss_val': 1.2470187801502908, 'psi': 0.40893634245975385}
[S7] START round=6 head_norm_before_train=1.422390 (no previous merge yet)
[S7] round=6 local utility u=0.839475 metrics={'f1_val': 0.6853906980015682, 'auprc': 0.7803143991984353, 'loss_val': 0.7444551551518408, 'psi': 0.723360178480315}-{'f1_val': 0.41683246609844005, 'auprc': 0.7774664112662891, 'loss_val': 0.8035113942287627, 'psi': 0.5610860441655797}
[S8] START round=6 head_norm_before_train=1.298059 (no previous merge yet)
[S8] round=6 local utility u=0.970188 metrics={'f1_val': 0.683723596042986, 'auprc': 0.644347480209097, 'loss_val': 1.0108331690111116, 'psi': 0.6679731497094304}-{'f1_val': 0.4165552843179967, 'auprc': 0.575134399884796, 'loss_val': 1.140559518623327, 'psi': 0.4799869305447164}
[S9] START round=6 head_norm_before_train=0.812525 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.031407 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.998435704254953, 'loss_val': 0.4656157474167341, 'psi': 0.8201930823334866}-{'f1_val': 0.7014391336149548, 'auprc': 0.9992294299578593, 'loss_val': 0.5312568490152959, 'psi': 0.8205552521521167}
[S10] START round=6 head_norm_before_train=1.325822 (no previous merge yet)
[S10] round=6 local utility u=0.089090 metrics={'f1_val': 0.41689270364329833, 'auprc': 0.663574225859002, 'loss_val': 0.9438816692155931, 'psi': 0.5155653125295798}-{'f1_val': 0.41615846728099787, 'auprc': 0.6580910629477366, 'loss_val': 1.1012067526645073, 'psi': 0.5129315055476933}
[S11] START round=6 head_norm_before_train=0.867146 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.39658602128368947, 'auprc': 0.977677289463925, 'loss_val': 0.9507790268690481, 'psi': 0.6290225285557837}-{'f1_val': 0.14041368337311058, 'auprc': 0.7684846888877969, 'loss_val': 1.093019769811673, 'psi': 0.3916420855789851}
[S13] START round=6 head_norm_before_train=1.258078 (no previous merge yet)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.4164711099175653, 'auprc': 0.549291284129827, 'loss_val': 1.0639437109167114, 'psi': 0.46959917960247}-{'f1_val': 0.4156839344320697, 'auprc': 0.5791340057311674, 'loss_val': 1.131645207545034, 'psi': 0.4810639629517087}
[S14] START round=6 head_norm_before_train=1.108444 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.198766 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8974314634960012, 'loss_val': 1.2242337248047241, 'psi': 0.44318729712802274}-{'f1_val': 0.14035785288270378, 'auprc': 0.7749194050318268, 'loss_val': 1.254230094592081, 'psi': 0.394182473742353}
[S15] START round=6 head_norm_before_train=1.318966 (no previous merge yet)
[S15] round=6 local utility u=0.052523 metrics={'f1_val': 0.4167593395843331, 'auprc': 0.7734386708873466, 'loss_val': 1.0239993786794315, 'psi': 0.5594310721055384}-{'f1_val': 0.4164559415260807, 'auprc': 0.783906683435108, 'loss_val': 1.1586284702523266, 'psi': 0.5634362382896916}
[S16] START round=6 head_norm_before_train=0.638235 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.727048 metrics={'f1_val': 0.4109137657133718, 'auprc': 0.5473981742527604, 'loss_val': 1.1776710726082844, 'psi': 0.4655075291291272}-{'f1_val': 0.14063745019920318, 'auprc': 0.6066732638115901, 'loss_val': 1.1879335171086638, 'psi': 0.327051775644158}
[S17] START round=6 head_norm_before_train=1.276218 (no previous merge yet)
[S17] round=6 local utility u=0.868694 metrics={'f1_val': 0.38612967953686095, 'auprc': 0.6556478191504125, 'loss_val': 1.0926748890891873, 'psi': 0.49393693538228156}-{'f1_val': 0.14094896331738438, 'auprc': 0.5865554803073553, 'loss_val': 1.1517009065647055, 'psi': 0.31919157011337274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:38507
[S2] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.7511
[S14] RECEIVED delta(kind=head bytes=1795) from S9
[S14] cosine check vs S9: cos=-0.0531
[S14] DROPPED delta from S9 (cos=-0.0531 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] cosine check vs S7: cos=0.9329
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] cosine check vs S16: cos=0.4789
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] cosine check vs S8: cos=-0.0501
[S7] DROPPED delta from S8 (cos=-0.0501 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S11
[S9] cosine check vs S11: cos=0.3544
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=0.9647
[S5] RECEIVED delta(kind=head bytes=1796) from S2
[S5] cosine check vs S2: cos=0.6943
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.4204
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] cosine check vs S3: cos=0.2639
[S5] RECEIVED delta(kind=head bytes=1801) from S14
[S5] cosine check vs S14: cos=0.2880
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] cosine check vs S10: cos=0.3998
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S17
[S9] cosine check vs S17: cos=0.3744
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1414 head_norm=0.814092
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.829252e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.637097 delta_norm=0.382925
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=1.128356
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.905091e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.4148 head_norm=1.276586 delta_norm=0.290509
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=5 kept=5 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.5737 head_norm=0.680872
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.979016e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.7011 head_norm=0.616262 delta_norm=0.197902
[S5] aggregate: ACCEPT kept=['S2', 'S15', 'S3', 'S14', 'S10'] (k=5/5) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.7014 head_norm=0.923123
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.752668e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.7014 head_norm=0.774061 delta_norm=0.475267
[S9] aggregate: ACCEPT kept=['S11', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.3966 head_norm=0.911155
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.201564e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.3966 head_norm=0.894719 delta_norm=0.120156
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4109 head_norm=0.665059
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.375285e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.2677 head_norm=0.629703 delta_norm=0.237528
[S16] aggregate: ROLLBACK (f1_val pre=0.411 post=0.268 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=0.992173 cos_to_last_merge=0.9688 (last merge round=2)
[S2] round=7 local utility u=0.714666 metrics={'f1_val': 0.6289286506480471, 'auprc': 0.7768221121866823, 'loss_val': 0.8785046178622569, 'psi': 0.6880860352635012}-{'f1_val': 0.41650965113631266, 'auprc': 0.7751173865972394, 'loss_val': 1.0282086003222821, 'psi': 0.5599527453206834}
[S3] START round=7 head_norm_before_train=1.197061 cos_to_last_merge=0.8996 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.900
[S3] round=7 local utility u=0.216139 metrics={'f1_val': 0.6530104667321902, 'auprc': 0.9861526046575486, 'loss_val': 0.4779511422969207, 'psi': 0.7862673219023335}-{'f1_val': 0.6891653956046963, 'auprc': 0.7961275371026829, 'loss_val': 0.5570833844581355, 'psi': 0.731950252203891}
[S4] START round=7 head_norm_before_train=0.894269 cos_to_last_merge=0.9505 (last merge round=2)
[S4] round=7 local utility u=1.000000 metrics={'f1_val': 0.67146857249966, 'auprc': 0.7862183231049975, 'loss_val': 0.8911710600726418, 'psi': 0.717368472741795}-{'f1_val': 0.14022662889518414, 'auprc': 0.7880110622030556, 'loss_val': 1.0466418194824396, 'psi': 0.3993404022183327}
[S5] START round=7 head_norm_before_train=0.616262 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.406483 metrics={'f1_val': 0.7008175646132602, 'auprc': 0.6673543866134222, 'loss_val': 0.7654860429127185, 'psi': 0.687432293413325}-{'f1_val': 0.5736686460980216, 'auprc': 0.6649002467290847, 'loss_val': 0.8081962162411329, 'psi': 0.6101612863504469}
[S6] START round=7 head_norm_before_train=0.637097 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.180379 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7631447064417038, 'loss_val': 1.1922719858830653, 'psi': 0.3901136518074508}-{'f1_val': 0.14142628205128205, 'auprc': 0.6492135188885214, 'loss_val': 1.211235620251626, 'psi': 0.3445411767861778}
[S7] START round=7 head_norm_before_train=1.467974 (no previous merge yet)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.3778853612367726, 'auprc': 0.7732726935063995, 'loss_val': 0.9216371655580176, 'psi': 0.5360402941446234}-{'f1_val': 0.6853906980015682, 'auprc': 0.7803143991984353, 'loss_val': 0.7444551551518408, 'psi': 0.723360178480315}
[S8] START round=7 head_norm_before_train=1.329656 (no previous merge yet)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.3726652774371328, 'auprc': 0.7764130738809982, 'loss_val': 0.8968209150641562, 'psi': 0.5341643960146789}-{'f1_val': 0.683723596042986, 'auprc': 0.644347480209097, 'loss_val': 1.0108331690111116, 'psi': 0.6679731497094304}
[S9] START round=7 head_norm_before_train=0.774061 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.007827 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9984244997889659, 'loss_val': 0.44992756941775625, 'psi': 0.8201886005470919}-{'f1_val': 0.7013646677191758, 'auprc': 0.998435704254953, 'loss_val': 0.4656157474167341, 'psi': 0.8201930823334866}
[S10] START round=7 head_norm_before_train=1.371074 (no previous merge yet)
[S10] round=7 local utility u=0.335716 metrics={'f1_val': 0.4114242575428734, 'auprc': 0.8573496666309489, 'loss_val': 0.8209661043864626, 'psi': 0.5897944211781037}-{'f1_val': 0.41689270364329833, 'auprc': 0.663574225859002, 'loss_val': 0.9438816692155931, 'psi': 0.5155653125295798}
[S11] START round=7 head_norm_before_train=0.894719 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.078765 metrics={'f1_val': 0.3907478305924216, 'auprc': 0.9957090571371541, 'loss_val': 0.8123153389201557, 'psi': 0.6327323212103145}-{'f1_val': 0.39658602128368947, 'auprc': 0.977677289463925, 'loss_val': 0.9507790268690481, 'psi': 0.6290225285557837}
[S13] START round=7 head_norm_before_train=1.283013 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.416200286011302, 'auprc': 0.5253747502773413, 'loss_val': 1.0208900572528132, 'psi': 0.45987007171771765}-{'f1_val': 0.4164711099175653, 'auprc': 0.549291284129827, 'loss_val': 1.0639437109167114, 'psi': 0.46959917960247}
[S14] START round=7 head_norm_before_train=1.276586 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.114808 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9583464511797388, 'loss_val': 1.1773630326137392, 'psi': 0.4675532922015178}-{'f1_val': 0.14035785288270378, 'auprc': 0.8974314634960012, 'loss_val': 1.2242337248047241, 'psi': 0.44318729712802274}
[S15] START round=7 head_norm_before_train=1.351914 (no previous merge yet)
[S15] round=7 local utility u=0.086454 metrics={'f1_val': 0.4170305028984703, 'auprc': 0.7818861876386727, 'loss_val': 0.8780606547442232, 'psi': 0.5629727767945513}-{'f1_val': 0.4167593395843331, 'auprc': 0.7734386708873466, 'loss_val': 1.0239993786794315, 'psi': 0.5594310721055384}
[S16] START round=7 head_norm_before_train=0.629703 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.017069 metrics={'f1_val': 0.41684138078021116, 'auprc': 0.5331046238374553, 'loss_val': 1.136217748861987, 'psi': 0.4633466780031088}-{'f1_val': 0.4109137657133718, 'auprc': 0.5473981742527604, 'loss_val': 1.1776710726082844, 'psi': 0.4655075291291272}
[S17] START round=7 head_norm_before_train=1.297891 (no previous merge yet)
[S17] round=7 local utility u=0.129435 metrics={'f1_val': 0.39658425346854415, 'auprc': 0.670822723124555, 'loss_val': 0.9420571685423202, 'psi': 0.5062796413309485}-{'f1_val': 0.38612967953686095, 'auprc': 0.6556478191504125, 'loss_val': 1.0926748890891873, 'psi': 0.49393693538228156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:38510
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:38512
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38505
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.8608
[S4] RECEIVED delta(kind=head bytes=1804) from S6
[S4] cosine check vs S6: cos=0.0036
[S9] RECEIVED delta(kind=head bytes=1794) from S11
[S9] cosine check vs S11: cos=0.5634
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=-0.0325
[S14] DROPPED delta from S9 (cos=-0.0325 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9699
[S5] RECEIVED delta(kind=head bytes=1795) from S10
[S5] cosine check vs S10: cos=0.3799
[S5] RECEIVED delta(kind=head bytes=1799) from S14
[S5] cosine check vs S14: cos=0.2732
[S5] RECEIVED delta(kind=head bytes=1796) from S2
[S5] cosine check vs S2: cos=0.7095
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.4308
[S5] RECEIVED delta(kind=head bytes=1801) from S3
[S5] cosine check vs S3: cos=0.3890
[S6] RECEIVED delta(kind=head bytes=1805) from S16
[S6] cosine check vs S16: cos=0.7010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.6593
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.6715 head_norm=0.940770
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.723627e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6683 head_norm=0.574322 delta_norm=0.572363
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4168 head_norm=0.653727
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.778797e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4166 head_norm=0.647406 delta_norm=0.177880
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.1414 head_norm=0.655623
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.531191e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.1674 head_norm=0.603764 delta_norm=0.253119
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=5 kept=5 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.7008 head_norm=0.688617
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.682979e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.7008 head_norm=0.645262 delta_norm=0.168298
[S5] aggregate: ACCEPT kept=['S10', 'S14', 'S2', 'S15', 'S3'] (k=5/5) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.3907 head_norm=0.946889
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.158720e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.3910 head_norm=0.936695 delta_norm=0.115872
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7014 head_norm=0.880225
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.115644e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.7014 head_norm=0.848430 delta_norm=0.311564
[S9] aggregate: ACCEPT kept=['S11', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.041072 cos_to_last_merge=0.9538 (last merge round=2)
[S2] round=8 local utility u=0.160907 metrics={'f1_val': 0.7012811618205921, 'auprc': 0.6964968094489965, 'loss_val': 0.7498289246345667, 'psi': 0.6993674208719538}-{'f1_val': 0.6289286506480471, 'auprc': 0.7768221121866823, 'loss_val': 0.8785046178622569, 'psi': 0.6880860352635012}
[S3] START round=8 head_norm_before_train=1.285214 cos_to_last_merge=0.8748 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.875
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.6007004521553635, 'auprc': 0.9215180121278465, 'loss_val': 0.49869610796005914, 'psi': 0.7290274761443567}-{'f1_val': 0.6530104667321902, 'auprc': 0.9861526046575486, 'loss_val': 0.4779511422969207, 'psi': 0.7862673219023335}
[S4] START round=8 head_norm_before_train=0.574322 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.6688979015642553, 'auprc': 0.6599872813433063, 'loss_val': 0.8703249900302844, 'psi': 0.6653336534758758}-{'f1_val': 0.67146857249966, 'auprc': 0.7862183231049975, 'loss_val': 0.8911710600726418, 'psi': 0.717368472741795}
[S5] START round=8 head_norm_before_train=0.645262 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.045227 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.669635620270362, 'loss_val': 0.6818710644907346, 'psi': 0.6883443634146591}-{'f1_val': 0.7008175646132602, 'auprc': 0.6673543866134222, 'loss_val': 0.7654860429127185, 'psi': 0.687432293413325}
[S6] START round=8 head_norm_before_train=0.603764 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6135234014069554, 'loss_val': 1.163771565011445, 'psi': 0.3302651297935514}-{'f1_val': 0.14142628205128205, 'auprc': 0.7631447064417038, 'loss_val': 1.1922719858830653, 'psi': 0.3901136518074508}
[S7] START round=8 head_norm_before_train=1.503412 (no previous merge yet)
[S7] round=8 local utility u=0.036459 metrics={'f1_val': 0.3995316050099016, 'auprc': 0.7724032575020544, 'loss_val': 0.975987553666986, 'psi': 0.5486802660067628}-{'f1_val': 0.3778853612367726, 'auprc': 0.7732726935063995, 'loss_val': 0.9216371655580176, 'psi': 0.5360402941446234}
[S8] START round=8 head_norm_before_train=1.369243 (no previous merge yet)
[S8] round=8 local utility u=0.133759 metrics={'f1_val': 0.3731326739016295, 'auprc': 0.8646499111162418, 'loss_val': 0.8968173667198329, 'psi': 0.5697395687874744}-{'f1_val': 0.3726652774371328, 'auprc': 0.7764130738809982, 'loss_val': 0.8968209150641562, 'psi': 0.5341643960146789}
[S9] START round=8 head_norm_before_train=0.848430 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.012062 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.998429294008282, 'loss_val': 0.425817547371615, 'psi': 0.8201905182348184}-{'f1_val': 0.7013646677191758, 'auprc': 0.9984244997889659, 'loss_val': 0.44992756941775625, 'psi': 0.8201886005470919}
[S10] START round=8 head_norm_before_train=1.409073 (no previous merge yet)
[S10] round=8 local utility u=0.974515 metrics={'f1_val': 0.7016946595131214, 'auprc': 0.8654566458161735, 'loss_val': 0.6378788145501696, 'psi': 0.7671994540343423}-{'f1_val': 0.4114242575428734, 'auprc': 0.8573496666309489, 'loss_val': 0.8209661043864626, 'psi': 0.5897944211781037}
[S11] START round=8 head_norm_before_train=0.936695 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.077969 metrics={'f1_val': 0.4032058630539166, 'auprc': 0.991309558149571, 'loss_val': 0.7179261159593342, 'psi': 0.6384473410921784}-{'f1_val': 0.3907478305924216, 'auprc': 0.9957090571371541, 'loss_val': 0.8123153389201557, 'psi': 0.6327323212103145}
[S13] START round=8 head_norm_before_train=1.315532 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.41519440521463746, 'auprc': 0.5153789820771361, 'loss_val': 0.9934916613573116, 'psi': 0.4552682359596369}-{'f1_val': 0.416200286011302, 'auprc': 0.5253747502773413, 'loss_val': 1.0208900572528132, 'psi': 0.45987007171771765}
[S14] START round=8 head_norm_before_train=1.291990 cos_to_last_merge=0.9974 (last merge round=6)
[S14] round=8 local utility u=0.385495 metrics={'f1_val': 0.23055619684887385, 'auprc': 0.9920960355805627, 'loss_val': 1.048812536270169, 'psi': 0.5351721323415494}-{'f1_val': 0.14035785288270378, 'auprc': 0.9583464511797388, 'loss_val': 1.1773630326137392, 'psi': 0.4675532922015178}
[S15] START round=8 head_norm_before_train=1.387365 (no previous merge yet)
[S15] round=8 local utility u=0.204384 metrics={'f1_val': 0.3914556440736586, 'auprc': 0.927811566311489, 'loss_val': 0.7536205834117714, 'psi': 0.6059980129687907}-{'f1_val': 0.4170305028984703, 'auprc': 0.7818861876386727, 'loss_val': 0.8780606547442232, 'psi': 0.5629727767945513}
[S16] START round=8 head_norm_before_train=0.647406 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.040785 metrics={'f1_val': 0.41930646242860165, 'auprc': 0.5420075256003041, 'loss_val': 1.0961468027814185, 'psi': 0.46838688769728265}-{'f1_val': 0.41684138078021116, 'auprc': 0.5331046238374553, 'loss_val': 1.136217748861987, 'psi': 0.4633466780031088}
[S17] START round=8 head_norm_before_train=1.336961 (no previous merge yet)
[S17] round=8 local utility u=0.074466 metrics={'f1_val': 0.35342870760485867, 'auprc': 0.7970587272310743, 'loss_val': 0.9129001583586969, 'psi': 0.530880715455345}-{'f1_val': 0.39658425346854415, 'auprc': 0.670822723124555, 'loss_val': 0.9420571685423202, 'psi': 0.5062796413309485}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=0.7033
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=0.3757
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=-0.0263
[S14] DROPPED delta from S9 (cos=-0.0263 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S8
[S7] cosine check vs S8: cos=-0.0541
[S7] DROPPED delta from S8 (cos=-0.0541 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.9587
[S9] RECEIVED delta(kind=head bytes=1795) from S11
[S9] cosine check vs S11: cos=0.6356
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[S14] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S14
[S5] cosine check vs S14: cos=0.2963
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.4375
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:38507
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] cosine check vs S16: cos=0.8408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38516
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=0.7641
[S5] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.8940
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.1414 head_norm=0.631314
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.850479e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.1673 head_norm=0.625687 delta_norm=0.185048
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7014 head_norm=0.939456
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.371577e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7014 head_norm=0.919185 delta_norm=0.237158
[S9] aggregate: ACCEPT kept=['S11', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.7008 head_norm=0.712721
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.845184e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.7008 head_norm=0.677631 delta_norm=0.184518
[S5] aggregate: ACCEPT kept=['S2', 'S10', 'S14', 'S15'] (k=4/4) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.2306 head_norm=1.315177
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.304163e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3705 head_norm=1.407948 delta_norm=0.230416
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4193 head_norm=0.672976
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.606607e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4273 head_norm=0.674257 delta_norm=0.160661
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.095139 cos_to_last_merge=0.9379 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.938
[S2] round=9 local utility u=0.134942 metrics={'f1_val': 0.7144564396016401, 'auprc': 0.7786687275820461, 'loss_val': 0.8055132667650068, 'psi': 0.7401413547938025}-{'f1_val': 0.7012811618205921, 'auprc': 0.6964968094489965, 'loss_val': 0.7498289246345667, 'psi': 0.6993674208719538}
[S3] START round=9 head_norm_before_train=1.367846 cos_to_last_merge=0.8534 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.853
[S3] round=9 local utility u=0.501195 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9916285947702188, 'loss_val': 0.304419803113003, 'psi': 0.8168499893200047}-{'f1_val': 0.6007004521553635, 'auprc': 0.9215180121278465, 'loss_val': 0.49869610796005914, 'psi': 0.7290274761443567}
[S4] START round=9 head_norm_before_train=0.637942 cos_to_last_merge=0.9918 (last merge round=7)
[S4] round=9 local utility u=0.089721 metrics={'f1_val': 0.6495520489414365, 'auprc': 0.7175589157308544, 'loss_val': 0.7475234267722088, 'psi': 0.6767547956572036}-{'f1_val': 0.6688979015642553, 'auprc': 0.6599872813433063, 'loss_val': 0.8703249900302844, 'psi': 0.6653336534758758}
[S5] START round=9 head_norm_before_train=0.677631 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.033449 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.6751565463806201, 'loss_val': 0.6300454619878121, 'psi': 0.6904037245550391}-{'f1_val': 0.7008168588441903, 'auprc': 0.669635620270362, 'loss_val': 0.6818710644907346, 'psi': 0.6883443634146591}
[S6] START round=9 head_norm_before_train=0.625687 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.553645 metrics={'f1_val': 0.27648701332911857, 'auprc': 0.6879691359848203, 'loss_val': 1.0901825548670125, 'psi': 0.4410798623913993}-{'f1_val': 0.14142628205128205, 'auprc': 0.6135234014069554, 'loss_val': 1.163771565011445, 'psi': 0.3302651297935514}
[S7] START round=9 head_norm_before_train=1.530074 (no previous merge yet)
[S7] round=9 local utility u=1.000000 metrics={'f1_val': 0.6611827313737583, 'auprc': 0.8154772388764536, 'loss_val': 0.5335333338561996, 'psi': 0.7229005343748365}-{'f1_val': 0.3995316050099016, 'auprc': 0.7724032575020544, 'loss_val': 0.975987553666986, 'psi': 0.5486802660067628}
[S8] START round=9 head_norm_before_train=1.402933 (no previous merge yet)
[S8] round=9 local utility u=0.022104 metrics={'f1_val': 0.3729988868650071, 'auprc': 0.8649930363312491, 'loss_val': 0.852836861527156, 'psi': 0.5697965466515039}-{'f1_val': 0.3731326739016295, 'auprc': 0.8646499111162418, 'loss_val': 0.8968173667198329, 'psi': 0.5697395687874744}
[S9] START round=9 head_norm_before_train=0.919185 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.011938 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9964810101480581, 'loss_val': 0.3960964154303635, 'psi': 0.8194112046907287}-{'f1_val': 0.7013646677191758, 'auprc': 0.998429294008282, 'loss_val': 0.425817547371615, 'psi': 0.8201905182348184}
[S10] START round=9 head_norm_before_train=1.452950 (no previous merge yet)
[S10] round=9 local utility u=0.220778 metrics={'f1_val': 0.7008219242649836, 'auprc': 0.9711726081221459, 'loss_val': 0.5082335952831144, 'psi': 0.8089621978078485}-{'f1_val': 0.7016946595131214, 'auprc': 0.8654566458161735, 'loss_val': 0.6378788145501696, 'psi': 0.7671994540343423}
[S11] START round=9 head_norm_before_train=0.988140 cos_to_last_merge=0.9958 (last merge round=7)
[S11] round=9 local utility u=0.873762 metrics={'f1_val': 0.6864977544389914, 'auprc': 0.9623656907437984, 'loss_val': 0.5833213566100911, 'psi': 0.7968449289609142}-{'f1_val': 0.4032058630539166, 'auprc': 0.991309558149571, 'loss_val': 0.7179261159593342, 'psi': 0.6384473410921784}
[S13] START round=9 head_norm_before_train=1.352229 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.37433734666320495, 'auprc': 0.5047047555950137, 'loss_val': 1.0102226313111264, 'psi': 0.4264843102359285}-{'f1_val': 0.41519440521463746, 'auprc': 0.5153789820771361, 'loss_val': 0.9934916613573116, 'psi': 0.4552682359596369}
[S14] START round=9 head_norm_before_train=1.407948 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=1.000000 metrics={'f1_val': 0.954322235815622, 'auprc': 0.9948814907392008, 'loss_val': 0.8873507398339341, 'psi': 0.9705459377850536}-{'f1_val': 0.23055619684887385, 'auprc': 0.9920960355805627, 'loss_val': 1.048812536270169, 'psi': 0.5351721323415494}
[S15] START round=9 head_norm_before_train=1.424285 (no previous merge yet)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.4174120492044242, 'auprc': 0.6644238985652112, 'loss_val': 0.8206664035429229, 'psi': 0.516216788948739}-{'f1_val': 0.3914556440736586, 'auprc': 0.927811566311489, 'loss_val': 0.7536205834117714, 'psi': 0.6059980129687907}
[S16] START round=9 head_norm_before_train=0.674257 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.064928 metrics={'f1_val': 0.43654077672147906, 'auprc': 0.5413899766646246, 'loss_val': 1.0678446477847963, 'psi': 0.4784804566987373}-{'f1_val': 0.41930646242860165, 'auprc': 0.5420075256003041, 'loss_val': 1.0961468027814185, 'psi': 0.46838688769728265}
[S17] START round=9 head_norm_before_train=1.375467 (no previous merge yet)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.3463470314481204, 'auprc': 0.7519614561469291, 'loss_val': 1.02587517708535, 'psi': 0.508592801327644}-{'f1_val': 0.35342870760485867, 'auprc': 0.7970587272310743, 'loss_val': 0.9129001583586969, 'psi': 0.530880715455345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:38505
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:38507
[S4] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.9205
[S4] RECEIVED delta(kind=head bytes=1800) from S6
[S4] cosine check vs S6: cos=0.3914
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=-0.0282
[S14] DROPPED delta from S9 (cos=-0.0282 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1805) from S14
[S5] cosine check vs S14: cos=0.3650
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.9816
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] cosine check vs S16: cos=0.9017
[S9] RECEIVED delta(kind=head bytes=1793) from S11
[S9] cosine check vs S11: cos=0.6492
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.8023
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=0.4258
[S7] RECEIVED delta(kind=head bytes=1797) from S8
[S7] cosine check vs S8: cos=-0.0553
[S7] DROPPED delta from S8 (cos=-0.0553 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] cosine check vs S3: cos=0.3044
[S5] RECEIVED delta(kind=head bytes=1798) from S2
[S5] cosine check vs S2: cos=0.6642
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.4365 head_norm=0.704612
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.479603e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.4289 head_norm=0.716308 delta_norm=0.147960
[S16] aggregate: ROLLBACK (f1_val pre=0.437 post=0.429 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.7006 head_norm=0.757299
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.345943e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.7006 head_norm=0.718904 delta_norm=0.234594
[S5] aggregate: ACCEPT kept=['S14', 'S10', 'S3', 'S2'] (k=4/4) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.6865 head_norm=1.044665
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.174620e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.7017 head_norm=0.838478 delta_norm=0.317462
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.7014 head_norm=1.006832
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.299114e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7014 head_norm=0.931501 delta_norm=0.429911
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.2765 head_norm=0.655262
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.526825e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.1675 head_norm=0.663032 delta_norm=0.152683
[S6] aggregate: ROLLBACK (f1_val pre=0.276 post=0.167 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6496 head_norm=0.718562
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.798360e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.3807 head_norm=0.573214 delta_norm=0.379836
[S4] aggregate: ROLLBACK (f1_val pre=0.650 post=0.381 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.9543 head_norm=1.435252
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.557092e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.9964 head_norm=1.489378 delta_norm=0.155709
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.150367 cos_to_last_merge=0.9227 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.923
[S2] round=10 local utility u=0.078297 metrics={'f1_val': 0.7035449356215242, 'auprc': 0.779278547139956, 'loss_val': 0.5852800305809827, 'psi': 0.7338383802288969}-{'f1_val': 0.7144564396016401, 'auprc': 0.7786687275820461, 'loss_val': 0.8055132667650068, 'psi': 0.7401413547938025}
[S3] START round=10 head_norm_before_train=1.440098 cos_to_last_merge=0.8372 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.837
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.5320155589703793, 'auprc': 0.8359826348270054, 'loss_val': 0.7323818501925478, 'psi': 0.6536023893130298}-{'f1_val': 0.700330919019862, 'auprc': 0.9916285947702188, 'loss_val': 0.304419803113003, 'psi': 0.8168499893200047}
[S4] START round=10 head_norm_before_train=0.573214 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.3755896401856021, 'auprc': 0.745656946460554, 'loss_val': 0.7992047817885963, 'psi': 0.5236165626955829}-{'f1_val': 0.6495520489414365, 'auprc': 0.7175589157308544, 'loss_val': 0.7475234267722088, 'psi': 0.6767547956572036}
[S5] START round=10 head_norm_before_train=0.718904 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.025918 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.6625275008180443, 'loss_val': 0.538839882917094, 'psi': 0.685203790787566}-{'f1_val': 0.7005685100046517, 'auprc': 0.6751565463806201, 'loss_val': 0.6300454619878121, 'psi': 0.6904037245550391}
[S6] START round=10 head_norm_before_train=0.663032 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.656111 metrics={'f1_val': 0.4341466113622319, 'auprc': 0.7768838277253407, 'loss_val': 0.9906630355308569, 'psi': 0.5712414979074755}-{'f1_val': 0.27648701332911857, 'auprc': 0.6879691359848203, 'loss_val': 1.0901825548670125, 'psi': 0.4410798623913993}
[S7] START round=10 head_norm_before_train=1.557253 (no previous merge yet)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.6115622396209368, 'auprc': 0.7824422796437819, 'loss_val': 0.6823018602972273, 'psi': 0.6799142556300748}-{'f1_val': 0.6611827313737583, 'auprc': 0.8154772388764536, 'loss_val': 0.5335333338561996, 'psi': 0.7229005343748365}
[S8] START round=10 head_norm_before_train=1.437215 (no previous merge yet)
[S8] round=10 local utility u=0.061830 metrics={'f1_val': 0.3728649953480749, 'auprc': 0.8661699964898768, 'loss_val': 0.7319035875655213, 'psi': 0.5701869958047956}-{'f1_val': 0.3729988868650071, 'auprc': 0.8649930363312491, 'loss_val': 0.852836861527156, 'psi': 0.5697965466515039}
[S9] START round=10 head_norm_before_train=0.931501 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.008798 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9963351557796641, 'loss_val': 0.37806384395654813, 'psi': 0.8193528629433712}-{'f1_val': 0.7013646677191758, 'auprc': 0.9964810101480581, 'loss_val': 0.3960964154303635, 'psi': 0.8194112046907287}
[S10] START round=10 head_norm_before_train=1.501653 (no previous merge yet)
[S10] round=10 local utility u=0.057510 metrics={'f1_val': 0.6896869148777132, 'auprc': 0.9975097674474154, 'loss_val': 0.40541467651258933, 'psi': 0.812816055905594}-{'f1_val': 0.7008219242649836, 'auprc': 0.9711726081221459, 'loss_val': 0.5082335952831144, 'psi': 0.8089621978078485}
[S11] START round=10 head_norm_before_train=0.838478 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.041004 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9429829807009856, 'loss_val': 0.5343386157459656, 'psi': 0.7982092800325491}-{'f1_val': 0.6864977544389914, 'auprc': 0.9623656907437984, 'loss_val': 0.5833213566100911, 'psi': 0.7968449289609142}
[S13] START round=10 head_norm_before_train=1.391143 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.35958055087218105, 'auprc': 0.5023546067929637, 'loss_val': 0.9437477829030444, 'psi': 0.4166901732404942}-{'f1_val': 0.37433734666320495, 'auprc': 0.5047047555950137, 'loss_val': 1.0102226313111264, 'psi': 0.4264843102359285}
[S14] START round=10 head_norm_before_train=1.489378 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.212663 metrics={'f1_val': 0.9973656831533881, 'auprc': 0.9935375297306994, 'loss_val': 0.7162529287080869, 'psi': 0.9958344217843127}-{'f1_val': 0.954322235815622, 'auprc': 0.9948814907392008, 'loss_val': 0.8873507398339341, 'psi': 0.9705459377850536}
[S15] START round=10 head_norm_before_train=1.455620 (no previous merge yet)
[S15] round=10 local utility u=0.436992 metrics={'f1_val': 0.43748228581968224, 'auprc': 0.8755343476589983, 'loss_val': 0.7004356733330065, 'psi': 0.6127031105554086}-{'f1_val': 0.4174120492044242, 'auprc': 0.6644238985652112, 'loss_val': 0.8206664035429229, 'psi': 0.516216788948739}
[S16] START round=10 head_norm_before_train=0.716308 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.4364769592962116, 'auprc': 0.5343599302909945, 'loss_val': 1.053416999691119, 'psi': 0.4756301476941248}-{'f1_val': 0.43654077672147906, 'auprc': 0.5413899766646246, 'loss_val': 1.0678446477847963, 'psi': 0.4784804566987373}
[S17] START round=10 head_norm_before_train=1.410757 (no previous merge yet)
[S17] round=10 local utility u=0.101629 metrics={'f1_val': 0.3519909574605653, 'auprc': 0.7631709208725782, 'loss_val': 0.8901091555442169, 'psi': 0.5164629428253705}-{'f1_val': 0.3463470314481204, 'auprc': 0.7519614561469291, 'loss_val': 1.02587517708535, 'psi': 0.508592801327644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:38504
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:38514
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38505
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=0.2846
[S5] RECEIVED delta(kind=head bytes=1796) from S2
[S5] cosine check vs S2: cos=0.7151
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.9287
[S4] RECEIVED delta(kind=head bytes=1798) from S6
[S4] cosine check vs S6: cos=0.6976
[S14] RECEIVED delta(kind=head bytes=1795) from S9
[S14] cosine check vs S9: cos=0.0134
[S7] RECEIVED delta(kind=head bytes=1797) from S8
[S7] cosine check vs S8: cos=-0.0562
[S7] DROPPED delta from S8 (cos=-0.0562 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] cosine check vs S11: cos=0.8395
[S5] RECEIVED delta(kind=head bytes=1804) from S14
[S5] cosine check vs S14: cos=0.3661
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=0.4449
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.5751
[S3] ⇄ pheromone p=0.353 → S5@127.0.0.1:38505
[S13] ⇄ pheromone p=0.183 → S9@127.0.0.1:38510
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.3756 head_norm=0.642130
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.604162e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.3746 head_norm=0.614686 delta_norm=0.260416
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.236 → S11@127.0.0.1:38512
[S7] ⇄ pheromone p=0.390 → S14@127.0.0.1:38514
[S11] ⇄ pheromone p=0.370 → S9@127.0.0.1:38510
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7003 head_norm=0.802698
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.036097e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7003 head_norm=0.750734 delta_norm=0.203610
[S5] aggregate: ACCEPT kept=['S15', 'S2', 'S14', 'S10'] (k=4/4) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.237 → S16@127.0.0.1:38516
[S15] ⇄ pheromone p=0.314 → S5@127.0.0.1:38505
[S2] ⇄ pheromone p=0.350 → S5@127.0.0.1:38505
[S6] ⇄ pheromone p=0.385 → S4@127.0.0.1:38504
[S8] ⇄ pheromone p=0.287 → S7@127.0.0.1:38508
[S10] ⇄ pheromone p=0.392 → S5@127.0.0.1:38505
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7014 head_norm=1.014310
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.758075e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7014 head_norm=0.937659 delta_norm=0.275807
[S9] aggregate: ACCEPT kept=['S11', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.214 → S14@127.0.0.1:38514
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.9974 head_norm=1.521957
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.088252e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.9982 head_norm=0.920122 delta_norm=0.908825
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.414 → S5@127.0.0.1:38505
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.4365 head_norm=0.749948
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.488836e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3823 head_norm=0.762369 delta_norm=0.148884
[S16] aggregate: ROLLBACK (f1_val pre=0.436 post=0.382 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.185 → S6@127.0.0.1:38507
[S17] ⇄ pheromone p=0.233 → S9@127.0.0.1:38510
[S2] START round=11 head_norm_before_train=1.205278 cos_to_last_merge=0.9097 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.910
[S2] round=11 local utility u=0.043787 metrics={'f1_val': 0.7001215862290263, 'auprc': 0.7800821398700741, 'loss_val': 0.4795766227847051, 'psi': 0.7321058076854454}-{'f1_val': 0.7035449356215242, 'auprc': 0.779278547139956, 'loss_val': 0.5852800305809827, 'psi': 0.7338383802288969}
[S3] START round=11 head_norm_before_train=1.490694 cos_to_last_merge=0.8268 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.827
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.4709468320346653, 'auprc': 0.7975276107403395, 'loss_val': 0.8755773805528341, 'psi': 0.601579143516935}-{'f1_val': 0.5320155589703793, 'auprc': 0.8359826348270054, 'loss_val': 0.7323818501925478, 'psi': 0.6536023893130298}
[S4] START round=11 head_norm_before_train=0.614686 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.114344 metrics={'f1_val': 0.3815759882014209, 'auprc': 0.8160730947603776, 'loss_val': 0.817683447338383, 'psi': 0.5553748308250036}-{'f1_val': 0.3755896401856021, 'auprc': 0.745656946460554, 'loss_val': 0.7992047817885963, 'psi': 0.5236165626955829}
[S5] START round=11 head_norm_before_train=0.750734 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.006467 metrics={'f1_val': 0.700323158105602, 'auprc': 0.6627855440067134, 'loss_val': 0.5266915130695065, 'psi': 0.6853081124660465}-{'f1_val': 0.7003213174339138, 'auprc': 0.6625275008180443, 'loss_val': 0.538839882917094, 'psi': 0.685203790787566}
[S6] START round=11 head_norm_before_train=0.692084 cos_to_last_merge=0.9931 (last merge round=9)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.4158432846376109, 'auprc': 0.7692655375450765, 'loss_val': 0.8779381554667589, 'psi': 0.5572121858005972}-{'f1_val': 0.4341466113622319, 'auprc': 0.7768838277253407, 'loss_val': 0.9906630355308569, 'psi': 0.5712414979074755}
[S7] START round=11 head_norm_before_train=1.578434 (no previous merge yet)
[S7] round=11 local utility u=0.184489 metrics={'f1_val': 0.644271520449096, 'auprc': 0.7985488583912644, 'loss_val': 0.5578993633457604, 'psi': 0.7059824556259633}-{'f1_val': 0.6115622396209368, 'auprc': 0.7824422796437819, 'loss_val': 0.6823018602972273, 'psi': 0.6799142556300748}
[S8] START round=11 head_norm_before_train=1.475750 (no previous merge yet)
[S8] round=11 local utility u=0.308987 metrics={'f1_val': 0.37396411929138307, 'auprc': 0.9932429828337349, 'loss_val': 0.5017435330990728, 'psi': 0.6216756647083238}-{'f1_val': 0.3728649953480749, 'auprc': 0.8661699964898768, 'loss_val': 0.7319035875655213, 'psi': 0.5701869958047956}
[S9] START round=11 head_norm_before_train=0.937659 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.023303 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9960851153010815, 'loss_val': 0.3307074043164977, 'psi': 0.8192528467519381}-{'f1_val': 0.7013646677191758, 'auprc': 0.9963351557796641, 'loss_val': 0.37806384395654813, 'psi': 0.8193528629433712}
[S10] START round=11 head_norm_before_train=1.552052 (no previous merge yet)
[S10] round=11 local utility u=0.024029 metrics={'f1_val': 0.689287422803073, 'auprc': 0.9936514198596362, 'loss_val': 0.3433852992583909, 'psi': 0.8110330216256982}-{'f1_val': 0.6896869148777132, 'auprc': 0.9975097674474154, 'loss_val': 0.40541467651258933, 'psi': 0.812816055905594}
[S11] START round=11 head_norm_before_train=0.897770 cos_to_last_merge=0.9962 (last merge round=9)
[S11] round=11 local utility u=0.102442 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9854804066377434, 'loss_val': 0.4587901107598299, 'psi': 0.8153926282226366}-{'f1_val': 0.7016934795869249, 'auprc': 0.9429829807009856, 'loss_val': 0.5343386157459656, 'psi': 0.7982092800325491}
[S13] START round=11 head_norm_before_train=1.429097 (no previous merge yet)
[S13] round=11 local utility u=0.521007 metrics={'f1_val': 0.5053810074998063, 'auprc': 0.5442297473954634, 'loss_val': 0.9021624608347522, 'psi': 0.5209205034580691}-{'f1_val': 0.35958055087218105, 'auprc': 0.5023546067929637, 'loss_val': 0.9437477829030444, 'psi': 0.4166901732404942}
[S14] START round=11 head_norm_before_train=0.920122 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.9243896101454301, 'auprc': 0.9927821250694214, 'loss_val': 0.7872917051015111, 'psi': 0.9517466161150265}-{'f1_val': 0.9973656831533881, 'auprc': 0.9935375297306994, 'loss_val': 0.7162529287080869, 'psi': 0.9958344217843127}
[S15] START round=11 head_norm_before_train=1.488488 (no previous merge yet)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.43743303554081, 'auprc': 0.8204007648229523, 'loss_val': 0.6850995106346168, 'psi': 0.5906201272536669}-{'f1_val': 0.43748228581968224, 'auprc': 0.8755343476589983, 'loss_val': 0.7004356733330065, 'psi': 0.6127031105554086}
[S16] START round=11 head_norm_before_train=0.762369 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.3536804090780925, 'auprc': 0.5437727902874956, 'loss_val': 1.0523713519057443, 'psi': 0.4297173615618537}-{'f1_val': 0.4364769592962116, 'auprc': 0.5343599302909945, 'loss_val': 1.053416999691119, 'psi': 0.4756301476941248}
[S17] START round=11 head_norm_before_train=1.442996 (no previous merge yet)
[S17] round=11 local utility u=0.044719 metrics={'f1_val': 0.35312879537120345, 'auprc': 0.7899884128602903, 'loss_val': 0.8879507697060626, 'psi': 0.5278726423668382}-{'f1_val': 0.3519909574605653, 'auprc': 0.7631709208725782, 'loss_val': 0.8901091555442169, 'psi': 0.5164629428253705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:38512
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38516
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S2
[S5] cosine check vs S2: cos=0.6819
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.9512
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.8319
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.4912
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] cosine check vs S8: cos=-0.0564
[S7] DROPPED delta from S8 (cos=-0.0564 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=0.2473
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=0.5552
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] cosine check vs S11: cos=0.7421
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.4786
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.7301
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.9244 head_norm=0.957995
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.149717e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.9606 head_norm=0.943503 delta_norm=0.114972
[S14] aggregate: ACCEPT kept=['S7', 'S9'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7020 head_norm=0.960953
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.055243e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7019 head_norm=0.722944 delta_norm=0.405524
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7014 head_norm=1.023242
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.463435e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7014 head_norm=0.892996 delta_norm=0.246343
[S9] aggregate: ACCEPT kept=['S13', 'S11', 'S17'] (k=3/3) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7003 head_norm=0.814943
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.487221e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7003 head_norm=0.884452 delta_norm=0.348722
[S5] aggregate: ACCEPT kept=['S2', 'S10'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.3537 head_norm=0.801437
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.263666e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.3783 head_norm=0.798278 delta_norm=0.126367
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.257810 cos_to_last_merge=0.8985 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.899
[S2] round=12 local utility u=0.039474 metrics={'f1_val': 0.6994076265853314, 'auprc': 0.7817649765965925, 'loss_val': 0.4013925210826471, 'psi': 0.7323505665898358}-{'f1_val': 0.7001215862290263, 'auprc': 0.7800821398700741, 'loss_val': 0.4795766227847051, 'psi': 0.7321058076854454}
[S3] START round=12 head_norm_before_train=1.533545 cos_to_last_merge=0.8192 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.819
[S3] round=12 local utility u=0.712777 metrics={'f1_val': 0.6050756774701895, 'auprc': 0.8941993273151008, 'loss_val': 0.5448125375984126, 'psi': 0.720725137408154}-{'f1_val': 0.4709468320346653, 'auprc': 0.7975276107403395, 'loss_val': 0.8755773805528341, 'psi': 0.601579143516935}
[S4] START round=12 head_norm_before_train=0.671392 cos_to_last_merge=0.9839 (last merge round=10)
[S4] round=12 local utility u=0.944773 metrics={'f1_val': 0.657903703922384, 'auprc': 0.8554856164072159, 'loss_val': 0.7043411355147692, 'psi': 0.7369364689163167}-{'f1_val': 0.3815759882014209, 'auprc': 0.8160730947603776, 'loss_val': 0.817683447338383, 'psi': 0.5553748308250036}
[S5] START round=12 head_norm_before_train=0.884452 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.040370 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.6708991398593975, 'loss_val': 0.4702812017741053, 'psi': 0.6885524464041073}-{'f1_val': 0.700323158105602, 'auprc': 0.6627855440067134, 'loss_val': 0.5266915130695065, 'psi': 0.6853081124660465}
[S6] START round=12 head_norm_before_train=0.733186 cos_to_last_merge=0.9758 (last merge round=9)
[S6] round=12 local utility u=0.692508 metrics={'f1_val': 0.6198187576752905, 'auprc': 0.7784056433322262, 'loss_val': 0.7441957032512017, 'psi': 0.6832535119380647}-{'f1_val': 0.4158432846376109, 'auprc': 0.7692655375450765, 'loss_val': 0.8779381554667589, 'psi': 0.5572121858005972}
[S7] START round=12 head_norm_before_train=1.596599 (no previous merge yet)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.5020843284981004, 'auprc': 0.7788286735782597, 'loss_val': 0.900115305827393, 'psi': 0.6127820665301641}-{'f1_val': 0.644271520449096, 'auprc': 0.7985488583912644, 'loss_val': 0.5578993633457604, 'psi': 0.7059824556259633}
[S8] START round=12 head_norm_before_train=1.516254 (no previous merge yet)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.37266438550987346, 'auprc': 0.9931155502346902, 'loss_val': 0.5015252401044252, 'psi': 0.6208448513998002}-{'f1_val': 0.37396411929138307, 'auprc': 0.9932429828337349, 'loss_val': 0.5017435330990728, 'psi': 0.6216756647083238}
[S9] START round=12 head_norm_before_train=0.892996 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.013017 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9958773380889416, 'loss_val': 0.3040491976993876, 'psi': 0.8191697358670822}-{'f1_val': 0.7013646677191758, 'auprc': 0.9960851153010815, 'loss_val': 0.3307074043164977, 'psi': 0.8192528467519381}
[S10] START round=12 head_norm_before_train=1.595594 (no previous merge yet)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.6840780388290802, 'auprc': 0.9559054296029083, 'loss_val': 0.323171785798904, 'psi': 0.7928089951386115}-{'f1_val': 0.689287422803073, 'auprc': 0.9936514198596362, 'loss_val': 0.3433852992583909, 'psi': 0.8110330216256982}
[S11] START round=12 head_norm_before_train=0.722944 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9978292425598116, 'loss_val': 0.5052956734525431, 'psi': 0.8201477847760796}-{'f1_val': 0.7020007759458987, 'auprc': 0.9854804066377434, 'loss_val': 0.4587901107598299, 'psi': 0.8153926282226366}
[S13] START round=12 head_norm_before_train=1.460687 (no previous merge yet)
[S13] round=12 local utility u=0.251624 metrics={'f1_val': 0.5660699238683209, 'auprc': 0.5590389292423196, 'loss_val': 0.8074747275571686, 'psi': 0.5632575260179203}-{'f1_val': 0.5053810074998063, 'auprc': 0.5442297473954634, 'loss_val': 0.9021624608347522, 'psi': 0.5209205034580691}
[S14] START round=12 head_norm_before_train=0.943503 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.094128 metrics={'f1_val': 0.9280279764997064, 'auprc': 0.9934104469274844, 'loss_val': 0.622750118189838, 'psi': 0.9541809646708175}-{'f1_val': 0.9243896101454301, 'auprc': 0.9927821250694214, 'loss_val': 0.7872917051015111, 'psi': 0.9517466161150265}
[S15] START round=12 head_norm_before_train=1.522161 (no previous merge yet)
[S15] round=12 local utility u=0.039890 metrics={'f1_val': 0.43748228581968224, 'auprc': 0.8293094447234414, 'loss_val': 0.6323409835037939, 'psi': 0.594213149381186}-{'f1_val': 0.43743303554081, 'auprc': 0.8204007648229523, 'loss_val': 0.6850995106346168, 'psi': 0.5906201272536669}
[S16] START round=12 head_norm_before_train=0.798278 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.054790 metrics={'f1_val': 0.3815434431287199, 'auprc': 0.5277206972011559, 'loss_val': 1.0618125932076394, 'psi': 0.4400143447576943}-{'f1_val': 0.3536804090780925, 'auprc': 0.5437727902874956, 'loss_val': 1.0523713519057443, 'psi': 0.4297173615618537}
[S17] START round=12 head_norm_before_train=1.465660 (no previous merge yet)
[S17] round=12 local utility u=0.000808 metrics={'f1_val': 0.35236581484865914, 'auprc': 0.8001559223698306, 'loss_val': 0.9122593483480052, 'psi': 0.5314818578571278}-{'f1_val': 0.35312879537120345, 'auprc': 0.7899884128602903, 'loss_val': 0.8879507697060626, 'psi': 0.5278726423668382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:38514
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=0.4225
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=0.8432
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.2077
[S5] RECEIVED delta(kind=head bytes=1797) from S3
[S5] cosine check vs S3: cos=0.2477
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.9106
[S5] RECEIVED delta(kind=head bytes=1797) from S2
[S5] cosine check vs S2: cos=0.7209
[S4] RECEIVED delta(kind=head bytes=1801) from S6
[S4] cosine check vs S6: cos=0.7768
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] cosine check vs S16: cos=0.8219
[S14] RECEIVED delta(kind=head bytes=1794) from S9
[S14] cosine check vs S9: cos=0.4661
[S5] RECEIVED delta(kind=head bytes=1791) from S14
[S5] cosine check vs S14: cos=0.1687
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=0.6972
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7017 head_norm=0.787261
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.156447e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.9552 head_norm=0.736252 delta_norm=0.215645
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6579 head_norm=0.746565
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.569267e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.4205 head_norm=0.722980 delta_norm=0.256927
[S4] aggregate: ROLLBACK (f1_val pre=0.658 post=0.421 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.6198 head_norm=0.787442
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.438304e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.6181 head_norm=0.776077 delta_norm=0.243830
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9280 head_norm=0.990678
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.086256e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.9966 head_norm=0.842832 delta_norm=0.508626
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.3815 head_norm=0.838709
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.931164e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.3745 head_norm=0.866375 delta_norm=0.193116
[S16] aggregate: ROLLBACK (f1_val pre=0.382 post=0.375 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7003 head_norm=0.934005
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.726776e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7003 head_norm=0.762298 delta_norm=0.372678
[S5] aggregate: ACCEPT kept=['S15', 'S3', 'S2', 'S14'] (k=4/4) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7014 head_norm=0.978105
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.627256e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7014 head_norm=0.972302 delta_norm=0.362726
[S9] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.300509 cos_to_last_merge=0.8889 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.889
[S2] round=13 local utility u=0.025842 metrics={'f1_val': 0.6998613151798172, 'auprc': 0.7826119995887771, 'loss_val': 0.3549717624750001, 'psi': 0.7329615889434011}-{'f1_val': 0.6994076265853314, 'auprc': 0.7817649765965925, 'loss_val': 0.4013925210826471, 'psi': 0.7323505665898358}
[S3] START round=13 head_norm_before_train=1.567872 cos_to_last_merge=0.8147 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.815
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.5212887436967002, 'auprc': 0.832568123382496, 'loss_val': 0.8287698061835017, 'psi': 0.6458004955710186}-{'f1_val': 0.6050756774701895, 'auprc': 0.8941993273151008, 'loss_val': 0.5448125375984126, 'psi': 0.720725137408154}
[S4] START round=13 head_norm_before_train=0.722980 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.6607700291698321, 'auprc': 0.8454596649217873, 'loss_val': 0.7327570745048485, 'psi': 0.7346458834706142}-{'f1_val': 0.657903703922384, 'auprc': 0.8554856164072159, 'loss_val': 0.7043411355147692, 'psi': 0.7369364689163167}
[S5] START round=13 head_norm_before_train=0.762298 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.4177062138068043, 'auprc': 0.7737783978844148, 'loss_val': 0.9394994661177211, 'psi': 0.5601350874378486}-{'f1_val': 0.7003213174339138, 'auprc': 0.6708991398593975, 'loss_val': 0.4702812017741053, 'psi': 0.6885524464041073}
[S6] START round=13 head_norm_before_train=0.776077 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.435975 metrics={'f1_val': 0.7071507414533961, 'auprc': 0.8752127775857819, 'loss_val': 0.6866582602134124, 'psi': 0.7743755559063504}-{'f1_val': 0.6198187576752905, 'auprc': 0.7784056433322262, 'loss_val': 0.7441957032512017, 'psi': 0.6832535119380647}
[S7] START round=13 head_norm_before_train=1.616938 (no previous merge yet)
[S7] round=13 local utility u=0.209128 metrics={'f1_val': 0.5549366558552641, 'auprc': 0.7809468720195181, 'loss_val': 0.805327349775812, 'psi': 0.6453407423209656}-{'f1_val': 0.5020843284981004, 'auprc': 0.7788286735782597, 'loss_val': 0.900115305827393, 'psi': 0.6127820665301641}
[S8] START round=13 head_norm_before_train=1.552211 (no previous merge yet)
[S8] round=13 local utility u=1.000000 metrics={'f1_val': 0.7957813143121878, 'auprc': 0.9933021964948725, 'loss_val': 0.3706781204504025, 'psi': 0.8747896671852617}-{'f1_val': 0.37266438550987346, 'auprc': 0.9931155502346902, 'loss_val': 0.5015252401044252, 'psi': 0.6208448513998002}
[S9] START round=13 head_norm_before_train=0.972302 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.5750321285046149, 'auprc': 0.8612749898975156, 'loss_val': 0.5982889573663102, 'psi': 0.6895292730617752}-{'f1_val': 0.7013646677191758, 'auprc': 0.9958773380889416, 'loss_val': 0.3040491976993876, 'psi': 0.8191697358670822}
[S10] START round=13 head_norm_before_train=1.632177 (no previous merge yet)
[S10] round=13 local utility u=0.109906 metrics={'f1_val': 0.6881466509562315, 'auprc': 0.9949768266269275, 'loss_val': 0.24498506637235254, 'psi': 0.8108787212245099}-{'f1_val': 0.6840780388290802, 'auprc': 0.9559054296029083, 'loss_val': 0.323171785798904, 'psi': 0.7928089951386115}
[S11] START round=13 head_norm_before_train=0.736252 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9962911958193438, 'loss_val': 0.5193947565260673, 'psi': 0.8196776683067295}-{'f1_val': 0.7016934795869249, 'auprc': 0.9978292425598116, 'loss_val': 0.5052956734525431, 'psi': 0.8201477847760796}
[S13] START round=13 head_norm_before_train=1.489540 (no previous merge yet)
[S13] round=13 local utility u=0.425114 metrics={'f1_val': 0.6490511971664891, 'auprc': 0.6253937503994138, 'loss_val': 0.6541978856719642, 'psi': 0.639588218459659}-{'f1_val': 0.5660699238683209, 'auprc': 0.5590389292423196, 'loss_val': 0.8074747275571686, 'psi': 0.5632575260179203}
[S14] START round=13 head_norm_before_train=0.842832 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.091211 metrics={'f1_val': 0.9711060864057185, 'auprc': 0.9932290644250599, 'loss_val': 0.6982534680080839, 'psi': 0.979955277613455}-{'f1_val': 0.9280279764997064, 'auprc': 0.9934104469274844, 'loss_val': 0.622750118189838, 'psi': 0.9541809646708175}
[S15] START round=13 head_norm_before_train=1.553230 (no previous merge yet)
[S15] round=13 local utility u=0.227835 metrics={'f1_val': 0.49335268712089014, 'auprc': 0.8581468815980287, 'loss_val': 0.5984049892860508, 'psi': 0.6392703649117455}-{'f1_val': 0.43748228581968224, 'auprc': 0.8293094447234414, 'loss_val': 0.6323409835037939, 'psi': 0.594213149381186}
[S16] START round=13 head_norm_before_train=0.866375 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.385717 metrics={'f1_val': 0.40078834203991304, 'auprc': 0.7321022782189468, 'loss_val': 1.0189920485759658, 'psi': 0.5333139165115266}-{'f1_val': 0.3815434431287199, 'auprc': 0.5277206972011559, 'loss_val': 1.0618125932076394, 'psi': 0.4400143447576943}
[S17] START round=13 head_norm_before_train=1.484029 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.35267292535303435, 'auprc': 0.7903958930275069, 'loss_val': 0.9488766395532398, 'psi': 0.5277621124228233}-{'f1_val': 0.35236581484865914, 'auprc': 0.8001559223698306, 'loss_val': 0.9122593483480052, 'psi': 0.5314818578571278}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:38507
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:38510
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:38505
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:38504
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S14
[S5] cosine check vs S14: cos=0.2155
[S4] RECEIVED delta(kind=head bytes=1801) from S6
[S4] cosine check vs S6: cos=0.8565
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] cosine check vs S16: cos=0.9133
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] cosine check vs S8: cos=-0.0566
[S7] DROPPED delta from S8 (cos=-0.0566 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=0.4502
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] cosine check vs S13: cos=0.6148
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.5123
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] cosine check vs S15: cos=0.3683
[S5] RECEIVED delta(kind=head bytes=1795) from S2
[S5] cosine check vs S2: cos=0.7786
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.4177 head_norm=0.820626
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.975482e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.4179 head_norm=0.733684 delta_norm=0.197548
[S5] aggregate: ACCEPT kept=['S14', 'S10', 'S15', 'S2'] (k=4/4) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.5750 head_norm=1.041806
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.000758e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.5985 head_norm=1.153576 delta_norm=0.600076
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6608 head_norm=0.778784
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.147041e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6591 head_norm=0.769315 delta_norm=0.214704
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.7072 head_norm=0.818158
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.849738e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.7072 head_norm=0.844123 delta_norm=0.184974
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.9711 head_norm=0.885320
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.023151e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.9290 head_norm=1.111173 delta_norm=0.702315
[S14] aggregate: ROLLBACK (f1_val pre=0.971 post=0.929 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.342227 cos_to_last_merge=0.8782 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.878
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.7007275992706767, 'auprc': 0.7842417983869682, 'loss_val': 0.36785669478438593, 'psi': 0.7341332789171933}-{'f1_val': 0.6998613151798172, 'auprc': 0.7826119995887771, 'loss_val': 0.3549717624750001, 'psi': 0.7329615889434011}
[S3] START round=14 head_norm_before_train=1.592380 cos_to_last_merge=0.8109 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.811
[S3] round=14 local utility u=0.180589 metrics={'f1_val': 0.5485112604878596, 'auprc': 0.8626759684826251, 'loss_val': 0.7212496577068963, 'psi': 0.6741771436857658}-{'f1_val': 0.5212887436967002, 'auprc': 0.832568123382496, 'loss_val': 0.8287698061835017, 'psi': 0.6458004955710186}
[S4] START round=14 head_norm_before_train=0.769315 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.6213284434032923, 'auprc': 0.8938487309831509, 'loss_val': 0.7573329965410803, 'psi': 0.7303365584352357}-{'f1_val': 0.6607700291698321, 'auprc': 0.8454596649217873, 'loss_val': 0.7327570745048485, 'psi': 0.7346458834706142}
[S5] START round=14 head_norm_before_train=0.733684 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.903042 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.6777113620863622, 'loss_val': 0.5426282958113519, 'psi': 0.6914495804321494}-{'f1_val': 0.4177062138068043, 'auprc': 0.7737783978844148, 'loss_val': 0.9394994661177211, 'psi': 0.5601350874378486}
[S6] START round=14 head_norm_before_train=0.844123 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.126391 metrics={'f1_val': 0.7038955189394618, 'auprc': 0.9505045405346353, 'loss_val': 0.640219771740927, 'psi': 0.8025391275775312}-{'f1_val': 0.7071507414533961, 'auprc': 0.8752127775857819, 'loss_val': 0.6866582602134124, 'psi': 0.7743755559063504}
[S7] START round=14 head_norm_before_train=1.634660 (no previous merge yet)
[S7] round=14 local utility u=0.041765 metrics={'f1_val': 0.5611816037480543, 'auprc': 0.7817482095385139, 'loss_val': 0.7616706336399567, 'psi': 0.6494082460642381}-{'f1_val': 0.5549366558552641, 'auprc': 0.7809468720195181, 'loss_val': 0.805327349775812, 'psi': 0.6453407423209656}
[S8] START round=14 head_norm_before_train=1.587742 (no previous merge yet)
[S8] round=14 local utility u=0.679152 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9960065551482251, 'loss_val': 0.22391705389411493, 'psi': 0.9962144670206647}-{'f1_val': 0.7957813143121878, 'auprc': 0.9933021964948725, 'loss_val': 0.3706781204504025, 'psi': 0.8747896671852617}
[S9] START round=14 head_norm_before_train=1.153576 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.739457 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.9968511833488525, 'loss_val': 0.2845464910052254, 'psi': 0.8196039535085138}-{'f1_val': 0.5750321285046149, 'auprc': 0.8612749898975156, 'loss_val': 0.5982889573663102, 'psi': 0.6895292730617752}
[S10] START round=14 head_norm_before_train=1.665990 (no previous merge yet)
[S10] round=14 local utility u=0.027185 metrics={'f1_val': 0.688096275447425, 'auprc': 0.9976278023567675, 'loss_val': 0.19826590375160458, 'psi': 0.8119088862111621}-{'f1_val': 0.6881466509562315, 'auprc': 0.9949768266269275, 'loss_val': 0.24498506637235254, 'psi': 0.8108787212245099}
[S11] START round=14 head_norm_before_train=0.798035 cos_to_last_merge=0.9940 (last merge round=12)
[S11] round=14 local utility u=0.044727 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.996275616376644, 'loss_val': 0.4284426857692851, 'psi': 0.8195263343028125}-{'f1_val': 0.7019353166316534, 'auprc': 0.9962911958193438, 'loss_val': 0.5193947565260673, 'psi': 0.8196776683067295}
[S13] START round=14 head_norm_before_train=1.515353 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5878698859232087, 'auprc': 0.6719623496203853, 'loss_val': 0.7222156351154199, 'psi': 0.6215068714020793}-{'f1_val': 0.6490511971664891, 'auprc': 0.6253937503994138, 'loss_val': 0.6541978856719642, 'psi': 0.639588218459659}
[S14] START round=14 head_norm_before_train=1.111173 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.687481317863798, 'auprc': 0.9963632097687611, 'loss_val': 0.43643058952565494, 'psi': 0.8110340746257833}-{'f1_val': 0.9711060864057185, 'auprc': 0.9932290644250599, 'loss_val': 0.6982534680080839, 'psi': 0.979955277613455}
[S15] START round=14 head_norm_before_train=1.586839 (no previous merge yet)
[S15] round=14 local utility u=0.695224 metrics={'f1_val': 0.6505526498743649, 'auprc': 0.9784045135181935, 'loss_val': 0.511930620026544, 'psi': 0.7816933953318963}-{'f1_val': 0.49335268712089014, 'auprc': 0.8581468815980287, 'loss_val': 0.5984049892860508, 'psi': 0.6392703649117455}
[S16] START round=14 head_norm_before_train=0.907819 cos_to_last_merge=0.9957 (last merge round=12)
[S16] round=14 local utility u=0.177003 metrics={'f1_val': 0.4338046773022406, 'auprc': 0.7502632126637795, 'loss_val': 0.9175665849784876, 'psi': 0.5603880914468562}-{'f1_val': 0.40078834203991304, 'auprc': 0.7321022782189468, 'loss_val': 1.0189920485759658, 'psi': 0.5333139165115266}
[S17] START round=14 head_norm_before_train=1.498659 (no previous merge yet)
[S17] round=14 local utility u=0.023757 metrics={'f1_val': 0.3633076423949172, 'auprc': 0.7848144009107159, 'loss_val': 0.948426819440813, 'psi': 0.5319103458012366}-{'f1_val': 0.35267292535303435, 'auprc': 0.7903958930275069, 'loss_val': 0.9488766395532398, 'psi': 0.5277621124228233}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S8
[S7] cosine check vs S8: cos=-0.0577
[S7] DROPPED delta from S8 (cos=-0.0577 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] cosine check vs S15: cos=0.4303
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] cosine check vs S16: cos=0.9669
[S14] RECEIVED delta(kind=head bytes=1804) from S9
[S14] cosine check vs S9: cos=0.1777
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=0.9348
[S4] RECEIVED delta(kind=head bytes=1800) from S6
[S4] cosine check vs S6: cos=0.8971
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] cosine check vs S11: cos=0.3025
[S5] RECEIVED delta(kind=head bytes=1805) from S10
[S5] cosine check vs S10: cos=0.4985
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.9163
[S5] RECEIVED delta(kind=head bytes=1799) from S3
[S5] cosine check vs S3: cos=0.3205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.3971
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.6875 head_norm=1.162051
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.740632e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.6639 head_norm=1.046639 delta_norm=0.274063
[S14] aggregate: ROLLBACK (f1_val pre=0.687 post=0.664 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.6213 head_norm=0.814729
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.954876e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.6185 head_norm=0.827056 delta_norm=0.195488
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.7039 head_norm=0.883567
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.237239e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.6995 head_norm=0.912407 delta_norm=0.123724
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7014 head_norm=1.195252
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.531284e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7014 head_norm=0.905796 delta_norm=0.553128
[S9] aggregate: ACCEPT kept=['S11', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.4338 head_norm=0.956503
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.973558e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.4465 head_norm=0.850816 delta_norm=0.197356
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7006 head_norm=0.781521
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.499814e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7006 head_norm=0.808337 delta_norm=0.349981
[S5] aggregate: ACCEPT kept=['S15', 'S10', 'S3'] (k=3/3) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.382770 cos_to_last_merge=0.8695 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.870
[S2] round=15 local utility u=0.020082 metrics={'f1_val': 0.7001964954534124, 'auprc': 0.786514873668262, 'loss_val': 0.331324795279256, 'psi': 0.7347238467393522}-{'f1_val': 0.7007275992706767, 'auprc': 0.7842417983869682, 'loss_val': 0.36785669478438593, 'psi': 0.7341332789171933}
[S3] START round=15 head_norm_before_train=1.613081 cos_to_last_merge=0.8086 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.809
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.518109323626565, 'auprc': 0.852003785559223, 'loss_val': 0.8358515820200664, 'psi': 0.6516671083996282}-{'f1_val': 0.5485112604878596, 'auprc': 0.8626759684826251, 'loss_val': 0.7212496577068963, 'psi': 0.6741771436857658}
[S4] START round=15 head_norm_before_train=0.827056 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.023005 metrics={'f1_val': 0.6435413870435617, 'auprc': 0.8582565224639849, 'loss_val': 0.7378239324228129, 'psi': 0.729427441211731}-{'f1_val': 0.6213284434032923, 'auprc': 0.8938487309831509, 'loss_val': 0.7573329965410803, 'psi': 0.7303365584352357}
[S5] START round=15 head_norm_before_train=0.808337 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.034216 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.6875780545273789, 'loss_val': 0.5037964312010489, 'psi': 0.6953962574085562}-{'f1_val': 0.7006083926626743, 'auprc': 0.6777113620863622, 'loss_val': 0.5426282958113519, 'psi': 0.6914495804321494}
[S6] START round=15 head_norm_before_train=0.912407 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.7047917545891521, 'auprc': 0.8032569812058866, 'loss_val': 0.6213018057375898, 'psi': 0.7441778452358458}-{'f1_val': 0.7038955189394618, 'auprc': 0.9505045405346353, 'loss_val': 0.640219771740927, 'psi': 0.8025391275775312}
[S7] START round=15 head_norm_before_train=1.651423 (no previous merge yet)
[S7] round=15 local utility u=0.403649 metrics={'f1_val': 0.6477602530292318, 'auprc': 0.797973030215883, 'loss_val': 0.5225196150178664, 'psi': 0.7078453639038922}-{'f1_val': 0.5611816037480543, 'auprc': 0.7817482095385139, 'loss_val': 0.7616706336399567, 'psi': 0.6494082460642381}
[S8] START round=15 head_norm_before_train=1.621945 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.9755313525898199, 'auprc': 0.9957526937107638, 'loss_val': 0.25881841038482745, 'psi': 0.9836198890381975}-{'f1_val': 0.9963530749356245, 'auprc': 0.9960065551482251, 'loss_val': 0.22391705389411493, 'psi': 0.9962144670206647}
[S9] START round=15 head_norm_before_train=0.905796 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.7011888050472792, 'auprc': 0.9937105120800386, 'loss_val': 0.28491355635489235, 'psi': 0.818197487860383}-{'f1_val': 0.7014391336149548, 'auprc': 0.9968511833488525, 'loss_val': 0.2845464910052254, 'psi': 0.8196039535085138}
[S10] START round=15 head_norm_before_train=1.693717 (no previous merge yet)
[S10] round=15 local utility u=0.809703 metrics={'f1_val': 0.9547138975675885, 'auprc': 0.9941326679938356, 'loss_val': 0.16807997845660214, 'psi': 0.9704814057380873}-{'f1_val': 0.688096275447425, 'auprc': 0.9976278023567675, 'loss_val': 0.19826590375160458, 'psi': 0.8119088862111621}
[S11] START round=15 head_norm_before_train=0.863895 cos_to_last_merge=0.9805 (last merge round=12)
[S11] round=15 local utility u=0.034765 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9977604741549566, 'loss_val': 0.36481788986111185, 'psi': 0.8202653796409747}-{'f1_val': 0.7016934795869249, 'auprc': 0.996275616376644, 'loss_val': 0.4284426857692851, 'psi': 0.8195263343028125}
[S13] START round=15 head_norm_before_train=1.535932 (no previous merge yet)
[S13] round=15 local utility u=0.210235 metrics={'f1_val': 0.6498699146757696, 'auprc': 0.6472101851634735, 'loss_val': 0.5994895727969102, 'psi': 0.6488060228708512}-{'f1_val': 0.5878698859232087, 'auprc': 0.6719623496203853, 'loss_val': 0.7222156351154199, 'psi': 0.6215068714020793}
[S14] START round=15 head_norm_before_train=1.046639 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.766389 metrics={'f1_val': 0.9402866085844913, 'auprc': 0.9957218713679814, 'loss_val': 0.41855979609317073, 'psi': 0.9624607136978873}-{'f1_val': 0.687481317863798, 'auprc': 0.9963632097687611, 'loss_val': 0.43643058952565494, 'psi': 0.8110340746257833}
[S15] START round=15 head_norm_before_train=1.625347 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6974989642745102, 'auprc': 0.6687166925746901, 'loss_val': 0.5469817069450277, 'psi': 0.6859860555945821}-{'f1_val': 0.6505526498743649, 'auprc': 0.9784045135181935, 'loss_val': 0.511930620026544, 'psi': 0.7816933953318963}
[S16] START round=15 head_norm_before_train=0.850816 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.376610 metrics={'f1_val': 0.520053647861148, 'auprc': 0.799605840196282, 'loss_val': 0.8298686934622731, 'psi': 0.6318745247952016}-{'f1_val': 0.4338046773022406, 'auprc': 0.7502632126637795, 'loss_val': 0.9175665849784876, 'psi': 0.5603880914468562}
[S17] START round=15 head_norm_before_train=1.509811 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.3634957323031022, 'auprc': 0.7514651721792818, 'loss_val': 0.9733417747465741, 'psi': 0.5186835082535741}-{'f1_val': 0.3633076423949172, 'auprc': 0.7848144009107159, 'loss_val': 0.948426819440813, 'psi': 0.5319103458012366}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:38510
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:38512
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] → sending delta(kind=head bytes=1808) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1808 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.8695
[S14] RECEIVED delta(kind=head bytes=1808) from S7
[S14] cosine check vs S7: cos=0.8968
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=0.9744
[S9] RECEIVED delta(kind=head bytes=1791) from S11
[S9] cosine check vs S11: cos=0.4784
[S9] RECEIVED delta(kind=head bytes=1806) from S13
[S9] cosine check vs S13: cos=0.6607
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.6726
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=0.5537
[S5] RECEIVED delta(kind=head bytes=1794) from S14
[S5] cosine check vs S14: cos=0.1633
[S5] RECEIVED delta(kind=head bytes=1803) from S2
[S5] cosine check vs S2: cos=0.5525
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7012 head_norm=0.965535
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.350757e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7012 head_norm=0.906994 delta_norm=0.335076
[S9] aggregate: ACCEPT kept=['S11', 'S13'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.192 → S14@127.0.0.1:38514
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.7048 head_norm=0.948888
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.072566e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.7068 head_norm=0.919508 delta_norm=0.107257
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.273 → S4@127.0.0.1:38504
[S3] ⇄ pheromone p=0.218 → S5@127.0.0.1:38505
[S8] ⇄ pheromone p=0.356 → S7@127.0.0.1:38508
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.5201 head_norm=0.902003
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.264929e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.5714 head_norm=0.854703 delta_norm=0.226493
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.219 → S6@127.0.0.1:38507
[S10] ⇄ pheromone p=0.311 → S5@127.0.0.1:38505
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7019 head_norm=0.930731
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.653261e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7019 head_norm=0.823401 delta_norm=0.365326
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.144 → S9@127.0.0.1:38510
[S4] ⇄ pheromone p=0.188 → S11@127.0.0.1:38512
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7006 head_norm=0.866038
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.213157e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7003 head_norm=0.790768 delta_norm=0.321316
[S5] aggregate: ACCEPT kept=['S10', 'S14', 'S2'] (k=3/3) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.234 → S16@127.0.0.1:38516
[S13] ⇄ pheromone p=0.225 → S9@127.0.0.1:38510
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9403 head_norm=1.093297
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.200348e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9358 head_norm=1.345828 delta_norm=0.420035
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.310 → S5@127.0.0.1:38505
[S2] ⇄ pheromone p=0.130 → S5@127.0.0.1:38505
[S7] ⇄ pheromone p=0.257 → S14@127.0.0.1:38514
[S17] ⇄ pheromone p=0.084 → S9@127.0.0.1:38510
[S15] ⇄ pheromone p=0.247 → S5@127.0.0.1:38505
[S2] START round=16 head_norm_before_train=1.417711 cos_to_last_merge=0.8625 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.862
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7135349671441167, 'auprc': 0.7711390442243993, 'loss_val': 0.6377927449140885, 'psi': 0.7365765979762298}-{'f1_val': 0.7001964954534124, 'auprc': 0.786514873668262, 'loss_val': 0.331324795279256, 'psi': 0.7347238467393522}
[S3] START round=16 head_norm_before_train=1.632957 cos_to_last_merge=0.8071 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.807
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.42458416381230474, 'auprc': 0.7955153594467776, 'loss_val': 1.0460248122227487, 'psi': 0.5729566420660939}-{'f1_val': 0.518109323626565, 'auprc': 0.852003785559223, 'loss_val': 0.8358515820200664, 'psi': 0.6516671083996282}
[S4] START round=16 head_norm_before_train=0.869854 cos_to_last_merge=0.9924 (last merge round=14)
[S4] round=16 local utility u=0.089060 metrics={'f1_val': 0.6174150478041792, 'auprc': 0.9393685868100933, 'loss_val': 0.6462826518916404, 'psi': 0.7461964634065448}-{'f1_val': 0.6435413870435617, 'auprc': 0.8582565224639849, 'loss_val': 0.7378239324228129, 'psi': 0.729427441211731}
[S5] START round=16 head_norm_before_train=0.790768 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.6612446512063761, 'loss_val': 0.42976029729486465, 'psi': 0.6846906509428987}-{'f1_val': 0.7006083926626743, 'auprc': 0.6875780545273789, 'loss_val': 0.5037964312010489, 'psi': 0.6953962574085562}
[S6] START round=16 head_norm_before_train=0.919508 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6279939300471477, 'auprc': 0.7751688787208184, 'loss_val': 0.6515417997007539, 'psi': 0.686863909516616}-{'f1_val': 0.7047917545891521, 'auprc': 0.8032569812058866, 'loss_val': 0.6213018057375898, 'psi': 0.7441778452358458}
[S7] START round=16 head_norm_before_train=1.667353 (no previous merge yet)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.5710088470868337, 'auprc': 0.7841138716837592, 'loss_val': 0.7529784358521397, 'psi': 0.6562508569256039}-{'f1_val': 0.6477602530292318, 'auprc': 0.797973030215883, 'loss_val': 0.5225196150178664, 'psi': 0.7078453639038922}
[S8] START round=16 head_norm_before_train=1.654961 (no previous merge yet)
[S8] round=16 local utility u=0.127245 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9972168963611613, 'loss_val': 0.13365233113796746, 'psi': 0.9966986035058393}-{'f1_val': 0.9755313525898199, 'auprc': 0.9957526937107638, 'loss_val': 0.25881841038482745, 'psi': 0.9836198890381975}
[S9] START round=16 head_norm_before_train=0.906994 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.895739 metrics={'f1_val': 0.9958851710193355, 'auprc': 0.995567217158547, 'loss_val': 0.26718449250737775, 'psi': 0.9957579894750201}-{'f1_val': 0.7011888050472792, 'auprc': 0.9937105120800386, 'loss_val': 0.28491355635489235, 'psi': 0.818197487860383}
[S10] START round=16 head_norm_before_train=1.716342 (no previous merge yet)
[S10] round=16 local utility u=0.128578 metrics={'f1_val': 0.9934866838477164, 'auprc': 0.9919512238139149, 'loss_val': 0.1370172675700744, 'psi': 0.9928724998341958}-{'f1_val': 0.9547138975675885, 'auprc': 0.9941326679938356, 'loss_val': 0.16807997845660214, 'psi': 0.9704814057380873}
[S11] START round=16 head_norm_before_train=0.823401 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9975315954932301, 'loss_val': 0.432419884764648, 'psi': 0.8199896075358348}-{'f1_val': 0.7019353166316534, 'auprc': 0.9977604741549566, 'loss_val': 0.36481788986111185, 'psi': 0.8202653796409747}
[S13] START round=16 head_norm_before_train=1.553192 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6097131815428779, 'auprc': 0.6381764469293019, 'loss_val': 0.6869080615147319, 'psi': 0.6210984876974475}-{'f1_val': 0.6498699146757696, 'auprc': 0.6472101851634735, 'loss_val': 0.5994895727969102, 'psi': 0.6488060228708512}
[S14] START round=16 head_norm_before_train=1.345828 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.057654 metrics={'f1_val': 0.9346318856776838, 'auprc': 0.9956385808676853, 'loss_val': 0.26907415032314186, 'psi': 0.9590345637536845}-{'f1_val': 0.9402866085844913, 'auprc': 0.9957218713679814, 'loss_val': 0.41855979609317073, 'psi': 0.9624607136978873}
[S15] START round=16 head_norm_before_train=1.666128 (no previous merge yet)
[S15] round=16 local utility u=0.576706 metrics={'f1_val': 0.6933677384711974, 'auprc': 0.9875957400713566, 'loss_val': 0.3254191774785734, 'psi': 0.811058939111261}-{'f1_val': 0.6974989642745102, 'auprc': 0.6687166925746901, 'loss_val': 0.5469817069450277, 'psi': 0.6859860555945821}
[S16] START round=16 head_norm_before_train=0.854703 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.354348 metrics={'f1_val': 0.5784177908502859, 'auprc': 0.9109885033027092, 'loss_val': 0.8055060534276537, 'psi': 0.7114460758312553}-{'f1_val': 0.520053647861148, 'auprc': 0.799605840196282, 'loss_val': 0.8298686934622731, 'psi': 0.6318745247952016}
[S17] START round=16 head_norm_before_train=1.518377 (no previous merge yet)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.34156388329961296, 'auprc': 0.7140521082164077, 'loss_val': 1.038913827759023, 'psi': 0.4905591732663309}-{'f1_val': 0.3634957323031022, 'auprc': 0.7514651721792818, 'loss_val': 0.9733417747465741, 'psi': 0.5186835082535741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38514
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:38505
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:38507
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.3079
[S5] RECEIVED delta(kind=head bytes=1794) from S14
[S5] cosine check vs S14: cos=0.3405
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=0.1532
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=0.9615
[S7] RECEIVED delta(kind=head bytes=1802) from S8
[S7] cosine check vs S8: cos=-0.0589
[S7] DROPPED delta from S8 (cos=-0.0589 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1792) from S4
[S11] cosine check vs S4: cos=0.8971
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.6198
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.6280 head_norm=0.955847
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.316325e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.6511 head_norm=0.920345 delta_norm=0.131633
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7016 head_norm=0.877015
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.061227e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.9604 head_norm=0.878756 delta_norm=0.206123
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7003 head_norm=0.859207
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.264234e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7003 head_norm=0.825876 delta_norm=0.326423
[S5] aggregate: ACCEPT kept=['S15', 'S14', 'S10'] (k=3/3) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9346 head_norm=1.389669
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.848271e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9429 head_norm=0.907313 delta_norm=0.784827
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.450366 cos_to_last_merge=0.8572 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.857
[S2] round=17 local utility u=0.050269 metrics={'f1_val': 0.7137398551476413, 'auprc': 0.7831167876449863, 'loss_val': 0.5744177791944364, 'psi': 0.7414906281465792}-{'f1_val': 0.7135349671441167, 'auprc': 0.7711390442243993, 'loss_val': 0.6377927449140885, 'psi': 0.7365765979762298}
[S3] START round=17 head_norm_before_train=1.658494 cos_to_last_merge=0.8055 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.805
[S3] round=17 local utility u=1.000000 metrics={'f1_val': 0.6090548011330188, 'auprc': 0.9021988642324297, 'loss_val': 0.4396268628617756, 'psi': 0.7263124263727831}-{'f1_val': 0.42458416381230474, 'auprc': 0.7955153594467776, 'loss_val': 1.0460248122227487, 'psi': 0.5729566420660939}
[S4] START round=17 head_norm_before_train=0.927494 cos_to_last_merge=0.9743 (last merge round=14)
[S4] round=17 local utility u=0.035990 metrics={'f1_val': 0.6146971490154916, 'auprc': 0.9495984018501862, 'loss_val': 0.5886838212186938, 'psi': 0.7486576501493694}-{'f1_val': 0.6174150478041792, 'auprc': 0.9393685868100933, 'loss_val': 0.6462826518916404, 'psi': 0.7461964634065448}
[S5] START round=17 head_norm_before_train=0.825876 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.006526 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.6710553812586455, 'loss_val': 0.4478631290893697, 'psi': 0.6887871881010628}-{'f1_val': 0.7003213174339138, 'auprc': 0.6612446512063761, 'loss_val': 0.42976029729486465, 'psi': 0.6846906509428987}
[S6] START round=17 head_norm_before_train=0.920345 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.578870 metrics={'f1_val': 0.6995234039071992, 'auprc': 0.9661470722069057, 'loss_val': 0.49591258962653706, 'psi': 0.8061728712270818}-{'f1_val': 0.6279939300471477, 'auprc': 0.7751688787208184, 'loss_val': 0.6515417997007539, 'psi': 0.686863909516616}
[S7] START round=17 head_norm_before_train=1.684382 (no previous merge yet)
[S7] round=17 local utility u=0.508741 metrics={'f1_val': 0.665243554655655, 'auprc': 0.8228082891217401, 'loss_val': 0.41698771151707054, 'psi': 0.7282694484420891}-{'f1_val': 0.5710088470868337, 'auprc': 0.7841138716837592, 'loss_val': 0.7529784358521397, 'psi': 0.6562508569256039}
[S8] START round=17 head_norm_before_train=1.685230 (no previous merge yet)
[S8] round=17 local utility u=0.006171 metrics={'f1_val': 0.9956042622259146, 'auprc': 0.9960290744182807, 'loss_val': 0.11325425167801532, 'psi': 0.9957741871028611}-{'f1_val': 0.9963530749356245, 'auprc': 0.9972168963611613, 'loss_val': 0.13365233113796746, 'psi': 0.9966986035058393}
[S9] START round=17 head_norm_before_train=0.973222 cos_to_last_merge=0.9947 (last merge round=15)
[S9] round=17 local utility u=0.016831 metrics={'f1_val': 0.988736075591129, 'auprc': 0.9971296606116247, 'loss_val': 0.19531596504902837, 'psi': 0.9920935095993273}-{'f1_val': 0.9958851710193355, 'auprc': 0.995567217158547, 'loss_val': 0.26718449250737775, 'psi': 0.9957579894750201}
[S10] START round=17 head_norm_before_train=1.736245 (no previous merge yet)
[S10] round=17 local utility u=0.020913 metrics={'f1_val': 0.994337411336045, 'auprc': 0.995752072753116, 'loss_val': 0.11169852285537823, 'psi': 0.9949032759028734}-{'f1_val': 0.9934866838477164, 'auprc': 0.9919512238139149, 'loss_val': 0.1370172675700744, 'psi': 0.9928724998341958}
[S11] START round=17 head_norm_before_train=0.878756 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9977927601105024, 'loss_val': 0.44169892678109585, 'psi': 0.820278294023193}-{'f1_val': 0.7016282822309048, 'auprc': 0.9975315954932301, 'loss_val': 0.432419884764648, 'psi': 0.8199896075358348}
[S13] START round=17 head_norm_before_train=1.567322 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6120654699023353, 'auprc': 0.5981794783784864, 'loss_val': 0.6423264435813768, 'psi': 0.6065110732927957}-{'f1_val': 0.6097131815428779, 'auprc': 0.6381764469293019, 'loss_val': 0.6869080615147319, 'psi': 0.6210984876974475}
[S14] START round=17 head_norm_before_train=0.907313 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.9307428975023473, 'auprc': 0.9970655366262473, 'loss_val': 0.4244975719554941, 'psi': 0.9572719531519073}-{'f1_val': 0.9346318856776838, 'auprc': 0.9956385808676853, 'loss_val': 0.26907415032314186, 'psi': 0.9590345637536845}
[S15] START round=17 head_norm_before_train=1.699468 (no previous merge yet)
[S15] round=17 local utility u=0.686546 metrics={'f1_val': 0.900555297779559, 'auprc': 0.9929822077495154, 'loss_val': 0.21161125316322618, 'psi': 0.9375260617675415}-{'f1_val': 0.6933677384711974, 'auprc': 0.9875957400713566, 'loss_val': 0.3254191774785734, 'psi': 0.811058939111261}
[S16] START round=17 head_norm_before_train=0.902818 cos_to_last_merge=0.9955 (last merge round=15)
[S16] round=17 local utility u=0.248053 metrics={'f1_val': 0.6073778575519798, 'auprc': 0.9566144909919165, 'loss_val': 0.6200388672387358, 'psi': 0.7470725109279546}-{'f1_val': 0.5784177908502859, 'auprc': 0.9109885033027092, 'loss_val': 0.8055060534276537, 'psi': 0.7114460758312553}
[S17] START round=17 head_norm_before_train=1.526588 (no previous merge yet)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.34191940872839366, 'auprc': 0.6981197473175442, 'loss_val': 1.0425327018609778, 'psi': 0.48439954416405384}-{'f1_val': 0.34156388329961296, 'auprc': 0.7140521082164077, 'loss_val': 1.038913827759023, 'psi': 0.4905591732663309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] → sending delta(kind=head bytes=1808) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:38512
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:38507
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1808 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1808) from S2
[S5] cosine check vs S2: cos=0.4580
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.4546
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.8894
[S4] RECEIVED delta(kind=head bytes=1796) from S6
[S4] cosine check vs S6: cos=0.8656
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] cosine check vs S9: cos=0.6255
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=0.9833
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] cosine check vs S8: cos=-0.0585
[S7] DROPPED delta from S8 (cos=-0.0585 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9545
[S5] RECEIVED delta(kind=head bytes=1797) from S3
[S5] cosine check vs S3: cos=0.1942
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.6168
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.7521
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7019 head_norm=0.928652
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.481687e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.9583 head_norm=0.949285 delta_norm=0.148169
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9307 head_norm=0.952876
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.025520e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9305 head_norm=0.967099 delta_norm=0.102552
[S14] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.6995 head_norm=0.956417
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.757669e-02
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.6959 head_norm=0.955047 delta_norm=0.087577
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.6074 head_norm=0.961683
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.209952e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.6001 head_norm=0.904905 delta_norm=0.220995
[S16] aggregate: ROLLBACK (f1_val pre=0.607 post=0.600 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.6147 head_norm=0.991866
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.530657e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.6144 head_norm=0.940863 delta_norm=0.253066
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.7006 head_norm=0.900304
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.352516e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7006 head_norm=0.860597 delta_norm=0.335252
[S5] aggregate: ACCEPT kept=['S2', 'S15', 'S3', 'S10'] (k=4/4) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.477008 cos_to_last_merge=0.8532 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.853
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.713964151104507, 'auprc': 0.7825335246424812, 'loss_val': 0.5862818883172898, 'psi': 0.7413919005196967}-{'f1_val': 0.7137398551476413, 'auprc': 0.7831167876449863, 'loss_val': 0.5744177791944364, 'psi': 0.7414906281465792}
[S3] START round=18 head_norm_before_train=1.686844 cos_to_last_merge=0.8037 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.804
[S3] round=18 local utility u=0.028300 metrics={'f1_val': 0.7084377830911404, 'auprc': 0.8518670837574889, 'loss_val': 0.8283287448424813, 'psi': 0.7658095033576797}-{'f1_val': 0.6090548011330188, 'auprc': 0.9021988642324297, 'loss_val': 0.4396268628617756, 'psi': 0.7263124263727831}
[S4] START round=18 head_norm_before_train=0.940863 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.6141839124551954, 'auprc': 0.9407684163915626, 'loss_val': 0.6078881964410879, 'psi': 0.7448177140297423}-{'f1_val': 0.6146971490154916, 'auprc': 0.9495984018501862, 'loss_val': 0.5886838212186938, 'psi': 0.7486576501493694}
[S5] START round=18 head_norm_before_train=0.860597 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.6691426498256832, 'auprc': 0.7218450340392035, 'loss_val': 0.45310995232918505, 'psi': 0.6902236035110914}-{'f1_val': 0.7006083926626743, 'auprc': 0.6710553812586455, 'loss_val': 0.4478631290893697, 'psi': 0.6887871881010628}
[S6] START round=18 head_norm_before_train=0.955047 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.7079394718648842, 'auprc': 0.8719383263846843, 'loss_val': 0.4967344109448519, 'psi': 0.7735390136728042}-{'f1_val': 0.6995234039071992, 'auprc': 0.9661470722069057, 'loss_val': 0.49591258962653706, 'psi': 0.8061728712270818}
[S7] START round=18 head_norm_before_train=1.703422 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.6470927872269251, 'auprc': 0.800036897058509, 'loss_val': 0.5208830082281154, 'psi': 0.7082704311595587}-{'f1_val': 0.665243554655655, 'auprc': 0.8228082891217401, 'loss_val': 0.41698771151707054, 'psi': 0.7282694484420891}
[S8] START round=18 head_norm_before_train=1.716538 (no previous merge yet)
[S8] round=18 local utility u=0.017833 metrics={'f1_val': 0.996503822188793, 'auprc': 0.9974725663343846, 'loss_val': 0.08731514007270316, 'psi': 0.9968913198470296}-{'f1_val': 0.9956042622259146, 'auprc': 0.9960290744182807, 'loss_val': 0.11325425167801532, 'psi': 0.9957741871028611}
[S9] START round=18 head_norm_before_train=1.054860 cos_to_last_merge=0.9818 (last merge round=15)
[S9] round=18 local utility u=0.032880 metrics={'f1_val': 0.9904421192279471, 'auprc': 0.9983256184315914, 'loss_val': 0.14337925328047, 'psi': 0.9935955189094048}-{'f1_val': 0.988736075591129, 'auprc': 0.9971296606116247, 'loss_val': 0.19531596504902837, 'psi': 0.9920935095993273}
[S10] START round=18 head_norm_before_train=1.752831 (no previous merge yet)
[S10] round=18 local utility u=0.012018 metrics={'f1_val': 0.9944424285248281, 'auprc': 0.997645368545963, 'loss_val': 0.09397203572320886, 'psi': 0.995723604533282}-{'f1_val': 0.994337411336045, 'auprc': 0.995752072753116, 'loss_val': 0.11169852285537823, 'psi': 0.9949032759028734}
[S11] START round=18 head_norm_before_train=0.949285 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.024827 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9977214025602497, 'loss_val': 0.3914394661906111, 'psi': 0.8202106321776486}-{'f1_val': 0.7019353166316534, 'auprc': 0.9977927601105024, 'loss_val': 0.44169892678109585, 'psi': 0.820278294023193}
[S13] START round=18 head_norm_before_train=1.580269 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.610179605275149, 'auprc': 0.6118804333113546, 'loss_val': 0.7147215861519852, 'psi': 0.6108599364896312}-{'f1_val': 0.6120654699023353, 'auprc': 0.5981794783784864, 'loss_val': 0.6423264435813768, 'psi': 0.6065110732927957}
[S14] START round=18 head_norm_before_train=0.967099 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.240046 metrics={'f1_val': 0.9966690272900108, 'auprc': 0.9956335559969328, 'loss_val': 0.33566605129211113, 'psi': 0.9962548387727796}-{'f1_val': 0.9307428975023473, 'auprc': 0.9970655366262473, 'loss_val': 0.4244975719554941, 'psi': 0.9572719531519073}
[S15] START round=18 head_norm_before_train=1.737181 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6938040408976027, 'auprc': 0.9823085561085744, 'loss_val': 0.3871112220826026, 'psi': 0.8092058469819914}-{'f1_val': 0.900555297779559, 'auprc': 0.9929822077495154, 'loss_val': 0.21161125316322618, 'psi': 0.9375260617675415}
[S16] START round=18 head_norm_before_train=0.904905 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.651419 metrics={'f1_val': 0.8312510585066496, 'auprc': 0.9916196102071241, 'loss_val': 0.7654546485586199, 'psi': 0.8953984791868395}-{'f1_val': 0.6073778575519798, 'auprc': 0.9566144909919165, 'loss_val': 0.6200388672387358, 'psi': 0.7470725109279546}
[S17] START round=18 head_norm_before_train=1.537784 (no previous merge yet)
[S17] round=18 local utility u=0.633969 metrics={'f1_val': 0.5457149373218049, 'auprc': 0.7074063879246351, 'loss_val': 1.025227328080806, 'psi': 0.6103915175629369}-{'f1_val': 0.34191940872839366, 'auprc': 0.6981197473175442, 'loss_val': 1.0425327018609778, 'psi': 0.48439954416405384}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:38507
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:38514
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:38510
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1805) from S10
[S5] cosine check vs S10: cos=0.5605
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] cosine check vs S16: cos=0.9689
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] cosine check vs S8: cos=-0.0580
[S7] DROPPED delta from S8 (cos=-0.0580 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S11
[S9] cosine check vs S11: cos=0.4375
[S14] RECEIVED delta(kind=head bytes=1802) from S9
[S14] cosine check vs S9: cos=0.5451
[S5] RECEIVED delta(kind=head bytes=1793) from S14
[S5] cosine check vs S14: cos=0.2900
[S5] RECEIVED delta(kind=head bytes=1792) from S3
[S5] cosine check vs S3: cos=0.4266
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.4520
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.7079 head_norm=0.992843
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.227580e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.7079 head_norm=0.968574 delta_norm=0.122758
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.6691 head_norm=0.929960
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.185531e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.6763 head_norm=0.818155 delta_norm=0.318553
[S5] aggregate: ACCEPT kept=['S10', 'S14', 'S3'] (k=3/3) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9967 head_norm=1.023123
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.136252e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9983 head_norm=0.943383 delta_norm=0.513625
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9904 head_norm=1.122846
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.635909e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9900 head_norm=0.924455 delta_norm=0.463591
[S9] aggregate: ACCEPT kept=['S11', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.496679 cos_to_last_merge=0.8507 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.851
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7139036139988328, 'auprc': 0.7863714783499456, 'loss_val': 0.6284828453187093, 'psi': 0.742890759739278}-{'f1_val': 0.713964151104507, 'auprc': 0.7825335246424812, 'loss_val': 0.5862818883172898, 'psi': 0.7413919005196967}
[S3] START round=19 head_norm_before_train=1.716479 cos_to_last_merge=0.8028 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.803
[S3] round=19 local utility u=1.000000 metrics={'f1_val': 0.9281512458191016, 'auprc': 0.9928821648332193, 'loss_val': 0.16214881724974442, 'psi': 0.9540436134247487}-{'f1_val': 0.7084377830911404, 'auprc': 0.8518670837574889, 'loss_val': 0.8283287448424813, 'psi': 0.7658095033576797}
[S4] START round=19 head_norm_before_train=0.991313 cos_to_last_merge=0.9970 (last merge round=17)
[S4] round=19 local utility u=0.063899 metrics={'f1_val': 0.6186566870878356, 'auprc': 0.9524057397886906, 'loss_val': 0.5418388031397406, 'psi': 0.7521563081681777}-{'f1_val': 0.6141839124551954, 'auprc': 0.9407684163915626, 'loss_val': 0.6078881964410879, 'psi': 0.7448177140297423}
[S5] START round=19 head_norm_before_train=0.818155 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.062081 metrics={'f1_val': 0.6883078961398884, 'auprc': 0.7218002039280556, 'loss_val': 0.4438055711909305, 'psi': 0.7017048192551553}-{'f1_val': 0.6691426498256832, 'auprc': 0.7218450340392035, 'loss_val': 0.45310995232918505, 'psi': 0.6902236035110914}
[S6] START round=19 head_norm_before_train=0.968574 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.106044 metrics={'f1_val': 0.6949453545637659, 'auprc': 0.9523667348817194, 'loss_val': 0.4479671376745043, 'psi': 0.7979139066909473}-{'f1_val': 0.7079394718648842, 'auprc': 0.8719383263846843, 'loss_val': 0.4967344109448519, 'psi': 0.7735390136728042}
[S7] START round=19 head_norm_before_train=1.721374 (no previous merge yet)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.6373326320469437, 'auprc': 0.7965313144145322, 'loss_val': 0.561811987424143, 'psi': 0.701012104993979}-{'f1_val': 0.6470927872269251, 'auprc': 0.800036897058509, 'loss_val': 0.5208830082281154, 'psi': 0.7082704311595587}
[S8] START round=19 head_norm_before_train=1.745039 (no previous merge yet)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9959635918139167, 'loss_val': 0.08808748438430726, 'psi': 0.9961972816869414}-{'f1_val': 0.996503822188793, 'auprc': 0.9974725663343846, 'loss_val': 0.08731514007270316, 'psi': 0.9968913198470296}
[S9] START round=19 head_norm_before_train=0.924455 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9954716855113626, 'loss_val': 0.18232169847238808, 'psi': 0.9964677279888104}-{'f1_val': 0.9904421192279471, 'auprc': 0.9983256184315914, 'loss_val': 0.14337925328047, 'psi': 0.9935955189094048}
[S10] START round=19 head_norm_before_train=1.768901 (no previous merge yet)
[S10] round=19 local utility u=0.003578 metrics={'f1_val': 0.9936100131187782, 'auprc': 0.9967073602706475, 'loss_val': 0.07900804091467414, 'psi': 0.9948489519795258}-{'f1_val': 0.9944424285248281, 'auprc': 0.997645368545963, 'loss_val': 0.09397203572320886, 'psi': 0.995723604533282}
[S11] START round=19 head_norm_before_train=1.001297 cos_to_last_merge=0.9942 (last merge round=17)
[S11] round=19 local utility u=0.034177 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9960489229345878, 'loss_val': 0.3184586414896022, 'psi': 0.8195807591528272}-{'f1_val': 0.7018701185892477, 'auprc': 0.9977214025602497, 'loss_val': 0.3914394661906111, 'psi': 0.8202106321776486}
[S13] START round=19 head_norm_before_train=1.597230 (no previous merge yet)
[S13] round=19 local utility u=0.113632 metrics={'f1_val': 0.6283664042661001, 'auprc': 0.6092079333871021, 'loss_val': 0.5885604308245123, 'psi': 0.6207030159145009}-{'f1_val': 0.610179605275149, 'auprc': 0.6118804333113546, 'loss_val': 0.7147215861519852, 'psi': 0.6108599364896312}
[S14] START round=19 head_norm_before_train=0.943383 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9983274240503504, 'auprc': 0.9970903824354996, 'loss_val': 0.4475368289732142, 'psi': 0.9978326074044102}-{'f1_val': 0.9966690272900108, 'auprc': 0.9956335559969328, 'loss_val': 0.33566605129211113, 'psi': 0.9962548387727796}
[S15] START round=19 head_norm_before_train=1.775192 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6987007171710401, 'auprc': 0.8594154911301504, 'loss_val': 0.4929946954362883, 'psi': 0.7629866267546843}-{'f1_val': 0.6938040408976027, 'auprc': 0.9823085561085744, 'loss_val': 0.3871112220826026, 'psi': 0.8092058469819914}
[S16] START round=19 head_norm_before_train=0.959516 cos_to_last_merge=0.9961 (last merge round=17)
[S16] round=19 local utility u=0.141944 metrics={'f1_val': 0.8547387913837565, 'auprc': 0.9943351613393564, 'loss_val': 0.6306395049993158, 'psi': 0.9105773393659965}-{'f1_val': 0.8312510585066496, 'auprc': 0.9916196102071241, 'loss_val': 0.7654546485586199, 'psi': 0.8953984791868395}
[S17] START round=19 head_norm_before_train=1.551663 (no previous merge yet)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.37815524948912865, 'auprc': 0.694323868765929, 'loss_val': 1.0542255234709297, 'psi': 0.5046226971998489}-{'f1_val': 0.5457149373218049, 'auprc': 0.7074063879246351, 'loss_val': 1.025227328080806, 'psi': 0.6103915175629369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:38510
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:38507
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.9091
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.6126
[S5] RECEIVED delta(kind=head bytes=1803) from S3
[S5] cosine check vs S3: cos=0.4946
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] cosine check vs S6: cos=0.9139
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9204
[S6] RECEIVED delta(kind=head bytes=1793) from S16
[S6] cosine check vs S16: cos=0.9847
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] cosine check vs S13: cos=0.5282
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] cosine check vs S11: cos=0.5340
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=20 psi=0.998 u=0.0000 p_local=0.1714 f1=0.998 auprc=0.997 bytes=25156
[S8] r=20 psi=0.996 u=0.0000 p_local=0.1625 f1=0.996 auprc=0.996 bytes=23407
[S7] r=20 psi=0.701 u=0.0000 p_local=0.1705 f1=0.637 auprc=0.797 bytes=19796
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9971 head_norm=0.987476
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.929529e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9971 head_norm=0.925208 delta_norm=0.392953
[S9] aggregate: ACCEPT kept=['S13', 'S11'] (k=2/2) mode=median trim_p=0.1
[S9] r=20 psi=0.996 u=0.0000 p_local=0.1777 f1=0.997 auprc=0.995 bytes=25172
[S2] r=20 psi=0.743 u=0.0000 p_local=0.0595 f1=0.714 auprc=0.786 bytes=23363
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.7019 head_norm=1.065349
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.109629e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.9569 head_norm=1.034949 delta_norm=0.210963
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.820 u=0.0342 p_local=0.0696 f1=0.702 auprc=0.996 bytes=21537
[S3] r=20 psi=0.954 u=1.0000 p_local=0.4216 f1=0.928 auprc=0.993 bytes=17974
[S13] r=20 psi=0.621 u=0.1136 p_local=0.1148 f1=0.628 auprc=0.609 bytes=16199
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.6883 head_norm=0.897472
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.909860e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.7006 head_norm=1.016750 delta_norm=0.390986
[S5] aggregate: ACCEPT kept=['S10', 'S3'] (k=2/2) mode=median trim_p=0.1
[S5] r=20 psi=0.702 u=0.0621 p_local=0.1090 f1=0.688 auprc=0.722 bytes=25171
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.8547 head_norm=1.019161
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.127444e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.8477 head_norm=0.936383 delta_norm=0.212744
[S16] aggregate: ROLLBACK (f1_val pre=0.855 post=0.848 tol_abs=0.005 tol_rel=0.0)
[S16] r=20 psi=0.911 u=0.1419 p_local=0.2905 f1=0.855 auprc=0.994 bytes=23369
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.6187 head_norm=1.047035
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.136350e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.6175 head_norm=1.001627 delta_norm=0.213635
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.752 u=0.0639 p_local=0.1036 f1=0.619 auprc=0.952 bytes=23380
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.6949 head_norm=1.000755
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.892628e-02
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.6951 head_norm=1.006078 delta_norm=0.088926
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] r=20 psi=0.798 u=0.1060 p_local=0.2071 f1=0.695 auprc=0.952 bytes=16186
[S10] r=20 psi=0.995 u=0.0036 p_local=0.1458 f1=0.994 auprc=0.997 bytes=30593
[S17] r=20 psi=0.505 u=0.0000 p_local=0.1358 f1=0.378 auprc=0.694 bytes=17998
[S15] r=20 psi=0.763 u=0.0000 p_local=0.2482 f1=0.699 auprc=0.859 bytes=23381
[S2] START round=20 head_norm_before_train=1.513317 cos_to_last_merge=0.8475 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.848
[S2] round=20 local utility u=0.010153 metrics={'f1_val': 0.7139036139988328, 'auprc': 0.7853191498684631, 'loss_val': 0.6050197795836468, 'psi': 0.7424698283466848}-{'f1_val': 0.7139036139988328, 'auprc': 0.7863714783499456, 'loss_val': 0.6284828453187093, 'psi': 0.742890759739278}
[S3] START round=20 head_norm_before_train=1.752791 cos_to_last_merge=0.8018 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.802
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.8468469843616193, 'auprc': 0.9931648337383545, 'loss_val': 0.3737049185474066, 'psi': 0.9053741241123134}-{'f1_val': 0.9281512458191016, 'auprc': 0.9928821648332193, 'loss_val': 0.16214881724974442, 'psi': 0.9540436134247487}
[S4] START round=20 head_norm_before_train=1.001627 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.6120099223150745, 'auprc': 0.9432978015567197, 'loss_val': 0.5807910939733251, 'psi': 0.7445250740117326}-{'f1_val': 0.6186566870878356, 'auprc': 0.9524057397886906, 'loss_val': 0.5418388031397406, 'psi': 0.7521563081681777}
[S5] START round=20 head_norm_before_train=1.016750 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.046256 metrics={'f1_val': 0.7003603281361598, 'auprc': 0.715765606670065, 'loss_val': 0.4055050339697133, 'psi': 0.7065224395497218}-{'f1_val': 0.6883078961398884, 'auprc': 0.7218002039280556, 'loss_val': 0.4438055711909305, 'psi': 0.7017048192551553}
[S6] START round=20 head_norm_before_train=1.006078 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.7070152481968857, 'auprc': 0.772708350872614, 'loss_val': 0.609864373210424, 'psi': 0.733292489267177}-{'f1_val': 0.6949453545637659, 'auprc': 0.9523667348817194, 'loss_val': 0.4479671376745043, 'psi': 0.7979139066909473}
[S7] START round=20 head_norm_before_train=1.734912 (no previous merge yet)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.6003884980405114, 'auprc': 0.7875265910105325, 'loss_val': 0.6272897663375331, 'psi': 0.6752437352285199}-{'f1_val': 0.6373326320469437, 'auprc': 0.7965313144145322, 'loss_val': 0.561811987424143, 'psi': 0.701012104993979}
[S8] START round=20 head_norm_before_train=1.768496 (no previous merge yet)
[S8] round=20 local utility u=0.009290 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.995930564939334, 'loss_val': 0.06940780165987467, 'psi': 0.9961840709371084}-{'f1_val': 0.9963530749356245, 'auprc': 0.9959635918139167, 'loss_val': 0.08808748438430726, 'psi': 0.9961972816869414}
[S9] START round=20 head_norm_before_train=0.925208 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.996721335281205, 'auprc': 0.9932636825076252, 'loss_val': 0.1803719070940263, 'psi': 0.995338274171773}-{'f1_val': 0.9971317563071089, 'auprc': 0.9954716855113626, 'loss_val': 0.18232169847238808, 'psi': 0.9964677279888104}
[S10] START round=20 head_norm_before_train=1.789440 (no previous merge yet)
[S10] round=20 local utility u=0.005867 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9967187223727418, 'loss_val': 0.06755834918604224, 'psi': 0.9948785931672964}-{'f1_val': 0.9936100131187782, 'auprc': 0.9967073602706475, 'loss_val': 0.07900804091467414, 'psi': 0.9948489519795258}
[S11] START round=20 head_norm_before_train=1.034949 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.744838 metrics={'f1_val': 0.9451825552469971, 'auprc': 0.9976370668374994, 'loss_val': 0.2930296267560359, 'psi': 0.966164359883198}-{'f1_val': 0.7019353166316534, 'auprc': 0.9960489229345878, 'loss_val': 0.3184586414896022, 'psi': 0.8195807591528272}
[S13] START round=20 head_norm_before_train=1.613204 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.6012129655998006, 'auprc': 0.6785513408495523, 'loss_val': 0.7620755839376528, 'psi': 0.6321483156997013}-{'f1_val': 0.6283664042661001, 'auprc': 0.6092079333871021, 'loss_val': 0.5885604308245123, 'psi': 0.6207030159145009}
[S14] START round=20 head_norm_before_train=0.993188 cos_to_last_merge=0.9960 (last merge round=18)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9299773145901551, 'auprc': 0.9971542658523573, 'loss_val': 0.3362197213554463, 'psi': 0.956848095095036}-{'f1_val': 0.9983274240503504, 'auprc': 0.9970903824354996, 'loss_val': 0.4475368289732142, 'psi': 0.9978326074044102}
[S15] START round=20 head_norm_before_train=1.808519 (no previous merge yet)
[S15] round=20 local utility u=0.741658 metrics={'f1_val': 0.8307618775493596, 'auprc': 0.9917366543623247, 'loss_val': 0.19900835772090164, 'psi': 0.8951517882745457}-{'f1_val': 0.6987007171710401, 'auprc': 0.8594154911301504, 'loss_val': 0.4929946954362883, 'psi': 0.7629866267546843}
[S16] START round=20 head_norm_before_train=0.936383 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.377062 metrics={'f1_val': 0.9439805565862458, 'auprc': 0.985923316976433, 'loss_val': 0.3867299322326034, 'psi': 0.9607576607423207}-{'f1_val': 0.8547387913837565, 'auprc': 0.9943351613393564, 'loss_val': 0.6306395049993158, 'psi': 0.9105773393659965}
[S17] START round=20 head_norm_before_train=1.566172 (no previous merge yet)
[S17] round=20 local utility u=0.179443 metrics={'f1_val': 0.39170684291836266, 'auprc': 0.7491922355623611, 'loss_val': 0.9412534222567733, 'psi': 0.5347009999759621}-{'f1_val': 0.37815524948912865, 'auprc': 0.694323868765929, 'loss_val': 1.0542255234709297, 'psi': 0.5046226971998489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:38507
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S8] → sending delta(kind=head bytes=1811) to S7@127.0.0.1:38508
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:38516
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1811 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.6992
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.1500
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] cosine check vs S2: cos=0.4466
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.8755
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=0.9809
[S7] RECEIVED delta(kind=head bytes=1811) from S8
[S7] cosine check vs S8: cos=-0.0582
[S7] DROPPED delta from S8 (cos=-0.0582 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] cosine check vs S11: cos=0.5887
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S17
[S9] cosine check vs S17: cos=0.4241
[S14] ⇄ pheromone p=0.137 → S5@127.0.0.1:38505
[S4] ⇄ pheromone p=0.083 → S11@127.0.0.1:38512
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.7070 head_norm=1.036512
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.015799e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.7070 head_norm=1.009735 delta_norm=0.101580
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.166 → S4@127.0.0.1:38504
[S3] ⇄ pheromone p=0.337 → S5@127.0.0.1:38505
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9967 head_norm=1.005981
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.993431e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9972 head_norm=0.905317 delta_norm=0.399343
[S9] aggregate: ACCEPT kept=['S11', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.142 → S14@127.0.0.1:38514
[S7] ⇄ pheromone p=0.136 → S14@127.0.0.1:38514
[S13] ⇄ pheromone p=0.092 → S9@127.0.0.1:38510
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.7004 head_norm=1.091687
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.073435e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.7006 head_norm=0.988882 delta_norm=0.407343
[S5] aggregate: ACCEPT kept=['S10', 'S15', 'S2'] (k=3/3) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.096 → S16@127.0.0.1:38516
[S10] ⇄ pheromone p=0.118 → S5@127.0.0.1:38505
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9440 head_norm=0.992678
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.644159e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9885 head_norm=1.009296 delta_norm=0.264416
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.308 → S6@127.0.0.1:38507
[S8] ⇄ pheromone p=0.132 → S7@127.0.0.1:38508
[S2] ⇄ pheromone p=0.050 → S5@127.0.0.1:38505
[S11] ⇄ pheromone p=0.205 → S9@127.0.0.1:38510
[S15] ⇄ pheromone p=0.347 → S5@127.0.0.1:38505
[S17] ⇄ pheromone p=0.145 → S9@127.0.0.1:38510
[S2] START round=21 head_norm_before_train=1.529690 cos_to_last_merge=0.8455 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.846
[S2] round=21 local utility u=0.119554 metrics={'f1_val': 0.7002891471968757, 'auprc': 0.7861851486362497, 'loss_val': 0.28682267932858174, 'psi': 0.7346475477726253}-{'f1_val': 0.7139036139988328, 'auprc': 0.7853191498684631, 'loss_val': 0.6050197795836468, 'psi': 0.7424698283466848}
[S3] START round=21 head_norm_before_train=1.783212 cos_to_last_merge=0.8008 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.801
[S3] round=21 local utility u=0.086104 metrics={'f1_val': 0.8634993010921369, 'auprc': 0.998166749752387, 'loss_val': 0.3164160788215775, 'psi': 0.917366280556237}-{'f1_val': 0.8468469843616193, 'auprc': 0.9931648337383545, 'loss_val': 0.3737049185474066, 'psi': 0.9053741241123134}
[S4] START round=21 head_norm_before_train=1.046199 cos_to_last_merge=0.9980 (last merge round=19)
[S4] round=21 local utility u=1.000000 metrics={'f1_val': 0.9459562559650474, 'auprc': 0.9529633553498804, 'loss_val': 0.48947896050836803, 'psi': 0.9487590957189806}-{'f1_val': 0.6120099223150745, 'auprc': 0.9432978015567197, 'loss_val': 0.5807910939733251, 'psi': 0.7445250740117326}
[S5] START round=21 head_norm_before_train=0.988882 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.144052 metrics={'f1_val': 0.700320598491359, 'auprc': 0.7919232903809277, 'loss_val': 0.3456360616506428, 'psi': 0.7369616752471865}-{'f1_val': 0.7003603281361598, 'auprc': 0.715765606670065, 'loss_val': 0.4055050339697133, 'psi': 0.7065224395497218}
[S6] START round=21 head_norm_before_train=1.009735 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.358077 metrics={'f1_val': 0.6968297543128634, 'auprc': 0.9639311984533181, 'loss_val': 0.4062669423006516, 'psi': 0.8036703319690452}-{'f1_val': 0.7070152481968857, 'auprc': 0.772708350872614, 'loss_val': 0.609864373210424, 'psi': 0.733292489267177}
[S7] START round=21 head_norm_before_train=1.749595 (no previous merge yet)
[S7] round=21 local utility u=0.013048 metrics={'f1_val': 0.6176944025562602, 'auprc': 0.7946881262009443, 'loss_val': 0.7265141674018595, 'psi': 0.6884918920141339}-{'f1_val': 0.6003884980405114, 'auprc': 0.7875265910105325, 'loss_val': 0.6272897663375331, 'psi': 0.6752437352285199}
[S8] START round=21 head_norm_before_train=1.787068 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9393622724251038, 'auprc': 0.9935241893893758, 'loss_val': 0.1199229538598874, 'psi': 0.9610270392108127}-{'f1_val': 0.9963530749356245, 'auprc': 0.995930564939334, 'loss_val': 0.06940780165987467, 'psi': 0.9961840709371084}
[S9] START round=21 head_norm_before_train=0.905317 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.001694 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9931966812545017, 'loss_val': 0.17924513506416623, 'psi': 0.9955577262860661}-{'f1_val': 0.996721335281205, 'auprc': 0.9932636825076252, 'loss_val': 0.1803719070940263, 'psi': 0.995338274171773}
[S10] START round=21 head_norm_before_train=1.814166 (no previous merge yet)
[S10] round=21 local utility u=0.001444 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9947301149681833, 'loss_val': 0.06002037192448254, 'psi': 0.9942146736176003}-{'f1_val': 0.9936518403636662, 'auprc': 0.9967187223727418, 'loss_val': 0.06755834918604224, 'psi': 0.9948785931672964}
[S11] START round=21 head_norm_before_train=1.090523 cos_to_last_merge=0.9966 (last merge round=19)
[S11] round=21 local utility u=0.134973 metrics={'f1_val': 0.980267291664415, 'auprc': 0.9975947115888343, 'loss_val': 0.23346571819781203, 'psi': 0.9871982596341826}-{'f1_val': 0.9451825552469971, 'auprc': 0.9976370668374994, 'loss_val': 0.2930296267560359, 'psi': 0.966164359883198}
[S13] START round=21 head_norm_before_train=1.624767 (no previous merge yet)
[S13] round=21 local utility u=0.079430 metrics={'f1_val': 0.6333308179243401, 'auprc': 0.6274483662615691, 'loss_val': 0.6426131824734402, 'psi': 0.6309778372592317}-{'f1_val': 0.6012129655998006, 'auprc': 0.6785513408495523, 'loss_val': 0.7620755839376528, 'psi': 0.6321483156997013}
[S14] START round=21 head_norm_before_train=1.055907 cos_to_last_merge=0.9848 (last merge round=18)
[S14] round=21 local utility u=0.264145 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9971522094889235, 'loss_val': 0.2125093495548274, 'psi': 0.9973058454966047}-{'f1_val': 0.9299773145901551, 'auprc': 0.9971542658523573, 'loss_val': 0.3362197213554463, 'psi': 0.956848095095036}
[S15] START round=21 head_norm_before_train=1.832512 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7624783138815041, 'auprc': 0.9922411604777271, 'loss_val': 0.3560896877300026, 'psi': 0.8543834525199934}-{'f1_val': 0.8307618775493596, 'auprc': 0.9917366543623247, 'loss_val': 0.19900835772090164, 'psi': 0.8951517882745457}
[S16] START round=21 head_norm_before_train=1.009296 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.9367354306616138, 'auprc': 0.9943556166858509, 'loss_val': 0.43415896096509177, 'psi': 0.9597835050713086}-{'f1_val': 0.9439805565862458, 'auprc': 0.985923316976433, 'loss_val': 0.3867299322326034, 'psi': 0.9607576607423207}
[S17] START round=21 head_norm_before_train=1.580727 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.38768779675983583, 'auprc': 0.7371331647279087, 'loss_val': 0.8915406107629656, 'psi': 0.527465943947065}-{'f1_val': 0.39170684291836266, 'auprc': 0.7491922355623611, 'loss_val': 0.9412534222567733, 'psi': 0.5347009999759621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S13] → sending delta(kind=head bytes=1811) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:38512
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1811 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=0.6252
[S5] RECEIVED delta(kind=head bytes=1803) from S3
[S5] cosine check vs S3: cos=0.4320
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.6841
[S5] RECEIVED delta(kind=head bytes=1801) from S14
[S5] cosine check vs S14: cos=0.1492
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.9543
[S4] RECEIVED delta(kind=head bytes=1797) from S6
[S4] cosine check vs S6: cos=0.9411
[S14] RECEIVED delta(kind=head bytes=1795) from S9
[S14] cosine check vs S9: cos=0.7324
[S14] RECEIVED delta(kind=head bytes=1805) from S7
[S14] cosine check vs S7: cos=0.5153
[S9] RECEIVED delta(kind=head bytes=1803) from S11
[S9] cosine check vs S11: cos=0.6109
[S9] RECEIVED delta(kind=head bytes=1811) from S13
[S9] cosine check vs S13: cos=0.4915
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9212
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9974 head_norm=1.122507
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.414120e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9978 head_norm=1.018065 delta_norm=0.341412
[S14] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9971 head_norm=0.992651
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.883181e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9971 head_norm=0.948448 delta_norm=0.388318
[S9] aggregate: ACCEPT kept=['S11', 'S13'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.7003 head_norm=1.066193
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.744216e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.7003 head_norm=0.936751 delta_norm=0.274422
[S5] aggregate: ACCEPT kept=['S2', 'S3', 'S10', 'S14'] (k=4/4) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9803 head_norm=1.149735
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.242989e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9965 head_norm=1.099715 delta_norm=0.224299
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9460 head_norm=1.094292
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.850637e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.8625 head_norm=1.049609 delta_norm=0.185064
[S4] aggregate: ROLLBACK (f1_val pre=0.946 post=0.862 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.9367 head_norm=1.060157
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.606723e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.9351 head_norm=1.050969 delta_norm=0.160672
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.545192 cos_to_last_merge=0.8440 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.844
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7102027146828505, 'auprc': 0.7870297238641417, 'loss_val': 0.4709054564061575, 'psi': 0.7409335183553669}-{'f1_val': 0.7002891471968757, 'auprc': 0.7861851486362497, 'loss_val': 0.28682267932858174, 'psi': 0.7346475477726253}
[S3] START round=22 head_norm_before_train=1.814693 cos_to_last_merge=0.7996 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.800
[S3] round=22 local utility u=0.461423 metrics={'f1_val': 0.9778196264792421, 'auprc': 0.9982178084668509, 'loss_val': 0.07964608389903054, 'psi': 0.9859788992742857}-{'f1_val': 0.8634993010921369, 'auprc': 0.998166749752387, 'loss_val': 0.3164160788215775, 'psi': 0.917366280556237}
[S4] START round=22 head_norm_before_train=1.049609 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.6899378110297623, 'auprc': 0.9493406928014891, 'loss_val': 0.5274890734841762, 'psi': 0.7936989637384531}-{'f1_val': 0.9459562559650474, 'auprc': 0.9529633553498804, 'loss_val': 0.48947896050836803, 'psi': 0.9487590957189806}
[S5] START round=22 head_norm_before_train=0.936751 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.129082 metrics={'f1_val': 0.6766161940101222, 'auprc': 0.9341597283306173, 'loss_val': 0.37195441280970964, 'psi': 0.7796336077383204}-{'f1_val': 0.700320598491359, 'auprc': 0.7919232903809277, 'loss_val': 0.3456360616506428, 'psi': 0.7369616752471865}
[S6] START round=22 head_norm_before_train=1.036523 cos_to_last_merge=0.9990 (last merge round=20)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.7003211746645324, 'auprc': 0.809473207908749, 'loss_val': 0.45671331939690635, 'psi': 0.743981987962219}-{'f1_val': 0.6968297543128634, 'auprc': 0.9639311984533181, 'loss_val': 0.4062669423006516, 'psi': 0.8036703319690452}
[S7] START round=22 head_norm_before_train=1.769742 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.4942359994502056, 'auprc': 0.777478765516893, 'loss_val': 1.1511549805410233, 'psi': 0.6075331058768805}-{'f1_val': 0.6176944025562602, 'auprc': 0.7946881262009443, 'loss_val': 0.7265141674018595, 'psi': 0.6884918920141339}
[S8] START round=22 head_norm_before_train=1.808627 (no previous merge yet)
[S8] round=22 local utility u=0.198328 metrics={'f1_val': 0.9936367563789379, 'auprc': 0.9964474762657892, 'loss_val': 0.05768317542691681, 'psi': 0.9947610443336784}-{'f1_val': 0.9393622724251038, 'auprc': 0.9935241893893758, 'loss_val': 0.1199229538598874, 'psi': 0.9610270392108127}
[S9] START round=22 head_norm_before_train=0.948448 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.011293 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9928138019043329, 'loss_val': 0.1555105055585451, 'psi': 0.9954045745459985}-{'f1_val': 0.9971317563071089, 'auprc': 0.9931966812545017, 'loss_val': 0.17924513506416623, 'psi': 0.9955577262860661}
[S10] START round=22 head_norm_before_train=1.838615 (no previous merge yet)
[S10] round=22 local utility u=0.002893 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9948660909070784, 'loss_val': 0.05464281551187244, 'psi': 0.9942690639931584}-{'f1_val': 0.993871046050545, 'auprc': 0.9947301149681833, 'loss_val': 0.06002037192448254, 'psi': 0.9942146736176003}
[S11] START round=22 head_norm_before_train=1.099715 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.050778 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976238495291397, 'loss_val': 0.22967471476439505, 'psi': 0.9969777425198096}-{'f1_val': 0.980267291664415, 'auprc': 0.9975947115888343, 'loss_val': 0.23346571819781203, 'psi': 0.9871982596341826}
[S13] START round=22 head_norm_before_train=1.640399 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.6109888414260148, 'auprc': 0.6696817512162587, 'loss_val': 0.7856330230784762, 'psi': 0.6344660053421124}-{'f1_val': 0.6333308179243401, 'auprc': 0.6274483662615691, 'loss_val': 0.6426131824734402, 'psi': 0.6309778372592317}
[S14] START round=22 head_norm_before_train=1.018065 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.014675 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9970641068896212, 'loss_val': 0.1843519461858933, 'psi': 0.9974163135857607}-{'f1_val': 0.9974082695017256, 'auprc': 0.9971522094889235, 'loss_val': 0.2125093495548274, 'psi': 0.9973058454966047}
[S15] START round=22 head_norm_before_train=1.858336 (no previous merge yet)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.6961893921700067, 'auprc': 0.8151271174106516, 'loss_val': 0.5921926964839616, 'psi': 0.7437644822662648}-{'f1_val': 0.7624783138815041, 'auprc': 0.9922411604777271, 'loss_val': 0.3560896877300026, 'psi': 0.8543834525199934}
[S16] START round=22 head_norm_before_train=1.050969 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.9035203172655838, 'auprc': 0.9946852341483738, 'loss_val': 0.4864092985296629, 'psi': 0.9399862840186998}-{'f1_val': 0.9367354306616138, 'auprc': 0.9943556166858509, 'loss_val': 0.43415896096509177, 'psi': 0.9597835050713086}
[S17] START round=22 head_norm_before_train=1.596171 (no previous merge yet)
[S17] round=22 local utility u=0.084149 metrics={'f1_val': 0.3962623089098154, 'auprc': 0.7409581947687425, 'loss_val': 0.7861647307783618, 'psi': 0.5341406632533863}-{'f1_val': 0.38768779675983583, 'auprc': 0.7371331647279087, 'loss_val': 0.8915406107629656, 'psi': 0.527465943947065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38508
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S9] not sending this round → trigger blocked (psi=0.995)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.986)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.780)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S10] not sending this round → trigger blocked (psi=0.994)
[S8] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S8
[S7] cosine check vs S8: cos=-0.0596
[S7] DROPPED delta from S8 (cos=-0.0596 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.4091
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9971 head_norm=1.040856
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.598925e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9972 head_norm=1.124228 delta_norm=0.759892
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.558675 cos_to_last_merge=0.8426 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.843
[S2] round=23 local utility u=0.015787 metrics={'f1_val': 0.704061745842822, 'auprc': 0.7788721528777719, 'loss_val': 0.3780119968292275, 'psi': 0.7339859086568019}-{'f1_val': 0.7102027146828505, 'auprc': 0.7870297238641417, 'loss_val': 0.4709054564061575, 'psi': 0.7409335183553669}
[S3] START round=23 head_norm_before_train=1.847729 cos_to_last_merge=0.7980 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.798
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.7471674099450186, 'auprc': 0.96456770208628, 'loss_val': 0.7129728313864292, 'psi': 0.8341275268015231}-{'f1_val': 0.9778196264792421, 'auprc': 0.9982178084668509, 'loss_val': 0.07964608389903054, 'psi': 0.9859788992742857}
[S4] START round=23 head_norm_before_train=1.088912 cos_to_last_merge=0.9986 (last merge round=21)
[S4] round=23 local utility u=0.882584 metrics={'f1_val': 0.9576316087348935, 'auprc': 0.9544163640943089, 'loss_val': 0.38371134789699296, 'psi': 0.9563455108786596}-{'f1_val': 0.6899378110297623, 'auprc': 0.9493406928014891, 'loss_val': 0.5274890734841762, 'psi': 0.7936989637384531}
[S5] START round=23 head_norm_before_train=1.008538 cos_to_last_merge=0.9960 (last merge round=21)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.6167835775818497, 'auprc': 0.8538479442864195, 'loss_val': 0.4916160871575319, 'psi': 0.7116093242636776}-{'f1_val': 0.6766161940101222, 'auprc': 0.9341597283306173, 'loss_val': 0.37195441280970964, 'psi': 0.7796336077383204}
[S6] START round=23 head_norm_before_train=1.068646 cos_to_last_merge=0.9961 (last merge round=20)
[S6] round=23 local utility u=1.000000 metrics={'f1_val': 0.9601888138684657, 'auprc': 0.9534086211316222, 'loss_val': 0.3931467545669556, 'psi': 0.9574767367737282}-{'f1_val': 0.7003211746645324, 'auprc': 0.809473207908749, 'loss_val': 0.45671331939690635, 'psi': 0.743981987962219}
[S7] START round=23 head_norm_before_train=1.777453 (no previous merge yet)
[S7] round=23 local utility u=0.172509 metrics={'f1_val': 0.5173432532005043, 'auprc': 0.7820091521338834, 'loss_val': 0.9583713066716795, 'psi': 0.623209612773856}-{'f1_val': 0.4942359994502056, 'auprc': 0.777478765516893, 'loss_val': 1.1511549805410233, 'psi': 0.6075331058768805}
[S8] START round=23 head_norm_before_train=1.825034 (no previous merge yet)
[S8] round=23 local utility u=0.000775 metrics={'f1_val': 0.9959161110103343, 'auprc': 0.9930167900239673, 'loss_val': 0.059516287150305124, 'psi': 0.9947563826157875}-{'f1_val': 0.9936367563789379, 'auprc': 0.9964474762657892, 'loss_val': 0.05768317542691681, 'psi': 0.9947610443336784}
[S9] START round=23 head_norm_before_train=1.124228 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.014489 metrics={'f1_val': 0.9958851710193355, 'auprc': 0.9960191740847564, 'loss_val': 0.12866824497474216, 'psi': 0.9959387722455038}-{'f1_val': 0.9971317563071089, 'auprc': 0.9928138019043329, 'loss_val': 0.1555105055585451, 'psi': 0.9954045745459985}
[S10] START round=23 head_norm_before_train=1.860229 (no previous merge yet)
[S10] round=23 local utility u=0.002572 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9956092870684258, 'loss_val': 0.050412640551788485, 'psi': 0.99443481904557}-{'f1_val': 0.993871046050545, 'auprc': 0.9948660909070784, 'loss_val': 0.05464281551187244, 'psi': 0.9942690639931584}
[S11] START round=23 head_norm_before_train=1.151863 cos_to_last_merge=0.9977 (last merge round=21)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.997320678846417, 'loss_val': 0.22966093088075773, 'psi': 0.9966084764865524}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976238495291397, 'loss_val': 0.22967471476439505, 'psi': 0.9969777425198096}
[S13] START round=23 head_norm_before_train=1.653450 (no previous merge yet)
[S13] round=23 local utility u=0.147982 metrics={'f1_val': 0.634180113602425, 'auprc': 0.6713268933518428, 'loss_val': 0.6337524677375989, 'psi': 0.6490388255021922}-{'f1_val': 0.6109888414260148, 'auprc': 0.6696817512162587, 'loss_val': 0.7856330230784762, 'psi': 0.6344660053421124}
[S14] START round=23 head_norm_before_train=1.079821 cos_to_last_merge=0.9983 (last merge round=21)
[S14] round=23 local utility u=0.020718 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969713924523168, 'loss_val': 0.14017312359735165, 'psi': 0.9971327710044026}-{'f1_val': 0.9976511180498535, 'auprc': 0.9970641068896212, 'loss_val': 0.1843519461858933, 'psi': 0.9974163135857607}
[S15] START round=23 head_norm_before_train=1.886144 (no previous merge yet)
[S15] round=23 local utility u=1.000000 metrics={'f1_val': 0.9919272683002007, 'auprc': 0.9976816544525315, 'loss_val': 0.05927836286400996, 'psi': 0.994229022761133}-{'f1_val': 0.6961893921700067, 'auprc': 0.8151271174106516, 'loss_val': 0.5921926964839616, 'psi': 0.7437644822662648}
[S16] START round=23 head_norm_before_train=1.104337 cos_to_last_merge=0.9976 (last merge round=21)
[S16] round=23 local utility u=0.016183 metrics={'f1_val': 0.9010289415523955, 'auprc': 0.9945425690293793, 'loss_val': 0.4386675918073139, 'psi': 0.938434392543189}-{'f1_val': 0.9035203172655838, 'auprc': 0.9946852341483738, 'loss_val': 0.4864092985296629, 'psi': 0.9399862840186998}
[S17] START round=23 head_norm_before_train=1.612226 (no previous merge yet)
[S17] round=23 local utility u=0.014166 metrics={'f1_val': 0.3903428948889381, 'auprc': 0.7884190881263945, 'loss_val': 0.8646989927357108, 'psi': 0.5495733721839207}-{'f1_val': 0.3962623089098154, 'auprc': 0.7409581947687425, 'loss_val': 0.7861647307783618, 'psi': 0.5341406632533863}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:38514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38508
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:38512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:38504
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] cosine check vs S15: cos=0.2199
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.6067
[S5] RECEIVED delta(kind=head bytes=1797) from S14
[S5] cosine check vs S14: cos=0.3158
[S4] RECEIVED delta(kind=head bytes=1794) from S6
[S4] cosine check vs S6: cos=0.9639
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] cosine check vs S9: cos=0.5127
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=0.7288
[S7] RECEIVED delta(kind=head bytes=1803) from S8
[S7] cosine check vs S8: cos=-0.0607
[S7] DROPPED delta from S8 (cos=-0.0607 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] cosine check vs S13: cos=0.4051
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] cosine check vs S4: cos=0.9306
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=0.8872
[S6] RECEIVED delta(kind=head bytes=1803) from S16
[S6] cosine check vs S16: cos=0.9539
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38505
[S2] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S2
[S5] cosine check vs S2: cos=0.6903
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9961 head_norm=1.208472
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.211854e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9710 head_norm=1.151719 delta_norm=0.221185
[S11] aggregate: ROLLBACK (f1_val pre=0.996 post=0.971 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.6168 head_norm=1.075689
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.822607e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.6241 head_norm=0.927819 delta_norm=0.282261
[S5] aggregate: ACCEPT kept=['S15', 'S10', 'S14', 'S2'] (k=4/4) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.9602 head_norm=1.101493
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.739375e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.6993 head_norm=1.117317 delta_norm=0.173938
[S6] aggregate: ROLLBACK (f1_val pre=0.960 post=0.699 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9576 head_norm=1.135937
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.512194e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9567 head_norm=1.108581 delta_norm=0.151219
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.9959 head_norm=1.199606
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.006098e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.9959 head_norm=1.166717 delta_norm=0.300610
[S9] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9972 head_norm=1.137555
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.326688e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9972 head_norm=1.068573 delta_norm=0.232669
[S14] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.570515 cos_to_last_merge=0.8414 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.841
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7136985991747458, 'auprc': 0.7749949618272898, 'loss_val': 0.8215402098634261, 'psi': 0.7382171442357635}-{'f1_val': 0.704061745842822, 'auprc': 0.7788721528777719, 'loss_val': 0.3780119968292275, 'psi': 0.7339859086568019}
[S3] START round=24 head_norm_before_train=1.872435 cos_to_last_merge=0.7964 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.796
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.698391671598517, 'auprc': 0.9593273110724078, 'loss_val': 0.8634092892519298, 'psi': 0.8027659273880733}-{'f1_val': 0.7471674099450186, 'auprc': 0.96456770208628, 'loss_val': 0.7129728313864292, 'psi': 0.8341275268015231}
[S4] START round=24 head_norm_before_train=1.108581 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.001937 metrics={'f1_val': 0.9518777308081332, 'auprc': 0.9656410445683141, 'loss_val': 0.37898730201563885, 'psi': 0.9573830563122055}-{'f1_val': 0.9576316087348935, 'auprc': 0.9544163640943089, 'loss_val': 0.38371134789699296, 'psi': 0.9563455108786596}
[S5] START round=24 head_norm_before_train=0.927819 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.535026 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9892344474675614, 'loss_val': 0.32894529451596777, 'psi': 0.81588613808184}-{'f1_val': 0.6167835775818497, 'auprc': 0.8538479442864195, 'loss_val': 0.4916160871575319, 'psi': 0.7116093242636776}
[S6] START round=24 head_norm_before_train=1.117317 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.031427 metrics={'f1_val': 0.9596460579889747, 'auprc': 0.9606113958237217, 'loss_val': 0.348644982719496, 'psi': 0.9600321931228735}-{'f1_val': 0.9601888138684657, 'auprc': 0.9534086211316222, 'loss_val': 0.3931467545669556, 'psi': 0.9574767367737282}
[S7] START round=24 head_norm_before_train=1.780139 (no previous merge yet)
[S7] round=24 local utility u=1.000000 metrics={'f1_val': 0.717719870429008, 'auprc': 0.9077397928520843, 'loss_val': 0.22096224457933375, 'psi': 0.7937278393982385}-{'f1_val': 0.5173432532005043, 'auprc': 0.7820091521338834, 'loss_val': 0.9583713066716795, 'psi': 0.623209612773856}
[S8] START round=24 head_norm_before_train=1.834268 (no previous merge yet)
[S8] round=24 local utility u=0.013384 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9984151724842331, 'loss_val': 0.05156452645394552, 'psi': 0.997177913955068}-{'f1_val': 0.9959161110103343, 'auprc': 0.9930167900239673, 'loss_val': 0.059516287150305124, 'psi': 0.9947563826157875}
[S9] START round=24 head_norm_before_train=1.166717 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.005667 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.992352264696438, 'loss_val': 0.11381298622554287, 'psi': 0.9952199596628406}-{'f1_val': 0.9958851710193355, 'auprc': 0.9960191740847564, 'loss_val': 0.12866824497474216, 'psi': 0.9959387722455038}
[S10] START round=24 head_norm_before_train=1.882513 (no previous merge yet)
[S10] round=24 local utility u=0.000648 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9966717451624972, 'loss_val': 0.04811157491629497, 'psi': 0.994440644082794}-{'f1_val': 0.9936518403636662, 'auprc': 0.9956092870684258, 'loss_val': 0.050412640551788485, 'psi': 0.99443481904557}
[S11] START round=24 head_norm_before_train=1.151719 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.013581 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9945299939034139, 'loss_val': 0.19515643981712924, 'psi': 0.9955950980426822}-{'f1_val': 0.9961336749133093, 'auprc': 0.997320678846417, 'loss_val': 0.22966093088075773, 'psi': 0.9966084764865524}
[S13] START round=24 head_norm_before_train=1.659807 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6296416236175619, 'auprc': 0.6727848821197098, 'loss_val': 0.6697759979720433, 'psi': 0.6468989270184211}-{'f1_val': 0.634180113602425, 'auprc': 0.6713268933518428, 'loss_val': 0.6337524677375989, 'psi': 0.6490388255021922}
[S14] START round=24 head_norm_before_train=1.068573 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9970481395732111, 'loss_val': 0.15511902786271792, 'psi': 0.9967715947957346}-{'f1_val': 0.997240356705793, 'auprc': 0.9969713924523168, 'loss_val': 0.14017312359735165, 'psi': 0.9971327710044026}
[S15] START round=24 head_norm_before_train=1.908895 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7643683386193243, 'auprc': 0.9921499972997107, 'loss_val': 0.3610111987002506, 'psi': 0.8554810020914788}-{'f1_val': 0.9919272683002007, 'auprc': 0.9976816544525315, 'loss_val': 0.05927836286400996, 'psi': 0.994229022761133}
[S16] START round=24 head_norm_before_train=1.159317 cos_to_last_merge=0.9922 (last merge round=21)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.858144998537634, 'auprc': 0.9908559466821512, 'loss_val': 0.6004648398029699, 'psi': 0.9112293777954409}-{'f1_val': 0.9010289415523955, 'auprc': 0.9945425690293793, 'loss_val': 0.4386675918073139, 'psi': 0.938434392543189}
[S17] START round=24 head_norm_before_train=1.630389 (no previous merge yet)
[S17] round=24 local utility u=0.117292 metrics={'f1_val': 0.3954054797332352, 'auprc': 0.814210389792376, 'loss_val': 0.7378648547909861, 'psi': 0.5629274437568915}-{'f1_val': 0.3903428948889381, 'auprc': 0.7884190881263945, 'loss_val': 0.8646989927357108, 'psi': 0.5495733721839207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38514
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S8] → sending delta(kind=head bytes=1809) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:38512
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:38510
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:38514
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1809 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.5917
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] cosine check vs S5: cos=0.9474
[S4] RECEIVED delta(kind=head bytes=1793) from S6
[S4] cosine check vs S6: cos=0.9755
[S14] RECEIVED delta(kind=head bytes=1807) from S7
[S14] cosine check vs S7: cos=0.7892
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=0.5125
[S7] RECEIVED delta(kind=head bytes=1809) from S8
[S7] cosine check vs S8: cos=-0.0610
[S7] DROPPED delta from S8 (cos=-0.0610 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] cosine check vs S11: cos=0.2138
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9524
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S17
[S9] cosine check vs S17: cos=0.8230
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9966 head_norm=1.118511
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.357679e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9970 head_norm=1.076017 delta_norm=0.135768
[S14] aggregate: ACCEPT kept=['S7', 'S9'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.7003 head_norm=0.984466
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.710376e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7003 head_norm=1.305403 delta_norm=0.771038
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9963 head_norm=1.202979
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.833501e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9963 head_norm=1.156454 delta_norm=0.183350
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9519 head_norm=1.137913
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.263659e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9496 head_norm=1.133417 delta_norm=0.126366
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9971 head_norm=1.225261
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.834567e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9971 head_norm=1.066794 delta_norm=0.383457
[S9] aggregate: ACCEPT kept=['S11', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.8581 head_norm=1.209165
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.095869e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.8578 head_norm=1.082451 delta_norm=0.209587
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.582386 cos_to_last_merge=0.8400 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.840
[S2] round=25 local utility u=0.171002 metrics={'f1_val': 0.718176210011975, 'auprc': 0.7913599436230523, 'loss_val': 0.5554965720413941, 'psi': 0.7474497034564058}-{'f1_val': 0.7136985991747458, 'auprc': 0.7749949618272898, 'loss_val': 0.8215402098634261, 'psi': 0.7382171442357635}
[S3] START round=25 head_norm_before_train=1.893649 cos_to_last_merge=0.7951 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.795
[S3] round=25 local utility u=0.630077 metrics={'f1_val': 0.8300549582231483, 'auprc': 0.9827920745187007, 'loss_val': 0.4636298586047491, 'psi': 0.8911498047413693}-{'f1_val': 0.698391671598517, 'auprc': 0.9593273110724078, 'loss_val': 0.8634092892519298, 'psi': 0.8027659273880733}
[S4] START round=25 head_norm_before_train=1.133417 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9416050587317227, 'auprc': 0.9296448923459609, 'loss_val': 0.37905174143084674, 'psi': 0.936820992177418}-{'f1_val': 0.9518777308081332, 'auprc': 0.9656410445683141, 'loss_val': 0.37898730201563885, 'psi': 0.9573830563122055}
[S5] START round=25 head_norm_before_train=1.305403 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.5735088031422972, 'auprc': 0.886721091439348, 'loss_val': 0.5424837955178722, 'psi': 0.6987937184611175}-{'f1_val': 0.700320598491359, 'auprc': 0.9892344474675614, 'loss_val': 0.32894529451596777, 'psi': 0.81588613808184}
[S6] START round=25 head_norm_before_train=1.142961 cos_to_last_merge=0.9991 (last merge round=23)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.6139265049694286, 'auprc': 0.7752855571625659, 'loss_val': 0.6162388431506508, 'psi': 0.6784701258466835}-{'f1_val': 0.9596460579889747, 'auprc': 0.9606113958237217, 'loss_val': 0.348644982719496, 'psi': 0.9600321931228735}
[S7] START round=25 head_norm_before_train=1.785810 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.614034343551955, 'auprc': 0.7946637233450267, 'loss_val': 0.620779570531284, 'psi': 0.6862860954691836}-{'f1_val': 0.717719870429008, 'auprc': 0.9077397928520843, 'loss_val': 0.22096224457933375, 'psi': 0.7937278393982385}
[S8] START round=25 head_norm_before_train=1.841207 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9950790219939822, 'auprc': 0.9945512088252252, 'loss_val': 0.06654977951972683, 'psi': 0.9948678967264795}-{'f1_val': 0.9963530749356245, 'auprc': 0.9984151724842331, 'loss_val': 0.05156452645394552, 'psi': 0.997177913955068}
[S9] START round=25 head_norm_before_train=1.066794 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9916690206238385, 'loss_val': 0.1364837801981574, 'psi': 0.9949466620338008}-{'f1_val': 0.9971317563071089, 'auprc': 0.992352264696438, 'loss_val': 0.11381298622554287, 'psi': 0.9952199596628406}
[S10] START round=25 head_norm_before_train=1.904726 (no previous merge yet)
[S10] round=25 local utility u=0.000472 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9967568294292907, 'loss_val': 0.0461109794699981, 'psi': 0.9943434109398408}-{'f1_val': 0.9929532433629917, 'auprc': 0.9966717451624972, 'loss_val': 0.04811157491629497, 'psi': 0.994440644082794}
[S11] START round=25 head_norm_before_train=1.156454 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.95965670083016, 'auprc': 0.9959934694569702, 'loss_val': 0.21155320657282536, 'psi': 0.974191408280884}-{'f1_val': 0.996305167468861, 'auprc': 0.9945299939034139, 'loss_val': 0.19515643981712924, 'psi': 0.9955950980426822}
[S13] START round=25 head_norm_before_train=1.665726 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.5876178723851571, 'auprc': 0.6905384280264063, 'loss_val': 0.8681505663769452, 'psi': 0.6287860946416568}-{'f1_val': 0.6296416236175619, 'auprc': 0.6727848821197098, 'loss_val': 0.6697759979720433, 'psi': 0.6468989270184211}
[S14] START round=25 head_norm_before_train=1.076017 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9438246150335925, 'auprc': 0.9969290466614893, 'loss_val': 0.18330411724827092, 'psi': 0.9650663876847513}-{'f1_val': 0.9965872316107504, 'auprc': 0.9970481395732111, 'loss_val': 0.15511902786271792, 'psi': 0.9967715947957346}
[S15] START round=25 head_norm_before_train=1.929220 (no previous merge yet)
[S15] round=25 local utility u=0.292971 metrics={'f1_val': 0.8410660051193339, 'auprc': 0.987178848482483, 'loss_val': 0.22034077443592406, 'psi': 0.8995111424645936}-{'f1_val': 0.7643683386193243, 'auprc': 0.9921499972997107, 'loss_val': 0.3610111987002506, 'psi': 0.8554810020914788}
[S16] START round=25 head_norm_before_train=1.082451 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.613623 metrics={'f1_val': 0.9915293093038144, 'auprc': 0.9909115715117789, 'loss_val': 0.17369160118972146, 'psi': 0.9912822141870002}-{'f1_val': 0.858144998537634, 'auprc': 0.9908559466821512, 'loss_val': 0.6004648398029699, 'psi': 0.9112293777954409}
[S17] START round=25 head_norm_before_train=1.653036 (no previous merge yet)
[S17] round=25 local utility u=0.683640 metrics={'f1_val': 0.618102911811026, 'auprc': 0.8191444234801839, 'loss_val': 0.721571815551041, 'psi': 0.6985195164786892}-{'f1_val': 0.3954054797332352, 'auprc': 0.814210389792376, 'loss_val': 0.7378648547909861, 'psi': 0.5629274437568915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:38507
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38505
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38505
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S3
[S5] cosine check vs S3: cos=0.1373
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=0.9815
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.1107
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] cosine check vs S2: cos=0.3632
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=0.9446
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=0.8523
[S8] ⇄ pheromone p=0.066 → S7@127.0.0.1:38508
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.5735 head_norm=1.342609
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.054689e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.5806 head_norm=1.087456 delta_norm=0.505469
[S5] aggregate: ACCEPT kept=['S3', 'S15', 'S2', 'S10'] (k=4/4) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.142 → S16@127.0.0.1:38516
[S11] ⇄ pheromone p=0.085 → S9@127.0.0.1:38510
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.6139 head_norm=1.170773
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.126075e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.6416 head_norm=1.144122 delta_norm=0.112607
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.217 → S4@127.0.0.1:38504
[S13] ⇄ pheromone p=0.056 → S9@127.0.0.1:38510
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9971 head_norm=1.129733
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.657660e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9971 head_norm=1.355532 delta_norm=0.465766
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.051 → S14@127.0.0.1:38514
[S4] ⇄ pheromone p=0.222 → S11@127.0.0.1:38512
[S14] ⇄ pheromone p=0.071 → S5@127.0.0.1:38505
[S3] ⇄ pheromone p=0.291 → S5@127.0.0.1:38505
[S15] ⇄ pheromone p=0.300 → S5@127.0.0.1:38505
[S2] ⇄ pheromone p=0.062 → S5@127.0.0.1:38505
[S16] ⇄ pheromone p=0.226 → S6@127.0.0.1:38507
[S10] ⇄ pheromone p=0.040 → S5@127.0.0.1:38505
[S7] ⇄ pheromone p=0.228 → S14@127.0.0.1:38514
[S17] ⇄ pheromone p=0.213 → S9@127.0.0.1:38510
[S2] START round=26 head_norm_before_train=1.595130 cos_to_last_merge=0.8390 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.839
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.6874787111429894, 'auprc': 0.7882323934483921, 'loss_val': 0.5294569643137801, 'psi': 0.7277801840651505}-{'f1_val': 0.718176210011975, 'auprc': 0.7913599436230523, 'loss_val': 0.5554965720413941, 'psi': 0.7474497034564058}
[S3] START round=26 head_norm_before_train=1.915113 cos_to_last_merge=0.7937 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.794
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.8233001527686432, 'auprc': 0.9801958181856008, 'loss_val': 0.5137312445508602, 'psi': 0.8860584189354261}-{'f1_val': 0.8300549582231483, 'auprc': 0.9827920745187007, 'loss_val': 0.4636298586047491, 'psi': 0.8911498047413693}
[S4] START round=26 head_norm_before_train=1.168562 cos_to_last_merge=0.9989 (last merge round=24)
[S4] round=26 local utility u=0.118802 metrics={'f1_val': 0.9474999487146318, 'auprc': 0.9725797426696181, 'loss_val': 0.30562172058829934, 'psi': 0.9575318662966263}-{'f1_val': 0.9416050587317227, 'auprc': 0.9296448923459609, 'loss_val': 0.37905174143084674, 'psi': 0.936820992177418}
[S5] START round=26 head_norm_before_train=1.087456 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.612163 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9729405499119687, 'loss_val': 0.3376869571431812, 'psi': 0.8093685790596028}-{'f1_val': 0.5735088031422972, 'auprc': 0.886721091439348, 'loss_val': 0.5424837955178722, 'psi': 0.6987937184611175}
[S6] START round=26 head_norm_before_train=1.144122 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.9595985056705737, 'auprc': 0.9602551289847482, 'loss_val': 0.3132126736831472, 'psi': 0.9598611549962435}-{'f1_val': 0.6139265049694286, 'auprc': 0.7752855571625659, 'loss_val': 0.6162388431506508, 'psi': 0.6784701258466835}
[S7] START round=26 head_norm_before_train=1.788095 (no previous merge yet)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.525529742731897, 'auprc': 0.781728596431051, 'loss_val': 0.9142828750638761, 'psi': 0.6280092842115585}-{'f1_val': 0.614034343551955, 'auprc': 0.7946637233450267, 'loss_val': 0.620779570531284, 'psi': 0.6862860954691836}
[S8] START round=26 head_norm_before_train=1.849128 (no previous merge yet)
[S8] round=26 local utility u=0.013961 metrics={'f1_val': 0.9948741547680577, 'auprc': 0.9988714604748155, 'loss_val': 0.0503602162530059, 'psi': 0.9964730770507608}-{'f1_val': 0.9950790219939822, 'auprc': 0.9945512088252252, 'loss_val': 0.06654977951972683, 'psi': 0.9948678967264795}
[S9] START round=26 head_norm_before_train=1.355532 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.023675 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9953991490171458, 'loss_val': 0.10032347848908285, 'psi': 0.9964387133911237}-{'f1_val': 0.9971317563071089, 'auprc': 0.9916690206238385, 'loss_val': 0.1364837801981574, 'psi': 0.9949466620338008}
[S10] START round=26 head_norm_before_train=1.923817 (no previous merge yet)
[S10] round=26 local utility u=0.004657 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9954884329427514, 'loss_val': 0.03981081813930454, 'psi': 0.9945180008074275}-{'f1_val': 0.9927344652802075, 'auprc': 0.9967568294292907, 'loss_val': 0.0461109794699981, 'psi': 0.9943434109398408}
[S11] START round=26 head_norm_before_train=1.206800 cos_to_last_merge=0.9973 (last merge round=24)
[S11] round=26 local utility u=0.144948 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983694381626771, 'loss_val': 0.15012790853244976, 'psi': 0.9972759779732245}-{'f1_val': 0.95965670083016, 'auprc': 0.9959934694569702, 'loss_val': 0.21155320657282536, 'psi': 0.974191408280884}
[S13] START round=26 head_norm_before_train=1.671525 (no previous merge yet)
[S13] round=26 local utility u=0.116082 metrics={'f1_val': 0.6180574869318431, 'auprc': 0.6435399247182123, 'loss_val': 0.6776289152102963, 'psi': 0.6282504620463908}-{'f1_val': 0.5876178723851571, 'auprc': 0.6905384280264063, 'loss_val': 0.8681505663769452, 'psi': 0.6287860946416568}
[S14] START round=26 head_norm_before_train=1.124927 cos_to_last_merge=0.9988 (last merge round=24)
[S14] round=26 local utility u=0.191340 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969483387027436, 'loss_val': 0.1197183902092744, 'psi': 0.9969778403756965}-{'f1_val': 0.9438246150335925, 'auprc': 0.9969290466614893, 'loss_val': 0.18330411724827092, 'psi': 0.9650663876847513}
[S15] START round=26 head_norm_before_train=1.948963 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.8016913079152356, 'auprc': 0.9941644666458497, 'loss_val': 0.2947823509405582, 'psi': 0.8786805714074812}-{'f1_val': 0.8410660051193339, 'auprc': 0.987178848482483, 'loss_val': 0.22034077443592406, 'psi': 0.8995111424645936}
[S16] START round=26 head_norm_before_train=1.128132 cos_to_last_merge=0.9989 (last merge round=24)
[S16] round=26 local utility u=0.018806 metrics={'f1_val': 0.991302604972911, 'auprc': 0.9917509134964305, 'loss_val': 0.1372366562437326, 'psi': 0.9914819283823189}-{'f1_val': 0.9915293093038144, 'auprc': 0.9909115715117789, 'loss_val': 0.17369160118972146, 'psi': 0.9912822141870002}
[S17] START round=26 head_norm_before_train=1.683007 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.39291962362552957, 'auprc': 0.8141552185421349, 'loss_val': 0.8014172216405452, 'psi': 0.5614138615921718}-{'f1_val': 0.618102911811026, 'auprc': 0.8191444234801839, 'loss_val': 0.721571815551041, 'psi': 0.6985195164786892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:38512
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=0.9543
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38516
[S5] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.9322
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38505
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:38514
[S4] RECEIVED delta(kind=head bytes=1797) from S6
[S4] cosine check vs S6: cos=0.9784
[S10] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S10
[S5] cosine check vs S10: cos=0.7930
[S9] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=0.4567
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:38510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:38510
[S13] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1807) from S13
[S9] cosine check vs S13: cos=0.2514
[S9] RECEIVED delta(kind=head bytes=1803) from S11
[S9] cosine check vs S11: cos=0.1880
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:38507
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] → sending delta(kind=head bytes=1808) to S7@127.0.0.1:38508
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S14
[S5] cosine check vs S14: cos=0.1306
[S16] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=0.9922
[S8] sending update (kind=head size=1808 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1808) from S8
[S7] cosine check vs S8: cos=-0.0609
[S7] DROPPED delta from S8 (cos=-0.0609 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9475 head_norm=1.215802
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.262874e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9464 head_norm=1.183823 delta_norm=0.126287
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.7003 head_norm=1.122010
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.116368e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.7003 head_norm=1.057931 delta_norm=0.411637
[S5] aggregate: ACCEPT kept=['S10', 'S14'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.9965 head_norm=1.260833
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.884805e-01
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.9965 head_norm=1.224097 delta_norm=0.188480
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9970 head_norm=1.176298
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.825526e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9970 head_norm=1.106943 delta_norm=0.682553
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.9596 head_norm=1.164731
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.328702e-02
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.9288 head_norm=1.167069 delta_norm=0.073287
[S6] aggregate: ROLLBACK (f1_val pre=0.960 post=0.929 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.9971 head_norm=1.413763
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.548910e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.9971 head_norm=1.017865 delta_norm=0.754891
[S9] aggregate: ACCEPT kept=['S13', 'S11'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.9913 head_norm=1.173986
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.129520e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.9913 head_norm=1.128373 delta_norm=0.212952
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.609085 cos_to_last_merge=0.8382 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.838
[S2] round=27 local utility u=0.322860 metrics={'f1_val': 0.7006092462491879, 'auprc': 0.8729269384940298, 'loss_val': 0.21660288811381814, 'psi': 0.7695363231471246}-{'f1_val': 0.6874787111429894, 'auprc': 0.7882323934483921, 'loss_val': 0.5294569643137801, 'psi': 0.7277801840651505}
[S3] START round=27 head_norm_before_train=1.936458 cos_to_last_merge=0.7922 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.792
[S3] round=27 local utility u=0.575007 metrics={'f1_val': 0.9428143325152761, 'auprc': 0.996693821559564, 'loss_val': 0.13029558045270734, 'psi': 0.9643661281329912}-{'f1_val': 0.8233001527686432, 'auprc': 0.9801958181856008, 'loss_val': 0.5137312445508602, 'psi': 0.8860584189354261}
[S4] START round=27 head_norm_before_train=1.183823 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9425496969706241, 'auprc': 0.9625925430144397, 'loss_val': 0.3040872867328706, 'psi': 0.9505668353881505}-{'f1_val': 0.9474999487146318, 'auprc': 0.9725797426696181, 'loss_val': 0.30562172058829934, 'psi': 0.9575318662966263}
[S5] START round=27 head_norm_before_train=1.057931 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.6627707972098416, 'auprc': 0.9547874394624097, 'loss_val': 0.3843181830693894, 'psi': 0.7795774541108689}-{'f1_val': 0.700320598491359, 'auprc': 0.9729405499119687, 'loss_val': 0.3376869571431812, 'psi': 0.8093685790596028}
[S6] START round=27 head_norm_before_train=1.167069 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.654152089761134, 'auprc': 0.7760417041470247, 'loss_val': 0.5503978279565329, 'psi': 0.7029079355154904}-{'f1_val': 0.9595985056705737, 'auprc': 0.9602551289847482, 'loss_val': 0.3132126736831472, 'psi': 0.9598611549962435}
[S7] START round=27 head_norm_before_train=1.795406 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.518622187658823, 'auprc': 0.782043270299949, 'loss_val': 0.9285850246634085, 'psi': 0.6239906207152734}-{'f1_val': 0.525529742731897, 'auprc': 0.781728596431051, 'loss_val': 0.9142828750638761, 'psi': 0.6280092842115585}
[S8] START round=27 head_norm_before_train=1.863116 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9947267123181514, 'auprc': 0.9929802780087222, 'loss_val': 0.05176717757421239, 'psi': 0.9940281385943797}-{'f1_val': 0.9948741547680577, 'auprc': 0.9988714604748155, 'loss_val': 0.0503602162530059, 'psi': 0.9964730770507608}
[S9] START round=27 head_norm_before_train=1.017865 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.996750526393083, 'auprc': 0.9909729223124744, 'loss_val': 0.12126455967057292, 'psi': 0.9944394847608395}-{'f1_val': 0.9971317563071089, 'auprc': 0.9953991490171458, 'loss_val': 0.10032347848908285, 'psi': 0.9964387133911237}
[S10] START round=27 head_norm_before_train=1.941125 (no previous merge yet)
[S10] round=27 local utility u=0.003260 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9951480978521836, 'loss_val': 0.03753472740810188, 'psi': 0.994908404672497}-{'f1_val': 0.993871046050545, 'auprc': 0.9954884329427514, 'loss_val': 0.03981081813930454, 'psi': 0.9945180008074275}
[S11] START round=27 head_norm_before_train=1.224097 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9954691416423189, 'auprc': 0.9961638022065499, 'loss_val': 0.17359384044132103, 'psi': 0.9957470058680113}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983694381626771, 'loss_val': 0.15012790853244976, 'psi': 0.9972759779732245}
[S13] START round=27 head_norm_before_train=1.680422 (no previous merge yet)
[S13] round=27 local utility u=0.063129 metrics={'f1_val': 0.6160894964357889, 'auprc': 0.6718881721994987, 'loss_val': 0.6246082538908144, 'psi': 0.6384089667412729}-{'f1_val': 0.6180574869318431, 'auprc': 0.6435399247182123, 'loss_val': 0.6776289152102963, 'psi': 0.6282504620463908}
[S14] START round=27 head_norm_before_train=1.106943 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9970908426933331, 'loss_val': 0.23989254071696436, 'psi': 0.9971805511008092}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969483387027436, 'loss_val': 0.1197183902092744, 'psi': 0.9969778403756965}
[S15] START round=27 head_norm_before_train=1.967426 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.7774955962535278, 'auprc': 0.9894515657950518, 'loss_val': 0.2927945597256899, 'psi': 0.8622779840701373}-{'f1_val': 0.8016913079152356, 'auprc': 0.9941644666458497, 'loss_val': 0.2947823509405582, 'psi': 0.8786805714074812}
[S16] START round=27 head_norm_before_train=1.128373 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.9237636030650476, 'auprc': 0.9910328987435771, 'loss_val': 0.3891944167917367, 'psi': 0.9506713213364595}-{'f1_val': 0.991302604972911, 'auprc': 0.9917509134964305, 'loss_val': 0.1372366562437326, 'psi': 0.9914819283823189}
[S17] START round=27 head_norm_before_train=1.717314 (no previous merge yet)
[S17] round=27 local utility u=0.800169 metrics={'f1_val': 0.6205507639742167, 'auprc': 0.8369443894539663, 'loss_val': 0.6352343170366399, 'psi': 0.7071082141661165}-{'f1_val': 0.39291962362552957, 'auprc': 0.8141552185421349, 'loss_val': 0.8014172216405452, 'psi': 0.5614138615921718}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:38510
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1807 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1807) from S13
[S9] cosine check vs S13: cos=0.6205
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.8778
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S17
[S9] cosine check vs S17: cos=0.7055
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9968 head_norm=1.090418
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.777927e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9968 head_norm=1.148704 delta_norm=0.277793
[S9] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.6628 head_norm=1.094649
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.633120e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.6674 head_norm=1.482793 delta_norm=0.563312
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.620231 cos_to_last_merge=0.8376 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.838
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7202607260956926, 'auprc': 0.7940510440802027, 'loss_val': 0.6077235420162561, 'psi': 0.7497768532894966}-{'f1_val': 0.7006092462491879, 'auprc': 0.8729269384940298, 'loss_val': 0.21660288811381814, 'psi': 0.7695363231471246}
[S3] START round=28 head_norm_before_train=1.957531 cos_to_last_merge=0.7908 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.791
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.682644975436777, 'auprc': 0.9460181077819985, 'loss_val': 0.9869995249603815, 'psi': 0.7879942283748655}-{'f1_val': 0.9428143325152761, 'auprc': 0.996693821559564, 'loss_val': 0.13029558045270734, 'psi': 0.9643661281329912}
[S4] START round=28 head_norm_before_train=1.231636 cos_to_last_merge=0.9984 (last merge round=26)
[S4] round=28 local utility u=0.069074 metrics={'f1_val': 0.9531025818233132, 'auprc': 0.976429652577658, 'loss_val': 0.27076718891357376, 'psi': 0.9624334101250511}-{'f1_val': 0.9425496969706241, 'auprc': 0.9625925430144397, 'loss_val': 0.3040872867328706, 'psi': 0.9505668353881505}
[S5] START round=28 head_norm_before_train=1.482793 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.190945 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9877790121801595, 'loss_val': 0.3267068456684456, 'psi': 0.8153043953324121}-{'f1_val': 0.6627707972098416, 'auprc': 0.9547874394624097, 'loss_val': 0.3843181830693894, 'psi': 0.7795774541108689}
[S6] START round=28 head_norm_before_train=1.184186 cos_to_last_merge=0.9993 (last merge round=26)
[S6] round=28 local utility u=1.000000 metrics={'f1_val': 0.8765915700212255, 'auprc': 0.9571609962001193, 'loss_val': 0.3539314465306121, 'psi': 0.908819340492783}-{'f1_val': 0.654152089761134, 'auprc': 0.7760417041470247, 'loss_val': 0.5503978279565329, 'psi': 0.7029079355154904}
[S7] START round=28 head_norm_before_train=1.808976 (no previous merge yet)
[S7] round=28 local utility u=0.034221 metrics={'f1_val': 0.516587208907771, 'auprc': 0.7806006653467694, 'loss_val': 0.843605436502159, 'psi': 0.6221925914833704}-{'f1_val': 0.518622187658823, 'auprc': 0.782043270299949, 'loss_val': 0.9285850246634085, 'psi': 0.6239906207152734}
[S8] START round=28 head_norm_before_train=1.874719 (no previous merge yet)
[S8] round=28 local utility u=0.009533 metrics={'f1_val': 0.9947267123181514, 'auprc': 0.997794848592126, 'loss_val': 0.047145721715330435, 'psi': 0.9959539668277413}-{'f1_val': 0.9947267123181514, 'auprc': 0.9929802780087222, 'loss_val': 0.05176717757421239, 'psi': 0.9940281385943797}
[S9] START round=28 head_norm_before_train=1.148704 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.019574 metrics={'f1_val': 0.9963334817266025, 'auprc': 0.9956184610310588, 'loss_val': 0.09355110700754024, 'psi': 0.9960474734483851}-{'f1_val': 0.996750526393083, 'auprc': 0.9909729223124744, 'loss_val': 0.12126455967057292, 'psi': 0.9944394847608395}
[S10] START round=28 head_norm_before_train=1.957993 (no previous merge yet)
[S10] round=28 local utility u=0.000870 metrics={'f1_val': 0.9942851896505369, 'auprc': 0.9962730101166875, 'loss_val': 0.03638864061365345, 'psi': 0.9950803178369971}-{'f1_val': 0.9947486092193725, 'auprc': 0.9951480978521836, 'loss_val': 0.03753472740810188, 'psi': 0.994908404672497}
[S11] START round=28 head_norm_before_train=1.271808 cos_to_last_merge=0.9983 (last merge round=26)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9868054331490699, 'auprc': 0.9963330645117385, 'loss_val': 0.13686898154198165, 'psi': 0.9906164856941373}-{'f1_val': 0.9954691416423189, 'auprc': 0.9961638022065499, 'loss_val': 0.17359384044132103, 'psi': 0.9957470058680113}
[S13] START round=28 head_norm_before_train=1.688842 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5685638229286787, 'auprc': 0.6890673005271231, 'loss_val': 0.848948406202804, 'psi': 0.6167652139680564}-{'f1_val': 0.6160894964357889, 'auprc': 0.6718881721994987, 'loss_val': 0.6246082538908144, 'psi': 0.6384089667412729}
[S14] START round=28 head_norm_before_train=1.153240 cos_to_last_merge=0.9980 (last merge round=26)
[S14] round=28 local utility u=0.016632 metrics={'f1_val': 0.9928837287011565, 'auprc': 0.9970873949285826, 'loss_val': 0.1804783751774442, 'psi': 0.9945651951921268}-{'f1_val': 0.997240356705793, 'auprc': 0.9970908426933331, 'loss_val': 0.23989254071696436, 'psi': 0.9971805511008092}
[S15] START round=28 head_norm_before_train=1.982158 (no previous merge yet)
[S15] round=28 local utility u=0.434849 metrics={'f1_val': 0.8954810399290587, 'auprc': 0.9961553539063646, 'loss_val': 0.15112007103398384, 'psi': 0.935750765519981}-{'f1_val': 0.7774955962535278, 'auprc': 0.9894515657950518, 'loss_val': 0.2927945597256899, 'psi': 0.8622779840701373}
[S16] START round=28 head_norm_before_train=1.170898 cos_to_last_merge=0.9991 (last merge round=26)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8574811005238295, 'auprc': 0.9897558160472094, 'loss_val': 0.615612347106488, 'psi': 0.9103909867331815}-{'f1_val': 0.9237636030650476, 'auprc': 0.9910328987435771, 'loss_val': 0.3891944167917367, 'psi': 0.9506713213364595}
[S17] START round=28 head_norm_before_train=1.744498 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6167347343009311, 'auprc': 0.8086040742362667, 'loss_val': 0.9683891629258552, 'psi': 0.6934824702750653}-{'f1_val': 0.6205507639742167, 'auprc': 0.8369443894539663, 'loss_val': 0.6352343170366399, 'psi': 0.7071082141661165}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:38515
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:38517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:38509
[S10] not sending this round → trigger blocked (psi=0.995)
[S7] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S7
[S8] cosine check vs S7: cos=-0.0612
[S8] DROPPED delta from S7 (cos=-0.0612 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] cosine check vs S5: cos=0.0406
[S6] RECEIVED delta(kind=head bytes=1799) from S4
[S6] cosine check vs S4: cos=0.9797
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=0.9823
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.4342
[S17] RECEIVED delta(kind=head bytes=1806) from S9
[S17] cosine check vs S9: cos=0.7436
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.5166 head_norm=1.817083
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.446097e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.5302 head_norm=1.290452 delta_norm=0.844610
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.8766 head_norm=1.199841
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.305072e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.9408 head_norm=1.232144 delta_norm=0.130507
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.8955 head_norm=1.994335
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.227077e+00
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.8543 head_norm=1.276096 delta_norm=1.227077
[S15] aggregate: ROLLBACK (f1_val pre=0.895 post=0.854 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.8575 head_norm=1.213103
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.137946e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.8584 head_norm=1.201112 delta_norm=0.113795
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.6167 head_norm=1.771420
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.945150e-01
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.6149 head_norm=1.396906 delta_norm=0.594515
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.629380 cos_to_last_merge=0.8371 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.837
[S2] round=29 local utility u=0.128112 metrics={'f1_val': 0.7085679462795612, 'auprc': 0.7998337152842371, 'loss_val': 0.29869002337743705, 'psi': 0.7450742538814317}-{'f1_val': 0.7202607260956926, 'auprc': 0.7940510440802027, 'loss_val': 0.6077235420162561, 'psi': 0.7497768532894966}
[S3] START round=29 head_norm_before_train=1.973415 cos_to_last_merge=0.7900 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.790
[S3] round=29 local utility u=0.964571 metrics={'f1_val': 0.8721428835663321, 'auprc': 0.996703065847635, 'loss_val': 0.3469007197028643, 'psi': 0.9219669564788532}-{'f1_val': 0.682644975436777, 'auprc': 0.9460181077819985, 'loss_val': 0.9869995249603815, 'psi': 0.7879942283748655}
[S4] START round=29 head_norm_before_train=1.277028 cos_to_last_merge=0.9951 (last merge round=26)
[S4] round=29 local utility u=0.006252 metrics={'f1_val': 0.9563503543851574, 'auprc': 0.9694689224080412, 'loss_val': 0.25686826197930784, 'psi': 0.9615977815943109}-{'f1_val': 0.9531025818233132, 'auprc': 0.976429652577658, 'loss_val': 0.27076718891357376, 'psi': 0.9624334101250511}
[S5] START round=29 head_norm_before_train=1.513575 cos_to_last_merge=0.9991 (last merge round=27)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.6699545623490275, 'auprc': 0.9541743122166482, 'loss_val': 0.35266132354409957, 'psi': 0.7836424622960758}-{'f1_val': 0.7003213174339138, 'auprc': 0.9877790121801595, 'loss_val': 0.3267068456684456, 'psi': 0.8153043953324121}
[S6] START round=29 head_norm_before_train=1.232144 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.331223 metrics={'f1_val': 0.9612630228425124, 'auprc': 0.9717246749899475, 'loss_val': 0.24320462536873325, 'psi': 0.9654476837014865}-{'f1_val': 0.8765915700212255, 'auprc': 0.9571609962001193, 'loss_val': 0.3539314465306121, 'psi': 0.908819340492783}
[S7] START round=29 head_norm_before_train=1.290452 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=1.000000 metrics={'f1_val': 0.7362417016685476, 'auprc': 0.9110529893905646, 'loss_val': 0.2928566230868862, 'psi': 0.8061662167573544}-{'f1_val': 0.516587208907771, 'auprc': 0.7806006653467694, 'loss_val': 0.843605436502159, 'psi': 0.6221925914833704}
[S8] START round=29 head_norm_before_train=1.891016 (no previous merge yet)
[S8] round=29 local utility u=0.005056 metrics={'f1_val': 0.9956124759962259, 'auprc': 0.9990930890182148, 'loss_val': 0.046243951837300096, 'psi': 0.9970047212050215}-{'f1_val': 0.9947267123181514, 'auprc': 0.997794848592126, 'loss_val': 0.047145721715330435, 'psi': 0.9959539668277413}
[S9] START round=29 head_norm_before_train=1.213121 cos_to_last_merge=0.9979 (last merge round=27)
[S9] round=29 local utility u=0.011716 metrics={'f1_val': 0.9964678035083712, 'auprc': 0.9955367856557586, 'loss_val': 0.07067939788248367, 'psi': 0.9960953963673261}-{'f1_val': 0.9963334817266025, 'auprc': 0.9956184610310588, 'loss_val': 0.09355110700754024, 'psi': 0.9960474734483851}
[S10] START round=29 head_norm_before_train=1.974147 (no previous merge yet)
[S10] round=29 local utility u=0.000756 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9965854780616936, 'loss_val': 0.034645488126015936, 'psi': 0.9950883865228457}-{'f1_val': 0.9942851896505369, 'auprc': 0.9962730101166875, 'loss_val': 0.03638864061365345, 'psi': 0.9950803178369971}
[S11] START round=29 head_norm_before_train=1.315520 cos_to_last_merge=0.9946 (last merge round=26)
[S11] round=29 local utility u=0.045334 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9963950254181722, 'loss_val': 0.10483574214486237, 'psi': 0.9964862128754226}-{'f1_val': 0.9868054331490699, 'auprc': 0.9963330645117385, 'loss_val': 0.13686898154198165, 'psi': 0.9906164856941373}
[S13] START round=29 head_norm_before_train=1.697697 (no previous merge yet)
[S13] round=29 local utility u=0.183089 metrics={'f1_val': 0.6107479204665454, 'auprc': 0.6754532644594201, 'loss_val': 0.6950325024593929, 'psi': 0.6366300580636952}-{'f1_val': 0.5685638229286787, 'auprc': 0.6890673005271231, 'loss_val': 0.848948406202804, 'psi': 0.6167652139680564}
[S14] START round=29 head_norm_before_train=1.206429 cos_to_last_merge=0.9924 (last merge round=26)
[S14] round=29 local utility u=0.042123 metrics={'f1_val': 0.9976483782674455, 'auprc': 0.9987982461312879, 'loss_val': 0.12995286457514196, 'psi': 0.9981083254129823}-{'f1_val': 0.9928837287011565, 'auprc': 0.9970873949285826, 'loss_val': 0.1804783751774442, 'psi': 0.9945651951921268}
[S15] START round=29 head_norm_before_train=1.276096 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.7396065253365002, 'auprc': 0.8610645182225223, 'loss_val': 0.42022250993701427, 'psi': 0.7881897224909091}-{'f1_val': 0.8954810399290587, 'auprc': 0.9961553539063646, 'loss_val': 0.15112007103398384, 'psi': 0.935750765519981}
[S16] START round=29 head_norm_before_train=1.201112 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.657907 metrics={'f1_val': 0.9904103707988213, 'auprc': 0.9920407182702486, 'loss_val': 0.10422920346717329, 'psi': 0.9910625097873923}-{'f1_val': 0.8574811005238295, 'auprc': 0.9897558160472094, 'loss_val': 0.615612347106488, 'psi': 0.9103909867331815}
[S17] START round=29 head_norm_before_train=1.396906 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=0.190913 metrics={'f1_val': 0.628209744778832, 'auprc': 0.830801522088525, 'loss_val': 0.722004577733844, 'psi': 0.7092464557027092}-{'f1_val': 0.6167347343009311, 'auprc': 0.8086040742362667, 'loss_val': 0.9683891629258552, 'psi': 0.6934824702750653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38516
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S6
[S16] cosine check vs S6: cos=0.9872
[S6] RECEIVED delta(kind=head bytes=1799) from S4
[S6] cosine check vs S4: cos=0.9922
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:38509
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=-0.0411
[S8] DROPPED delta from S7 (cos=-0.0411 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:38504
[S11] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] cosine check vs S11: cos=0.9562
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:38517
[S9] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S9
[S17] cosine check vs S9: cos=0.9003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.7784
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S16] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S16
[S5] cosine check vs S16: cos=0.7958
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.6700 head_norm=1.532707
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.641444e-01
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.6688 head_norm=1.313963 delta_norm=0.464144
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.7362 head_norm=1.313105
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.281640e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.8449 head_norm=1.210236 delta_norm=0.428164
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.9613 head_norm=1.247571
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.599084e-02
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.9613 head_norm=1.276465 delta_norm=0.085991
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9564 head_norm=1.310374
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.986149e-01
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9568 head_norm=1.318899 delta_norm=0.198615
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9904 head_norm=1.238817
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.972699e-02
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9904 head_norm=1.239195 delta_norm=0.099727
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.6282 head_norm=1.429821
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.113929e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.6428 head_norm=1.314860 delta_norm=0.311393
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.641364 cos_to_last_merge=0.8360 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.836
[S2] round=30 local utility u=0.223458 metrics={'f1_val': 0.7188851822172756, 'auprc': 0.9101739214976877, 'loss_val': 0.24469771849334732, 'psi': 0.7954006779294405}-{'f1_val': 0.7085679462795612, 'auprc': 0.7998337152842371, 'loss_val': 0.29869002337743705, 'psi': 0.7450742538814317}
[S3] START round=30 head_norm_before_train=1.991232 cos_to_last_merge=0.7887 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.789
[S3] round=30 local utility u=0.142801 metrics={'f1_val': 0.9083897882780564, 'auprc': 0.9957427466915569, 'loss_val': 0.2758993681162876, 'psi': 0.9433309716434566}-{'f1_val': 0.8721428835663321, 'auprc': 0.996703065847635, 'loss_val': 0.3469007197028643, 'psi': 0.9219669564788532}
[S4] START round=30 head_norm_before_train=1.318899 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9390273861860581, 'auprc': 0.9333011534675263, 'loss_val': 0.2734383167563006, 'psi': 0.9367368930986453}-{'f1_val': 0.9563503543851574, 'auprc': 0.9694689224080412, 'loss_val': 0.25686826197930784, 'psi': 0.9615977815943109}
[S5] START round=30 head_norm_before_train=1.313963 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.42812314874436574, 'auprc': 0.8430976546921363, 'loss_val': 1.1168159106718458, 'psi': 0.594112951123474}-{'f1_val': 0.6699545623490275, 'auprc': 0.9541743122166482, 'loss_val': 0.35266132354409957, 'psi': 0.7836424622960758}
[S6] START round=30 head_norm_before_train=1.276465 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.5955879714515893, 'auprc': 0.7787457720009654, 'loss_val': 0.5527819468045853, 'psi': 0.6688510916713397}-{'f1_val': 0.9612630228425124, 'auprc': 0.9717246749899475, 'loss_val': 0.24320462536873325, 'psi': 0.9654476837014865}
[S7] START round=30 head_norm_before_train=1.210236 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.6232611450351213, 'auprc': 0.7942771245058105, 'loss_val': 0.6386896335576182, 'psi': 0.691667536823397}-{'f1_val': 0.7362417016685476, 'auprc': 0.9110529893905646, 'loss_val': 0.2928566230868862, 'psi': 0.8061662167573544}
[S8] START round=30 head_norm_before_train=1.907030 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9989800341368262, 'loss_val': 0.04056917321097668, 'psi': 0.9959871554078386}-{'f1_val': 0.9956124759962259, 'auprc': 0.9990930890182148, 'loss_val': 0.046243951837300096, 'psi': 0.9970047212050215}
[S9] START round=30 head_norm_before_train=1.267776 cos_to_last_merge=0.9935 (last merge round=27)
[S9] round=30 local utility u=0.004852 metrics={'f1_val': 0.9964678035083712, 'auprc': 0.9951757942881544, 'loss_val': 0.059892660684024504, 'psi': 0.9959509998202845}-{'f1_val': 0.9964678035083712, 'auprc': 0.9955367856557586, 'loss_val': 0.07067939788248367, 'psi': 0.9960953963673261}
[S10] START round=30 head_norm_before_train=1.985139 (no previous merge yet)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9961069238588083, 'loss_val': 0.03369526233391523, 'psi': 0.9948969648416915}-{'f1_val': 0.9940903254969471, 'auprc': 0.9965854780616936, 'loss_val': 0.034645488126015936, 'psi': 0.9950883865228457}
[S11] START round=30 head_norm_before_train=1.356763 cos_to_last_merge=0.9902 (last merge round=26)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9863564000658616, 'auprc': 0.9978402505306987, 'loss_val': 0.1451016735379399, 'psi': 0.9909499402517964}-{'f1_val': 0.9965470045135896, 'auprc': 0.9963950254181722, 'loss_val': 0.10483574214486237, 'psi': 0.9964862128754226}
[S13] START round=30 head_norm_before_train=1.704366 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5373398625003116, 'auprc': 0.6983193972675721, 'loss_val': 0.8705599196830326, 'psi': 0.6017316764072158}-{'f1_val': 0.6107479204665454, 'auprc': 0.6754532644594201, 'loss_val': 0.6950325024593929, 'psi': 0.6366300580636952}
[S14] START round=30 head_norm_before_train=1.253693 cos_to_last_merge=0.9859 (last merge round=26)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9806544189294047, 'auprc': 0.9970849693967998, 'loss_val': 0.1147238845129696, 'psi': 0.9872266391163628}-{'f1_val': 0.9976483782674455, 'auprc': 0.9987982461312879, 'loss_val': 0.12995286457514196, 'psi': 0.9981083254129823}
[S15] START round=30 head_norm_before_train=1.313337 cos_to_last_merge=0.9992 (last merge round=28)
[S15] round=30 local utility u=0.917216 metrics={'f1_val': 0.9356738638643878, 'auprc': 0.9968440985900853, 'loss_val': 0.16953371023118383, 'psi': 0.9601419577546668}-{'f1_val': 0.7396065253365002, 'auprc': 0.8610645182225223, 'loss_val': 0.42022250993701427, 'psi': 0.7881897224909091}
[S16] START round=30 head_norm_before_train=1.239195 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9479735694369813, 'auprc': 0.9915430419116789, 'loss_val': 0.1721541827854777, 'psi': 0.9654013584268603}-{'f1_val': 0.9904103707988213, 'auprc': 0.9920407182702486, 'loss_val': 0.10422920346717329, 'psi': 0.9910625097873923}
[S17] START round=30 head_norm_before_train=1.314860 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6315314450116029, 'auprc': 0.8146699989657284, 'loss_val': 0.8670601808606332, 'psi': 0.7047868665932531}-{'f1_val': 0.628209744778832, 'auprc': 0.830801522088525, 'loss_val': 0.722004577733844, 'psi': 0.7092464557027092}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:38517
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] cosine check vs S9: cos=0.9652
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.048 → S7@127.0.0.1:38508
[S5] ⇄ pheromone p=0.121 → S15@127.0.0.1:38515
[S4] ⇄ pheromone p=0.092 → S6@127.0.0.1:38507
[S7] ⇄ pheromone p=0.239 → S8@127.0.0.1:38509
[S11] ⇄ pheromone p=0.047 → S4@127.0.0.1:38504
[S6] ⇄ pheromone p=0.334 → S16@127.0.0.1:38516
[S9] ⇄ pheromone p=0.024 → S17@127.0.0.1:38517
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.6315 head_norm=1.358426
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.777488e-01
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.6283 head_norm=1.323923 delta_norm=0.177749
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.182 → S9@127.0.0.1:38510
[S16] ⇄ pheromone p=0.181 → S6@127.0.0.1:38507
[S2] START round=31 head_norm_before_train=1.654888 cos_to_last_merge=0.8343 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.834
[S2] round=31 local utility u=0.029732 metrics={'f1_val': 0.7083101783210911, 'auprc': 0.9740534702225273, 'loss_val': 0.3134223315827588, 'psi': 0.8146074950816655}-{'f1_val': 0.7188851822172756, 'auprc': 0.9101739214976877, 'loss_val': 0.24469771849334732, 'psi': 0.7954006779294405}
[S3] START round=31 head_norm_before_train=2.009489 cos_to_last_merge=0.7873 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.787
[S3] round=31 local utility u=0.157711 metrics={'f1_val': 0.9443008741126334, 'auprc': 0.995389472949685, 'loss_val': 0.1748849243656992, 'psi': 0.964736313647454}-{'f1_val': 0.9083897882780564, 'auprc': 0.9957427466915569, 'loss_val': 0.2758993681162876, 'psi': 0.9433309716434566}
[S4] START round=31 head_norm_before_train=1.341318 cos_to_last_merge=0.9999 (last merge round=29)
[S4] round=31 local utility u=0.019869 metrics={'f1_val': 0.9410508037389258, 'auprc': 0.9402021500007521, 'loss_val': 0.26654420348101493, 'psi': 0.9407113422436564}-{'f1_val': 0.9390273861860581, 'auprc': 0.9333011534675263, 'loss_val': 0.2734383167563006, 'psi': 0.9367368930986453}
[S5] START round=31 head_norm_before_train=1.334422 cos_to_last_merge=0.9998 (last merge round=29)
[S5] round=31 local utility u=1.000000 metrics={'f1_val': 0.6660067596633608, 'auprc': 0.8389237874765073, 'loss_val': 0.4502314498000263, 'psi': 0.7351735707886193}-{'f1_val': 0.42812314874436574, 'auprc': 0.8430976546921363, 'loss_val': 1.1168159106718458, 'psi': 0.594112951123474}
[S6] START round=31 head_norm_before_train=1.292231 cos_to_last_merge=0.9997 (last merge round=29)
[S6] round=31 local utility u=1.000000 metrics={'f1_val': 0.8378912198289092, 'auprc': 0.9587714040005509, 'loss_val': 0.29677340217736253, 'psi': 0.8862432934975659}-{'f1_val': 0.5955879714515893, 'auprc': 0.7787457720009654, 'loss_val': 0.5527819468045853, 'psi': 0.6688510916713397}
[S7] START round=31 head_norm_before_train=1.253010 cos_to_last_merge=0.9978 (last merge round=29)
[S7] round=31 local utility u=0.141498 metrics={'f1_val': 0.6476732434569079, 'auprc': 0.8049493366736559, 'loss_val': 0.5341819031189753, 'psi': 0.7105836807436071}-{'f1_val': 0.6232611450351213, 'auprc': 0.7942771245058105, 'loss_val': 0.6386896335576182, 'psi': 0.691667536823397}
[S8] START round=31 head_norm_before_train=1.919937 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9942168943487393, 'loss_val': 0.04120113743831805, 'psi': 0.9943021740988116}-{'f1_val': 0.9939919029218467, 'auprc': 0.9989800341368262, 'loss_val': 0.04056917321097668, 'psi': 0.9959871554078386}
[S9] START round=31 head_norm_before_train=1.312787 cos_to_last_merge=0.9888 (last merge round=27)
[S9] round=31 local utility u=0.005410 metrics={'f1_val': 0.996721335281205, 'auprc': 0.9942099581930413, 'loss_val': 0.0476972532279374, 'psi': 0.9957167844459395}-{'f1_val': 0.9964678035083712, 'auprc': 0.9951757942881544, 'loss_val': 0.059892660684024504, 'psi': 0.9959509998202845}
[S10] START round=31 head_norm_before_train=1.996664 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9957336712287358, 'loss_val': 0.033556700033487624, 'psi': 0.9946160961218213}-{'f1_val': 0.9940903254969471, 'auprc': 0.9961069238588083, 'loss_val': 0.03369526233391523, 'psi': 0.9948969648416915}
[S11] START round=31 head_norm_before_train=1.394414 cos_to_last_merge=0.9859 (last merge round=26)
[S11] round=31 local utility u=0.054810 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.997736185442073, 'loss_val': 0.09383216062087732, 'psi': 0.9967746791248148}-{'f1_val': 0.9863564000658616, 'auprc': 0.9978402505306987, 'loss_val': 0.1451016735379399, 'psi': 0.9909499402517964}
[S13] START round=31 head_norm_before_train=1.710627 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5527978546996545, 'auprc': 0.7028351875874118, 'loss_val': 1.046643728884936, 'psi': 0.6128127878547573}-{'f1_val': 0.5373398625003116, 'auprc': 0.6983193972675721, 'loss_val': 0.8705599196830326, 'psi': 0.6017316764072158}
[S14] START round=31 head_norm_before_train=1.297777 cos_to_last_merge=0.9794 (last merge round=26)
[S14] round=31 local utility u=0.070255 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9986421056885668, 'loss_val': 0.07940775657997463, 'psi': 0.9979018039764621}-{'f1_val': 0.9806544189294047, 'auprc': 0.9970849693967998, 'loss_val': 0.1147238845129696, 'psi': 0.9872266391163628}
[S15] START round=31 head_norm_before_train=1.374646 cos_to_last_merge=0.9955 (last merge round=28)
[S15] round=31 local utility u=0.010515 metrics={'f1_val': 0.9358133107767638, 'auprc': 0.9970659163342714, 'loss_val': 0.1500061769110489, 'psi': 0.9603143529997669}-{'f1_val': 0.9356738638643878, 'auprc': 0.9968440985900853, 'loss_val': 0.16953371023118383, 'psi': 0.9601419577546668}
[S16] START round=31 head_norm_before_train=1.273142 cos_to_last_merge=0.9997 (last merge round=29)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9404436694315146, 'auprc': 0.9907045923489284, 'loss_val': 0.21581251685765873, 'psi': 0.9605480385984801}-{'f1_val': 0.9479735694369813, 'auprc': 0.9915430419116789, 'loss_val': 0.1721541827854777, 'psi': 0.9654013584268603}
[S17] START round=31 head_norm_before_train=1.323923 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.132676 metrics={'f1_val': 0.649940789658368, 'auprc': 0.827502928580447, 'loss_val': 0.7506624910859919, 'psi': 0.7209656452271996}-{'f1_val': 0.6315314450116029, 'auprc': 0.8146699989657284, 'loss_val': 0.8670601808606332, 'psi': 0.7047868665932531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:38507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:38508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:38515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:38517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38505
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:38516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:38504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:38509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.6218
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.6218
[S16] RECEIVED delta(kind=head bytes=1803) from S6
[S16] cosine check vs S6: cos=0.9883
[S4] RECEIVED delta(kind=head bytes=1802) from S11
[S4] cosine check vs S11: cos=0.9815
[S6] RECEIVED delta(kind=head bytes=1802) from S4
[S6] cosine check vs S4: cos=0.9812
[S7] RECEIVED delta(kind=head bytes=1805) from S14
[S7] cosine check vs S14: cos=0.9135
[S17] RECEIVED delta(kind=head bytes=1804) from S9
[S17] cosine check vs S9: cos=0.9853
[S8] RECEIVED delta(kind=head bytes=1796) from S7
[S8] cosine check vs S7: cos=-0.0325
[S8] DROPPED delta from S7 (cos=-0.0325 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:38510
[S17] sending update (kind=head size=1806 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1806) from S17
[S9] cosine check vs S17: cos=0.9853
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.6477 head_norm=1.314364
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.761279e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.6582 head_norm=1.297276 delta_norm=0.276128
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.9967 head_norm=1.347476
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.172813e-01
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.9971 head_norm=1.355897 delta_norm=0.117281
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.8379 head_norm=1.306685
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.319338e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.8483 head_norm=1.327217 delta_norm=0.131934
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.6660 head_norm=1.349806
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.087052e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.6783 head_norm=1.257640 delta_norm=0.608705
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=31 metric=0.9411 head_norm=1.360293
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.383335e-01
[S4] stored merged vector for next round verification (round=31)
[S4] DEBUG after merge:  round=31 metric=0.9413 head_norm=1.388158 delta_norm=0.138333
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.9358 head_norm=1.443047
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.087052e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.8812 head_norm=1.257640 delta_norm=0.608705
[S15] aggregate: ROLLBACK (f1_val pre=0.936 post=0.881 tol_abs=0.005 tol_rel=0.0)
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S16
[S5]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.9404 head_norm=1.302953
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.971957e-02
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.9404 head_norm=1.301004 delta_norm=0.099720
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.6499 head_norm=1.374311
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.172813e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.6515 head_norm=1.355897 delta_norm=0.117281
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.666734 cos_to_last_merge=0.8327 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.833
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.7157212765046949, 'auprc': 0.7958521050386812, 'loss_val': 0.49204021717521784, 'psi': 0.7477736079182895}-{'f1_val': 0.7083101783210911, 'auprc': 0.9740534702225273, 'loss_val': 0.3134223315827588, 'psi': 0.8146074950816655}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=2.025532 cos_to_last_merge=0.7860 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.786
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.8762925917060056, 'auprc': 0.9885611368643414, 'loss_val': 0.4224690100663659, 'psi': 0.9212000097693399}-{'f1_val': 0.9443008741126334, 'auprc': 0.995389472949685, 'loss_val': 0.1748849243656992, 'psi': 0.964736313647454}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.388158 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=32 local utility u=0.049026 metrics={'f1_val': 0.9465577180313366, 'auprc': 0.9615925011095743, 'loss_val': 0.2657044030012348, 'psi': 0.9525716312626317}-{'f1_val': 0.9410508037389258, 'auprc': 0.9402021500007521, 'loss_val': 0.26654420348101493, 'psi': 0.9407113422436564}
[S5] START round=32 head_norm_before_train=1.257640 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8554051510864972, 'loss_val': 0.7805834437164418, 'psi': 0.6042217987378221}-{'f1_val': 0.6660067596633608, 'auprc': 0.8389237874765073, 'loss_val': 0.4502314498000263, 'psi': 0.7351735707886193}
[S6] START round=32 head_norm_before_train=1.327217 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.7328337665968235, 'auprc': 0.7972039697796612, 'loss_val': 0.4897326623587787, 'psi': 0.7585818478699586}-{'f1_val': 0.8378912198289092, 'auprc': 0.9587714040005509, 'loss_val': 0.29677340217736253, 'psi': 0.8862432934975659}
[S7] START round=32 head_norm_before_train=1.297276 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.597970823435096, 'auprc': 0.7908970431713152, 'loss_val': 0.6912059811078126, 'psi': 0.6751413113295837}-{'f1_val': 0.6476732434569079, 'auprc': 0.8049493366736559, 'loss_val': 0.5341819031189753, 'psi': 0.7105836807436071}
[S8] START round=32 head_norm_before_train=1.930078 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9943332319846547, 'auprc': 0.9979559269643066, 'loss_val': 0.053872196160694115, 'psi': 0.9957823099765155}-{'f1_val': 0.9943590272655265, 'auprc': 0.9942168943487393, 'loss_val': 0.04120113743831805, 'psi': 0.9943021740988116}
[S9] START round=32 head_norm_before_train=1.355897 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.006145 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9975387437964968, 'loss_val': 0.04537483830696381, 'psi': 0.9970463763598572}-{'f1_val': 0.996721335281205, 'auprc': 0.9942099581930413, 'loss_val': 0.0476972532279374, 'psi': 0.9957167844459395}
[S10] START round=32 head_norm_before_train=2.008712 (no previous merge yet)
[S10] round=32 local utility u=0.000822 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9955679121302775, 'loss_val': 0.03273114628298514, 'psi': 0.9946813601502793}-{'f1_val': 0.993871046050545, 'auprc': 0.9957336712287358, 'loss_val': 0.033556700033487624, 'psi': 0.9946160961218213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=32 head_norm_before_train=1.428930 cos_to_last_merge=0.9817 (last merge round=26)
[S11] round=32 local utility u=0.013077 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9975601208495786, 'loss_val': 0.06715031372438506, 'psi': 0.996704253287817}-{'f1_val': 0.9961336749133093, 'auprc': 0.997736185442073, 'loss_val': 0.09383216062087732, 'psi': 0.9967746791248148}
[S13] START round=32 head_norm_before_train=1.718382 (no previous merge yet)
[S13] round=32 local utility u=0.224698 metrics={'f1_val': 0.5981199043033534, 'auprc': 0.6598344659426683, 'loss_val': 0.740178413915375, 'psi': 0.6228057289590794}-{'f1_val': 0.5527978546996545, 'auprc': 0.7028351875874118, 'loss_val': 1.046643728884936, 'psi': 0.6128127878547573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S13] sending update (kind=head size=1811 to 1 peers)
[S14] START round=32 head_norm_before_train=1.338204 cos_to_last_merge=0.9732 (last merge round=26)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9330055469485266, 'auprc': 0.998249633967482, 'loss_val': 0.1331001230204714, 'psi': 0.9591031817561088}-{'f1_val': 0.9974082695017256, 'auprc': 0.9986421056885668, 'loss_val': 0.07940775657997463, 'psi': 0.9979018039764621}
[S15] START round=32 head_norm_before_train=1.257640 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.064117 metrics={'f1_val': 0.9707189725668711, 'auprc': 0.994785828795818, 'loss_val': 0.22436498129222135, 'psi': 0.9803457150584499}-{'f1_val': 0.9358133107767638, 'auprc': 0.9970659163342714, 'loss_val': 0.1500061769110489, 'psi': 0.9603143529997669}
[S16] START round=32 head_norm_before_train=1.301004 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.219697 metrics={'f1_val': 0.9910754194310013, 'auprc': 0.9940471062026073, 'loss_val': 0.09023681415051067, 'psi': 0.9922640941396437}-{'f1_val': 0.9404436694315146, 'auprc': 0.9907045923489284, 'loss_val': 0.21581251685765873, 'psi': 0.9605480385984801}
[S17] START round=32 head_norm_before_train=1.355897 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.632962996776367, 'auprc': 0.8181448280471517, 'loss_val': 0.9178837868493944, 'psi': 0.707035729284681}-{'f1_val': 0.649940789658368, 'auprc': 0.827502928580447, 'loss_val': 0.7506624910859919, 'psi': 0.7209656452271996}
[S11] not sending this round → trigger blocked (psi=0.997)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.980)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.953)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:38507
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=0.9870
[S5] RoundReady barrier timeout: have=2 need=4 — continuing
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7]  timeout peer S8
[S11]  timeout peer S4
[S9]  timeout peer S11
[S9]  timeout peer S13
[S14]  timeout peer S7
[S14]  timeout peer S9
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S10
[S5]  timeout peer S14
[S5]  timeout peer S15
[S4]  timeout peer S6
[S16]  timeout peer S5
[S2] START round=33 head_norm_before_train=1.675385 cos_to_last_merge=0.8314 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.831
[S2] round=33 local utility u=0.287937 metrics={'f1_val': 0.7095200956219546, 'auprc': 0.9380835783153856, 'loss_val': 0.3056544721628168, 'psi': 0.800945488699327}-{'f1_val': 0.7157212765046949, 'auprc': 0.7958521050386812, 'loss_val': 0.49204021717521784, 'psi': 0.7477736079182895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=33 head_norm_before_train=2.036099 cos_to_last_merge=0.7849 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.785
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.7537117053716268, 'auprc': 0.9693324908512325, 'loss_val': 0.837723601811491, 'psi': 0.8399600195634691}-{'f1_val': 0.8762925917060056, 'auprc': 0.9885611368643414, 'loss_val': 0.4224690100663659, 'psi': 0.9212000097693399}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.405056 cos_to_last_merge=0.9999 (last merge round=31)
[S4] round=33 local utility u=0.020300 metrics={'f1_val': 0.9482639532685908, 'auprc': 0.9702349018664567, 'loss_val': 0.2612685773363796, 'psi': 0.9570523327077372}-{'f1_val': 0.9465577180313366, 'auprc': 0.9615925011095743, 'loss_val': 0.2657044030012348, 'psi': 0.9525716312626317}
[S5] START round=33 head_norm_before_train=1.271571 cos_to_last_merge=0.9999 (last merge round=31)
[S5] round=33 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9892844931497664, 'loss_val': 0.2691501989858717, 'psi': 0.8159065877202548}-{'f1_val': 0.43676623050537206, 'auprc': 0.8554051510864972, 'loss_val': 0.7805834437164418, 'psi': 0.6042217987378221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S5] sending update (kind=head size=1809 to 1 peers)
[S6] START round=33 head_norm_before_train=1.342682 cos_to_last_merge=0.9998 (last merge round=31)
[S6] round=33 local utility u=0.530008 metrics={'f1_val': 0.8045333867912857, 'auprc': 0.960831061928498, 'loss_val': 0.3507965286163022, 'psi': 0.8670524568461706}-{'f1_val': 0.7328337665968235, 'auprc': 0.7972039697796612, 'loss_val': 0.4897326623587787, 'psi': 0.7585818478699586}
[S7] START round=33 head_norm_before_train=1.336365 cos_to_last_merge=0.9988 (last merge round=31)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.5709358535868196, 'auprc': 0.7828296292157343, 'loss_val': 0.7640932437135081, 'psi': 0.6556933638383855}-{'f1_val': 0.597970823435096, 'auprc': 0.7908970431713152, 'loss_val': 0.6912059811078126, 'psi': 0.6751413113295837}
[S8] START round=33 head_norm_before_train=1.937762 (no previous merge yet)
[S8] round=33 local utility u=0.007802 metrics={'f1_val': 0.9945058427751525, 'auprc': 0.997692970207118, 'loss_val': 0.03851530587822308, 'psi': 0.9957806937479386}-{'f1_val': 0.9943332319846547, 'auprc': 0.9979559269643066, 'loss_val': 0.053872196160694115, 'psi': 0.9957823099765155}
[S9] START round=33 head_norm_before_train=1.385798 cos_to_last_merge=0.9998 (last merge round=31)
[S9] round=33 local utility u=0.000202 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9951082543997333, 'loss_val': 0.040161315070256824, 'psi': 0.9963223555441587}-{'f1_val': 0.9967181314020974, 'auprc': 0.9975387437964968, 'loss_val': 0.04537483830696381, 'psi': 0.9970463763598572}
[S10] START round=33 head_norm_before_train=2.018293 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9960695600993676, 'loss_val': 0.03303384040210856, 'psi': 0.994750451670074}-{'f1_val': 0.9940903254969471, 'auprc': 0.9955679121302775, 'loss_val': 0.03273114628298514, 'psi': 0.9946813601502793}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.459087 cos_to_last_merge=0.9780 (last merge round=26)
[S11] round=33 local utility u=0.004387 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9970472865376873, 'loss_val': 0.056838801658363226, 'psi': 0.9964991195630605}-{'f1_val': 0.9961336749133093, 'auprc': 0.9975601208495786, 'loss_val': 0.06715031372438506, 'psi': 0.996704253287817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=33 head_norm_before_train=1.725764 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5848199744148702, 'auprc': 0.6818839856059205, 'loss_val': 0.808944417332101, 'psi': 0.6236455788912902}-{'f1_val': 0.5981199043033534, 'auprc': 0.6598344659426683, 'loss_val': 0.740178413915375, 'psi': 0.6228057289590794}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.373644 cos_to_last_merge=0.9677 (last merge round=26)
[S14] round=33 local utility u=0.205115 metrics={'f1_val': 0.9909552337568698, 'auprc': 0.9981906871875843, 'loss_val': 0.0703920403265067, 'psi': 0.9938494151291557}-{'f1_val': 0.9330055469485266, 'auprc': 0.998249633967482, 'loss_val': 0.1331001230204714, 'psi': 0.9591031817561088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=33 head_norm_before_train=1.326178 cos_to_last_merge=0.9967 (last merge round=31)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.6988138008547277, 'auprc': 0.9144258927099898, 'loss_val': 0.4222456459759886, 'psi': 0.7850586375968325}-{'f1_val': 0.9707189725668711, 'auprc': 0.994785828795818, 'loss_val': 0.22436498129222135, 'psi': 0.9803457150584499}
[S16] START round=33 head_norm_before_train=1.327220 cos_to_last_merge=0.9998 (last merge round=31)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9410423397709485, 'auprc': 0.9906914827067113, 'loss_val': 0.20263656518649828, 'psi': 0.9609019969452537}-{'f1_val': 0.9910754194310013, 'auprc': 0.9940471062026073, 'loss_val': 0.09023681415051067, 'psi': 0.9922640941396437}
[S17] START round=33 head_norm_before_train=1.405742 cos_to_last_merge=0.9992 (last merge round=31)
[S17] round=33 local utility u=0.122603 metrics={'f1_val': 0.6548054428382066, 'auprc': 0.8317740990263579, 'loss_val': 0.8446201864042342, 'psi': 0.7255929053134671}-{'f1_val': 0.632962996776367, 'auprc': 0.8181448280471517, 'loss_val': 0.9178837868493944, 'psi': 0.707035729284681}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.8045 head_norm=1.360846
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.128471e-01
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.8060 head_norm=1.339393 delta_norm=0.112847
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.686400 cos_to_last_merge=0.8296 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.830
[S2] round=34 local utility u=0.378674 metrics={'f1_val': 0.8268581934580957, 'auprc': 0.9449818517475802, 'loss_val': 0.2730298321296345, 'psi': 0.8741076567738895}-{'f1_val': 0.7095200956219546, 'auprc': 0.9380835783153856, 'loss_val': 0.3056544721628168, 'psi': 0.800945488699327}
[S2] not sending this round → trigger blocked (psi=0.874)
[S3] START round=34 head_norm_before_train=2.045583 cos_to_last_merge=0.7841 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.784
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.7439729038092029, 'auprc': 0.9709244038221191, 'loss_val': 0.8498998757788165, 'psi': 0.8347535038143694}-{'f1_val': 0.7537117053716268, 'auprc': 0.9693324908512325, 'loss_val': 0.837723601811491, 'psi': 0.8399600195634691}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.422870 cos_to_last_merge=0.9997 (last merge round=31)
[S4] round=34 local utility u=0.010653 metrics={'f1_val': 0.9498635036575471, 'auprc': 0.9718510308318618, 'loss_val': 0.2544091936478068, 'psi': 0.9586585145272729}-{'f1_val': 0.9482639532685908, 'auprc': 0.9702349018664567, 'loss_val': 0.2612685773363796, 'psi': 0.9570523327077372}
[S5] START round=34 head_norm_before_train=1.293867 cos_to_last_merge=0.9993 (last merge round=31)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.454633391385575, 'auprc': 0.8551443704710706, 'loss_val': 0.7496687289870887, 'psi': 0.6148377830197733}-{'f1_val': 0.7003213174339138, 'auprc': 0.9892844931497664, 'loss_val': 0.2691501989858717, 'psi': 0.8159065877202548}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.339393 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.5644191554611672, 'auprc': 0.7846569967066118, 'loss_val': 0.623998686796916, 'psi': 0.6525142919593451}-{'f1_val': 0.8045333867912857, 'auprc': 0.960831061928498, 'loss_val': 0.3507965286163022, 'psi': 0.8670524568461706}
[S7] START round=34 head_norm_before_train=1.384401 cos_to_last_merge=0.9954 (last merge round=31)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5025482730206253, 'auprc': 0.7784134820511173, 'loss_val': 0.9651465079767033, 'psi': 0.6128943566328222}-{'f1_val': 0.5709358535868196, 'auprc': 0.7828296292157343, 'loss_val': 0.7640932437135081, 'psi': 0.6556933638383855}
[S8] START round=34 head_norm_before_train=1.944576 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9934116751513793, 'auprc': 0.9982997226277521, 'loss_val': 0.04150186321642655, 'psi': 0.9953668941419285}-{'f1_val': 0.9945058427751525, 'auprc': 0.997692970207118, 'loss_val': 0.03851530587822308, 'psi': 0.9957806937479386}
[S9] START round=34 head_norm_before_train=1.411524 cos_to_last_merge=0.9993 (last merge round=31)
[S9] round=34 local utility u=0.003372 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9971993390119283, 'loss_val': 0.03720942751514097, 'psi': 0.9969106144460297}-{'f1_val': 0.9971317563071089, 'auprc': 0.9951082543997333, 'loss_val': 0.040161315070256824, 'psi': 0.9963223555441587}
[S10] START round=34 head_norm_before_train=2.026832 (no previous merge yet)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9956069855839103, 'loss_val': 0.032455667280840886, 'psi': 0.9945654218638911}-{'f1_val': 0.993871046050545, 'auprc': 0.9960695600993676, 'loss_val': 0.03303384040210856, 'psi': 0.994750451670074}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.485565 cos_to_last_merge=0.9747 (last merge round=26)
[S11] round=34 local utility u=0.003351 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9975408713855777, 'loss_val': 0.05161685864241018, 'psi': 0.9966965535022166}-{'f1_val': 0.9961336749133093, 'auprc': 0.9970472865376873, 'loss_val': 0.056838801658363226, 'psi': 0.9964991195630605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=34 head_norm_before_train=1.732505 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5754416931701485, 'auprc': 0.6838626734335923, 'loss_val': 0.7926487325101518, 'psi': 0.6188100852755261}-{'f1_val': 0.5848199744148702, 'auprc': 0.6818839856059205, 'loss_val': 0.808944417332101, 'psi': 0.6236455788912902}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.404305 cos_to_last_merge=0.9631 (last merge round=26)
[S14] round=34 local utility u=0.022191 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9967322779283242, 'loss_val': 0.05542679361120836, 'psi': 0.9966452501377798}-{'f1_val': 0.9909552337568698, 'auprc': 0.9981906871875843, 'loss_val': 0.0703920403265067, 'psi': 0.9938494151291557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=34 head_norm_before_train=1.406090 cos_to_last_merge=0.9879 (last merge round=31)
[S15] round=34 local utility u=0.793443 metrics={'f1_val': 0.881899515148729, 'auprc': 0.9964076567005343, 'loss_val': 0.17981951407342622, 'psi': 0.927702771769451}-{'f1_val': 0.6988138008547277, 'auprc': 0.9144258927099898, 'loss_val': 0.4222456459759886, 'psi': 0.7850586375968325}
[S16] START round=34 head_norm_before_train=1.350508 cos_to_last_merge=0.9994 (last merge round=31)
[S16] round=34 local utility u=0.221200 metrics={'f1_val': 0.991028065129781, 'auprc': 0.993999124996148, 'loss_val': 0.07007376497423896, 'psi': 0.9922164890763278}-{'f1_val': 0.9410423397709485, 'auprc': 0.9906914827067113, 'loss_val': 0.20263656518649828, 'psi': 0.9609019969452537}
[S17] START round=34 head_norm_before_train=1.456363 cos_to_last_merge=0.9972 (last merge round=31)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6390493163526326, 'auprc': 0.8220686245618161, 'loss_val': 0.9932830323943607, 'psi': 0.7122570396363059}-{'f1_val': 0.6548054428382066, 'auprc': 0.8317740990263579, 'loss_val': 0.8446201864042342, 'psi': 0.7255929053134671}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.702225 cos_to_last_merge=0.8273 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.827
[S2] round=35 local utility u=0.115596 metrics={'f1_val': 0.8752043245341556, 'auprc': 0.9120806552506318, 'loss_val': 0.23321123399453367, 'psi': 0.889954856820746}-{'f1_val': 0.8268581934580957, 'auprc': 0.9449818517475802, 'loss_val': 0.2730298321296345, 'psi': 0.8741076567738895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=35 head_norm_before_train=2.058379 cos_to_last_merge=0.7830 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.783
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.6980165431256723, 'auprc': 0.9682282496362824, 'loss_val': 1.0559714988313587, 'psi': 0.8061012257299164}-{'f1_val': 0.7439729038092029, 'auprc': 0.9709244038221191, 'loss_val': 0.8498998757788165, 'psi': 0.8347535038143694}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.440583 cos_to_last_merge=0.9992 (last merge round=31)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9500317876366464, 'auprc': 0.9664441129937186, 'loss_val': 0.25367845897394015, 'psi': 0.9565967177794752}-{'f1_val': 0.9498635036575471, 'auprc': 0.9718510308318618, 'loss_val': 0.2544091936478068, 'psi': 0.9586585145272729}
[S5] START round=35 head_norm_before_train=1.313834 cos_to_last_merge=0.9984 (last merge round=31)
[S5] round=35 local utility u=0.222364 metrics={'f1_val': 0.5306073793870152, 'auprc': 0.8500085239963806, 'loss_val': 0.7453770198976902, 'psi': 0.6583678372307613}-{'f1_val': 0.454633391385575, 'auprc': 0.8551443704710706, 'loss_val': 0.7496687289870887, 'psi': 0.6148377830197733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=35 head_norm_before_train=1.355079 cos_to_last_merge=0.9997 (last merge round=33)
[S6] round=35 local utility u=0.544187 metrics={'f1_val': 0.6685702039586316, 'auprc': 0.9054907457041592, 'loss_val': 0.5230323586530032, 'psi': 0.7633384206568428}-{'f1_val': 0.5644191554611672, 'auprc': 0.7846569967066118, 'loss_val': 0.623998686796916, 'psi': 0.6525142919593451}
[S7] START round=35 head_norm_before_train=1.430487 cos_to_last_merge=0.9912 (last merge round=31)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.4909864096143346, 'auprc': 0.7790809242630221, 'loss_val': 1.0084256684181507, 'psi': 0.6062242154738096}-{'f1_val': 0.5025482730206253, 'auprc': 0.7784134820511173, 'loss_val': 0.9651465079767033, 'psi': 0.6128943566328222}
[S8] START round=35 head_norm_before_train=1.954375 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9932268840868632, 'auprc': 0.9984105578763385, 'loss_val': 0.05457198286719229, 'psi': 0.9953003536026533}-{'f1_val': 0.9934116751513793, 'auprc': 0.9982997226277521, 'loss_val': 0.04150186321642655, 'psi': 0.9953668941419285}
[S9] START round=35 head_norm_before_train=1.433492 cos_to_last_merge=0.9988 (last merge round=31)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.996721335281205, 'auprc': 0.9933500894376265, 'loss_val': 0.03441146100795679, 'psi': 0.9953728369437735}-{'f1_val': 0.9967181314020974, 'auprc': 0.9971993390119283, 'loss_val': 0.03720942751514097, 'psi': 0.9969106144460297}
[S10] START round=35 head_norm_before_train=2.036746 (no previous merge yet)
[S10] round=35 local utility u=0.000158 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9955750572512518, 'loss_val': 0.03204398914629088, 'psi': 0.9945526505308278}-{'f1_val': 0.993871046050545, 'auprc': 0.9956069855839103, 'loss_val': 0.032455667280840886, 'psi': 0.9945654218638911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=35 head_norm_before_train=1.509708 cos_to_last_merge=0.9717 (last merge round=26)
[S11] round=35 local utility u=0.002192 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9976847606258991, 'loss_val': 0.04766398442790565, 'psi': 0.9967541091983452}-{'f1_val': 0.9961336749133093, 'auprc': 0.9975408713855777, 'loss_val': 0.05161685864241018, 'psi': 0.9966965535022166}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=35 head_norm_before_train=1.739902 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5984958910836741, 'auprc': 0.6323448476800017, 'loss_val': 0.8158323826650022, 'psi': 0.6120354737222051}-{'f1_val': 0.5754416931701485, 'auprc': 0.6838626734335923, 'loss_val': 0.7926487325101518, 'psi': 0.6188100852755261}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.430532 cos_to_last_merge=0.9593 (last merge round=26)
[S14] round=35 local utility u=0.004344 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.997044571636836, 'loss_val': 0.05027412932643768, 'psi': 0.9970300023284597}-{'f1_val': 0.9965872316107504, 'auprc': 0.9967322779283242, 'loss_val': 0.05542679361120836, 'psi': 0.9966452501377798}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=35 head_norm_before_train=1.475279 cos_to_last_merge=0.9784 (last merge round=31)
[S15] round=35 local utility u=0.391047 metrics={'f1_val': 0.9928039097217635, 'auprc': 0.9982057339502458, 'loss_val': 0.06854683765743085, 'psi': 0.9949646394131564}-{'f1_val': 0.881899515148729, 'auprc': 0.9964076567005343, 'loss_val': 0.17981951407342622, 'psi': 0.927702771769451}
[S16] START round=35 head_norm_before_train=1.371911 cos_to_last_merge=0.9989 (last merge round=31)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9402041963475007, 'auprc': 0.991744368459871, 'loss_val': 0.22675652097934965, 'psi': 0.9608202651924489}-{'f1_val': 0.991028065129781, 'auprc': 0.993999124996148, 'loss_val': 0.07007376497423896, 'psi': 0.9922164890763278}
[S17] START round=35 head_norm_before_train=1.499717 cos_to_last_merge=0.9948 (last merge round=31)
[S17] round=35 local utility u=0.095603 metrics={'f1_val': 0.6486096293959589, 'auprc': 0.8397656227378848, 'loss_val': 0.9125294296463212, 'psi': 0.7250720267327293}-{'f1_val': 0.6390493163526326, 'auprc': 0.8220686245618161, 'loss_val': 0.9932830323943607, 'psi': 0.7122570396363059}
[S15] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] START round=36 head_norm_before_train=1.717476 cos_to_last_merge=0.8254 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.825
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.8265721070943877, 'auprc': 0.9608855949550434, 'loss_val': 0.2899154257311867, 'psi': 0.88029750223865}-{'f1_val': 0.8752043245341556, 'auprc': 0.9120806552506318, 'loss_val': 0.23321123399453367, 'psi': 0.889954856820746}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=2.070528 cos_to_last_merge=0.7821 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.782
[S3] round=36 local utility u=1.000000 metrics={'f1_val': 0.9613238019923649, 'auprc': 0.9987340054958598, 'loss_val': 0.09338586228350877, 'psi': 0.9762878833937628}-{'f1_val': 0.6980165431256723, 'auprc': 0.9682282496362824, 'loss_val': 1.0559714988313587, 'psi': 0.8061012257299164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=36 head_norm_before_train=1.457740 cos_to_last_merge=0.9986 (last merge round=31)
[S4] round=36 local utility u=0.025451 metrics={'f1_val': 0.9522886457815457, 'auprc': 0.976084803491405, 'loss_val': 0.24523890784828256, 'psi': 0.9618071088654894}-{'f1_val': 0.9500317876366464, 'auprc': 0.9664441129937186, 'loss_val': 0.25367845897394015, 'psi': 0.9565967177794752}
[S5] START round=36 head_norm_before_train=1.332033 cos_to_last_merge=0.9973 (last merge round=31)
[S5] round=36 local utility u=0.121713 metrics={'f1_val': 0.5606174639802742, 'auprc': 0.8542121863991838, 'loss_val': 0.6946227967201729, 'psi': 0.6780553529478381}-{'f1_val': 0.5306073793870152, 'auprc': 0.8500085239963806, 'loss_val': 0.7453770198976902, 'psi': 0.6583678372307613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=36 head_norm_before_train=1.368219 cos_to_last_merge=0.9993 (last merge round=33)
[S6] round=36 local utility u=0.369529 metrics={'f1_val': 0.8077644168101119, 'auprc': 0.841915530005324, 'loss_val': 0.42841362066903593, 'psi': 0.8214248620881968}-{'f1_val': 0.6685702039586316, 'auprc': 0.9054907457041592, 'loss_val': 0.5230323586530032, 'psi': 0.7633384206568428}
[S7] START round=36 head_norm_before_train=1.464383 cos_to_last_merge=0.9878 (last merge round=31)
[S7] round=36 local utility u=0.511794 metrics={'f1_val': 0.5999712057425611, 'auprc': 0.7940371960442669, 'loss_val': 0.6836160387779577, 'psi': 0.6775976018632435}-{'f1_val': 0.4909864096143346, 'auprc': 0.7790809242630221, 'loss_val': 1.0084256684181507, 'psi': 0.6062242154738096}
[S8] START round=36 head_norm_before_train=1.965697 (no previous merge yet)
[S8] round=36 local utility u=0.011551 metrics={'f1_val': 0.9937709050739206, 'auprc': 0.9989586852407212, 'loss_val': 0.036377590123551774, 'psi': 0.9958460171406408}-{'f1_val': 0.9932268840868632, 'auprc': 0.9984105578763385, 'loss_val': 0.05457198286719229, 'psi': 0.9953003536026533}
[S9] START round=36 head_norm_before_train=1.452491 cos_to_last_merge=0.9983 (last merge round=31)
[S9] round=36 local utility u=0.007873 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9981992339665713, 'loss_val': 0.03319408922894513, 'psi': 0.9973105724278869}-{'f1_val': 0.996721335281205, 'auprc': 0.9933500894376265, 'loss_val': 0.03441146100795679, 'psi': 0.9953728369437735}
[S10] START round=36 head_norm_before_train=2.046959 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9956543909651202, 'loss_val': 0.032668496719538614, 'psi': 0.9944528606042478}-{'f1_val': 0.993871046050545, 'auprc': 0.9955750572512518, 'loss_val': 0.03204398914629088, 'psi': 0.9945526505308278}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.531479 cos_to_last_merge=0.9690 (last merge round=26)
[S11] round=36 local utility u=0.001595 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978686692030401, 'loss_val': 0.04502557979034258, 'psi': 0.9968276726292016}-{'f1_val': 0.9961336749133093, 'auprc': 0.9976847606258991, 'loss_val': 0.04766398442790565, 'psi': 0.9967541091983452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=36 head_norm_before_train=1.748270 (no previous merge yet)
[S13] round=36 local utility u=0.133256 metrics={'f1_val': 0.6092863845762152, 'auprc': 0.7128397369640219, 'loss_val': 0.8555477869825365, 'psi': 0.6507077255313379}-{'f1_val': 0.5984958910836741, 'auprc': 0.6323448476800017, 'loss_val': 0.8158323826650022, 'psi': 0.6120354737222051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=36 head_norm_before_train=1.448974 cos_to_last_merge=0.9567 (last merge round=26)
[S14] round=36 local utility u=0.005459 metrics={'f1_val': 0.9971461297597816, 'auprc': 0.9988245930151444, 'loss_val': 0.045450901351449406, 'psi': 0.9978175150619266}-{'f1_val': 0.9970202894562089, 'auprc': 0.997044571636836, 'loss_val': 0.05027412932643768, 'psi': 0.9970300023284597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=36 head_norm_before_train=1.534926 cos_to_last_merge=0.9699 (last merge round=31)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.9814885069367558, 'auprc': 0.9982062824272915, 'loss_val': 0.08122855807920647, 'psi': 0.9881756171329701}-{'f1_val': 0.9928039097217635, 'auprc': 0.9982057339502458, 'loss_val': 0.06854683765743085, 'psi': 0.9949646394131564}
[S16] START round=36 head_norm_before_train=1.392112 cos_to_last_merge=0.9982 (last merge round=31)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.8580213976381572, 'auprc': 0.9872868105824988, 'loss_val': 0.7330314054646483, 'psi': 0.9097275628158938}-{'f1_val': 0.9402041963475007, 'auprc': 0.991744368459871, 'loss_val': 0.22675652097934965, 'psi': 0.9608202651924489}
[S17] START round=36 head_norm_before_train=1.536952 cos_to_last_merge=0.9924 (last merge round=31)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6388303150387384, 'auprc': 0.8132300094458664, 'loss_val': 1.0608689006068852, 'psi': 0.7085901928015896}-{'f1_val': 0.6486096293959589, 'auprc': 0.8397656227378848, 'loss_val': 0.9125294296463212, 'psi': 0.7250720267327293}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.821)
[S2] START round=37 head_norm_before_train=1.730272 cos_to_last_merge=0.8235 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.824
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.7967470757620426, 'auprc': 0.9882766941394096, 'loss_val': 0.33773236564438786, 'psi': 0.8733589231129895}-{'f1_val': 0.8265721070943877, 'auprc': 0.9608855949550434, 'loss_val': 0.2899154257311867, 'psi': 0.88029750223865}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=2.081679 cos_to_last_merge=0.7812 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.781
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9606067420772127, 'auprc': 0.9978207458082368, 'loss_val': 0.13141980156066635, 'psi': 0.9754923435696223}-{'f1_val': 0.9613238019923649, 'auprc': 0.9987340054958598, 'loss_val': 0.09338586228350877, 'psi': 0.9762878833937628}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.474343 cos_to_last_merge=0.9980 (last merge round=31)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9443284004635673, 'auprc': 0.949706927835003, 'loss_val': 0.26662941622388026, 'psi': 0.9464798114121415}-{'f1_val': 0.9522886457815457, 'auprc': 0.976084803491405, 'loss_val': 0.24523890784828256, 'psi': 0.9618071088654894}
[S5] START round=37 head_norm_before_train=1.346508 cos_to_last_merge=0.9965 (last merge round=31)
[S5] round=37 local utility u=0.166379 metrics={'f1_val': 0.6371174752302596, 'auprc': 0.7482287006821495, 'loss_val': 0.502914579345596, 'psi': 0.6815619654110157}-{'f1_val': 0.5606174639802742, 'auprc': 0.8542121863991838, 'loss_val': 0.6946227967201729, 'psi': 0.6780553529478381}
[S5] not sending this round → trigger blocked (psi=0.682)
[S6] START round=37 head_norm_before_train=1.384019 cos_to_last_merge=0.9986 (last merge round=33)
[S6] round=37 local utility u=0.227517 metrics={'f1_val': 0.821944662409571, 'auprc': 0.953005403922293, 'loss_val': 0.3917299447287569, 'psi': 0.8743689590146597}-{'f1_val': 0.8077644168101119, 'auprc': 0.841915530005324, 'loss_val': 0.42841362066903593, 'psi': 0.8214248620881968}
[S7] START round=37 head_norm_before_train=1.482881 cos_to_last_merge=0.9858 (last merge round=31)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5927819376621257, 'auprc': 0.7918967549832955, 'loss_val': 0.7530534638631611, 'psi': 0.6724278645905937}-{'f1_val': 0.5999712057425611, 'auprc': 0.7940371960442669, 'loss_val': 0.6836160387779577, 'psi': 0.6775976018632435}
[S8] START round=37 head_norm_before_train=1.975108 (no previous merge yet)
[S8] round=37 local utility u=0.000988 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9989558360890695, 'loss_val': 0.03571957904397686, 'psi': 0.9959774761887359}-{'f1_val': 0.9937709050739206, 'auprc': 0.9989586852407212, 'loss_val': 0.036377590123551774, 'psi': 0.9958460171406408}
[S9] START round=37 head_norm_before_train=1.470077 cos_to_last_merge=0.9978 (last merge round=31)
[S9] round=37 local utility u=0.001467 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9984739561605751, 'loss_val': 0.03108388043658491, 'psi': 0.9974204613054884}-{'f1_val': 0.9967181314020974, 'auprc': 0.9981992339665713, 'loss_val': 0.03319408922894513, 'psi': 0.9973105724278869}
[S10] START round=37 head_norm_before_train=2.057032 (no previous merge yet)
[S10] round=37 local utility u=0.001102 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9954477593141531, 'loss_val': 0.03115952111217005, 'psi': 0.9945017313559882}-{'f1_val': 0.9936518403636662, 'auprc': 0.9956543909651202, 'loss_val': 0.032668496719538614, 'psi': 0.9944528606042478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=37 head_norm_before_train=1.550856 cos_to_last_merge=0.9666 (last merge round=26)
[S11] round=37 local utility u=0.000300 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981115317390871, 'loss_val': 0.04515390987586482, 'psi': 0.9969248176436204}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978686692030401, 'loss_val': 0.04502557979034258, 'psi': 0.9968276726292016}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=37 head_norm_before_train=1.756439 (no previous merge yet)
[S13] round=37 local utility u=0.095424 metrics={'f1_val': 0.6402428016690012, 'auprc': 0.6698862016518738, 'loss_val': 0.7215767675346179, 'psi': 0.6521001616621502}-{'f1_val': 0.6092863845762152, 'auprc': 0.7128397369640219, 'loss_val': 0.8555477869825365, 'psi': 0.6507077255313379}
[S13] not sending this round → trigger blocked (psi=0.652)
[S14] START round=37 head_norm_before_train=1.465597 cos_to_last_merge=0.9543 (last merge round=26)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.997032258414768, 'loss_val': 0.050315067517354525, 'psi': 0.9972715336702849}-{'f1_val': 0.9971461297597816, 'auprc': 0.9988245930151444, 'loss_val': 0.045450901351449406, 'psi': 0.9978175150619266}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.585419 cos_to_last_merge=0.9627 (last merge round=31)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.9435872789767732, 'auprc': 0.997866546896411, 'loss_val': 0.12259837017608767, 'psi': 0.9652989861446283}-{'f1_val': 0.9814885069367558, 'auprc': 0.9982062824272915, 'loss_val': 0.08122855807920647, 'psi': 0.9881756171329701}
[S16] START round=37 head_norm_before_train=1.410874 cos_to_last_merge=0.9975 (last merge round=31)
[S16] round=37 local utility u=0.015608 metrics={'f1_val': 0.8607744024556745, 'auprc': 0.9835618494946813, 'loss_val': 0.7071584025130342, 'psi': 0.9098893812712772}-{'f1_val': 0.8580213976381572, 'auprc': 0.9872868105824988, 'loss_val': 0.7330314054646483, 'psi': 0.9097275628158938}
[S17] START round=37 head_norm_before_train=1.573605 cos_to_last_merge=0.9899 (last merge round=31)
[S17] round=37 local utility u=0.047318 metrics={'f1_val': 0.6381358338683538, 'auprc': 0.8449162611010348, 'loss_val': 1.057124508993229, 'psi': 0.7208480047614262}-{'f1_val': 0.6388303150387384, 'auprc': 0.8132300094458664, 'loss_val': 1.0608689006068852, 'psi': 0.7085901928015896}
[S9] not sending this round → trigger blocked (psi=0.997)
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] START round=38 head_norm_before_train=1.739702 cos_to_last_merge=0.8219 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.822
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.7684994047022348, 'auprc': 0.833219630800563, 'loss_val': 0.3502680636440647, 'psi': 0.7943874951415661}-{'f1_val': 0.7967470757620426, 'auprc': 0.9882766941394096, 'loss_val': 0.33773236564438786, 'psi': 0.8733589231129895}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=2.088037 cos_to_last_merge=0.7809 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.781
[S3] round=38 local utility u=0.015413 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9989211263082456, 'loss_val': 0.10670401393214801, 'psi': 0.9762135017629705}-{'f1_val': 0.9606067420772127, 'auprc': 0.9978207458082368, 'loss_val': 0.13141980156066635, 'psi': 0.9754923435696223}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=38 head_norm_before_train=1.487786 cos_to_last_merge=0.9974 (last merge round=31)
[S4] round=38 local utility u=0.021282 metrics={'f1_val': 0.9443137408274804, 'auprc': 0.9620393211541411, 'loss_val': 0.2609748693010397, 'psi': 0.9514039729581447}-{'f1_val': 0.9443284004635673, 'auprc': 0.949706927835003, 'loss_val': 0.26662941622388026, 'psi': 0.9464798114121415}
[S5] START round=38 head_norm_before_train=1.359619 cos_to_last_merge=0.9956 (last merge round=31)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.4444297219767441, 'auprc': 0.8553854996241789, 'loss_val': 0.789308403646083, 'psi': 0.608812033035718}-{'f1_val': 0.6371174752302596, 'auprc': 0.7482287006821495, 'loss_val': 0.502914579345596, 'psi': 0.6815619654110157}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.400265 cos_to_last_merge=0.9977 (last merge round=33)
[S6] round=38 local utility u=0.045750 metrics={'f1_val': 0.8245864954491031, 'auprc': 0.9620432425692468, 'loss_val': 0.3431951474769426, 'psi': 0.8795691942971606}-{'f1_val': 0.821944662409571, 'auprc': 0.953005403922293, 'loss_val': 0.3917299447287569, 'psi': 0.8743689590146597}
[S7] START round=38 head_norm_before_train=1.510656 cos_to_last_merge=0.9826 (last merge round=31)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5529266905383919, 'auprc': 0.7837997755906633, 'loss_val': 0.8655504400093731, 'psi': 0.6452759245593005}-{'f1_val': 0.5927819376621257, 'auprc': 0.7918967549832955, 'loss_val': 0.7530534638631611, 'psi': 0.6724278645905937}
[S8] START round=38 head_norm_before_train=1.987216 (no previous merge yet)
[S8] round=38 local utility u=0.000699 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9988175163756072, 'loss_val': 0.036109263199362605, 'psi': 0.9961424229095588}-{'f1_val': 0.9939919029218467, 'auprc': 0.9989558360890695, 'loss_val': 0.03571957904397686, 'psi': 0.9959774761887359}
[S9] START round=38 head_norm_before_train=1.488798 cos_to_last_merge=0.9971 (last merge round=31)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.996721335281205, 'auprc': 0.9945347474212689, 'loss_val': 0.02907961503925789, 'psi': 0.9958467001372305}-{'f1_val': 0.9967181314020974, 'auprc': 0.9984739561605751, 'loss_val': 0.03108388043658491, 'psi': 0.9974204613054884}
[S10] START round=38 head_norm_before_train=2.065383 (no previous merge yet)
[S10] round=38 local utility u=0.000633 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9958781683785394, 'loss_val': 0.031185503646178572, 'psi': 0.9946738949817427}-{'f1_val': 0.993871046050545, 'auprc': 0.9954477593141531, 'loss_val': 0.03115952111217005, 'psi': 0.9945017313559882}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=38 head_norm_before_train=1.567869 cos_to_last_merge=0.9646 (last merge round=26)
[S11] round=38 local utility u=0.000152 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9979710903840007, 'loss_val': 0.04297778048162889, 'psi': 0.9967235388747486}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981115317390871, 'loss_val': 0.04515390987586482, 'psi': 0.9969248176436204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=38 head_norm_before_train=1.765972 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6207525703217687, 'auprc': 0.6935038029362115, 'loss_val': 0.7219394672453889, 'psi': 0.6498530633675459}-{'f1_val': 0.6402428016690012, 'auprc': 0.6698862016518738, 'loss_val': 0.7215767675346179, 'psi': 0.6521001616621502}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.478409 cos_to_last_merge=0.9526 (last merge round=26)
[S14] round=38 local utility u=0.002353 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.997147707664569, 'loss_val': 0.04203388997790793, 'psi': 0.9969255476372894}-{'f1_val': 0.9974310505072961, 'auprc': 0.997032258414768, 'loss_val': 0.050315067517354525, 'psi': 0.9972715336702849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=38 head_norm_before_train=1.627238 cos_to_last_merge=0.9570 (last merge round=31)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.8131383121661161, 'auprc': 0.9960405322820337, 'loss_val': 0.28826884365470634, 'psi': 0.8862992002124831}-{'f1_val': 0.9435872789767732, 'auprc': 0.997866546896411, 'loss_val': 0.12259837017608767, 'psi': 0.9652989861446283}
[S16] START round=38 head_norm_before_train=1.427981 cos_to_last_merge=0.9968 (last merge round=31)
[S16] round=38 local utility u=0.190564 metrics={'f1_val': 0.8917674173192303, 'auprc': 0.9865185896468225, 'loss_val': 0.5208577615260102, 'psi': 0.9296678862502672}-{'f1_val': 0.8607744024556745, 'auprc': 0.9835618494946813, 'loss_val': 0.7071584025130342, 'psi': 0.9098893812712772}
[S17] START round=38 head_norm_before_train=1.602409 cos_to_last_merge=0.9877 (last merge round=31)
[S17] round=38 local utility u=0.345031 metrics={'f1_val': 0.6576235162571629, 'auprc': 0.9037847147220177, 'loss_val': 0.6605940419122772, 'psi': 0.7560879956431048}-{'f1_val': 0.6381358338683538, 'auprc': 0.8449162611010348, 'loss_val': 1.057124508993229, 'psi': 0.7208480047614262}
[S7]  timeout peer S14
[S9]  timeout peer S17
[S8]  timeout peer S7
[S17]  timeout peer S9
[S16]  timeout peer S6
[S4]  timeout peer S11
[S15]  timeout peer S5
[S6]  timeout peer S4
[S6]  timeout peer S16
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.756)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.930)
[S6] not sending this round → trigger blocked (psi=0.880)
[S2] START round=39 head_norm_before_train=1.751181 cos_to_last_merge=0.8201 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.820
[S2] round=39 local utility u=0.396243 metrics={'f1_val': 0.8226554517210568, 'auprc': 0.9905355784137508, 'loss_val': 0.354665440857388, 'psi': 0.8898075023981344}-{'f1_val': 0.7684994047022348, 'auprc': 0.833219630800563, 'loss_val': 0.3502680636440647, 'psi': 0.7943874951415661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S2] r=40 psi=0.890 u=0.3962 p_local=0.1456 f1=0.823 auprc=0.991 bytes=43178
[S3] START round=39 head_norm_before_train=2.097032 cos_to_last_merge=0.7803 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.780
[S3] round=39 local utility u=0.047812 metrics={'f1_val': 0.9755384046795901, 'auprc': 0.9976099118724574, 'loss_val': 0.09392720531715211, 'psi': 0.984367007556737}-{'f1_val': 0.9610750853994537, 'auprc': 0.9989211263082456, 'loss_val': 0.10670401393214801, 'psi': 0.9762135017629705}
[S3] not sending this round → trigger blocked (psi=0.984)
[S3] r=40 psi=0.984 u=0.0478 p_local=0.1650 f1=0.976 auprc=0.998 bytes=32379
[S4] START round=39 head_norm_before_train=1.498293 cos_to_last_merge=0.9971 (last merge round=31)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9422531705164856, 'auprc': 0.9468126905298515, 'loss_val': 0.2723171338398709, 'psi': 0.9440769785218319}-{'f1_val': 0.9443137408274804, 'auprc': 0.9620393211541411, 'loss_val': 0.2609748693010397, 'psi': 0.9514039729581447}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.944 u=0.0000 p_local=0.0229 f1=0.942 auprc=0.947 bytes=43190
[S5] START round=39 head_norm_before_train=1.370941 cos_to_last_merge=0.9947 (last merge round=31)
[S5] round=39 local utility u=1.000000 metrics={'f1_val': 0.7029607488664021, 'auprc': 0.9893056751218786, 'loss_val': 0.17846629495859445, 'psi': 0.8174987193685928}-{'f1_val': 0.4444297219767441, 'auprc': 0.8553854996241789, 'loss_val': 0.789308403646083, 'psi': 0.608812033035718}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S5] r=40 psi=0.817 u=1.0000 p_local=0.3542 f1=0.703 auprc=0.989 bytes=43181
[S6] START round=39 head_norm_before_train=1.415318 cos_to_last_merge=0.9967 (last merge round=33)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.6700837041568144, 'auprc': 0.817973028263822, 'loss_val': 0.48113371623989165, 'psi': 0.7292394337996174}-{'f1_val': 0.8245864954491031, 'auprc': 0.9620432425692468, 'loss_val': 0.3431951474769426, 'psi': 0.8795691942971606}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.729 u=0.0000 p_local=0.2250 f1=0.670 auprc=0.818 bytes=34167
[S7] START round=39 head_norm_before_train=1.529930 cos_to_last_merge=0.9803 (last merge round=31)
[S7] round=39 local utility u=0.372336 metrics={'f1_val': 0.6217711384059017, 'auprc': 0.8004995554018235, 'loss_val': 0.5840442374497821, 'psi': 0.6932625052042705}-{'f1_val': 0.5529266905383919, 'auprc': 0.7837997755906633, 'loss_val': 0.8655504400093731, 'psi': 0.6452759245593005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S7] r=40 psi=0.693 u=0.3723 p_local=0.1637 f1=0.622 auprc=0.800 bytes=34215
[S8] START round=39 head_norm_before_train=2.000484 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.989780933099827, 'auprc': 0.9989509709647109, 'loss_val': 0.04135052141100592, 'psi': 0.9934489482457806}-{'f1_val': 0.9943590272655265, 'auprc': 0.9988175163756072, 'loss_val': 0.036109263199362605, 'psi': 0.9961424229095588}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.993 u=0.0000 p_local=0.0051 f1=0.990 auprc=0.999 bytes=41453
[S9] START round=39 head_norm_before_train=1.508016 cos_to_last_merge=0.9964 (last merge round=31)
[S9] round=39 local utility u=0.001824 metrics={'f1_val': 0.9958851710193355, 'auprc': 0.9982150429553063, 'loss_val': 0.03145580894255232, 'psi': 0.9968171197937238}-{'f1_val': 0.996721335281205, 'auprc': 0.9945347474212689, 'loss_val': 0.02907961503925789, 'psi': 0.9958467001372305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S9] r=40 psi=0.997 u=0.0018 p_local=0.0052 f1=0.996 auprc=0.998 bytes=46780
[S10] START round=39 head_norm_before_train=2.071402 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9956776383956554, 'loss_val': 0.03230752496578986, 'psi': 0.9944621595764618}-{'f1_val': 0.993871046050545, 'auprc': 0.9958781683785394, 'loss_val': 0.031185503646178572, 'psi': 0.9946738949817427}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.994 u=0.0000 p_local=0.0022 f1=0.994 auprc=0.996 bytes=50411
[S11] START round=39 head_norm_before_train=1.582219 cos_to_last_merge=0.9628 (last merge round=26)
[S11] round=39 local utility u=0.002088 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9979406112345931, 'loss_val': 0.040160733162083434, 'psi': 0.9968564494418228}-{'f1_val': 0.9958918378685807, 'auprc': 0.9979710903840007, 'loss_val': 0.04297778048162889, 'psi': 0.9967235388747486}
[S11] not sending this round → trigger blocked (psi=0.997)
[S11] r=40 psi=0.997 u=0.0021 p_local=0.0100 f1=0.996 auprc=0.998 bytes=39556
[S13] START round=39 head_norm_before_train=1.774398 (no previous merge yet)
[S13] round=39 local utility u=0.227571 metrics={'f1_val': 0.658104306938964, 'auprc': 0.7230322991298636, 'loss_val': 0.5794938737269264, 'psi': 0.6840755038153239}-{'f1_val': 0.6207525703217687, 'auprc': 0.6935038029362115, 'loss_val': 0.7219394672453889, 'psi': 0.6498530633675459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S13] r=40 psi=0.684 u=0.2276 p_local=0.0893 f1=0.658 auprc=0.723 bytes=30654
[S14] START round=39 head_norm_before_train=1.490327 cos_to_last_merge=0.9510 (last merge round=26)
[S14] round=39 local utility u=0.005763 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9990905735954603, 'loss_val': 0.03911434655425709, 'psi': 0.9979804434616599}-{'f1_val': 0.9967774409524363, 'auprc': 0.997147707664569, 'loss_val': 0.04203388997790793, 'psi': 0.9969255476372894}
[S14] not sending this round → trigger blocked (psi=0.998)
[S14] r=40 psi=0.998 u=0.0058 p_local=0.0234 f1=0.997 auprc=0.999 bytes=43167
[S15] START round=39 head_norm_before_train=1.661396 cos_to_last_merge=0.9524 (last merge round=31)
[S15] round=39 local utility u=0.008148 metrics={'f1_val': 0.8111908314257685, 'auprc': 0.9945409433317338, 'loss_val': 0.2557897969937578, 'psi': 0.8845308761881546}-{'f1_val': 0.8131383121661161, 'auprc': 0.9960405322820337, 'loss_val': 0.28826884365470634, 'psi': 0.8862992002124831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S15] r=40 psi=0.885 u=0.0081 p_local=0.1340 f1=0.811 auprc=0.995 bytes=37789
[S16] START round=39 head_norm_before_train=1.443869 cos_to_last_merge=0.9961 (last merge round=31)
[S16] round=39 local utility u=0.544779 metrics={'f1_val': 0.9917148021162032, 'auprc': 0.9939604808967335, 'loss_val': 0.05331017419853184, 'psi': 0.9926130736284153}-{'f1_val': 0.8917674173192303, 'auprc': 0.9865185896468225, 'loss_val': 0.5208577615260102, 'psi': 0.9296678862502672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S16] r=40 psi=0.993 u=0.5448 p_local=0.1894 f1=0.992 auprc=0.994 bytes=39578
[S17] START round=39 head_norm_before_train=1.619700 cos_to_last_merge=0.9863 (last merge round=31)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6244885276827818, 'auprc': 0.8289969938844589, 'loss_val': 1.161497443390947, 'psi': 0.7062919141634527}-{'f1_val': 0.6576235162571629, 'auprc': 0.9037847147220177, 'loss_val': 0.6605940419122772, 'psi': 0.7560879956431048}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.706 u=0.0000 p_local=0.1045 f1=0.624 auprc=0.829 bytes=37828
[S2] START round=40 head_norm_before_train=1.761183 cos_to_last_merge=0.8187 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.819
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.8277513685234402, 'auprc': 0.9502456424308072, 'loss_val': 0.3169605847586142, 'psi': 0.876749078086387}-{'f1_val': 0.8226554517210568, 'auprc': 0.9905355784137508, 'loss_val': 0.354665440857388, 'psi': 0.8898075023981344}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.107796 cos_to_last_merge=0.7795 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.779
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.8429997780095332, 'auprc': 0.9888394897972781, 'loss_val': 0.3697255278132529, 'psi': 0.9013356627246312}-{'f1_val': 0.9755384046795901, 'auprc': 0.9976099118724574, 'loss_val': 0.09392720531715211, 'psi': 0.984367007556737}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.508404 cos_to_last_merge=0.9966 (last merge round=31)
[S4] round=40 local utility u=0.044403 metrics={'f1_val': 0.9491041410072458, 'auprc': 0.9610581066038326, 'loss_val': 0.2673528721624321, 'psi': 0.9538857272458805}-{'f1_val': 0.9422531705164856, 'auprc': 0.9468126905298515, 'loss_val': 0.2723171338398709, 'psi': 0.9440769785218319}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=40 head_norm_before_train=1.381562 cos_to_last_merge=0.9939 (last merge round=31)
[S5] round=40 local utility u=0.150665 metrics={'f1_val': 0.7529116904596529, 'auprc': 0.9893587641116781, 'loss_val': 0.17700078803963706, 'psi': 0.847490519920463}-{'f1_val': 0.7029607488664021, 'auprc': 0.9893056751218786, 'loss_val': 0.17846629495859445, 'psi': 0.8174987193685928}
[S5] not sending this round → trigger blocked (psi=0.847)
[S6] START round=40 head_norm_before_train=1.428334 cos_to_last_merge=0.9956 (last merge round=33)
[S6] round=40 local utility u=0.260350 metrics={'f1_val': 0.7089129657988489, 'auprc': 0.9243205456889764, 'loss_val': 0.5124513427224034, 'psi': 0.7950759977548998}-{'f1_val': 0.6700837041568144, 'auprc': 0.817973028263822, 'loss_val': 0.48113371623989165, 'psi': 0.7292394337996174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=40 head_norm_before_train=1.544669 cos_to_last_merge=0.9785 (last merge round=31)
[S7] round=40 local utility u=0.126510 metrics={'f1_val': 0.6506508436712163, 'auprc': 0.8065602901304421, 'loss_val': 0.52248427894655, 'psi': 0.7130146222549065}-{'f1_val': 0.6217711384059017, 'auprc': 0.8004995554018235, 'loss_val': 0.5840442374497821, 'psi': 0.6932625052042705}
[S7] not sending this round → trigger blocked (psi=0.713)
[S8] START round=40 head_norm_before_train=2.012390 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9930484401182695, 'auprc': 0.9883251070027372, 'loss_val': 0.0494531870308324, 'psi': 0.9911591068720567}-{'f1_val': 0.989780933099827, 'auprc': 0.9989509709647109, 'loss_val': 0.04135052141100592, 'psi': 0.9934489482457806}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.525169 cos_to_last_merge=0.9956 (last merge round=31)
[S9] round=40 local utility u=0.000129 metrics={'f1_val': 0.996721335281205, 'auprc': 0.9950549219629058, 'loss_val': 0.02673471091806949, 'psi': 0.9960547699538853}-{'f1_val': 0.9958851710193355, 'auprc': 0.9982150429553063, 'loss_val': 0.03145580894255232, 'psi': 0.9968171197937238}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=40 head_norm_before_train=2.078961 (no previous merge yet)
[S10] round=40 local utility u=0.001218 metrics={'f1_val': 0.993871046050545, 'auprc': 0.995522798111987, 'loss_val': 0.030722834303774718, 'psi': 0.9945317468751218}-{'f1_val': 0.9936518403636662, 'auprc': 0.9956776383956554, 'loss_val': 0.03230752496578986, 'psi': 0.9944621595764618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=40 head_norm_before_train=1.596093 cos_to_last_merge=0.9610 (last merge round=26)
[S11] round=40 local utility u=0.000725 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9977935761278252, 'loss_val': 0.03826927907578206, 'psi': 0.9967976353991157}-{'f1_val': 0.9961336749133093, 'auprc': 0.9979406112345931, 'loss_val': 0.040160733162083434, 'psi': 0.9968564494418228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=40 head_norm_before_train=1.778581 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6512102012495593, 'auprc': 0.6930657744784195, 'loss_val': 0.7864363586603575, 'psi': 0.6679524305411033}-{'f1_val': 0.658104306938964, 'auprc': 0.7230322991298636, 'loss_val': 0.5794938737269264, 'psi': 0.6840755038153239}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.503473 cos_to_last_merge=0.9492 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.949
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9986202937888535, 'loss_val': 0.0383259108994365, 'psi': 0.9974004564819916}-{'f1_val': 0.997240356705793, 'auprc': 0.9990905735954603, 'loss_val': 0.03911434655425709, 'psi': 0.9979804434616599}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.689209 cos_to_last_merge=0.9488 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7998576562272125, 'auprc': 0.9604498322963462, 'loss_val': 0.4078598243210318, 'psi': 0.864094526654866}-{'f1_val': 0.8111908314257685, 'auprc': 0.9945409433317338, 'loss_val': 0.2557897969937578, 'psi': 0.8845308761881546}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.458780 cos_to_last_merge=0.9954 (last merge round=31)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.7159170833359135, 'auprc': 0.9186653892253055, 'loss_val': 0.97116490462731, 'psi': 0.7970164056916703}-{'f1_val': 0.9917148021162032, 'auprc': 0.9939604808967335, 'loss_val': 0.05331017419853184, 'psi': 0.9926130736284153}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.634259 cos_to_last_merge=0.9850 (last merge round=31)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6139656807501053, 'auprc': 0.8201712758545663, 'loss_val': 1.1420048573028099, 'psi': 0.6964479187918897}-{'f1_val': 0.6244885276827818, 'auprc': 0.8289969938844589, 'loss_val': 1.161497443390947, 'psi': 0.7062919141634527}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.770868 cos_to_last_merge=0.8175 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.817
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.8314242185805154, 'auprc': 0.9144212571604828, 'loss_val': 0.2770804526247813, 'psi': 0.8646230340125024}-{'f1_val': 0.8277513685234402, 'auprc': 0.9502456424308072, 'loss_val': 0.3169605847586142, 'psi': 0.876749078086387}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.113171 cos_to_last_merge=0.7793 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.779
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.7789445500334902, 'auprc': 0.9676371243892241, 'loss_val': 0.5915073273995264, 'psi': 0.8544215797757837}-{'f1_val': 0.8429997780095332, 'auprc': 0.9888394897972781, 'loss_val': 0.3697255278132529, 'psi': 0.9013356627246312}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.517719 cos_to_last_merge=0.9963 (last merge round=31)
[S4] round=41 local utility u=0.009073 metrics={'f1_val': 0.9498141294264935, 'auprc': 0.9642553695513656, 'loss_val': 0.2630576599448833, 'psi': 0.9555906254764422}-{'f1_val': 0.9491041410072458, 'auprc': 0.9610581066038326, 'loss_val': 0.2673528721624321, 'psi': 0.9538857272458805}
[S4] not sending this round → trigger blocked (psi=0.956)
[S5] START round=41 head_norm_before_train=1.394270 cos_to_last_merge=0.9929 (last merge round=31)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.5804650123441957, 'auprc': 0.855208722745497, 'loss_val': 0.6429136875552273, 'psi': 0.6903624965047161}-{'f1_val': 0.7529116904596529, 'auprc': 0.9893587641116781, 'loss_val': 0.17700078803963706, 'psi': 0.847490519920463}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.437175 cos_to_last_merge=0.9946 (last merge round=33)
[S6] round=41 local utility u=0.456545 metrics={'f1_val': 0.8227286484843733, 'auprc': 0.954700075842451, 'loss_val': 0.37339383883882016, 'psi': 0.8755172194276044}-{'f1_val': 0.7089129657988489, 'auprc': 0.9243205456889764, 'loss_val': 0.5124513427224034, 'psi': 0.7950759977548998}
[S6] not sending this round → trigger blocked (psi=0.876)
[S7] START round=41 head_norm_before_train=1.558291 cos_to_last_merge=0.9768 (last merge round=31)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5527396006414442, 'auprc': 0.784093070410251, 'loss_val': 0.8340588800573778, 'psi': 0.645280988548967}-{'f1_val': 0.6506508436712163, 'auprc': 0.8065602901304421, 'loss_val': 0.52248427894655, 'psi': 0.7130146222549065}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=2.023031 (no previous merge yet)
[S8] round=41 local utility u=0.026001 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9987601785795397, 'loss_val': 0.034417787136420144, 'psi': 0.9958992131849239}-{'f1_val': 0.9930484401182695, 'auprc': 0.9883251070027372, 'loss_val': 0.0494531870308324, 'psi': 0.9911591068720567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=41 head_norm_before_train=1.536566 cos_to_last_merge=0.9950 (last merge round=31)
[S9] round=41 local utility u=0.004954 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9986004771698964, 'loss_val': 0.027444372906236858, 'psi': 0.997471069709217}-{'f1_val': 0.996721335281205, 'auprc': 0.9950549219629058, 'loss_val': 0.02673471091806949, 'psi': 0.9960547699538853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=41 head_norm_before_train=2.087293 (no previous merge yet)
[S10] round=41 local utility u=0.000024 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9955452171102399, 'loss_val': 0.030742626048150614, 'psi': 0.9945407144744229}-{'f1_val': 0.993871046050545, 'auprc': 0.995522798111987, 'loss_val': 0.030722834303774718, 'psi': 0.9945317468751218}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=41 head_norm_before_train=1.610043 cos_to_last_merge=0.9593 (last merge round=26)
[S11] round=41 local utility u=0.001055 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9976733625171788, 'loss_val': 0.035799433525674024, 'psi': 0.9967495499548571}-{'f1_val': 0.9961336749133093, 'auprc': 0.9977935761278252, 'loss_val': 0.03826927907578206, 'psi': 0.9967976353991157}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=41 head_norm_before_train=1.783968 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6398381090226088, 'auprc': 0.6563986973358401, 'loss_val': 0.8662798604588894, 'psi': 0.6464623443479014}-{'f1_val': 0.6512102012495593, 'auprc': 0.6930657744784195, 'loss_val': 0.7864363586603575, 'psi': 0.6679524305411033}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.518481 cos_to_last_merge=0.9472 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.947
[S14] round=41 local utility u=0.002948 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9985788254834509, 'loss_val': 0.03622413188355395, 'psi': 0.9977757442168562}-{'f1_val': 0.9965872316107504, 'auprc': 0.9986202937888535, 'loss_val': 0.0383259108994365, 'psi': 0.9974004564819916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=41 head_norm_before_train=1.712103 cos_to_last_merge=0.9459 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=41 local utility u=0.390998 metrics={'f1_val': 0.888275594263359, 'auprc': 0.9786540946179751, 'loss_val': 0.21098348553769805, 'psi': 0.9244269944052055}-{'f1_val': 0.7998576562272125, 'auprc': 0.9604498322963462, 'loss_val': 0.4078598243210318, 'psi': 0.864094526654866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S15] sending update (kind=head size=1808 to 1 peers)
[S16] START round=41 head_norm_before_train=1.471495 cos_to_last_merge=0.9949 (last merge round=31)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.8200698244529734, 'auprc': 0.7856402365556058, 'loss_val': 1.21056604010688, 'psi': 0.8062979892940263}-{'f1_val': 0.7159170833359135, 'auprc': 0.9186653892253055, 'loss_val': 0.97116490462731, 'psi': 0.7970164056916703}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.639241 cos_to_last_merge=0.9842 (last merge round=31)
[S17] round=41 local utility u=0.518353 metrics={'f1_val': 0.6530008591643262, 'auprc': 0.9181314262519371, 'loss_val': 0.6333899442290958, 'psi': 0.7590530859993705}-{'f1_val': 0.6139656807501053, 'auprc': 0.8201712758545663, 'loss_val': 1.1420048573028099, 'psi': 0.6964479187918897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=42 head_norm_before_train=1.781955 cos_to_last_merge=0.8162 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.816
[S2] round=42 local utility u=0.003963 metrics={'f1_val': 0.8137899346904544, 'auprc': 0.9911684578459964, 'loss_val': 0.3935901357310922, 'psi': 0.8847413439526712}-{'f1_val': 0.8314242185805154, 'auprc': 0.9144212571604828, 'loss_val': 0.2770804526247813, 'psi': 0.8646230340125024}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=42 head_norm_before_train=2.121946 cos_to_last_merge=0.7787 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.779
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.7403996814403662, 'auprc': 0.9735566206646661, 'loss_val': 0.7497514536738646, 'psi': 0.8336624571300861}-{'f1_val': 0.7789445500334902, 'auprc': 0.9676371243892241, 'loss_val': 0.5915073273995264, 'psi': 0.8544215797757837}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.526347 cos_to_last_merge=0.9959 (last merge round=31)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9413899721268816, 'auprc': 0.9470613923982534, 'loss_val': 0.2740032023822335, 'psi': 0.9436585402354303}-{'f1_val': 0.9498141294264935, 'auprc': 0.9642553695513656, 'loss_val': 0.2630576599448833, 'psi': 0.9555906254764422}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.410468 cos_to_last_merge=0.9914 (last merge round=31)
[S5] round=42 local utility u=0.117069 metrics={'f1_val': 0.591743212411905, 'auprc': 0.8699887673643427, 'loss_val': 0.5207847915427838, 'psi': 0.7030414343928801}-{'f1_val': 0.5804650123441957, 'auprc': 0.855208722745497, 'loss_val': 0.6429136875552273, 'psi': 0.6903624965047161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=42 head_norm_before_train=1.445578 cos_to_last_merge=0.9937 (last merge round=33)
[S6] round=42 local utility u=0.499566 metrics={'f1_val': 0.9609696814787294, 'auprc': 0.955001799293802, 'loss_val': 0.20461317719421132, 'psi': 0.9585825286047585}-{'f1_val': 0.8227286484843733, 'auprc': 0.954700075842451, 'loss_val': 0.37339383883882016, 'psi': 0.8755172194276044}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=42 head_norm_before_train=1.571346 cos_to_last_merge=0.9753 (last merge round=31)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5163702343348229, 'auprc': 0.7824454257812181, 'loss_val': 0.8548793161143768, 'psi': 0.622800310913381}-{'f1_val': 0.5527396006414442, 'auprc': 0.784093070410251, 'loss_val': 0.8340588800573778, 'psi': 0.645280988548967}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=2.034129 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9919528555747477, 'auprc': 0.9989395134170302, 'loss_val': 0.03499110067786339, 'psi': 0.9947475187116607}-{'f1_val': 0.9939919029218467, 'auprc': 0.9987601785795397, 'loss_val': 0.034417787136420144, 'psi': 0.9958992131849239}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.545250 cos_to_last_merge=0.9946 (last merge round=31)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9960787721465576, 'loss_val': 0.0254198786692637, 'psi': 0.9967105626428885}-{'f1_val': 0.9967181314020974, 'auprc': 0.9986004771698964, 'loss_val': 0.027444372906236858, 'psi': 0.997471069709217}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.095855 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9956684721878999, 'loss_val': 0.03200459303228944, 'psi': 0.9944584930933597}-{'f1_val': 0.993871046050545, 'auprc': 0.9955452171102399, 'loss_val': 0.030742626048150614, 'psi': 0.9945407144744229}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.623619 cos_to_last_merge=0.9577 (last merge round=26)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9975198028890983, 'loss_val': 0.03467209212153365, 'psi': 0.9965430238767877}-{'f1_val': 0.9961336749133093, 'auprc': 0.9976733625171788, 'loss_val': 0.035799433525674024, 'psi': 0.9967495499548571}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.790054 (no previous merge yet)
[S13] round=42 local utility u=0.188003 metrics={'f1_val': 0.6403111379246085, 'auprc': 0.7371339948370397, 'loss_val': 0.7353172457633644, 'psi': 0.679040280689581}-{'f1_val': 0.6398381090226088, 'auprc': 0.6563986973358401, 'loss_val': 0.8662798604588894, 'psi': 0.6464623443479014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S13] sending update (kind=head size=1810 to 1 peers)
[S14] START round=42 head_norm_before_train=1.534340 cos_to_last_merge=0.9451 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=42 local utility u=0.000471 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.998520018487538, 'loss_val': 0.03364840638791299, 'psi': 0.9976065122896143}-{'f1_val': 0.997240356705793, 'auprc': 0.9985788254834509, 'loss_val': 0.03622413188355395, 'psi': 0.9977757442168562}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=42 head_norm_before_train=1.731703 cos_to_last_merge=0.9434 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.943
[S15] round=42 local utility u=0.168758 metrics={'f1_val': 0.9297711615909787, 'auprc': 0.9876649693218879, 'loss_val': 0.14947439496687626, 'psi': 0.9529286846833425}-{'f1_val': 0.888275594263359, 'auprc': 0.9786540946179751, 'loss_val': 0.21098348553769805, 'psi': 0.9244269944052055}
[S15] not sending this round → trigger blocked (psi=0.953)
[S16] START round=42 head_norm_before_train=1.481178 cos_to_last_merge=0.9945 (last merge round=31)
[S16] round=42 local utility u=0.567836 metrics={'f1_val': 0.8252870697054254, 'auprc': 0.9579014278554112, 'loss_val': 0.6229819269812522, 'psi': 0.8783328129654198}-{'f1_val': 0.8200698244529734, 'auprc': 0.7856402365556058, 'loss_val': 1.21056604010688, 'psi': 0.8062979892940263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=42 head_norm_before_train=1.643740 cos_to_last_merge=0.9833 (last merge round=31)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6527719964404797, 'auprc': 0.878180087171291, 'loss_val': 0.8675482140467278, 'psi': 0.7429352327328043}-{'f1_val': 0.6530008591643262, 'auprc': 0.9181314262519371, 'loss_val': 0.6333899442290958, 'psi': 0.7590530859993705}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.793219 cos_to_last_merge=0.8150 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.815
[S2] round=43 local utility u=0.030937 metrics={'f1_val': 0.830464736066973, 'auprc': 0.9450885563657244, 'loss_val': 0.2935243670971314, 'psi': 0.8763142641864736}-{'f1_val': 0.8137899346904544, 'auprc': 0.9911684578459964, 'loss_val': 0.3935901357310922, 'psi': 0.8847413439526712}
[S2] not sending this round → trigger blocked (psi=0.876)
[S3] START round=43 head_norm_before_train=2.131798 cos_to_last_merge=0.7779 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.778
[S3] round=43 local utility u=0.363569 metrics={'f1_val': 0.8179643999407311, 'auprc': 0.9959048704347799, 'loss_val': 0.5550466915612083, 'psi': 0.8891405881383507}-{'f1_val': 0.7403996814403662, 'auprc': 0.9735566206646661, 'loss_val': 0.7497514536738646, 'psi': 0.8336624571300861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=43 head_norm_before_train=1.533463 cos_to_last_merge=0.9956 (last merge round=31)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9383882972768387, 'auprc': 0.938552109401344, 'loss_val': 0.29736996626241236, 'psi': 0.9384538221266409}-{'f1_val': 0.9413899721268816, 'auprc': 0.9470613923982534, 'loss_val': 0.2740032023822335, 'psi': 0.9436585402354303}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.422770 cos_to_last_merge=0.9901 (last merge round=31)
[S5] round=43 local utility u=0.550834 metrics={'f1_val': 0.6932573725697585, 'auprc': 0.9620864049897836, 'loss_val': 0.30449366556835405, 'psi': 0.8007889855377686}-{'f1_val': 0.591743212411905, 'auprc': 0.8699887673643427, 'loss_val': 0.5207847915427838, 'psi': 0.7030414343928801}
[S5] not sending this round → trigger blocked (psi=0.801)
[S6] START round=43 head_norm_before_train=1.456785 cos_to_last_merge=0.9928 (last merge round=33)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.6358996656787423, 'auprc': 0.7826121925881582, 'loss_val': 0.6753599919462091, 'psi': 0.6945846764425088}-{'f1_val': 0.9609696814787294, 'auprc': 0.955001799293802, 'loss_val': 0.20461317719421132, 'psi': 0.9585825286047585}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.583511 cos_to_last_merge=0.9739 (last merge round=31)
[S7] round=43 local utility u=0.416124 metrics={'f1_val': 0.60740808034915, 'auprc': 0.7920450691789273, 'loss_val': 0.5976572377481262, 'psi': 0.6812628758810608}-{'f1_val': 0.5163702343348229, 'auprc': 0.7824454257812181, 'loss_val': 0.8548793161143768, 'psi': 0.622800310913381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=43 head_norm_before_train=2.045421 (no previous merge yet)
[S8] round=43 local utility u=0.004630 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.9988563817323375, 'loss_val': 0.03332110470352812, 'psi': 0.9954981493010528}-{'f1_val': 0.9919528555747477, 'auprc': 0.9989395134170302, 'loss_val': 0.03499110067786339, 'psi': 0.9947475187116607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=43 head_norm_before_train=1.557006 cos_to_last_merge=0.9940 (last merge round=31)
[S9] round=43 local utility u=0.002774 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9987643338265081, 'loss_val': 0.025446136560047055, 'psi': 0.9975366123718616}-{'f1_val': 0.9971317563071089, 'auprc': 0.9960787721465576, 'loss_val': 0.0254198786692637, 'psi': 0.9967105626428885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=43 head_norm_before_train=2.104540 (no previous merge yet)
[S10] round=43 local utility u=0.001442 metrics={'f1_val': 0.993871046050545, 'auprc': 0.995489558547755, 'loss_val': 0.029899848056914664, 'psi': 0.9945184510494289}-{'f1_val': 0.9936518403636662, 'auprc': 0.9956684721878999, 'loss_val': 0.03200459303228944, 'psi': 0.9944584930933597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=43 head_norm_before_train=1.634621 cos_to_last_merge=0.9564 (last merge round=26)
[S11] round=43 local utility u=0.000202 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9972162489923686, 'loss_val': 0.03335719551620006, 'psi': 0.9964216023180958}-{'f1_val': 0.9958918378685807, 'auprc': 0.9975198028890983, 'loss_val': 0.03467209212153365, 'psi': 0.9965430238767877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=43 head_norm_before_train=1.797580 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6100153975341515, 'auprc': 0.6333358551793054, 'loss_val': 1.0282506308914368, 'psi': 0.6193435805922131}-{'f1_val': 0.6403111379246085, 'auprc': 0.7371339948370397, 'loss_val': 0.7353172457633644, 'psi': 0.679040280689581}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.549523 cos_to_last_merge=0.9430 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9949110635196168, 'auprc': 0.9985214849495292, 'loss_val': 0.04567152910044799, 'psi': 0.9963552320915818}-{'f1_val': 0.9969975081576651, 'auprc': 0.998520018487538, 'loss_val': 0.03364840638791299, 'psi': 0.9976065122896143}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.750131 cos_to_last_merge=0.9412 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.941
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.788234781328844, 'auprc': 0.9649068736209212, 'loss_val': 0.43186934326314536, 'psi': 0.8589036182456748}-{'f1_val': 0.9297711615909787, 'auprc': 0.9876649693218879, 'loss_val': 0.14947439496687626, 'psi': 0.9529286846833425}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.489407 cos_to_last_merge=0.9941 (last merge round=31)
[S16] round=43 local utility u=0.832523 metrics={'f1_val': 0.9921499874340187, 'auprc': 0.9868513320894032, 'loss_val': 0.0459638841685198, 'psi': 0.9900305252961725}-{'f1_val': 0.8252870697054254, 'auprc': 0.9579014278554112, 'loss_val': 0.6229819269812522, 'psi': 0.8783328129654198}
[S16] not sending this round → trigger blocked (psi=0.990)
[S17] START round=43 head_norm_before_train=1.651090 cos_to_last_merge=0.9826 (last merge round=31)
[S17] round=43 local utility u=0.184769 metrics={'f1_val': 0.6893242651496344, 'auprc': 0.8780864334407181, 'loss_val': 0.7170437323182828, 'psi': 0.7648291324660679}-{'f1_val': 0.6527719964404797, 'auprc': 0.878180087171291, 'loss_val': 0.8675482140467278, 'psi': 0.7429352327328043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=44 head_norm_before_train=1.802929 cos_to_last_merge=0.8138 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.814
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.8248506551525135, 'auprc': 0.988679577067066, 'loss_val': 0.39280523965587144, 'psi': 0.8903822239183345}-{'f1_val': 0.830464736066973, 'auprc': 0.9450885563657244, 'loss_val': 0.2935243670971314, 'psi': 0.8763142641864736}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.141204 cos_to_last_merge=0.7772 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.777
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.8075812521255366, 'auprc': 0.9763623352219711, 'loss_val': 0.5904723710143621, 'psi': 0.8750936853641105}-{'f1_val': 0.8179643999407311, 'auprc': 0.9959048704347799, 'loss_val': 0.5550466915612083, 'psi': 0.8891405881383507}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.537881 cos_to_last_merge=0.9955 (last merge round=31)
[S4] round=44 local utility u=0.004257 metrics={'f1_val': 0.9384522277773089, 'auprc': 0.9384196805760538, 'loss_val': 0.2888418341595812, 'psi': 0.9384392088968069}-{'f1_val': 0.9383882972768387, 'auprc': 0.938552109401344, 'loss_val': 0.29736996626241236, 'psi': 0.9384538221266409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=44 head_norm_before_train=1.434451 cos_to_last_merge=0.9889 (last merge round=31)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.6949093280111207, 'auprc': 0.9511591810460824, 'loss_val': 0.34512956373541376, 'psi': 0.7974092692251054}-{'f1_val': 0.6932573725697585, 'auprc': 0.9620864049897836, 'loss_val': 0.30449366556835405, 'psi': 0.8007889855377686}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.468819 cos_to_last_merge=0.9918 (last merge round=33)
[S6] round=44 local utility u=0.983954 metrics={'f1_val': 0.831467290447118, 'auprc': 0.959227520187374, 'loss_val': 0.4107032387659029, 'psi': 0.8825713823432204}-{'f1_val': 0.6358996656787423, 'auprc': 0.7826121925881582, 'loss_val': 0.6753599919462091, 'psi': 0.6945846764425088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=44 head_norm_before_train=1.595668 cos_to_last_merge=0.9722 (last merge round=31)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5695242735788659, 'auprc': 0.781597661134411, 'loss_val': 0.7875825812718107, 'psi': 0.654353628601084}-{'f1_val': 0.60740808034915, 'auprc': 0.7920450691789273, 'loss_val': 0.5976572377481262, 'psi': 0.6812628758810608}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=2.055395 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9936178346089239, 'auprc': 0.9980991777034132, 'loss_val': 0.03501764260942323, 'psi': 0.9954103718467197}-{'f1_val': 0.9932593276801964, 'auprc': 0.9988563817323375, 'loss_val': 0.03332110470352812, 'psi': 0.9954981493010528}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.569458 cos_to_last_merge=0.9934 (last merge round=31)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9963629590336975, 'loss_val': 0.024037757438809395, 'psi': 0.9968242373977444}-{'f1_val': 0.9967181314020974, 'auprc': 0.9987643338265081, 'loss_val': 0.025446136560047055, 'psi': 0.9975366123718616}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.108188 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9956413162194059, 'loss_val': 0.030592260531819283, 'psi': 0.9945791541180893}-{'f1_val': 0.993871046050545, 'auprc': 0.995489558547755, 'loss_val': 0.029899848056914664, 'psi': 0.9945184510494289}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.645617 cos_to_last_merge=0.9551 (last merge round=26)
[S11] round=44 local utility u=0.001892 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9973786370590638, 'loss_val': 0.03151224751055649, 'psi': 0.9966316597716112}-{'f1_val': 0.9958918378685807, 'auprc': 0.9972162489923686, 'loss_val': 0.03335719551620006, 'psi': 0.9964216023180958}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=44 head_norm_before_train=1.804513 (no previous merge yet)
[S13] round=44 local utility u=0.402270 metrics={'f1_val': 0.6712124286946171, 'auprc': 0.7170609650437746, 'loss_val': 0.8420675194769325, 'psi': 0.6895518432342801}-{'f1_val': 0.6100153975341515, 'auprc': 0.6333358551793054, 'loss_val': 1.0282506308914368, 'psi': 0.6193435805922131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=44 head_norm_before_train=1.562661 cos_to_last_merge=0.9414 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=44 local utility u=0.013514 metrics={'f1_val': 0.9970407855713329, 'auprc': 0.9987127795956126, 'loss_val': 0.031996170984095136, 'psi': 0.9977095831810447}-{'f1_val': 0.9949110635196168, 'auprc': 0.9985214849495292, 'loss_val': 0.04567152910044799, 'psi': 0.9963552320915818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=44 head_norm_before_train=1.767331 cos_to_last_merge=0.9392 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.939
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7047232480846449, 'auprc': 0.9942657912052671, 'loss_val': 0.3806975825531361, 'psi': 0.8205402653328938}-{'f1_val': 0.788234781328844, 'auprc': 0.9649068736209212, 'loss_val': 0.43186934326314536, 'psi': 0.8589036182456748}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.498540 cos_to_last_merge=0.9936 (last merge round=31)
[S16] round=44 local utility u=0.000843 metrics={'f1_val': 0.9925668486722657, 'auprc': 0.9865556368242898, 'loss_val': 0.04589177859274031, 'psi': 0.9901623639330754}-{'f1_val': 0.9921499874340187, 'auprc': 0.9868513320894032, 'loss_val': 0.0459638841685198, 'psi': 0.9900305252961725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=44 head_norm_before_train=1.664247 cos_to_last_merge=0.9818 (last merge round=31)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6553623436667022, 'auprc': 0.8712846103487193, 'loss_val': 0.9815565584881106, 'psi': 0.741731250339509}-{'f1_val': 0.6893242651496344, 'auprc': 0.8780864334407181, 'loss_val': 0.7170437323182828, 'psi': 0.7648291324660679}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.814447 cos_to_last_merge=0.8125 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.813
[S2] round=45 local utility u=0.111791 metrics={'f1_val': 0.886268555795095, 'auprc': 0.8968469582618114, 'loss_val': 0.2622320478621297, 'psi': 0.8904999167817815}-{'f1_val': 0.8248506551525135, 'auprc': 0.988679577067066, 'loss_val': 0.39280523965587144, 'psi': 0.8903822239183345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=45 head_norm_before_train=2.150534 cos_to_last_merge=0.7763 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.776
[S3] round=45 local utility u=0.282865 metrics={'f1_val': 0.8620638857415521, 'auprc': 0.9970485209300808, 'loss_val': 0.41369575070055975, 'psi': 0.9160577398169636}-{'f1_val': 0.8075812521255366, 'auprc': 0.9763623352219711, 'loss_val': 0.5904723710143621, 'psi': 0.8750936853641105}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=45 head_norm_before_train=1.545107 cos_to_last_merge=0.9952 (last merge round=31)
[S4] round=45 local utility u=0.042634 metrics={'f1_val': 0.9439106258225823, 'auprc': 0.9493427778159094, 'loss_val': 0.26909388756797525, 'psi': 0.9460834866199131}-{'f1_val': 0.9384522277773089, 'auprc': 0.9384196805760538, 'loss_val': 0.2888418341595812, 'psi': 0.9384392088968069}
[S4] not sending this round → trigger blocked (psi=0.946)
[S5] START round=45 head_norm_before_train=1.445835 cos_to_last_merge=0.9879 (last merge round=31)
[S5] round=45 local utility u=0.377082 metrics={'f1_val': 0.776781816381392, 'auprc': 0.9882370923831225, 'loss_val': 0.193434496361306, 'psi': 0.8613639267820842}-{'f1_val': 0.6949093280111207, 'auprc': 0.9511591810460824, 'loss_val': 0.34512956373541376, 'psi': 0.7974092692251054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=45 head_norm_before_train=1.478717 cos_to_last_merge=0.9910 (last merge round=33)
[S6] round=45 local utility u=0.540124 metrics={'f1_val': 0.9587846210430632, 'auprc': 0.977041741923852, 'loss_val': 0.14780118749781795, 'psi': 0.9660874693953787}-{'f1_val': 0.831467290447118, 'auprc': 0.959227520187374, 'loss_val': 0.4107032387659029, 'psi': 0.8825713823432204}
[S6] not sending this round → trigger blocked (psi=0.966)
[S7] START round=45 head_norm_before_train=1.614166 cos_to_last_merge=0.9696 (last merge round=31)
[S7] round=45 local utility u=0.067313 metrics={'f1_val': 0.5883809978707375, 'auprc': 0.7891227319636899, 'loss_val': 0.7886720266009462, 'psi': 0.6686776915079184}-{'f1_val': 0.5695242735788659, 'auprc': 0.781597661134411, 'loss_val': 0.7875825812718107, 'psi': 0.654353628601084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=45 head_norm_before_train=2.058599 (no previous merge yet)
[S8] round=45 local utility u=0.001490 metrics={'f1_val': 0.993632801855294, 'auprc': 0.9987370868687403, 'loss_val': 0.03404090889353736, 'psi': 0.9956745158606726}-{'f1_val': 0.9936178346089239, 'auprc': 0.9980991777034132, 'loss_val': 0.03501764260942323, 'psi': 0.9954103718467197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=45 head_norm_before_train=1.580191 cos_to_last_merge=0.9928 (last merge round=31)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9968814284133827, 'auprc': 0.9963095700105155, 'loss_val': 0.02466086080092821, 'psi': 0.9966526850522357}-{'f1_val': 0.9971317563071089, 'auprc': 0.9963629590336975, 'loss_val': 0.024037757438809395, 'psi': 0.9968242373977444}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.113935 (no previous merge yet)
[S10] round=45 local utility u=0.001053 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9953761569742875, 'loss_val': 0.029007304164019348, 'psi': 0.9946046580878832}-{'f1_val': 0.993871046050545, 'auprc': 0.9956413162194059, 'loss_val': 0.030592260531819283, 'psi': 0.9945791541180893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=45 head_norm_before_train=1.656491 cos_to_last_merge=0.9538 (last merge round=26)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9972053687315371, 'loss_val': 0.032613847814426215, 'psi': 0.9964172502137633}-{'f1_val': 0.9961336749133093, 'auprc': 0.9973786370590638, 'loss_val': 0.03151224751055649, 'psi': 0.9966316597716112}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.808572 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.662216247641138, 'auprc': 0.669539126533475, 'loss_val': 0.7431708979407522, 'psi': 0.6651453991980728}-{'f1_val': 0.6712124286946171, 'auprc': 0.7170609650437746, 'loss_val': 0.8420675194769325, 'psi': 0.6895518432342801}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.572701 cos_to_last_merge=0.9402 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9984891562414027, 'loss_val': 0.03383224507808036, 'psi': 0.9977085836986751}-{'f1_val': 0.9970407855713329, 'auprc': 0.9987127795956126, 'loss_val': 0.031996170984095136, 'psi': 0.9977095831810447}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.779848 cos_to_last_merge=0.9375 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.938
[S15] round=45 local utility u=1.000000 metrics={'f1_val': 0.9905411004745681, 'auprc': 0.9983037395927042, 'loss_val': 0.04427029094407097, 'psi': 0.9936461561218226}-{'f1_val': 0.7047232480846449, 'auprc': 0.9942657912052671, 'loss_val': 0.3806975825531361, 'psi': 0.8205402653328938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=45 head_norm_before_train=1.508874 cos_to_last_merge=0.9931 (last merge round=31)
[S16] round=45 local utility u=0.001831 metrics={'f1_val': 0.9919465737938408, 'auprc': 0.9904353932374942, 'loss_val': 0.0501466751065101, 'psi': 0.9913421015713022}-{'f1_val': 0.9925668486722657, 'auprc': 0.9865556368242898, 'loss_val': 0.04589177859274031, 'psi': 0.9901623639330754}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=45 head_norm_before_train=1.674579 cos_to_last_merge=0.9812 (last merge round=31)
[S17] round=45 local utility u=0.022715 metrics={'f1_val': 0.6544848626790839, 'auprc': 0.883466607067707, 'loss_val': 0.9674076023626411, 'psi': 0.7460775604345331}-{'f1_val': 0.6553623436667022, 'auprc': 0.8712846103487193, 'loss_val': 0.9815565584881106, 'psi': 0.741731250339509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S17] sending update (kind=head size=1809 to 1 peers)
[S2] START round=46 head_norm_before_train=1.823716 cos_to_last_merge=0.8113 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.811
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.8242578994519097, 'auprc': 0.9887104402250619, 'loss_val': 0.40455231207016185, 'psi': 0.8900389157611706}-{'f1_val': 0.886268555795095, 'auprc': 0.8968469582618114, 'loss_val': 0.2622320478621297, 'psi': 0.8904999167817815}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.154425 cos_to_last_merge=0.7760 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.776
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.8010236657982022, 'auprc': 0.9887740813489395, 'loss_val': 0.5923463250162715, 'psi': 0.8761238320184971}-{'f1_val': 0.8620638857415521, 'auprc': 0.9970485209300808, 'loss_val': 0.41369575070055975, 'psi': 0.9160577398169636}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.552356 cos_to_last_merge=0.9950 (last merge round=31)
[S4] round=46 local utility u=0.009926 metrics={'f1_val': 0.9458941670005256, 'auprc': 0.9529306494316797, 'loss_val': 0.27190731531818935, 'psi': 0.9487087599729872}-{'f1_val': 0.9439106258225823, 'auprc': 0.9493427778159094, 'loss_val': 0.26909388756797525, 'psi': 0.9460834866199131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=46 head_norm_before_train=1.455348 cos_to_last_merge=0.9870 (last merge round=31)
[S5] round=46 local utility u=0.696437 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.990737863752547, 'loss_val': 0.12537399617011175, 'psi': 0.9940954326791529}-{'f1_val': 0.776781816381392, 'auprc': 0.9882370923831225, 'loss_val': 0.193434496361306, 'psi': 0.8613639267820842}
[S5] not sending this round → trigger blocked (psi=0.994)
[S6] START round=46 head_norm_before_train=1.490147 cos_to_last_merge=0.9896 (last merge round=33)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7869896519562809, 'auprc': 0.8093735184913179, 'loss_val': 0.535263575910191, 'psi': 0.7959431985702957}-{'f1_val': 0.9587846210430632, 'auprc': 0.977041741923852, 'loss_val': 0.14780118749781795, 'psi': 0.9660874693953787}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.634246 cos_to_last_merge=0.9671 (last merge round=31)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.5471596903803144, 'auprc': 0.783648224529331, 'loss_val': 0.7407592121501583, 'psi': 0.6417551040399211}-{'f1_val': 0.5883809978707375, 'auprc': 0.7891227319636899, 'loss_val': 0.7886720266009462, 'psi': 0.6686776915079184}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=2.058975 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.998685554714081, 'loss_val': 0.03418061957386966, 'psi': 0.9956494241543303}-{'f1_val': 0.993632801855294, 'auprc': 0.9987370868687403, 'loss_val': 0.03404090889353736, 'psi': 0.9956745158606726}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.591336 cos_to_last_merge=0.9922 (last merge round=31)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.996721335281205, 'auprc': 0.9949967629375254, 'loss_val': 0.02334578502382686, 'psi': 0.996031506343733}-{'f1_val': 0.9968814284133827, 'auprc': 0.9963095700105155, 'loss_val': 0.02466086080092821, 'psi': 0.9966526850522357}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.118835 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.995602488030835, 'loss_val': 0.029468180726782547, 'psi': 0.994563622842661}-{'f1_val': 0.9940903254969471, 'auprc': 0.9953761569742875, 'loss_val': 0.029007304164019348, 'psi': 0.9946046580878832}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.667384 cos_to_last_merge=0.9525 (last merge round=26)
[S11] round=46 local utility u=0.000163 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9971226796901514, 'loss_val': 0.032040108060156926, 'psi': 0.9963841745972091}-{'f1_val': 0.9958918378685807, 'auprc': 0.9972053687315371, 'loss_val': 0.032613847814426215, 'psi': 0.9964172502137633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=46 head_norm_before_train=1.812556 (no previous merge yet)
[S13] round=46 local utility u=0.053504 metrics={'f1_val': 0.6635118583947225, 'auprc': 0.7446405080385144, 'loss_val': 0.8692402067858971, 'psi': 0.6959633182522393}-{'f1_val': 0.662216247641138, 'auprc': 0.669539126533475, 'loss_val': 0.7431708979407522, 'psi': 0.6651453991980728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=46 head_norm_before_train=1.583380 cos_to_last_merge=0.9390 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.939
[S14] round=46 local utility u=0.002908 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9988679750785581, 'loss_val': 0.030609960934232808, 'psi': 0.9980058203358009}-{'f1_val': 0.9971882020035234, 'auprc': 0.9984891562414027, 'loss_val': 0.03383224507808036, 'psi': 0.9977085836986751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=46 head_norm_before_train=1.792722 cos_to_last_merge=0.9359 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.936
[S15] round=46 local utility u=0.002268 metrics={'f1_val': 0.9912705198893618, 'auprc': 0.998595919638771, 'loss_val': 0.044987411646853034, 'psi': 0.9942006797891255}-{'f1_val': 0.9905411004745681, 'auprc': 0.9983037395927042, 'loss_val': 0.04427029094407097, 'psi': 0.9936461561218226}
[S15] not sending this round → trigger blocked (psi=0.994)
[S16] START round=46 head_norm_before_train=1.519043 cos_to_last_merge=0.9925 (last merge round=31)
[S16] round=46 local utility u=0.003307 metrics={'f1_val': 0.991028065129781, 'auprc': 0.9935886267862756, 'loss_val': 0.047480938895134044, 'psi': 0.9920522897923788}-{'f1_val': 0.9919465737938408, 'auprc': 0.9904353932374942, 'loss_val': 0.0501466751065101, 'psi': 0.9913421015713022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=46 head_norm_before_train=1.686591 cos_to_last_merge=0.9806 (last merge round=31)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6641622141816392, 'auprc': 0.8722889425531625, 'loss_val': 1.0187966035635525, 'psi': 0.7474129055302485}-{'f1_val': 0.6544848626790839, 'auprc': 0.883466607067707, 'loss_val': 0.9674076023626411, 'psi': 0.7460775604345331}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.828375 cos_to_last_merge=0.8106 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.811
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.8306565812318158, 'auprc': 0.9357931057893956, 'loss_val': 0.30328907783772274, 'psi': 0.8727111910548477}-{'f1_val': 0.8242578994519097, 'auprc': 0.9887104402250619, 'loss_val': 0.40455231207016185, 'psi': 0.8900389157611706}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.158971 cos_to_last_merge=0.7756 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.776
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.6900157464516015, 'auprc': 0.9504456871373539, 'loss_val': 1.0237515428236288, 'psi': 0.7941877227259024}-{'f1_val': 0.8010236657982022, 'auprc': 0.9887740813489395, 'loss_val': 0.5923463250162715, 'psi': 0.8761238320184971}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.558459 cos_to_last_merge=0.9948 (last merge round=31)
[S4] round=47 local utility u=0.002960 metrics={'f1_val': 0.9474338884386309, 'auprc': 0.9525233011826459, 'loss_val': 0.2740030323901481, 'psi': 0.9494696535362368}-{'f1_val': 0.9458941670005256, 'auprc': 0.9529306494316797, 'loss_val': 0.27190731531818935, 'psi': 0.9487087599729872}
[S4] not sending this round → trigger blocked (psi=0.949)
[S5] START round=47 head_norm_before_train=1.465410 cos_to_last_merge=0.9859 (last merge round=31)
[S5] round=47 local utility u=0.001336 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.990738501107823, 'loss_val': 0.12270322625779592, 'psi': 0.9940956876212632}-{'f1_val': 0.9963338119635569, 'auprc': 0.990737863752547, 'loss_val': 0.12537399617011175, 'psi': 0.9940954326791529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=47 head_norm_before_train=1.499288 cos_to_last_merge=0.9882 (last merge round=33)
[S6] round=47 local utility u=0.398588 metrics={'f1_val': 0.8280943718520986, 'auprc': 0.9506815115565075, 'loss_val': 0.40864021326755956, 'psi': 0.8771292277338621}-{'f1_val': 0.7869896519562809, 'auprc': 0.8093735184913179, 'loss_val': 0.535263575910191, 'psi': 0.7959431985702957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=47 head_norm_before_train=1.647693 cos_to_last_merge=0.9664 (last merge round=31)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5337161530199934, 'auprc': 0.7841214102587486, 'loss_val': 0.7759444586935137, 'psi': 0.6338782559154955}-{'f1_val': 0.5471596903803144, 'auprc': 0.783648224529331, 'loss_val': 0.7407592121501583, 'psi': 0.6417551040399211}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.061900 (no previous merge yet)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9928679610072813, 'auprc': 0.998224446997924, 'loss_val': 0.037980153144583195, 'psi': 0.9950105554035383}-{'f1_val': 0.9936253371144965, 'auprc': 0.998685554714081, 'loss_val': 0.03418061957386966, 'psi': 0.9956494241543303}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.603147 cos_to_last_merge=0.9916 (last merge round=31)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.992714837543047, 'auprc': 0.9987407230334522, 'loss_val': 0.031195235580662485, 'psi': 0.9951251917392091}-{'f1_val': 0.996721335281205, 'auprc': 0.9949967629375254, 'loss_val': 0.02334578502382686, 'psi': 0.996031506343733}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.122413 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9955702950455184, 'loss_val': 0.02980862170803875, 'psi': 0.9945507456485343}-{'f1_val': 0.993871046050545, 'auprc': 0.995602488030835, 'loss_val': 0.029468180726782547, 'psi': 0.994563622842661}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.676677 cos_to_last_merge=0.9511 (last merge round=26)
[S11] round=47 local utility u=0.000818 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9972002362661888, 'loss_val': 0.032087621592015385, 'psi': 0.9965602994544611}-{'f1_val': 0.9958918378685807, 'auprc': 0.9971226796901514, 'loss_val': 0.032040108060156926, 'psi': 0.9963841745972091}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=47 head_norm_before_train=1.815871 (no previous merge yet)
[S13] round=47 local utility u=0.098303 metrics={'f1_val': 0.6684172762781393, 'auprc': 0.7344809127927334, 'loss_val': 0.6715876921354266, 'psi': 0.694842730883977}-{'f1_val': 0.6635118583947225, 'auprc': 0.7446405080385144, 'loss_val': 0.8692402067858971, 'psi': 0.6959633182522393}
[S13] not sending this round → trigger blocked (psi=0.695)
[S14] START round=47 head_norm_before_train=1.591179 cos_to_last_merge=0.9381 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.938
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9870982339345652, 'auprc': 0.9984704444089051, 'loss_val': 0.049869565131051674, 'psi': 0.9916471181243012}-{'f1_val': 0.9974310505072961, 'auprc': 0.9988679750785581, 'loss_val': 0.030609960934232808, 'psi': 0.9980058203358009}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.805278 cos_to_last_merge=0.9345 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.8333021297853949, 'auprc': 0.9967712850290856, 'loss_val': 0.25477314628022873, 'psi': 0.8986897918828711}-{'f1_val': 0.9912705198893618, 'auprc': 0.998595919638771, 'loss_val': 0.044987411646853034, 'psi': 0.9942006797891255}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.527548 cos_to_last_merge=0.9920 (last merge round=31)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.8468694214395579, 'auprc': 0.9536555496435735, 'loss_val': 1.0211316259261505, 'psi': 0.889583872721164}-{'f1_val': 0.991028065129781, 'auprc': 0.9935886267862756, 'loss_val': 0.047480938895134044, 'psi': 0.9920522897923788}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.699356 cos_to_last_merge=0.9799 (last merge round=31)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6545705070460225, 'auprc': 0.8770125589415559, 'loss_val': 1.076127038916653, 'psi': 0.7435473278042359}-{'f1_val': 0.6641622141816392, 'auprc': 0.8722889425531625, 'loss_val': 1.0187966035635525, 'psi': 0.7474129055302485}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.830959 cos_to_last_merge=0.8099 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.810
[S2] round=48 local utility u=0.031805 metrics={'f1_val': 0.8267801214126818, 'auprc': 0.9907724254207564, 'loss_val': 0.38135903279610855, 'psi': 0.8923770430159116}-{'f1_val': 0.8306565812318158, 'auprc': 0.9357931057893956, 'loss_val': 0.30328907783772274, 'psi': 0.8727111910548477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=48 head_norm_before_train=2.166712 cos_to_last_merge=0.7749 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.775
[S3] round=48 local utility u=1.000000 metrics={'f1_val': 0.9836467296990142, 'auprc': 0.9994280362658244, 'loss_val': 0.04494286387542792, 'psi': 0.9899592523257383}-{'f1_val': 0.6900157464516015, 'auprc': 0.9504456871373539, 'loss_val': 1.0237515428236288, 'psi': 0.7941877227259024}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=48 head_norm_before_train=1.562776 cos_to_last_merge=0.9946 (last merge round=31)
[S4] round=48 local utility u=0.004267 metrics={'f1_val': 0.952002752941395, 'auprc': 0.9471881463554359, 'loss_val': 0.27687669165344486, 'psi': 0.9500769103070114}-{'f1_val': 0.9474338884386309, 'auprc': 0.9525233011826459, 'loss_val': 0.2740030323901481, 'psi': 0.9494696535362368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=48 head_norm_before_train=1.479981 cos_to_last_merge=0.9843 (last merge round=31)
[S5] round=48 local utility u=0.023117 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9945448709648536, 'loss_val': 0.09009646942012602, 'psi': 0.995839129473016}-{'f1_val': 0.9963338119635569, 'auprc': 0.990738501107823, 'loss_val': 0.12270322625779592, 'psi': 0.9940956876212632}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=48 head_norm_before_train=1.507773 cos_to_last_merge=0.9870 (last merge round=33)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.768556944476577, 'auprc': 0.9363425254329454, 'loss_val': 0.5673682311697666, 'psi': 0.8356711768591243}-{'f1_val': 0.8280943718520986, 'auprc': 0.9506815115565075, 'loss_val': 0.40864021326755956, 'psi': 0.8771292277338621}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.656794 cos_to_last_merge=0.9653 (last merge round=31)
[S7] round=48 local utility u=0.041473 metrics={'f1_val': 0.5677089986447432, 'auprc': 0.7869778061831687, 'loss_val': 0.9055247916491341, 'psi': 0.6554165216601134}-{'f1_val': 0.5337161530199934, 'auprc': 0.7841214102587486, 'loss_val': 0.7759444586935137, 'psi': 0.6338782559154955}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=48 head_norm_before_train=2.067716 (no previous merge yet)
[S8] round=48 local utility u=0.006307 metrics={'f1_val': 0.9937709050739206, 'auprc': 0.998778207940771, 'loss_val': 0.032445904532779804, 'psi': 0.9957738262206608}-{'f1_val': 0.9928679610072813, 'auprc': 0.998224446997924, 'loss_val': 0.037980153144583195, 'psi': 0.9950105554035383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=48 head_norm_before_train=1.615574 cos_to_last_merge=0.9910 (last merge round=31)
[S9] round=48 local utility u=0.011366 metrics={'f1_val': 0.996721335281205, 'auprc': 0.9952693049225935, 'loss_val': 0.022087408873389933, 'psi': 0.9961405231377604}-{'f1_val': 0.992714837543047, 'auprc': 0.9987407230334522, 'loss_val': 0.031195235580662485, 'psi': 0.9951251917392091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=48 head_norm_before_train=2.127983 (no previous merge yet)
[S10] round=48 local utility u=0.000370 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9954469849109705, 'loss_val': 0.028698155561070804, 'psi': 0.9945014215947152}-{'f1_val': 0.993871046050545, 'auprc': 0.9955702950455184, 'loss_val': 0.02980862170803875, 'psi': 0.9945507456485343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=48 head_norm_before_train=1.683630 cos_to_last_merge=0.9502 (last merge round=26)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9971814150987326, 'loss_val': 0.03189340063873618, 'psi': 0.9964076687606415}-{'f1_val': 0.9961336749133093, 'auprc': 0.9972002362661888, 'loss_val': 0.032087621592015385, 'psi': 0.9965602994544611}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.820060 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6533011946759149, 'auprc': 0.7036238442350928, 'loss_val': 0.8526611338255637, 'psi': 0.673430254499586}-{'f1_val': 0.6684172762781393, 'auprc': 0.7344809127927334, 'loss_val': 0.6715876921354266, 'psi': 0.694842730883977}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.600805 cos_to_last_merge=0.9370 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.937
[S14] round=48 local utility u=0.040678 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.998666755552202, 'loss_val': 0.028497376716957852, 'psi': 0.9976652071154799}-{'f1_val': 0.9870982339345652, 'auprc': 0.9984704444089051, 'loss_val': 0.049869565131051674, 'psi': 0.9916471181243012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=48 head_norm_before_train=1.816867 cos_to_last_merge=0.9331 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.7751032395968034, 'auprc': 0.9955608555506744, 'loss_val': 0.4161613557765452, 'psi': 0.8632862859783519}-{'f1_val': 0.8333021297853949, 'auprc': 0.9967712850290856, 'loss_val': 0.25477314628022873, 'psi': 0.8986897918828711}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.536262 cos_to_last_merge=0.9915 (last merge round=31)
[S16] round=48 local utility u=0.971034 metrics={'f1_val': 0.99257769258791, 'auprc': 0.9865168878077234, 'loss_val': 0.05189756207194477, 'psi': 0.9901533706758353}-{'f1_val': 0.8468694214395579, 'auprc': 0.9536555496435735, 'loss_val': 1.0211316259261505, 'psi': 0.889583872721164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=48 head_norm_before_train=1.708038 cos_to_last_merge=0.9794 (last merge round=31)
[S17] round=48 local utility u=0.218451 metrics={'f1_val': 0.6650485305462306, 'auprc': 0.9113507090174506, 'loss_val': 0.8051081361637252, 'psi': 0.7635694019347186}-{'f1_val': 0.6545705070460225, 'auprc': 0.8770125589415559, 'loss_val': 1.076127038916653, 'psi': 0.7435473278042359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=49 head_norm_before_train=1.834147 cos_to_last_merge=0.8091 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.809
[S2] round=49 local utility u=0.021027 metrics={'f1_val': 0.8293041273281317, 'auprc': 0.989671584337762, 'loss_val': 0.35114628025566624, 'psi': 0.8934511101319839}-{'f1_val': 0.8267801214126818, 'auprc': 0.9907724254207564, 'loss_val': 0.38135903279610855, 'psi': 0.8923770430159116}
[S2] not sending this round → trigger blocked (psi=0.893)
[S3] START round=49 head_norm_before_train=2.174867 cos_to_last_merge=0.7742 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.774
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9710802692419721, 'auprc': 0.9976944681236264, 'loss_val': 0.079576883462635, 'psi': 0.9817259487946339}-{'f1_val': 0.9836467296990142, 'auprc': 0.9994280362658244, 'loss_val': 0.04494286387542792, 'psi': 0.9899592523257383}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.566526 cos_to_last_merge=0.9944 (last merge round=31)
[S4] round=49 local utility u=0.019392 metrics={'f1_val': 0.948809879210248, 'auprc': 0.9630287751235733, 'loss_val': 0.26645734374829505, 'psi': 0.954497437575578}-{'f1_val': 0.952002752941395, 'auprc': 0.9471881463554359, 'loss_val': 0.27687669165344486, 'psi': 0.9500769103070114}
[S4] not sending this round → trigger blocked (psi=0.954)
[S5] START round=49 head_norm_before_train=1.493189 cos_to_last_merge=0.9825 (last merge round=31)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9910262201633673, 'loss_val': 0.09641007714312327, 'psi': 0.994210775243481}-{'f1_val': 0.9967019684784577, 'auprc': 0.9945448709648536, 'loss_val': 0.09009646942012602, 'psi': 0.995839129473016}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.518785 cos_to_last_merge=0.9859 (last merge round=33)
[S6] round=49 local utility u=0.914574 metrics={'f1_val': 0.9806711250133916, 'auprc': 0.9719299222216979, 'loss_val': 0.11766781644008094, 'psi': 0.9771746438967142}-{'f1_val': 0.768556944476577, 'auprc': 0.9363425254329454, 'loss_val': 0.5673682311697666, 'psi': 0.8356711768591243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=49 head_norm_before_train=1.672630 cos_to_last_merge=0.9632 (last merge round=31)
[S7] round=49 local utility u=0.502149 metrics={'f1_val': 0.6611361605045868, 'auprc': 0.8055860512828306, 'loss_val': 0.517615072028396, 'psi': 0.7189161168158843}-{'f1_val': 0.5677089986447432, 'auprc': 0.7869778061831687, 'loss_val': 0.9055247916491341, 'psi': 0.6554165216601134}
[S7] not sending this round → trigger blocked (psi=0.719)
[S8] START round=49 head_norm_before_train=2.075744 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9928679610072813, 'auprc': 0.9984570935955489, 'loss_val': 0.036654528719933056, 'psi': 0.9951036140425883}-{'f1_val': 0.9937709050739206, 'auprc': 0.998778207940771, 'loss_val': 0.032445904532779804, 'psi': 0.9957738262206608}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.625120 cos_to_last_merge=0.9904 (last merge round=31)
[S9] round=49 local utility u=0.000278 metrics={'f1_val': 0.9964678035083712, 'auprc': 0.996395126353651, 'loss_val': 0.023387867996642654, 'psi': 0.9964387326464831}-{'f1_val': 0.996721335281205, 'auprc': 0.9952693049225935, 'loss_val': 0.022087408873389933, 'psi': 0.9961405231377604}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=49 head_norm_before_train=2.134418 (no previous merge yet)
[S10] round=49 local utility u=0.000379 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9956513986298037, 'loss_val': 0.02855312880033054, 'psi': 0.9945831870822485}-{'f1_val': 0.993871046050545, 'auprc': 0.9954469849109705, 'loss_val': 0.028698155561070804, 'psi': 0.9945014215947152}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=49 head_norm_before_train=1.690951 cos_to_last_merge=0.9492 (last merge round=26)
[S11] ⚠️ Model drifted since last merge! cos=0.949
[S11] round=49 local utility u=0.001014 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.997360076171895, 'loss_val': 0.03185327785545778, 'psi': 0.9966242354167436}-{'f1_val': 0.9958918378685807, 'auprc': 0.9971814150987326, 'loss_val': 0.03189340063873618, 'psi': 0.9964076687606415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=49 head_norm_before_train=1.827249 (no previous merge yet)
[S13] round=49 local utility u=0.007058 metrics={'f1_val': 0.6560731233914976, 'auprc': 0.6971666090120024, 'loss_val': 0.8358055488368606, 'psi': 0.6725105176396995}-{'f1_val': 0.6533011946759149, 'auprc': 0.7036238442350928, 'loss_val': 0.8526611338255637, 'psi': 0.673430254499586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1813 reason=None
[S13] sending update (kind=head size=1813 to 1 peers)
[S14] START round=49 head_norm_before_train=1.611112 cos_to_last_merge=0.9359 (last merge round=26)
[S14] ⚠️ Model drifted since last merge! cos=0.936
[S14] round=49 local utility u=0.000971 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9988737345681777, 'loss_val': 0.027043956731255578, 'psi': 0.9977347938775369}-{'f1_val': 0.9969975081576651, 'auprc': 0.998666755552202, 'loss_val': 0.028497376716957852, 'psi': 0.9976652071154799}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=49 head_norm_before_train=1.828745 cos_to_last_merge=0.9317 (last merge round=31)
[S15] ⚠️ Model drifted since last merge! cos=0.932
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.7637552273445312, 'auprc': 0.9605388384681932, 'loss_val': 0.5029824069967895, 'psi': 0.842468671793996}-{'f1_val': 0.7751032395968034, 'auprc': 0.9955608555506744, 'loss_val': 0.4161613557765452, 'psi': 0.8632862859783519}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.543944 cos_to_last_merge=0.9909 (last merge round=31)
[S16] round=49 local utility u=0.012112 metrics={'f1_val': 0.9923583176762151, 'auprc': 0.9923588752330714, 'loss_val': 0.04388365986651422, 'psi': 0.9923585406989576}-{'f1_val': 0.99257769258791, 'auprc': 0.9865168878077234, 'loss_val': 0.05189756207194477, 'psi': 0.9901533706758353}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=49 head_norm_before_train=1.717723 cos_to_last_merge=0.9788 (last merge round=31)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6347219102734338, 'auprc': 0.908539250883685, 'loss_val': 0.8923330320844037, 'psi': 0.7442488465175343}-{'f1_val': 0.6650485305462306, 'auprc': 0.9113507090174506, 'loss_val': 0.8051081361637252, 'psi': 0.7635694019347186}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
