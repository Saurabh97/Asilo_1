[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:63503
[S3] → join 127.0.0.1:63502
[S4] → join 127.0.0.1:63502
[S5] → join 127.0.0.1:63502
[S6] → join 127.0.0.1:63502
[S7] → join 127.0.0.1:63502
[S8] → join 127.0.0.1:63502
[S9] → join 127.0.0.1:63502
[S10] → join 127.0.0.1:63502
[S11] → join 127.0.0.1:63502
[S13] → join 127.0.0.1:63502
[S14] → join 127.0.0.1:63502
[S15] → join 127.0.0.1:63502
[S16] → join 127.0.0.1:63502
[S17] → join 127.0.0.1:63502
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.082009 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.181919 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.152378 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.179463 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.146413 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.171044 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.144091 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.166308 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.157828 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.108738 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.164592 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.145159 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.135773 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.191316 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.150460 (no previous merge yet)
[S10]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3] + discovered S16
[S3] + discovered S5
[S3] + discovered S7
[S3] + discovered S4
[S3] + discovered S15
[S4] + discovered S3
[S3] + discovered S9
[S3] + discovered S6
[S3] + discovered S13
[S3] + discovered S8
[S3] + discovered S11
[S3] + discovered S14
[S3] + discovered S17
[S3] + discovered S10
[S4] + discovered S2
[S4] + discovered S6
[S4] + discovered S13
[S4] + discovered S10
[S4] + discovered S7
[S4] + discovered S14
[S4] + discovered S5
[S4] + discovered S11
[S4] + discovered S8
[S4] + discovered S9
[S5] + discovered S4
[S4] + discovered S17
[S4] + discovered S16
[S5] + discovered S2
[S4] + discovered S15
[S5] + discovered S3
[S5] + discovered S8
[S5] + discovered S7
[S6] + discovered S5
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S4
[S5] + discovered S6
[S5] + discovered S16
[S5] + discovered S14
[S5] + discovered S13
[S5] + discovered S11
[S5] + discovered S9
[S5] + discovered S10
[S5] + discovered S17
[S5] + discovered S15
[S6] + discovered S9
[S6] + discovered S7
[S6] + discovered S17
[S7] + discovered S6
[S6] + discovered S14
[S6] + discovered S15
[S7] + discovered S2
[S7] + discovered S5
[S6] + discovered S13
[S6] + discovered S8
[S7] + discovered S3
[S6] + discovered S16
[S6] + discovered S10
[S7] + discovered S4
[S6] + discovered S11
[S8] + discovered S7
[S8] + discovered S4
[S7] + discovered S13
[S7] + discovered S14
[S8] + discovered S2
[S7] + discovered S9
[S7] + discovered S10
[S7] + discovered S15
[S7] + discovered S8
[S8] + discovered S3
[S7] + discovered S16
[S7] + discovered S17
[S7] + discovered S11
[S8] + discovered S6
[S8] + discovered S5
[S8] + discovered S10
[S8] + discovered S11
[S8] + discovered S17
[S9] + discovered S6
[S8] + discovered S14
[S8] + discovered S16
[S9] + discovered S8
[S9] + discovered S5
[S9] + discovered S4
[S8] + discovered S13
[S8] + discovered S9
[S9] + discovered S7
[S9] + discovered S2
[S9] + discovered S3
[S8] + discovered S15
[S9] + discovered S17
[S9] + discovered S15
[S9] + discovered S14
[S9] + discovered S13
[S10] + discovered S2
[S9] + discovered S10
[S9] + discovered S11
[S10] + discovered S3
[S10] + discovered S5
[S10] + discovered S4
[S10] + discovered S9
[S10] + discovered S8
[S10] + discovered S7
[S10] + discovered S6
[S9] + discovered S16
[S10] + discovered S15
[S10] + discovered S13
[S11] + discovered S9
[S11] + discovered S5
[S11] + discovered S3
[S10] + discovered S17
[S10] + discovered S14
[S10] + discovered S16
[S10] + discovered S11
[S11] + discovered S6
[S11] + discovered S7
[S11] + discovered S4
[S11] + discovered S10
[S11] + discovered S8
[S11] + discovered S2
[S13] + discovered S7
[S13] + discovered S2
[S11] + discovered S17
[S13] + discovered S8
[S11] + discovered S13
[S11] + discovered S14
[S11] + discovered S16
[S11] + discovered S15
[S13] + discovered S6
[S13] + discovered S3
[S13] + discovered S9
[S13] + discovered S11
[S13] + discovered S4
[S13] + discovered S10
[S13] + discovered S5
[S14] + discovered S7
[S13] + discovered S15
[S14] + discovered S9
[S13] + discovered S14
[S14] + discovered S3
[S13] + discovered S17
[S14] + discovered S8
[S13] + discovered S16
[S14] + discovered S10
[S14] + discovered S4
[S14] + discovered S5
[S14] + discovered S2
[S14] + discovered S6
[S14] + discovered S11
[S14] + discovered S13
[S14] + discovered S17
[S15] + discovered S10
[S15] + discovered S14
[S15] + discovered S7
[S15] + discovered S2
[S15] + discovered S5
[S14] + discovered S16
[S15] + discovered S11
[S15] + discovered S8
[S14] + discovered S15
[S15] + discovered S4
[S15] + discovered S3
[S15] + discovered S6
[S15] + discovered S13
[S15] + discovered S9
[S16] + discovered S6
[S16] + discovered S13
[S16] + discovered S2
[S16] + discovered S7
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S11
[S16] + discovered S3
[S16] + discovered S4
[S16] + discovered S15
[S16] + discovered S5
[S16] + discovered S8
[S16] + discovered S10
[S16] + discovered S9
[S16] + discovered S14
[S17] + discovered S15
[S17] + discovered S5
[S17] + discovered S10
[S17] + discovered S4
[S17] + discovered S8
[S17] + discovered S3
[S17] + discovered S9
[S17] + discovered S16
[S17] + discovered S6
[S17] + discovered S2
[S17] + discovered S7
[S17] + discovered S11
[S17] + discovered S14
[S16] + discovered S17
[S17] + discovered S13
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=1.000 → S16@127.0.0.1:63516
[S11] ⇄ pheromone p=1.000 → S5@127.0.0.1:63505
[S15] ⇄ pheromone p=1.000 → S4@127.0.0.1:63504
[S13] ⇄ pheromone p=1.000 → S8@127.0.0.1:63509
[S5] ⇄ pheromone p=1.000 → S15@127.0.0.1:63515
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:63516
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:63517
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:63508
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:63507
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:63515
[S2] ⇄ pheromone p=1.000 → S14@127.0.0.1:63514
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:63509
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:63515
[S10] ⇄ pheromone p=1.000 → S17@127.0.0.1:63517
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:63513
[S2] START round=1 head_norm_before_train=1.086198 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7829562564632218, 'loss_val': 1.3108465867624532, 'psi': 0.3982487826184288}-{'f1_val': 0.261887893223976, 'auprc': 0.689116742328997, 'loss_val': 1.3487332979010127, 'psi': 0.4327794328659844}
[S3] START round=1 head_norm_before_train=1.183409 (no previous merge yet)
[S3] round=1 local utility u=0.294925 metrics={'f1_val': 0.08969866853538892, 'auprc': 0.8654038890404248, 'loss_val': 1.3442643056764891, 'psi': 0.39998075673740324}-{'f1_val': 0.08969866853538892, 'auprc': 0.6802530164705709, 'loss_val': 1.3786625929171963, 'psi': 0.32592040770946173}
[S4] START round=1 head_norm_before_train=1.154433 (no previous merge yet)
[S4] round=1 local utility u=0.507347 metrics={'f1_val': 0.47920986811012306, 'auprc': 0.695284421211246, 'loss_val': 1.333519686433389, 'psi': 0.5656396893505722}-{'f1_val': 0.3738131173853739, 'auprc': 0.5811341673945642, 'loss_val': 1.3733829767439598, 'psi': 0.4567415373890501}
[S5] START round=1 head_norm_before_train=1.181197 (no previous merge yet)
[S5] round=1 local utility u=0.381682 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7685223320894392, 'loss_val': 1.312387178194617, 'psi': 0.39276607569291855}-{'f1_val': 0.14226190476190476, 'auprc': 0.5247459006280223, 'loss_val': 1.3444222657041105, 'psi': 0.2952555031083518}
[S6] START round=1 head_norm_before_train=1.145236 (no previous merge yet)
[S6] round=1 local utility u=0.253766 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6400582226460754, 'loss_val': 1.3214111003254478, 'psi': 0.34087905828919934}-{'f1_val': 0.14142628205128205, 'auprc': 0.48340007669905877, 'loss_val': 1.35896786164406, 'psi': 0.27821579991039275}
[S7] START round=1 head_norm_before_train=1.180660 (no previous merge yet)
[S7] round=1 local utility u=0.315723 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7919356860434024, 'loss_val': 1.3227073649449435, 'psi': 0.40200836805481593}-{'f1_val': 0.14205682272909165, 'auprc': 0.5906226264737517, 'loss_val': 1.3502143276227336, 'psi': 0.3214831442269557}
[S8] START round=1 head_norm_before_train=1.145153 (no previous merge yet)
[S8] round=1 local utility u=0.335085 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.44934646349974006, 'loss_val': 1.3376895876532326, 'psi': 0.26371217483567033}-{'f1_val': 0.10450549450549451, 'auprc': 0.30854258066278717, 'loss_val': 1.3727456791952783, 'psi': 0.18612032896841157}
[S9] START round=1 head_norm_before_train=1.166083 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7834326066165791, 'loss_val': 1.3087848851126795, 'psi': 0.3982118169306293}-{'f1_val': 0.16122402374971453, 'auprc': 0.7734745307757933, 'loss_val': 1.3547864705408998, 'psi': 0.4061242265601461}
[S10] START round=1 head_norm_before_train=1.164261 (no previous merge yet)
[S10] round=1 local utility u=0.042933 metrics={'f1_val': 0.4162385227504591, 'auprc': 0.8229992999134947, 'loss_val': 1.3194108331005556, 'psi': 0.5789428336156733}-{'f1_val': 0.41658224582082864, 'auprc': 0.8035312444109919, 'loss_val': 1.3489346875350265, 'psi': 0.5713618452568939}
[S11] START round=1 head_norm_before_train=1.101652 (no previous merge yet)
[S11] round=1 local utility u=0.821967 metrics={'f1_val': 0.2652661228478626, 'auprc': 0.5579524484140637, 'loss_val': 1.3628259473048263, 'psi': 0.38234065307434306}-{'f1_val': 0.054460325283390836, 'auprc': 0.4418146560860094, 'loss_val': 1.3935117161373871, 'psi': 0.20940205760443828}
[S13] START round=1 head_norm_before_train=1.164726 (no previous merge yet)
[S13] round=1 local utility u=0.292441 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5707598034242234, 'loss_val': 1.3257631880091751, 'psi': 0.3125353789159212}-{'f1_val': 0.09037372593431484, 'auprc': 0.48930187910919287, 'loss_val': 1.3662000943006307, 'psi': 0.24994498720426606}
[S14] START round=1 head_norm_before_train=1.144508 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.25541001418525333, 'auprc': 0.670178291836759, 'loss_val': 1.3577735010085001, 'psi': 0.42131732524585563}-{'f1_val': 0.2615474206744515, 'auprc': 0.721841672039721, 'loss_val': 1.3832976282802403, 'psi': 0.44566512122055935}
[S15] START round=1 head_norm_before_train=1.147189 (no previous merge yet)
[S15] round=1 local utility u=0.123027 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7456152630202583, 'loss_val': 1.3210459841245608, 'psi': 0.3820862960250383}-{'f1_val': 0.13973365136155833, 'auprc': 0.6732023293820544, 'loss_val': 1.34986185144567, 'psi': 0.35312112256975675}
[S16] START round=1 head_norm_before_train=1.201456 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.4128285032050827, 'auprc': 0.8376919929548263, 'loss_val': 1.3247970426216886, 'psi': 0.5827738991049802}-{'f1_val': 0.41587088522183485, 'auprc': 0.9080948307005049, 'loss_val': 1.3557179881562966, 'psi': 0.6127604634133028}
[S17] START round=1 head_norm_before_train=1.149290 (no previous merge yet)
[S17] round=1 local utility u=0.230448 metrics={'f1_val': 0.14520435407681248, 'auprc': 0.5082801169280872, 'loss_val': 1.3506421447573052, 'psi': 0.29043465921732237}-{'f1_val': 0.09754189944134078, 'auprc': 0.45990061929965964, 'loss_val': 1.3804251646527257, 'psi': 0.24248538738466832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S5] → sending delta(kind=head bytes=1786) to S9@127.0.0.1:63510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:63513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:63512
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:63503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:63502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:63514
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:63511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1778 reason=None
[S3] → sending delta(kind=head bytes=1778) to S5@127.0.0.1:63505
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1778 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1786 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1778) from S3
[S5] cosine check vs S3: cos=-0.0641
[S5] DROPPED delta from S3 (cos=-0.0641 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1790) from S7
[S2] cosine check vs S7: cos=0.0780
[S14] RECEIVED delta(kind=head bytes=1790) from S13
[S14] cosine check vs S13: cos=-0.0568
[S14] DROPPED delta from S13 (cos=-0.0568 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1796) from S6
[S13] cosine check vs S6: cos=-0.0430
[S13] DROPPED delta from S6 (cos=-0.0430 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1790) from S8
[S10] cosine check vs S8: cos=-0.0702
[S10] DROPPED delta from S8 (cos=-0.0702 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S11
[S17] cosine check vs S11: cos=0.0153
[S3] RECEIVED delta(kind=head bytes=1792) from S4
[S3] cosine check vs S4: cos=0.0299
[S11] RECEIVED delta(kind=head bytes=1792) from S15
[S11] cosine check vs S15: cos=0.0097
[S9] RECEIVED delta(kind=head bytes=1786) from S5
[S9] cosine check vs S5: cos=-0.1383
[S9] DROPPED delta from S5 (cos=-0.1383 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=-0.0323
[S14] DROPPED delta from S10 (cos=-0.0323 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:63504
[S17] sending update (kind=head size=1791 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1791) from S17
[S4] cosine check vs S17: cos=-0.0119
[S4] DROPPED delta from S17 (cos=-0.0119 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.100273
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.799448e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.843106 delta_norm=0.779945
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.2653 head_norm=1.108452
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.008395e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.3147 head_norm=0.808645 delta_norm=0.800839
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=1 metric=0.0897 head_norm=1.195570
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.243636e-01
[S3] stored merged vector for next round verification (round=1)
[S3] DEBUG after merge:  round=1 metric=0.1117 head_norm=0.849405 delta_norm=0.824364
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1452 head_norm=1.157477
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.951541e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.3296 head_norm=0.807428 delta_norm=0.795154
[S17] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.843106 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.159056 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.8843218762249128, 'loss_val': 1.2968317865398251, 'psi': 0.43879503052310515}-{'f1_val': 0.1417771333885667, 'auprc': 0.7829562564632218, 'loss_val': 1.3108465867624532, 'psi': 0.3982487826184288}
[S3] START round=2 head_norm_before_train=0.849405 cos_to_last_merge=1.0000 (last merge round=1)
[S3] round=2 local utility u=0.968383 metrics={'f1_val': 0.3916107768504741, 'auprc': 0.9055077553020262, 'loss_val': 1.339282163539034, 'psi': 0.5971695682310949}-{'f1_val': 0.08969866853538892, 'auprc': 0.8654038890404248, 'loss_val': 1.3442643056764891, 'psi': 0.39998075673740324}
[S4] START round=2 head_norm_before_train=1.171640 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.41237070505136264, 'auprc': 0.7809969771490672, 'loss_val': 1.2829695980024434, 'psi': 0.5598212138904445}-{'f1_val': 0.47920986811012306, 'auprc': 0.695284421211246, 'loss_val': 1.333519686433389, 'psi': 0.5656396893505722}
[S5] START round=2 head_norm_before_train=1.190380 (no previous merge yet)
[S5] round=2 local utility u=0.016536 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7697068382260457, 'loss_val': 1.282869282817051, 'psi': 0.3932398781475612}-{'f1_val': 0.14226190476190476, 'auprc': 0.7685223320894392, 'loss_val': 1.312387178194617, 'psi': 0.39276607569291855}
[S6] START round=2 head_norm_before_train=1.155951 (no previous merge yet)
[S6] round=2 local utility u=0.282502 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8151071701867468, 'loss_val': 1.2815546040866856, 'psi': 0.41089863730546794}-{'f1_val': 0.14142628205128205, 'auprc': 0.6400582226460754, 'loss_val': 1.3214111003254478, 'psi': 0.34087905828919934}
[S7] START round=2 head_norm_before_train=1.194856 (no previous merge yet)
[S7] round=2 local utility u=0.020573 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7947724473402754, 'loss_val': 1.29007230811999, 'psi': 0.4031430725735652}-{'f1_val': 0.14205682272909165, 'auprc': 0.7919356860434024, 'loss_val': 1.3227073649449435, 'psi': 0.40200836805481593}
[S8] START round=2 head_norm_before_train=1.157279 (no previous merge yet)
[S8] round=2 local utility u=0.371020 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.685245971138106, 'loss_val': 1.303349063818577, 'psi': 0.35807197789101675}-{'f1_val': 0.13995598239295717, 'auprc': 0.44934646349974006, 'loss_val': 1.3376895876532326, 'psi': 0.26371217483567033}
[S9] START round=2 head_norm_before_train=1.177819 (no previous merge yet)
[S9] round=2 local utility u=0.145607 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8623977366553447, 'loss_val': 1.2544659454638118, 'psi': 0.42979786894613553}-{'f1_val': 0.141397957139996, 'auprc': 0.7834326066165791, 'loss_val': 1.3087848851126795, 'psi': 0.3982118169306293}
[S10] START round=2 head_norm_before_train=1.180007 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.31595514881688513, 'auprc': 0.8314451522802075, 'loss_val': 1.2799889176569956, 'psi': 0.5221511502022141}-{'f1_val': 0.4162385227504591, 'auprc': 0.8229992999134947, 'loss_val': 1.3194108331005556, 'psi': 0.5789428336156733}
[S11] START round=2 head_norm_before_train=0.808645 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.759396048830775, 'loss_val': 1.3439794820714628, 'psi': 0.3880066295561764}-{'f1_val': 0.2652661228478626, 'auprc': 0.5579524484140637, 'loss_val': 1.3628259473048263, 'psi': 0.38234065307434306}
[S13] START round=2 head_norm_before_train=1.175370 (no previous merge yet)
[S13] round=2 local utility u=0.184616 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6801965028082866, 'loss_val': 1.284840527521174, 'psi': 0.3563100586695465}-{'f1_val': 0.1403857625770531, 'auprc': 0.5707598034242234, 'loss_val': 1.3257631880091751, 'psi': 0.3125353789159212}
[S14] START round=2 head_norm_before_train=1.154158 (no previous merge yet)
[S14] round=2 local utility u=0.500191 metrics={'f1_val': 0.4101841673295141, 'auprc': 0.684149400168952, 'loss_val': 1.3279495687905636, 'psi': 0.5197702604652893}-{'f1_val': 0.25541001418525333, 'auprc': 0.670178291836759, 'loss_val': 1.3577735010085001, 'psi': 0.42131732524585563}
[S15] START round=2 head_norm_before_train=1.166977 (no previous merge yet)
[S15] round=2 local utility u=0.045940 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.767230046226928, 'loss_val': 1.294010079409678, 'psi': 0.39073220930770625}-{'f1_val': 0.13973365136155833, 'auprc': 0.7456152630202583, 'loss_val': 1.3210459841245608, 'psi': 0.3820862960250383}
[S16] START round=2 head_norm_before_train=1.219886 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8228843666719577, 'loss_val': 1.2875360703841083, 'psi': 0.413536216788305}-{'f1_val': 0.4128285032050827, 'auprc': 0.8376919929548263, 'loss_val': 1.3247970426216886, 'psi': 0.5827738991049802}
[S17] START round=2 head_norm_before_train=0.807428 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.100271 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5853741596249252, 'loss_val': 1.3558489728872554, 'psi': 0.31871904184040073}-{'f1_val': 0.14520435407681248, 'auprc': 0.5082801169280872, 'loss_val': 1.3506421447573052, 'psi': 0.29043465921732237}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:63511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:63502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:63502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63515
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:63511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S14] → sending delta(kind=head bytes=1787) to S2@127.0.0.1:63502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:63504
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:63510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S8] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:63516
[S6] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1787 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1788 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1791) from S15
[S2] cosine check vs S15: cos=-0.0832
[S2] DROPPED delta from S15 (cos=-0.0832 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S5
[S10] cosine check vs S5: cos=0.0410
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] cosine check vs S2: cos=-0.0832
[S15] DROPPED delta from S2 (cos=-0.0832 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1787) from S14
[S2] cosine check vs S14: cos=0.0864
[S4] RECEIVED delta(kind=head bytes=1794) from S9
[S4] cosine check vs S9: cos=0.0418
[S16] RECEIVED delta(kind=head bytes=1796) from S3
[S16] cosine check vs S3: cos=-0.0558
[S16] DROPPED delta from S3 (cos=-0.0558 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1792) from S7
[S2] cosine check vs S7: cos=0.7506
[S5] RECEIVED delta(kind=head bytes=1788) from S8
[S5] cosine check vs S8: cos=-0.0564
[S5] DROPPED delta from S8 (cos=-0.0564 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1792) from S6
[S10] cosine check vs S6: cos=0.0231
[S9] RECEIVED delta(kind=head bytes=1788) from S13
[S9] cosine check vs S13: cos=-0.0235
[S9] DROPPED delta from S13 (cos=-0.0235 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:63515
[S17] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S17
[S15] cosine check vs S17: cos=0.0354
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=2 metric=0.4124 head_norm=1.198060
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.299776e-01
[S4] stored merged vector for next round verification (round=2)
[S4] DEBUG after merge:  round=2 metric=0.1402 head_norm=0.865401 delta_norm=0.829978
[S4] aggregate: ROLLBACK (f1_val pre=0.412 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=2 metric=0.1397 head_norm=1.191649
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.107680e-01
[S15] stored merged vector for next round verification (round=2)
[S15] DEBUG after merge:  round=2 metric=0.1397 head_norm=0.734627 delta_norm=0.710768
[S15] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=0.865368
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.002162e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.774470 delta_norm=0.400216
[S2] aggregate: ACCEPT kept=['S14', 'S7'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.3160 head_norm=1.206147
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.282100e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.759269 delta_norm=0.728210
[S10] aggregate: ROLLBACK (f1_val pre=0.316 post=0.139 tol_abs=0.005 tol_rel=0.0)
[S2] START round=3 head_norm_before_train=0.774470 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7769098319083559, 'loss_val': 1.2666444009903997, 'psi': 0.39583021279648245}-{'f1_val': 0.1417771333885667, 'auprc': 0.8843218762249128, 'loss_val': 1.2968317865398251, 'psi': 0.43879503052310515}
[S3] START round=3 head_norm_before_train=0.869098 cos_to_last_merge=0.9967 (last merge round=1)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.998796136202491, 'loss_val': 1.2936949771765311, 'psi': 0.4834224938494607}-{'f1_val': 0.3916107768504741, 'auprc': 0.9055077553020262, 'loss_val': 1.339282163539034, 'psi': 0.5971695682310949}
[S4] START round=3 head_norm_before_train=0.865401 cos_to_last_merge=1.0000 (last merge round=2)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.776298061073915, 'loss_val': 1.2735945443907568, 'psi': 0.3946552017666765}-{'f1_val': 0.41237070505136264, 'auprc': 0.7809969771490672, 'loss_val': 1.2829695980024434, 'psi': 0.5598212138904445}
[S5] START round=3 head_norm_before_train=1.204380 (no previous merge yet)
[S5] round=3 local utility u=0.017736 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7697413098783142, 'loss_val': 1.247500128280832, 'psi': 0.39325366680846857}-{'f1_val': 0.14226190476190476, 'auprc': 0.7697068382260457, 'loss_val': 1.282869282817051, 'psi': 0.3932398781475612}
[S6] START round=3 head_norm_before_train=1.177778 (no previous merge yet)
[S6] round=3 local utility u=0.058060 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8434061581998135, 'loss_val': 1.2503320059371084, 'psi': 0.4222182325106946}-{'f1_val': 0.14142628205128205, 'auprc': 0.8151071701867468, 'loss_val': 1.2815546040866856, 'psi': 0.41089863730546794}
[S7] START round=3 head_norm_before_train=1.218634 (no previous merge yet)
[S7] round=3 local utility u=0.018568 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.794921253021674, 'loss_val': 1.2533835459689018, 'psi': 0.40320259484612464}-{'f1_val': 0.14205682272909165, 'auprc': 0.7947724473402754, 'loss_val': 1.29007230811999, 'psi': 0.4031430725735652}
[S8] START round=3 head_norm_before_train=1.177159 (no previous merge yet)
[S8] round=3 local utility u=0.072336 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7214293511624401, 'loss_val': 1.2672266152865, 'psi': 0.3725453299007504}-{'f1_val': 0.13995598239295717, 'auprc': 0.685245971138106, 'loss_val': 1.303349063818577, 'psi': 0.35807197789101675}
[S9] START round=3 head_norm_before_train=1.200090 (no previous merge yet)
[S9] round=3 local utility u=0.025092 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8580373054645125, 'loss_val': 1.1912003592857092, 'psi': 0.4280536964698026}-{'f1_val': 0.141397957139996, 'auprc': 0.8623977366553447, 'loss_val': 1.2544659454638118, 'psi': 0.42979786894613553}
[S10] START round=3 head_norm_before_train=0.759269 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8234400222436294, 'loss_val': 1.2858034562579168, 'psi': 0.41254899142248613}-{'f1_val': 0.31595514881688513, 'auprc': 0.8314451522802075, 'loss_val': 1.2799889176569956, 'psi': 0.5221511502022141}
[S11] START round=3 head_norm_before_train=0.821984 cos_to_last_merge=0.9968 (last merge round=1)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6970424765824156, 'loss_val': 1.3052894817931633, 'psi': 0.36306520065683257}-{'f1_val': 0.14041368337311058, 'auprc': 0.759396048830775, 'loss_val': 1.3439794820714628, 'psi': 0.3880066295561764}
[S13] START round=3 head_norm_before_train=1.192465 (no previous merge yet)
[S13] round=3 local utility u=0.065041 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7117826519961392, 'loss_val': 1.2495164415818154, 'psi': 0.36894451834468756}-{'f1_val': 0.1403857625770531, 'auprc': 0.6801965028082866, 'loss_val': 1.284840527521174, 'psi': 0.3563100586695465}
[S14] START round=3 head_norm_before_train=1.172851 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6893621636895707, 'loss_val': 1.2882905721698321, 'psi': 0.3599595772054505}-{'f1_val': 0.4101841673295141, 'auprc': 0.684149400168952, 'loss_val': 1.3279495687905636, 'psi': 0.5197702604652893}
[S15] START round=3 head_norm_before_train=0.734627 cos_to_last_merge=1.0000 (last merge round=2)
[S15] round=3 local utility u=0.003447 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7747538083461989, 'loss_val': 1.3096883431787014, 'psi': 0.3937417141554146}-{'f1_val': 0.13973365136155833, 'auprc': 0.767230046226928, 'loss_val': 1.294010079409678, 'psi': 0.39073220930770625}
[S16] START round=3 head_norm_before_train=1.247319 (no previous merge yet)
[S16] round=3 local utility u=0.071486 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8522315757447482, 'loss_val': 1.2326055210016265, 'psi': 0.4252751004174212}-{'f1_val': 0.14063745019920318, 'auprc': 0.8228843666719577, 'loss_val': 1.2875360703841083, 'psi': 0.413536216788305}
[S17] START round=3 head_norm_before_train=0.818357 cos_to_last_merge=0.9963 (last merge round=1)
[S17] round=3 local utility u=0.110823 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.64840766535106, 'loss_val': 1.3233029744698057, 'psi': 0.3439324441308546}-{'f1_val': 0.14094896331738438, 'auprc': 0.5853741596249252, 'loss_val': 1.3558489728872554, 'psi': 0.31871904184040073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:63517
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S8] → sending delta(kind=head bytes=1785) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:63508
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:63516
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:63509
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:63515
[S16] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1785 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S16
[S7] cosine check vs S16: cos=-0.0732
[S7] DROPPED delta from S16 (cos=-0.0732 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] cosine check vs S9: cos=0.0105
[S15] RECEIVED delta(kind=head bytes=1797) from S6
[S15] cosine check vs S6: cos=0.0147
[S15] RECEIVED delta(kind=head bytes=1791) from S5
[S15] cosine check vs S5: cos=0.0336
[S15] RECEIVED delta(kind=head bytes=1785) from S8
[S15] cosine check vs S8: cos=-0.0017
[S15] DROPPED delta from S8 (cos=-0.0017 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S7
[S17] cosine check vs S7: cos=0.0678
[S4] RECEIVED delta(kind=head bytes=1798) from S15
[S4] cosine check vs S15: cos=0.0344
[S8] RECEIVED delta(kind=head bytes=1793) from S13
[S8] cosine check vs S13: cos=-0.0655
[S8] DROPPED delta from S13 (cos=-0.0655 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1793 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1793) from S17
[S13] cosine check vs S17: cos=-0.0334
[S13] DROPPED delta from S17 (cos=-0.0334 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1402 head_norm=0.894000
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.760762e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.1402 head_norm=0.595951 delta_norm=0.576076
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=1.283516
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.845132e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.893851 delta_norm=0.884513
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=0.758161
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.739419e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.1397 head_norm=0.593092 delta_norm=0.573942
[S15] aggregate: ACCEPT kept=['S6', 'S5'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=0.838852
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.272238e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1409 head_norm=0.774403 delta_norm=0.727224
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.801197 cos_to_last_merge=0.9957 (last merge round=2)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7090241342236868, 'loss_val': 1.2162289960710262, 'psi': 0.36867593372261476}-{'f1_val': 0.1417771333885667, 'auprc': 0.7769098319083559, 'loss_val': 1.2666444009903997, 'psi': 0.39583021279648245}
[S3] START round=4 head_norm_before_train=0.897759 cos_to_last_merge=0.9880 (last merge round=1)
[S3] round=4 local utility u=0.026817 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.995182476068692, 'loss_val': 1.2292201885018796, 'psi': 0.48197702979594104}-{'f1_val': 0.13984006561410703, 'auprc': 0.998796136202491, 'loss_val': 1.2936949771765311, 'psi': 0.4834224938494607}
[S4] START round=4 head_norm_before_train=0.595951 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.031641 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7902926058781714, 'loss_val': 1.2522960086993145, 'psi': 0.40025301968837906}-{'f1_val': 0.14022662889518414, 'auprc': 0.776298061073915, 'loss_val': 1.2735945443907568, 'psi': 0.3946552017666765}
[S5] START round=4 head_norm_before_train=1.226339 (no previous merge yet)
[S5] round=4 local utility u=0.020416 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7696781367073127, 'loss_val': 1.2064792064098646, 'psi': 0.39322839754006794}-{'f1_val': 0.14226190476190476, 'auprc': 0.7697413098783142, 'loss_val': 1.247500128280832, 'psi': 0.39325366680846857}
[S6] START round=4 head_norm_before_train=1.203473 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7751691427693337, 'loss_val': 1.223314838960903, 'psi': 0.3949234263385027}-{'f1_val': 0.14142628205128205, 'auprc': 0.8434061581998135, 'loss_val': 1.2503320059371084, 'psi': 0.4222182325106946}
[S7] START round=4 head_norm_before_train=1.246369 (no previous merge yet)
[S7] round=4 local utility u=0.017458 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7948842323792207, 'loss_val': 1.2183573753150474, 'psi': 0.4031877865891433}-{'f1_val': 0.14205682272909165, 'auprc': 0.794921253021674, 'loss_val': 1.2533835459689018, 'psi': 0.40320259484612464}
[S8] START round=4 head_norm_before_train=1.202143 (no previous merge yet)
[S8] round=4 local utility u=0.056017 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7476162390604262, 'loss_val': 1.2337533941298455, 'psi': 0.3830200850599448}-{'f1_val': 0.13995598239295717, 'auprc': 0.7214293511624401, 'loss_val': 1.2672266152865, 'psi': 0.3725453299007504}
[S9] START round=4 head_norm_before_train=1.230957 (no previous merge yet)
[S9] round=4 local utility u=0.029688 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8566152502341035, 'loss_val': 1.1275583268678895, 'psi': 0.427484874377639}-{'f1_val': 0.141397957139996, 'auprc': 0.8580373054645125, 'loss_val': 1.1912003592857092, 'psi': 0.4280536964698026}
[S10] START round=4 head_norm_before_train=0.790501 cos_to_last_merge=0.9965 (last merge round=2)
[S10] round=4 local utility u=0.255434 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.9707395955876057, 'loss_val': 1.2168351366570784, 'psi': 0.4714688207600767}-{'f1_val': 0.13862163754172394, 'auprc': 0.8234400222436294, 'loss_val': 1.2858034562579168, 'psi': 0.41254899142248613}
[S11] START round=4 head_norm_before_train=0.846855 cos_to_last_merge=0.9876 (last merge round=1)
[S11] round=4 local utility u=0.008246 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.680501493203445, 'loss_val': 1.2391744969164533, 'psi': 0.35644880730524436}-{'f1_val': 0.14041368337311058, 'auprc': 0.6970424765824156, 'loss_val': 1.3052894817931633, 'psi': 0.36306520065683257}
[S13] START round=4 head_norm_before_train=1.209158 (no previous merge yet)
[S13] round=4 local utility u=0.028229 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7191705509051691, 'loss_val': 1.215222459018555, 'psi': 0.37189967790829953}-{'f1_val': 0.1403857625770531, 'auprc': 0.7117826519961392, 'loss_val': 1.2495164415818154, 'psi': 0.36894451834468756}
[S14] START round=4 head_norm_before_train=1.201670 (no previous merge yet)
[S14] round=4 local utility u=0.149529 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7726018598726507, 'loss_val': 1.2389515340847546, 'psi': 0.3932554556786826}-{'f1_val': 0.14035785288270378, 'auprc': 0.6893621636895707, 'loss_val': 1.2882905721698321, 'psi': 0.3599595772054505}
[S15] START round=4 head_norm_before_train=0.593092 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7738669612232885, 'loss_val': 1.323211637714974, 'psi': 0.3933869753062504}-{'f1_val': 0.13973365136155833, 'auprc': 0.7747538083461989, 'loss_val': 1.3096883431787014, 'psi': 0.3937417141554146}
[S16] START round=4 head_norm_before_train=0.893851 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7104106946365799, 'loss_val': 1.2401918259544646, 'psi': 0.3685467479741539}-{'f1_val': 0.14063745019920318, 'auprc': 0.8522315757447482, 'loss_val': 1.2326055210016265, 'psi': 0.4252751004174212}
[S17] START round=4 head_norm_before_train=0.774403 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.051304 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.676998313598935, 'loss_val': 1.3064664823456211, 'psi': 0.35536870343000465}-{'f1_val': 0.14094896331738438, 'auprc': 0.64840766535106, 'loss_val': 1.3233029744698057, 'psi': 0.3439324441308546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:63516
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:63517
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:63515
[S9] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S14
[S8] cosine check vs S14: cos=0.0181
[S15] RECEIVED delta(kind=head bytes=1794) from S8
[S15] cosine check vs S8: cos=-0.0054
[S15] DROPPED delta from S8 (cos=-0.0054 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S5
[S15] cosine check vs S5: cos=0.5491
[S17] RECEIVED delta(kind=head bytes=1800) from S10
[S17] cosine check vs S10: cos=0.0030
[S8] RECEIVED delta(kind=head bytes=1793) from S13
[S8] cosine check vs S13: cos=-0.0634
[S8] DROPPED delta from S13 (cos=-0.0634 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S7
[S17] cosine check vs S7: cos=0.8240
[S16] RECEIVED delta(kind=head bytes=1793) from S9
[S16] cosine check vs S9: cos=0.6670
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] cosine check vs S11: cos=0.0519
[S16] RECEIVED delta(kind=head bytes=1802) from S4
[S16] cosine check vs S4: cos=0.3084
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] cosine check vs S3: cos=-0.0207
[S6] DROPPED delta from S3 (cos=-0.0207 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S17
[S13] cosine check vs S17: cos=-0.0752
[S13] DROPPED delta from S17 (cos=-0.0752 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=4 metric=0.1397 head_norm=0.612603
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.233386e-01
[S15] stored merged vector for next round verification (round=4)
[S15] DEBUG after merge:  round=4 metric=0.1397 head_norm=0.833160 delta_norm=0.523339
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=1.249318
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.460960e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1423 head_norm=0.783557 delta_norm=0.746096
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.1400 head_norm=1.223016
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.618230e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.1400 head_norm=0.877562 delta_norm=0.861823
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.927662
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.860281e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.793122 delta_norm=0.386028
[S16] aggregate: ACCEPT kept=['S9', 'S4'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.1409 head_norm=0.792576
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.037867e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.1409 head_norm=0.711753 delta_norm=0.303787
[S17] aggregate: ACCEPT kept=['S10', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.827670 cos_to_last_merge=0.9877 (last merge round=2)
[S2] round=5 local utility u=0.123963 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7702865621169609, 'loss_val': 1.1520905513410415, 'psi': 0.3931809048799244}-{'f1_val': 0.1417771333885667, 'auprc': 0.7090241342236868, 'loss_val': 1.2162289960710262, 'psi': 0.36867593372261476}
[S3] START round=5 head_norm_before_train=0.933580 cos_to_last_merge=0.9757 (last merge round=1)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8655377412945107, 'loss_val': 1.1796233441087467, 'psi': 0.4301191358862685}-{'f1_val': 0.13984006561410703, 'auprc': 0.995182476068692, 'loss_val': 1.2292201885018796, 'psi': 0.48197702979594104}
[S4] START round=5 head_norm_before_train=0.629971 cos_to_last_merge=0.9938 (last merge round=3)
[S4] round=5 local utility u=0.039004 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7935492303167404, 'loss_val': 1.1840576547468478, 'psi': 0.40155566946380666}-{'f1_val': 0.14022662889518414, 'auprc': 0.7902926058781714, 'loss_val': 1.2522960086993145, 'psi': 0.40025301968837906}
[S5] START round=5 head_norm_before_train=0.783557 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7690729490155569, 'loss_val': 1.2073156185074807, 'psi': 0.3929863224633656}-{'f1_val': 0.14226190476190476, 'auprc': 0.7696781367073127, 'loss_val': 1.2064792064098646, 'psi': 0.39322839754006794}
[S6] START round=5 head_norm_before_train=1.223561 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6703766365322957, 'loss_val': 1.1799098295452126, 'psi': 0.3530064238436875}-{'f1_val': 0.14142628205128205, 'auprc': 0.7751691427693337, 'loss_val': 1.223314838960903, 'psi': 0.3949234263385027}
[S7] START round=5 head_norm_before_train=1.265763 (no previous merge yet)
[S7] round=5 local utility u=0.014035 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7865467446425818, 'loss_val': 1.1652746605687347, 'psi': 0.3998527914944877}-{'f1_val': 0.14205682272909165, 'auprc': 0.7948842323792207, 'loss_val': 1.2183573753150474, 'psi': 0.4031877865891433}
[S8] START round=5 head_norm_before_train=0.877562 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.020599 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7666891316945583, 'loss_val': 1.2497749684528705, 'psi': 0.3906492421135977}-{'f1_val': 0.13995598239295717, 'auprc': 0.7476162390604262, 'loss_val': 1.2337533941298455, 'psi': 0.3830200850599448}
[S9] START round=5 head_norm_before_train=1.260231 (no previous merge yet)
[S9] round=5 local utility u=0.135650 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9079702914118641, 'loss_val': 1.010322816184299, 'psi': 0.4480268908487433}-{'f1_val': 0.141397957139996, 'auprc': 0.8566152502341035, 'loss_val': 1.1275583268678895, 'psi': 0.427484874377639}
[S10] START round=5 head_norm_before_train=0.831483 cos_to_last_merge=0.9874 (last merge round=2)
[S10] round=5 local utility u=0.747783 metrics={'f1_val': 0.4139415300783953, 'auprc': 0.8784885682779646, 'loss_val': 1.0964352200327885, 'psi': 0.5997603453582231}-{'f1_val': 0.13862163754172394, 'auprc': 0.9707395955876057, 'loss_val': 1.2168351366570784, 'psi': 0.4714688207600767}
[S11] START round=5 head_norm_before_train=0.883429 cos_to_last_merge=0.9734 (last merge round=1)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6200114029303001, 'loss_val': 1.150886042834538, 'psi': 0.3322527711959864}-{'f1_val': 0.14041368337311058, 'auprc': 0.680501493203445, 'loss_val': 1.2391744969164533, 'psi': 0.35644880730524436}
[S13] START round=5 head_norm_before_train=1.227244 (no previous merge yet)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.17931833741059808, 'auprc': 0.5565427297075582, 'loss_val': 1.1817231354548707, 'psi': 0.33020809432938214}-{'f1_val': 0.1403857625770531, 'auprc': 0.7191705509051691, 'loss_val': 1.215222459018555, 'psi': 0.37189967790829953}
[S14] START round=5 head_norm_before_train=1.236907 (no previous merge yet)
[S14] round=5 local utility u=0.184172 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8731339498734826, 'loss_val': 1.172203529732293, 'psi': 0.4334682916790153}-{'f1_val': 0.14035785288270378, 'auprc': 0.7726018598726507, 'loss_val': 1.2389515340847546, 'psi': 0.3932554556786826}
[S15] START round=5 head_norm_before_train=0.833160 cos_to_last_merge=1.0000 (last merge round=4)
[S15] round=5 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7656736842017917, 'loss_val': 1.3084377772615643, 'psi': 0.3901096644976517}-{'f1_val': 0.13973365136155833, 'auprc': 0.7738669612232885, 'loss_val': 1.323211637714974, 'psi': 0.3933869753062504}
[S16] START round=5 head_norm_before_train=0.793122 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.051425 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7423122918210835, 'loss_val': 1.2330458330772833, 'psi': 0.3813073868479553}-{'f1_val': 0.14063745019920318, 'auprc': 0.7104106946365799, 'loss_val': 1.2401918259544646, 'psi': 0.3685467479741539}
[S17] START round=5 head_norm_before_train=0.711753 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5316245051576878, 'loss_val': 1.2819780240018916, 'psi': 0.2972191800535058}-{'f1_val': 0.14094896331738438, 'auprc': 0.676998313598935, 'loss_val': 1.3064664823456211, 'psi': 0.35536870343000465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:63508
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:63515
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:63516
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:63517
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] cosine check vs S14: cos=0.6974
[S17] RECEIVED delta(kind=head bytes=1796) from S10
[S17] cosine check vs S10: cos=0.2943
[S15] RECEIVED delta(kind=head bytes=1793) from S8
[S15] cosine check vs S8: cos=-0.0296
[S15] DROPPED delta from S8 (cos=-0.0296 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] cosine check vs S7: cos=0.8800
[S16] RECEIVED delta(kind=head bytes=1797) from S4
[S16] cosine check vs S4: cos=0.5391
[S16] RECEIVED delta(kind=head bytes=1793) from S9
[S16] cosine check vs S9: cos=0.8538
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=-0.1317
[S7] DROPPED delta from S16 (cos=-0.1317 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S2
[S14] cosine check vs S2: cos=0.4279
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.383 → S8@127.0.0.1:63509
[S6] ⇄ pheromone p=0.385 → S15@127.0.0.1:63515
[S3] ⇄ pheromone p=0.455 → S6@127.0.0.1:63507
[S5] ⇄ pheromone p=0.366 → S15@127.0.0.1:63515
[S11] ⇄ pheromone p=0.396 → S5@127.0.0.1:63505
[S9] ⇄ pheromone p=0.378 → S16@127.0.0.1:63516
[S10] ⇄ pheromone p=0.522 → S17@127.0.0.1:63517
[S2] ⇄ pheromone p=0.369 → S14@127.0.0.1:63514
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.818229
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.277395e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.805938 delta_norm=0.227739
[S16] aggregate: ACCEPT kept=['S4', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.347 → S7@127.0.0.1:63508
[S4] ⇄ pheromone p=0.382 → S16@127.0.0.1:63516
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=1.273968
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.965249e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.907394 delta_norm=0.596525
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.440 → S8@127.0.0.1:63509
[S7] ⇄ pheromone p=0.364 → S17@127.0.0.1:63517
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.1400 head_norm=0.894634
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.565067e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.1421 head_norm=1.001640 delta_norm=0.456507
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.415 → S15@127.0.0.1:63515
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.1409 head_norm=0.736970
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.766769e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.1409 head_norm=0.737463 delta_norm=0.176677
[S17] aggregate: ACCEPT kept=['S10', 'S7'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.379 → S13@127.0.0.1:63513
[S15] ⇄ pheromone p=0.343 → S4@127.0.0.1:63504
[S2] START round=6 head_norm_before_train=0.857566 cos_to_last_merge=0.9781 (last merge round=2)
[S2] round=6 local utility u=0.881073 metrics={'f1_val': 0.4157110705713425, 'auprc': 0.7785756841207134, 'loss_val': 1.058415504997614, 'psi': 0.5608569159910909}-{'f1_val': 0.1417771333885667, 'auprc': 0.7702865621169609, 'loss_val': 1.1520905513410415, 'psi': 0.3931809048799244}
[S3] START round=6 head_norm_before_train=0.973005 cos_to_last_merge=0.9620 (last merge round=1)
[S3] round=6 local utility u=0.851674 metrics={'f1_val': 0.4052047529580315, 'auprc': 0.8596400972744005, 'loss_val': 1.0507702269658261, 'psi': 0.5869788906845791}-{'f1_val': 0.13984006561410703, 'auprc': 0.8655377412945107, 'loss_val': 1.1796233441087467, 'psi': 0.4301191358862685}
[S4] START round=6 head_norm_before_train=0.672667 cos_to_last_merge=0.9788 (last merge round=3)
[S4] round=6 local utility u=0.858022 metrics={'f1_val': 0.41521773740003826, 'auprc': 0.7822288289849124, 'loss_val': 1.0839994798991859, 'psi': 0.5620221740339879}-{'f1_val': 0.14022662889518414, 'auprc': 0.7935492303167404, 'loss_val': 1.1840576547468478, 'psi': 0.40155566946380666}
[S5] START round=6 head_norm_before_train=0.810637 cos_to_last_merge=0.9977 (last merge round=4)
[S5] round=6 local utility u=0.872667 metrics={'f1_val': 0.4165810387685111, 'auprc': 0.7664322968378898, 'loss_val': 1.0999740595749783, 'psi': 0.5565215419962626}-{'f1_val': 0.14226190476190476, 'auprc': 0.7690729490155569, 'loss_val': 1.2073156185074807, 'psi': 0.3929863224633656}
[S6] START round=6 head_norm_before_train=1.244796 (no previous merge yet)
[S6] round=6 local utility u=0.025601 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.661906972819821, 'loss_val': 1.103298828430063, 'psi': 0.34961855835869765}-{'f1_val': 0.14142628205128205, 'auprc': 0.6703766365322957, 'loss_val': 1.1799098295452126, 'psi': 0.3530064238436875}
[S7] START round=6 head_norm_before_train=1.286540 (no previous merge yet)
[S7] round=6 local utility u=0.866975 metrics={'f1_val': 0.4127708737097793, 'auprc': 0.7949731945896004, 'loss_val': 1.0808887218037944, 'psi': 0.5656518020617077}-{'f1_val': 0.14205682272909165, 'auprc': 0.7865467446425818, 'loss_val': 1.1652746605687347, 'psi': 0.3998527914944877}
[S8] START round=6 head_norm_before_train=1.001640 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.14134168518892706, 'auprc': 0.6009280352629772, 'loss_val': 1.2349392433989073, 'psi': 0.32517622521854717}-{'f1_val': 0.13995598239295717, 'auprc': 0.7666891316945583, 'loss_val': 1.2497749684528705, 'psi': 0.3906492421135977}
[S9] START round=6 head_norm_before_train=1.286306 (no previous merge yet)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.43720199806843946, 'auprc': 0.9781398536156025, 'loss_val': 0.8353400556875061, 'psi': 0.6535771402873047}-{'f1_val': 0.141397957139996, 'auprc': 0.9079702914118641, 'loss_val': 1.010322816184299, 'psi': 0.4480268908487433}
[S10] START round=6 head_norm_before_train=0.880028 cos_to_last_merge=0.9752 (last merge round=2)
[S10] round=6 local utility u=0.070745 metrics={'f1_val': 0.41229629546475677, 'auprc': 0.8663100740492239, 'loss_val': 0.9085393062128342, 'psi': 0.5939018068985437}-{'f1_val': 0.4139415300783953, 'auprc': 0.8784885682779646, 'loss_val': 1.0964352200327885, 'psi': 0.5997603453582231}
[S11] START round=6 head_norm_before_train=0.925096 cos_to_last_merge=0.9573 (last merge round=1)
[S11] round=6 local utility u=0.975799 metrics={'f1_val': 0.41093233052891764, 'auprc': 0.6836519887752321, 'loss_val': 1.0133226815776717, 'psi': 0.5200201938274435}-{'f1_val': 0.14041368337311058, 'auprc': 0.6200114029303001, 'loss_val': 1.150886042834538, 'psi': 0.3322527711959864}
[S13] START round=6 head_norm_before_train=1.243987 (no previous merge yet)
[S13] round=6 local utility u=0.773168 metrics={'f1_val': 0.41627458463323097, 'auprc': 0.5768701786855867, 'loss_val': 1.118107365092693, 'psi': 0.48051282225417324}-{'f1_val': 0.17931833741059808, 'auprc': 0.5565427297075582, 'loss_val': 1.1817231354548707, 'psi': 0.33020809432938214}
[S14] START round=6 head_norm_before_train=0.907394 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.851145 metrics={'f1_val': 0.4134824248840898, 'auprc': 0.8773244660502049, 'loss_val': 1.1212327310992423, 'psi': 0.5990192413505359}-{'f1_val': 0.14035785288270378, 'auprc': 0.8731339498734826, 'loss_val': 1.172203529732293, 'psi': 0.4334682916790153}
[S15] START round=6 head_norm_before_train=0.845851 cos_to_last_merge=0.9963 (last merge round=4)
[S15] round=6 local utility u=0.031740 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.771886339701066, 'loss_val': 1.263595689214892, 'psi': 0.39259472669736145}-{'f1_val': 0.13973365136155833, 'auprc': 0.7656736842017917, 'loss_val': 1.3084377772615643, 'psi': 0.3901096644976517}
[S16] START round=6 head_norm_before_train=0.805938 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.17520064663480855, 'auprc': 0.45324380481024124, 'loss_val': 1.1897463282237999, 'psi': 0.2864179099049816}-{'f1_val': 0.14063745019920318, 'auprc': 0.7423122918210835, 'loss_val': 1.2330458330772833, 'psi': 0.3813073868479553}
[S17] START round=6 head_norm_before_train=0.737463 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.025983 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5380936235528474, 'loss_val': 1.249418857958313, 'psi': 0.2998068274115696}-{'f1_val': 0.14094896331738438, 'auprc': 0.5316245051576878, 'loss_val': 1.2819780240018916, 'psi': 0.2972191800535058}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:63516
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:63514
[S13] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1792) from S2
[S14] cosine check vs S2: cos=0.7518
[S15] RECEIVED delta(kind=head bytes=1797) from S6
[S15] cosine check vs S6: cos=0.2207
[S8] RECEIVED delta(kind=head bytes=1792) from S14
[S8] cosine check vs S14: cos=0.8549
[S15] RECEIVED delta(kind=head bytes=1796) from S5
[S15] cosine check vs S5: cos=0.8931
[S17] RECEIVED delta(kind=head bytes=1797) from S10
[S17] cosine check vs S10: cos=0.4400
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] cosine check vs S7: cos=0.8590
[S4] RECEIVED delta(kind=head bytes=1790) from S15
[S4] cosine check vs S15: cos=0.1206
[S16] RECEIVED delta(kind=head bytes=1797) from S4
[S16] cosine check vs S4: cos=0.6380
[S16] RECEIVED delta(kind=head bytes=1800) from S9
[S16] cosine check vs S9: cos=0.9066
[S6] RECEIVED delta(kind=head bytes=1795) from S3
[S6] cosine check vs S3: cos=-0.0241
[S6] DROPPED delta from S3 (cos=-0.0241 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1791) from S11
[S5] cosine check vs S11: cos=0.5566
[S8] RECEIVED delta(kind=head bytes=1801) from S13
[S8] cosine check vs S13: cos=-0.0828
[S8] DROPPED delta from S13 (cos=-0.0828 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=-0.0725
[S13] DROPPED delta from S17 (cos=-0.0725 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.1413 head_norm=1.012972
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.657253e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.2807 head_norm=0.942955 delta_norm=0.265725
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.4135 head_norm=0.945218
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.249603e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.4113 head_norm=0.861006 delta_norm=0.324960
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.4152 head_norm=0.715124
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.271422e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.1402 head_norm=0.593768 delta_norm=0.527142
[S4] aggregate: ROLLBACK (f1_val pre=0.415 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.4166 head_norm=0.847384
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.316826e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.4171 head_norm=0.802864 delta_norm=0.431683
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.1397 head_norm=0.865723
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.435787e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.1397 head_norm=0.752973 delta_norm=0.343579
[S15] aggregate: ACCEPT kept=['S6', 'S5'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.1752 head_norm=0.826315
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.555816e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.1406 head_norm=0.841766 delta_norm=0.155582
[S16] aggregate: ROLLBACK (f1_val pre=0.175 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.1409 head_norm=0.765774
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.226207e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.1409 head_norm=0.775208 delta_norm=0.122621
[S17] aggregate: ACCEPT kept=['S10', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.894664 cos_to_last_merge=0.9659 (last merge round=2)
[S2] round=7 local utility u=0.120112 metrics={'f1_val': 0.43526029828358526, 'auprc': 0.7768672323100972, 'loss_val': 0.9303620505047931, 'psi': 0.57190307189419}-{'f1_val': 0.4157110705713425, 'auprc': 0.7785756841207134, 'loss_val': 1.058415504997614, 'psi': 0.5608569159910909}
[S3] START round=7 head_norm_before_train=1.005638 cos_to_last_merge=0.9513 (last merge round=1)
[S3] round=7 local utility u=0.235919 metrics={'f1_val': 0.3953911791098006, 'auprc': 0.9964962810999521, 'loss_val': 0.9306192785219306, 'psi': 0.6358332199058613}-{'f1_val': 0.4052047529580315, 'auprc': 0.8596400972744005, 'loss_val': 1.0507702269658261, 'psi': 0.5869788906845791}
[S4] START round=7 head_norm_before_train=0.593768 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.41521773740003826, 'auprc': 0.6761946047463994, 'loss_val': 1.0951522985792865, 'psi': 0.5196084843385828}-{'f1_val': 0.41521773740003826, 'auprc': 0.7822288289849124, 'loss_val': 1.0839994798991859, 'psi': 0.5620221740339879}
[S5] START round=7 head_norm_before_train=0.802864 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.055371 metrics={'f1_val': 0.4183544144322735, 'auprc': 0.7777751220507534, 'loss_val': 1.0339002024108006, 'psi': 0.5621226974796654}-{'f1_val': 0.4165810387685111, 'auprc': 0.7664322968378898, 'loss_val': 1.0999740595749783, 'psi': 0.5565215419962626}
[S6] START round=7 head_norm_before_train=1.269709 (no previous merge yet)
[S6] round=7 local utility u=1.000000 metrics={'f1_val': 0.41661633401962306, 'auprc': 0.8212409246805713, 'loss_val': 0.9858839974569292, 'psi': 0.5784661702840024}-{'f1_val': 0.14142628205128205, 'auprc': 0.661906972819821, 'loss_val': 1.103298828430063, 'psi': 0.34961855835869765}
[S7] START round=7 head_norm_before_train=1.305991 (no previous merge yet)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.4171579869317734, 'auprc': 0.6827571902525122, 'loss_val': 0.9491226552689771, 'psi': 0.523397668260069}-{'f1_val': 0.4127708737097793, 'auprc': 0.7949731945896004, 'loss_val': 1.0808887218037944, 'psi': 0.5656518020617077}
[S8] START round=7 head_norm_before_train=0.942955 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.425316 metrics={'f1_val': 0.27430409050588944, 'auprc': 0.6010460533085875, 'loss_val': 1.1824362752269666, 'psi': 0.4050008756269687}-{'f1_val': 0.14134168518892706, 'auprc': 0.6009280352629772, 'loss_val': 1.2349392433989073, 'psi': 0.32517622521854717}
[S9] START round=7 head_norm_before_train=1.323797 (no previous merge yet)
[S9] round=7 local utility u=0.929389 metrics={'f1_val': 0.7012675768428742, 'auprc': 0.9997843690850007, 'loss_val': 0.6258891228392142, 'psi': 0.8206742937397248}-{'f1_val': 0.43720199806843946, 'auprc': 0.9781398536156025, 'loss_val': 0.8353400556875061, 'psi': 0.6535771402873047}
[S10] START round=7 head_norm_before_train=0.928089 cos_to_last_merge=0.9630 (last merge round=2)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.39269101263332185, 'auprc': 0.8594223914868523, 'loss_val': 0.7955603542503351, 'psi': 0.579383564174734}-{'f1_val': 0.41229629546475677, 'auprc': 0.8663100740492239, 'loss_val': 0.9085393062128342, 'psi': 0.5939018068985437}
[S11] START round=7 head_norm_before_train=0.971505 cos_to_last_merge=0.9398 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.940
[S11] round=7 local utility u=0.185405 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.7878560948985789, 'loss_val': 0.868642148967014, 'psi': 0.5530535706049312}-{'f1_val': 0.41093233052891764, 'auprc': 0.6836519887752321, 'loss_val': 1.0133226815776717, 'psi': 0.5200201938274435}
[S13] START round=7 head_norm_before_train=1.263060 (no previous merge yet)
[S13] round=7 local utility u=0.297313 metrics={'f1_val': 0.4163167573796875, 'auprc': 0.7421668665752739, 'loss_val': 1.019624768317823, 'psi': 0.546656801057922}-{'f1_val': 0.41627458463323097, 'auprc': 0.5768701786855867, 'loss_val': 1.118107365092693, 'psi': 0.48051282225417324}
[S14] START round=7 head_norm_before_train=0.861006 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.112170 metrics={'f1_val': 0.3966267743617936, 'auprc': 0.9471150376152901, 'loss_val': 1.005130039885614, 'psi': 0.6168220796631922}-{'f1_val': 0.4134824248840898, 'auprc': 0.8773244660502049, 'loss_val': 1.1212327310992423, 'psi': 0.5990192413505359}
[S15] START round=7 head_norm_before_train=0.752973 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.016573 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7758669933516124, 'loss_val': 1.2423917158921465, 'psi': 0.39418698815757997}-{'f1_val': 0.13973365136155833, 'auprc': 0.771886339701066, 'loss_val': 1.263595689214892, 'psi': 0.39259472669736145}
[S16] START round=7 head_norm_before_train=0.841766 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.751690 metrics={'f1_val': 0.41738655605465536, 'auprc': 0.44926879574861855, 'loss_val': 1.1275565742221674, 'psi': 0.4301394519322406}-{'f1_val': 0.17520064663480855, 'auprc': 0.45324380481024124, 'loss_val': 1.1897463282237999, 'psi': 0.2864179099049816}
[S17] START round=7 head_norm_before_train=0.775208 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.046233 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5438669338153969, 'loss_val': 1.1742718126679912, 'psi': 0.3021161515165894}-{'f1_val': 0.14094896331738438, 'auprc': 0.5380936235528474, 'loss_val': 1.249418857958313, 'psi': 0.2998068274115696}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:63508
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:63504
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S6
[S15] cosine check vs S6: cos=0.5499
[S15] RECEIVED delta(kind=head bytes=1792) from S5
[S15] cosine check vs S5: cos=0.6611
[S4] RECEIVED delta(kind=head bytes=1791) from S15
[S4] cosine check vs S15: cos=0.7261
[S16] RECEIVED delta(kind=head bytes=1804) from S9
[S16] cosine check vs S9: cos=0.9122
[S7] RECEIVED delta(kind=head bytes=1794) from S16
[S7] cosine check vs S16: cos=-0.1217
[S7] DROPPED delta from S16 (cos=-0.1217 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1792) from S3
[S6] cosine check vs S3: cos=-0.0275
[S6] DROPPED delta from S3 (cos=-0.0275 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1791) from S11
[S5] cosine check vs S11: cos=0.8659
[S15] RECEIVED delta(kind=head bytes=1792) from S8
[S15] cosine check vs S8: cos=-0.0195
[S15] DROPPED delta from S8 (cos=-0.0195 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1793) from S13
[S8] cosine check vs S13: cos=-0.0882
[S8] DROPPED delta from S13 (cos=-0.0882 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S14
[S8] cosine check vs S14: cos=0.8400
[S14] RECEIVED delta(kind=head bytes=1792) from S2
[S14] cosine check vs S2: cos=0.9059
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1791 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1791) from S17
[S13] cosine check vs S17: cos=-0.0654
[S13] DROPPED delta from S17 (cos=-0.0654 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.4152 head_norm=0.627812
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.677608e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.1402 head_norm=0.651160 delta_norm=0.267761
[S4] aggregate: ROLLBACK (f1_val pre=0.415 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.1397 head_norm=0.772828
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.500615e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.1397 head_norm=0.742263 delta_norm=0.250061
[S15] aggregate: ACCEPT kept=['S6', 'S5'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4174 head_norm=0.867772
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.401071e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4356 head_norm=1.095983 delta_norm=0.340107
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.3966 head_norm=0.904522
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.012947e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.3966 head_norm=0.901763 delta_norm=0.201295
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.2743 head_norm=0.956076
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.642924e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.3914 head_norm=0.892340 delta_norm=0.264292
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4184 head_norm=0.834139
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.577004e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.4177 head_norm=0.898131 delta_norm=0.257700
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.942991 cos_to_last_merge=0.9505 (last merge round=2)
[S2] round=8 local utility u=0.820066 metrics={'f1_val': 0.7137509122518518, 'auprc': 0.7223760748134431, 'loss_val': 0.7977010434032445, 'psi': 0.7172009772764883}-{'f1_val': 0.43526029828358526, 'auprc': 0.7768672323100972, 'loss_val': 0.9303620505047931, 'psi': 0.57190307189419}
[S3] START round=8 head_norm_before_train=1.047263 cos_to_last_merge=0.9374 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=8 local utility u=0.085849 metrics={'f1_val': 0.39381786591190104, 'auprc': 0.998202292819306, 'loss_val': 0.7545996287487033, 'psi': 0.635571636674863}-{'f1_val': 0.3953911791098006, 'auprc': 0.9964962810999521, 'loss_val': 0.9306192785219306, 'psi': 0.6358332199058613}
[S4] START round=8 head_norm_before_train=0.651160 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.196714 metrics={'f1_val': 0.41521773740003826, 'auprc': 0.7844653939228969, 'loss_val': 1.0265373548461993, 'psi': 0.5629168000091818}-{'f1_val': 0.41521773740003826, 'auprc': 0.6761946047463994, 'loss_val': 1.0951522985792865, 'psi': 0.5196084843385828}
[S5] START round=8 head_norm_before_train=0.898131 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.735032 metrics={'f1_val': 0.6465268089692466, 'auprc': 0.7776282687887581, 'loss_val': 0.9324300160608352, 'psi': 0.6989673928970512}-{'f1_val': 0.4183544144322735, 'auprc': 0.7777751220507534, 'loss_val': 1.0339002024108006, 'psi': 0.5621226974796654}
[S6] START round=8 head_norm_before_train=1.295735 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.4166544795555117, 'auprc': 0.665020567543745, 'loss_val': 0.7964192702617743, 'psi': 0.516000914750805}-{'f1_val': 0.41661633401962306, 'auprc': 0.8212409246805713, 'loss_val': 0.9858839974569292, 'psi': 0.5784661702840024}
[S7] START round=8 head_norm_before_train=1.333487 (no previous merge yet)
[S7] round=8 local utility u=0.326705 metrics={'f1_val': 0.4529051282966897, 'auprc': 0.7932421555355248, 'loss_val': 0.8416507965252452, 'psi': 0.5890399391922237}-{'f1_val': 0.4171579869317734, 'auprc': 0.6827571902525122, 'loss_val': 0.9491226552689771, 'psi': 0.523397668260069}
[S8] START round=8 head_norm_before_train=0.892340 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.387358 metrics={'f1_val': 0.39141596466002504, 'auprc': 0.6009967500232337, 'loss_val': 1.1102427229682383, 'psi': 0.4752482788053085}-{'f1_val': 0.27430409050588944, 'auprc': 0.6010460533085875, 'loss_val': 1.1824362752269666, 'psi': 0.4050008756269687}
[S9] START round=8 head_norm_before_train=1.371377 (no previous merge yet)
[S9] round=8 local utility u=0.099059 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.9995840156576625, 'loss_val': 0.42819968518854645, 'psi': 0.8206970864320379}-{'f1_val': 0.7012675768428742, 'auprc': 0.9997843690850007, 'loss_val': 0.6258891228392142, 'psi': 0.8206742937397248}
[S10] START round=8 head_norm_before_train=0.972392 cos_to_last_merge=0.9497 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.950
[S10] round=8 local utility u=1.000000 metrics={'f1_val': 0.7013654545499672, 'auprc': 0.9982947440487268, 'loss_val': 0.6282342147362526, 'psi': 0.8201371703494711}-{'f1_val': 0.39269101263332185, 'auprc': 0.8594223914868523, 'loss_val': 0.7955603542503351, 'psi': 0.579383564174734}
[S11] START round=8 head_norm_before_train=1.024845 cos_to_last_merge=0.9202 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.920
[S11] round=8 local utility u=0.256324 metrics={'f1_val': 0.3907365794034231, 'auprc': 0.9396858682106364, 'loss_val': 0.7767924659671035, 'psi': 0.6103162949263083}-{'f1_val': 0.39651855440916606, 'auprc': 0.7878560948985789, 'loss_val': 0.868642148967014, 'psi': 0.5530535706049312}
[S13] START round=8 head_norm_before_train=1.286258 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.3716616846250217, 'auprc': 0.6880806736430128, 'loss_val': 0.9525971646175491, 'psi': 0.49822928023221813}-{'f1_val': 0.4163167573796875, 'auprc': 0.7421668665752739, 'loss_val': 1.019624768317823, 'psi': 0.546656801057922}
[S14] START round=8 head_norm_before_train=0.901763 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.104954 metrics={'f1_val': 0.3912389550782592, 'auprc': 0.9923749435282058, 'loss_val': 0.8986749678159951, 'psi': 0.6316933504582378}-{'f1_val': 0.3966267743617936, 'auprc': 0.9471150376152901, 'loss_val': 1.005130039885614, 'psi': 0.6168220796631922}
[S15] START round=8 head_norm_before_train=0.742263 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.021044 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7766325884901127, 'loss_val': 1.202601302103917, 'psi': 0.3944932262129801}-{'f1_val': 0.13973365136155833, 'auprc': 0.7758669933516124, 'loss_val': 1.2423917158921465, 'psi': 0.39418698815757997}
[S16] START round=8 head_norm_before_train=1.095983 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.040784 metrics={'f1_val': 0.42053538098129595, 'auprc': 0.4479332613489036, 'loss_val': 1.0608740707680642, 'psi': 0.43149453312833896}-{'f1_val': 0.41738655605465536, 'auprc': 0.44926879574861855, 'loss_val': 1.1275565742221674, 'psi': 0.4301394519322406}
[S17] START round=8 head_norm_before_train=0.805854 cos_to_last_merge=0.9955 (last merge round=6)
[S17] round=8 local utility u=0.716459 metrics={'f1_val': 0.3547534297160254, 'auprc': 0.5528933539076053, 'loss_val': 1.0512602091444903, 'psi': 0.43400939939265737}-{'f1_val': 0.14094896331738438, 'auprc': 0.5438669338153969, 'loss_val': 1.1742718126679912, 'psi': 0.3021161515165894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:63515
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:63507
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:63509
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1790) from S7
[S17] cosine check vs S7: cos=0.8189
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=-0.0429
[S15] DROPPED delta from S8 (cos=-0.0429 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] cosine check vs S5: cos=0.5910
[S17] RECEIVED delta(kind=head bytes=1792) from S10
[S17] cosine check vs S10: cos=0.4874
[S4] RECEIVED delta(kind=head bytes=1798) from S15
[S4] cosine check vs S15: cos=0.8522
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=0.9736
[S16] RECEIVED delta(kind=head bytes=1796) from S4
[S16] cosine check vs S4: cos=0.1106
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=-0.1110
[S7] DROPPED delta from S16 (cos=-0.1110 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] cosine check vs S3: cos=-0.0297
[S6] DROPPED delta from S3 (cos=-0.0297 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1790) from S11
[S5] cosine check vs S11: cos=0.9458
[S14] RECEIVED delta(kind=head bytes=1792) from S2
[S14] cosine check vs S2: cos=0.9538
[S8] RECEIVED delta(kind=head bytes=1795) from S14
[S8] cosine check vs S14: cos=0.8878
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S17
[S13] cosine check vs S17: cos=-0.0543
[S13] DROPPED delta from S17 (cos=-0.0543 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.1397 head_norm=0.764248
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.895645e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.1397 head_norm=0.755589 delta_norm=0.389565
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.3912 head_norm=0.947070
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.499796e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3959 head_norm=0.961473 delta_norm=0.149980
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.4152 head_norm=0.684545
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.006136e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.1402 head_norm=0.697204 delta_norm=0.200614
[S4] aggregate: ROLLBACK (f1_val pre=0.415 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.3914 head_norm=0.910747
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.207303e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.3914 head_norm=0.902485 delta_norm=0.220730
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.6465 head_norm=0.928049
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.817766e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.6615 head_norm=0.990947 delta_norm=0.181777
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4205 head_norm=1.120085
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.538191e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.3639 head_norm=0.940093 delta_norm=0.253819
[S16] aggregate: ROLLBACK (f1_val pre=0.421 post=0.364 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3548 head_norm=0.847812
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.510691e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3697 head_norm=0.841708 delta_norm=0.151069
[S17] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.998452 cos_to_last_merge=0.9328 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.933
[S2] round=9 local utility u=0.090715 metrics={'f1_val': 0.7141397964103724, 'auprc': 0.7604704410207688, 'loss_val': 0.7328872131764905, 'psi': 0.732672054254531}-{'f1_val': 0.7137509122518518, 'auprc': 0.7223760748134431, 'loss_val': 0.7977010434032445, 'psi': 0.7172009772764883}
[S3] START round=9 head_norm_before_train=1.097574 cos_to_last_merge=0.9204 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.4024484509855121, 'auprc': 0.7230057435367949, 'loss_val': 0.8425005741912412, 'psi': 0.5306713680060252}-{'f1_val': 0.39381786591190104, 'auprc': 0.998202292819306, 'loss_val': 0.7545996287487033, 'psi': 0.635571636674863}
[S4] START round=9 head_norm_before_train=0.697204 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.42654230067756355, 'auprc': 0.6636048930184872, 'loss_val': 0.9449148425850118, 'psi': 0.521367337613933}-{'f1_val': 0.41521773740003826, 'auprc': 0.7844653939228969, 'loss_val': 1.0265373548461993, 'psi': 0.5629168000091818}
[S5] START round=9 head_norm_before_train=0.990947 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.37155485817742906, 'auprc': 0.7715998299650924, 'loss_val': 0.8503319994482214, 'psi': 0.5315728468924944}-{'f1_val': 0.6465268089692466, 'auprc': 0.7776282687887581, 'loss_val': 0.9324300160608352, 'psi': 0.6989673928970512}
[S6] START round=9 head_norm_before_train=1.338958 (no previous merge yet)
[S6] round=9 local utility u=0.055560 metrics={'f1_val': 0.41605123052148413, 'auprc': 0.6650633216755517, 'loss_val': 0.6818090279658019, 'psi': 0.5156560669831112}-{'f1_val': 0.4166544795555117, 'auprc': 0.665020567543745, 'loss_val': 0.7964192702617743, 'psi': 0.516000914750805}
[S7] START round=9 head_norm_before_train=1.369727 (no previous merge yet)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7898935550538575, 'loss_val': 0.7963409626207087, 'psi': 0.5659834928881571}-{'f1_val': 0.4529051282966897, 'auprc': 0.7932421555355248, 'loss_val': 0.8416507965252452, 'psi': 0.5890399391922237}
[S8] START round=9 head_norm_before_train=0.902485 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.965466 metrics={'f1_val': 0.6826661760917605, 'auprc': 0.6346294187997548, 'loss_val': 1.0277096853284517, 'psi': 0.6634514731749581}-{'f1_val': 0.39141596466002504, 'auprc': 0.6009967500232337, 'loss_val': 1.1102427229682383, 'psi': 0.4752482788053085}
[S9] START round=9 head_norm_before_train=1.424928 (no previous merge yet)
[S9] round=9 local utility u=0.061477 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.999388672658703, 'loss_val': 0.30421313190720306, 'psi': 0.8205742696949867}-{'f1_val': 0.7014391336149548, 'auprc': 0.9995840156576625, 'loss_val': 0.42819968518854645, 'psi': 0.8206970864320379}
[S10] START round=9 head_norm_before_train=1.017390 cos_to_last_merge=0.9337 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.934
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.6304159970091038, 'auprc': 0.992177625930843, 'loss_val': 0.5636429822130208, 'psi': 0.7751206485777995}-{'f1_val': 0.7013654545499672, 'auprc': 0.9982947440487268, 'loss_val': 0.6282342147362526, 'psi': 0.8201371703494711}
[S11] START round=9 head_norm_before_train=1.081094 cos_to_last_merge=0.9007 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.901
[S11] round=9 local utility u=0.311179 metrics={'f1_val': 0.47558473700402193, 'auprc': 0.9399362106836803, 'loss_val': 0.6642750488829071, 'psi': 0.6613253264758853}-{'f1_val': 0.3907365794034231, 'auprc': 0.9396858682106364, 'loss_val': 0.7767924659671035, 'psi': 0.6103162949263083}
[S13] START round=9 head_norm_before_train=1.310453 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.37175581789750844, 'auprc': 0.6428804498426764, 'loss_val': 0.90602462836078, 'psi': 0.4802056706755756}-{'f1_val': 0.3716616846250217, 'auprc': 0.6880806736430128, 'loss_val': 0.9525971646175491, 'psi': 0.49822928023221813}
[S14] START round=9 head_norm_before_train=0.961473 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.504339 metrics={'f1_val': 0.5274464604712827, 'auprc': 0.9967166682161918, 'loss_val': 0.7202674154006607, 'psi': 0.7151545435692463}-{'f1_val': 0.3912389550782592, 'auprc': 0.9923749435282058, 'loss_val': 0.8986749678159951, 'psi': 0.6316933504582378}
[S15] START round=9 head_norm_before_train=0.755589 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.886261 metrics={'f1_val': 0.4157993423538048, 'auprc': 0.7770275359330654, 'loss_val': 1.0876592561207923, 'psi': 0.5602906197855091}-{'f1_val': 0.13973365136155833, 'auprc': 0.7766325884901127, 'loss_val': 1.202601302103917, 'psi': 0.3944932262129801}
[S16] START round=9 head_norm_before_train=0.940093 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.37933271850106304, 'auprc': 0.47103065626881335, 'loss_val': 0.9905639414302704, 'psi': 0.41601189360816315}-{'f1_val': 0.42053538098129595, 'auprc': 0.4479332613489036, 'loss_val': 1.0608740707680642, 'psi': 0.43149453312833896}
[S17] START round=9 head_norm_before_train=0.841708 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.187059 metrics={'f1_val': 0.3898303614792201, 'auprc': 0.5557909920077911, 'loss_val': 0.8962976523348998, 'psi': 0.45621461369064853}-{'f1_val': 0.3547534297160254, 'auprc': 0.5528933539076053, 'loss_val': 1.0512602091444903, 'psi': 0.43400939939265737}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:63505
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:63504
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] cosine check vs S14: cos=0.9371
[S15] RECEIVED delta(kind=head bytes=1805) from S6
[S15] cosine check vs S6: cos=0.3890
[S14] RECEIVED delta(kind=head bytes=1795) from S2
[S14] cosine check vs S2: cos=0.9701
[S15] RECEIVED delta(kind=head bytes=1792) from S8
[S15] cosine check vs S8: cos=-0.0352
[S15] DROPPED delta from S8 (cos=-0.0352 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1794) from S15
[S4] cosine check vs S15: cos=0.8367
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] cosine check vs S9: cos=0.9513
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] cosine check vs S11: cos=0.9677
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S17
[S13] cosine check vs S17: cos=-0.0572
[S13] DROPPED delta from S17 (cos=-0.0572 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.4265 head_norm=0.735033
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.187778e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.4144 head_norm=0.729070 delta_norm=0.218778
[S4] aggregate: ROLLBACK (f1_val pre=0.427 post=0.414 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.3716 head_norm=1.019811
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.487175e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.3716 head_norm=1.069605 delta_norm=0.148718
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.6827 head_norm=0.925841
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.758723e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.3914 head_norm=0.950846 delta_norm=0.175872
[S8] aggregate: ROLLBACK (f1_val pre=0.683 post=0.391 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.4158 head_norm=0.786473
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.476443e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.7151 head_norm=0.917353 delta_norm=0.647644
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.5274 head_norm=1.006428
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.285441e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.5266 head_norm=1.023698 delta_norm=0.128544
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3793 head_norm=0.971024
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.159590e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3334 head_norm=1.211237 delta_norm=0.315959
[S16] aggregate: ROLLBACK (f1_val pre=0.379 post=0.333 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=1.056440 cos_to_last_merge=0.9163 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.916
[S2] round=10 local utility u=0.057363 metrics={'f1_val': 0.7139368000590668, 'auprc': 0.7785782889866142, 'loss_val': 0.6712673849052052, 'psi': 0.7397933956300857}-{'f1_val': 0.7141397964103724, 'auprc': 0.7604704410207688, 'loss_val': 0.7328872131764905, 'psi': 0.732672054254531}
[S3] START round=10 head_norm_before_train=1.146383 cos_to_last_merge=0.9043 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=10 local utility u=1.000000 metrics={'f1_val': 0.6995739279432054, 'auprc': 0.9990595238185478, 'loss_val': 0.5284313825755182, 'psi': 0.8193681662933423}-{'f1_val': 0.4024484509855121, 'auprc': 0.7230057435367949, 'loss_val': 0.8425005741912412, 'psi': 0.5306713680060252}
[S4] START round=10 head_norm_before_train=0.729070 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.737365 metrics={'f1_val': 0.6663854665595623, 'auprc': 0.6537077405152931, 'loss_val': 0.8795519129407047, 'psi': 0.6613143761418546}-{'f1_val': 0.42654230067756355, 'auprc': 0.6636048930184872, 'loss_val': 0.9449148425850118, 'psi': 0.521367337613933}
[S5] START round=10 head_norm_before_train=1.069605 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=1.000000 metrics={'f1_val': 0.7146275168069246, 'auprc': 0.7948547590577593, 'loss_val': 0.7105235419286922, 'psi': 0.7467184137072584}-{'f1_val': 0.37155485817742906, 'auprc': 0.7715998299650924, 'loss_val': 0.8503319994482214, 'psi': 0.5315728468924944}
[S6] START round=10 head_norm_before_train=1.379645 (no previous merge yet)
[S6] round=10 local utility u=0.124311 metrics={'f1_val': 0.417656138684398, 'auprc': 0.7203281470371315, 'loss_val': 0.6086103935412212, 'psi': 0.5387249420254914}-{'f1_val': 0.41605123052148413, 'auprc': 0.6650633216755517, 'loss_val': 0.6818090279658019, 'psi': 0.5156560669831112}
[S7] START round=10 head_norm_before_train=1.402424 (no previous merge yet)
[S7] round=10 local utility u=0.025697 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7830321747104473, 'loss_val': 0.7255808491541244, 'psi': 0.5633607281456536}-{'f1_val': 0.41671011811102343, 'auprc': 0.7898935550538575, 'loss_val': 0.7963409626207087, 'psi': 0.5659834928881571}
[S8] START round=10 head_norm_before_train=0.950846 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.713058 metrics={'f1_val': 0.713537083467729, 'auprc': 0.998517233012273, 'loss_val': 0.8784832196881385, 'psi': 0.8275291432855467}-{'f1_val': 0.6826661760917605, 'auprc': 0.6346294187997548, 'loss_val': 1.0277096853284517, 'psi': 0.6634514731749581}
[S9] START round=10 head_norm_before_train=1.480191 (no previous merge yet)
[S9] round=10 local utility u=0.032731 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.998940325927641, 'loss_val': 0.23696155458562654, 'psi': 0.8203504204955945}-{'f1_val': 0.7013646677191758, 'auprc': 0.999388672658703, 'loss_val': 0.30421313190720306, 'psi': 0.8205742696949867}
[S10] START round=10 head_norm_before_train=1.062723 cos_to_last_merge=0.9180 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.918
[S10] round=10 local utility u=0.200911 metrics={'f1_val': 0.6896084979365251, 'auprc': 0.9878598215273147, 'loss_val': 0.504022464112761, 'psi': 0.808909027372841}-{'f1_val': 0.6304159970091038, 'auprc': 0.992177625930843, 'loss_val': 0.5636429822130208, 'psi': 0.7751206485777995}
[S11] START round=10 head_norm_before_train=1.136806 cos_to_last_merge=0.8827 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.883
[S11] round=10 local utility u=0.706526 metrics={'f1_val': 0.6951118805376592, 'auprc': 0.9410367899010608, 'loss_val': 0.571688298375959, 'psi': 0.7934818442830198}-{'f1_val': 0.47558473700402193, 'auprc': 0.9399362106836803, 'loss_val': 0.6642750488829071, 'psi': 0.6613253264758853}
[S13] START round=10 head_norm_before_train=1.337873 (no previous merge yet)
[S13] round=10 local utility u=0.540555 metrics={'f1_val': 0.46223108630138454, 'auprc': 0.7930392095748012, 'loss_val': 0.818242544784151, 'psi': 0.5945543356107512}-{'f1_val': 0.37175581789750844, 'auprc': 0.6428804498426764, 'loss_val': 0.90602462836078, 'psi': 0.4802056706755756}
[S14] START round=10 head_norm_before_train=1.023698 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.598844 metrics={'f1_val': 0.7015374514081609, 'auprc': 0.997360423182216, 'loss_val': 0.569056178830691, 'psi': 0.819866640117783}-{'f1_val': 0.5274464604712827, 'auprc': 0.9967166682161918, 'loss_val': 0.7202674154006607, 'psi': 0.7151545435692463}
[S15] START round=10 head_norm_before_train=0.917353 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.982759 metrics={'f1_val': 0.7152751555048662, 'auprc': 0.7943798835088792, 'loss_val': 0.9710536364095012, 'psi': 0.7469170467064714}-{'f1_val': 0.4157993423538048, 'auprc': 0.7770275359330654, 'loss_val': 1.0876592561207923, 'psi': 0.5602906197855091}
[S16] START round=10 head_norm_before_train=1.211237 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.258454 metrics={'f1_val': 0.3315898832958798, 'auprc': 0.7260006794442169, 'loss_val': 0.952108183032636, 'psi': 0.4893542017552146}-{'f1_val': 0.37933271850106304, 'auprc': 0.47103065626881335, 'loss_val': 0.9905639414302704, 'psi': 0.41601189360816315}
[S17] START round=10 head_norm_before_train=0.890691 cos_to_last_merge=0.9939 (last merge round=8)
[S17] round=10 local utility u=0.073241 metrics={'f1_val': 0.35302995561043005, 'auprc': 0.6783655422039377, 'loss_val': 0.8967360576402599, 'psi': 0.48316419024783314}-{'f1_val': 0.3898303614792201, 'auprc': 0.5557909920077911, 'loss_val': 0.8962976523348998, 'psi': 0.45621461369064853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] → sending delta(kind=head bytes=1808) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:63507
[S4] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1808 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1792) from S8
[S15] cosine check vs S8: cos=-0.0698
[S15] DROPPED delta from S8 (cos=-0.0698 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1808) from S6
[S15] cosine check vs S6: cos=0.8990
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] cosine check vs S7: cos=0.7937
[S17] RECEIVED delta(kind=head bytes=1799) from S10
[S17] cosine check vs S10: cos=0.5136
[S4] RECEIVED delta(kind=head bytes=1793) from S15
[S4] cosine check vs S15: cos=0.7924
[S16] RECEIVED delta(kind=head bytes=1796) from S4
[S16] cosine check vs S4: cos=0.0654
[S14] RECEIVED delta(kind=head bytes=1800) from S2
[S14] cosine check vs S2: cos=0.9781
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] cosine check vs S9: cos=0.9836
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=-0.1016
[S7] DROPPED delta from S16 (cos=-0.1016 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S3
[S6] cosine check vs S3: cos=-0.0389
[S6] DROPPED delta from S3 (cos=-0.0389 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] cosine check vs S11: cos=0.9771
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] cosine check vs S14: cos=0.9621
[S8] RECEIVED delta(kind=head bytes=1792) from S13
[S8] cosine check vs S13: cos=-0.0575
[S8] DROPPED delta from S13 (cos=-0.0575 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S5
[S15] cosine check vs S5: cos=0.4360
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1792 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1792) from S17
[S13] cosine check vs S17: cos=-0.0523
[S13] DROPPED delta from S17 (cos=-0.0523 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7146 head_norm=1.099216
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.306452e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7146 head_norm=1.138550 delta_norm=0.130645
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.491 → S15@127.0.0.1:63515
[S13] ⇄ pheromone p=0.328 → S8@127.0.0.1:63509
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.7153 head_norm=0.941759
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.520061e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.7147 head_norm=0.921224 delta_norm=0.152006
[S15] aggregate: ACCEPT kept=['S6', 'S5'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.458 → S4@127.0.0.1:63504
[S7] ⇄ pheromone p=0.237 → S17@127.0.0.1:63517
[S10] ⇄ pheromone p=0.345 → S17@127.0.0.1:63517
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.7015 head_norm=1.072769
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.158750e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.7017 head_norm=1.085625 delta_norm=0.115875
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.439 → S8@127.0.0.1:63509
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3316 head_norm=1.245172
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.875921e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3442 head_norm=1.025545 delta_norm=0.287592
[S16] aggregate: ACCEPT kept=['S4', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.248 → S7@127.0.0.1:63508
[S9] ⇄ pheromone p=0.330 → S16@127.0.0.1:63516
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6664 head_norm=0.772978
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.875174e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6682 head_norm=0.812118 delta_norm=0.287517
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.368 → S16@127.0.0.1:63516
[S11] ⇄ pheromone p=0.453 → S5@127.0.0.1:63505
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.7135 head_norm=0.986012
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.480700e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.7147 head_norm=1.019609 delta_norm=0.148070
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.526 → S15@127.0.0.1:63515
[S2] ⇄ pheromone p=0.336 → S14@127.0.0.1:63514
[S6] ⇄ pheromone p=0.264 → S15@127.0.0.1:63515
[S3] ⇄ pheromone p=0.454 → S6@127.0.0.1:63507
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3530 head_norm=0.946825
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.824429e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3526 head_norm=0.917192 delta_norm=0.182443
[S17] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.267 → S13@127.0.0.1:63513
[S2] START round=11 head_norm_before_train=1.110488 cos_to_last_merge=0.9026 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.903
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.6997710619262707, 'auprc': 0.7473101101708539, 'loss_val': 0.5293141755488645, 'psi': 0.7187866812241039}-{'f1_val': 0.7139368000590668, 'auprc': 0.7785782889866142, 'loss_val': 0.6712673849052052, 'psi': 0.7397933956300857}
[S3] START round=11 head_norm_before_train=1.195863 cos_to_last_merge=0.8889 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.889
[S3] round=11 local utility u=0.045601 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9988751801670461, 'loss_val': 0.4442240257446779, 'psi': 0.8200491130821048}-{'f1_val': 0.6995739279432054, 'auprc': 0.9990595238185478, 'loss_val': 0.5284313825755182, 'psi': 0.8193681662933423}
[S4] START round=11 head_norm_before_train=0.812118 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.085407 metrics={'f1_val': 0.6692288541366607, 'auprc': 0.6630704279441744, 'loss_val': 0.7538868789888573, 'psi': 0.6667654836596661}-{'f1_val': 0.6663854665595623, 'auprc': 0.6537077405152931, 'loss_val': 0.8795519129407047, 'psi': 0.6613143761418546}
[S5] START round=11 head_norm_before_train=1.138550 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.053414 metrics={'f1_val': 0.7130736608813009, 'auprc': 0.8001985416805732, 'loss_val': 0.6104044155483965, 'psi': 0.7479236132010099}-{'f1_val': 0.7146275168069246, 'auprc': 0.7948547590577593, 'loss_val': 0.7105235419286922, 'psi': 0.7467184137072584}
[S6] START round=11 head_norm_before_train=1.417086 (no previous merge yet)
[S6] round=11 local utility u=0.992985 metrics={'f1_val': 0.699176859263281, 'auprc': 0.7748350108498208, 'loss_val': 0.4752859554790651, 'psi': 0.7294401198978969}-{'f1_val': 0.417656138684398, 'auprc': 0.7203281470371315, 'loss_val': 0.6086103935412212, 'psi': 0.5387249420254914}
[S7] START round=11 head_norm_before_train=1.432642 (no previous merge yet)
[S7] round=11 local utility u=0.352037 metrics={'f1_val': 0.498035282911033, 'auprc': 0.8738488621533109, 'loss_val': 0.7806893968237953, 'psi': 0.6483607146079442}-{'f1_val': 0.4169130971024577, 'auprc': 0.7830321747104473, 'loss_val': 0.7255808491541244, 'psi': 0.5633607281456536}
[S8] START round=11 head_norm_before_train=1.019609 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.3727318090052443, 'auprc': 0.9923572979297809, 'loss_val': 0.7923091593149085, 'psi': 0.620582004575059}-{'f1_val': 0.713537083467729, 'auprc': 0.998517233012273, 'loss_val': 0.8784832196881385, 'psi': 0.8275291432855467}
[S9] START round=11 head_norm_before_train=1.530995 (no previous merge yet)
[S9] round=11 local utility u=0.017957 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9987298483992153, 'loss_val': 0.19997268688420886, 'psi': 0.8202218878236973}-{'f1_val': 0.7012904835408967, 'auprc': 0.998940325927641, 'loss_val': 0.23696155458562654, 'psi': 0.8203504204955945}
[S10] START round=11 head_norm_before_train=1.109004 cos_to_last_merge=0.9041 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.904
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.6985606309256568, 'auprc': 0.9108679967160049, 'loss_val': 0.4443722414725633, 'psi': 0.7834835772417961}-{'f1_val': 0.6896084979365251, 'auprc': 0.9878598215273147, 'loss_val': 0.504022464112761, 'psi': 0.808909027372841}
[S11] START round=11 head_norm_before_train=1.190989 cos_to_last_merge=0.8672 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.867
[S11] round=11 local utility u=0.059934 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9269159672025382, 'loss_val': 0.4507905460103161, 'psi': 0.7919668524485546}-{'f1_val': 0.6951118805376592, 'auprc': 0.9410367899010608, 'loss_val': 0.571688298375959, 'psi': 0.7934818442830198}
[S13] START round=11 head_norm_before_train=1.372392 (no previous merge yet)
[S13] round=11 local utility u=0.843848 metrics={'f1_val': 0.7130944222777218, 'auprc': 0.8078849578332978, 'loss_val': 0.6802642156075177, 'psi': 0.7510106364999523}-{'f1_val': 0.46223108630138454, 'auprc': 0.7930392095748012, 'loss_val': 0.818242544784151, 'psi': 0.5945543356107512}
[S14] START round=11 head_norm_before_train=1.085625 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.742597 metrics={'f1_val': 0.9305492172165444, 'auprc': 0.9988334244574556, 'loss_val': 0.4623516729360941, 'psi': 0.9578629001129089}-{'f1_val': 0.7015374514081609, 'auprc': 0.997360423182216, 'loss_val': 0.569056178830691, 'psi': 0.819866640117783}
[S15] START round=11 head_norm_before_train=0.921224 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.047233 metrics={'f1_val': 0.697133665547196, 'auprc': 0.794152841404806, 'loss_val': 0.7670580504195664, 'psi': 0.73594133589024}-{'f1_val': 0.7152751555048662, 'auprc': 0.7943798835088792, 'loss_val': 0.9710536364095012, 'psi': 0.7469170467064714}
[S16] START round=11 head_norm_before_train=1.025545 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.217928 metrics={'f1_val': 0.37758073740568854, 'auprc': 0.7543795166262874, 'loss_val': 0.8773345108019812, 'psi': 0.5283002490939281}-{'f1_val': 0.3315898832958798, 'auprc': 0.7260006794442169, 'loss_val': 0.952108183032636, 'psi': 0.4893542017552146}
[S17] START round=11 head_norm_before_train=0.917192 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.336370720216993, 'auprc': 0.6587958917830218, 'loss_val': 1.020078390010131, 'psi': 0.4653407888434045}-{'f1_val': 0.35302995561043005, 'auprc': 0.6783655422039377, 'loss_val': 0.8967360576402599, 'psi': 0.48316419024783314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:63509
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:63517
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:63504
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S16] → sending delta(kind=head bytes=1786) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:63509
[S9] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1786 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S11
[S5] cosine check vs S11: cos=0.9846
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] cosine check vs S14: cos=0.9725
[S15] RECEIVED delta(kind=head bytes=1802) from S6
[S15] cosine check vs S6: cos=0.8413
[S15] RECEIVED delta(kind=head bytes=1796) from S5
[S15] cosine check vs S5: cos=0.5548
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] cosine check vs S7: cos=0.8000
[S4] RECEIVED delta(kind=head bytes=1792) from S15
[S4] cosine check vs S15: cos=0.9425
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] cosine check vs S9: cos=0.9543
[S8] RECEIVED delta(kind=head bytes=1793) from S13
[S8] cosine check vs S13: cos=-0.0444
[S8] DROPPED delta from S13 (cos=-0.0444 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1786) from S16
[S7] cosine check vs S16: cos=-0.1008
[S7] DROPPED delta from S16 (cos=-0.1008 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S4
[S16] cosine check vs S4: cos=0.2248
[S6] RECEIVED delta(kind=head bytes=1796) from S3
[S6] cosine check vs S3: cos=-0.0439
[S6] DROPPED delta from S3 (cos=-0.0439 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.3727 head_norm=1.065263
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.332367e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.3727 head_norm=1.091798 delta_norm=0.133237
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.3776 head_norm=1.064655
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.757919e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.4003 head_norm=0.966889 delta_norm=0.175792
[S16] aggregate: ACCEPT kept=['S9', 'S4'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.6971 head_norm=0.955575
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.105466e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.6958 head_norm=0.950211 delta_norm=0.110547
[S15] aggregate: ACCEPT kept=['S6', 'S5'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7131 head_norm=1.163314
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.144225e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7102 head_norm=1.201947 delta_norm=0.114423
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6692 head_norm=0.859307
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.609954e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6688 head_norm=0.894341 delta_norm=0.160995
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3364 head_norm=0.967723
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.491110e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3362 head_norm=1.153902 delta_norm=0.449111
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.161263 cos_to_last_merge=0.8904 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.890
[S2] round=12 local utility u=0.111042 metrics={'f1_val': 0.6995103141566394, 'auprc': 0.7951346005689821, 'loss_val': 0.44913823255595553, 'psi': 0.7377600287215765}-{'f1_val': 0.6997710619262707, 'auprc': 0.7473101101708539, 'loss_val': 0.5293141755488645, 'psi': 0.7187866812241039}
[S3] START round=12 head_norm_before_train=1.241143 cos_to_last_merge=0.8754 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.875
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.6957981540986701, 'auprc': 0.99732818563086, 'loss_val': 0.41124160793610476, 'psi': 0.8164101667115461}-{'f1_val': 0.7008317350254774, 'auprc': 0.9988751801670461, 'loss_val': 0.4442240257446779, 'psi': 0.8200491130821048}
[S4] START round=12 head_norm_before_train=0.894341 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.387920 metrics={'f1_val': 0.685911683989495, 'auprc': 0.8588327855263489, 'loss_val': 0.665430066700202, 'psi': 0.7550801246042365}-{'f1_val': 0.6692288541366607, 'auprc': 0.6630704279441744, 'loss_val': 0.7538868789888573, 'psi': 0.6667654836596661}
[S5] START round=12 head_norm_before_train=1.201947 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.287488 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9934644970958104, 'loss_val': 0.5387119240821856, 'psi': 0.8175785892986724}-{'f1_val': 0.7130736608813009, 'auprc': 0.8001985416805732, 'loss_val': 0.6104044155483965, 'psi': 0.7479236132010099}
[S6] START round=12 head_norm_before_train=1.448609 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6713484258981219, 'auprc': 0.7910772512036937, 'loss_val': 0.519638629599331, 'psi': 0.7192399560203506}-{'f1_val': 0.699176859263281, 'auprc': 0.7748350108498208, 'loss_val': 0.4752859554790651, 'psi': 0.7294401198978969}
[S7] START round=12 head_norm_before_train=1.459415 (no previous merge yet)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.4992129616856797, 'auprc': 0.7942338890756269, 'loss_val': 0.7682390467193569, 'psi': 0.6172213326416586}-{'f1_val': 0.498035282911033, 'auprc': 0.8738488621533109, 'loss_val': 0.7806893968237953, 'psi': 0.6483607146079442}
[S8] START round=12 head_norm_before_train=1.091798 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.050690 metrics={'f1_val': 0.3727983816295533, 'auprc': 0.9949130644693283, 'loss_val': 0.6989956300771828, 'psi': 0.6216442547654633}-{'f1_val': 0.3727318090052443, 'auprc': 0.9923572979297809, 'loss_val': 0.7923091593149085, 'psi': 0.620582004575059}
[S9] START round=12 head_norm_before_train=1.577078 (no previous merge yet)
[S9] round=12 local utility u=0.912160 metrics={'f1_val': 0.9937350633245463, 'auprc': 0.9988665473615937, 'loss_val': 0.131173178742415, 'psi': 0.9957876569393652}-{'f1_val': 0.7012165807733519, 'auprc': 0.9987298483992153, 'loss_val': 0.19997268688420886, 'psi': 0.8202218878236973}
[S10] START round=12 head_norm_before_train=1.158877 cos_to_last_merge=0.8921 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.892
[S10] round=12 local utility u=0.138479 metrics={'f1_val': 0.6885969159024345, 'auprc': 0.9969041528960754, 'loss_val': 0.365739580151538, 'psi': 0.8119198106998908}-{'f1_val': 0.6985606309256568, 'auprc': 0.9108679967160049, 'loss_val': 0.4443722414725633, 'psi': 0.7834835772417961}
[S11] START round=12 head_norm_before_train=1.249895 cos_to_last_merge=0.8540 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.854
[S11] round=12 local utility u=0.028973 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9182012728909207, 'loss_val': 0.3663069574698383, 'psi': 0.7884416991353603}-{'f1_val': 0.7020007759458987, 'auprc': 0.9269159672025382, 'loss_val': 0.4507905460103161, 'psi': 0.7919668524485546}
[S13] START round=12 head_norm_before_train=1.411761 (no previous merge yet)
[S13] round=12 local utility u=0.065492 metrics={'f1_val': 0.7132262943575028, 'auprc': 0.8077100356345389, 'loss_val': 0.5495460243903706, 'psi': 0.7510197908683174}-{'f1_val': 0.7130944222777218, 'auprc': 0.8078849578332978, 'loss_val': 0.6802642156075177, 'psi': 0.7510106364999523}
[S14] START round=12 head_norm_before_train=1.133475 cos_to_last_merge=0.9974 (last merge round=10)
[S14] round=12 local utility u=0.256326 metrics={'f1_val': 0.9971867406506559, 'auprc': 0.9988470027757916, 'loss_val': 0.34956612593251046, 'psi': 0.9978508455007102}-{'f1_val': 0.9305492172165444, 'auprc': 0.9988334244574556, 'loss_val': 0.4623516729360941, 'psi': 0.9578629001129089}
[S15] START round=12 head_norm_before_train=0.950211 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.074193 metrics={'f1_val': 0.69807863613385, 'auprc': 0.7940718505851734, 'loss_val': 0.6240984174143968, 'psi': 0.7364759219143794}-{'f1_val': 0.697133665547196, 'auprc': 0.794152841404806, 'loss_val': 0.7670580504195664, 'psi': 0.73594133589024}
[S16] START round=12 head_norm_before_train=0.966889 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.106987 metrics={'f1_val': 0.40732502489786465, 'auprc': 0.7576310215932043, 'loss_val': 0.8515806324385724, 'psi': 0.5474474235760005}-{'f1_val': 0.37758073740568854, 'auprc': 0.7543795166262874, 'loss_val': 0.8773345108019812, 'psi': 0.5283002490939281}
[S17] START round=12 head_norm_before_train=1.153902 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.2463529332814226, 'auprc': 0.635749520211291, 'loss_val': 1.264610972917735, 'psi': 0.40211156805337}-{'f1_val': 0.336370720216993, 'auprc': 0.6587958917830218, 'loss_val': 1.020078390010131, 'psi': 0.4653407888434045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:63514
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:63516
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:63515
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S2
[S14] cosine check vs S2: cos=0.9691
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=0.9206
[S5] RECEIVED delta(kind=head bytes=1795) from S11
[S5] cosine check vs S11: cos=0.9901
[S8] RECEIVED delta(kind=head bytes=1805) from S14
[S8] cosine check vs S14: cos=0.9826
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=-0.0699
[S15] DROPPED delta from S8 (cos=-0.0699 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1793) from S5
[S15] cosine check vs S5: cos=0.6155
[S4] RECEIVED delta(kind=head bytes=1793) from S15
[S4] cosine check vs S15: cos=0.9622
[S17] RECEIVED delta(kind=head bytes=1802) from S10
[S17] cosine check vs S10: cos=0.2670
[S7] RECEIVED delta(kind=head bytes=1792) from S16
[S7] cosine check vs S16: cos=-0.0972
[S7] DROPPED delta from S16 (cos=-0.0972 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S13
[S8] cosine check vs S13: cos=-0.0344
[S8] DROPPED delta from S13 (cos=-0.0344 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S4
[S16] cosine check vs S4: cos=0.3413
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.6981 head_norm=0.990445
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.970745e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.6962 head_norm=0.997053 delta_norm=0.497074
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.4073 head_norm=1.013931
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.288430e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.6165 head_norm=0.967102 delta_norm=0.128843
[S16] aggregate: ACCEPT kept=['S9', 'S4'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7003 head_norm=1.225323
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.829826e-02
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7003 head_norm=1.263366 delta_norm=0.098298
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.3728 head_norm=1.142181
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.102989e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.3727 head_norm=1.157241 delta_norm=0.110299
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9972 head_norm=1.182442
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.493530e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.9955 head_norm=1.186626 delta_norm=0.149353
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6859 head_norm=0.945277
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.349267e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6874 head_norm=0.958676 delta_norm=0.134927
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.2464 head_norm=1.191655
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.270327e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.2365 head_norm=0.955818 delta_norm=0.727033
[S17] aggregate: ROLLBACK (f1_val pre=0.246 post=0.236 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.209383 cos_to_last_merge=0.8791 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.879
[S2] round=13 local utility u=0.030056 metrics={'f1_val': 0.7002291620262046, 'auprc': 0.7936189015773153, 'loss_val': 0.3887914887529492, 'psi': 0.737585057846649}-{'f1_val': 0.6995103141566394, 'auprc': 0.7951346005689821, 'loss_val': 0.44913823255595553, 'psi': 0.7377600287215765}
[S3] START round=13 head_norm_before_train=1.283766 cos_to_last_merge=0.8628 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.863
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.6303109830779203, 'auprc': 0.9923467418491698, 'loss_val': 0.45571839760185295, 'psi': 0.7751252865864202}-{'f1_val': 0.6957981540986701, 'auprc': 0.99732818563086, 'loss_val': 0.41124160793610476, 'psi': 0.8164101667115461}
[S4] START round=13 head_norm_before_train=0.958676 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.6727703252532061, 'auprc': 0.8559310562086468, 'loss_val': 0.5917288407963338, 'psi': 0.7460346176353825}-{'f1_val': 0.685911683989495, 'auprc': 0.8588327855263489, 'loss_val': 0.665430066700202, 'psi': 0.7550801246042365}
[S5] START round=13 head_norm_before_train=1.263366 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.036705 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9945218975709456, 'loss_val': 0.46846938630193735, 'psi': 0.8180011181231936}-{'f1_val': 0.7003213174339138, 'auprc': 0.9934644970958104, 'loss_val': 0.5387119240821856, 'psi': 0.8175785892986724}
[S6] START round=13 head_norm_before_train=1.484145 (no previous merge yet)
[S6] round=13 local utility u=0.067025 metrics={'f1_val': 0.6803543570557127, 'auprc': 0.7936812972653601, 'loss_val': 0.44743701076737996, 'psi': 0.7256851331395716}-{'f1_val': 0.6713484258981219, 'auprc': 0.7910772512036937, 'loss_val': 0.519638629599331, 'psi': 0.7192399560203506}
[S7] START round=13 head_norm_before_train=1.483358 (no previous merge yet)
[S7] round=13 local utility u=0.593073 metrics={'f1_val': 0.6500600722910435, 'auprc': 0.8297004766675662, 'loss_val': 0.5935760872220437, 'psi': 0.7219162340416525}-{'f1_val': 0.4992129616856797, 'auprc': 0.7942338890756269, 'loss_val': 0.7682390467193569, 'psi': 0.6172213326416586}
[S8] START round=13 head_norm_before_train=1.157241 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.046241 metrics={'f1_val': 0.37266438550987346, 'auprc': 0.9949896343960433, 'loss_val': 0.6059387259310554, 'psi': 0.6215944850643415}-{'f1_val': 0.3727983816295533, 'auprc': 0.9949130644693283, 'loss_val': 0.6989956300771828, 'psi': 0.6216442547654633}
[S9] START round=13 head_norm_before_train=1.617942 (no previous merge yet)
[S9] round=13 local utility u=0.021485 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9992131986705292, 'loss_val': 0.08928490071993177, 'psi': 0.9959305844620367}-{'f1_val': 0.9937350633245463, 'auprc': 0.9988665473615937, 'loss_val': 0.131173178742415, 'psi': 0.9957876569393652}
[S10] START round=13 head_norm_before_train=1.210078 cos_to_last_merge=0.8811 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.881
[S10] round=13 local utility u=0.028658 metrics={'f1_val': 0.6889385471580445, 'auprc': 0.9967839309114797, 'loss_val': 0.310112855150041, 'psi': 0.8120767006594185}-{'f1_val': 0.6885969159024345, 'auprc': 0.9969041528960754, 'loss_val': 0.365739580151538, 'psi': 0.8119198106998908}
[S11] START round=13 head_norm_before_train=1.307706 cos_to_last_merge=0.8432 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.843
[S11] round=13 local utility u=0.090502 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9612822887644327, 'loss_val': 0.3145450479784251, 'psi': 0.8056741054847651}-{'f1_val': 0.7019353166316534, 'auprc': 0.9182012728909207, 'loss_val': 0.3663069574698383, 'psi': 0.7884416991353603}
[S13] START round=13 head_norm_before_train=1.444923 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.7102786495363854, 'auprc': 0.8098546204689077, 'loss_val': 0.5549790571487371, 'psi': 0.7501090379093944}-{'f1_val': 0.7132262943575028, 'auprc': 0.8077100356345389, 'loss_val': 0.5495460243903706, 'psi': 0.7510197908683174}
[S14] START round=13 head_norm_before_train=1.186626 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.028495 metrics={'f1_val': 0.9978207838439215, 'auprc': 0.9987836526955125, 'loss_val': 0.29619123556760246, 'psi': 0.9982059313845579}-{'f1_val': 0.9971867406506559, 'auprc': 0.9988470027757916, 'loss_val': 0.34956612593251046, 'psi': 0.9978508455007102}
[S15] START round=13 head_norm_before_train=0.997053 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.312170 metrics={'f1_val': 0.6928821345102002, 'auprc': 0.9860942077087234, 'loss_val': 0.544646098758741, 'psi': 0.8101669637896094}-{'f1_val': 0.69807863613385, 'auprc': 0.7940718505851734, 'loss_val': 0.6240984174143968, 'psi': 0.7364759219143794}
[S16] START round=13 head_norm_before_train=0.967102 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=1.000000 metrics={'f1_val': 0.8158604056408274, 'auprc': 0.7762571572965427, 'loss_val': 0.7977605793710646, 'psi': 0.8000191063031135}-{'f1_val': 0.40732502489786465, 'auprc': 0.7576310215932043, 'loss_val': 0.8515806324385724, 'psi': 0.5474474235760005}
[S17] START round=13 head_norm_before_train=0.955818 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.500954 metrics={'f1_val': 0.352263956233478, 'auprc': 0.6491335225279231, 'loss_val': 0.9383218729050221, 'psi': 0.471011782751256}-{'f1_val': 0.2463529332814226, 'auprc': 0.635749520211291, 'loss_val': 1.264610972917735, 'psi': 0.40211156805337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:63515
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:63517
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:63515
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] → sending delta(kind=head bytes=1789) to S13@127.0.0.1:63513
[S14] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1790) from S15
[S4] cosine check vs S15: cos=0.8500
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] cosine check vs S14: cos=0.9834
[S15] RECEIVED delta(kind=head bytes=1796) from S5
[S15] cosine check vs S5: cos=0.9105
[S5] RECEIVED delta(kind=head bytes=1794) from S11
[S5] cosine check vs S11: cos=0.9934
[S16] RECEIVED delta(kind=head bytes=1796) from S9
[S16] cosine check vs S9: cos=0.8922
[S7] RECEIVED delta(kind=head bytes=1794) from S16
[S7] cosine check vs S16: cos=-0.0912
[S7] DROPPED delta from S16 (cos=-0.0912 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S10
[S17] cosine check vs S10: cos=0.7818
[S14] RECEIVED delta(kind=head bytes=1799) from S2
[S14] cosine check vs S2: cos=0.9821
[S15] RECEIVED delta(kind=head bytes=1806) from S6
[S15] cosine check vs S6: cos=0.4332
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=-0.0420
[S15] DROPPED delta from S8 (cos=-0.0420 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S7
[S17] cosine check vs S7: cos=0.6297
[S17] sending update (kind=head size=1789 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1789) from S17
[S13] cosine check vs S17: cos=-0.0728
[S13] DROPPED delta from S17 (cos=-0.0728 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6728 head_norm=1.011160
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.814827e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6739 head_norm=0.987192 delta_norm=0.281483
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.7003 head_norm=1.287126
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.347432e-02
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.7003 head_norm=1.319533 delta_norm=0.083474
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6929 head_norm=1.041689
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.382087e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6922 head_norm=1.004571 delta_norm=0.238209
[S15] aggregate: ACCEPT kept=['S5', 'S6'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.3727 head_norm=1.202806
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.118676e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.3727 head_norm=1.212936 delta_norm=0.111868
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3523 head_norm=0.987033
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.418884e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3683 head_norm=0.985925 delta_norm=0.141888
[S17] aggregate: ACCEPT kept=['S10', 'S7'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.8159 head_norm=1.015866
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.385026e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.8120 head_norm=1.300398 delta_norm=0.438503
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.9978 head_norm=1.233173
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.180869e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.9979 head_norm=1.238657 delta_norm=0.118087
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.255275 cos_to_last_merge=0.8685 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.868
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.6995103141566394, 'auprc': 0.7381886608553158, 'loss_val': 0.3494699180069222, 'psi': 0.7149816528361099}-{'f1_val': 0.7002291620262046, 'auprc': 0.7936189015773153, 'loss_val': 0.3887914887529492, 'psi': 0.737585057846649}
[S3] START round=14 head_norm_before_train=1.321389 cos_to_last_merge=0.8515 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.851
[S3] round=14 local utility u=0.242160 metrics={'f1_val': 0.6930047378052776, 'auprc': 0.9931292705492499, 'loss_val': 0.3499078749824651, 'psi': 0.8130545509028666}-{'f1_val': 0.6303109830779203, 'auprc': 0.9923467418491698, 'loss_val': 0.45571839760185295, 'psi': 0.7751252865864202}
[S4] START round=14 head_norm_before_train=0.987192 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.6651329170242223, 'auprc': 0.65589631179737, 'loss_val': 0.5791180502239589, 'psi': 0.6614382749334813}-{'f1_val': 0.6727703252532061, 'auprc': 0.8559310562086468, 'loss_val': 0.5917288407963338, 'psi': 0.7460346176353825}
[S5] START round=14 head_norm_before_train=1.319533 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.020712 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9945680746567169, 'loss_val': 0.4271832766031203, 'psi': 0.8180195889575022}-{'f1_val': 0.700320598491359, 'auprc': 0.9945218975709456, 'loss_val': 0.46846938630193735, 'psi': 0.8180011181231936}
[S6] START round=14 head_norm_before_train=1.515852 (no previous merge yet)
[S6] round=14 local utility u=0.074941 metrics={'f1_val': 0.6975990075831962, 'auprc': 0.7943317994314752, 'loss_val': 0.4029749798288135, 'psi': 0.7362921243225078}-{'f1_val': 0.6803543570557127, 'auprc': 0.7936812972653601, 'loss_val': 0.44743701076737996, 'psi': 0.7256851331395716}
[S7] START round=14 head_norm_before_train=1.503914 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.3945312424340336, 'auprc': 0.7688477232819049, 'loss_val': 1.0287678003611602, 'psi': 0.5442578347731821}-{'f1_val': 0.6500600722910435, 'auprc': 0.8297004766675662, 'loss_val': 0.5935760872220437, 'psi': 0.7219162340416525}
[S8] START round=14 head_norm_before_train=1.212936 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.016197 metrics={'f1_val': 0.37266438550987346, 'auprc': 0.9930872196179948, 'loss_val': 0.5678366525337571, 'psi': 0.620833519153122}-{'f1_val': 0.37266438550987346, 'auprc': 0.9949896343960433, 'loss_val': 0.6059387259310554, 'psi': 0.6215944850643415}
[S9] START round=14 head_norm_before_train=1.653680 (no previous merge yet)
[S9] round=14 local utility u=0.016117 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9991362583448953, 'loss_val': 0.06183281982996444, 'psi': 0.9964010120335249}-{'f1_val': 0.9937421749897083, 'auprc': 0.9992131986705292, 'loss_val': 0.08928490071993177, 'psi': 0.9959305844620367}
[S10] START round=14 head_norm_before_train=1.255811 cos_to_last_merge=0.8705 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.871
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.5769635343738924, 'auprc': 0.9020008370270922, 'loss_val': 0.39480662310172776, 'psi': 0.7069784554351723}-{'f1_val': 0.6889385471580445, 'auprc': 0.9967839309114797, 'loss_val': 0.310112855150041, 'psi': 0.8120767006594185}
[S11] START round=14 head_norm_before_train=1.356310 cos_to_last_merge=0.8354 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.835
[S11] round=14 local utility u=0.051948 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9895410466115755, 'loss_val': 0.29542441486458365, 'psi': 0.8169776086236222}-{'f1_val': 0.7019353166316534, 'auprc': 0.9612822887644327, 'loss_val': 0.3145450479784251, 'psi': 0.8056741054847651}
[S13] START round=14 head_norm_before_train=1.472057 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6895065759797523, 'auprc': 0.8267910998400646, 'loss_val': 0.5552957137846635, 'psi': 0.7444203855238771}-{'f1_val': 0.7102786495363854, 'auprc': 0.8098546204689077, 'loss_val': 0.5549790571487371, 'psi': 0.7501090379093944}
[S14] START round=14 head_norm_before_train=1.238657 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.021047 metrics={'f1_val': 0.998107494697275, 'auprc': 0.9987997429231494, 'loss_val': 0.25586537455477737, 'psi': 0.9983843939876247}-{'f1_val': 0.9978207838439215, 'auprc': 0.9987836526955125, 'loss_val': 0.29619123556760246, 'psi': 0.9982059313845579}
[S15] START round=14 head_norm_before_train=1.004571 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.063421 metrics={'f1_val': 0.6989963398331794, 'auprc': 0.986683473740806, 'loss_val': 0.4562575960745806, 'psi': 0.8140711933962301}-{'f1_val': 0.6928821345102002, 'auprc': 0.9860942077087234, 'loss_val': 0.544646098758741, 'psi': 0.8101669637896094}
[S16] START round=14 head_norm_before_train=1.300398 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.747406244745218, 'auprc': 0.8117093842756141, 'loss_val': 0.6873082617709065, 'psi': 0.7731275005573764}-{'f1_val': 0.8158604056408274, 'auprc': 0.7762571572965427, 'loss_val': 0.7977605793710646, 'psi': 0.8000191063031135}
[S17] START round=14 head_norm_before_train=0.985925 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.143254 metrics={'f1_val': 0.361345893654092, 'auprc': 0.7106867336702851, 'loss_val': 0.8909646088190993, 'psi': 0.5010822296605693}-{'f1_val': 0.352263956233478, 'auprc': 0.6491335225279231, 'loss_val': 0.9383218729050221, 'psi': 0.471011782751256}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:63516
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:63509
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:63507
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:63505
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:63515
[S5] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S3
[S6] cosine check vs S3: cos=-0.0513
[S6] DROPPED delta from S3 (cos=-0.0513 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] cosine check vs S14: cos=0.9862
[S15] RECEIVED delta(kind=head bytes=1803) from S6
[S15] cosine check vs S6: cos=0.6129
[S5] RECEIVED delta(kind=head bytes=1792) from S11
[S5] cosine check vs S11: cos=0.9955
[S15] RECEIVED delta(kind=head bytes=1793) from S5
[S15] cosine check vs S5: cos=0.8106
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] cosine check vs S9: cos=0.9774
[S15] RECEIVED delta(kind=head bytes=1803) from S8
[S15] cosine check vs S8: cos=-0.0586
[S15] DROPPED delta from S8 (cos=-0.0586 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S15
[S4] cosine check vs S15: cos=0.9759
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=-0.0765
[S13] DROPPED delta from S17 (cos=-0.0765 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.6651 head_norm=1.041556
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.147265e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.6651 head_norm=1.038913 delta_norm=0.114726
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7003 head_norm=1.339763
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.994145e-02
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7003 head_norm=1.364960 delta_norm=0.069941
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.3727 head_norm=1.255658
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.064596e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.3739 head_norm=1.264777 delta_norm=0.106460
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6990 head_norm=1.048888
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.379187e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6983 head_norm=1.041967 delta_norm=0.137919
[S15] aggregate: ACCEPT kept=['S6', 'S5'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.7474 head_norm=1.347375
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.331053e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.7611 head_norm=1.508083 delta_norm=0.233105
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.300850 cos_to_last_merge=0.8578 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.858
[S2] round=15 local utility u=0.081261 metrics={'f1_val': 0.7005280643985495, 'auprc': 0.7965669217112891, 'loss_val': 0.36819019772827644, 'psi': 0.7389436073236454}-{'f1_val': 0.6995103141566394, 'auprc': 0.7381886608553158, 'loss_val': 0.3494699180069222, 'psi': 0.7149816528361099}
[S3] START round=15 head_norm_before_train=1.358115 cos_to_last_merge=0.8412 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.841
[S3] round=15 local utility u=0.065503 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9969440728165238, 'loss_val': 0.27685453563074086, 'psi': 0.8192313513677894}-{'f1_val': 0.6930047378052776, 'auprc': 0.9931292705492499, 'loss_val': 0.3499078749824651, 'psi': 0.8130545509028666}
[S4] START round=15 head_norm_before_train=1.038913 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.322285 metrics={'f1_val': 0.6642136680720184, 'auprc': 0.8552462940852756, 'loss_val': 0.5270816658510972, 'psi': 0.7406267184773213}-{'f1_val': 0.6651329170242223, 'auprc': 0.65589631179737, 'loss_val': 0.5791180502239589, 'psi': 0.6614382749334813}
[S5] START round=15 head_norm_before_train=1.364960 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7105142190171496, 'auprc': 0.7921845555776601, 'loss_val': 0.4495964262118937, 'psi': 0.7431823536413538}-{'f1_val': 0.700320598491359, 'auprc': 0.9945680746567169, 'loss_val': 0.4271832766031203, 'psi': 0.8180195889575022}
[S6] START round=15 head_norm_before_train=1.546803 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.6823591651007158, 'auprc': 0.8016648785246197, 'loss_val': 0.3673230629512037, 'psi': 0.7300814504702773}-{'f1_val': 0.6975990075831962, 'auprc': 0.7943317994314752, 'loss_val': 0.4029749798288135, 'psi': 0.7362921243225078}
[S7] START round=15 head_norm_before_train=1.519760 (no previous merge yet)
[S7] round=15 local utility u=0.883002 metrics={'f1_val': 0.6127583448604375, 'auprc': 0.7958642607687149, 'loss_val': 0.6531761123750411, 'psi': 0.6860007112237485}-{'f1_val': 0.3945312424340336, 'auprc': 0.7688477232819049, 'loss_val': 1.0287678003611602, 'psi': 0.5442578347731821}
[S8] START round=15 head_norm_before_train=1.264777 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.814591 metrics={'f1_val': 0.6312210764411295, 'auprc': 0.9947390771915499, 'loss_val': 0.494949470225426, 'psi': 0.7766282767412975}-{'f1_val': 0.37266438550987346, 'auprc': 0.9930872196179948, 'loss_val': 0.5678366525337571, 'psi': 0.620833519153122}
[S9] START round=15 head_norm_before_train=1.685790 (no previous merge yet)
[S9] round=15 local utility u=0.005464 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.999045231608966, 'loss_val': 0.048128080030635505, 'psi': 0.9961141526672603}-{'f1_val': 0.9945775144926113, 'auprc': 0.9991362583448953, 'loss_val': 0.06183281982996444, 'psi': 0.9964010120335249}
[S10] START round=15 head_norm_before_train=1.296614 cos_to_last_merge=0.8608 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.861
[S10] round=15 local utility u=0.608663 metrics={'f1_val': 0.6994347117202335, 'auprc': 0.9981161999752408, 'loss_val': 0.2006546194652437, 'psi': 0.8189073070222364}-{'f1_val': 0.5769635343738924, 'auprc': 0.9020008370270922, 'loss_val': 0.39480662310172776, 'psi': 0.7069784554351723}
[S11] START round=15 head_norm_before_train=1.393216 cos_to_last_merge=0.8300 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.830
[S11] round=15 local utility u=0.017103 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9960226970345902, 'loss_val': 0.2806627329728399, 'psi': 0.8195702687928281}-{'f1_val': 0.7019353166316534, 'auprc': 0.9895410466115755, 'loss_val': 0.29542441486458365, 'psi': 0.8169776086236222}
[S13] START round=15 head_norm_before_train=1.496709 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.632127978804419, 'auprc': 0.8249232416054, 'loss_val': 0.5351763613738388, 'psi': 0.7092460839248114}-{'f1_val': 0.6895065759797523, 'auprc': 0.8267910998400646, 'loss_val': 0.5552957137846635, 'psi': 0.7444203855238771}
[S14] START round=15 head_norm_before_train=1.282697 cos_to_last_merge=0.9985 (last merge round=13)
[S14] round=15 local utility u=0.024729 metrics={'f1_val': 0.9964034173396682, 'auprc': 0.9991375872943061, 'loss_val': 0.19719589381069313, 'psi': 0.9974970853215234}-{'f1_val': 0.998107494697275, 'auprc': 0.9987997429231494, 'loss_val': 0.25586537455477737, 'psi': 0.9983843939876247}
[S15] START round=15 head_norm_before_train=1.041967 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.045270 metrics={'f1_val': 0.699247069653446, 'auprc': 0.9904201266926536, 'loss_val': 0.37843273788709575, 'psi': 0.815716292469129}-{'f1_val': 0.6989963398331794, 'auprc': 0.986683473740806, 'loss_val': 0.4562575960745806, 'psi': 0.8140711933962301}
[S16] START round=15 head_norm_before_train=1.508083 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.356303 metrics={'f1_val': 0.8440752072961623, 'auprc': 0.8373787139143273, 'loss_val': 0.6317238460349109, 'psi': 0.8413966099434282}-{'f1_val': 0.747406244745218, 'auprc': 0.8117093842756141, 'loss_val': 0.6873082617709065, 'psi': 0.7731275005573764}
[S17] START round=15 head_norm_before_train=1.022098 cos_to_last_merge=0.9964 (last merge round=13)
[S17] round=15 local utility u=0.175120 metrics={'f1_val': 0.3829937643602409, 'auprc': 0.7380230618210899, 'loss_val': 0.7526214940893914, 'psi': 0.5250054833445805}-{'f1_val': 0.361345893654092, 'auprc': 0.7106867336702851, 'loss_val': 0.8909646088190993, 'psi': 0.5010822296605693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:63515
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:63507
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:63517
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:63514
[S2] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] cosine check vs S7: cos=0.7092
[S5] RECEIVED delta(kind=head bytes=1796) from S11
[S5] cosine check vs S11: cos=0.9968
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] cosine check vs S9: cos=0.9908
[S15] RECEIVED delta(kind=head bytes=1802) from S8
[S15] cosine check vs S8: cos=-0.0650
[S15] DROPPED delta from S8 (cos=-0.0650 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S2
[S14] cosine check vs S2: cos=0.9768
[S16] RECEIVED delta(kind=head bytes=1797) from S4
[S16] cosine check vs S4: cos=0.0910
[S4] RECEIVED delta(kind=head bytes=1798) from S15
[S4] cosine check vs S15: cos=0.9801
[S17] RECEIVED delta(kind=head bytes=1800) from S10
[S17] cosine check vs S10: cos=0.6944
[S7] RECEIVED delta(kind=head bytes=1804) from S16
[S7] cosine check vs S16: cos=-0.0814
[S7] DROPPED delta from S16 (cos=-0.0814 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] cosine check vs S3: cos=-0.0528
[S6] DROPPED delta from S3 (cos=-0.0528 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=0.9922
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] cosine check vs S17: cos=-0.0759
[S13] DROPPED delta from S17 (cos=-0.0759 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7105 head_norm=1.385396
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.979943e-02
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7089 head_norm=1.404163 delta_norm=0.059799
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.203 → S15@127.0.0.1:63515
[S6] ⇄ pheromone p=0.189 → S15@127.0.0.1:63515
[S13] ⇄ pheromone p=0.183 → S8@127.0.0.1:63509
[S10] ⇄ pheromone p=0.253 → S17@127.0.0.1:63517
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.6642 head_norm=1.087431
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.085565e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.6642 head_norm=1.081906 delta_norm=0.108556
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.232 → S16@127.0.0.1:63516
[S7] ⇄ pheromone p=0.359 → S17@127.0.0.1:63517
[S2] ⇄ pheromone p=0.142 → S14@127.0.0.1:63514
[S9] ⇄ pheromone p=0.209 → S16@127.0.0.1:63516
[S15] ⇄ pheromone p=0.221 → S4@127.0.0.1:63504
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.6312 head_norm=1.312426
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.290119e-02
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.6215 head_norm=1.316620 delta_norm=0.082901
[S8] aggregate: ROLLBACK (f1_val pre=0.631 post=0.621 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.349 → S15@127.0.0.1:63515
[S11] ⇄ pheromone p=0.180 → S5@127.0.0.1:63505
[S3] ⇄ pheromone p=0.204 → S6@127.0.0.1:63507
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9964 head_norm=1.325994
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.440640e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9964 head_norm=1.327589 delta_norm=0.144064
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.243 → S8@127.0.0.1:63509
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.8441 head_norm=1.548456
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.041477e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.8432 head_norm=1.246914 delta_norm=0.404148
[S16] aggregate: ACCEPT kept=['S9', 'S4'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.309 → S7@127.0.0.1:63508
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3830 head_norm=1.059960
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.395614e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3853 head_norm=1.042512 delta_norm=0.139561
[S17] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.210 → S13@127.0.0.1:63513
[S2] START round=16 head_norm_before_train=1.344706 cos_to_last_merge=0.8489 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.849
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7006730233501429, 'auprc': 0.7982332622140587, 'loss_val': 0.3758916739055745, 'psi': 0.7396971188957092}-{'f1_val': 0.7005280643985495, 'auprc': 0.7965669217112891, 'loss_val': 0.36819019772827644, 'psi': 0.7389436073236454}
[S3] START round=16 head_norm_before_train=1.395326 cos_to_last_merge=0.8320 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.832
[S3] round=16 local utility u=0.007766 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9985755418415325, 'loss_val': 0.2657656720685951, 'psi': 0.8198387925358139}-{'f1_val': 0.7007562037352997, 'auprc': 0.9969440728165238, 'loss_val': 0.27685453563074086, 'psi': 0.8192313513677894}
[S4] START round=16 head_norm_before_train=1.081906 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.6658162580319655, 'auprc': 0.6567174345886058, 'loss_val': 0.5407788815491384, 'psi': 0.6621767286546216}-{'f1_val': 0.6642136680720184, 'auprc': 0.8552462940852756, 'loss_val': 0.5270816658510972, 'psi': 0.7406267184773213}
[S5] START round=16 head_norm_before_train=1.404163 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.313707 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9943365372528106, 'loss_val': 0.3674762169344401, 'psi': 0.8179269739959396}-{'f1_val': 0.7105142190171496, 'auprc': 0.7921845555776601, 'loss_val': 0.4495964262118937, 'psi': 0.7431823536413538}
[S6] START round=16 head_norm_before_train=1.575374 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6887798441590129, 'auprc': 0.7785098176656801, 'loss_val': 0.6690631405140525, 'psi': 0.7246718335616797}-{'f1_val': 0.6823591651007158, 'auprc': 0.8016648785246197, 'loss_val': 0.3673230629512037, 'psi': 0.7300814504702773}
[S7] START round=16 head_norm_before_train=1.531203 (no previous merge yet)
[S7] round=16 local utility u=0.234235 metrics={'f1_val': 0.6566055434552416, 'auprc': 0.8206995263367739, 'loss_val': 0.5222943417144018, 'psi': 0.7222431366078546}-{'f1_val': 0.6127583448604375, 'auprc': 0.7958642607687149, 'loss_val': 0.6531761123750411, 'psi': 0.6860007112237485}
[S8] START round=16 head_norm_before_train=1.316620 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.267126 metrics={'f1_val': 0.715272961878105, 'auprc': 0.9918261076166378, 'loss_val': 0.4562697361705687, 'psi': 0.8258942201735182}-{'f1_val': 0.6312210764411295, 'auprc': 0.9947390771915499, 'loss_val': 0.494949470225426, 'psi': 0.7766282767412975}
[S9] START round=16 head_norm_before_train=1.714003 (no previous merge yet)
[S9] round=16 local utility u=0.001133 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9991467706359084, 'loss_val': 0.0421566697170238, 'psi': 0.9957538175601859}-{'f1_val': 0.9941601000394567, 'auprc': 0.999045231608966, 'loss_val': 0.048128080030635505, 'psi': 0.9961141526672603}
[S10] START round=16 head_norm_before_train=1.336590 cos_to_last_merge=0.8527 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.853
[S10] round=16 local utility u=0.521399 metrics={'f1_val': 0.8749140767588122, 'auprc': 0.9931208826851563, 'loss_val': 0.19574631475049029, 'psi': 0.9221967991293498}-{'f1_val': 0.6994347117202335, 'auprc': 0.9981161999752408, 'loss_val': 0.2006546194652437, 'psi': 0.8189073070222364}
[S11] START round=16 head_norm_before_train=1.425195 cos_to_last_merge=0.8258 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.826
[S11] round=16 local utility u=0.008714 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9974613489268769, 'loss_val': 0.26755051004115415, 'psi': 0.8201457295497427}-{'f1_val': 0.7019353166316534, 'auprc': 0.9960226970345902, 'loss_val': 0.2806627329728399, 'psi': 0.8195702687928281}
[S13] START round=16 head_norm_before_train=1.518468 (no previous merge yet)
[S13] round=16 local utility u=0.177968 metrics={'f1_val': 0.6917169020997932, 'auprc': 0.8089736759602224, 'loss_val': 0.4889247016287208, 'psi': 0.738619611643965}-{'f1_val': 0.632127978804419, 'auprc': 0.8249232416054, 'loss_val': 0.5351763613738388, 'psi': 0.7092460839248114}
[S14] START round=16 head_norm_before_train=1.327589 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.004719 metrics={'f1_val': 0.9946029854378727, 'auprc': 0.9991405196141498, 'loss_val': 0.17696439212360807, 'psi': 0.9964179991083837}-{'f1_val': 0.9964034173396682, 'auprc': 0.9991375872943061, 'loss_val': 0.19719589381069313, 'psi': 0.9974970853215234}
[S15] START round=16 head_norm_before_train=1.087246 cos_to_last_merge=0.9977 (last merge round=14)
[S15] round=16 local utility u=0.035494 metrics={'f1_val': 0.698806771037434, 'auprc': 0.9919786429938554, 'loss_val': 0.30947946000586407, 'psi': 0.8160755198200026}-{'f1_val': 0.699247069653446, 'auprc': 0.9904201266926536, 'loss_val': 0.37843273788709575, 'psi': 0.815716292469129}
[S16] START round=16 head_norm_before_train=1.246914 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.055874 metrics={'f1_val': 0.8432077889476975, 'auprc': 0.8703129592075987, 'loss_val': 0.6135731260666526, 'psi': 0.8540498570516579}-{'f1_val': 0.8440752072961623, 'auprc': 0.8373787139143273, 'loss_val': 0.6317238460349109, 'psi': 0.8413966099434282}
[S17] START round=16 head_norm_before_train=1.042512 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.043625 metrics={'f1_val': 0.3915843571992698, 'auprc': 0.7372477489649453, 'loss_val': 0.7145895278136165, 'psi': 0.52984971390554}-{'f1_val': 0.3829937643602409, 'auprc': 0.7380230618210899, 'loss_val': 0.7526214940893914, 'psi': 0.5250054833445805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:63507
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:63505
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:63515
[S8] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S9
[S16] cosine check vs S9: cos=0.9556
[S5] RECEIVED delta(kind=head bytes=1797) from S11
[S5] cosine check vs S11: cos=0.9977
[S8] RECEIVED delta(kind=head bytes=1803) from S14
[S8] cosine check vs S14: cos=0.9912
[S6] RECEIVED delta(kind=head bytes=1797) from S3
[S6] cosine check vs S3: cos=-0.0535
[S6] DROPPED delta from S3 (cos=-0.0535 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=-0.0736
[S7] DROPPED delta from S16 (cos=-0.0736 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S10
[S17] cosine check vs S10: cos=0.6823
[S15] RECEIVED delta(kind=head bytes=1795) from S5
[S15] cosine check vs S5: cos=0.7499
[S8] RECEIVED delta(kind=head bytes=1802) from S13
[S8] cosine check vs S13: cos=-0.0158
[S8] DROPPED delta from S13 (cos=-0.0158 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S7
[S17] cosine check vs S7: cos=0.7420
[S4] RECEIVED delta(kind=head bytes=1794) from S15
[S4] cosine check vs S15: cos=0.9880
[S15] RECEIVED delta(kind=head bytes=1804) from S8
[S15] cosine check vs S8: cos=-0.0574
[S15] DROPPED delta from S8 (cos=-0.0574 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] cosine check vs S17: cos=-0.0752
[S13] DROPPED delta from S17 (cos=-0.0752 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.6658 head_norm=1.123925
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.762355e-02
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.6658 head_norm=1.125975 delta_norm=0.087624
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.8432 head_norm=1.291687
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.170222e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.8412 head_norm=1.499969 delta_norm=0.317022
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7003 head_norm=1.422135
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.170748e-02
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7003 head_norm=1.438007 delta_norm=0.051707
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.6988 head_norm=1.134807
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.716106e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.6984 head_norm=1.196959 delta_norm=0.471611
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.7153 head_norm=1.359762
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.046147e-02
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.4387 head_norm=1.362005 delta_norm=0.090461
[S8] aggregate: ROLLBACK (f1_val pre=0.715 post=0.439 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.3916 head_norm=1.073463
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.038072e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.3936 head_norm=1.061913 delta_norm=0.103807
[S17] aggregate: ACCEPT kept=['S10', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.380063 cos_to_last_merge=0.8434 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.843
[S2] round=17 local utility u=0.002580 metrics={'f1_val': 0.7015559965819167, 'auprc': 0.7992376719699081, 'loss_val': 0.3790422973936226, 'psi': 0.7406286667371134}-{'f1_val': 0.7006730233501429, 'auprc': 0.7982332622140587, 'loss_val': 0.3758916739055745, 'psi': 0.7396971188957092}
[S3] START round=17 head_norm_before_train=1.432081 cos_to_last_merge=0.8234 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.823
[S3] round=17 local utility u=0.022240 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.998415132870058, 'loss_val': 0.2208042551016787, 'psi': 0.8197746289472241}-{'f1_val': 0.7006809596653347, 'auprc': 0.9985755418415325, 'loss_val': 0.2657656720685951, 'psi': 0.8198387925358139}
[S4] START round=17 head_norm_before_train=1.125975 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.339150 metrics={'f1_val': 0.6697511978246774, 'auprc': 0.8547241929029189, 'loss_val': 0.4801087376662478, 'psi': 0.7437403958559741}-{'f1_val': 0.6658162580319655, 'auprc': 0.6567174345886058, 'loss_val': 0.5407788815491384, 'psi': 0.6621767286546216}
[S5] START round=17 head_norm_before_train=1.438007 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.708862375658345, 'auprc': 0.7920140688666122, 'loss_val': 0.40980210445761894, 'psi': 0.7421230529416518}-{'f1_val': 0.700320598491359, 'auprc': 0.9943365372528106, 'loss_val': 0.3674762169344401, 'psi': 0.8179269739959396}
[S6] START round=17 head_norm_before_train=1.597628 (no previous merge yet)
[S6] round=17 local utility u=0.321084 metrics={'f1_val': 0.6746195145243215, 'auprc': 0.9269875481578562, 'loss_val': 0.3873660275471901, 'psi': 0.7755667279777354}-{'f1_val': 0.6887798441590129, 'auprc': 0.7785098176656801, 'loss_val': 0.6690631405140525, 'psi': 0.7246718335616797}
[S7] START round=17 head_norm_before_train=1.540452 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.39043981048991383, 'auprc': 0.6857297152139029, 'loss_val': 1.1626063680224425, 'psi': 0.5085557723795094}-{'f1_val': 0.6566055434552416, 'auprc': 0.8206995263367739, 'loss_val': 0.5222943417144018, 'psi': 0.7222431366078546}
[S8] START round=17 head_norm_before_train=1.362005 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.905844 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.9967592764266282, 'loss_val': 0.3475795378889078, 'psi': 0.9966873588346485}-{'f1_val': 0.715272961878105, 'auprc': 0.9918261076166378, 'loss_val': 0.4562697361705687, 'psi': 0.8258942201735182}
[S9] START round=17 head_norm_before_train=1.741369 (no previous merge yet)
[S9] round=17 local utility u=0.006956 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9950349229127378, 'loss_val': 0.034920631005493766, 'psi': 0.99601027625343}-{'f1_val': 0.9934918488430377, 'auprc': 0.9991467706359084, 'loss_val': 0.0421566697170238, 'psi': 0.9957538175601859}
[S10] START round=17 head_norm_before_train=1.374396 cos_to_last_merge=0.8459 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.846
[S10] round=17 local utility u=0.309222 metrics={'f1_val': 0.9812992826887066, 'auprc': 0.9863618130259516, 'loss_val': 0.19533560795271224, 'psi': 0.9833242948236046}-{'f1_val': 0.8749140767588122, 'auprc': 0.9931208826851563, 'loss_val': 0.19574631475049029, 'psi': 0.9221967991293498}
[S11] START round=17 head_norm_before_train=1.455544 cos_to_last_merge=0.8224 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.822
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9854788382037664, 'loss_val': 0.24552818902168058, 'psi': 0.8153136064350552}-{'f1_val': 0.7019353166316534, 'auprc': 0.9974613489268769, 'loss_val': 0.26755051004115415, 'psi': 0.8201457295497427}
[S13] START round=17 head_norm_before_train=1.533447 (no previous merge yet)
[S13] round=17 local utility u=0.018049 metrics={'f1_val': 0.6965342282272008, 'auprc': 0.7998142807736065, 'loss_val': 0.45425316619613304, 'psi': 0.7378462492457631}-{'f1_val': 0.6917169020997932, 'auprc': 0.8089736759602224, 'loss_val': 0.4889247016287208, 'psi': 0.738619611643965}
[S14] START round=17 head_norm_before_train=1.370230 cos_to_last_merge=0.9990 (last merge round=15)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.987409784820387, 'auprc': 0.9990341066276489, 'loss_val': 0.14759335906770674, 'psi': 0.9920595135432918}-{'f1_val': 0.9946029854378727, 'auprc': 0.9991405196141498, 'loss_val': 0.17696439212360807, 'psi': 0.9964179991083837}
[S15] START round=17 head_norm_before_train=1.196959 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6997239203093304, 'auprc': 0.9856878546239304, 'loss_val': 0.3422673445214904, 'psi': 0.8141094940351704}-{'f1_val': 0.698806771037434, 'auprc': 0.9919786429938554, 'loss_val': 0.30947946000586407, 'psi': 0.8160755198200026}
[S16] START round=17 head_norm_before_train=1.499969 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.272222 metrics={'f1_val': 0.8720663240599728, 'auprc': 0.921412273981322, 'loss_val': 0.39557754506801457, 'psi': 0.8918047040285124}-{'f1_val': 0.8432077889476975, 'auprc': 0.8703129592075987, 'loss_val': 0.6135731260666526, 'psi': 0.8540498570516579}
[S17] START round=17 head_norm_before_train=1.061913 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.020599 metrics={'f1_val': 0.3946665215821526, 'auprc': 0.7424961531388278, 'loss_val': 0.7076291877060431, 'psi': 0.5337983742048227}-{'f1_val': 0.3915843571992698, 'auprc': 0.7372477489649453, 'loss_val': 0.7145895278136165, 'psi': 0.52984971390554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63515
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:63514
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:63517
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:63503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S6
[S3] cosine check vs S6: cos=-0.0542
[S3] DROPPED delta from S6 (cos=-0.0542 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S13
[S17] cosine check vs S13: cos=-0.0726
[S17] DROPPED delta from S13 (cos=-0.0726 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] cosine check vs S16: cos=0.1397
[S15] RECEIVED delta(kind=head bytes=1797) from S4
[S15] cosine check vs S4: cos=0.9227
[S14] RECEIVED delta(kind=head bytes=1798) from S8
[S14] cosine check vs S8: cos=0.9952
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:63508
[S17] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S17
[S7] cosine check vs S17: cos=0.7543
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.3904 head_norm=1.549874
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.102198e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.3968 head_norm=1.239503 delta_norm=0.510220
[S7] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9874 head_norm=1.414649
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.933168e-02
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9857 head_norm=1.407052 delta_norm=0.069332
[S14] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.6698 head_norm=1.160641
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.955552e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.9657 head_norm=1.025176 delta_norm=0.895555
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.6997 head_norm=1.242738
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.396437e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.6994 head_norm=1.178267 delta_norm=0.239644
[S15] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.412207 cos_to_last_merge=0.8395 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.840
[S2] round=18 local utility u=0.092952 metrics={'f1_val': 0.7073994220563002, 'auprc': 0.833776142470364, 'loss_val': 0.331815254577843, 'psi': 0.7579501102219257}-{'f1_val': 0.7015559965819167, 'auprc': 0.7992376719699081, 'loss_val': 0.3790422973936226, 'psi': 0.7406286667371134}
[S3] START round=18 head_norm_before_train=1.463530 cos_to_last_merge=0.8166 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.817
[S3] round=18 local utility u=0.334135 metrics={'f1_val': 0.8040440365459924, 'auprc': 0.9985943112249109, 'loss_val': 0.1732503194911777, 'psi': 0.8818641464175598}-{'f1_val': 0.7006809596653347, 'auprc': 0.998415132870058, 'loss_val': 0.2208042551016787, 'psi': 0.8197746289472241}
[S4] START round=18 head_norm_before_train=1.025176 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.6646942647005993, 'auprc': 0.8570658739184471, 'loss_val': 0.5795877576994799, 'psi': 0.7416429083877385}-{'f1_val': 0.6697511978246774, 'auprc': 0.8547241929029189, 'loss_val': 0.4801087376662478, 'psi': 0.7437403958559741}
[S5] START round=18 head_norm_before_train=1.455753 cos_to_last_merge=0.9997 (last merge round=16)
[S5] round=18 local utility u=0.328023 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9947706311028307, 'loss_val': 0.3107745179539758, 'psi': 0.8181006115359477}-{'f1_val': 0.708862375658345, 'auprc': 0.7920140688666122, 'loss_val': 0.40980210445761894, 'psi': 0.7421230529416518}
[S6] START round=18 head_norm_before_train=1.611681 (no previous merge yet)
[S6] round=18 local utility u=0.066845 metrics={'f1_val': 0.6819319855085597, 'auprc': 0.9374666609549133, 'loss_val': 0.328987866122997, 'psi': 0.7841458556871012}-{'f1_val': 0.6746195145243215, 'auprc': 0.9269875481578562, 'loss_val': 0.3873660275471901, 'psi': 0.7755667279777354}
[S7] START round=18 head_norm_before_train=1.239503 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=1.000000 metrics={'f1_val': 0.6627634441873933, 'auprc': 0.8266490445559541, 'loss_val': 0.5268308368102903, 'psi': 0.7283176843348176}-{'f1_val': 0.39043981048991383, 'auprc': 0.6857297152139029, 'loss_val': 1.1626063680224425, 'psi': 0.5085557723795094}
[S8] START round=18 head_norm_before_train=1.402844 cos_to_last_merge=0.9993 (last merge round=16)
[S8] round=18 local utility u=0.040775 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9942818986761645, 'loss_val': 0.25769728863164587, 'psi': 0.9956064250318708}-{'f1_val': 0.9966394137733288, 'auprc': 0.9967592764266282, 'loss_val': 0.3475795378889078, 'psi': 0.9966873588346485}
[S9] START round=18 head_norm_before_train=1.765841 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9901297741397954, 'auprc': 0.9995601064123052, 'loss_val': 0.04099380067966311, 'psi': 0.9939019070487993}-{'f1_val': 0.9966605118138915, 'auprc': 0.9950349229127378, 'loss_val': 0.034920631005493766, 'psi': 0.99601027625343}
[S10] START round=18 head_norm_before_train=1.403145 cos_to_last_merge=0.8409 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.841
[S10] round=18 local utility u=0.095401 metrics={'f1_val': 0.9945358580698285, 'auprc': 0.9978360355572808, 'loss_val': 0.11837659235080294, 'psi': 0.9958559290648095}-{'f1_val': 0.9812992826887066, 'auprc': 0.9863618130259516, 'loss_val': 0.19533560795271224, 'psi': 0.9833242948236046}
[S11] START round=18 head_norm_before_train=1.483033 cos_to_last_merge=0.8198 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.820
[S11] round=18 local utility u=0.028204 metrics={'f1_val': 0.7021770286274283, 'auprc': 0.998365368902099, 'loss_val': 0.22962142347420259, 'psi': 0.8206523647372965}-{'f1_val': 0.7018701185892477, 'auprc': 0.9854788382037664, 'loss_val': 0.24552818902168058, 'psi': 0.8153136064350552}
[S13] START round=18 head_norm_before_train=1.546136 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5670965992632764, 'auprc': 0.7933601039743455, 'loss_val': 0.6920992062880864, 'psi': 0.6576020011477041}-{'f1_val': 0.6965342282272008, 'auprc': 0.7998142807736065, 'loss_val': 0.45425316619613304, 'psi': 0.7378462492457631}
[S14] START round=18 head_norm_before_train=1.407052 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.051458 metrics={'f1_val': 0.9973269879856502, 'auprc': 0.9991380487170001, 'loss_val': 0.1044914924741382, 'psi': 0.9980514122781902}-{'f1_val': 0.987409784820387, 'auprc': 0.9990341066276489, 'loss_val': 0.14759335906770674, 'psi': 0.9920595135432918}
[S15] START round=18 head_norm_before_train=1.178267 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.195932 metrics={'f1_val': 0.7454048834139086, 'auprc': 0.993306921393289, 'loss_val': 0.2473470119987964, 'psi': 0.8445656986056609}-{'f1_val': 0.6997239203093304, 'auprc': 0.9856878546239304, 'loss_val': 0.3422673445214904, 'psi': 0.8141094940351704}
[S16] START round=18 head_norm_before_train=1.535879 cos_to_last_merge=0.9994 (last merge round=16)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8462847902176065, 'auprc': 0.9363967107644969, 'loss_val': 0.3925743472732552, 'psi': 0.8823295584363626}-{'f1_val': 0.8720663240599728, 'auprc': 0.921412273981322, 'loss_val': 0.39557754506801457, 'psi': 0.8918047040285124}
[S17] START round=18 head_norm_before_train=1.091455 cos_to_last_merge=0.9983 (last merge round=16)
[S17] round=18 local utility u=0.042680 metrics={'f1_val': 0.39020009496283015, 'auprc': 0.7739122622317666, 'loss_val': 0.6897196768811082, 'psi': 0.5436849618704047}-{'f1_val': 0.3946665215821526, 'auprc': 0.7424961531388278, 'loss_val': 0.7076291877060431, 'psi': 0.5337983742048227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:63512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:63502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:63503
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:63514
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:63508
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] cosine check vs S15: cos=-0.0450
[S8] DROPPED delta from S15 (cos=-0.0450 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S8
[S14] cosine check vs S8: cos=0.9955
[S3] RECEIVED delta(kind=head bytes=1801) from S6
[S3] cosine check vs S6: cos=-0.0541
[S3] DROPPED delta from S6 (cos=-0.0541 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S7
[S16] cosine check vs S7: cos=-0.0684
[S16] DROPPED delta from S7 (cos=-0.0684 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S14
[S2] cosine check vs S14: cos=0.9692
[S11] RECEIVED delta(kind=head bytes=1794) from S5
[S11] cosine check vs S5: cos=0.9956
[S17] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S17
[S7] cosine check vs S17: cos=0.9093
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.7074 head_norm=1.442447
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.792391e-01
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.7001 head_norm=1.433365 delta_norm=0.179239
[S2] aggregate: ROLLBACK (f1_val pre=0.707 post=0.700 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.7022 head_norm=1.510924
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.233129e-02
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.7022 head_norm=1.492335 delta_norm=0.072331
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.6628 head_norm=1.248716
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.599330e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.6745 head_norm=1.158363 delta_norm=0.259933
[S7] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9973 head_norm=1.446607
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.872863e-02
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9973 head_norm=1.444954 delta_norm=0.068729
[S14] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.433365 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.6413929264337574, 'auprc': 0.6723796864352896, 'loss_val': 0.38803446718270307, 'psi': 0.6537876304343704}-{'f1_val': 0.7073994220563002, 'auprc': 0.833776142470364, 'loss_val': 0.331815254577843, 'psi': 0.7579501102219257}
[S3] START round=19 head_norm_before_train=1.491382 cos_to_last_merge=0.8106 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.811
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9980438035005569, 'loss_val': 0.17187641323288386, 'psi': 0.8195811229003461}-{'f1_val': 0.8040440365459924, 'auprc': 0.9985943112249109, 'loss_val': 0.1732503194911777, 'psi': 0.8818641464175598}
[S4] START round=19 head_norm_before_train=1.058085 cos_to_last_merge=0.9977 (last merge round=17)
[S4] round=19 local utility u=0.038553 metrics={'f1_val': 0.6669303774604375, 'auprc': 0.8568278240013869, 'loss_val': 0.5151852522212876, 'psi': 0.7428893560768173}-{'f1_val': 0.6646942647005993, 'auprc': 0.8570658739184471, 'loss_val': 0.5795877576994799, 'psi': 0.7416429083877385}
[S5] START round=19 head_norm_before_train=1.477057 cos_to_last_merge=0.9988 (last merge round=16)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7138808545923863, 'auprc': 0.7886875803235385, 'loss_val': 0.5135727628419754, 'psi': 0.7438035448848472}-{'f1_val': 0.700320598491359, 'auprc': 0.9947706311028307, 'loss_val': 0.3107745179539758, 'psi': 0.8181006115359477}
[S6] START round=19 head_norm_before_train=1.624301 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.7075365143577863, 'auprc': 0.7816707809924512, 'loss_val': 0.6608950184321292, 'psi': 0.7371902210116523}-{'f1_val': 0.6819319855085597, 'auprc': 0.9374666609549133, 'loss_val': 0.328987866122997, 'psi': 0.7841458556871012}
[S7] START round=19 head_norm_before_train=1.158363 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.4640887809010965, 'auprc': 0.6595736134601774, 'loss_val': 0.8859121781195379, 'psi': 0.5422827139247288}-{'f1_val': 0.6627634441873933, 'auprc': 0.8266490445559541, 'loss_val': 0.5268308368102903, 'psi': 0.7283176843348176}
[S8] START round=19 head_norm_before_train=1.446567 cos_to_last_merge=0.9972 (last merge round=16)
[S8] round=19 local utility u=0.038634 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.9974563679694144, 'loss_val': 0.19085191817842176, 'psi': 0.996966195451763}-{'f1_val': 0.9964894426023416, 'auprc': 0.9942818986761645, 'loss_val': 0.25769728863164587, 'psi': 0.9956064250318708}
[S9] START round=19 head_norm_before_train=1.786274 (no previous merge yet)
[S9] round=19 local utility u=0.021107 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9966088652093905, 'loss_val': 0.029111263533967913, 'psi': 0.996639853172091}-{'f1_val': 0.9901297741397954, 'auprc': 0.9995601064123052, 'loss_val': 0.04099380067966311, 'psi': 0.9939019070487993}
[S10] START round=19 head_norm_before_train=1.423075 cos_to_last_merge=0.8373 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.837
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9935229376570949, 'auprc': 0.9942106216998734, 'loss_val': 0.13474904445776723, 'psi': 0.9937980112742062}-{'f1_val': 0.9945358580698285, 'auprc': 0.9978360355572808, 'loss_val': 0.11837659235080294, 'psi': 0.9958559290648095}
[S11] START round=19 head_norm_before_train=1.492335 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.003038 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9981574463195368, 'loss_val': 0.22147057078023621, 'psi': 0.8204241685068068}-{'f1_val': 0.7021770286274283, 'auprc': 0.998365368902099, 'loss_val': 0.22962142347420259, 'psi': 0.8206523647372965}
[S13] START round=19 head_norm_before_train=1.560735 (no previous merge yet)
[S13] round=19 local utility u=0.249885 metrics={'f1_val': 0.634917068279066, 'auprc': 0.7713205758102054, 'loss_val': 0.5331325364606854, 'psi': 0.6894784712915218}-{'f1_val': 0.5670965992632764, 'auprc': 0.7933601039743455, 'loss_val': 0.6920992062880864, 'psi': 0.6576020011477041}
[S14] START round=19 head_norm_before_train=1.444954 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9931267950132177, 'auprc': 0.9990472743117376, 'loss_val': 0.09469891972755026, 'psi': 0.9954949867326256}-{'f1_val': 0.9973269879856502, 'auprc': 0.9991380487170001, 'loss_val': 0.1044914924741382, 'psi': 0.9980514122781902}
[S15] START round=19 head_norm_before_train=1.219939 cos_to_last_merge=0.9991 (last merge round=17)
[S15] round=19 local utility u=0.498225 metrics={'f1_val': 0.901202963947731, 'auprc': 0.9929996461324947, 'loss_val': 0.18476397908935804, 'psi': 0.9379216368216364}-{'f1_val': 0.7454048834139086, 'auprc': 0.993306921393289, 'loss_val': 0.2473470119987964, 'psi': 0.8445656986056609}
[S16] START round=19 head_norm_before_train=1.571692 cos_to_last_merge=0.9980 (last merge round=16)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8431649571020077, 'auprc': 0.9413906367761397, 'loss_val': 0.5965114428119518, 'psi': 0.8824552289716605}-{'f1_val': 0.8462847902176065, 'auprc': 0.9363967107644969, 'loss_val': 0.3925743472732552, 'psi': 0.8823295584363626}
[S17] START round=19 head_norm_before_train=1.122252 cos_to_last_merge=0.9945 (last merge round=16)
[S17] round=19 local utility u=0.424676 metrics={'f1_val': 0.4874777372806832, 'auprc': 0.8563033037464991, 'loss_val': 0.6712059911820822, 'psi': 0.6350079638670096}-{'f1_val': 0.39020009496283015, 'auprc': 0.7739122622317666, 'loss_val': 0.6897196768811082, 'psi': 0.5436849618704047}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:63517
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:63514
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S8
[S14] cosine check vs S8: cos=0.9959
[S17] RECEIVED delta(kind=head bytes=1799) from S13
[S17] cosine check vs S13: cos=-0.0694
[S17] DROPPED delta from S13 (cos=-0.0694 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:63509
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] cosine check vs S15: cos=-0.0461
[S8] DROPPED delta from S15 (cos=-0.0461 < 0.0)
[S4] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S4
[S15] cosine check vs S4: cos=0.6852
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:63508
[S17] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S17
[S7] cosine check vs S17: cos=0.9710
[S3] r=20 psi=0.820 u=0.0000 p_local=0.1408 f1=0.701 auprc=0.998 bytes=23335
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.4641 head_norm=1.169822
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.399606e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.5018 head_norm=1.151387 delta_norm=0.139961
[S7] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.542 u=0.0000 p_local=0.3311 f1=0.464 auprc=0.660 bytes=23332
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S7
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S16
[S4]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S13] r=20 psi=0.689 u=0.2499 p_local=0.1455 f1=0.635 auprc=0.771 bytes=21541
[S11] r=20 psi=0.820 u=0.0030 p_local=0.0795 f1=0.702 auprc=0.998 bytes=26931
[S16] r=20 psi=0.882 u=0.0000 p_local=0.1672 f1=0.843 auprc=0.941 bytes=19761
[S6] r=20 psi=0.737 u=0.0000 p_local=0.1290 f1=0.708 auprc=0.782 bytes=21606
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.9012 head_norm=1.258464
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.734419e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.9029 head_norm=1.082930 delta_norm=0.473442
[S15] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.938 u=0.4982 p_local=0.2250 f1=0.901 auprc=0.993 bytes=28713
[S10] r=20 psi=0.994 u=0.0000 p_local=0.2117 f1=0.994 auprc=0.994 bytes=21590
[S9] r=20 psi=0.997 u=0.0211 p_local=0.0910 f1=0.997 auprc=0.997 bytes=30580
[S8] r=20 psi=0.997 u=0.0386 p_local=0.3005 f1=0.997 auprc=0.997 bytes=30524
[S4] r=20 psi=0.743 u=0.0386 p_local=0.1461 f1=0.667 auprc=0.857 bytes=19765
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9931 head_norm=1.480071
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.702896e-02
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9931 head_norm=1.483070 delta_norm=0.067029
[S14] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.995 u=0.0000 p_local=0.1082 f1=0.993 auprc=0.999 bytes=26964
[S2] r=20 psi=0.654 u=0.0000 p_local=0.0732 f1=0.641 auprc=0.672 bytes=21563
[S17] r=20 psi=0.635 u=0.4247 p_local=0.1848 f1=0.487 auprc=0.856 bytes=28738
[S5] r=20 psi=0.744 u=0.0000 p_local=0.1677 f1=0.714 auprc=0.789 bytes=25115
[S2] START round=20 head_norm_before_train=1.456368 cos_to_last_merge=0.9997 (last merge round=18)
[S2] round=20 local utility u=0.484494 metrics={'f1_val': 0.7039757249015572, 'auprc': 0.8696831767262513, 'loss_val': 0.3864538961566469, 'psi': 0.770258705631435}-{'f1_val': 0.6413929264337574, 'auprc': 0.6723796864352896, 'loss_val': 0.38803446718270307, 'psi': 0.6537876304343704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=20 head_norm_before_train=1.518541 cos_to_last_merge=0.8066 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.807
[S3] round=20 local utility u=0.838158 metrics={'f1_val': 0.9723820024593455, 'auprc': 0.9982136121867087, 'loss_val': 0.12672619046931424, 'psi': 0.9827146463502907}-{'f1_val': 0.7006060025002057, 'auprc': 0.9980438035005569, 'loss_val': 0.17187641323288386, 'psi': 0.8195811229003461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=20 head_norm_before_train=1.100018 cos_to_last_merge=0.9904 (last merge round=17)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.6133340710839927, 'auprc': 0.8413960135476667, 'loss_val': 0.4940932566914796, 'psi': 0.7045588480694622}-{'f1_val': 0.6669303774604375, 'auprc': 0.8568278240013869, 'loss_val': 0.5151852522212876, 'psi': 0.7428893560768173}
[S5] START round=20 head_norm_before_train=1.495799 cos_to_last_merge=0.9977 (last merge round=16)
[S5] round=20 local utility u=0.044430 metrics={'f1_val': 0.7138148496769623, 'auprc': 0.7913430407319979, 'loss_val': 0.43228344082704195, 'psi': 0.7448261260989766}-{'f1_val': 0.7138808545923863, 'auprc': 0.7886875803235385, 'loss_val': 0.5135727628419754, 'psi': 0.7438035448848472}
[S6] START round=20 head_norm_before_train=1.634536 (no previous merge yet)
[S6] round=20 local utility u=0.492282 metrics={'f1_val': 0.7255562776402691, 'auprc': 0.9509580210257174, 'loss_val': 0.2923120761527552, 'psi': 0.8157169749944484}-{'f1_val': 0.7075365143577863, 'auprc': 0.7816707809924512, 'loss_val': 0.6608950184321292, 'psi': 0.7371902210116523}
[S7] START round=20 head_norm_before_train=1.151387 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=1.000000 metrics={'f1_val': 0.6701192625151522, 'auprc': 0.8421500548804515, 'loss_val': 0.514421798429367, 'psi': 0.7389315794612719}-{'f1_val': 0.4640887809010965, 'auprc': 0.6595736134601774, 'loss_val': 0.8859121781195379, 'psi': 0.5422827139247288}
[S8] START round=20 head_norm_before_train=1.489083 cos_to_last_merge=0.9941 (last merge round=16)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9948403229310986, 'auprc': 0.9911279672250866, 'loss_val': 0.1847091815121476, 'psi': 0.9933553806486938}-{'f1_val': 0.9966394137733288, 'auprc': 0.9974563679694144, 'loss_val': 0.19085191817842176, 'psi': 0.996966195451763}
[S9] START round=20 head_norm_before_train=1.803020 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9884223813560973, 'auprc': 0.9995800895705654, 'loss_val': 0.045054137657102485, 'psi': 0.9928854646418845}-{'f1_val': 0.9966605118138915, 'auprc': 0.9966088652093905, 'loss_val': 0.029111263533967913, 'psi': 0.996639853172091}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=20 head_norm_before_train=1.439405 cos_to_last_merge=0.8346 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.835
[S10] round=20 local utility u=0.027009 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9969659943239588, 'loss_val': 0.1001995201639643, 'psi': 0.9960203983460162}-{'f1_val': 0.9935229376570949, 'auprc': 0.9942106216998734, 'loss_val': 0.13474904445776723, 'psi': 0.9937980112742062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=20 head_norm_before_train=1.521648 cos_to_last_merge=0.9996 (last merge round=18)
[S11] round=20 local utility u=0.795248 metrics={'f1_val': 0.9597194965484097, 'auprc': 0.9980432243496524, 'loss_val': 0.17733647628593133, 'psi': 0.9750489876689068}-{'f1_val': 0.7019353166316534, 'auprc': 0.9981574463195368, 'loss_val': 0.22147057078023621, 'psi': 0.8204241685068068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] sending update (kind=head size=1790 to 1 peers)
[S13] START round=20 head_norm_before_train=1.573156 (no previous merge yet)
[S13] round=20 local utility u=0.045442 metrics={'f1_val': 0.6317180702898831, 'auprc': 0.7987809770421884, 'loss_val': 0.5054348222224601, 'psi': 0.6985432329908052}-{'f1_val': 0.634917068279066, 'auprc': 0.7713205758102054, 'loss_val': 0.5331325364606854, 'psi': 0.6894784712915218}
[S14] START round=20 head_norm_before_train=1.483070 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9828660545850221, 'auprc': 0.9989346711200088, 'loss_val': 0.09193472897573333, 'psi': 0.9892935011990167}-{'f1_val': 0.9931267950132177, 'auprc': 0.9990472743117376, 'loss_val': 0.09469891972755026, 'psi': 0.9954949867326256}
[S15] START round=20 head_norm_before_train=1.082930 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6988300917594832, 'auprc': 0.9885858204520948, 'loss_val': 0.31965805219274185, 'psi': 0.8147323832365279}-{'f1_val': 0.901202963947731, 'auprc': 0.9929996461324947, 'loss_val': 0.18476397908935804, 'psi': 0.9379216368216364}
[S16] START round=20 head_norm_before_train=1.606235 cos_to_last_merge=0.9963 (last merge round=16)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.842120468752784, 'auprc': 0.9350532155241184, 'loss_val': 0.6455637570035492, 'psi': 0.8792935674613177}-{'f1_val': 0.8431649571020077, 'auprc': 0.9413906367761397, 'loss_val': 0.5965114428119518, 'psi': 0.8824552289716605}
[S17] START round=20 head_norm_before_train=1.149817 cos_to_last_merge=0.9900 (last merge round=16)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.39210535432998117, 'auprc': 0.858779496855574, 'loss_val': 0.6651525139497738, 'psi': 0.5787750113402182}-{'f1_val': 0.4874777372806832, 'auprc': 0.8563033037464991, 'loss_val': 0.6712059911820822, 'psi': 0.6350079638670096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:63516
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:63512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:63503
[S5] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] ⇄ pheromone p=0.117 → S15@127.0.0.1:63515
[S6] sending update (kind=head size=1796 to 1 peers)
[S14] ⇄ pheromone p=0.087 → S2@127.0.0.1:63502
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RECEIVED delta(kind=head bytes=1800) from S13
[S17] cosine check vs S13: cos=-0.0702
[S17] DROPPED delta from S13 (cos=-0.0702 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S5
[S11] cosine check vs S5: cos=0.9939
[S3] RECEIVED delta(kind=head bytes=1796) from S6
[S3] cosine check vs S6: cos=-0.0554
[S3] DROPPED delta from S6 (cos=-0.0554 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] cosine check vs S7: cos=-0.0618
[S16] DROPPED delta from S7 (cos=-0.0618 < 0.0)
[S7] ⇄ pheromone p=0.465 → S16@127.0.0.1:63516
[S6] ⇄ pheromone p=0.202 → S3@127.0.0.1:63503
[S13] ⇄ pheromone p=0.126 → S17@127.0.0.1:63517
[S5] ⇄ pheromone p=0.143 → S11@127.0.0.1:63512
[S17] ⇄ pheromone p=0.148 → S7@127.0.0.1:63508
[S16] ⇄ pheromone p=0.134 → S4@127.0.0.1:63504
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RoundReady barrier timeout: have=1 need=2 — continuing
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.240 → S14@127.0.0.1:63514
[S4]  timeout peer S15
[S13]  timeout peer S17
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S8
[S17]  timeout peer S7
[S17]  timeout peer S10
[S7]  timeout peer S16
[S6]  timeout peer S3
[S14]  timeout peer S2
[S5]  timeout peer S11
[S16]  timeout peer S4
[S16]  timeout peer S9
[S8]  timeout peer S13
[S8]  timeout peer S14
[S2] START round=21 head_norm_before_train=1.472245 cos_to_last_merge=0.9992 (last merge round=18)
[S2] round=21 local utility u=0.108330 metrics={'f1_val': 0.8104180165115459, 'auprc': 0.7497547472301325, 'loss_val': 0.4486623846778584, 'psi': 0.7861527087989805}-{'f1_val': 0.7039757249015572, 'auprc': 0.8696831767262513, 'loss_val': 0.3864538961566469, 'psi': 0.770258705631435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=21 head_norm_before_train=1.546187 cos_to_last_merge=0.8022 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.802
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.9633071192161984, 'auprc': 0.998043527437417, 'loss_val': 0.11614015208938845, 'psi': 0.9772016825046859}-{'f1_val': 0.9723820024593455, 'auprc': 0.9982136121867087, 'loss_val': 0.12672619046931424, 'psi': 0.9827146463502907}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=21 head_norm_before_train=1.139030 cos_to_last_merge=0.9816 (last merge round=17)
[S4] round=21 local utility u=0.147543 metrics={'f1_val': 0.6119579427293272, 'auprc': 0.9430888263654303, 'loss_val': 0.4958282603812271, 'psi': 0.7444102961837684}-{'f1_val': 0.6133340710839927, 'auprc': 0.8413960135476667, 'loss_val': 0.4940932566914796, 'psi': 0.7045588480694622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=21 head_norm_before_train=1.510001 cos_to_last_merge=0.9969 (last merge round=16)
[S5] round=21 local utility u=0.342728 metrics={'f1_val': 0.700320598491359, 'auprc': 0.994465387656167, 'loss_val': 0.27522980592201146, 'psi': 0.8179785141572822}-{'f1_val': 0.7138148496769623, 'auprc': 0.7913430407319979, 'loss_val': 0.43228344082704195, 'psi': 0.7448261260989766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=21 head_norm_before_train=1.641700 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.42954779584618924, 'auprc': 0.7813210662035057, 'loss_val': 1.2462888281219784, 'psi': 0.5702571039891159}-{'f1_val': 0.7255562776402691, 'auprc': 0.9509580210257174, 'loss_val': 0.2923120761527552, 'psi': 0.8157169749944484}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=21 head_norm_before_train=1.167351 cos_to_last_merge=0.9998 (last merge round=19)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.5078004622198568, 'auprc': 0.6340671476609756, 'loss_val': 0.8522307053413014, 'psi': 0.5583071363963044}-{'f1_val': 0.6701192625151522, 'auprc': 0.8421500548804515, 'loss_val': 0.514421798429367, 'psi': 0.7389315794612719}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=21 head_norm_before_train=1.522752 cos_to_last_merge=0.9913 (last merge round=16)
[S8] round=21 local utility u=0.039862 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9980503450172997, 'loss_val': 0.135646095055714, 'psi': 0.9971138035683249}-{'f1_val': 0.9948403229310986, 'auprc': 0.9911279672250866, 'loss_val': 0.1847091815121476, 'psi': 0.9933553806486938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=21 head_norm_before_train=1.819241 (no previous merge yet)
[S9] round=21 local utility u=0.029200 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9963761957643069, 'loss_val': 0.026470422656344642, 'psi': 0.9965467853940576}-{'f1_val': 0.9884223813560973, 'auprc': 0.9995800895705654, 'loss_val': 0.045054137657102485, 'psi': 0.9928854646418845}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=21 head_norm_before_train=1.453924 cos_to_last_merge=0.8321 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.832
[S10] round=21 local utility u=0.006093 metrics={'f1_val': 0.9959407510105199, 'auprc': 0.9970890786048143, 'loss_val': 0.09168711445553913, 'psi': 0.9964000820482377}-{'f1_val': 0.9953900010273877, 'auprc': 0.9969659943239588, 'loss_val': 0.1001995201639643, 'psi': 0.9960203983460162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] sending update (kind=head size=1806 to 1 peers)
[S11] START round=21 head_norm_before_train=1.550080 cos_to_last_merge=0.9982 (last merge round=18)
[S11] round=21 local utility u=0.119957 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980377206881161, 'loss_val': 0.15837161395446883, 'psi': 0.9971432909834002}-{'f1_val': 0.9597194965484097, 'auprc': 0.9980432243496524, 'loss_val': 0.17733647628593133, 'psi': 0.9750489876689068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9965 head_norm=1.577944
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.090870e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9607 head_norm=1.540488 delta_norm=0.109087
[S11] aggregate: ROLLBACK (f1_val pre=0.997 post=0.961 tol_abs=0.005 tol_rel=0.0)
[S13] START round=21 head_norm_before_train=1.585259 (no previous merge yet)
[S13] round=21 local utility u=0.205187 metrics={'f1_val': 0.6923683661019961, 'auprc': 0.7895906977958431, 'loss_val': 0.43139207327073137, 'psi': 0.7312572987795349}-{'f1_val': 0.6317180702898831, 'auprc': 0.7987809770421884, 'loss_val': 0.5054348222224601, 'psi': 0.6985432329908052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=21 head_norm_before_train=1.513677 cos_to_last_merge=0.9997 (last merge round=19)
[S14] round=21 local utility u=0.023917 metrics={'f1_val': 0.9880644530100982, 'auprc': 0.9989379285292076, 'loss_val': 0.07530012738585436, 'psi': 0.992413843217742}-{'f1_val': 0.9828660545850221, 'auprc': 0.9989346711200088, 'loss_val': 0.09193472897573333, 'psi': 0.9892935011990167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=21 head_norm_before_train=1.122077 cos_to_last_merge=0.9990 (last merge round=19)
[S15] round=21 local utility u=0.229358 metrics={'f1_val': 0.7684691285979145, 'auprc': 0.9892886628033567, 'loss_val': 0.28088531840605835, 'psi': 0.8567969422800914}-{'f1_val': 0.6988300917594832, 'auprc': 0.9885858204520948, 'loss_val': 0.31965805219274185, 'psi': 0.8147323832365279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=21 head_norm_before_train=1.635513 cos_to_last_merge=0.9947 (last merge round=16)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.791278545725068, 'auprc': 0.9275659016771278, 'loss_val': 0.7022538507838697, 'psi': 0.8457934881058919}-{'f1_val': 0.842120468752784, 'auprc': 0.9350532155241184, 'loss_val': 0.6455637570035492, 'psi': 0.8792935674613177}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=21 head_norm_before_train=1.171234 cos_to_last_merge=0.9861 (last merge round=16)
[S17] round=21 local utility u=0.041222 metrics={'f1_val': 0.40835818276958724, 'auprc': 0.8441599455894333, 'loss_val': 0.6363664252435921, 'psi': 0.5826788878975256}-{'f1_val': 0.39210535432998117, 'auprc': 0.858779496855574, 'loss_val': 0.6651525139497738, 'psi': 0.5787750113402182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=22 head_norm_before_train=1.484594 cos_to_last_merge=0.9986 (last merge round=18)
[S2] round=22 local utility u=0.195165 metrics={'f1_val': 0.8251692015006304, 'auprc': 0.8224269625440666, 'loss_val': 0.36485534756421184, 'psi': 0.8240723059180048}-{'f1_val': 0.8104180165115459, 'auprc': 0.7497547472301325, 'loss_val': 0.4486623846778584, 'psi': 0.7861527087989805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=22 head_norm_before_train=1.570798 cos_to_last_merge=0.7986 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.799
[S3] round=22 local utility u=0.112795 metrics={'f1_val': 0.996507985077103, 'auprc': 0.9980409851064594, 'loss_val': 0.08974701180709216, 'psi': 0.9971211850888456}-{'f1_val': 0.9633071192161984, 'auprc': 0.998043527437417, 'loss_val': 0.11614015208938845, 'psi': 0.9772016825046859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=22 head_norm_before_train=1.167793 cos_to_last_merge=0.9750 (last merge round=17)
[S4] round=22 local utility u=0.007692 metrics={'f1_val': 0.6141506101122425, 'auprc': 0.943038413799199, 'loss_val': 0.49344915661474964, 'psi': 0.745705731587025}-{'f1_val': 0.6119579427293272, 'auprc': 0.9430888263654303, 'loss_val': 0.4958282603812271, 'psi': 0.7444102961837684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=22 head_norm_before_train=1.528361 cos_to_last_merge=0.9957 (last merge round=16)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7112595591851253, 'auprc': 0.7977257906692281, 'loss_val': 0.35160962896422154, 'psi': 0.7458460517787664}-{'f1_val': 0.700320598491359, 'auprc': 0.994465387656167, 'loss_val': 0.27522980592201146, 'psi': 0.8179785141572822}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=22 head_norm_before_train=1.648918 (no previous merge yet)
[S6] round=22 local utility u=1.000000 metrics={'f1_val': 0.9665152882005901, 'auprc': 0.936022456763434, 'loss_val': 0.3109169610691343, 'psi': 0.9543181556257276}-{'f1_val': 0.42954779584618924, 'auprc': 0.7813210662035057, 'loss_val': 1.2462888281219784, 'psi': 0.5702571039891159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=22 head_norm_before_train=1.190392 cos_to_last_merge=0.9990 (last merge round=19)
[S7] round=22 local utility u=0.410512 metrics={'f1_val': 0.6069338353848703, 'auprc': 0.6534269773251808, 'loss_val': 0.6840861767081763, 'psi': 0.6255310921609946}-{'f1_val': 0.5078004622198568, 'auprc': 0.6340671476609756, 'loss_val': 0.8522307053413014, 'psi': 0.5583071363963044}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=22 head_norm_before_train=1.550340 cos_to_last_merge=0.9890 (last merge round=16)
[S8] round=22 local utility u=0.012170 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9991252082759623, 'loss_val': 0.1145307361573817, 'psi': 0.99754374887179}-{'f1_val': 0.9964894426023416, 'auprc': 0.9980503450172997, 'loss_val': 0.135646095055714, 'psi': 0.9971138035683249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=22 head_norm_before_train=1.834939 (no previous merge yet)
[S9] round=22 local utility u=0.000587 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9995540364241834, 'loss_val': 0.0258606833925249, 'psi': 0.9969209184036424}-{'f1_val': 0.9966605118138915, 'auprc': 0.9963761957643069, 'loss_val': 0.026470422656344642, 'psi': 0.9965467853940576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=22 head_norm_before_train=1.468908 cos_to_last_merge=0.8296 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.830
[S10] round=22 local utility u=0.003474 metrics={'f1_val': 0.9955013957964032, 'auprc': 0.9971646480923528, 'loss_val': 0.08232918023191137, 'psi': 0.9961666967147831}-{'f1_val': 0.9959407510105199, 'auprc': 0.9970890786048143, 'loss_val': 0.09168711445553913, 'psi': 0.9964000820482377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=22 head_norm_before_train=1.540488 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.9445664548726485, 'auprc': 0.9978921037618715, 'loss_val': 0.26518405202844525, 'psi': 0.9658967144283377}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980377206881161, 'loss_val': 0.15837161395446883, 'psi': 0.9971432909834002}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=22 head_norm_before_train=1.595976 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.6269842074436065, 'auprc': 0.774398107087753, 'loss_val': 0.5374607905164293, 'psi': 0.6859497673012651}-{'f1_val': 0.6923683661019961, 'auprc': 0.7895906977958431, 'loss_val': 0.43139207327073137, 'psi': 0.7312572987795349}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=1.543513 cos_to_last_merge=0.9989 (last merge round=19)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9611295402353511, 'auprc': 0.9988371604387595, 'loss_val': 0.0780801100122856, 'psi': 0.9762125883167145}-{'f1_val': 0.9880644530100982, 'auprc': 0.9989379285292076, 'loss_val': 0.07530012738585436, 'psi': 0.992413843217742}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=22 head_norm_before_train=1.165471 cos_to_last_merge=0.9963 (last merge round=19)
[S15] round=22 local utility u=0.406881 metrics={'f1_val': 0.8921666329710115, 'auprc': 0.9926635749462436, 'loss_val': 0.21943356031983885, 'psi': 0.9323654097611044}-{'f1_val': 0.7684691285979145, 'auprc': 0.9892886628033567, 'loss_val': 0.28088531840605835, 'psi': 0.8567969422800914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=22 head_norm_before_train=1.662259 cos_to_last_merge=0.9934 (last merge round=16)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8293247163197027, 'auprc': 0.8858474719041092, 'loss_val': 0.8175541865117137, 'psi': 0.8519338185534653}-{'f1_val': 0.791278545725068, 'auprc': 0.9275659016771278, 'loss_val': 0.7022538507838697, 'psi': 0.8457934881058919}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=22 head_norm_before_train=1.191644 cos_to_last_merge=0.9828 (last merge round=16)
[S17] round=22 local utility u=0.086266 metrics={'f1_val': 0.43642031318520075, 'auprc': 0.837657847857494, 'loss_val': 0.6126999635304988, 'psi': 0.5969153270541181}-{'f1_val': 0.40835818276958724, 'auprc': 0.8441599455894333, 'loss_val': 0.6363664252435921, 'psi': 0.5826788878975256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=23 head_norm_before_train=1.498546 cos_to_last_merge=0.9976 (last merge round=18)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.82884637399454, 'auprc': 0.8195783644911336, 'loss_val': 0.3954000193340032, 'psi': 0.8251391701931774}-{'f1_val': 0.8251692015006304, 'auprc': 0.8224269625440666, 'loss_val': 0.36485534756421184, 'psi': 0.8240723059180048}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=23 head_norm_before_train=1.596702 cos_to_last_merge=0.7948 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.795
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9342951680476788, 'auprc': 0.998043758029662, 'loss_val': 0.1549868029148364, 'psi': 0.9597946040404721}-{'f1_val': 0.996507985077103, 'auprc': 0.9980409851064594, 'loss_val': 0.08974701180709216, 'psi': 0.9971211850888456}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=23 head_norm_before_train=1.199796 cos_to_last_merge=0.9684 (last merge round=17)
[S4] round=23 local utility u=0.000421 metrics={'f1_val': 0.612536594863619, 'auprc': 0.9459156060827847, 'loss_val': 0.4915554085422564, 'psi': 0.7458881993512854}-{'f1_val': 0.6141506101122425, 'auprc': 0.943038413799199, 'loss_val': 0.49344915661474964, 'psi': 0.745705731587025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=23 head_norm_before_train=1.548033 cos_to_last_merge=0.9940 (last merge round=16)
[S5] round=23 local utility u=0.322230 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9955126698344207, 'loss_val': 0.23487558587114718, 'psi': 0.8183974270285836}-{'f1_val': 0.7112595591851253, 'auprc': 0.7977257906692281, 'loss_val': 0.35160962896422154, 'psi': 0.7458460517787664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=23 head_norm_before_train=1.653332 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.7541110486736151, 'auprc': 0.9430037553395698, 'loss_val': 0.28701217595588013, 'psi': 0.829668131339997}-{'f1_val': 0.9665152882005901, 'auprc': 0.936022456763434, 'loss_val': 0.3109169610691343, 'psi': 0.9543181556257276}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=23 head_norm_before_train=1.215396 cos_to_last_merge=0.9979 (last merge round=19)
[S7] round=23 local utility u=0.191126 metrics={'f1_val': 0.6375689970867329, 'auprc': 0.680465139203783, 'loss_val': 0.566759754962914, 'psi': 0.6547274539335529}-{'f1_val': 0.6069338353848703, 'auprc': 0.6534269773251808, 'loss_val': 0.6840861767081763, 'psi': 0.6255310921609946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=23 head_norm_before_train=1.577190 cos_to_last_merge=0.9868 (last merge round=16)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9963402451333164, 'auprc': 0.9939767272487915, 'loss_val': 0.10303726963483315, 'psi': 0.9953948379795065}-{'f1_val': 0.9964894426023416, 'auprc': 0.9991252082759623, 'loss_val': 0.1145307361573817, 'psi': 0.99754374887179}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=23 head_norm_before_train=1.847052 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9995515937983357, 'loss_val': 0.029402670220968773, 'psi': 0.9959157468251568}-{'f1_val': 0.9951655063899485, 'auprc': 0.9995540364241834, 'loss_val': 0.0258606833925249, 'psi': 0.9969209184036424}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=23 head_norm_before_train=1.488769 cos_to_last_merge=0.8265 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.827
[S10] round=23 local utility u=0.004347 metrics={'f1_val': 0.9955013957964032, 'auprc': 0.9970746852467849, 'loss_val': 0.0733659554043303, 'psi': 0.9961307115765559}-{'f1_val': 0.9955013957964032, 'auprc': 0.9971646480923528, 'loss_val': 0.08232918023191137, 'psi': 0.9961666967147831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=23 head_norm_before_train=1.568612 cos_to_last_merge=0.9995 (last merge round=21)
[S11] round=23 local utility u=0.227413 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998043222154615, 'loss_val': 0.12269502188530963, 'psi': 0.9971454915699998}-{'f1_val': 0.9445664548726485, 'auprc': 0.9978921037618715, 'loss_val': 0.26518405202844525, 'psi': 0.9658967144283377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=23 head_norm_before_train=1.608133 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.621680811358229, 'auprc': 0.76573460786657, 'loss_val': 0.5757779859473603, 'psi': 0.6793023299615654}-{'f1_val': 0.6269842074436065, 'auprc': 0.774398107087753, 'loss_val': 0.5374607905164293, 'psi': 0.6859497673012651}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=23 head_norm_before_train=1.571967 cos_to_last_merge=0.9978 (last merge round=19)
[S14] round=23 local utility u=0.127745 metrics={'f1_val': 0.9979803455147667, 'auprc': 0.9989449651795281, 'loss_val': 0.044018024648651184, 'psi': 0.9983661933806712}-{'f1_val': 0.9611295402353511, 'auprc': 0.9988371604387595, 'loss_val': 0.0780801100122856, 'psi': 0.9762125883167145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=23 head_norm_before_train=1.210275 cos_to_last_merge=0.9924 (last merge round=19)
[S15] round=23 local utility u=0.196158 metrics={'f1_val': 0.9453920883754298, 'auprc': 0.9935784107663257, 'loss_val': 0.1492146784177336, 'psi': 0.9646666173317882}-{'f1_val': 0.8921666329710115, 'auprc': 0.9926635749462436, 'loss_val': 0.21943356031983885, 'psi': 0.9323654097611044}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=23 head_norm_before_train=1.684777 cos_to_last_merge=0.9924 (last merge round=16)
[S16] round=23 local utility u=0.784991 metrics={'f1_val': 0.9390812943777298, 'auprc': 0.9861562136516792, 'loss_val': 0.2070370929063905, 'psi': 0.9579112620873096}-{'f1_val': 0.8293247163197027, 'auprc': 0.8858474719041092, 'loss_val': 0.8175541865117137, 'psi': 0.8519338185534653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=23 head_norm_before_train=1.214741 cos_to_last_merge=0.9790 (last merge round=16)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.40256731413033414, 'auprc': 0.7879654496442622, 'loss_val': 0.6150489404174332, 'psi': 0.5567265683359054}-{'f1_val': 0.43642031318520075, 'auprc': 0.837657847857494, 'loss_val': 0.6126999635304988, 'psi': 0.5969153270541181}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=24 head_norm_before_train=1.517960 cos_to_last_merge=0.9958 (last merge round=18)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7980771455772745, 'auprc': 0.8591802631603275, 'loss_val': 0.4540459129882228, 'psi': 0.8225183926104958}-{'f1_val': 0.82884637399454, 'auprc': 0.8195783644911336, 'loss_val': 0.3954000193340032, 'psi': 0.8251391701931774}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=24 head_norm_before_train=1.617431 cos_to_last_merge=0.7920 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.792
[S3] round=24 local utility u=0.234640 metrics={'f1_val': 0.9974985492286463, 'auprc': 0.9979699668298792, 'loss_val': 0.06470585804743557, 'psi': 0.9976871162691394}-{'f1_val': 0.9342951680476788, 'auprc': 0.998043758029662, 'loss_val': 0.1549868029148364, 'psi': 0.9597946040404721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=24 head_norm_before_train=1.231400 cos_to_last_merge=0.9623 (last merge round=17)
[S4] round=24 local utility u=0.002399 metrics={'f1_val': 0.6112747574029852, 'auprc': 0.9507266299917182, 'loss_val': 0.4936188379472611, 'psi': 0.7470555064384785}-{'f1_val': 0.612536594863619, 'auprc': 0.9459156060827847, 'loss_val': 0.4915554085422564, 'psi': 0.7458881993512854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=24 head_norm_before_train=1.566824 cos_to_last_merge=0.9922 (last merge round=16)
[S5] round=24 local utility u=0.010043 metrics={'f1_val': 0.700320598491359, 'auprc': 0.995588298373147, 'loss_val': 0.21501573801239968, 'psi': 0.8184276784440743}-{'f1_val': 0.700320598491359, 'auprc': 0.9955126698344207, 'loss_val': 0.23487558587114718, 'psi': 0.8183974270285836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=24 head_norm_before_train=1.658940 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.6421909847760534, 'auprc': 0.7802708662251127, 'loss_val': 0.5088780408776222, 'psi': 0.6974229373556771}-{'f1_val': 0.7541110486736151, 'auprc': 0.9430037553395698, 'loss_val': 0.28701217595588013, 'psi': 0.829668131339997}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=24 head_norm_before_train=1.240568 cos_to_last_merge=0.9966 (last merge round=19)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5270959481291491, 'auprc': 0.6330956597527587, 'loss_val': 0.8744079226029091, 'psi': 0.5694958327785928}-{'f1_val': 0.6375689970867329, 'auprc': 0.680465139203783, 'loss_val': 0.566759754962914, 'psi': 0.6547274539335529}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=24 head_norm_before_train=1.603650 cos_to_last_merge=0.9843 (last merge round=16)
[S8] round=24 local utility u=0.012652 metrics={'f1_val': 0.9953812994639146, 'auprc': 0.998626457834806, 'loss_val': 0.08592807734772935, 'psi': 0.9966793628122712}-{'f1_val': 0.9963402451333164, 'auprc': 0.9939767272487915, 'loss_val': 0.10303726963483315, 'psi': 0.9953948379795065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=24 head_norm_before_train=1.855299 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9901297741397954, 'auprc': 0.9995357240377388, 'loss_val': 0.035788627067573194, 'psi': 0.9938921540989728}-{'f1_val': 0.9934918488430377, 'auprc': 0.9995515937983357, 'loss_val': 0.029402670220968773, 'psi': 0.9959157468251568}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=24 head_norm_before_train=1.509122 cos_to_last_merge=0.8235 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.823
[S10] round=24 local utility u=0.003295 metrics={'f1_val': 0.9955013957964032, 'auprc': 0.9965895093547612, 'loss_val': 0.06531996566686792, 'psi': 0.9959366412197463}-{'f1_val': 0.9955013957964032, 'auprc': 0.9970746852467849, 'loss_val': 0.0733659554043303, 'psi': 0.9961307115765559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=24 head_norm_before_train=1.591909 cos_to_last_merge=0.9985 (last merge round=21)
[S11] round=24 local utility u=0.011322 metrics={'f1_val': 0.9970303038664694, 'auprc': 0.9982008574115154, 'loss_val': 0.10342436924831103, 'psi': 0.9974985252844879}-{'f1_val': 0.9965470045135896, 'auprc': 0.998043222154615, 'loss_val': 0.12269502188530963, 'psi': 0.9971454915699998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=24 head_norm_before_train=1.626439 (no previous merge yet)
[S13] round=24 local utility u=0.091782 metrics={'f1_val': 0.6466768666198998, 'auprc': 0.7480627042773006, 'loss_val': 0.4891745768381499, 'psi': 0.6872312016828601}-{'f1_val': 0.621680811358229, 'auprc': 0.76573460786657, 'loss_val': 0.5757779859473603, 'psi': 0.6793023299615654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=24 head_norm_before_train=1.594964 cos_to_last_merge=0.9966 (last merge round=19)
[S14] round=24 local utility u=0.000663 metrics={'f1_val': 0.9978876167521111, 'auprc': 0.9989474631871745, 'loss_val': 0.04214353916066723, 'psi': 0.9983115553261366}-{'f1_val': 0.9979803455147667, 'auprc': 0.9989449651795281, 'loss_val': 0.044018024648651184, 'psi': 0.9983661933806712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=24 head_norm_before_train=1.254979 cos_to_last_merge=0.9877 (last merge round=19)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.69874462408325, 'auprc': 0.8613846675967308, 'loss_val': 0.43782055679544246, 'psi': 0.7638006414886424}-{'f1_val': 0.9453920883754298, 'auprc': 0.9935784107663257, 'loss_val': 0.1492146784177336, 'psi': 0.9646666173317882}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=24 head_norm_before_train=1.705105 cos_to_last_merge=0.9914 (last merge round=16)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.893458975038489, 'auprc': 0.9871553406646715, 'loss_val': 0.2221027052684857, 'psi': 0.930937521288962}-{'f1_val': 0.9390812943777298, 'auprc': 0.9861562136516792, 'loss_val': 0.2070370929063905, 'psi': 0.9579112620873096}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=24 head_norm_before_train=1.237990 cos_to_last_merge=0.9751 (last merge round=16)
[S17] round=24 local utility u=0.511533 metrics={'f1_val': 0.563589573183491, 'auprc': 0.7857759775304985, 'loss_val': 0.5515475776063337, 'psi': 0.652464134922294}-{'f1_val': 0.40256731413033414, 'auprc': 0.7879654496442622, 'loss_val': 0.6150489404174332, 'psi': 0.5567265683359054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=25 head_norm_before_train=1.539304 cos_to_last_merge=0.9934 (last merge round=18)
[S2] round=25 local utility u=0.130009 metrics={'f1_val': 0.8274399300490484, 'auprc': 0.8705426604150108, 'loss_val': 0.4042920132637735, 'psi': 0.8446810221954333}-{'f1_val': 0.7980771455772745, 'auprc': 0.8591802631603275, 'loss_val': 0.4540459129882228, 'psi': 0.8225183926104958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=25 head_norm_before_train=1.635273 cos_to_last_merge=0.7894 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.789
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9785814939268872, 'auprc': 0.9980846141988083, 'loss_val': 0.07706784103490961, 'psi': 0.9863827420356557}-{'f1_val': 0.9974985492286463, 'auprc': 0.9979699668298792, 'loss_val': 0.06470585804743557, 'psi': 0.9976871162691394}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=1.257303 cos_to_last_merge=0.9576 (last merge round=17)
[S4] round=25 local utility u=0.002215 metrics={'f1_val': 0.6122143085898493, 'auprc': 0.9491682143543105, 'loss_val': 0.4901499767938479, 'psi': 0.7469958708956338}-{'f1_val': 0.6112747574029852, 'auprc': 0.9507266299917182, 'loss_val': 0.4936188379472611, 'psi': 0.7470555064384785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=25 head_norm_before_train=1.584527 cos_to_last_merge=0.9908 (last merge round=16)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7030641086643515, 'auprc': 0.990921316718856, 'loss_val': 0.24120832085707272, 'psi': 0.8182069918861533}-{'f1_val': 0.700320598491359, 'auprc': 0.995588298373147, 'loss_val': 0.21501573801239968, 'psi': 0.8184276784440743}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=25 head_norm_before_train=1.666139 (no previous merge yet)
[S6] round=25 local utility u=1.000000 metrics={'f1_val': 0.9399102800779828, 'auprc': 0.9240149031455908, 'loss_val': 0.2862497589548985, 'psi': 0.933552129305026}-{'f1_val': 0.6421909847760534, 'auprc': 0.7802708662251127, 'loss_val': 0.5088780408776222, 'psi': 0.6974229373556771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=25 head_norm_before_train=1.262435 cos_to_last_merge=0.9952 (last merge round=19)
[S7] round=25 local utility u=0.817704 metrics={'f1_val': 0.6525589749946071, 'auprc': 0.8040204199314489, 'loss_val': 0.5045519244132696, 'psi': 0.7131435529693438}-{'f1_val': 0.5270959481291491, 'auprc': 0.6330956597527587, 'loss_val': 0.8744079226029091, 'psi': 0.5694958327785928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=25 head_norm_before_train=1.631266 cos_to_last_merge=0.9816 (last merge round=16)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.993553675737062, 'auprc': 0.9989853211181254, 'loss_val': 0.08180080182624576, 'psi': 0.9957263338894874}-{'f1_val': 0.9953812994639146, 'auprc': 0.998626457834806, 'loss_val': 0.08592807734772935, 'psi': 0.9966793628122712}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=25 head_norm_before_train=1.864732 (no previous merge yet)
[S9] round=25 local utility u=0.021644 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9968279958177639, 'loss_val': 0.023562251505644043, 'psi': 0.9967275054154404}-{'f1_val': 0.9901297741397954, 'auprc': 0.9995357240377388, 'loss_val': 0.035788627067573194, 'psi': 0.9938921540989728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=25 head_norm_before_train=1.530510 cos_to_last_merge=0.8202 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.820
[S10] round=25 local utility u=0.003058 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9966285833244517, 'loss_val': 0.05865204288303759, 'psi': 0.9958854339462133}-{'f1_val': 0.9955013957964032, 'auprc': 0.9965895093547612, 'loss_val': 0.06531996566686792, 'psi': 0.9959366412197463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=25 head_norm_before_train=1.617120 cos_to_last_merge=0.9971 (last merge round=21)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979355889637954, 'loss_val': 0.10157760746549348, 'psi': 0.9969573360668347}-{'f1_val': 0.9970303038664694, 'auprc': 0.9982008574115154, 'loss_val': 0.10342436924831103, 'psi': 0.9974985252844879}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=25 head_norm_before_train=1.646029 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6309031059592821, 'auprc': 0.7310680887298264, 'loss_val': 0.5340151384073375, 'psi': 0.6709690990674998}-{'f1_val': 0.6466768666198998, 'auprc': 0.7480627042773006, 'loss_val': 0.4891745768381499, 'psi': 0.6872312016828601}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=25 head_norm_before_train=1.613589 cos_to_last_merge=0.9956 (last merge round=19)
[S14] round=25 local utility u=0.003079 metrics={'f1_val': 0.9977377496967396, 'auprc': 0.9989465972037661, 'loss_val': 0.035084159466031765, 'psi': 0.9982212886995502}-{'f1_val': 0.9978876167521111, 'auprc': 0.9989474631871745, 'loss_val': 0.04214353916066723, 'psi': 0.9983115553261366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=25 head_norm_before_train=1.290599 cos_to_last_merge=0.9837 (last merge round=19)
[S15] round=25 local utility u=1.000000 metrics={'f1_val': 0.9336063076791719, 'auprc': 0.9957128686257082, 'loss_val': 0.11693006474827046, 'psi': 0.9584489320577864}-{'f1_val': 0.69874462408325, 'auprc': 0.8613846675967308, 'loss_val': 0.43782055679544246, 'psi': 0.7638006414886424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=25 head_norm_before_train=1.721541 cos_to_last_merge=0.9904 (last merge round=16)
[S16] round=25 local utility u=0.306306 metrics={'f1_val': 0.9744081551647826, 'auprc': 0.9905836040202891, 'loss_val': 0.10547131368798716, 'psi': 0.9808783347069853}-{'f1_val': 0.893458975038489, 'auprc': 0.9871553406646715, 'loss_val': 0.2221027052684857, 'psi': 0.930937521288962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=25 head_norm_before_train=1.259677 cos_to_last_merge=0.9712 (last merge round=16)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.5095992660630143, 'auprc': 0.7547173955094899, 'loss_val': 0.580927420625622, 'psi': 0.6076465178416046}-{'f1_val': 0.563589573183491, 'auprc': 0.7857759775304985, 'loss_val': 0.5515475776063337, 'psi': 0.652464134922294}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=26 head_norm_before_train=1.559540 cos_to_last_merge=0.9911 (last merge round=18)
[S2] round=26 local utility u=0.004237 metrics={'f1_val': 0.8369171889608086, 'auprc': 0.8638833600277492, 'loss_val': 0.43270398004108934, 'psi': 0.8477036573875848}-{'f1_val': 0.8274399300490484, 'auprc': 0.8705426604150108, 'loss_val': 0.4042920132637735, 'psi': 0.8446810221954333}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=26 head_norm_before_train=1.653021 cos_to_last_merge=0.7868 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.787
[S3] round=26 local utility u=0.059219 metrics={'f1_val': 0.9965365984006044, 'auprc': 0.9983138472554749, 'loss_val': 0.06704875616780687, 'psi': 0.9972474979425525}-{'f1_val': 0.9785814939268872, 'auprc': 0.9980846141988083, 'loss_val': 0.07706784103490961, 'psi': 0.9863827420356557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=26 head_norm_before_train=1.280795 cos_to_last_merge=0.9531 (last merge round=17)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.6129160256844602, 'auprc': 0.9491285446323936, 'loss_val': 0.4971738518183245, 'psi': 0.7474010332636336}-{'f1_val': 0.6122143085898493, 'auprc': 0.9491682143543105, 'loss_val': 0.4901499767938479, 'psi': 0.7469958708956338}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=26 head_norm_before_train=1.600859 cos_to_last_merge=0.9891 (last merge round=16)
[S5] round=26 local utility u=0.108337 metrics={'f1_val': 0.749383193909287, 'auprc': 0.9744317265984235, 'loss_val': 0.2529810493016121, 'psi': 0.8394026069849416}-{'f1_val': 0.7030641086643515, 'auprc': 0.990921316718856, 'loss_val': 0.24120832085707272, 'psi': 0.8182069918861533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=26 head_norm_before_train=1.677246 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.6424436974123455, 'auprc': 0.7806641345370948, 'loss_val': 0.5915569981464114, 'psi': 0.6977318722622452}-{'f1_val': 0.9399102800779828, 'auprc': 0.9240149031455908, 'loss_val': 0.2862497589548985, 'psi': 0.933552129305026}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=26 head_norm_before_train=1.280176 cos_to_last_merge=0.9941 (last merge round=19)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.4450158401076535, 'auprc': 0.6414941137889065, 'loss_val': 1.0056504219862072, 'psi': 0.5236071495801546}-{'f1_val': 0.6525589749946071, 'auprc': 0.8040204199314489, 'loss_val': 0.5045519244132696, 'psi': 0.7131435529693438}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=1.654480 cos_to_last_merge=0.9794 (last merge round=16)
[S8] round=26 local utility u=0.009216 metrics={'f1_val': 0.9963402451333164, 'auprc': 0.9967805186029239, 'loss_val': 0.07347345963152714, 'psi': 0.9965163545211595}-{'f1_val': 0.993553675737062, 'auprc': 0.9989853211181254, 'loss_val': 0.08180080182624576, 'psi': 0.9957263338894874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=26 head_norm_before_train=1.876029 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9901297741397954, 'auprc': 0.9995221707291904, 'loss_val': 0.03345206427689416, 'psi': 0.9938867327755534}-{'f1_val': 0.9966605118138915, 'auprc': 0.9968279958177639, 'loss_val': 0.023562251505644043, 'psi': 0.9967275054154404}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=26 head_norm_before_train=1.555044 cos_to_last_merge=0.8165 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.817
[S10] round=26 local utility u=0.000405 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958550740732247, 'loss_val': 0.054307950187226325, 'psi': 0.9954547330409147}-{'f1_val': 0.9953900010273877, 'auprc': 0.9966285833244517, 'loss_val': 0.05865204288303759, 'psi': 0.9958854339462133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=26 head_norm_before_train=1.643254 cos_to_last_merge=0.9952 (last merge round=21)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9071928743169293, 'auprc': 0.9967227553700123, 'loss_val': 0.14837933060284703, 'psi': 0.9430048267381625}-{'f1_val': 0.996305167468861, 'auprc': 0.9979355889637954, 'loss_val': 0.10157760746549348, 'psi': 0.9969573360668347}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=26 head_norm_before_train=1.658689 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6270662118066677, 'auprc': 0.6965345823465929, 'loss_val': 0.5968883386427413, 'psi': 0.6548535600226377}-{'f1_val': 0.6309031059592821, 'auprc': 0.7310680887298264, 'loss_val': 0.5340151384073375, 'psi': 0.6709690990674998}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=1.632990 cos_to_last_merge=0.9946 (last merge round=19)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9300667983078812, 'auprc': 0.998836269221973, 'loss_val': 0.1144089313927575, 'psi': 0.9575745866735179}-{'f1_val': 0.9977377496967396, 'auprc': 0.9989465972037661, 'loss_val': 0.035084159466031765, 'psi': 0.9982212886995502}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=26 head_norm_before_train=1.319342 cos_to_last_merge=0.9804 (last merge round=19)
[S15] round=26 local utility u=0.004918 metrics={'f1_val': 0.934622979928375, 'auprc': 0.9946814524701599, 'loss_val': 0.1100998640331146, 'psi': 0.9586463689450889}-{'f1_val': 0.9336063076791719, 'auprc': 0.9957128686257082, 'loss_val': 0.11693006474827046, 'psi': 0.9584489320577864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=26 head_norm_before_train=1.738775 cos_to_last_merge=0.9896 (last merge round=16)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.9697098555125452, 'auprc': 0.9916383362676506, 'loss_val': 0.11069810120599573, 'psi': 0.9784812478145873}-{'f1_val': 0.9744081551647826, 'auprc': 0.9905836040202891, 'loss_val': 0.10547131368798716, 'psi': 0.9808783347069853}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=1.284750 cos_to_last_merge=0.9664 (last merge round=16)
[S17] round=26 local utility u=0.580762 metrics={'f1_val': 0.6530330281424122, 'auprc': 0.8286783654130752, 'loss_val': 0.5018887915137842, 'psi': 0.7232911630506773}-{'f1_val': 0.5095992660630143, 'auprc': 0.7547173955094899, 'loss_val': 0.580927420625622, 'psi': 0.6076465178416046}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=27 head_norm_before_train=1.582477 cos_to_last_merge=0.9884 (last merge round=18)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6615175092041778, 'auprc': 0.740497180822759, 'loss_val': 0.5762076498279838, 'psi': 0.6931093778516102}-{'f1_val': 0.8369171889608086, 'auprc': 0.8638833600277492, 'loss_val': 0.43270398004108934, 'psi': 0.8477036573875848}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=27 head_norm_before_train=1.672780 cos_to_last_merge=0.7839 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.784
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9986819572147767, 'loss_val': 0.09185148421345088, 'psi': 0.9979117243535451}-{'f1_val': 0.9965365984006044, 'auprc': 0.9983138472554749, 'loss_val': 0.06704875616780687, 'psi': 0.9972474979425525}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=1.301902 cos_to_last_merge=0.9491 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.949
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.6130195951622412, 'auprc': 0.9382399592189166, 'loss_val': 0.47379627094503113, 'psi': 0.7431077407849114}-{'f1_val': 0.6129160256844602, 'auprc': 0.9491285446323936, 'loss_val': 0.4971738518183245, 'psi': 0.7474010332636336}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=27 head_norm_before_train=1.618800 cos_to_last_merge=0.9876 (last merge round=16)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.7292258241695345, 'auprc': 0.966731168575687, 'loss_val': 0.26760200461310335, 'psi': 0.8242279619319954}-{'f1_val': 0.749383193909287, 'auprc': 0.9744317265984235, 'loss_val': 0.2529810493016121, 'psi': 0.8394026069849416}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=27 head_norm_before_train=1.691752 (no previous merge yet)
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.931903481099568, 'auprc': 0.9264185563841622, 'loss_val': 0.2675393596397389, 'psi': 0.9297095112134057}-{'f1_val': 0.6424436974123455, 'auprc': 0.7806641345370948, 'loss_val': 0.5915569981464114, 'psi': 0.6977318722622452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=27 head_norm_before_train=1.290691 cos_to_last_merge=0.9935 (last merge round=19)
[S7] round=27 local utility u=1.000000 metrics={'f1_val': 0.6983503936015005, 'auprc': 0.9204577905096772, 'loss_val': 0.32532157556042074, 'psi': 0.7871933523647712}-{'f1_val': 0.4450158401076535, 'auprc': 0.6414941137889065, 'loss_val': 1.0056504219862072, 'psi': 0.5236071495801546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=27 head_norm_before_train=1.673059 cos_to_last_merge=0.9776 (last merge round=16)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9888667903680081, 'auprc': 0.9989662395337549, 'loss_val': 0.0899086257954544, 'psi': 0.9929065700343067}-{'f1_val': 0.9963402451333164, 'auprc': 0.9967805186029239, 'loss_val': 0.07347345963152714, 'psi': 0.9965163545211595}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=27 head_norm_before_train=1.888582 (no previous merge yet)
[S9] round=27 local utility u=0.021830 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9995012682851048, 'loss_val': 0.0239116603353814, 'psi': 0.9972965383325532}-{'f1_val': 0.9901297741397954, 'auprc': 0.9995221707291904, 'loss_val': 0.03345206427689416, 'psi': 0.9938867327755534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=27 head_norm_before_train=1.580359 cos_to_last_merge=0.8130 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.813
[S10] round=27 local utility u=0.002744 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9961004534902806, 'loss_val': 0.048237901504545586, 'psi': 0.9954210933151579}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958550740732247, 'loss_val': 0.054307950187226325, 'psi': 0.9954547330409147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=27 head_norm_before_train=1.667493 cos_to_last_merge=0.9931 (last merge round=21)
[S11] round=27 local utility u=0.316351 metrics={'f1_val': 0.9970303038664694, 'auprc': 0.9981303548408721, 'loss_val': 0.05892554025283645, 'psi': 0.9974703242562305}-{'f1_val': 0.9071928743169293, 'auprc': 0.9967227553700123, 'loss_val': 0.14837933060284703, 'psi': 0.9430048267381625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=27 head_norm_before_train=1.671855 (no previous merge yet)
[S13] round=27 local utility u=0.123351 metrics={'f1_val': 0.6624615359525021, 'auprc': 0.6682558361309507, 'loss_val': 0.4777219123224637, 'psi': 0.6647792560238817}-{'f1_val': 0.6270662118066677, 'auprc': 0.6965345823465929, 'loss_val': 0.5968883386427413, 'psi': 0.6548535600226377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=27 head_norm_before_train=1.650842 cos_to_last_merge=0.9935 (last merge round=19)
[S14] round=27 local utility u=0.245471 metrics={'f1_val': 0.9977377496967396, 'auprc': 0.9989465352733552, 'loss_val': 0.02982355803807879, 'psi': 0.9982212639273857}-{'f1_val': 0.9300667983078812, 'auprc': 0.998836269221973, 'loss_val': 0.1144089313927575, 'psi': 0.9575745866735179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=27 head_norm_before_train=1.350303 cos_to_last_merge=0.9769 (last merge round=19)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.8746629556237644, 'auprc': 0.9934700187073463, 'loss_val': 0.20702600754496053, 'psi': 0.9221857808571972}-{'f1_val': 0.934622979928375, 'auprc': 0.9946814524701599, 'loss_val': 0.1100998640331146, 'psi': 0.9586463689450889}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=27 head_norm_before_train=1.754360 cos_to_last_merge=0.9888 (last merge round=16)
[S16] round=27 local utility u=0.073041 metrics={'f1_val': 0.9882571884495168, 'auprc': 0.991114836638404, 'loss_val': 0.07432867120792004, 'psi': 0.9894002477250716}-{'f1_val': 0.9697098555125452, 'auprc': 0.9916383362676506, 'loss_val': 0.11069810120599573, 'psi': 0.9784812478145873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=27 head_norm_before_train=1.312467 cos_to_last_merge=0.9611 (last merge round=16)
[S17] round=27 local utility u=0.153155 metrics={'f1_val': 0.7135033052981716, 'auprc': 0.8027954727375775, 'loss_val': 0.4807521693075771, 'psi': 0.749220172273934}-{'f1_val': 0.6530330281424122, 'auprc': 0.8286783654130752, 'loss_val': 0.5018887915137842, 'psi': 0.7232911630506773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=28 head_norm_before_train=1.605906 cos_to_last_merge=0.9856 (last merge round=18)
[S2] round=28 local utility u=0.778461 metrics={'f1_val': 0.824881451820254, 'auprc': 0.8773093313902087, 'loss_val': 0.4099053494890312, 'psi': 0.8458526036482359}-{'f1_val': 0.6615175092041778, 'auprc': 0.740497180822759, 'loss_val': 0.5762076498279838, 'psi': 0.6931093778516102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=28 head_norm_before_train=1.691135 cos_to_last_merge=0.7813 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.781
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.933322139176921, 'auprc': 0.9982483792397356, 'loss_val': 0.1902753338222873, 'psi': 0.9592926352020468}-{'f1_val': 0.9973982357793907, 'auprc': 0.9986819572147767, 'loss_val': 0.09185148421345088, 'psi': 0.9979117243535451}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=1.323488 cos_to_last_merge=0.9453 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.945
[S4] round=28 local utility u=0.023499 metrics={'f1_val': 0.6194170358093531, 'auprc': 0.9342678043140304, 'loss_val': 0.45326715904939807, 'psi': 0.7453573432112242}-{'f1_val': 0.6130195951622412, 'auprc': 0.9382399592189166, 'loss_val': 0.47379627094503113, 'psi': 0.7431077407849114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=28 head_norm_before_train=1.634816 cos_to_last_merge=0.9861 (last merge round=16)
[S5] round=28 local utility u=0.911456 metrics={'f1_val': 0.9964804002465358, 'auprc': 0.9960453975929713, 'loss_val': 0.13616075874404784, 'psi': 0.99630639918511}-{'f1_val': 0.7292258241695345, 'auprc': 0.966731168575687, 'loss_val': 0.26760200461310335, 'psi': 0.8242279619319954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=28 head_norm_before_train=1.703602 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.8244891153680585, 'auprc': 0.9330295674478373, 'loss_val': 0.3086497037641297, 'psi': 0.86790529619997}-{'f1_val': 0.931903481099568, 'auprc': 0.9264185563841622, 'loss_val': 0.2675393596397389, 'psi': 0.9297095112134057}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.303439 cos_to_last_merge=0.9927 (last merge round=19)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.6163573912348611, 'auprc': 0.7877133741228485, 'loss_val': 0.6479232805185725, 'psi': 0.684899784390056}-{'f1_val': 0.6983503936015005, 'auprc': 0.9204577905096772, 'loss_val': 0.32532157556042074, 'psi': 0.7871933523647712}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=1.691995 cos_to_last_merge=0.9758 (last merge round=16)
[S8] round=28 local utility u=0.023604 metrics={'f1_val': 0.9948599102674471, 'auprc': 0.9959246953083103, 'loss_val': 0.06953420242718295, 'psi': 0.9952858242837924}-{'f1_val': 0.9888667903680081, 'auprc': 0.9989662395337549, 'loss_val': 0.0899086257954544, 'psi': 0.9929065700343067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=28 head_norm_before_train=1.899396 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9994954598796759, 'loss_val': 0.026900355368198393, 'psi': 0.9958932932576929}-{'f1_val': 0.9958267183641853, 'auprc': 0.9995012682851048, 'loss_val': 0.0239116603353814, 'psi': 0.9972965383325532}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.605963 cos_to_last_merge=0.8095 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.809
[S10] round=28 local utility u=0.000459 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9960311400067106, 'loss_val': 0.04447726070980709, 'psi': 0.9951299200817209}-{'f1_val': 0.9949681865317428, 'auprc': 0.9961004534902806, 'loss_val': 0.048237901504545586, 'psi': 0.9954210933151579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=28 head_norm_before_train=1.693413 cos_to_last_merge=0.9908 (last merge round=21)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9981301553517978, 'loss_val': 0.06316113089810121, 'psi': 0.9970772942861696}-{'f1_val': 0.9970303038664694, 'auprc': 0.9981303548408721, 'loss_val': 0.05892554025283645, 'psi': 0.9974703242562305}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=28 head_norm_before_train=1.684390 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5787557554381605, 'auprc': 0.7134083361149153, 'loss_val': 0.9043841832898066, 'psi': 0.6326167877088624}-{'f1_val': 0.6624615359525021, 'auprc': 0.6682558361309507, 'loss_val': 0.4777219123224637, 'psi': 0.6647792560238817}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=1.666768 cos_to_last_merge=0.9926 (last merge round=19)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9969657466406101, 'auprc': 0.9975213682386902, 'loss_val': 0.04365463127929888, 'psi': 0.9971879952798421}-{'f1_val': 0.9977377496967396, 'auprc': 0.9989465352733552, 'loss_val': 0.02982355803807879, 'psi': 0.9982212639273857}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=1.380769 cos_to_last_merge=0.9734 (last merge round=19)
[S15] round=28 local utility u=0.381735 metrics={'f1_val': 0.9796393192389494, 'auprc': 0.9948611624275578, 'loss_val': 0.07758733848454856, 'psi': 0.9857280565143929}-{'f1_val': 0.8746629556237644, 'auprc': 0.9934700187073463, 'loss_val': 0.20702600754496053, 'psi': 0.9221857808571972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[S16] START round=28 head_norm_before_train=1.768782 cos_to_last_merge=0.9880 (last merge round=16)
[S16] round=28 local utility u=0.001603 metrics={'f1_val': 0.9884666501126564, 'auprc': 0.9905750761299272, 'loss_val': 0.07076003518360385, 'psi': 0.9893100205195647}-{'f1_val': 0.9882571884495168, 'auprc': 0.991114836638404, 'loss_val': 0.07432867120792004, 'psi': 0.9894002477250716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=28 head_norm_before_train=1.342579 cos_to_last_merge=0.9555 (last merge round=16)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6476198150186312, 'auprc': 0.8948132858162579, 'loss_val': 0.48585281051902574, 'psi': 0.7464972033376819}-{'f1_val': 0.7135033052981716, 'auprc': 0.8027954727375775, 'loss_val': 0.4807521693075771, 'psi': 0.749220172273934}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.622557 cos_to_last_merge=0.9835 (last merge round=18)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.7813264481702994, 'auprc': 0.8211680163488057, 'loss_val': 0.53423484898344, 'psi': 0.7972630754417018}-{'f1_val': 0.824881451820254, 'auprc': 0.8773093313902087, 'loss_val': 0.4099053494890312, 'psi': 0.8458526036482359}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=1.707551 cos_to_last_merge=0.7794 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.779
[S3] round=29 local utility u=0.105425 metrics={'f1_val': 0.9606109340814555, 'auprc': 0.9981635028420857, 'loss_val': 0.1429037615547072, 'psi': 0.9756319615857075}-{'f1_val': 0.933322139176921, 'auprc': 0.9982483792397356, 'loss_val': 0.1902753338222873, 'psi': 0.9592926352020468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=29 head_norm_before_train=1.343988 cos_to_last_merge=0.9414 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.941
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.6154546255402527, 'auprc': 0.946607400715641, 'loss_val': 0.4708599113318856, 'psi': 0.747915735610408}-{'f1_val': 0.6194170358093531, 'auprc': 0.9342678043140304, 'loss_val': 0.45326715904939807, 'psi': 0.7453573432112242}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.647526 cos_to_last_merge=0.9848 (last merge round=16)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.9585513538715271, 'auprc': 0.9930773536916191, 'loss_val': 0.15616791859412385, 'psi': 0.9723617537995639}-{'f1_val': 0.9964804002465358, 'auprc': 0.9960453975929713, 'loss_val': 0.13616075874404784, 'psi': 0.99630639918511}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=1.721048 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.8116419149548728, 'auprc': 0.7771175774799206, 'loss_val': 0.4150575964500855, 'psi': 0.797832179964892}-{'f1_val': 0.8244891153680585, 'auprc': 0.9330295674478373, 'loss_val': 0.3086497037641297, 'psi': 0.86790529619997}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=29 head_norm_before_train=1.319624 cos_to_last_merge=0.9912 (last merge round=19)
[S7] round=29 local utility u=0.160127 metrics={'f1_val': 0.6439530575317486, 'auprc': 0.8008994876762809, 'loss_val': 0.5328008373159656, 'psi': 0.7067316295895616}-{'f1_val': 0.6163573912348611, 'auprc': 0.7877133741228485, 'loss_val': 0.6479232805185725, 'psi': 0.684899784390056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=29 head_norm_before_train=1.704662 cos_to_last_merge=0.9746 (last merge round=16)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9146996806464427, 'auprc': 0.995309092781156, 'loss_val': 0.13056995187980064, 'psi': 0.946943445500328}-{'f1_val': 0.9948599102674471, 'auprc': 0.9959246953083103, 'loss_val': 0.06953420242718295, 'psi': 0.9952858242837924}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=1.908972 (no previous merge yet)
[S9] round=29 local utility u=0.012166 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9993533263862883, 'loss_val': 0.021326174866130015, 'psi': 0.9977548195332184}-{'f1_val': 0.9934918488430377, 'auprc': 0.9994954598796759, 'loss_val': 0.026900355368198393, 'psi': 0.9958932932576929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=29 head_norm_before_train=1.629936 cos_to_last_merge=0.8065 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.806
[S10] round=29 local utility u=0.000890 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9956921978050028, 'loss_val': 0.04168013768255157, 'psi': 0.9949943432010377}-{'f1_val': 0.9945291067983943, 'auprc': 0.9960311400067106, 'loss_val': 0.04447726070980709, 'psi': 0.9951299200817209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=29 head_norm_before_train=1.715650 cos_to_last_merge=0.9887 (last merge round=21)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9778585445269737, 'auprc': 0.9966813699899182, 'loss_val': 0.09724171646557046, 'psi': 0.9853876747121515}-{'f1_val': 0.9963753869090841, 'auprc': 0.9981301553517978, 'loss_val': 0.06316113089810121, 'psi': 0.9970772942861696}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=29 head_norm_before_train=1.688989 (no previous merge yet)
[S13] round=29 local utility u=0.613487 metrics={'f1_val': 0.6812466646703019, 'auprc': 0.7556267587528376, 'loss_val': 0.41901147714520326, 'psi': 0.7109987023033162}-{'f1_val': 0.5787557554381605, 'auprc': 0.7134083361149153, 'loss_val': 0.9043841832898066, 'psi': 0.6326167877088624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=29 head_norm_before_train=1.679357 cos_to_last_merge=0.9919 (last merge round=19)
[S14] round=29 local utility u=0.011059 metrics={'f1_val': 0.9973269879856502, 'auprc': 0.9990270243850252, 'loss_val': 0.028220360487299593, 'psi': 0.9980070025454002}-{'f1_val': 0.9969657466406101, 'auprc': 0.9975213682386902, 'loss_val': 0.04365463127929888, 'psi': 0.9971879952798421}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=29 head_norm_before_train=1.408387 cos_to_last_merge=0.9703 (last merge round=19)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.8079019360347459, 'auprc': 0.9904049960324695, 'loss_val': 0.267435603751298, 'psi': 0.8809031600338353}-{'f1_val': 0.9796393192389494, 'auprc': 0.9948611624275578, 'loss_val': 0.07758733848454856, 'psi': 0.9857280565143929}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=1.782864 cos_to_last_merge=0.9872 (last merge round=16)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.980455751637221, 'auprc': 0.9916273108700189, 'loss_val': 0.0833488808273098, 'psi': 0.98492437533034}-{'f1_val': 0.9884666501126564, 'auprc': 0.9905750761299272, 'loss_val': 0.07076003518360385, 'psi': 0.9893100205195647}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=1.374687 cos_to_last_merge=0.9502 (last merge round=16)
[S17] round=29 local utility u=0.099424 metrics={'f1_val': 0.6515817199170548, 'auprc': 0.9502321228122882, 'loss_val': 0.47703194113005437, 'psi': 0.7710418810751483}-{'f1_val': 0.6476198150186312, 'auprc': 0.8948132858162579, 'loss_val': 0.48585281051902574, 'psi': 0.7464972033376819}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=30 head_norm_before_train=1.634658 cos_to_last_merge=0.9821 (last merge round=18)
[S2] round=30 local utility u=0.167705 metrics={'f1_val': 0.8149014331591701, 'auprc': 0.8332913478875125, 'loss_val': 0.4366455221357927, 'psi': 0.8222573990505071}-{'f1_val': 0.7813264481702994, 'auprc': 0.8211680163488057, 'loss_val': 0.53423484898344, 'psi': 0.7972630754417018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=30 head_norm_before_train=1.722229 cos_to_last_merge=0.7778 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.778
[S3] round=30 local utility u=0.161428 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9985572811751214, 'loss_val': 0.04425205050822518, 'psi': 0.9980918102970071}-{'f1_val': 0.9606109340814555, 'auprc': 0.9981635028420857, 'loss_val': 0.1429037615547072, 'psi': 0.9756319615857075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=30 head_norm_before_train=1.357667 cos_to_last_merge=0.9387 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.939
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.6128825945199587, 'auprc': 0.9538183163878888, 'loss_val': 0.48343139942005947, 'psi': 0.7492568832671307}-{'f1_val': 0.6154546255402527, 'auprc': 0.946607400715641, 'loss_val': 0.4708599113318856, 'psi': 0.747915735610408}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=1.656072 cos_to_last_merge=0.9838 (last merge round=16)
[S5] round=30 local utility u=0.120052 metrics={'f1_val': 0.9944149664932573, 'auprc': 0.9933072421886082, 'loss_val': 0.1319349996155433, 'psi': 0.9939718767713976}-{'f1_val': 0.9585513538715271, 'auprc': 0.9930773536916191, 'loss_val': 0.15616791859412385, 'psi': 0.9723617537995639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=30 head_norm_before_train=1.737962 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.7719723556734945, 'auprc': 0.769527008983081, 'loss_val': 0.5448573104724402, 'psi': 0.7709942169973292}-{'f1_val': 0.8116419149548728, 'auprc': 0.7771175774799206, 'loss_val': 0.4150575964500855, 'psi': 0.797832179964892}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.340929 cos_to_last_merge=0.9894 (last merge round=19)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.46322487960705383, 'auprc': 0.7776129875199554, 'loss_val': 0.9184155802260224, 'psi': 0.5889801227722145}-{'f1_val': 0.6439530575317486, 'auprc': 0.8008994876762809, 'loss_val': 0.5328008373159656, 'psi': 0.7067316295895616}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=30 head_norm_before_train=1.712629 cos_to_last_merge=0.9740 (last merge round=16)
[S8] round=30 local utility u=0.282569 metrics={'f1_val': 0.9949323051384696, 'auprc': 0.9991143645299752, 'loss_val': 0.05824266582061207, 'psi': 0.9966051288950718}-{'f1_val': 0.9146996806464427, 'auprc': 0.995309092781156, 'loss_val': 0.13056995187980064, 'psi': 0.946943445500328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=30 head_norm_before_train=1.917624 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9939839846302205, 'loss_val': 0.02160667560830203, 'psi': 0.9955899009404231}-{'f1_val': 0.9966891482978385, 'auprc': 0.9993533263862883, 'loss_val': 0.021326174866130015, 'psi': 0.9977548195332184}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.652880 cos_to_last_merge=0.8036 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.804
[S10] round=30 local utility u=0.001862 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9961386500481522, 'loss_val': 0.03929478706018107, 'psi': 0.9951729240982975}-{'f1_val': 0.9945291067983943, 'auprc': 0.9956921978050028, 'loss_val': 0.04168013768255157, 'psi': 0.9949943432010377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=30 head_norm_before_train=1.738356 cos_to_last_merge=0.9868 (last merge round=21)
[S11] round=30 local utility u=0.035814 metrics={'f1_val': 0.9867585279771589, 'auprc': 0.9979391252596919, 'loss_val': 0.08278779347837507, 'psi': 0.9912307668901721}-{'f1_val': 0.9778585445269737, 'auprc': 0.9966813699899182, 'loss_val': 0.09724171646557046, 'psi': 0.9853876747121515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=30 head_norm_before_train=1.688772 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6266623239435655, 'auprc': 0.789254886797661, 'loss_val': 0.5871542368445839, 'psi': 0.6916993490852037}-{'f1_val': 0.6812466646703019, 'auprc': 0.7556267587528376, 'loss_val': 0.41901147714520326, 'psi': 0.7109987023033162}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.688391 cos_to_last_merge=0.9913 (last merge round=19)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9878073713273039, 'auprc': 0.9988720695967612, 'loss_val': 0.048767116242354525, 'psi': 0.9922332506350868}-{'f1_val': 0.9973269879856502, 'auprc': 0.9990270243850252, 'loss_val': 0.028220360487299593, 'psi': 0.9980070025454002}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=1.431244 cos_to_last_merge=0.9676 (last merge round=19)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.783033019662846, 'auprc': 0.9916900944133096, 'loss_val': 0.30141017700651496, 'psi': 0.8664958495630315}-{'f1_val': 0.8079019360347459, 'auprc': 0.9904049960324695, 'loss_val': 0.267435603751298, 'psi': 0.8809031600338353}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.795557 cos_to_last_merge=0.9865 (last merge round=16)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.957047912581827, 'auprc': 0.9919343696872043, 'loss_val': 0.1242581441240187, 'psi': 0.9710024954239779}-{'f1_val': 0.980455751637221, 'auprc': 0.9916273108700189, 'loss_val': 0.0833488808273098, 'psi': 0.98492437533034}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=1.407133 cos_to_last_merge=0.9454 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.945
[S17] round=30 local utility u=0.017258 metrics={'f1_val': 0.654350277162961, 'auprc': 0.9525649625034535, 'loss_val': 0.4661251357007631, 'psi': 0.7736361512991581}-{'f1_val': 0.6515817199170548, 'auprc': 0.9502321228122882, 'loss_val': 0.47703194113005437, 'psi': 0.7710418810751483}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=31 head_norm_before_train=1.646333 cos_to_last_merge=0.9811 (last merge round=18)
[S2] round=31 local utility u=0.113631 metrics={'f1_val': 0.8189389695619762, 'auprc': 0.8952035059144661, 'loss_val': 0.41934510397784913, 'psi': 0.8494447841029722}-{'f1_val': 0.8149014331591701, 'auprc': 0.8332913478875125, 'loss_val': 0.4366455221357927, 'psi': 0.8222573990505071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=31 head_norm_before_train=1.737105 cos_to_last_merge=0.7764 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.776
[S3] round=31 local utility u=0.002859 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9981599286586058, 'loss_val': 0.03734263793618373, 'psi': 0.9979328692904008}-{'f1_val': 0.9977814963782642, 'auprc': 0.9985572811751214, 'loss_val': 0.04425205050822518, 'psi': 0.9980918102970071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=31 head_norm_before_train=1.370506 cos_to_last_merge=0.9363 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.936
[S4] round=31 local utility u=1.000000 metrics={'f1_val': 0.9446202756047227, 'auprc': 0.9472979531885268, 'loss_val': 0.4260439368795979, 'psi': 0.9456913466382444}-{'f1_val': 0.6128825945199587, 'auprc': 0.9538183163878888, 'loss_val': 0.48343139942005947, 'psi': 0.7492568832671307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=31 head_norm_before_train=1.665670 cos_to_last_merge=0.9826 (last merge round=16)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.8358366312427937, 'auprc': 0.9923563689147694, 'loss_val': 0.18534705688249872, 'psi': 0.8984445263115841}-{'f1_val': 0.9944149664932573, 'auprc': 0.9933072421886082, 'loss_val': 0.1319349996155433, 'psi': 0.9939718767713976}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=1.753716 (no previous merge yet)
[S6] round=31 local utility u=0.397382 metrics={'f1_val': 0.8203498256227616, 'auprc': 0.9016789717529019, 'loss_val': 0.43681443535590636, 'psi': 0.8528814840748178}-{'f1_val': 0.7719723556734945, 'auprc': 0.769527008983081, 'loss_val': 0.5448573104724402, 'psi': 0.7709942169973292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=31 head_norm_before_train=1.358085 cos_to_last_merge=0.9879 (last merge round=19)
[S7] round=31 local utility u=0.838175 metrics={'f1_val': 0.6535145049692517, 'auprc': 0.8103404353132466, 'loss_val': 0.48198490281974726, 'psi': 0.7162448771068497}-{'f1_val': 0.46322487960705383, 'auprc': 0.7776129875199554, 'loss_val': 0.9184155802260224, 'psi': 0.5889801227722145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=31 head_norm_before_train=1.717085 cos_to_last_merge=0.9736 (last merge round=16)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9941099979732976, 'auprc': 0.9952771421027278, 'loss_val': 0.0705033734191047, 'psi': 0.9945768556250697}-{'f1_val': 0.9949323051384696, 'auprc': 0.9991143645299752, 'loss_val': 0.05824266582061207, 'psi': 0.9966051288950718}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=1.927777 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9994829204341387, 'loss_val': 0.024316120988762048, 'psi': 0.9958882774794781}-{'f1_val': 0.9966605118138915, 'auprc': 0.9939839846302205, 'loss_val': 0.02160667560830203, 'psi': 0.9955899009404231}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.674179 cos_to_last_merge=0.8011 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.801
[S10] round=31 local utility u=0.000181 metrics={'f1_val': 0.9943624847472301, 'auprc': 0.9965424514073109, 'loss_val': 0.03914413404603871, 'psi': 0.9952344714112624}-{'f1_val': 0.9945291067983943, 'auprc': 0.9961386500481522, 'loss_val': 0.03929478706018107, 'psi': 0.9951729240982975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=31 head_norm_before_train=1.761426 cos_to_last_merge=0.9848 (last merge round=21)
[S11] round=31 local utility u=0.049378 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998270270656942, 'loss_val': 0.04127606845393231, 'psi': 0.9969883132107624}-{'f1_val': 0.9867585279771589, 'auprc': 0.9979391252596919, 'loss_val': 0.08278779347837507, 'psi': 0.9912307668901721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=31 head_norm_before_train=1.689666 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6219898831261076, 'auprc': 0.7909549653473233, 'loss_val': 0.6402709638871205, 'psi': 0.6895759160145939}-{'f1_val': 0.6266623239435655, 'auprc': 0.789254886797661, 'loss_val': 0.5871542368445839, 'psi': 0.6916993490852037}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.696423 cos_to_last_merge=0.9908 (last merge round=19)
[S14] round=31 local utility u=0.018499 metrics={'f1_val': 0.9925055088818385, 'auprc': 0.9989163354185923, 'loss_val': 0.04008980214720053, 'psi': 0.99506983949654}-{'f1_val': 0.9878073713273039, 'auprc': 0.9988720695967612, 'loss_val': 0.048767116242354525, 'psi': 0.9922332506350868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=31 head_norm_before_train=1.452333 cos_to_last_merge=0.9652 (last merge round=19)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7701467461396392, 'auprc': 0.9908772003223613, 'loss_val': 0.2762448147693303, 'psi': 0.858438927812728}-{'f1_val': 0.783033019662846, 'auprc': 0.9916900944133096, 'loss_val': 0.30141017700651496, 'psi': 0.8664958495630315}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=1.808542 cos_to_last_merge=0.9857 (last merge round=16)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8483285552951089, 'auprc': 0.9666677951114108, 'loss_val': 0.8191450951451233, 'psi': 0.8956642512216296}-{'f1_val': 0.957047912581827, 'auprc': 0.9919343696872043, 'loss_val': 0.1242581441240187, 'psi': 0.9710024954239779}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=1.438524 cos_to_last_merge=0.9411 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.941
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.576218236737668, 'auprc': 0.9530825263404421, 'loss_val': 0.5405940288989769, 'psi': 0.7269639525787777}-{'f1_val': 0.654350277162961, 'auprc': 0.9525649625034535, 'loss_val': 0.4661251357007631, 'psi': 0.7736361512991581}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.655646 cos_to_last_merge=0.9804 (last merge round=18)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.79128400818371, 'auprc': 0.9193743162000904, 'loss_val': 0.4244052125405307, 'psi': 0.8425201313902622}-{'f1_val': 0.8189389695619762, 'auprc': 0.8952035059144661, 'loss_val': 0.41934510397784913, 'psi': 0.8494447841029722}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=1.754993 cos_to_last_merge=0.7748 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.775
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9981655223203489, 'loss_val': 0.09900301776841763, 'psi': 0.9758873595914057}-{'f1_val': 0.9977814963782642, 'auprc': 0.9981599286586058, 'loss_val': 0.03734263793618373, 'psi': 0.9979328692904008}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.382579 cos_to_last_merge=0.9345 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.934
[S4] round=32 local utility u=0.002128 metrics={'f1_val': 0.9412236075663548, 'auprc': 0.9513738227885805, 'loss_val': 0.4136357746438429, 'psi': 0.9452836936552451}-{'f1_val': 0.9446202756047227, 'auprc': 0.9472979531885268, 'loss_val': 0.4260439368795979, 'psi': 0.9456913466382444}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=32 head_norm_before_train=1.678948 cos_to_last_merge=0.9809 (last merge round=16)
[S5] round=32 local utility u=0.533247 metrics={'f1_val': 0.9957741494321548, 'auprc': 0.9970982943648168, 'loss_val': 0.09270301482731001, 'psi': 0.9963038074052196}-{'f1_val': 0.8358366312427937, 'auprc': 0.9923563689147694, 'loss_val': 0.18534705688249872, 'psi': 0.8984445263115841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=32 head_norm_before_train=1.767379 (no previous merge yet)
[S6] round=32 local utility u=0.009678 metrics={'f1_val': 0.8038735853625296, 'auprc': 0.922605205124149, 'loss_val': 0.38138024142359117, 'psi': 0.8513662332671774}-{'f1_val': 0.8203498256227616, 'auprc': 0.9016789717529019, 'loss_val': 0.43681443535590636, 'psi': 0.8528814840748178}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=32 head_norm_before_train=1.372406 cos_to_last_merge=0.9867 (last merge round=19)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.4441970755407879, 'auprc': 0.776196974685216, 'loss_val': 0.944351209180095, 'psi': 0.5769970351985592}-{'f1_val': 0.6535145049692517, 'auprc': 0.8103404353132466, 'loss_val': 0.48198490281974726, 'psi': 0.7162448771068497}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.721988 cos_to_last_merge=0.9730 (last merge round=16)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9905236748878183, 'auprc': 0.9929676248812691, 'loss_val': 0.07755550054907046, 'psi': 0.9915012548851986}-{'f1_val': 0.9941099979732976, 'auprc': 0.9952771421027278, 'loss_val': 0.0705033734191047, 'psi': 0.9945768556250697}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.938461 (no previous merge yet)
[S9] round=32 local utility u=0.011495 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9994782854611997, 'loss_val': 0.02032487708104259, 'psi': 0.9977876212728147}-{'f1_val': 0.9934918488430377, 'auprc': 0.9994829204341387, 'loss_val': 0.024316120988762048, 'psi': 0.9958882774794781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=32 head_norm_before_train=1.690356 cos_to_last_merge=0.7995 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.799
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9965642875967902, 'loss_val': 0.037069304154586286, 'psi': 0.9948979881835291}-{'f1_val': 0.9943624847472301, 'auprc': 0.9965424514073109, 'loss_val': 0.03914413404603871, 'psi': 0.9952344714112624}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.783366 cos_to_last_merge=0.9830 (last merge round=21)
[S11] round=32 local utility u=0.004839 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981687841543331, 'loss_val': 0.033773615065162736, 'psi': 0.997195716369887}-{'f1_val': 0.9961336749133093, 'auprc': 0.998270270656942, 'loss_val': 0.04127606845393231, 'psi': 0.9969883132107624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=32 head_norm_before_train=1.694610 (no previous merge yet)
[S13] round=32 local utility u=0.169845 metrics={'f1_val': 0.648593589558127, 'auprc': 0.8008365597155706, 'loss_val': 0.4898474002692601, 'psi': 0.7094907776211044}-{'f1_val': 0.6219898831261076, 'auprc': 0.7909549653473233, 'loss_val': 0.6402709638871205, 'psi': 0.6895759160145939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=32 head_norm_before_train=1.705857 cos_to_last_merge=0.9902 (last merge round=19)
[S14] round=32 local utility u=0.019274 metrics={'f1_val': 0.997319969503565, 'auprc': 0.9988410047229982, 'loss_val': 0.030202495291446533, 'psi': 0.9979283835913384}-{'f1_val': 0.9925055088818385, 'auprc': 0.9989163354185923, 'loss_val': 0.04008980214720053, 'psi': 0.99506983949654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=32 head_norm_before_train=1.471303 cos_to_last_merge=0.9631 (last merge round=19)
[S15] round=32 local utility u=0.476034 metrics={'f1_val': 0.9029190682347286, 'auprc': 0.9954774380696716, 'loss_val': 0.134610658994734, 'psi': 0.9399424161687058}-{'f1_val': 0.7701467461396392, 'auprc': 0.9908772003223613, 'loss_val': 0.2762448147693303, 'psi': 0.858438927812728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=32 head_norm_before_train=1.820206 cos_to_last_merge=0.9849 (last merge round=16)
[S16] round=32 local utility u=0.581211 metrics={'f1_val': 0.9356989218029149, 'auprc': 0.9932347144543839, 'loss_val': 0.2606457267838055, 'psi': 0.9587132388635026}-{'f1_val': 0.8483285552951089, 'auprc': 0.9666677951114108, 'loss_val': 0.8191450951451233, 'psi': 0.8956642512216296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=32 head_norm_before_train=1.463356 cos_to_last_merge=0.9378 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.938
[S17] round=32 local utility u=0.176166 metrics={'f1_val': 0.6222366297934524, 'auprc': 0.962131040293761, 'loss_val': 0.4915172950735979, 'psi': 0.7581943939935758}-{'f1_val': 0.576218236737668, 'auprc': 0.9530825263404421, 'loss_val': 0.5405940288989769, 'psi': 0.7269639525787777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=33 head_norm_before_train=1.665589 cos_to_last_merge=0.9796 (last merge round=18)
[S2] round=33 local utility u=0.070802 metrics={'f1_val': 0.8287735258355844, 'auprc': 0.8760269930393652, 'loss_val': 0.37769729000064967, 'psi': 0.8476749127170967}-{'f1_val': 0.79128400818371, 'auprc': 0.9193743162000904, 'loss_val': 0.4244052125405307, 'psi': 0.8425201313902622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=33 head_norm_before_train=1.768708 cos_to_last_merge=0.7734 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.773
[S3] round=33 local utility u=0.143042 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9981567653984862, 'loss_val': 0.03337030656724797, 'psi': 0.997931603986353}-{'f1_val': 0.9610352511054436, 'auprc': 0.9981655223203489, 'loss_val': 0.09900301776841763, 'psi': 0.9758873595914057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=33 head_norm_before_train=1.396795 cos_to_last_merge=0.9328 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.933
[S4] round=33 local utility u=0.080480 metrics={'f1_val': 0.9459290550947526, 'auprc': 0.959125252682713, 'loss_val': 0.30416295565847296, 'psi': 0.9512075341299366}-{'f1_val': 0.9412236075663548, 'auprc': 0.9513738227885805, 'loss_val': 0.4136357746438429, 'psi': 0.9452836936552451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=33 head_norm_before_train=1.690086 cos_to_last_merge=0.9794 (last merge round=16)
[S5] round=33 local utility u=0.001219 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.993942591521539, 'loss_val': 0.0815124321054347, 'psi': 0.9951130308798193}-{'f1_val': 0.9957741494321548, 'auprc': 0.9970982943648168, 'loss_val': 0.09270301482731001, 'psi': 0.9963038074052196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=33 head_norm_before_train=1.781067 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.8241577875590913, 'auprc': 0.8756477369326424, 'loss_val': 0.4434853658833063, 'psi': 0.8447537673085117}-{'f1_val': 0.8038735853625296, 'auprc': 0.922605205124149, 'loss_val': 0.38138024142359117, 'psi': 0.8513662332671774}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.383167 cos_to_last_merge=0.9855 (last merge round=19)
[S7] round=33 local utility u=1.000000 metrics={'f1_val': 0.6862630539536554, 'auprc': 0.8425688368296844, 'loss_val': 0.35808943865918097, 'psi': 0.748785367104067}-{'f1_val': 0.4441970755407879, 'auprc': 0.776196974685216, 'loss_val': 0.944351209180095, 'psi': 0.5769970351985592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=33 head_norm_before_train=1.730602 cos_to_last_merge=0.9721 (last merge round=16)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9868666482772372, 'auprc': 0.9953517154600812, 'loss_val': 0.09257762708220355, 'psi': 0.9902606751503749}-{'f1_val': 0.9905236748878183, 'auprc': 0.9929676248812691, 'loss_val': 0.07755550054907046, 'psi': 0.9915012548851986}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=1.946539 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9962421144756511, 'auprc': 0.9994782784308572, 'loss_val': 0.020106532444506532, 'psi': 0.9975365800577336}-{'f1_val': 0.9966605118138915, 'auprc': 0.9994782854611997, 'loss_val': 0.02032487708104259, 'psi': 0.9977876212728147}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.702514 cos_to_last_merge=0.7986 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.799
[S10] round=33 local utility u=0.003330 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9955669254400674, 'loss_val': 0.03531486520490979, 'psi': 0.995288851021686}-{'f1_val': 0.9937871219080217, 'auprc': 0.9965642875967902, 'loss_val': 0.037069304154586286, 'psi': 0.9948979881835291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=33 head_norm_before_train=1.803662 cos_to_last_merge=0.9814 (last merge round=21)
[S11] round=33 local utility u=0.001905 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9982293352360663, 'loss_val': 0.03159484613251125, 'psi': 0.9973649640000452}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981687841543331, 'loss_val': 0.033773615065162736, 'psi': 0.997195716369887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=33 head_norm_before_train=1.701423 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.6001639814087065, 'auprc': 0.8164536902772337, 'loss_val': 0.7412095563729008, 'psi': 0.6866798649561174}-{'f1_val': 0.648593589558127, 'auprc': 0.8008365597155706, 'loss_val': 0.4898474002692601, 'psi': 0.7094907776211044}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.716605 cos_to_last_merge=0.9894 (last merge round=19)
[S14] round=33 local utility u=0.002372 metrics={'f1_val': 0.9974950262084489, 'auprc': 0.9989251614805301, 'loss_val': 0.026760533988428797, 'psi': 0.9980670803172813}-{'f1_val': 0.997319969503565, 'auprc': 0.9988410047229982, 'loss_val': 0.030202495291446533, 'psi': 0.9979283835913384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=33 head_norm_before_train=1.486555 cos_to_last_merge=0.9614 (last merge round=19)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.7010443585704017, 'auprc': 0.9237310674933021, 'loss_val': 0.4240874013078218, 'psi': 0.7901190421395619}-{'f1_val': 0.9029190682347286, 'auprc': 0.9954774380696716, 'loss_val': 0.134610658994734, 'psi': 0.9399424161687058}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.830893 cos_to_last_merge=0.9842 (last merge round=16)
[S16] round=33 local utility u=0.261801 metrics={'f1_val': 0.9888924622447011, 'auprc': 0.9928212067423949, 'loss_val': 0.05496372889796279, 'psi': 0.9904639600437786}-{'f1_val': 0.9356989218029149, 'auprc': 0.9932347144543839, 'loss_val': 0.2606457267838055, 'psi': 0.9587132388635026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=33 head_norm_before_train=1.491168 cos_to_last_merge=0.9345 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.935
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.5770003796528264, 'auprc': 0.9488127425137164, 'loss_val': 0.6604281391657061, 'psi': 0.7257253247971824}-{'f1_val': 0.6222366297934524, 'auprc': 0.962131040293761, 'loss_val': 0.4915172950735979, 'psi': 0.7581943939935758}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.678267 cos_to_last_merge=0.9787 (last merge round=18)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7141054744782103, 'auprc': 0.9218355753159307, 'loss_val': 0.4850262819012378, 'psi': 0.7971975148132984}-{'f1_val': 0.8287735258355844, 'auprc': 0.8760269930393652, 'loss_val': 0.37769729000064967, 'psi': 0.8476749127170967}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=1.782609 cos_to_last_merge=0.7719 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.772
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.998166466758813, 'loss_val': 0.10853779608721043, 'psi': 0.9758877373667914}-{'f1_val': 0.9977814963782642, 'auprc': 0.9981567653984862, 'loss_val': 0.03337030656724797, 'psi': 0.997931603986353}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.412504 cos_to_last_merge=0.9304 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.930
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.8831592031884415, 'auprc': 0.9544358751572637, 'loss_val': 0.41105379415428595, 'psi': 0.9116698719759704}-{'f1_val': 0.9459290550947526, 'auprc': 0.959125252682713, 'loss_val': 0.30416295565847296, 'psi': 0.9512075341299366}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.697377 cos_to_last_merge=0.9783 (last merge round=16)
[S5] round=34 local utility u=0.010169 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9973607918608969, 'loss_val': 0.07142883964273376, 'psi': 0.9964803110155624}-{'f1_val': 0.9958933237853395, 'auprc': 0.993942591521539, 'loss_val': 0.0815124321054347, 'psi': 0.9951130308798193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=34 head_norm_before_train=1.797039 (no previous merge yet)
[S6] round=34 local utility u=0.705906 metrics={'f1_val': 0.9608079955321158, 'auprc': 0.9743483435040289, 'loss_val': 0.1476761011936748, 'psi': 0.9662241347208811}-{'f1_val': 0.8241577875590913, 'auprc': 0.8756477369326424, 'loss_val': 0.4434853658833063, 'psi': 0.8447537673085117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=34 head_norm_before_train=1.391000 cos_to_last_merge=0.9847 (last merge round=19)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5802729678864736, 'auprc': 0.7801503595541776, 'loss_val': 0.7247214969610637, 'psi': 0.6602239245535553}-{'f1_val': 0.6862630539536554, 'auprc': 0.8425688368296844, 'loss_val': 0.35808943865918097, 'psi': 0.748785367104067}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.738542 cos_to_last_merge=0.9713 (last merge round=16)
[S8] round=34 local utility u=0.048014 metrics={'f1_val': 0.9946453664677153, 'auprc': 0.9983413920700392, 'loss_val': 0.05219191239438866, 'psi': 0.9961237767086448}-{'f1_val': 0.9868666482772372, 'auprc': 0.9953517154600812, 'loss_val': 0.09257762708220355, 'psi': 0.9902606751503749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=34 head_norm_before_train=1.954924 (no previous merge yet)
[S9] round=34 local utility u=0.001817 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9994884130725677, 'loss_val': 0.01918600602299018, 'psi': 0.9978088542077302}-{'f1_val': 0.9962421144756511, 'auprc': 0.9994782784308572, 'loss_val': 0.020106532444506532, 'psi': 0.9975365800577336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=34 head_norm_before_train=1.715413 cos_to_last_merge=0.7975 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.797
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9957070731219463, 'loss_val': 0.03434328462383365, 'psi': 0.9950814622544284}-{'f1_val': 0.9951034680760983, 'auprc': 0.9955669254400674, 'loss_val': 0.03531486520490979, 'psi': 0.995288851021686}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.822007 cos_to_last_merge=0.9799 (last merge round=21)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9812755455496334, 'auprc': 0.9967650575526229, 'loss_val': 0.07588730730071314, 'psi': 0.9874713503508292}-{'f1_val': 0.9967887165093644, 'auprc': 0.9982293352360663, 'loss_val': 0.03159484613251125, 'psi': 0.9973649640000452}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.708235 (no previous merge yet)
[S13] round=34 local utility u=0.181731 metrics={'f1_val': 0.6327812305372895, 'auprc': 0.8029454464591999, 'loss_val': 0.532927004795604, 'psi': 0.7008469169060536}-{'f1_val': 0.6001639814087065, 'auprc': 0.8164536902772337, 'loss_val': 0.7412095563729008, 'psi': 0.6866798649561174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=34 head_norm_before_train=1.726845 cos_to_last_merge=0.9886 (last merge round=19)
[S14] round=34 local utility u=0.001616 metrics={'f1_val': 0.9977377496967396, 'auprc': 0.9988407672123472, 'loss_val': 0.024731605670179322, 'psi': 0.9981789567029826}-{'f1_val': 0.9974950262084489, 'auprc': 0.9989251614805301, 'loss_val': 0.026760533988428797, 'psi': 0.9980670803172813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=34 head_norm_before_train=1.502256 cos_to_last_merge=0.9596 (last merge round=19)
[S15] round=34 local utility u=1.000000 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9986524031857107, 'loss_val': 0.03373519128390745, 'psi': 0.9977313133911444}-{'f1_val': 0.7010443585704017, 'auprc': 0.9237310674933021, 'loss_val': 0.4240874013078218, 'psi': 0.7901190421395619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=34 head_norm_before_train=1.839688 cos_to_last_merge=0.9835 (last merge round=16)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.9842829835904955, 'auprc': 0.9942254420633605, 'loss_val': 0.07275759754917209, 'psi': 0.9882599669796415}-{'f1_val': 0.9888924622447011, 'auprc': 0.9928212067423949, 'loss_val': 0.05496372889796279, 'psi': 0.9904639600437786}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.514267 cos_to_last_merge=0.9317 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.932
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.5649099928788457, 'auprc': 0.8351697744192388, 'loss_val': 0.714503798670372, 'psi': 0.6730139054950028}-{'f1_val': 0.5770003796528264, 'auprc': 0.9488127425137164, 'loss_val': 0.6604281391657061, 'psi': 0.7257253247971824}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.695470 cos_to_last_merge=0.9773 (last merge round=18)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6595250109498437, 'auprc': 0.7446684139288638, 'loss_val': 0.6236935204439045, 'psi': 0.6935823721414518}-{'f1_val': 0.7141054744782103, 'auprc': 0.9218355753159307, 'loss_val': 0.4850262819012378, 'psi': 0.7971975148132984}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.795437 cos_to_last_merge=0.7707 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.771
[S3] round=35 local utility u=0.079951 metrics={'f1_val': 0.9790540474391666, 'auprc': 0.9981640453573228, 'loss_val': 0.05674154560753791, 'psi': 0.9866980466064291}-{'f1_val': 0.9610352511054436, 'auprc': 0.998166466758813, 'loss_val': 0.10853779608721043, 'psi': 0.9758877373667914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=35 head_norm_before_train=1.426037 cos_to_last_merge=0.9281 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.928
[S4] round=35 local utility u=0.256273 metrics={'f1_val': 0.942667594051745, 'auprc': 0.9661143463126451, 'loss_val': 0.29059278562998275, 'psi': 0.952046294956105}-{'f1_val': 0.8831592031884415, 'auprc': 0.9544358751572637, 'loss_val': 0.41105379415428595, 'psi': 0.9116698719759704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=35 head_norm_before_train=1.704444 cos_to_last_merge=0.9772 (last merge round=16)
[S5] round=35 local utility u=0.003641 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9971879545781683, 'loss_val': 0.06450700116129013, 'psi': 0.9964991169746905}-{'f1_val': 0.9958933237853395, 'auprc': 0.9973607918608969, 'loss_val': 0.07142883964273376, 'psi': 0.9964803110155624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=35 head_norm_before_train=1.810646 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.8130557970972845, 'auprc': 0.8057879725669093, 'loss_val': 0.5195188267342911, 'psi': 0.8101486672851343}-{'f1_val': 0.9608079955321158, 'auprc': 0.9743483435040289, 'loss_val': 0.1476761011936748, 'psi': 0.9662241347208811}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.397240 cos_to_last_merge=0.9840 (last merge round=19)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5601336058109156, 'auprc': 0.7785420299369149, 'loss_val': 0.8215419567915795, 'psi': 0.6474969754613153}-{'f1_val': 0.5802729678864736, 'auprc': 0.7801503595541776, 'loss_val': 0.7247214969610637, 'psi': 0.6602239245535553}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.745271 cos_to_last_merge=0.9710 (last merge round=16)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.984153916551662, 'auprc': 0.9929412479891229, 'loss_val': 0.09358242208554332, 'psi': 0.9876688491266463}-{'f1_val': 0.9946453664677153, 'auprc': 0.9983413920700392, 'loss_val': 0.05219191239438866, 'psi': 0.9961237767086448}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.962700 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9936714819651399, 'loss_val': 0.02030766638029412, 'psi': 0.9954840875449132}-{'f1_val': 0.9966891482978385, 'auprc': 0.9994884130725677, 'loss_val': 0.01918600602299018, 'psi': 0.9978088542077302}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.728935 cos_to_last_merge=0.7963 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.796
[S10] round=35 local utility u=0.002018 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9954604739192314, 'loss_val': 0.03351899210818897, 'psi': 0.9953780619059307}-{'f1_val': 0.9946643883427498, 'auprc': 0.9957070731219463, 'loss_val': 0.03434328462383365, 'psi': 0.9950814622544284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=35 head_norm_before_train=1.835776 cos_to_last_merge=0.9787 (last merge round=21)
[S11] round=35 local utility u=0.047116 metrics={'f1_val': 0.9936639729114821, 'auprc': 0.9980534245531694, 'loss_val': 0.05985049244507741, 'psi': 0.995419753568157}-{'f1_val': 0.9812755455496334, 'auprc': 0.9967650575526229, 'loss_val': 0.07588730730071314, 'psi': 0.9874713503508292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=35 head_norm_before_train=1.715488 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5809667539678287, 'auprc': 0.827116601104806, 'loss_val': 0.8414825599372282, 'psi': 0.6794266928226196}-{'f1_val': 0.6327812305372895, 'auprc': 0.8029454464591999, 'loss_val': 0.532927004795604, 'psi': 0.7008469169060536}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.737615 cos_to_last_merge=0.9879 (last merge round=19)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9308080586819163, 'auprc': 0.9988133841864957, 'loss_val': 0.09087108786637761, 'psi': 0.958010188883748}-{'f1_val': 0.9977377496967396, 'auprc': 0.9988407672123472, 'loss_val': 0.024731605670179322, 'psi': 0.9981789567029826}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.518216 cos_to_last_merge=0.9578 (last merge round=19)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7004973448483123, 'auprc': 0.8947850927707517, 'loss_val': 0.5121779054512473, 'psi': 0.7782124440172881}-{'f1_val': 0.9971172535281002, 'auprc': 0.9986524031857107, 'loss_val': 0.03373519128390745, 'psi': 0.9977313133911444}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.848974 cos_to_last_merge=0.9828 (last merge round=16)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9661338226502164, 'auprc': 0.9945749035751708, 'loss_val': 0.10610564580148978, 'psi': 0.9775102550201982}-{'f1_val': 0.9842829835904955, 'auprc': 0.9942254420633605, 'loss_val': 0.07275759754917209, 'psi': 0.9882599669796415}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=1.535381 cos_to_last_merge=0.9290 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.929
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.5691416315551414, 'auprc': 0.8393367974341971, 'loss_val': 0.8486741104592272, 'psi': 0.6772196979067637}-{'f1_val': 0.5649099928788457, 'auprc': 0.8351697744192388, 'loss_val': 0.714503798670372, 'psi': 0.6730139054950028}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.710980 cos_to_last_merge=0.9759 (last merge round=18)
[S2] round=36 local utility u=0.866906 metrics={'f1_val': 0.8248726928726091, 'auprc': 0.9266153749928628, 'loss_val': 0.4278092616073278, 'psi': 0.8655697657207106}-{'f1_val': 0.6595250109498437, 'auprc': 0.7446684139288638, 'loss_val': 0.6236935204439045, 'psi': 0.6935823721414518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=36 head_norm_before_train=1.807395 cos_to_last_merge=0.7696 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.770
[S3] round=36 local utility u=0.011085 metrics={'f1_val': 0.9816369354330233, 'auprc': 0.9981614270281061, 'loss_val': 0.05006026995473141, 'psi': 0.9882467320710564}-{'f1_val': 0.9790540474391666, 'auprc': 0.9981640453573228, 'loss_val': 0.05674154560753791, 'psi': 0.9866980466064291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=36 head_norm_before_train=1.441989 cos_to_last_merge=0.9254 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.925
[S4] round=36 local utility u=0.014325 metrics={'f1_val': 0.9433537921305193, 'auprc': 0.9717466994509378, 'loss_val': 0.28295773585117806, 'psi': 0.9547109550586867}-{'f1_val': 0.942667594051745, 'auprc': 0.9661143463126451, 'loss_val': 0.29059278562998275, 'psi': 0.952046294956105}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=36 head_norm_before_train=1.718036 cos_to_last_merge=0.9750 (last merge round=16)
[S5] round=36 local utility u=0.000392 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9956220819816547, 'loss_val': 0.05902599565180402, 'psi': 0.995872767936085}-{'f1_val': 0.9960398919057053, 'auprc': 0.9971879545781683, 'loss_val': 0.06450700116129013, 'psi': 0.9964991169746905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=36 head_norm_before_train=1.820447 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.7722267363545756, 'auprc': 0.8325569958805394, 'loss_val': 0.6158325604373078, 'psi': 0.7963588401649612}-{'f1_val': 0.8130557970972845, 'auprc': 0.8057879725669093, 'loss_val': 0.5195188267342911, 'psi': 0.8101486672851343}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.403533 cos_to_last_merge=0.9833 (last merge round=19)
[S7] round=36 local utility u=0.278128 metrics={'f1_val': 0.6129874300454984, 'auprc': 0.7913593123918207, 'loss_val': 0.6208613373092403, 'psi': 0.6843361829840273}-{'f1_val': 0.5601336058109156, 'auprc': 0.7785420299369149, 'loss_val': 0.8215419567915795, 'psi': 0.6474969754613153}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=36 head_norm_before_train=1.750535 cos_to_last_merge=0.9705 (last merge round=16)
[S8] round=36 local utility u=0.059524 metrics={'f1_val': 0.9941403419904568, 'auprc': 0.998526990780829, 'loss_val': 0.05121085912874414, 'psi': 0.9958950015066057}-{'f1_val': 0.984153916551662, 'auprc': 0.9929412479891229, 'loss_val': 0.09358242208554332, 'psi': 0.9876688491266463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] START round=36 head_norm_before_train=1.968705 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9854657388091037, 'auprc': 0.9995325673791418, 'loss_val': 0.0543243482476529, 'psi': 0.9910924702371189}-{'f1_val': 0.9966924912647621, 'auprc': 0.9936714819651399, 'loss_val': 0.02030766638029412, 'psi': 0.9954840875449132}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.742870 cos_to_last_merge=0.7950 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.795
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9956512673961772, 'loss_val': 0.032747474696785066, 'psi': 0.9950591399641207}-{'f1_val': 0.9953231205637304, 'auprc': 0.9954604739192314, 'loss_val': 0.03351899210818897, 'psi': 0.9953780619059307}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.848682 cos_to_last_merge=0.9775 (last merge round=21)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.7811844551721826, 'auprc': 0.9960698008006894, 'loss_val': 0.5338051646961124, 'psi': 0.8671385934235853}-{'f1_val': 0.9936639729114821, 'auprc': 0.9980534245531694, 'loss_val': 0.05985049244507741, 'psi': 0.995419753568157}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.724826 (no previous merge yet)
[S13] round=36 local utility u=0.221544 metrics={'f1_val': 0.6163013399709931, 'auprc': 0.8494524407319126, 'loss_val': 0.6774099746124013, 'psi': 0.7095617802753609}-{'f1_val': 0.5809667539678287, 'auprc': 0.827116601104806, 'loss_val': 0.8414825599372282, 'psi': 0.6794266928226196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=36 head_norm_before_train=1.747808 cos_to_last_merge=0.9872 (last merge round=19)
[S14] round=36 local utility u=0.235528 metrics={'f1_val': 0.9977377496967396, 'auprc': 0.9988541348326245, 'loss_val': 0.02151578732809115, 'psi': 0.9981843037510936}-{'f1_val': 0.9308080586819163, 'auprc': 0.9988133841864957, 'loss_val': 0.09087108786637761, 'psi': 0.958010188883748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=36 head_norm_before_train=1.533196 cos_to_last_merge=0.9563 (last merge round=19)
[S15] round=36 local utility u=1.000000 metrics={'f1_val': 0.9571746326116914, 'auprc': 0.9975004357103094, 'loss_val': 0.07116053281830952, 'psi': 0.9733049538511387}-{'f1_val': 0.7004973448483123, 'auprc': 0.8947850927707517, 'loss_val': 0.5121779054512473, 'psi': 0.7782124440172881}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=36 head_norm_before_train=1.859547 cos_to_last_merge=0.9822 (last merge round=16)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9515613154893232, 'auprc': 0.9949039329167207, 'loss_val': 0.1229707164099609, 'psi': 0.9688983624602823}-{'f1_val': 0.9661338226502164, 'auprc': 0.9945749035751708, 'loss_val': 0.10610564580148978, 'psi': 0.9775102550201982}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.551409 cos_to_last_merge=0.9270 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.927
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.45184790949052644, 'auprc': 0.7968436037530015, 'loss_val': 1.0932543718689807, 'psi': 0.5898461871955165}-{'f1_val': 0.5691416315551414, 'auprc': 0.8393367974341971, 'loss_val': 0.8486741104592272, 'psi': 0.6772196979067637}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.723732 cos_to_last_merge=0.9747 (last merge round=18)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.6415410589787065, 'auprc': 0.8022003945718406, 'loss_val': 1.1076839796911582, 'psi': 0.7058047932159601}-{'f1_val': 0.8248726928726091, 'auprc': 0.9266153749928628, 'loss_val': 0.4278092616073278, 'psi': 0.8655697657207106}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.820654 cos_to_last_merge=0.7684 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.768
[S3] round=37 local utility u=0.051985 metrics={'f1_val': 0.9969808748199115, 'auprc': 0.9981676905909334, 'loss_val': 0.038172758789779875, 'psi': 0.9974556011283202}-{'f1_val': 0.9816369354330233, 'auprc': 0.9981614270281061, 'loss_val': 0.05006026995473141, 'psi': 0.9882467320710564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=37 head_norm_before_train=1.460035 cos_to_last_merge=0.9222 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.922
[S4] round=37 local utility u=0.011572 metrics={'f1_val': 0.9430984950659203, 'auprc': 0.9788038160473527, 'loss_val': 0.27945263100906825, 'psi': 0.9573806234584933}-{'f1_val': 0.9433537921305193, 'auprc': 0.9717466994509378, 'loss_val': 0.28295773585117806, 'psi': 0.9547109550586867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=37 head_norm_before_train=1.733901 cos_to_last_merge=0.9726 (last merge round=16)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9905512680608703, 'loss_val': 0.06059796193076949, 'psi': 0.9937565014955518}-{'f1_val': 0.9960398919057053, 'auprc': 0.9956220819816547, 'loss_val': 0.05902599565180402, 'psi': 0.995872767936085}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.828663 (no previous merge yet)
[S6] round=37 local utility u=0.697138 metrics={'f1_val': 0.8947420303973262, 'auprc': 0.9435442712600809, 'loss_val': 0.28960956232068047, 'psi': 0.914262926742428}-{'f1_val': 0.7722267363545756, 'auprc': 0.8325569958805394, 'loss_val': 0.6158325604373078, 'psi': 0.7963588401649612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=37 head_norm_before_train=1.412605 cos_to_last_merge=0.9828 (last merge round=19)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.6075075053440175, 'auprc': 0.792345426284508, 'loss_val': 0.6072838104981676, 'psi': 0.6814426737202137}-{'f1_val': 0.6129874300454984, 'auprc': 0.7913593123918207, 'loss_val': 0.6208613373092403, 'psi': 0.6843361829840273}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.756269 cos_to_last_merge=0.9700 (last merge round=16)
[S8] round=37 local utility u=0.002270 metrics={'f1_val': 0.9941986149874398, 'auprc': 0.9990079153389897, 'loss_val': 0.04846268445607892, 'psi': 0.9961223351280597}-{'f1_val': 0.9941403419904568, 'auprc': 0.998526990780829, 'loss_val': 0.05121085912874414, 'psi': 0.9958950015066057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=37 head_norm_before_train=1.974916 (no previous merge yet)
[S9] round=37 local utility u=0.042533 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9940580234011174, 'loss_val': 0.02000247226625528, 'psi': 0.9956195164487818}-{'f1_val': 0.9854657388091037, 'auprc': 0.9995325673791418, 'loss_val': 0.0543243482476529, 'psi': 0.9910924702371189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=37 head_norm_before_train=1.755764 cos_to_last_merge=0.7938 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.794
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9956869503566663, 'loss_val': 0.03240755788270402, 'psi': 0.9949417564604606}-{'f1_val': 0.9946643883427498, 'auprc': 0.9956512673961772, 'loss_val': 0.032747474696785066, 'psi': 0.9950591399641207}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.860700 cos_to_last_merge=0.9765 (last merge round=21)
[S11] round=37 local utility u=0.600067 metrics={'f1_val': 0.9112384984202913, 'auprc': 0.9970534316814206, 'loss_val': 0.11694719370458762, 'psi': 0.945564471724743}-{'f1_val': 0.7811844551721826, 'auprc': 0.9960698008006894, 'loss_val': 0.5338051646961124, 'psi': 0.8671385934235853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=37 head_norm_before_train=1.736036 (no previous merge yet)
[S13] round=37 local utility u=0.306684 metrics={'f1_val': 0.6812703872020263, 'auprc': 0.8350251564398249, 'loss_val': 0.4105749715418009, 'psi': 0.7427722948971457}-{'f1_val': 0.6163013399709931, 'auprc': 0.8494524407319126, 'loss_val': 0.6774099746124013, 'psi': 0.7095617802753609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=37 head_norm_before_train=1.758252 cos_to_last_merge=0.9865 (last merge round=19)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9976448308335482, 'auprc': 0.9988609036311042, 'loss_val': 0.0221212556559619, 'psi': 0.9981312599525707}-{'f1_val': 0.9977377496967396, 'auprc': 0.9988541348326245, 'loss_val': 0.02151578732809115, 'psi': 0.9981843037510936}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.547515 cos_to_last_merge=0.9548 (last merge round=19)
[S15] round=37 local utility u=0.038192 metrics={'f1_val': 0.9695806937748813, 'auprc': 0.9956000288695364, 'loss_val': 0.06351171644450125, 'psi': 0.9799884278127433}-{'f1_val': 0.9571746326116914, 'auprc': 0.9975004357103094, 'loss_val': 0.07116053281830952, 'psi': 0.9733049538511387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=37 head_norm_before_train=1.869975 cos_to_last_merge=0.9816 (last merge round=16)
[S16] round=37 local utility u=0.095664 metrics={'f1_val': 0.9763569961598569, 'auprc': 0.9952211195998236, 'loss_val': 0.08136856570867114, 'psi': 0.9839026455358436}-{'f1_val': 0.9515613154893232, 'auprc': 0.9949039329167207, 'loss_val': 0.1229707164099609, 'psi': 0.9688983624602823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=37 head_norm_before_train=1.566793 cos_to_last_merge=0.9252 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.925
[S17] round=37 local utility u=0.702484 metrics={'f1_val': 0.5954314280765712, 'auprc': 0.8506871948267885, 'loss_val': 0.7113174463682115, 'psi': 0.6975337347766581}-{'f1_val': 0.45184790949052644, 'auprc': 0.7968436037530015, 'loss_val': 1.0932543718689807, 'psi': 0.5898461871955165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=38 head_norm_before_train=1.730833 cos_to_last_merge=0.9741 (last merge round=18)
[S2] round=38 local utility u=1.000000 metrics={'f1_val': 0.8253084187134844, 'auprc': 0.9337304267953115, 'loss_val': 0.4052454075592014, 'psi': 0.8686772219462152}-{'f1_val': 0.6415410589787065, 'auprc': 0.8022003945718406, 'loss_val': 1.1076839796911582, 'psi': 0.7058047932159601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=38 head_norm_before_train=1.833361 cos_to_last_merge=0.7671 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.767
[S3] round=38 local utility u=0.001685 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9985141660004987, 'loss_val': 0.038346630673442336, 'psi': 0.9978446078678339}-{'f1_val': 0.9969808748199115, 'auprc': 0.9981676905909334, 'loss_val': 0.038172758789779875, 'psi': 0.9974556011283202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=38 head_norm_before_train=1.475884 cos_to_last_merge=0.9192 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.919
[S4] round=38 local utility u=0.007288 metrics={'f1_val': 0.9445060219943915, 'auprc': 0.9808624066192403, 'loss_val': 0.2794966729825708, 'psi': 0.959048575844331}-{'f1_val': 0.9430984950659203, 'auprc': 0.9788038160473527, 'loss_val': 0.27945263100906825, 'psi': 0.9573806234584933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=38 head_norm_before_train=1.748406 cos_to_last_merge=0.9704 (last merge round=16)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9892868047902209, 'loss_val': 0.07625605385616721, 'psi': 0.993250716187292}-{'f1_val': 0.9958933237853395, 'auprc': 0.9905512680608703, 'loss_val': 0.06059796193076949, 'psi': 0.9937565014955518}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.838477 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.8224095165069656, 'auprc': 0.9177040906319414, 'loss_val': 0.5287278348233335, 'psi': 0.8605273461569559}-{'f1_val': 0.8947420303973262, 'auprc': 0.9435442712600809, 'loss_val': 0.28960956232068047, 'psi': 0.914262926742428}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.427890 cos_to_last_merge=0.9814 (last merge round=19)
[S7] round=38 local utility u=0.168848 metrics={'f1_val': 0.6394184332174964, 'auprc': 0.8039171298187016, 'loss_val': 0.4957690792756244, 'psi': 0.7052179118579784}-{'f1_val': 0.6075075053440175, 'auprc': 0.792345426284508, 'loss_val': 0.6072838104981676, 'psi': 0.6814426737202137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=38 head_norm_before_train=1.764242 cos_to_last_merge=0.9692 (last merge round=16)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.8279841385049509, 'auprc': 0.9876886169981957, 'loss_val': 0.1371175177041156, 'psi': 0.8918659299022489}-{'f1_val': 0.9941986149874398, 'auprc': 0.9990079153389897, 'loss_val': 0.04846268445607892, 'psi': 0.9961223351280597}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.978593 (no previous merge yet)
[S9] round=38 local utility u=0.003729 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9963528473845662, 'loss_val': 0.01942905053867544, 'psi': 0.9965374460421613}-{'f1_val': 0.9966605118138915, 'auprc': 0.9940580234011174, 'loss_val': 0.02000247226625528, 'psi': 0.9956195164487818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=38 head_norm_before_train=1.765419 cos_to_last_merge=0.7932 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.793
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9942256070413027, 'auprc': 0.9956697237245842, 'loss_val': 0.0319411503271631, 'psi': 0.9948032537146153}-{'f1_val': 0.9944449605296568, 'auprc': 0.9956869503566663, 'loss_val': 0.03240755788270402, 'psi': 0.9949417564604606}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.868363 cos_to_last_merge=0.9757 (last merge round=21)
[S11] round=38 local utility u=0.077605 metrics={'f1_val': 0.9342246717911106, 'auprc': 0.9973178647272127, 'loss_val': 0.10044675675573983, 'psi': 0.9594619489655514}-{'f1_val': 0.9112384984202913, 'auprc': 0.9970534316814206, 'loss_val': 0.11694719370458762, 'psi': 0.945564471724743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=38 head_norm_before_train=1.742721 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5661517524133037, 'auprc': 0.862478007270721, 'loss_val': 1.029256146724566, 'psi': 0.6846822543562707}-{'f1_val': 0.6812703872020263, 'auprc': 0.8350251564398249, 'loss_val': 0.4105749715418009, 'psi': 0.7427722948971457}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.767543 cos_to_last_merge=0.9859 (last merge round=19)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9963991289854817, 'auprc': 0.9988228823842261, 'loss_val': 0.03115534947541117, 'psi': 0.9973686303449794}-{'f1_val': 0.9976448308335482, 'auprc': 0.9988609036311042, 'loss_val': 0.0221212556559619, 'psi': 0.9981312599525707}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.560804 cos_to_last_merge=0.9534 (last merge round=19)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.9042349585124321, 'auprc': 0.9974264576510382, 'loss_val': 0.13646826131571427, 'psi': 0.9415115581678746}-{'f1_val': 0.9695806937748813, 'auprc': 0.9956000288695364, 'loss_val': 0.06351171644450125, 'psi': 0.9799884278127433}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.879322 cos_to_last_merge=0.9811 (last merge round=16)
[S16] round=38 local utility u=0.047563 metrics={'f1_val': 0.988250487295022, 'auprc': 0.9958548368047652, 'loss_val': 0.059504910266888485, 'psi': 0.9912922270989193}-{'f1_val': 0.9763569961598569, 'auprc': 0.9952211195998236, 'loss_val': 0.08136856570867114, 'psi': 0.9839026455358436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=38 head_norm_before_train=1.579872 cos_to_last_merge=0.9240 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.924
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.5756577178828154, 'auprc': 0.929501583933575, 'loss_val': 0.9179165261229092, 'psi': 0.7171952643031192}-{'f1_val': 0.5954314280765712, 'auprc': 0.8506871948267885, 'loss_val': 0.7113174463682115, 'psi': 0.6975337347766581}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.737277 cos_to_last_merge=0.9736 (last merge round=18)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.7255756266889367, 'auprc': 0.846769737923403, 'loss_val': 0.7377163889380485, 'psi': 0.7740532711827233}-{'f1_val': 0.8253084187134844, 'auprc': 0.9337304267953115, 'loss_val': 0.4052454075592014, 'psi': 0.8686772219462152}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.774 u=0.0000 p_local=0.2789 f1=0.726 auprc=0.847 bytes=41362
[S3] START round=39 head_norm_before_train=1.844763 cos_to_last_merge=0.7659 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.766
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9606109340814555, 'auprc': 0.9981645505013736, 'loss_val': 0.1457300995595778, 'psi': 0.9756323806494227}-{'f1_val': 0.9973982357793907, 'auprc': 0.9985141660004987, 'loss_val': 0.038346630673442336, 'psi': 0.9978446078678339}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.976 u=0.0000 p_local=0.0357 f1=0.961 auprc=0.998 bytes=44919
[S4] START round=39 head_norm_before_train=1.486082 cos_to_last_merge=0.9170 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.917
[S4] round=39 local utility u=0.025055 metrics={'f1_val': 0.9515235152915054, 'auprc': 0.9816882678908508, 'loss_val': 0.2739683009126027, 'psi': 0.9635894163312435}-{'f1_val': 0.9445060219943915, 'auprc': 0.9808624066192403, 'loss_val': 0.2794966729825708, 'psi': 0.959048575844331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S4] r=40 psi=0.964 u=0.0251 p_local=0.0707 f1=0.952 auprc=0.982 bytes=44997
[S5] START round=39 head_norm_before_train=1.761067 cos_to_last_merge=0.9686 (last merge round=16)
[S5] round=39 local utility u=0.024559 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9966396346319691, 'loss_val': 0.049195852324518806, 'psi': 0.9961918481239913}-{'f1_val': 0.9958933237853395, 'auprc': 0.9892868047902209, 'loss_val': 0.07625605385616721, 'psi': 0.993250716187292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S5] r=40 psi=0.996 u=0.0246 p_local=0.0536 f1=0.996 auprc=0.997 bytes=48508
[S6] START round=39 head_norm_before_train=1.848705 (no previous merge yet)
[S6] round=39 local utility u=0.615671 metrics={'f1_val': 0.9622253368673204, 'auprc': 0.938757166199171, 'loss_val': 0.1994398042954523, 'psi': 0.9528380686000607}-{'f1_val': 0.8224095165069656, 'auprc': 0.9177040906319414, 'loss_val': 0.5287278348233335, 'psi': 0.8605273461569559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S6] r=40 psi=0.953 u=0.6157 p_local=0.3023 f1=0.962 auprc=0.939 bytes=37815
[S7] START round=39 head_norm_before_train=1.441103 cos_to_last_merge=0.9800 (last merge round=19)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.48623032371454256, 'auprc': 0.7785032827790006, 'loss_val': 0.9184505377843063, 'psi': 0.6031395073403258}-{'f1_val': 0.6394184332174964, 'auprc': 0.8039171298187016, 'loss_val': 0.4957690792756244, 'psi': 0.7052179118579784}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.603 u=0.0000 p_local=0.1700 f1=0.486 auprc=0.779 bytes=41349
[S8] START round=39 head_norm_before_train=1.773957 cos_to_last_merge=0.9683 (last merge round=16)
[S8] round=39 local utility u=0.550485 metrics={'f1_val': 0.9916052646339149, 'auprc': 0.9989290793064721, 'loss_val': 0.05159533093962521, 'psi': 0.9945347905029378}-{'f1_val': 0.8279841385049509, 'auprc': 0.9876886169981957, 'loss_val': 0.1371175177041156, 'psi': 0.8918659299022489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S8] r=40 psi=0.995 u=0.5505 p_local=0.1315 f1=0.992 auprc=0.999 bytes=48543
[S9] START round=39 head_norm_before_train=1.980641 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9893026945281196, 'auprc': 0.9996733436501951, 'loss_val': 0.04106699102880268, 'psi': 0.9934509541769498}-{'f1_val': 0.9966605118138915, 'auprc': 0.9963528473845662, 'loss_val': 0.01942905053867544, 'psi': 0.9965374460421613}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.993 u=0.0000 p_local=0.0086 f1=0.989 auprc=1.000 bytes=46767
[S10] START round=39 head_norm_before_train=1.776299 cos_to_last_merge=0.7924 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.792
[S10] round=39 local utility u=0.000894 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9956477258690002, 'loss_val': 0.03140322571156014, 'psi': 0.9949260666653942}-{'f1_val': 0.9942256070413027, 'auprc': 0.9956697237245842, 'loss_val': 0.0319411503271631, 'psi': 0.9948032537146153}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S10] r=40 psi=0.995 u=0.0009 p_local=0.0033 f1=0.994 auprc=0.996 bytes=48593
[S11] START round=39 head_norm_before_train=1.875336 cos_to_last_merge=0.9751 (last merge round=21)
[S11] round=39 local utility u=0.024067 metrics={'f1_val': 0.9412271024053886, 'auprc': 0.9963830808195975, 'loss_val': 0.0915235179601764, 'psi': 0.9632894937710722}-{'f1_val': 0.9342246717911106, 'auprc': 0.9973178647272127, 'loss_val': 0.10044675675573983, 'psi': 0.9594619489655514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S11] r=40 psi=0.963 u=0.0241 p_local=0.1102 f1=0.941 auprc=0.996 bytes=50328
[S13] START round=39 head_norm_before_train=1.748166 (no previous merge yet)
[S13] round=39 local utility u=0.175026 metrics={'f1_val': 0.5851860881358015, 'auprc': 0.8742506900909974, 'loss_val': 0.8287280041887851, 'psi': 0.7008119289178798}-{'f1_val': 0.5661517524133037, 'auprc': 0.862478007270721, 'loss_val': 1.029256146724566, 'psi': 0.6846822543562707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S13] r=40 psi=0.701 u=0.1750 p_local=0.1340 f1=0.585 auprc=0.874 bytes=39555
[S14] START round=39 head_norm_before_train=1.775022 cos_to_last_merge=0.9854 (last merge round=19)
[S14] round=39 local utility u=0.009690 metrics={'f1_val': 0.9979803455147667, 'auprc': 0.9988423713310643, 'loss_val': 0.021321857654150872, 'psi': 0.9983251558412858}-{'f1_val': 0.9963991289854817, 'auprc': 0.9988228823842261, 'loss_val': 0.03115534947541117, 'psi': 0.9973686303449794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S14] r=40 psi=0.998 u=0.0097 p_local=0.0334 f1=0.998 auprc=0.999 bytes=48587
[S15] START round=39 head_norm_before_train=1.575614 cos_to_last_merge=0.9517 (last merge round=19)
[S15] round=39 local utility u=0.327602 metrics={'f1_val': 0.9955737760715937, 'auprc': 0.9980924861441357, 'loss_val': 0.031295969212666884, 'psi': 0.9965812601006105}-{'f1_val': 0.9042349585124321, 'auprc': 0.9974264576510382, 'loss_val': 0.13646826131571427, 'psi': 0.9415115581678746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S15] r=40 psi=0.997 u=0.3276 p_local=0.2801 f1=0.996 auprc=0.998 bytes=48507
[S16] START round=39 head_norm_before_train=1.889371 cos_to_last_merge=0.9805 (last merge round=16)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9731525312567513, 'auprc': 0.995433465356399, 'loss_val': 0.08918283274710768, 'psi': 0.9820649048966104}-{'f1_val': 0.988250487295022, 'auprc': 0.9958548368047652, 'loss_val': 0.059504910266888485, 'psi': 0.9912922270989193}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.982 u=0.0000 p_local=0.0680 f1=0.973 auprc=0.995 bytes=34144
[S17] START round=39 head_norm_before_train=1.589952 cos_to_last_merge=0.9231 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.923
[S17] round=39 local utility u=0.121888 metrics={'f1_val': 0.5911033318031208, 'auprc': 0.9511914404454407, 'loss_val': 0.8318831744177781, 'psi': 0.7351385752600488}-{'f1_val': 0.5756577178828154, 'auprc': 0.929501583933575, 'loss_val': 0.9179165261229092, 'psi': 0.7171952643031192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S17] r=40 psi=0.735 u=0.1219 p_local=0.1390 f1=0.591 auprc=0.951 bytes=46749
[S2] START round=40 head_norm_before_train=1.748177 cos_to_last_merge=0.9727 (last merge round=18)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.725483039447847, 'auprc': 0.8450281142774949, 'loss_val': 0.7628111321802864, 'psi': 0.7733010693797062}-{'f1_val': 0.7255756266889367, 'auprc': 0.846769737923403, 'loss_val': 0.7377163889380485, 'psi': 0.7740532711827233}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.855692 cos_to_last_merge=0.7649 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.765
[S3] round=40 local utility u=0.166180 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.998133090060275, 'loss_val': 0.03647006872735978, 'psi': 0.9979392565846857}-{'f1_val': 0.9606109340814555, 'auprc': 0.9981645505013736, 'loss_val': 0.1457300995595778, 'psi': 0.9756323806494227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=40 head_norm_before_train=1.492006 cos_to_last_merge=0.9154 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.915
[S4] round=40 local utility u=0.004468 metrics={'f1_val': 0.9523011830520547, 'auprc': 0.9813385149616192, 'loss_val': 0.2686483967074376, 'psi': 0.9639161158158804}-{'f1_val': 0.9515235152915054, 'auprc': 0.9816882678908508, 'loss_val': 0.2739683009126027, 'psi': 0.9635894163312435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=40 head_norm_before_train=1.770604 cos_to_last_merge=0.9672 (last merge round=16)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.99537903177663, 'loss_val': 0.04764607062822627, 'psi': 0.9956876069818557}-{'f1_val': 0.9958933237853395, 'auprc': 0.9966396346319691, 'loss_val': 0.049195852324518806, 'psi': 0.9961918481239913}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.856166 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.8141760128737126, 'auprc': 0.9405781390008013, 'loss_val': 0.43662303667663965, 'psi': 0.864736863324548}-{'f1_val': 0.9622253368673204, 'auprc': 0.938757166199171, 'loss_val': 0.1994398042954523, 'psi': 0.9528380686000607}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.453551 cos_to_last_merge=0.9788 (last merge round=19)
[S7] round=40 local utility u=0.613202 metrics={'f1_val': 0.6233252490069856, 'auprc': 0.7985333086945, 'loss_val': 0.5747057845126436, 'psi': 0.6934084728819914}-{'f1_val': 0.48623032371454256, 'auprc': 0.7785032827790006, 'loss_val': 0.9184505377843063, 'psi': 0.6031395073403258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=40 head_norm_before_train=1.783591 cos_to_last_merge=0.9673 (last merge round=16)
[S8] round=40 local utility u=0.009340 metrics={'f1_val': 0.993774941018067, 'auprc': 0.9988889621209659, 'loss_val': 0.04581273437352144, 'psi': 0.9958205494592265}-{'f1_val': 0.9916052646339149, 'auprc': 0.9989290793064721, 'loss_val': 0.05159533093962521, 'psi': 0.9945347905029378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=40 head_norm_before_train=1.984424 (no previous merge yet)
[S9] round=40 local utility u=0.028277 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9966851124333401, 'loss_val': 0.019696111962439852, 'psi': 0.9966703520616709}-{'f1_val': 0.9893026945281196, 'auprc': 0.9996733436501951, 'loss_val': 0.04106699102880268, 'psi': 0.9934509541769498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=40 head_norm_before_train=1.787587 cos_to_last_merge=0.7914 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.791
[S10] round=40 local utility u=0.000897 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.995593580621827, 'loss_val': 0.03076294138983212, 'psi': 0.9950360652543806}-{'f1_val': 0.9944449605296568, 'auprc': 0.9956477258690002, 'loss_val': 0.03140322571156014, 'psi': 0.9949260666653942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=40 head_norm_before_train=1.882805 cos_to_last_merge=0.9743 (last merge round=21)
[S11] round=40 local utility u=0.196867 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981848206211774, 'loss_val': 0.03263344142996697, 'psi': 0.9969541331964565}-{'f1_val': 0.9412271024053886, 'auprc': 0.9963830808195975, 'loss_val': 0.0915235179601764, 'psi': 0.9632894937710722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=40 head_norm_before_train=1.750123 (no previous merge yet)
[S13] round=40 local utility u=0.408424 metrics={'f1_val': 0.6593837341402728, 'auprc': 0.8691374847737552, 'loss_val': 0.4417264416786176, 'psi': 0.7432852343936658}-{'f1_val': 0.5851860881358015, 'auprc': 0.8742506900909974, 'loss_val': 0.8287280041887851, 'psi': 0.7008119289178798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=40 head_norm_before_train=1.780836 cos_to_last_merge=0.9848 (last merge round=19)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.957650084096497, 'auprc': 0.9988139384695006, 'loss_val': 0.0513420500732167, 'psi': 0.9741156258456984}-{'f1_val': 0.9979803455147667, 'auprc': 0.9988423713310643, 'loss_val': 0.021321857654150872, 'psi': 0.9983251558412858}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.589311 cos_to_last_merge=0.9502 (last merge round=19)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9960979635431926, 'loss_val': 0.03418627169787493, 'psi': 0.9964871864497894}-{'f1_val': 0.9955737760715937, 'auprc': 0.9980924861441357, 'loss_val': 0.031295969212666884, 'psi': 0.9965812601006105}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.897225 cos_to_last_merge=0.9799 (last merge round=16)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8483285552951089, 'auprc': 0.9542839081353026, 'loss_val': 0.8505189023758603, 'psi': 0.8907106964311864}-{'f1_val': 0.9731525312567513, 'auprc': 0.995433465356399, 'loss_val': 0.08918283274710768, 'psi': 0.9820649048966104}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.600769 cos_to_last_merge=0.9221 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.922
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.29309496257535217, 'auprc': 0.8700620756497743, 'loss_val': 1.449235093783109, 'psi': 0.5238818078051211}-{'f1_val': 0.5911033318031208, 'auprc': 0.9511914404454407, 'loss_val': 0.8318831744177781, 'psi': 0.7351385752600488}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.761226 cos_to_last_merge=0.9715 (last merge round=18)
[S2] round=41 local utility u=0.468059 metrics={'f1_val': 0.8346938581594713, 'auprc': 0.8605902993788419, 'loss_val': 0.5286444168851919, 'psi': 0.8450524346472196}-{'f1_val': 0.725483039447847, 'auprc': 0.8450281142774949, 'loss_val': 0.7628111321802864, 'psi': 0.7733010693797062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=41 head_norm_before_train=1.865542 cos_to_last_merge=0.7640 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.764
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9971302205031132, 'auprc': 0.9984980601441806, 'loss_val': 0.06229962785941353, 'psi': 0.9976773563595401}-{'f1_val': 0.9978100342676263, 'auprc': 0.998133090060275, 'loss_val': 0.03647006872735978, 'psi': 0.9979392565846857}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.496377 cos_to_last_merge=0.9140 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.914
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9421387189357007, 'auprc': 0.9776844913282253, 'loss_val': 0.2856682768919552, 'psi': 0.9563570278927105}-{'f1_val': 0.9523011830520547, 'auprc': 0.9813385149616192, 'loss_val': 0.2686483967074376, 'psi': 0.9639161158158804}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.778207 cos_to_last_merge=0.9659 (last merge round=16)
[S5] round=41 local utility u=0.002190 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.995932786194998, 'loss_val': 0.04492811227136454, 'psi': 0.9959091087492029}-{'f1_val': 0.9958933237853395, 'auprc': 0.99537903177663, 'loss_val': 0.04764607062822627, 'psi': 0.9956876069818557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=41 head_norm_before_train=1.864541 (no previous merge yet)
[S6] round=41 local utility u=0.261274 metrics={'f1_val': 0.8717358825635789, 'auprc': 0.9498642045064832, 'loss_val': 0.2872922615794416, 'psi': 0.9029872113407407}-{'f1_val': 0.8141760128737126, 'auprc': 0.9405781390008013, 'loss_val': 0.43662303667663965, 'psi': 0.864736863324548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=41 head_norm_before_train=1.462465 cos_to_last_merge=0.9779 (last merge round=19)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.4730517003264808, 'auprc': 0.778335505125442, 'loss_val': 0.9372429562248512, 'psi': 0.5951652222460653}-{'f1_val': 0.6233252490069856, 'auprc': 0.7985333086945, 'loss_val': 0.5747057845126436, 'psi': 0.6934084728819914}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.795766 cos_to_last_merge=0.9663 (last merge round=16)
[S8] round=41 local utility u=0.002724 metrics={'f1_val': 0.9944993143621779, 'auprc': 0.9985348991534383, 'loss_val': 0.043649256584545965, 'psi': 0.996113548278682}-{'f1_val': 0.993774941018067, 'auprc': 0.9988889621209659, 'loss_val': 0.04581273437352144, 'psi': 0.9958205494592265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=41 head_norm_before_train=1.989193 (no previous merge yet)
[S9] round=41 local utility u=0.004237 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9994934019857207, 'loss_val': 0.019647437146739194, 'psi': 0.9977936678826231}-{'f1_val': 0.9966605118138915, 'auprc': 0.9966851124333401, 'loss_val': 0.019696111962439852, 'psi': 0.9966703520616709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=41 head_norm_before_train=1.798922 cos_to_last_merge=0.7904 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.790
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9956019971628428, 'loss_val': 0.030374644250659093, 'psi': 0.9949582629441738}-{'f1_val': 0.9946643883427498, 'auprc': 0.995593580621827, 'loss_val': 0.03076294138983212, 'psi': 0.9950360652543806}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.892237 cos_to_last_merge=0.9735 (last merge round=21)
[S11] round=41 local utility u=0.002602 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9980932415107975, 'loss_val': 0.027155298482080127, 'psi': 0.9969175015523046}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981848206211774, 'loss_val': 0.03263344142996697, 'psi': 0.9969541331964565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=41 head_norm_before_train=1.751578 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6033220434907072, 'auprc': 0.903169273414888, 'loss_val': 0.710551928214845, 'psi': 0.7232609354603795}-{'f1_val': 0.6593837341402728, 'auprc': 0.8691374847737552, 'loss_val': 0.4417264416786176, 'psi': 0.7432852343936658}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.786501 cos_to_last_merge=0.9844 (last merge round=19)
[S14] round=41 local utility u=0.133528 metrics={'f1_val': 0.9970842644973595, 'auprc': 0.9988616994415779, 'loss_val': 0.02103342955276121, 'psi': 0.9977952384750468}-{'f1_val': 0.957650084096497, 'auprc': 0.9988139384695006, 'loss_val': 0.0513420500732167, 'psi': 0.9741156258456984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=41 head_norm_before_train=1.602385 cos_to_last_merge=0.9487 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.8062807849659358, 'auprc': 0.9924318475070179, 'loss_val': 0.3236983898160658, 'psi': 0.8807412099823686}-{'f1_val': 0.9967466683875206, 'auprc': 0.9960979635431926, 'loss_val': 0.03418627169787493, 'psi': 0.9964871864497894}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.904489 cos_to_last_merge=0.9794 (last merge round=16)
[S16] round=41 local utility u=0.831400 metrics={'f1_val': 0.9790316353341643, 'auprc': 0.9938301946419005, 'loss_val': 0.0905768785514378, 'psi': 0.9849510590572588}-{'f1_val': 0.8483285552951089, 'auprc': 0.9542839081353026, 'loss_val': 0.8505189023758603, 'psi': 0.8907106964311864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=41 head_norm_before_train=1.613251 cos_to_last_merge=0.9209 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.921
[S17] round=41 local utility u=1.000000 metrics={'f1_val': 0.5892147114656404, 'auprc': 0.8503413132660111, 'loss_val': 0.9157888009236197, 'psi': 0.6936653521857887}-{'f1_val': 0.29309496257535217, 'auprc': 0.8700620756497743, 'loss_val': 1.449235093783109, 'psi': 0.5238818078051211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S2] START round=42 head_norm_before_train=1.775692 cos_to_last_merge=0.9702 (last merge round=18)
[S2] round=42 local utility u=0.023153 metrics={'f1_val': 0.7938743242985296, 'auprc': 0.9348983518170098, 'loss_val': 0.46034468423520597, 'psi': 0.8502839353059216}-{'f1_val': 0.8346938581594713, 'auprc': 0.8605902993788419, 'loss_val': 0.5286444168851919, 'psi': 0.8450524346472196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=42 head_norm_before_train=1.873918 cos_to_last_merge=0.7634 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.763
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9623918531992162, 'auprc': 0.9981391165380462, 'loss_val': 0.12462537994334816, 'psi': 0.9766907585347482}-{'f1_val': 0.9971302205031132, 'auprc': 0.9984980601441806, 'loss_val': 0.06229962785941353, 'psi': 0.9976773563595401}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.500898 cos_to_last_merge=0.9128 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.913
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9403493926903528, 'auprc': 0.9538596852978699, 'loss_val': 0.29352671134830144, 'psi': 0.9457535097333596}-{'f1_val': 0.9421387189357007, 'auprc': 0.9776844913282253, 'loss_val': 0.2856682768919552, 'psi': 0.9563570278927105}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.792821 cos_to_last_merge=0.9639 (last merge round=16)
[S5] round=42 local utility u=0.001358 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9964243625664456, 'loss_val': 0.04368670877032999, 'psi': 0.9961057392977819}-{'f1_val': 0.9958933237853395, 'auprc': 0.995932786194998, 'loss_val': 0.04492811227136454, 'psi': 0.9959091087492029}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=42 head_norm_before_train=1.873560 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.8203008835866464, 'auprc': 0.9230556899476104, 'loss_val': 0.4831172663117834, 'psi': 0.861402806131032}-{'f1_val': 0.8717358825635789, 'auprc': 0.9498642045064832, 'loss_val': 0.2872922615794416, 'psi': 0.9029872113407407}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.467521 cos_to_last_merge=0.9774 (last merge round=19)
[S7] round=42 local utility u=1.000000 metrics={'f1_val': 0.7223894891327997, 'auprc': 0.9681788464724232, 'loss_val': 0.20544872911614062, 'psi': 0.8207052320686492}-{'f1_val': 0.4730517003264808, 'auprc': 0.778335505125442, 'loss_val': 0.9372429562248512, 'psi': 0.5951652222460653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=42 head_norm_before_train=1.809155 cos_to_last_merge=0.9650 (last merge round=16)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9937505990112392, 'auprc': 0.9949822143536983, 'loss_val': 0.0471148998891341, 'psi': 0.9942432451482228}-{'f1_val': 0.9944993143621779, 'auprc': 0.9985348991534383, 'loss_val': 0.043649256584545965, 'psi': 0.996113548278682}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.994772 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9994656511301013, 'loss_val': 0.026914634899517224, 'psi': 0.9960315654458656}-{'f1_val': 0.9966605118138915, 'auprc': 0.9994934019857207, 'loss_val': 0.019647437146739194, 'psi': 0.9977936678826231}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.806269 cos_to_last_merge=0.7901 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.790
[S10] round=42 local utility u=0.000520 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9955954667790813, 'loss_val': 0.030126563680176226, 'psi': 0.9950368197172823}-{'f1_val': 0.9945291067983943, 'auprc': 0.9956019971628428, 'loss_val': 0.030374644250659093, 'psi': 0.9949582629441738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=42 head_norm_before_train=1.901771 cos_to_last_merge=0.9726 (last merge round=21)
[S11] round=42 local utility u=0.002327 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980086356860357, 'loss_val': 0.024727931263225006, 'psi': 0.997131656982568}-{'f1_val': 0.9961336749133093, 'auprc': 0.9980932415107975, 'loss_val': 0.027155298482080127, 'psi': 0.9969175015523046}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=42 head_norm_before_train=1.752864 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6055582438877259, 'auprc': 0.890347691114896, 'loss_val': 0.7032951862873326, 'psi': 0.7194740227785941}-{'f1_val': 0.6033220434907072, 'auprc': 0.903169273414888, 'loss_val': 0.710551928214845, 'psi': 0.7232609354603795}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.791576 cos_to_last_merge=0.9839 (last merge round=19)
[S14] round=42 local utility u=0.001419 metrics={'f1_val': 0.9974950262084489, 'auprc': 0.9989307343012782, 'loss_val': 0.0208666661186915, 'psi': 0.9980693094455806}-{'f1_val': 0.9970842644973595, 'auprc': 0.9988616994415779, 'loss_val': 0.02103342955276121, 'psi': 0.9977952384750468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=42 head_norm_before_train=1.614339 cos_to_last_merge=0.9474 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=42 local utility u=0.730576 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9983878279038831, 'loss_val': 0.025432899551945998, 'psi': 0.9976254832784134}-{'f1_val': 0.8062807849659358, 'auprc': 0.9924318475070179, 'loss_val': 0.3236983898160658, 'psi': 0.8807412099823686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=42 head_norm_before_train=1.912670 cos_to_last_merge=0.9788 (last merge round=16)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.7702198164282607, 'auprc': 0.9287117021582773, 'loss_val': 0.9999839137321999, 'psi': 0.8336165707202673}-{'f1_val': 0.9790316353341643, 'auprc': 0.9938301946419005, 'loss_val': 0.0905768785514378, 'psi': 0.9849510590572588}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.625185 cos_to_last_merge=0.9199 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.920
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.5331153780198501, 'auprc': 0.7464050823878723, 'loss_val': 1.112365543828673, 'psi': 0.6184312597670589}-{'f1_val': 0.5892147114656404, 'auprc': 0.8503413132660111, 'loss_val': 0.9157888009236197, 'psi': 0.6936653521857887}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.784054 cos_to_last_merge=0.9686 (last merge round=18)
[S2] round=43 local utility u=0.013634 metrics={'f1_val': 0.7752720763066381, 'auprc': 0.9791701102410663, 'loss_val': 0.4542781454470489, 'psi': 0.8568312898804094}-{'f1_val': 0.7938743242985296, 'auprc': 0.9348983518170098, 'loss_val': 0.46034468423520597, 'psi': 0.8502839353059216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=43 head_norm_before_train=1.881178 cos_to_last_merge=0.7627 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.763
[S3] round=43 local utility u=0.088487 metrics={'f1_val': 0.9814494903353892, 'auprc': 0.9980099727212427, 'loss_val': 0.06160942197628017, 'psi': 0.9880736832897306}-{'f1_val': 0.9623918531992162, 'auprc': 0.9981391165380462, 'loss_val': 0.12462537994334816, 'psi': 0.9766907585347482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=43 head_norm_before_train=1.508935 cos_to_last_merge=0.9108 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.911
[S4] round=43 local utility u=0.034465 metrics={'f1_val': 0.9412040177377425, 'auprc': 0.9738698196350032, 'loss_val': 0.2897557081606207, 'psi': 0.9542703384966468}-{'f1_val': 0.9403493926903528, 'auprc': 0.9538596852978699, 'loss_val': 0.29352671134830144, 'psi': 0.9457535097333596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=43 head_norm_before_train=1.800472 cos_to_last_merge=0.9623 (last merge round=16)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.9453515654184304, 'auprc': 0.9871901954686122, 'loss_val': 0.11018869458729734, 'psi': 0.962087017438503}-{'f1_val': 0.9958933237853395, 'auprc': 0.9964243625664456, 'loss_val': 0.04368670877032999, 'psi': 0.9961057392977819}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.884132 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.5946546109225543, 'auprc': 0.7442145816096323, 'loss_val': 1.1822647324865316, 'psi': 0.6544785991973855}-{'f1_val': 0.8203008835866464, 'auprc': 0.9230556899476104, 'loss_val': 0.4831172663117834, 'psi': 0.861402806131032}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.472912 cos_to_last_merge=0.9769 (last merge round=19)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.41326103963638483, 'auprc': 0.7759329580398732, 'loss_val': 1.1733353011545962, 'psi': 0.5583298069977802}-{'f1_val': 0.7223894891327997, 'auprc': 0.9681788464724232, 'loss_val': 0.20544872911614062, 'psi': 0.8207052320686492}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.822188 cos_to_last_merge=0.9639 (last merge round=16)
[S8] round=43 local utility u=0.005561 metrics={'f1_val': 0.9926820383061284, 'auprc': 0.9989865784745422, 'loss_val': 0.041594950042926154, 'psi': 0.9952038543734939}-{'f1_val': 0.9937505990112392, 'auprc': 0.9949822143536983, 'loss_val': 0.0471148998891341, 'psi': 0.9942432451482228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=43 head_norm_before_train=2.002079 (no previous merge yet)
[S9] round=43 local utility u=0.006456 metrics={'f1_val': 0.994994420763055, 'auprc': 0.9995976908860718, 'loss_val': 0.02191208579635261, 'psi': 0.9968357288122617}-{'f1_val': 0.9937421749897083, 'auprc': 0.9994656511301013, 'loss_val': 0.026914634899517224, 'psi': 0.9960315654458656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=43 head_norm_before_train=1.814589 cos_to_last_merge=0.7896 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.790
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9955945773168998, 'loss_val': 0.029797972581127218, 'psi': 0.9949552950057965}-{'f1_val': 0.9946643883427498, 'auprc': 0.9955954667790813, 'loss_val': 0.030126563680176226, 'psi': 0.9950368197172823}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.910503 cos_to_last_merge=0.9717 (last merge round=21)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.7898207326762289, 'auprc': 0.995878213105404, 'loss_val': 0.4039783863842283, 'psi': 0.8722437248478989}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980086356860357, 'loss_val': 0.024727931263225006, 'psi': 0.997131656982568}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.758670 (no previous merge yet)
[S13] round=43 local utility u=0.121796 metrics={'f1_val': 0.6263149811161948, 'auprc': 0.9006258431514316, 'loss_val': 0.6150777951939769, 'psi': 0.7360393259302895}-{'f1_val': 0.6055582438877259, 'auprc': 0.890347691114896, 'loss_val': 0.7032951862873326, 'psi': 0.7194740227785941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=43 head_norm_before_train=1.799281 cos_to_last_merge=0.9833 (last merge round=19)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9364252622185804, 'auprc': 0.9988155562610785, 'loss_val': 0.07883996695961668, 'psi': 0.9613813798355797}-{'f1_val': 0.9974950262084489, 'auprc': 0.9989307343012782, 'loss_val': 0.0208666661186915, 'psi': 0.9980693094455806}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.626067 cos_to_last_merge=0.9461 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.8438929803140421, 'auprc': 0.9850677481544131, 'loss_val': 0.30468849333855264, 'psi': 0.9003628874501906}-{'f1_val': 0.9971172535281002, 'auprc': 0.9983878279038831, 'loss_val': 0.025432899551945998, 'psi': 0.9976254832784134}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.919759 cos_to_last_merge=0.9784 (last merge round=16)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.8144481022866102, 'auprc': 0.8129194331385681, 'loss_val': 1.2742768805482356, 'psi': 0.8138366346273933}-{'f1_val': 0.7702198164282607, 'auprc': 0.9287117021582773, 'loss_val': 0.9999839137321999, 'psi': 0.8336165707202673}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.633023 cos_to_last_merge=0.9190 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.919
[S17] round=43 local utility u=0.490053 metrics={'f1_val': 0.5898270174866634, 'auprc': 0.9067192112331539, 'loss_val': 0.9534709166329118, 'psi': 0.7165838949852597}-{'f1_val': 0.5331153780198501, 'auprc': 0.7464050823878723, 'loss_val': 1.112365543828673, 'psi': 0.6184312597670589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=44 head_norm_before_train=1.796225 cos_to_last_merge=0.9672 (last merge round=18)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.7982526999764032, 'auprc': 0.8269563682208023, 'loss_val': 0.5540471482790005, 'psi': 0.8097341672741629}-{'f1_val': 0.7752720763066381, 'auprc': 0.9791701102410663, 'loss_val': 0.4542781454470489, 'psi': 0.8568312898804094}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.890156 cos_to_last_merge=0.7619 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.762
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.998158678247588, 'loss_val': 0.14504742152795938, 'psi': 0.9755897950385035}-{'f1_val': 0.9814494903353892, 'auprc': 0.9980099727212427, 'loss_val': 0.06160942197628017, 'psi': 0.9880736832897306}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.520965 cos_to_last_merge=0.9085 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.908
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9392973607024491, 'auprc': 0.9500089630434054, 'loss_val': 0.30011438002222923, 'psi': 0.9435820016388317}-{'f1_val': 0.9412040177377425, 'auprc': 0.9738698196350032, 'loss_val': 0.2897557081606207, 'psi': 0.9542703384966468}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.806656 cos_to_last_merge=0.9611 (last merge round=16)
[S5] round=44 local utility u=0.194631 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9932368592192742, 'loss_val': 0.04231818921845672, 'psi': 0.9948307379589133}-{'f1_val': 0.9453515654184304, 'auprc': 0.9871901954686122, 'loss_val': 0.11018869458729734, 'psi': 0.962087017438503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=44 head_norm_before_train=1.896093 (no previous merge yet)
[S6] round=44 local utility u=0.538908 metrics={'f1_val': 0.700514873640595, 'auprc': 0.788453461616619, 'loss_val': 0.8723272774059159, 'psi': 0.7356903088310045}-{'f1_val': 0.5946546109225543, 'auprc': 0.7442145816096323, 'loss_val': 1.1822647324865316, 'psi': 0.6544785991973855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=44 head_norm_before_train=1.475155 cos_to_last_merge=0.9761 (last merge round=19)
[S7] round=44 local utility u=1.000000 metrics={'f1_val': 0.6579687371035003, 'auprc': 0.8150869834118961, 'loss_val': 0.44685313800027127, 'psi': 0.7208160356268587}-{'f1_val': 0.41326103963638483, 'auprc': 0.7759329580398732, 'loss_val': 1.1733353011545962, 'psi': 0.5583298069977802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=44 head_norm_before_train=1.833767 cos_to_last_merge=0.9628 (last merge round=16)
[S8] round=44 local utility u=0.000276 metrics={'f1_val': 0.9926820383061284, 'auprc': 0.9990120955493994, 'loss_val': 0.0411193796733937, 'psi': 0.9952140612034368}-{'f1_val': 0.9926820383061284, 'auprc': 0.9989865784745422, 'loss_val': 0.041594950042926154, 'psi': 0.9952038543734939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=44 head_norm_before_train=2.007439 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9996212342135389, 'loss_val': 0.025190087410443065, 'psi': 0.9963623175357552}-{'f1_val': 0.994994420763055, 'auprc': 0.9995976908860718, 'loss_val': 0.02191208579635261, 'psi': 0.9968357288122617}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.823718 cos_to_last_merge=0.7890 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.789
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9955922506517684, 'loss_val': 0.029581156531954, 'psi': 0.9948227076518881}-{'f1_val': 0.9945291067983943, 'auprc': 0.9955945773168998, 'loss_val': 0.029797972581127218, 'psi': 0.9949552950057965}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.919992 cos_to_last_merge=0.9709 (last merge round=21)
[S11] round=44 local utility u=0.721616 metrics={'f1_val': 0.9742452705632607, 'auprc': 0.9977009417028451, 'loss_val': 0.07276096172867574, 'psi': 0.9836275390190945}-{'f1_val': 0.7898207326762289, 'auprc': 0.995878213105404, 'loss_val': 0.4039783863842283, 'psi': 0.8722437248478989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=44 head_norm_before_train=1.766231 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5910694537057206, 'auprc': 0.8928198973501944, 'loss_val': 0.8198083729315694, 'psi': 0.7117696311635101}-{'f1_val': 0.6263149811161948, 'auprc': 0.9006258431514316, 'loss_val': 0.6150777951939769, 'psi': 0.7360393259302895}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.807675 cos_to_last_merge=0.9828 (last merge round=19)
[S14] round=44 local utility u=0.027521 metrics={'f1_val': 0.9424424554635733, 'auprc': 0.9988247056509093, 'loss_val': 0.05992781884255134, 'psi': 0.9649953555385078}-{'f1_val': 0.9364252622185804, 'auprc': 0.9988155562610785, 'loss_val': 0.07883996695961668, 'psi': 0.9613813798355797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=44 head_norm_before_train=1.638167 cos_to_last_merge=0.9448 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.945
[S15] round=44 local utility u=0.606546 metrics={'f1_val': 0.9959176576326709, 'auprc': 0.9969731530694524, 'loss_val': 0.03946075184586988, 'psi': 0.9963398558073836}-{'f1_val': 0.8438929803140421, 'auprc': 0.9850677481544131, 'loss_val': 0.30468849333855264, 'psi': 0.9003628874501906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=44 head_norm_before_train=1.926220 cos_to_last_merge=0.9780 (last merge round=16)
[S16] round=44 local utility u=1.000000 metrics={'f1_val': 0.948828356437685, 'auprc': 0.9954782942553316, 'loss_val': 0.10964562765809972, 'psi': 0.9674883315647437}-{'f1_val': 0.8144481022866102, 'auprc': 0.8129194331385681, 'loss_val': 1.2742768805482356, 'psi': 0.8138366346273933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=44 head_norm_before_train=1.643462 cos_to_last_merge=0.9180 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.918
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.5757143609957125, 'auprc': 0.8458520232883868, 'loss_val': 1.0793109593165, 'psi': 0.6837694259127822}-{'f1_val': 0.5898270174866634, 'auprc': 0.9067192112331539, 'loss_val': 0.9534709166329118, 'psi': 0.7165838949852597}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.806001 cos_to_last_merge=0.9657 (last merge round=18)
[S2] round=45 local utility u=0.167737 metrics={'f1_val': 0.8105225519457254, 'auprc': 0.8995969919626821, 'loss_val': 0.5101134508939464, 'psi': 0.846152327952508}-{'f1_val': 0.7982526999764032, 'auprc': 0.8269563682208023, 'loss_val': 0.5540471482790005, 'psi': 0.8097341672741629}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=45 head_norm_before_train=1.898720 cos_to_last_merge=0.7613 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.761
[S3] round=45 local utility u=0.161422 metrics={'f1_val': 0.9974247332315468, 'auprc': 0.9982306749515912, 'loss_val': 0.043705118872024065, 'psi': 0.9977471099195645}-{'f1_val': 0.9605438728991138, 'auprc': 0.998158678247588, 'loss_val': 0.14504742152795938, 'psi': 0.9755897950385035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=45 head_norm_before_train=1.534011 cos_to_last_merge=0.9058 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.906
[S4] round=45 local utility u=0.044728 metrics={'f1_val': 0.9416129466549209, 'auprc': 0.9707705798879421, 'loss_val': 0.28683757429512136, 'psi': 0.9532759999481295}-{'f1_val': 0.9392973607024491, 'auprc': 0.9500089630434054, 'loss_val': 0.30011438002222923, 'psi': 0.9435820016388317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S4] sending update (kind=head size=1808 to 1 peers)
[S5] START round=45 head_norm_before_train=1.814442 cos_to_last_merge=0.9599 (last merge round=16)
[S5] round=45 local utility u=0.007583 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9973516620134528, 'loss_val': 0.040375589431482575, 'psi': 0.9965645999488043}-{'f1_val': 0.9958933237853395, 'auprc': 0.9932368592192742, 'loss_val': 0.04231818921845672, 'psi': 0.9948307379589133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=45 head_norm_before_train=1.904493 (no previous merge yet)
[S6] round=45 local utility u=0.635841 metrics={'f1_val': 0.7914994464162795, 'auprc': 0.9338873226507005, 'loss_val': 0.5828551428596358, 'psi': 0.8484545969100479}-{'f1_val': 0.700514873640595, 'auprc': 0.788453461616619, 'loss_val': 0.8723272774059159, 'psi': 0.7356903088310045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=45 head_norm_before_train=1.478119 cos_to_last_merge=0.9756 (last merge round=19)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5853002068454343, 'auprc': 0.7859786654879796, 'loss_val': 0.7031814595215202, 'psi': 0.6655715903024524}-{'f1_val': 0.6579687371035003, 'auprc': 0.8150869834118961, 'loss_val': 0.44685313800027127, 'psi': 0.7208160356268587}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.844519 cos_to_last_merge=0.9617 (last merge round=16)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.993375371694408, 'auprc': 0.9973744072101711, 'loss_val': 0.04362848992269035, 'psi': 0.9949749859007133}-{'f1_val': 0.9926820383061284, 'auprc': 0.9990120955493994, 'loss_val': 0.0411193796733937, 'psi': 0.9952140612034368}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=2.014029 (no previous merge yet)
[S9] round=45 local utility u=0.012125 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9994956091262932, 'loss_val': 0.018041904491352945, 'psi': 0.998059991157803}-{'f1_val': 0.9941897064172326, 'auprc': 0.9996212342135389, 'loss_val': 0.025190087410443065, 'psi': 0.9963623175357552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=45 head_norm_before_train=1.833431 cos_to_last_merge=0.7882 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.788
[S10] round=45 local utility u=0.000893 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9955835272072665, 'loss_val': 0.02908461864130253, 'psi': 0.9949508749619432}-{'f1_val': 0.9943096789853013, 'auprc': 0.9955922506517684, 'loss_val': 0.029581156531954, 'psi': 0.9948227076518881}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=45 head_norm_before_train=1.928151 cos_to_last_merge=0.9702 (last merge round=21)
[S11] round=45 local utility u=0.092659 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980051709914504, 'loss_val': 0.02216564346935691, 'psi': 0.9971302711047338}-{'f1_val': 0.9742452705632607, 'auprc': 0.9977009417028451, 'loss_val': 0.07276096172867574, 'psi': 0.9836275390190945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=45 head_norm_before_train=1.774320 (no previous merge yet)
[S13] round=45 local utility u=0.209366 metrics={'f1_val': 0.6267191101058692, 'auprc': 0.8913753190997389, 'loss_val': 0.610641324593874, 'psi': 0.732581593703417}-{'f1_val': 0.5910694537057206, 'auprc': 0.8928198973501944, 'loss_val': 0.8198083729315694, 'psi': 0.7117696311635101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=45 head_norm_before_train=1.815688 cos_to_last_merge=0.9823 (last merge round=19)
[S14] round=45 local utility u=0.063328 metrics={'f1_val': 0.9616263022808583, 'auprc': 0.9988336439778864, 'loss_val': 0.048401454073530706, 'psi': 0.9765092389596697}-{'f1_val': 0.9424424554635733, 'auprc': 0.9988247056509093, 'loss_val': 0.05992781884255134, 'psi': 0.9649953555385078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=45 head_norm_before_train=1.649444 cos_to_last_merge=0.9436 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.8152021400974544, 'auprc': 0.9921872991494679, 'loss_val': 0.33278685317425033, 'psi': 0.8859962037182598}-{'f1_val': 0.9959176576326709, 'auprc': 0.9969731530694524, 'loss_val': 0.03946075184586988, 'psi': 0.9963398558073836}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.930717 cos_to_last_merge=0.9777 (last merge round=16)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8839497839568979, 'auprc': 0.990498667034109, 'loss_val': 0.27617165827395024, 'psi': 0.9265693371877823}-{'f1_val': 0.948828356437685, 'auprc': 0.9954782942553316, 'loss_val': 0.10964562765809972, 'psi': 0.9674883315647437}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.654751 cos_to_last_merge=0.9170 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.917
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.5103458700958373, 'auprc': 0.6878022224969945, 'loss_val': 1.274783035126788, 'psi': 0.5813284110563002}-{'f1_val': 0.5757143609957125, 'auprc': 0.8458520232883868, 'loss_val': 1.0793109593165, 'psi': 0.6837694259127822}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=1.814561 cos_to_last_merge=0.9647 (last merge round=18)
[S2] round=46 local utility u=0.059098 metrics={'f1_val': 0.8287907245911048, 'auprc': 0.8737221871319435, 'loss_val': 0.42390211975725794, 'psi': 0.8467633096074403}-{'f1_val': 0.8105225519457254, 'auprc': 0.8995969919626821, 'loss_val': 0.5101134508939464, 'psi': 0.846152327952508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=46 head_norm_before_train=1.907637 cos_to_last_merge=0.7607 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.761
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9660958543001401, 'auprc': 0.9982139958938447, 'loss_val': 0.07876583205859122, 'psi': 0.9789431109376219}-{'f1_val': 0.9974247332315468, 'auprc': 0.9982306749515912, 'loss_val': 0.043705118872024065, 'psi': 0.9977471099195645}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.544055 cos_to_last_merge=0.9038 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.904
[S4] round=46 local utility u=0.003866 metrics={'f1_val': 0.9415554075374448, 'auprc': 0.974766767324106, 'loss_val': 0.29074820502374177, 'psi': 0.9548399514521093}-{'f1_val': 0.9416129466549209, 'auprc': 0.9707705798879421, 'loss_val': 0.28683757429512136, 'psi': 0.9532759999481295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] sending update (kind=head size=1807 to 1 peers)
[S5] START round=46 head_norm_before_train=1.823801 cos_to_last_merge=0.9589 (last merge round=16)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9883021712479838, 'loss_val': 0.0496924346852189, 'psi': 0.9927693781028673}-{'f1_val': 0.9960398919057053, 'auprc': 0.9973516620134528, 'loss_val': 0.040375589431482575, 'psi': 0.9965645999488043}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.910568 (no previous merge yet)
[S6] round=46 local utility u=0.286816 metrics={'f1_val': 0.8400136723813159, 'auprc': 0.9419275561394145, 'loss_val': 0.32442833861405085, 'psi': 0.8807792258845553}-{'f1_val': 0.7914994464162795, 'auprc': 0.9338873226507005, 'loss_val': 0.5828551428596358, 'psi': 0.8484545969100479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=46 head_norm_before_train=1.486822 cos_to_last_merge=0.9744 (last merge round=19)
[S7] round=46 local utility u=0.469860 metrics={'f1_val': 0.6700070621524242, 'auprc': 0.8220480824130019, 'loss_val': 0.37991155037127994, 'psi': 0.7308234702566553}-{'f1_val': 0.5853002068454343, 'auprc': 0.7859786654879796, 'loss_val': 0.7031814595215202, 'psi': 0.6655715903024524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=46 head_norm_before_train=1.852450 cos_to_last_merge=0.9610 (last merge round=16)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9916052646339149, 'auprc': 0.9990080210116672, 'loss_val': 0.04424919207464792, 'psi': 0.9945663671850158}-{'f1_val': 0.993375371694408, 'auprc': 0.9973744072101711, 'loss_val': 0.04362848992269035, 'psi': 0.9949749859007133}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=2.021688 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9965272547490296, 'loss_val': 0.01844391924914129, 'psi': 0.9966072089879467}-{'f1_val': 0.9971029125121428, 'auprc': 0.9994956091262932, 'loss_val': 0.018041904491352945, 'psi': 0.998059991157803}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.843268 cos_to_last_merge=0.7873 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.787
[S10] round=46 local utility u=0.000012 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9955787431260417, 'loss_val': 0.0290460338224855, 'psi': 0.9949489613294533}-{'f1_val': 0.9945291067983943, 'auprc': 0.9955835272072665, 'loss_val': 0.02908461864130253, 'psi': 0.9949508749619432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=46 head_norm_before_train=1.937162 cos_to_last_merge=0.9694 (last merge round=21)
[S11] round=46 local utility u=0.000930 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9979870662462913, 'loss_val': 0.02170180450861849, 'psi': 0.9972680564041352}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980051709914504, 'loss_val': 0.02216564346935691, 'psi': 0.9971302711047338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=46 head_norm_before_train=1.779088 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6051372002459247, 'auprc': 0.9125367225552037, 'loss_val': 0.7234010343254204, 'psi': 0.7280970091696363}-{'f1_val': 0.6267191101058692, 'auprc': 0.8913753190997389, 'loss_val': 0.610641324593874, 'psi': 0.732581593703417}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.824870 cos_to_last_merge=0.9817 (last merge round=19)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9307925573731705, 'auprc': 0.9988566544620892, 'loss_val': 0.10600553910764346, 'psi': 0.958018196208738}-{'f1_val': 0.9616263022808583, 'auprc': 0.9988336439778864, 'loss_val': 0.048401454073530706, 'psi': 0.9765092389596697}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.659096 cos_to_last_merge=0.9425 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.943
[S15] round=46 local utility u=0.116413 metrics={'f1_val': 0.850578578228887, 'auprc': 0.9884285657300156, 'loss_val': 0.3009435282308509, 'psi': 0.9057185732293385}-{'f1_val': 0.8152021400974544, 'auprc': 0.9921872991494679, 'loss_val': 0.33278685317425033, 'psi': 0.8859962037182598}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=46 head_norm_before_train=1.936937 cos_to_last_merge=0.9773 (last merge round=16)
[S16] round=46 local utility u=0.309750 metrics={'f1_val': 0.9557382475121958, 'auprc': 0.9968335415654554, 'loss_val': 0.10640620684779399, 'psi': 0.9721763651334997}-{'f1_val': 0.8839497839568979, 'auprc': 0.990498667034109, 'loss_val': 0.27617165827395024, 'psi': 0.9265693371877823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=46 head_norm_before_train=1.667031 cos_to_last_merge=0.9161 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.916
[S17] round=46 local utility u=0.644347 metrics={'f1_val': 0.6045842245016387, 'auprc': 0.8423027128895468, 'loss_val': 1.0150214238507134, 'psi': 0.699671619856802}-{'f1_val': 0.5103458700958373, 'auprc': 0.6878022224969945, 'loss_val': 1.274783035126788, 'psi': 0.5813284110563002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=47 head_norm_before_train=1.823537 cos_to_last_merge=0.9640 (last merge round=18)
[S2] round=47 local utility u=0.056411 metrics={'f1_val': 0.8282273049040089, 'auprc': 0.9057459021269126, 'loss_val': 0.40377173353284995, 'psi': 0.8592347437931703}-{'f1_val': 0.8287907245911048, 'auprc': 0.8737221871319435, 'loss_val': 0.42390211975725794, 'psi': 0.8467633096074403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=47 head_norm_before_train=1.917896 cos_to_last_merge=0.7599 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.760
[S3] round=47 local utility u=0.062554 metrics={'f1_val': 0.9816704223582675, 'auprc': 0.998226781571305, 'loss_val': 0.047143505844724376, 'psi': 0.9882929660434825}-{'f1_val': 0.9660958543001401, 'auprc': 0.9982139958938447, 'loss_val': 0.07876583205859122, 'psi': 0.9789431109376219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=47 head_norm_before_train=1.552691 cos_to_last_merge=0.9022 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.902
[S4] round=47 local utility u=0.002664 metrics={'f1_val': 0.9426884607814996, 'auprc': 0.9719969862009851, 'loss_val': 0.2839091756205232, 'psi': 0.9544118709492937}-{'f1_val': 0.9415554075374448, 'auprc': 0.974766767324106, 'loss_val': 0.29074820502374177, 'psi': 0.9548399514521093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=47 head_norm_before_train=1.831183 cos_to_last_merge=0.9580 (last merge round=16)
[S5] round=47 local utility u=0.019199 metrics={'f1_val': 0.9956746166411652, 'auprc': 0.9976444477700472, 'loss_val': 0.0388833023732817, 'psi': 0.9964625490927179}-{'f1_val': 0.9957475160061228, 'auprc': 0.9883021712479838, 'loss_val': 0.0496924346852189, 'psi': 0.9927693781028673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=47 head_norm_before_train=1.916543 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.7335063415272437, 'auprc': 0.7802277985206212, 'loss_val': 0.8025962800031177, 'psi': 0.7521949243245947}-{'f1_val': 0.8400136723813159, 'auprc': 0.9419275561394145, 'loss_val': 0.32442833861405085, 'psi': 0.8807792258845553}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.498515 cos_to_last_merge=0.9730 (last merge round=19)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5668444942504289, 'auprc': 0.7835469709609921, 'loss_val': 0.7802781555123502, 'psi': 0.6535254849346541}-{'f1_val': 0.6700070621524242, 'auprc': 0.8220480824130019, 'loss_val': 0.37991155037127994, 'psi': 0.7308234702566553}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.861769 cos_to_last_merge=0.9601 (last merge round=16)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9912442014017308, 'auprc': 0.9989510948373757, 'loss_val': 0.0440941055549545, 'psi': 0.9943269587759886}-{'f1_val': 0.9916052646339149, 'auprc': 0.9990080210116672, 'loss_val': 0.04424919207464792, 'psi': 0.9945663671850158}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=2.030329 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9888785659900814, 'auprc': 0.9997001354453637, 'loss_val': 0.0437314277847067, 'psi': 0.9932071937721944}-{'f1_val': 0.9966605118138915, 'auprc': 0.9965272547490296, 'loss_val': 0.01844391924914129, 'psi': 0.9966072089879467}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.852945 cos_to_last_merge=0.7864 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.786
[S10] round=47 local utility u=0.000063 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9955719066442125, 'loss_val': 0.028898756701218838, 'psi': 0.9949462267367216}-{'f1_val': 0.9945291067983943, 'auprc': 0.9955787431260417, 'loss_val': 0.0290460338224855, 'psi': 0.9949489613294533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=47 head_norm_before_train=1.942478 cos_to_last_merge=0.9690 (last merge round=21)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9960678441841043, 'loss_val': 0.0354330419001701, 'psi': 0.996119622520089}-{'f1_val': 0.9967887165093644, 'auprc': 0.9979870662462913, 'loss_val': 0.02170180450861849, 'psi': 0.9972680564041352}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.781448 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.576632532526007, 'auprc': 0.875917069005268, 'loss_val': 0.9788264745185123, 'psi': 0.6963463471177114}-{'f1_val': 0.6051372002459247, 'auprc': 0.9125367225552037, 'loss_val': 0.7234010343254204, 'psi': 0.7280970091696363}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.833482 cos_to_last_merge=0.9811 (last merge round=19)
[S14] round=47 local utility u=0.058556 metrics={'f1_val': 0.9429380987137113, 'auprc': 0.9989598661950276, 'loss_val': 0.062075473970543214, 'psi': 0.9653468057062379}-{'f1_val': 0.9307925573731705, 'auprc': 0.9988566544620892, 'loss_val': 0.10600553910764346, 'psi': 0.958018196208738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=47 head_norm_before_train=1.669241 cos_to_last_merge=0.9414 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.941
[S15] round=47 local utility u=0.588126 metrics={'f1_val': 0.9958675500088137, 'auprc': 0.9985044828599186, 'loss_val': 0.026653301961687265, 'psi': 0.9969223231492557}-{'f1_val': 0.850578578228887, 'auprc': 0.9884285657300156, 'loss_val': 0.3009435282308509, 'psi': 0.9057185732293385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=47 head_norm_before_train=1.944400 cos_to_last_merge=0.9768 (last merge round=16)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.8608945476619856, 'auprc': 0.9915459689756176, 'loss_val': 0.6604557675365781, 'psi': 0.9131551161874385}-{'f1_val': 0.9557382475121958, 'auprc': 0.9968335415654554, 'loss_val': 0.10640620684779399, 'psi': 0.9721763651334997}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.677561 cos_to_last_merge=0.9153 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.915
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5868148455878592, 'auprc': 0.891400813382991, 'loss_val': 1.1826619203988922, 'psi': 0.708649232705912}-{'f1_val': 0.6045842245016387, 'auprc': 0.8423027128895468, 'loss_val': 1.0150214238507134, 'psi': 0.699671619856802}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.831205 cos_to_last_merge=0.9636 (last merge round=18)
[S2] round=48 local utility u=0.084797 metrics={'f1_val': 0.8258337344448012, 'auprc': 0.9747974054316396, 'loss_val': 0.42696994829235896, 'psi': 0.8854192028395366}-{'f1_val': 0.8282273049040089, 'auprc': 0.9057459021269126, 'loss_val': 0.40377173353284995, 'psi': 0.8592347437931703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=48 head_norm_before_train=1.926673 cos_to_last_merge=0.7592 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.759
[S3] round=48 local utility u=0.027171 metrics={'f1_val': 0.9881217137222198, 'auprc': 0.9981494723290704, 'loss_val': 0.031276958692930394, 'psi': 0.99213281716496}-{'f1_val': 0.9816704223582675, 'auprc': 0.998226781571305, 'loss_val': 0.047143505844724376, 'psi': 0.9882929660434825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=48 head_norm_before_train=1.557592 cos_to_last_merge=0.9011 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.901
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9425722336704245, 'auprc': 0.9714153082879389, 'loss_val': 0.28523906237587077, 'psi': 0.9541094635174303}-{'f1_val': 0.9426884607814996, 'auprc': 0.9719969862009851, 'loss_val': 0.2839091756205232, 'psi': 0.9544118709492937}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.836928 cos_to_last_merge=0.9573 (last merge round=16)
[S5] round=48 local utility u=0.000574 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9972867626412207, 'loss_val': 0.03797508751384063, 'psi': 0.9964506993276919}-{'f1_val': 0.9956746166411652, 'auprc': 0.9976444477700472, 'loss_val': 0.0388833023732817, 'psi': 0.9964625490927179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=48 head_norm_before_train=1.921841 (no previous merge yet)
[S6] round=48 local utility u=1.000000 metrics={'f1_val': 0.9486161024356168, 'auprc': 0.9182043108093029, 'loss_val': 0.23723443404961742, 'psi': 0.9364513857850912}-{'f1_val': 0.7335063415272437, 'auprc': 0.7802277985206212, 'loss_val': 0.8025962800031177, 'psi': 0.7521949243245947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=48 head_norm_before_train=1.510406 cos_to_last_merge=0.9716 (last merge round=19)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5699399924710712, 'auprc': 0.782052597985799, 'loss_val': 0.8213147662110954, 'psi': 0.6547850346769624}-{'f1_val': 0.5668444942504289, 'auprc': 0.7835469709609921, 'loss_val': 0.7802781555123502, 'psi': 0.6535254849346541}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.869908 cos_to_last_merge=0.9592 (last merge round=16)
[S8] round=48 local utility u=0.011953 metrics={'f1_val': 0.9944993143621779, 'auprc': 0.9982936948420665, 'loss_val': 0.03774589495158698, 'psi': 0.9960170665541332}-{'f1_val': 0.9912442014017308, 'auprc': 0.9989510948373757, 'loss_val': 0.0440941055549545, 'psi': 0.9943269587759886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=48 head_norm_before_train=2.032275 (no previous merge yet)
[S9] round=48 local utility u=0.034535 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988473556287297, 'loss_val': 0.018795700630420926, 'psi': 0.9975352493398267}-{'f1_val': 0.9888785659900814, 'auprc': 0.9997001354453637, 'loss_val': 0.0437314277847067, 'psi': 0.9932071937721944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=48 head_norm_before_train=1.862151 cos_to_last_merge=0.7857 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.786
[S10] round=48 local utility u=0.000037 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9955677385061801, 'loss_val': 0.02881270078619487, 'psi': 0.9949445594815086}-{'f1_val': 0.9945291067983943, 'auprc': 0.9955719066442125, 'loss_val': 0.028898756701218838, 'psi': 0.9949462267367216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=48 head_norm_before_train=1.949664 cos_to_last_merge=0.9684 (last merge round=21)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.8271613237452253, 'auprc': 0.9956943632780815, 'loss_val': 0.2883285818578648, 'psi': 0.8945745395583677}-{'f1_val': 0.9961541414107454, 'auprc': 0.9960678441841043, 'loss_val': 0.0354330419001701, 'psi': 0.996119622520089}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.788147 (no previous merge yet)
[S13] round=48 local utility u=0.360413 metrics={'f1_val': 0.6206558023866977, 'auprc': 0.9250964416631773, 'loss_val': 0.6696790648433225, 'psi': 0.7424320580972896}-{'f1_val': 0.576632532526007, 'auprc': 0.875917069005268, 'loss_val': 0.9788264745185123, 'psi': 0.6963463471177114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=48 head_norm_before_train=1.841749 cos_to_last_merge=0.9806 (last merge round=19)
[S14] round=48 local utility u=0.186091 metrics={'f1_val': 0.9978651759306688, 'auprc': 0.9989391150998894, 'loss_val': 0.01939328599552637, 'psi': 0.998294751598357}-{'f1_val': 0.9429380987137113, 'auprc': 0.9989598661950276, 'loss_val': 0.062075473970543214, 'psi': 0.9653468057062379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=48 head_norm_before_train=1.679334 cos_to_last_merge=0.9403 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.940
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.9119982596230046, 'auprc': 0.9962382830100985, 'loss_val': 0.1331046347327314, 'psi': 0.9456942689778421}-{'f1_val': 0.9958675500088137, 'auprc': 0.9985044828599186, 'loss_val': 0.026653301961687265, 'psi': 0.9969223231492557}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.951807 cos_to_last_merge=0.9764 (last merge round=16)
[S16] round=48 local utility u=0.248304 metrics={'f1_val': 0.9034580523217681, 'auprc': 0.9869497583964197, 'loss_val': 0.4054402317961887, 'psi': 0.9368547347516288}-{'f1_val': 0.8608945476619856, 'auprc': 0.9915459689756176, 'loss_val': 0.6604557675365781, 'psi': 0.9131551161874385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=48 head_norm_before_train=1.683873 cos_to_last_merge=0.9145 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.915
[S17] round=48 local utility u=0.178144 metrics={'f1_val': 0.6061844187970078, 'auprc': 0.9355651916722971, 'loss_val': 1.0750845176451158, 'psi': 0.7379367279471236}-{'f1_val': 0.5868148455878592, 'auprc': 0.891400813382991, 'loss_val': 1.1826619203988922, 'psi': 0.708649232705912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=49 head_norm_before_train=1.838718 cos_to_last_merge=0.9634 (last merge round=18)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.8110481773486283, 'auprc': 0.8647255024878757, 'loss_val': 0.4897892178720833, 'psi': 0.8325191074043273}-{'f1_val': 0.8258337344448012, 'auprc': 0.9747974054316396, 'loss_val': 0.42696994829235896, 'psi': 0.8854192028395366}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.935640 cos_to_last_merge=0.7584 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.758
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9981659607490119, 'loss_val': 0.11377742345207359, 'psi': 0.9759114355392771}-{'f1_val': 0.9881217137222198, 'auprc': 0.9981494723290704, 'loss_val': 0.031276958692930394, 'psi': 0.99213281716496}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.562608 cos_to_last_merge=0.8998 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.900
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9415074479137224, 'auprc': 0.9712450168027127, 'loss_val': 0.2911166855226259, 'psi': 0.9534024754693184}-{'f1_val': 0.9425722336704245, 'auprc': 0.9714153082879389, 'loss_val': 0.28523906237587077, 'psi': 0.9541094635174303}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.844075 cos_to_last_merge=0.9566 (last merge round=16)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9905818789824784, 'loss_val': 0.042458377266236524, 'psi': 0.993681261196665}-{'f1_val': 0.9958933237853395, 'auprc': 0.9972867626412207, 'loss_val': 0.03797508751384063, 'psi': 0.9964506993276919}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.926358 (no previous merge yet)
[S6] round=49 local utility u=0.020400 metrics={'f1_val': 0.9338146730903796, 'auprc': 0.9504117612965927, 'loss_val': 0.2042482176845305, 'psi': 0.9404535083728649}-{'f1_val': 0.9486161024356168, 'auprc': 0.9182043108093029, 'loss_val': 0.23723443404961742, 'psi': 0.9364513857850912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=49 head_norm_before_train=1.520803 cos_to_last_merge=0.9707 (last merge round=19)
[S7] round=49 local utility u=0.413727 metrics={'f1_val': 0.6502600197460315, 'auprc': 0.8035990564757405, 'loss_val': 0.5404203911631368, 'psi': 0.7115956344379151}-{'f1_val': 0.5699399924710712, 'auprc': 0.782052597985799, 'loss_val': 0.8213147662110954, 'psi': 0.6547850346769624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=49 head_norm_before_train=1.875516 cos_to_last_merge=0.9588 (last merge round=16)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9919561654725609, 'auprc': 0.9991829052333581, 'loss_val': 0.038935840196511966, 'psi': 0.9948468613768798}-{'f1_val': 0.9944993143621779, 'auprc': 0.9982936948420665, 'loss_val': 0.03774589495158698, 'psi': 0.9960170665541332}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=2.036179 (no previous merge yet)
[S9] round=49 local utility u=0.001744 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9997347599567663, 'loss_val': 0.017969067541722283, 'psi': 0.9978902110710414}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988473556287297, 'loss_val': 0.018795700630420926, 'psi': 0.9975352493398267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=49 head_norm_before_train=1.871228 cos_to_last_merge=0.7849 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.785
[S10] round=49 local utility u=0.000214 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9955819013565306, 'loss_val': 0.028427159261823185, 'psi': 0.9949502246216488}-{'f1_val': 0.9945291067983943, 'auprc': 0.9955677385061801, 'loss_val': 0.02881270078619487, 'psi': 0.9949445594815086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=49 head_norm_before_train=1.956143 cos_to_last_merge=0.9678 (last merge round=21)
[S11] round=49 local utility u=0.194692 metrics={'f1_val': 0.8701911149692435, 'auprc': 0.9957851321084451, 'loss_val': 0.15739582231713178, 'psi': 0.9204287218249242}-{'f1_val': 0.8271613237452253, 'auprc': 0.9956943632780815, 'loss_val': 0.2883285818578648, 'psi': 0.8945745395583677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=49 head_norm_before_train=1.793752 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6018801372351845, 'auprc': 0.9241380997602693, 'loss_val': 0.7674910558221286, 'psi': 0.7307833222452185}-{'f1_val': 0.6206558023866977, 'auprc': 0.9250964416631773, 'loss_val': 0.6696790648433225, 'psi': 0.7424320580972896}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.846398 cos_to_last_merge=0.9800 (last merge round=19)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9974544106971202, 'auprc': 0.9989382634980991, 'loss_val': 0.0192330141534624, 'psi': 0.9980479518175117}-{'f1_val': 0.9978651759306688, 'auprc': 0.9989391150998894, 'loss_val': 0.01939328599552637, 'psi': 0.998294751598357}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.688736 cos_to_last_merge=0.9393 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.939
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.8111840298125648, 'auprc': 0.9852933664253871, 'loss_val': 0.36554890869119605, 'psi': 0.8808277644576936}-{'f1_val': 0.9119982596230046, 'auprc': 0.9962382830100985, 'loss_val': 0.1331046347327314, 'psi': 0.9456942689778421}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.956512 cos_to_last_merge=0.9760 (last merge round=16)
[S16] round=49 local utility u=0.213770 metrics={'f1_val': 0.9427147362405115, 'auprc': 0.986108207443988, 'loss_val': 0.21091553375999483, 'psi': 0.9600721247219021}-{'f1_val': 0.9034580523217681, 'auprc': 0.9869497583964197, 'loss_val': 0.4054402317961887, 'psi': 0.9368547347516288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=49 head_norm_before_train=1.687356 cos_to_last_merge=0.9139 (last merge round=16)
[S17] ⚠️ Model drifted since last merge! cos=0.914
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.3631158861746713, 'auprc': 0.6894742143333089, 'loss_val': 1.5164316448595614, 'psi': 0.49365921743812635}-{'f1_val': 0.6061844187970078, 'auprc': 0.9355651916722971, 'loss_val': 1.0750845176451158, 'psi': 0.7379367279471236}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
