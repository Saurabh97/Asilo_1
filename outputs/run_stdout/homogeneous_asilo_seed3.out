[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:63503
[S3] → join 127.0.0.1:63502
[S4] → join 127.0.0.1:63502
[S5] → join 127.0.0.1:63502
[S6] → join 127.0.0.1:63502
[S7] → join 127.0.0.1:63502
[S8] → join 127.0.0.1:63502
[S9] → join 127.0.0.1:63502
[S10] → join 127.0.0.1:63502
[S11] → join 127.0.0.1:63502
[S13] → join 127.0.0.1:63502
[S14] → join 127.0.0.1:63502
[S15] → join 127.0.0.1:63502
[S16] → join 127.0.0.1:63502
[S17] → join 127.0.0.1:63502
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.183806 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.173725 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.146462 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.231755 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.151513 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.112593 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.151046 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.123828 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.172114 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.228262 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.144496 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.185885 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.190050 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.143911 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.188262 (no previous merge yet)
[S2]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3] + discovered S4
[S3] + discovered S6
[S3] + discovered S10
[S3] + discovered S5
[S3] + discovered S7
[S3] + discovered S16
[S3] + discovered S15
[S3] + discovered S17
[S3] + discovered S14
[S4] + discovered S2
[S3] + discovered S9
[S4] + discovered S3
[S3] + discovered S11
[S3] + discovered S13
[S3] + discovered S8
[S4] + discovered S14
[S4] + discovered S11
[S4] + discovered S9
[S4] + discovered S5
[S4] + discovered S15
[S4] + discovered S6
[S4] + discovered S8
[S4] + discovered S17
[S4] + discovered S10
[S4] + discovered S7
[S5] + discovered S4
[S4] + discovered S13
[S5] + discovered S2
[S4] + discovered S16
[S5] + discovered S3
[S5] + discovered S6
[S5] + discovered S13
[S5] + discovered S7
[S5] + discovered S17
[S5] + discovered S15
[S5] + discovered S9
[S5] + discovered S10
[S6] + discovered S3
[S6] + discovered S2
[S5] + discovered S11
[S5] + discovered S8
[S6] + discovered S4
[S5] + discovered S14
[S5] + discovered S16
[S6] + discovered S5
[S6] + discovered S8
[S6] + discovered S14
[S6] + discovered S15
[S7] + discovered S5
[S6] + discovered S9
[S6] + discovered S10
[S7] + discovered S3
[S6] + discovered S7
[S7] + discovered S6
[S7] + discovered S4
[S7] + discovered S2
[S6] + discovered S11
[S6] + discovered S13
[S6] + discovered S17
[S6] + discovered S16
[S7] + discovered S13
[S8] + discovered S3
[S7] + discovered S11
[S8] + discovered S6
[S7] + discovered S16
[S8] + discovered S2
[S7] + discovered S17
[S8] + discovered S7
[S7] + discovered S8
[S8] + discovered S5
[S7] + discovered S15
[S8] + discovered S4
[S7] + discovered S10
[S7] + discovered S14
[S7] + discovered S9
[S9] + discovered S5
[S9] + discovered S8
[S9] + discovered S7
[S8] + discovered S16
[S8] + discovered S10
[S8] + discovered S15
[S9] + discovered S4
[S8] + discovered S17
[S9] + discovered S6
[S9] + discovered S3
[S8] + discovered S11
[S8] + discovered S9
[S9] + discovered S2
[S8] + discovered S13
[S8] + discovered S14
[S9] + discovered S14
[S10] + discovered S6
[S9] + discovered S13
[S10] + discovered S7
[S9] + discovered S17
[S10] + discovered S5
[S10] + discovered S8
[S9] + discovered S11
[S10] + discovered S2
[S10] + discovered S9
[S9] + discovered S10
[S9] + discovered S16
[S10] + discovered S3
[S9] + discovered S15
[S10] + discovered S4
[S10] + discovered S11
[S11] + discovered S4
[S10] + discovered S16
[S10] + discovered S15
[S11] + discovered S5
[S11] + discovered S9
[S11] + discovered S3
[S11] + discovered S7
[S11] + discovered S6
[S11] + discovered S8
[S11] + discovered S2
[S11] + discovered S10
[S10] + discovered S14
[S10] + discovered S13
[S10] + discovered S17
[S11] + discovered S15
[S11] + discovered S16
[S11] + discovered S14
[S11] + discovered S13
[S13] + discovered S9
[S11] + discovered S17
[S13] + discovered S3
[S13] + discovered S4
[S13] + discovered S5
[S13] + discovered S11
[S13] + discovered S10
[S13] + discovered S8
[S13] + discovered S6
[S13] + discovered S7
[S13] + discovered S2
[S14] + discovered S9
[S14] + discovered S2
[S14] + discovered S13
[S13] + discovered S14
[S14] + discovered S10
[S13] + discovered S16
[S14] + discovered S6
[S14] + discovered S3
[S14] + discovered S8
[S14] + discovered S7
[S13] + discovered S17
[S13] + discovered S15
[S14] + discovered S5
[S14] + discovered S4
[S14] + discovered S11
[S15] + discovered S9
[S15] + discovered S8
[S15] + discovered S6
[S14] + discovered S16
[S15] + discovered S11
[S15] + discovered S10
[S15] + discovered S3
[S14] + discovered S15
[S15] + discovered S7
[S15] + discovered S4
[S15] + discovered S14
[S15] + discovered S2
[S14] + discovered S17
[S15] + discovered S5
[S15] + discovered S13
[S15] + discovered S17
[S16] + discovered S11
[S16] + discovered S7
[S16] + discovered S15
[S16] + discovered S13
[S16] + discovered S10
[S16] + discovered S3
[S16] + discovered S8
[S16] + discovered S9
[S16] + discovered S4
[S16] + discovered S6
[S16] + discovered S14
[S15] + discovered S16
[S16] + discovered S5
[S16] + discovered S2
[S17] + discovered S9
[S17] + discovered S7
[S17] + discovered S3
[S17] + discovered S6
[S17] + discovered S2
[S17] + discovered S14
[S17] + discovered S16
[S17] + discovered S13
[S17] + discovered S15
[S17] + discovered S10
[S17] + discovered S4
[S17] + discovered S5
[S17] + discovered S11
[S16] + discovered S17
[S17] + discovered S8
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:63517
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:63515
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:63509
[S4] ⇄ pheromone p=1.000 → S16@127.0.0.1:63516
[S2] ⇄ pheromone p=1.000 → S14@127.0.0.1:63514
[S15] ⇄ pheromone p=1.000 → S4@127.0.0.1:63504
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:63507
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:63515
[S10] ⇄ pheromone p=1.000 → S17@127.0.0.1:63517
[S5] ⇄ pheromone p=1.000 → S15@127.0.0.1:63515
[S13] ⇄ pheromone p=1.000 → S8@127.0.0.1:63509
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:63508
[S11] ⇄ pheromone p=1.000 → S5@127.0.0.1:63505
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:63516
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:63513
[S2] START round=1 head_norm_before_train=1.192122 (no previous merge yet)
[S2] round=1 local utility u=0.099145 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.5965715960431223, 'loss_val': 1.3111636570551386, 'psi': 0.32369491845038895}-{'f1_val': 0.1417771333885667, 'auprc': 0.5441533670291836, 'loss_val': 1.3521999553521118, 'psi': 0.30272762684481347}
[S3] START round=1 head_norm_before_train=1.174606 (no previous merge yet)
[S3] round=1 local utility u=0.286600 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9979633566466265, 'loss_val': 1.3454880354330707, 'psi': 0.4830893820271148}-{'f1_val': 0.08969866853538892, 'auprc': 0.9166867225579558, 'loss_val': 1.3740106904232277, 'psi': 0.4204938901444157}
[S4] START round=1 head_norm_before_train=1.147906 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.6865198303102172, 'auprc': 0.7932419863120437, 'loss_val': 1.3275624370090993, 'psi': 0.7292086927109478}-{'f1_val': 0.6843169319354099, 'auprc': 0.8792039883441594, 'loss_val': 1.364538745273763, 'psi': 0.7622717544989097}
[S5] START round=1 head_norm_before_train=1.240016 (no previous merge yet)
[S5] round=1 local utility u=0.020532 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7689648688811485, 'loss_val': 1.302816972414275, 'psi': 0.39294309040960224}-{'f1_val': 0.14226190476190476, 'auprc': 0.7695567996926966, 'loss_val': 1.3456572371397733, 'psi': 0.3931798627342215}
[S6] START round=1 head_norm_before_train=1.156173 (no previous merge yet)
[S6] round=1 local utility u=0.538439 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8044233957206801, 'loss_val': 1.324451380965591, 'psi': 0.4066251275190413}-{'f1_val': 0.14142628205128205, 'auprc': 0.45583434515730936, 'loss_val': 1.3555628584945154, 'psi': 0.26718950729369295}
[S7] START round=1 head_norm_before_train=1.116791 (no previous merge yet)
[S7] round=1 local utility u=0.017192 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7946130480663467, 'loss_val': 1.3123094179771213, 'psi': 0.4030793128639937}-{'f1_val': 0.14205682272909165, 'auprc': 0.7924367858350196, 'loss_val': 1.340165566292494, 'psi': 0.40220880797146286}
[S8] START round=1 head_norm_before_train=1.147124 (no previous merge yet)
[S8] round=1 local utility u=0.259930 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7709180958423487, 'loss_val': 1.3436873971374717, 'psi': 0.39234082777271384}-{'f1_val': 0.13995598239295717, 'auprc': 0.6073647782645444, 'loss_val': 1.3728884236775862, 'psi': 0.3269195007415921}
[S9] START round=1 head_norm_before_train=1.137549 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.1640010657423593, 'auprc': 0.8207078870441248, 'loss_val': 1.2880025944015017, 'psi': 0.42668379426306546}-{'f1_val': 0.3794876607376607, 'auprc': 0.6365907033361216, 'loss_val': 1.3382773779651163, 'psi': 0.4823288777770451}
[S10] START round=1 head_norm_before_train=1.172258 (no previous merge yet)
[S10] round=1 local utility u=0.142036 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6493398111910247, 'loss_val': 1.319179493865094, 'psi': 0.3429089070014442}-{'f1_val': 0.13862163754172394, 'auprc': 0.562353286804157, 'loss_val': 1.3422911093375098, 'psi': 0.30811429724669714}
[S11] START round=1 head_norm_before_train=1.230864 (no previous merge yet)
[S11] round=1 local utility u=0.932405 metrics={'f1_val': 0.3964515026091945, 'auprc': 0.7487675553812576, 'loss_val': 1.3184579511519776, 'psi': 0.5373779237180197}-{'f1_val': 0.10359570269677702, 'auprc': 0.72578572661208, 'loss_val': 1.3571878982722592, 'psi': 0.3524717122628982}
[S13] START round=1 head_norm_before_train=1.156569 (no previous merge yet)
[S13] round=1 local utility u=0.032462 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.573356211877141, 'loss_val': 1.318083415676885, 'psi': 0.3135739422970883}-{'f1_val': 0.1403857625770531, 'auprc': 0.561861436700059, 'loss_val': 1.3485239719865658, 'psi': 0.30897603222625547}
[S14] START round=1 head_norm_before_train=1.184771 (no previous merge yet)
[S14] round=1 local utility u=0.839658 metrics={'f1_val': 0.3074027827299708, 'auprc': 0.7235291691622804, 'loss_val': 1.3493379049868568, 'psi': 0.47385333730289464}-{'f1_val': 0.12660736862416447, 'auprc': 0.5331504502607576, 'loss_val': 1.3727461658835372, 'psi': 0.28922460127880173}
[S15] START round=1 head_norm_before_train=1.201362 (no previous merge yet)
[S15] round=1 local utility u=0.101631 metrics={'f1_val': 0.40745348286433214, 'auprc': 0.7913703973453993, 'loss_val': 1.3171627447405962, 'psi': 0.561020248656759}-{'f1_val': 0.3791028829404088, 'auprc': 0.7912372716522138, 'loss_val': 1.3499224530510288, 'psi': 0.5439566384251308}
[S16] START round=1 head_norm_before_train=1.148744 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.801740504557658, 'loss_val': 1.3385932209555318, 'psi': 0.4050786719425852}-{'f1_val': 0.39791834269905246, 'auprc': 0.7916821375793508, 'loss_val': 1.3709223141935714, 'psi': 0.5554238606511719}
[S17] START round=1 head_norm_before_train=1.193625 (no previous merge yet)
[S17] round=1 local utility u=0.122978 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7194869184241534, 'loss_val': 1.3207968835479846, 'psi': 0.372364145360092}-{'f1_val': 0.17034342985809536, 'auprc': 0.5874567886583913, 'loss_val': 1.3470299312571052, 'psi': 0.3371887733782138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S13] → sending delta(kind=head bytes=1785) to S8@127.0.0.1:63509
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:63513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:63513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S14] → sending delta(kind=head bytes=1784) to S3@127.0.0.1:63503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:63503
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:63513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S6] → sending delta(kind=head bytes=1785) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S8] → sending delta(kind=head bytes=1785) to S10@127.0.0.1:63511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S7] → sending delta(kind=head bytes=1788) to S4@127.0.0.1:63504
[S15] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1785 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1785 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1788 to 1 peers)
[S7] sending update (kind=head size=1788 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1784 to 1 peers)
[S13] sending update (kind=head size=1785 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1790) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.209839)
[S3] loaded HEAD from S2 (vec_in norm=1.209839)
[S3] cosine check vs S2: cos=0.0371
[S3] BUFFERED delta from S2 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1785) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.169087)
[S17] loaded HEAD from S6 (vec_in norm=1.169087)
[S17] cosine check vs S6: cos=0.0784
[S17] BUFFERED delta from S6 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1790) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.187277)
[S5] loaded HEAD from S3 (vec_in norm=1.187277)
[S5] cosine check vs S3: cos=-0.0165
[S5] DROPPED delta from S3 (cos=-0.0165 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1793) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.182860)
[S13] loaded HEAD from S10 (vec_in norm=1.182860)
[S13] cosine check vs S10: cos=0.0511
[S13] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1793) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.259648)
[S13] loaded HEAD from S5 (vec_in norm=1.259648)
[S13] cosine check vs S5: cos=-0.0420
[S13] DROPPED delta from S5 (cos=-0.0420 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1788) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.130523)
[S4] loaded HEAD from S7 (vec_in norm=1.130523)
[S4] cosine check vs S7: cos=0.0464
[S4] BUFFERED delta from S7 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1785) from S13
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.173755)
[S8] loaded HEAD from S13 (vec_in norm=1.173755)
[S8] cosine check vs S13: cos=0.1022
[S8] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1788) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.246138)
[S14] loaded HEAD from S11 (vec_in norm=1.246138)
[S14] cosine check vs S11: cos=-0.1593
[S14] DROPPED delta from S11 (cos=-0.1593 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1785) from S8
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.154851)
[S10] loaded HEAD from S8 (vec_in norm=1.154851)
[S10] cosine check vs S8: cos=-0.0510
[S10] DROPPED delta from S8 (cos=-0.0510 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1791) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.219723)
[S13] loaded HEAD from S15 (vec_in norm=1.219723)
[S13] cosine check vs S15: cos=0.0055
[S13] BUFFERED delta from S15 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1784) from S14
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.193491)
[S3] loaded HEAD from S14 (vec_in norm=1.193491)
[S3] cosine check vs S14: cos=0.0141
[S3] BUFFERED delta from S14 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:63505
[S17] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.207059)
[S5] loaded HEAD from S17 (vec_in norm=1.207059)
[S5] cosine check vs S17: cos=-0.0498
[S5] DROPPED delta from S17 (cos=-0.0498 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.6865 head_norm=1.161021
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.912477e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.4229 head_norm=0.828827 delta_norm=0.791248
[S4] aggregate: ROLLBACK (f1_val pre=0.687 post=0.423 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.154851
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.801085e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.864362 delta_norm=0.780109
[S8] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=1 metric=0.1398 head_norm=1.187277
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.229080e-01
[S3] stored merged vector for next round verification (round=1)
[S3] DEBUG after merge:  round=1 metric=0.1398 head_norm=0.747825 delta_norm=0.722908
[S3] aggregate: ACCEPT kept=['S2', 'S14'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.1404 head_norm=1.173755
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.989396e-01
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.726589 delta_norm=0.698940
[S13] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.207059
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.065957e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.872514 delta_norm=0.806596
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.209839 (no previous merge yet)
[S2] round=2 local utility u=0.164264 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6916380810353867, 'loss_val': 1.2678356564584092, 'psi': 0.3617215124472947}-{'f1_val': 0.1417771333885667, 'auprc': 0.5965715960431223, 'loss_val': 1.3111636570551386, 'psi': 0.32369491845038895}
[S3] START round=2 head_norm_before_train=0.747825 cos_to_last_merge=1.0000 (last merge round=1)
[S3] round=2 local utility u=0.001787 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9988947186929235, 'loss_val': 1.3447073302047332, 'psi': 0.4834619268456336}-{'f1_val': 0.13984006561410703, 'auprc': 0.9979633566466265, 'loss_val': 1.3454880354330707, 'psi': 0.4830893820271148}
[S4] START round=2 head_norm_before_train=0.828827 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.3990979004520701, 'auprc': 0.7948658749280249, 'loss_val': 1.322989018355022, 'psi': 0.557405090242452}-{'f1_val': 0.6865198303102172, 'auprc': 0.7932419863120437, 'loss_val': 1.3275624370090993, 'psi': 0.7292086927109478}
[S5] START round=2 head_norm_before_train=1.259648 (no previous merge yet)
[S5] round=2 local utility u=0.013886 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7632380232770265, 'loss_val': 1.2578642548891072, 'psi': 0.39065235216795346}-{'f1_val': 0.14226190476190476, 'auprc': 0.7689648688811485, 'loss_val': 1.302816972414275, 'psi': 0.39294309040960224}
[S6] START round=2 head_norm_before_train=1.169087 (no previous merge yet)
[S6] round=2 local utility u=0.099443 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8604404414079093, 'loss_val': 1.2936157199101663, 'psi': 0.42903194579393295}-{'f1_val': 0.14142628205128205, 'auprc': 0.8044233957206801, 'loss_val': 1.324451380965591, 'psi': 0.4066251275190413}
[S7] START round=2 head_norm_before_train=1.130523 (no previous merge yet)
[S7] round=2 local utility u=0.000161 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7845335144253979, 'loss_val': 1.2817496609634078, 'psi': 0.39904749940761414}-{'f1_val': 0.14205682272909165, 'auprc': 0.7946130480663467, 'loss_val': 1.3123094179771213, 'psi': 0.4030793128639937}
[S8] START round=2 head_norm_before_train=0.864362 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7401691855161465, 'loss_val': 1.3325606273248123, 'psi': 0.38004126364223295}-{'f1_val': 0.13995598239295717, 'auprc': 0.7709180958423487, 'loss_val': 1.3436873971374717, 'psi': 0.39234082777271384}
[S9] START round=2 head_norm_before_train=1.159984 (no previous merge yet)
[S9] round=2 local utility u=0.118738 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9212310391503935, 'loss_val': 1.2164769042830965, 'psi': 0.45333118994415506}-{'f1_val': 0.1640010657423593, 'auprc': 0.8207078870441248, 'loss_val': 1.2880025944015017, 'psi': 0.42668379426306546}
[S10] START round=2 head_norm_before_train=1.182860 (no previous merge yet)
[S10] round=2 local utility u=0.217305 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7847863601180533, 'loss_val': 1.2909095408049132, 'psi': 0.39708752657225566}-{'f1_val': 0.13862163754172394, 'auprc': 0.6493398111910247, 'loss_val': 1.319179493865094, 'psi': 0.3429089070014442}
[S11] START round=2 head_norm_before_train=1.246138 (no previous merge yet)
[S11] round=2 local utility u=0.111079 metrics={'f1_val': 0.4229120744550575, 'auprc': 0.7534876352006444, 'loss_val': 1.2692241029017166, 'psi': 0.5551422987532924}-{'f1_val': 0.3964515026091945, 'auprc': 0.7487675553812576, 'loss_val': 1.3184579511519776, 'psi': 0.5373779237180197}
[S13] START round=2 head_norm_before_train=0.726589 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5694552794709155, 'loss_val': 1.3215953655362096, 'psi': 0.31201356933459806}-{'f1_val': 0.1403857625770531, 'auprc': 0.573356211877141, 'loss_val': 1.318083415676885, 'psi': 0.3135739422970883}
[S14] START round=2 head_norm_before_train=1.193491 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8536158959738749, 'loss_val': 1.322449935323361, 'psi': 0.4256610701191722}-{'f1_val': 0.3074027827299708, 'auprc': 0.7235291691622804, 'loss_val': 1.3493379049868568, 'psi': 0.47385333730289464}
[S15] START round=2 head_norm_before_train=1.219723 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.79175436075411, 'loss_val': 1.2802357232984254, 'psi': 0.400541935118579}-{'f1_val': 0.40745348286433214, 'auprc': 0.7913703973453993, 'loss_val': 1.3171627447405962, 'psi': 0.561020248656759}
[S16] START round=2 head_norm_before_train=1.164186 (no previous merge yet)
[S16] round=2 local utility u=0.054779 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8250353149829173, 'loss_val': 1.2989203991842995, 'psi': 0.41439659611268886}-{'f1_val': 0.14063745019920318, 'auprc': 0.801740504557658, 'loss_val': 1.3385932209555318, 'psi': 0.4050786719425852}
[S17] START round=2 head_norm_before_train=0.872514 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7124394006172075, 'loss_val': 1.3291315124680387, 'psi': 0.3695451382373136}-{'f1_val': 0.14094896331738438, 'auprc': 0.7194869184241534, 'loss_val': 1.3207968835479846, 'psi': 0.372364145360092}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:63512
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S7] → sending delta(kind=head bytes=1787) to S10@127.0.0.1:63511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:63511
[S16] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1787 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1791) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.188007)
[S17] loaded HEAD from S16 (vec_in norm=1.188007)
[S17] cosine check vs S16: cos=0.0921
[S17] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1793) from S11
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.271377)
[S17] loaded HEAD from S11 (vec_in norm=1.271377)
[S17] cosine check vs S11: cos=-0.0733
[S17] DROPPED delta from S11 (cos=-0.0733 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S3
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.771357)
[S10] loaded HEAD from S3 (vec_in norm=0.771357)
[S10] cosine check vs S3: cos=-0.0163
[S10] DROPPED delta from S3 (cos=-0.0163 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.232123)
[S11] loaded HEAD from S2 (vec_in norm=1.232123)
[S11] cosine check vs S2: cos=0.0586
[S11] BUFFERED delta from S2 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1794) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.287517)
[S15] loaded HEAD from S5 (vec_in norm=1.287517)
[S15] cosine check vs S5: cos=-0.0656
[S15] DROPPED delta from S5 (cos=-0.0656 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S9
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.193072)
[S4] loaded HEAD from S9 (vec_in norm=1.193072)
[S4] cosine check vs S9: cos=-0.0523
[S4] DROPPED delta from S9 (cos=-0.0523 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1792) from S6
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.190068)
[S5] loaded HEAD from S6 (vec_in norm=1.190068)
[S5] cosine check vs S6: cos=0.0356
[S5] BUFFERED delta from S6 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1787) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.150802)
[S10] loaded HEAD from S7 (vec_in norm=1.150802)
[S10] cosine check vs S7: cos=0.0230
[S10] BUFFERED delta from S7 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1792) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.202677)
[S4] loaded HEAD from S10 (vec_in norm=1.202677)
[S4] cosine check vs S10: cos=-0.0259
[S4] DROPPED delta from S10 (cos=-0.0259 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.4229 head_norm=1.271377
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.588922e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.3738 head_norm=0.910806 delta_norm=0.858892
[S11] aggregate: ROLLBACK (f1_val pre=0.423 post=0.374 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=2 metric=0.1423 head_norm=1.287517
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.609276e-01
[S5] stored merged vector for next round verification (round=2)
[S5] DEBUG after merge:  round=2 metric=0.1423 head_norm=0.892067 delta_norm=0.860928
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=1.202677
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.226470e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.841808 delta_norm=0.822647
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1409 head_norm=0.884850
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.072273e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.1409 head_norm=0.772652 delta_norm=0.707227
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.232123 (no previous merge yet)
[S2] round=3 local utility u=0.088472 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7363343649726242, 'loss_val': 1.2249812783377516, 'psi': 0.37960002602218973}-{'f1_val': 0.1417771333885667, 'auprc': 0.6916380810353867, 'loss_val': 1.2678356564584092, 'psi': 0.3617215124472947}
[S3] START round=3 head_norm_before_train=0.771357 cos_to_last_merge=0.9957 (last merge round=1)
[S3] round=3 local utility u=0.016897 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9991134897889867, 'loss_val': 1.3115697772230077, 'psi': 0.4835494352840589}-{'f1_val': 0.13984006561410703, 'auprc': 0.9988947186929235, 'loss_val': 1.3447073302047332, 'psi': 0.4834619268456336}
[S4] START round=3 head_norm_before_train=0.847735 cos_to_last_merge=0.9966 (last merge round=1)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7939724259594978, 'loss_val': 1.2755519359937666, 'psi': 0.4017249477209096}-{'f1_val': 0.3990979004520701, 'auprc': 0.7948658749280249, 'loss_val': 1.322989018355022, 'psi': 0.557405090242452}
[S5] START round=3 head_norm_before_train=0.892067 cos_to_last_merge=1.0000 (last merge round=2)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7580346086688264, 'loss_val': 1.2670186294760517, 'psi': 0.38857098632467346}-{'f1_val': 0.14226190476190476, 'auprc': 0.7632380232770265, 'loss_val': 1.2578642548891072, 'psi': 0.39065235216795346}
[S6] START round=3 head_norm_before_train=1.190068 (no previous merge yet)
[S6] round=3 local utility u=0.014632 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8609049519480093, 'loss_val': 1.2657450948789444, 'psi': 0.429217750009973}-{'f1_val': 0.14142628205128205, 'auprc': 0.8604404414079093, 'loss_val': 1.2936157199101663, 'psi': 0.42903194579393295}
[S7] START round=3 head_norm_before_train=1.150802 (no previous merge yet)
[S7] round=3 local utility u=0.007411 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776073956505409, 'loss_val': 1.246148829638916, 'psi': 0.3962770518976714}-{'f1_val': 0.14205682272909165, 'auprc': 0.7845335144253979, 'loss_val': 1.2817496609634078, 'psi': 0.39904749940761414}
[S8] START round=3 head_norm_before_train=0.882148 cos_to_last_merge=0.9970 (last merge round=1)
[S8] round=3 local utility u=0.007987 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7353437804436448, 'loss_val': 1.3021113619294213, 'psi': 0.37811110161323225}-{'f1_val': 0.13995598239295717, 'auprc': 0.7401691855161465, 'loss_val': 1.3325606273248123, 'psi': 0.38004126364223295}
[S9] START round=3 head_norm_before_train=1.193072 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8693110595472208, 'loss_val': 1.1250434800617881, 'psi': 0.43256319810288596}-{'f1_val': 0.141397957139996, 'auprc': 0.9212310391503935, 'loss_val': 1.2164769042830965, 'psi': 0.45333118994415506}
[S10] START round=3 head_norm_before_train=0.841808 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5870988973716156, 'loss_val': 1.3120099009135326, 'psi': 0.31801254147368063}-{'f1_val': 0.13862163754172394, 'auprc': 0.7847863601180533, 'loss_val': 1.2909095408049132, 'psi': 0.39708752657225566}
[S11] START round=3 head_norm_before_train=0.910806 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5920064517957404, 'loss_val': 1.2567370162187543, 'psi': 0.32105079074216253}-{'f1_val': 0.4229120744550575, 'auprc': 0.7534876352006444, 'loss_val': 1.2692241029017166, 'psi': 0.5551422987532924}
[S13] START round=3 head_norm_before_train=0.748648 cos_to_last_merge=0.9962 (last merge round=1)
[S13] round=3 local utility u=0.011085 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5671936026016823, 'loss_val': 1.2926411831234061, 'psi': 0.31110889858690477}-{'f1_val': 0.1403857625770531, 'auprc': 0.5694552794709155, 'loss_val': 1.3215953655362096, 'psi': 0.31201356933459806}
[S14] START round=3 head_norm_before_train=1.209960 (no previous merge yet)
[S14] round=3 local utility u=0.023598 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8585912345592852, 'loss_val': 1.290179511185663, 'psi': 0.42765120555333636}-{'f1_val': 0.14035785288270378, 'auprc': 0.8536158959738749, 'loss_val': 1.322449935323361, 'psi': 0.4256610701191722}
[S15] START round=3 head_norm_before_train=1.244284 (no previous merge yet)
[S15] round=3 local utility u=0.014743 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.785716917412753, 'loss_val': 1.2326375952866893, 'psi': 0.3981269577820362}-{'f1_val': 0.13973365136155833, 'auprc': 0.79175436075411, 'loss_val': 1.2802357232984254, 'psi': 0.400541935118579}
[S16] START round=3 head_norm_before_train=1.188007 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8057791514963564, 'loss_val': 1.2449230773985651, 'psi': 0.4066941307180645}-{'f1_val': 0.14063745019920318, 'auprc': 0.8250353149829173, 'loss_val': 1.2989203991842995, 'psi': 0.41439659611268886}
[S17] START round=3 head_norm_before_train=0.772652 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6561520434661707, 'loss_val': 1.3161013283071386, 'psi': 0.34703019537689894}-{'f1_val': 0.14094896331738438, 'auprc': 0.7124394006172075, 'loss_val': 1.3291315124680387, 'psi': 0.3695451382373136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:63515
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:63509
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:63509
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:63507
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:63515
[S2] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.236065)
[S8] loaded HEAD from S14 (vec_in norm=1.236065)
[S8] cosine check vs S14: cos=-0.0409
[S8] DROPPED delta from S14 (cos=-0.0409 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S13
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.779327)
[S8] loaded HEAD from S13 (vec_in norm=0.779327)
[S8] cosine check vs S13: cos=0.6073
[S8] BUFFERED delta from S13 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1796) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.178245)
[S17] loaded HEAD from S7 (vec_in norm=1.178245)
[S17] cosine check vs S7: cos=0.0626
[S17] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1796) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.807348)
[S6] loaded HEAD from S3 (vec_in norm=0.807348)
[S6] cosine check vs S3: cos=0.0425
[S6] BUFFERED delta from S3 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1793) from S2
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.258997)
[S14] loaded HEAD from S2 (vec_in norm=1.258997)
[S14] cosine check vs S2: cos=0.0365
[S14] BUFFERED delta from S2 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1792) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.908887)
[S15] loaded HEAD from S8 (vec_in norm=0.908887)
[S15] cosine check vs S8: cos=0.0535
[S15] BUFFERED delta from S8 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1792) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.278122)
[S4] loaded HEAD from S15 (vec_in norm=1.278122)
[S4] cosine check vs S15: cos=0.0299
[S4] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1790) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.215258)
[S15] loaded HEAD from S6 (vec_in norm=1.215258)
[S15] cosine check vs S6: cos=-0.0213
[S15] DROPPED delta from S6 (cos=-0.0213 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1402 head_norm=0.878764
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.646222e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.1402 head_norm=0.786297 delta_norm=0.764622
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.236065
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.659134e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.898142 delta_norm=0.865913
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=1.278122
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.641117e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.1397 head_norm=0.803722 delta_norm=0.764112
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=1.215258
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.150542e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.743659 delta_norm=0.715054
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1400 head_norm=0.908887
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.785142e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.1400 head_norm=0.757258 delta_norm=0.378514
[S8] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=0.790830
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.886660e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1409 head_norm=0.729778 delta_norm=0.688666
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.258997 (no previous merge yet)
[S2] round=4 local utility u=0.040017 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7509702086730019, 'loss_val': 1.1888556872397604, 'psi': 0.3854543635023408}-{'f1_val': 0.1417771333885667, 'auprc': 0.7363343649726242, 'loss_val': 1.2249812783377516, 'psi': 0.37960002602218973}
[S3] START round=4 head_norm_before_train=0.807348 cos_to_last_merge=0.9846 (last merge round=1)
[S3] round=4 local utility u=0.026827 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9989371246066625, 'loss_val': 1.257385823227794, 'psi': 0.48347888921112925}-{'f1_val': 0.13984006561410703, 'auprc': 0.9991134897889867, 'loss_val': 1.3115697772230077, 'psi': 0.4835494352840589}
[S4] START round=4 head_norm_before_train=0.786297 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7940209389804426, 'loss_val': 1.291356537108109, 'psi': 0.4017443529292875}-{'f1_val': 0.14022662889518414, 'auprc': 0.7939724259594978, 'loss_val': 1.2755519359937666, 'psi': 0.4017249477209096}
[S5] START round=4 head_norm_before_train=0.917786 cos_to_last_merge=0.9982 (last merge round=2)
[S5] round=4 local utility u=0.037888 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7696472456385313, 'loss_val': 1.2260810001596942, 'psi': 0.39321604111255537}-{'f1_val': 0.14226190476190476, 'auprc': 0.7580346086688264, 'loss_val': 1.2670186294760517, 'psi': 0.38857098632467346}
[S6] START round=4 head_norm_before_train=0.743659 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8616075262486854, 'loss_val': 1.2870192387182933, 'psi': 0.4294987797302434}-{'f1_val': 0.14142628205128205, 'auprc': 0.8609049519480093, 'loss_val': 1.2657450948789444, 'psi': 0.429217750009973}
[S7] START round=4 head_norm_before_train=1.178245 (no previous merge yet)
[S7] round=4 local utility u=0.014832 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776582854977021, 'loss_val': 1.2166365439445839, 'psi': 0.39629740783653583}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776073956505409, 'loss_val': 1.246148829638916, 'psi': 0.3962770518976714}
[S8] START round=4 head_norm_before_train=0.757258 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7153652835288935, 'loss_val': 1.290483197568601, 'psi': 0.37011970284733176}-{'f1_val': 0.13995598239295717, 'auprc': 0.7353437804436448, 'loss_val': 1.3021113619294213, 'psi': 0.37811110161323225}
[S9] START round=4 head_norm_before_train=1.233422 (no previous merge yet)
[S9] round=4 local utility u=0.037795 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8662495736047743, 'loss_val': 1.0402681714582407, 'psi': 0.4313386037259073}-{'f1_val': 0.141397957139996, 'auprc': 0.8693110595472208, 'loss_val': 1.1250434800617881, 'psi': 0.43256319810288596}
[S10] START round=4 head_norm_before_train=0.859351 cos_to_last_merge=0.9966 (last merge round=2)
[S10] round=4 local utility u=0.029042 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5920715680844153, 'loss_val': 1.2688439299526038, 'psi': 0.3200016097588005}-{'f1_val': 0.13862163754172394, 'auprc': 0.5870988973716156, 'loss_val': 1.3120099009135326, 'psi': 0.31801254147368063}
[S11] START round=4 head_norm_before_train=0.942975 cos_to_last_merge=0.9970 (last merge round=2)
[S11] round=4 local utility u=0.036445 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5915853283162271, 'loss_val': 1.182583747497627, 'psi': 0.3208823413503572}-{'f1_val': 0.14041368337311058, 'auprc': 0.5920064517957404, 'loss_val': 1.2567370162187543, 'psi': 0.32105079074216253}
[S13] START round=4 head_norm_before_train=0.779327 cos_to_last_merge=0.9868 (last merge round=1)
[S13] round=4 local utility u=0.012646 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5667933644495468, 'loss_val': 1.2661485736807405, 'psi': 0.31094880332605057}-{'f1_val': 0.1403857625770531, 'auprc': 0.5671936026016823, 'loss_val': 1.2926411831234061, 'psi': 0.31110889858690477}
[S14] START round=4 head_norm_before_train=0.898142 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6948275173333198, 'loss_val': 1.3106504766653084, 'psi': 0.3621457186629502}-{'f1_val': 0.14035785288270378, 'auprc': 0.8585912345592852, 'loss_val': 1.290179511185663, 'psi': 0.42765120555333636}
[S15] START round=4 head_norm_before_train=0.803722 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7768774867246958, 'loss_val': 1.2411453933993395, 'psi': 0.3945911855068133}-{'f1_val': 0.13973365136155833, 'auprc': 0.785716917412753, 'loss_val': 1.2326375952866893, 'psi': 0.3981269577820362}
[S16] START round=4 head_norm_before_train=1.220543 (no previous merge yet)
[S16] round=4 local utility u=0.035069 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8125747719486485, 'loss_val': 1.1951721177107741, 'psi': 0.4094123788989813}-{'f1_val': 0.14063745019920318, 'auprc': 0.8057791514963564, 'loss_val': 1.2449230773985651, 'psi': 0.4066941307180645}
[S17] START round=4 head_norm_before_train=0.729778 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5627283917518487, 'loss_val': 1.2799875430827383, 'psi': 0.30966073469117017}-{'f1_val': 0.14094896331738438, 'auprc': 0.6561520434661707, 'loss_val': 1.3161013283071386, 'psi': 0.34703019537689894}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S3] → sending delta(kind=head bytes=1787) to S6@127.0.0.1:63507
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:63514
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:63517
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:63515
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:63509
[S9] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1787 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.200421)
[S17] loaded HEAD from S7 (vec_in norm=1.200421)
[S17] cosine check vs S7: cos=0.8250
[S17] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.269483)
[S16] loaded HEAD from S9 (vec_in norm=1.269483)
[S16] cosine check vs S9: cos=0.1232
[S16] BUFFERED delta from S9 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.983261)
[S5] loaded HEAD from S11 (vec_in norm=0.983261)
[S5] cosine check vs S11: cos=-0.0163
[S5] DROPPED delta from S11 (cos=-0.0163 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S13
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.814298)
[S8] loaded HEAD from S13 (vec_in norm=0.814298)
[S8] cosine check vs S13: cos=0.8602
[S8] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.257419)
[S7] loaded HEAD from S16 (vec_in norm=1.257419)
[S7] cosine check vs S16: cos=-0.0361
[S7] DROPPED delta from S16 (cos=-0.0361 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S2
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.283411)
[S14] loaded HEAD from S2 (vec_in norm=1.283411)
[S14] cosine check vs S2: cos=0.7005
[S14] BUFFERED delta from S2 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1793) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.939199)
[S15] loaded HEAD from S5 (vec_in norm=0.939199)
[S15] cosine check vs S5: cos=-0.0620
[S15] DROPPED delta from S5 (cos=-0.0620 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.887070)
[S17] loaded HEAD from S10 (vec_in norm=0.887070)
[S17] cosine check vs S10: cos=0.5661
[S17] BUFFERED delta from S10 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1787) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.853620)
[S6] loaded HEAD from S3 (vec_in norm=0.853620)
[S6] cosine check vs S3: cos=0.5601
[S6] BUFFERED delta from S3 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=4 metric=0.1414 head_norm=0.763043
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.812191e-01
[S6] stored merged vector for next round verification (round=4)
[S6] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.714229 delta_norm=0.381219
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.1400 head_norm=0.784713
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.118932e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.1400 head_norm=0.771057 delta_norm=0.211893
[S8] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=4 metric=0.1404 head_norm=0.918862
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.580324e-01
[S14] stored merged vector for next round verification (round=4)
[S14] DEBUG after merge:  round=4 metric=0.1474 head_norm=1.017807 delta_norm=0.458032
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=1.257419
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.365449e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.946856 delta_norm=0.836545
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.1409 head_norm=0.755051
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.920248e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.1409 head_norm=0.805444 delta_norm=0.292025
[S17] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.283411 (no previous merge yet)
[S2] round=5 local utility u=0.882281 metrics={'f1_val': 0.4160938496492347, 'auprc': 0.7670866970009467, 'loss_val': 1.1185444252821677, 'psi': 0.5564909885899194}-{'f1_val': 0.1417771333885667, 'auprc': 0.7509702086730019, 'loss_val': 1.1888556872397604, 'psi': 0.3854543635023408}
[S3] START round=5 head_norm_before_train=0.853620 cos_to_last_merge=0.9692 (last merge round=1)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8541117055929883, 'loss_val': 1.1838465767741997, 'psi': 0.4255487216056596}-{'f1_val': 0.13984006561410703, 'auprc': 0.9989371246066625, 'loss_val': 1.257385823227794, 'psi': 0.48347888921112925}
[S4] START round=5 head_norm_before_train=0.808500 cos_to_last_merge=0.9953 (last merge round=3)
[S4] round=5 local utility u=0.043602 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7944165630615707, 'loss_val': 1.2053384237478517, 'psi': 0.40190260256173876}-{'f1_val': 0.14022662889518414, 'auprc': 0.7940209389804426, 'loss_val': 1.291356537108109, 'psi': 0.4017443529292875}
[S5] START round=5 head_norm_before_train=0.939199 cos_to_last_merge=0.9945 (last merge round=2)
[S5] round=5 local utility u=0.031375 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7700846199060994, 'loss_val': 1.1646438285065395, 'psi': 0.3933909908195827}-{'f1_val': 0.14226190476190476, 'auprc': 0.7696472456385313, 'loss_val': 1.2260810001596942, 'psi': 0.39321604111255537}
[S6] START round=5 head_norm_before_train=0.714229 cos_to_last_merge=1.0000 (last merge round=4)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8628897032868313, 'loss_val': 1.2912741940099468, 'psi': 0.4300116505455018}-{'f1_val': 0.14142628205128205, 'auprc': 0.8616075262486854, 'loss_val': 1.2870192387182933, 'psi': 0.4294987797302434}
[S7] START round=5 head_norm_before_train=1.200421 (no previous merge yet)
[S7] round=5 local utility u=0.021266 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778405587598207, 'loss_val': 1.1746507013975462, 'psi': 0.3963703171413833}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776582854977021, 'loss_val': 1.2166365439445839, 'psi': 0.39629740783653583}
[S8] START round=5 head_norm_before_train=0.771057 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.038936 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7324297146291043, 'loss_val': 1.2638052246147293, 'psi': 0.37694547528741607}-{'f1_val': 0.13995598239295717, 'auprc': 0.7153652835288935, 'loss_val': 1.290483197568601, 'psi': 0.37011970284733176}
[S9] START round=5 head_norm_before_train=1.269483 (no previous merge yet)
[S9] round=5 local utility u=1.000000 metrics={'f1_val': 0.41697558078303143, 'auprc': 0.9945705990382625, 'loss_val': 0.8585242724976411, 'psi': 0.6480135880851239}-{'f1_val': 0.141397957139996, 'auprc': 0.8662495736047743, 'loss_val': 1.0402681714582407, 'psi': 0.4313386037259073}
[S10] START round=5 head_norm_before_train=0.887070 cos_to_last_merge=0.9873 (last merge round=2)
[S10] round=5 local utility u=0.047037 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6079239109649589, 'loss_val': 1.2223269593904702, 'psi': 0.32634254691101794}-{'f1_val': 0.13862163754172394, 'auprc': 0.5920715680844153, 'loss_val': 1.2688439299526038, 'psi': 0.3200016097588005}
[S11] START round=5 head_norm_before_train=0.983261 cos_to_last_merge=0.9886 (last merge round=2)
[S11] round=5 local utility u=0.049047 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5965983662340707, 'loss_val': 1.0995284908547793, 'psi': 0.3228875565174946}-{'f1_val': 0.14041368337311058, 'auprc': 0.5915853283162271, 'loss_val': 1.182583747497627, 'psi': 0.3208823413503572}
[S13] START round=5 head_norm_before_train=0.814298 cos_to_last_merge=0.9766 (last merge round=1)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5539370575804575, 'loss_val': 1.2339156091501629, 'psi': 0.30580628057841486}-{'f1_val': 0.1403857625770531, 'auprc': 0.5667933644495468, 'loss_val': 1.2661485736807405, 'psi': 0.31094880332605057}
[S14] START round=5 head_norm_before_train=1.017807 cos_to_last_merge=1.0000 (last merge round=4)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6679785506010987, 'loss_val': 1.3102738650458652, 'psi': 0.3514061319700617}-{'f1_val': 0.14035785288270378, 'auprc': 0.6948275173333198, 'loss_val': 1.3106504766653084, 'psi': 0.3621457186629502}
[S15] START round=5 head_norm_before_train=0.834963 cos_to_last_merge=0.9976 (last merge round=3)
[S15] round=5 local utility u=0.034153 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770350193882597, 'loss_val': 1.1733126736337725, 'psi': 0.3946541985722389}-{'f1_val': 0.13973365136155833, 'auprc': 0.7768774867246958, 'loss_val': 1.2411453933993395, 'psi': 0.3945911855068133}
[S16] START round=5 head_norm_before_train=0.946856 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.015729 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8111183101028769, 'loss_val': 1.159344714433088, 'psi': 0.40882979416067267}-{'f1_val': 0.14063745019920318, 'auprc': 0.8125747719486485, 'loss_val': 1.1951721177107741, 'psi': 0.4094123788989813}
[S17] START round=5 head_norm_before_train=0.805444 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.045355 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5756118561182793, 'loss_val': 1.2279281931113388, 'psi': 0.3148141204377424}-{'f1_val': 0.14094896331738438, 'auprc': 0.5627283917518487, 'loss_val': 1.2799875430827383, 'psi': 0.30966073469117017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:63514
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:63516
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1794) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.962003)
[S15] loaded HEAD from S5 (vec_in norm=0.962003)
[S15] cosine check vs S5: cos=-0.0518
[S15] DROPPED delta from S5 (cos=-0.0518 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.020019)
[S5] loaded HEAD from S11 (vec_in norm=1.020019)
[S5] cosine check vs S11: cos=-0.0059
[S5] DROPPED delta from S11 (cos=-0.0059 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.218800)
[S17] loaded HEAD from S7 (vec_in norm=1.218800)
[S17] cosine check vs S7: cos=0.9201
[S17] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.839345)
[S16] loaded HEAD from S4 (vec_in norm=0.839345)
[S16] cosine check vs S4: cos=0.0876
[S16] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1788) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.979146)
[S7] loaded HEAD from S16 (vec_in norm=0.979146)
[S7] cosine check vs S16: cos=-0.0305
[S7] DROPPED delta from S16 (cos=-0.0305 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1793) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.913225)
[S17] loaded HEAD from S10 (vec_in norm=0.913225)
[S17] cosine check vs S10: cos=0.7417
[S17] BUFFERED delta from S10 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.300157)
[S16] loaded HEAD from S9 (vec_in norm=1.300157)
[S16] cosine check vs S9: cos=0.7354
[S16] BUFFERED delta from S9 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1791) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.800216)
[S15] loaded HEAD from S8 (vec_in norm=0.800216)
[S15] cosine check vs S8: cos=0.6832
[S15] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S2
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.306110)
[S14] loaded HEAD from S2 (vec_in norm=1.306110)
[S14] cosine check vs S2: cos=0.9282
[S14] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.870367)
[S4] loaded HEAD from S15 (vec_in norm=0.870367)
[S4] cosine check vs S15: cos=0.6540
[S4] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1793 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1793) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.830092)
[S13] loaded HEAD from S17 (vec_in norm=0.830092)
[S13] cosine check vs S17: cos=0.2220
[S13] BUFFERED delta from S17 (total buffered=1)
[S8] ⇄ pheromone p=0.358 → S15@127.0.0.1:63515
[S9] ⇄ pheromone p=0.546 → S16@127.0.0.1:63516
[S7] ⇄ pheromone p=0.337 → S17@127.0.0.1:63517
[S2] ⇄ pheromone p=0.547 → S14@127.0.0.1:63514
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.1397 head_norm=0.870367
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.339745e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.1397 head_norm=0.766422 delta_norm=0.333974
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.345 → S4@127.0.0.1:63504
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.1404 head_norm=0.842754
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.216907e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.653821 delta_norm=0.521691
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.334 → S8@127.0.0.1:63509
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.979146
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.826779e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.2011 head_norm=0.806575 delta_norm=0.382678
[S16] aggregate: ACCEPT kept=['S4', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.342 → S7@127.0.0.1:63508
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=1.026045
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.602125e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.2917 head_norm=1.145266 delta_norm=0.260213
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.399 → S8@127.0.0.1:63509
[S3] ⇄ pheromone p=0.358 → S6@127.0.0.1:63507
[S6] ⇄ pheromone p=0.384 → S15@127.0.0.1:63515
[S5] ⇄ pheromone p=0.343 → S15@127.0.0.1:63515
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.1402 head_norm=0.839345
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.558568e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.1402 head_norm=0.777422 delta_norm=0.355857
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.336 → S16@127.0.0.1:63516
[S10] ⇄ pheromone p=0.376 → S17@127.0.0.1:63517
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.1409 head_norm=0.830092
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.708075e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.1409 head_norm=0.880757 delta_norm=0.170808
[S17] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.347 → S13@127.0.0.1:63513
[S11] ⇄ pheromone p=0.431 → S5@127.0.0.1:63505
[S2] START round=6 head_norm_before_train=1.306110 (no previous merge yet)
[S2] round=6 local utility u=0.063156 metrics={'f1_val': 0.4168984104266471, 'auprc': 0.7759288274240432, 'loss_val': 1.0235867757416461, 'psi': 0.5605105772256056}-{'f1_val': 0.4160938496492347, 'auprc': 0.7670866970009467, 'loss_val': 1.1185444252821677, 'psi': 0.5564909885899194}
[S3] START round=6 head_norm_before_train=0.902416 cos_to_last_merge=0.9529 (last merge round=1)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7973812830834306, 'loss_val': 1.063657202571218, 'psi': 0.4028565526018365}-{'f1_val': 0.13984006561410703, 'auprc': 0.8541117055929883, 'loss_val': 1.1838465767741997, 'psi': 0.4255487216056596}
[S4] START round=6 head_norm_before_train=0.777422 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.010564 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7938000582745803, 'loss_val': 1.1823604121285625, 'psi': 0.4016560006469426}-{'f1_val': 0.14022662889518414, 'auprc': 0.7944165630615707, 'loss_val': 1.2053384237478517, 'psi': 0.40190260256173876}
[S5] START round=6 head_norm_before_train=0.962003 cos_to_last_merge=0.9892 (last merge round=2)
[S5] round=6 local utility u=0.879554 metrics={'f1_val': 0.41694544507090897, 'auprc': 0.7760151003766618, 'loss_val': 1.0714292374080718, 'psi': 0.5605733071932102}-{'f1_val': 0.14226190476190476, 'auprc': 0.7700846199060994, 'loss_val': 1.1646438285065395, 'psi': 0.3933909908195827}
[S6] START round=6 head_norm_before_train=0.732900 cos_to_last_merge=0.9965 (last merge round=4)
[S6] round=6 local utility u=0.024182 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8639832526009458, 'loss_val': 1.2461918235125418, 'psi': 0.43044907027114754}-{'f1_val': 0.14142628205128205, 'auprc': 0.8628897032868313, 'loss_val': 1.2912741940099468, 'psi': 0.4300116505455018}
[S7] START round=6 head_norm_before_train=1.218800 (no previous merge yet)
[S7] round=6 local utility u=0.857372 metrics={'f1_val': 0.41626420531236646, 'auprc': 0.7778817114699947, 'loss_val': 1.105275222649573, 'psi': 0.5609112077754178}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778405587598207, 'loss_val': 1.1746507013975462, 'psi': 0.3963703171413833}
[S8] START round=6 head_norm_before_train=0.800216 cos_to_last_merge=0.9968 (last merge round=4)
[S8] round=6 local utility u=0.084195 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.766016953599269, 'loss_val': 1.1961770468038524, 'psi': 0.39038037087548194}-{'f1_val': 0.13995598239295717, 'auprc': 0.7324297146291043, 'loss_val': 1.2638052246147293, 'psi': 0.37694547528741607}
[S9] START round=6 head_norm_before_train=1.300157 (no previous merge yet)
[S9] round=6 local utility u=0.169926 metrics={'f1_val': 0.4365487798630441, 'auprc': 0.9999486400232003, 'loss_val': 0.6522447044155075, 'psi': 0.6619087239271066}-{'f1_val': 0.41697558078303143, 'auprc': 0.9945705990382625, 'loss_val': 0.8585242724976411, 'psi': 0.6480135880851239}
[S10] START round=6 head_norm_before_train=0.913225 cos_to_last_merge=0.9765 (last merge round=2)
[S10] round=6 local utility u=0.042904 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6073765824105813, 'loss_val': 1.134876728943481, 'psi': 0.32612361548926694}-{'f1_val': 0.13862163754172394, 'auprc': 0.6079239109649589, 'loss_val': 1.2223269593904702, 'psi': 0.32634254691101794}
[S11] START round=6 head_norm_before_train=1.020019 cos_to_last_merge=0.9793 (last merge round=2)
[S11] round=6 local utility u=0.839176 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.604331975172567, 'loss_val': 0.9812079672621578, 'psi': 0.4796641316247505}-{'f1_val': 0.14041368337311058, 'auprc': 0.5965983662340707, 'loss_val': 1.0995284908547793, 'psi': 0.3228875565174946}
[S13] START round=6 head_norm_before_train=0.653821 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5455205666560853, 'loss_val': 1.216786888232007, 'psi': 0.30243968420866596}-{'f1_val': 0.1403857625770531, 'auprc': 0.5539370575804575, 'loss_val': 1.2339156091501629, 'psi': 0.30580628057841486}
[S14] START round=6 head_norm_before_train=1.145266 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.085409 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7150213893444531, 'loss_val': 1.2805835827959733, 'psi': 0.3702232674674035}-{'f1_val': 0.14035785288270378, 'auprc': 0.6679785506010987, 'loss_val': 1.3102738650458652, 'psi': 0.3514061319700617}
[S15] START round=6 head_norm_before_train=0.766422 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.850393 metrics={'f1_val': 0.4115250909149176, 'auprc': 0.7812285452145591, 'loss_val': 1.1158558429449277, 'psi': 0.5594064726347743}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770350193882597, 'loss_val': 1.1733126736337725, 'psi': 0.3946541985722389}
[S16] START round=6 head_norm_before_train=0.806575 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.542731 metrics={'f1_val': 0.41526982732562534, 'auprc': 0.6038683619447656, 'loss_val': 1.0999278259606053, 'psi': 0.4907092411732814}-{'f1_val': 0.14063745019920318, 'auprc': 0.8111183101028769, 'loss_val': 1.159344714433088, 'psi': 0.40882979416067267}
[S17] START round=6 head_norm_before_train=0.880757 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.078270 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6006157597116695, 'loss_val': 1.1464004843968907, 'psi': 0.32481568187509846}-{'f1_val': 0.14094896331738438, 'auprc': 0.5756118561182793, 'loss_val': 1.2279281931113388, 'psi': 0.3148141204377424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:63516
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:63508
[S11] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.990339)
[S15] loaded HEAD from S5 (vec_in norm=0.990339)
[S15] cosine check vs S5: cos=-0.0358
[S15] DROPPED delta from S5 (cos=-0.0358 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1793) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.837423)
[S15] loaded HEAD from S8 (vec_in norm=0.837423)
[S15] cosine check vs S8: cos=0.8914
[S15] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.799108)
[S16] loaded HEAD from S4 (vec_in norm=0.799108)
[S16] cosine check vs S4: cos=0.3100
[S16] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.343091)
[S16] loaded HEAD from S9 (vec_in norm=1.343091)
[S16] cosine check vs S9: cos=0.8454
[S16] BUFFERED delta from S9 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.151238)
[S8] loaded HEAD from S14 (vec_in norm=1.151238)
[S8] cosine check vs S14: cos=0.0613
[S8] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.759860)
[S15] loaded HEAD from S6 (vec_in norm=0.759860)
[S15] cosine check vs S6: cos=0.1019
[S15] BUFFERED delta from S6 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1802) from S2
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.334753)
[S14] loaded HEAD from S2 (vec_in norm=1.334753)
[S14] cosine check vs S2: cos=0.9727
[S14] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.054919)
[S5] loaded HEAD from S11 (vec_in norm=1.054919)
[S5] cosine check vs S11: cos=-0.0001
[S5] DROPPED delta from S11 (cos=-0.0001 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1793) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.838096)
[S7] loaded HEAD from S16 (vec_in norm=0.838096)
[S7] cosine check vs S16: cos=0.0914
[S7] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.245569)
[S17] loaded HEAD from S7 (vec_in norm=1.245569)
[S17] cosine check vs S7: cos=0.9245
[S17] BUFFERED delta from S7 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1803) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.797619)
[S4] loaded HEAD from S15 (vec_in norm=0.797619)
[S4] cosine check vs S15: cos=0.7715
[S4] BUFFERED delta from S15 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.946488)
[S17] loaded HEAD from S10 (vec_in norm=0.946488)
[S17] cosine check vs S10: cos=0.7842
[S17] BUFFERED delta from S10 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1788 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1788) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.906980)
[S13] loaded HEAD from S17 (vec_in norm=0.906980)
[S13] cosine check vs S17: cos=0.7590
[S13] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.1404 head_norm=0.681082
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.953053e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.745679 delta_norm=0.295305
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=1.151238
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.715567e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1471 head_norm=1.234514 delta_norm=0.171557
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.1402 head_norm=0.799108
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.698751e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.1402 head_norm=0.751367 delta_norm=0.269875
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4153 head_norm=0.838096
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.173418e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.4168 head_norm=0.791725 delta_norm=0.217342
[S16] aggregate: ACCEPT kept=['S4', 'S9'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.1400 head_norm=0.837423
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.907357e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.1400 head_norm=0.732255 delta_norm=0.690736
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.4163 head_norm=1.245569
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.181606e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.4167 head_norm=0.781773 delta_norm=0.718161
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.4115 head_norm=0.797619
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.879460e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.1640 head_norm=0.641477 delta_norm=0.287946
[S15] aggregate: ROLLBACK (f1_val pre=0.412 post=0.164 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.1409 head_norm=0.906980
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.222089e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.1409 head_norm=0.934726 delta_norm=0.122209
[S17] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.334753 (no previous merge yet)
[S2] round=7 local utility u=0.565932 metrics={'f1_val': 0.5817930833397007, 'auprc': 0.7778435624005937, 'loss_val': 0.8868342668280801, 'psi': 0.6602132749640579}-{'f1_val': 0.4168984104266471, 'auprc': 0.7759288274240432, 'loss_val': 1.0235867757416461, 'psi': 0.5605105772256056}
[S3] START round=7 head_norm_before_train=0.954643 cos_to_last_merge=0.9369 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=7 local utility u=0.846731 metrics={'f1_val': 0.39160370528504335, 'auprc': 0.7970011176980732, 'loss_val': 0.8796362123297689, 'psi': 0.5537626702502554}-{'f1_val': 0.13984006561410703, 'auprc': 0.7973812830834306, 'loss_val': 1.063657202571218, 'psi': 0.4028565526018365}
[S4] START round=7 head_norm_before_train=0.751367 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.028783 metrics={'f1_val': 0.14159059035220026, 'auprc': 0.7872438383380119, 'loss_val': 1.11330938797056, 'psi': 0.39985188954652495}-{'f1_val': 0.14022662889518414, 'auprc': 0.7938000582745803, 'loss_val': 1.1823604121285625, 'psi': 0.4016560006469426}
[S5] START round=7 head_norm_before_train=0.990339 cos_to_last_merge=0.9816 (last merge round=2)
[S5] round=7 local utility u=0.063227 metrics={'f1_val': 0.41916201189878316, 'auprc': 0.7778222619350593, 'loss_val': 0.9636970919509635, 'psi': 0.5626261119132936}-{'f1_val': 0.41694544507090897, 'auprc': 0.7760151003766618, 'loss_val': 1.0714292374080718, 'psi': 0.5605733071932102}
[S6] START round=7 head_norm_before_train=0.759860 cos_to_last_merge=0.9860 (last merge round=4)
[S6] round=7 local utility u=0.026970 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.863197746325123, 'loss_val': 1.18989597031102, 'psi': 0.43013486776081844}-{'f1_val': 0.14142628205128205, 'auprc': 0.8639832526009458, 'loss_val': 1.2461918235125418, 'psi': 0.43044907027114754}
[S7] START round=7 head_norm_before_train=0.781773 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.007827 metrics={'f1_val': 0.4168747328879592, 'auprc': 0.776490980857653, 'loss_val': 1.0891129471087688, 'psi': 0.5607212320758368}-{'f1_val': 0.41626420531236646, 'auprc': 0.7778817114699947, 'loss_val': 1.105275222649573, 'psi': 0.5609112077754178}
[S8] START round=7 head_norm_before_train=0.732255 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.012150 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7658342011790061, 'loss_val': 1.1713292748327184, 'psi': 0.3903072699073768}-{'f1_val': 0.13995598239295717, 'auprc': 0.766016953599269, 'loss_val': 1.1961770468038524, 'psi': 0.39038037087548194}
[S9] START round=7 head_norm_before_train=1.343091 (no previous merge yet)
[S9] round=7 local utility u=0.879616 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9993988137359899, 'loss_val': 0.48175980251804335, 'psi': 0.820728434925333}-{'f1_val': 0.4365487798630441, 'auprc': 0.9999486400232003, 'loss_val': 0.6522447044155075, 'psi': 0.6619087239271066}
[S10] START round=7 head_norm_before_train=0.946488 cos_to_last_merge=0.9619 (last merge round=2)
[S10] round=7 local utility u=0.906816 metrics={'f1_val': 0.4167489431456496, 'auprc': 0.6061888942859072, 'loss_val': 0.9864461850493887, 'psi': 0.4925249236017526}-{'f1_val': 0.13862163754172394, 'auprc': 0.6073765824105813, 'loss_val': 1.134876728943481, 'psi': 0.32612361548926694}
[S11] START round=7 head_norm_before_train=1.054919 cos_to_last_merge=0.9692 (last merge round=2)
[S11] round=7 local utility u=0.601923 metrics={'f1_val': 0.396484976660716, 'auprc': 0.9540449364114577, 'loss_val': 0.8260975609766217, 'psi': 0.6195089605610127}-{'f1_val': 0.39655223592620625, 'auprc': 0.604331975172567, 'loss_val': 0.9812079672621578, 'psi': 0.4796641316247505}
[S13] START round=7 head_norm_before_train=0.745679 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.836516 metrics={'f1_val': 0.41607788054795825, 'auprc': 0.5382318155776827, 'loss_val': 1.176042231214609, 'psi': 0.46493945455984803}-{'f1_val': 0.1403857625770531, 'auprc': 0.5455205666560853, 'loss_val': 1.216786888232007, 'psi': 0.30243968420866596}
[S14] START round=7 head_norm_before_train=1.234514 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.193892 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8302918991671696, 'loss_val': 1.238611456918249, 'psi': 0.4163314713964901}-{'f1_val': 0.14035785288270378, 'auprc': 0.7150213893444531, 'loss_val': 1.2805835827959733, 'psi': 0.3702232674674035}
[S15] START round=7 head_norm_before_train=0.641477 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.089891 metrics={'f1_val': 0.4167593395843331, 'auprc': 0.7997574939519023, 'loss_val': 1.02306579622546, 'psi': 0.5699586013313608}-{'f1_val': 0.4115250909149176, 'auprc': 0.7812285452145591, 'loss_val': 1.1158558429449277, 'psi': 0.5594064726347743}
[S16] START round=7 head_norm_before_train=0.791725 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.239381 metrics={'f1_val': 0.41719231679200464, 'auprc': 0.732442043226808, 'loss_val': 1.0184219524121068, 'psi': 0.5432922073659259}-{'f1_val': 0.41526982732562534, 'auprc': 0.6038683619447656, 'loss_val': 1.0999278259606053, 'psi': 0.4907092411732814}
[S17] START round=7 head_norm_before_train=0.934726 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.884315 metrics={'f1_val': 0.38623779854620977, 'auprc': 0.6724962951016953, 'loss_val': 1.065145722806598, 'psi': 0.5007411971684039}-{'f1_val': 0.14094896331738438, 'auprc': 0.6006157597116695, 'loss_val': 1.1464004843968907, 'psi': 0.32481568187509846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:63513
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.781143)
[S15] loaded HEAD from S6 (vec_in norm=0.781143)
[S15] cosine check vs S6: cos=0.3721
[S15] BUFFERED delta from S6 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.101518)
[S5] loaded HEAD from S11 (vec_in norm=1.101518)
[S5] cosine check vs S11: cos=-0.0035
[S5] DROPPED delta from S11 (cos=-0.0035 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.822918)
[S7] loaded HEAD from S16 (vec_in norm=0.822918)
[S7] cosine check vs S16: cos=0.5965
[S7] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S2
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.365376)
[S14] loaded HEAD from S2 (vec_in norm=1.365376)
[S14] cosine check vs S2: cos=0.9836
[S14] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1789) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.009688)
[S6] loaded HEAD from S3 (vec_in norm=1.009688)
[S6] cosine check vs S3: cos=0.8066
[S6] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1794) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.391026)
[S16] loaded HEAD from S9 (vec_in norm=1.391026)
[S16] cosine check vs S9: cos=0.8681
[S16] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1795) from S13
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.769664)
[S8] loaded HEAD from S13 (vec_in norm=0.769664)
[S8] cosine check vs S13: cos=0.3161
[S8] BUFFERED delta from S13 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.991490)
[S17] loaded HEAD from S10 (vec_in norm=0.991490)
[S17] cosine check vs S10: cos=0.7895
[S17] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.246153)
[S8] loaded HEAD from S14 (vec_in norm=1.246153)
[S8] cosine check vs S14: cos=0.7844
[S8] BUFFERED delta from S14 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1803) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.816565)
[S17] loaded HEAD from S7 (vec_in norm=0.816565)
[S17] cosine check vs S7: cos=0.8093
[S17] BUFFERED delta from S7 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.763373)
[S15] loaded HEAD from S8 (vec_in norm=0.763373)
[S15] cosine check vs S8: cos=0.6562
[S15] BUFFERED delta from S8 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1798) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.769143)
[S16] loaded HEAD from S4 (vec_in norm=0.769143)
[S16] cosine check vs S4: cos=0.3931
[S16] BUFFERED delta from S4 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.021408)
[S15] loaded HEAD from S5 (vec_in norm=1.021408)
[S15] cosine check vs S5: cos=0.0646
[S15] BUFFERED delta from S5 (total buffered=3)
[S4] RECEIVED delta(kind=head bytes=1795) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.681813)
[S4] loaded HEAD from S15 (vec_in norm=0.681813)
[S4] cosine check vs S15: cos=0.8586
[S4] BUFFERED delta from S15 (total buffered=1)
[S17] sending update (kind=head size=1792 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1792) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.965519)
[S13] loaded HEAD from S17 (vec_in norm=0.965519)
[S13] cosine check vs S17: cos=0.9309
[S13] BUFFERED delta from S17 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.1414 head_norm=0.781143
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.988504e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.1414 head_norm=0.851772 delta_norm=0.298850
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.1400 head_norm=0.763373
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.244786e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.1400 head_norm=0.718584 delta_norm=0.224479
[S8] aggregate: ACCEPT kept=['S13', 'S14'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.1416 head_norm=0.769143
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.974330e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.1402 head_norm=0.699461 delta_norm=0.197433
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4161 head_norm=0.769664
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.877564e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.1844 head_norm=0.852673 delta_norm=0.187756
[S13] aggregate: ROLLBACK (f1_val pre=0.416 post=0.184 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.4169 head_norm=0.816565
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.682272e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.4171 head_norm=0.732390 delta_norm=0.368227
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.4168 head_norm=0.681813
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.211311e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.2290 head_norm=0.555196 delta_norm=0.321131
[S15] aggregate: ROLLBACK (f1_val pre=0.417 post=0.229 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1404 head_norm=1.246153
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.323319e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1404 head_norm=1.300408 delta_norm=0.132332
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3862 head_norm=0.965519
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.950877e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3883 head_norm=0.857317 delta_norm=0.195088
[S17] aggregate: ACCEPT kept=['S10', 'S7'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4172 head_norm=0.822918
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.512575e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4171 head_norm=0.802577 delta_norm=0.151257
[S16] aggregate: ACCEPT kept=['S9', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.365376 (no previous merge yet)
[S2] round=8 local utility u=0.399387 metrics={'f1_val': 0.6896435298122037, 'auprc': 0.7784075444502818, 'loss_val': 0.7368540509132384, 'psi': 0.7251491356674349}-{'f1_val': 0.5817930833397007, 'auprc': 0.7778435624005937, 'loss_val': 0.8868342668280801, 'psi': 0.6602132749640579}
[S3] START round=8 head_norm_before_train=1.009688 cos_to_last_merge=0.9213 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=8 local utility u=0.412752 metrics={'f1_val': 0.40310226040402647, 'auprc': 0.9978433085413454, 'loss_val': 0.7256506878109229, 'psi': 0.6409986796589541}-{'f1_val': 0.39160370528504335, 'auprc': 0.7970011176980732, 'loss_val': 0.8796362123297689, 'psi': 0.5537626702502554}
[S4] START round=8 head_norm_before_train=0.699461 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.720825 metrics={'f1_val': 0.36878382938157805, 'auprc': 0.7873435247059896, 'loss_val': 1.035117417900264, 'psi': 0.5362077075113426}-{'f1_val': 0.14159059035220026, 'auprc': 0.7872438383380119, 'loss_val': 1.11330938797056, 'psi': 0.39985188954652495}
[S5] START round=8 head_norm_before_train=1.021408 cos_to_last_merge=0.9718 (last merge round=2)
[S5] round=8 local utility u=0.984968 metrics={'f1_val': 0.7149202182934221, 'auprc': 0.7946002749905552, 'loss_val': 0.8186438920677906, 'psi': 0.7467922409722754}-{'f1_val': 0.41916201189878316, 'auprc': 0.7778222619350593, 'loss_val': 0.9636970919509635, 'psi': 0.5626261119132936}
[S6] START round=8 head_norm_before_train=0.851772 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.851671 metrics={'f1_val': 0.4148396098038316, 'auprc': 0.8653630689860481, 'loss_val': 1.1335308828037451, 'psi': 0.5950489934767182}-{'f1_val': 0.14142628205128205, 'auprc': 0.863197746325123, 'loss_val': 1.18989597031102, 'psi': 0.43013486776081844}
[S7] START round=8 head_norm_before_train=0.732390 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.021788 metrics={'f1_val': 0.4168747328879592, 'auprc': 0.7772815079750095, 'loss_val': 1.0479077162507102, 'psi': 0.5610374429227794}-{'f1_val': 0.4168747328879592, 'auprc': 0.776490980857653, 'loss_val': 1.0891129471087688, 'psi': 0.5607212320758368}
[S8] START round=8 head_norm_before_train=0.718584 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=1.000000 metrics={'f1_val': 0.7145897797924492, 'auprc': 0.7657583737296766, 'loss_val': 1.0916694162793183, 'psi': 0.7350572173673402}-{'f1_val': 0.13995598239295717, 'auprc': 0.7658342011790061, 'loss_val': 1.1713292748327184, 'psi': 0.3903072699073768}
[S9] START round=8 head_norm_before_train=1.391026 (no previous merge yet)
[S9] round=8 local utility u=0.056315 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9987365312865226, 'loss_val': 0.3666987757353691, 'psi': 0.8204190110357723}-{'f1_val': 0.7016148490515617, 'auprc': 0.9993988137359899, 'loss_val': 0.48175980251804335, 'psi': 0.820728434925333}
[S10] START round=8 head_norm_before_train=0.991490 cos_to_last_merge=0.9425 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=8 local utility u=0.299436 metrics={'f1_val': 0.37933666696668156, 'auprc': 0.8395327223796181, 'loss_val': 0.86313249913476, 'psi': 0.5634150891318561}-{'f1_val': 0.4167489431456496, 'auprc': 0.6061888942859072, 'loss_val': 0.9864461850493887, 'psi': 0.4925249236017526}
[S11] START round=8 head_norm_before_train=1.101518 cos_to_last_merge=0.9549 (last merge round=2)
[S11] round=8 local utility u=0.109525 metrics={'f1_val': 0.3907016764486894, 'auprc': 0.9984021179645712, 'loss_val': 0.7054187973653449, 'psi': 0.6337818530550422}-{'f1_val': 0.396484976660716, 'auprc': 0.9540449364114577, 'loss_val': 0.8260975609766217, 'psi': 0.6195089605610127}
[S13] START round=8 head_norm_before_train=0.852673 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.020480 metrics={'f1_val': 0.4160404975377924, 'auprc': 0.5219333155498577, 'loss_val': 1.085962170638502, 'psi': 0.45839762474261847}-{'f1_val': 0.41607788054795825, 'auprc': 0.5382318155776827, 'loss_val': 1.176042231214609, 'psi': 0.46493945455984803}
[S14] START round=8 head_norm_before_train=1.300408 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.095204 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8717769484031256, 'loss_val': 1.1726577832505491, 'psi': 0.4329254910908725}-{'f1_val': 0.14035785288270378, 'auprc': 0.8302918991671696, 'loss_val': 1.238611456918249, 'psi': 0.4163314713964901}
[S15] START round=8 head_norm_before_train=0.555196 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.048566 metrics={'f1_val': 0.4178289890384971, 'auprc': 0.7996701453179027, 'loss_val': 0.9320901649904433, 'psi': 0.5705654515502594}-{'f1_val': 0.4167593395843331, 'auprc': 0.7997574939519023, 'loss_val': 1.02306579622546, 'psi': 0.5699586013313608}
[S16] START round=8 head_norm_before_train=0.802577 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.036910 metrics={'f1_val': 0.4169627677417108, 'auprc': 0.7399649473122181, 'loss_val': 0.9657940709775621, 'psi': 0.5461636395699138}-{'f1_val': 0.41719231679200464, 'auprc': 0.732442043226808, 'loss_val': 1.0184219524121068, 'psi': 0.5432922073659259}
[S17] START round=8 head_norm_before_train=0.857317 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.184518 metrics={'f1_val': 0.39161774811033667, 'auprc': 0.7522121229816521, 'loss_val': 0.9675368262579793, 'psi': 0.5358554980588628}-{'f1_val': 0.38623779854620977, 'auprc': 0.6724962951016953, 'loss_val': 1.065145722806598, 'psi': 0.5007411971684039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:63508
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.068486)
[S6] loaded HEAD from S3 (vec_in norm=1.068486)
[S6] cosine check vs S3: cos=0.9428
[S6] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.765731)
[S17] loaded HEAD from S7 (vec_in norm=0.765731)
[S17] cosine check vs S7: cos=0.6239
[S17] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.837264)
[S7] loaded HEAD from S16 (vec_in norm=0.837264)
[S7] cosine check vs S16: cos=0.8429
[S7] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.154463)
[S5] loaded HEAD from S11 (vec_in norm=1.154463)
[S5] cosine check vs S11: cos=-0.0113
[S5] DROPPED delta from S11 (cos=-0.0113 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.314767)
[S8] loaded HEAD from S14 (vec_in norm=1.314767)
[S8] cosine check vs S14: cos=0.8244
[S8] BUFFERED delta from S14 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.042678)
[S17] loaded HEAD from S10 (vec_in norm=1.042678)
[S17] cosine check vs S10: cos=0.8129
[S17] BUFFERED delta from S10 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1799) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.874789)
[S15] loaded HEAD from S6 (vec_in norm=0.874789)
[S15] cosine check vs S6: cos=0.6233
[S15] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.745196)
[S15] loaded HEAD from S8 (vec_in norm=0.745196)
[S15] cosine check vs S8: cos=0.6373
[S15] BUFFERED delta from S8 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1796) from S13
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.879162)
[S8] loaded HEAD from S13 (vec_in norm=0.879162)
[S8] cosine check vs S13: cos=0.4092
[S8] BUFFERED delta from S13 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1796) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.724137)
[S16] loaded HEAD from S4 (vec_in norm=0.724137)
[S16] cosine check vs S4: cos=0.4127
[S16] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.438522)
[S16] loaded HEAD from S9 (vec_in norm=1.438522)
[S16] cosine check vs S9: cos=0.8708
[S16] BUFFERED delta from S9 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1802) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.601088)
[S4] loaded HEAD from S15 (vec_in norm=0.601088)
[S4] cosine check vs S15: cos=0.7994
[S4] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.058800)
[S15] loaded HEAD from S5 (vec_in norm=1.058800)
[S15] cosine check vs S5: cos=0.3273
[S15] BUFFERED delta from S5 (total buffered=3)
[S14] RECEIVED delta(kind=head bytes=1799) from S2
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.401536)
[S14] loaded HEAD from S2 (vec_in norm=1.401536)
[S14] cosine check vs S2: cos=0.9865
[S14] BUFFERED delta from S2 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1788 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1788) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.895429)
[S13] loaded HEAD from S17 (vec_in norm=0.895429)
[S13] cosine check vs S17: cos=0.9618
[S13] BUFFERED delta from S17 (total buffered=1)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4170 head_norm=0.837264
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.279505e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4281 head_norm=0.816044 delta_norm=0.127951
[S16] aggregate: ACCEPT kept=['S4', 'S9'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.4160 head_norm=0.879162
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.228522e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.4162 head_norm=0.878787 delta_norm=0.122852
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.4169 head_norm=0.765731
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.272347e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.4169 head_norm=0.769443 delta_norm=0.227235
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.1404 head_norm=1.314767
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.197595e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.1404 head_norm=1.353556 delta_norm=0.119759
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.7146 head_norm=0.745196
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.732779e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.7143 head_norm=0.753604 delta_norm=0.173278
[S8] aggregate: ACCEPT kept=['S14', 'S13'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.3688 head_norm=0.724137
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.178265e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.3688 head_norm=0.628802 delta_norm=0.217826
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.4178 head_norm=0.601088
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.912920e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.1672 head_norm=0.568086 delta_norm=0.191292
[S15] aggregate: ROLLBACK (f1_val pre=0.418 post=0.167 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.4148 head_norm=0.874789
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.900205e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.4105 head_norm=0.957784 delta_norm=0.190020
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3916 head_norm=0.895429
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.023805e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3917 head_norm=0.796441 delta_norm=0.202380
[S17] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.401536 (no previous merge yet)
[S2] round=9 local utility u=0.131668 metrics={'f1_val': 0.7139516054926395, 'auprc': 0.7792174557008364, 'loss_val': 0.6217967607936126, 'psi': 0.7400579455759182}-{'f1_val': 0.6896435298122037, 'auprc': 0.7784075444502818, 'loss_val': 0.7368540509132384, 'psi': 0.7251491356674349}
[S3] START round=9 head_norm_before_train=1.068486 cos_to_last_merge=0.9034 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.903
[S3] round=9 local utility u=0.584646 metrics={'f1_val': 0.5743541622663907, 'auprc': 0.998295377381674, 'loss_val': 0.5852261926019666, 'psi': 0.743930648312504}-{'f1_val': 0.40310226040402647, 'auprc': 0.9978433085413454, 'loss_val': 0.7256506878109229, 'psi': 0.6409986796589541}
[S4] START round=9 head_norm_before_train=0.628802 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.4002279153492222, 'auprc': 0.6639958436759713, 'loss_val': 0.9396141833325198, 'psi': 0.5057350866799218}-{'f1_val': 0.36878382938157805, 'auprc': 0.7873435247059896, 'loss_val': 1.035117417900264, 'psi': 0.5362077075113426}
[S5] START round=9 head_norm_before_train=1.058800 cos_to_last_merge=0.9585 (last merge round=2)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.7487875527457688, 'loss_val': 0.6765282449468739, 'psi': 0.7200051364048217}-{'f1_val': 0.7149202182934221, 'auprc': 0.7946002749905552, 'loss_val': 0.8186438920677906, 'psi': 0.7467922409722754}
[S6] START round=9 head_norm_before_train=0.957784 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.060161 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.8650528504940379, 'loss_val': 1.0243718415153573, 'psi': 0.5961342517239356}-{'f1_val': 0.4148396098038316, 'auprc': 0.8653630689860481, 'loss_val': 1.1335308828037451, 'psi': 0.5950489934767182}
[S7] START round=9 head_norm_before_train=0.769443 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.015151 metrics={'f1_val': 0.41679099637737954, 'auprc': 0.7735550579436601, 'loss_val': 1.0059232274889562, 'psi': 0.5594966210038917}-{'f1_val': 0.4168747328879592, 'auprc': 0.7772815079750095, 'loss_val': 1.0479077162507102, 'psi': 0.5610374429227794}
[S8] START round=9 head_norm_before_train=0.753604 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.44166348694517715, 'auprc': 0.7658056778619382, 'loss_val': 0.973948075552654, 'psi': 0.5713203633118815}-{'f1_val': 0.7145897797924492, 'auprc': 0.7657583737296766, 'loss_val': 1.0916694162793183, 'psi': 0.7350572173673402}
[S9] START round=9 head_norm_before_train=1.438522 (no previous merge yet)
[S9] round=9 local utility u=0.025862 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9987358256650644, 'loss_val': 0.3149716693598277, 'psi': 0.8204187287871889}-{'f1_val': 0.7015406642019387, 'auprc': 0.9987365312865226, 'loss_val': 0.3666987757353691, 'psi': 0.8204190110357723}
[S10] START round=9 head_norm_before_train=1.042678 cos_to_last_merge=0.9222 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.922
[S10] round=9 local utility u=0.847310 metrics={'f1_val': 0.5803047895011015, 'auprc': 0.9600217601502492, 'loss_val': 0.7357884231538122, 'psi': 0.7321915777607606}-{'f1_val': 0.37933666696668156, 'auprc': 0.8395327223796181, 'loss_val': 0.86313249913476, 'psi': 0.5634150891318561}
[S11] START round=9 head_norm_before_train=1.154463 cos_to_last_merge=0.9382 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=9 local utility u=0.274461 metrics={'f1_val': 0.469283518474054, 'auprc': 0.9994433845130701, 'loss_val': 0.6311112286954537, 'psi': 0.6813474648896605}-{'f1_val': 0.3907016764486894, 'auprc': 0.9984021179645712, 'loss_val': 0.7054187973653449, 'psi': 0.6337818530550422}
[S13] START round=9 head_norm_before_train=0.878787 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.059831 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.5400564454867404, 'loss_val': 1.020449595414496, 'psi': 0.4656248979541732}-{'f1_val': 0.4160404975377924, 'auprc': 0.5219333155498577, 'loss_val': 1.085962170638502, 'psi': 0.45839762474261847}
[S14] START round=9 head_norm_before_train=1.353556 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=1.000000 metrics={'f1_val': 0.5373002658415462, 'auprc': 0.9991908436836152, 'loss_val': 1.056197672071665, 'psi': 0.7220564969783738}-{'f1_val': 0.14035785288270378, 'auprc': 0.8717769484031256, 'loss_val': 1.1726577832505491, 'psi': 0.4329254910908725}
[S15] START round=9 head_norm_before_train=0.568086 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.093753 metrics={'f1_val': 0.43689849513366374, 'auprc': 0.799615911422479, 'loss_val': 0.858839367774526, 'psi': 0.5819854616491899}-{'f1_val': 0.4178289890384971, 'auprc': 0.7996701453179027, 'loss_val': 0.9320901649904433, 'psi': 0.5705654515502594}
[S16] START round=9 head_norm_before_train=0.816044 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.020892 metrics={'f1_val': 0.42037441362354255, 'auprc': 0.7396619617682303, 'loss_val': 0.9435714321820581, 'psi': 0.5480894328814176}-{'f1_val': 0.4169627677417108, 'auprc': 0.7399649473122181, 'loss_val': 0.9657940709775621, 'psi': 0.5461636395699138}
[S17] START round=9 head_norm_before_train=0.796441 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.38992585602971463, 'auprc': 0.6970341879099066, 'loss_val': 0.9270014496707686, 'psi': 0.5127691887817915}-{'f1_val': 0.39161774811033667, 'auprc': 0.7522121229816521, 'loss_val': 0.9675368262579793, 'psi': 0.5358554980588628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:63508
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:63515
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:63505
[S2] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.098276)
[S17] loaded HEAD from S10 (vec_in norm=1.098276)
[S17] cosine check vs S10: cos=0.8226
[S17] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1792) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.854978)
[S7] loaded HEAD from S16 (vec_in norm=0.854978)
[S7] cosine check vs S16: cos=0.9213
[S7] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1793) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.127171)
[S6] loaded HEAD from S3 (vec_in norm=1.127171)
[S6] cosine check vs S3: cos=0.9719
[S6] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.798111)
[S17] loaded HEAD from S7 (vec_in norm=0.798111)
[S17] cosine check vs S7: cos=0.5621
[S17] BUFFERED delta from S7 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1802) from S2
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.444431)
[S14] loaded HEAD from S2 (vec_in norm=1.444431)
[S14] cosine check vs S2: cos=0.9876
[S14] BUFFERED delta from S2 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.485577)
[S16] loaded HEAD from S9 (vec_in norm=1.485577)
[S16] cosine check vs S9: cos=0.8784
[S16] BUFFERED delta from S9 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1793) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.986633)
[S15] loaded HEAD from S6 (vec_in norm=0.986633)
[S15] cosine check vs S6: cos=0.6879
[S15] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1792) from S13
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.908503)
[S8] loaded HEAD from S13 (vec_in norm=0.908503)
[S8] cosine check vs S13: cos=0.4984
[S8] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.614134)
[S4] loaded HEAD from S15 (vec_in norm=0.614134)
[S4] cosine check vs S15: cos=0.8268
[S4] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.367221)
[S8] loaded HEAD from S14 (vec_in norm=1.367221)
[S8] cosine check vs S14: cos=0.8208
[S8] BUFFERED delta from S14 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.204043)
[S5] loaded HEAD from S11 (vec_in norm=1.204043)
[S5] cosine check vs S11: cos=-0.0179
[S5] DROPPED delta from S11 (cos=-0.0179 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.4002 head_norm=0.665241
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.898465e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.4002 head_norm=0.611401 delta_norm=0.189847
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.4417 head_norm=0.786540
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.361105e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.3729 head_norm=0.798713 delta_norm=0.136110
[S8] aggregate: ROLLBACK (f1_val pre=0.442 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.4169 head_norm=0.986633
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.434558e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.4169 head_norm=1.049476 delta_norm=0.143456
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.4204 head_norm=0.854978
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.203027e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.4128 head_norm=1.136798 delta_norm=0.420303
[S16] aggregate: ROLLBACK (f1_val pre=0.420 post=0.413 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.5373 head_norm=1.367221
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.170087e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.4463 head_norm=1.401480 delta_norm=0.117009
[S14] aggregate: ROLLBACK (f1_val pre=0.537 post=0.446 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4168 head_norm=0.798111
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.663395e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4168 head_norm=0.810133 delta_norm=0.166339
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.4369 head_norm=0.614134
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.595130e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.1683 head_norm=0.738954 delta_norm=0.359513
[S15] aggregate: ROLLBACK (f1_val pre=0.437 post=0.168 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3899 head_norm=0.841203
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.769983e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3840 head_norm=0.774595 delta_norm=0.176998
[S17] aggregate: ROLLBACK (f1_val pre=0.390 post=0.384 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=1.444431 (no previous merge yet)
[S2] round=10 local utility u=0.054968 metrics={'f1_val': 0.7001914061315861, 'auprc': 0.7944284653034406, 'loss_val': 0.47493311199999916, 'psi': 0.7378862298003279}-{'f1_val': 0.7139516054926395, 'auprc': 0.7792174557008364, 'loss_val': 0.6217967607936126, 'psi': 0.7400579455759182}
[S3] START round=10 head_norm_before_train=1.127171 cos_to_last_merge=0.8846 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.885
[S3] round=10 local utility u=0.407031 metrics={'f1_val': 0.6940226410609599, 'auprc': 0.9981516452128839, 'loss_val': 0.48874479156716966, 'psi': 0.8156742427217295}-{'f1_val': 0.5743541622663907, 'auprc': 0.998295377381674, 'loss_val': 0.5852261926019666, 'psi': 0.743930648312504}
[S4] START round=10 head_norm_before_train=0.611401 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.033665 metrics={'f1_val': 0.4013373648417855, 'auprc': 0.6616321563762446, 'loss_val': 0.8718503890877431, 'psi': 0.5054552814555692}-{'f1_val': 0.4002279153492222, 'auprc': 0.6639958436759713, 'loss_val': 0.9396141833325198, 'psi': 0.5057350866799218}
[S5] START round=10 head_norm_before_train=1.102365 cos_to_last_merge=0.9434 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.943
[S5] round=10 local utility u=0.144418 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.7953165259199281, 'loss_val': 0.5257893932676767, 'psi': 0.7384677163707623}-{'f1_val': 0.7008168588441903, 'auprc': 0.7487875527457688, 'loss_val': 0.6765282449468739, 'psi': 0.7200051364048217}
[S6] START round=10 head_norm_before_train=1.049476 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.273285 metrics={'f1_val': 0.41661253849481683, 'auprc': 0.9886444572032478, 'loss_val': 0.8471209935265102, 'psi': 0.6454253059781891}-{'f1_val': 0.4168551858772006, 'auprc': 0.8650528504940379, 'loss_val': 1.0243718415153573, 'psi': 0.5961342517239356}
[S7] START round=10 head_norm_before_train=0.810133 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.007090 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7727850100041961, 'loss_val': 0.9889475407629497, 'psi': 0.5591400748682924}-{'f1_val': 0.41679099637737954, 'auprc': 0.7735550579436601, 'loss_val': 1.0059232274889562, 'psi': 0.5594966210038917}
[S8] START round=10 head_norm_before_train=0.798713 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.690861 metrics={'f1_val': 0.5348815352525744, 'auprc': 0.997615327271392, 'loss_val': 0.8469623695416599, 'psi': 0.7199750520601015}-{'f1_val': 0.44166348694517715, 'auprc': 0.7658056778619382, 'loss_val': 0.973948075552654, 'psi': 0.5713203633118815}
[S9] START round=10 head_norm_before_train=1.485577 (no previous merge yet)
[S9] round=10 local utility u=0.009660 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9985038280815848, 'loss_val': 0.2934551676633559, 'psi': 0.8201758213571719}-{'f1_val': 0.7015406642019387, 'auprc': 0.9987358256650644, 'loss_val': 0.3149716693598277, 'psi': 0.8204187287871889}
[S10] START round=10 head_norm_before_train=1.098276 cos_to_last_merge=0.8992 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.899
[S10] round=10 local utility u=0.403741 metrics={'f1_val': 0.6953117373974806, 'auprc': 0.9824611545537912, 'loss_val': 0.6856654313392214, 'psi': 0.8101715042600048}-{'f1_val': 0.5803047895011015, 'auprc': 0.9600217601502492, 'loss_val': 0.7357884231538122, 'psi': 0.7321915777607606}
[S11] START round=10 head_norm_before_train=1.204043 cos_to_last_merge=0.9217 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.922
[S11] round=10 local utility u=0.209793 metrics={'f1_val': 0.5287807507029675, 'auprc': 0.9984903652995314, 'loss_val': 0.5656496007057102, 'psi': 0.716664596541593}-{'f1_val': 0.469283518474054, 'auprc': 0.9994433845130701, 'loss_val': 0.6311112286954537, 'psi': 0.6813474648896605}
[S13] START round=10 head_norm_before_train=0.908503 cos_to_last_merge=0.9960 (last merge round=8)
[S13] round=10 local utility u=0.075840 metrics={'f1_val': 0.41542461814022946, 'auprc': 0.5596466902621813, 'loss_val': 0.9240642411614796, 'psi': 0.4731134469890102}-{'f1_val': 0.4160038662657951, 'auprc': 0.5400564454867404, 'loss_val': 1.020449595414496, 'psi': 0.4656248979541732}
[S14] START round=10 head_norm_before_train=1.401480 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.614400 metrics={'f1_val': 0.7130919261053962, 'auprc': 0.9991860780581063, 'loss_val': 0.8821343217790643, 'psi': 0.8275295868864803}-{'f1_val': 0.5373002658415462, 'auprc': 0.9991908436836152, 'loss_val': 1.056197672071665, 'psi': 0.7220564969783738}
[S15] START round=10 head_norm_before_train=0.738954 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.41895527537584065, 'auprc': 0.7981192102945168, 'loss_val': 0.8203047404773229, 'psi': 0.5706208493433111}-{'f1_val': 0.43689849513366374, 'auprc': 0.799615911422479, 'loss_val': 0.858839367774526, 'psi': 0.5819854616491899}
[S16] START round=10 head_norm_before_train=1.136798 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.3730959402999686, 'auprc': 0.7393230984979418, 'loss_val': 0.8703493593638542, 'psi': 0.5195868035791579}-{'f1_val': 0.42037441362354255, 'auprc': 0.7396619617682303, 'loss_val': 0.9435714321820581, 'psi': 0.5480894328814176}
[S17] START round=10 head_norm_before_train=0.774595 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.36922353188931584, 'auprc': 0.6222073020000239, 'loss_val': 0.9251040227613321, 'psi': 0.47041703993359907}-{'f1_val': 0.38992585602971463, 'auprc': 0.6970341879099066, 'loss_val': 0.9270014496707686, 'psi': 0.5127691887817915}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:63515
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:63517
[S8] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.250761)
[S5] loaded HEAD from S11 (vec_in norm=1.250761)
[S5] cosine check vs S11: cos=-0.0217
[S5] DROPPED delta from S11 (cos=-0.0217 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.836975)
[S17] loaded HEAD from S7 (vec_in norm=0.836975)
[S17] cosine check vs S7: cos=0.5633
[S17] BUFFERED delta from S7 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1789) from S13
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.946409)
[S8] loaded HEAD from S13 (vec_in norm=0.946409)
[S8] cosine check vs S13: cos=0.5510
[S8] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S2
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.486926)
[S14] loaded HEAD from S2 (vec_in norm=1.486926)
[S14] cosine check vs S2: cos=0.9884
[S14] BUFFERED delta from S2 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.832551)
[S15] loaded HEAD from S8 (vec_in norm=0.832551)
[S15] cosine check vs S8: cos=0.4876
[S15] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.428111)
[S8] loaded HEAD from S14 (vec_in norm=1.428111)
[S8] cosine check vs S14: cos=0.8155
[S8] BUFFERED delta from S14 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1802) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.150346)
[S15] loaded HEAD from S5 (vec_in norm=1.150346)
[S15] cosine check vs S5: cos=0.2234
[S15] BUFFERED delta from S5 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.177446)
[S6] loaded HEAD from S3 (vec_in norm=1.177446)
[S6] cosine check vs S3: cos=0.9805
[S6] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.082830)
[S15] loaded HEAD from S6 (vec_in norm=1.082830)
[S15] cosine check vs S6: cos=0.9062
[S15] BUFFERED delta from S6 (total buffered=3)
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.528043)
[S16] loaded HEAD from S9 (vec_in norm=1.528043)
[S16] cosine check vs S9: cos=0.9744
[S16] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1794) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.658218)
[S16] loaded HEAD from S4 (vec_in norm=0.658218)
[S16] cosine check vs S4: cos=0.1534
[S16] BUFFERED delta from S4 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1800) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.142753)
[S17] loaded HEAD from S10 (vec_in norm=1.142753)
[S17] cosine check vs S10: cos=0.8231
[S17] BUFFERED delta from S10 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.4190 head_norm=0.776666
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.984876e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.4512 head_norm=0.692665 delta_norm=0.198488
[S15] aggregate: ACCEPT kept=['S8', 'S5', 'S6'] (k=3/3) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.213 → S4@127.0.0.1:63504
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.7131 head_norm=1.428111
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.146102e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.7273 head_norm=1.453303 delta_norm=0.114610
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.453 → S8@127.0.0.1:63509
[S10] ⇄ pheromone p=0.474 → S17@127.0.0.1:63517
[S13] ⇄ pheromone p=0.222 → S8@127.0.0.1:63509
[S4] ⇄ pheromone p=0.213 → S16@127.0.0.1:63516
[S11] ⇄ pheromone p=0.372 → S5@127.0.0.1:63505
[S7] ⇄ pheromone p=0.188 → S17@127.0.0.1:63517
[S9] ⇄ pheromone p=0.296 → S16@127.0.0.1:63516
[S5] ⇄ pheromone p=0.346 → S15@127.0.0.1:63515
[S3] ⇄ pheromone p=0.432 → S6@127.0.0.1:63507
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.5349 head_norm=0.832551
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.099408e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3729 head_norm=0.844992 delta_norm=0.109941
[S8] aggregate: ROLLBACK (f1_val pre=0.535 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.392 → S15@127.0.0.1:63515
[S2] ⇄ pheromone p=0.325 → S14@127.0.0.1:63514
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.4166 head_norm=1.082830
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.210073e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.4166 head_norm=1.124637 delta_norm=0.121007
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.304 → S15@127.0.0.1:63515
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3731 head_norm=1.169873
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.315768e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3788 head_norm=0.991783 delta_norm=0.231577
[S16] aggregate: ACCEPT kept=['S9', 'S4'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.189 → S7@127.0.0.1:63508
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3692 head_norm=0.822500
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.529189e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3700 head_norm=0.777218 delta_norm=0.152919
[S17] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.234 → S13@127.0.0.1:63513
[S2] START round=11 head_norm_before_train=1.486926 (no previous merge yet)
[S2] round=11 local utility u=0.043785 metrics={'f1_val': 0.7075821801673605, 'auprc': 0.7938568351887252, 'loss_val': 0.4299923832900442, 'psi': 0.7420920421759064}-{'f1_val': 0.7001914061315861, 'auprc': 0.7944284653034406, 'loss_val': 0.47493311199999916, 'psi': 0.7378862298003279}
[S3] START round=11 head_norm_before_train=1.177446 cos_to_last_merge=0.8680 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.868
[S3] round=11 local utility u=0.062900 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9981267632791245, 'loss_val': 0.4022231063878811, 'psi': 0.8195995429069028}-{'f1_val': 0.6940226410609599, 'auprc': 0.9981516452128839, 'loss_val': 0.48874479156716966, 'psi': 0.8156742427217295}
[S4] START round=11 head_norm_before_train=0.658218 cos_to_last_merge=0.9873 (last merge round=9)
[S4] round=11 local utility u=0.745379 metrics={'f1_val': 0.531605015157511, 'auprc': 0.8541464630745369, 'loss_val': 0.740241524627497, 'psi': 0.6606215943243214}-{'f1_val': 0.4013373648417855, 'auprc': 0.6616321563762446, 'loss_val': 0.8718503890877431, 'psi': 0.5054552814555692}
[S5] START round=11 head_norm_before_train=1.150346 cos_to_last_merge=0.9284 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.928
[S5] round=11 local utility u=0.035409 metrics={'f1_val': 0.7044093743971336, 'auprc': 0.7952158267627738, 'loss_val': 0.4777146060604731, 'psi': 0.7407319553433898}-{'f1_val': 0.7005685100046517, 'auprc': 0.7953165259199281, 'loss_val': 0.5257893932676767, 'psi': 0.7384677163707623}
[S6] START round=11 head_norm_before_train=1.124637 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.057803 metrics={'f1_val': 0.4168135083356663, 'auprc': 0.9906531763773078, 'loss_val': 0.7387466369397722, 'psi': 0.6463493755523229}-{'f1_val': 0.41661253849481683, 'auprc': 0.9886444572032478, 'loss_val': 0.8471209935265102, 'psi': 0.6454253059781891}
[S7] START round=11 head_norm_before_train=0.836975 cos_to_last_merge=0.9933 (last merge round=9)
[S7] round=11 local utility u=0.039727 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7743231403416886, 'loss_val': 0.9141075838073921, 'psi': 0.5597553270032896}-{'f1_val': 0.41671011811102343, 'auprc': 0.7727850100041961, 'loss_val': 0.9889475407629497, 'psi': 0.5591400748682924}
[S8] START round=11 head_norm_before_train=0.844992 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.564620 metrics={'f1_val': 0.7011417569092661, 'auprc': 0.9950278188611846, 'loss_val': 0.7075212840542143, 'psi': 0.8186961816900336}-{'f1_val': 0.5348815352525744, 'auprc': 0.997615327271392, 'loss_val': 0.8469623695416599, 'psi': 0.7199750520601015}
[S9] START round=11 head_norm_before_train=1.528043 (no previous merge yet)
[S9] round=11 local utility u=0.005495 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9984618698972668, 'loss_val': 0.28233924373150243, 'psi': 0.8201590380834448}-{'f1_val': 0.7012904835408967, 'auprc': 0.9985038280815848, 'loss_val': 0.2934551676633559, 'psi': 0.8201758213571719}
[S10] START round=11 head_norm_before_train=1.142753 cos_to_last_merge=0.8806 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.881
[S10] round=11 local utility u=0.028354 metrics={'f1_val': 0.7015844573984173, 'auprc': 0.9672282234535325, 'loss_val': 0.6208941386617441, 'psi': 0.8078419638204635}-{'f1_val': 0.6953117373974806, 'auprc': 0.9824611545537912, 'loss_val': 0.6856654313392214, 'psi': 0.8101715042600048}
[S11] START round=11 head_norm_before_train=1.250761 cos_to_last_merge=0.9077 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.908
[S11] round=11 local utility u=0.556583 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9992666291925475, 'loss_val': 0.4941319711285486, 'psi': 0.8209071172445582}-{'f1_val': 0.5287807507029675, 'auprc': 0.9984903652995314, 'loss_val': 0.5656496007057102, 'psi': 0.716664596541593}
[S13] START round=11 head_norm_before_train=0.946409 cos_to_last_merge=0.9864 (last merge round=8)
[S13] round=11 local utility u=0.863239 metrics={'f1_val': 0.6304574649540933, 'auprc': 0.6750023447841973, 'loss_val': 0.8338501351219318, 'psi': 0.6482754168861349}-{'f1_val': 0.41542461814022946, 'auprc': 0.5596466902621813, 'loss_val': 0.9240642411614796, 'psi': 0.4731134469890102}
[S14] START round=11 head_norm_before_train=1.453303 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.946919 metrics={'f1_val': 0.9976985674416128, 'auprc': 0.997424660445591, 'loss_val': 0.6906522645304929, 'psi': 0.9975890046432041}-{'f1_val': 0.7130919261053962, 'auprc': 0.9991860780581063, 'loss_val': 0.8821343217790643, 'psi': 0.8275295868864803}
[S15] START round=11 head_norm_before_train=0.692665 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.735430 metrics={'f1_val': 0.6999510323111611, 'auprc': 0.7174756885984415, 'loss_val': 0.7934877960960346, 'psi': 0.7069608948260733}-{'f1_val': 0.41895527537584065, 'auprc': 0.7981192102945168, 'loss_val': 0.8203047404773229, 'psi': 0.5706208493433111}
[S16] START round=11 head_norm_before_train=0.991783 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.032262 metrics={'f1_val': 0.38390558502381084, 'auprc': 0.737035769735654, 'loss_val': 0.8638218207068297, 'psi': 0.525157658908548}-{'f1_val': 0.3730959402999686, 'auprc': 0.7393230984979418, 'loss_val': 0.8703493593638542, 'psi': 0.5195868035791579}
[S17] START round=11 head_norm_before_train=0.777218 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.020239 metrics={'f1_val': 0.43932444437545254, 'auprc': 0.4958066167470412, 'loss_val': 0.9260301178665976, 'psi': 0.46191731332408803}-{'f1_val': 0.36922353188931584, 'auprc': 0.6222073020000239, 'loss_val': 0.9251040227613321, 'psi': 0.47041703993359907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:63514
[S16] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1789) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.025371)
[S7] loaded HEAD from S16 (vec_in norm=1.025371)
[S7] cosine check vs S16: cos=0.8919
[S7] BUFFERED delta from S16 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1794) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.163328)
[S15] loaded HEAD from S6 (vec_in norm=1.163328)
[S15] cosine check vs S6: cos=0.8263
[S15] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1795) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.722633)
[S16] loaded HEAD from S4 (vec_in norm=0.722633)
[S16] cosine check vs S4: cos=0.2660
[S16] BUFFERED delta from S4 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1795) from S13
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.985751)
[S8] loaded HEAD from S13 (vec_in norm=0.985751)
[S8] cosine check vs S13: cos=0.5704
[S8] BUFFERED delta from S13 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.866742)
[S17] loaded HEAD from S7 (vec_in norm=0.866742)
[S17] cosine check vs S7: cos=0.6156
[S17] BUFFERED delta from S7 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.489371)
[S8] loaded HEAD from S14 (vec_in norm=1.489371)
[S8] cosine check vs S14: cos=0.8140
[S8] BUFFERED delta from S14 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1802) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.737543)
[S4] loaded HEAD from S15 (vec_in norm=0.737543)
[S4] cosine check vs S15: cos=0.8022
[S4] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.566433)
[S16] loaded HEAD from S9 (vec_in norm=1.566433)
[S16] cosine check vs S9: cos=0.9552
[S16] BUFFERED delta from S9 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1802) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.295092)
[S5] loaded HEAD from S11 (vec_in norm=1.295092)
[S5] cosine check vs S11: cos=-0.0228
[S5] DROPPED delta from S11 (cos=-0.0228 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.221111)
[S6] loaded HEAD from S3 (vec_in norm=1.221111)
[S6] cosine check vs S3: cos=0.9845
[S6] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.187314)
[S17] loaded HEAD from S10 (vec_in norm=1.187314)
[S17] cosine check vs S10: cos=0.8195
[S17] BUFFERED delta from S10 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1802) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.194279)
[S15] loaded HEAD from S5 (vec_in norm=1.194279)
[S15] cosine check vs S5: cos=0.3267
[S15] BUFFERED delta from S5 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1793) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.882809)
[S15] loaded HEAD from S8 (vec_in norm=0.882809)
[S15] cosine check vs S8: cos=0.5965
[S15] BUFFERED delta from S8 (total buffered=3)
[S14] RECEIVED delta(kind=head bytes=1797) from S2
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.532572)
[S14] loaded HEAD from S2 (vec_in norm=1.532572)
[S14] cosine check vs S2: cos=0.9897
[S14] BUFFERED delta from S2 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.824422)
[S13] loaded HEAD from S17 (vec_in norm=0.824422)
[S13] cosine check vs S17: cos=0.8322
[S13] BUFFERED delta from S17 (total buffered=1)
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.7000 head_norm=0.737543
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.440931e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.6987 head_norm=0.700606 delta_norm=0.144093
[S15] aggregate: ACCEPT kept=['S6', 'S5', 'S8'] (k=3/3) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.4168 head_norm=1.163328
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.089784e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.4168 head_norm=1.187580 delta_norm=0.108978
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.5316 head_norm=0.722633
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.297175e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.4448 head_norm=0.693047 delta_norm=0.229718
[S4] aggregate: ROLLBACK (f1_val pre=0.532 post=0.445 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.7011 head_norm=0.882809
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.007894e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.7011 head_norm=0.890776 delta_norm=0.100789
[S8] aggregate: ACCEPT kept=['S13', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4167 head_norm=0.866742
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.330673e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4167 head_norm=0.920322 delta_norm=0.233067
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6305 head_norm=0.985751
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.733130e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.6721 head_norm=0.866596 delta_norm=0.273313
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.9977 head_norm=1.489371
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.105888e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.9972 head_norm=1.507074 delta_norm=0.110589
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.4393 head_norm=0.824422
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.241230e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3520 head_norm=0.797765 delta_norm=0.124123
[S17] aggregate: ROLLBACK (f1_val pre=0.439 post=0.352 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.3839 head_norm=1.025371
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.398918e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.3940 head_norm=0.940875 delta_norm=0.139892
[S16] aggregate: ACCEPT kept=['S4', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.532572 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.7003071396965701, 'auprc': 0.7429154113118747, 'loss_val': 0.3533659515984904, 'psi': 0.7173504483426919}-{'f1_val': 0.7075821801673605, 'auprc': 0.7938568351887252, 'loss_val': 0.4299923832900442, 'psi': 0.7420920421759064}
[S3] START round=12 head_norm_before_train=1.221111 cos_to_last_merge=0.8528 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.853
[S3] round=12 local utility u=0.021200 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9984533378452194, 'loss_val': 0.359300316652375, 'psi': 0.819579886550005}-{'f1_val': 0.7005813959920884, 'auprc': 0.9981267632791245, 'loss_val': 0.4022231063878811, 'psi': 0.8195995429069028}
[S4] START round=12 head_norm_before_train=0.693047 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.514171535865894, 'auprc': 0.6618140488265559, 'loss_val': 0.69391548848285, 'psi': 0.5732285410501587}-{'f1_val': 0.531605015157511, 'auprc': 0.8541464630745369, 'loss_val': 0.740241524627497, 'psi': 0.6606215943243214}
[S5] START round=12 head_norm_before_train=1.194279 cos_to_last_merge=0.9158 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.916
[S5] round=12 local utility u=0.333561 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9924506243878174, 'loss_val': 0.37925573965739656, 'psi': 0.8173217428612852}-{'f1_val': 0.7044093743971336, 'auprc': 0.7952158267627738, 'loss_val': 0.4777146060604731, 'psi': 0.7407319553433898}
[S6] START round=12 head_norm_before_train=1.187580 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.061993 metrics={'f1_val': 0.5235521377475421, 'auprc': 0.8040342021413736, 'loss_val': 0.6953345827202756, 'psi': 0.6357449635050747}-{'f1_val': 0.4168135083356663, 'auprc': 0.9906531763773078, 'loss_val': 0.7387466369397722, 'psi': 0.6463493755523229}
[S7] START round=12 head_norm_before_train=0.920322 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.014568 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7825129417590373, 'loss_val': 0.9095411896227538, 'psi': 0.563031247570229}-{'f1_val': 0.41671011811102343, 'auprc': 0.7743231403416886, 'loss_val': 0.9141075838073921, 'psi': 0.5597553270032896}
[S8] START round=12 head_norm_before_train=0.890776 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.094532 metrics={'f1_val': 0.7063191464967399, 'auprc': 0.9982117053832267, 'loss_val': 0.5590725897962956, 'psi': 0.8230761700513347}-{'f1_val': 0.7011417569092661, 'auprc': 0.9950278188611846, 'loss_val': 0.7075212840542143, 'psi': 0.8186961816900336}
[S9] START round=12 head_norm_before_train=1.566433 (no previous merge yet)
[S9] round=12 local utility u=0.020515 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9980720401482549, 'loss_val': 0.24119816577097752, 'psi': 0.820108872437505}-{'f1_val': 0.7012904835408967, 'auprc': 0.9984618698972668, 'loss_val': 0.28233924373150243, 'psi': 0.8201590380834448}
[S10] START round=12 head_norm_before_train=1.187314 cos_to_last_merge=0.8627 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.863
[S10] round=12 local utility u=0.105527 metrics={'f1_val': 0.7017747360062386, 'auprc': 0.9972689128139129, 'loss_val': 0.5011031348370264, 'psi': 0.8199724067293084}-{'f1_val': 0.7015844573984173, 'auprc': 0.9672282234535325, 'loss_val': 0.6208941386617441, 'psi': 0.8078419638204635}
[S11] START round=12 head_norm_before_train=1.295092 cos_to_last_merge=0.8946 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.895
[S11] round=12 local utility u=0.040782 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9970124561540804, 'loss_val': 0.4054122876895745, 'psi': 0.8199661724406242}-{'f1_val': 0.7020007759458987, 'auprc': 0.9992666291925475, 'loss_val': 0.4941319711285486, 'psi': 0.8209071172445582}
[S13] START round=12 head_norm_before_train=0.866596 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.32675510753176407, 'auprc': 0.5288121460308725, 'loss_val': 0.9418400502040574, 'psi': 0.40757792293140743}-{'f1_val': 0.6304574649540933, 'auprc': 0.6750023447841973, 'loss_val': 0.8338501351219318, 'psi': 0.6482754168861349}
[S14] START round=12 head_norm_before_train=1.507074 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.110474 metrics={'f1_val': 0.9980868056894548, 'auprc': 0.9974510459930646, 'loss_val': 0.47211205032673126, 'psi': 0.9978325018108988}-{'f1_val': 0.9976985674416128, 'auprc': 0.997424660445591, 'loss_val': 0.6906522645304929, 'psi': 0.9975890046432041}
[S15] START round=12 head_norm_before_train=0.700606 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.144285 metrics={'f1_val': 0.6921349071780624, 'auprc': 0.7994515075637949, 'loss_val': 0.7039479672110649, 'psi': 0.7350615473323554}-{'f1_val': 0.6999510323111611, 'auprc': 0.7174756885984415, 'loss_val': 0.7934877960960346, 'psi': 0.7069608948260733}
[S16] START round=12 head_norm_before_train=0.940875 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.147538 metrics={'f1_val': 0.43378834460560894, 'auprc': 0.7320924934687058, 'loss_val': 0.8532129265965513, 'psi': 0.5531100041508477}-{'f1_val': 0.38390558502381084, 'auprc': 0.737035769735654, 'loss_val': 0.8638218207068297, 'psi': 0.525157658908548}
[S17] START round=12 head_norm_before_train=0.797765 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.35243828617822603, 'auprc': 0.4899959880444201, 'loss_val': 0.936904357046986, 'psi': 0.4074613669247037}-{'f1_val': 0.43932444437545254, 'auprc': 0.4958066167470412, 'loss_val': 0.9260301178665976, 'psi': 0.46191731332408803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S7] → sending delta(kind=head bytes=1786) to S17@127.0.0.1:63517
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:63517
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:63515
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1786 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1793) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.982453)
[S7] loaded HEAD from S16 (vec_in norm=0.982453)
[S7] cosine check vs S16: cos=0.9626
[S7] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.227839)
[S17] loaded HEAD from S10 (vec_in norm=1.227839)
[S17] cosine check vs S10: cos=0.8176
[S17] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1804) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.259592)
[S6] loaded HEAD from S3 (vec_in norm=1.259592)
[S6] cosine check vs S3: cos=0.9874
[S6] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1786) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.942347)
[S17] loaded HEAD from S7 (vec_in norm=0.942347)
[S17] cosine check vs S7: cos=0.5715
[S17] BUFFERED delta from S7 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1795) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.226563)
[S15] loaded HEAD from S6 (vec_in norm=1.226563)
[S15] cosine check vs S6: cos=0.7701
[S15] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.935623)
[S15] loaded HEAD from S8 (vec_in norm=0.935623)
[S15] cosine check vs S8: cos=0.6493
[S15] BUFFERED delta from S8 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.227834)
[S15] loaded HEAD from S5 (vec_in norm=1.227834)
[S15] cosine check vs S5: cos=0.3778
[S15] BUFFERED delta from S5 (total buffered=3)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.595525)
[S16] loaded HEAD from S9 (vec_in norm=1.595525)
[S16] cosine check vs S9: cos=0.9340
[S16] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.547909)
[S8] loaded HEAD from S14 (vec_in norm=1.547909)
[S8] cosine check vs S14: cos=0.8153
[S8] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.747795)
[S4] loaded HEAD from S15 (vec_in norm=0.747795)
[S4] cosine check vs S15: cos=0.9097
[S4] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.340946)
[S5] loaded HEAD from S11 (vec_in norm=1.340946)
[S5] cosine check vs S11: cos=-0.0235
[S5] DROPPED delta from S11 (cos=-0.0235 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.5142 head_norm=0.756419
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.598808e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6759 head_norm=0.734930 delta_norm=0.159881
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.4167 head_norm=0.942347
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.330883e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.4167 head_norm=0.953364 delta_norm=0.133088
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.7063 head_norm=0.935623
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.769086e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.7009 head_norm=1.186703 delta_norm=0.476909
[S8] aggregate: ROLLBACK (f1_val pre=0.706 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.6921 head_norm=0.747795
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.224836e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.6917 head_norm=0.724483 delta_norm=0.122484
[S15] aggregate: ACCEPT kept=['S6', 'S8', 'S5'] (k=3/3) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.5236 head_norm=1.226563
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.986874e-02
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.5243 head_norm=1.239170 delta_norm=0.099869
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.4338 head_norm=0.982453
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.817097e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4657 head_norm=1.268761 delta_norm=0.381710
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3524 head_norm=0.843987
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.334654e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3523 head_norm=0.817756 delta_norm=0.133465
[S17] aggregate: ACCEPT kept=['S10', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.578013 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.7008465614907264, 'auprc': 0.7267648895319996, 'loss_val': 0.34796081926824773, 'psi': 0.7112138927072357}-{'f1_val': 0.7003071396965701, 'auprc': 0.7429154113118747, 'loss_val': 0.3533659515984904, 'psi': 0.7173504483426919}
[S3] START round=13 head_norm_before_train=1.259592 cos_to_last_merge=0.8384 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.838
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.6417210401382335, 'auprc': 0.9954840290594823, 'loss_val': 0.4266230079162046, 'psi': 0.783226235706733}-{'f1_val': 0.700330919019862, 'auprc': 0.9984533378452194, 'loss_val': 0.359300316652375, 'psi': 0.819579886550005}
[S4] START round=13 head_norm_before_train=0.734930 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.598186 metrics={'f1_val': 0.6908906759003879, 'auprc': 0.6944823784120223, 'loss_val': 0.6558632618036495, 'psi': 0.6923273569050417}-{'f1_val': 0.514171535865894, 'auprc': 0.6618140488265559, 'loss_val': 0.69391548848285, 'psi': 0.5732285410501587}
[S5] START round=13 head_norm_before_train=1.227834 cos_to_last_merge=0.9064 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.906
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.6779064772636458, 'auprc': 0.7916856890339713, 'loss_val': 0.6241566539766319, 'psi': 0.723418161971776}-{'f1_val': 0.7005691551769304, 'auprc': 0.9924506243878174, 'loss_val': 0.37925573965739656, 'psi': 0.8173217428612852}
[S6] START round=13 head_norm_before_train=1.239170 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.860183 metrics={'f1_val': 0.689418322878877, 'auprc': 0.9848679109852003, 'loss_val': 0.5126674149542788, 'psi': 0.8075981581214065}-{'f1_val': 0.5235521377475421, 'auprc': 0.8040342021413736, 'loss_val': 0.6953345827202756, 'psi': 0.6357449635050747}
[S7] START round=13 head_norm_before_train=0.953364 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.024869 metrics={'f1_val': 0.416587999573199, 'auprc': 0.7914231106367595, 'loss_val': 0.8858017416182263, 'psi': 0.5665220439986232}-{'f1_val': 0.41671011811102343, 'auprc': 0.7825129417590373, 'loss_val': 0.9095411896227538, 'psi': 0.563031247570229}
[S8] START round=13 head_norm_before_train=1.186703 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.086560 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9977918797122654, 'loss_val': 0.42971538439092166, 'psi': 0.8274105188752622}-{'f1_val': 0.7063191464967399, 'auprc': 0.9982117053832267, 'loss_val': 0.5590725897962956, 'psi': 0.8230761700513347}
[S9] START round=13 head_norm_before_train=1.595525 (no previous merge yet)
[S9] round=13 local utility u=0.009066 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982179889438001, 'loss_val': 0.22200329747308672, 'psi': 0.8200171440415311}-{'f1_val': 0.7014667606303384, 'auprc': 0.9980720401482549, 'loss_val': 0.24119816577097752, 'psi': 0.820108872437505}
[S10] START round=13 head_norm_before_train=1.227839 cos_to_last_merge=0.8475 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.847
[S10] round=13 local utility u=0.060991 metrics={'f1_val': 0.7014667009264342, 'auprc': 0.9976323719405099, 'loss_val': 0.3783633300041335, 'psi': 0.8199329693320645}-{'f1_val': 0.7017747360062386, 'auprc': 0.9972689128139129, 'loss_val': 0.5011031348370264, 'psi': 0.8199724067293084}
[S11] START round=13 head_norm_before_train=1.340946 cos_to_last_merge=0.8823 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.882
[S11] round=13 local utility u=0.010134 metrics={'f1_val': 0.6964285577286595, 'auprc': 0.9984241930376145, 'loss_val': 0.3563389771519568, 'psi': 0.8172268118522416}-{'f1_val': 0.7019353166316534, 'auprc': 0.9970124561540804, 'loss_val': 0.4054122876895745, 'psi': 0.8199661724406242}
[S13] START round=13 head_norm_before_train=0.899140 cos_to_last_merge=0.9971 (last merge round=11)
[S13] round=13 local utility u=1.000000 metrics={'f1_val': 0.6466760401838656, 'auprc': 0.6483657514350474, 'loss_val': 0.7953205773511508, 'psi': 0.6473519246843383}-{'f1_val': 0.32675510753176407, 'auprc': 0.5288121460308725, 'loss_val': 0.9418400502040574, 'psi': 0.40757792293140743}
[S14] START round=13 head_norm_before_train=1.547909 cos_to_last_merge=0.9984 (last merge round=11)
[S14] round=13 local utility u=0.073134 metrics={'f1_val': 0.9983295269340572, 'auprc': 0.9960416584701823, 'loss_val': 0.32307245914435867, 'psi': 0.9974143795485073}-{'f1_val': 0.9980868056894548, 'auprc': 0.9974510459930646, 'loss_val': 0.47211205032673126, 'psi': 0.9978325018108988}
[S15] START round=13 head_norm_before_train=0.724483 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.032874 metrics={'f1_val': 0.6981546047153424, 'auprc': 0.7995704001613273, 'loss_val': 0.6746739984011847, 'psi': 0.7387209228937364}-{'f1_val': 0.6921349071780624, 'auprc': 0.7994515075637949, 'loss_val': 0.7039479672110649, 'psi': 0.7350615473323554}
[S16] START round=13 head_norm_before_train=1.268761 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.359468 metrics={'f1_val': 0.5287800508745794, 'auprc': 0.7542968473227456, 'loss_val': 0.770839978131726, 'psi': 0.6189867694538459}-{'f1_val': 0.43378834460560894, 'auprc': 0.7320924934687058, 'loss_val': 0.8532129265965513, 'psi': 0.5531100041508477}
[S17] START round=13 head_norm_before_train=0.817756 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.338121 metrics={'f1_val': 0.35199388000949794, 'auprc': 0.7207773232937797, 'loss_val': 0.9503403316560622, 'psi': 0.49950725732321066}-{'f1_val': 0.35243828617822603, 'auprc': 0.4899959880444201, 'loss_val': 0.936904357046986, 'psi': 0.4074613669247037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S7] → sending delta(kind=head bytes=1787) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:63515
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:63509
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:63516
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1787 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.796595)
[S16] loaded HEAD from S4 (vec_in norm=0.796595)
[S16] cosine check vs S4: cos=0.1267
[S16] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.306569)
[S7] loaded HEAD from S16 (vec_in norm=1.306569)
[S7] cosine check vs S16: cos=0.9558
[S7] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.597842)
[S8] loaded HEAD from S14 (vec_in norm=1.597842)
[S8] cosine check vs S14: cos=0.9609
[S8] BUFFERED delta from S14 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1787) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.979521)
[S17] loaded HEAD from S7 (vec_in norm=0.979521)
[S17] cosine check vs S7: cos=0.5865
[S17] BUFFERED delta from S7 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1794) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.266275)
[S17] loaded HEAD from S10 (vec_in norm=1.266275)
[S17] cosine check vs S10: cos=0.8101
[S17] BUFFERED delta from S10 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.227940)
[S15] loaded HEAD from S8 (vec_in norm=1.227940)
[S15] cosine check vs S8: cos=0.6459
[S15] BUFFERED delta from S8 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.773700)
[S4] loaded HEAD from S15 (vec_in norm=0.773700)
[S4] cosine check vs S15: cos=0.9426
[S4] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.272179)
[S15] loaded HEAD from S6 (vec_in norm=1.272179)
[S15] cosine check vs S6: cos=0.7383
[S15] BUFFERED delta from S6 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1795) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.620595)
[S16] loaded HEAD from S9 (vec_in norm=1.620595)
[S16] cosine check vs S9: cos=0.9856
[S16] BUFFERED delta from S9 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.384581)
[S5] loaded HEAD from S11 (vec_in norm=1.384581)
[S5] cosine check vs S11: cos=-0.0239
[S5] DROPPED delta from S11 (cos=-0.0239 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S13
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.934457)
[S8] loaded HEAD from S13 (vec_in norm=0.934457)
[S8] cosine check vs S13: cos=0.2725
[S8] BUFFERED delta from S13 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.860197)
[S13] loaded HEAD from S17 (vec_in norm=0.860197)
[S13] cosine check vs S17: cos=0.8741
[S13] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.4166 head_norm=0.979521
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.345421e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.4166 head_norm=1.130612 delta_norm=0.234542
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.6467 head_norm=0.934457
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.279997e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.6839 head_norm=0.868672 delta_norm=0.228000
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.7138 head_norm=1.227940
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.247670e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.7138 head_norm=1.072147 delta_norm=0.224767
[S8] aggregate: ACCEPT kept=['S14', 'S13'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6909 head_norm=0.796595
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.334417e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6905 head_norm=0.773809 delta_norm=0.133442
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3520 head_norm=0.860197
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.192313e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3520 head_norm=0.838147 delta_norm=0.119231
[S17] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.5288 head_norm=1.306569
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.796508e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.4887 head_norm=1.089793 delta_norm=0.279651
[S16] aggregate: ROLLBACK (f1_val pre=0.529 post=0.489 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6982 head_norm=0.773700
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.769877e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6983 head_norm=0.864231 delta_norm=0.276988
[S15] aggregate: ACCEPT kept=['S8', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.615438 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.6995880223688264, 'auprc': 0.6629807912759896, 'loss_val': 0.33979364419430974, 'psi': 0.6849451299316918}-{'f1_val': 0.7008465614907264, 'auprc': 0.7267648895319996, 'loss_val': 0.34796081926824773, 'psi': 0.7112138927072357}
[S3] START round=14 head_norm_before_train=1.294359 cos_to_last_merge=0.8264 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.826
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.49151645455993276, 'auprc': 0.9085741943129545, 'loss_val': 0.6716368341127333, 'psi': 0.6583395504611415}-{'f1_val': 0.6417210401382335, 'auprc': 0.9954840290594823, 'loss_val': 0.4266230079162046, 'psi': 0.783226235706733}
[S4] START round=14 head_norm_before_train=0.773809 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.029291 metrics={'f1_val': 0.6760273890603584, 'auprc': 0.7356093131799163, 'loss_val': 0.6314815674849809, 'psi': 0.6998601587081816}-{'f1_val': 0.6908906759003879, 'auprc': 0.6944823784120223, 'loss_val': 0.6558632618036495, 'psi': 0.6923273569050417}
[S5] START round=14 head_norm_before_train=1.258679 cos_to_last_merge=0.8985 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.899
[S5] round=14 local utility u=0.511745 metrics={'f1_val': 0.7003221706489986, 'auprc': 0.9903699429453054, 'loss_val': 0.3312135643595935, 'psi': 0.8163412795675213}-{'f1_val': 0.6779064772636458, 'auprc': 0.7916856890339713, 'loss_val': 0.6241566539766319, 'psi': 0.723418161971776}
[S6] START round=14 head_norm_before_train=1.272179 cos_to_last_merge=0.9990 (last merge round=12)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.5279206032632641, 'auprc': 0.7742553932362248, 'loss_val': 0.6744733916198673, 'psi': 0.6264545192524484}-{'f1_val': 0.689418322878877, 'auprc': 0.9848679109852003, 'loss_val': 0.5126674149542788, 'psi': 0.8075981581214065}
[S7] START round=14 head_norm_before_train=1.130612 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.096994 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.8440220318239616, 'loss_val': 0.8503431688341375, 'psi': 0.5876348835961986}-{'f1_val': 0.416587999573199, 'auprc': 0.7914231106367595, 'loss_val': 0.8858017416182263, 'psi': 0.5665220439986232}
[S8] START round=14 head_norm_before_train=1.072147 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.013825 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.9971740492870216, 'loss_val': 0.4005981131224741, 'psi': 0.8272020997932776}-{'f1_val': 0.7138229449839267, 'auprc': 0.9977918797122654, 'loss_val': 0.42971538439092166, 'psi': 0.8274105188752622}
[S9] START round=14 head_norm_before_train=1.620595 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981361604849097, 'loss_val': 0.22626857047577237, 'psi': 0.8199844126579751}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982179889438001, 'loss_val': 0.22200329747308672, 'psi': 0.8200171440415311}
[S10] START round=14 head_norm_before_train=1.266275 cos_to_last_merge=0.8311 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.831
[S10] round=14 local utility u=0.038007 metrics={'f1_val': 0.7009295470428154, 'auprc': 0.9976169189713054, 'loss_val': 0.29907979656656275, 'psi': 0.8196044958142115}-{'f1_val': 0.7014667009264342, 'auprc': 0.9976323719405099, 'loss_val': 0.3783633300041335, 'psi': 0.8199329693320645}
[S11] START round=14 head_norm_before_train=1.384581 cos_to_last_merge=0.8720 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.872
[S11] round=14 local utility u=0.048245 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9976066662726847, 'loss_val': 0.2889866117399968, 'psi': 0.8200587542612288}-{'f1_val': 0.6964285577286595, 'auprc': 0.9984241930376145, 'loss_val': 0.3563389771519568, 'psi': 0.8172268118522416}
[S13] START round=14 head_norm_before_train=0.868672 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5962782762206489, 'auprc': 0.5882686246925859, 'loss_val': 0.8399883133030135, 'psi': 0.5930744156094236}-{'f1_val': 0.6466760401838656, 'auprc': 0.6483657514350474, 'loss_val': 0.7953205773511508, 'psi': 0.6473519246843383}
[S14] START round=14 head_norm_before_train=1.597842 cos_to_last_merge=0.9947 (last merge round=11)
[S14] round=14 local utility u=0.045736 metrics={'f1_val': 0.9976543488671686, 'auprc': 0.997075833008266, 'loss_val': 0.23065202296268514, 'psi': 0.9974229425236075}-{'f1_val': 0.9983295269340572, 'auprc': 0.9960416584701823, 'loss_val': 0.32307245914435867, 'psi': 0.9974143795485073}
[S15] START round=14 head_norm_before_train=0.864231 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.021566 metrics={'f1_val': 0.699247069653446, 'auprc': 0.7995648874871988, 'loss_val': 0.6380811288288251, 'psi': 0.7393741967869472}-{'f1_val': 0.6981546047153424, 'auprc': 0.7995704001613273, 'loss_val': 0.6746739984011847, 'psi': 0.7387209228937364}
[S16] START round=14 head_norm_before_train=1.089793 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.213061 metrics={'f1_val': 0.554833091307386, 'auprc': 0.8285961914440698, 'loss_val': 0.723935079911687, 'psi': 0.6643383313620594}-{'f1_val': 0.5287800508745794, 'auprc': 0.7542968473227456, 'loss_val': 0.770839978131726, 'psi': 0.6189867694538459}
[S17] START round=14 head_norm_before_train=0.838147 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.3519375686298838, 'auprc': 0.6648774089770431, 'loss_val': 0.9520161193029496, 'psi': 0.4771135047687475}-{'f1_val': 0.35199388000949794, 'auprc': 0.7207773232937797, 'loss_val': 0.9503403316560622, 'psi': 0.49950725732321066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:63502
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:63512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:63510
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:63514
[S8] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S8
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.119640)
[S14] loaded HEAD from S8 (vec_in norm=1.119640)
[S14] cosine check vs S8: cos=0.9179
[S14] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1791) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.154306)
[S16] loaded HEAD from S7 (vec_in norm=1.154306)
[S16] cosine check vs S7: cos=0.9858
[S16] BUFFERED delta from S7 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1804) from S14
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.645658)
[S2] loaded HEAD from S14 (vec_in norm=1.645658)
[S2] cosine check vs S14: cos=0.9759
[S2] BUFFERED delta from S14 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1790) from S16
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.124923)
[S9] loaded HEAD from S16 (vec_in norm=1.124923)
[S9] cosine check vs S16: cos=0.9607
[S9] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1793) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.911652)
[S8] loaded HEAD from S15 (vec_in norm=0.911652)
[S8] cosine check vs S15: cos=0.7504
[S8] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S4
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.835150)
[S15] loaded HEAD from S4 (vec_in norm=0.835150)
[S15] cosine check vs S4: cos=0.9332
[S15] BUFFERED delta from S4 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1805) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.281117)
[S11] loaded HEAD from S5 (vec_in norm=1.281117)
[S11] cosine check vs S5: cos=-0.0237
[S11] DROPPED delta from S5 (cos=-0.0237 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.6996 head_norm=1.640092
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.805039e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.6996 head_norm=1.632931 delta_norm=0.180504
[S2] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7012 head_norm=1.643571
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.218213e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7012 head_norm=1.371065 delta_norm=0.321821
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6992 head_norm=0.911652
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.639856e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6991 head_norm=0.858720 delta_norm=0.163986
[S15] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9977 head_norm=1.645658
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.804873e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9977 head_norm=1.355035 delta_norm=0.380487
[S14] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.5548 head_norm=1.124923
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.705450e-02
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.5546 head_norm=1.135569 delta_norm=0.097055
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.7139 head_norm=1.119640
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.717264e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.7139 head_norm=0.950879 delta_norm=0.371726
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.632931 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.6947202927965317, 'auprc': 0.6624711032139663, 'loss_val': 0.3470686202194609, 'psi': 0.6818206169635055}-{'f1_val': 0.6995880223688264, 'auprc': 0.6629807912759896, 'loss_val': 0.33979364419430974, 'psi': 0.6849451299316918}
[S3] START round=15 head_norm_before_train=1.332293 cos_to_last_merge=0.8176 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.818
[S3] round=15 local utility u=0.750450 metrics={'f1_val': 0.6518708028083028, 'auprc': 0.9941366653718302, 'loss_val': 0.38955068139178084, 'psi': 0.7887771478337138}-{'f1_val': 0.49151645455993276, 'auprc': 0.9085741943129545, 'loss_val': 0.6716368341127333, 'psi': 0.6583395504611415}
[S4] START round=15 head_norm_before_train=0.835150 cos_to_last_merge=0.9943 (last merge round=13)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.6013913556941908, 'auprc': 0.8579647587212205, 'loss_val': 0.5746530413090081, 'psi': 0.7040207169050027}-{'f1_val': 0.6760273890603584, 'auprc': 0.7356093131799163, 'loss_val': 0.6314815674849809, 'psi': 0.6998601587081816}
[S5] START round=15 head_norm_before_train=1.281117 cos_to_last_merge=0.8929 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.893
[S5] round=15 local utility u=0.005325 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9898529982257647, 'loss_val': 0.3207306359619433, 'psi': 0.8163062348879104}-{'f1_val': 0.7003221706489986, 'auprc': 0.9903699429453054, 'loss_val': 0.3312135643595935, 'psi': 0.8163412795675213}
[S6] START round=15 head_norm_before_train=1.305012 cos_to_last_merge=0.9967 (last merge round=12)
[S6] round=15 local utility u=1.000000 metrics={'f1_val': 0.7070176932987858, 'auprc': 0.9877165165358348, 'loss_val': 0.358056772829068, 'psi': 0.8192972225936055}-{'f1_val': 0.5279206032632641, 'auprc': 0.7742553932362248, 'loss_val': 0.6744733916198673, 'psi': 0.6264545192524484}
[S7] START round=15 head_norm_before_train=1.154306 cos_to_last_merge=0.9983 (last merge round=13)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7856001187333509, 'loss_val': 0.8292682942081608, 'psi': 0.5642661183599544}-{'f1_val': 0.41671011811102343, 'auprc': 0.8440220318239616, 'loss_val': 0.8503431688341375, 'psi': 0.5876348835961986}
[S8] START round=15 head_norm_before_train=0.950879 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.005787 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.996820807667578, 'loss_val': 0.38796482479438954, 'psi': 0.8270608031455001}-{'f1_val': 0.7138874667974482, 'auprc': 0.9971740492870216, 'loss_val': 0.4005981131224741, 'psi': 0.8272020997932776}
[S9] START round=15 head_norm_before_train=1.371065 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.011397 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981035436602621, 'loss_val': 0.2033765598174093, 'psi': 0.819971365928116}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981361604849097, 'loss_val': 0.22626857047577237, 'psi': 0.8199844126579751}
[S10] START round=15 head_norm_before_train=1.303326 cos_to_last_merge=0.8157 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.816
[S10] round=15 local utility u=0.382427 metrics={'f1_val': 0.8188268152652661, 'auprc': 0.9975322933907452, 'loss_val': 0.24135481394675481, 'psi': 0.8903090065154577}-{'f1_val': 0.7009295470428154, 'auprc': 0.9976169189713054, 'loss_val': 0.29907979656656275, 'psi': 0.8196044958142115}
[S11] START round=15 head_norm_before_train=1.423780 cos_to_last_merge=0.8631 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.863
[S11] round=15 local utility u=0.019425 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9983574040366557, 'loss_val': 0.25384058326349535, 'psi': 0.8205041515936544}-{'f1_val': 0.7016934795869249, 'auprc': 0.9976066662726847, 'loss_val': 0.2889866117399968, 'psi': 0.8200587542612288}
[S13] START round=15 head_norm_before_train=0.904452 cos_to_last_merge=0.9979 (last merge round=13)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.57385135203478, 'auprc': 0.5239415011126476, 'loss_val': 0.8361740416752277, 'psi': 0.553887411665927}-{'f1_val': 0.5962782762206489, 'auprc': 0.5882686246925859, 'loss_val': 0.8399883133030135, 'psi': 0.5930744156094236}
[S14] START round=15 head_norm_before_train=1.355035 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.9978965638266506, 'auprc': 0.9971097322779078, 'loss_val': 0.24231150738111162, 'psi': 0.9975818312071534}-{'f1_val': 0.9976543488671686, 'auprc': 0.997075833008266, 'loss_val': 0.23065202296268514, 'psi': 0.9974229425236075}
[S15] START round=15 head_norm_before_train=0.858720 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.156559 metrics={'f1_val': 0.7091662466518779, 'auprc': 0.8347348667095158, 'loss_val': 0.4899883747554622, 'psi': 0.7593936946749331}-{'f1_val': 0.699247069653446, 'auprc': 0.7995648874871988, 'loss_val': 0.6380811288288251, 'psi': 0.7393741967869472}
[S16] START round=15 head_norm_before_train=1.135569 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.325061 metrics={'f1_val': 0.5947972448060725, 'auprc': 0.9147780333725299, 'loss_val': 0.5721432382921489, 'psi': 0.7227895602326555}-{'f1_val': 0.554833091307386, 'auprc': 0.8285961914440698, 'loss_val': 0.723935079911687, 'psi': 0.6643383313620594}
[S17] START round=15 head_norm_before_train=0.879721 cos_to_last_merge=0.9952 (last merge round=13)
[S17] round=15 local utility u=0.029072 metrics={'f1_val': 0.3554061895551257, 'auprc': 0.6505908773406996, 'loss_val': 0.8718237649755934, 'psi': 0.4734800646693553}-{'f1_val': 0.3519375686298838, 'auprc': 0.6648774089770431, 'loss_val': 0.9520161193029496, 'psi': 0.4771135047687475}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:63509
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:63503
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:63512
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:63510
[S5] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.911584)
[S8] loaded HEAD from S15 (vec_in norm=0.911584)
[S8] cosine check vs S15: cos=0.8595
[S8] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.302766)
[S11] loaded HEAD from S5 (vec_in norm=1.302766)
[S11] cosine check vs S5: cos=-0.0221
[S11] DROPPED delta from S5 (cos=-0.0221 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1805) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.334136)
[S3] loaded HEAD from S6 (vec_in norm=1.334136)
[S3] cosine check vs S6: cos=0.9802
[S3] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S8
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.993582)
[S14] loaded HEAD from S8 (vec_in norm=0.993582)
[S14] cosine check vs S8: cos=0.9162
[S14] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:63511
[S16] sending update (kind=head size=1792 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1792) from S16
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.171108)
[S9] loaded HEAD from S16 (vec_in norm=1.171108)
[S9] cosine check vs S16: cos=0.9803
[S9] BUFFERED delta from S16 (total buffered=1)
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1797) from S17
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.918901)
[S10] loaded HEAD from S17 (vec_in norm=0.918901)
[S10] cosine check vs S17: cos=0.7865
[S10] BUFFERED delta from S17 (total buffered=1)
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S16
[S4]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S7] ⇄ pheromone p=0.085 → S16@127.0.0.1:63516
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.6519 head_norm=1.364213
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.350346e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.6467 head_norm=1.342484 delta_norm=0.135035
[S3] aggregate: ROLLBACK (f1_val pre=0.652 post=0.647 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.272 → S17@127.0.0.1:63517
[S4] ⇄ pheromone p=0.212 → S15@127.0.0.1:63515
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7012 head_norm=1.396423
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.698027e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7012 head_norm=1.277463 delta_norm=0.169803
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.8188 head_norm=1.341548
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.197976e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.7015 head_norm=1.070437 delta_norm=0.419798
[S10] aggregate: ROLLBACK (f1_val pre=0.819 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.233 → S11@127.0.0.1:63512
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.7139 head_norm=0.993582
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.555257e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.7140 head_norm=0.918587 delta_norm=0.255526
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.199 → S14@127.0.0.1:63514
[S6] ⇄ pheromone p=0.421 → S3@127.0.0.1:63503
[S15] ⇄ pheromone p=0.184 → S8@127.0.0.1:63509
[S16] ⇄ pheromone p=0.225 → S9@127.0.0.1:63510
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9979 head_norm=1.396980
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.143375e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9979 head_norm=1.170714 delta_norm=0.314337
[S14] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.254 → S2@127.0.0.1:63502
[S17] ⇄ pheromone p=0.128 → S10@127.0.0.1:63511
[S2] START round=16 head_norm_before_train=1.652416 cos_to_last_merge=0.9997 (last merge round=14)
[S2] round=16 local utility u=0.022675 metrics={'f1_val': 0.7009533202285976, 'auprc': 0.6634406860484632, 'loss_val': 0.3420252046388943, 'psi': 0.6859482665565437}-{'f1_val': 0.6947202927965317, 'auprc': 0.6624711032139663, 'loss_val': 0.3470686202194609, 'psi': 0.6818206169635055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=16 head_norm_before_train=1.342484 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.193339 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9939600855933477, 'loss_val': 0.29310344282345663, 'psi': 0.8177825856492563}-{'f1_val': 0.6518708028083028, 'auprc': 0.9941366653718302, 'loss_val': 0.38955068139178084, 'psi': 0.7887771478337138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=16 head_norm_before_train=0.897698 cos_to_last_merge=0.9829 (last merge round=13)
[S4] round=16 local utility u=0.241282 metrics={'f1_val': 0.6749461563791138, 'auprc': 0.8558210776421546, 'loss_val': 0.5269874100702535, 'psi': 0.7472961248843302}-{'f1_val': 0.6013913556941908, 'auprc': 0.8579647587212205, 'loss_val': 0.5746530413090081, 'psi': 0.7040207169050027}
[S5] START round=16 head_norm_before_train=1.302766 cos_to_last_merge=0.8878 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.888
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.6798022783483211, 'auprc': 0.7939458361065672, 'loss_val': 0.6240574390934429, 'psi': 0.7254597014516195}-{'f1_val': 0.7006083926626743, 'auprc': 0.9898529982257647, 'loss_val': 0.3207306359619433, 'psi': 0.8163062348879104}
[S6] START round=16 head_norm_before_train=1.334136 cos_to_last_merge=0.9941 (last merge round=12)
[S6] round=16 local utility u=0.298065 metrics={'f1_val': 0.8035177216228738, 'auprc': 0.9815812732528888, 'loss_val': 0.3225217021138295, 'psi': 0.8747431422748798}-{'f1_val': 0.7070176932987858, 'auprc': 0.9877165165358348, 'loss_val': 0.358056772829068, 'psi': 0.8192972225936055}
[S7] START round=16 head_norm_before_train=1.178340 cos_to_last_merge=0.9946 (last merge round=13)
[S7] round=16 local utility u=0.057111 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.8199639092638176, 'loss_val': 0.8181385639981491, 'psi': 0.5780116345721411}-{'f1_val': 0.41671011811102343, 'auprc': 0.7856001187333509, 'loss_val': 0.8292682942081608, 'psi': 0.5642661183599544}
[S8] START round=16 head_norm_before_train=0.918587 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.7009086045093338, 'auprc': 0.9981554048747947, 'loss_val': 0.39473898748513614, 'psi': 0.8198073246555182}-{'f1_val': 0.7138874667974482, 'auprc': 0.996820807667578, 'loss_val': 0.38796482479438954, 'psi': 0.8270608031455001}
[S9] START round=16 head_norm_before_train=1.277463 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000233 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9980960454612441, 'loss_val': 0.2028882963791408, 'psi': 0.8199683666485088}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981035436602621, 'loss_val': 0.2033765598174093, 'psi': 0.819971365928116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=16 head_norm_before_train=1.070437 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.373479 metrics={'f1_val': 0.9587542390256161, 'auprc': 0.9939882345310557, 'loss_val': 0.32332823838998626, 'psi': 0.9728478372277919}-{'f1_val': 0.8188268152652661, 'auprc': 0.9975322933907452, 'loss_val': 0.24135481394675481, 'psi': 0.8903090065154577}
[S11] START round=16 head_norm_before_train=1.457027 cos_to_last_merge=0.8560 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.856
[S11] round=16 local utility u=0.746643 metrics={'f1_val': 0.9474444785897367, 'auprc': 0.9983096082125584, 'loss_val': 0.23346714393282383, 'psi': 0.9677905304388654}-{'f1_val': 0.7019353166316534, 'auprc': 0.9983574040366557, 'loss_val': 0.25384058326349535, 'psi': 0.8205041515936544}
[S13] START round=16 head_norm_before_train=0.947213 cos_to_last_merge=0.9919 (last merge round=13)
[S13] round=16 local utility u=0.082229 metrics={'f1_val': 0.5947306031690465, 'auprc': 0.5288588207998333, 'loss_val': 0.8117425813641828, 'psi': 0.5683818902213612}-{'f1_val': 0.57385135203478, 'auprc': 0.5239415011126476, 'loss_val': 0.8361740416752277, 'psi': 0.553887411665927}
[S14] START round=16 head_norm_before_train=1.170714 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.002511 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9971123506783578, 'loss_val': 0.23829286658890406, 'psi': 0.9976823601805509}-{'f1_val': 0.9978965638266506, 'auprc': 0.9971097322779078, 'loss_val': 0.24231150738111162, 'psi': 0.9975818312071534}
[S15] START round=16 head_norm_before_train=0.911584 cos_to_last_merge=0.9969 (last merge round=14)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6884590176684433, 'auprc': 0.8078792505678766, 'loss_val': 0.5211666934942613, 'psi': 0.7362271108282166}-{'f1_val': 0.7091662466518779, 'auprc': 0.8347348667095158, 'loss_val': 0.4899883747554622, 'psi': 0.7593936946749331}
[S16] START round=16 head_norm_before_train=1.171108 cos_to_last_merge=0.9990 (last merge round=14)
[S16] round=16 local utility u=0.801218 metrics={'f1_val': 0.840316431416719, 'auprc': 0.9181872237664974, 'loss_val': 0.45304967869006135, 'psi': 0.8714647483566302}-{'f1_val': 0.5947972448060725, 'auprc': 0.9147780333725299, 'loss_val': 0.5721432382921489, 'psi': 0.7227895602326555}
[S17] START round=16 head_norm_before_train=0.918901 cos_to_last_merge=0.9854 (last merge round=13)
[S17] round=16 local utility u=0.181090 metrics={'f1_val': 0.3897494827312298, 'auprc': 0.6571668706878657, 'loss_val': 0.7354309744274464, 'psi': 0.49671643791388415}-{'f1_val': 0.3554061895551257, 'auprc': 0.6505908773406996, 'loss_val': 0.8718237649755934, 'psi': 0.4734800646693553}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:63503
[S7] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1792) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.199269)
[S16] loaded HEAD from S7 (vec_in norm=1.199269)
[S16] cosine check vs S7: cos=0.9844
[S16] BUFFERED delta from S7 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.360983)
[S3] loaded HEAD from S6 (vec_in norm=1.360983)
[S3] cosine check vs S6: cos=0.9909
[S3] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S4
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.955711)
[S15] loaded HEAD from S4 (vec_in norm=0.955711)
[S15] cosine check vs S4: cos=0.9604
[S15] BUFFERED delta from S4 (total buffered=1)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:63517
[S10] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.111707)
[S17] loaded HEAD from S10 (vec_in norm=1.111707)
[S17] cosine check vs S10: cos=0.9025
[S17] BUFFERED delta from S10 (total buffered=1)
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S7
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S11
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:63517
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:63511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S16] → sending delta(kind=head bytes=1787) to S9@127.0.0.1:63510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:63502
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1787 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1787) from S16
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.208324)
[S9] loaded HEAD from S16 (vec_in norm=1.208324)
[S9] cosine check vs S16: cos=0.9899
[S9] BUFFERED delta from S16 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1790) from S14
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.225603)
[S2] loaded HEAD from S14 (vec_in norm=1.225603)
[S2] cosine check vs S14: cos=0.9488
[S2] BUFFERED delta from S14 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1795) from S13
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.988659)
[S17] loaded HEAD from S13 (vec_in norm=0.988659)
[S17] cosine check vs S13: cos=0.9007
[S17] BUFFERED delta from S13 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1797) from S17
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.953769)
[S10] loaded HEAD from S17 (vec_in norm=0.953769)
[S10] cosine check vs S17: cos=0.9025
[S10] BUFFERED delta from S17 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.485239)
[S5] loaded HEAD from S11 (vec_in norm=1.485239)
[S5] cosine check vs S11: cos=-0.0207
[S5] DROPPED delta from S11 (cos=-0.0207 < 0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.3897 head_norm=0.953769
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.712176e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.3771 head_norm=0.965612 delta_norm=0.171218
[S17] aggregate: ROLLBACK (f1_val pre=0.390 post=0.377 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.8403 head_norm=1.208324
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.063333e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.8406 head_norm=1.199100 delta_norm=0.106333
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4]  timeout peer S15
[S15] CommDone barrier timeout: have=2 need=3 — continuing
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.6885 head_norm=0.964175
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.351384e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.6790 head_norm=0.950393 delta_norm=0.135138
[S15] aggregate: ROLLBACK (f1_val pre=0.688 post=0.679 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.671622 cos_to_last_merge=0.9989 (last merge round=14)
[S2] round=17 local utility u=0.124615 metrics={'f1_val': 0.7029215363667651, 'auprc': 0.7653325002352446, 'loss_val': 0.4102807290398391, 'psi': 0.7278859219141569}-{'f1_val': 0.7009533202285976, 'auprc': 0.6634406860484632, 'loss_val': 0.3420252046388943, 'psi': 0.6859482665565437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.7029 head_norm=1.689548
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.299368e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.7032 head_norm=1.438569 delta_norm=0.329937
[S2] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] START round=17 head_norm_before_train=1.367691 cos_to_last_merge=0.9996 (last merge round=15)
[S3] round=17 local utility u=0.008136 metrics={'f1_val': 0.7008362290767893, 'auprc': 0.9941665672459549, 'loss_val': 0.28048328949683055, 'psi': 0.8181683643444555}-{'f1_val': 0.700330919019862, 'auprc': 0.9939600855933477, 'loss_val': 0.29310344282345663, 'psi': 0.8177825856492563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.7008 head_norm=1.390987
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.052195e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.7008 head_norm=1.372038 delta_norm=0.105219
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] START round=17 head_norm_before_train=0.955711 cos_to_last_merge=0.9709 (last merge round=13)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.6645858894502484, 'auprc': 0.8453343252537175, 'loss_val': 0.5338531791376918, 'psi': 0.7368852637716361}-{'f1_val': 0.6749461563791138, 'auprc': 0.8558210776421546, 'loss_val': 0.5269874100702535, 'psi': 0.7472961248843302}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=17 head_norm_before_train=1.319515 cos_to_last_merge=0.8842 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.884
[S5] round=17 local utility u=0.522855 metrics={'f1_val': 0.7003221706489986, 'auprc': 0.9906254205201463, 'loss_val': 0.2915045569893639, 'psi': 0.8164434705974577}-{'f1_val': 0.6798022783483211, 'auprc': 0.7939458361065672, 'loss_val': 0.6240574390934429, 'psi': 0.7254597014516195}
[S6] START round=17 head_norm_before_train=1.360983 cos_to_last_merge=0.9915 (last merge round=12)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.6882137581986753, 'auprc': 0.7803443500118517, 'loss_val': 0.48726470373975467, 'psi': 0.7250659949239459}-{'f1_val': 0.8035177216228738, 'auprc': 0.9815812732528888, 'loss_val': 0.3225217021138295, 'psi': 0.8747431422748798}
[S7] START round=17 head_norm_before_train=1.199269 cos_to_last_merge=0.9908 (last merge round=13)
[S7] round=17 local utility u=0.004390 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.8227531362525746, 'loss_val': 0.8177263104103336, 'psi': 0.5791273253676439}-{'f1_val': 0.41671011811102343, 'auprc': 0.8199639092638176, 'loss_val': 0.8181385639981491, 'psi': 0.5780116345721411}
[S8] START round=17 head_norm_before_train=0.956809 cos_to_last_merge=0.9980 (last merge round=15)
[S8] round=17 local utility u=0.074030 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.9977308989236897, 'loss_val': 0.3232778915280092, 'psi': 0.8274248396479449}-{'f1_val': 0.7009086045093338, 'auprc': 0.9981554048747947, 'loss_val': 0.39473898748513614, 'psi': 0.8198073246555182}
[S9] START round=17 head_norm_before_train=1.304454 cos_to_last_merge=0.9995 (last merge round=15)
[S9] round=17 local utility u=0.001686 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.998475724100217, 'loss_val': 0.20065621078520035, 'psi': 0.820120238104098}-{'f1_val': 0.7012165807733519, 'auprc': 0.9980960454612441, 'loss_val': 0.2028882963791408, 'psi': 0.8199683666485088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.7012 head_norm=1.340701
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.221049e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.7012 head_norm=1.270375 delta_norm=0.122105
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] START round=17 head_norm_before_train=1.111707 cos_to_last_merge=0.9985 (last merge round=15)
[S10] round=17 local utility u=0.146443 metrics={'f1_val': 0.9897339741016268, 'auprc': 0.9958021134386483, 'loss_val': 0.2217618119544433, 'psi': 0.9921612298364355}-{'f1_val': 0.9587542390256161, 'auprc': 0.9939882345310557, 'loss_val': 0.32332823838998626, 'psi': 0.9728478372277919}
[S11] START round=17 head_norm_before_train=1.485239 cos_to_last_merge=0.8512 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.851
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.7079646396605977, 'auprc': 0.9988390109320422, 'loss_val': 0.22685590160693342, 'psi': 0.8243143881691755}-{'f1_val': 0.9474444785897367, 'auprc': 0.9983096082125584, 'loss_val': 0.23346714393282383, 'psi': 0.9677905304388654}
[S13] START round=17 head_norm_before_train=0.988659 cos_to_last_merge=0.9844 (last merge round=13)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5844275586698897, 'auprc': 0.5381085194417716, 'loss_val': 0.7887771781620806, 'psi': 0.5658999429786424}-{'f1_val': 0.5947306031690465, 'auprc': 0.5288588207998333, 'loss_val': 0.8117425813641828, 'psi': 0.5683818902213612}
[S14] START round=17 head_norm_before_train=1.225603 cos_to_last_merge=0.9987 (last merge round=15)
[S14] round=17 local utility u=0.028186 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971558419853261, 'loss_val': 0.17958435599049447, 'psi': 0.9974530076240427}-{'f1_val': 0.9980623665153463, 'auprc': 0.9971123506783578, 'loss_val': 0.23829286658890406, 'psi': 0.9976823601805509}
[S15] START round=17 head_norm_before_train=0.950393 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.393845 metrics={'f1_val': 0.769114912310773, 'auprc': 0.8664958268274211, 'loss_val': 0.39326209693884173, 'psi': 0.8080672781174323}-{'f1_val': 0.6884590176684433, 'auprc': 0.8078792505678766, 'loss_val': 0.5211666934942613, 'psi': 0.7362271108282166}
[S16] START round=17 head_norm_before_train=1.199100 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.110528 metrics={'f1_val': 0.8622647594434899, 'auprc': 0.9746428956290117, 'loss_val': 0.5330507052317524, 'psi': 0.9072160139176987}-{'f1_val': 0.840316431416719, 'auprc': 0.9181872237664974, 'loss_val': 0.45304967869006135, 'psi': 0.8714647483566302}
[S17] START round=17 head_norm_before_train=0.965612 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.021924 metrics={'f1_val': 0.41603529967696096, 'auprc': 0.6371964176268776, 'loss_val': 0.7893863203799112, 'psi': 0.5044997468569277}-{'f1_val': 0.3897494827312298, 'auprc': 0.6571668706878657, 'loss_val': 0.7354309744274464, 'psi': 0.49671643791388415}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.153783)
[S17] loaded HEAD from S10 (vec_in norm=1.153783)
[S17] cosine check vs S10: cos=0.9323
[S17] BUFFERED delta from S10 (total buffered=1)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9897 head_norm=1.153783
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.642766e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9590 head_norm=1.024989 delta_norm=0.264277
[S10] aggregate: ROLLBACK (f1_val pre=0.990 post=0.959 tol_abs=0.005 tol_rel=0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.282345)
[S8] loaded HEAD from S14 (vec_in norm=1.282345)
[S8] cosine check vs S14: cos=0.8872
[S8] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.993473)
[S13] loaded HEAD from S17 (vec_in norm=0.993473)
[S13] cosine check vs S17: cos=0.9302
[S13] BUFFERED delta from S17 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.7139 head_norm=0.998483
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.038754e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9679 head_norm=1.108309 delta_norm=0.303875
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.4160 head_norm=0.993473
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.127040e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.5569 head_norm=1.055395 delta_norm=0.212704
[S17] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7]  timeout peer S16
[S13]  timeout peer S17
[S6]  timeout peer S3
[S8]  timeout peer S13
[S8]  timeout peer S14
[S17]  timeout peer S7
[S17]  timeout peer S10
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S8
[S16]  timeout peer S4
[S16]  timeout peer S9
[S5]  timeout peer S11
[S14]  timeout peer S2
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:63508
[S16] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.996907)
[S4] loaded HEAD from S15 (vec_in norm=0.996907)
[S4] cosine check vs S15: cos=0.9813
[S4] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1793) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.236911)
[S7] loaded HEAD from S16 (vec_in norm=1.236911)
[S7] cosine check vs S16: cos=0.9907
[S7] BUFFERED delta from S16 (total buffered=1)
[S2] START round=18 head_norm_before_train=1.438569 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7013016308569164, 'auprc': 0.7209348596339934, 'loss_val': 0.3966052891998523, 'psi': 0.7091549223677472}-{'f1_val': 0.7029215363667651, 'auprc': 0.7653325002352446, 'loss_val': 0.4102807290398391, 'psi': 0.7278859219141569}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=18 head_norm_before_train=1.372038 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.003605 metrics={'f1_val': 0.7005769689796157, 'auprc': 0.9952778183776937, 'loss_val': 0.27505165664314246, 'psi': 0.8184573087388469}-{'f1_val': 0.7008362290767893, 'auprc': 0.9941665672459549, 'loss_val': 0.28048328949683055, 'psi': 0.8181683643444555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=18 head_norm_before_train=1.008799 cos_to_last_merge=0.9597 (last merge round=13)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.5347978985510663, 'auprc': 0.8566198514629144, 'loss_val': 0.4640454126414997, 'psi': 0.6635266797158055}-{'f1_val': 0.6645858894502484, 'auprc': 0.8453343252537175, 'loss_val': 0.5338531791376918, 'psi': 0.7368852637716361}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.5348 head_norm=1.052420
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.150966e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.6877 head_norm=1.018558 delta_norm=0.115097
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] START round=18 head_norm_before_train=1.331172 cos_to_last_merge=0.8817 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.882
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7003603281361598, 'auprc': 0.989880839422977, 'loss_val': 0.29815000498289845, 'psi': 0.8161685326508867}-{'f1_val': 0.7003221706489986, 'auprc': 0.9906254205201463, 'loss_val': 0.2915045569893639, 'psi': 0.8164434705974577}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=18 head_norm_before_train=1.391126 cos_to_last_merge=0.9885 (last merge round=12)
[S6] round=18 local utility u=0.135684 metrics={'f1_val': 0.7062692570556668, 'auprc': 0.8074175052767729, 'loss_val': 0.40545002642084416, 'psi': 0.7467285563441093}-{'f1_val': 0.6882137581986753, 'auprc': 0.7803443500118517, 'loss_val': 0.48726470373975467, 'psi': 0.7250659949239459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=18 head_norm_before_train=1.215069 cos_to_last_merge=0.9877 (last merge round=13)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7901042724648, 'loss_val': 0.8014919565070964, 'psi': 0.566067779852534}-{'f1_val': 0.41671011811102343, 'auprc': 0.8227531362525746, 'loss_val': 0.8177263104103336, 'psi': 0.5791273253676439}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.4167 head_norm=1.229883
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.236012e-02
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.4167 head_norm=1.229939 delta_norm=0.092360
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] START round=18 head_norm_before_train=1.108309 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.893229 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.998153262698823, 'loss_val': 0.2328811931097587, 'psi': 0.997073150040904}-{'f1_val': 0.7138874667974482, 'auprc': 0.9977308989236897, 'loss_val': 0.3232778915280092, 'psi': 0.8274248396479449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=18 head_norm_before_train=1.270375 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.858441 metrics={'f1_val': 0.9826668589742594, 'auprc': 0.9984660885233689, 'loss_val': 0.1724462192623931, 'psi': 0.9889865507939032}-{'f1_val': 0.7012165807733519, 'auprc': 0.998475724100217, 'loss_val': 0.20065621078520035, 'psi': 0.820120238104098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=18 head_norm_before_train=1.024989 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.000370 metrics={'f1_val': 0.9951887897730489, 'auprc': 0.9967117203940179, 'loss_val': 0.2564792442537968, 'psi': 0.9957979620214364}-{'f1_val': 0.9897339741016268, 'auprc': 0.9958021134386483, 'loss_val': 0.2217618119544433, 'psi': 0.9921612298364355}
[S11] START round=18 head_norm_before_train=1.515010 cos_to_last_merge=0.8485 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.849
[S11] round=18 local utility u=0.755453 metrics={'f1_val': 0.9547246252056056, 'auprc': 0.9982706512404034, 'loss_val': 0.19480515280079608, 'psi': 0.9721430356195246}-{'f1_val': 0.7079646396605977, 'auprc': 0.9988390109320422, 'loss_val': 0.22685590160693342, 'psi': 0.8243143881691755}
[S13] START round=18 head_norm_before_train=1.027794 cos_to_last_merge=0.9766 (last merge round=13)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.57125000521006, 'auprc': 0.5385331087130975, 'loss_val': 0.807794030025924, 'psi': 0.5581632466112749}-{'f1_val': 0.5844275586698897, 'auprc': 0.5381085194417716, 'loss_val': 0.7887771781620806, 'psi': 0.5658999429786424}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.5713 head_norm=1.068106
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.092335e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.5981 head_norm=1.010020 delta_norm=0.209233
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] START round=18 head_norm_before_train=1.282345 cos_to_last_merge=0.9954 (last merge round=15)
[S14] round=18 local utility u=0.019041 metrics={'f1_val': 0.9970229111636145, 'auprc': 0.9969834017119219, 'loss_val': 0.1372152172397968, 'psi': 0.9970071073829375}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971558419853261, 'loss_val': 0.17958435599049447, 'psi': 0.9974530076240427}
[S15] START round=18 head_norm_before_train=0.996907 cos_to_last_merge=0.9988 (last merge round=16)
[S15] round=18 local utility u=0.193787 metrics={'f1_val': 0.7859666328670433, 'auprc': 0.938307898509712, 'loss_val': 0.3222342147534976, 'psi': 0.8469031391241107}-{'f1_val': 0.769114912310773, 'auprc': 0.8664958268274211, 'loss_val': 0.39326209693884173, 'psi': 0.8080672781174323}
[S16] START round=18 head_norm_before_train=1.236911 cos_to_last_merge=0.9990 (last merge round=16)
[S16] round=18 local utility u=0.331193 metrics={'f1_val': 0.930330553155886, 'auprc': 0.9893563562118501, 'loss_val': 0.3231997712527948, 'psi': 0.9539408743782716}-{'f1_val': 0.8622647594434899, 'auprc': 0.9746428956290117, 'loss_val': 0.5330507052317524, 'psi': 0.9072160139176987}
[S17] START round=18 head_norm_before_train=1.055395 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.37655460321495915, 'auprc': 0.6736347735173793, 'loss_val': 0.9257078621656987, 'psi': 0.49538667133592723}-{'f1_val': 0.41603529967696096, 'auprc': 0.6371964176268776, 'loss_val': 0.7893863203799112, 'psi': 0.5044997468569277}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S16] → sending delta(kind=head bytes=1785) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:63505
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1785 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.041190)
[S4] loaded HEAD from S15 (vec_in norm=1.041190)
[S4] cosine check vs S15: cos=0.9913
[S4] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1785) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.280327)
[S7] loaded HEAD from S16 (vec_in norm=1.280327)
[S7] cosine check vs S16: cos=0.9940
[S7] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.329337)
[S8] loaded HEAD from S14 (vec_in norm=1.329337)
[S8] cosine check vs S14: cos=0.9712
[S8] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.542954)
[S5] loaded HEAD from S11 (vec_in norm=1.542954)
[S5] cosine check vs S11: cos=-0.0181
[S5] DROPPED delta from S11 (cos=-0.0181 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:63517
[S10] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.069135)
[S17] loaded HEAD from S10 (vec_in norm=1.069135)
[S17] cosine check vs S10: cos=0.9960
[S17] BUFFERED delta from S10 (total buffered=1)
[S2] START round=19 head_norm_before_train=1.456634 cos_to_last_merge=0.9998 (last merge round=17)
[S2] round=19 local utility u=0.053904 metrics={'f1_val': 0.7076879472520883, 'auprc': 0.792340592366333, 'loss_val': 0.5413317073482884, 'psi': 0.7415490052977862}-{'f1_val': 0.7013016308569164, 'auprc': 0.7209348596339934, 'loss_val': 0.3966052891998523, 'psi': 0.7091549223677472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S2] r=20 psi=0.742 u=0.0539 p_local=0.0742 f1=0.708 auprc=0.792 bytes=25179
[S3] START round=19 head_norm_before_train=1.391219 cos_to_last_merge=0.9998 (last merge round=17)
[S3] round=19 local utility u=0.001820 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9941673516829821, 'loss_val': 0.26810700953687705, 'psi': 0.8180157782684458}-{'f1_val': 0.7005769689796157, 'auprc': 0.9952778183776937, 'loss_val': 0.27505165664314246, 'psi': 0.8184573087388469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S3] r=20 psi=0.818 u=0.0018 p_local=0.1442 f1=0.701 auprc=0.994 bytes=26946
[S4] START round=19 head_norm_before_train=1.018558 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.219388 metrics={'f1_val': 0.6138905707332077, 'auprc': 0.8545547764275868, 'loss_val': 0.49362995572778856, 'psi': 0.7101562530109593}-{'f1_val': 0.5347978985510663, 'auprc': 0.8566198514629144, 'loss_val': 0.4640454126414997, 'psi': 0.6635266797158055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.6139 head_norm=1.060154
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.400996e-02
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.6157 head_norm=1.047351 delta_norm=0.084010
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.710 u=0.2194 p_local=0.1555 f1=0.614 auprc=0.855 bytes=17973
[S5] START round=19 head_norm_before_train=1.344721 cos_to_last_merge=0.8792 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.879
[S5] round=19 local utility u=0.014784 metrics={'f1_val': 0.7006099296049884, 'auprc': 0.9905234175572457, 'loss_val': 0.27200670139494865, 'psi': 0.8165753247858913}-{'f1_val': 0.7003603281361598, 'auprc': 0.989880839422977, 'loss_val': 0.29815000498289845, 'psi': 0.8161685326508867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S5] r=20 psi=0.817 u=0.0148 p_local=0.1655 f1=0.701 auprc=0.991 bytes=25169
[S6] START round=19 head_norm_before_train=1.417066 cos_to_last_merge=0.9857 (last merge round=12)
[S6] round=19 local utility u=0.229079 metrics={'f1_val': 0.7072158277222031, 'auprc': 0.9335243394139733, 'loss_val': 0.33129211072878206, 'psi': 0.7977392323989112}-{'f1_val': 0.7062692570556668, 'auprc': 0.8074175052767729, 'loss_val': 0.40545002642084416, 'psi': 0.7467285563441093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S6] r=20 psi=0.798 u=0.2291 p_local=0.2704 f1=0.707 auprc=0.934 bytes=26939
[S7] START round=19 head_norm_before_train=1.229939 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.78293933785186, 'loss_val': 0.7967772879023427, 'psi': 0.563201806007358}-{'f1_val': 0.41671011811102343, 'auprc': 0.7901042724648, 'loss_val': 0.8014919565070964, 'psi': 0.566067779852534}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.4167 head_norm=1.243247
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.806345e-02
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.4167 head_norm=1.259506 delta_norm=0.078063
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.563 u=0.0000 p_local=0.0412 f1=0.417 auprc=0.783 bytes=28710
[S8] START round=19 head_norm_before_train=1.152889 cos_to_last_merge=0.9988 (last merge round=17)
[S8] round=19 local utility u=0.022671 metrics={'f1_val': 0.9960662206126181, 'auprc': 0.9984808560725779, 'loss_val': 0.18680113198117013, 'psi': 0.9970320747966019}-{'f1_val': 0.9963530749356245, 'auprc': 0.998153262698823, 'loss_val': 0.2328811931097587, 'psi': 0.997073150040904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9961 head_norm=1.197426
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.770281e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9961 head_norm=1.252655 delta_norm=0.177028
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.997 u=0.0227 p_local=0.2383 f1=0.996 auprc=0.998 bytes=26932
[S9] START round=19 head_norm_before_train=1.309190 cos_to_last_merge=0.9992 (last merge round=17)
[S9] round=19 local utility u=0.000574 metrics={'f1_val': 0.9787460450212913, 'auprc': 0.9984677943939527, 'loss_val': 0.14777767416544615, 'psi': 0.9866347447703558}-{'f1_val': 0.9826668589742594, 'auprc': 0.9984660885233689, 'loss_val': 0.1724462192623931, 'psi': 0.9889865507939032}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S9] r=20 psi=0.987 u=0.0006 p_local=0.1799 f1=0.979 auprc=0.998 bytes=28760
[S10] START round=19 head_norm_before_train=1.069135 cos_to_last_merge=0.9984 (last merge round=17)
[S10] round=19 local utility u=0.009735 metrics={'f1_val': 0.9951887897730489, 'auprc': 0.993209794105433, 'loss_val': 0.22650255498305438, 'psi': 0.9943971915060025}-{'f1_val': 0.9951887897730489, 'auprc': 0.9967117203940179, 'loss_val': 0.2564792442537968, 'psi': 0.9957979620214364}
[S11] START round=19 head_norm_before_train=1.542954 cos_to_last_merge=0.8466 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.847
[S11] round=19 local utility u=0.013267 metrics={'f1_val': 0.955923326508306, 'auprc': 0.9983980187006236, 'loss_val': 0.17584525656106592, 'psi': 0.972913203385233}-{'f1_val': 0.9547246252056056, 'auprc': 0.9982706512404034, 'loss_val': 0.19480515280079608, 'psi': 0.9721430356195246}
[S13] START round=19 head_norm_before_train=1.010020 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.207724 metrics={'f1_val': 0.606110006305576, 'auprc': 0.5886523852687999, 'loss_val': 0.7518631450963948, 'psi': 0.5991269578908656}-{'f1_val': 0.57125000521006, 'auprc': 0.5385331087130975, 'loss_val': 0.807794030025924, 'psi': 0.5581632466112749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S13] r=20 psi=0.599 u=0.2077 p_local=0.1612 f1=0.606 auprc=0.589 bytes=19745
[S14] START round=19 head_norm_before_train=1.329337 cos_to_last_merge=0.9919 (last merge round=15)
[S14] round=19 local utility u=0.004875 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9961255619382394, 'loss_val': 0.12866103465230985, 'psi': 0.9970408956052079}-{'f1_val': 0.9970229111636145, 'auprc': 0.9969834017119219, 'loss_val': 0.1372152172397968, 'psi': 0.9970071073829375}
[S15] START round=19 head_norm_before_train=1.041190 cos_to_last_merge=0.9960 (last merge round=16)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.695941051067822, 'auprc': 0.7995350305490588, 'loss_val': 0.518049828989453, 'psi': 0.7373786428603168}-{'f1_val': 0.7859666328670433, 'auprc': 0.938307898509712, 'loss_val': 0.3222342147534976, 'psi': 0.8469031391241107}
[S16] START round=19 head_norm_before_train=1.280327 cos_to_last_merge=0.9962 (last merge round=16)
[S16] round=19 local utility u=0.072231 metrics={'f1_val': 0.9402650323309663, 'auprc': 0.993616528299133, 'loss_val': 0.25112450729937646, 'psi': 0.961605630718233}-{'f1_val': 0.930330553155886, 'auprc': 0.9893563562118501, 'loss_val': 0.3231997712527948, 'psi': 0.9539408743782716}
[S17] START round=19 head_norm_before_train=1.079437 cos_to_last_merge=0.9990 (last merge round=17)
[S17] round=19 local utility u=0.191600 metrics={'f1_val': 0.3755339791843324, 'auprc': 0.8175609356828202, 'loss_val': 0.9681620356476927, 'psi': 0.5523447617837275}-{'f1_val': 0.37655460321495915, 'auprc': 0.6736347735173793, 'loss_val': 0.9257078621656987, 'psi': 0.49538667133592723}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:63509
[S16] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] r=20 psi=0.737 u=0.0000 p_local=0.1567 f1=0.696 auprc=0.800 bytes=25160
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.323068)
[S7] loaded HEAD from S16 (vec_in norm=1.323068)
[S7] cosine check vs S16: cos=0.9957
[S7] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1805) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.369558)
[S8] loaded HEAD from S14 (vec_in norm=1.369558)
[S8] cosine check vs S14: cos=0.9904
[S8] BUFFERED delta from S14 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.100524)
[S13] loaded HEAD from S17 (vec_in norm=1.100524)
[S13] cosine check vs S17: cos=0.9375
[S13] BUFFERED delta from S17 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.120205)
[S17] loaded HEAD from S10 (vec_in norm=1.120205)
[S17] cosine check vs S10: cos=0.9905
[S17] BUFFERED delta from S10 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.572233)
[S5] loaded HEAD from S11 (vec_in norm=1.572233)
[S5] cosine check vs S11: cos=-0.0178
[S5] DROPPED delta from S11 (cos=-0.0178 < 0.0)
[S14] r=20 psi=0.997 u=0.0049 p_local=0.1119 f1=0.998 auprc=0.996 bytes=26970
[S11] r=20 psi=0.973 u=0.0133 p_local=0.2755 f1=0.956 auprc=0.998 bytes=30573
[S16] r=20 psi=0.962 u=0.0722 p_local=0.2557 f1=0.940 auprc=0.994 bytes=28678
[S10] r=20 psi=0.994 u=0.0097 p_local=0.1650 f1=0.995 auprc=0.993 bytes=32358
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.3755 head_norm=1.100524
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.639089e-02
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.3759 head_norm=1.095391 delta_norm=0.066391
[S17] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S17] r=20 psi=0.552 u=0.1916 p_local=0.1119 f1=0.376 auprc=0.818 bytes=19745
[S2] START round=20 head_norm_before_train=1.478929 cos_to_last_merge=0.9993 (last merge round=17)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7005679037941495, 'auprc': 0.664213235901557, 'loss_val': 0.3925663265130509, 'psi': 0.6860260366371125}-{'f1_val': 0.7076879472520883, 'auprc': 0.792340592366333, 'loss_val': 0.5413317073482884, 'psi': 0.7415490052977862}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=20 head_norm_before_train=1.410061 cos_to_last_merge=0.9993 (last merge round=17)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9941667457219082, 'loss_val': 0.2675769588681042, 'psi': 0.8178652497006805}-{'f1_val': 0.7005813959920884, 'auprc': 0.9941673516829821, 'loss_val': 0.26810700953687705, 'psi': 0.8180157782684458}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=20 head_norm_before_train=1.047351 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.216057 metrics={'f1_val': 0.6737834903432153, 'auprc': 0.8651843283739226, 'loss_val': 0.4527618773856273, 'psi': 0.7503438255554982}-{'f1_val': 0.6138905707332077, 'auprc': 0.8545547764275868, 'loss_val': 0.49362995572778856, 'psi': 0.7101562530109593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=20 head_norm_before_train=1.365467 cos_to_last_merge=0.8758 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.876
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.7044651449286463, 'auprc': 0.9556676534713741, 'loss_val': 0.28615996527620347, 'psi': 0.8049461483457374}-{'f1_val': 0.7006099296049884, 'auprc': 0.9905234175572457, 'loss_val': 0.27200670139494865, 'psi': 0.8165753247858913}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=20 head_norm_before_train=1.440201 cos_to_last_merge=0.9830 (last merge round=12)
[S6] round=20 local utility u=0.725243 metrics={'f1_val': 0.9323349192555894, 'auprc': 0.9573906612295405, 'loss_val': 0.30311967070978446, 'psi': 0.9423572160451699}-{'f1_val': 0.7072158277222031, 'auprc': 0.9335243394139733, 'loss_val': 0.33129211072878206, 'psi': 0.7977392323989112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=20 head_norm_before_train=1.259506 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.002108 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7796744285765156, 'loss_val': 0.7827673810445345, 'psi': 0.5618958422972202}-{'f1_val': 0.41671011811102343, 'auprc': 0.78293933785186, 'loss_val': 0.7967772879023427, 'psi': 0.563201806007358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] sending update (kind=head size=1791 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.4167 head_norm=1.272912
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.290904e-02
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.4167 head_norm=1.296184 delta_norm=0.072909
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] START round=20 head_norm_before_train=1.252655 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.009392 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9978980836256666, 'loss_val': 0.16798931644901088, 'psi': 0.9969710784116415}-{'f1_val': 0.9960662206126181, 'auprc': 0.9984808560725779, 'loss_val': 0.18680113198117013, 'psi': 0.9970320747966019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9964 head_norm=1.292772
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.161739e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9965 head_norm=1.326641 delta_norm=0.116174
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] START round=20 head_norm_before_train=1.354929 cos_to_last_merge=0.9967 (last merge round=17)
[S9] round=20 local utility u=0.021387 metrics={'f1_val': 0.9837128737439169, 'auprc': 0.998165422395309, 'loss_val': 0.13389752470772254, 'psi': 0.9894938932044738}-{'f1_val': 0.9787460450212913, 'auprc': 0.9984677943939527, 'loss_val': 0.14777767416544615, 'psi': 0.9866347447703558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=20 head_norm_before_train=1.120205 cos_to_last_merge=0.9940 (last merge round=17)
[S10] round=20 local utility u=0.016207 metrics={'f1_val': 0.9951887897730489, 'auprc': 0.9925261973593826, 'loss_val': 0.19203826194448065, 'psi': 0.9941237528075824}-{'f1_val': 0.9951887897730489, 'auprc': 0.993209794105433, 'loss_val': 0.22650255498305438, 'psi': 0.9943971915060025}
[S11] START round=20 head_norm_before_train=1.572233 cos_to_last_merge=0.8450 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.845
[S11] round=20 local utility u=0.021540 metrics={'f1_val': 0.9601592860089405, 'auprc': 0.9985326950704516, 'loss_val': 0.1585844465709871, 'psi': 0.975508649633545}-{'f1_val': 0.955923326508306, 'auprc': 0.9983980187006236, 'loss_val': 0.17584525656106592, 'psi': 0.972913203385233}
[S13] START round=20 head_norm_before_train=1.048358 cos_to_last_merge=0.9989 (last merge round=18)
[S13] round=20 local utility u=0.044314 metrics={'f1_val': 0.6129798833673572, 'auprc': 0.5959510741896161, 'loss_val': 0.7263500338059168, 'psi': 0.6061683596962608}-{'f1_val': 0.606110006305576, 'auprc': 0.5886523852687999, 'loss_val': 0.7518631450963948, 'psi': 0.5991269578908656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.6130 head_norm=1.078173
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.043615e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.6254 head_norm=1.070066 delta_norm=0.204362
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] START round=20 head_norm_before_train=1.369558 cos_to_last_merge=0.9884 (last merge round=15)
[S14] round=20 local utility u=0.017902 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.99715315011197, 'loss_val': 0.09349504635426172, 'psi': 0.9972073971022114}-{'f1_val': 0.9976511180498535, 'auprc': 0.9961255619382394, 'loss_val': 0.12866103465230985, 'psi': 0.9970408956052079}
[S15] START round=20 head_norm_before_train=1.081290 cos_to_last_merge=0.9926 (last merge round=16)
[S15] round=20 local utility u=0.334630 metrics={'f1_val': 0.762187196646367, 'auprc': 0.8413775338415147, 'loss_val': 0.3717935785120619, 'psi': 0.7938633315244261}-{'f1_val': 0.695941051067822, 'auprc': 0.7995350305490588, 'loss_val': 0.518049828989453, 'psi': 0.7373786428603168}
[S16] START round=20 head_norm_before_train=1.323068 cos_to_last_merge=0.9921 (last merge round=16)
[S16] round=20 local utility u=0.160841 metrics={'f1_val': 0.9815308670238913, 'auprc': 0.993911492515637, 'loss_val': 0.17792218731400733, 'psi': 0.9864831172205897}-{'f1_val': 0.9402650323309663, 'auprc': 0.993616528299133, 'loss_val': 0.25112450729937646, 'psi': 0.961605630718233}
[S17] START round=20 head_norm_before_train=1.095391 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.067512 metrics={'f1_val': 0.38236806510252563, 'auprc': 0.8263751170925265, 'loss_val': 0.9005848183950768, 'psi': 0.559970885898526}-{'f1_val': 0.3755339791843324, 'auprc': 0.8175609356828202, 'loss_val': 0.9681620356476927, 'psi': 0.5523447617837275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:63509
[S16] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.168988)
[S17] loaded HEAD from S10 (vec_in norm=1.168988)
[S17] cosine check vs S10: cos=0.9917
[S17] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.597163)
[S5] loaded HEAD from S11 (vec_in norm=1.597163)
[S5] cosine check vs S11: cos=-0.0164
[S5] DROPPED delta from S11 (cos=-0.0164 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1804) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.116045)
[S4] loaded HEAD from S15 (vec_in norm=1.116045)
[S4] cosine check vs S15: cos=0.9900
[S4] BUFFERED delta from S15 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.115180)
[S13] loaded HEAD from S17 (vec_in norm=1.115180)
[S13] cosine check vs S17: cos=0.9769
[S13] BUFFERED delta from S17 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.365474)
[S7] loaded HEAD from S16 (vec_in norm=1.365474)
[S7] cosine check vs S16: cos=0.9968
[S7] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1803) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.403486)
[S8] loaded HEAD from S14 (vec_in norm=1.403486)
[S8] cosine check vs S14: cos=0.9957
[S8] BUFFERED delta from S14 (total buffered=1)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.3824 head_norm=1.115180
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.847799e-02
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.3864 head_norm=1.139702 delta_norm=0.078478
[S17] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.103 → S13@127.0.0.1:63513
[S10] ⇄ pheromone p=0.135 → S17@127.0.0.1:63517
[S15] ⇄ pheromone p=0.192 → S4@127.0.0.1:63504
[S14] ⇄ pheromone p=0.093 → S8@127.0.0.1:63509
[S11] ⇄ pheromone p=0.225 → S5@127.0.0.1:63505
[S16] ⇄ pheromone p=0.237 → S7@127.0.0.1:63508
[S2] START round=21 head_norm_before_train=1.498243 cos_to_last_merge=0.9986 (last merge round=17)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.6986023796094776, 'auprc': 0.6637388064285001, 'loss_val': 0.4010177601497724, 'psi': 0.6846569503370866}-{'f1_val': 0.7005679037941495, 'auprc': 0.664213235901557, 'loss_val': 0.3925663265130509, 'psi': 0.6860260366371125}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=21 head_norm_before_train=1.431488 cos_to_last_merge=0.9989 (last merge round=17)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.6947844743292331, 'auprc': 0.9943180402892352, 'loss_val': 0.25623205141995364, 'psi': 0.814597900713234}-{'f1_val': 0.700330919019862, 'auprc': 0.9941667457219082, 'loss_val': 0.2675769588681042, 'psi': 0.8178652497006805}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=21 head_norm_before_train=1.083786 cos_to_last_merge=0.9995 (last merge round=19)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.6172550229056634, 'auprc': 0.8495210619235638, 'loss_val': 0.504607185480986, 'psi': 0.7101614385128235}-{'f1_val': 0.6737834903432153, 'auprc': 0.8651843283739226, 'loss_val': 0.4527618773856273, 'psi': 0.7503438255554982}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.6173 head_norm=1.120439
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.034436e-02
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.6184 head_norm=1.114589 delta_norm=0.090344
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] START round=21 head_norm_before_train=1.382387 cos_to_last_merge=0.8724 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.872
[S5] round=21 local utility u=0.070632 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9896680437230014, 'loss_val': 0.22375682722763768, 'psi': 0.8162322530868051}-{'f1_val': 0.7044651449286463, 'auprc': 0.9556676534713741, 'loss_val': 0.28615996527620347, 'psi': 0.8049461483457374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=21 head_norm_before_train=1.462648 cos_to_last_merge=0.9801 (last merge round=12)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.7088947357698112, 'auprc': 0.8051561735749154, 'loss_val': 0.4575848969770942, 'psi': 0.7473993108918529}-{'f1_val': 0.9323349192555894, 'auprc': 0.9573906612295405, 'loss_val': 0.30311967070978446, 'psi': 0.9423572160451699}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=21 head_norm_before_train=1.296184 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.831871 metrics={'f1_val': 0.6889031164465604, 'auprc': 0.7815927723272935, 'loss_val': 0.7579381210831407, 'psi': 0.7259789787988538}-{'f1_val': 0.41671011811102343, 'auprc': 0.7796744285765156, 'loss_val': 0.7827673810445345, 'psi': 0.5618958422972202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.6889 head_norm=1.308755
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.138731e-02
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.7119 head_norm=1.335509 delta_norm=0.071387
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] START round=21 head_norm_before_train=1.326641 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.013449 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9979905108308774, 'loss_val': 0.14136774136146255, 'psi': 0.9970080492937257}-{'f1_val': 0.9963530749356245, 'auprc': 0.9978980836256666, 'loss_val': 0.16798931644901088, 'psi': 0.9969710784116415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9964 head_norm=1.362119
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.516664e-02
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9964 head_norm=1.380333 delta_norm=0.085167
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] START round=21 head_norm_before_train=1.399417 cos_to_last_merge=0.9934 (last merge round=17)
[S9] round=21 local utility u=0.053623 metrics={'f1_val': 0.9947440946163844, 'auprc': 0.998452972479992, 'loss_val': 0.09370177046298805, 'psi': 0.9962276457618274}-{'f1_val': 0.9837128737439169, 'auprc': 0.998165422395309, 'loss_val': 0.13389752470772254, 'psi': 0.9894938932044738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=21 head_norm_before_train=1.168988 cos_to_last_merge=0.9884 (last merge round=17)
[S10] round=21 local utility u=0.021000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9935672493794919, 'loss_val': 0.14816611791349918, 'psi': 0.9940407387788496}-{'f1_val': 0.9951887897730489, 'auprc': 0.9925261973593826, 'loss_val': 0.19203826194448065, 'psi': 0.9941237528075824}
[S11] START round=21 head_norm_before_train=1.597163 cos_to_last_merge=0.8432 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.843
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9573527113557667, 'auprc': 0.998822332596935, 'loss_val': 0.14357661629408686, 'psi': 0.973940559852234}-{'f1_val': 0.9601592860089405, 'auprc': 0.9985326950704516, 'loss_val': 0.1585844465709871, 'psi': 0.975508649633545}
[S13] START round=21 head_norm_before_train=1.070066 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.102169 metrics={'f1_val': 0.6054182864625355, 'auprc': 0.6814002081814398, 'loss_val': 0.7329894997806526, 'psi': 0.6358110551500972}-{'f1_val': 0.6129798833673572, 'auprc': 0.5959510741896161, 'loss_val': 0.7263500338059168, 'psi': 0.6061683596962608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.6054 head_norm=1.096351
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.340381e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.6107 head_norm=1.097652 delta_norm=0.134038
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] START round=21 head_norm_before_train=1.403486 cos_to_last_merge=0.9852 (last merge round=15)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971492635399066, 'loss_val': 0.10349134513618688, 'psi': 0.9970582103105616}-{'f1_val': 0.9972435617623723, 'auprc': 0.99715315011197, 'loss_val': 0.09349504635426172, 'psi': 0.9972073971022114}
[S15] START round=21 head_norm_before_train=1.116045 cos_to_last_merge=0.9893 (last merge round=16)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.732746098757264, 'auprc': 0.8314809647499408, 'loss_val': 0.36143614543008823, 'psi': 0.7722400451543348}-{'f1_val': 0.762187196646367, 'auprc': 0.8413775338415147, 'loss_val': 0.3717935785120619, 'psi': 0.7938633315244261}
[S16] START round=21 head_norm_before_train=1.365474 cos_to_last_merge=0.9879 (last merge round=16)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8658787812795847, 'auprc': 0.9946678113468703, 'loss_val': 0.5149692747098228, 'psi': 0.917394393306499}-{'f1_val': 0.9815308670238913, 'auprc': 0.993911492515637, 'loss_val': 0.17792218731400733, 'psi': 0.9864831172205897}
[S17] START round=21 head_norm_before_train=1.139702 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.37826251765244334, 'auprc': 0.8209673250676222, 'loss_val': 0.9276723778536283, 'psi': 0.5553444406185148}-{'f1_val': 0.38236806510252563, 'auprc': 0.8263751170925265, 'loss_val': 0.9005848183950768, 'psi': 0.559970885898526}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=22 head_norm_before_train=1.519175 cos_to_last_merge=0.9979 (last merge round=17)
[S2] round=22 local utility u=0.123641 metrics={'f1_val': 0.7016138473266027, 'auprc': 0.7440659018835922, 'loss_val': 0.41278620895532586, 'psi': 0.7185946691493985}-{'f1_val': 0.6986023796094776, 'auprc': 0.6637388064285001, 'loss_val': 0.4010177601497724, 'psi': 0.6846569503370866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=22 head_norm_before_train=1.450962 cos_to_last_merge=0.9977 (last merge round=17)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.6881354888248631, 'auprc': 0.9930889144793483, 'loss_val': 0.25708130783697314, 'psi': 0.8101168590866572}-{'f1_val': 0.6947844743292331, 'auprc': 0.9943180402892352, 'loss_val': 0.25623205141995364, 'psi': 0.814597900713234}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=1.114589 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.350067 metrics={'f1_val': 0.6741160526121323, 'auprc': 0.9448313572594768, 'loss_val': 0.4315707284644806, 'psi': 0.7824021744710701}-{'f1_val': 0.6172550229056634, 'auprc': 0.8495210619235638, 'loss_val': 0.504607185480986, 'psi': 0.7101614385128235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=22 head_norm_before_train=1.396883 cos_to_last_merge=0.8699 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.870
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9896471718539002, 'loss_val': 0.2552592027725878, 'psi': 0.8162239043391646}-{'f1_val': 0.7006083926626743, 'auprc': 0.9896680437230014, 'loss_val': 0.22375682722763768, 'psi': 0.8162322530868051}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=22 head_norm_before_train=1.484980 cos_to_last_merge=0.9772 (last merge round=12)
[S6] round=22 local utility u=0.295458 metrics={'f1_val': 0.789220428919555, 'auprc': 0.810544950980281, 'loss_val': 0.36478861347315394, 'psi': 0.7977502377438455}-{'f1_val': 0.7088947357698112, 'auprc': 0.8051561735749154, 'loss_val': 0.4575848969770942, 'psi': 0.7473993108918529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=22 head_norm_before_train=1.335509 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.5307966639400862, 'auprc': 0.7802702267175021, 'loss_val': 0.7834132131567427, 'psi': 0.6305860890510526}-{'f1_val': 0.6889031164465604, 'auprc': 0.7815927723272935, 'loss_val': 0.7579381210831407, 'psi': 0.7259789787988538}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=22 head_norm_before_train=1.380333 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.003999 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9976239410685077, 'loss_val': 0.13137082735015287, 'psi': 0.9967714384674948}-{'f1_val': 0.9963530749356245, 'auprc': 0.9979905108308774, 'loss_val': 0.14136774136146255, 'psi': 0.9970080492937257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=22 head_norm_before_train=1.440884 cos_to_last_merge=0.9889 (last merge round=17)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9896951746952075, 'auprc': 0.9984519503659963, 'loss_val': 0.077101626188036, 'psi': 0.993197884963523}-{'f1_val': 0.9947440946163844, 'auprc': 0.998452972479992, 'loss_val': 0.09370177046298805, 'psi': 0.9962276457618274}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=22 head_norm_before_train=1.212862 cos_to_last_merge=0.9830 (last merge round=17)
[S10] round=22 local utility u=0.015041 metrics={'f1_val': 0.9947781979029806, 'auprc': 0.99479859983407, 'loss_val': 0.12430818939750128, 'psi': 0.9947863586754164}-{'f1_val': 0.9943563983784213, 'auprc': 0.9935672493794919, 'loss_val': 0.14816611791349918, 'psi': 0.9940407387788496}
[S11] START round=22 head_norm_before_train=1.625486 cos_to_last_merge=0.8417 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.842
[S11] round=22 local utility u=0.135328 metrics={'f1_val': 0.9975505764362702, 'auprc': 0.9988198121670928, 'loss_val': 0.11410043872700176, 'psi': 0.9980582707285992}-{'f1_val': 0.9573527113557667, 'auprc': 0.998822332596935, 'loss_val': 0.14357661629408686, 'psi': 0.973940559852234}
[S13] START round=22 head_norm_before_train=1.097652 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.058777 metrics={'f1_val': 0.6167581814585075, 'auprc': 0.6879043945190826, 'loss_val': 0.7029882417901752, 'psi': 0.6452166666827375}-{'f1_val': 0.6054182864625355, 'auprc': 0.6814002081814398, 'loss_val': 0.7329894997806526, 'psi': 0.6358110551500972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=22 head_norm_before_train=1.433142 cos_to_last_merge=0.9822 (last merge round=15)
[S14] round=22 local utility u=0.017714 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.998234858275879, 'loss_val': 0.074233095023299, 'psi': 0.9977837899402442}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971492635399066, 'loss_val': 0.10349134513618688, 'psi': 0.9970582103105616}
[S15] START round=22 head_norm_before_train=1.143537 cos_to_last_merge=0.9866 (last merge round=16)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.6973184083716771, 'auprc': 0.7995323396731289, 'loss_val': 0.4934606299450918, 'psi': 0.7382039808922578}-{'f1_val': 0.732746098757264, 'auprc': 0.8314809647499408, 'loss_val': 0.36143614543008823, 'psi': 0.7722400451543348}
[S16] START round=22 head_norm_before_train=1.405649 cos_to_last_merge=0.9837 (last merge round=16)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8667070083015459, 'auprc': 0.9911816232896558, 'loss_val': 0.551333534293397, 'psi': 0.9164968542967898}-{'f1_val': 0.8658787812795847, 'auprc': 0.9946678113468703, 'loss_val': 0.5149692747098228, 'psi': 0.917394393306499}
[S17] START round=22 head_norm_before_train=1.161338 cos_to_last_merge=0.9995 (last merge round=20)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.3735188774900605, 'auprc': 0.7948606721105167, 'loss_val': 1.0430962217578024, 'psi': 0.542055595338243}-{'f1_val': 0.37826251765244334, 'auprc': 0.8209673250676222, 'loss_val': 0.9276723778536283, 'psi': 0.5553444406185148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=23 head_norm_before_train=1.541020 cos_to_last_merge=0.9970 (last merge round=17)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7074331183246881, 'auprc': 0.6729535196464627, 'loss_val': 0.4404148291074651, 'psi': 0.6936412788533979}-{'f1_val': 0.7016138473266027, 'auprc': 0.7440659018835922, 'loss_val': 0.41278620895532586, 'psi': 0.7185946691493985}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=23 head_norm_before_train=1.471761 cos_to_last_merge=0.9961 (last merge round=17)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.653311310212793, 'auprc': 0.9931310379312546, 'loss_val': 0.33060110729758574, 'psi': 0.7892392013001777}-{'f1_val': 0.6881354888248631, 'auprc': 0.9930889144793483, 'loss_val': 0.25708130783697314, 'psi': 0.8101168590866572}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=23 head_norm_before_train=1.144678 cos_to_last_merge=0.9996 (last merge round=21)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.6434805082972325, 'auprc': 0.9490204025236821, 'loss_val': 0.4488349348400727, 'psi': 0.7656964659878123}-{'f1_val': 0.6741160526121323, 'auprc': 0.9448313572594768, 'loss_val': 0.4315707284644806, 'psi': 0.7824021744710701}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=23 head_norm_before_train=1.411045 cos_to_last_merge=0.8678 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.868
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.7006728406085594, 'auprc': 0.9895411370588016, 'loss_val': 0.25641426687067, 'psi': 0.8162201591886563}-{'f1_val': 0.7006083926626743, 'auprc': 0.9896471718539002, 'loss_val': 0.2552592027725878, 'psi': 0.8162239043391646}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=23 head_norm_before_train=1.503559 cos_to_last_merge=0.9746 (last merge round=12)
[S6] round=23 local utility u=0.847723 metrics={'f1_val': 0.9596753963393896, 'auprc': 0.9753712570129425, 'loss_val': 0.18655128352607353, 'psi': 0.9659537406088107}-{'f1_val': 0.789220428919555, 'auprc': 0.810544950980281, 'loss_val': 0.36478861347315394, 'psi': 0.7977502377438455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=23 head_norm_before_train=1.348728 cos_to_last_merge=0.9997 (last merge round=21)
[S7] round=23 local utility u=0.472603 metrics={'f1_val': 0.667132461399256, 'auprc': 0.7834338861783141, 'loss_val': 0.6657126877207694, 'psi': 0.7136530313108792}-{'f1_val': 0.5307966639400862, 'auprc': 0.7802702267175021, 'loss_val': 0.7834132131567427, 'psi': 0.6305860890510526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=23 head_norm_before_train=1.412346 cos_to_last_merge=0.9995 (last merge round=21)
[S8] round=23 local utility u=0.005180 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.998218723597069, 'loss_val': 0.12279503630941091, 'psi': 0.9970093514789193}-{'f1_val': 0.9962031034001528, 'auprc': 0.9976239410685077, 'loss_val': 0.13137082735015287, 'psi': 0.9967714384674948}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=23 head_norm_before_train=1.481389 cos_to_last_merge=0.9834 (last merge round=17)
[S9] round=23 local utility u=0.024484 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9964879714063132, 'loss_val': 0.06403362692161653, 'psi': 0.9965914956508601}-{'f1_val': 0.9896951746952075, 'auprc': 0.9984519503659963, 'loss_val': 0.077101626188036, 'psi': 0.993197884963523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=23 head_norm_before_train=1.252293 cos_to_last_merge=0.9780 (last merge round=17)
[S10] round=23 local utility u=0.011284 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9956539050925068, 'loss_val': 0.1092939087556367, 'psi': 0.9956273541460146}-{'f1_val': 0.9947781979029806, 'auprc': 0.99479859983407, 'loss_val': 0.12430818939750128, 'psi': 0.9947863586754164}
[S11] START round=23 head_norm_before_train=1.651544 cos_to_last_merge=0.8402 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.840
[S11] round=23 local utility u=0.006619 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.9988867534615542, 'loss_val': 0.10002776432586645, 'psi': 0.9979815532472374}-{'f1_val': 0.9975505764362702, 'auprc': 0.9988198121670928, 'loss_val': 0.11410043872700176, 'psi': 0.9980582707285992}
[S13] START round=23 head_norm_before_train=1.129388 cos_to_last_merge=0.9988 (last merge round=21)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6120782600577904, 'auprc': 0.689521939245088, 'loss_val': 0.7130572447758395, 'psi': 0.6430557317327095}-{'f1_val': 0.6167581814585075, 'auprc': 0.6879043945190826, 'loss_val': 0.7029882417901752, 'psi': 0.6452166666827375}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=23 head_norm_before_train=1.462236 cos_to_last_merge=0.9794 (last merge round=15)
[S14] round=23 local utility u=0.002668 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971555968411632, 'loss_val': 0.06274670035172292, 'psi': 0.9970607436310643}-{'f1_val': 0.9974830777164877, 'auprc': 0.998234858275879, 'loss_val': 0.074233095023299, 'psi': 0.9977837899402442}
[S15] START round=23 head_norm_before_train=1.170200 cos_to_last_merge=0.9841 (last merge round=16)
[S15] round=23 local utility u=1.000000 metrics={'f1_val': 0.9857011428040713, 'auprc': 0.9992689253837632, 'loss_val': 0.17018096900922686, 'psi': 0.9911282558359481}-{'f1_val': 0.6973184083716771, 'auprc': 0.7995323396731289, 'loss_val': 0.4934606299450918, 'psi': 0.7382039808922578}
[S16] START round=23 head_norm_before_train=1.439734 cos_to_last_merge=0.9800 (last merge round=16)
[S16] round=23 local utility u=0.405384 metrics={'f1_val': 0.9396425837952862, 'auprc': 0.9952684415511555, 'loss_val': 0.19043898591689815, 'psi': 0.961892926897634}-{'f1_val': 0.8667070083015459, 'auprc': 0.9911816232896558, 'loss_val': 0.551333534293397, 'psi': 0.9164968542967898}
[S17] START round=23 head_norm_before_train=1.181978 cos_to_last_merge=0.9984 (last merge round=20)
[S17] round=23 local utility u=0.127579 metrics={'f1_val': 0.39039992083542513, 'auprc': 0.8206008860091245, 'loss_val': 0.9664459814801574, 'psi': 0.5624803069049049}-{'f1_val': 0.3735188774900605, 'auprc': 0.7948606721105167, 'loss_val': 1.0430962217578024, 'psi': 0.542055595338243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S2] START round=24 head_norm_before_train=1.562537 cos_to_last_merge=0.9959 (last merge round=17)
[S2] round=24 local utility u=0.045013 metrics={'f1_val': 0.711194307796851, 'auprc': 0.7800365094027756, 'loss_val': 0.6942051318869473, 'psi': 0.7387311884392208}-{'f1_val': 0.7074331183246881, 'auprc': 0.6729535196464627, 'loss_val': 0.4404148291074651, 'psi': 0.6936412788533979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=24 head_norm_before_train=1.488616 cos_to_last_merge=0.9953 (last merge round=17)
[S3] round=24 local utility u=0.199986 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9956130584750801, 'loss_val': 0.21868971057186376, 'psi': 0.818293405546183}-{'f1_val': 0.653311310212793, 'auprc': 0.9931310379312546, 'loss_val': 0.33060110729758574, 'psi': 0.7892392013001777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=24 head_norm_before_train=1.171532 cos_to_last_merge=0.9984 (last merge round=21)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.6235825948109475, 'auprc': 0.9451982524809794, 'loss_val': 0.4740405212277218, 'psi': 0.7522288578789602}-{'f1_val': 0.6434805082972325, 'auprc': 0.9490204025236821, 'loss_val': 0.4488349348400727, 'psi': 0.7656964659878123}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=24 head_norm_before_train=1.428583 cos_to_last_merge=0.8652 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.865
[S5] round=24 local utility u=0.046825 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9948751622721741, 'loss_val': 0.17837981583042214, 'psi': 0.8183151005064742}-{'f1_val': 0.7006728406085594, 'auprc': 0.9895411370588016, 'loss_val': 0.25641426687067, 'psi': 0.8162201591886563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=24 head_norm_before_train=1.520315 cos_to_last_merge=0.9721 (last merge round=12)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.9194688649366913, 'auprc': 0.960186176306554, 'loss_val': 0.24068791560587313, 'psi': 0.9357557894846364}-{'f1_val': 0.9596753963393896, 'auprc': 0.9753712570129425, 'loss_val': 0.18655128352607353, 'psi': 0.9659537406088107}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=24 head_norm_before_train=1.362358 cos_to_last_merge=0.9987 (last merge round=21)
[S7] round=24 local utility u=0.090475 metrics={'f1_val': 0.6790084441045943, 'auprc': 0.7872741416188966, 'loss_val': 0.5675386183911946, 'psi': 0.7223147231103152}-{'f1_val': 0.667132461399256, 'auprc': 0.7834338861783141, 'loss_val': 0.6657126877207694, 'psi': 0.7136530313108792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] sending update (kind=head size=1792 to 1 peers)
[S8] START round=24 head_norm_before_train=1.437814 cos_to_last_merge=0.9986 (last merge round=21)
[S8] round=24 local utility u=0.007288 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9979735562570241, 'loss_val': 0.10748413211708842, 'psi': 0.9969112845429013}-{'f1_val': 0.9962031034001528, 'auprc': 0.998218723597069, 'loss_val': 0.12279503630941091, 'psi': 0.9970093514789193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=24 head_norm_before_train=1.518372 cos_to_last_merge=0.9783 (last merge round=17)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9884223813560973, 'auprc': 0.9984515223733665, 'loss_val': 0.06038797576629291, 'psi': 0.992434037763005}-{'f1_val': 0.9966605118138915, 'auprc': 0.9964879714063132, 'loss_val': 0.06403362692161653, 'psi': 0.9965914956508601}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=24 head_norm_before_train=1.292036 cos_to_last_merge=0.9728 (last merge round=17)
[S10] round=24 local utility u=0.004793 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9947703845607762, 'loss_val': 0.09705660934248957, 'psi': 0.9952739459333224}-{'f1_val': 0.9956096535150197, 'auprc': 0.9956539050925068, 'loss_val': 0.1092939087556367, 'psi': 0.9956273541460146}
[S11] START round=24 head_norm_before_train=1.674808 cos_to_last_merge=0.8388 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.839
[S11] round=24 local utility u=0.008605 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9987315692282268, 'loss_val': 0.07986871897267965, 'psi': 0.9976711816670369}-{'f1_val': 0.9973780864376928, 'auprc': 0.9988867534615542, 'loss_val': 0.10002776432586645, 'psi': 0.9979815532472374}
[S13] START round=24 head_norm_before_train=1.164328 cos_to_last_merge=0.9958 (last merge round=21)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6042537801987782, 'auprc': 0.6879716532523004, 'loss_val': 0.7455230294814462, 'psi': 0.637740929420187}-{'f1_val': 0.6120782600577904, 'auprc': 0.689521939245088, 'loss_val': 0.7130572447758395, 'psi': 0.6430557317327095}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=24 head_norm_before_train=1.492942 cos_to_last_merge=0.9765 (last merge round=15)
[S14] round=24 local utility u=0.002010 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.997116522315439, 'loss_val': 0.05860880452560056, 'psi': 0.9970451138207747}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971555968411632, 'loss_val': 0.06274670035172292, 'psi': 0.9970607436310643}
[S15] START round=24 head_norm_before_train=1.194167 cos_to_last_merge=0.9815 (last merge round=16)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7011955970681706, 'auprc': 0.8169007303297995, 'loss_val': 0.39073111523286974, 'psi': 0.7474776503728222}-{'f1_val': 0.9857011428040713, 'auprc': 0.9992689253837632, 'loss_val': 0.17018096900922686, 'psi': 0.9911282558359481}
[S16] START round=24 head_norm_before_train=1.470683 cos_to_last_merge=0.9766 (last merge round=16)
[S16] round=24 local utility u=0.204255 metrics={'f1_val': 0.9917947446729134, 'auprc': 0.9924171023683854, 'loss_val': 0.08628864813679549, 'psi': 0.9920436877511023}-{'f1_val': 0.9396425837952862, 'auprc': 0.9952684415511555, 'loss_val': 0.19043898591689815, 'psi': 0.961892926897634}
[S17] START round=24 head_norm_before_train=1.204459 cos_to_last_merge=0.9967 (last merge round=20)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.3764004993354615, 'auprc': 0.7856642183879314, 'loss_val': 1.1511153021007245, 'psi': 0.5401059869564495}-{'f1_val': 0.39039992083542513, 'auprc': 0.8206008860091245, 'loss_val': 0.9664459814801574, 'psi': 0.5624803069049049}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] sending update (kind=head size=1807 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S2] START round=25 head_norm_before_train=1.582113 cos_to_last_merge=0.9949 (last merge round=17)
[S2] round=25 local utility u=0.065221 metrics={'f1_val': 0.7086904849731513, 'auprc': 0.7756430603158491, 'loss_val': 0.5355608081269083, 'psi': 0.7354715151102305}-{'f1_val': 0.711194307796851, 'auprc': 0.7800365094027756, 'loss_val': 0.6942051318869473, 'psi': 0.7387311884392208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=25 head_norm_before_train=1.501972 cos_to_last_merge=0.9946 (last merge round=17)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.6842496215603537, 'auprc': 0.9957320215956937, 'loss_val': 0.2269347888834525, 'psi': 0.8088425815744897}-{'f1_val': 0.7000803035935849, 'auprc': 0.9956130584750801, 'loss_val': 0.21868971057186376, 'psi': 0.818293405546183}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=1.194759 cos_to_last_merge=0.9970 (last merge round=21)
[S4] round=25 local utility u=0.032385 metrics={'f1_val': 0.6316301169634594, 'auprc': 0.9428892018537189, 'loss_val': 0.4506276531190804, 'psi': 0.7561337509195631}-{'f1_val': 0.6235825948109475, 'auprc': 0.9451982524809794, 'loss_val': 0.4740405212277218, 'psi': 0.7522288578789602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=25 head_norm_before_train=1.444711 cos_to_last_merge=0.8631 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.863
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7108663298678486, 'auprc': 0.9373860131554783, 'loss_val': 0.3032546982742541, 'psi': 0.8014742031829005}-{'f1_val': 0.7006083926626743, 'auprc': 0.9948751622721741, 'loss_val': 0.17837981583042214, 'psi': 0.8183151005064742}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=25 head_norm_before_train=1.536905 cos_to_last_merge=0.9695 (last merge round=12)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.7096225974985129, 'auprc': 0.7550836603962557, 'loss_val': 0.579889356799298, 'psi': 0.72780702265761}-{'f1_val': 0.9194688649366913, 'auprc': 0.960186176306554, 'loss_val': 0.24068791560587313, 'psi': 0.9357557894846364}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=25 head_norm_before_train=1.372586 cos_to_last_merge=0.9977 (last merge round=21)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.44497563724106237, 'auprc': 0.7648801660687826, 'loss_val': 0.8198480485925356, 'psi': 0.5729374487721505}-{'f1_val': 0.6790084441045943, 'auprc': 0.7872741416188966, 'loss_val': 0.5675386183911946, 'psi': 0.7223147231103152}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=25 head_norm_before_train=1.460540 cos_to_last_merge=0.9976 (last merge round=21)
[S8] round=25 local utility u=0.008275 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9984486934256034, 'loss_val': 0.0923600626264451, 'psi': 0.9971013394103331}-{'f1_val': 0.9962031034001528, 'auprc': 0.9979735562570241, 'loss_val': 0.10748413211708842, 'psi': 0.9969112845429013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=25 head_norm_before_train=1.554126 cos_to_last_merge=0.9733 (last merge round=17)
[S9] round=25 local utility u=0.031372 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9965419729184901, 'loss_val': 0.04134417917537911, 'psi': 0.9966130962557309}-{'f1_val': 0.9884223813560973, 'auprc': 0.9984515223733665, 'loss_val': 0.06038797576629291, 'psi': 0.992434037763005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=25 head_norm_before_train=1.333717 cos_to_last_merge=0.9672 (last merge round=17)
[S10] round=25 local utility u=0.011022 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9966378928097386, 'loss_val': 0.08061540883054816, 'psi': 0.9960209492329073}-{'f1_val': 0.9956096535150197, 'auprc': 0.9947703845607762, 'loss_val': 0.09705660934248957, 'psi': 0.9952739459333224}
[S11] START round=25 head_norm_before_train=1.695691 cos_to_last_merge=0.8377 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.838
[S11] round=25 local utility u=0.007725 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.9988105361847102, 'loss_val': 0.06713860253363824, 'psi': 0.9979510663364998}-{'f1_val': 0.9969642566262439, 'auprc': 0.9987315692282268, 'loss_val': 0.07986871897267965, 'psi': 0.9976711816670369}
[S13] START round=25 head_norm_before_train=1.198494 cos_to_last_merge=0.9918 (last merge round=21)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6106968599023415, 'auprc': 0.5809040788889381, 'loss_val': 0.7929374988927625, 'psi': 0.5987797474969802}-{'f1_val': 0.6042537801987782, 'auprc': 0.6879716532523004, 'loss_val': 0.7455230294814462, 'psi': 0.637740929420187}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=25 head_norm_before_train=1.523876 cos_to_last_merge=0.9734 (last merge round=15)
[S14] round=25 local utility u=0.003849 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9971569148098708, 'loss_val': 0.053497208607732424, 'psi': 0.9973077276249837}-{'f1_val': 0.9969975081576651, 'auprc': 0.997116522315439, 'loss_val': 0.05860880452560056, 'psi': 0.9970451138207747}
[S15] START round=25 head_norm_before_train=1.211790 cos_to_last_merge=0.9796 (last merge round=16)
[S15] round=25 local utility u=0.105652 metrics={'f1_val': 0.7154015914930092, 'auprc': 0.8550459575421339, 'loss_val': 0.379099507653552, 'psi': 0.7712593379126591}-{'f1_val': 0.7011955970681706, 'auprc': 0.8169007303297995, 'loss_val': 0.39073111523286974, 'psi': 0.7474776503728222}
[S16] START round=25 head_norm_before_train=1.496947 cos_to_last_merge=0.9738 (last merge round=16)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.8717045987909264, 'auprc': 0.9938332121695755, 'loss_val': 0.5407395254495868, 'psi': 0.9205560441423861}-{'f1_val': 0.9917947446729134, 'auprc': 0.9924171023683854, 'loss_val': 0.08628864813679549, 'psi': 0.9920436877511023}
[S17] START round=25 head_norm_before_train=1.222391 cos_to_last_merge=0.9951 (last merge round=20)
[S17] round=25 local utility u=0.122983 metrics={'f1_val': 0.3917628942939913, 'auprc': 0.81250935588934, 'loss_val': 1.0778591258337002, 'psi': 0.5600614789321308}-{'f1_val': 0.3764004993354615, 'auprc': 0.7856642183879314, 'loss_val': 1.1511153021007245, 'psi': 0.5401059869564495}
[S14]  timeout peer S8
[S15]  timeout peer S4
[S10]  timeout peer S17
[S17]  timeout peer S13
[S16]  timeout peer S7
[S11]  timeout peer S5
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S2] START round=26 head_norm_before_train=1.598356 cos_to_last_merge=0.9939 (last merge round=17)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.6562761384510304, 'auprc': 0.699968027534953, 'loss_val': 0.5823685346037906, 'psi': 0.6737528940845994}-{'f1_val': 0.7086904849731513, 'auprc': 0.7756430603158491, 'loss_val': 0.5355608081269083, 'psi': 0.7354715151102305}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=1.518947 cos_to_last_merge=0.9936 (last merge round=17)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.5931629952402844, 'auprc': 0.9938411955745873, 'loss_val': 0.42851264431144986, 'psi': 0.7534342753740055}-{'f1_val': 0.6842496215603537, 'auprc': 0.9957320215956937, 'loss_val': 0.2269347888834525, 'psi': 0.8088425815744897}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=1.215270 cos_to_last_merge=0.9956 (last merge round=21)
[S4] round=26 local utility u=0.011408 metrics={'f1_val': 0.6313451654319345, 'auprc': 0.9451370484224076, 'loss_val': 0.4328460632450907, 'psi': 0.7568619186281238}-{'f1_val': 0.6316301169634594, 'auprc': 0.9428892018537189, 'loss_val': 0.4506276531190804, 'psi': 0.7561337509195631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=26 head_norm_before_train=1.459486 cos_to_last_merge=0.8616 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.862
[S5] round=26 local utility u=1.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9923630331832377, 'loss_val': 0.1492379959301211, 'psi': 0.9947455004514292}-{'f1_val': 0.7108663298678486, 'auprc': 0.9373860131554783, 'loss_val': 0.3032546982742541, 'psi': 0.8014742031829005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=26 head_norm_before_train=1.552988 cos_to_last_merge=0.9668 (last merge round=12)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.559439575124429, 'auprc': 0.7636819928429764, 'loss_val': 0.7483013932123525, 'psi': 0.641136542211848}-{'f1_val': 0.7096225974985129, 'auprc': 0.7550836603962557, 'loss_val': 0.579889356799298, 'psi': 0.72780702265761}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=26 head_norm_before_train=1.381730 cos_to_last_merge=0.9967 (last merge round=21)
[S7] round=26 local utility u=0.313290 metrics={'f1_val': 0.5388260861728911, 'auprc': 0.7668483187193442, 'loss_val': 0.7622755503700371, 'psi': 0.6300349791914723}-{'f1_val': 0.44497563724106237, 'auprc': 0.7648801660687826, 'loss_val': 0.8198480485925356, 'psi': 0.5729374487721505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=26 head_norm_before_train=1.483092 cos_to_last_merge=0.9963 (last merge round=21)
[S8] round=26 local utility u=0.002075 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9982448219192641, 'loss_val': 0.08759858925942375, 'psi': 0.9970197908077973}-{'f1_val': 0.9962031034001528, 'auprc': 0.9984486934256034, 'loss_val': 0.0923600626264451, 'psi': 0.9971013394103331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=26 head_norm_before_train=1.585033 cos_to_last_merge=0.9688 (last merge round=17)
[S9] round=26 local utility u=0.001718 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9965805904894314, 'loss_val': 0.03652276400999527, 'psi': 0.9964783475961051}-{'f1_val': 0.9966605118138915, 'auprc': 0.9965419729184901, 'loss_val': 0.04134417917537911, 'psi': 0.9966130962557309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=26 head_norm_before_train=1.373681 cos_to_last_merge=0.9618 (last merge round=17)
[S10] round=26 local utility u=0.000212 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9945176624793386, 'loss_val': 0.07129978674103042, 'psi': 0.9949197684033603}-{'f1_val': 0.9956096535150197, 'auprc': 0.9966378928097386, 'loss_val': 0.08061540883054816, 'psi': 0.9960209492329073}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=26 head_norm_before_train=1.718204 cos_to_last_merge=0.8367 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.837
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.959779555599099, 'auprc': 0.9986776030080259, 'loss_val': 0.07377924517976824, 'psi': 0.9753387745626698}-{'f1_val': 0.9973780864376928, 'auprc': 0.9988105361847102, 'loss_val': 0.06713860253363824, 'psi': 0.9979510663364998}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=26 head_norm_before_train=1.232002 cos_to_last_merge=0.9871 (last merge round=21)
[S13] round=26 local utility u=0.309611 metrics={'f1_val': 0.6366324978063231, 'auprc': 0.681163688746104, 'loss_val': 0.6301073249756255, 'psi': 0.6544449741822356}-{'f1_val': 0.6106968599023415, 'auprc': 0.5809040788889381, 'loss_val': 0.7929374988927625, 'psi': 0.5987797474969802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] sending update (kind=head size=1788 to 1 peers)
[S14] START round=26 head_norm_before_train=1.549477 cos_to_last_merge=0.9707 (last merge round=15)
[S14] round=26 local utility u=0.005120 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.9988490990092564, 'loss_val': 0.04632193043173243, 'psi': 0.9977833203054463}-{'f1_val': 0.9974082695017256, 'auprc': 0.9971569148098708, 'loss_val': 0.053497208607732424, 'psi': 0.9973077276249837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=26 head_norm_before_train=1.230669 cos_to_last_merge=0.9776 (last merge round=16)
[S15] round=26 local utility u=1.000000 metrics={'f1_val': 0.9639329627099853, 'auprc': 0.997006155073479, 'loss_val': 0.133813412221985, 'psi': 0.9771622396553827}-{'f1_val': 0.7154015914930092, 'auprc': 0.8550459575421339, 'loss_val': 0.379099507653552, 'psi': 0.7712593379126591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=26 head_norm_before_train=1.520922 cos_to_last_merge=0.9711 (last merge round=16)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8700400035753182, 'auprc': 0.9939175867902064, 'loss_val': 0.5610742771130452, 'psi': 0.9195910368612734}-{'f1_val': 0.8717045987909264, 'auprc': 0.9938332121695755, 'loss_val': 0.5407395254495868, 'psi': 0.9205560441423861}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=1.237632 cos_to_last_merge=0.9936 (last merge round=20)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.3800077299026109, 'auprc': 0.7894589587768034, 'loss_val': 1.1988650000370302, 'psi': 0.5437882214522879}-{'f1_val': 0.3917628942939913, 'auprc': 0.81250935588934, 'loss_val': 1.0778591258337002, 'psi': 0.5600614789321308}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=27 head_norm_before_train=1.614332 cos_to_last_merge=0.9930 (last merge round=17)
[S2] round=27 local utility u=0.252900 metrics={'f1_val': 0.6940548262478884, 'auprc': 0.7696989105446392, 'loss_val': 0.5124324320164276, 'psi': 0.7243124599665888}-{'f1_val': 0.6562761384510304, 'auprc': 0.699968027534953, 'loss_val': 0.5823685346037906, 'psi': 0.6737528940845994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=27 head_norm_before_train=1.535905 cos_to_last_merge=0.9920 (last merge round=17)
[S3] round=27 local utility u=0.323183 metrics={'f1_val': 0.7879622231452827, 'auprc': 0.8888320668548337, 'loss_val': 0.6359141765878935, 'psi': 0.8283101606291032}-{'f1_val': 0.5931629952402844, 'auprc': 0.9938411955745873, 'loss_val': 0.42851264431144986, 'psi': 0.7534342753740055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=27 head_norm_before_train=1.234696 cos_to_last_merge=0.9944 (last merge round=21)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.6195046206193885, 'auprc': 0.9475025137310651, 'loss_val': 0.43675748936735653, 'psi': 0.7507037778640591}-{'f1_val': 0.6313451654319345, 'auprc': 0.9451370484224076, 'loss_val': 0.4328460632450907, 'psi': 0.7568619186281238}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=27 head_norm_before_train=1.474912 cos_to_last_merge=0.8600 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.860
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.7148616753480442, 'auprc': 0.8394902913513211, 'loss_val': 0.41741519903278823, 'psi': 0.764713121749355}-{'f1_val': 0.9963338119635569, 'auprc': 0.9923630331832377, 'loss_val': 0.1492379959301211, 'psi': 0.9947455004514292}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=27 head_norm_before_train=1.566419 cos_to_last_merge=0.9646 (last merge round=12)
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.8111998866126796, 'auprc': 0.9521100511187721, 'loss_val': 0.29408872935861236, 'psi': 0.8675639524151166}-{'f1_val': 0.559439575124429, 'auprc': 0.7636819928429764, 'loss_val': 0.7483013932123525, 'psi': 0.641136542211848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=27 head_norm_before_train=1.393119 cos_to_last_merge=0.9953 (last merge round=21)
[S7] round=27 local utility u=0.677467 metrics={'f1_val': 0.6811082325761337, 'auprc': 0.8484793381869298, 'loss_val': 0.5059266497849123, 'psi': 0.7480566748204522}-{'f1_val': 0.5388260861728911, 'auprc': 0.7668483187193442, 'loss_val': 0.7622755503700371, 'psi': 0.6300349791914723}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=27 head_norm_before_train=1.505486 cos_to_last_merge=0.9948 (last merge round=21)
[S8] round=27 local utility u=0.000562 metrics={'f1_val': 0.9950790219939822, 'auprc': 0.9984911189025628, 'loss_val': 0.08046969890150138, 'psi': 0.9964438607574144}-{'f1_val': 0.9962031034001528, 'auprc': 0.9982448219192641, 'loss_val': 0.08759858925942375, 'psi': 0.9970197908077973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=27 head_norm_before_train=1.613015 cos_to_last_merge=0.9651 (last merge round=17)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9918149940667227, 'auprc': 0.9984697925767759, 'loss_val': 0.03888609496539547, 'psi': 0.994476913470744}-{'f1_val': 0.9964101856672208, 'auprc': 0.9965805904894314, 'loss_val': 0.03652276400999527, 'psi': 0.9964783475961051}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=27 head_norm_before_train=1.412736 cos_to_last_merge=0.9570 (last merge round=17)
[S10] round=27 local utility u=0.003563 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9945041169503026, 'loss_val': 0.06413263283882067, 'psi': 0.9949143501917459}-{'f1_val': 0.9951878390193748, 'auprc': 0.9945176624793386, 'loss_val': 0.07129978674103042, 'psi': 0.9949197684033603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=27 head_norm_before_train=1.741689 cos_to_last_merge=0.8359 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.836
[S11] round=27 local utility u=0.122962 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9984192300331776, 'loss_val': 0.04756445534190903, 'psi': 0.9972838109106502}-{'f1_val': 0.959779555599099, 'auprc': 0.9986776030080259, 'loss_val': 0.07377924517976824, 'psi': 0.9753387745626698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=27 head_norm_before_train=1.256608 cos_to_last_merge=0.9832 (last merge round=21)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5479177188823, 'auprc': 0.6880231327476097, 'loss_val': 0.8530485968060189, 'psi': 0.603959884428424}-{'f1_val': 0.6366324978063231, 'auprc': 0.681163688746104, 'loss_val': 0.6301073249756255, 'psi': 0.6544449741822356}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=1.572722 cos_to_last_merge=0.9682 (last merge round=15)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9971541620183044, 'loss_val': 0.04268622054035967, 'psi': 0.9970620927358684}-{'f1_val': 0.9970728011695729, 'auprc': 0.9988490990092564, 'loss_val': 0.04632193043173243, 'psi': 0.9977833203054463}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=27 head_norm_before_train=1.253523 cos_to_last_merge=0.9748 (last merge round=16)
[S15] round=27 local utility u=0.120898 metrics={'f1_val': 0.9957486733069153, 'auprc': 0.9985567657448565, 'loss_val': 0.08756410574539318, 'psi': 0.9968719102820918}-{'f1_val': 0.9639329627099853, 'auprc': 0.997006155073479, 'loss_val': 0.133813412221985, 'psi': 0.9771622396553827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=27 head_norm_before_train=1.544437 cos_to_last_merge=0.9683 (last merge round=16)
[S16] round=27 local utility u=0.099875 metrics={'f1_val': 0.8861481414195498, 'auprc': 0.9941599422251143, 'loss_val': 0.4587003834922738, 'psi': 0.9293528617417756}-{'f1_val': 0.8700400035753182, 'auprc': 0.9939175867902064, 'loss_val': 0.5610742771130452, 'psi': 0.9195910368612734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=27 head_norm_before_train=1.252501 cos_to_last_merge=0.9920 (last merge round=20)
[S17] round=27 local utility u=0.650323 metrics={'f1_val': 0.5408366556761752, 'auprc': 0.8248697738196074, 'loss_val': 0.9694244647978393, 'psi': 0.6544499029335481}-{'f1_val': 0.3800077299026109, 'auprc': 0.7894589587768034, 'loss_val': 1.1988650000370302, 'psi': 0.5437882214522879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=28 head_norm_before_train=1.631345 cos_to_last_merge=0.9919 (last merge round=17)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.6697877007500475, 'auprc': 0.7202045855501956, 'loss_val': 0.6646412060630085, 'psi': 0.6899544546701067}-{'f1_val': 0.6940548262478884, 'auprc': 0.7696989105446392, 'loss_val': 0.5124324320164276, 'psi': 0.7243124599665888}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=28 head_norm_before_train=1.551295 cos_to_last_merge=0.9904 (last merge round=17)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.5728859184045785, 'auprc': 0.9990577741425016, 'loss_val': 0.5058338439074158, 'psi': 0.7433546606997476}-{'f1_val': 0.7879622231452827, 'auprc': 0.8888320668548337, 'loss_val': 0.6359141765878935, 'psi': 0.8283101606291032}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=1.255435 cos_to_last_merge=0.9931 (last merge round=21)
[S4] round=28 local utility u=0.975536 metrics={'f1_val': 0.9393949765451443, 'auprc': 0.9558578827425096, 'loss_val': 0.43009409563681994, 'psi': 0.9459801390240904}-{'f1_val': 0.6195046206193885, 'auprc': 0.9475025137310651, 'loss_val': 0.43675748936735653, 'psi': 0.7507037778640591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=28 head_norm_before_train=1.491360 cos_to_last_merge=0.8585 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.858
[S5] round=28 local utility u=0.979444 metrics={'f1_val': 0.9189883137124983, 'auprc': 0.9924212473258354, 'loss_val': 0.14208048824143865, 'psi': 0.9483614871578331}-{'f1_val': 0.7148616753480442, 'auprc': 0.8394902913513211, 'loss_val': 0.41741519903278823, 'psi': 0.764713121749355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=28 head_norm_before_train=1.576789 cos_to_last_merge=0.9627 (last merge round=12)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.511039159337382, 'auprc': 0.7596431842163865, 'loss_val': 0.8242948986390686, 'psi': 0.6104807692889838}-{'f1_val': 0.8111998866126796, 'auprc': 0.9521100511187721, 'loss_val': 0.29408872935861236, 'psi': 0.8675639524151166}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.406989 cos_to_last_merge=0.9935 (last merge round=21)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.4573686625698962, 'auprc': 0.7526353074230513, 'loss_val': 0.8783584259687117, 'psi': 0.5754753205111582}-{'f1_val': 0.6811082325761337, 'auprc': 0.8484793381869298, 'loss_val': 0.5059266497849123, 'psi': 0.7480566748204522}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=1.527223 cos_to_last_merge=0.9933 (last merge round=21)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9915895183459548, 'auprc': 0.9982585446147716, 'loss_val': 0.11803545894304898, 'psi': 0.9942571288534816}-{'f1_val': 0.9950790219939822, 'auprc': 0.9984911189025628, 'loss_val': 0.08046969890150138, 'psi': 0.9964438607574144}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=28 head_norm_before_train=1.636095 cos_to_last_merge=0.9618 (last merge round=17)
[S9] round=28 local utility u=0.007365 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9988520989078031, 'loss_val': 0.03536332711523215, 'psi': 0.9956359488689438}-{'f1_val': 0.9918149940667227, 'auprc': 0.9984697925767759, 'loss_val': 0.03888609496539547, 'psi': 0.994476913470744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=28 head_norm_before_train=1.448775 cos_to_last_merge=0.9527 (last merge round=17)
[S10] round=28 local utility u=0.003460 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9949506613249803, 'loss_val': 0.05855233998600941, 'psi': 0.995092967941617}-{'f1_val': 0.9951878390193748, 'auprc': 0.9945041169503026, 'loss_val': 0.06413263283882067, 'psi': 0.9949143501917459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=28 head_norm_before_train=1.764568 cos_to_last_merge=0.8350 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.835
[S11] round=28 local utility u=0.005161 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9987116038070173, 'loss_val': 0.04074417584290077, 'psi': 0.9976631954985532}-{'f1_val': 0.9965268648289654, 'auprc': 0.9984192300331776, 'loss_val': 0.04756445534190903, 'psi': 0.9972838109106502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=28 head_norm_before_train=1.276403 cos_to_last_merge=0.9796 (last merge round=21)
[S13] round=28 local utility u=0.216469 metrics={'f1_val': 0.6036526551371402, 'auprc': 0.6626370573731666, 'loss_val': 0.6783626264980994, 'psi': 0.6272464160315507}-{'f1_val': 0.5479177188823, 'auprc': 0.6880231327476097, 'loss_val': 0.8530485968060189, 'psi': 0.603959884428424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=28 head_norm_before_train=1.596070 cos_to_last_merge=0.9659 (last merge round=15)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.995882416290562, 'loss_val': 0.05103463530137562, 'psi': 0.99665214231488}-{'f1_val': 0.9970007132142444, 'auprc': 0.9971541620183044, 'loss_val': 0.04268622054035967, 'psi': 0.9970620927358684}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=1.277686 cos_to_last_merge=0.9717 (last merge round=16)
[S15] round=28 local utility u=0.002256 metrics={'f1_val': 0.9966196520233872, 'auprc': 0.99611122537458, 'loss_val': 0.0809419239239521, 'psi': 0.9964162813638644}-{'f1_val': 0.9957486733069153, 'auprc': 0.9985567657448565, 'loss_val': 0.08756410574539318, 'psi': 0.9968719102820918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=28 head_norm_before_train=1.565502 cos_to_last_merge=0.9660 (last merge round=16)
[S16] round=28 local utility u=0.502670 metrics={'f1_val': 0.9909324780531616, 'auprc': 0.9891926637253723, 'loss_val': 0.06716413650646341, 'psi': 0.9902365523220459}-{'f1_val': 0.8861481414195498, 'auprc': 0.9941599422251143, 'loss_val': 0.4587003834922738, 'psi': 0.9293528617417756}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=28 head_norm_before_train=1.265442 cos_to_last_merge=0.9905 (last merge round=20)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.3793380125906414, 'auprc': 0.769813341423512, 'loss_val': 1.2899528856348024, 'psi': 0.5355281441237896}-{'f1_val': 0.5408366556761752, 'auprc': 0.8248697738196074, 'loss_val': 0.9694244647978393, 'psi': 0.6544499029335481}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.645446 cos_to_last_merge=0.9907 (last merge round=17)
[S2] round=29 local utility u=0.160161 metrics={'f1_val': 0.712800578879969, 'auprc': 0.7665668073468087, 'loss_val': 0.7414822489869345, 'psi': 0.7343070702667049}-{'f1_val': 0.6697877007500475, 'auprc': 0.7202045855501956, 'loss_val': 0.6646412060630085, 'psi': 0.6899544546701067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=29 head_norm_before_train=1.573263 cos_to_last_merge=0.9881 (last merge round=17)
[S3] round=29 local utility u=1.000000 metrics={'f1_val': 0.8835998066202159, 'auprc': 0.9990750827959922, 'loss_val': 0.2752940246084424, 'psi': 0.9297899170905264}-{'f1_val': 0.5728859184045785, 'auprc': 0.9990577741425016, 'loss_val': 0.5058338439074158, 'psi': 0.7433546606997476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=29 head_norm_before_train=1.274514 cos_to_last_merge=0.9917 (last merge round=21)
[S4] round=29 local utility u=0.047605 metrics={'f1_val': 0.9435784868089672, 'auprc': 0.9557259170717727, 'loss_val': 0.3595885473466953, 'psi': 0.9484374589140894}-{'f1_val': 0.9393949765451443, 'auprc': 0.9558578827425096, 'loss_val': 0.43009409563681994, 'psi': 0.9459801390240904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=29 head_norm_before_train=1.503141 cos_to_last_merge=0.8574 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.857
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.8013612597355988, 'auprc': 0.9895702654463832, 'loss_val': 0.20402899955414097, 'psi': 0.8766448620199125}-{'f1_val': 0.9189883137124983, 'auprc': 0.9924212473258354, 'loss_val': 0.14208048824143865, 'psi': 0.9483614871578331}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=1.586983 cos_to_last_merge=0.9608 (last merge round=12)
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.9185757926229025, 'auprc': 0.961860815328876, 'loss_val': 0.2252864180632408, 'psi': 0.9358898017052919}-{'f1_val': 0.511039159337382, 'auprc': 0.7596431842163865, 'loss_val': 0.8242948986390686, 'psi': 0.6104807692889838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=29 head_norm_before_train=1.417135 cos_to_last_merge=0.9921 (last merge round=21)
[S7] round=29 local utility u=0.434702 metrics={'f1_val': 0.5659677844780439, 'auprc': 0.7718602737053434, 'loss_val': 0.7182240709465002, 'psi': 0.6483247801689637}-{'f1_val': 0.4573686625698962, 'auprc': 0.7526353074230513, 'loss_val': 0.8783584259687117, 'psi': 0.5754753205111582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=29 head_norm_before_train=1.548053 cos_to_last_merge=0.9919 (last merge round=21)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9015710189647316, 'auprc': 0.9972099937305315, 'loss_val': 0.14092615475308434, 'psi': 0.9398266088710516}-{'f1_val': 0.9915895183459548, 'auprc': 0.9982585446147716, 'loss_val': 0.11803545894304898, 'psi': 0.9942571288534816}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=1.659428 cos_to_last_merge=0.9589 (last merge round=17)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.9988579101950957, 'loss_val': 0.03631767573897093, 'psi': 0.9938742872866342}-{'f1_val': 0.9934918488430377, 'auprc': 0.9988520989078031, 'loss_val': 0.03536332711523215, 'psi': 0.9956359488689438}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=29 head_norm_before_train=1.481533 cos_to_last_merge=0.9488 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.949
[S10] round=29 local utility u=0.004167 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9952761769905342, 'loss_val': 0.05372623944678108, 'psi': 0.9954762629052256}-{'f1_val': 0.9951878390193748, 'auprc': 0.9949506613249803, 'loss_val': 0.05855233998600941, 'psi': 0.995092967941617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=29 head_norm_before_train=1.786137 cos_to_last_merge=0.8340 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.834
[S11] round=29 local utility u=0.003520 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9987703526575176, 'loss_val': 0.03388006465404631, 'psi': 0.9976866950387533}-{'f1_val': 0.9969642566262439, 'auprc': 0.9987116038070173, 'loss_val': 0.04074417584290077, 'psi': 0.9976631954985532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=29 head_norm_before_train=1.296089 cos_to_last_merge=0.9763 (last merge round=21)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5670040726583763, 'auprc': 0.689178612183338, 'loss_val': 0.8119412311533033, 'psi': 0.615873888468361}-{'f1_val': 0.6036526551371402, 'auprc': 0.6626370573731666, 'loss_val': 0.6783626264980994, 'psi': 0.6272464160315507}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=29 head_norm_before_train=1.615931 cos_to_last_merge=0.9639 (last merge round=15)
[S14] round=29 local utility u=0.009009 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9971538320600333, 'loss_val': 0.03828789681307165, 'psi': 0.9973064945250487}-{'f1_val': 0.9971652929977585, 'auprc': 0.995882416290562, 'loss_val': 0.05103463530137562, 'psi': 0.99665214231488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=29 head_norm_before_train=1.295413 cos_to_last_merge=0.9695 (last merge round=16)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.7011887589157009, 'auprc': 0.7994160357036146, 'loss_val': 0.4474052122219883, 'psi': 0.7404796696308664}-{'f1_val': 0.9966196520233872, 'auprc': 0.99611122537458, 'loss_val': 0.0809419239239521, 'psi': 0.9964162813638644}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=1.585345 cos_to_last_merge=0.9639 (last merge round=16)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8541647607647452, 'auprc': 0.9932056268580859, 'loss_val': 0.6925019856512, 'psi': 0.9097811072020814}-{'f1_val': 0.9909324780531616, 'auprc': 0.9891926637253723, 'loss_val': 0.06716413650646341, 'psi': 0.9902365523220459}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=1.274215 cos_to_last_merge=0.9894 (last merge round=20)
[S17] round=29 local utility u=0.965483 metrics={'f1_val': 0.6279157980834986, 'auprc': 0.8318177956371795, 'loss_val': 1.03646710198023, 'psi': 0.709476597104971}-{'f1_val': 0.3793380125906414, 'auprc': 0.769813341423512, 'loss_val': 1.2899528856348024, 'psi': 0.5355281441237896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=30 head_norm_before_train=1.656829 cos_to_last_merge=0.9896 (last merge round=17)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.48695447977334055, 'auprc': 0.5935121258292267, 'loss_val': 1.2623045719556003, 'psi': 0.529577538195695}-{'f1_val': 0.712800578879969, 'auprc': 0.7665668073468087, 'loss_val': 0.7414822489869345, 'psi': 0.7343070702667049}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.594772 cos_to_last_merge=0.9854 (last merge round=17)
[S3] round=30 local utility u=0.402476 metrics={'f1_val': 0.9884885067105256, 'auprc': 0.9989190150032476, 'loss_val': 0.09920679438221686, 'psi': 0.9926607100276144}-{'f1_val': 0.8835998066202159, 'auprc': 0.9990750827959922, 'loss_val': 0.2752940246084424, 'psi': 0.9297899170905264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=30 head_norm_before_train=1.285234 cos_to_last_merge=0.9906 (last merge round=21)
[S4] round=30 local utility u=0.024826 metrics={'f1_val': 0.9534023055385004, 'auprc': 0.9579756976112493, 'loss_val': 0.37562900286051426, 'psi': 0.9552316623675999}-{'f1_val': 0.9435784868089672, 'auprc': 0.9557259170717727, 'loss_val': 0.3595885473466953, 'psi': 0.9484374589140894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=30 head_norm_before_train=1.516608 cos_to_last_merge=0.8561 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.856
[S5] round=30 local utility u=0.633370 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9918511878359433, 'loss_val': 0.11396687929056963, 'psi': 0.9945407623125113}-{'f1_val': 0.8013612597355988, 'auprc': 0.9895702654463832, 'loss_val': 0.20402899955414097, 'psi': 0.8766448620199125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=30 head_norm_before_train=1.600330 cos_to_last_merge=0.9589 (last merge round=12)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.47016678590507555, 'auprc': 0.7774520801657279, 'loss_val': 0.9253310991549588, 'psi': 0.5930809036093365}-{'f1_val': 0.9185757926229025, 'auprc': 0.961860815328876, 'loss_val': 0.2252864180632408, 'psi': 0.9358898017052919}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.426124 cos_to_last_merge=0.9908 (last merge round=21)
[S7] round=30 local utility u=0.289796 metrics={'f1_val': 0.6314187161340539, 'auprc': 0.7940862757212309, 'loss_val': 0.5980147072890201, 'psi': 0.6964857399689247}-{'f1_val': 0.5659677844780439, 'auprc': 0.7718602737053434, 'loss_val': 0.7182240709465002, 'psi': 0.6483247801689637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=30 head_norm_before_train=1.563868 cos_to_last_merge=0.9908 (last merge round=21)
[S8] round=30 local utility u=0.311539 metrics={'f1_val': 0.9928250278729972, 'auprc': 0.9981115908173882, 'loss_val': 0.06807788425373323, 'psi': 0.9949396530507536}-{'f1_val': 0.9015710189647316, 'auprc': 0.9972099937305315, 'loss_val': 0.14092615475308434, 'psi': 0.9398266088710516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=30 head_norm_before_train=1.679957 cos_to_last_merge=0.9567 (last merge round=17)
[S9] round=30 local utility u=0.011027 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9988519284542224, 'loss_val': 0.031886457635783634, 'psi': 0.9956358806875115}-{'f1_val': 0.9905518720143266, 'auprc': 0.9988579101950957, 'loss_val': 0.03631767573897093, 'psi': 0.9938742872866342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=30 head_norm_before_train=1.510631 cos_to_last_merge=0.9452 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.945
[S10] round=30 local utility u=0.001891 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9950637540815404, 'loss_val': 0.049307148166868875, 'psi': 0.995391293741628}-{'f1_val': 0.9956096535150197, 'auprc': 0.9952761769905342, 'loss_val': 0.05372623944678108, 'psi': 0.9954762629052256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=30 head_norm_before_train=1.808337 cos_to_last_merge=0.8332 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.833
[S11] round=30 local utility u=0.001489 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9986624576222477, 'loss_val': 0.03057771146759764, 'psi': 0.9976435370246454}-{'f1_val': 0.9969642566262439, 'auprc': 0.9987703526575176, 'loss_val': 0.03388006465404631, 'psi': 0.9976866950387533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=30 head_norm_before_train=1.313253 cos_to_last_merge=0.9732 (last merge round=21)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5580544598268088, 'auprc': 0.6934267097702227, 'loss_val': 0.8597790511735827, 'psi': 0.6122033598041744}-{'f1_val': 0.5670040726583763, 'auprc': 0.689178612183338, 'loss_val': 0.8119412311533033, 'psi': 0.615873888468361}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.633803 cos_to_last_merge=0.9619 (last merge round=15)
[S14] round=30 local utility u=0.004543 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9984720043524828, 'loss_val': 0.03448186651668906, 'psi': 0.9979662675779295}-{'f1_val': 0.9974082695017256, 'auprc': 0.9971538320600333, 'loss_val': 0.03828789681307165, 'psi': 0.9973064945250487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=30 head_norm_before_train=1.311708 cos_to_last_merge=0.9676 (last merge round=16)
[S15] round=30 local utility u=1.000000 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9986502810550696, 'loss_val': 0.06903764570089557, 'psi': 0.9977304645388879}-{'f1_val': 0.7011887589157009, 'auprc': 0.7994160357036146, 'loss_val': 0.4474052122219883, 'psi': 0.7404796696308664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=30 head_norm_before_train=1.602552 cos_to_last_merge=0.9620 (last merge round=16)
[S16] round=30 local utility u=0.425022 metrics={'f1_val': 0.9308250691372867, 'auprc': 0.9930633340940004, 'loss_val': 0.3019933281819176, 'psi': 0.9557203751199721}-{'f1_val': 0.8541647607647452, 'auprc': 0.9932056268580859, 'loss_val': 0.6925019856512, 'psi': 0.9097811072020814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=30 head_norm_before_train=1.280881 cos_to_last_merge=0.9885 (last merge round=20)
[S17] round=30 local utility u=0.065234 metrics={'f1_val': 0.6530224809686392, 'auprc': 0.8328585337596771, 'loss_val': 1.059762200162923, 'psi': 0.7249569020850544}-{'f1_val': 0.6279157980834986, 'auprc': 0.8318177956371795, 'loss_val': 1.03646710198023, 'psi': 0.709476597104971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=31 head_norm_before_train=1.664388 cos_to_last_merge=0.9887 (last merge round=17)
[S2] round=31 local utility u=1.000000 metrics={'f1_val': 0.6993813925516972, 'auprc': 0.7640068594249498, 'loss_val': 0.886410391400636, 'psi': 0.7252315793009982}-{'f1_val': 0.48695447977334055, 'auprc': 0.5935121258292267, 'loss_val': 1.2623045719556003, 'psi': 0.529577538195695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=31 head_norm_before_train=1.620119 cos_to_last_merge=0.9819 (last merge round=17)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9344345889578257, 'auprc': 0.998703896392235, 'loss_val': 0.1352253166849247, 'psi': 0.9601423119315895}-{'f1_val': 0.9884885067105256, 'auprc': 0.9989190150032476, 'loss_val': 0.09920679438221686, 'psi': 0.9926607100276144}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.300269 cos_to_last_merge=0.9890 (last merge round=21)
[S4] round=31 local utility u=0.024067 metrics={'f1_val': 0.9509024158382701, 'auprc': 0.962450329039831, 'loss_val': 0.3259198147756487, 'psi': 0.9555215811188944}-{'f1_val': 0.9534023055385004, 'auprc': 0.9579756976112493, 'loss_val': 0.37562900286051426, 'psi': 0.9552316623675999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=31 head_norm_before_train=1.527982 cos_to_last_merge=0.8551 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.855
[S5] round=31 local utility u=0.005064 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9908130422179393, 'loss_val': 0.10072443722029929, 'psi': 0.9941255040653099}-{'f1_val': 0.9963338119635569, 'auprc': 0.9918511878359433, 'loss_val': 0.11396687929056963, 'psi': 0.9945407623125113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=31 head_norm_before_train=1.617718 cos_to_last_merge=0.9564 (last merge round=12)
[S6] round=31 local utility u=1.000000 metrics={'f1_val': 0.9613225823734587, 'auprc': 0.9738713618493432, 'loss_val': 0.17227310326684517, 'psi': 0.9663420941638126}-{'f1_val': 0.47016678590507555, 'auprc': 0.7774520801657279, 'loss_val': 0.9253310991549588, 'psi': 0.5930809036093365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=31 head_norm_before_train=1.434485 cos_to_last_merge=0.9896 (last merge round=21)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.5133969256453088, 'auprc': 0.741595835605193, 'loss_val': 0.8698539423921731, 'psi': 0.6046764896292625}-{'f1_val': 0.6314187161340539, 'auprc': 0.7940862757212309, 'loss_val': 0.5980147072890201, 'psi': 0.6964857399689247}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=1.578254 cos_to_last_merge=0.9897 (last merge round=21)
[S8] round=31 local utility u=0.003957 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9985485895578949, 'loss_val': 0.0596983252262872, 'psi': 0.9949368174175497}-{'f1_val': 0.9928250278729972, 'auprc': 0.9981115908173882, 'loss_val': 0.06807788425373323, 'psi': 0.9949396530507536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] START round=31 head_norm_before_train=1.698449 cos_to_last_merge=0.9551 (last merge round=17)
[S9] round=31 local utility u=0.004098 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9937532035899672, 'loss_val': 0.027406891917790905, 'psi': 0.9954975885243218}-{'f1_val': 0.9934918488430377, 'auprc': 0.9988519284542224, 'loss_val': 0.031886457635783634, 'psi': 0.9956358806875115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=31 head_norm_before_train=1.537860 cos_to_last_merge=0.9420 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.942
[S10] round=31 local utility u=0.003172 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9953332247711634, 'loss_val': 0.04377230858416482, 'psi': 0.9954990820174772}-{'f1_val': 0.9956096535150197, 'auprc': 0.9950637540815404, 'loss_val': 0.049307148166868875, 'psi': 0.995391293741628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=31 head_norm_before_train=1.829266 cos_to_last_merge=0.8325 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.832
[S11] round=31 local utility u=0.000601 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.9990399784758441, 'loss_val': 0.03299185165272882, 'psi': 0.9980428432529533}-{'f1_val': 0.9969642566262439, 'auprc': 0.9986624576222477, 'loss_val': 0.03057771146759764, 'psi': 0.9976435370246454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=31 head_norm_before_train=1.331948 cos_to_last_merge=0.9700 (last merge round=21)
[S13] round=31 local utility u=0.246290 metrics={'f1_val': 0.6020600681840016, 'auprc': 0.7007862945691674, 'loss_val': 0.6533107545757555, 'psi': 0.6415505587380679}-{'f1_val': 0.5580544598268088, 'auprc': 0.6934267097702227, 'loss_val': 0.8597790511735827, 'psi': 0.6122033598041744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=31 head_norm_before_train=1.648037 cos_to_last_merge=0.9604 (last merge round=15)
[S14] round=31 local utility u=0.000753 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9988354501422716, 'loss_val': 0.03173277744312487, 'psi': 0.9978783940803845}-{'f1_val': 0.9976291097282272, 'auprc': 0.9984720043524828, 'loss_val': 0.03448186651668906, 'psi': 0.9979662675779295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=31 head_norm_before_train=1.326901 cos_to_last_merge=0.9658 (last merge round=16)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7016872558005718, 'auprc': 0.8606983754537577, 'loss_val': 0.39756785492216534, 'psi': 0.7652917036618462}-{'f1_val': 0.9971172535281002, 'auprc': 0.9986502810550696, 'loss_val': 0.06903764570089557, 'psi': 0.9977304645388879}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=1.618068 cos_to_last_merge=0.9603 (last merge round=16)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8826157216733873, 'auprc': 0.9877858887236353, 'loss_val': 0.5240778265899756, 'psi': 0.9246837884934864}-{'f1_val': 0.9308250691372867, 'auprc': 0.9930633340940004, 'loss_val': 0.3019933281819176, 'psi': 0.9557203751199721}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=1.288035 cos_to_last_merge=0.9875 (last merge round=20)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6068485665697175, 'auprc': 0.8103258874295738, 'loss_val': 1.199240884495559, 'psi': 0.6882394949136601}-{'f1_val': 0.6530224809686392, 'auprc': 0.8328585337596771, 'loss_val': 1.059762200162923, 'psi': 0.7249569020850544}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.670497 cos_to_last_merge=0.9882 (last merge round=17)
[S2] round=32 local utility u=0.068519 metrics={'f1_val': 0.7156100927780082, 'auprc': 0.7353437530249518, 'loss_val': 0.7607557843443313, 'psi': 0.7235035568767856}-{'f1_val': 0.6993813925516972, 'auprc': 0.7640068594249498, 'loss_val': 0.886410391400636, 'psi': 0.7252315793009982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=32 head_norm_before_train=1.643708 cos_to_last_merge=0.9785 (last merge round=17)
[S3] round=32 local utility u=0.226989 metrics={'f1_val': 0.9975552686373071, 'auprc': 0.9983935706763509, 'loss_val': 0.059039517007266056, 'psi': 0.9978905894529246}-{'f1_val': 0.9344345889578257, 'auprc': 0.998703896392235, 'loss_val': 0.1352253166849247, 'psi': 0.9601423119315895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=32 head_norm_before_train=1.317826 cos_to_last_merge=0.9867 (last merge round=21)
[S4] round=32 local utility u=0.009139 metrics={'f1_val': 0.95178267708533, 'auprc': 0.9555292669595759, 'loss_val': 0.2921593321537284, 'psi': 0.9532813130350284}-{'f1_val': 0.9509024158382701, 'auprc': 0.962450329039831, 'loss_val': 0.3259198147756487, 'psi': 0.9555215811188944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=32 head_norm_before_train=1.539157 cos_to_last_merge=0.8539 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.854
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9899048492537418, 'loss_val': 0.10931464684167445, 'psi': 0.9937622268796308}-{'f1_val': 0.9963338119635569, 'auprc': 0.9908130422179393, 'loss_val': 0.10072443722029929, 'psi': 0.9941255040653099}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.633433 cos_to_last_merge=0.9545 (last merge round=12)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.8228297850896743, 'auprc': 0.9593578557980238, 'loss_val': 0.36958292214500454, 'psi': 0.8774410133730142}-{'f1_val': 0.9613225823734587, 'auprc': 0.9738713618493432, 'loss_val': 0.17227310326684517, 'psi': 0.9663420941638126}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.444756 cos_to_last_merge=0.9881 (last merge round=21)
[S7] round=32 local utility u=0.617821 metrics={'f1_val': 0.6391882199000675, 'auprc': 0.7981243343552783, 'loss_val': 0.5585454187147177, 'psi': 0.7027626656821518}-{'f1_val': 0.5133969256453088, 'auprc': 0.741595835605193, 'loss_val': 0.8698539423921731, 'psi': 0.6046764896292625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] sending update (kind=head size=1792 to 1 peers)
[S8] START round=32 head_norm_before_train=1.591723 cos_to_last_merge=0.9887 (last merge round=21)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.7163324629376355, 'auprc': 0.9973231013209933, 'loss_val': 0.1930254469796872, 'psi': 0.8287287182909786}-{'f1_val': 0.9925289693239863, 'auprc': 0.9985485895578949, 'loss_val': 0.0596983252262872, 'psi': 0.9949368174175497}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.714570 cos_to_last_merge=0.9537 (last merge round=17)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9995159000283832, 'loss_val': 0.029207604698623692, 'psi': 0.9961522243470249}-{'f1_val': 0.9966605118138915, 'auprc': 0.9937532035899672, 'loss_val': 0.027406891917790905, 'psi': 0.9954975885243218}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.563749 cos_to_last_merge=0.9392 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.939
[S10] round=32 local utility u=0.000702 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9950419385157285, 'loss_val': 0.04149353189579787, 'psi': 0.9953825675153033}-{'f1_val': 0.9956096535150197, 'auprc': 0.9953332247711634, 'loss_val': 0.04377230858416482, 'psi': 0.9954990820174772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=32 head_norm_before_train=1.845882 cos_to_last_merge=0.8318 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.832
[S11] round=32 local utility u=0.000436 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9986460860054666, 'loss_val': 0.027003959814476442, 'psi': 0.9974918861510959}-{'f1_val': 0.9973780864376928, 'auprc': 0.9990399784758441, 'loss_val': 0.03299185165272882, 'psi': 0.9980428432529533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=32 head_norm_before_train=1.350278 cos_to_last_merge=0.9670 (last merge round=21)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5532421713928759, 'auprc': 0.6608839406641759, 'loss_val': 0.9640808790106224, 'psi': 0.5962988791013959}-{'f1_val': 0.6020600681840016, 'auprc': 0.7007862945691674, 'loss_val': 0.6533107545757555, 'psi': 0.6415505587380679}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.663467 cos_to_last_merge=0.9589 (last merge round=15)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9988303344878038, 'loss_val': 0.03336998790535081, 'psi': 0.9977306386897206}-{'f1_val': 0.997240356705793, 'auprc': 0.9988354501422716, 'loss_val': 0.03173277744312487, 'psi': 0.9978783940803845}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.339892 cos_to_last_merge=0.9644 (last merge round=16)
[S15] round=32 local utility u=1.000000 metrics={'f1_val': 0.9966196520233872, 'auprc': 0.9966099229863644, 'loss_val': 0.06515335993312078, 'psi': 0.9966157604085781}-{'f1_val': 0.7016872558005718, 'auprc': 0.8606983754537577, 'loss_val': 0.39756785492216534, 'psi': 0.7652917036618462}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=32 head_norm_before_train=1.631215 cos_to_last_merge=0.9590 (last merge round=16)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.8636480888209206, 'auprc': 0.9896234381955576, 'loss_val': 0.6610415967710537, 'psi': 0.9140382285707754}-{'f1_val': 0.8826157216733873, 'auprc': 0.9877858887236353, 'loss_val': 0.5240778265899756, 'psi': 0.9246837884934864}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.298065 cos_to_last_merge=0.9858 (last merge round=20)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.48066217671033457, 'auprc': 0.7883738788041075, 'loss_val': 1.242992021885421, 'psi': 0.6037468575478437}-{'f1_val': 0.6068485665697175, 'auprc': 0.8103258874295738, 'loss_val': 1.199240884495559, 'psi': 0.6882394949136601}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.676736 cos_to_last_merge=0.9875 (last merge round=17)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.7138476474940568, 'auprc': 0.7528954020000707, 'loss_val': 0.8889933181498888, 'psi': 0.7294667492964624}-{'f1_val': 0.7156100927780082, 'auprc': 0.7353437530249518, 'loss_val': 0.7607557843443313, 'psi': 0.7235035568767856}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.668147 cos_to_last_merge=0.9749 (last merge round=17)
[S3] round=33 local utility u=0.002245 metrics={'f1_val': 0.9973956967430226, 'auprc': 0.9985855633971719, 'loss_val': 0.05416807408124719, 'psi': 0.9978716434046823}-{'f1_val': 0.9975552686373071, 'auprc': 0.9983935706763509, 'loss_val': 0.059039517007266056, 'psi': 0.9978905894529246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=33 head_norm_before_train=1.333999 cos_to_last_merge=0.9840 (last merge round=21)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9410624119093114, 'auprc': 0.9671839596252009, 'loss_val': 0.27657059235936526, 'psi': 0.9515110309956671}-{'f1_val': 0.95178267708533, 'auprc': 0.9555292669595759, 'loss_val': 0.2921593321537284, 'psi': 0.9532813130350284}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.552130 cos_to_last_merge=0.8524 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.852
[S5] round=33 local utility u=0.021890 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9925812492420297, 'loss_val': 0.07356318595864868, 'psi': 0.994832786874946}-{'f1_val': 0.9963338119635569, 'auprc': 0.9899048492537418, 'loss_val': 0.10931464684167445, 'psi': 0.9937622268796308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=33 head_norm_before_train=1.647426 cos_to_last_merge=0.9526 (last merge round=12)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7804294827014965, 'auprc': 0.8728236633941822, 'loss_val': 0.5309539177603088, 'psi': 0.8173871549785707}-{'f1_val': 0.8228297850896743, 'auprc': 0.9593578557980238, 'loss_val': 0.36958292214500454, 'psi': 0.8774410133730142}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.452717 cos_to_last_merge=0.9869 (last merge round=21)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.6366678947658253, 'auprc': 0.8012066081980653, 'loss_val': 0.5573146787708813, 'psi': 0.7024833801387214}-{'f1_val': 0.6391882199000675, 'auprc': 0.7981243343552783, 'loss_val': 0.5585454187147177, 'psi': 0.7027626656821518}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.603129 cos_to_last_merge=0.9878 (last merge round=21)
[S8] round=33 local utility u=0.745691 metrics={'f1_val': 0.9596285370973854, 'auprc': 0.984820634179908, 'loss_val': 0.12391313473479149, 'psi': 0.9697053759303944}-{'f1_val': 0.7163324629376355, 'auprc': 0.9973231013209933, 'loss_val': 0.1930254469796872, 'psi': 0.8287287182909786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=33 head_norm_before_train=1.726576 cos_to_last_merge=0.9524 (last merge round=17)
[S9] round=33 local utility u=0.005147 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9966380496373118, 'loss_val': 0.025282347846368243, 'psi': 0.9965013312552573}-{'f1_val': 0.993909773892786, 'auprc': 0.9995159000283832, 'loss_val': 0.029207604698623692, 'psi': 0.9961522243470249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=33 head_norm_before_train=1.586728 cos_to_last_merge=0.9368 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9950249193654681, 'loss_val': 0.04045293288726312, 'psi': 0.995122671157812}-{'f1_val': 0.9956096535150197, 'auprc': 0.9950419385157285, 'loss_val': 0.04149353189579787, 'psi': 0.9953825675153033}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.861576 cos_to_last_merge=0.8312 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.831
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9970974977402893, 'loss_val': 0.02599661717049355, 'psi': 0.9967695520931741}-{'f1_val': 0.9967224195815153, 'auprc': 0.9986460860054666, 'loss_val': 0.027003959814476442, 'psi': 0.9974918861510959}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.364057 cos_to_last_merge=0.9651 (last merge round=21)
[S13] round=33 local utility u=0.306635 metrics={'f1_val': 0.5979824448588356, 'auprc': 0.7173160245256456, 'loss_val': 0.7885493175457987, 'psi': 0.6457158767255595}-{'f1_val': 0.5532421713928759, 'auprc': 0.6608839406641759, 'loss_val': 0.9640808790106224, 'psi': 0.5962988791013959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=33 head_norm_before_train=1.675133 cos_to_last_merge=0.9576 (last merge round=15)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9980121866830549, 'loss_val': 0.03565608629933551, 'psi': 0.997403379567821}-{'f1_val': 0.9969975081576651, 'auprc': 0.9988303344878038, 'loss_val': 0.03336998790535081, 'psi': 0.9977306386897206}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.356271 cos_to_last_merge=0.9623 (last merge round=16)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.9020878793590958, 'auprc': 0.9946168319449334, 'loss_val': 0.16094375023385477, 'psi': 0.9390994603934308}-{'f1_val': 0.9966196520233872, 'auprc': 0.9966099229863644, 'loss_val': 0.06515335993312078, 'psi': 0.9966157604085781}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.644418 cos_to_last_merge=0.9578 (last merge round=16)
[S16] round=33 local utility u=0.206574 metrics={'f1_val': 0.8954600159633853, 'auprc': 0.9921938400268542, 'loss_val': 0.4464769888773449, 'psi': 0.9341535455887728}-{'f1_val': 0.8636480888209206, 'auprc': 0.9896234381955576, 'loss_val': 0.6610415967710537, 'psi': 0.9140382285707754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=33 head_norm_before_train=1.308108 cos_to_last_merge=0.9843 (last merge round=20)
[S17] round=33 local utility u=0.807300 metrics={'f1_val': 0.6625296890226828, 'auprc': 0.8417104429374879, 'loss_val': 0.8796067320820427, 'psi': 0.7342019905886048}-{'f1_val': 0.48066217671033457, 'auprc': 0.7883738788041075, 'loss_val': 1.242992021885421, 'psi': 0.6037468575478437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=34 head_norm_before_train=1.686945 cos_to_last_merge=0.9865 (last merge round=17)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.70428252163078, 'auprc': 0.7247152366463181, 'loss_val': 0.7985462951781725, 'psi': 0.7124556076369952}-{'f1_val': 0.7138476474940568, 'auprc': 0.7528954020000707, 'loss_val': 0.8889933181498888, 'psi': 0.7294667492964624}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=1.688199 cos_to_last_merge=0.9712 (last merge round=17)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9971375144070074, 'loss_val': 0.10153464566864633, 'psi': 0.9755241601034944}-{'f1_val': 0.9973956967430226, 'auprc': 0.9985855633971719, 'loss_val': 0.05416807408124719, 'psi': 0.9978716434046823}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.354760 cos_to_last_merge=0.9809 (last merge round=21)
[S4] round=34 local utility u=0.014348 metrics={'f1_val': 0.9553150513167541, 'auprc': 0.957973742502901, 'loss_val': 0.305759141102196, 'psi': 0.9563785277912129}-{'f1_val': 0.9410624119093114, 'auprc': 0.9671839596252009, 'loss_val': 0.27657059235936526, 'psi': 0.9515110309956671}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=34 head_norm_before_train=1.565963 cos_to_last_merge=0.8507 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.851
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.989802033420151, 'loss_val': 0.11031702067941442, 'psi': 0.9937211005461946}-{'f1_val': 0.9963338119635569, 'auprc': 0.9925812492420297, 'loss_val': 0.07356318595864868, 'psi': 0.994832786874946}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.664867 cos_to_last_merge=0.9500 (last merge round=12)
[S6] ⚠️ Model drifted since last merge! cos=0.950
[S6] round=34 local utility u=0.114845 metrics={'f1_val': 0.7985423364286148, 'auprc': 0.9061148346909712, 'loss_val': 0.509814562934302, 'psi': 0.8415713357335575}-{'f1_val': 0.7804294827014965, 'auprc': 0.8728236633941822, 'loss_val': 0.5309539177603088, 'psi': 0.8173871549785707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=34 head_norm_before_train=1.460438 cos_to_last_merge=0.9857 (last merge round=21)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5656648938457495, 'auprc': 0.7891371490539165, 'loss_val': 0.7153614464292898, 'psi': 0.6550537959290164}-{'f1_val': 0.6366678947658253, 'auprc': 0.8012066081980653, 'loss_val': 0.5573146787708813, 'psi': 0.7024833801387214}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.612489 cos_to_last_merge=0.9870 (last merge round=21)
[S8] round=34 local utility u=0.151602 metrics={'f1_val': 0.9934642595170017, 'auprc': 0.9985930338063314, 'loss_val': 0.06504084410942332, 'psi': 0.9955157692327335}-{'f1_val': 0.9596285370973854, 'auprc': 0.984820634179908, 'loss_val': 0.12391313473479149, 'psi': 0.9697053759303944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=34 head_norm_before_train=1.738989 cos_to_last_merge=0.9512 (last merge round=17)
[S9] round=34 local utility u=0.004081 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9988375991750509, 'loss_val': 0.0237189287474463, 'psi': 0.9973811510703529}-{'f1_val': 0.9964101856672208, 'auprc': 0.9966380496373118, 'loss_val': 0.025282347846368243, 'psi': 0.9965013312552573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=34 head_norm_before_train=1.605119 cos_to_last_merge=0.9345 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=34 local utility u=0.004293 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9957010685319423, 'loss_val': 0.03724243985224375, 'psi': 0.9957277638598232}-{'f1_val': 0.9951878390193748, 'auprc': 0.9950249193654681, 'loss_val': 0.04045293288726312, 'psi': 0.995122671157812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=34 head_norm_before_train=1.872874 cos_to_last_merge=0.8306 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.831
[S11] round=34 local utility u=0.001337 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9975335198933142, 'loss_val': 0.024629905133695316, 'psi': 0.996943960954384}-{'f1_val': 0.9965509216617638, 'auprc': 0.9970974977402893, 'loss_val': 0.02599661717049355, 'psi': 0.9967695520931741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=34 head_norm_before_train=1.376511 cos_to_last_merge=0.9630 (last merge round=21)
[S13] round=34 local utility u=0.139629 metrics={'f1_val': 0.6337502278241501, 'auprc': 0.7238404523783959, 'loss_val': 0.7434712264288357, 'psi': 0.6697863176458485}-{'f1_val': 0.5979824448588356, 'auprc': 0.7173160245256456, 'loss_val': 0.7885493175457987, 'psi': 0.6457158767255595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=34 head_norm_before_train=1.689115 cos_to_last_merge=0.9562 (last merge round=15)
[S14] round=34 local utility u=0.003430 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.998849492273475, 'loss_val': 0.03130700865017901, 'psi': 0.997738301803989}-{'f1_val': 0.9969975081576651, 'auprc': 0.9980121866830549, 'loss_val': 0.03565608629933551, 'psi': 0.997403379567821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=34 head_norm_before_train=1.372861 cos_to_last_merge=0.9604 (last merge round=16)
[S15] round=34 local utility u=0.335669 metrics={'f1_val': 0.9952542381910652, 'auprc': 0.9978744854974142, 'loss_val': 0.058377040179542386, 'psi': 0.9963023371136047}-{'f1_val': 0.9020878793590958, 'auprc': 0.9946168319449334, 'loss_val': 0.16094375023385477, 'psi': 0.9390994603934308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=34 head_norm_before_train=1.658458 cos_to_last_merge=0.9564 (last merge round=16)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8578486619293901, 'auprc': 0.9891060601991228, 'loss_val': 0.7050602148927007, 'psi': 0.9103516212372833}-{'f1_val': 0.8954600159633853, 'auprc': 0.9921938400268542, 'loss_val': 0.4464769888773449, 'psi': 0.9341535455887728}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.316093 cos_to_last_merge=0.9827 (last merge round=20)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6527084380208171, 'auprc': 0.7579145467800703, 'loss_val': 1.0704301619754109, 'psi': 0.6947908815245184}-{'f1_val': 0.6625296890226828, 'auprc': 0.8417104429374879, 'loss_val': 0.8796067320820427, 'psi': 0.7342019905886048}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.697835 cos_to_last_merge=0.9851 (last merge round=17)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6097883498142849, 'auprc': 0.7484358181297408, 'loss_val': 0.9976328263765132, 'psi': 0.6652473371404672}-{'f1_val': 0.70428252163078, 'auprc': 0.7247152366463181, 'loss_val': 0.7985462951781725, 'psi': 0.7124556076369952}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.701842 cos_to_last_merge=0.9683 (last merge round=17)
[S3] round=35 local utility u=0.138619 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9971166957164789, 'loss_val': 0.04457562720752616, 'psi': 0.9975500347664789}-{'f1_val': 0.9611152572344858, 'auprc': 0.9971375144070074, 'loss_val': 0.10153464566864633, 'psi': 0.9755241601034944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=35 head_norm_before_train=1.373660 cos_to_last_merge=0.9786 (last merge round=21)
[S4] round=35 local utility u=0.103815 metrics={'f1_val': 0.9694666196386105, 'auprc': 0.9534612757977098, 'loss_val': 0.16950123823331364, 'psi': 0.9630644821022502}-{'f1_val': 0.9553150513167541, 'auprc': 0.957973742502901, 'loss_val': 0.305759141102196, 'psi': 0.9563785277912129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=35 head_norm_before_train=1.576627 cos_to_last_merge=0.8494 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.849
[S5] round=35 local utility u=0.028295 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9925507802508492, 'loss_val': 0.061973830871493385, 'psi': 0.9948205992784738}-{'f1_val': 0.9963338119635569, 'auprc': 0.989802033420151, 'loss_val': 0.11031702067941442, 'psi': 0.9937211005461946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=35 head_norm_before_train=1.680122 cos_to_last_merge=0.9475 (last merge round=12)
[S6] ⚠️ Model drifted since last merge! cos=0.948
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.7719728184479188, 'auprc': 0.9421531912729694, 'loss_val': 0.5324078443890139, 'psi': 0.840044967577939}-{'f1_val': 0.7985423364286148, 'auprc': 0.9061148346909712, 'loss_val': 0.509814562934302, 'psi': 0.8415713357335575}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.467808 cos_to_last_merge=0.9846 (last merge round=21)
[S7] round=35 local utility u=1.000000 metrics={'f1_val': 0.7497831216839874, 'auprc': 0.9986584939945439, 'loss_val': 0.26032916906683096, 'psi': 0.84933327060821}-{'f1_val': 0.5656648938457495, 'auprc': 0.7891371490539165, 'loss_val': 0.7153614464292898, 'psi': 0.6550537959290164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=35 head_norm_before_train=1.620644 cos_to_last_merge=0.9864 (last merge round=21)
[S8] round=35 local utility u=0.005335 metrics={'f1_val': 0.9931832866490584, 'auprc': 0.9987551357134561, 'loss_val': 0.05317096809258835, 'psi': 0.9954120262748175}-{'f1_val': 0.9934642595170017, 'auprc': 0.9985930338063314, 'loss_val': 0.06504084410942332, 'psi': 0.9955157692327335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=35 head_norm_before_train=1.752003 cos_to_last_merge=0.9503 (last merge round=17)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9988360394002329, 'loss_val': 0.02775193369197892, 'psi': 0.9956295250659157}-{'f1_val': 0.9964101856672208, 'auprc': 0.9988375991750509, 'loss_val': 0.0237189287474463, 'psi': 0.9973811510703529}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.623037 cos_to_last_merge=0.9324 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.932
[S10] round=35 local utility u=0.000645 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9958308261562518, 'loss_val': 0.03634127567629249, 'psi': 0.9957796669095471}-{'f1_val': 0.9957455607450773, 'auprc': 0.9957010685319423, 'loss_val': 0.03724243985224375, 'psi': 0.9957277638598232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=35 head_norm_before_train=1.885713 cos_to_last_merge=0.8300 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.830
[S11] round=35 local utility u=0.002585 metrics={'f1_val': 0.9967233539996936, 'auprc': 0.9985486723800516, 'loss_val': 0.0235392580034056, 'psi': 0.9974534813518368}-{'f1_val': 0.9965509216617638, 'auprc': 0.9975335198933142, 'loss_val': 0.024629905133695316, 'psi': 0.996943960954384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=35 head_norm_before_train=1.388423 cos_to_last_merge=0.9607 (last merge round=21)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.61686829017138, 'auprc': 0.6885246466856092, 'loss_val': 0.7418400668004584, 'psi': 0.6455308327770717}-{'f1_val': 0.6337502278241501, 'auprc': 0.7238404523783959, 'loss_val': 0.7434712264288357, 'psi': 0.6697863176458485}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.701792 cos_to_last_merge=0.9550 (last merge round=15)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971542614490749, 'loss_val': 0.028897325141726635, 'psi': 0.997060209474229}-{'f1_val': 0.9969975081576651, 'auprc': 0.998849492273475, 'loss_val': 0.03130700865017901, 'psi': 0.997738301803989}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.391411 cos_to_last_merge=0.9584 (last merge round=16)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.8744091213379718, 'auprc': 0.9400643885155181, 'loss_val': 0.24559933118277638, 'psi': 0.9006712282089904}-{'f1_val': 0.9952542381910652, 'auprc': 0.9978744854974142, 'loss_val': 0.058377040179542386, 'psi': 0.9963023371136047}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.671209 cos_to_last_merge=0.9552 (last merge round=16)
[S16] round=35 local utility u=0.700212 metrics={'f1_val': 0.983540283422659, 'auprc': 0.994273569115177, 'loss_val': 0.07428753137975232, 'psi': 0.9878335976996662}-{'f1_val': 0.8578486619293901, 'auprc': 0.9891060601991228, 'loss_val': 0.7050602148927007, 'psi': 0.9103516212372833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=35 head_norm_before_train=1.324239 cos_to_last_merge=0.9814 (last merge round=20)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6318696334297695, 'auprc': 0.7164917356723208, 'loss_val': 1.1829667199162899, 'psi': 0.6657184743267901}-{'f1_val': 0.6527084380208171, 'auprc': 0.7579145467800703, 'loss_val': 1.0704301619754109, 'psi': 0.6947908815245184}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.709730 cos_to_last_merge=0.9837 (last merge round=17)
[S2] round=36 local utility u=0.393218 metrics={'f1_val': 0.7193888028246586, 'auprc': 0.7417913609231015, 'loss_val': 0.8488663204538928, 'psi': 0.7283498260640358}-{'f1_val': 0.6097883498142849, 'auprc': 0.7484358181297408, 'loss_val': 0.9976328263765132, 'psi': 0.6652473371404672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=36 head_norm_before_train=1.716590 cos_to_last_merge=0.9656 (last merge round=17)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9986772210196541, 'loss_val': 0.09412016789366565, 'psi': 0.9761159396475338}-{'f1_val': 0.9978389274664787, 'auprc': 0.9971166957164789, 'loss_val': 0.04457562720752616, 'psi': 0.9975500347664789}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.388419 cos_to_last_merge=0.9763 (last merge round=21)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9681056194869114, 'auprc': 0.9364621336350327, 'loss_val': 0.16323526537889663, 'psi': 0.95544822514616}-{'f1_val': 0.9694666196386105, 'auprc': 0.9534612757977098, 'loss_val': 0.16950123823331364, 'psi': 0.9630644821022502}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.587198 cos_to_last_merge=0.8482 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.848
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9917660685192548, 'loss_val': 0.06229757745210734, 'psi': 0.994506714585836}-{'f1_val': 0.9963338119635569, 'auprc': 0.9925507802508492, 'loss_val': 0.061973830871493385, 'psi': 0.9948205992784738}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.690441 cos_to_last_merge=0.9456 (last merge round=12)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.6226312721243596, 'auprc': 0.9305584364719974, 'loss_val': 0.43567617144194537, 'psi': 0.7458021378634148}-{'f1_val': 0.7719728184479188, 'auprc': 0.9421531912729694, 'loss_val': 0.5324078443890139, 'psi': 0.840044967577939}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.475339 cos_to_last_merge=0.9834 (last merge round=21)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.4585871841911648, 'auprc': 0.7765403951229786, 'loss_val': 0.9649135345286363, 'psi': 0.5857684685638903}-{'f1_val': 0.7497831216839874, 'auprc': 0.9986584939945439, 'loss_val': 0.26032916906683096, 'psi': 0.84933327060821}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=1.630296 cos_to_last_merge=0.9857 (last merge round=21)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9985509274846657, 'loss_val': 0.05065290910867677, 'psi': 0.9947191406668976}-{'f1_val': 0.9931832866490584, 'auprc': 0.9987551357134561, 'loss_val': 0.05317096809258835, 'psi': 0.9954120262748175}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.762754 cos_to_last_merge=0.9501 (last merge round=17)
[S9] round=36 local utility u=0.002716 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9939082781425203, 'loss_val': 0.024085738812557662, 'psi': 0.9953133681245747}-{'f1_val': 0.9934918488430377, 'auprc': 0.9988360394002329, 'loss_val': 0.02775193369197892, 'psi': 0.9956295250659157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=36 head_norm_before_train=1.641100 cos_to_last_merge=0.9305 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9947369917995689, 'loss_val': 0.035868028149079814, 'psi': 0.9953421331668739}-{'f1_val': 0.9957455607450773, 'auprc': 0.9958308261562518, 'loss_val': 0.03634127567629249, 'psi': 0.9957796669095471}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.899539 cos_to_last_merge=0.8295 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.830
[S11] round=36 local utility u=0.001938 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9986372577033202, 'loss_val': 0.02137379129845351, 'psi': 0.9976334570570744}-{'f1_val': 0.9967233539996936, 'auprc': 0.9985486723800516, 'loss_val': 0.0235392580034056, 'psi': 0.9974534813518368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=36 head_norm_before_train=1.397845 cos_to_last_merge=0.9589 (last merge round=21)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.6061247859043933, 'auprc': 0.6867566146897854, 'loss_val': 1.0242785367232758, 'psi': 0.6383775174185502}-{'f1_val': 0.61686829017138, 'auprc': 0.6885246466856092, 'loss_val': 0.7418400668004584, 'psi': 0.6455308327770717}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.714386 cos_to_last_merge=0.9539 (last merge round=15)
[S14] round=36 local utility u=0.002712 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.999208773275065, 'loss_val': 0.02963662405069258, 'psi': 0.997882014204625}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971542614490749, 'loss_val': 0.028897325141726635, 'psi': 0.997060209474229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=36 head_norm_before_train=1.412864 cos_to_last_merge=0.9559 (last merge round=16)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.847716147598656, 'auprc': 0.9478834115546418, 'loss_val': 0.25390831128814706, 'psi': 0.8877830531810503}-{'f1_val': 0.8744091213379718, 'auprc': 0.9400643885155181, 'loss_val': 0.24559933118277638, 'psi': 0.9006712282089904}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.683531 cos_to_last_merge=0.9540 (last merge round=16)
[S16] round=36 local utility u=0.043198 metrics={'f1_val': 0.992709249004596, 'auprc': 0.9953583291756829, 'loss_val': 0.04615920702838294, 'psi': 0.9937688810730307}-{'f1_val': 0.983540283422659, 'auprc': 0.994273569115177, 'loss_val': 0.07428753137975232, 'psi': 0.9878335976996662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=36 head_norm_before_train=1.335464 cos_to_last_merge=0.9795 (last merge round=20)
[S17] round=36 local utility u=0.387572 metrics={'f1_val': 0.6686928280485036, 'auprc': 0.8310271547582647, 'loss_val': 0.9723676120323994, 'psi': 0.733626558732408}-{'f1_val': 0.6318696334297695, 'auprc': 0.7164917356723208, 'loss_val': 1.1829667199162899, 'psi': 0.6657184743267901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=37 head_norm_before_train=1.727303 cos_to_last_merge=0.9816 (last merge round=17)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.7220080513878064, 'auprc': 0.7407083425686483, 'loss_val': 0.8956788116597089, 'psi': 0.7294881678601431}-{'f1_val': 0.7193888028246586, 'auprc': 0.7417913609231015, 'loss_val': 0.8488663204538928, 'psi': 0.7283498260640358}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.731245 cos_to_last_merge=0.9634 (last merge round=17)
[S3] round=37 local utility u=0.122747 metrics={'f1_val': 0.9936445785345308, 'auprc': 0.9988211400448077, 'loss_val': 0.044474690134063175, 'psi': 0.9957152031386416}-{'f1_val': 0.9610750853994537, 'auprc': 0.9986772210196541, 'loss_val': 0.09412016789366565, 'psi': 0.9761159396475338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=37 head_norm_before_train=1.400232 cos_to_last_merge=0.9738 (last merge round=21)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9280071803591148, 'auprc': 0.935198537069942, 'loss_val': 0.22430530112814126, 'psi': 0.9308837230434457}-{'f1_val': 0.9681056194869114, 'auprc': 0.9364621336350327, 'loss_val': 0.16323526537889663, 'psi': 0.95544822514616}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.596371 cos_to_last_merge=0.8471 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.847
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.990092467318211, 'loss_val': 0.06923430791193674, 'psi': 0.9938372741054184}-{'f1_val': 0.9963338119635569, 'auprc': 0.9917660685192548, 'loss_val': 0.06229757745210734, 'psi': 0.994506714585836}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.699881 cos_to_last_merge=0.9443 (last merge round=12)
[S6] ⚠️ Model drifted since last merge! cos=0.944
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6015312273195808, 'auprc': 0.7676452882721796, 'loss_val': 0.9515221302318165, 'psi': 0.6679768517006203}-{'f1_val': 0.6226312721243596, 'auprc': 0.9305584364719974, 'loss_val': 0.43567617144194537, 'psi': 0.7458021378634148}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.480273 cos_to_last_merge=0.9827 (last merge round=21)
[S7] round=37 local utility u=0.824234 metrics={'f1_val': 0.6425899249271059, 'auprc': 0.807563833589821, 'loss_val': 0.5135324212059197, 'psi': 0.7085794883921919}-{'f1_val': 0.4585871841911648, 'auprc': 0.7765403951229786, 'loss_val': 0.9649135345286363, 'psi': 0.5857684685638903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=37 head_norm_before_train=1.641706 cos_to_last_merge=0.9847 (last merge round=21)
[S8] round=37 local utility u=0.004626 metrics={'f1_val': 0.9939849501843234, 'auprc': 0.998782294287291, 'loss_val': 0.05301612217241343, 'psi': 0.9959038878255104}-{'f1_val': 0.9921646161217188, 'auprc': 0.9985509274846657, 'loss_val': 0.05065290910867677, 'psi': 0.9947191406668976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] sending update (kind=head size=1808 to 1 peers)
[S9] START round=37 head_norm_before_train=1.773712 cos_to_last_merge=0.9498 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.950
[S9] round=37 local utility u=0.006990 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9989104437639758, 'loss_val': 0.02257279455994449, 'psi': 0.9970602085241016}-{'f1_val': 0.9962500947792776, 'auprc': 0.9939082781425203, 'loss_val': 0.024085738812557662, 'psi': 0.9953133681245747}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=37 head_norm_before_train=1.658843 cos_to_last_merge=0.9287 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.929
[S10] round=37 local utility u=0.000796 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9949095084781816, 'loss_val': 0.03479413629229894, 'psi': 0.995411139838319}-{'f1_val': 0.9957455607450773, 'auprc': 0.9947369917995689, 'loss_val': 0.035868028149079814, 'psi': 0.9953421331668739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=37 head_norm_before_train=1.913468 cos_to_last_merge=0.8291 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.829
[S11] round=37 local utility u=0.000444 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9986784376179771, 'loss_val': 0.020609634131000424, 'psi': 0.9976499290229371}-{'f1_val': 0.9969642566262439, 'auprc': 0.9986372577033202, 'loss_val': 0.02137379129845351, 'psi': 0.9976334570570744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=37 head_norm_before_train=1.406911 cos_to_last_merge=0.9563 (last merge round=21)
[S13] round=37 local utility u=0.263824 metrics={'f1_val': 0.6337377639329635, 'auprc': 0.7192391461652343, 'loss_val': 0.7597566355318344, 'psi': 0.6679383168258719}-{'f1_val': 0.6061247859043933, 'auprc': 0.6867566146897854, 'loss_val': 1.0242785367232758, 'psi': 0.6383775174185502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] sending update (kind=head size=1793 to 1 peers)
[S14] START round=37 head_norm_before_train=1.728056 cos_to_last_merge=0.9527 (last merge round=15)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9942951036644737, 'auprc': 0.9992212722797627, 'loss_val': 0.04057350717290844, 'psi': 0.9962655711105893}-{'f1_val': 0.9969975081576651, 'auprc': 0.999208773275065, 'loss_val': 0.02963662405069258, 'psi': 0.997882014204625}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.433919 cos_to_last_merge=0.9534 (last merge round=16)
[S15] round=37 local utility u=0.618091 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9918622554522706, 'loss_val': 0.04384550149207274, 'psi': 0.9947929032134206}-{'f1_val': 0.847716147598656, 'auprc': 0.9478834115546418, 'loss_val': 0.25390831128814706, 'psi': 0.8877830531810503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=37 head_norm_before_train=1.694637 cos_to_last_merge=0.9528 (last merge round=16)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.992269773212496, 'auprc': 0.9944447148635409, 'loss_val': 0.04811746000775969, 'psi': 0.993139749872914}-{'f1_val': 0.992709249004596, 'auprc': 0.9953583291756829, 'loss_val': 0.04615920702838294, 'psi': 0.9937688810730307}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.344954 cos_to_last_merge=0.9780 (last merge round=20)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.4976292911958463, 'auprc': 0.6503377683380264, 'loss_val': 1.3409259828394695, 'psi': 0.5587126820527184}-{'f1_val': 0.6686928280485036, 'auprc': 0.8310271547582647, 'loss_val': 0.9723676120323994, 'psi': 0.733626558732408}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.746107 cos_to_last_merge=0.9793 (last merge round=17)
[S2] round=38 local utility u=0.034417 metrics={'f1_val': 0.7130902641639645, 'auprc': 0.7598544468868562, 'loss_val': 0.8307760000143052, 'psi': 0.7317959372531211}-{'f1_val': 0.7220080513878064, 'auprc': 0.7407083425686483, 'loss_val': 0.8956788116597089, 'psi': 0.7294881678601431}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=38 head_norm_before_train=1.746120 cos_to_last_merge=0.9613 (last merge round=17)
[S3] round=38 local utility u=0.007825 metrics={'f1_val': 0.996947988970087, 'auprc': 0.997146358616187, 'loss_val': 0.043621196960263044, 'psi': 0.997027336828527}-{'f1_val': 0.9936445785345308, 'auprc': 0.9988211400448077, 'loss_val': 0.044474690134063175, 'psi': 0.9957152031386416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=38 head_norm_before_train=1.411570 cos_to_last_merge=0.9712 (last merge round=21)
[S4] round=38 local utility u=0.066953 metrics={'f1_val': 0.9431737556009889, 'auprc': 0.9692925956557983, 'loss_val': 0.2836807207818025, 'psi': 0.9536212916229128}-{'f1_val': 0.9280071803591148, 'auprc': 0.935198537069942, 'loss_val': 0.22430530112814126, 'psi': 0.9308837230434457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=38 head_norm_before_train=1.604480 cos_to_last_merge=0.8462 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.846
[S5] round=38 local utility u=0.011065 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9922238831271895, 'loss_val': 0.05349854911220596, 'psi': 0.9946898404290099}-{'f1_val': 0.9963338119635569, 'auprc': 0.990092467318211, 'loss_val': 0.06923430791193674, 'psi': 0.9938372741054184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=38 head_norm_before_train=1.708781 cos_to_last_merge=0.9427 (last merge round=12)
[S6] ⚠️ Model drifted since last merge! cos=0.943
[S6] round=38 local utility u=0.829504 metrics={'f1_val': 0.7276734181023414, 'auprc': 0.9291369354542818, 'loss_val': 0.5338427337565105, 'psi': 0.8082588250431175}-{'f1_val': 0.6015312273195808, 'auprc': 0.7676452882721796, 'loss_val': 0.9515221302318165, 'psi': 0.6679768517006203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=38 head_norm_before_train=1.485290 cos_to_last_merge=0.9820 (last merge round=21)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5575784780462372, 'auprc': 0.7898492877431497, 'loss_val': 0.7399054814626077, 'psi': 0.6504868019250022}-{'f1_val': 0.6425899249271059, 'auprc': 0.807563833589821, 'loss_val': 0.5135324212059197, 'psi': 0.7085794883921919}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.654830 cos_to_last_merge=0.9836 (last merge round=21)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9983821431016756, 'loss_val': 0.04737347659148963, 'psi': 0.9946516269137016}-{'f1_val': 0.9939849501843234, 'auprc': 0.998782294287291, 'loss_val': 0.05301612217241343, 'psi': 0.9959038878255104}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.784858 cos_to_last_merge=0.9496 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.950
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9907913321404518, 'auprc': 0.9995759381281649, 'loss_val': 0.03507020889236344, 'psi': 0.994305174535537}-{'f1_val': 0.9958267183641853, 'auprc': 0.9989104437639758, 'loss_val': 0.02257279455994449, 'psi': 0.9970602085241016}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.675689 cos_to_last_merge=0.9271 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=38 local utility u=0.001027 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9952250990597807, 'loss_val': 0.0336872730511007, 'psi': 0.9955373760709586}-{'f1_val': 0.9957455607450773, 'auprc': 0.9949095084781816, 'loss_val': 0.03479413629229894, 'psi': 0.995411139838319}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=38 head_norm_before_train=1.924282 cos_to_last_merge=0.8286 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.829
[S11] round=38 local utility u=0.000247 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9986297216973257, 'loss_val': 0.019969546013428638, 'psi': 0.9976304426546765}-{'f1_val': 0.9969642566262439, 'auprc': 0.9986784376179771, 'loss_val': 0.020609634131000424, 'psi': 0.9976499290229371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=38 head_norm_before_train=1.415959 cos_to_last_merge=0.9544 (last merge round=21)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6330010654095486, 'auprc': 0.7491916833962327, 'loss_val': 0.8868828282442098, 'psi': 0.6794773126042222}-{'f1_val': 0.6337377639329635, 'auprc': 0.7192391461652343, 'loss_val': 0.7597566355318344, 'psi': 0.6679383168258719}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.739764 cos_to_last_merge=0.9515 (last merge round=15)
[S14] round=38 local utility u=0.017262 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9992301085863955, 'loss_val': 0.02867968971836478, 'psi': 0.998529463343766}-{'f1_val': 0.9942951036644737, 'auprc': 0.9992212722797627, 'loss_val': 0.04057350717290844, 'psi': 0.9962655711105893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=38 head_norm_before_train=1.454884 cos_to_last_merge=0.9508 (last merge round=16)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7021146389164286, 'auprc': 0.9133381345871023, 'loss_val': 0.3959534439864079, 'psi': 0.7866040371846981}-{'f1_val': 0.9967466683875206, 'auprc': 0.9918622554522706, 'loss_val': 0.04384550149207274, 'psi': 0.9947929032134206}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.705251 cos_to_last_merge=0.9517 (last merge round=16)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9847991483360631, 'auprc': 0.9941399463553446, 'loss_val': 0.07050764229121124, 'psi': 0.9885354675437756}-{'f1_val': 0.992269773212496, 'auprc': 0.9944447148635409, 'loss_val': 0.04811746000775969, 'psi': 0.993139749872914}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.355986 cos_to_last_merge=0.9766 (last merge round=20)
[S17] round=38 local utility u=1.000000 metrics={'f1_val': 0.7257574593518193, 'auprc': 0.8301523230920609, 'loss_val': 0.7179313228026017, 'psi': 0.767515404847916}-{'f1_val': 0.4976292911958463, 'auprc': 0.6503377683380264, 'loss_val': 1.3409259828394695, 'psi': 0.5587126820527184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=39 head_norm_before_train=1.764775 cos_to_last_merge=0.9770 (last merge round=17)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.706294937621737, 'auprc': 0.7586852001463906, 'loss_val': 0.8507426114249707, 'psi': 0.7272510426315985}-{'f1_val': 0.7130902641639645, 'auprc': 0.7598544468868562, 'loss_val': 0.8307760000143052, 'psi': 0.7317959372531211}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.727 u=0.0000 p_local=0.0914 f1=0.706 auprc=0.759 bytes=41373
[S3] START round=39 head_norm_before_train=1.763758 cos_to_last_merge=0.9587 (last merge round=17)
[S3] round=39 local utility u=0.010685 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9988202869315554, 'loss_val': 0.03261938779146992, 'psi': 0.9982314712525094}-{'f1_val': 0.996947988970087, 'auprc': 0.997146358616187, 'loss_val': 0.043621196960263044, 'psi': 0.997027336828527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S3] r=40 psi=0.998 u=0.0107 p_local=0.0799 f1=0.998 auprc=0.999 bytes=44940
[S4] START round=39 head_norm_before_train=1.417775 cos_to_last_merge=0.9683 (last merge round=21)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.944694058891637, 'auprc': 0.9587152782410093, 'loss_val': 0.2901967445848645, 'psi': 0.9503025466313859}-{'f1_val': 0.9431737556009889, 'auprc': 0.9692925956557983, 'loss_val': 0.2836807207818025, 'psi': 0.9536212916229128}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.950 u=0.0000 p_local=0.0442 f1=0.945 auprc=0.959 bytes=39574
[S5] START round=39 head_norm_before_train=1.611360 cos_to_last_merge=0.8455 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.845
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9904793566231987, 'loss_val': 0.05572902550733734, 'psi': 0.9939920298274136}-{'f1_val': 0.9963338119635569, 'auprc': 0.9922238831271895, 'loss_val': 0.05349854911220596, 'psi': 0.9946898404290099}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.994 u=0.0000 p_local=0.0527 f1=0.996 auprc=0.990 bytes=41367
[S6] START round=39 head_norm_before_train=1.716048 cos_to_last_merge=0.9414 (last merge round=12)
[S6] ⚠️ Model drifted since last merge! cos=0.941
[S6] round=39 local utility u=0.308679 metrics={'f1_val': 0.820495923143218, 'auprc': 0.9404684874969964, 'loss_val': 0.5074149448155011, 'psi': 0.8684849488847294}-{'f1_val': 0.7276734181023414, 'auprc': 0.9291369354542818, 'loss_val': 0.5338427337565105, 'psi': 0.8082588250431175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S6] r=40 psi=0.868 u=0.3087 p_local=0.2821 f1=0.820 auprc=0.940 bytes=43123
[S7] START round=39 head_norm_before_train=1.491436 cos_to_last_merge=0.9811 (last merge round=21)
[S7] round=39 local utility u=0.247937 metrics={'f1_val': 0.6127631872564367, 'auprc': 0.7969309635847636, 'loss_val': 0.5963848870447255, 'psi': 0.6864302977877674}-{'f1_val': 0.5575784780462372, 'auprc': 0.7898492877431497, 'loss_val': 0.7399054814626077, 'psi': 0.6504868019250022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S7] r=40 psi=0.686 u=0.2479 p_local=0.2996 f1=0.613 auprc=0.797 bytes=50269
[S8] START round=39 head_norm_before_train=1.667389 cos_to_last_merge=0.9827 (last merge round=21)
[S8] round=39 local utility u=0.006450 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9986457476788325, 'loss_val': 0.0440295643640665, 'psi': 0.9956335013402309}-{'f1_val': 0.9921646161217188, 'auprc': 0.9983821431016756, 'loss_val': 0.04737347659148963, 'psi': 0.9946516269137016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S8] r=40 psi=0.996 u=0.0064 p_local=0.0629 f1=0.994 auprc=0.999 bytes=53955
[S9] START round=39 head_norm_before_train=1.796206 cos_to_last_merge=0.9491 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.949
[S9] round=39 local utility u=0.014320 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9942866333580667, 'loss_val': 0.0233153776279219, 'psi': 0.9954647102107932}-{'f1_val': 0.9907913321404518, 'auprc': 0.9995759381281649, 'loss_val': 0.03507020889236344, 'psi': 0.994305174535537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S9] r=40 psi=0.995 u=0.0143 p_local=0.0079 f1=0.996 auprc=0.994 bytes=52143
[S10] START round=39 head_norm_before_train=1.691030 cos_to_last_merge=0.9256 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9948533234138619, 'loss_val': 0.03299229110854878, 'psi': 0.995388665812591}-{'f1_val': 0.9957455607450773, 'auprc': 0.9952250990597807, 'loss_val': 0.0336872730511007, 'psi': 0.9955373760709586}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0033 f1=0.996 auprc=0.995 bytes=61113
[S11] START round=39 head_norm_before_train=1.935735 cos_to_last_merge=0.8282 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.828
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9980511596777231, 'loss_val': 0.020731308655204336, 'psi': 0.9971510168681476}-{'f1_val': 0.9969642566262439, 'auprc': 0.9986297216973257, 'loss_val': 0.019969546013428638, 'psi': 0.9976304426546765}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.997 u=0.0000 p_local=0.0065 f1=0.997 auprc=0.998 bytes=59350
[S13] START round=39 head_norm_before_train=1.426088 cos_to_last_merge=0.9526 (last merge round=21)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6310328392405875, 'auprc': 0.6236376646295523, 'loss_val': 0.8466990766926885, 'psi': 0.6280747693961735}-{'f1_val': 0.6330010654095486, 'auprc': 0.7491916833962327, 'loss_val': 0.8868828282442098, 'psi': 0.6794773126042222}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.628 u=0.0000 p_local=0.0770 f1=0.631 auprc=0.624 bytes=35915
[S14] START round=39 head_norm_before_train=1.751559 cos_to_last_merge=0.9503 (last merge round=15)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9988513919506266, 'loss_val': 0.025009863330800203, 'psi': 0.997985518481286}-{'f1_val': 0.9980623665153463, 'auprc': 0.9992301085863955, 'loss_val': 0.02867968971836478, 'psi': 0.998529463343766}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.998 u=0.0000 p_local=0.0051 f1=0.997 auprc=0.999 bytes=48611
[S15] START round=39 head_norm_before_train=1.474865 cos_to_last_merge=0.9484 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=39 local utility u=0.807264 metrics={'f1_val': 0.900877565646653, 'auprc': 0.9922992457898294, 'loss_val': 0.2108867879960693, 'psi': 0.9374462377039235}-{'f1_val': 0.7021146389164286, 'auprc': 0.9133381345871023, 'loss_val': 0.3959534439864079, 'psi': 0.7866040371846981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S15] r=40 psi=0.937 u=0.8073 p_local=0.3534 f1=0.901 auprc=0.992 bytes=44957
[S16] START round=39 head_norm_before_train=1.714437 cos_to_last_merge=0.9507 (last merge round=16)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8409068708977117, 'auprc': 0.9879599949121325, 'loss_val': 0.8825357564788218, 'psi': 0.8997281205034801}-{'f1_val': 0.9847991483360631, 'auprc': 0.9941399463553446, 'loss_val': 0.07050764229121124, 'psi': 0.9885354675437756}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.900 u=0.0000 p_local=0.1012 f1=0.841 auprc=0.988 bytes=44866
[S17] START round=39 head_norm_before_train=1.369158 cos_to_last_merge=0.9749 (last merge round=20)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.39705575027872797, 'auprc': 0.5932773654434869, 'loss_val': 1.428831793685243, 'psi': 0.4755443963446315}-{'f1_val': 0.7257574593518193, 'auprc': 0.8301523230920609, 'loss_val': 0.7179313228026017, 'psi': 0.767515404847916}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.476 u=0.0000 p_local=0.2767 f1=0.397 auprc=0.593 bytes=35935
[S2] START round=40 head_norm_before_train=1.783587 cos_to_last_merge=0.9747 (last merge round=17)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.6991614290950736, 'auprc': 0.7462674342195104, 'loss_val': 0.8990829490230294, 'psi': 0.7180038311448483}-{'f1_val': 0.706294937621737, 'auprc': 0.7586852001463906, 'loss_val': 0.8507426114249707, 'psi': 0.7272510426315985}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.783409 cos_to_last_merge=0.9558 (last merge round=17)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9348958752843897, 'auprc': 0.9986243143370974, 'loss_val': 0.1325141786515517, 'psi': 0.9603872509054727}-{'f1_val': 0.9978389274664787, 'auprc': 0.9988202869315554, 'loss_val': 0.03261938779146992, 'psi': 0.9982314712525094}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.420622 cos_to_last_merge=0.9657 (last merge round=21)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9290592590396003, 'auprc': 0.9393368288902748, 'loss_val': 0.23440585083894883, 'psi': 0.93317028697987}-{'f1_val': 0.944694058891637, 'auprc': 0.9587152782410093, 'loss_val': 0.2901967445848645, 'psi': 0.9503025466313859}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.621889 cos_to_last_merge=0.8446 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.845
[S5] round=40 local utility u=0.015833 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9972521814167783, 'loss_val': 0.04438065271409421, 'psi': 0.9967011597448454}-{'f1_val': 0.9963338119635569, 'auprc': 0.9904793566231987, 'loss_val': 0.05572902550733734, 'psi': 0.9939920298274136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=40 head_norm_before_train=1.721758 cos_to_last_merge=0.9405 (last merge round=12)
[S6] ⚠️ Model drifted since last merge! cos=0.940
[S6] round=40 local utility u=0.628076 metrics={'f1_val': 0.9604502912090898, 'auprc': 0.9722103808999395, 'loss_val': 0.1862142611659076, 'psi': 0.9651543270854297}-{'f1_val': 0.820495923143218, 'auprc': 0.9404684874969964, 'loss_val': 0.5074149448155011, 'psi': 0.8684849488847294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=40 head_norm_before_train=1.498123 cos_to_last_merge=0.9802 (last merge round=21)
[S7] round=40 local utility u=0.202238 metrics={'f1_val': 0.6559500793000786, 'auprc': 0.8068561384432698, 'loss_val': 0.480804844718287, 'psi': 0.7163125029573552}-{'f1_val': 0.6127631872564367, 'auprc': 0.7969309635847636, 'loss_val': 0.5963848870447255, 'psi': 0.6864302977877674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=40 head_norm_before_train=1.681852 cos_to_last_merge=0.9815 (last merge round=21)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9944057881617658, 'auprc': 0.9990047523958666, 'loss_val': 0.06004957593002414, 'psi': 0.9962453738554061}-{'f1_val': 0.9936253371144965, 'auprc': 0.9986457476788325, 'loss_val': 0.0440295643640665, 'psi': 0.9956335013402309}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.806874 cos_to_last_merge=0.9482 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.948
[S9] round=40 local utility u=0.007808 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9988771481010288, 'loss_val': 0.021446063043621136, 'psi': 0.997298528219943}-{'f1_val': 0.9962500947792776, 'auprc': 0.9942866333580667, 'loss_val': 0.0233153776279219, 'psi': 0.9954647102107932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=40 head_norm_before_train=1.702243 cos_to_last_merge=0.9241 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=40 local utility u=0.001322 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9953980173975876, 'loss_val': 0.03198161387603239, 'psi': 0.9956065434060813}-{'f1_val': 0.9957455607450773, 'auprc': 0.9948533234138619, 'loss_val': 0.03299229110854878, 'psi': 0.995388665812591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=40 head_norm_before_train=1.946494 cos_to_last_merge=0.8279 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.828
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9978518836029027, 'loss_val': 0.020632943917781303, 'psi': 0.9970713064382194}-{'f1_val': 0.9965509216617638, 'auprc': 0.9980511596777231, 'loss_val': 0.020731308655204336, 'psi': 0.9971510168681476}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.436520 cos_to_last_merge=0.9512 (last merge round=21)
[S13] round=40 local utility u=0.107371 metrics={'f1_val': 0.627742069239241, 'auprc': 0.7324151689653963, 'loss_val': 0.9385445862350453, 'psi': 0.6696113091297031}-{'f1_val': 0.6310328392405875, 'auprc': 0.6236376646295523, 'loss_val': 0.8466990766926885, 'psi': 0.6280747693961735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] sending update (kind=head size=1790 to 1 peers)
[S14] START round=40 head_norm_before_train=1.763754 cos_to_last_merge=0.9492 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.949
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9988508902611399, 'loss_val': 0.02597261750143446, 'psi': 0.9979853178054914}-{'f1_val': 0.9974082695017256, 'auprc': 0.9988513919506266, 'loss_val': 0.025009863330800203, 'psi': 0.997985518481286}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.493553 cos_to_last_merge=0.9462 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=40 local utility u=0.383258 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976325736970922, 'loss_val': 0.03558523656910256, 'psi': 0.9971010305113492}-{'f1_val': 0.900877565646653, 'auprc': 0.9922992457898294, 'loss_val': 0.2108867879960693, 'psi': 0.9374462377039235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=40 head_norm_before_train=1.723381 cos_to_last_merge=0.9498 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.950
[S16] round=40 local utility u=0.309230 metrics={'f1_val': 0.8852944726149736, 'auprc': 0.9923667589623524, 'loss_val': 0.5436222691136608, 'psi': 0.9281233871539252}-{'f1_val': 0.8409068708977117, 'auprc': 0.9879599949121325, 'loss_val': 0.8825357564788218, 'psi': 0.8997281205034801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=40 head_norm_before_train=1.379054 cos_to_last_merge=0.9735 (last merge round=20)
[S17] round=40 local utility u=1.000000 metrics={'f1_val': 0.6850304362536795, 'auprc': 0.8404813619417184, 'loss_val': 0.9844527292878636, 'psi': 0.7472108065288952}-{'f1_val': 0.39705575027872797, 'auprc': 0.5932773654434869, 'loss_val': 1.428831793685243, 'psi': 0.4755443963446315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=41 head_norm_before_train=1.800242 cos_to_last_merge=0.9727 (last merge round=17)
[S2] round=41 local utility u=0.029579 metrics={'f1_val': 0.7211870572973387, 'auprc': 0.7484957978623358, 'loss_val': 0.9787633790408341, 'psi': 0.7321105535233374}-{'f1_val': 0.6991614290950736, 'auprc': 0.7462674342195104, 'loss_val': 0.8990829490230294, 'psi': 0.7180038311448483}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=41 head_norm_before_train=1.801487 cos_to_last_merge=0.9533 (last merge round=17)
[S3] round=41 local utility u=0.087264 metrics={'f1_val': 0.9579254148315203, 'auprc': 0.9971392255259193, 'loss_val': 0.09170771493995149, 'psi': 0.9736109391092799}-{'f1_val': 0.9348958752843897, 'auprc': 0.9986243143370974, 'loss_val': 0.1325141786515517, 'psi': 0.9603872509054727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=41 head_norm_before_train=1.426050 cos_to_last_merge=0.9639 (last merge round=21)
[S4] round=41 local utility u=0.187371 metrics={'f1_val': 0.9660093203196771, 'auprc': 0.959291394322893, 'loss_val': 0.14122826149833898, 'psi': 0.9633221499209635}-{'f1_val': 0.9290592590396003, 'auprc': 0.9393368288902748, 'loss_val': 0.23440585083894883, 'psi': 0.93317028697987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=41 head_norm_before_train=1.638392 cos_to_last_merge=0.8430 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.843
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9915610503293384, 'loss_val': 0.06543829908486061, 'psi': 0.9941615202684659}-{'f1_val': 0.9963338119635569, 'auprc': 0.9972521814167783, 'loss_val': 0.04438065271409421, 'psi': 0.9967011597448454}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.730994 cos_to_last_merge=0.9393 (last merge round=12)
[S6] ⚠️ Model drifted since last merge! cos=0.939
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.8073067661152857, 'auprc': 0.9472244440813915, 'loss_val': 0.43819819095442003, 'psi': 0.863273837301728}-{'f1_val': 0.9604502912090898, 'auprc': 0.9722103808999395, 'loss_val': 0.1862142611659076, 'psi': 0.9651543270854297}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.506501 cos_to_last_merge=0.9791 (last merge round=21)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.6428033689973146, 'auprc': 0.8007994436244402, 'loss_val': 0.5364159467800625, 'psi': 0.7060017988481648}-{'f1_val': 0.6559500793000786, 'auprc': 0.8068561384432698, 'loss_val': 0.480804844718287, 'psi': 0.7163125029573552}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.693627 cos_to_last_merge=0.9804 (last merge round=21)
[S8] round=41 local utility u=0.000563 metrics={'f1_val': 0.9918008107316822, 'auprc': 0.9988116435055396, 'loss_val': 0.04271500785551707, 'psi': 0.9946051438412252}-{'f1_val': 0.9944057881617658, 'auprc': 0.9990047523958666, 'loss_val': 0.06004957593002414, 'psi': 0.9962453738554061}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=41 head_norm_before_train=1.817798 cos_to_last_merge=0.9472 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.947
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.8338733376462005, 'auprc': 0.9897134091164357, 'loss_val': 0.24600487446157132, 'psi': 0.8962093662342945}-{'f1_val': 0.9962461149658858, 'auprc': 0.9988771481010288, 'loss_val': 0.021446063043621136, 'psi': 0.997298528219943}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.714604 cos_to_last_merge=0.9227 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.923
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9947614146809564, 'loss_val': 0.031644612035990456, 'psi': 0.9953519023194288}-{'f1_val': 0.9957455607450773, 'auprc': 0.9953980173975876, 'loss_val': 0.03198161387603239, 'psi': 0.9956065434060813}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.957350 cos_to_last_merge=0.8276 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.828
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9931243966782941, 'auprc': 0.9988937204913964, 'loss_val': 0.0270973083248151, 'psi': 0.995432126203535}-{'f1_val': 0.9965509216617638, 'auprc': 0.9978518836029027, 'loss_val': 0.020632943917781303, 'psi': 0.9970713064382194}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.445384 cos_to_last_merge=0.9497 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.950
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6028651525058546, 'auprc': 0.7196455047375734, 'loss_val': 0.9578454839658248, 'psi': 0.6495772933985421}-{'f1_val': 0.627742069239241, 'auprc': 0.7324151689653963, 'loss_val': 0.9385445862350453, 'psi': 0.6696113091297031}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.772917 cos_to_last_merge=0.9484 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.948
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9477161062804406, 'auprc': 0.9975293856725882, 'loss_val': 0.07011415030250993, 'psi': 0.9676414180372996}-{'f1_val': 0.9974082695017256, 'auprc': 0.9988508902611399, 'loss_val': 0.02597261750143446, 'psi': 0.9979853178054914}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.511218 cos_to_last_merge=0.9441 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.8758096980207036, 'auprc': 0.9716479210041166, 'loss_val': 0.2559570639277828, 'psi': 0.9141449872140688}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976325736970922, 'loss_val': 0.03558523656910256, 'psi': 0.9971010305113492}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.732981 cos_to_last_merge=0.9489 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.949
[S16] round=41 local utility u=0.346503 metrics={'f1_val': 0.9413200511045076, 'auprc': 0.9921695256124057, 'loss_val': 0.1861776157590069, 'psi': 0.9616598409076669}-{'f1_val': 0.8852944726149736, 'auprc': 0.9923667589623524, 'loss_val': 0.5436222691136608, 'psi': 0.9281233871539252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=41 head_norm_before_train=1.387255 cos_to_last_merge=0.9723 (last merge round=20)
[S17] round=41 local utility u=0.073924 metrics={'f1_val': 0.681557904153259, 'auprc': 0.8575467898634566, 'loss_val': 0.8669666490838115, 'psi': 0.751953458437338}-{'f1_val': 0.6850304362536795, 'auprc': 0.8404813619417184, 'loss_val': 0.9844527292878636, 'psi': 0.7472108065288952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=42 head_norm_before_train=1.815508 cos_to_last_merge=0.9711 (last merge round=17)
[S2] round=42 local utility u=0.012000 metrics={'f1_val': 0.7199224614848726, 'auprc': 0.7386940210900955, 'loss_val': 0.9177697570155099, 'psi': 0.7274310853269618}-{'f1_val': 0.7211870572973387, 'auprc': 0.7484957978623358, 'loss_val': 0.9787633790408341, 'psi': 0.7321105535233374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=42 head_norm_before_train=1.812013 cos_to_last_merge=0.9513 (last merge round=17)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.8814410568410593, 'auprc': 0.9955664279399168, 'loss_val': 0.2960792501380035, 'psi': 0.9270912052806023}-{'f1_val': 0.9579254148315203, 'auprc': 0.9971392255259193, 'loss_val': 0.09170771493995149, 'psi': 0.9736109391092799}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.432299 cos_to_last_merge=0.9628 (last merge round=21)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9594553413644532, 'auprc': 0.9566931920395565, 'loss_val': 0.14813363586081188, 'psi': 0.9583504816344945}-{'f1_val': 0.9660093203196771, 'auprc': 0.959291394322893, 'loss_val': 0.14122826149833898, 'psi': 0.9633221499209635}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.652351 cos_to_last_merge=0.8415 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.841
[S5] round=42 local utility u=0.014106 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9932603528121253, 'loss_val': 0.042325178358987144, 'psi': 0.9948412412615807}-{'f1_val': 0.995895166894551, 'auprc': 0.9915610503293384, 'loss_val': 0.06543829908486061, 'psi': 0.9941615202684659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=42 head_norm_before_train=1.740249 cos_to_last_merge=0.9381 (last merge round=12)
[S6] ⚠️ Model drifted since last merge! cos=0.938
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7844350712092294, 'auprc': 0.9411278784814638, 'loss_val': 0.5648320796890494, 'psi': 0.8471121941181232}-{'f1_val': 0.8073067661152857, 'auprc': 0.9472244440813915, 'loss_val': 0.43819819095442003, 'psi': 0.863273837301728}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.513858 cos_to_last_merge=0.9781 (last merge round=21)
[S7] round=42 local utility u=0.109719 metrics={'f1_val': 0.6694052464582736, 'auprc': 0.8024633122032049, 'loss_val': 0.48158114442033334, 'psi': 0.7226284727562461}-{'f1_val': 0.6428033689973146, 'auprc': 0.8007994436244402, 'loss_val': 0.5364159467800625, 'psi': 0.7060017988481648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=42 head_norm_before_train=1.701761 cos_to_last_merge=0.9797 (last merge round=21)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9984659253950758, 'loss_val': 0.04310975835927794, 'psi': 0.9944729508557362}-{'f1_val': 0.9918008107316822, 'auprc': 0.9988116435055396, 'loss_val': 0.04271500785551707, 'psi': 0.9946051438412252}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.824892 cos_to_last_merge=0.9459 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.946
[S9] round=42 local utility u=0.607058 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9942294162228316, 'loss_val': 0.0221605086154881, 'psi': 0.9956880735774675}-{'f1_val': 0.8338733376462005, 'auprc': 0.9897134091164357, 'loss_val': 0.24600487446157132, 'psi': 0.8962093662342945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=42 head_norm_before_train=1.724027 cos_to_last_merge=0.9213 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.921
[S10] round=42 local utility u=0.000241 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9947261489056831, 'loss_val': 0.031057449645310826, 'psi': 0.9953377960093195}-{'f1_val': 0.9957455607450773, 'auprc': 0.9947614146809564, 'loss_val': 0.031644612035990456, 'psi': 0.9953519023194288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=42 head_norm_before_train=1.968284 cos_to_last_merge=0.8272 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.827
[S11] round=42 local utility u=0.015826 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9987384724306553, 'loss_val': 0.0180179774997904, 'psi': 0.9976739429480084}-{'f1_val': 0.9931243966782941, 'auprc': 0.9988937204913964, 'loss_val': 0.0270973083248151, 'psi': 0.995432126203535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=42 head_norm_before_train=1.453145 cos_to_last_merge=0.9487 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.949
[S13] round=42 local utility u=0.412375 metrics={'f1_val': 0.6941772177246912, 'auprc': 0.756616127890654, 'loss_val': 0.7918806414577872, 'psi': 0.7191527817910763}-{'f1_val': 0.6028651525058546, 'auprc': 0.7196455047375734, 'loss_val': 0.9578454839658248, 'psi': 0.6495772933985421}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=42 head_norm_before_train=1.781345 cos_to_last_merge=0.9477 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.948
[S14] round=42 local utility u=0.176090 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9988563515306226, 'loss_val': 0.02152480163275474, 'psi': 0.9981332114421612}-{'f1_val': 0.9477161062804406, 'auprc': 0.9975293856725882, 'loss_val': 0.07011415030250993, 'psi': 0.9676414180372996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=42 head_norm_before_train=1.528212 cos_to_last_merge=0.9422 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=42 local utility u=0.384365 metrics={'f1_val': 0.9609044917527205, 'auprc': 0.996301652065961, 'loss_val': 0.07175701485446383, 'psi': 0.9750633558780166}-{'f1_val': 0.8758096980207036, 'auprc': 0.9716479210041166, 'loss_val': 0.2559570639277828, 'psi': 0.9141449872140688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=42 head_norm_before_train=1.742446 cos_to_last_merge=0.9480 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=42 local utility u=0.213347 metrics={'f1_val': 0.9906794394630849, 'auprc': 0.992882696583028, 'loss_val': 0.0577796289690319, 'psi': 0.9915607423110622}-{'f1_val': 0.9413200511045076, 'auprc': 0.9921695256124057, 'loss_val': 0.1861776157590069, 'psi': 0.9616598409076669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] sending update (kind=head size=1790 to 1 peers)
[S17] START round=42 head_norm_before_train=1.399321 cos_to_last_merge=0.9702 (last merge round=20)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.3803936341388927, 'auprc': 0.49767234732618626, 'loss_val': 1.6022471303679664, 'psi': 0.4273051194138101}-{'f1_val': 0.681557904153259, 'auprc': 0.8575467898634566, 'loss_val': 0.8669666490838115, 'psi': 0.751953458437338}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.828117 cos_to_last_merge=0.9697 (last merge round=17)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7204864832926811, 'auprc': 0.7516251884414908, 'loss_val': 0.9692182233684025, 'psi': 0.732941965352205}-{'f1_val': 0.7199224614848726, 'auprc': 0.7386940210900955, 'loss_val': 0.9177697570155099, 'psi': 0.7274310853269618}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.823926 cos_to_last_merge=0.9496 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.950
[S3] round=43 local utility u=0.345068 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.998807169244242, 'loss_val': 0.09371048923032232, 'psi': 0.9761920220383882}-{'f1_val': 0.8814410568410593, 'auprc': 0.9955664279399168, 'loss_val': 0.2960792501380035, 'psi': 0.9270912052806023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=43 head_norm_before_train=1.436735 cos_to_last_merge=0.9615 (last merge round=21)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9502270744849919, 'auprc': 0.9621641793901456, 'loss_val': 0.20157574239272882, 'psi': 0.9550019164470533}-{'f1_val': 0.9594553413644532, 'auprc': 0.9566931920395565, 'loss_val': 0.14813363586081188, 'psi': 0.9583504816344945}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.665784 cos_to_last_merge=0.8403 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9916039416930218, 'loss_val': 0.04238802594519628, 'psi': 0.9941786768139393}-{'f1_val': 0.995895166894551, 'auprc': 0.9932603528121253, 'loss_val': 0.042325178358987144, 'psi': 0.9948412412615807}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.748301 cos_to_last_merge=0.9368 (last merge round=12)
[S6] ⚠️ Model drifted since last merge! cos=0.937
[S6] round=43 local utility u=0.305129 metrics={'f1_val': 0.8262281434477688, 'auprc': 0.9638685063749804, 'loss_val': 0.27355355952360116, 'psi': 0.8812842886186535}-{'f1_val': 0.7844350712092294, 'auprc': 0.9411278784814638, 'loss_val': 0.5648320796890494, 'psi': 0.8471121941181232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=43 head_norm_before_train=1.519929 cos_to_last_merge=0.9772 (last merge round=21)
[S7] round=43 local utility u=0.236953 metrics={'f1_val': 0.6977962832710036, 'auprc': 0.8555458736665088, 'loss_val': 0.3372684401985614, 'psi': 0.7608961194292057}-{'f1_val': 0.6694052464582736, 'auprc': 0.8024633122032049, 'loss_val': 0.48158114442033334, 'psi': 0.7226284727562461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=43 head_norm_before_train=1.711993 cos_to_last_merge=0.9790 (last merge round=21)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9849103120104981, 'auprc': 0.9991572265693425, 'loss_val': 0.08828977633718696, 'psi': 0.9906090778340357}-{'f1_val': 0.9918109678295097, 'auprc': 0.9984659253950758, 'loss_val': 0.04310975835927794, 'psi': 0.9944729508557362}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.831209 cos_to_last_merge=0.9448 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.945
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.991646066029652, 'loss_val': 0.02319859196115704, 'psi': 0.9944084832794273}-{'f1_val': 0.9966605118138915, 'auprc': 0.9942294162228316, 'loss_val': 0.0221605086154881, 'psi': 0.9956880735774675}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.733919 cos_to_last_merge=0.9200 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.920
[S10] round=43 local utility u=0.002121 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9958274163293029, 'loss_val': 0.030119250813758908, 'psi': 0.9957783029787675}-{'f1_val': 0.9957455607450773, 'auprc': 0.9947261489056831, 'loss_val': 0.031057449645310826, 'psi': 0.9953377960093195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=43 head_norm_before_train=1.978970 cos_to_last_merge=0.8269 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.827
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9945607349735557, 'auprc': 0.9991035765459219, 'loss_val': 0.023877078151126774, 'psi': 0.9963778716025021}-{'f1_val': 0.9969642566262439, 'auprc': 0.9987384724306553, 'loss_val': 0.0180179774997904, 'psi': 0.9976739429480084}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.459793 cos_to_last_merge=0.9479 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.948
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6569536321465684, 'auprc': 0.7569133463175273, 'loss_val': 0.9119045604879611, 'psi': 0.696937517814952}-{'f1_val': 0.6941772177246912, 'auprc': 0.756616127890654, 'loss_val': 0.7918806414577872, 'psi': 0.7191527817910763}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.791224 cos_to_last_merge=0.9468 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.947
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9988518507036451, 'loss_val': 0.022617811319828464, 'psi': 0.9981199242553838}-{'f1_val': 0.9976511180498535, 'auprc': 0.9988563515306226, 'loss_val': 0.02152480163275474, 'psi': 0.9981332114421612}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.543745 cos_to_last_merge=0.9405 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.940
[S15] round=43 local utility u=0.124222 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9941354323105559, 'loss_val': 0.03186781673376302, 'psi': 0.9957021739567347}-{'f1_val': 0.9609044917527205, 'auprc': 0.996301652065961, 'loss_val': 0.07175701485446383, 'psi': 0.9750633558780166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=43 head_norm_before_train=1.751648 cos_to_last_merge=0.9472 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.947
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.8950750498569578, 'auprc': 0.9859526984938234, 'loss_val': 0.5068248801251927, 'psi': 0.931426109311704}-{'f1_val': 0.9906794394630849, 'auprc': 0.992882696583028, 'loss_val': 0.0577796289690319, 'psi': 0.9915607423110622}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.412635 cos_to_last_merge=0.9678 (last merge round=20)
[S17] round=43 local utility u=0.791393 metrics={'f1_val': 0.508318923654489, 'auprc': 0.8009276726109371, 'loss_val': 1.6967785590610565, 'psi': 0.6253624232370683}-{'f1_val': 0.3803936341388927, 'auprc': 0.49767234732618626, 'loss_val': 1.6022471303679664, 'psi': 0.4273051194138101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=44 head_norm_before_train=1.840029 cos_to_last_merge=0.9686 (last merge round=17)
[S2] round=44 local utility u=0.006224 metrics={'f1_val': 0.709226319067721, 'auprc': 0.7464540501927316, 'loss_val': 0.8736951131031767, 'psi': 0.7241174115177254}-{'f1_val': 0.7204864832926811, 'auprc': 0.7516251884414908, 'loss_val': 0.9692182233684025, 'psi': 0.732941965352205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=44 head_norm_before_train=1.834729 cos_to_last_merge=0.9484 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.948
[S3] round=44 local utility u=0.128616 metrics={'f1_val': 0.99419719460899, 'auprc': 0.998313240194258, 'loss_val': 0.03348867409338212, 'psi': 0.9958436128430972}-{'f1_val': 0.9611152572344858, 'auprc': 0.998807169244242, 'loss_val': 0.09371048923032232, 'psi': 0.9761920220383882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=44 head_norm_before_train=1.444497 cos_to_last_merge=0.9603 (last merge round=21)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.938982295501574, 'auprc': 0.9481366493997314, 'loss_val': 0.22320779607738891, 'psi': 0.942644037060837}-{'f1_val': 0.9502270744849919, 'auprc': 0.9621641793901456, 'loss_val': 0.20157574239272882, 'psi': 0.9550019164470533}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.679899 cos_to_last_merge=0.8391 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.839
[S5] round=44 local utility u=0.002483 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9916047872016798, 'loss_val': 0.037423798185185236, 'psi': 0.9941790150174025}-{'f1_val': 0.995895166894551, 'auprc': 0.9916039416930218, 'loss_val': 0.04238802594519628, 'psi': 0.9941786768139393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=44 head_norm_before_train=1.756354 cos_to_last_merge=0.9356 (last merge round=12)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6203029357699694, 'auprc': 0.7619299539276208, 'loss_val': 0.9738057577286852, 'psi': 0.6769537430330299}-{'f1_val': 0.8262281434477688, 'auprc': 0.9638685063749804, 'loss_val': 0.27355355952360116, 'psi': 0.8812842886186535}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.526682 cos_to_last_merge=0.9761 (last merge round=21)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.6103090777827782, 'auprc': 0.7976088226020605, 'loss_val': 0.5908492016924195, 'psi': 0.6852289757104911}-{'f1_val': 0.6977962832710036, 'auprc': 0.8555458736665088, 'loss_val': 0.3372684401985614, 'psi': 0.7608961194292057}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.720688 cos_to_last_merge=0.9782 (last merge round=21)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.7009248641206862, 'auprc': 0.9007343243560264, 'loss_val': 0.5378865099971402, 'psi': 0.7808486482148222}-{'f1_val': 0.9849103120104981, 'auprc': 0.9991572265693425, 'loss_val': 0.08828977633718696, 'psi': 0.9906090778340357}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.839262 cos_to_last_merge=0.9440 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.944
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.8964921461097443, 'auprc': 0.9992157262349205, 'loss_val': 0.18058067912725323, 'psi': 0.9375815781598147}-{'f1_val': 0.9962500947792776, 'auprc': 0.991646066029652, 'loss_val': 0.02319859196115704, 'psi': 0.9944084832794273}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.745098 cos_to_last_merge=0.9188 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.919
[S10] round=44 local utility u=0.000612 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9958783683891983, 'loss_val': 0.0290484292898866, 'psi': 0.9957986838027256}-{'f1_val': 0.9957455607450773, 'auprc': 0.9958274163293029, 'loss_val': 0.030119250813758908, 'psi': 0.9957783029787675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=44 head_norm_before_train=1.987021 cos_to_last_merge=0.8266 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.827
[S11] round=44 local utility u=0.007784 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9986329544959403, 'loss_val': 0.018837485293267692, 'psi': 0.9973837347954344}-{'f1_val': 0.9945607349735557, 'auprc': 0.9991035765459219, 'loss_val': 0.023877078151126774, 'psi': 0.9963778716025021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=44 head_norm_before_train=1.467864 cos_to_last_merge=0.9470 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.947
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6372266194188851, 'auprc': 0.7600979407709, 'loss_val': 0.8892991616791404, 'psi': 0.6863751479596911}-{'f1_val': 0.6569536321465684, 'auprc': 0.7569133463175273, 'loss_val': 0.9119045604879611, 'psi': 0.696937517814952}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.800527 cos_to_last_merge=0.9460 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.946
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9972216920155168, 'auprc': 0.9988514750731545, 'loss_val': 0.023096697261194187, 'psi': 0.9978736052385719}-{'f1_val': 0.9976319732898762, 'auprc': 0.9988518507036451, 'loss_val': 0.022617811319828464, 'psi': 0.9981199242553838}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.556988 cos_to_last_merge=0.9391 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.939
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7663855753262233, 'auprc': 0.9743811454962624, 'loss_val': 0.3592300522304536, 'psi': 0.849583803394239}-{'f1_val': 0.9967466683875206, 'auprc': 0.9941354323105559, 'loss_val': 0.03186781673376302, 'psi': 0.9957021739567347}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.759521 cos_to_last_merge=0.9463 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.946
[S16] round=44 local utility u=0.328267 metrics={'f1_val': 0.9431545792773739, 'auprc': 0.991872512322786, 'loss_val': 0.15652783863192546, 'psi': 0.9626417524955386}-{'f1_val': 0.8950750498569578, 'auprc': 0.9859526984938234, 'loss_val': 0.5068248801251927, 'psi': 0.931426109311704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=44 head_norm_before_train=1.419237 cos_to_last_merge=0.9666 (last merge round=20)
[S17] round=44 local utility u=0.409078 metrics={'f1_val': 0.5832968619878689, 'auprc': 0.8073151106590546, 'loss_val': 1.3476516973328123, 'psi': 0.6729041614563431}-{'f1_val': 0.508318923654489, 'auprc': 0.8009276726109371, 'loss_val': 1.6967785590610565, 'psi': 0.6253624232370683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=45 head_norm_before_train=1.848738 cos_to_last_merge=0.9678 (last merge round=17)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.7206758095329626, 'auprc': 0.7419113049567929, 'loss_val': 0.9730073261544627, 'psi': 0.7291700077024947}-{'f1_val': 0.709226319067721, 'auprc': 0.7464540501927316, 'loss_val': 0.8736951131031767, 'psi': 0.7241174115177254}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.847041 cos_to_last_merge=0.9470 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.947
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9318334398819119, 'auprc': 0.9984825535577762, 'loss_val': 0.16866392202863006, 'psi': 0.9584930853522576}-{'f1_val': 0.99419719460899, 'auprc': 0.998313240194258, 'loss_val': 0.03348867409338212, 'psi': 0.9958436128430972}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.456200 cos_to_last_merge=0.9593 (last merge round=21)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9413667598148422, 'auprc': 0.9530002286210524, 'loss_val': 0.2779063414907717, 'psi': 0.9460201473373262}-{'f1_val': 0.938982295501574, 'auprc': 0.9481366493997314, 'loss_val': 0.22320779607738891, 'psi': 0.942644037060837}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.698504 cos_to_last_merge=0.8374 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.837
[S5] round=45 local utility u=0.005055 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9934826684274397, 'loss_val': 0.03294804264140214, 'psi': 0.9949301675077065}-{'f1_val': 0.995895166894551, 'auprc': 0.9916047872016798, 'loss_val': 0.037423798185185236, 'psi': 0.9941790150174025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=45 head_norm_before_train=1.761228 cos_to_last_merge=0.9343 (last merge round=12)
[S6] ⚠️ Model drifted since last merge! cos=0.934
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.8200566156883654, 'auprc': 0.9438585867090707, 'loss_val': 0.39838541426142327, 'psi': 0.8695774040966475}-{'f1_val': 0.6203029357699694, 'auprc': 0.7619299539276208, 'loss_val': 0.9738057577286852, 'psi': 0.6769537430330299}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=45 head_norm_before_train=1.532835 cos_to_last_merge=0.9751 (last merge round=21)
[S7] round=45 local utility u=0.149502 metrics={'f1_val': 0.6441287971174245, 'auprc': 0.8062416365755788, 'loss_val': 0.520661464578286, 'psi': 0.7089739329006862}-{'f1_val': 0.6103090777827782, 'auprc': 0.7976088226020605, 'loss_val': 0.5908492016924195, 'psi': 0.6852289757104911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=45 head_norm_before_train=1.726328 cos_to_last_merge=0.9776 (last merge round=21)
[S8] round=45 local utility u=1.000000 metrics={'f1_val': 0.9920222688347867, 'auprc': 0.9987219275748127, 'loss_val': 0.04005032030823286, 'psi': 0.9947021323307971}-{'f1_val': 0.7009248641206862, 'auprc': 0.9007343243560264, 'loss_val': 0.5378865099971402, 'psi': 0.7808486482148222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=45 head_norm_before_train=1.844878 cos_to_last_merge=0.9442 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.944
[S9] round=45 local utility u=0.376017 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9988590234104131, 'loss_val': 0.023483288250325085, 'psi': 0.9970396403826765}-{'f1_val': 0.8964921461097443, 'auprc': 0.9992157262349205, 'loss_val': 0.18058067912725323, 'psi': 0.9375815781598147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=45 head_norm_before_train=1.756715 cos_to_last_merge=0.9178 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.918
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9958550621065696, 'loss_val': 0.029065455339535876, 'psi': 0.9957893612896742}-{'f1_val': 0.9957455607450773, 'auprc': 0.9958783683891983, 'loss_val': 0.0290484292898866, 'psi': 0.9957986838027256}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.994620 cos_to_last_merge=0.8262 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.826
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9982908137800406, 'loss_val': 0.019181504090198923, 'psi': 0.9972468785090746}-{'f1_val': 0.9965509216617638, 'auprc': 0.9986329544959403, 'loss_val': 0.018837485293267692, 'psi': 0.9973837347954344}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.473375 cos_to_last_merge=0.9460 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.946
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6209609234836235, 'auprc': 0.7661066210212926, 'loss_val': 0.8977426571381385, 'psi': 0.6790192024986912}-{'f1_val': 0.6372266194188851, 'auprc': 0.7600979407709, 'loss_val': 0.8892991616791404, 'psi': 0.6863751479596911}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.808025 cos_to_last_merge=0.9452 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=45 local utility u=0.001439 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9988516450459779, 'loss_val': 0.022681137944903697, 'psi': 0.998119841992317}-{'f1_val': 0.9972216920155168, 'auprc': 0.9988514750731545, 'loss_val': 0.023096697261194187, 'psi': 0.9978736052385719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] sending update (kind=head size=1807 to 1 peers)
[S15] START round=45 head_norm_before_train=1.570280 cos_to_last_merge=0.9377 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.938
[S15] round=45 local utility u=0.519536 metrics={'f1_val': 0.9003876200435856, 'auprc': 0.9917229994928078, 'loss_val': 0.17619665221795539, 'psi': 0.9369217718232745}-{'f1_val': 0.7663855753262233, 'auprc': 0.9743811454962624, 'loss_val': 0.3592300522304536, 'psi': 0.849583803394239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=45 head_norm_before_train=1.768723 cos_to_last_merge=0.9454 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.945
[S16] round=45 local utility u=0.205013 metrics={'f1_val': 0.9921917777340556, 'auprc': 0.9939141840196413, 'loss_val': 0.04684933619292787, 'psi': 0.9928807402482899}-{'f1_val': 0.9431545792773739, 'auprc': 0.991872512322786, 'loss_val': 0.15652783863192546, 'psi': 0.9626417524955386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=45 head_norm_before_train=1.427935 cos_to_last_merge=0.9652 (last merge round=20)
[S17] round=45 local utility u=0.158836 metrics={'f1_val': 0.6610380314496197, 'auprc': 0.7007870001320194, 'loss_val': 1.176841755203245, 'psi': 0.6769376189225795}-{'f1_val': 0.5832968619878689, 'auprc': 0.8073151106590546, 'loss_val': 1.3476516973328123, 'psi': 0.6729041614563431}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=46 head_norm_before_train=1.857076 cos_to_last_merge=0.9670 (last merge round=17)
[S2] round=46 local utility u=0.007785 metrics={'f1_val': 0.7164880983762107, 'auprc': 0.7395025552708767, 'loss_val': 0.9250848275161995, 'psi': 0.7256938811340772}-{'f1_val': 0.7206758095329626, 'auprc': 0.7419113049567929, 'loss_val': 0.9730073261544627, 'psi': 0.7291700077024947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=46 head_norm_before_train=1.852028 cos_to_last_merge=0.9455 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.946
[S3] round=46 local utility u=0.259962 metrics={'f1_val': 0.9962569026383599, 'auprc': 0.9988542422354826, 'loss_val': 0.036395854857041485, 'psi': 0.9972958384772089}-{'f1_val': 0.9318334398819119, 'auprc': 0.9984825535577762, 'loss_val': 0.16866392202863006, 'psi': 0.9584930853522576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=46 head_norm_before_train=1.469378 cos_to_last_merge=0.9582 (last merge round=21)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9404425635567016, 'auprc': 0.9546900292515905, 'loss_val': 0.2944679010244585, 'psi': 0.9461415498346571}-{'f1_val': 0.9413667598148422, 'auprc': 0.9530002286210524, 'loss_val': 0.2779063414907717, 'psi': 0.9460201473373262}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.719034 cos_to_last_merge=0.8355 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.835
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.990666621695002, 'loss_val': 0.05549477440007167, 'psi': 0.9938037488147313}-{'f1_val': 0.995895166894551, 'auprc': 0.9934826684274397, 'loss_val': 0.03294804264140214, 'psi': 0.9949301675077065}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.769389 cos_to_last_merge=0.9332 (last merge round=12)
[S6] ⚠️ Model drifted since last merge! cos=0.933
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7067887882246069, 'auprc': 0.7745454848802398, 'loss_val': 0.8433189088690535, 'psi': 0.73389146688686}-{'f1_val': 0.8200566156883654, 'auprc': 0.9438585867090707, 'loss_val': 0.39838541426142327, 'psi': 0.8695774040966475}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.540043 cos_to_last_merge=0.9740 (last merge round=21)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.6204714124765345, 'auprc': 0.8012162582011895, 'loss_val': 0.5853516411142992, 'psi': 0.6927693507663965}-{'f1_val': 0.6441287971174245, 'auprc': 0.8062416365755788, 'loss_val': 0.520661464578286, 'psi': 0.7089739329006862}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.731011 cos_to_last_merge=0.9772 (last merge round=21)
[S8] round=46 local utility u=0.007953 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9989686674414284, 'loss_val': 0.0367029701804278, 'psi': 0.9959826087296795}-{'f1_val': 0.9920222688347867, 'auprc': 0.9987219275748127, 'loss_val': 0.04005032030823286, 'psi': 0.9947021323307971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=46 head_norm_before_train=1.850525 cos_to_last_merge=0.9442 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.944
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9944678570457485, 'loss_val': 0.022796797161526834, 'psi': 0.995537199685866}-{'f1_val': 0.9958267183641853, 'auprc': 0.9988590234104131, 'loss_val': 0.023483288250325085, 'psi': 0.9970396403826765}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.768404 cos_to_last_merge=0.9169 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9947940079241195, 'loss_val': 0.0290617440946219, 'psi': 0.9953649396166941}-{'f1_val': 0.9957455607450773, 'auprc': 0.9958550621065696, 'loss_val': 0.029065455339535876, 'psi': 0.9957893612896742}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=2.002901 cos_to_last_merge=0.8259 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.826
[S11] round=46 local utility u=0.001051 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9986422527290657, 'loss_val': 0.018133937820377623, 'psi': 0.9973874540886847}-{'f1_val': 0.9965509216617638, 'auprc': 0.9982908137800406, 'loss_val': 0.019181504090198923, 'psi': 0.9972468785090746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=46 head_norm_before_train=1.479225 cos_to_last_merge=0.9450 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.945
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6360035414362051, 'auprc': 0.6689345097552417, 'loss_val': 0.8884227484961085, 'psi': 0.6491759287638197}-{'f1_val': 0.6209609234836235, 'auprc': 0.7661066210212926, 'loss_val': 0.8977426571381385, 'psi': 0.6790192024986912}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.814664 cos_to_last_merge=0.9443 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.944
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9988518194606945, 'loss_val': 0.02284453414942483, 'psi': 0.9977260278345437}-{'f1_val': 0.9976319732898762, 'auprc': 0.9988516450459779, 'loss_val': 0.022681137944903697, 'psi': 0.998119841992317}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.582296 cos_to_last_merge=0.9365 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.937
[S15] round=46 local utility u=0.370257 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9968513186747275, 'loss_val': 0.029222425299429255, 'psi': 0.9967885285024034}-{'f1_val': 0.9003876200435856, 'auprc': 0.9917229994928078, 'loss_val': 0.17619665221795539, 'psi': 0.9369217718232745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=46 head_norm_before_train=1.778509 cos_to_last_merge=0.9444 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.944
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9248746090577395, 'auprc': 0.9890422834999228, 'loss_val': 0.39083462569041816, 'psi': 0.9505416788346129}-{'f1_val': 0.9921917777340556, 'auprc': 0.9939141840196413, 'loss_val': 0.04684933619292787, 'psi': 0.9928807402482899}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.436151 cos_to_last_merge=0.9639 (last merge round=20)
[S17] round=46 local utility u=0.877239 metrics={'f1_val': 0.7896880681057935, 'auprc': 0.8685893084011811, 'loss_val': 0.6976699087668324, 'psi': 0.8212485642239485}-{'f1_val': 0.6610380314496197, 'auprc': 0.7007870001320194, 'loss_val': 1.176841755203245, 'psi': 0.6769376189225795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=47 head_norm_before_train=1.867288 cos_to_last_merge=0.9661 (last merge round=17)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7203528407231348, 'auprc': 0.740363975059155, 'loss_val': 0.9706258842887948, 'psi': 0.7283572944575428}-{'f1_val': 0.7164880983762107, 'auprc': 0.7395025552708767, 'loss_val': 0.9250848275161995, 'psi': 0.7256938811340772}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.857835 cos_to_last_merge=0.9443 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.944
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9493045943254277, 'auprc': 0.997114480599521, 'loss_val': 0.11187288591639376, 'psi': 0.968428548835065}-{'f1_val': 0.9962569026383599, 'auprc': 0.9988542422354826, 'loss_val': 0.036395854857041485, 'psi': 0.9972958384772089}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.478940 cos_to_last_merge=0.9578 (last merge round=21)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9380645573163993, 'auprc': 0.9414257804028012, 'loss_val': 0.2746881987666081, 'psi': 0.9394090465509601}-{'f1_val': 0.9404425635567016, 'auprc': 0.9546900292515905, 'loss_val': 0.2944679010244585, 'psi': 0.9461415498346571}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.734990 cos_to_last_merge=0.8340 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.834
[S5] round=47 local utility u=0.012783 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9916031155599627, 'loss_val': 0.03273911563948695, 'psi': 0.9941783463607157}-{'f1_val': 0.995895166894551, 'auprc': 0.990666621695002, 'loss_val': 0.05549477440007167, 'psi': 0.9938037488147313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=47 head_norm_before_train=1.777855 cos_to_last_merge=0.9318 (last merge round=12)
[S6] ⚠️ Model drifted since last merge! cos=0.932
[S6] round=47 local utility u=1.000000 metrics={'f1_val': 0.8490402538340208, 'auprc': 0.9751388547392983, 'loss_val': 0.2187539574139992, 'psi': 0.8994796941961318}-{'f1_val': 0.7067887882246069, 'auprc': 0.7745454848802398, 'loss_val': 0.8433189088690535, 'psi': 0.73389146688686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=47 head_norm_before_train=1.545588 cos_to_last_merge=0.9732 (last merge round=21)
[S7] round=47 local utility u=0.101379 metrics={'f1_val': 0.6425236991654619, 'auprc': 0.8060602696416778, 'loss_val': 0.5294387908091973, 'psi': 0.7079383273559483}-{'f1_val': 0.6204714124765345, 'auprc': 0.8012162582011895, 'loss_val': 0.5853516411142992, 'psi': 0.6927693507663965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=47 head_norm_before_train=1.734478 cos_to_last_merge=0.9770 (last merge round=21)
[S8] round=47 local utility u=0.001563 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9989770946753327, 'loss_val': 0.035805632789292045, 'psi': 0.996206254229449}-{'f1_val': 0.9939919029218467, 'auprc': 0.9989686674414284, 'loss_val': 0.0367029701804278, 'psi': 0.9959826087296795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=47 head_norm_before_train=1.858806 cos_to_last_merge=0.9438 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.944
[S9] round=47 local utility u=0.008397 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984817258733889, 'loss_val': 0.02050695677689377, 'psi': 0.9973889974376904}-{'f1_val': 0.9962500947792776, 'auprc': 0.9944678570457485, 'loss_val': 0.022796797161526834, 'psi': 0.995537199685866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=47 head_norm_before_train=1.779871 cos_to_last_merge=0.9160 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.916
[S10] round=47 local utility u=0.000216 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9948306462212608, 'loss_val': 0.028738997172079266, 'psi': 0.9953795949355506}-{'f1_val': 0.9957455607450773, 'auprc': 0.9947940079241195, 'loss_val': 0.0290617440946219, 'psi': 0.9953649396166941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=47 head_norm_before_train=2.011531 cos_to_last_merge=0.8256 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.826
[S11] round=47 local utility u=0.002145 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9989016225740921, 'loss_val': 0.017102038230354326, 'psi': 0.9977392030053831}-{'f1_val': 0.9965509216617638, 'auprc': 0.9986422527290657, 'loss_val': 0.018133937820377623, 'psi': 0.9973874540886847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=47 head_norm_before_train=1.486032 cos_to_last_merge=0.9439 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.944
[S13] round=47 local utility u=0.264637 metrics={'f1_val': 0.6547799336166404, 'auprc': 0.7702674965513892, 'loss_val': 0.7758060644489115, 'psi': 0.70097495879054}-{'f1_val': 0.6360035414362051, 'auprc': 0.6689345097552417, 'loss_val': 0.8884227484961085, 'psi': 0.6491759287638197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=47 head_norm_before_train=1.820672 cos_to_last_merge=0.9437 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.944
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9830177320841569, 'auprc': 0.9983894974542062, 'loss_val': 0.048067256151275495, 'psi': 0.9891664382321766}-{'f1_val': 0.9969755000837764, 'auprc': 0.9988518194606945, 'loss_val': 0.02284453414942483, 'psi': 0.9977260278345437}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.591740 cos_to_last_merge=0.9356 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.936
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.903170176196454, 'auprc': 0.9964715077117765, 'loss_val': 0.21071416354743144, 'psi': 0.9404907088025829}-{'f1_val': 0.9967466683875206, 'auprc': 0.9968513186747275, 'loss_val': 0.029222425299429255, 'psi': 0.9967885285024034}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.787475 cos_to_last_merge=0.9435 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.944
[S16] round=47 local utility u=0.062670 metrics={'f1_val': 0.9359496240711012, 'auprc': 0.9906870148123079, 'loss_val': 0.33687964717493923, 'psi': 0.9578445803675839}-{'f1_val': 0.9248746090577395, 'auprc': 0.9890422834999228, 'loss_val': 0.39083462569041816, 'psi': 0.9505416788346129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=47 head_norm_before_train=1.445643 cos_to_last_merge=0.9627 (last merge round=20)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6718221678732986, 'auprc': 0.8296941301240005, 'loss_val': 1.158370054105443, 'psi': 0.7349709527735794}-{'f1_val': 0.7896880681057935, 'auprc': 0.8685893084011811, 'loss_val': 0.6976699087668324, 'psi': 0.8212485642239485}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.876590 cos_to_last_merge=0.9655 (last merge round=17)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.707250008548183, 'auprc': 0.7469924827700538, 'loss_val': 0.9176506135941652, 'psi': 0.7231469982369314}-{'f1_val': 0.7203528407231348, 'auprc': 0.740363975059155, 'loss_val': 0.9706258842887948, 'psi': 0.7283572944575428}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.864401 cos_to_last_merge=0.9432 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.943
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.9410040235215229, 'auprc': 0.9988216274983708, 'loss_val': 0.17298265227220794, 'psi': 0.964131065112262}-{'f1_val': 0.9493045943254277, 'auprc': 0.997114480599521, 'loss_val': 0.11187288591639376, 'psi': 0.968428548835065}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.487772 cos_to_last_merge=0.9577 (last merge round=21)
[S4] round=48 local utility u=0.067296 metrics={'f1_val': 0.9421657091060944, 'auprc': 0.981865989296423, 'loss_val': 0.2860236643981639, 'psi': 0.9580458211822258}-{'f1_val': 0.9380645573163993, 'auprc': 0.9414257804028012, 'loss_val': 0.2746881987666081, 'psi': 0.9394090465509601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=48 head_norm_before_train=1.750022 cos_to_last_merge=0.8325 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.833
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9914366116871489, 'loss_val': 0.03238973494070912, 'psi': 0.9941117448115901}-{'f1_val': 0.995895166894551, 'auprc': 0.9916031155599627, 'loss_val': 0.03273911563948695, 'psi': 0.9941783463607157}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.786180 cos_to_last_merge=0.9306 (last merge round=12)
[S6] ⚠️ Model drifted since last merge! cos=0.931
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.8448148166594398, 'auprc': 0.9623259828529601, 'loss_val': 0.42758236407672984, 'psi': 0.8918192831368479}-{'f1_val': 0.8490402538340208, 'auprc': 0.9751388547392983, 'loss_val': 0.2187539574139992, 'psi': 0.8994796941961318}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.549120 cos_to_last_merge=0.9727 (last merge round=21)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6201006115915881, 'auprc': 0.8010697004546836, 'loss_val': 0.5714380456008784, 'psi': 0.6924882471368263}-{'f1_val': 0.6425236991654619, 'auprc': 0.8060602696416778, 'loss_val': 0.5294387908091973, 'psi': 0.7079383273559483}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.740101 cos_to_last_merge=0.9767 (last merge round=21)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9934805280689575, 'auprc': 0.9987001286078386, 'loss_val': 0.04036514506737785, 'psi': 0.9955683682845099}-{'f1_val': 0.9943590272655265, 'auprc': 0.9989770946753327, 'loss_val': 0.035805632789292045, 'psi': 0.996206254229449}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.864461 cos_to_last_merge=0.9446 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.945
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9871446711497952, 'auprc': 0.9988210859934642, 'loss_val': 0.05274230720377923, 'psi': 0.9918152370872628}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984817258733889, 'loss_val': 0.02050695677689377, 'psi': 0.9973889974376904}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.791006 cos_to_last_merge=0.9151 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.915
[S10] round=48 local utility u=0.000089 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9948006728423788, 'loss_val': 0.0284716594724103, 'psi': 0.9953676055839978}-{'f1_val': 0.9957455607450773, 'auprc': 0.9948306462212608, 'loss_val': 0.028738997172079266, 'psi': 0.9953795949355506}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=48 head_norm_before_train=2.019964 cos_to_last_merge=0.8253 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.825
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9860102991376019, 'auprc': 0.9991287389566854, 'loss_val': 0.06265311274559718, 'psi': 0.9912576750652353}-{'f1_val': 0.9969642566262439, 'auprc': 0.9989016225740921, 'loss_val': 0.017102038230354326, 'psi': 0.9977392030053831}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.492948 cos_to_last_merge=0.9428 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.943
[S13] round=48 local utility u=0.064966 metrics={'f1_val': 0.699750168560701, 'auprc': 0.78646642218246, 'loss_val': 0.964291831732365, 'psi': 0.7344366700094047}-{'f1_val': 0.6547799336166404, 'auprc': 0.7702674965513892, 'loss_val': 0.7758060644489115, 'psi': 0.70097495879054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=48 head_norm_before_train=1.828526 cos_to_last_merge=0.9430 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9535323934999523, 'auprc': 0.9971514517737763, 'loss_val': 0.05845457776716055, 'psi': 0.970980016809482}-{'f1_val': 0.9830177320841569, 'auprc': 0.9983894974542062, 'loss_val': 0.048067256151275495, 'psi': 0.9891664382321766}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.601793 cos_to_last_merge=0.9346 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.935
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.8799601501346977, 'auprc': 0.9923071833779381, 'loss_val': 0.21493610876948024, 'psi': 0.9248989634319938}-{'f1_val': 0.903170176196454, 'auprc': 0.9964715077117765, 'loss_val': 0.21071416354743144, 'psi': 0.9404907088025829}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.795005 cos_to_last_merge=0.9427 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.943
[S16] round=48 local utility u=0.288575 metrics={'f1_val': 0.9849945372118851, 'auprc': 0.9943409107733666, 'loss_val': 0.06496042930023513, 'psi': 0.9887330866364777}-{'f1_val': 0.9359496240711012, 'auprc': 0.9906870148123079, 'loss_val': 0.33687964717493923, 'psi': 0.9578445803675839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=48 head_norm_before_train=1.453189 cos_to_last_merge=0.9616 (last merge round=20)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6705793626885528, 'auprc': 0.819867628937072, 'loss_val': 1.1857601528365016, 'psi': 0.7302946691879605}-{'f1_val': 0.6718221678732986, 'auprc': 0.8296941301240005, 'loss_val': 1.158370054105443, 'psi': 0.7349709527735794}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.884378 cos_to_last_merge=0.9650 (last merge round=17)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.6601316050832081, 'auprc': 0.7479967757550277, 'loss_val': 1.181644025545032, 'psi': 0.6952776733519359}-{'f1_val': 0.707250008548183, 'auprc': 0.7469924827700538, 'loss_val': 0.9176506135941652, 'psi': 0.7231469982369314}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.873023 cos_to_last_merge=0.9425 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.943
[S3] round=49 local utility u=0.084639 metrics={'f1_val': 0.9567711928027022, 'auprc': 0.9988121747550724, 'loss_val': 0.0982795305429607, 'psi': 0.9735875855836502}-{'f1_val': 0.9410040235215229, 'auprc': 0.9988216274983708, 'loss_val': 0.17298265227220794, 'psi': 0.964131065112262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=49 head_norm_before_train=1.494928 cos_to_last_merge=0.9572 (last merge round=21)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9408230051991343, 'auprc': 0.9573833489521348, 'loss_val': 0.2852043871610975, 'psi': 0.9474471427003346}-{'f1_val': 0.9421657091060944, 'auprc': 0.981865989296423, 'loss_val': 0.2860236643981639, 'psi': 0.9580458211822258}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.759231 cos_to_last_merge=0.8318 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=49 local utility u=0.003631 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9926880057871053, 'loss_val': 0.02888288991429576, 'psi': 0.9946123024515727}-{'f1_val': 0.995895166894551, 'auprc': 0.9914366116871489, 'loss_val': 0.03238973494070912, 'psi': 0.9941117448115901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=49 head_norm_before_train=1.793823 cos_to_last_merge=0.9294 (last merge round=12)
[S6] ⚠️ Model drifted since last merge! cos=0.929
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6365477846423857, 'auprc': 0.9508705714665504, 'loss_val': 0.5102502853314779, 'psi': 0.7622768993720517}-{'f1_val': 0.8448148166594398, 'auprc': 0.9623259828529601, 'loss_val': 0.42758236407672984, 'psi': 0.8918192831368479}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.552196 cos_to_last_merge=0.9722 (last merge round=21)
[S7] round=49 local utility u=0.192523 metrics={'f1_val': 0.6619668654516194, 'auprc': 0.8093529062731242, 'loss_val': 0.4624390720838072, 'psi': 0.7209212817802213}-{'f1_val': 0.6201006115915881, 'auprc': 0.8010697004546836, 'loss_val': 0.5714380456008784, 'psi': 0.6924882471368263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=49 head_norm_before_train=1.746999 cos_to_last_merge=0.9762 (last merge round=21)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9892831449862951, 'auprc': 0.9985173477156606, 'loss_val': 0.04256699422066437, 'psi': 0.9929768260780413}-{'f1_val': 0.9934805280689575, 'auprc': 0.9987001286078386, 'loss_val': 0.04036514506737785, 'psi': 0.9955683682845099}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.871203 cos_to_last_merge=0.9449 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.945
[S9] round=49 local utility u=0.045208 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988399554376943, 'loss_val': 0.019477314487165266, 'psi': 0.9975322892634126}-{'f1_val': 0.9871446711497952, 'auprc': 0.9988210859934642, 'loss_val': 0.05274230720377923, 'psi': 0.9918152370872628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=49 head_norm_before_train=1.798298 cos_to_last_merge=0.9140 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.914
[S10] round=49 local utility u=0.001156 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9953583242986397, 'loss_val': 0.027831800008581386, 'psi': 0.9955906661665022}-{'f1_val': 0.9957455607450773, 'auprc': 0.9948006728423788, 'loss_val': 0.0284716594724103, 'psi': 0.9953676055839978}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=49 head_norm_before_train=2.027644 cos_to_last_merge=0.8251 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.825
[S11] round=49 local utility u=0.055227 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9987328378924704, 'loss_val': 0.016735247770820933, 'psi': 0.9976716891327344}-{'f1_val': 0.9860102991376019, 'auprc': 0.9991287389566854, 'loss_val': 0.06265311274559718, 'psi': 0.9912576750652353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=49 head_norm_before_train=1.497977 cos_to_last_merge=0.9421 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.942
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6136724579036265, 'auprc': 0.8107159262318278, 'loss_val': 1.120512151416462, 'psi': 0.692489845234907}-{'f1_val': 0.699750168560701, 'auprc': 0.78646642218246, 'loss_val': 0.964291831732365, 'psi': 0.7344366700094047}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.838027 cos_to_last_merge=0.9421 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.942
[S14] round=49 local utility u=0.109252 metrics={'f1_val': 0.986491485312831, 'auprc': 0.9971462130491298, 'loss_val': 0.03769010976046161, 'psi': 0.9907533764073505}-{'f1_val': 0.9535323934999523, 'auprc': 0.9971514517737763, 'loss_val': 0.05845457776716055, 'psi': 0.970980016809482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=49 head_norm_before_train=1.611786 cos_to_last_merge=0.9335 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=49 local utility u=0.082296 metrics={'f1_val': 0.903170176196454, 'auprc': 0.9968286259250829, 'loss_val': 0.20316801235699145, 'psi': 0.9406335560879056}-{'f1_val': 0.8799601501346977, 'auprc': 0.9923071833779381, 'loss_val': 0.21493610876948024, 'psi': 0.9248989634319938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=49 head_norm_before_train=1.803018 cos_to_last_merge=0.9418 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.942
[S16] round=49 local utility u=0.031901 metrics={'f1_val': 0.9919999988114725, 'auprc': 0.9943176174279869, 'loss_val': 0.04312061979488503, 'psi': 0.9929270462580783}-{'f1_val': 0.9849945372118851, 'auprc': 0.9943409107733666, 'loss_val': 0.06496042930023513, 'psi': 0.9887330866364777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=49 head_norm_before_train=1.468257 cos_to_last_merge=0.9594 (last merge round=20)
[S17] round=49 local utility u=0.185815 metrics={'f1_val': 0.6844258651917502, 'auprc': 0.8502412040078897, 'loss_val': 0.9883304694907837, 'psi': 0.750752000718206}-{'f1_val': 0.6705793626885528, 'auprc': 0.819867628937072, 'loss_val': 1.1857601528365016, 'psi': 0.7302946691879605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
