[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:38403
[S3] → join 127.0.0.1:38402
[S4] → join 127.0.0.1:38402
[S5] → join 127.0.0.1:38402
[S6] → join 127.0.0.1:38402
[S7] → join 127.0.0.1:38402
[S8] → join 127.0.0.1:38402
[S9] → join 127.0.0.1:38402
[S10] → join 127.0.0.1:38402
[S11] → join 127.0.0.1:38402
[S13] → join 127.0.0.1:38402
[S14] → join 127.0.0.1:38402
[S15] → join 127.0.0.1:38402
[S16] → join 127.0.0.1:38402
[S17] → join 127.0.0.1:38402
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.167429 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.201797 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.160395 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.114981 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.118638 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.197936 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.184781 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.149405 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.136272 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.189842 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.171406 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.202755 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.164773 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.130476 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.166010 (no previous merge yet)
[S15]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3] + discovered S17
[S3] + discovered S10
[S3] + discovered S14
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S15
[S3] + discovered S9
[S3] + discovered S5
[S3] + discovered S7
[S3] + discovered S6
[S3] + discovered S13
[S3] + discovered S8
[S3] + discovered S11
[S3] + discovered S16
[S3] + discovered S4
[S5] + discovered S3
[S5] + discovered S4
[S5] + discovered S2
[S4] + discovered S15
[S4] + discovered S6
[S4] + discovered S9
[S4] + discovered S5
[S4] + discovered S7
[S4] + discovered S13
[S4] + discovered S8
[S4] + discovered S16
[S4] + discovered S11
[S4] + discovered S17
[S4] + discovered S10
[S4] + discovered S14
[S6] + discovered S2
[S6] + discovered S4
[S6] + discovered S3
[S6] + discovered S5
[S5] + discovered S14
[S5] + discovered S13
[S5] + discovered S17
[S5] + discovered S16
[S5] + discovered S8
[S5] + discovered S7
[S5] + discovered S9
[S5] + discovered S15
[S5] + discovered S10
[S5] + discovered S11
[S5] + discovered S6
[S6] + discovered S11
[S6] + discovered S9
[S6] + discovered S10
[S6] + discovered S7
[S6] + discovered S16
[S6] + discovered S13
[S6] + discovered S15
[S6] + discovered S8
[S6] + discovered S17
[S6] + discovered S14
[S7] + discovered S3
[S7] + discovered S4
[S7] + discovered S6
[S7] + discovered S5
[S7] + discovered S2
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S2
[S7] + discovered S16
[S7] + discovered S9
[S7] + discovered S11
[S7] + discovered S17
[S7] + discovered S14
[S7] + discovered S8
[S7] + discovered S15
[S8] + discovered S3
[S7] + discovered S13
[S8] + discovered S4
[S7] + discovered S10
[S8] + discovered S7
[S8] + discovered S16
[S8] + discovered S17
[S8] + discovered S11
[S8] + discovered S10
[S9] + discovered S4
[S9] + discovered S7
[S9] + discovered S3
[S9] + discovered S8
[S8] + discovered S14
[S9] + discovered S5
[S8] + discovered S13
[S8] + discovered S15
[S9] + discovered S6
[S9] + discovered S2
[S8] + discovered S9
[S9] + discovered S10
[S9] + discovered S11
[S9] + discovered S15
[S9] + discovered S14
[S9] + discovered S16
[S10] + discovered S9
[S10] + discovered S5
[S10] + discovered S6
[S10] + discovered S2
[S10] + discovered S3
[S10] + discovered S7
[S10] + discovered S4
[S10] + discovered S8
[S9] + discovered S17
[S9] + discovered S13
[S10] + discovered S14
[S11] + discovered S7
[S10] + discovered S17
[S11] + discovered S2
[S11] + discovered S6
[S11] + discovered S8
[S11] + discovered S9
[S11] + discovered S10
[S11] + discovered S5
[S10] + discovered S16
[S10] + discovered S15
[S10] + discovered S11
[S11] + discovered S3
[S10] + discovered S13
[S11] + discovered S4
[S13] + discovered S10
[S11] + discovered S15
[S11] + discovered S13
[S11] + discovered S14
[S11] + discovered S16
[S11] + discovered S17
[S13] + discovered S3
[S13] + discovered S6
[S13] + discovered S9
[S13] + discovered S5
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S2
[S13] + discovered S11
[S13] + discovered S8
[S14] + discovered S9
[S14] + discovered S13
[S14] + discovered S4
[S14] + discovered S6
[S14] + discovered S11
[S14] + discovered S5
[S14] + discovered S2
[S14] + discovered S3
[S13] + discovered S14
[S14] + discovered S8
[S13] + discovered S16
[S13] + discovered S15
[S13] + discovered S17
[S14] + discovered S7
[S14] + discovered S10
[S15] + discovered S4
[S15] + discovered S11
[S15] + discovered S6
[S15] + discovered S2
[S15] + discovered S8
[S14] + discovered S15
[S15] + discovered S13
[S15] + discovered S9
[S15] + discovered S14
[S15] + discovered S10
[S15] + discovered S7
[S15] + discovered S5
[S15] + discovered S3
[S14] + discovered S16
[S14] + discovered S17
[S16] + discovered S6
[S16] + discovered S10
[S16] + discovered S7
[S15] + discovered S17
[S16] + discovered S8
[S16] + discovered S15
[S16] + discovered S13
[S16] + discovered S3
[S16] + discovered S5
[S16] + discovered S14
[S16] + discovered S9
[S16] + discovered S11
[S16] + discovered S2
[S15] + discovered S16
[S16] + discovered S4
[S17] + discovered S3
[S17] + discovered S8
[S17] + discovered S6
[S17] + discovered S9
[S17] + discovered S16
[S17] + discovered S7
[S17] + discovered S11
[S17] + discovered S15
[S17] + discovered S5
[S17] + discovered S14
[S17] + discovered S2
[S17] + discovered S13
[S17] + discovered S4
[S16] + discovered S17
[S17] + discovered S10
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:38409
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:38403
[S7] ⇄ pheromone p=1.000 → S8@127.0.0.1:38409
[S13] ⇄ pheromone p=1.000 → S16@127.0.0.1:38416
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:38407
[S10] ⇄ pheromone p=1.000 → S7@127.0.0.1:38408
[S2] ⇄ pheromone p=1.000 → S5@127.0.0.1:38405
[S15] ⇄ pheromone p=1.000 → S7@127.0.0.1:38408
[S6] ⇄ pheromone p=1.000 → S7@127.0.0.1:38408
[S8] ⇄ pheromone p=1.000 → S16@127.0.0.1:38416
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:38404
[S9] ⇄ pheromone p=1.000 → S3@127.0.0.1:38403
[S14] ⇄ pheromone p=1.000 → S13@127.0.0.1:38413
[S11] ⇄ pheromone p=1.000 → S10@127.0.0.1:38411
[S17] ⇄ pheromone p=1.000 → S14@127.0.0.1:38414
[S2] START round=1 head_norm_before_train=1.185196 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7707534862941782, 'loss_val': 1.2537258656106924, 'psi': 0.39336767455081134}-{'f1_val': 0.4158043744979465, 'auprc': 0.5968322407017208, 'loss_val': 1.3229623267709125, 'psi': 0.4882155209794562}
[S3] START round=1 head_norm_before_train=1.194146 (no previous merge yet)
[S3] round=1 local utility u=0.870090 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8540143811454892, 'loss_val': 1.3561345645825094, 'psi': 0.42550979182665993}-{'f1_val': 0.1449012942392523, 'auprc': 0.27516029672972786, 'loss_val': 1.3901192704665235, 'psi': 0.1970048952354425}
[S4] START round=1 head_norm_before_train=1.186032 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7805235012882652, 'loss_val': 1.258424315497196, 'psi': 0.3963453778524166}-{'f1_val': 0.14022662889518414, 'auprc': 0.8571331622132381, 'loss_val': 1.3275910618013438, 'psi': 0.42698924222240575}
[S5] START round=1 head_norm_before_train=1.116804 (no previous merge yet)
[S5] round=1 local utility u=0.304801 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5765076730597938, 'loss_val': 1.3284604617432654, 'psi': 0.3159602120810604}-{'f1_val': 0.1423183803096467, 'auprc': 0.38483948554236774, 'loss_val': 1.3633960909022123, 'psi': 0.23932682240273512}
[S6] START round=1 head_norm_before_train=1.130837 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7734101599270085, 'loss_val': 1.2675239624493035, 'psi': 0.3942198332015726}-{'f1_val': 0.2800874596472937, 'auprc': 0.7496675160324537, 'loss_val': 1.3436226746998916, 'psi': 0.4679194822013577}
[S7] START round=1 head_norm_before_train=1.199670 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7797368146996657, 'loss_val': 1.3268826006925118, 'psi': 0.3971288195173213}-{'f1_val': 0.4173988288474969, 'auprc': 0.7847463530033244, 'loss_val': 1.3650972541258586, 'psi': 0.5643378385098279}
[S8] START round=1 head_norm_before_train=1.189080 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7671916480845895, 'loss_val': 1.249269212522252, 'psi': 0.39085024866961016}-{'f1_val': 0.13995598239295717, 'auprc': 0.789907937062088, 'loss_val': 1.3165276358816913, 'psi': 0.39993676426060953}
[S9] START round=1 head_norm_before_train=1.151255 (no previous merge yet)
[S9] round=1 local utility u=0.084924 metrics={'f1_val': 0.3941659435284694, 'auprc': 0.9995004177909848, 'loss_val': 1.3240918503747356, 'psi': 0.6362997332334756}-{'f1_val': 0.37518880971941626, 'auprc': 0.9978565679764737, 'loss_val': 1.3751452370271096, 'psi': 0.6242559130222393}
[S10] START round=1 head_norm_before_train=1.151924 (no previous merge yet)
[S10] round=1 local utility u=0.037431 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6435770424979044, 'loss_val': 1.2807195104778162, 'psi': 0.3406037995241961}-{'f1_val': 0.13862163754172394, 'auprc': 0.6397064164836899, 'loss_val': 1.3439698980509527, 'psi': 0.3390555491185103}
[S11] START round=1 head_norm_before_train=1.186658 (no previous merge yet)
[S11] round=1 local utility u=0.212911 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7258214512048548, 'loss_val': 1.3304974350542706, 'psi': 0.3745767905058083}-{'f1_val': 0.14041368337311058, 'auprc': 0.5956534129430966, 'loss_val': 1.3658161653220555, 'psi': 0.322509575201105}
[S13] START round=1 head_norm_before_train=1.178175 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5614071131487011, 'loss_val': 1.2649393138950997, 'psi': 0.3087943028057123}-{'f1_val': 0.48461686843891916, 'auprc': 0.6685585752651626, 'loss_val': 1.33137949644036, 'psi': 0.5581935511694165}
[S14] START round=1 head_norm_before_train=1.208024 (no previous merge yet)
[S14] round=1 local utility u=0.209753 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6482182724514614, 'loss_val': 1.3264461122183844, 'psi': 0.3435020207102068}-{'f1_val': 0.14035785288270378, 'auprc': 0.5157634504082008, 'loss_val': 1.348586728553267, 'psi': 0.2905200918929026}
[S15] START round=1 head_norm_before_train=1.164391 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.754175744982915, 'loss_val': 1.3005788413430217, 'psi': 0.385510488810101}-{'f1_val': 0.41173248111977145, 'auprc': 0.7358528799203242, 'loss_val': 1.370724009873462, 'psi': 0.5413806406399926}
[S16] START round=1 head_norm_before_train=1.133436 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6444403324015723, 'loss_val': 1.340650327571979, 'psi': 0.3421586030801508}-{'f1_val': 0.16357520896491862, 'auprc': 0.6161842863032254, 'loss_val': 1.3687927487108376, 'psi': 0.34461883990024134}
[S17] START round=1 head_norm_before_train=1.181318 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7154108599633623, 'loss_val': 1.297300526895197, 'psi': 0.37073372197577553}-{'f1_val': 0.3820636616232371, 'auprc': 0.6491155438420646, 'loss_val': 1.3519141202767737, 'psi': 0.48888441451076814}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S5] → sending delta(kind=head bytes=1785) to S2@127.0.0.1:38402
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:38402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S10] → sending delta(kind=head bytes=1787) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S3] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:38416
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S14] → sending delta(kind=head bytes=1786) to S2@127.0.0.1:38402
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1786 to 1 peers)
[S3] sending update (kind=head size=1788 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1787 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1785 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1788) from S3
[S16] cosine check vs S3: cos=0.0936
[S2] RECEIVED delta(kind=head bytes=1786) from S14
[S2] cosine check vs S14: cos=0.1126
[S2] RECEIVED delta(kind=head bytes=1791) from S9
[S2] cosine check vs S9: cos=-0.0855
[S2] DROPPED delta from S9 (cos=-0.0855 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=-0.0871
[S4] DROPPED delta from S11 (cos=-0.0871 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1785) from S5
[S2] cosine check vs S5: cos=-0.0496
[S2] DROPPED delta from S5 (cos=-0.0496 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1787) from S10
[S7] cosine check vs S10: cos=-0.0663
[S7] DROPPED delta from S10 (cos=-0.0663 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.230234
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.163059e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.914005 delta_norm=0.816306
[S2] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.143388
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.887754e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.866300 delta_norm=0.788775
[S16] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.914005 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.011819 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7574754642053462, 'loss_val': 1.1902542763282724, 'psi': 0.3880564657152785}-{'f1_val': 0.1417771333885667, 'auprc': 0.7707534862941782, 'loss_val': 1.2537258656106924, 'psi': 0.39336767455081134}
[S3] START round=2 head_norm_before_train=1.199145 (no previous merge yet)
[S3] round=2 local utility u=0.120384 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9240614848788595, 'loss_val': 1.3255074873092199, 'psi': 0.45352863332000803}-{'f1_val': 0.13984006561410703, 'auprc': 0.8540143811454892, 'loss_val': 1.3561345645825094, 'psi': 0.42550979182665993}
[S4] START round=2 head_norm_before_train=1.239496 (no previous merge yet)
[S4] round=2 local utility u=0.896318 metrics={'f1_val': 0.4146045557441992, 'auprc': 0.7844215320778056, 'loss_val': 1.1237499120719614, 'psi': 0.5625313462776418}-{'f1_val': 0.14022662889518414, 'auprc': 0.7805235012882652, 'loss_val': 1.258424315497196, 'psi': 0.3963453778524166}
[S5] START round=2 head_norm_before_train=1.127727 (no previous merge yet)
[S5] round=2 local utility u=0.182141 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.6843282925115994, 'loss_val': 1.2876398319206772, 'psi': 0.3590884598617826}-{'f1_val': 0.14226190476190476, 'auprc': 0.5765076730597938, 'loss_val': 1.3284604617432654, 'psi': 0.3159602120810604}
[S6] START round=2 head_norm_before_train=1.172560 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6234054890505534, 'loss_val': 1.1966257476726319, 'psi': 0.3342179648509906}-{'f1_val': 0.14142628205128205, 'auprc': 0.7734101599270085, 'loss_val': 1.2675239624493035, 'psi': 0.3942198332015726}
[S7] START round=2 head_norm_before_train=1.212653 (no previous merge yet)
[S7] round=2 local utility u=0.034244 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7873407973495399, 'loss_val': 1.2812061412847915, 'psi': 0.400170412577271}-{'f1_val': 0.14205682272909165, 'auprc': 0.7797368146996657, 'loss_val': 1.3268826006925118, 'psi': 0.3971288195173213}
[S8] START round=2 head_norm_before_train=1.225750 (no previous merge yet)
[S8] round=2 local utility u=0.746010 metrics={'f1_val': 0.36731900237160997, 'auprc': 0.7748542253781516, 'loss_val': 1.144414217740299, 'psi': 0.5303330915742266}-{'f1_val': 0.13995598239295717, 'auprc': 0.7671916480845895, 'loss_val': 1.249269212522252, 'psi': 0.39085024866961016}
[S9] START round=2 head_norm_before_train=1.163144 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9875553253672718, 'loss_val': 1.2653036465835337, 'psi': 0.47986090443090634}-{'f1_val': 0.3941659435284694, 'auprc': 0.9995004177909848, 'loss_val': 1.3240918503747356, 'psi': 0.6362997332334756}
[S10] START round=2 head_norm_before_train=1.194615 (no previous merge yet)
[S10] round=2 local utility u=0.194738 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.748220510596076, 'loss_val': 1.2051744897931047, 'psi': 0.38246118676346474}-{'f1_val': 0.13862163754172394, 'auprc': 0.6435770424979044, 'loss_val': 1.2807195104778162, 'psi': 0.3406037995241961}
[S11] START round=2 head_norm_before_train=1.193958 (no previous merge yet)
[S11] round=2 local utility u=0.141407 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8057113549003274, 'loss_val': 1.2873528141828483, 'psi': 0.40653275198399735}-{'f1_val': 0.14041368337311058, 'auprc': 0.7258214512048548, 'loss_val': 1.3304974350542706, 'psi': 0.3745767905058083}
[S13] START round=2 head_norm_before_train=1.212783 (no previous merge yet)
[S13] round=2 local utility u=0.049679 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5693148936202401, 'loss_val': 1.189304576757889, 'psi': 0.31195741499432794}-{'f1_val': 0.1403857625770531, 'auprc': 0.5614071131487011, 'loss_val': 1.2649393138950997, 'psi': 0.3087943028057123}
[S14] START round=2 head_norm_before_train=1.220673 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6306072664708607, 'loss_val': 1.2970333314040112, 'psi': 0.33645761831796656}-{'f1_val': 0.14035785288270378, 'auprc': 0.6482182724514614, 'loss_val': 1.3264461122183844, 'psi': 0.3435020207102068}
[S15] START round=2 head_norm_before_train=1.197992 (no previous merge yet)
[S15] round=2 local utility u=0.062534 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7744146488522192, 'loss_val': 1.2362280037640725, 'psi': 0.3936060503578227}-{'f1_val': 0.13973365136155833, 'auprc': 0.754175744982915, 'loss_val': 1.3005788413430217, 'psi': 0.385510488810101}
[S16] START round=2 head_norm_before_train=0.866300 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.020093 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6552908500014101, 'loss_val': 1.3330162911866352, 'psi': 0.346498810120086}-{'f1_val': 0.14063745019920318, 'auprc': 0.6444403324015723, 'loss_val': 1.340650327571979, 'psi': 0.3421586030801508}
[S17] START round=2 head_norm_before_train=1.216863 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.652466187195772, 'loss_val': 1.181536717694364, 'psi': 0.3455558528687394}-{'f1_val': 0.14094896331738438, 'auprc': 0.7154108599633623, 'loss_val': 1.297300526895197, 'psi': 0.37073372197577553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:38415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:38414
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:38414
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.454)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:38409
[S11] not sending this round → trigger blocked (psi=0.407)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:38410
[S5] not sending this round → trigger blocked (psi=0.359)
[S10] not sending this round → trigger blocked (psi=0.382)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:38403
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S13
[S9] cosine check vs S13: cos=0.0556
[S15] RECEIVED delta(kind=head bytes=1800) from S4
[S15] cosine check vs S4: cos=0.0116
[S14] RECEIVED delta(kind=head bytes=1793) from S16
[S14] cosine check vs S16: cos=-0.0750
[S14] DROPPED delta from S16 (cos=-0.0750 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S7
[S14] cosine check vs S7: cos=-0.0524
[S14] DROPPED delta from S7 (cos=-0.0524 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1792) from S15
[S13] cosine check vs S15: cos=-0.0039
[S13] DROPPED delta from S15 (cos=-0.0039 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1793) from S2
[S8] cosine check vs S2: cos=0.0268
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=-0.0468
[S3] DROPPED delta from S8 (cos=-0.0468 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=1.185080
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.395616e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.887523 delta_norm=0.839562
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=2 metric=0.1397 head_norm=1.237613
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.952702e-01
[S15] stored merged vector for next round verification (round=2)
[S15] DEBUG after merge:  round=2 metric=0.1397 head_norm=0.905713 delta_norm=0.895270
[S15] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=2 metric=0.3673 head_norm=1.276980
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.946891e-01
[S8] stored merged vector for next round verification (round=2)
[S8] DEBUG after merge:  round=2 metric=0.2511 head_norm=0.815522 delta_norm=0.794689
[S8] aggregate: ROLLBACK (f1_val pre=0.367 post=0.251 tol_abs=0.005 tol_rel=0.0)
[S2] START round=3 head_norm_before_train=0.981088 cos_to_last_merge=0.9939 (last merge round=1)
[S2] round=3 local utility u=0.916358 metrics={'f1_val': 0.4156703010573377, 'auprc': 0.7807372425753134, 'loss_val': 1.0706836062843004, 'psi': 0.561697077664528}-{'f1_val': 0.1417771333885667, 'auprc': 0.7574754642053462, 'loss_val': 1.1902542763282724, 'psi': 0.3880564657152785}
[S3] START round=3 head_norm_before_train=1.212832 (no previous merge yet)
[S3] round=3 local utility u=0.024389 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9282867093157605, 'loss_val': 1.2894045952469833, 'psi': 0.4552187230947684}-{'f1_val': 0.13984006561410703, 'auprc': 0.9240614848788595, 'loss_val': 1.3255074873092199, 'psi': 0.45352863332000803}
[S4] START round=3 head_norm_before_train=1.308421 (no previous merge yet)
[S4] round=3 local utility u=0.486711 metrics={'f1_val': 0.5264082890681356, 'auprc': 0.7870127446071248, 'loss_val': 0.8289231427489162, 'psi': 0.6306500712837313}-{'f1_val': 0.4146045557441992, 'auprc': 0.7844215320778056, 'loss_val': 1.1237499120719614, 'psi': 0.5625313462776418}
[S5] START round=3 head_norm_before_train=1.150823 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5673563675172999, 'loss_val': 1.2551953836792635, 'psi': 0.3122996898640628}-{'f1_val': 0.14226190476190476, 'auprc': 0.6843282925115994, 'loss_val': 1.2876398319206772, 'psi': 0.3590884598617826}
[S6] START round=3 head_norm_before_train=1.215974 (no previous merge yet)
[S6] round=3 local utility u=0.645329 metrics={'f1_val': 0.3399606346925129, 'auprc': 0.6134622979324218, 'loss_val': 1.0673445761999747, 'psi': 0.4493612999884765}-{'f1_val': 0.14142628205128205, 'auprc': 0.6234054890505534, 'loss_val': 1.1966257476726319, 'psi': 0.3342179648509906}
[S7] START round=3 head_norm_before_train=1.234753 (no previous merge yet)
[S7] round=3 local utility u=0.007166 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775650882023117, 'loss_val': 1.2375464529875213, 'psi': 0.3962601289183797}-{'f1_val': 0.14205682272909165, 'auprc': 0.7873407973495399, 'loss_val': 1.2812061412847915, 'psi': 0.400170412577271}
[S8] START round=3 head_norm_before_train=0.815522 cos_to_last_merge=1.0000 (last merge round=2)
[S8] round=3 local utility u=0.089873 metrics={'f1_val': 0.3726652774371328, 'auprc': 0.7768189755778705, 'loss_val': 1.0026401090913313, 'psi': 0.5343267566934279}-{'f1_val': 0.36731900237160997, 'auprc': 0.7748542253781516, 'loss_val': 1.144414217740299, 'psi': 0.5303330915742266}
[S9] START round=3 head_norm_before_train=0.887523 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8660070914652558, 'loss_val': 1.2471080338260607, 'psi': 0.43124161087009993}-{'f1_val': 0.141397957139996, 'auprc': 0.9875553253672718, 'loss_val': 1.2653036465835337, 'psi': 0.47986090443090634}
[S10] START round=3 head_norm_before_train=1.240503 (no previous merge yet)
[S10] round=3 local utility u=0.496191 metrics={'f1_val': 0.31420564322530714, 'auprc': 0.670160008654193, 'loss_val': 1.0321150181736118, 'psi': 0.4565873893968615}-{'f1_val': 0.13862163754172394, 'auprc': 0.748220510596076, 'loss_val': 1.2051744897931047, 'psi': 0.38246118676346474}
[S11] START round=3 head_norm_before_train=1.211742 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7749137307586339, 'loss_val': 1.2377172075615233, 'psi': 0.39421370232731995}-{'f1_val': 0.14041368337311058, 'auprc': 0.8057113549003274, 'loss_val': 1.2873528141828483, 'psi': 0.40653275198399735}
[S13] START round=3 head_norm_before_train=1.257261 (no previous merge yet)
[S13] round=3 local utility u=0.837635 metrics={'f1_val': 0.4164711099175653, 'auprc': 0.5285631541571388, 'loss_val': 1.048292439010596, 'psi': 0.46130792761339473}-{'f1_val': 0.1403857625770531, 'auprc': 0.5693148936202401, 'loss_val': 1.189304576757889, 'psi': 0.31195741499432794}
[S14] START round=3 head_norm_before_train=1.244321 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5678141201980729, 'loss_val': 1.2656106695656915, 'psi': 0.31134035980885144}-{'f1_val': 0.14035785288270378, 'auprc': 0.6306072664708607, 'loss_val': 1.2970333314040112, 'psi': 0.33645761831796656}
[S15] START round=3 head_norm_before_train=0.905713 cos_to_last_merge=1.0000 (last merge round=2)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7768267292955842, 'loss_val': 1.2465244727051865, 'psi': 0.3945708825351687}-{'f1_val': 0.13973365136155833, 'auprc': 0.7744146488522192, 'loss_val': 1.2362280037640725, 'psi': 0.3936060503578227}
[S16] START round=3 head_norm_before_train=0.884153 cos_to_last_merge=0.9968 (last merge round=1)
[S16] round=3 local utility u=0.019340 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.655902695492592, 'loss_val': 1.296172724507644, 'psi': 0.34674354831655874}-{'f1_val': 0.14063745019920318, 'auprc': 0.6552908500014101, 'loss_val': 1.3330162911866352, 'psi': 0.346498810120086}
[S17] START round=3 head_norm_before_train=1.270710 (no previous merge yet)
[S17] round=3 local utility u=1.000000 metrics={'f1_val': 0.42157871186320506, 'auprc': 0.7577159633921842, 'loss_val': 0.995393790165903, 'psi': 0.5560336124747967}-{'f1_val': 0.14094896331738438, 'auprc': 0.652466187195772, 'loss_val': 1.181536717694364, 'psi': 0.3455558528687394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:38407
[S2] not sending this round → trigger blocked (psi=0.562)
[S7] not sending this round → trigger blocked (psi=0.396)
[S16] not sending this round → trigger blocked (psi=0.347)
[S8] not sending this round → trigger blocked (psi=0.534)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:38408
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.631)
[S13] not sending this round → trigger blocked (psi=0.461)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1791) from S6
[S7] cosine check vs S6: cos=-0.0087
[S7] DROPPED delta from S6 (cos=-0.0087 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S3
[S6] cosine check vs S3: cos=-0.0985
[S6] DROPPED delta from S3 (cos=-0.0985 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=-0.0660
[S7] DROPPED delta from S10 (cos=-0.0660 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=0.0209
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.272765
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.110093e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.930204 delta_norm=0.911009
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.035302 cos_to_last_merge=0.9847 (last merge round=1)
[S2] round=4 local utility u=0.088795 metrics={'f1_val': 0.4169802289999417, 'auprc': 0.7702974277085142, 'loss_val': 0.8696332601448585, 'psi': 0.5583071084833706}-{'f1_val': 0.4156703010573377, 'auprc': 0.7807372425753134, 'loss_val': 1.0706836062843004, 'psi': 0.561697077664528}
[S3] START round=4 head_norm_before_train=1.236629 (no previous merge yet)
[S3] round=4 local utility u=0.003988 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9205735861102654, 'loss_val': 1.2582885298016022, 'psi': 0.4521334738125704}-{'f1_val': 0.13984006561410703, 'auprc': 0.9282867093157605, 'loss_val': 1.2894045952469833, 'psi': 0.4552187230947684}
[S4] START round=4 head_norm_before_train=1.382293 (no previous merge yet)
[S4] round=4 local utility u=0.658925 metrics={'f1_val': 0.6760522917486693, 'auprc': 0.846542540222132, 'loss_val': 0.5875264560984113, 'psi': 0.7442483911380544}-{'f1_val': 0.5264082890681356, 'auprc': 0.7870127446071248, 'loss_val': 0.8289231427489162, 'psi': 0.6306500712837313}
[S5] START round=4 head_norm_before_train=1.178800 (no previous merge yet)
[S5] round=4 local utility u=0.030334 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5791507756136085, 'loss_val': 1.229909713218393, 'psi': 0.3170174531025863}-{'f1_val': 0.14226190476190476, 'auprc': 0.5673563675172999, 'loss_val': 1.2551953836792635, 'psi': 0.3122996898640628}
[S6] START round=4 head_norm_before_train=1.259497 (no previous merge yet)
[S6] round=4 local utility u=0.562742 metrics={'f1_val': 0.4132691924753549, 'auprc': 0.7669306077454068, 'loss_val': 0.8421162132735784, 'psi': 0.5547337585833757}-{'f1_val': 0.3399606346925129, 'auprc': 0.6134622979324218, 'loss_val': 1.0673445761999747, 'psi': 0.4493612999884765}
[S7] START round=4 head_norm_before_train=1.260447 (no previous merge yet)
[S7] round=4 local utility u=0.018137 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776902724210912, 'loss_val': 1.2016487003729257, 'psi': 0.3963102026058915}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775650882023117, 'loss_val': 1.2375464529875213, 'psi': 0.3962601289183797}
[S8] START round=4 head_norm_before_train=0.887478 cos_to_last_merge=0.9932 (last merge round=2)
[S8] round=4 local utility u=0.415608 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.9939223393306474, 'loss_val': 0.8239371380470264, 'psi': 0.6212883560455649}-{'f1_val': 0.3726652774371328, 'auprc': 0.7768189755778705, 'loss_val': 1.0026401090913313, 'psi': 0.5343267566934279}
[S9] START round=4 head_norm_before_train=0.913729 cos_to_last_merge=0.9976 (last merge round=2)
[S9] round=4 local utility u=0.029458 metrics={'f1_val': 0.141397957139996, 'auprc': 0.865861873590689, 'loss_val': 1.1877554659621983, 'psi': 0.43118352372027324}-{'f1_val': 0.141397957139996, 'auprc': 0.8660070914652558, 'loss_val': 1.2471080338260607, 'psi': 0.43124161087009993}
[S10] START round=4 head_norm_before_train=1.302363 (no previous merge yet)
[S10] round=4 local utility u=1.000000 metrics={'f1_val': 0.700063668009639, 'auprc': 0.9324181254497099, 'loss_val': 0.6963107970828544, 'psi': 0.7930054509856674}-{'f1_val': 0.31420564322530714, 'auprc': 0.670160008654193, 'loss_val': 1.0321150181736118, 'psi': 0.4565873893968615}
[S11] START round=4 head_norm_before_train=1.237699 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7633697830898555, 'loss_val': 1.2068080780824273, 'psi': 0.3895961232598086}-{'f1_val': 0.14041368337311058, 'auprc': 0.7749137307586339, 'loss_val': 1.2377172075615233, 'psi': 0.39421370232731995}
[S13] START round=4 head_norm_before_train=1.306447 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.37169029467602305, 'auprc': 0.47654590315296297, 'loss_val': 1.0374683143732368, 'psi': 0.413632538066799}-{'f1_val': 0.4164711099175653, 'auprc': 0.5285631541571388, 'loss_val': 1.048292439010596, 'psi': 0.46130792761339473}
[S14] START round=4 head_norm_before_train=0.930204 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5560234997854233, 'loss_val': 1.2733901342961393, 'psi': 0.3066241116437916}-{'f1_val': 0.14035785288270378, 'auprc': 0.5678141201980729, 'loss_val': 1.2656106695656915, 'psi': 0.31134035980885144}
[S15] START round=4 head_norm_before_train=0.936403 cos_to_last_merge=0.9946 (last merge round=2)
[S15] round=4 local utility u=0.067311 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7777029612159789, 'loss_val': 1.1145315964941434, 'psi': 0.3949213753033266}-{'f1_val': 0.13973365136155833, 'auprc': 0.7768267292955842, 'loss_val': 1.2465244727051865, 'psi': 0.3945708825351687}
[S16] START round=4 head_norm_before_train=0.914084 cos_to_last_merge=0.9885 (last merge round=1)
[S16] round=4 local utility u=0.034223 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6609305473575933, 'loss_val': 1.2428112032629999, 'psi': 0.34875468906255924}-{'f1_val': 0.14063745019920318, 'auprc': 0.655902695492592, 'loss_val': 1.296172724507644, 'psi': 0.34674354831655874}
[S17] START round=4 head_norm_before_train=1.330603 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.36371749087943384, 'auprc': 0.7472437342908135, 'loss_val': 0.8643760532836743, 'psi': 0.5171279882439856}-{'f1_val': 0.42157871186320506, 'auprc': 0.7577159633921842, 'loss_val': 0.995393790165903, 'psi': 0.5560336124747967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:38403
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:38409
[S6] not sending this round → trigger blocked (psi=0.555)
[S3] not sending this round → trigger blocked (psi=0.452)
[S10] not sending this round → trigger blocked (psi=0.793)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S16] → sending delta(kind=head bytes=1786) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:38416
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1786 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S8
[S16] cosine check vs S8: cos=-0.0544
[S16] DROPPED delta from S8 (cos=-0.0544 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1790) from S2
[S5] cosine check vs S2: cos=-0.0923
[S5] DROPPED delta from S2 (cos=-0.0923 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S4
[S8] cosine check vs S4: cos=-0.0200
[S8] DROPPED delta from S4 (cos=-0.0200 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1793) from S7
[S8] cosine check vs S7: cos=0.0086
[S3] RECEIVED delta(kind=head bytes=1795) from S5
[S3] cosine check vs S5: cos=0.0176
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=0.0284
[S7] RECEIVED delta(kind=head bytes=1805) from S15
[S7] cosine check vs S15: cos=0.0002
[S4] RECEIVED delta(kind=head bytes=1786) from S16
[S4] cosine check vs S16: cos=0.0117
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.1398 head_norm=1.263152
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.213570e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.1398 head_norm=0.741995 delta_norm=0.721357
[S3] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.6761 head_norm=1.465377
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.693938e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.6609 head_norm=0.878758 delta_norm=0.869394
[S4] aggregate: ROLLBACK (f1_val pre=0.676 post=0.661 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.3729 head_norm=0.968328
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.011244e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.3729 head_norm=0.807785 delta_norm=0.801124
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=1.284903
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.113176e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1421 head_norm=0.811438 delta_norm=0.811318
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.102891 cos_to_last_merge=0.9705 (last merge round=1)
[S2] round=5 local utility u=0.953910 metrics={'f1_val': 0.7013912449526117, 'auprc': 0.7439697877395713, 'loss_val': 0.5892972823123163, 'psi': 0.7184226620673956}-{'f1_val': 0.4169802289999417, 'auprc': 0.7702974277085142, 'loss_val': 0.8696332601448585, 'psi': 0.5583071084833706}
[S3] START round=5 head_norm_before_train=0.741995 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.921070245899433, 'loss_val': 1.2653205187938852, 'psi': 0.45233213772823744}-{'f1_val': 0.13984006561410703, 'auprc': 0.9205735861102654, 'loss_val': 1.2582885298016022, 'psi': 0.4521334738125704}
[S4] START round=5 head_norm_before_train=0.878758 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.6593158743527269, 'auprc': 0.8588528572786646, 'loss_val': 0.5889264770693382, 'psi': 0.739130667523102}-{'f1_val': 0.6760522917486693, 'auprc': 0.846542540222132, 'loss_val': 0.5875264560984113, 'psi': 0.7442483911380544}
[S5] START round=5 head_norm_before_train=1.194704 (no previous merge yet)
[S5] round=5 local utility u=0.241479 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7275068218514001, 'loss_val': 1.1920208364739033, 'psi': 0.3763598715977029}-{'f1_val': 0.14226190476190476, 'auprc': 0.5791507756136085, 'loss_val': 1.229909713218393, 'psi': 0.3170174531025863}
[S6] START round=5 head_norm_before_train=1.321175 (no previous merge yet)
[S6] round=5 local utility u=0.668823 metrics={'f1_val': 0.5971840876626067, 'auprc': 0.791455391844618, 'loss_val': 0.6815348457595215, 'psi': 0.6748926093354113}-{'f1_val': 0.4132691924753549, 'auprc': 0.7669306077454068, 'loss_val': 0.8421162132735784, 'psi': 0.5547337585833757}
[S7] START round=5 head_norm_before_train=0.811438 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778378543765432, 'loss_val': 1.2191176166772708, 'psi': 0.3963692353880723}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776902724210912, 'loss_val': 1.2016487003729257, 'psi': 0.3963102026058915}
[S8] START round=5 head_norm_before_train=0.807785 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.014669 metrics={'f1_val': 0.3729322731464855, 'auprc': 0.9952017255787492, 'loss_val': 0.7988375336944281, 'psi': 0.621840054119391}-{'f1_val': 0.3728657005221765, 'auprc': 0.9939223393306474, 'loss_val': 0.8239371380470264, 'psi': 0.6212883560455649}
[S9] START round=5 head_norm_before_train=0.943869 cos_to_last_merge=0.9917 (last merge round=2)
[S9] round=5 local utility u=0.038874 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8641400328327238, 'loss_val': 1.1048425783818119, 'psi': 0.43049478741708713}-{'f1_val': 0.141397957139996, 'auprc': 0.865861873590689, 'loss_val': 1.1877554659621983, 'psi': 0.43118352372027324}
[S10] START round=5 head_norm_before_train=1.374447 (no previous merge yet)
[S10] round=5 local utility u=0.119885 metrics={'f1_val': 0.6876525877330749, 'auprc': 0.9474815967422718, 'loss_val': 0.4272645425418546, 'psi': 0.7915841913367536}-{'f1_val': 0.700063668009639, 'auprc': 0.9324181254497099, 'loss_val': 0.6963107970828544, 'psi': 0.7930054509856674}
[S11] START round=5 head_norm_before_train=1.268005 (no previous merge yet)
[S11] round=5 local utility u=0.056229 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7728779843953919, 'loss_val': 1.1228749088905312, 'psi': 0.39339940378202315}-{'f1_val': 0.14041368337311058, 'auprc': 0.7633697830898555, 'loss_val': 1.2068080780824273, 'psi': 0.3895961232598086}
[S13] START round=5 head_norm_before_train=1.369099 (no previous merge yet)
[S13] round=5 local utility u=0.063410 metrics={'f1_val': 0.3967281073222898, 'auprc': 0.41070847292444096, 'loss_val': 0.8633626895396279, 'psi': 0.40232025356315027}-{'f1_val': 0.37169029467602305, 'auprc': 0.47654590315296297, 'loss_val': 1.0374683143732368, 'psi': 0.413632538066799}
[S14] START round=5 head_norm_before_train=0.956065 cos_to_last_merge=0.9980 (last merge round=3)
[S14] round=5 local utility u=0.002568 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5403610171097424, 'loss_val': 1.2212675566994262, 'psi': 0.3003591185735192}-{'f1_val': 0.14035785288270378, 'auprc': 0.5560234997854233, 'loss_val': 1.2733901342961393, 'psi': 0.3066241116437916}
[S15] START round=5 head_norm_before_train=0.991140 cos_to_last_merge=0.9769 (last merge round=2)
[S15] round=5 local utility u=0.984265 metrics={'f1_val': 0.4181088048020016, 'auprc': 0.7999601310509722, 'loss_val': 0.8830230680716669, 'psi': 0.5708493353015898}-{'f1_val': 0.13973365136155833, 'auprc': 0.7777029612159789, 'loss_val': 1.1145315964941434, 'psi': 0.3949213753033266}
[S16] START round=5 head_norm_before_train=0.953306 cos_to_last_merge=0.9765 (last merge round=1)
[S16] round=5 local utility u=0.027067 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6564742651495875, 'loss_val': 1.175308695581159, 'psi': 0.34697217617935694}-{'f1_val': 0.14063745019920318, 'auprc': 0.6609305473575933, 'loss_val': 1.2428112032629999, 'psi': 0.34875468906255924}
[S17] START round=5 head_norm_before_train=1.395127 (no previous merge yet)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.3537203727030127, 'auprc': 0.668928749715213, 'loss_val': 0.8615815885236529, 'psi': 0.4798037235078928}-{'f1_val': 0.36371749087943384, 'auprc': 0.7472437342908135, 'loss_val': 0.8643760532836743, 'psi': 0.5171279882439856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S16] → sending delta(kind=head bytes=1787) to S4@127.0.0.1:38404
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:38403
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:38416
[S16] sending update (kind=head size=1787 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S2
[S5] cosine check vs S2: cos=-0.0813
[S5] DROPPED delta from S2 (cos=-0.0813 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S14
[S13] cosine check vs S14: cos=0.0074
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=0.3845
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=0.3081
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=0.5731
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=-0.0581
[S7] DROPPED delta from S10 (cos=-0.0581 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S6
[S7] cosine check vs S6: cos=-0.0219
[S7] DROPPED delta from S6 (cos=-0.0219 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S13
[S16] cosine check vs S13: cos=0.0195
[S16] RECEIVED delta(kind=head bytes=1791) from S8
[S16] cosine check vs S8: cos=-0.0569
[S16] DROPPED delta from S8 (cos=-0.0569 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1787) from S16
[S4] cosine check vs S16: cos=0.5058
[S10] RECEIVED delta(kind=head bytes=1792) from S11
[S10] cosine check vs S11: cos=0.0157
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.835758
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.490137e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.842122 delta_norm=0.449014
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.335 → S8@127.0.0.1:38409
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=0.775868
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.799818e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.1398 head_norm=0.664008 delta_norm=0.379982
[S3] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.415 → S6@127.0.0.1:38407
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.6593 head_norm=0.985537
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.928854e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.4753 head_norm=0.860266 delta_norm=0.492885
[S4] aggregate: ROLLBACK (f1_val pre=0.659 post=0.475 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.587 → S8@127.0.0.1:38409
[S11] ⇄ pheromone p=0.371 → S10@127.0.0.1:38411
[S9] ⇄ pheromone p=0.347 → S3@127.0.0.1:38403
[S14] ⇄ pheromone p=0.345 → S13@127.0.0.1:38413
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.3967 head_norm=1.424109
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.629611e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.3140 head_norm=0.868921 delta_norm=0.862961
[S13] aggregate: ROLLBACK (f1_val pre=0.397 post=0.314 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.453 → S16@127.0.0.1:38416
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.997349
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.613263e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1039 head_norm=0.877218 delta_norm=0.861326
[S16] aggregate: ROLLBACK (f1_val pre=0.141 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.343 → S4@127.0.0.1:38404
[S5] ⇄ pheromone p=0.424 → S3@127.0.0.1:38403
[S6] ⇄ pheromone p=0.634 → S7@127.0.0.1:38408
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.6877 head_norm=1.462039
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.670154e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.6872 head_norm=0.982187 delta_norm=0.967015
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.598 → S7@127.0.0.1:38408
[S8] ⇄ pheromone p=0.485 → S16@127.0.0.1:38416
[S15] ⇄ pheromone p=0.542 → S7@127.0.0.1:38408
[S2] ⇄ pheromone p=0.651 → S5@127.0.0.1:38405
[S17] ⇄ pheromone p=0.456 → S14@127.0.0.1:38414
[S2] START round=6 head_norm_before_train=1.189337 cos_to_last_merge=0.9500 (last merge round=1)
[S2] round=6 local utility u=0.059561 metrics={'f1_val': 0.701470645897668, 'auprc': 0.7186922118780568, 'loss_val': 0.3948181444493296, 'psi': 0.7083592722898235}-{'f1_val': 0.7013912449526117, 'auprc': 0.7439697877395713, 'loss_val': 0.5892972823123163, 'psi': 0.7184226620673956}
[S3] START round=6 head_norm_before_train=0.664008 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8874718578742014, 'loss_val': 1.2631066452134292, 'psi': 0.4388927825181448}-{'f1_val': 0.13984006561410703, 'auprc': 0.921070245899433, 'loss_val': 1.2653205187938852, 'psi': 0.45233213772823744}
[S4] START round=6 head_norm_before_train=0.860266 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.005684 metrics={'f1_val': 0.6620522717583355, 'auprc': 0.8579862695001254, 'loss_val': 0.5913771057584328, 'psi': 0.7404258708550515}-{'f1_val': 0.6593158743527269, 'auprc': 0.8588528572786646, 'loss_val': 0.5889264770693382, 'psi': 0.739130667523102}
[S5] START round=6 head_norm_before_train=1.205806 (no previous merge yet)
[S5] round=6 local utility u=0.179059 metrics={'f1_val': 0.16791569086651054, 'auprc': 0.7773543513993035, 'loss_val': 1.1373681060674683, 'psi': 0.4116911550796278}-{'f1_val': 0.14226190476190476, 'auprc': 0.7275068218514001, 'loss_val': 1.1920208364739033, 'psi': 0.3763598715977029}
[S6] START round=6 head_norm_before_train=1.379447 (no previous merge yet)
[S6] round=6 local utility u=0.473884 metrics={'f1_val': 0.7097881113328781, 'auprc': 0.8378135543908838, 'loss_val': 0.5484659643111167, 'psi': 0.7609982885560804}-{'f1_val': 0.5971840876626067, 'auprc': 0.791455391844618, 'loss_val': 0.6815348457595215, 'psi': 0.6748926093354113}
[S7] START round=6 head_norm_before_train=0.842122 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.000840 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777915678282611, 'loss_val': 1.217298770760524, 'psi': 0.39635072076875943}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778378543765432, 'loss_val': 1.2191176166772708, 'psi': 0.3963692353880723}
[S8] START round=6 head_norm_before_train=0.897455 cos_to_last_merge=0.9869 (last merge round=4)
[S8] round=6 local utility u=0.058757 metrics={'f1_val': 0.3727983816295533, 'auprc': 0.995008445480929, 'loss_val': 0.6799404895275363, 'psi': 0.6216824071701036}-{'f1_val': 0.3729322731464855, 'auprc': 0.9952017255787492, 'loss_val': 0.7988375336944281, 'psi': 0.621840054119391}
[S9] START round=6 head_norm_before_train=0.976284 cos_to_last_merge=0.9842 (last merge round=2)
[S9] round=6 local utility u=0.889035 metrics={'f1_val': 0.41596643747099904, 'auprc': 0.8551632353067052, 'loss_val': 0.9472523891931612, 'psi': 0.5916451566052815}-{'f1_val': 0.141397957139996, 'auprc': 0.8641400328327238, 'loss_val': 1.1048425783818119, 'psi': 0.43049478741708713}
[S10] START round=6 head_norm_before_train=0.982187 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.067745 metrics={'f1_val': 0.6887135971856682, 'auprc': 0.9869614047845765, 'loss_val': 0.4165799971096975, 'psi': 0.8080127202252314}-{'f1_val': 0.6876525877330749, 'auprc': 0.9474815967422718, 'loss_val': 0.4272645425418546, 'psi': 0.7915841913367536}
[S11] START round=6 head_norm_before_train=1.289211 (no previous merge yet)
[S11] round=6 local utility u=0.100773 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8073451821883607, 'loss_val': 1.0247305420888813, 'psi': 0.40718628289921066}-{'f1_val': 0.14041368337311058, 'auprc': 0.7728779843953919, 'loss_val': 1.1228749088905312, 'psi': 0.39339940378202315}
[S13] START round=6 head_norm_before_train=0.868921 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.177154 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.490718647644379, 'loss_val': 0.8635596473773463, 'psi': 0.4457718202491699}-{'f1_val': 0.3967281073222898, 'auprc': 0.41070847292444096, 'loss_val': 0.8633626895396279, 'psi': 0.40232025356315027}
[S14] START round=6 head_norm_before_train=0.985579 cos_to_last_merge=0.9925 (last merge round=3)
[S14] round=6 local utility u=0.099281 metrics={'f1_val': 0.15394679459223726, 'auprc': 0.5507777216747292, 'loss_val': 1.1354886379748728, 'psi': 0.31267916542523405}-{'f1_val': 0.14035785288270378, 'auprc': 0.5403610171097424, 'loss_val': 1.2212675566994262, 'psi': 0.3003591185735192}
[S15] START round=6 head_norm_before_train=1.059751 cos_to_last_merge=0.9510 (last merge round=2)
[S15] round=6 local utility u=0.983959 metrics={'f1_val': 0.7002669143990126, 'auprc': 0.799868323104312, 'loss_val': 0.6077775681657912, 'psi': 0.7401074778811323}-{'f1_val': 0.4181088048020016, 'auprc': 0.7999601310509722, 'loss_val': 0.8830230680716669, 'psi': 0.5708493353015898}
[S16] START round=6 head_norm_before_train=0.877218 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.371168 metrics={'f1_val': 0.34557035400216096, 'auprc': 0.47516353658766225, 'loss_val': 1.1186386999906937, 'psi': 0.39740762703636145}-{'f1_val': 0.14063745019920318, 'auprc': 0.6564742651495875, 'loss_val': 1.175308695581159, 'psi': 0.34697217617935694}
[S17] START round=6 head_norm_before_train=1.454071 (no previous merge yet)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.3525844685111543, 'auprc': 0.6039850504320781, 'loss_val': 0.9255658698123317, 'psi': 0.45314470127952383}-{'f1_val': 0.3537203727030127, 'auprc': 0.668928749715213, 'loss_val': 0.8615815885236529, 'psi': 0.4798037235078928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:38411
[S5] not sending this round → trigger blocked (psi=0.412)
[S2] not sending this round → trigger blocked (psi=0.708)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.313)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:38403
[S10] not sending this round → trigger blocked (psi=0.808)
[S15] not sending this round → trigger blocked (psi=0.740)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:38404
[S13] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] cosine check vs S6: cos=-0.0258
[S7] DROPPED delta from S6 (cos=-0.0258 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S8
[S16] cosine check vs S8: cos=-0.1041
[S16] DROPPED delta from S8 (cos=-0.1041 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S11
[S10] cosine check vs S11: cos=0.6148
[S8] RECEIVED delta(kind=head bytes=1797) from S7
[S8] cosine check vs S7: cos=0.2544
[S8] RECEIVED delta(kind=head bytes=1790) from S4
[S8] cosine check vs S4: cos=-0.0348
[S8] DROPPED delta from S4 (cos=-0.0348 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1793) from S9
[S3] cosine check vs S9: cos=0.5024
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] cosine check vs S16: cos=0.4928
[S16] RECEIVED delta(kind=head bytes=1804) from S13
[S16] cosine check vs S13: cos=0.6503
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.1398 head_norm=0.697245
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.481932e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.1398 head_norm=0.745655 delta_norm=0.448193
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.6887 head_norm=1.075678
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.345595e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.6886 head_norm=1.073927 delta_norm=0.534560
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.3728 head_norm=0.985820
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.659373e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.3728 head_norm=0.732222 delta_norm=0.565937
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.3456 head_norm=0.910000
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.864863e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.3742 head_norm=0.839119 delta_norm=0.386486
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.6621 head_norm=0.967817
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.734858e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.6623 head_norm=0.811292 delta_norm=0.473486
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.283040 cos_to_last_merge=0.9260 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.926
[S2] round=7 local utility u=0.286605 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.8777027020902055, 'loss_val': 0.29924269444723867, 'psi': 0.7720237162592313}-{'f1_val': 0.701470645897668, 'auprc': 0.7186922118780568, 'loss_val': 0.3948181444493296, 'psi': 0.7083592722898235}
[S3] START round=7 head_norm_before_train=0.745655 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8617400241813885, 'loss_val': 1.2585809206694056, 'psi': 0.42860004904101967}-{'f1_val': 0.13984006561410703, 'auprc': 0.8874718578742014, 'loss_val': 1.2631066452134292, 'psi': 0.4388927825181448}
[S4] START round=7 head_norm_before_train=0.811292 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.123593 metrics={'f1_val': 0.6614611770352833, 'auprc': 0.9435755598837632, 'loss_val': 0.5974130497132715, 'psi': 0.7743069301746752}-{'f1_val': 0.6620522717583355, 'auprc': 0.8579862695001254, 'loss_val': 0.5913771057584328, 'psi': 0.7404258708550515}
[S5] START round=7 head_norm_before_train=1.220098 (no previous merge yet)
[S5] round=7 local utility u=0.793670 metrics={'f1_val': 0.4176512731124327, 'auprc': 0.7777706105095938, 'loss_val': 1.0496897860493757, 'psi': 0.5616990080712971}-{'f1_val': 0.16791569086651054, 'auprc': 0.7773543513993035, 'loss_val': 1.1373681060674683, 'psi': 0.4116911550796278}
[S6] START round=7 head_norm_before_train=1.443906 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.6443060119021865, 'auprc': 0.7982011718147983, 'loss_val': 0.5134458608411283, 'psi': 0.7058640758672312}-{'f1_val': 0.7097881113328781, 'auprc': 0.8378135543908838, 'loss_val': 0.5484659643111167, 'psi': 0.7609982885560804}
[S7] START round=7 head_norm_before_train=0.860830 cos_to_last_merge=0.9971 (last merge round=5)
[S7] round=7 local utility u=0.656670 metrics={'f1_val': 0.3493029040319462, 'auprc': 0.7778312817345681, 'loss_val': 1.1475545356161763, 'psi': 0.520714255112995}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777915678282611, 'loss_val': 1.217298770760524, 'psi': 0.39635072076875943}
[S8] START round=7 head_norm_before_train=0.732222 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.3725978128855645, 'auprc': 0.9930808976114557, 'loss_val': 0.6963889387932424, 'psi': 0.620791046775921}-{'f1_val': 0.3727983816295533, 'auprc': 0.995008445480929, 'loss_val': 0.6799404895275363, 'psi': 0.6216824071701036}
[S9] START round=7 head_norm_before_train=1.013710 cos_to_last_merge=0.9748 (last merge round=2)
[S9] round=7 local utility u=0.152213 metrics={'f1_val': 0.43653568420557587, 'auprc': 0.8584855649763695, 'loss_val': 0.776209504435641, 'psi': 0.6053156365138933}-{'f1_val': 0.41596643747099904, 'auprc': 0.8551632353067052, 'loss_val': 0.9472523891931612, 'psi': 0.5916451566052815}
[S10] START round=7 head_norm_before_train=1.073927 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.052765 metrics={'f1_val': 0.7000537794092287, 'auprc': 0.997461463420674, 'loss_val': 0.4105904334038748, 'psi': 0.8190168530138069}-{'f1_val': 0.6887135971856682, 'auprc': 0.9869614047845765, 'loss_val': 0.4165799971096975, 'psi': 0.8080127202252314}
[S11] START round=7 head_norm_before_train=1.311893 (no previous merge yet)
[S11] round=7 local utility u=1.000000 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9654448269073321, 'loss_val': 0.8889470319069012, 'psi': 0.6241092723186566}-{'f1_val': 0.14041368337311058, 'auprc': 0.8073451821883607, 'loss_val': 1.0247305420888813, 'psi': 0.40718628289921066}
[S13] START round=7 head_norm_before_train=0.937488 cos_to_last_merge=0.9919 (last merge round=5)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.3849858702176946, 'auprc': 0.4909289338122591, 'loss_val': 0.8322575872434975, 'psi': 0.4273630956555204}-{'f1_val': 0.41580726865236384, 'auprc': 0.490718647644379, 'loss_val': 0.8635596473773463, 'psi': 0.4457718202491699}
[S14] START round=7 head_norm_before_train=1.018215 cos_to_last_merge=0.9852 (last merge round=3)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.3964619511854436, 'auprc': 0.7515609609854043, 'loss_val': 1.0295201628350368, 'psi': 0.5385015551054279}-{'f1_val': 0.15394679459223726, 'auprc': 0.5507777216747292, 'loss_val': 1.1354886379748728, 'psi': 0.31267916542523405}
[S15] START round=7 head_norm_before_train=1.147422 cos_to_last_merge=0.9202 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.920
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.6936359422275227, 'auprc': 0.7993077439156417, 'loss_val': 0.6012921746842677, 'psi': 0.7359046629027703}-{'f1_val': 0.7002669143990126, 'auprc': 0.799868323104312, 'loss_val': 0.6077775681657912, 'psi': 0.7401074778811323}
[S16] START round=7 head_norm_before_train=0.839119 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.272898 metrics={'f1_val': 0.41719231679200464, 'auprc': 0.48039621071260835, 'loss_val': 1.018273239881258, 'psi': 0.4424738743602461}-{'f1_val': 0.34557035400216096, 'auprc': 0.47516353658766225, 'loss_val': 1.1186386999906937, 'psi': 0.39740762703636145}
[S17] START round=7 head_norm_before_train=1.492652 (no previous merge yet)
[S17] round=7 local utility u=0.066162 metrics={'f1_val': 0.3473398844215665, 'auprc': 0.6798368700219293, 'loss_val': 0.9893291894818895, 'psi': 0.4803386786617116}-{'f1_val': 0.3525844685111543, 'auprc': 0.6039850504320781, 'loss_val': 0.9255658698123317, 'psi': 0.45314470127952383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:38403
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38405
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:38409
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:38413
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:38409
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=-0.1155
[S7] DROPPED delta from S10 (cos=-0.1155 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] cosine check vs S16: cos=0.6179
[S13] RECEIVED delta(kind=head bytes=1798) from S14
[S13] cosine check vs S14: cos=0.4906
[S10] RECEIVED delta(kind=head bytes=1797) from S11
[S10] cosine check vs S11: cos=0.8621
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] cosine check vs S2: cos=-0.0519
[S5] DROPPED delta from S2 (cos=-0.0519 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1791) from S4
[S8] cosine check vs S4: cos=0.0382
[S8] RECEIVED delta(kind=head bytes=1791) from S7
[S8] cosine check vs S7: cos=0.6968
[S3] RECEIVED delta(kind=head bytes=1795) from S9
[S3] cosine check vs S9: cos=0.8935
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] cosine check vs S5: cos=0.2624
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1805 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1805) from S17
[S14] cosine check vs S17: cos=0.6308
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.3726 head_norm=0.824697
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.958542e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.3726 head_norm=0.652384 delta_norm=0.395854
[S8] aggregate: ACCEPT kept=['S4', 'S7'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.1398 head_norm=0.765086
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.465908e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.1398 head_norm=0.740350 delta_norm=0.246591
[S3] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.3850 head_norm=1.018081
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.246933e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.3730 head_norm=0.897040 delta_norm=0.524693
[S13] aggregate: ROLLBACK (f1_val pre=0.385 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.6615 head_norm=0.920950
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.919015e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6633 head_norm=0.805025 delta_norm=0.391901
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.3965 head_norm=1.059942
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.895618e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.4491 head_norm=1.166047 delta_norm=0.589562
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.7001 head_norm=1.150114
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.408131e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.9555 head_norm=1.204103 delta_norm=0.340813
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.358928 cos_to_last_merge=0.9030 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.903
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.7056887750168136, 'loss_val': 0.2833586697378927, 'psi': 0.7032181454298745}-{'f1_val': 0.7015710590385817, 'auprc': 0.8777027020902055, 'loss_val': 0.29924269444723867, 'psi': 0.7720237162592313}
[S3] START round=8 head_norm_before_train=0.740350 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.017968 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8597403613491881, 'loss_val': 1.2166457560247566, 'psi': 0.42780018390813945}-{'f1_val': 0.13984006561410703, 'auprc': 0.8617400241813885, 'loss_val': 1.2585809206694056, 'psi': 0.42860004904101967}
[S4] START round=8 head_norm_before_train=0.805025 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.862622 metrics={'f1_val': 0.9473775981059684, 'auprc': 0.9453848920300185, 'loss_val': 0.5930955129310909, 'psi': 0.9465805156755884}-{'f1_val': 0.6614611770352833, 'auprc': 0.9435755598837632, 'loss_val': 0.5974130497132715, 'psi': 0.7743069301746752}
[S5] START round=8 head_norm_before_train=1.238732 (no previous merge yet)
[S5] round=8 local utility u=0.913118 metrics={'f1_val': 0.7030856069943066, 'auprc': 0.7778219552288929, 'loss_val': 0.9362135110437234, 'psi': 0.7329801462881411}-{'f1_val': 0.4176512731124327, 'auprc': 0.7777706105095938, 'loss_val': 1.0496897860493757, 'psi': 0.5616990080712971}
[S6] START round=8 head_norm_before_train=1.521423 (no previous merge yet)
[S6] round=8 local utility u=0.505477 metrics={'f1_val': 0.7094983302739498, 'auprc': 0.9531115295465327, 'loss_val': 0.3583762105080935, 'psi': 0.806943609982983}-{'f1_val': 0.6443060119021865, 'auprc': 0.7982011718147983, 'loss_val': 0.5134458608411283, 'psi': 0.7058640758672312}
[S7] START round=8 head_norm_before_train=0.885340 cos_to_last_merge=0.9891 (last merge round=5)
[S7] round=8 local utility u=0.240870 metrics={'f1_val': 0.4171579869317734, 'auprc': 0.777012001138715, 'loss_val': 1.0704869262503576, 'psi': 0.5610995926145501}-{'f1_val': 0.3493029040319462, 'auprc': 0.7778312817345681, 'loss_val': 1.1475545356161763, 'psi': 0.520714255112995}
[S8] START round=8 head_norm_before_train=0.652384 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.3725978128855645, 'auprc': 0.9914178352244095, 'loss_val': 0.7201572877476027, 'psi': 0.6201258218211025}-{'f1_val': 0.3725978128855645, 'auprc': 0.9930808976114557, 'loss_val': 0.6963889387932424, 'psi': 0.620791046775921}
[S9] START round=8 head_norm_before_train=1.061906 cos_to_last_merge=0.9618 (last merge round=2)
[S9] round=8 local utility u=1.000000 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.999673169470113, 'loss_val': 0.5841841363576897, 'psi': 0.8208381772189822}-{'f1_val': 0.43653568420557587, 'auprc': 0.8584855649763695, 'loss_val': 0.776209504435641, 'psi': 0.6053156365138933}
[S10] START round=8 head_norm_before_train=1.204103 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.788193 metrics={'f1_val': 0.9565306080604937, 'auprc': 0.9974164220423507, 'loss_val': 0.37293030711943176, 'psi': 0.9728849336532366}-{'f1_val': 0.7000537794092287, 'auprc': 0.997461463420674, 'loss_val': 0.4105904334038748, 'psi': 0.8190168530138069}
[S11] START round=8 head_norm_before_train=1.345092 (no previous merge yet)
[S11] round=8 local utility u=0.250008 metrics={'f1_val': 0.4374392989397371, 'auprc': 0.9986572660202999, 'loss_val': 0.7338909336848436, 'psi': 0.6619264857719622}-{'f1_val': 0.39655223592620625, 'auprc': 0.9654448269073321, 'loss_val': 0.8889470319069012, 'psi': 0.6241092723186566}
[S13] START round=8 head_norm_before_train=0.897040 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.37199349544676236, 'auprc': 0.49190385879127424, 'loss_val': 0.9218601223053846, 'psi': 0.4199576407845671}-{'f1_val': 0.3849858702176946, 'auprc': 0.4909289338122591, 'loss_val': 0.8322575872434975, 'psi': 0.4273630956555204}
[S14] START round=8 head_norm_before_train=1.166047 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.327309 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.9397522978553725, 'loss_val': 0.9398707124080505, 'psi': 0.6138174617893036}-{'f1_val': 0.3964619511854436, 'auprc': 0.7515609609854043, 'loss_val': 1.0295201628350368, 'psi': 0.5385015551054279}
[S15] START round=8 head_norm_before_train=1.236030 cos_to_last_merge=0.8937 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.894
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.696140808760891, 'auprc': 0.6588064545919934, 'loss_val': 0.34060945118334096, 'psi': 0.681207067093332}-{'f1_val': 0.6936359422275227, 'auprc': 0.7993077439156417, 'loss_val': 0.6012921746842677, 'psi': 0.7359046629027703}
[S16] START round=8 head_norm_before_train=0.868995 cos_to_last_merge=0.9939 (last merge round=6)
[S16] round=8 local utility u=0.219344 metrics={'f1_val': 0.38414206838313125, 'auprc': 0.6532471461813005, 'loss_val': 0.8998373266510273, 'psi': 0.491784099502399}-{'f1_val': 0.41719231679200464, 'auprc': 0.48039621071260835, 'loss_val': 1.018273239881258, 'psi': 0.4424738743602461}
[S17] START round=8 head_norm_before_train=1.513611 (no previous merge yet)
[S17] round=8 local utility u=0.213730 metrics={'f1_val': 0.35277173603230394, 'auprc': 0.7838567333149495, 'loss_val': 0.9065205607960263, 'psi': 0.5252057349453622}-{'f1_val': 0.3473398844215665, 'auprc': 0.6798368700219293, 'loss_val': 0.9893291894818895, 'psi': 0.4803386786617116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:38409
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:38411
[S3] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=-0.1142
[S7] DROPPED delta from S10 (cos=-0.1142 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S14
[S13] cosine check vs S14: cos=0.7285
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] cosine check vs S3: cos=0.0370
[S10] RECEIVED delta(kind=head bytes=1794) from S11
[S10] cosine check vs S11: cos=0.9283
[S8] RECEIVED delta(kind=head bytes=1795) from S4
[S8] cosine check vs S4: cos=0.3252
[S8] RECEIVED delta(kind=head bytes=1797) from S7
[S8] cosine check vs S7: cos=0.7586
[S3] RECEIVED delta(kind=head bytes=1802) from S5
[S3] cosine check vs S5: cos=0.5334
[S3] RECEIVED delta(kind=head bytes=1794) from S9
[S3] cosine check vs S9: cos=0.7775
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:38414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:38404
[S17] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S17
[S14] cosine check vs S17: cos=0.9145
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] cosine check vs S16: cos=0.8271
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] cosine check vs S6: cos=-0.0098
[S7] DROPPED delta from S6 (cos=-0.0098 < 0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.3726 head_norm=0.753680
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.729572e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.3726 head_norm=0.664899 delta_norm=0.272957
[S8] aggregate: ACCEPT kept=['S4', 'S7'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.3720 head_norm=0.968529
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.134428e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.3732 head_norm=1.008507 delta_norm=0.413443
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.3965 head_norm=1.199165
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.265600e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.5301 head_norm=1.337506 delta_norm=0.326560
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.9565 head_norm=1.271636
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.581104e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.9892 head_norm=1.305395 delta_norm=0.258110
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.9474 head_norm=0.899260
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.666048e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.9485 head_norm=0.866343 delta_norm=0.266605
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.1398 head_norm=0.762813
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.451392e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.1398 head_norm=0.780474 delta_norm=0.145139
[S3] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.7095 head_norm=1.585285
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.668379e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.7095 head_norm=0.892243 delta_norm=0.866838
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.420546 cos_to_last_merge=0.8883 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.888
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.6672598484334216, 'loss_val': 0.2844326788621124, 'psi': 0.6877990291116762}-{'f1_val': 0.7015710590385817, 'auprc': 0.7056887750168136, 'loss_val': 0.2833586697378927, 'psi': 0.7032181454298745}
[S3] START round=9 head_norm_before_train=0.780474 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.562592 metrics={'f1_val': 0.349229583455809, 'auprc': 0.7818902556589873, 'loss_val': 1.114248392536176, 'psi': 0.5222938523370804}-{'f1_val': 0.13984006561410703, 'auprc': 0.8597403613491881, 'loss_val': 1.2166457560247566, 'psi': 0.42780018390813945}
[S4] START round=9 head_norm_before_train=0.866343 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.063039 metrics={'f1_val': 0.9526095754244436, 'auprc': 0.9536125146270693, 'loss_val': 0.5230927070644655, 'psi': 0.9530107511054938}-{'f1_val': 0.9473775981059684, 'auprc': 0.9453848920300185, 'loss_val': 0.5930955129310909, 'psi': 0.9465805156755884}
[S5] START round=9 head_norm_before_train=1.264269 (no previous merge yet)
[S5] round=9 local utility u=0.094469 metrics={'f1_val': 0.7157326608733922, 'auprc': 0.7775124098088244, 'loss_val': 0.8222289278388277, 'psi': 0.7404445604475651}-{'f1_val': 0.7030856069943066, 'auprc': 0.7778219552288929, 'loss_val': 0.9362135110437234, 'psi': 0.7329801462881411}
[S6] START round=9 head_norm_before_train=0.892243 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.642931988866153, 'auprc': 0.812135826348298, 'loss_val': 0.5396285845774635, 'psi': 0.710613523859011}-{'f1_val': 0.7094983302739498, 'auprc': 0.9531115295465327, 'loss_val': 0.3583762105080935, 'psi': 0.806943609982983}
[S7] START round=9 head_norm_before_train=0.900333 cos_to_last_merge=0.9819 (last merge round=5)
[S7] round=9 local utility u=0.042079 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.7768024434726579, 'loss_val': 0.9849646008340195, 'psi': 0.560942233681832}-{'f1_val': 0.4171579869317734, 'auprc': 0.777012001138715, 'loss_val': 1.0704869262503576, 'psi': 0.5610995926145501}
[S8] START round=9 head_norm_before_train=0.664899 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.012829 metrics={'f1_val': 0.3725978128855645, 'auprc': 0.9923654518591194, 'loss_val': 0.697341574811707, 'psi': 0.6205048684749865}-{'f1_val': 0.3725978128855645, 'auprc': 0.9914178352244095, 'loss_val': 0.7201572877476027, 'psi': 0.6201258218211025}
[S9] START round=9 head_norm_before_train=1.115706 cos_to_last_merge=0.9471 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.947
[S9] round=9 local utility u=0.068052 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9993547711700802, 'loss_val': 0.4456239140525574, 'psi': 0.8205607090995376}-{'f1_val': 0.7016148490515617, 'auprc': 0.999673169470113, 'loss_val': 0.5841841363576897, 'psi': 0.8208381772189822}
[S10] START round=9 head_norm_before_train=1.305395 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.148062 metrics={'f1_val': 0.9954627014564918, 'auprc': 0.9975107398413121, 'loss_val': 0.3106813871601352, 'psi': 0.99628191681042}-{'f1_val': 0.9565306080604937, 'auprc': 0.9974164220423507, 'loss_val': 0.37293030711943176, 'psi': 0.9728849336532366}
[S11] START round=9 head_norm_before_train=1.387190 (no previous merge yet)
[S11] round=9 local utility u=0.864579 metrics={'f1_val': 0.701890640953942, 'auprc': 0.9945204932812303, 'loss_val': 0.5790311058523728, 'psi': 0.8189425818848574}-{'f1_val': 0.4374392989397371, 'auprc': 0.9986572660202999, 'loss_val': 0.7338909336848436, 'psi': 0.6619264857719622}
[S13] START round=9 head_norm_before_train=1.008507 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.684616 metrics={'f1_val': 0.5806326573064042, 'auprc': 0.5114021367062649, 'loss_val': 0.8629569959478361, 'psi': 0.5529404490663485}-{'f1_val': 0.37199349544676236, 'auprc': 0.49190385879127424, 'loss_val': 0.9218601223053846, 'psi': 0.4199576407845671}
[S14] START round=9 head_norm_before_train=1.337506 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.062299 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.9575641607068334, 'loss_val': 0.8687091693812861, 'psi': 0.620942206929888}-{'f1_val': 0.39652757107859105, 'auprc': 0.9397522978553725, 'loss_val': 0.9398707124080505, 'psi': 0.6138174617893036}
[S15] START round=9 head_norm_before_train=1.308214 cos_to_last_merge=0.8746 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.875
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.6908757534947085, 'auprc': 0.7749084425312871, 'loss_val': 0.7443302836431583, 'psi': 0.72448882910934}-{'f1_val': 0.696140808760891, 'auprc': 0.6588064545919934, 'loss_val': 0.34060945118334096, 'psi': 0.681207067093332}
[S16] START round=9 head_norm_before_train=0.913558 cos_to_last_merge=0.9801 (last merge round=6)
[S16] round=9 local utility u=0.050405 metrics={'f1_val': 0.3870499062789804, 'auprc': 0.6596944750326291, 'loss_val': 0.8358165161229555, 'psi': 0.49610773378043993}-{'f1_val': 0.38414206838313125, 'auprc': 0.6532471461813005, 'loss_val': 0.8998373266510273, 'psi': 0.491784099502399}
[S17] START round=9 head_norm_before_train=1.533992 (no previous merge yet)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.35439869680828473, 'auprc': 0.7558590293058702, 'loss_val': 0.8610780011081106, 'psi': 0.5149828298073189}-{'f1_val': 0.35277173603230394, 'auprc': 0.7838567333149495, 'loss_val': 0.9065205607960263, 'psi': 0.5252057349453622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:38409
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:38409
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:38411
[S5] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=-0.1163
[S7] DROPPED delta from S10 (cos=-0.1163 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] cosine check vs S16: cos=0.8963
[S16] RECEIVED delta(kind=head bytes=1795) from S8
[S16] cosine check vs S8: cos=0.2781
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] cosine check vs S13: cos=0.5004
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] cosine check vs S3: cos=0.4184
[S13] RECEIVED delta(kind=head bytes=1801) from S14
[S13] cosine check vs S14: cos=0.8578
[S10] RECEIVED delta(kind=head bytes=1795) from S11
[S10] cosine check vs S11: cos=0.9544
[S8] RECEIVED delta(kind=head bytes=1793) from S4
[S8] cosine check vs S4: cos=0.4480
[S8] RECEIVED delta(kind=head bytes=1796) from S7
[S8] cosine check vs S7: cos=0.7507
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=0.7006
[S3] RECEIVED delta(kind=head bytes=1802) from S5
[S3] cosine check vs S5: cos=0.6403
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.6429 head_norm=0.986743
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.905812e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.6440 head_norm=0.758989 delta_norm=0.490581
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3870 head_norm=0.959577
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.092394e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3865 head_norm=0.724662 delta_norm=0.409239
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3726 head_norm=0.763460
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.316086e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.3726 head_norm=0.692293 delta_norm=0.231609
[S8] aggregate: ACCEPT kept=['S4', 'S7'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.9526 head_norm=0.954851
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.179590e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.9533 head_norm=0.932072 delta_norm=0.217959
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.9955 head_norm=1.367492
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.147028e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.9951 head_norm=1.387098 delta_norm=0.214703
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.3492 head_norm=0.812284
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.114416e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.3974 head_norm=0.826537 delta_norm=0.111442
[S3] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.5806 head_norm=1.065315
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.550579e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.5876 head_norm=1.172398 delta_norm=0.355058
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.465671 cos_to_last_merge=0.8798 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.880
[S2] round=10 local utility u=0.023648 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.6845633953434308, 'loss_val': 0.28904708435276294, 'psi': 0.6947204478756799}-{'f1_val': 0.7014918162305126, 'auprc': 0.6672598484334216, 'loss_val': 0.2844326788621124, 'psi': 0.6877990291116762}
[S3] START round=10 head_norm_before_train=0.826537 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.451021 metrics={'f1_val': 0.39645225981545407, 'auprc': 0.946019983756862, 'loss_val': 0.9879324758299609, 'psi': 0.6162793493920173}-{'f1_val': 0.349229583455809, 'auprc': 0.7818902556589873, 'loss_val': 1.114248392536176, 'psi': 0.5222938523370804}
[S4] START round=10 head_norm_before_train=0.932072 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.013884 metrics={'f1_val': 0.9440401642522868, 'auprc': 0.9614860945105899, 'loss_val': 0.4675280859794067, 'psi': 0.951018536355608}-{'f1_val': 0.9526095754244436, 'auprc': 0.9536125146270693, 'loss_val': 0.5230927070644655, 'psi': 0.9530107511054938}
[S5] START round=10 head_norm_before_train=1.293674 (no previous merge yet)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.7009907355533597, 'auprc': 0.6441270336210159, 'loss_val': 0.7308012000522757, 'psi': 0.6782452547804221}-{'f1_val': 0.7157326608733922, 'auprc': 0.7775124098088244, 'loss_val': 0.8222289278388277, 'psi': 0.7404445604475651}
[S6] START round=10 head_norm_before_train=0.758989 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=1.000000 metrics={'f1_val': 0.9625205697182323, 'auprc': 0.9664694682853096, 'loss_val': 0.423125739283439, 'psi': 0.9641001291450633}-{'f1_val': 0.642931988866153, 'auprc': 0.812135826348298, 'loss_val': 0.5396285845774635, 'psi': 0.710613523859011}
[S7] START round=10 head_norm_before_train=0.915422 cos_to_last_merge=0.9722 (last merge round=5)
[S7] round=10 local utility u=0.070622 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7944124595584574, 'loss_val': 0.8958170000884353, 'psi': 0.5679128420848576}-{'f1_val': 0.41703542715461484, 'auprc': 0.7768024434726579, 'loss_val': 0.9849646008340195, 'psi': 0.560942233681832}
[S8] START round=10 head_norm_before_train=0.692293 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.002726 metrics={'f1_val': 0.3725978128855645, 'auprc': 0.9895859901028345, 'loss_val': 0.6835514314426616, 'psi': 0.6193930837724726}-{'f1_val': 0.3725978128855645, 'auprc': 0.9923654518591194, 'loss_val': 0.697341574811707, 'psi': 0.6205048684749865}
[S9] START round=10 head_norm_before_train=1.175028 cos_to_last_merge=0.9320 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.932
[S9] round=10 local utility u=0.054989 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9984432068580311, 'loss_val': 0.3324667116492932, 'psi': 0.8201515728677505}-{'f1_val': 0.7013646677191758, 'auprc': 0.9993547711700802, 'loss_val': 0.4456239140525574, 'psi': 0.8205607090995376}
[S10] START round=10 head_norm_before_train=1.387098 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.013289 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9974528941483648, 'loss_val': 0.2814739578873402, 'psi': 0.9960131649244502}-{'f1_val': 0.9954627014564918, 'auprc': 0.9975107398413121, 'loss_val': 0.3106813871601352, 'psi': 0.99628191681042}
[S11] START round=10 head_norm_before_train=1.438834 (no previous merge yet)
[S11] round=10 local utility u=0.072368 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9950884990376165, 'loss_val': 0.4366606641565064, 'psi': 0.8192358651825858}-{'f1_val': 0.701890640953942, 'auprc': 0.9945204932812303, 'loss_val': 0.5790311058523728, 'psi': 0.8189425818848574}
[S13] START round=10 head_norm_before_train=1.172398 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.125922 metrics={'f1_val': 0.5710119741714539, 'auprc': 0.6186348437517052, 'loss_val': 0.8750865265008612, 'psi': 0.5900611220035544}-{'f1_val': 0.5806326573064042, 'auprc': 0.5114021367062649, 'loss_val': 0.8629569959478361, 'psi': 0.5529404490663485}
[S14] START round=10 head_norm_before_train=1.366115 cos_to_last_merge=0.9971 (last merge round=8)
[S14] round=10 local utility u=0.098785 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9909524118960266, 'loss_val': 0.7715016757032124, 'psi': 0.6343172861446057}-{'f1_val': 0.39652757107859105, 'auprc': 0.9575641607068334, 'loss_val': 0.8687091693812861, 'psi': 0.620942206929888}
[S15] START round=10 head_norm_before_train=1.357057 cos_to_last_merge=0.8602 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.860
[S15] round=10 local utility u=0.775514 metrics={'f1_val': 0.8255526567649603, 'auprc': 0.8826150838537765, 'loss_val': 0.32448398707094783, 'psi': 0.8483776276004868}-{'f1_val': 0.6908757534947085, 'auprc': 0.7749084425312871, 'loss_val': 0.7443302836431583, 'psi': 0.72448882910934}
[S16] START round=10 head_norm_before_train=0.724662 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.018039 metrics={'f1_val': 0.3853334645035885, 'auprc': 0.6799142724643735, 'loss_val': 0.8500982930290959, 'psi': 0.5031657876879025}-{'f1_val': 0.3870499062789804, 'auprc': 0.6596944750326291, 'loss_val': 0.8358165161229555, 'psi': 0.49610773378043993}
[S17] START round=10 head_norm_before_train=1.560713 (no previous merge yet)
[S17] round=10 local utility u=0.059621 metrics={'f1_val': 0.38441176470588234, 'auprc': 0.7358884599778801, 'loss_val': 0.8620019683298308, 'psi': 0.5250024428146814}-{'f1_val': 0.35439869680828473, 'auprc': 0.7558590293058702, 'loss_val': 0.8610780011081106, 'psi': 0.5149828298073189}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:38411
[S11] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S4
[S8] cosine check vs S4: cos=0.5243
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=-0.1202
[S7] DROPPED delta from S10 (cos=-0.1202 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S6
[S7] cosine check vs S6: cos=-0.0005
[S7] DROPPED delta from S6 (cos=-0.0005 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] cosine check vs S15: cos=0.7491
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] cosine check vs S16: cos=0.8735
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] cosine check vs S8: cos=0.5654
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=0.5980
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] cosine check vs S3: cos=0.7032
[S13] RECEIVED delta(kind=head bytes=1801) from S14
[S13] cosine check vs S14: cos=0.9500
[S5] RECEIVED delta(kind=head bytes=1804) from S2
[S5] cosine check vs S2: cos=-0.0278
[S5] DROPPED delta from S2 (cos=-0.0278 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=0.6691
[S10] RECEIVED delta(kind=head bytes=1796) from S11
[S10] cosine check vs S11: cos=0.9698
[S8] RECEIVED delta(kind=head bytes=1796) from S7
[S8] cosine check vs S7: cos=0.7386
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=0.9533
[S5] ⇄ pheromone p=0.367 → S3@127.0.0.1:38403
[S2] ⇄ pheromone p=0.252 → S5@127.0.0.1:38405
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.9625 head_norm=0.867299
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.334294e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.9625 head_norm=0.798682 delta_norm=0.333429
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.511 → S7@127.0.0.1:38408
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.5710 head_norm=1.217784
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.259720e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.5708 head_norm=1.293206 delta_norm=0.225972
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.298 → S16@127.0.0.1:38416
[S9] ⇄ pheromone p=0.352 → S3@127.0.0.1:38403
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.3965 head_norm=0.863671
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.582637e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.3965 head_norm=0.960177 delta_norm=0.458264
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.319 → S6@127.0.0.1:38407
[S15] ⇄ pheromone p=0.413 → S7@127.0.0.1:38408
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.9440 head_norm=1.024326
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.566454e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.9451 head_norm=0.870272 delta_norm=0.256645
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.329 → S8@127.0.0.1:38409
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3853 head_norm=0.772812
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.571471e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3385 head_norm=0.719872 delta_norm=0.257147
[S16] aggregate: ROLLBACK (f1_val pre=0.385 post=0.338 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.211 → S4@127.0.0.1:38404
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.9951 head_norm=1.439561
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.824229e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.9951 head_norm=1.456045 delta_norm=0.182423
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.334 → S7@127.0.0.1:38408
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.3726 head_norm=0.781334
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.051890e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3739 head_norm=0.722770 delta_norm=0.205189
[S8] aggregate: ACCEPT kept=['S4', 'S7'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.166 → S16@127.0.0.1:38416
[S11] ⇄ pheromone p=0.417 → S10@127.0.0.1:38411
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4169 head_norm=0.937508
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.651382e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.5142 head_norm=1.093626 delta_norm=0.465138
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.229 → S8@127.0.0.1:38409
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.3966 head_norm=1.401390
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.469950e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.3966 head_norm=1.478691 delta_norm=0.246995
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.295 → S13@127.0.0.1:38413
[S17] ⇄ pheromone p=0.195 → S14@127.0.0.1:38414
[S2] START round=11 head_norm_before_train=1.501155 cos_to_last_merge=0.8748 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.875
[S2] round=11 local utility u=0.074983 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.7363231911715004, 'loss_val': 0.2943609489946464, 'psi': 0.7154243662069077}-{'f1_val': 0.7014918162305126, 'auprc': 0.6845633953434308, 'loss_val': 0.28904708435276294, 'psi': 0.6947204478756799}
[S3] START round=11 head_norm_before_train=0.960177 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.006766 metrics={'f1_val': 0.396483704974271, 'auprc': 0.9071603447110694, 'loss_val': 0.8580101449167882, 'psi': 0.6007543608689904}-{'f1_val': 0.39645225981545407, 'auprc': 0.946019983756862, 'loss_val': 0.9879324758299609, 'psi': 0.6162793493920173}
[S4] START round=11 head_norm_before_train=0.870272 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.006890 metrics={'f1_val': 0.9433427237478442, 'auprc': 0.9565920748155202, 'loss_val': 0.43488044496943007, 'psi': 0.9486424641749147}-{'f1_val': 0.9440401642522868, 'auprc': 0.9614860945105899, 'loss_val': 0.4675280859794067, 'psi': 0.951018536355608}
[S5] START round=11 head_norm_before_train=1.324690 (no previous merge yet)
[S5] round=11 local utility u=0.235578 metrics={'f1_val': 0.7146937595824697, 'auprc': 0.7761210540235579, 'loss_val': 0.7378448314507733, 'psi': 0.7392646773589051}-{'f1_val': 0.7009907355533597, 'auprc': 0.6441270336210159, 'loss_val': 0.7308012000522757, 'psi': 0.6782452547804221}
[S6] START round=11 head_norm_before_train=0.798682 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.959535659347832, 'auprc': 0.9638681088226619, 'loss_val': 0.46732320852728193, 'psi': 0.961268639137764}-{'f1_val': 0.9625205697182323, 'auprc': 0.9664694682853096, 'loss_val': 0.423125739283439, 'psi': 0.9641001291450633}
[S7] START round=11 head_norm_before_train=1.093626 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.41727946905461333, 'auprc': 0.7869239782580186, 'loss_val': 0.9519028725972136, 'psi': 0.5651372727359755}-{'f1_val': 0.4169130971024577, 'auprc': 0.7944124595584574, 'loss_val': 0.8958170000884353, 'psi': 0.5679128420848576}
[S8] START round=11 head_norm_before_train=0.722770 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.527038 metrics={'f1_val': 0.546131993244507, 'auprc': 0.9909112826219867, 'loss_val': 0.6746555285801077, 'psi': 0.724043708995499}-{'f1_val': 0.3725978128855645, 'auprc': 0.9895859901028345, 'loss_val': 0.6835514314426616, 'psi': 0.6193930837724726}
[S9] START round=11 head_norm_before_train=1.232056 cos_to_last_merge=0.9167 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.917
[S9] round=11 local utility u=0.027473 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982349860803633, 'loss_val': 0.2764528868888061, 'psi': 0.8200239428961564}-{'f1_val': 0.7012904835408967, 'auprc': 0.9984432068580311, 'loss_val': 0.3324667116492932, 'psi': 0.8201515728677505}
[S10] START round=11 head_norm_before_train=1.456045 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.020105 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9967892866820885, 'loss_val': 0.23927289673701416, 'psi': 0.9957477219379398}-{'f1_val': 0.9950533454418405, 'auprc': 0.9974528941483648, 'loss_val': 0.2814739578873402, 'psi': 0.9960131649244502}
[S11] START round=11 head_norm_before_train=1.494775 (no previous merge yet)
[S11] round=11 local utility u=0.052263 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9964091825598094, 'loss_val': 0.33609685332322653, 'psi': 0.8197641385914629}-{'f1_val': 0.7020007759458987, 'auprc': 0.9950884990376165, 'loss_val': 0.4366606641565064, 'psi': 0.8192358651825858}
[S13] START round=11 head_norm_before_train=1.293206 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.055863 metrics={'f1_val': 0.5983420015547489, 'auprc': 0.5887323762745925, 'loss_val': 0.8376341506989372, 'psi': 0.5944981514426864}-{'f1_val': 0.5710119741714539, 'auprc': 0.6186348437517052, 'loss_val': 0.8750865265008612, 'psi': 0.5900611220035544}
[S14] START round=11 head_norm_before_train=1.478691 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.022052 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.993838585424262, 'loss_val': 0.7360569137956217, 'psi': 0.6354717555558999}-{'f1_val': 0.39656053564365834, 'auprc': 0.9909524118960266, 'loss_val': 0.7715016757032124, 'psi': 0.6343172861446057}
[S15] START round=11 head_norm_before_train=1.394927 cos_to_last_merge=0.8499 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.850
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.6959181020356849, 'auprc': 0.7987607745377628, 'loss_val': 0.5366723927728353, 'psi': 0.7370551710365161}-{'f1_val': 0.8255526567649603, 'auprc': 0.8826150838537765, 'loss_val': 0.32448398707094783, 'psi': 0.8483776276004868}
[S16] START round=11 head_norm_before_train=0.719872 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.3453132482293319, 'auprc': 0.7038173828881901, 'loss_val': 0.8725227029100797, 'psi': 0.48871490209287516}-{'f1_val': 0.3853334645035885, 'auprc': 0.6799142724643735, 'loss_val': 0.8500982930290959, 'psi': 0.5031657876879025}
[S17] START round=11 head_norm_before_train=1.590967 (no previous merge yet)
[S17] round=11 local utility u=0.121736 metrics={'f1_val': 0.3909105021807206, 'auprc': 0.7799015727958164, 'loss_val': 0.7895626658066199, 'psi': 0.5465069304267589}-{'f1_val': 0.38441176470588234, 'auprc': 0.7358884599778801, 'loss_val': 0.8620019683298308, 'psi': 0.5250024428146814}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:38409
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38405
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=0.2835
[S13] RECEIVED delta(kind=head bytes=1806) from S14
[S13] cosine check vs S14: cos=0.9580
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=-0.0202
[S5] DROPPED delta from S2 (cos=-0.0202 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S11
[S10] cosine check vs S11: cos=0.9764
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=-0.1171
[S7] DROPPED delta from S10 (cos=-0.1171 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1792) from S4
[S8] cosine check vs S4: cos=0.6639
[S16] RECEIVED delta(kind=head bytes=1807) from S8
[S16] cosine check vs S8: cos=0.6699
[S6] RECEIVED delta(kind=head bytes=1803) from S3
[S6] cosine check vs S3: cos=0.7577
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=0.9243
[S16] RECEIVED delta(kind=head bytes=1794) from S13
[S16] cosine check vs S13: cos=0.7053
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=0.9803
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.9595 head_norm=0.892325
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.328143e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.9587 head_norm=0.886494 delta_norm=0.332814
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.9951 head_norm=1.516224
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.678874e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.9949 head_norm=1.525813 delta_norm=0.167887
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.5983 head_norm=1.340353
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.212976e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.5983 head_norm=1.407134 delta_norm=0.221298
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.3965 head_norm=0.998514
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.579070e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.3965 head_norm=0.922951 delta_norm=0.257907
[S3] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.3966 head_norm=1.503813
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.685009e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.3966 head_norm=1.560477 delta_norm=0.168501
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.5461 head_norm=0.793796
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.681633e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.6533 head_norm=0.801807 delta_norm=0.368163
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.3453 head_norm=0.766565
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.764292e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.5590 head_norm=0.772837 delta_norm=0.176429
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.529913 cos_to_last_merge=0.8691 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.869
[S2] round=12 local utility u=0.026114 metrics={'f1_val': 0.7073605576449813, 'auprc': 0.7448704314362565, 'loss_val': 0.30298746459491094, 'psi': 0.7223645071614914}-{'f1_val': 0.7014918162305126, 'auprc': 0.7363231911715004, 'loss_val': 0.2943609489946464, 'psi': 0.7154243662069077}
[S3] START round=12 head_norm_before_train=0.922951 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.181075 metrics={'f1_val': 0.39642092198300777, 'auprc': 0.9982239607363181, 'loss_val': 0.7686738223774667, 'psi': 0.6371421374843319}-{'f1_val': 0.396483704974271, 'auprc': 0.9071603447110694, 'loss_val': 0.8580101449167882, 'psi': 0.6007543608689904}
[S4] START round=12 head_norm_before_train=0.962687 cos_to_last_merge=0.9874 (last merge round=10)
[S4] round=12 local utility u=0.076546 metrics={'f1_val': 0.9444741587647983, 'auprc': 0.9716578683710699, 'loss_val': 0.33377381264233164, 'psi': 0.955347642607307}-{'f1_val': 0.9433427237478442, 'auprc': 0.9565920748155202, 'loss_val': 0.43488044496943007, 'psi': 0.9486424641749147}
[S5] START round=12 head_norm_before_train=1.356913 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.7009912934976192, 'auprc': 0.6440213146785408, 'loss_val': 0.6382434518028217, 'psi': 0.6782033019699879}-{'f1_val': 0.7146937595824697, 'auprc': 0.7761210540235579, 'loss_val': 0.7378448314507733, 'psi': 0.7392646773589051}
[S6] START round=12 head_norm_before_train=0.886494 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.038725 metrics={'f1_val': 0.9628915458528594, 'auprc': 0.9636417384949381, 'loss_val': 0.40932949882353364, 'psi': 0.9631916229096908}-{'f1_val': 0.959535659347832, 'auprc': 0.9638681088226619, 'loss_val': 0.46732320852728193, 'psi': 0.961268639137764}
[S7] START round=12 head_norm_before_train=1.111885 cos_to_last_merge=0.9979 (last merge round=10)
[S7] round=12 local utility u=0.034581 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7861742362220512, 'loss_val': 0.8770763206938337, 'psi': 0.5644957653554346}-{'f1_val': 0.41727946905461333, 'auprc': 0.7869239782580186, 'loss_val': 0.9519028725972136, 'psi': 0.5651372727359755}
[S8] START round=12 head_norm_before_train=0.801807 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.293131 metrics={'f1_val': 0.6436878547651987, 'auprc': 0.9886445926075259, 'loss_val': 0.6669277943821036, 'psi': 0.7816705499021297}-{'f1_val': 0.546131993244507, 'auprc': 0.9909112826219867, 'loss_val': 0.6746555285801077, 'psi': 0.724043708995499}
[S9] START round=12 head_norm_before_train=1.285512 cos_to_last_merge=0.9024 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.902
[S9] round=12 local utility u=0.029325 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9978792824380553, 'loss_val': 0.21673613309669965, 'psi': 0.8198816614392332}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982349860803633, 'loss_val': 0.2764528868888061, 'psi': 0.8200239428961564}
[S10] START round=12 head_norm_before_train=1.525813 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.019362 metrics={'f1_val': 0.994175185407767, 'auprc': 0.9972598583771743, 'loss_val': 0.19669165986145437, 'psi': 0.9954090545955299}-{'f1_val': 0.9950533454418405, 'auprc': 0.9967892866820885, 'loss_val': 0.23927289673701416, 'psi': 0.9957477219379398}
[S11] START round=12 head_norm_before_train=1.553592 (no previous merge yet)
[S11] round=12 local utility u=0.029202 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9962530879652591, 'loss_val': 0.27683129940174084, 'psi': 0.8196624251650957}-{'f1_val': 0.7020007759458987, 'auprc': 0.9964091825598094, 'loss_val': 0.33609685332322653, 'psi': 0.8197641385914629}
[S13] START round=12 head_norm_before_train=1.407134 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.5936554712041946, 'auprc': 0.5591950720694691, 'loss_val': 0.8374815845509915, 'psi': 0.5798713115503045}-{'f1_val': 0.5983420015547489, 'auprc': 0.5887323762745925, 'loss_val': 0.8376341506989372, 'psi': 0.5944981514426864}
[S14] START round=12 head_norm_before_train=1.560477 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.031210 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.9958051397606936, 'loss_val': 0.6797347707603925, 'psi': 0.6362782179330347}-{'f1_val': 0.39656053564365834, 'auprc': 0.993838585424262, 'loss_val': 0.7360569137956217, 'psi': 0.6354717555558999}
[S15] START round=12 head_norm_before_train=1.441174 cos_to_last_merge=0.8397 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.840
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.7019634771773248, 'auprc': 0.7978023493242877, 'loss_val': 0.5779327320201816, 'psi': 0.74029902603611}-{'f1_val': 0.6959181020356849, 'auprc': 0.7987607745377628, 'loss_val': 0.5366723927728353, 'psi': 0.7370551710365161}
[S16] START round=12 head_norm_before_train=0.772837 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=1.000000 metrics={'f1_val': 0.7545871935115752, 'auprc': 0.7511924164317383, 'loss_val': 0.893223771771311, 'psi': 0.7532292826796405}-{'f1_val': 0.3453132482293319, 'auprc': 0.7038173828881901, 'loss_val': 0.8725227029100797, 'psi': 0.48871490209287516}
[S17] START round=12 head_norm_before_train=1.632638 (no previous merge yet)
[S17] round=12 local utility u=0.558032 metrics={'f1_val': 0.5789243018120015, 'auprc': 0.7884598334127283, 'loss_val': 0.8272569791435548, 'psi': 0.6627385144522923}-{'f1_val': 0.3909105021807206, 'auprc': 0.7799015727958164, 'loss_val': 0.7895626658066199, 'psi': 0.5465069304267589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:38407
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:38416
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S8
[S16] cosine check vs S8: cos=0.7677
[S6] RECEIVED delta(kind=head bytes=1802) from S3
[S6] cosine check vs S3: cos=0.8851
[S7] RECEIVED delta(kind=head bytes=1804) from S10
[S7] cosine check vs S10: cos=-0.1227
[S7] DROPPED delta from S10 (cos=-0.1227 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1805) from S14
[S13] cosine check vs S14: cos=0.9696
[S5] RECEIVED delta(kind=head bytes=1803) from S2
[S5] cosine check vs S2: cos=-0.0155
[S5] DROPPED delta from S2 (cos=-0.0155 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S11
[S10] cosine check vs S11: cos=0.9807
[S8] RECEIVED delta(kind=head bytes=1797) from S7
[S8] cosine check vs S7: cos=0.4368
[S8] RECEIVED delta(kind=head bytes=1798) from S4
[S8] cosine check vs S4: cos=0.8747
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] cosine check vs S16: cos=0.7288
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=0.8189
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] cosine check vs S6: cos=0.0378
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=0.9876
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.5937 head_norm=1.451019
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.988572e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.5939 head_norm=1.506740 delta_norm=0.198857
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.7546 head_norm=0.821080
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.883667e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4277 head_norm=0.793279 delta_norm=0.288367
[S16] aggregate: ROLLBACK (f1_val pre=0.755 post=0.428 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.9942 head_norm=1.584178
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.571078e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.9937 head_norm=1.587047 delta_norm=0.157108
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.3966 head_norm=1.585612
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.380835e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.3966 head_norm=1.630429 delta_norm=0.138084
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.3964 head_norm=0.967616
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.872260e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.3964 head_norm=1.097999 delta_norm=0.387226
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.4167 head_norm=1.140602
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.365563e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.6573 head_norm=0.764599 delta_norm=0.736556
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.9445 head_norm=1.056496
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.625837e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.9507 head_norm=0.873906 delta_norm=0.362584
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.9629 head_norm=0.976360
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.329973e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.9622 head_norm=0.943659 delta_norm=0.232997
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.6437 head_norm=0.866441
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.333237e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.6548 head_norm=0.818935 delta_norm=0.233324
[S8] aggregate: ACCEPT kept=['S7', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.553226 cos_to_last_merge=0.8654 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.865
[S2] round=13 local utility u=0.486314 metrics={'f1_val': 0.8270324769014605, 'auprc': 0.8168418705934203, 'loss_val': 0.26430545311970605, 'psi': 0.8229562343782444}-{'f1_val': 0.7073605576449813, 'auprc': 0.7448704314362565, 'loss_val': 0.30298746459491094, 'psi': 0.7223645071614914}
[S3] START round=13 head_norm_before_train=1.097999 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.036537 metrics={'f1_val': 0.39642092198300777, 'auprc': 0.996719447292915, 'loss_val': 0.6910858996068565, 'psi': 0.6365403321069707}-{'f1_val': 0.39642092198300777, 'auprc': 0.9982239607363181, 'loss_val': 0.7686738223774667, 'psi': 0.6371421374843319}
[S4] START round=13 head_norm_before_train=0.873906 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.028557 metrics={'f1_val': 0.9564143767882127, 'auprc': 0.9800615591554488, 'loss_val': 0.373512010759883, 'psi': 0.9658732497351072}-{'f1_val': 0.9444741587647983, 'auprc': 0.9716578683710699, 'loss_val': 0.33377381264233164, 'psi': 0.955347642607307}
[S5] START round=13 head_norm_before_train=1.380644 (no previous merge yet)
[S5] round=13 local utility u=0.032978 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.6440788386178813, 'loss_val': 0.571412770351736, 'psi': 0.6781216507536667}-{'f1_val': 0.7009912934976192, 'auprc': 0.6440213146785408, 'loss_val': 0.6382434518028217, 'psi': 0.6782033019699879}
[S6] START round=13 head_norm_before_train=0.943659 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.4669235819688919, 'auprc': 0.7753041171856779, 'loss_val': 0.744111871971527, 'psi': 0.5902757960556063}-{'f1_val': 0.9628915458528594, 'auprc': 0.9636417384949381, 'loss_val': 0.40932949882353364, 'psi': 0.9631916229096908}
[S7] START round=13 head_norm_before_train=0.764599 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.41679099637737954, 'auprc': 0.7865174545111621, 'loss_val': 0.9540581251523625, 'psi': 0.5646815796308926}-{'f1_val': 0.41671011811102343, 'auprc': 0.7861742362220512, 'loss_val': 0.8770763206938337, 'psi': 0.5644957653554346}
[S8] START round=13 head_norm_before_train=0.818935 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.082618 metrics={'f1_val': 0.6535240347323994, 'auprc': 0.9901909111487446, 'loss_val': 0.5653468486060615, 'psi': 0.7881907852989375}-{'f1_val': 0.6436878547651987, 'auprc': 0.9886445926075259, 'loss_val': 0.6669277943821036, 'psi': 0.7816705499021297}
[S9] START round=13 head_norm_before_train=1.332220 cos_to_last_merge=0.8906 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.891
[S9] round=13 local utility u=0.003142 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981960309580173, 'loss_val': 0.21140320100081683, 'psi': 0.8200083608472181}-{'f1_val': 0.7012165807733519, 'auprc': 0.9978792824380553, 'loss_val': 0.21673613309669965, 'psi': 0.8198816614392332}
[S10] START round=13 head_norm_before_train=1.587047 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.003354 metrics={'f1_val': 0.9948336929542084, 'auprc': 0.9955386144666925, 'loss_val': 0.188770699122319, 'psi': 0.9951156615592021}-{'f1_val': 0.994175185407767, 'auprc': 0.9972598583771743, 'loss_val': 0.19669165986145437, 'psi': 0.9954090545955299}
[S11] START round=13 head_norm_before_train=1.605362 (no previous merge yet)
[S11] round=13 local utility u=0.018372 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9967063775385345, 'loss_val': 0.24144770656004944, 'psi': 0.8198437409944059}-{'f1_val': 0.7019353166316534, 'auprc': 0.9962530879652591, 'loss_val': 0.27683129940174084, 'psi': 0.8196624251650957}
[S13] START round=13 head_norm_before_train=1.506740 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.592417451386549, 'auprc': 0.5477566758173578, 'loss_val': 0.8793626470051187, 'psi': 0.5745531411588725}-{'f1_val': 0.5936554712041946, 'auprc': 0.5591950720694691, 'loss_val': 0.8374815845509915, 'psi': 0.5798713115503045}
[S14] START round=13 head_norm_before_train=1.630429 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.469512 metrics={'f1_val': 0.5406795916449861, 'auprc': 0.996599634943595, 'loss_val': 0.6076109976655375, 'psi': 0.7230476089644298}-{'f1_val': 0.39659360338126215, 'auprc': 0.9958051397606936, 'loss_val': 0.6797347707603925, 'psi': 0.6362782179330347}
[S15] START round=13 head_norm_before_train=1.486784 cos_to_last_merge=0.8310 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.831
[S15] round=13 local utility u=1.000000 metrics={'f1_val': 0.9918209161032032, 'auprc': 0.9924644162709743, 'loss_val': 0.11772512399241304, 'psi': 0.9920783161703117}-{'f1_val': 0.7019634771773248, 'auprc': 0.7978023493242877, 'loss_val': 0.5779327320201816, 'psi': 0.74029902603611}
[S16] START round=13 head_norm_before_train=0.793279 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.4654604251162535, 'auprc': 0.7550970777661666, 'loss_val': 0.8397542828275834, 'psi': 0.5813150861762189}-{'f1_val': 0.7545871935115752, 'auprc': 0.7511924164317383, 'loss_val': 0.893223771771311, 'psi': 0.7532292826796405}
[S17] START round=13 head_norm_before_train=1.685397 (no previous merge yet)
[S17] round=13 local utility u=0.016364 metrics={'f1_val': 0.599037446083228, 'auprc': 0.7633015250239916, 'loss_val': 0.8397334081028485, 'psi': 0.6647430776595333}-{'f1_val': 0.5789243018120015, 'auprc': 0.7884598334127283, 'loss_val': 0.8272569791435548, 'psi': 0.6627385144522923}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:38407
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] cosine check vs S8: cos=0.8982
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] cosine check vs S3: cos=0.8758
[S13] RECEIVED delta(kind=head bytes=1800) from S14
[S13] cosine check vs S14: cos=0.9773
[S3] RECEIVED delta(kind=head bytes=1793) from S5
[S3] cosine check vs S5: cos=0.2070
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] cosine check vs S2: cos=-0.0127
[S5] DROPPED delta from S2 (cos=-0.0127 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S11
[S10] cosine check vs S11: cos=0.9859
[S8] RECEIVED delta(kind=head bytes=1798) from S4
[S8] cosine check vs S4: cos=0.8247
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=0.9538
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=-0.1060
[S7] DROPPED delta from S10 (cos=-0.1060 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] cosine check vs S15: cos=0.7073
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=0.9909
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.4669 head_norm=1.027120
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.754439e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.4628 head_norm=1.049443 delta_norm=0.275444
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.4168 head_norm=0.790977
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.613866e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.4168 head_norm=1.083018 delta_norm=0.561387
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.5924 head_norm=1.557795
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.776721e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.5930 head_norm=1.596808 delta_norm=0.177672
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.9948 head_norm=1.630728
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.380473e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.9948 head_norm=1.634323 delta_norm=0.138047
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.6535 head_norm=0.901589
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.745125e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.6546 head_norm=0.882940 delta_norm=0.274512
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.5407 head_norm=1.654086
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.209681e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.4671 head_norm=1.690086 delta_norm=0.120968
[S14] aggregate: ROLLBACK (f1_val pre=0.541 post=0.467 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.3964 head_norm=1.139924
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.173245e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.3964 head_norm=1.006078 delta_norm=0.317325
[S3] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.4655 head_norm=0.853512
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.993305e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.4044 head_norm=0.854951 delta_norm=0.199330
[S16] aggregate: ROLLBACK (f1_val pre=0.465 post=0.404 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.573719 cos_to_last_merge=0.8619 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.862
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.834996546787159, 'auprc': 0.7786116578561665, 'loss_val': 0.306228239216826, 'psi': 0.8124425912147619}-{'f1_val': 0.8270324769014605, 'auprc': 0.8168418705934203, 'loss_val': 0.26430545311970605, 'psi': 0.8229562343782444}
[S3] START round=14 head_norm_before_train=1.006078 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.025663 metrics={'f1_val': 0.396483704974271, 'auprc': 0.9985088223291556, 'loss_val': 0.6455049517803079, 'psi': 0.6372937519162248}-{'f1_val': 0.39642092198300777, 'auprc': 0.996719447292915, 'loss_val': 0.6910858996068565, 'psi': 0.6365403321069707}
[S4] START round=14 head_norm_before_train=0.947110 cos_to_last_merge=0.9947 (last merge round=12)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.9434736555471578, 'auprc': 0.9666195985447875, 'loss_val': 0.32160937737337886, 'psi': 0.9527320327462097}-{'f1_val': 0.9564143767882127, 'auprc': 0.9800615591554488, 'loss_val': 0.373512010759883, 'psi': 0.9658732497351072}
[S5] START round=14 head_norm_before_train=1.399083 (no previous merge yet)
[S5] round=14 local utility u=0.138162 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.7187456871648698, 'loss_val': 0.5193268500392835, 'psi': 0.7080120684018745}-{'f1_val': 0.7008168588441903, 'auprc': 0.6440788386178813, 'loss_val': 0.571412770351736, 'psi': 0.6781216507536667}
[S6] START round=14 head_norm_before_train=1.049443 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=1.000000 metrics={'f1_val': 0.8939182473584066, 'auprc': 0.9608650531127874, 'loss_val': 0.4237710663732344, 'psi': 0.9206969696601589}-{'f1_val': 0.4669235819688919, 'auprc': 0.7753041171856779, 'loss_val': 0.744111871971527, 'psi': 0.5902757960556063}
[S7] START round=14 head_norm_before_train=1.083018 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.007835 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7767593258884906, 'loss_val': 0.9086275165365495, 'psi': 0.5607298012220103}-{'f1_val': 0.41679099637737954, 'auprc': 0.7865174545111621, 'loss_val': 0.9540581251523625, 'psi': 0.5646815796308926}
[S8] START round=14 head_norm_before_train=0.882940 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.047386 metrics={'f1_val': 0.6550634210237409, 'auprc': 0.9942255655080301, 'loss_val': 0.49191526524514406, 'psi': 0.7907282788174566}-{'f1_val': 0.6535240347323994, 'auprc': 0.9901909111487446, 'loss_val': 0.5653468486060615, 'psi': 0.7881907852989375}
[S9] START round=14 head_norm_before_train=1.373128 cos_to_last_merge=0.8811 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.881
[S9] round=14 local utility u=0.898457 metrics={'f1_val': 0.9903686845626269, 'auprc': 0.9982406732646185, 'loss_val': 0.14953573913308285, 'psi': 0.9935174800434237}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981960309580173, 'loss_val': 0.21140320100081683, 'psi': 0.8200083608472181}
[S10] START round=14 head_norm_before_train=1.634323 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.016946 metrics={'f1_val': 0.9932982145767046, 'auprc': 0.9977147366585555, 'loss_val': 0.15219501868648005, 'psi': 0.995064823409445}-{'f1_val': 0.9948336929542084, 'auprc': 0.9955386144666925, 'loss_val': 0.188770699122319, 'psi': 0.9951156615592021}
[S11] START round=14 head_norm_before_train=1.649504 (no previous merge yet)
[S11] round=14 local utility u=0.795727 metrics={'f1_val': 0.955923326508306, 'auprc': 0.9980780801845203, 'loss_val': 0.17803636098479117, 'psi': 0.9727852279787916}-{'f1_val': 0.7019353166316534, 'auprc': 0.9967063775385345, 'loss_val': 0.24144770656004944, 'psi': 0.8198437409944059}
[S13] START round=14 head_norm_before_train=1.596808 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.349800 metrics={'f1_val': 0.6192712335168796, 'auprc': 0.6633904538138882, 'loss_val': 0.6877863610714839, 'psi': 0.636918921635683}-{'f1_val': 0.592417451386549, 'auprc': 0.5477566758173578, 'loss_val': 0.8793626470051187, 'psi': 0.5745531411588725}
[S14] START round=14 head_norm_before_train=1.690086 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=1.000000 metrics={'f1_val': 0.935068859462215, 'auprc': 0.9968934669372684, 'loss_val': 0.5123068131642409, 'psi': 0.9597987024522363}-{'f1_val': 0.5406795916449861, 'auprc': 0.996599634943595, 'loss_val': 0.6076109976655375, 'psi': 0.7230476089644298}
[S15] START round=14 head_norm_before_train=1.533141 cos_to_last_merge=0.8227 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.823
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.7689817280685696, 'auprc': 0.8701865296076138, 'loss_val': 0.39606011334223634, 'psi': 0.8094636486841873}-{'f1_val': 0.9918209161032032, 'auprc': 0.9924644162709743, 'loss_val': 0.11772512399241304, 'psi': 0.9920783161703117}
[S16] START round=14 head_norm_before_train=0.854951 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.181570 metrics={'f1_val': 0.5103522369702992, 'auprc': 0.7581052929825299, 'loss_val': 0.7549907979839796, 'psi': 0.6094534593751915}-{'f1_val': 0.4654604251162535, 'auprc': 0.7550970777661666, 'loss_val': 0.8397542828275834, 'psi': 0.5813150861762189}
[S17] START round=14 head_norm_before_train=1.733796 (no previous merge yet)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.5741610983065818, 'auprc': 0.710465838935616, 'loss_val': 0.8309022962282514, 'psi': 0.6286829945581954}-{'f1_val': 0.599037446083228, 'auprc': 0.7633015250239916, 'loss_val': 0.8397334081028485, 'psi': 0.6647430776595333}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38408
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:38407
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:38413
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[S8] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S8
[S16] cosine check vs S8: cos=0.9835
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] cosine check vs S13: cos=0.2989
[S6] RECEIVED delta(kind=head bytes=1802) from S3
[S6] cosine check vs S3: cos=0.9406
[S13] RECEIVED delta(kind=head bytes=1802) from S14
[S13] cosine check vs S14: cos=0.9846
[S10] RECEIVED delta(kind=head bytes=1797) from S11
[S10] cosine check vs S11: cos=0.9861
[S8] RECEIVED delta(kind=head bytes=1801) from S7
[S8] cosine check vs S7: cos=0.4532
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=0.8584
[S3] RECEIVED delta(kind=head bytes=1795) from S5
[S3] cosine check vs S5: cos=0.4501
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=-0.1157
[S7] DROPPED delta from S10 (cos=-0.1157 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1804) from S6
[S7] cosine check vs S6: cos=0.2682
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] cosine check vs S16: cos=0.8969
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9435 head_norm=1.033872
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.288316e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.9450 head_norm=0.946070 delta_norm=0.228832
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.6193 head_norm=1.636889
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.518464e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.6195 head_norm=1.669229 delta_norm=0.151846
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.8939 head_norm=1.113012
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.889256e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.8768 head_norm=1.065323 delta_norm=0.188926
[S6] aggregate: ROLLBACK (f1_val pre=0.894 post=0.877 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.9933 head_norm=1.688017
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.405440e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.9933 head_norm=1.682070 delta_norm=0.140544
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.4167 head_norm=1.104891
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.708235e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.4167 head_norm=0.883055 delta_norm=0.670823
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.6551 head_norm=0.971199
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.457587e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.6551 head_norm=0.885525 delta_norm=0.545759
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.3965 head_norm=1.049960
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.765080e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.3965 head_norm=1.001348 delta_norm=0.176508
[S3] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.5104 head_norm=0.908808
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.003744e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.6233 head_norm=0.903678 delta_norm=0.400374
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.597382 cos_to_last_merge=0.8579 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.858
[S2] round=15 local utility u=0.100409 metrics={'f1_val': 0.8317779327057064, 'auprc': 0.8390811380115346, 'loss_val': 0.2675073519442438, 'psi': 0.8346992148280377}-{'f1_val': 0.834996546787159, 'auprc': 0.7786116578561665, 'loss_val': 0.306228239216826, 'psi': 0.8124425912147619}
[S3] START round=15 head_norm_before_train=1.001348 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.240346 metrics={'f1_val': 0.4736706103374636, 'auprc': 0.9985913535392004, 'loss_val': 0.6281810080817533, 'psi': 0.6836389076181584}-{'f1_val': 0.396483704974271, 'auprc': 0.9985088223291556, 'loss_val': 0.6455049517803079, 'psi': 0.6372937519162248}
[S4] START round=15 head_norm_before_train=0.946070 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.9424139297661448, 'auprc': 0.9653291952197582, 'loss_val': 0.31571140089177707, 'psi': 0.9515800359475901}-{'f1_val': 0.9434736555471578, 'auprc': 0.9666195985447875, 'loss_val': 0.32160937737337886, 'psi': 0.9527320327462097}
[S5] START round=15 head_norm_before_train=1.415772 (no previous merge yet)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.6693105113828334, 'loss_val': 0.4627478902456987, 'psi': 0.6882383746426526}-{'f1_val': 0.7008563225598777, 'auprc': 0.7187456871648698, 'loss_val': 0.5193268500392835, 'psi': 0.7080120684018745}
[S6] START round=15 head_norm_before_train=1.065323 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.8204355498950692, 'auprc': 0.9365335722474636, 'loss_val': 0.4949964587539233, 'psi': 0.8668747588360269}-{'f1_val': 0.8939182473584066, 'auprc': 0.9608650531127874, 'loss_val': 0.4237710663732344, 'psi': 0.9206969696601589}
[S7] START round=15 head_norm_before_train=0.883055 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7780755376917791, 'loss_val': 0.9533171665218575, 'psi': 0.5612562859433257}-{'f1_val': 0.41671011811102343, 'auprc': 0.7767593258884906, 'loss_val': 0.9086275165365495, 'psi': 0.5607298012220103}
[S8] START round=15 head_norm_before_train=0.885525 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=1.000000 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9947061203173808, 'loss_val': 0.4253160971745002, 'psi': 0.995694293088327}-{'f1_val': 0.6550634210237409, 'auprc': 0.9942255655080301, 'loss_val': 0.49191526524514406, 'psi': 0.7907282788174566}
[S9] START round=15 head_norm_before_train=1.413531 cos_to_last_merge=0.8731 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.873
[S9] round=15 local utility u=0.030066 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9984486316837651, 'loss_val': 0.1102687995631888, 'psi': 0.995624757667331}-{'f1_val': 0.9903686845626269, 'auprc': 0.9982406732646185, 'loss_val': 0.14953573913308285, 'psi': 0.9935174800434237}
[S10] START round=15 head_norm_before_train=1.682070 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.018831 metrics={'f1_val': 0.99393134655043, 'auprc': 0.9977443595184923, 'loss_val': 0.11842010107544046, 'psi': 0.9954565517376549}-{'f1_val': 0.9932982145767046, 'auprc': 0.9977147366585555, 'loss_val': 0.15219501868648005, 'psi': 0.995064823409445}
[S11] START round=15 head_norm_before_train=1.687845 (no previous merge yet)
[S11] round=15 local utility u=0.130701 metrics={'f1_val': 0.996960829744628, 'auprc': 0.99637519739062, 'loss_val': 0.15774984021672644, 'psi': 0.9967265768030247}-{'f1_val': 0.955923326508306, 'auprc': 0.9980780801845203, 'loss_val': 0.17803636098479117, 'psi': 0.9727852279787916}
[S13] START round=15 head_norm_before_train=1.669229 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6043045200117684, 'auprc': 0.5557016572236771, 'loss_val': 0.8017601110723129, 'psi': 0.5848633748965318}-{'f1_val': 0.6192712335168796, 'auprc': 0.6633904538138882, 'loss_val': 0.6877863610714839, 'psi': 0.636918921635683}
[S14] START round=15 head_norm_before_train=1.714455 cos_to_last_merge=0.9991 (last merge round=13)
[S14] round=15 local utility u=0.259928 metrics={'f1_val': 0.9977078681357447, 'auprc': 0.9969202131674992, 'loss_val': 0.3683656896803652, 'psi': 0.9973928061484465}-{'f1_val': 0.935068859462215, 'auprc': 0.9968934669372684, 'loss_val': 0.5123068131642409, 'psi': 0.9597987024522363}
[S15] START round=15 head_norm_before_train=1.581020 cos_to_last_merge=0.8150 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.815
[S15] round=15 local utility u=0.018795 metrics={'f1_val': 0.7706827724442711, 'auprc': 0.8692451583323331, 'loss_val': 0.36585151878117367, 'psi': 0.8101077267994958}-{'f1_val': 0.7689817280685696, 'auprc': 0.8701865296076138, 'loss_val': 0.39606011334223634, 'psi': 0.8094636486841873}
[S16] START round=15 head_norm_before_train=0.903678 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.116111 metrics={'f1_val': 0.5797737711443338, 'auprc': 0.7293581059737113, 'loss_val': 0.8530558581595388, 'psi': 0.6396075050760848}-{'f1_val': 0.5103522369702992, 'auprc': 0.7581052929825299, 'loss_val': 0.7549907979839796, 'psi': 0.6094534593751915}
[S17] START round=15 head_norm_before_train=1.779666 (no previous merge yet)
[S17] round=15 local utility u=0.561411 metrics={'f1_val': 0.615524730074128, 'auprc': 0.9170594197599303, 'loss_val': 0.576042726293069, 'psi': 0.7361386059484489}-{'f1_val': 0.5741610983065818, 'auprc': 0.710465838935616, 'loss_val': 0.8309022962282514, 'psi': 0.6286829945581954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S14] → sending delta(kind=head bytes=1809) to S13@127.0.0.1:38413
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:38411
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:38407
[S9] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1809 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] cosine check vs S8: cos=0.7323
[S6] RECEIVED delta(kind=head bytes=1802) from S3
[S6] cosine check vs S3: cos=0.9420
[S13] RECEIVED delta(kind=head bytes=1809) from S14
[S13] cosine check vs S14: cos=0.9919
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=-0.0041
[S5] DROPPED delta from S2 (cos=-0.0041 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S11
[S10] cosine check vs S11: cos=0.9863
[S3] RECEIVED delta(kind=head bytes=1805) from S9
[S3] cosine check vs S9: cos=0.7842
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=-0.0767
[S7] DROPPED delta from S10 (cos=-0.0767 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=0.6375
[S4] RECEIVED delta(kind=head bytes=1803) from S16
[S4] cosine check vs S16: cos=0.8919
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] cosine check vs S17: cos=0.9860
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.9424 head_norm=1.034771
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.344218e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.9434 head_norm=0.965624 delta_norm=0.234422
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.120 → S8@127.0.0.1:38409
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.4167 head_norm=0.903392
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.262577e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.4167 head_norm=1.150452 delta_norm=0.626258
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.080 → S8@127.0.0.1:38409
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.8204 head_norm=1.129392
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.897714e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.8190 head_norm=1.071723 delta_norm=0.189771
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.332 → S7@127.0.0.1:38408
[S5] ⇄ pheromone p=0.166 → S3@127.0.0.1:38403
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6043 head_norm=1.697673
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.115565e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6043 head_norm=1.716740 delta_norm=0.111556
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.158 → S16@127.0.0.1:38416
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.5798 head_norm=0.950798
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.522080e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.4553 head_norm=0.895627 delta_norm=0.352208
[S16] aggregate: ROLLBACK (f1_val pre=0.580 post=0.455 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.224 → S4@127.0.0.1:38404
[S9] ⇄ pheromone p=0.271 → S3@127.0.0.1:38403
[S8] ⇄ pheromone p=0.346 → S16@127.0.0.1:38416
[S2] ⇄ pheromone p=0.174 → S5@127.0.0.1:38405
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9977 head_norm=1.742753
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.543183e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9977 head_norm=1.775735 delta_norm=0.154318
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.374 → S13@127.0.0.1:38413
[S11] ⇄ pheromone p=0.300 → S10@127.0.0.1:38411
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.9939 head_norm=1.742184
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.439275e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.9937 head_norm=1.726460 delta_norm=0.143927
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.120 → S7@127.0.0.1:38408
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.4737 head_norm=1.045791
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.540478e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.3965 head_norm=1.183145 delta_norm=0.454048
[S3] aggregate: ROLLBACK (f1_val pre=0.474 post=0.396 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.180 → S6@127.0.0.1:38407
[S15] ⇄ pheromone p=0.267 → S7@127.0.0.1:38408
[S17] ⇄ pheromone p=0.246 → S14@127.0.0.1:38414
[S2] START round=16 head_norm_before_train=1.624725 cos_to_last_merge=0.8536 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.854
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.8431855334457895, 'auprc': 0.7937216880925674, 'loss_val': 0.32933933777349034, 'psi': 0.8233999953045006}-{'f1_val': 0.8317779327057064, 'auprc': 0.8390811380115346, 'loss_val': 0.2675073519442438, 'psi': 0.8346992148280377}
[S3] START round=16 head_norm_before_train=1.183145 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.732152 metrics={'f1_val': 0.7005685418741973, 'auprc': 0.9984302418391324, 'loss_val': 0.5247809454501812, 'psi': 0.8197132218601713}-{'f1_val': 0.4736706103374636, 'auprc': 0.9985913535392004, 'loss_val': 0.6281810080817533, 'psi': 0.6836389076181584}
[S4] START round=16 head_norm_before_train=0.965624 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.012489 metrics={'f1_val': 0.9432542558209052, 'auprc': 0.9714154967678281, 'loss_val': 0.3140340164176304, 'psi': 0.9545187521996743}-{'f1_val': 0.9424139297661448, 'auprc': 0.9653291952197582, 'loss_val': 0.31571140089177707, 'psi': 0.9515800359475901}
[S5] START round=16 head_norm_before_train=1.440890 (no previous merge yet)
[S5] round=16 local utility u=0.182146 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.7757490233765619, 'loss_val': 0.4162850092263634, 'psi': 0.7306650657540932}-{'f1_val': 0.7008569501491988, 'auprc': 0.6693105113828334, 'loss_val': 0.4627478902456987, 'psi': 0.6882383746426526}
[S6] START round=16 head_norm_before_train=1.071723 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.8223512274726547, 'auprc': 0.847517585567771, 'loss_val': 0.4683889541231533, 'psi': 0.8324177707107012}-{'f1_val': 0.8204355498950692, 'auprc': 0.9365335722474636, 'loss_val': 0.4949964587539233, 'psi': 0.8668747588360269}
[S7] START round=16 head_norm_before_train=1.150452 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.031606 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7737400360781856, 'loss_val': 0.8770994750507728, 'psi': 0.5595220852978884}-{'f1_val': 0.41671011811102343, 'auprc': 0.7780755376917791, 'loss_val': 0.9533171665218575, 'psi': 0.5612562859433257}
[S8] START round=16 head_norm_before_train=0.973847 cos_to_last_merge=0.9884 (last merge round=14)
[S8] round=16 local utility u=0.099559 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9970441307223966, 'loss_val': 0.23321117696717356, 'psi': 0.9966294972503333}-{'f1_val': 0.9963530749356245, 'auprc': 0.9947061203173808, 'loss_val': 0.4253160971745002, 'psi': 0.995694293088327}
[S9] START round=16 head_norm_before_train=1.455440 cos_to_last_merge=0.8658 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.866
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9886727075027679, 'auprc': 0.9984510227296082, 'loss_val': 0.09265518690670681, 'psi': 0.9925840335935041}-{'f1_val': 0.9937421749897083, 'auprc': 0.9984486316837651, 'loss_val': 0.1102687995631888, 'psi': 0.995624757667331}
[S10] START round=16 head_norm_before_train=1.726460 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.006254 metrics={'f1_val': 0.9935173467861318, 'auprc': 0.9967294543342258, 'loss_val': 0.10038280587209435, 'psi': 0.9948021898053694}-{'f1_val': 0.99393134655043, 'auprc': 0.9977443595184923, 'loss_val': 0.11842010107544046, 'psi': 0.9954565517376549}
[S11] START round=16 head_norm_before_train=1.722658 (no previous merge yet)
[S11] round=16 local utility u=0.013774 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9967189470040003, 'loss_val': 0.13020088365960783, 'psi': 0.9967608087072188}-{'f1_val': 0.996960829744628, 'auprc': 0.99637519739062, 'loss_val': 0.15774984021672644, 'psi': 0.9967265768030247}
[S13] START round=16 head_norm_before_train=1.716740 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.312225 metrics={'f1_val': 0.6219222848262774, 'auprc': 0.677158875955917, 'loss_val': 0.6473884688828819, 'psi': 0.6440169212781333}-{'f1_val': 0.6043045200117684, 'auprc': 0.5557016572236771, 'loss_val': 0.8017601110723129, 'psi': 0.5848633748965318}
[S14] START round=16 head_norm_before_train=1.775735 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.9926521142818703, 'auprc': 0.9971693588801189, 'loss_val': 0.34372142805916917, 'psi': 0.9944590121211697}-{'f1_val': 0.9977078681357447, 'auprc': 0.9969202131674992, 'loss_val': 0.3683656896803652, 'psi': 0.9973928061484465}
[S15] START round=16 head_norm_before_train=1.617208 cos_to_last_merge=0.8096 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.810
[S15] round=16 local utility u=0.893919 metrics={'f1_val': 0.9623961259189234, 'auprc': 0.9950656516520395, 'loss_val': 0.1057554912425497, 'psi': 0.9754639362121699}-{'f1_val': 0.7706827724442711, 'auprc': 0.8692451583323331, 'loss_val': 0.36585151878117367, 'psi': 0.8101077267994958}
[S16] START round=16 head_norm_before_train=0.895627 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.882130 metrics={'f1_val': 0.8224001249632853, 'auprc': 0.7839043788203903, 'loss_val': 0.7081935001112153, 'psi': 0.8070018265061273}-{'f1_val': 0.5797737711443338, 'auprc': 0.7293581059737113, 'loss_val': 0.8530558581595388, 'psi': 0.6396075050760848}
[S17] START round=16 head_norm_before_train=1.821238 (no previous merge yet)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.5870856504267667, 'auprc': 0.8678411496072804, 'loss_val': 0.764501377912154, 'psi': 0.6993878500989723}-{'f1_val': 0.615524730074128, 'auprc': 0.9170594197599303, 'loss_val': 0.576042726293069, 'psi': 0.7361386059484489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:38407
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:38404
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38416
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:38403
[S3] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=-0.1038
[S7] DROPPED delta from S10 (cos=-0.1038 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S3
[S6] cosine check vs S3: cos=0.9303
[S16] RECEIVED delta(kind=head bytes=1797) from S8
[S16] cosine check vs S8: cos=0.9186
[S10] RECEIVED delta(kind=head bytes=1791) from S11
[S10] cosine check vs S11: cos=0.9880
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] cosine check vs S16: cos=0.9208
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=0.7769
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=0.7535
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=0.2374
[S16] RECEIVED delta(kind=head bytes=1805) from S13
[S16] cosine check vs S13: cos=0.4054
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=0.9467
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.8224 head_norm=1.138709
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.234797e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.8227 head_norm=1.157784 delta_norm=0.223480
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.9433 head_norm=1.044437
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.039687e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9482 head_norm=0.972573 delta_norm=0.203969
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9964 head_norm=1.066702
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.069701e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9964 head_norm=0.973755 delta_norm=0.206970
[S8] aggregate: ACCEPT kept=['S7', 'S4'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.7006 head_norm=1.218259
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.369763e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.7007 head_norm=1.061362 delta_norm=0.836976
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.8224 head_norm=0.940296
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.364940e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.8177 head_norm=0.951663 delta_norm=0.336494
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.9935 head_norm=1.787065
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.380798e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.9935 head_norm=1.765422 delta_norm=0.138080
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.4167 head_norm=1.171974
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.289325e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.4167 head_norm=1.391816 delta_norm=0.328932
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.656443 cos_to_last_merge=0.8489 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.849
[S2] round=17 local utility u=0.056829 metrics={'f1_val': 0.832549463982728, 'auprc': 0.8442883318615197, 'loss_val': 0.30356567185275546, 'psi': 0.8372450111342447}-{'f1_val': 0.8431855334457895, 'auprc': 0.7937216880925674, 'loss_val': 0.32933933777349034, 'psi': 0.8233999953045006}
[S3] START round=17 head_norm_before_train=1.061362 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.693377602045257, 'auprc': 0.9992443906768201, 'loss_val': 0.5707362453943765, 'psi': 0.8157243174978823}-{'f1_val': 0.7005685418741973, 'auprc': 0.9984302418391324, 'loss_val': 0.5247809454501812, 'psi': 0.8197132218601713}
[S4] START round=17 head_norm_before_train=0.972573 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.004669 metrics={'f1_val': 0.9439368878641098, 'auprc': 0.97221782536295, 'loss_val': 0.31119899121411343, 'psi': 0.9552492628636458}-{'f1_val': 0.9432542558209052, 'auprc': 0.9714154967678281, 'loss_val': 0.3140340164176304, 'psi': 0.9545187521996743}
[S5] START round=17 head_norm_before_train=1.473052 (no previous merge yet)
[S5] round=17 local utility u=0.052244 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7948892741972442, 'loss_val': 0.36921320037790506, 'psi': 0.7383207452765023}-{'f1_val': 0.7006090940057808, 'auprc': 0.7757490233765619, 'loss_val': 0.4162850092263634, 'psi': 0.7306650657540932}
[S6] START round=17 head_norm_before_train=1.157784 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.7716380948540824, 'auprc': 0.8078368910149321, 'loss_val': 0.5570774501915282, 'psi': 0.7861176133184222}-{'f1_val': 0.8223512274726547, 'auprc': 0.847517585567771, 'loss_val': 0.4683889541231533, 'psi': 0.8324177707107012}
[S7] START round=17 head_norm_before_train=1.391816 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.599670 metrics={'f1_val': 0.6213582246955308, 'auprc': 0.7595873984855529, 'loss_val': 0.8631901798595049, 'psi': 0.6766498942115396}-{'f1_val': 0.41671011811102343, 'auprc': 0.7737400360781856, 'loss_val': 0.8770994750507728, 'psi': 0.5595220852978884}
[S8] START round=17 head_norm_before_train=0.973755 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9920842938635006, 'loss_val': 0.25026625330404156, 'psi': 0.9945555795854919}-{'f1_val': 0.9963530749356245, 'auprc': 0.9970441307223966, 'loss_val': 0.23321117696717356, 'psi': 0.9966294972503333}
[S9] START round=17 head_norm_before_train=1.496062 cos_to_last_merge=0.8593 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.859
[S9] round=17 local utility u=0.034535 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984466452690008, 'loss_val': 0.06649698204294521, 'psi': 0.9968746891261115}-{'f1_val': 0.9886727075027679, 'auprc': 0.9984510227296082, 'loss_val': 0.09265518690670681, 'psi': 0.9925840335935041}
[S10] START round=17 head_norm_before_train=1.765422 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.002344 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9943279535238465, 'loss_val': 0.09770644495098216, 'psi': 0.9947631886746429}-{'f1_val': 0.9935173467861318, 'auprc': 0.9967294543342258, 'loss_val': 0.10038280587209435, 'psi': 0.9948021898053694}
[S11] START round=17 head_norm_before_train=1.754411 (no previous merge yet)
[S11] round=17 local utility u=0.018466 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978515086250268, 'loss_val': 0.09376563970687804, 'psi': 0.9969237039313272}-{'f1_val': 0.9967887165093644, 'auprc': 0.9967189470040003, 'loss_val': 0.13020088365960783, 'psi': 0.9967608087072188}
[S13] START round=17 head_norm_before_train=1.740465 cos_to_last_merge=0.9994 (last merge round=15)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5880035877371402, 'auprc': 0.5357638373825035, 'loss_val': 0.9611347106236926, 'psi': 0.5671076875952856}-{'f1_val': 0.6219222848262774, 'auprc': 0.677158875955917, 'loss_val': 0.6473884688828819, 'psi': 0.6440169212781333}
[S14] START round=17 head_norm_before_train=1.802782 cos_to_last_merge=0.9994 (last merge round=15)
[S14] round=17 local utility u=0.070595 metrics={'f1_val': 0.997062983226801, 'auprc': 0.9969068979385085, 'loss_val': 0.2282097831160397, 'psi': 0.997000549111484}-{'f1_val': 0.9926521142818703, 'auprc': 0.9971693588801189, 'loss_val': 0.34372142805916917, 'psi': 0.9944590121211697}
[S15] START round=17 head_norm_before_train=1.648386 cos_to_last_merge=0.8056 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.806
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.7011792057493088, 'auprc': 0.7981293361716357, 'loss_val': 0.61434085191239, 'psi': 0.7399592579182396}-{'f1_val': 0.9623961259189234, 'auprc': 0.9950656516520395, 'loss_val': 0.1057554912425497, 'psi': 0.9754639362121699}
[S16] START round=17 head_norm_before_train=0.951663 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.084754 metrics={'f1_val': 0.8312656383446746, 'auprc': 0.8205415284365545, 'loss_val': 0.701790651128154, 'psi': 0.8269759943814265}-{'f1_val': 0.8224001249632853, 'auprc': 0.7839043788203903, 'loss_val': 0.7081935001112153, 'psi': 0.8070018265061273}
[S17] START round=17 head_norm_before_train=1.854525 (no previous merge yet)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.5991444821205504, 'auprc': 0.7816969697228016, 'loss_val': 1.0769592945543955, 'psi': 0.6721654771614509}-{'f1_val': 0.5870856504267667, 'auprc': 0.8678411496072804, 'loss_val': 0.764501377912154, 'psi': 0.6993878500989723}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:38411
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:38409
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:38409
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:38413
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=-0.1052
[S7] DROPPED delta from S10 (cos=-0.1052 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S14
[S13] cosine check vs S14: cos=0.9898
[S10] RECEIVED delta(kind=head bytes=1795) from S11
[S10] cosine check vs S11: cos=0.9904
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=0.0047
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=0.8670
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] cosine check vs S16: cos=0.8996
[S8] RECEIVED delta(kind=head bytes=1801) from S7
[S8] cosine check vs S7: cos=0.7639
[S3] RECEIVED delta(kind=head bytes=1795) from S5
[S3] cosine check vs S5: cos=0.8190
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=0.5296
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.5880 head_norm=1.771981
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.316219e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.5872 head_norm=1.796247 delta_norm=0.131622
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9962 head_norm=1.046759
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.705197e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9962 head_norm=1.034193 delta_norm=0.170520
[S8] aggregate: ACCEPT kept=['S4', 'S7'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.6934 head_norm=1.097504
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.367577e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.6926 head_norm=1.067144 delta_norm=0.136758
[S3] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.7006 head_norm=1.503630
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.125311e+00
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7006 head_norm=1.130629 delta_norm=1.125311
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9439 head_norm=1.051549
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.309497e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.9491 head_norm=0.998030 delta_norm=0.230950
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9951 head_norm=1.820591
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.260875e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9951 head_norm=1.797699 delta_norm=0.126087
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.681782 cos_to_last_merge=0.8447 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.845
[S2] round=18 local utility u=0.029438 metrics={'f1_val': 0.832549463982728, 'auprc': 0.8690177876611952, 'loss_val': 0.3188772385195314, 'psi': 0.847136793454115}-{'f1_val': 0.832549463982728, 'auprc': 0.8442883318615197, 'loss_val': 0.30356567185275546, 'psi': 0.8372450111342447}
[S3] START round=18 head_norm_before_train=1.067144 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.040249 metrics={'f1_val': 0.7010863553524592, 'auprc': 0.9988725522853158, 'loss_val': 0.5353759779875589, 'psi': 0.820200834125602}-{'f1_val': 0.693377602045257, 'auprc': 0.9992443906768201, 'loss_val': 0.5707362453943765, 'psi': 0.8157243174978823}
[S4] START round=18 head_norm_before_train=0.998030 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.002908 metrics={'f1_val': 0.9491653780843848, 'auprc': 0.9665256741478003, 'loss_val': 0.3196767789632615, 'psi': 0.9561094965097511}-{'f1_val': 0.9439368878641098, 'auprc': 0.97221782536295, 'loss_val': 0.31119899121411343, 'psi': 0.9552492628636458}
[S5] START round=18 head_norm_before_train=1.130629 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7003192476127398, 'auprc': 0.7932983984882767, 'loss_val': 0.5153941192531601, 'psi': 0.7375109079629545}-{'f1_val': 0.7006083926626743, 'auprc': 0.7948892741972442, 'loss_val': 0.36921320037790506, 'psi': 0.7383207452765023}
[S6] START round=18 head_norm_before_train=1.221133 cos_to_last_merge=0.9949 (last merge round=16)
[S6] round=18 local utility u=0.231977 metrics={'f1_val': 0.769918855731432, 'auprc': 0.9510606763204514, 'loss_val': 0.512480362500059, 'psi': 0.8423755839670398}-{'f1_val': 0.7716380948540824, 'auprc': 0.8078368910149321, 'loss_val': 0.5570774501915282, 'psi': 0.7861176133184222}
[S7] START round=18 head_norm_before_train=1.408884 cos_to_last_merge=0.9990 (last merge round=16)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5714920478693996, 'auprc': 0.8203114540248175, 'loss_val': 0.8322622073801105, 'psi': 0.6710198103315668}-{'f1_val': 0.6213582246955308, 'auprc': 0.7595873984855529, 'loss_val': 0.8631901798595049, 'psi': 0.6766498942115396}
[S8] START round=18 head_norm_before_train=1.034193 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.7142166427160836, 'auprc': 0.9878566111589214, 'loss_val': 0.366747999643728, 'psi': 0.8236726300932188}-{'f1_val': 0.9962031034001528, 'auprc': 0.9920842938635006, 'loss_val': 0.25026625330404156, 'psi': 0.9945555795854919}
[S9] START round=18 head_norm_before_train=1.528825 cos_to_last_merge=0.8542 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.854
[S9] round=18 local utility u=0.003943 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9961830672090992, 'loss_val': 0.056822086777187496, 'psi': 0.9964695339719746}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984466452690008, 'loss_val': 0.06649698204294521, 'psi': 0.9968746891261115}
[S10] START round=18 head_norm_before_train=1.797699 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.014392 metrics={'f1_val': 0.9950288014007544, 'auprc': 0.9979126463280712, 'loss_val': 0.07953018000642968, 'psi': 0.9961823393716812}-{'f1_val': 0.9950533454418405, 'auprc': 0.9943279535238465, 'loss_val': 0.09770644495098216, 'psi': 0.9947631886746429}
[S11] START round=18 head_norm_before_train=1.783448 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.9769543110331391, 'auprc': 0.9967538234705091, 'loss_val': 0.1489733187176548, 'psi': 0.9848741160080872}-{'f1_val': 0.996305167468861, 'auprc': 0.9978515086250268, 'loss_val': 0.09376563970687804, 'psi': 0.9969237039313272}
[S13] START round=18 head_norm_before_train=1.796247 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.227450 metrics={'f1_val': 0.5937341873962585, 'auprc': 0.6251387930384735, 'loss_val': 0.8087430290975705, 'psi': 0.6062960296531446}-{'f1_val': 0.5880035877371402, 'auprc': 0.5357638373825035, 'loss_val': 0.9611347106236926, 'psi': 0.5671076875952856}
[S14] START round=18 head_norm_before_train=1.829684 cos_to_last_merge=0.9977 (last merge round=15)
[S14] round=18 local utility u=0.026140 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9989178325699776, 'loss_val': 0.18158888075771462, 'psi': 0.9977675609565377}-{'f1_val': 0.997062983226801, 'auprc': 0.9969068979385085, 'loss_val': 0.2282097831160397, 'psi': 0.997000549111484}
[S15] START round=18 head_norm_before_train=1.680391 cos_to_last_merge=0.8020 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.802
[S15] round=18 local utility u=1.000000 metrics={'f1_val': 0.8930144828268114, 'auprc': 0.9901187421694992, 'loss_val': 0.16289559407445112, 'psi': 0.9318561865638866}-{'f1_val': 0.7011792057493088, 'auprc': 0.7981293361716357, 'loss_val': 0.61434085191239, 'psi': 0.7399592579182396}
[S16] START round=18 head_norm_before_train=0.996517 cos_to_last_merge=0.9979 (last merge round=16)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.7864034063029608, 'auprc': 0.8578601152908504, 'loss_val': 0.5870012140440749, 'psi': 0.8149860898981167}-{'f1_val': 0.8312656383446746, 'auprc': 0.8205415284365545, 'loss_val': 0.701790651128154, 'psi': 0.8269759943814265}
[S17] START round=18 head_norm_before_train=1.887318 (no previous merge yet)
[S17] round=18 local utility u=0.206034 metrics={'f1_val': 0.597129358328226, 'auprc': 0.8829358885373683, 'loss_val': 0.9565170990726342, 'psi': 0.7114519704118829}-{'f1_val': 0.5991444821205504, 'auprc': 0.7816969697228016, 'loss_val': 1.0769592945543955, 'psi': 0.6721654771614509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38405
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] cosine check vs S2: cos=0.7290
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38408
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=-0.1065
[S7] DROPPED delta from S10 (cos=-0.1065 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:38413
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=0.6225
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=0.1971
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] cosine check vs S3: cos=0.8457
[S14] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S14
[S13] cosine check vs S14: cos=0.9947
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:38416
[S13] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:38409
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1805) from S13
[S16] cosine check vs S13: cos=0.6582
[S4] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] cosine check vs S4: cos=0.8492
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[S15] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] cosine check vs S15: cos=0.9827
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:38414
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=0.9827
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.7142 head_norm=1.102831
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.987970e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.7142 head_norm=1.044866 delta_norm=0.298797
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7003 head_norm=1.165874
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.845287e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.5318 head_norm=1.337907 delta_norm=0.584529
[S5] aggregate: ROLLBACK (f1_val pre=0.700 post=0.532 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9970 head_norm=1.855431
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.776714e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9970 head_norm=1.877134 delta_norm=0.177671
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.5937 head_norm=1.822380
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.628592e-02
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.6033 head_norm=1.836457 delta_norm=0.096286
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.7699 head_norm=1.289175
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.440215e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.7684 head_norm=1.147510 delta_norm=0.344021
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.7011 head_norm=1.099220
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.135232e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.7008 head_norm=1.201376 delta_norm=0.613523
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.7864 head_norm=1.045661
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.902771e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.8494 head_norm=1.315582 delta_norm=0.690277
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.5715 head_norm=1.424365
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.579766e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.4344 head_norm=1.226511 delta_norm=0.357977
[S7] aggregate: ROLLBACK (f1_val pre=0.571 post=0.434 tol_abs=0.005 tol_rel=0.0)
[S2] START round=19 head_norm_before_train=1.704134 cos_to_last_merge=0.8403 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.840
[S2] round=19 local utility u=0.022597 metrics={'f1_val': 0.8270916486870554, 'auprc': 0.9156393636908083, 'loss_val': 0.3808018289366549, 'psi': 0.8625107346885565}-{'f1_val': 0.832549463982728, 'auprc': 0.8690177876611952, 'loss_val': 0.3188772385195314, 'psi': 0.847136793454115}
[S3] START round=19 head_norm_before_train=1.201376 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.043198 metrics={'f1_val': 0.7005769689796157, 'auprc': 0.999247357677966, 'loss_val': 0.44704819743054447, 'psi': 0.8200451244589558}-{'f1_val': 0.7010863553524592, 'auprc': 0.9988725522853158, 'loss_val': 0.5353759779875589, 'psi': 0.820200834125602}
[S4] START round=19 head_norm_before_train=1.070428 cos_to_last_merge=0.9946 (last merge round=17)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9423604400408934, 'auprc': 0.964218524909896, 'loss_val': 0.2960896081297963, 'psi': 0.9511036739884945}-{'f1_val': 0.9491653780843848, 'auprc': 0.9665256741478003, 'loss_val': 0.3196767789632615, 'psi': 0.9561094965097511}
[S5] START round=19 head_norm_before_train=1.337907 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7007401782914919, 'auprc': 0.7020228040446604, 'loss_val': 0.5999002952860021, 'psi': 0.7012532285927593}-{'f1_val': 0.7003192476127398, 'auprc': 0.7932983984882767, 'loss_val': 0.5153941192531601, 'psi': 0.7375109079629545}
[S6] START round=19 head_norm_before_train=1.147510 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.282204 metrics={'f1_val': 0.8302643030174017, 'auprc': 0.9682118724354678, 'loss_val': 0.36159861144167404, 'psi': 0.8854433307846281}-{'f1_val': 0.769918855731432, 'auprc': 0.9510606763204514, 'loss_val': 0.512480362500059, 'psi': 0.8423755839670398}
[S7] START round=19 head_norm_before_train=1.226511 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7808924197176002, 'loss_val': 0.8190865130750706, 'psi': 0.5623830387536541}-{'f1_val': 0.5714920478693996, 'auprc': 0.8203114540248175, 'loss_val': 0.8322622073801105, 'psi': 0.6710198103315668}
[S8] START round=19 head_norm_before_train=1.044866 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.924868 metrics={'f1_val': 0.9950790219939822, 'auprc': 0.9903656523230068, 'loss_val': 0.20971357072423885, 'psi': 0.993193674125592}-{'f1_val': 0.7142166427160836, 'auprc': 0.9878566111589214, 'loss_val': 0.366747999643728, 'psi': 0.8236726300932188}
[S9] START round=19 head_norm_before_train=1.559213 cos_to_last_merge=0.8501 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.850
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9984884078794601, 'loss_val': 0.04958578400874307, 'psi': 0.9957412274874557}-{'f1_val': 0.9966605118138915, 'auprc': 0.9961830672090992, 'loss_val': 0.056822086777187496, 'psi': 0.9964695339719746}
[S10] START round=19 head_norm_before_train=1.845990 cos_to_last_merge=0.9985 (last merge round=17)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9926412559977399, 'auprc': 0.9967248102055253, 'loss_val': 0.071224014858377, 'psi': 0.9942746776808541}-{'f1_val': 0.9950288014007544, 'auprc': 0.9979126463280712, 'loss_val': 0.07953018000642968, 'psi': 0.9961823393716812}
[S11] START round=19 head_norm_before_train=1.806503 (no previous merge yet)
[S11] round=19 local utility u=0.094596 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9971372033336523, 'loss_val': 0.07703615608261387, 'psi': 0.9966379818147775}-{'f1_val': 0.9769543110331391, 'auprc': 0.9967538234705091, 'loss_val': 0.1489733187176548, 'psi': 0.9848741160080872}
[S13] START round=19 head_norm_before_train=1.836457 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.041032 metrics={'f1_val': 0.5983823403401307, 'auprc': 0.6277524628899691, 'loss_val': 0.7624095469753456, 'psi': 0.610130389360066}-{'f1_val': 0.5937341873962585, 'auprc': 0.6251387930384735, 'loss_val': 0.8087430290975705, 'psi': 0.6062960296531446}
[S14] START round=19 head_norm_before_train=1.877134 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.010377 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9987628750947972, 'loss_val': 0.16037002125208177, 'psi': 0.9977055779664656}-{'f1_val': 0.9970007132142444, 'auprc': 0.9989178325699776, 'loss_val': 0.18158888075771462, 'psi': 0.9977675609565377}
[S15] START round=19 head_norm_before_train=1.707808 cos_to_last_merge=0.7990 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.799
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.7745562998763835, 'auprc': 0.9231375536719055, 'loss_val': 0.3719532619007591, 'psi': 0.8339888013945923}-{'f1_val': 0.8930144828268114, 'auprc': 0.9901187421694992, 'loss_val': 0.16289559407445112, 'psi': 0.9318561865638866}
[S16] START round=19 head_norm_before_train=1.315582 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.164921 metrics={'f1_val': 0.8306167798390561, 'auprc': 0.9307399545244368, 'loss_val': 0.7410784694783127, 'psi': 0.8706660497132084}-{'f1_val': 0.7864034063029608, 'auprc': 0.8578601152908504, 'loss_val': 0.5870012140440749, 'psi': 0.8149860898981167}
[S17] START round=19 head_norm_before_train=1.915143 (no previous merge yet)
[S17] round=19 local utility u=0.101429 metrics={'f1_val': 0.5906662994597763, 'auprc': 0.9484755343410983, 'loss_val': 0.9114992336002631, 'psi': 0.7337899934123051}-{'f1_val': 0.597129358328226, 'auprc': 0.8829358885373683, 'loss_val': 0.9565170990726342, 'psi': 0.7114519704118829}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38416
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:38407
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=0.9366
[S10] RECEIVED delta(kind=head bytes=1798) from S11
[S10] cosine check vs S11: cos=0.9863
[S4] RECEIVED delta(kind=head bytes=1804) from S16
[S4] cosine check vs S16: cos=0.7183
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] cosine check vs S6: cos=0.4159
[S16] RECEIVED delta(kind=head bytes=1791) from S8
[S16] cosine check vs S8: cos=0.6161
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] cosine check vs S13: cos=0.9397
[S13] RECEIVED delta(kind=head bytes=1801) from S14
[S13] cosine check vs S14: cos=0.9948
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] cosine check vs S3: cos=0.9356
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=0.9927
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.7007 head_norm=1.369492
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.275759e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.5038 head_norm=1.524799 delta_norm=0.327576
[S5] aggregate: ROLLBACK (f1_val pre=0.701 post=0.504 tol_abs=0.005 tol_rel=0.0)
[S5] r=20 psi=0.701 u=0.0000 p_local=0.0933 f1=0.701 auprc=0.702 bytes=19765
[S9] r=20 psi=0.996 u=0.0000 p_local=0.1160 f1=0.994 auprc=0.998 bytes=26971
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.4167 head_norm=1.242058
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.619043e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.4167 head_norm=1.030368 delta_norm=0.661904
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.562 u=0.0000 p_local=0.1127 f1=0.417 auprc=0.781 bytes=19759
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9424 head_norm=1.137677
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.769190e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9491 head_norm=1.153320 delta_norm=0.476919
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.951 u=0.0000 p_local=0.0514 f1=0.942 auprc=0.964 bytes=23366
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9926 head_norm=1.890890
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.571425e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9928 head_norm=1.852476 delta_norm=0.157142
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.994 u=0.0000 p_local=0.0524 f1=0.993 auprc=0.997 bytes=26984
[S11] r=20 psi=0.997 u=0.0946 p_local=0.1455 f1=0.996 auprc=0.997 bytes=26938
[S8] r=20 psi=0.993 u=0.9249 p_local=0.3368 f1=0.995 auprc=0.990 bytes=23368
[S3] r=20 psi=0.820 u=0.0432 p_local=0.1639 f1=0.701 auprc=0.999 bytes=23380
[S2] r=20 psi=0.863 u=0.0226 p_local=0.0877 f1=0.827 auprc=0.916 bytes=21586
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.8303 head_norm=1.206997
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.191160e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.8248 head_norm=1.199303 delta_norm=0.219116
[S6] aggregate: ROLLBACK (f1_val pre=0.830 post=0.825 tol_abs=0.005 tol_rel=0.0)
[S6] r=20 psi=0.885 u=0.2822 p_local=0.2293 f1=0.830 auprc=0.968 bytes=16181
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9970 head_norm=1.904983
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.175235e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9970 head_norm=1.920018 delta_norm=0.117524
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.998 u=0.0104 p_local=0.1684 f1=0.997 auprc=0.999 bytes=25210
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.8306 head_norm=1.349403
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.183152e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.8297 head_norm=1.284839 delta_norm=0.118315
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S16] r=20 psi=0.871 u=0.1649 p_local=0.2258 f1=0.831 auprc=0.931 bytes=25154
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.5984 head_norm=1.854232
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.883386e-02
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.6040 head_norm=1.877179 delta_norm=0.098834
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.610 u=0.0410 p_local=0.1413 f1=0.598 auprc=0.628 bytes=18004
[S15] r=20 psi=0.834 u=0.0000 p_local=0.3610 f1=0.775 auprc=0.923 bytes=14396
[S17] r=20 psi=0.734 u=0.1014 p_local=0.1538 f1=0.591 auprc=0.948 bytes=18009
[S2] START round=20 head_norm_before_train=1.728909 cos_to_last_merge=0.8362 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.836
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.829180439650694, 'auprc': 0.8724948189402788, 'loss_val': 0.3945284477131788, 'psi': 0.8465061913665279}-{'f1_val': 0.8270916486870554, 'auprc': 0.9156393636908083, 'loss_val': 0.3808018289366549, 'psi': 0.8625107346885565}
[S3] START round=20 head_norm_before_train=1.231193 cos_to_last_merge=0.9993 (last merge round=18)
[S3] round=20 local utility u=0.020281 metrics={'f1_val': 0.7003264167718803, 'auprc': 0.9996217853692158, 'loss_val': 0.4061071125792446, 'psi': 0.8200445642108145}-{'f1_val': 0.7005769689796157, 'auprc': 0.999247357677966, 'loss_val': 0.44704819743054447, 'psi': 0.8200451244589558}
[S4] START round=20 head_norm_before_train=1.153320 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.941887676277767, 'auprc': 0.9508612856168009, 'loss_val': 0.34996129264951387, 'psi': 0.9454771200133807}-{'f1_val': 0.9423604400408934, 'auprc': 0.964218524909896, 'loss_val': 0.2960896081297963, 'psi': 0.9511036739884945}
[S5] START round=20 head_norm_before_train=1.524799 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.661266279836998, 'loss_val': 0.5413249833796331, 'psi': 0.6847506577633602}-{'f1_val': 0.7007401782914919, 'auprc': 0.7020228040446604, 'loss_val': 0.5999002952860021, 'psi': 0.7012532285927593}
[S6] START round=20 head_norm_before_train=1.199303 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.733538710274184, 'auprc': 0.797887795213892, 'loss_val': 0.5875684481472202, 'psi': 0.7592783442500672}-{'f1_val': 0.8302643030174017, 'auprc': 0.9682118724354678, 'loss_val': 0.36159861144167404, 'psi': 0.8854433307846281}
[S7] START round=20 head_norm_before_train=1.030368 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.787095186019386, 'loss_val': 0.881982391037795, 'psi': 0.5648641452743685}-{'f1_val': 0.41671011811102343, 'auprc': 0.7808924197176002, 'loss_val': 0.8190865130750706, 'psi': 0.5623830387536541}
[S8] START round=20 head_norm_before_train=1.109662 cos_to_last_merge=0.9970 (last merge round=18)
[S8] round=20 local utility u=0.045028 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.99505582282299, 'loss_val': 0.14219059696230518, 'psi': 0.995915994690601}-{'f1_val': 0.9950790219939822, 'auprc': 0.9903656523230068, 'loss_val': 0.20971357072423885, 'psi': 0.993193674125592}
[S9] START round=20 head_norm_before_train=1.585923 cos_to_last_merge=0.8469 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.847
[S9] round=20 local utility u=0.000990 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9984785268010232, 'loss_val': 0.045068062493923026, 'psi': 0.9954865200262318}-{'f1_val': 0.993909773892786, 'auprc': 0.9984884078794601, 'loss_val': 0.04958578400874307, 'psi': 0.9957412274874557}
[S10] START round=20 head_norm_before_train=1.852476 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.008423 metrics={'f1_val': 0.9948336929542084, 'auprc': 0.9977376546603368, 'loss_val': 0.07057188799463576, 'psi': 0.9959952776366598}-{'f1_val': 0.9926412559977399, 'auprc': 0.9967248102055253, 'loss_val': 0.071224014858377, 'psi': 0.9942746776808541}
[S11] START round=20 head_norm_before_train=1.826817 (no previous merge yet)
[S11] round=20 local utility u=0.007035 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976394616122376, 'loss_val': 0.06592374763000473, 'psi': 0.9969839873530488}-{'f1_val': 0.996305167468861, 'auprc': 0.9971372033336523, 'loss_val': 0.07703615608261387, 'psi': 0.9966379818147775}
[S13] START round=20 head_norm_before_train=1.877179 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5500087454631624, 'auprc': 0.5334506459014864, 'loss_val': 1.0531032528706747, 'psi': 0.543385505638492}-{'f1_val': 0.5983823403401307, 'auprc': 0.6277524628899691, 'loss_val': 0.7624095469753456, 'psi': 0.610130389360066}
[S14] START round=20 head_norm_before_train=1.920018 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.9991506757863159, 'loss_val': 0.15983655822920403, 'psi': 0.9976262782801808}-{'f1_val': 0.9970007132142444, 'auprc': 0.9987628750947972, 'loss_val': 0.16037002125208177, 'psi': 0.9977055779664656}
[S15] START round=20 head_norm_before_train=1.733974 cos_to_last_merge=0.7962 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.796
[S15] round=20 local utility u=0.591357 metrics={'f1_val': 0.900148233924709, 'auprc': 0.99105892387807, 'loss_val': 0.14655461609066855, 'psi': 0.9365125099060534}-{'f1_val': 0.7745562998763835, 'auprc': 0.9231375536719055, 'loss_val': 0.3719532619007591, 'psi': 0.8339888013945923}
[S16] START round=20 head_norm_before_train=1.284839 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.486940 metrics={'f1_val': 0.9354653923479762, 'auprc': 0.932873599154314, 'loss_val': 0.402691913407307, 'psi': 0.9344286750705113}-{'f1_val': 0.8306167798390561, 'auprc': 0.9307399545244368, 'loss_val': 0.7410784694783127, 'psi': 0.8706660497132084}
[S17] START round=20 head_norm_before_train=1.942061 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.5792059830547673, 'auprc': 0.7802029295103463, 'loss_val': 1.0710356338828035, 'psi': 0.6596047616369989}-{'f1_val': 0.5906662994597763, 'auprc': 0.9484755343410983, 'loss_val': 0.9114992336002631, 'psi': 0.7337899934123051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:38416
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:38408
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:38407
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1793) from S10
[S7] cosine check vs S10: cos=-0.0564
[S7] DROPPED delta from S10 (cos=-0.0564 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=0.9230
[S16] RECEIVED delta(kind=head bytes=1796) from S8
[S16] cosine check vs S8: cos=0.6636
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] cosine check vs S3: cos=0.9723
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:38411
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=0.6327
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] cosine check vs S16: cos=0.9414
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S11
[S10] cosine check vs S11: cos=0.9928
[S2] ⇄ pheromone p=0.070 → S5@127.0.0.1:38405
[S5] ⇄ pheromone p=0.075 → S3@127.0.0.1:38403
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9419 head_norm=1.205511
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.247720e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9424 head_norm=1.247224 delta_norm=0.224772
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.041 → S8@127.0.0.1:38409
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.7335 head_norm=1.261223
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.487122e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.7262 head_norm=1.253762 delta_norm=0.148712
[S6] aggregate: ROLLBACK (f1_val pre=0.734 post=0.726 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.183 → S7@127.0.0.1:38408
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.4167 head_norm=1.048615
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.819101e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.6888 head_norm=1.277527 delta_norm=0.681910
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.090 → S8@127.0.0.1:38409
[S9] ⇄ pheromone p=0.093 → S3@127.0.0.1:38403
[S8] ⇄ pheromone p=0.278 → S16@127.0.0.1:38416
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.7003 head_norm=1.263877
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.288405e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.7001 head_norm=1.409183 delta_norm=0.328840
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.135 → S6@127.0.0.1:38407
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9948 head_norm=1.889737
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.138289e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9948 head_norm=1.865202 delta_norm=0.113829
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.044 → S7@127.0.0.1:38408
[S11] ⇄ pheromone p=0.118 → S10@127.0.0.1:38411
[S13] ⇄ pheromone p=0.113 → S16@127.0.0.1:38416
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9355 head_norm=1.326245
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.183702e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9289 head_norm=1.143810 delta_norm=0.518370
[S16] aggregate: ROLLBACK (f1_val pre=0.935 post=0.929 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.278 → S4@127.0.0.1:38404
[S15] ⇄ pheromone p=0.407 → S7@127.0.0.1:38408
[S17] ⇄ pheromone p=0.123 → S14@127.0.0.1:38414
[S14] ⇄ pheromone p=0.135 → S13@127.0.0.1:38413
[S2] START round=21 head_norm_before_train=1.745798 cos_to_last_merge=0.8337 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.834
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.832549463982728, 'auprc': 0.8380872379114198, 'loss_val': 0.3215778602556511, 'psi': 0.8347645735542047}-{'f1_val': 0.829180439650694, 'auprc': 0.8724948189402788, 'loss_val': 0.3945284477131788, 'psi': 0.8465061913665279}
[S3] START round=21 head_norm_before_train=1.409183 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.006890 metrics={'f1_val': 0.7009355793019081, 'auprc': 0.9992253486829533, 'loss_val': 0.39479232025288347, 'psi': 0.8202514870543262}-{'f1_val': 0.7003264167718803, 'auprc': 0.9996217853692158, 'loss_val': 0.4061071125792446, 'psi': 0.8200445642108145}
[S4] START round=21 head_norm_before_train=1.247224 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9424482039958052, 'auprc': 0.9388897891811961, 'loss_val': 0.3475252353783714, 'psi': 0.9410248380699616}-{'f1_val': 0.941887676277767, 'auprc': 0.9508612856168009, 'loss_val': 0.34996129264951387, 'psi': 0.9454771200133807}
[S5] START round=21 head_norm_before_train=1.556694 cos_to_last_merge=0.9968 (last merge round=19)
[S5] round=21 local utility u=0.072305 metrics={'f1_val': 0.700320598491359, 'auprc': 0.6646698991588006, 'loss_val': 0.40640788905722414, 'psi': 0.6860603187583356}-{'f1_val': 0.7004069097142683, 'auprc': 0.661266279836998, 'loss_val': 0.5413249833796331, 'psi': 0.6847506577633602}
[S6] START round=21 head_norm_before_train=1.253762 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.6519001204936833, 'auprc': 0.8641896084663243, 'loss_val': 0.5888310405455621, 'psi': 0.7368159156827396}-{'f1_val': 0.733538710274184, 'auprc': 0.797887795213892, 'loss_val': 0.5875684481472202, 'psi': 0.7592783442500672}
[S7] START round=21 head_norm_before_train=1.277527 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.833677 metrics={'f1_val': 0.6785955620906624, 'auprc': 0.7858453440026036, 'loss_val': 0.7821907160289183, 'psi': 0.721495474855439}-{'f1_val': 0.41671011811102343, 'auprc': 0.787095186019386, 'loss_val': 0.881982391037795, 'psi': 0.5648641452743685}
[S8] START round=21 head_norm_before_train=1.181141 cos_to_last_merge=0.9903 (last merge round=18)
[S8] round=21 local utility u=0.020037 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9970708624650272, 'loss_val': 0.10644311564284774, 'psi': 0.9965502070261025}-{'f1_val': 0.9964894426023416, 'auprc': 0.99505582282299, 'loss_val': 0.14219059696230518, 'psi': 0.995915994690601}
[S9] START round=21 head_norm_before_train=1.609496 cos_to_last_merge=0.8441 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.844
[S9] round=21 local utility u=0.009113 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9969911321039628, 'loss_val': 0.04139233901059201, 'psi': 0.99679275992992}-{'f1_val': 0.9934918488430377, 'auprc': 0.9984785268010232, 'loss_val': 0.045068062493923026, 'psi': 0.9954865200262318}
[S10] START round=21 head_norm_before_train=1.865202 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9944964075022051, 'loss_val': 0.07460243476331975, 'psi': 0.9948305702659863}-{'f1_val': 0.9948336929542084, 'auprc': 0.9977376546603368, 'loss_val': 0.07057188799463576, 'psi': 0.9959952776366598}
[S11] START round=21 head_norm_before_train=1.847368 (no previous merge yet)
[S11] round=21 local utility u=0.003838 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9967446334092831, 'loss_val': 0.05701380503742914, 'psi': 0.996771083269332}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976394616122376, 'loss_val': 0.06592374763000473, 'psi': 0.9969839873530488}
[S13] START round=21 head_norm_before_train=1.898806 cos_to_last_merge=0.9996 (last merge round=19)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5134338868775404, 'auprc': 0.5333268978925638, 'loss_val': 1.1288429487877853, 'psi': 0.5213910912835498}-{'f1_val': 0.5500087454631624, 'auprc': 0.5334506459014864, 'loss_val': 1.0531032528706747, 'psi': 0.543385505638492}
[S14] START round=21 head_norm_before_train=1.949875 cos_to_last_merge=0.9995 (last merge round=19)
[S14] round=21 local utility u=0.031455 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.999262661366819, 'loss_val': 0.09826753566770649, 'psi': 0.9977715291181893}-{'f1_val': 0.9966100132760906, 'auprc': 0.9991506757863159, 'loss_val': 0.15983655822920403, 'psi': 0.9976262782801808}
[S15] START round=21 head_norm_before_train=1.759137 cos_to_last_merge=0.7937 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.794
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7009343052485745, 'auprc': 0.8634091605747543, 'loss_val': 0.5087471363147316, 'psi': 0.7659242473790464}-{'f1_val': 0.900148233924709, 'auprc': 0.99105892387807, 'loss_val': 0.14655461609066855, 'psi': 0.9365125099060534}
[S16] START round=21 head_norm_before_train=1.143810 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8429182591155588, 'auprc': 0.9548424957580758, 'loss_val': 0.5819309590088166, 'psi': 0.8876879537725656}-{'f1_val': 0.9354653923479762, 'auprc': 0.932873599154314, 'loss_val': 0.402691913407307, 'psi': 0.9344286750705113}
[S17] START round=21 head_norm_before_train=1.966139 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.5111650273983837, 'auprc': 0.7297351293985775, 'loss_val': 1.3468627490031444, 'psi': 0.5985930681984613}-{'f1_val': 0.5792059830547673, 'auprc': 0.7802029295103463, 'loss_val': 1.0710356338828035, 'psi': 0.6596047616369989}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:38413
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:38411
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S7] → sending delta(kind=head bytes=1787) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:38407
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1787 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] cosine check vs S8: cos=0.8931
[S13] RECEIVED delta(kind=head bytes=1796) from S14
[S13] cosine check vs S14: cos=0.9951
[S10] RECEIVED delta(kind=head bytes=1802) from S11
[S10] cosine check vs S11: cos=0.9950
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] cosine check vs S3: cos=0.9506
[S3] RECEIVED delta(kind=head bytes=1802) from S5
[S3] cosine check vs S5: cos=-0.0303
[S3] DROPPED delta from S5 (cos=-0.0303 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=0.9806
[S8] RECEIVED delta(kind=head bytes=1787) from S7
[S8] cosine check vs S7: cos=0.6431
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.7009 head_norm=1.437074
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.792351e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.7010 head_norm=1.526304 delta_norm=0.179235
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.8429 head_norm=1.192072
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.836284e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8427 head_norm=1.187954 delta_norm=0.283628
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.5134 head_norm=1.914446
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.015381e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.5636 head_norm=1.944629 delta_norm=0.101538
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.9951 head_norm=1.902407
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.622179e-02
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.9951 head_norm=1.883199 delta_norm=0.096222
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9962 head_norm=1.249929
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.389478e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9962 head_norm=1.155423 delta_norm=0.538948
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.6519 head_norm=1.314523
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.244509e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.6367 head_norm=1.358749 delta_norm=0.224451
[S6] aggregate: ROLLBACK (f1_val pre=0.652 post=0.637 tol_abs=0.005 tol_rel=0.0)
[S2] START round=22 head_norm_before_train=1.761441 cos_to_last_merge=0.8310 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.831
[S2] round=22 local utility u=0.066451 metrics={'f1_val': 0.8317683168825399, 'auprc': 0.9047516135622482, 'loss_val': 0.3839827909913651, 'psi': 0.8609616355544232}-{'f1_val': 0.832549463982728, 'auprc': 0.8380872379114198, 'loss_val': 0.3215778602556511, 'psi': 0.8347645735542047}
[S3] START round=22 head_norm_before_train=1.526304 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.025635 metrics={'f1_val': 0.7004261945879899, 'auprc': 0.9992463115757997, 'loss_val': 0.34052857602370895, 'psi': 0.8199542413831138}-{'f1_val': 0.7009355793019081, 'auprc': 0.9992253486829533, 'loss_val': 0.39479232025288347, 'psi': 0.8202514870543262}
[S4] START round=22 head_norm_before_train=1.296413 cos_to_last_merge=0.9957 (last merge round=20)
[S4] round=22 local utility u=0.034205 metrics={'f1_val': 0.9442097532868005, 'auprc': 0.9413911960911754, 'loss_val': 0.2971894596111069, 'psi': 0.9430823304085505}-{'f1_val': 0.9424482039958052, 'auprc': 0.9388897891811961, 'loss_val': 0.3475252353783714, 'psi': 0.9410248380699616}
[S5] START round=22 head_norm_before_train=1.601272 cos_to_last_merge=0.9890 (last merge round=19)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.6590441684431665, 'auprc': 0.7346865811588585, 'loss_val': 0.5098683439135738, 'psi': 0.6893011335294433}-{'f1_val': 0.700320598491359, 'auprc': 0.6646698991588006, 'loss_val': 0.40640788905722414, 'psi': 0.6860603187583356}
[S6] START round=22 head_norm_before_train=1.358749 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.561256 metrics={'f1_val': 0.777211080550777, 'auprc': 0.9534612667657231, 'loss_val': 0.48599981351170624, 'psi': 0.8477111550367555}-{'f1_val': 0.6519001204936833, 'auprc': 0.8641896084663243, 'loss_val': 0.5888310405455621, 'psi': 0.7368159156827396}
[S7] START round=22 head_norm_before_train=1.299466 cos_to_last_merge=0.9993 (last merge round=20)
[S7] round=22 local utility u=0.083043 metrics={'f1_val': 0.700990556350108, 'auprc': 0.7872366026139662, 'loss_val': 0.7546483417396983, 'psi': 0.7354889748556512}-{'f1_val': 0.6785955620906624, 'auprc': 0.7858453440026036, 'loss_val': 0.7821907160289183, 'psi': 0.721495474855439}
[S8] START round=22 head_norm_before_train=1.155423 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9924526979191467, 'loss_val': 0.18264129055987838, 'psi': 0.9947029412077504}-{'f1_val': 0.9962031034001528, 'auprc': 0.9970708624650272, 'loss_val': 0.10644311564284774, 'psi': 0.9965502070261025}
[S9] START round=22 head_norm_before_train=1.630421 cos_to_last_merge=0.8416 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.842
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9995809338377417, 'loss_val': 0.04506543433610175, 'psi': 0.99443477620731}-{'f1_val': 0.9966605118138915, 'auprc': 0.9969911321039628, 'loss_val': 0.04139233901059201, 'psi': 0.99679275992992}
[S10] START round=22 head_norm_before_train=1.883199 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9938221244917009, 'auprc': 0.9924512840580157, 'loss_val': 0.080219722077362, 'psi': 0.9932737883182269}-{'f1_val': 0.9950533454418405, 'auprc': 0.9944964075022051, 'loss_val': 0.07460243476331975, 'psi': 0.9948305702659863}
[S11] START round=22 head_norm_before_train=1.868755 (no previous merge yet)
[S11] round=22 local utility u=0.003919 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9982609299657366, 'loss_val': 0.05082265001629385, 'psi': 0.9970874724676112}-{'f1_val': 0.9967887165093644, 'auprc': 0.9967446334092831, 'loss_val': 0.05701380503742914, 'psi': 0.996771083269332}
[S13] START round=22 head_norm_before_train=1.944629 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.581605 metrics={'f1_val': 0.6099943863940367, 'auprc': 0.6130754144416976, 'loss_val': 0.7842412481523838, 'psi': 0.6112267976131011}-{'f1_val': 0.5134338868775404, 'auprc': 0.5333268978925638, 'loss_val': 1.1288429487877853, 'psi': 0.5213910912835498}
[S14] START round=22 head_norm_before_train=1.979565 cos_to_last_merge=0.9982 (last merge round=19)
[S14] round=22 local utility u=0.008373 metrics={'f1_val': 0.9959175922875732, 'auprc': 0.9989900524619298, 'loss_val': 0.07554487749522126, 'psi': 0.9971465763573159}-{'f1_val': 0.9967774409524363, 'auprc': 0.999262661366819, 'loss_val': 0.09826753566770649, 'psi': 0.9977715291181893}
[S15] START round=22 head_norm_before_train=1.782960 cos_to_last_merge=0.7917 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.792
[S15] round=22 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9917057039657985, 'loss_val': 0.03495626997924663, 'psi': 0.9947302826188318}-{'f1_val': 0.7009343052485745, 'auprc': 0.8634091605747543, 'loss_val': 0.5087471363147316, 'psi': 0.7659242473790464}
[S16] START round=22 head_norm_before_train=1.187954 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.456493 metrics={'f1_val': 0.9310319755971684, 'auprc': 0.9814486966396938, 'loss_val': 0.2774464492618799, 'psi': 0.9511986640141785}-{'f1_val': 0.8429182591155588, 'auprc': 0.9548424957580758, 'loss_val': 0.5819309590088166, 'psi': 0.8876879537725656}
[S17] START round=22 head_norm_before_train=1.984037 (no previous merge yet)
[S17] round=22 local utility u=1.000000 metrics={'f1_val': 0.7414164008440226, 'auprc': 0.9986797734332583, 'loss_val': 0.48384575464474566, 'psi': 0.8443217498797169}-{'f1_val': 0.5111650273983837, 'auprc': 0.7297351293985775, 'loss_val': 1.3468627490031444, 'psi': 0.5985930681984613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:38407
[S3] sending update (kind=head size=1793 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1793) from S3
[S6] cosine check vs S3: cos=0.9664
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38416
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:38411
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38405
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S11
[S10] cosine check vs S11: cos=0.9958
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] cosine check vs S13: cos=0.4921
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] cosine check vs S6: cos=0.3718
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=0.9413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[S7] sending update (kind=head size=1792 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1792) from S7
[S8] cosine check vs S7: cos=0.8939
[S15] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] cosine check vs S15: cos=0.9433
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:38414
[S4] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S4
[S8] cosine check vs S4: cos=0.6024
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:38413
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=0.9900
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:38404
[S16] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S14
[S13] cosine check vs S14: cos=0.9982
[S4] RECEIVED delta(kind=head bytes=1805) from S16
[S4] cosine check vs S16: cos=0.8906
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.6590 head_norm=1.642777
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.004981e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.6750 head_norm=1.685450 delta_norm=0.300498
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9938 head_norm=1.920653
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.854225e-02
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9938 head_norm=1.904139 delta_norm=0.088542
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.6100 head_norm=1.953858
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.577834e-02
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.5538 head_norm=1.979736 delta_norm=0.065778
[S13] aggregate: ROLLBACK (f1_val pre=0.610 post=0.554 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9959 head_norm=2.007437
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.412751e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9959 head_norm=1.994927 delta_norm=0.141275
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9962 head_norm=1.213927
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.429721e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9962 head_norm=1.127236 delta_norm=0.242972
[S8] aggregate: ACCEPT kept=['S7', 'S4'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9442 head_norm=1.357019
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.088397e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9444 head_norm=1.259760 delta_norm=0.308840
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.7772 head_norm=1.408335
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.039381e-01
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.7717 head_norm=1.466010 delta_norm=0.203938
[S6] aggregate: ROLLBACK (f1_val pre=0.777 post=0.772 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.9310 head_norm=1.234203
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.612915e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.9891 head_norm=1.388735 delta_norm=0.861292
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.7010 head_norm=1.318660
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.319188e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.6783 head_norm=1.233595 delta_norm=0.231919
[S7] aggregate: ROLLBACK (f1_val pre=0.701 post=0.678 tol_abs=0.005 tol_rel=0.0)
[S2] START round=23 head_norm_before_train=1.778586 cos_to_last_merge=0.8283 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.828
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.8300249934966741, 'auprc': 0.8685642961642421, 'loss_val': 0.43501356320974083, 'psi': 0.8454407145637013}-{'f1_val': 0.8317683168825399, 'auprc': 0.9047516135622482, 'loss_val': 0.3839827909913651, 'psi': 0.8609616355544232}
[S3] START round=23 head_norm_before_train=1.548594 cos_to_last_merge=0.9996 (last merge round=21)
[S3] round=23 local utility u=0.035649 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9996127670094077, 'loss_val': 0.2723106342793276, 'psi': 0.8202988290449429}-{'f1_val': 0.7004261945879899, 'auprc': 0.9992463115757997, 'loss_val': 0.34052857602370895, 'psi': 0.8199542413831138}
[S4] START round=23 head_norm_before_train=1.259760 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.053322 metrics={'f1_val': 0.9443294045697762, 'auprc': 0.9694715541104663, 'loss_val': 0.2755050197051248, 'psi': 0.9543862643860523}-{'f1_val': 0.9442097532868005, 'auprc': 0.9413911960911754, 'loss_val': 0.2971894596111069, 'psi': 0.9430823304085505}
[S5] START round=23 head_norm_before_train=1.685450 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.258049 metrics={'f1_val': 0.7001587899531788, 'auprc': 0.799775704708027, 'loss_val': 0.4357263340440528, 'psi': 0.7400055558551181}-{'f1_val': 0.6590441684431665, 'auprc': 0.7346865811588585, 'loss_val': 0.5098683439135738, 'psi': 0.6893011335294433}
[S6] START round=23 head_norm_before_train=1.466010 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.6563098510394011, 'auprc': 0.8443077334504052, 'loss_val': 0.609863037054865, 'psi': 0.7315090040038028}-{'f1_val': 0.777211080550777, 'auprc': 0.9534612667657231, 'loss_val': 0.48599981351170624, 'psi': 0.8477111550367555}
[S7] START round=23 head_norm_before_train=1.233595 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.077763 metrics={'f1_val': 0.6820474609079913, 'auprc': 0.8697485949780124, 'loss_val': 0.7329997040296721, 'psi': 0.7571279145359997}-{'f1_val': 0.700990556350108, 'auprc': 0.7872366026139662, 'loss_val': 0.7546483417396983, 'psi': 0.7354889748556512}
[S8] START round=23 head_norm_before_train=1.127236 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.003369 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.995365115975473, 'loss_val': 0.18464152554148103, 'psi': 0.9958679084302808}-{'f1_val': 0.9962031034001528, 'auprc': 0.9924526979191467, 'loss_val': 0.18264129055987838, 'psi': 0.9947029412077504}
[S9] START round=23 head_norm_before_train=1.650386 cos_to_last_merge=0.8396 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.840
[S9] round=23 local utility u=0.016168 metrics={'f1_val': 0.994994420763055, 'auprc': 0.9995825475271921, 'loss_val': 0.036677652346100244, 'psi': 0.9968296714687098}-{'f1_val': 0.9910040044536889, 'auprc': 0.9995809338377417, 'loss_val': 0.04506543433610175, 'psi': 0.99443477620731}
[S10] START round=23 head_norm_before_train=1.904139 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.017590 metrics={'f1_val': 0.994614115641838, 'auprc': 0.9976590201604337, 'loss_val': 0.06541500724853914, 'psi': 0.9958320774492763}-{'f1_val': 0.9938221244917009, 'auprc': 0.9924512840580157, 'loss_val': 0.080219722077362, 'psi': 0.9932737883182269}
[S11] START round=23 head_norm_before_train=1.891630 (no previous merge yet)
[S11] round=23 local utility u=0.004713 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9980894900212501, 'loss_val': 0.043784510671831346, 'psi': 0.9973090259141186}-{'f1_val': 0.996305167468861, 'auprc': 0.9982609299657366, 'loss_val': 0.05082265001629385, 'psi': 0.9970874724676112}
[S13] START round=23 head_norm_before_train=1.979736 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5638055471465013, 'auprc': 0.5412507317634669, 'loss_val': 1.0985747624767461, 'psi': 0.5547836209932876}-{'f1_val': 0.6099943863940367, 'auprc': 0.6130754144416976, 'loss_val': 0.7842412481523838, 'psi': 0.6112267976131011}
[S14] START round=23 head_norm_before_train=1.994927 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9807545827885382, 'auprc': 0.9990485616128121, 'loss_val': 0.13114873291509482, 'psi': 0.9880721743182477}-{'f1_val': 0.9959175922875732, 'auprc': 0.9989900524619298, 'loss_val': 0.07554487749522126, 'psi': 0.9971465763573159}
[S15] START round=23 head_norm_before_train=1.805266 cos_to_last_merge=0.7896 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.790
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.8521195740944603, 'auprc': 0.9501739706356324, 'loss_val': 0.31602265978301664, 'psi': 0.8913413327109291}-{'f1_val': 0.9967466683875206, 'auprc': 0.9917057039657985, 'loss_val': 0.03495626997924663, 'psi': 0.9947302826188318}
[S16] START round=23 head_norm_before_train=1.388735 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.9371929578372769, 'auprc': 0.9814373681450383, 'loss_val': 0.3216982320854567, 'psi': 0.9548907219603814}-{'f1_val': 0.9310319755971684, 'auprc': 0.9814486966396938, 'loss_val': 0.2774464492618799, 'psi': 0.9511986640141785}
[S17] START round=23 head_norm_before_train=1.992380 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.45829037392805805, 'auprc': 0.7019695182896339, 'loss_val': 1.3483765788597928, 'psi': 0.5557620316726883}-{'f1_val': 0.7414164008440226, 'auprc': 0.9986797734332583, 'loss_val': 0.48384575464474566, 'psi': 0.8443217498797169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38408
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:38411
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:38407
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:38403
[S10] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S8
[S16] cosine check vs S8: cos=0.6334
[S6] RECEIVED delta(kind=head bytes=1797) from S3
[S6] cosine check vs S3: cos=0.9859
[S10] RECEIVED delta(kind=head bytes=1799) from S11
[S10] cosine check vs S11: cos=0.9963
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=-0.0792
[S7] DROPPED delta from S10 (cos=-0.0792 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=0.8309
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] cosine check vs S7: cos=0.8501
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] cosine check vs S5: cos=-0.0550
[S3] DROPPED delta from S5 (cos=-0.0550 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1806) from S9
[S3] cosine check vs S9: cos=0.9900
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9946 head_norm=1.939930
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.403618e-02
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9946 head_norm=1.925578 delta_norm=0.084036
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9962 head_norm=1.186903
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.158265e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9962 head_norm=1.137971 delta_norm=0.115826
[S8] aggregate: ACCEPT kept=['S4', 'S7'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.7008 head_norm=1.572481
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.238316e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.9224 head_norm=1.615666 delta_norm=0.123832
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9372 head_norm=1.428475
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.703757e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9374 head_norm=1.182925 delta_norm=0.570376
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.6563 head_norm=1.515269
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.325495e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.6463 head_norm=1.538440 delta_norm=0.132549
[S6] aggregate: ROLLBACK (f1_val pre=0.656 post=0.646 tol_abs=0.005 tol_rel=0.0)
[S2] START round=24 head_norm_before_train=1.799029 cos_to_last_merge=0.8259 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.826
[S2] round=24 local utility u=0.099983 metrics={'f1_val': 0.8271006995425202, 'auprc': 0.9358614253071036, 'loss_val': 0.41939293067145933, 'psi': 0.8706049898483535}-{'f1_val': 0.8300249934966741, 'auprc': 0.8685642961642421, 'loss_val': 0.43501356320974083, 'psi': 0.8454407145637013}
[S3] START round=24 head_norm_before_train=1.615666 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.009175 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9995981677016923, 'loss_val': 0.25391728695066434, 'psi': 0.8202929893218567}-{'f1_val': 0.7007562037352997, 'auprc': 0.9996127670094077, 'loss_val': 0.2723106342793276, 'psi': 0.8202988290449429}
[S4] START round=24 head_norm_before_train=1.318994 cos_to_last_merge=0.9980 (last merge round=22)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9433382205974099, 'auprc': 0.9676686744655215, 'loss_val': 0.26908443737040294, 'psi': 0.9530704021446545}-{'f1_val': 0.9443294045697762, 'auprc': 0.9694715541104663, 'loss_val': 0.2755050197051248, 'psi': 0.9543862643860523}
[S5] START round=24 head_norm_before_train=1.709429 cos_to_last_merge=0.9994 (last merge round=22)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.4359328930699593, 'auprc': 0.8532875226084119, 'loss_val': 0.7758476001493679, 'psi': 0.6028747448853403}-{'f1_val': 0.7001587899531788, 'auprc': 0.799775704708027, 'loss_val': 0.4357263340440528, 'psi': 0.7400055558551181}
[S6] START round=24 head_norm_before_train=1.538440 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.572773 metrics={'f1_val': 0.7778796678283405, 'auprc': 0.9493436898536879, 'loss_val': 0.5088446499262852, 'psi': 0.8464652766384795}-{'f1_val': 0.6563098510394011, 'auprc': 0.8443077334504052, 'loss_val': 0.609863037054865, 'psi': 0.7315090040038028}
[S7] START round=24 head_norm_before_train=1.251180 cos_to_last_merge=0.9995 (last merge round=22)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5611189441836643, 'auprc': 0.8562341586284077, 'loss_val': 0.7665660635044717, 'psi': 0.6791650299615617}-{'f1_val': 0.6820474609079913, 'auprc': 0.8697485949780124, 'loss_val': 0.7329997040296721, 'psi': 0.7571279145359997}
[S8] START round=24 head_norm_before_train=1.137971 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.011677 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.99053297849965, 'loss_val': 0.1467915751730097, 'psi': 0.9939350534399518}-{'f1_val': 0.9962031034001528, 'auprc': 0.995365115975473, 'loss_val': 0.18464152554148103, 'psi': 0.9958679084302808}
[S9] START round=24 head_norm_before_train=1.666951 cos_to_last_merge=0.8379 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.838
[S9] round=24 local utility u=0.006116 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9995718421131117, 'loss_val': 0.031924545731598065, 'psi': 0.9975764058247761}-{'f1_val': 0.994994420763055, 'auprc': 0.9995825475271921, 'loss_val': 0.036677652346100244, 'psi': 0.9968296714687098}
[S10] START round=24 head_norm_before_train=1.925578 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9936028450452988, 'auprc': 0.9964479342775023, 'loss_val': 0.06764138079339209, 'psi': 0.9947408807381802}-{'f1_val': 0.994614115641838, 'auprc': 0.9976590201604337, 'loss_val': 0.06541500724853914, 'psi': 0.9958320774492763}
[S11] START round=24 head_norm_before_train=1.914810 (no previous merge yet)
[S11] round=24 local utility u=0.002108 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9980688682724668, 'loss_val': 0.03950659449391488, 'psi': 0.9973007772146054}-{'f1_val': 0.9967887165093644, 'auprc': 0.9980894900212501, 'loss_val': 0.043784510671831346, 'psi': 0.9973090259141186}
[S13] START round=24 head_norm_before_train=1.989579 cos_to_last_merge=0.9999 (last merge round=22)
[S13] round=24 local utility u=0.427547 metrics={'f1_val': 0.6246385717569295, 'auprc': 0.5981788268821235, 'loss_val': 0.7792635942586946, 'psi': 0.6140546738070071}-{'f1_val': 0.5638055471465013, 'auprc': 0.5412507317634669, 'loss_val': 1.0985747624767461, 'psi': 0.5547836209932876}
[S14] START round=24 head_norm_before_train=2.019755 cos_to_last_merge=0.9998 (last merge round=22)
[S14] round=24 local utility u=0.017376 metrics={'f1_val': 0.9830927184242755, 'auprc': 0.9989170618383172, 'loss_val': 0.11003154218204618, 'psi': 0.9894224557898922}-{'f1_val': 0.9807545827885382, 'auprc': 0.9990485616128121, 'loss_val': 0.13114873291509482, 'psi': 0.9880721743182477}
[S15] START round=24 head_norm_before_train=1.825078 cos_to_last_merge=0.7880 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.788
[S15] round=24 local utility u=0.274454 metrics={'f1_val': 0.8972558542485122, 'auprc': 0.9912408471002968, 'loss_val': 0.1611322235607491, 'psi': 0.934849851389226}-{'f1_val': 0.8521195740944603, 'auprc': 0.9501739706356324, 'loss_val': 0.31602265978301664, 'psi': 0.8913413327109291}
[S16] START round=24 head_norm_before_train=1.182925 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.020525 metrics={'f1_val': 0.9384775340541959, 'auprc': 0.9782212418451199, 'loss_val': 0.27870674090252034, 'psi': 0.9543750171705655}-{'f1_val': 0.9371929578372769, 'auprc': 0.9814373681450383, 'loss_val': 0.3216982320854567, 'psi': 0.9548907219603814}
[S17] START round=24 head_norm_before_train=1.997451 (no previous merge yet)
[S17] round=24 local utility u=0.511555 metrics={'f1_val': 0.5656974551784854, 'auprc': 0.7665749607324689, 'loss_val': 1.1635254053438684, 'psi': 0.6460484574000789}-{'f1_val': 0.45829037392805805, 'auprc': 0.7019695182896339, 'loss_val': 1.3483765788597928, 'psi': 0.5557620316726883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:38410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:38417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:38403
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:38414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=0.9953
[S14] RECEIVED delta(kind=head bytes=1797) from S13
[S14] cosine check vs S13: cos=0.9979
[S17] RECEIVED delta(kind=head bytes=1797) from S14
[S17] cosine check vs S14: cos=0.9940
[S3] RECEIVED delta(kind=head bytes=1797) from S6
[S3] cosine check vs S6: cos=0.9876
[S7] RECEIVED delta(kind=head bytes=1805) from S8
[S7] cosine check vs S8: cos=0.8322
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:38409
[S16] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S16
[S8] cosine check vs S16: cos=0.8955
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.5611 head_norm=1.269570
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.609642e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.6815 head_norm=1.189837 delta_norm=0.360964
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9962 head_norm=1.683218
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.323413e-02
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9962 head_norm=1.659910 delta_norm=0.083234
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9962 head_norm=1.216638
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.797820e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9962 head_norm=1.191436 delta_norm=0.279782
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9831 head_norm=2.043309
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.928493e-02
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9831 head_norm=2.021547 delta_norm=0.069285
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.5657 head_norm=2.003729
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.121714e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.5647 head_norm=2.020504 delta_norm=0.112171
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.7008 head_norm=1.640498
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.304473e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.7008 head_norm=1.605035 delta_norm=0.130447
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.812072 cos_to_last_merge=0.8242 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.824
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.8322785958953889, 'auprc': 0.8437912082728195, 'loss_val': 0.3696074100896763, 'psi': 0.8368836408463611}-{'f1_val': 0.8271006995425202, 'auprc': 0.9358614253071036, 'loss_val': 0.41939293067145933, 'psi': 0.8706049898483535}
[S3] START round=25 head_norm_before_train=1.605035 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.633988 metrics={'f1_val': 0.904276387015178, 'auprc': 0.9992265185392533, 'loss_val': 0.2059464395205058, 'psi': 0.9422564396248081}-{'f1_val': 0.7007562037352997, 'auprc': 0.9995981677016923, 'loss_val': 0.25391728695066434, 'psi': 0.8202929893218567}
[S4] START round=25 head_norm_before_train=1.360660 cos_to_last_merge=0.9949 (last merge round=22)
[S4] round=25 local utility u=0.004757 metrics={'f1_val': 0.9442795097211886, 'auprc': 0.9675340514738126, 'loss_val': 0.2648134803874327, 'psi': 0.9535813264222381}-{'f1_val': 0.9433382205974099, 'auprc': 0.9676686744655215, 'loss_val': 0.26908443737040294, 'psi': 0.9530704021446545}
[S5] START round=25 head_norm_before_train=1.740148 cos_to_last_merge=0.9974 (last merge round=22)
[S5] round=25 local utility u=1.000000 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.9895959271645404, 'loss_val': 0.27646659922274247, 'psi': 0.8161865215842204}-{'f1_val': 0.4359328930699593, 'auprc': 0.8532875226084119, 'loss_val': 0.7758476001493679, 'psi': 0.6028747448853403}
[S6] START round=25 head_norm_before_train=1.579580 cos_to_last_merge=0.9985 (last merge round=23)
[S6] round=25 local utility u=0.196181 metrics={'f1_val': 0.8222248325067522, 'auprc': 0.9559516646376429, 'loss_val': 0.40237739000962375, 'psi': 0.8757155653591084}-{'f1_val': 0.7778796678283405, 'auprc': 0.9493436898536879, 'loss_val': 0.5088446499262852, 'psi': 0.8464652766384795}
[S7] START round=25 head_norm_before_train=1.189837 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.616564 metrics={'f1_val': 0.6998067410744289, 'auprc': 0.94872710325682, 'loss_val': 0.6430444044866832, 'psi': 0.7993748859473853}-{'f1_val': 0.5611189441836643, 'auprc': 0.8562341586284077, 'loss_val': 0.7665660635044717, 'psi': 0.6791650299615617}
[S8] START round=25 head_norm_before_train=1.191436 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.023299 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.996717291304948, 'loss_val': 0.11964689326133673, 'psi': 0.996498761483354}-{'f1_val': 0.9962031034001528, 'auprc': 0.99053297849965, 'loss_val': 0.1467915751730097, 'psi': 0.9939350534399518}
[S9] START round=25 head_norm_before_train=1.659910 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9957453629260273, 'loss_val': 0.033073291351215436, 'psi': 0.9962944522587458}-{'f1_val': 0.9962461149658858, 'auprc': 0.9995718421131117, 'loss_val': 0.031924545731598065, 'psi': 0.9975764058247761}
[S10] START round=25 head_norm_before_train=1.960659 cos_to_last_merge=0.9992 (last merge round=23)
[S10] round=25 local utility u=0.007548 metrics={'f1_val': 0.9932982145767046, 'auprc': 0.9976818063970819, 'loss_val': 0.054419048025325344, 'psi': 0.9950516513048555}-{'f1_val': 0.9936028450452988, 'auprc': 0.9964479342775023, 'loss_val': 0.06764138079339209, 'psi': 0.9947408807381802}
[S11] START round=25 head_norm_before_train=1.937138 (no previous merge yet)
[S11] round=25 local utility u=0.000559 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981210591132116, 'loss_val': 0.03709422400215409, 'psi': 0.9971766263534384}-{'f1_val': 0.9967887165093644, 'auprc': 0.9980688682724668, 'loss_val': 0.03950659449391488, 'psi': 0.9973007772146054}
[S13] START round=25 head_norm_before_train=2.001948 cos_to_last_merge=0.9997 (last merge round=22)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.5776932046767557, 'auprc': 0.5869699863488717, 'loss_val': 1.0910288595921773, 'psi': 0.581403917345602}-{'f1_val': 0.6246385717569295, 'auprc': 0.5981788268821235, 'loss_val': 0.7792635942586946, 'psi': 0.6140546738070071}
[S14] START round=25 head_norm_before_train=2.021547 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.071353 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9991350818658031, 'loss_val': 0.05385589423237376, 'psi': 0.9980973505779118}-{'f1_val': 0.9830927184242755, 'auprc': 0.9989170618383172, 'loss_val': 0.11003154218204618, 'psi': 0.9894224557898922}
[S15] START round=25 head_norm_before_train=1.838957 cos_to_last_merge=0.7861 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.786
[S15] round=25 local utility u=0.303412 metrics={'f1_val': 0.9846934520016146, 'auprc': 0.9961218980265343, 'loss_val': 0.09357655398583906, 'psi': 0.9892648304115825}-{'f1_val': 0.8972558542485122, 'auprc': 0.9912408471002968, 'loss_val': 0.1611322235607491, 'psi': 0.934849851389226}
[S16] START round=25 head_norm_before_train=1.231010 cos_to_last_merge=0.9989 (last merge round=23)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.8669139510142458, 'auprc': 0.9800890088789286, 'loss_val': 0.4730110931885651, 'psi': 0.912183974160119}-{'f1_val': 0.9384775340541959, 'auprc': 0.9782212418451199, 'loss_val': 0.27870674090252034, 'psi': 0.9543750171705655}
[S17] START round=25 head_norm_before_train=2.020504 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.277043 metrics={'f1_val': 0.606359853731556, 'auprc': 0.8476204537709315, 'loss_val': 1.0965495290158531, 'psi': 0.7028640937473062}-{'f1_val': 0.5656974551784854, 'auprc': 0.7665749607324689, 'loss_val': 1.1635254053438684, 'psi': 0.6460484574000789}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:38410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:38402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:38415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:38412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:38417
[S6] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1807 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] cosine check vs S7: cos=0.8590
[S9] RECEIVED delta(kind=head bytes=1798) from S3
[S9] cosine check vs S3: cos=0.9920
[S2] RECEIVED delta(kind=head bytes=1798) from S5
[S2] cosine check vs S5: cos=0.9659
[S11] RECEIVED delta(kind=head bytes=1799) from S10
[S11] cosine check vs S10: cos=0.9936
[S16] RECEIVED delta(kind=head bytes=1807) from S4
[S16] cosine check vs S4: cos=0.9415
[S7] RECEIVED delta(kind=head bytes=1801) from S8
[S7] cosine check vs S8: cos=0.8838
[S3] RECEIVED delta(kind=head bytes=1798) from S6
[S3] cosine check vs S6: cos=0.9931
[S17] RECEIVED delta(kind=head bytes=1794) from S14
[S17] cosine check vs S14: cos=0.9961
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=25 metric=0.8323 head_norm=1.827343
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.365118e-01
[S2] stored merged vector for next round verification (round=25)
[S2] DEBUG after merge:  round=25 metric=0.8323 head_norm=1.781410 delta_norm=0.236512
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.165 → S14@127.0.0.1:38414
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9965 head_norm=1.957442
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.132483e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9965 head_norm=1.972583 delta_norm=0.113248
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9967 head_norm=1.677553
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.070711e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9967 head_norm=1.650793 delta_norm=0.107071
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.9847 head_norm=1.855885
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.129402e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.9824 head_norm=1.479202 delta_norm=0.512940
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.8669 head_norm=1.280684
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.354528e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.8689 head_norm=1.317701 delta_norm=0.235453
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.141 → S8@127.0.0.1:38409
[S14] ⇄ pheromone p=0.065 → S17@127.0.0.1:38417
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.6998 head_norm=1.207471
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.994547e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.7136 head_norm=1.200270 delta_norm=0.299455
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.240 → S15@127.0.0.1:38415
[S6] ⇄ pheromone p=0.248 → S3@127.0.0.1:38403
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.9043 head_norm=1.630637
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.539913e-02
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.7367 head_norm=1.622974 delta_norm=0.095399
[S3] aggregate: ROLLBACK (f1_val pre=0.904 post=0.737 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.180 → S9@127.0.0.1:38410
[S8] ⇄ pheromone p=0.100 → S7@127.0.0.1:38408
[S10] ⇄ pheromone p=0.018 → S11@127.0.0.1:38412
[S4] ⇄ pheromone p=0.025 → S16@127.0.0.1:38416
[S5] ⇄ pheromone p=0.263 → S2@127.0.0.1:38402
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.6064 head_norm=2.033956
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.949134e-02
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.6068 head_norm=2.034923 delta_norm=0.089491
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=26 head_norm_before_train=1.781410 cos_to_last_merge=1.0000 (last merge round=25)
[S2] round=26 local utility u=0.104315 metrics={'f1_val': 0.8262356658448248, 'auprc': 0.944879144315276, 'loss_val': 0.4279836778100277, 'psi': 0.8736930572330053}-{'f1_val': 0.8322785958953889, 'auprc': 0.8437912082728195, 'loss_val': 0.3696074100896763, 'psi': 0.8368836408463611}
[S3] START round=26 head_norm_before_train=1.622974 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.309732 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9991913621052418, 'loss_val': 0.1474069973120534, 'psi': 0.9983454426690552}-{'f1_val': 0.904276387015178, 'auprc': 0.9992265185392533, 'loss_val': 0.2059464395205058, 'psi': 0.9422564396248081}
[S4] START round=26 head_norm_before_train=1.394056 cos_to_last_merge=0.9921 (last merge round=22)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9423266391859492, 'auprc': 0.957724472481166, 'loss_val': 0.28183219136740606, 'psi': 0.9484857725040359}-{'f1_val': 0.9442795097211886, 'auprc': 0.9675340514738126, 'loss_val': 0.2648134803874327, 'psi': 0.9535813264222381}
[S5] START round=26 head_norm_before_train=1.766222 cos_to_last_merge=0.9951 (last merge round=22)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8557496791070294, 'loss_val': 0.8324247981185504, 'psi': 0.604359609946035}-{'f1_val': 0.7005802511973405, 'auprc': 0.9895959271645404, 'loss_val': 0.27646659922274247, 'psi': 0.8161865215842204}
[S6] START round=26 head_norm_before_train=1.620900 cos_to_last_merge=0.9953 (last merge round=23)
[S6] round=26 local utility u=0.025948 metrics={'f1_val': 0.8479136454832146, 'auprc': 0.9463231053793856, 'loss_val': 0.4757279604861398, 'psi': 0.887277429441683}-{'f1_val': 0.8222248325067522, 'auprc': 0.9559516646376429, 'loss_val': 0.40237739000962375, 'psi': 0.8757155653591084}
[S7] START round=26 head_norm_before_train=1.200270 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.6729140675761356, 'auprc': 0.897555589062971, 'loss_val': 0.6917296800315915, 'psi': 0.7627706761708697}-{'f1_val': 0.6998067410744289, 'auprc': 0.94872710325682, 'loss_val': 0.6430444044866832, 'psi': 0.7993748859473853}
[S8] START round=26 head_norm_before_train=1.265960 cos_to_last_merge=0.9974 (last merge round=24)
[S8] round=26 local utility u=0.006140 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9911431592888145, 'loss_val': 0.08974497849573367, 'psi': 0.9941791257556175}-{'f1_val': 0.9963530749356245, 'auprc': 0.996717291304948, 'loss_val': 0.11964689326133673, 'psi': 0.996498761483354}
[S9] START round=26 head_norm_before_train=1.650793 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9920956129422706, 'auprc': 0.9995975651607456, 'loss_val': 0.04023906999395826, 'psi': 0.9950963938296606}-{'f1_val': 0.9966605118138915, 'auprc': 0.9957453629260273, 'loss_val': 0.033073291351215436, 'psi': 0.9962944522587458}
[S10] START round=26 head_norm_before_train=1.994051 cos_to_last_merge=0.9976 (last merge round=23)
[S10] round=26 local utility u=0.002738 metrics={'f1_val': 0.9949196380141286, 'auprc': 0.9943320860780159, 'loss_val': 0.048622364548225445, 'psi': 0.9946846172396835}-{'f1_val': 0.9932982145767046, 'auprc': 0.9976818063970819, 'loss_val': 0.054419048025325344, 'psi': 0.9950516513048555}
[S11] START round=26 head_norm_before_train=1.972583 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.001344 metrics={'f1_val': 0.997050770792581, 'auprc': 0.9967137885711254, 'loss_val': 0.03320658574509335, 'psi': 0.9969159779039987}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981210591132116, 'loss_val': 0.03709422400215409, 'psi': 0.9971766263534384}
[S13] START round=26 head_norm_before_train=2.010413 cos_to_last_merge=0.9995 (last merge round=22)
[S13] round=26 local utility u=0.497969 metrics={'f1_val': 0.6427854551354883, 'auprc': 0.6870507970891678, 'loss_val': 0.7858871154482522, 'psi': 0.6604915919169602}-{'f1_val': 0.5776932046767557, 'auprc': 0.5869699863488717, 'loss_val': 1.0910288595921773, 'psi': 0.581403917345602}
[S14] START round=26 head_norm_before_train=2.039819 cos_to_last_merge=0.9999 (last merge round=24)
[S14] round=26 local utility u=0.001181 metrics={'f1_val': 0.9969452255660185, 'auprc': 0.9977780212831895, 'loss_val': 0.044660859735032046, 'psi': 0.9972783438528869}-{'f1_val': 0.9974055297193176, 'auprc': 0.9991350818658031, 'loss_val': 0.05385589423237376, 'psi': 0.9980973505779118}
[S15] START round=26 head_norm_before_train=1.479202 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.8498781394557898, 'loss_val': 0.5376955444786613, 'psi': 0.7605014420840901}-{'f1_val': 0.9846934520016146, 'auprc': 0.9961218980265343, 'loss_val': 0.09357655398583906, 'psi': 0.9892648304115825}
[S16] START round=26 head_norm_before_train=1.317701 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.342179 metrics={'f1_val': 0.9390762272128295, 'auprc': 0.9785034604514872, 'loss_val': 0.21687099487011013, 'psi': 0.9548471205082926}-{'f1_val': 0.8669139510142458, 'auprc': 0.9800890088789286, 'loss_val': 0.4730110931885651, 'psi': 0.912183974160119}
[S17] START round=26 head_norm_before_train=2.034923 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.265723 metrics={'f1_val': 0.6040234169661043, 'auprc': 0.9990546683312898, 'loss_val': 1.0053866890574492, 'psi': 0.7620359175121785}-{'f1_val': 0.606359853731556, 'auprc': 0.8476204537709315, 'loss_val': 1.0965495290158531, 'psi': 0.7028640937473062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38414
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:38403
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:38411
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:38412
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:38409
[S10] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] cosine check vs S3: cos=0.9960
[S13] RECEIVED delta(kind=head bytes=1795) from S14
[S13] cosine check vs S14: cos=0.9987
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=0.9885
[S10] RECEIVED delta(kind=head bytes=1798) from S11
[S10] cosine check vs S11: cos=0.9970
[S11] RECEIVED delta(kind=head bytes=1794) from S10
[S11] cosine check vs S10: cos=0.9970
[S8] RECEIVED delta(kind=head bytes=1798) from S16
[S8] cosine check vs S16: cos=0.9405
[S3] RECEIVED delta(kind=head bytes=1794) from S6
[S3] cosine check vs S6: cos=0.9960
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] cosine check vs S8: cos=0.9405
[S14] RECEIVED delta(kind=head bytes=1798) from S13
[S14] cosine check vs S13: cos=0.9987
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S17
[S14] cosine check vs S17: cos=0.9983
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.4368 head_norm=1.782665
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.355135e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.4368 head_norm=1.779914 delta_norm=0.135513
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.9949 head_norm=2.021566
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.919014e-02
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.9949 head_norm=2.005246 delta_norm=0.079190
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.9391 head_norm=1.362894
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.329130e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.9383 head_norm=1.327921 delta_norm=0.232913
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9969 head_norm=2.058295
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.951425e-02
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9969 head_norm=2.046077 delta_norm=0.039514
[S14] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9962 head_norm=1.333328
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.329130e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9962 head_norm=1.327921 delta_norm=0.232913
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.6428 head_norm=2.020342
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.575889e-02
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.6423 head_norm=2.038644 delta_norm=0.055759
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.9971 head_norm=1.991943
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.919016e-02
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.9971 head_norm=2.005246 delta_norm=0.079190
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.9978 head_norm=1.648842
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.360142e-02
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.9974 head_norm=1.647730 delta_norm=0.073601
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.8479 head_norm=1.649905
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.360142e-02
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.8589 head_norm=1.647730 delta_norm=0.073601
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.787462 cos_to_last_merge=0.9999 (last merge round=25)
[S2] round=27 local utility u=0.024215 metrics={'f1_val': 0.8302280574582453, 'auprc': 0.9418481847886053, 'loss_val': 0.3944145824361679, 'psi': 0.8748761083903893}-{'f1_val': 0.8262356658448248, 'auprc': 0.944879144315276, 'loss_val': 0.4279836778100277, 'psi': 0.8736930572330053}
[S3] START round=27 head_norm_before_train=1.647730 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9342951680476788, 'auprc': 0.9973318254062664, 'loss_val': 0.1748478576828955, 'psi': 0.9595098309911139}-{'f1_val': 0.9977814963782642, 'auprc': 0.9991913621052418, 'loss_val': 0.1474069973120534, 'psi': 0.9983454426690552}
[S4] START round=27 head_norm_before_train=1.422467 cos_to_last_merge=0.9895 (last merge round=22)
[S4] round=27 local utility u=0.030004 metrics={'f1_val': 0.9438104958079434, 'auprc': 0.9704064812712727, 'loss_val': 0.2687725597200095, 'psi': 0.954448889993275}-{'f1_val': 0.9423266391859492, 'auprc': 0.957724472481166, 'loss_val': 0.28183219136740606, 'psi': 0.9484857725040359}
[S5] START round=27 head_norm_before_train=1.779914 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.43671700517611844, 'auprc': 0.8535043930135974, 'loss_val': 0.8632575510841684, 'psi': 0.60343196031111}-{'f1_val': 0.43676623050537206, 'auprc': 0.8557496791070294, 'loss_val': 0.8324247981185504, 'psi': 0.604359609946035}
[S6] START round=27 head_norm_before_train=1.647730 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.7981566360901003, 'auprc': 0.9529778494383371, 'loss_val': 0.5025357086612411, 'psi': 0.860085121429395}-{'f1_val': 0.8479136454832146, 'auprc': 0.9463231053793856, 'loss_val': 0.4757279604861398, 'psi': 0.887277429441683}
[S7] START round=27 head_norm_before_train=1.216314 cos_to_last_merge=0.9997 (last merge round=25)
[S7] round=27 local utility u=0.117194 metrics={'f1_val': 0.6794798491395456, 'auprc': 0.9361249534974792, 'loss_val': 0.6124445010639948, 'psi': 0.782137890882719}-{'f1_val': 0.6729140675761356, 'auprc': 0.897555589062971, 'loss_val': 0.6917296800315915, 'psi': 0.7627706761708697}
[S8] START round=27 head_norm_before_train=1.327921 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.009292 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9971500350708665, 'loss_val': 0.08918233645926694, 'psi': 0.9965818760684384}-{'f1_val': 0.9962031034001528, 'auprc': 0.9911431592888145, 'loss_val': 0.08974497849573367, 'psi': 0.9941791257556175}
[S9] START round=27 head_norm_before_train=1.667237 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9888785659900814, 'auprc': 0.9993024900205202, 'loss_val': 0.04944456053969321, 'psi': 0.9930481356022569}-{'f1_val': 0.9920956129422706, 'auprc': 0.9995975651607456, 'loss_val': 0.04023906999395826, 'psi': 0.9950963938296606}
[S10] START round=27 head_norm_before_train=2.005246 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.002756 metrics={'f1_val': 0.9946754461709264, 'auprc': 0.9967322058890321, 'loss_val': 0.04884568885026305, 'psi': 0.9954981500581687}-{'f1_val': 0.9949196380141286, 'auprc': 0.9943320860780159, 'loss_val': 0.048622364548225445, 'psi': 0.9946846172396835}
[S11] START round=27 head_norm_before_train=2.005246 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.000891 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981618114674486, 'loss_val': 0.03274519711121635, 'psi': 0.9971929272951332}-{'f1_val': 0.997050770792581, 'auprc': 0.9967137885711254, 'loss_val': 0.03320658574509335, 'psi': 0.9969159779039987}
[S13] START round=27 head_norm_before_train=2.038644 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5982196833674304, 'auprc': 0.6229805699527098, 'loss_val': 1.0295793069994572, 'psi': 0.6081240380015421}-{'f1_val': 0.6427854551354883, 'auprc': 0.6870507970891678, 'loss_val': 0.7858871154482522, 'psi': 0.6604915919169602}
[S14] START round=27 head_norm_before_train=2.046077 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.995501598651872, 'auprc': 0.999290279258906, 'loss_val': 0.04807823243039615, 'psi': 0.9970170708946857}-{'f1_val': 0.9969452255660185, 'auprc': 0.9977780212831895, 'loss_val': 0.044660859735032046, 'psi': 0.9972783438528869}
[S15] START round=27 head_norm_before_train=1.509707 cos_to_last_merge=0.9999 (last merge round=25)
[S15] round=27 local utility u=1.000000 metrics={'f1_val': 0.9165043867769429, 'auprc': 0.9912323325658052, 'loss_val': 0.12064356377220523, 'psi': 0.9463955650924878}-{'f1_val': 0.7009169771696235, 'auprc': 0.8498781394557898, 'loss_val': 0.5376955444786613, 'psi': 0.7605014420840901}
[S16] START round=27 head_norm_before_train=1.327921 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.142446 metrics={'f1_val': 0.9730978435426203, 'auprc': 0.9862030365973706, 'loss_val': 0.15920820915447048, 'psi': 0.9783399207645204}-{'f1_val': 0.9390762272128295, 'auprc': 0.9785034604514872, 'loss_val': 0.21687099487011013, 'psi': 0.9548471205082926}
[S17] START round=27 head_norm_before_train=2.052104 cos_to_last_merge=0.9999 (last merge round=25)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.6274729873921633, 'auprc': 0.9085017884578411, 'loss_val': 1.070828354413889, 'psi': 0.7398845078184344}-{'f1_val': 0.6040234169661043, 'auprc': 0.9990546683312898, 'loss_val': 1.0053866890574492, 'psi': 0.7620359175121785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:38416
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:38415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38405
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:38409
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:38412
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1806) from S16
[S8] cosine check vs S16: cos=0.9985
[S16] RECEIVED delta(kind=head bytes=1805) from S4
[S16] cosine check vs S4: cos=0.9562
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=0.9958
[S11] RECEIVED delta(kind=head bytes=1793) from S10
[S11] cosine check vs S10: cos=0.9998
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] cosine check vs S15: cos=0.8793
[S10] RECEIVED delta(kind=head bytes=1797) from S11
[S10] cosine check vs S11: cos=0.9998
[S15] RECEIVED delta(kind=head bytes=1802) from S7
[S15] cosine check vs S7: cos=0.8793
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] cosine check vs S8: cos=0.9985
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.4367 head_norm=1.793394
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.252777e-02
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.4367 head_norm=1.794459 delta_norm=0.082528
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9962 head_norm=1.380772
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.802260e-02
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9962 head_norm=1.372917 delta_norm=0.038023
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=27 metric=0.9947 head_norm=2.028291
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.916100e-02
[S10] stored merged vector for next round verification (round=27)
[S10] DEBUG after merge:  round=27 metric=0.9947 head_norm=2.026478 delta_norm=0.019161
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6795 head_norm=1.233990
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.760111e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6704 head_norm=1.352011 delta_norm=0.376011
[S7] aggregate: ROLLBACK (f1_val pre=0.679 post=0.670 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9731 head_norm=1.366076
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.031327e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9746 head_norm=1.377397 delta_norm=0.103133
[S16] aggregate: ACCEPT kept=['S4', 'S8'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.9165 head_norm=1.554318
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.760111e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.9077 head_norm=1.352011 delta_norm=0.376011
[S15] aggregate: ROLLBACK (f1_val pre=0.917 post=0.908 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9965 head_norm=2.024845
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.916100e-02
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9965 head_norm=2.026478 delta_norm=0.019161
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S9
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S7]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S15
[S17]  timeout peer S16
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S15
[S14]  timeout peer S16
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S2] START round=28 head_norm_before_train=1.799313 cos_to_last_merge=0.9998 (last merge round=25)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.8310041347397962, 'auprc': 0.9410104012780095, 'loss_val': 0.4001327680484934, 'psi': 0.8750066413550815}-{'f1_val': 0.8302280574582453, 'auprc': 0.9418481847886053, 'loss_val': 0.3944145824361679, 'psi': 0.8748761083903893}
[S3] START round=28 head_norm_before_train=1.672709 cos_to_last_merge=0.9998 (last merge round=26)
[S3] round=28 local utility u=0.112775 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9991643209260104, 'loss_val': 0.11801722837532605, 'psi': 0.9765650165343557}-{'f1_val': 0.9342951680476788, 'auprc': 0.9973318254062664, 'loss_val': 0.1748478576828955, 'psi': 0.9595098309911139}
[S4] START round=28 head_norm_before_train=1.446613 cos_to_last_merge=0.9874 (last merge round=22)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9476961653150144, 'auprc': 0.9535674340624152, 'loss_val': 0.260662348515428, 'psi': 0.9500446728139746}-{'f1_val': 0.9438104958079434, 'auprc': 0.9704064812712727, 'loss_val': 0.2687725597200095, 'psi': 0.954448889993275}
[S5] START round=28 head_norm_before_train=1.794459 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=1.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9595953966143059, 'loss_val': 0.3345224583633239, 'psi': 0.8040823044742834}-{'f1_val': 0.43671700517611844, 'auprc': 0.8535043930135974, 'loss_val': 0.8632575510841684, 'psi': 0.60343196031111}
[S6] START round=28 head_norm_before_train=1.668607 cos_to_last_merge=0.9998 (last merge round=26)
[S6] round=28 local utility u=0.045537 metrics={'f1_val': 0.8184529197577872, 'auprc': 0.942116502909655, 'loss_val': 0.5006547269215396, 'psi': 0.8679183530185344}-{'f1_val': 0.7981566360901003, 'auprc': 0.9529778494383371, 'loss_val': 0.5025357086612411, 'psi': 0.860085121429395}
[S7] START round=28 head_norm_before_train=1.352011 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.5223182939169817, 'auprc': 0.7822188673908668, 'loss_val': 0.7784630229625995, 'psi': 0.6262785233065358}-{'f1_val': 0.6794798491395456, 'auprc': 0.9361249534974792, 'loss_val': 0.6124445010639948, 'psi': 0.782137890882719}
[S8] START round=28 head_norm_before_train=1.372917 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.007717 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.997551338043394, 'loss_val': 0.0775734651810526, 'psi': 0.9970044598060173}-{'f1_val': 0.9962031034001528, 'auprc': 0.9971500350708665, 'loss_val': 0.08918233645926694, 'psi': 0.9965818760684384}
[S9] START round=28 head_norm_before_train=1.683686 cos_to_last_merge=0.9998 (last merge round=25)
[S9] round=28 local utility u=0.029882 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9964355550431384, 'loss_val': 0.03042664195555543, 'psi': 0.996835969524541}-{'f1_val': 0.9888785659900814, 'auprc': 0.9993024900205202, 'loss_val': 0.04944456053969321, 'psi': 0.9930481356022569}
[S10] START round=28 head_norm_before_train=2.026478 cos_to_last_merge=1.0000 (last merge round=27)
[S10] round=28 local utility u=0.003485 metrics={'f1_val': 0.994614115641838, 'auprc': 0.9973110401289592, 'loss_val': 0.04324508996578295, 'psi': 0.9956928854366864}-{'f1_val': 0.9946754461709264, 'auprc': 0.9967322058890321, 'loss_val': 0.04884568885026305, 'psi': 0.9954981500581687}
[S11] START round=28 head_norm_before_train=2.026478 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.001228 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981047327658892, 'loss_val': 0.030117672229639188, 'psi': 0.9971700958145094}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981618114674486, 'loss_val': 0.03274519711121635, 'psi': 0.9971929272951332}
[S13] START round=28 head_norm_before_train=2.046144 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5922270808151151, 'auprc': 0.6077343912213616, 'loss_val': 1.0885482569931257, 'psi': 0.5984300049776137}-{'f1_val': 0.5982196833674304, 'auprc': 0.6229805699527098, 'loss_val': 1.0295793069994572, 'psi': 0.6081240380015421}
[S14] START round=28 head_norm_before_train=2.063538 cos_to_last_merge=0.9999 (last merge round=26)
[S14] round=28 local utility u=0.006280 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9977275774343817, 'loss_val': 0.03848446057449689, 'psi': 0.9971574955452145}-{'f1_val': 0.995501598651872, 'auprc': 0.999290279258906, 'loss_val': 0.04807823243039615, 'psi': 0.9970170708946857}
[S15] START round=28 head_norm_before_train=1.352011 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.059214 metrics={'f1_val': 0.9332132365574981, 'auprc': 0.9938741242949556, 'loss_val': 0.11039452225524235, 'psi': 0.957477591652481}-{'f1_val': 0.9165043867769429, 'auprc': 0.9912323325658052, 'loss_val': 0.12064356377220523, 'psi': 0.9463955650924878}
[S16] START round=28 head_norm_before_train=1.377397 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9380383670110022, 'auprc': 0.9853973564327027, 'loss_val': 0.23839486890628123, 'psi': 0.9569819627796823}-{'f1_val': 0.9730978435426203, 'auprc': 0.9862030365973706, 'loss_val': 0.15920820915447048, 'psi': 0.9783399207645204}
[S17] START round=28 head_norm_before_train=2.068883 cos_to_last_merge=0.9997 (last merge round=25)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6009313822447999, 'auprc': 0.811627287125295, 'loss_val': 1.31004423427027, 'psi': 0.685209744196998}-{'f1_val': 0.6274729873921633, 'auprc': 0.9085017884578411, 'loss_val': 1.070828354413889, 'psi': 0.7398845078184344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:38403
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:38402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:38411
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:38412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:38413
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S15
[S7] cosine check vs S15: cos=0.9991
[S10] RECEIVED delta(kind=head bytes=1795) from S11
[S10] cosine check vs S11: cos=0.9998
[S11] RECEIVED delta(kind=head bytes=1797) from S10
[S11] cosine check vs S10: cos=0.9998
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=0.9861
[S3] RECEIVED delta(kind=head bytes=1794) from S6
[S3] cosine check vs S6: cos=0.9984
[S2] RECEIVED delta(kind=head bytes=1801) from S5
[S2] cosine check vs S5: cos=0.9981
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[S14] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:38407
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=28 metric=0.9965 head_norm=2.045450
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.863283e-02
[S11] stored merged vector for next round verification (round=28)
[S11] DEBUG after merge:  round=28 metric=0.9965 head_norm=2.047035 delta_norm=0.018633
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.9946 head_norm=2.048789
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.863283e-02
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.9946 head_norm=2.047035 delta_norm=0.018633
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] RECEIVED delta(kind=head bytes=1796) from S14
[S13] cosine check vs S14: cos=0.9995
[S3] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S3
[S6] cosine check vs S3: cos=0.9984
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] cosine check vs S8: cos=0.9945
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.9615 head_norm=1.696734
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.067105e-02
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.9615 head_norm=1.690703 delta_norm=0.070671
[S3] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.9380 head_norm=1.411839
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.437464e-02
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.9380 head_norm=1.413334 delta_norm=0.074375
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] RoundReady barrier timeout: have=2 need=3 — continuing
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] CommDone barrier timeout: have=1 need=2 — continuing
[S5]  timeout peer S2
[S13]  timeout peer S14
[S3]  timeout peer S5
[S3]  timeout peer S9
[S8]  timeout peer S4
[S8]  timeout peer S7
[S14]  timeout peer S17
[S4]  timeout peer S16
[S7]  timeout peer S6
[S7]  timeout peer S10
[S7]  timeout peer S15
[S6]  timeout peer S3
[S10]  timeout peer S11
[S16]  timeout peer S8
[S16]  timeout peer S13
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.5223 head_norm=1.370790
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.541888e-02
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.5146 head_norm=1.390978 delta_norm=0.035419
[S7] aggregate: ROLLBACK (f1_val pre=0.522 post=0.515 tol_abs=0.005 tol_rel=0.0)
[S2] START round=29 head_norm_before_train=1.815225 cos_to_last_merge=0.9997 (last merge round=25)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.831402644800177, 'auprc': 0.8067136385494388, 'loss_val': 0.417015017752952, 'psi': 0.8215270422998817}-{'f1_val': 0.8310041347397962, 'auprc': 0.9410104012780095, 'loss_val': 0.4001327680484934, 'psi': 0.8750066413550815}
[S3] START round=29 head_norm_before_train=1.690703 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.120885 metrics={'f1_val': 0.9973670153333725, 'auprc': 0.9991837113052628, 'loss_val': 0.0915147028472461, 'psi': 0.9980936937221286}-{'f1_val': 0.961498813606586, 'auprc': 0.9991643209260104, 'loss_val': 0.11801722837532605, 'psi': 0.9765650165343557}
[S4] START round=29 head_norm_before_train=1.467547 cos_to_last_merge=0.9854 (last merge round=22)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.936433693257227, 'auprc': 0.9260595894652746, 'loss_val': 0.35847488960388185, 'psi': 0.932284051740446}-{'f1_val': 0.9476961653150144, 'auprc': 0.9535674340624152, 'loss_val': 0.260662348515428, 'psi': 0.9500446728139746}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.806019 cos_to_last_merge=0.9999 (last merge round=27)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.6287555772413124, 'auprc': 0.8535981307825098, 'loss_val': 0.5229714993188452, 'psi': 0.7186925986577913}-{'f1_val': 0.7004069097142683, 'auprc': 0.9595953966143059, 'loss_val': 0.3345224583633239, 'psi': 0.8040823044742834}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=1.688536 cos_to_last_merge=0.9993 (last merge round=26)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.8005163640118524, 'auprc': 0.9288029658204426, 'loss_val': 0.4362094927990047, 'psi': 0.8518310047352886}-{'f1_val': 0.8184529197577872, 'auprc': 0.942116502909655, 'loss_val': 0.5006547269215396, 'psi': 0.8679183530185344}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.8005 head_norm=1.702740
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.502851e-02
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.8005 head_norm=1.698848 delta_norm=0.055029
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] START round=29 head_norm_before_train=1.390978 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.750539 metrics={'f1_val': 0.6836231259306449, 'auprc': 0.8663751978594364, 'loss_val': 0.49768338959304975, 'psi': 0.7567239547021615}-{'f1_val': 0.5223182939169817, 'auprc': 0.7822188673908668, 'loss_val': 0.7784630229625995, 'psi': 0.6262785233065358}
[S8] START round=29 head_norm_before_train=1.418732 cos_to_last_merge=0.9994 (last merge round=27)
[S8] round=29 local utility u=0.003810 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9974444960765604, 'loss_val': 0.06701205623497022, 'psi': 0.9966996604707159}-{'f1_val': 0.9966398743144329, 'auprc': 0.997551338043394, 'loss_val': 0.0775734651810526, 'psi': 0.9970044598060173}
[S9] START round=29 head_norm_before_train=1.701270 cos_to_last_merge=0.9996 (last merge round=25)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9956433335923135, 'loss_val': 0.02840945514817686, 'psi': 0.9962536405252602}-{'f1_val': 0.9971029125121428, 'auprc': 0.9964355550431384, 'loss_val': 0.03042664195555543, 'psi': 0.996835969524541}
[S10] START round=29 head_norm_before_train=2.047035 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.99393134655043, 'auprc': 0.9971365568469376, 'loss_val': 0.04499244773488938, 'psi': 0.995213430669033}-{'f1_val': 0.994614115641838, 'auprc': 0.9973110401289592, 'loss_val': 0.04324508996578295, 'psi': 0.9956928854366864}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=29 head_norm_before_train=2.047035 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=29 local utility u=0.001960 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9980574205491748, 'loss_val': 0.027505740381008288, 'psi': 0.9972961981252886}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981047327658892, 'loss_val': 0.030117672229639188, 'psi': 0.9971700958145094}
[S13] START round=29 head_norm_before_train=2.053708 cos_to_last_merge=0.9999 (last merge round=26)
[S13] round=29 local utility u=0.604137 metrics={'f1_val': 0.7134983107384446, 'auprc': 0.6738387612319742, 'loss_val': 0.8062139615448692, 'psi': 0.6976344909358565}-{'f1_val': 0.5922270808151151, 'auprc': 0.6077343912213616, 'loss_val': 1.0885482569931257, 'psi': 0.5984300049776137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] sending update (kind=head size=1792 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.7135 head_norm=2.060904
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.948337e-02
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.7039 head_norm=2.069280 delta_norm=0.039483
[S13] aggregate: ROLLBACK (f1_val pre=0.713 post=0.704 tol_abs=0.005 tol_rel=0.0)
[S14] START round=29 head_norm_before_train=2.078372 cos_to_last_merge=0.9998 (last merge round=26)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9684607423282106, 'auprc': 0.997791952324118, 'loss_val': 0.11579828209751833, 'psi': 0.9801932263265735}-{'f1_val': 0.9967774409524363, 'auprc': 0.9977275774343817, 'loss_val': 0.03848446057449689, 'psi': 0.9971574955452145}
[S15] START round=29 head_norm_before_train=1.411766 cos_to_last_merge=0.9994 (last merge round=27)
[S15] round=29 local utility u=0.221370 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9941001329607468, 'loss_val': 0.049532662758456136, 'psi': 0.9956880542168111}-{'f1_val': 0.9332132365574981, 'auprc': 0.9938741242949556, 'loss_val': 0.11039452225524235, 'psi': 0.957477591652481}
[S16] START round=29 head_norm_before_train=1.413334 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.021557 metrics={'f1_val': 0.9392772710101216, 'auprc': 0.9872253839940348, 'loss_val': 0.2081987112438395, 'psi': 0.9584565162036869}-{'f1_val': 0.9380383670110022, 'auprc': 0.9853973564327027, 'loss_val': 0.23839486890628123, 'psi': 0.9569819627796823}
[S17] START round=29 head_norm_before_train=2.086010 cos_to_last_merge=0.9994 (last merge round=25)
[S17] round=29 local utility u=0.191716 metrics={'f1_val': 0.6265257152728851, 'auprc': 0.8427598527877314, 'loss_val': 1.173576818974196, 'psi': 0.7130193702788237}-{'f1_val': 0.6009313822447999, 'auprc': 0.811627287125295, 'loss_val': 1.31004423427027, 'psi': 0.685209744196998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:38404
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:38409
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:38411
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1797 to 1 peers)
[S17] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=29 metric=0.8314 head_norm=1.826259
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.331870e-02
[S2] stored merged vector for next round verification (round=29)
[S2] DEBUG after merge:  round=29 metric=0.8314 head_norm=1.815063 delta_norm=0.063319
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] cosine check vs S16: cos=0.9589
[S16] RECEIVED delta(kind=head bytes=1801) from S8
[S16] cosine check vs S8: cos=0.9969
[S6] RECEIVED delta(kind=head bytes=1797) from S3
[S6] cosine check vs S3: cos=0.9986
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=0.9970
[S8] RECEIVED delta(kind=head bytes=1802) from S7
[S8] cosine check vs S7: cos=0.8085
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] cosine check vs S15: cos=0.9981
[S10] RECEIVED delta(kind=head bytes=1792) from S11
[S10] cosine check vs S11: cos=0.9998
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9962 head_norm=1.454429
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.431986e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9962 head_norm=1.359998 delta_norm=0.443199
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.6836 head_norm=1.405943
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.752996e-02
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.6834 head_norm=1.442121 delta_norm=0.057530
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9393 head_norm=1.444678
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.744253e-02
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9387 head_norm=1.448424 delta_norm=0.057443
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.815063 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=30 local utility u=0.169875 metrics={'f1_val': 0.8315071592437895, 'auprc': 0.9078102684642411, 'loss_val': 0.38118139292234354, 'psi': 0.8620284029319701}-{'f1_val': 0.831402644800177, 'auprc': 0.8067136385494388, 'loss_val': 0.417015017752952, 'psi': 0.8215270422998817}
[S3] START round=30 head_norm_before_train=1.711269 cos_to_last_merge=0.9999 (last merge round=28)
[S3] round=30 local utility u=0.002959 metrics={'f1_val': 0.9965365984006044, 'auprc': 0.9990852007274921, 'loss_val': 0.08031884682923648, 'psi': 0.9975560393313594}-{'f1_val': 0.9973670153333725, 'auprc': 0.9991837113052628, 'loss_val': 0.0915147028472461, 'psi': 0.9980936937221286}
[S4] START round=30 head_norm_before_train=1.487323 cos_to_last_merge=0.9834 (last merge round=22)
[S4] round=30 local utility u=0.119412 metrics={'f1_val': 0.9440494493626094, 'auprc': 0.9610244219354944, 'loss_val': 0.27024057257425416, 'psi': 0.9508394383917633}-{'f1_val': 0.936433693257227, 'auprc': 0.9260595894652746, 'loss_val': 0.35847488960388185, 'psi': 0.932284051740446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S4] sending update (kind=head size=1809 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9440 head_norm=1.503841
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.167981e-01
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9440 head_norm=1.458532 delta_norm=0.216798
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] START round=30 head_norm_before_train=1.819795 cos_to_last_merge=0.9995 (last merge round=27)
[S5] round=30 local utility u=0.146028 metrics={'f1_val': 0.6665774687569381, 'auprc': 0.8534810081704928, 'loss_val': 0.4574950776148205, 'psi': 0.7413388845223601}-{'f1_val': 0.6287555772413124, 'auprc': 0.8535981307825098, 'loss_val': 0.5229714993188452, 'psi': 0.7186925986577913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=30 head_norm_before_train=1.698848 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.265336 metrics={'f1_val': 0.8661887679859411, 'auprc': 0.9563654623027977, 'loss_val': 0.382260373070535, 'psi': 0.9022594457126838}-{'f1_val': 0.8005163640118524, 'auprc': 0.9288029658204426, 'loss_val': 0.4362094927990047, 'psi': 0.8518310047352886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.8662 head_norm=1.717269
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.524468e-02
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.8662 head_norm=1.713382 delta_norm=0.055245
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] START round=30 head_norm_before_train=1.442121 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.6248648234614068, 'auprc': 0.794789402827507, 'loss_val': 0.6085479391210784, 'psi': 0.6928346552078469}-{'f1_val': 0.6836231259306449, 'auprc': 0.8663751978594364, 'loss_val': 0.49768338959304975, 'psi': 0.7567239547021615}
[S8] START round=30 head_norm_before_train=1.359998 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.996435990324871, 'loss_val': 0.08086535796060801, 'psi': 0.9962962581700401}-{'f1_val': 0.9962031034001528, 'auprc': 0.9974444960765604, 'loss_val': 0.06701205623497022, 'psi': 0.9966996604707159}
[S9] START round=30 head_norm_before_train=1.718731 cos_to_last_merge=0.9993 (last merge round=25)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9901183584159563, 'auprc': 0.9988464559065384, 'loss_val': 0.04024139070617282, 'psi': 0.9936095974121891}-{'f1_val': 0.9966605118138915, 'auprc': 0.9956433335923135, 'loss_val': 0.02840945514817686, 'psi': 0.9962536405252602}
[S10] START round=30 head_norm_before_train=2.068804 cos_to_last_merge=0.9999 (last merge round=28)
[S10] round=30 local utility u=0.001497 metrics={'f1_val': 0.9937365524730105, 'auprc': 0.9974187953288517, 'loss_val': 0.04167707516007995, 'psi': 0.995209449615347}-{'f1_val': 0.99393134655043, 'auprc': 0.9971365568469376, 'loss_val': 0.04499244773488938, 'psi': 0.995213430669033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.9937 head_norm=2.088993
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.322314e-02
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.9937 head_norm=2.076916 delta_norm=0.033223
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] START round=30 head_norm_before_train=2.065304 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=30 local utility u=0.000639 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.997809544301859, 'loss_val': 0.025607238166745958, 'psi': 0.9972093275764908}-{'f1_val': 0.9967887165093644, 'auprc': 0.9980574205491748, 'loss_val': 0.027505740381008288, 'psi': 0.9972961981252886}
[S13] START round=30 head_norm_before_train=2.069280 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.653264641182588, 'auprc': 0.6222535304461625, 'loss_val': 1.0269978010397178, 'psi': 0.6408601968880178}-{'f1_val': 0.7134983107384446, 'auprc': 0.6738387612319742, 'loss_val': 0.8062139615448692, 'psi': 0.6976344909358565}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=2.089441 cos_to_last_merge=0.9997 (last merge round=26)
[S14] round=30 local utility u=0.086230 metrics={'f1_val': 0.9882365652992516, 'auprc': 0.9996183121003709, 'loss_val': 0.06747132193909484, 'psi': 0.9927892640196994}-{'f1_val': 0.9684607423282106, 'auprc': 0.997791952324118, 'loss_val': 0.11579828209751833, 'psi': 0.9801932263265735}
[S15] START round=30 head_norm_before_train=1.479651 cos_to_last_merge=0.9976 (last merge round=27)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.7007659221024161, 'auprc': 0.8482946218720955, 'loss_val': 0.5522100109521908, 'psi': 0.7597774020102879}-{'f1_val': 0.9967466683875206, 'auprc': 0.9941001329607468, 'loss_val': 0.049532662758456136, 'psi': 0.9956880542168111}
[S16] START round=30 head_norm_before_train=1.448424 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9378658570508742, 'auprc': 0.983829373193114, 'loss_val': 0.22538450499014528, 'psi': 0.9562512635077701}-{'f1_val': 0.9392772710101216, 'auprc': 0.9872253839940348, 'loss_val': 0.2081987112438395, 'psi': 0.9584565162036869}
[S17] START round=30 head_norm_before_train=2.101870 cos_to_last_merge=0.9992 (last merge round=25)
[S17] round=30 local utility u=0.013695 metrics={'f1_val': 0.6153172182430144, 'auprc': 0.8670288763249813, 'loss_val': 1.1517424976635535, 'psi': 0.7160018814758011}-{'f1_val': 0.6265257152728851, 'auprc': 0.8427598527877314, 'loss_val': 1.173576818974196, 'psi': 0.7130193702788237}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9882 head_norm=2.099081
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.517168e-02
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9876 head_norm=2.098748 delta_norm=0.085172
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=31 head_norm_before_train=1.828616 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.8322785958953889, 'auprc': 0.8679346476491929, 'loss_val': 0.3696671372153206, 'psi': 0.8465410165969105}-{'f1_val': 0.8315071592437895, 'auprc': 0.9078102684642411, 'loss_val': 0.38118139292234354, 'psi': 0.8620284029319701}
[S3] START round=31 head_norm_before_train=1.731685 cos_to_last_merge=0.9995 (last merge round=28)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9988874435444062, 'loss_val': 0.09265348590993001, 'psi': 0.976454265581714}-{'f1_val': 0.9965365984006044, 'auprc': 0.9990852007274921, 'loss_val': 0.08031884682923648, 'psi': 0.9975560393313594}
[S4] START round=31 head_norm_before_train=1.458532 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.018240 metrics={'f1_val': 0.9437581307166355, 'auprc': 0.9692976638715047, 'loss_val': 0.25683143213551535, 'psi': 0.9539739439785831}-{'f1_val': 0.9440494493626094, 'auprc': 0.9610244219354944, 'loss_val': 0.27024057257425416, 'psi': 0.9508394383917633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=31 head_norm_before_train=1.835110 cos_to_last_merge=0.9990 (last merge round=27)
[S5] round=31 local utility u=0.239110 metrics={'f1_val': 0.6774994057328141, 'auprc': 0.9469100020417272, 'loss_val': 0.3250937725059484, 'psi': 0.7852636442563793}-{'f1_val': 0.6665774687569381, 'auprc': 0.8534810081704928, 'loss_val': 0.4574950776148205, 'psi': 0.7413388845223601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=31 head_norm_before_train=1.713382 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.7693437364862682, 'auprc': 0.9446842664599365, 'loss_val': 0.5866328200324092, 'psi': 0.8394799484757356}-{'f1_val': 0.8661887679859411, 'auprc': 0.9563654623027977, 'loss_val': 0.382260373070535, 'psi': 0.9022594457126838}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=1.457087 cos_to_last_merge=0.9998 (last merge round=29)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.5640780083861715, 'auprc': 0.7853962317467583, 'loss_val': 0.7100185748092885, 'psi': 0.6526052977304062}-{'f1_val': 0.6248648234614068, 'auprc': 0.794789402827507, 'loss_val': 0.6085479391210784, 'psi': 0.6928346552078469}
[S8] START round=31 head_norm_before_train=1.396872 cos_to_last_merge=0.9997 (last merge round=29)
[S8] round=31 local utility u=0.006271 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.9959086500783003, 'loss_val': 0.0684625457958019, 'psi': 0.9962574846697219}-{'f1_val': 0.9962031034001528, 'auprc': 0.996435990324871, 'loss_val': 0.08086535796060801, 'psi': 0.9962962581700401}
[S9] START round=31 head_norm_before_train=1.734011 cos_to_last_merge=0.9990 (last merge round=25)
[S9] round=31 local utility u=0.022048 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9955370993484126, 'loss_val': 0.02546955811695065, 'psi': 0.9962111468277}-{'f1_val': 0.9901183584159563, 'auprc': 0.9988464559065384, 'loss_val': 0.04024139070617282, 'psi': 0.9936095974121891}
[S10] START round=31 head_norm_before_train=2.076916 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.003394 metrics={'f1_val': 0.9948336929542084, 'auprc': 0.9952067356070402, 'loss_val': 0.03483570148057506, 'psi': 0.9949829100153411}-{'f1_val': 0.9937365524730105, 'auprc': 0.9974187953288517, 'loss_val': 0.04167707516007995, 'psi': 0.995209449615347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=31 head_norm_before_train=2.080665 cos_to_last_merge=0.9999 (last merge round=28)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.996740869789898, 'loss_val': 0.02704210196419364, 'psi': 0.9966368302996874}-{'f1_val': 0.9968091830929121, 'auprc': 0.997809544301859, 'loss_val': 0.025607238166745958, 'psi': 0.9972093275764908}
[S13] START round=31 head_norm_before_train=2.078592 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=31 local utility u=0.042305 metrics={'f1_val': 0.6534299140650636, 'auprc': 0.6282075074182306, 'loss_val': 0.9612414130052723, 'psi': 0.6433409514063304}-{'f1_val': 0.653264641182588, 'auprc': 0.6222535304461625, 'loss_val': 1.0269978010397178, 'psi': 0.6408601968880178}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=31 head_norm_before_train=2.098748 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.042834 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9994566139967854, 'loss_val': 0.03489009191039525, 'psi': 0.9980818213973692}-{'f1_val': 0.9882365652992516, 'auprc': 0.9996183121003709, 'loss_val': 0.06747132193909484, 'psi': 0.9927892640196994}
[S15] START round=31 head_norm_before_train=1.538242 cos_to_last_merge=0.9955 (last merge round=27)
[S15] round=31 local utility u=1.000000 metrics={'f1_val': 0.9960528144333213, 'auprc': 0.9974408966286338, 'loss_val': 0.03321055648751728, 'psi': 0.9966080473114463}-{'f1_val': 0.7007659221024161, 'auprc': 0.8482946218720955, 'loss_val': 0.5522100109521908, 'psi': 0.7597774020102879}
[S16] START round=31 head_norm_before_train=1.477275 cos_to_last_merge=0.9998 (last merge round=29)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9353267421527613, 'auprc': 0.9834079382466027, 'loss_val': 0.2665231734239697, 'psi': 0.9545592205902979}-{'f1_val': 0.9378658570508742, 'auprc': 0.983829373193114, 'loss_val': 0.22538450499014528, 'psi': 0.9562512635077701}
[S17] START round=31 head_norm_before_train=2.116781 cos_to_last_merge=0.9988 (last merge round=25)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.5828595197590765, 'auprc': 0.8105186873409798, 'loss_val': 1.2441403524232986, 'psi': 0.6739231867918378}-{'f1_val': 0.6153172182430144, 'auprc': 0.8670288763249813, 'loss_val': 1.1517424976635535, 'psi': 0.7160018814758011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.844118 cos_to_last_merge=0.9999 (last merge round=29)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.8314976379130198, 'auprc': 0.8298325623087845, 'loss_val': 0.4018546178600818, 'psi': 0.8308316076713257}-{'f1_val': 0.8322785958953889, 'auprc': 0.8679346476491929, 'loss_val': 0.3696671372153206, 'psi': 0.8465410165969105}
[S3] START round=32 head_norm_before_train=1.751434 cos_to_last_merge=0.9989 (last merge round=28)
[S3] round=32 local utility u=0.078162 metrics={'f1_val': 0.9839785841484517, 'auprc': 0.998134541586153, 'loss_val': 0.06894951375359692, 'psi': 0.9896409671235322}-{'f1_val': 0.961498813606586, 'auprc': 0.9988874435444062, 'loss_val': 0.09265348590993001, 'psi': 0.976454265581714}
[S4] START round=32 head_norm_before_train=1.477368 cos_to_last_merge=0.9999 (last merge round=30)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9438298016908501, 'auprc': 0.9650348070368977, 'loss_val': 0.26356225334409533, 'psi': 0.9523118038292692}-{'f1_val': 0.9437581307166355, 'auprc': 0.9692976638715047, 'loss_val': 0.25683143213551535, 'psi': 0.9539739439785831}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.847602 cos_to_last_merge=0.9987 (last merge round=27)
[S5] round=32 local utility u=0.134158 metrics={'f1_val': 0.6995487752989087, 'auprc': 0.9727577814095871, 'loss_val': 0.2666172274090505, 'psi': 0.8088323777431801}-{'f1_val': 0.6774994057328141, 'auprc': 0.9469100020417272, 'loss_val': 0.3250937725059484, 'psi': 0.7852636442563793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=32 head_norm_before_train=1.731008 cos_to_last_merge=0.9999 (last merge round=30)
[S6] round=32 local utility u=0.141813 metrics={'f1_val': 0.8096292305626687, 'auprc': 0.9382502057571165, 'loss_val': 0.5254176626534267, 'psi': 0.8610776206404478}-{'f1_val': 0.7693437364862682, 'auprc': 0.9446842664599365, 'loss_val': 0.5866328200324092, 'psi': 0.8394799484757356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=32 head_norm_before_train=1.469821 cos_to_last_merge=0.9993 (last merge round=29)
[S7] round=32 local utility u=0.028622 metrics={'f1_val': 0.5699261601839816, 'auprc': 0.7860009651773926, 'loss_val': 0.6896778853671965, 'psi': 0.656356082181346}-{'f1_val': 0.5640780083861715, 'auprc': 0.7853962317467583, 'loss_val': 0.7100185748092885, 'psi': 0.6526052977304062}
[S8] START round=32 head_norm_before_train=1.433799 cos_to_last_merge=0.9987 (last merge round=29)
[S8] round=32 local utility u=0.005382 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9973022841309342, 'loss_val': 0.0610576761286691, 'psi': 0.9967327586137484}-{'f1_val': 0.9964900410640029, 'auprc': 0.9959086500783003, 'loss_val': 0.0684625457958019, 'psi': 0.9962574846697219}
[S9] START round=32 head_norm_before_train=1.749590 cos_to_last_merge=0.9986 (last merge round=25)
[S9] round=32 local utility u=0.002172 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9958297464800426, 'loss_val': 0.02465834135842215, 'psi': 0.9965936460993028}-{'f1_val': 0.9966605118138915, 'auprc': 0.9955370993484126, 'loss_val': 0.02546955811695065, 'psi': 0.9962111468277}
[S10] START round=32 head_norm_before_train=2.095486 cos_to_last_merge=0.9999 (last merge round=30)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9951148013850434, 'auprc': 0.9964881783174109, 'loss_val': 0.040474763820593423, 'psi': 0.9956641521579904}-{'f1_val': 0.9948336929542084, 'auprc': 0.9952067356070402, 'loss_val': 0.03483570148057506, 'psi': 0.9949829100153411}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=2.092471 cos_to_last_merge=0.9997 (last merge round=28)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9967364632798296, 'loss_val': 0.03051256874876509, 'psi': 0.996387070158379}-{'f1_val': 0.996567470639547, 'auprc': 0.996740869789898, 'loss_val': 0.02704210196419364, 'psi': 0.9966368302996874}
[S13] START round=32 head_norm_before_train=2.088573 cos_to_last_merge=0.9999 (last merge round=29)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.645409678926778, 'auprc': 0.6287034506453413, 'loss_val': 0.967281079637184, 'psi': 0.6387271876142033}-{'f1_val': 0.6534299140650636, 'auprc': 0.6282075074182306, 'loss_val': 0.9612414130052723, 'psi': 0.6433409514063304}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=2.108810 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=32 local utility u=0.001909 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9997855926690319, 'loss_val': 0.03351638177691064, 'psi': 0.9983591987686481}-{'f1_val': 0.9971652929977585, 'auprc': 0.9994566139967854, 'loss_val': 0.03489009191039525, 'psi': 0.9980818213973692}
[S15] START round=32 head_norm_before_train=1.585600 cos_to_last_merge=0.9935 (last merge round=27)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.8631917346573595, 'auprc': 0.9795535120923902, 'loss_val': 0.29190841959444136, 'psi': 0.9097364456313719}-{'f1_val': 0.9960528144333213, 'auprc': 0.9974408966286338, 'loss_val': 0.03321055648751728, 'psi': 0.9966080473114463}
[S16] START round=32 head_norm_before_train=1.503943 cos_to_last_merge=0.9994 (last merge round=29)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9290693855406426, 'auprc': 0.9833797829372074, 'loss_val': 0.29458123565473127, 'psi': 0.9507935444992686}-{'f1_val': 0.9353267421527613, 'auprc': 0.9834079382466027, 'loss_val': 0.2665231734239697, 'psi': 0.9545592205902979}
[S17] START round=32 head_norm_before_train=2.130489 cos_to_last_merge=0.9985 (last merge round=25)
[S17] round=32 local utility u=1.000000 metrics={'f1_val': 0.8810607153629058, 'auprc': 0.9999573644219106, 'loss_val': 0.19307791214740438, 'psi': 0.9286193749865077}-{'f1_val': 0.5828595197590765, 'auprc': 0.8105186873409798, 'loss_val': 1.2441403524232986, 'psi': 0.6739231867918378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S2] START round=33 head_norm_before_train=1.859161 cos_to_last_merge=0.9998 (last merge round=29)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.723132535747387, 'auprc': 0.8558882311895311, 'loss_val': 0.671254238699842, 'psi': 0.7762348139242445}-{'f1_val': 0.8314976379130198, 'auprc': 0.8298325623087845, 'loss_val': 0.4018546178600818, 'psi': 0.8308316076713257}
[S3] START round=33 head_norm_before_train=1.770231 cos_to_last_merge=0.9982 (last merge round=28)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9972235133844578, 'loss_val': 0.10362267190764843, 'psi': 0.9755105560170493}-{'f1_val': 0.9839785841484517, 'auprc': 0.998134541586153, 'loss_val': 0.06894951375359692, 'psi': 0.9896409671235322}
[S4] START round=33 head_norm_before_train=1.499766 cos_to_last_merge=0.9995 (last merge round=30)
[S4] round=33 local utility u=0.002183 metrics={'f1_val': 0.9454960009360824, 'auprc': 0.9614255698166179, 'loss_val': 0.25836487623703147, 'psi': 0.9518678284882967}-{'f1_val': 0.9438298016908501, 'auprc': 0.9650348070368977, 'loss_val': 0.26356225334409533, 'psi': 0.9523118038292692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=33 head_norm_before_train=1.857164 cos_to_last_merge=0.9984 (last merge round=27)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.43066828059020756, 'auprc': 0.8494840325239317, 'loss_val': 1.0774451773290525, 'psi': 0.5981945813636972}-{'f1_val': 0.6995487752989087, 'auprc': 0.9727577814095871, 'loss_val': 0.2666172274090505, 'psi': 0.8088323777431801}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.758435 cos_to_last_merge=0.9994 (last merge round=30)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.6157545152435498, 'auprc': 0.7556394551443526, 'loss_val': 0.8467942249211099, 'psi': 0.6717084912038709}-{'f1_val': 0.8096292305626687, 'auprc': 0.9382502057571165, 'loss_val': 0.5254176626534267, 'psi': 0.8610776206404478}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.478967 cos_to_last_merge=0.9986 (last merge round=29)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.5516578925335697, 'auprc': 0.7834826083994562, 'loss_val': 0.7435554648955573, 'psi': 0.6443877788799243}-{'f1_val': 0.5699261601839816, 'auprc': 0.7860009651773926, 'loss_val': 0.6896778853671965, 'psi': 0.656356082181346}
[S8] START round=33 head_norm_before_train=1.463522 cos_to_last_merge=0.9976 (last merge round=29)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9913622732478684, 'loss_val': 0.057536738526120124, 'psi': 0.994266771339239}-{'f1_val': 0.9963530749356245, 'auprc': 0.9973022841309342, 'loss_val': 0.0610576761286691, 'psi': 0.9967327586137484}
[S9] START round=33 head_norm_before_train=1.763609 cos_to_last_merge=0.9981 (last merge round=25)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9996000122639663, 'loss_val': 0.02876960270148542, 'psi': 0.9963538287559262}-{'f1_val': 0.9971029125121428, 'auprc': 0.9958297464800426, 'loss_val': 0.02465834135842215, 'psi': 0.9965936460993028}
[S10] START round=33 head_norm_before_train=2.110810 cos_to_last_merge=0.9998 (last merge round=30)
[S10] round=33 local utility u=0.002415 metrics={'f1_val': 0.9951148013850434, 'auprc': 0.9966055598817957, 'loss_val': 0.03599596745417035, 'psi': 0.9957111047837444}-{'f1_val': 0.9951148013850434, 'auprc': 0.9964881783174109, 'loss_val': 0.040474763820593423, 'psi': 0.9956641521579904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=33 head_norm_before_train=2.103741 cos_to_last_merge=0.9995 (last merge round=28)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9944720429924395, 'auprc': 0.9967207471691953, 'loss_val': 0.034599219917804944, 'psi': 0.9953715246631418}-{'f1_val': 0.9961541414107454, 'auprc': 0.9967364632798296, 'loss_val': 0.03051256874876509, 'psi': 0.996387070158379}
[S13] START round=33 head_norm_before_train=2.096793 cos_to_last_merge=0.9998 (last merge round=29)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.6442135427946808, 'auprc': 0.60760110239826, 'loss_val': 1.0615268772891968, 'psi': 0.6295685666361125}-{'f1_val': 0.645409678926778, 'auprc': 0.6287034506453413, 'loss_val': 0.967281079637184, 'psi': 0.6387271876142033}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=2.120364 cos_to_last_merge=0.9999 (last merge round=30)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9926782858135927, 'auprc': 0.9996306362943556, 'loss_val': 0.04489903193489557, 'psi': 0.9954592260058979}-{'f1_val': 0.9974082695017256, 'auprc': 0.9997855926690319, 'loss_val': 0.03351638177691064, 'psi': 0.9983591987686481}
[S15] START round=33 head_norm_before_train=1.620393 cos_to_last_merge=0.9921 (last merge round=27)
[S15] round=33 local utility u=0.548932 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9912993987139863, 'loss_val': 0.030612432249071248, 'psi': 0.9945677605181069}-{'f1_val': 0.8631917346573595, 'auprc': 0.9795535120923902, 'loss_val': 0.29190841959444136, 'psi': 0.9097364456313719}
[S16] START round=33 head_norm_before_train=1.527927 cos_to_last_merge=0.9989 (last merge round=29)
[S16] round=33 local utility u=0.005217 metrics={'f1_val': 0.92990344701835, 'auprc': 0.9837703951566447, 'loss_val': 0.2903242088788548, 'psi': 0.9514502262736679}-{'f1_val': 0.9290693855406426, 'auprc': 0.9833797829372074, 'loss_val': 0.29458123565473127, 'psi': 0.9507935444992686}
[S17] START round=33 head_norm_before_train=2.144825 cos_to_last_merge=0.9981 (last merge round=25)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.5813997621219714, 'auprc': 0.888698232210728, 'loss_val': 1.291852152462361, 'psi': 0.704319150157474}-{'f1_val': 0.8810607153629058, 'auprc': 0.9999573644219106, 'loss_val': 0.19307791214740438, 'psi': 0.9286193749865077}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.866484 cos_to_last_merge=0.9995 (last merge round=29)
[S2] round=34 local utility u=0.590882 metrics={'f1_val': 0.8315071592437895, 'auprc': 0.9402569132261765, 'loss_val': 0.39284406793332455, 'psi': 0.8750070608367444}-{'f1_val': 0.723132535747387, 'auprc': 0.8558882311895311, 'loss_val': 0.671254238699842, 'psi': 0.7762348139242445}
[S3] START round=34 head_norm_before_train=1.786791 cos_to_last_merge=0.9974 (last merge round=28)
[S3] round=34 local utility u=0.140439 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9981391050426369, 'loss_val': 0.04349736085886701, 'psi': 0.997677460612107}-{'f1_val': 0.9610352511054436, 'auprc': 0.9972235133844578, 'loss_val': 0.10362267190764843, 'psi': 0.9755105560170493}
[S4] START round=34 head_norm_before_train=1.519778 cos_to_last_merge=0.9989 (last merge round=30)
[S4] round=34 local utility u=0.000203 metrics={'f1_val': 0.9438947372691209, 'auprc': 0.9691313167976139, 'loss_val': 0.2714695346588836, 'psi': 0.9539893690805181}-{'f1_val': 0.9454960009360824, 'auprc': 0.9614255698166179, 'loss_val': 0.25836487623703147, 'psi': 0.9518678284882967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=34 head_norm_before_train=1.867409 cos_to_last_merge=0.9980 (last merge round=27)
[S5] round=34 local utility u=0.906836 metrics={'f1_val': 0.6276224281472144, 'auprc': 0.8595867238249371, 'loss_val': 0.475806289611898, 'psi': 0.7204081464183034}-{'f1_val': 0.43066828059020756, 'auprc': 0.8494840325239317, 'loss_val': 1.0774451773290525, 'psi': 0.5981945813636972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=34 head_norm_before_train=1.781796 cos_to_last_merge=0.9987 (last merge round=30)
[S6] round=34 local utility u=1.000000 metrics={'f1_val': 0.8225244409087689, 'auprc': 0.9552787047082818, 'loss_val': 0.3645323949025978, 'psi': 0.875626146428574}-{'f1_val': 0.6157545152435498, 'auprc': 0.7556394551443526, 'loss_val': 0.8467942249211099, 'psi': 0.6717084912038709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=34 head_norm_before_train=1.487400 cos_to_last_merge=0.9980 (last merge round=29)
[S7] round=34 local utility u=0.352499 metrics={'f1_val': 0.6310792194937519, 'auprc': 0.7995233315728354, 'loss_val': 0.5632084450612376, 'psi': 0.6984568643253853}-{'f1_val': 0.5516578925335697, 'auprc': 0.7834826083994562, 'loss_val': 0.7435554648955573, 'psi': 0.6443877788799243}
[S8] START round=34 head_norm_before_train=1.489424 cos_to_last_merge=0.9964 (last merge round=29)
[S8] round=34 local utility u=0.012030 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9971087885429679, 'loss_val': 0.05161604721845181, 'psi': 0.996655360378562}-{'f1_val': 0.9962031034001528, 'auprc': 0.9913622732478684, 'loss_val': 0.057536738526120124, 'psi': 0.994266771339239}
[S9] START round=34 head_norm_before_train=1.776362 cos_to_last_merge=0.9977 (last merge round=25)
[S9] round=34 local utility u=0.006792 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9970467134119625, 'loss_val': 0.022349739432552244, 'psi': 0.9968149924531199}-{'f1_val': 0.9941897064172326, 'auprc': 0.9996000122639663, 'loss_val': 0.02876960270148542, 'psi': 0.9963538287559262}
[S10] START round=34 head_norm_before_train=2.126581 cos_to_last_merge=0.9996 (last merge round=30)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9949196380141286, 'auprc': 0.9936879679883313, 'loss_val': 0.036374583683063545, 'psi': 0.9944269700038098}-{'f1_val': 0.9951148013850434, 'auprc': 0.9966055598817957, 'loss_val': 0.03599596745417035, 'psi': 0.9957111047837444}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=2.115814 cos_to_last_merge=0.9993 (last merge round=28)
[S11] round=34 local utility u=0.011068 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9967381797915443, 'loss_val': 0.024059162608802028, 'psi': 0.9965327842350842}-{'f1_val': 0.9944720429924395, 'auprc': 0.9967207471691953, 'loss_val': 0.034599219917804944, 'psi': 0.9953715246631418}
[S13] START round=34 head_norm_before_train=2.103949 cos_to_last_merge=0.9996 (last merge round=29)
[S13] round=34 local utility u=0.214051 metrics={'f1_val': 0.6425422582986036, 'auprc': 0.6928391722286609, 'loss_val': 0.8791117151183409, 'psi': 0.6626610238706265}-{'f1_val': 0.6442135427946808, 'auprc': 0.60760110239826, 'loss_val': 1.0615268772891968, 'psi': 0.6295685666361125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=34 head_norm_before_train=2.132489 cos_to_last_merge=0.9998 (last merge round=30)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9904379866573485, 'auprc': 0.9996151580358106, 'loss_val': 0.0497631658469781, 'psi': 0.9941088552087334}-{'f1_val': 0.9926782858135927, 'auprc': 0.9996306362943556, 'loss_val': 0.04489903193489557, 'psi': 0.9954592260058979}
[S15] START round=34 head_norm_before_train=1.650778 cos_to_last_merge=0.9907 (last merge round=27)
[S15] round=34 local utility u=0.000944 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9912819325373399, 'loss_val': 0.02608994644071248, 'psi': 0.9943026357874887}-{'f1_val': 0.9967466683875206, 'auprc': 0.9912993987139863, 'loss_val': 0.030612432249071248, 'psi': 0.9945677605181069}
[S16] START round=34 head_norm_before_train=1.549915 cos_to_last_merge=0.9983 (last merge round=29)
[S16] round=34 local utility u=0.051143 metrics={'f1_val': 0.9376228338867945, 'auprc': 0.982590078191818, 'loss_val': 0.2308136614986595, 'psi': 0.9556097316088039}-{'f1_val': 0.92990344701835, 'auprc': 0.9837703951566447, 'loss_val': 0.2903242088788548, 'psi': 0.9514502262736679}
[S17] START round=34 head_norm_before_train=2.149352 cos_to_last_merge=0.9979 (last merge round=25)
[S17] round=34 local utility u=0.946758 metrics={'f1_val': 0.7878250378824441, 'auprc': 0.9231488092710258, 'loss_val': 0.7402390314315221, 'psi': 0.8419545464378768}-{'f1_val': 0.5813997621219714, 'auprc': 0.888698232210728, 'loss_val': 1.291852152462361, 'psi': 0.704319150157474}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S2] START round=35 head_norm_before_train=1.874834 cos_to_last_merge=0.9993 (last merge round=29)
[S2] round=35 local utility u=0.058435 metrics={'f1_val': 0.8284079229120294, 'auprc': 0.9912821537950716, 'loss_val': 0.41045521840237814, 'psi': 0.8935576152652462}-{'f1_val': 0.8315071592437895, 'auprc': 0.9402569132261765, 'loss_val': 0.39284406793332455, 'psi': 0.8750070608367444}
[S3] START round=35 head_norm_before_train=1.800127 cos_to_last_merge=0.9967 (last merge round=28)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9393375990841639, 'auprc': 0.9958283303029305, 'loss_val': 0.13497379063813783, 'psi': 0.9619338915716705}-{'f1_val': 0.9973696976584205, 'auprc': 0.9981391050426369, 'loss_val': 0.04349736085886701, 'psi': 0.997677460612107}
[S4] START round=35 head_norm_before_train=1.539572 cos_to_last_merge=0.9982 (last merge round=30)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9417751223536226, 'auprc': 0.9555351417495445, 'loss_val': 0.2961147775237692, 'psi': 0.9472791301119913}-{'f1_val': 0.9438947372691209, 'auprc': 0.9691313167976139, 'loss_val': 0.2714695346588836, 'psi': 0.9539893690805181}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.875995 cos_to_last_merge=0.9977 (last merge round=27)
[S5] round=35 local utility u=0.552146 metrics={'f1_val': 0.7017724816427158, 'auprc': 0.9892760925485531, 'loss_val': 0.20548246308624207, 'psi': 0.8167739260050507}-{'f1_val': 0.6276224281472144, 'auprc': 0.8595867238249371, 'loss_val': 0.475806289611898, 'psi': 0.7204081464183034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=35 head_norm_before_train=1.801336 cos_to_last_merge=0.9980 (last merge round=30)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.7696915812094403, 'auprc': 0.938505732811094, 'loss_val': 0.6096555915662214, 'psi': 0.8372172418501018}-{'f1_val': 0.8225244409087689, 'auprc': 0.9552787047082818, 'loss_val': 0.3645323949025978, 'psi': 0.875626146428574}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.496352 cos_to_last_merge=0.9975 (last merge round=29)
[S7] round=35 local utility u=0.327000 metrics={'f1_val': 0.6888463710479791, 'auprc': 0.8460884459686924, 'loss_val': 0.39550610627516786, 'psi': 0.7517432010162644}-{'f1_val': 0.6310792194937519, 'auprc': 0.7995233315728354, 'loss_val': 0.5632084450612376, 'psi': 0.6984568643253853}
[S8] START round=35 head_norm_before_train=1.512841 cos_to_last_merge=0.9952 (last merge round=29)
[S8] round=35 local utility u=0.000878 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9963730658072959, 'loss_val': 0.04675400406111871, 'psi': 0.9962710883630101}-{'f1_val': 0.9963530749356245, 'auprc': 0.9971087885429679, 'loss_val': 0.05161604721845181, 'psi': 0.996655360378562}
[S9] START round=35 head_norm_before_train=1.787291 cos_to_last_merge=0.9973 (last merge round=25)
[S9] round=35 local utility u=0.003719 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995970231803573, 'loss_val': 0.022562987329730284, 'psi': 0.9978351163604777}-{'f1_val': 0.9966605118138915, 'auprc': 0.9970467134119625, 'loss_val': 0.022349739432552244, 'psi': 0.9968149924531199}
[S10] START round=35 head_norm_before_train=2.139646 cos_to_last_merge=0.9993 (last merge round=30)
[S10] round=35 local utility u=0.000444 metrics={'f1_val': 0.9942111254316871, 'auprc': 0.9966849196681041, 'loss_val': 0.04022568689086765, 'psi': 0.9952006431262539}-{'f1_val': 0.9949196380141286, 'auprc': 0.9936879679883313, 'loss_val': 0.036374583683063545, 'psi': 0.9944269700038098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=35 head_norm_before_train=2.127058 cos_to_last_merge=0.9991 (last merge round=28)
[S11] round=35 local utility u=0.001241 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997495609184018, 'loss_val': 0.024756228133830143, 'psi': 0.996926446381761}-{'f1_val': 0.9963958538641108, 'auprc': 0.9967381797915443, 'loss_val': 0.024059162608802028, 'psi': 0.9965327842350842}
[S13] START round=35 head_norm_before_train=2.111991 cos_to_last_merge=0.9994 (last merge round=29)
[S13] round=35 local utility u=0.227037 metrics={'f1_val': 0.7301195033379176, 'auprc': 0.6737314110772213, 'loss_val': 0.8931777135275544, 'psi': 0.7075642664336391}-{'f1_val': 0.6425422582986036, 'auprc': 0.6928391722286609, 'loss_val': 0.8791117151183409, 'psi': 0.6626610238706265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=35 head_norm_before_train=2.141998 cos_to_last_merge=0.9997 (last merge round=30)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9376098844374254, 'auprc': 0.999254554698782, 'loss_val': 0.18179841129978483, 'psi': 0.9622677525419681}-{'f1_val': 0.9904379866573485, 'auprc': 0.9996151580358106, 'loss_val': 0.0497631658469781, 'psi': 0.9941088552087334}
[S15] START round=35 head_norm_before_train=1.683050 cos_to_last_merge=0.9893 (last merge round=27)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.8381073156730071, 'auprc': 0.9802682149490514, 'loss_val': 0.3350332924878545, 'psi': 0.8949716753834249}-{'f1_val': 0.9963164379542544, 'auprc': 0.9912819325373399, 'loss_val': 0.02608994644071248, 'psi': 0.9943026357874887}
[S16] START round=35 head_norm_before_train=1.569759 cos_to_last_merge=0.9976 (last merge round=29)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.847274593105651, 'auprc': 0.9848657128959448, 'loss_val': 0.7141283245933157, 'psi': 0.9023110410217685}-{'f1_val': 0.9376228338867945, 'auprc': 0.982590078191818, 'loss_val': 0.2308136614986595, 'psi': 0.9556097316088039}
[S17] START round=35 head_norm_before_train=2.149471 cos_to_last_merge=0.9979 (last merge round=25)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.5279226764053844, 'auprc': 0.7405149209467591, 'loss_val': 1.4347601263919507, 'psi': 0.6129595742219343}-{'f1_val': 0.7878250378824441, 'auprc': 0.9231488092710258, 'loss_val': 0.7402390314315221, 'psi': 0.8419545464378768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S2] START round=36 head_norm_before_train=1.887324 cos_to_last_merge=0.9991 (last merge round=29)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.8255230098493987, 'auprc': 0.9888819111769218, 'loss_val': 0.46896927365188834, 'psi': 0.890866570380408}-{'f1_val': 0.8284079229120294, 'auprc': 0.9912821537950716, 'loss_val': 0.41045521840237814, 'psi': 0.8935576152652462}
[S3] START round=36 head_norm_before_train=1.813398 cos_to_last_merge=0.9960 (last merge round=28)
[S3] round=36 local utility u=0.188488 metrics={'f1_val': 0.9872687231472141, 'auprc': 0.9972833726681427, 'loss_val': 0.04994987961867003, 'psi': 0.9912745829555856}-{'f1_val': 0.9393375990841639, 'auprc': 0.9958283303029305, 'loss_val': 0.13497379063813783, 'psi': 0.9619338915716705}
[S4] START round=36 head_norm_before_train=1.556991 cos_to_last_merge=0.9977 (last merge round=30)
[S4] round=36 local utility u=0.054935 metrics={'f1_val': 0.9461498296842219, 'auprc': 0.9723475085886734, 'loss_val': 0.26292984697838623, 'psi': 0.9566289012460025}-{'f1_val': 0.9417751223536226, 'auprc': 0.9555351417495445, 'loss_val': 0.2961147775237692, 'psi': 0.9472791301119913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=36 head_norm_before_train=1.884726 cos_to_last_merge=0.9974 (last merge round=27)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.4519335310600194, 'auprc': 0.8553515021661136, 'loss_val': 0.7801958883795318, 'psi': 0.6133007195024571}-{'f1_val': 0.7017724816427158, 'auprc': 0.9892760925485531, 'loss_val': 0.20548246308624207, 'psi': 0.8167739260050507}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.818341 cos_to_last_merge=0.9973 (last merge round=30)
[S6] round=36 local utility u=0.269840 metrics={'f1_val': 0.8228918798500099, 'auprc': 0.9520667795690164, 'loss_val': 0.42986114983879714, 'psi': 0.8745618397376125}-{'f1_val': 0.7696915812094403, 'auprc': 0.938505732811094, 'loss_val': 0.6096555915662214, 'psi': 0.8372172418501018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=36 head_norm_before_train=1.503076 cos_to_last_merge=0.9972 (last merge round=29)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.5239786941572266, 'auprc': 0.783525841705603, 'loss_val': 0.8896206465920053, 'psi': 0.6277975531765771}-{'f1_val': 0.6888463710479791, 'auprc': 0.8460884459686924, 'loss_val': 0.39550610627516786, 'psi': 0.7517432010162644}
[S8] START round=36 head_norm_before_train=1.536821 cos_to_last_merge=0.9939 (last merge round=29)
[S8] round=36 local utility u=0.001264 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9963235362487282, 'loss_val': 0.04407738206201732, 'psi': 0.996251276539583}-{'f1_val': 0.9962031034001528, 'auprc': 0.9963730658072959, 'loss_val': 0.04675400406111871, 'psi': 0.9962710883630101}
[S9] START round=36 head_norm_before_train=1.794475 cos_to_last_merge=0.9972 (last merge round=25)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9995963793509595, 'loss_val': 0.02249480157705021, 'psi': 0.9974360250319128}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995970231803573, 'loss_val': 0.022562987329730284, 'psi': 0.9978351163604777}
[S10] START round=36 head_norm_before_train=2.151642 cos_to_last_merge=0.9991 (last merge round=30)
[S10] round=36 local utility u=0.005581 metrics={'f1_val': 0.994614115641838, 'auprc': 0.9971741900828142, 'loss_val': 0.03295039397282168, 'psi': 0.9956381454182284}-{'f1_val': 0.9942111254316871, 'auprc': 0.9966849196681041, 'loss_val': 0.04022568689086765, 'psi': 0.9952006431262539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=36 head_norm_before_train=2.138189 cos_to_last_merge=0.9989 (last merge round=28)
[S11] round=36 local utility u=0.002407 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9974734814543395, 'loss_val': 0.021448094456064395, 'psi': 0.9970749024374831}-{'f1_val': 0.9965470045135896, 'auprc': 0.997495609184018, 'loss_val': 0.024756228133830143, 'psi': 0.996926446381761}
[S13] START round=36 head_norm_before_train=2.118583 cos_to_last_merge=0.9992 (last merge round=29)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.6206906242721661, 'auprc': 0.6484346265538464, 'loss_val': 1.1405882461792274, 'psi': 0.6317882251848382}-{'f1_val': 0.7301195033379176, 'auprc': 0.6737314110772213, 'loss_val': 0.8931777135275544, 'psi': 0.7075642664336391}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=2.149625 cos_to_last_merge=0.9996 (last merge round=30)
[S14] round=36 local utility u=0.126759 metrics={'f1_val': 0.9591989392924253, 'auprc': 0.9997196719209627, 'loss_val': 0.05920999438537759, 'psi': 0.9754072323438403}-{'f1_val': 0.9376098844374254, 'auprc': 0.999254554698782, 'loss_val': 0.18179841129978483, 'psi': 0.9622677525419681}
[S15] START round=36 head_norm_before_train=1.713136 cos_to_last_merge=0.9878 (last merge round=27)
[S15] round=36 local utility u=0.180123 metrics={'f1_val': 0.8820500589424546, 'auprc': 0.994559243773543, 'loss_val': 0.2813171272393657, 'psi': 0.92705373287489}-{'f1_val': 0.8381073156730071, 'auprc': 0.9802682149490514, 'loss_val': 0.3350332924878545, 'psi': 0.8949716753834249}
[S16] START round=36 head_norm_before_train=1.587747 cos_to_last_merge=0.9969 (last merge round=29)
[S16] round=36 local utility u=0.738610 metrics={'f1_val': 0.9892903393653342, 'auprc': 0.9823880736825942, 'loss_val': 0.08157053368452462, 'psi': 0.9865294330922381}-{'f1_val': 0.847274593105651, 'auprc': 0.9848657128959448, 'loss_val': 0.7141283245933157, 'psi': 0.9023110410217685}
[S17] START round=36 head_norm_before_train=2.152556 cos_to_last_merge=0.9979 (last merge round=25)
[S17] round=36 local utility u=1.000000 metrics={'f1_val': 0.7743685590127801, 'auprc': 0.8637129747395003, 'loss_val': 0.7342214246538386, 'psi': 0.8101063253034682}-{'f1_val': 0.5279226764053844, 'auprc': 0.7405149209467591, 'loss_val': 1.4347601263919507, 'psi': 0.6129595742219343}
[S2]  timeout peer S5
[S9]  timeout peer S3
[S7]  timeout peer S8
[S14]  timeout peer S13
[S3]  timeout peer S6
[S15]  timeout peer S7
[S16]  timeout peer S4
[S11]  timeout peer S10
[S8]  timeout peer S16
[S17]  timeout peer S14
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S2] START round=37 head_norm_before_train=1.897434 cos_to_last_merge=0.9989 (last merge round=29)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.8315071592437895, 'auprc': 0.8492472352747632, 'loss_val': 0.40842871603505804, 'psi': 0.838603189656179}-{'f1_val': 0.8255230098493987, 'auprc': 0.9888819111769218, 'loss_val': 0.46896927365188834, 'psi': 0.890866570380408}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.825188 cos_to_last_merge=0.9953 (last merge round=28)
[S3] round=37 local utility u=0.039908 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.998196245303182, 'loss_val': 0.035948584875453306, 'psi': 0.9979473959482313}-{'f1_val': 0.9872687231472141, 'auprc': 0.9972833726681427, 'loss_val': 0.04994987961867003, 'psi': 0.9912745829555856}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=37 head_norm_before_train=1.570180 cos_to_last_merge=0.9972 (last merge round=30)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9428531363266265, 'auprc': 0.9625032016576824, 'loss_val': 0.27817346692696004, 'psi': 0.9507131624590488}-{'f1_val': 0.9461498296842219, 'auprc': 0.9723475085886734, 'loss_val': 0.26292984697838623, 'psi': 0.9566289012460025}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.893313 cos_to_last_merge=0.9970 (last merge round=27)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.4293867439105289, 'auprc': 0.8486027071343988, 'loss_val': 1.165882421589845, 'psi': 0.5970731292000768}-{'f1_val': 0.4519335310600194, 'auprc': 0.8553515021661136, 'loss_val': 0.7801958883795318, 'psi': 0.6133007195024571}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.826992 cos_to_last_merge=0.9969 (last merge round=30)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6014124713033581, 'auprc': 0.727623920091139, 'loss_val': 1.012275964159382, 'psi': 0.6518970508184705}-{'f1_val': 0.8228918798500099, 'auprc': 0.9520667795690164, 'loss_val': 0.42986114983879714, 'psi': 0.8745618397376125}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.507935 cos_to_last_merge=0.9970 (last merge round=29)
[S7] round=37 local utility u=0.680261 metrics={'f1_val': 0.6685956424871666, 'auprc': 0.8079842095924945, 'loss_val': 0.47017612325623315, 'psi': 0.7243510693292978}-{'f1_val': 0.5239786941572266, 'auprc': 0.783525841705603, 'loss_val': 0.8896206465920053, 'psi': 0.6277975531765771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=37 head_norm_before_train=1.557501 cos_to_last_merge=0.9927 (last merge round=29)
[S8] round=37 local utility u=0.000945 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.996561695231861, 'loss_val': 0.042902115865229976, 'psi': 0.9963465401328362}-{'f1_val': 0.9962031034001528, 'auprc': 0.9963235362487282, 'loss_val': 0.04407738206201732, 'psi': 0.996251276539583}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=37 head_norm_before_train=1.803227 cos_to_last_merge=0.9971 (last merge round=25)
[S9] round=37 local utility u=0.004110 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995894156870828, 'loss_val': 0.020896885561976702, 'psi': 0.9980975137821189}-{'f1_val': 0.9959957888192151, 'auprc': 0.9995963793509595, 'loss_val': 0.02249480157705021, 'psi': 0.9974360250319128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=37 head_norm_before_train=2.163254 cos_to_last_merge=0.9988 (last merge round=30)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9937976313733077, 'auprc': 0.9973867602124729, 'loss_val': 0.036647967451364866, 'psi': 0.9952332829089738}-{'f1_val': 0.994614115641838, 'auprc': 0.9971741900828142, 'loss_val': 0.03295039397282168, 'psi': 0.9956381454182284}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=2.148925 cos_to_last_merge=0.9988 (last merge round=28)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9956060750619125, 'auprc': 0.9977863331283682, 'loss_val': 0.023958063088017206, 'psi': 0.9964781782884947}-{'f1_val': 0.9968091830929121, 'auprc': 0.9974734814543395, 'loss_val': 0.021448094456064395, 'psi': 0.9970749024374831}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=2.128455 cos_to_last_merge=0.9989 (last merge round=29)
[S13] round=37 local utility u=0.466675 metrics={'f1_val': 0.6687101937218858, 'auprc': 0.735177879401029, 'loss_val': 0.7555856038590978, 'psi': 0.6952972679935431}-{'f1_val': 0.6206906242721661, 'auprc': 0.6484346265538464, 'loss_val': 1.1405882461792274, 'psi': 0.6317882251848382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] sending update (kind=head size=1790 to 1 peers)
[S14] START round=37 head_norm_before_train=2.158684 cos_to_last_merge=0.9994 (last merge round=30)
[S14] round=37 local utility u=0.125486 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9972655227832069, 'loss_val': 0.02634700076392322, 'psi': 0.9969726736847445}-{'f1_val': 0.9591989392924253, 'auprc': 0.9997196719209627, 'loss_val': 0.05920999438537759, 'psi': 0.9754072323438403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] START round=37 head_norm_before_train=1.741579 cos_to_last_merge=0.9865 (last merge round=27)
[S15] round=37 local utility u=0.188833 metrics={'f1_val': 0.922304964278244, 'auprc': 0.9918899713163849, 'loss_val': 0.13717218289345334, 'psi': 0.9501389670935003}-{'f1_val': 0.8820500589424546, 'auprc': 0.994559243773543, 'loss_val': 0.2813171272393657, 'psi': 0.92705373287489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=37 head_norm_before_train=1.605007 cos_to_last_merge=0.9963 (last merge round=29)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9814407995192055, 'auprc': 0.9852635151519059, 'loss_val': 0.09427699459168434, 'psi': 0.9829698857722856}-{'f1_val': 0.9892903393653342, 'auprc': 0.9823880736825942, 'loss_val': 0.08157053368452462, 'psi': 0.9865294330922381}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=2.159866 cos_to_last_merge=0.9978 (last merge round=25)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6082748161921988, 'auprc': 0.8689397491150648, 'loss_val': 1.1551856084218932, 'psi': 0.7125407893613451}-{'f1_val': 0.7743685590127801, 'auprc': 0.8637129747395003, 'loss_val': 0.7342214246538386, 'psi': 0.8101063253034682}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.904774 cos_to_last_merge=0.9987 (last merge round=29)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.8322785958953889, 'auprc': 0.8396888235768043, 'loss_val': 0.39599951106908376, 'psi': 0.835242686967955}-{'f1_val': 0.8315071592437895, 'auprc': 0.8492472352747632, 'loss_val': 0.40842871603505804, 'psi': 0.838603189656179}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=1.837743 cos_to_last_merge=0.9946 (last merge round=28)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9972732244167248, 'loss_val': 0.12060539034768822, 'psi': 0.9752518741880654}-{'f1_val': 0.9977814963782642, 'auprc': 0.998196245303182, 'loss_val': 0.035948584875453306, 'psi': 0.9979473959482313}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.583534 cos_to_last_merge=0.9968 (last merge round=30)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9394216489926361, 'auprc': 0.9274790306669919, 'loss_val': 0.30210391515109053, 'psi': 0.9346446016623784}-{'f1_val': 0.9428531363266265, 'auprc': 0.9625032016576824, 'loss_val': 0.27817346692696004, 'psi': 0.9507131624590488}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.901478 cos_to_last_merge=0.9966 (last merge round=27)
[S5] round=38 local utility u=1.000000 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.9891841052796339, 'loss_val': 0.22457832951616852, 'psi': 0.8160217928302578}-{'f1_val': 0.4293867439105289, 'auprc': 0.8486027071343988, 'loss_val': 1.165882421589845, 'psi': 0.5970731292000768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=38 head_norm_before_train=1.839810 cos_to_last_merge=0.9963 (last merge round=30)
[S6] round=38 local utility u=1.000000 metrics={'f1_val': 0.7831158711010561, 'auprc': 0.9366672800182474, 'loss_val': 0.6036852780036215, 'psi': 0.8445364346679326}-{'f1_val': 0.6014124713033581, 'auprc': 0.727623920091139, 'loss_val': 1.012275964159382, 'psi': 0.6518970508184705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=38 head_norm_before_train=1.511057 cos_to_last_merge=0.9968 (last merge round=29)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6488666512098058, 'auprc': 0.8011666849550618, 'loss_val': 0.5232588744463365, 'psi': 0.7097866647079083}-{'f1_val': 0.6685956424871666, 'auprc': 0.8079842095924945, 'loss_val': 0.47017612325623315, 'psi': 0.7243510693292978}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.576257 cos_to_last_merge=0.9915 (last merge round=29)
[S8] round=38 local utility u=0.001465 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9963493995531405, 'loss_val': 0.039335957778835494, 'psi': 0.9962616218613479}-{'f1_val': 0.9962031034001528, 'auprc': 0.996561695231861, 'loss_val': 0.042902115865229976, 'psi': 0.9963465401328362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=38 head_norm_before_train=1.813913 cos_to_last_merge=0.9968 (last merge round=25)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.990582573027146, 'auprc': 0.9996078003913477, 'loss_val': 0.03478696878475828, 'psi': 0.9941926639728267}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995894156870828, 'loss_val': 0.020896885561976702, 'psi': 0.9980975137821189}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=2.175453 cos_to_last_merge=0.9985 (last merge round=30)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9936028450452988, 'auprc': 0.9966855652238039, 'loss_val': 0.036783700102172745, 'psi': 0.9948359331167009}-{'f1_val': 0.9937976313733077, 'auprc': 0.9973867602124729, 'loss_val': 0.036647967451364866, 'psi': 0.9952332829089738}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=2.159847 cos_to_last_merge=0.9986 (last merge round=28)
[S11] round=38 local utility u=0.003275 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977956523121467, 'loss_val': 0.023081520414219504, 'psi': 0.9970464636330124}-{'f1_val': 0.9956060750619125, 'auprc': 0.9977863331283682, 'loss_val': 0.023958063088017206, 'psi': 0.9964781782884947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=38 head_norm_before_train=2.137451 cos_to_last_merge=0.9987 (last merge round=29)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6150575368033913, 'auprc': 0.6496446113169432, 'loss_val': 1.1693496620000265, 'psi': 0.628892366608812}-{'f1_val': 0.6687101937218858, 'auprc': 0.735177879401029, 'loss_val': 0.7555856038590978, 'psi': 0.6952972679935431}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=2.169804 cos_to_last_merge=0.9993 (last merge round=30)
[S14] round=38 local utility u=0.002695 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9990002342308429, 'loss_val': 0.027480622747902358, 'psi': 0.9977985985869362}-{'f1_val': 0.9967774409524363, 'auprc': 0.9972655227832069, 'loss_val': 0.02634700076392322, 'psi': 0.9969726736847445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] sending update (kind=head size=1791 to 1 peers)
[S15] START round=38 head_norm_before_train=1.766914 cos_to_last_merge=0.9852 (last merge round=27)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.9024517853918563, 'auprc': 0.9931104850100777, 'loss_val': 0.20908917505015925, 'psi': 0.9387152652391448}-{'f1_val': 0.922304964278244, 'auprc': 0.9918899713163849, 'loss_val': 0.13717218289345334, 'psi': 0.9501389670935003}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.620170 cos_to_last_merge=0.9957 (last merge round=29)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8409530792180274, 'auprc': 0.9809286926787604, 'loss_val': 0.831493837162373, 'psi': 0.8969433246023206}-{'f1_val': 0.9814407995192055, 'auprc': 0.9852635151519059, 'loss_val': 0.09427699459168434, 'psi': 0.9829698857722856}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=2.169552 cos_to_last_merge=0.9975 (last merge round=25)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6043552292294109, 'auprc': 0.8787704816344318, 'loss_val': 1.207846151498636, 'psi': 0.7141213301914193}-{'f1_val': 0.6082748161921988, 'auprc': 0.8689397491150648, 'loss_val': 1.1551856084218932, 'psi': 0.7125407893613451}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.917816 cos_to_last_merge=0.9984 (last merge round=29)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.8110185480814147, 'auprc': 0.8556745417236589, 'loss_val': 0.5147671821604535, 'psi': 0.8288809455383124}-{'f1_val': 0.8322785958953889, 'auprc': 0.8396888235768043, 'loss_val': 0.39599951106908376, 'psi': 0.835242686967955}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.829 u=0.0000 p_local=0.0516 f1=0.811 auprc=0.856 bytes=34180
[S3] START round=39 head_norm_before_train=1.848423 cos_to_last_merge=0.9939 (last merge round=28)
[S3] round=39 local utility u=0.002247 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9968615142546249, 'loss_val': 0.11487710616568268, 'psi': 0.9750871901232254}-{'f1_val': 0.9605709740356257, 'auprc': 0.9972732244167248, 'loss_val': 0.12060539034768822, 'psi': 0.9752518741880654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S3] r=40 psi=0.975 u=0.0022 p_local=0.0533 f1=0.961 auprc=0.997 bytes=48530
[S4] START round=39 head_norm_before_train=1.593177 cos_to_last_merge=0.9963 (last merge round=30)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.7962833795189302, 'auprc': 0.9041655193018764, 'loss_val': 0.4581447137592853, 'psi': 0.8394362354321088}-{'f1_val': 0.9394216489926361, 'auprc': 0.9274790306669919, 'loss_val': 0.30210391515109053, 'psi': 0.9346446016623784}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.839 u=0.0000 p_local=0.0111 f1=0.796 auprc=0.904 bytes=39601
[S5] START round=39 head_norm_before_train=1.906983 cos_to_last_merge=0.9964 (last merge round=27)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.69920569115474, 'auprc': 0.8677877031018921, 'loss_val': 0.4022951136870508, 'psi': 0.7666384959336008}-{'f1_val': 0.7005802511973405, 'auprc': 0.9891841052796339, 'loss_val': 0.22457832951616852, 'psi': 0.8160217928302578}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.767 u=0.0000 p_local=0.3110 f1=0.699 auprc=0.868 bytes=37773
[S6] START round=39 head_norm_before_train=1.855037 cos_to_last_merge=0.9955 (last merge round=30)
[S6] round=39 local utility u=0.233840 metrics={'f1_val': 0.8228918798500099, 'auprc': 0.9589453573629398, 'loss_val': 0.4414961843021999, 'psi': 0.8773132708551818}-{'f1_val': 0.7831158711010561, 'auprc': 0.9366672800182474, 'loss_val': 0.6036852780036215, 'psi': 0.8445364346679326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S6] r=40 psi=0.877 u=0.2338 p_local=0.3250 f1=0.823 auprc=0.959 bytes=35955
[S7] START round=39 head_norm_before_train=1.514008 cos_to_last_merge=0.9966 (last merge round=29)
[S7] round=39 local utility u=0.241454 metrics={'f1_val': 0.6920924276611671, 'auprc': 0.8323333824147429, 'loss_val': 0.3932053745277066, 'psi': 0.7481888095625974}-{'f1_val': 0.6488666512098058, 'auprc': 0.8011666849550618, 'loss_val': 0.5232588744463365, 'psi': 0.7097866647079083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S7] r=40 psi=0.748 u=0.2415 p_local=0.2147 f1=0.692 auprc=0.832 bytes=39551
[S8] START round=39 head_norm_before_train=1.597504 cos_to_last_merge=0.9903 (last merge round=29)
[S8] round=39 local utility u=0.002507 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9970108899528609, 'loss_val': 0.03720566651688065, 'psi': 0.9966162009425191}-{'f1_val': 0.9962031034001528, 'auprc': 0.9963493995531405, 'loss_val': 0.039335957778835494, 'psi': 0.9962616218613479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S8] r=40 psi=0.997 u=0.0025 p_local=0.0071 f1=0.996 auprc=0.997 bytes=52177
[S9] START round=39 head_norm_before_train=1.823392 cos_to_last_merge=0.9964 (last merge round=25)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9888785659900814, 'auprc': 0.9996226451738899, 'loss_val': 0.04233822989185029, 'psi': 0.9931761976636048}-{'f1_val': 0.990582573027146, 'auprc': 0.9996078003913477, 'loss_val': 0.03478696878475828, 'psi': 0.9941926639728267}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.993 u=0.0000 p_local=0.0041 f1=0.989 auprc=1.000 bytes=44986
[S10] START round=39 head_norm_before_train=2.187462 cos_to_last_merge=0.9982 (last merge round=30)
[S10] round=39 local utility u=0.003983 metrics={'f1_val': 0.99393134655043, 'auprc': 0.997916770436715, 'loss_val': 0.03448174085489397, 'psi': 0.995525516104944}-{'f1_val': 0.9936028450452988, 'auprc': 0.9966855652238039, 'loss_val': 0.036783700102172745, 'psi': 0.9948359331167009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S10] r=40 psi=0.996 u=0.0040 p_local=0.0026 f1=0.994 auprc=0.998 bytes=48549
[S11] START round=39 head_norm_before_train=2.167733 cos_to_last_merge=0.9984 (last merge round=28)
[S11] round=39 local utility u=0.000053 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977767325313633, 'loss_val': 0.0229182434922671, 'psi': 0.997038895720699}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977956523121467, 'loss_val': 0.023081520414219504, 'psi': 0.9970464636330124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S11] r=40 psi=0.997 u=0.0001 p_local=0.0035 f1=0.997 auprc=0.998 bytes=55695
[S13] START round=39 head_norm_before_train=2.142876 cos_to_last_merge=0.9985 (last merge round=29)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6192320088526844, 'auprc': 0.6392924836018236, 'loss_val': 1.1847837797032355, 'psi': 0.6272561987523401}-{'f1_val': 0.6150575368033913, 'auprc': 0.6496446113169432, 'loss_val': 1.1693496620000265, 'psi': 0.628892366608812}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.627 u=0.0000 p_local=0.1195 f1=0.619 auprc=0.639 bytes=32370
[S14] START round=39 head_norm_before_train=2.177788 cos_to_last_merge=0.9991 (last merge round=30)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9646128712313502, 'auprc': 0.9988812403070743, 'loss_val': 0.11531803682922828, 'psi': 0.9783202188616398}-{'f1_val': 0.9969975081576651, 'auprc': 0.9990002342308429, 'loss_val': 0.027480622747902358, 'psi': 0.9977985985869362}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.978 u=0.0000 p_local=0.0363 f1=0.965 auprc=0.999 bytes=46758
[S15] START round=39 head_norm_before_train=1.790706 cos_to_last_merge=0.9840 (last merge round=27)
[S15] round=39 local utility u=0.375300 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.993945224071457, 'loss_val': 0.02676332291425455, 'psi': 0.9956260906610952}-{'f1_val': 0.9024517853918563, 'auprc': 0.9931104850100777, 'loss_val': 0.20908917505015925, 'psi': 0.9387152652391448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S15] r=40 psi=0.996 u=0.3753 p_local=0.2146 f1=0.997 auprc=0.994 bytes=37790
[S16] START round=39 head_norm_before_train=1.634083 cos_to_last_merge=0.9951 (last merge round=29)
[S16] round=39 local utility u=0.831954 metrics={'f1_val': 0.9903319254995382, 'auprc': 0.9796752293052069, 'loss_val': 0.06009765002356705, 'psi': 0.9860692470218057}-{'f1_val': 0.8409530792180274, 'auprc': 0.9809286926787604, 'loss_val': 0.831493837162373, 'psi': 0.8969433246023206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S16] r=40 psi=0.986 u=0.8320 p_local=0.2580 f1=0.990 auprc=0.980 bytes=43170
[S17] START round=39 head_norm_before_train=2.177576 cos_to_last_merge=0.9973 (last merge round=25)
[S17] round=39 local utility u=0.683530 metrics={'f1_val': 0.8023416786954867, 'auprc': 0.7755807759386111, 'loss_val': 0.7191357199537514, 'psi': 0.7916373175927365}-{'f1_val': 0.6043552292294109, 'auprc': 0.8787704816344318, 'loss_val': 1.207846151498636, 'psi': 0.7141213301914193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S17] r=40 psi=0.792 u=0.6835 p_local=0.3628 f1=0.802 auprc=0.776 bytes=35986
[S2] START round=40 head_norm_before_train=1.923946 cos_to_last_merge=0.9979 (last merge round=29)
[S2] round=40 local utility u=0.195075 metrics={'f1_val': 0.830733455770276, 'auprc': 0.9277361314359304, 'loss_val': 0.459091523682093, 'psi': 0.8695345260365377}-{'f1_val': 0.8110185480814147, 'auprc': 0.8556745417236589, 'loss_val': 0.5147671821604535, 'psi': 0.8288809455383124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] sending update (kind=head size=1792 to 1 peers)
[S3] START round=40 head_norm_before_train=1.859241 cos_to_last_merge=0.9933 (last merge round=28)
[S3] round=40 local utility u=0.148200 metrics={'f1_val': 0.9969869110332736, 'auprc': 0.9983080873524003, 'loss_val': 0.041312143574955155, 'psi': 0.9975153815609242}-{'f1_val': 0.9605709740356257, 'auprc': 0.9968615142546249, 'loss_val': 0.11487710616568268, 'psi': 0.9750871901232254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] sending update (kind=head size=1790 to 1 peers)
[S4] START round=40 head_norm_before_train=1.601656 cos_to_last_merge=0.9960 (last merge round=30)
[S4] round=40 local utility u=0.601228 metrics={'f1_val': 0.9432387808679232, 'auprc': 0.9517382181774501, 'loss_val': 0.2801398188484902, 'psi': 0.9466385557917341}-{'f1_val': 0.7962833795189302, 'auprc': 0.9041655193018764, 'loss_val': 0.4581447137592853, 'psi': 0.8394362354321088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=40 head_norm_before_train=1.913418 cos_to_last_merge=0.9961 (last merge round=27)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.49855076084203986, 'auprc': 0.8555091585586482, 'loss_val': 0.7959659778912332, 'psi': 0.6413341199286833}-{'f1_val': 0.69920569115474, 'auprc': 0.8677877031018921, 'loss_val': 0.4022951136870508, 'psi': 0.7666384959336008}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.868567 cos_to_last_merge=0.9949 (last merge round=30)
[S6] round=40 local utility u=0.648129 metrics={'f1_val': 0.9767206873755425, 'auprc': 0.9677154078990646, 'loss_val': 0.09452086409487206, 'psi': 0.9731185755849513}-{'f1_val': 0.8228918798500099, 'auprc': 0.9589453573629398, 'loss_val': 0.4414961843021999, 'psi': 0.8773132708551818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=40 head_norm_before_train=1.517787 cos_to_last_merge=0.9963 (last merge round=29)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5748697360020985, 'auprc': 0.7868590371915769, 'loss_val': 0.6851680382871185, 'psi': 0.6596654564778899}-{'f1_val': 0.6920924276611671, 'auprc': 0.8323333824147429, 'loss_val': 0.3932053745277066, 'psi': 0.7481888095625974}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.615210 cos_to_last_merge=0.9891 (last merge round=29)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9937002519505231, 'loss_val': 0.04558286471105835, 'psi': 0.995201962820301}-{'f1_val': 0.9963530749356245, 'auprc': 0.9970108899528609, 'loss_val': 0.03720566651688065, 'psi': 0.9966162009425191}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.832494 cos_to_last_merge=0.9960 (last merge round=25)
[S9] round=40 local utility u=0.023283 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9996094085454457, 'loss_val': 0.026097820037820702, 'psi': 0.9962073910165865}-{'f1_val': 0.9888785659900814, 'auprc': 0.9996226451738899, 'loss_val': 0.04233822989185029, 'psi': 0.9931761976636048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=40 head_norm_before_train=2.196660 cos_to_last_merge=0.9979 (last merge round=30)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.99338363935842, 'auprc': 0.997429508770783, 'loss_val': 0.03441610154452884, 'psi': 0.9950019871233652}-{'f1_val': 0.99393134655043, 'auprc': 0.997916770436715, 'loss_val': 0.03448174085489397, 'psi': 0.995525516104944}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=2.176464 cos_to_last_merge=0.9982 (last merge round=28)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9966096277084884, 'loss_val': 0.02105811573960341, 'psi': 0.9967293609391427}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977767325313633, 'loss_val': 0.0229182434922671, 'psi': 0.997038895720699}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=2.151419 cos_to_last_merge=0.9982 (last merge round=29)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6224192427943418, 'auprc': 0.6354050957329608, 'loss_val': 1.195843022659825, 'psi': 0.6276135839697894}-{'f1_val': 0.6192320088526844, 'auprc': 0.6392924836018236, 'loss_val': 1.1847837797032355, 'psi': 0.6272561987523401}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=2.183884 cos_to_last_merge=0.9989 (last merge round=30)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9499605317348359, 'auprc': 0.9988236194154844, 'loss_val': 0.15052548890840717, 'psi': 0.9695057668070952}-{'f1_val': 0.9646128712313502, 'auprc': 0.9988812403070743, 'loss_val': 0.11531803682922828, 'psi': 0.9783202188616398}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.811111 cos_to_last_merge=0.9830 (last merge round=27)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.9136481870306838, 'auprc': 0.9932272387190882, 'loss_val': 0.15690298480931927, 'psi': 0.9454798077060456}-{'f1_val': 0.9967466683875206, 'auprc': 0.993945224071457, 'loss_val': 0.02676332291425455, 'psi': 0.9956260906610952}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.646122 cos_to_last_merge=0.9946 (last merge round=29)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.9653553228130316, 'auprc': 0.9781815250615329, 'loss_val': 0.11605490652359463, 'psi': 0.9704858037124322}-{'f1_val': 0.9903319254995382, 'auprc': 0.9796752293052069, 'loss_val': 0.06009765002356705, 'psi': 0.9860692470218057}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=2.187927 cos_to_last_merge=0.9969 (last merge round=25)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6280229813632757, 'auprc': 0.9141159878553728, 'loss_val': 1.1415485517531445, 'psi': 0.7424601839601146}-{'f1_val': 0.8023416786954867, 'auprc': 0.7755807759386111, 'loss_val': 0.7191357199537514, 'psi': 0.7916373175927365}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.934502 cos_to_last_merge=0.9975 (last merge round=29)
[S2] round=41 local utility u=0.097040 metrics={'f1_val': 0.827643834893705, 'auprc': 0.9932622820351453, 'loss_val': 0.44305166370954313, 'psi': 0.8938912137502811}-{'f1_val': 0.830733455770276, 'auprc': 0.9277361314359304, 'loss_val': 0.459091523682093, 'psi': 0.8695345260365377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=41 head_norm_before_train=1.868319 cos_to_last_merge=0.9927 (last merge round=28)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9587066537085368, 'auprc': 0.9963397313723317, 'loss_val': 0.13706686622437506, 'psi': 0.9737598847740547}-{'f1_val': 0.9969869110332736, 'auprc': 0.9983080873524003, 'loss_val': 0.041312143574955155, 'psi': 0.9975153815609242}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.612654 cos_to_last_merge=0.9955 (last merge round=30)
[S4] round=41 local utility u=0.056038 metrics={'f1_val': 0.9561375234632722, 'auprc': 0.9615087518612517, 'loss_val': 0.274768128728413, 'psi': 0.9582860148224641}-{'f1_val': 0.9432387808679232, 'auprc': 0.9517382181774501, 'loss_val': 0.2801398188484902, 'psi': 0.9466385557917341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=41 head_norm_before_train=1.918872 cos_to_last_merge=0.9958 (last merge round=27)
[S5] round=41 local utility u=1.000000 metrics={'f1_val': 0.7588227725526391, 'auprc': 0.9880331005115883, 'loss_val': 0.1695285720808297, 'psi': 0.8505069037362187}-{'f1_val': 0.49855076084203986, 'auprc': 0.8555091585586482, 'loss_val': 0.7959659778912332, 'psi': 0.6413341199286833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=41 head_norm_before_train=1.878843 cos_to_last_merge=0.9943 (last merge round=30)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.5969778023276647, 'auprc': 0.6471748279724205, 'loss_val': 1.2478758657703883, 'psi': 0.617056612585567}-{'f1_val': 0.9767206873755425, 'auprc': 0.9677154078990646, 'loss_val': 0.09452086409487206, 'psi': 0.9731185755849513}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.521860 cos_to_last_merge=0.9960 (last merge round=29)
[S7] round=41 local utility u=0.838910 metrics={'f1_val': 0.6988766735852125, 'auprc': 0.9651674021695065, 'loss_val': 0.2863155241939903, 'psi': 0.8053929650189302}-{'f1_val': 0.5748697360020985, 'auprc': 0.7868590371915769, 'loss_val': 0.6851680382871185, 'psi': 0.6596654564778899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=41 head_norm_before_train=1.621419 cos_to_last_merge=0.9880 (last merge round=29)
[S8] round=41 local utility u=0.008090 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9990253569056483, 'loss_val': 0.04537843717114329, 'psi': 0.9973320048023511}-{'f1_val': 0.9962031034001528, 'auprc': 0.9937002519505231, 'loss_val': 0.04558286471105835, 'psi': 0.995201962820301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=41 head_norm_before_train=1.841902 cos_to_last_merge=0.9956 (last merge round=25)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9920230569965528, 'loss_val': 0.022769091116616912, 'psi': 0.9948247175574785}-{'f1_val': 0.9939393793306803, 'auprc': 0.9996094085454457, 'loss_val': 0.026097820037820702, 'psi': 0.9962073910165865}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=2.206420 cos_to_last_merge=0.9976 (last merge round=30)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9935783626118951, 'auprc': 0.9971265961191207, 'loss_val': 0.0370465250692952, 'psi': 0.9949976560147853}-{'f1_val': 0.99338363935842, 'auprc': 0.997429508770783, 'loss_val': 0.03441610154452884, 'psi': 0.9950019871233652}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=2.184880 cos_to_last_merge=0.9980 (last merge round=28)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9967143726945028, 'loss_val': 0.02108734835823298, 'psi': 0.9965232613962676}-{'f1_val': 0.9968091830929121, 'auprc': 0.9966096277084884, 'loss_val': 0.02105811573960341, 'psi': 0.9967293609391427}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=2.156713 cos_to_last_merge=0.9979 (last merge round=29)
[S13] round=41 local utility u=0.283933 metrics={'f1_val': 0.6903713429020935, 'auprc': 0.6608856495999926, 'loss_val': 1.1121310545631455, 'psi': 0.6785770655812531}-{'f1_val': 0.6224192427943418, 'auprc': 0.6354050957329608, 'loss_val': 1.195843022659825, 'psi': 0.6276135839697894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] sending update (kind=head size=1792 to 1 peers)
[S14] START round=41 head_norm_before_train=2.191776 cos_to_last_merge=0.9988 (last merge round=30)
[S14] round=41 local utility u=0.189779 metrics={'f1_val': 0.993379856939056, 'auprc': 0.9994692864997883, 'loss_val': 0.033421239969359466, 'psi': 0.995815628763349}-{'f1_val': 0.9499605317348359, 'auprc': 0.9988236194154844, 'loss_val': 0.15052548890840717, 'psi': 0.9695057668070952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=41 head_norm_before_train=1.830777 cos_to_last_merge=0.9819 (last merge round=27)
[S15] round=41 local utility u=0.293910 metrics={'f1_val': 0.9900577267135185, 'auprc': 0.9953912503658056, 'loss_val': 0.034032395186519286, 'psi': 0.9921911361744333}-{'f1_val': 0.9136481870306838, 'auprc': 0.9932272387190882, 'loss_val': 0.15690298480931927, 'psi': 0.9454798077060456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=41 head_norm_before_train=1.658022 cos_to_last_merge=0.9942 (last merge round=29)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.833980827150707, 'auprc': 0.9854873820374561, 'loss_val': 0.9441547625301463, 'psi': 0.8945834491054065}-{'f1_val': 0.9653553228130316, 'auprc': 0.9781815250615329, 'loss_val': 0.11605490652359463, 'psi': 0.9704858037124322}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=2.195181 cos_to_last_merge=0.9966 (last merge round=25)
[S17] round=41 local utility u=0.753709 metrics={'f1_val': 0.7491233882994106, 'auprc': 0.999228559460655, 'loss_val': 0.6160715238603413, 'psi': 0.8491654567639084}-{'f1_val': 0.6280229813632757, 'auprc': 0.9141159878553728, 'loss_val': 1.1415485517531445, 'psi': 0.7424601839601146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=42 head_norm_before_train=1.945814 cos_to_last_merge=0.9972 (last merge round=29)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.8276157198016335, 'auprc': 0.9916246422841941, 'loss_val': 0.4472712317611473, 'psi': 0.8932192887946577}-{'f1_val': 0.827643834893705, 'auprc': 0.9932622820351453, 'loss_val': 0.44305166370954313, 'psi': 0.8938912137502811}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.875972 cos_to_last_merge=0.9922 (last merge round=28)
[S3] round=42 local utility u=0.149104 metrics={'f1_val': 0.9923851879828639, 'auprc': 0.9985787778256479, 'loss_val': 0.04764738670662043, 'psi': 0.9948626239199774}-{'f1_val': 0.9587066537085368, 'auprc': 0.9963397313723317, 'loss_val': 0.13706686622437506, 'psi': 0.9737598847740547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=42 head_norm_before_train=1.619681 cos_to_last_merge=0.9951 (last merge round=30)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9399055518043213, 'auprc': 0.9265278881092678, 'loss_val': 0.3060416703476621, 'psi': 0.9345544863262999}-{'f1_val': 0.9561375234632722, 'auprc': 0.9615087518612517, 'loss_val': 0.274768128728413, 'psi': 0.9582860148224641}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.923247 cos_to_last_merge=0.9955 (last merge round=27)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.4371741616982159, 'auprc': 0.8554593317187904, 'loss_val': 0.9518736336230517, 'psi': 0.6044882297064457}-{'f1_val': 0.7588227725526391, 'auprc': 0.9880331005115883, 'loss_val': 0.1695285720808297, 'psi': 0.8505069037362187}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.883687 cos_to_last_merge=0.9939 (last merge round=30)
[S6] round=42 local utility u=1.000000 metrics={'f1_val': 0.9333917567285741, 'auprc': 0.9514389465795142, 'loss_val': 0.2708609241838076, 'psi': 0.9406106326689502}-{'f1_val': 0.5969778023276647, 'auprc': 0.6471748279724205, 'loss_val': 1.2478758657703883, 'psi': 0.617056612585567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=42 head_norm_before_train=1.528005 cos_to_last_merge=0.9956 (last merge round=29)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.6206435551151807, 'auprc': 0.7969496764542341, 'loss_val': 0.5873303953071304, 'psi': 0.691166003650802}-{'f1_val': 0.6988766735852125, 'auprc': 0.9651674021695065, 'loss_val': 0.2863155241939903, 'psi': 0.8053929650189302}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.631027 cos_to_last_merge=0.9870 (last merge round=29)
[S8] round=42 local utility u=0.002154 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9985397630333707, 'loss_val': 0.03961285764814697, 'psi': 0.99713776725344}-{'f1_val': 0.9962031034001528, 'auprc': 0.9990253569056483, 'loss_val': 0.04537843717114329, 'psi': 0.9973320048023511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=42 head_norm_before_train=1.850901 cos_to_last_merge=0.9953 (last merge round=25)
[S9] round=42 local utility u=0.006683 metrics={'f1_val': 0.99518968612894, 'auprc': 0.9995976076874225, 'loss_val': 0.023109335927324254, 'psi': 0.996952854752333}-{'f1_val': 0.9966924912647621, 'auprc': 0.9920230569965528, 'loss_val': 0.022769091116616912, 'psi': 0.9948247175574785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=42 head_norm_before_train=2.214095 cos_to_last_merge=0.9973 (last merge round=30)
[S10] round=42 local utility u=0.005103 metrics={'f1_val': 0.994175185407767, 'auprc': 0.9973283141049865, 'loss_val': 0.03102712770275693, 'psi': 0.9954364368866547}-{'f1_val': 0.9935783626118951, 'auprc': 0.9971265961191207, 'loss_val': 0.0370465250692952, 'psi': 0.9949976560147853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=42 head_norm_before_train=2.192416 cos_to_last_merge=0.9977 (last merge round=28)
[S11] round=42 local utility u=0.000122 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.996705753497213, 'loss_val': 0.020818270774553907, 'psi': 0.9965198137173517}-{'f1_val': 0.9963958538641108, 'auprc': 0.9967143726945028, 'loss_val': 0.02108734835823298, 'psi': 0.9965232613962676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=42 head_norm_before_train=2.161665 cos_to_last_merge=0.9978 (last merge round=29)
[S13] round=42 local utility u=0.119392 metrics={'f1_val': 0.6797098588259529, 'auprc': 0.711817546125915, 'loss_val': 0.9621735978528984, 'psi': 0.6925529337459377}-{'f1_val': 0.6903713429020935, 'auprc': 0.6608856495999926, 'loss_val': 1.1121310545631455, 'psi': 0.6785770655812531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=42 head_norm_before_train=2.199277 cos_to_last_merge=0.9986 (last merge round=30)
[S14] round=42 local utility u=0.011831 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9971925566667545, 'loss_val': 0.023313894359522885, 'psi': 0.9969434872381635}-{'f1_val': 0.993379856939056, 'auprc': 0.9994692864997883, 'loss_val': 0.033421239969359466, 'psi': 0.995815628763349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=42 head_norm_before_train=1.847840 cos_to_last_merge=0.9811 (last merge round=27)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.953871728073497, 'auprc': 0.9957966574748053, 'loss_val': 0.07762427112125186, 'psi': 0.9706416998340203}-{'f1_val': 0.9900577267135185, 'auprc': 0.9953912503658056, 'loss_val': 0.034032395186519286, 'psi': 0.9921911361744333}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.668798 cos_to_last_merge=0.9937 (last merge round=29)
[S16] round=42 local utility u=0.919930 metrics={'f1_val': 0.9909947093544045, 'auprc': 0.9878499358324142, 'loss_val': 0.053465789898963875, 'psi': 0.9897367999456084}-{'f1_val': 0.833980827150707, 'auprc': 0.9854873820374561, 'loss_val': 0.9441547625301463, 'psi': 0.8945834491054065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=42 head_norm_before_train=2.202013 cos_to_last_merge=0.9963 (last merge round=25)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.5442757592777389, 'auprc': 0.7095462857949723, 'loss_val': 1.5936174491423953, 'psi': 0.6103839698846323}-{'f1_val': 0.7491233882994106, 'auprc': 0.999228559460655, 'loss_val': 0.6160715238603413, 'psi': 0.8491654567639084}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.955569 cos_to_last_merge=0.9970 (last merge round=29)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.8339681430515905, 'auprc': 0.8279491216796918, 'loss_val': 0.3395418497910638, 'psi': 0.8315605345028311}-{'f1_val': 0.8276157198016335, 'auprc': 0.9916246422841941, 'loss_val': 0.4472712317611473, 'psi': 0.8932192887946577}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.882840 cos_to_last_merge=0.9918 (last merge round=28)
[S3] round=43 local utility u=0.022419 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9985939031176068, 'loss_val': 0.03293223072868799, 'psi': 0.9978765027146772}-{'f1_val': 0.9923851879828639, 'auprc': 0.9985787778256479, 'loss_val': 0.04764738670662043, 'psi': 0.9948626239199774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=43 head_norm_before_train=1.624969 cos_to_last_merge=0.9946 (last merge round=30)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9410197733366742, 'auprc': 0.9135990981139256, 'loss_val': 0.30733770617863354, 'psi': 0.9300515032475747}-{'f1_val': 0.9399055518043213, 'auprc': 0.9265278881092678, 'loss_val': 0.3060416703476621, 'psi': 0.9345544863262999}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.926906 cos_to_last_merge=0.9953 (last merge round=27)
[S5] round=43 local utility u=1.000000 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9630875411383657, 'loss_val': 0.27891245486479355, 'psi': 0.8055313361210201}-{'f1_val': 0.4371741616982159, 'auprc': 0.8554593317187904, 'loss_val': 0.9518736336230517, 'psi': 0.6044882297064457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=43 head_norm_before_train=1.891513 cos_to_last_merge=0.9935 (last merge round=30)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.8227722660374753, 'auprc': 0.9353987965499931, 'loss_val': 0.593436569462121, 'psi': 0.8678228782424825}-{'f1_val': 0.9333917567285741, 'auprc': 0.9514389465795142, 'loss_val': 0.2708609241838076, 'psi': 0.9406106326689502}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.532707 cos_to_last_merge=0.9953 (last merge round=29)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5729760403125194, 'auprc': 0.7922701634118842, 'loss_val': 0.7011081235951298, 'psi': 0.6606936895522653}-{'f1_val': 0.6206435551151807, 'auprc': 0.7969496764542341, 'loss_val': 0.5873303953071304, 'psi': 0.691166003650802}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.645535 cos_to_last_merge=0.9865 (last merge round=29)
[S8] round=43 local utility u=0.000010 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.996315020148538, 'loss_val': 0.03463972473446508, 'psi': 0.996420032697817}-{'f1_val': 0.9962031034001528, 'auprc': 0.9985397630333707, 'loss_val': 0.03961285764814697, 'psi': 0.99713776725344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=43 head_norm_before_train=1.856335 cos_to_last_merge=0.9952 (last merge round=25)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9901606111321243, 'auprc': 0.9996155578346992, 'loss_val': 0.03535999516633855, 'psi': 0.9939425898131543}-{'f1_val': 0.99518968612894, 'auprc': 0.9995976076874225, 'loss_val': 0.023109335927324254, 'psi': 0.996952854752333}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.223116 cos_to_last_merge=0.9970 (last merge round=30)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9940169738272144, 'auprc': 0.9970924557650811, 'loss_val': 0.032592939575905464, 'psi': 0.9952471666023611}-{'f1_val': 0.994175185407767, 'auprc': 0.9973283141049865, 'loss_val': 0.03102712770275693, 'psi': 0.9954364368866547}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=2.201141 cos_to_last_merge=0.9975 (last merge round=28)
[S11] round=43 local utility u=0.001440 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9966294878415445, 'loss_val': 0.020189889328280232, 'psi': 0.9967373049923651}-{'f1_val': 0.9963958538641108, 'auprc': 0.996705753497213, 'loss_val': 0.020818270774553907, 'psi': 0.9965198137173517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=43 head_norm_before_train=2.165967 cos_to_last_merge=0.9976 (last merge round=29)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6642270208024855, 'auprc': 0.6616586621596023, 'loss_val': 1.1570197609051427, 'psi': 0.6631996773453323}-{'f1_val': 0.6797098588259529, 'auprc': 0.711817546125915, 'loss_val': 0.9621735978528984, 'psi': 0.6925529337459377}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.207689 cos_to_last_merge=0.9985 (last merge round=30)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9965344645149313, 'auprc': 0.9974484335722431, 'loss_val': 0.023575619190244725, 'psi': 0.9969000521378562}-{'f1_val': 0.9967774409524363, 'auprc': 0.9971925566667545, 'loss_val': 0.023313894359522885, 'psi': 0.9969434872381635}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.864805 cos_to_last_merge=0.9803 (last merge round=27)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.9114460259425831, 'auprc': 0.9953004586426115, 'loss_val': 0.17125959064318733, 'psi': 0.9449877990225946}-{'f1_val': 0.953871728073497, 'auprc': 0.9957966574748053, 'loss_val': 0.07762427112125186, 'psi': 0.9706416998340203}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.678264 cos_to_last_merge=0.9933 (last merge round=29)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9917196238550823, 'auprc': 0.9848789074631409, 'loss_val': 0.049053060459850514, 'psi': 0.9889833372983057}-{'f1_val': 0.9909947093544045, 'auprc': 0.9878499358324142, 'loss_val': 0.053465789898963875, 'psi': 0.9897367999456084}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=2.210799 cos_to_last_merge=0.9959 (last merge round=25)
[S17] round=43 local utility u=1.000000 metrics={'f1_val': 0.8552574946797478, 'auprc': 0.8591773169155429, 'loss_val': 0.5931980806914509, 'psi': 0.8568254235740658}-{'f1_val': 0.5442757592777389, 'auprc': 0.7095462857949723, 'loss_val': 1.5936174491423953, 'psi': 0.6103839698846323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=44 head_norm_before_train=1.963089 cos_to_last_merge=0.9965 (last merge round=29)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.8317683168825399, 'auprc': 0.8506015144472608, 'loss_val': 0.45480178554181233, 'psi': 0.8393015959084282}-{'f1_val': 0.8339681430515905, 'auprc': 0.8279491216796918, 'loss_val': 0.3395418497910638, 'psi': 0.8315605345028311}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.891510 cos_to_last_merge=0.9912 (last merge round=28)
[S3] round=44 local utility u=0.001881 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9980078417518181, 'loss_val': 0.02724014113285736, 'psi': 0.9976249552957795}-{'f1_val': 0.9973982357793907, 'auprc': 0.9985939031176068, 'loss_val': 0.03293223072868799, 'psi': 0.9978765027146772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=44 head_norm_before_train=1.627922 cos_to_last_merge=0.9943 (last merge round=30)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.6396090175519408, 'auprc': 0.9006967542242545, 'loss_val': 0.6563424683548351, 'psi': 0.7440441122208663}-{'f1_val': 0.9410197733366742, 'auprc': 0.9135990981139256, 'loss_val': 0.30733770617863354, 'psi': 0.9300515032475747}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.930557 cos_to_last_merge=0.9949 (last merge round=27)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.5944898749688111, 'auprc': 0.8554835519952497, 'loss_val': 0.6222849773466599, 'psi': 0.6988873457793865}-{'f1_val': 0.7004938661094564, 'auprc': 0.9630875411383657, 'loss_val': 0.27891245486479355, 'psi': 0.8055313361210201}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.903893 cos_to_last_merge=0.9928 (last merge round=30)
[S6] round=44 local utility u=0.156308 metrics={'f1_val': 0.8237959730328261, 'auprc': 0.9571789411780199, 'loss_val': 0.3523036577239581, 'psi': 0.8771491602909036}-{'f1_val': 0.8227722660374753, 'auprc': 0.9353987965499931, 'loss_val': 0.593436569462121, 'psi': 0.8678228782424825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=44 head_norm_before_train=1.537628 cos_to_last_merge=0.9950 (last merge round=29)
[S7] round=44 local utility u=0.573729 metrics={'f1_val': 0.6879199214354104, 'auprc': 0.8348821893064633, 'loss_val': 0.37115004909008653, 'psi': 0.7467048285838316}-{'f1_val': 0.5729760403125194, 'auprc': 0.7922701634118842, 'loss_val': 0.7011081235951298, 'psi': 0.6606936895522653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=44 head_norm_before_train=1.663215 cos_to_last_merge=0.9859 (last merge round=29)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9963743336862869, 'auprc': 0.9977374735444718, 'loss_val': 0.038777598759964164, 'psi': 0.9969195896295608}-{'f1_val': 0.9964900410640029, 'auprc': 0.996315020148538, 'loss_val': 0.03463972473446508, 'psi': 0.996420032697817}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.859819 cos_to_last_merge=0.9949 (last merge round=25)
[S9] round=44 local utility u=0.023172 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9960314651815042, 'loss_val': 0.019917568131839952, 'psi': 0.9966743335798873}-{'f1_val': 0.9901606111321243, 'auprc': 0.9996155578346992, 'loss_val': 0.03535999516633855, 'psi': 0.9939425898131543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=44 head_norm_before_train=2.232606 cos_to_last_merge=0.9967 (last merge round=30)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9936028450452988, 'auprc': 0.9968212243870493, 'loss_val': 0.031341385001388763, 'psi': 0.9948901967819991}-{'f1_val': 0.9940169738272144, 'auprc': 0.9970924557650811, 'loss_val': 0.032592939575905464, 'psi': 0.9952471666023611}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=2.210426 cos_to_last_merge=0.9973 (last merge round=28)
[S11] round=44 local utility u=0.001633 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9974176961545735, 'loss_val': 0.01928783583922665, 'psi': 0.9970525883175767}-{'f1_val': 0.9968091830929121, 'auprc': 0.9966294878415445, 'loss_val': 0.020189889328280232, 'psi': 0.9967373049923651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=44 head_norm_before_train=2.176044 cos_to_last_merge=0.9972 (last merge round=29)
[S13] round=44 local utility u=0.285195 metrics={'f1_val': 0.7062981517431212, 'auprc': 0.7082962076687388, 'loss_val': 0.9789692081609147, 'psi': 0.7070973741133681}-{'f1_val': 0.6642270208024855, 'auprc': 0.6616586621596023, 'loss_val': 1.1570197609051427, 'psi': 0.6631996773453323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=44 head_norm_before_train=2.216669 cos_to_last_merge=0.9983 (last merge round=30)
[S14] round=44 local utility u=0.004705 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.999153589383651, 'loss_val': 0.022059817452337375, 'psi': 0.9978599406480595}-{'f1_val': 0.9965344645149313, 'auprc': 0.9974484335722431, 'loss_val': 0.023575619190244725, 'psi': 0.9969000521378562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=44 head_norm_before_train=1.881416 cos_to_last_merge=0.9795 (last merge round=27)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.903592774729807, 'auprc': 0.993139209646015, 'loss_val': 0.22384089468219304, 'psi': 0.9394113486962903}-{'f1_val': 0.9114460259425831, 'auprc': 0.9953004586426115, 'loss_val': 0.17125959064318733, 'psi': 0.9449877990225946}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.687568 cos_to_last_merge=0.9928 (last merge round=29)
[S16] round=44 local utility u=0.002621 metrics={'f1_val': 0.9912669882405759, 'auprc': 0.9867973627482088, 'loss_val': 0.046850927360646395, 'psi': 0.9894791380436292}-{'f1_val': 0.9917196238550823, 'auprc': 0.9848789074631409, 'loss_val': 0.049053060459850514, 'psi': 0.9889833372983057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=44 head_norm_before_train=2.221012 cos_to_last_merge=0.9955 (last merge round=25)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6003644403253929, 'auprc': 0.9356819124031082, 'loss_val': 1.4178075990074661, 'psi': 0.734491429156479}-{'f1_val': 0.8552574946797478, 'auprc': 0.8591773169155429, 'loss_val': 0.5931980806914509, 'psi': 0.8568254235740658}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.969775 cos_to_last_merge=0.9962 (last merge round=29)
[S2] round=45 local utility u=0.015382 metrics={'f1_val': 0.8306296665088896, 'auprc': 0.8730168028202394, 'loss_val': 0.4844515386823848, 'psi': 0.8475845210334295}-{'f1_val': 0.8317683168825399, 'auprc': 0.8506015144472608, 'loss_val': 0.45480178554181233, 'psi': 0.8393015959084282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=45 head_norm_before_train=1.901111 cos_to_last_merge=0.9905 (last merge round=28)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.982537901173439, 'auprc': 0.9971436423530669, 'loss_val': 0.04804089863128789, 'psi': 0.9883801976452902}-{'f1_val': 0.9973696976584205, 'auprc': 0.9980078417518181, 'loss_val': 0.02724014113285736, 'psi': 0.9976249552957795}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.633911 cos_to_last_merge=0.9940 (last merge round=30)
[S4] round=45 local utility u=1.000000 metrics={'f1_val': 0.9296378100074218, 'auprc': 0.9301483746926589, 'loss_val': 0.3844898141780303, 'psi': 0.9298420358815167}-{'f1_val': 0.6396090175519408, 'auprc': 0.9006967542242545, 'loss_val': 0.6563424683548351, 'psi': 0.7440441122208663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=45 head_norm_before_train=1.934504 cos_to_last_merge=0.9946 (last merge round=27)
[S5] round=45 local utility u=0.039309 metrics={'f1_val': 0.6009674313315589, 'auprc': 0.8559367557981818, 'loss_val': 0.5838914278219596, 'psi': 0.7029551611182081}-{'f1_val': 0.5944898749688111, 'auprc': 0.8554835519952497, 'loss_val': 0.6222849773466599, 'psi': 0.6988873457793865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=45 head_norm_before_train=1.918884 cos_to_last_merge=0.9920 (last merge round=30)
[S6] round=45 local utility u=0.578570 metrics={'f1_val': 0.9652095106793669, 'auprc': 0.9803117087677583, 'loss_val': 0.11304399501237547, 'psi': 0.9712503899147233}-{'f1_val': 0.8237959730328261, 'auprc': 0.9571789411780199, 'loss_val': 0.3523036577239581, 'psi': 0.8771491602909036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=45 head_norm_before_train=1.542977 cos_to_last_merge=0.9946 (last merge round=29)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.40365023865691785, 'auprc': 0.7796020043928529, 'loss_val': 1.330871478259957, 'psi': 0.5540309449512919}-{'f1_val': 0.6879199214354104, 'auprc': 0.8348821893064633, 'loss_val': 0.37115004909008653, 'psi': 0.7467048285838316}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.673966 cos_to_last_merge=0.9851 (last merge round=29)
[S8] round=45 local utility u=0.001892 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9983084291949953, 'loss_val': 0.03567920523829035, 'psi': 0.9970452337180898}-{'f1_val': 0.9963743336862869, 'auprc': 0.9977374735444718, 'loss_val': 0.038777598759964164, 'psi': 0.9969195896295608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=45 head_norm_before_train=1.865723 cos_to_last_merge=0.9946 (last merge round=25)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9945471069535985, 'loss_val': 0.01984886338779793, 'psi': 0.9960805902887251}-{'f1_val': 0.9971029125121428, 'auprc': 0.9960314651815042, 'loss_val': 0.019917568131839952, 'psi': 0.9966743335798873}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.241962 cos_to_last_merge=0.9964 (last merge round=30)
[S10] round=45 local utility u=0.000020 metrics={'f1_val': 0.9936028450452988, 'auprc': 0.99681037623631, 'loss_val': 0.031269268444090205, 'psi': 0.9948858575217033}-{'f1_val': 0.9936028450452988, 'auprc': 0.9968212243870493, 'loss_val': 0.031341385001388763, 'psi': 0.9948901967819991}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=45 head_norm_before_train=2.218408 cos_to_last_merge=0.9972 (last merge round=28)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977056284499062, 'loss_val': 0.021467418266572915, 'psi': 0.9970104540881162}-{'f1_val': 0.9968091830929121, 'auprc': 0.9974176961545735, 'loss_val': 0.01928783583922665, 'psi': 0.9970525883175767}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=2.184648 cos_to_last_merge=0.9968 (last merge round=29)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.7161255791941936, 'auprc': 0.6903962678536528, 'loss_val': 1.1535182929457592, 'psi': 0.7058338546579772}-{'f1_val': 0.7062981517431212, 'auprc': 0.7082962076687388, 'loss_val': 0.9789692081609147, 'psi': 0.7070973741133681}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=2.223131 cos_to_last_merge=0.9982 (last merge round=30)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9941024030357819, 'auprc': 0.9989784180059098, 'loss_val': 0.028668771229251384, 'psi': 0.996052809023833}-{'f1_val': 0.9969975081576651, 'auprc': 0.999153589383651, 'loss_val': 0.022059817452337375, 'psi': 0.9978599406480595}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.897275 cos_to_last_merge=0.9787 (last merge round=27)
[S15] round=45 local utility u=0.122551 metrics={'f1_val': 0.9270199019487131, 'auprc': 0.9933030369819529, 'loss_val': 0.11979352645599697, 'psi': 0.9535331559620089}-{'f1_val': 0.903592774729807, 'auprc': 0.993139209646015, 'loss_val': 0.22384089468219304, 'psi': 0.9394113486962903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=45 head_norm_before_train=1.697298 cos_to_last_merge=0.9923 (last merge round=29)
[S16] round=45 local utility u=0.009437 metrics={'f1_val': 0.9923674692870484, 'auprc': 0.9898583448794867, 'loss_val': 0.0437619991190396, 'psi': 0.9913638195240237}-{'f1_val': 0.9912669882405759, 'auprc': 0.9867973627482088, 'loss_val': 0.046850927360646395, 'psi': 0.9894791380436292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=45 head_norm_before_train=2.226996 cos_to_last_merge=0.9953 (last merge round=25)
[S17] round=45 local utility u=1.000000 metrics={'f1_val': 0.8926545768704087, 'auprc': 0.9612611872256374, 'loss_val': 0.4609606539082659, 'psi': 0.9200972210125001}-{'f1_val': 0.6003644403253929, 'auprc': 0.9356819124031082, 'loss_val': 1.4178075990074661, 'psi': 0.734491429156479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=46 head_norm_before_train=1.977705 cos_to_last_merge=0.9958 (last merge round=29)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.8113424073827598, 'auprc': 0.779674938158998, 'loss_val': 0.46873813059057223, 'psi': 0.7986754196932551}-{'f1_val': 0.8306296665088896, 'auprc': 0.8730168028202394, 'loss_val': 0.4844515386823848, 'psi': 0.8475845210334295}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.909261 cos_to_last_merge=0.9900 (last merge round=28)
[S3] round=46 local utility u=0.045619 metrics={'f1_val': 0.9944226333564837, 'auprc': 0.9978840645096071, 'loss_val': 0.030332825666274682, 'psi': 0.9958072058177331}-{'f1_val': 0.982537901173439, 'auprc': 0.9971436423530669, 'loss_val': 0.04804089863128789, 'psi': 0.9883801976452902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=46 head_norm_before_train=1.642147 cos_to_last_merge=0.9936 (last merge round=30)
[S4] round=46 local utility u=0.152713 metrics={'f1_val': 0.9484472347465737, 'auprc': 0.9580967900611905, 'loss_val': 0.27576525612767794, 'psi': 0.9523070568724205}-{'f1_val': 0.9296378100074218, 'auprc': 0.9301483746926589, 'loss_val': 0.3844898141780303, 'psi': 0.9298420358815167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=46 head_norm_before_train=1.939005 cos_to_last_merge=0.9944 (last merge round=27)
[S5] round=46 local utility u=0.095407 metrics={'f1_val': 0.6079229957102815, 'auprc': 0.870024744413501, 'loss_val': 0.4770743696017403, 'psi': 0.7127636951915693}-{'f1_val': 0.6009674313315589, 'auprc': 0.8559367557981818, 'loss_val': 0.5838914278219596, 'psi': 0.7029551611182081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=46 head_norm_before_train=1.930436 cos_to_last_merge=0.9913 (last merge round=30)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6416167297154864, 'auprc': 0.8039056529972157, 'loss_val': 0.9507958599512881, 'psi': 0.7065322990281782}-{'f1_val': 0.9652095106793669, 'auprc': 0.9803117087677583, 'loss_val': 0.11304399501237547, 'psi': 0.9712503899147233}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.549947 cos_to_last_merge=0.9943 (last merge round=29)
[S7] round=46 local utility u=1.000000 metrics={'f1_val': 0.6413703156291246, 'auprc': 0.8039205447229498, 'loss_val': 0.5033016939523408, 'psi': 0.7063904072666547}-{'f1_val': 0.40365023865691785, 'auprc': 0.7796020043928529, 'loss_val': 1.330871478259957, 'psi': 0.5540309449512919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=46 head_norm_before_train=1.683143 cos_to_last_merge=0.9843 (last merge round=29)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9984343759288898, 'loss_val': 0.03787928585604704, 'psi': 0.9970956124116477}-{'f1_val': 0.9962031034001528, 'auprc': 0.9983084291949953, 'loss_val': 0.03567920523829035, 'psi': 0.9970452337180898}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.873973 cos_to_last_merge=0.9943 (last merge round=25)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9947734239942433, 'auprc': 0.9996142890315276, 'loss_val': 0.02327098800923686, 'psi': 0.9967097700091571}-{'f1_val': 0.9971029125121428, 'auprc': 0.9945471069535985, 'loss_val': 0.01984886338779793, 'psi': 0.9960805902887251}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.250142 cos_to_last_merge=0.9961 (last merge round=30)
[S10] round=46 local utility u=0.000776 metrics={'f1_val': 0.9940169738272144, 'auprc': 0.9969849144387468, 'loss_val': 0.03272485067436635, 'psi': 0.9952041500718274}-{'f1_val': 0.9936028450452988, 'auprc': 0.99681037623631, 'loss_val': 0.031269268444090205, 'psi': 0.9948858575217033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=46 head_norm_before_train=2.224936 cos_to_last_merge=0.9971 (last merge round=28)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9956060750619125, 'auprc': 0.9975208994710898, 'loss_val': 0.02248638217525516, 'psi': 0.9963720048255834}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977056284499062, 'loss_val': 0.021467418266572915, 'psi': 0.9970104540881162}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=2.192349 cos_to_last_merge=0.9964 (last merge round=29)
[S13] round=46 local utility u=0.167137 metrics={'f1_val': 0.7410137256678049, 'auprc': 0.6857110132450641, 'loss_val': 0.9545176138477519, 'psi': 0.7188926406987086}-{'f1_val': 0.7161255791941936, 'auprc': 0.6903962678536528, 'loss_val': 1.1535182929457592, 'psi': 0.7058338546579772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=46 head_norm_before_train=2.228490 cos_to_last_merge=0.9980 (last merge round=30)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9770599262713275, 'auprc': 0.9988716601056609, 'loss_val': 0.08331187620382707, 'psi': 0.9857846198050608}-{'f1_val': 0.9941024030357819, 'auprc': 0.9989784180059098, 'loss_val': 0.028668771229251384, 'psi': 0.996052809023833}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.912538 cos_to_last_merge=0.9780 (last merge round=27)
[S15] round=46 local utility u=0.264733 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9970370743349315, 'loss_val': 0.019890432998888437, 'psi': 0.996862830766485}-{'f1_val': 0.9270199019487131, 'auprc': 0.9933030369819529, 'loss_val': 0.11979352645599697, 'psi': 0.9535331559620089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=46 head_norm_before_train=1.708068 cos_to_last_merge=0.9918 (last merge round=29)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9908522410827455, 'auprc': 0.989315752960053, 'loss_val': 0.04807661860714773, 'psi': 0.9902376458336686}-{'f1_val': 0.9923674692870484, 'auprc': 0.9898583448794867, 'loss_val': 0.0437619991190396, 'psi': 0.9913638195240237}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=2.229515 cos_to_last_merge=0.9953 (last merge round=25)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.5116688074576419, 'auprc': 0.6746815237774156, 'loss_val': 1.757412856925279, 'psi': 0.5768738939855513}-{'f1_val': 0.8926545768704087, 'auprc': 0.9612611872256374, 'loss_val': 0.4609606539082659, 'psi': 0.9200972210125001}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.980534 cos_to_last_merge=0.9952 (last merge round=29)
[S2] round=47 local utility u=0.266256 metrics={'f1_val': 0.8315071592437895, 'auprc': 0.9040630302372803, 'loss_val': 0.4303796384623283, 'psi': 0.8605295076411859}-{'f1_val': 0.8113424073827598, 'auprc': 0.779674938158998, 'loss_val': 0.46873813059057223, 'psi': 0.7986754196932551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=47 head_norm_before_train=1.916927 cos_to_last_merge=0.9895 (last merge round=28)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9477099838211495, 'auprc': 0.9960029106224488, 'loss_val': 0.14044858674540703, 'psi': 0.9670271545416692}-{'f1_val': 0.9944226333564837, 'auprc': 0.9978840645096071, 'loss_val': 0.030332825666274682, 'psi': 0.9958072058177331}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.651324 cos_to_last_merge=0.9932 (last merge round=30)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9429113991336645, 'auprc': 0.9632663009668131, 'loss_val': 0.287136144532285, 'psi': 0.951053359866924}-{'f1_val': 0.9484472347465737, 'auprc': 0.9580967900611905, 'loss_val': 0.27576525612767794, 'psi': 0.9523070568724205}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.944228 cos_to_last_merge=0.9941 (last merge round=27)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.5310137561015893, 'auprc': 0.8554401251841747, 'loss_val': 0.8315123499824809, 'psi': 0.6607843037346235}-{'f1_val': 0.6079229957102815, 'auprc': 0.870024744413501, 'loss_val': 0.4770743696017403, 'psi': 0.7127636951915693}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.944790 cos_to_last_merge=0.9905 (last merge round=30)
[S6] round=47 local utility u=1.000000 metrics={'f1_val': 0.8287694676252786, 'auprc': 0.9450165267049764, 'loss_val': 0.3696585459610944, 'psi': 0.8752682912571577}-{'f1_val': 0.6416167297154864, 'auprc': 0.8039056529972157, 'loss_val': 0.9507958599512881, 'psi': 0.7065322990281782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=47 head_norm_before_train=1.553254 cos_to_last_merge=0.9940 (last merge round=29)
[S7] round=47 local utility u=0.533020 metrics={'f1_val': 0.6988766735852125, 'auprc': 0.9672446335011418, 'loss_val': 0.2722721017799734, 'psi': 0.8062238575515843}-{'f1_val': 0.6413703156291246, 'auprc': 0.8039205447229498, 'loss_val': 0.5033016939523408, 'psi': 0.7063904072666547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=47 head_norm_before_train=1.691001 cos_to_last_merge=0.9833 (last merge round=29)
[S8] round=47 local utility u=0.000845 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9982982892639768, 'loss_val': 0.03578041818811734, 'psi': 0.9970411777456825}-{'f1_val': 0.9962031034001528, 'auprc': 0.9984343759288898, 'loss_val': 0.03787928585604704, 'psi': 0.9970956124116477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=47 head_norm_before_train=1.877541 cos_to_last_merge=0.9940 (last merge round=25)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9997615657745538, 'loss_val': 0.024411914759928394, 'psi': 0.9965186198275118}-{'f1_val': 0.9947734239942433, 'auprc': 0.9996142890315276, 'loss_val': 0.02327098800923686, 'psi': 0.9967097700091571}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.256413 cos_to_last_merge=0.9959 (last merge round=30)
[S10] round=47 local utility u=0.000286 metrics={'f1_val': 0.9938221244917009, 'auprc': 0.9970227730024529, 'loss_val': 0.031097177310794633, 'psi': 0.9951023838960018}-{'f1_val': 0.9940169738272144, 'auprc': 0.9969849144387468, 'loss_val': 0.03272485067436635, 'psi': 0.9952041500718274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=47 head_norm_before_train=2.230810 cos_to_last_merge=0.9969 (last merge round=28)
[S11] round=47 local utility u=0.005969 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9979465662524079, 'loss_val': 0.019044749310531264, 'psi': 0.9972641363567104}-{'f1_val': 0.9956060750619125, 'auprc': 0.9975208994710898, 'loss_val': 0.02248638217525516, 'psi': 0.9963720048255834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=47 head_norm_before_train=2.198950 cos_to_last_merge=0.9961 (last merge round=29)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.689408605152851, 'auprc': 0.7238312254549476, 'loss_val': 1.1161895689453016, 'psi': 0.7031776532736896}-{'f1_val': 0.7410137256678049, 'auprc': 0.6857110132450641, 'loss_val': 0.9545176138477519, 'psi': 0.7188926406987086}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.233685 cos_to_last_merge=0.9979 (last merge round=30)
[S14] round=47 local utility u=0.060213 metrics={'f1_val': 0.9900098468022962, 'auprc': 0.9989438347762172, 'loss_val': 0.04080177613473596, 'psi': 0.9935834419918645}-{'f1_val': 0.9770599262713275, 'auprc': 0.9988716601056609, 'loss_val': 0.08331187620382707, 'psi': 0.9857846198050608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=47 head_norm_before_train=1.927509 cos_to_last_merge=0.9771 (last merge round=27)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.995979070103656, 'loss_val': 0.026773480199771438, 'psi': 0.996191074550747}-{'f1_val': 0.9967466683875206, 'auprc': 0.9970370743349315, 'loss_val': 0.019890432998888437, 'psi': 0.996862830766485}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.718102 cos_to_last_merge=0.9913 (last merge round=29)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9398603916842213, 'auprc': 0.9864100185189391, 'loss_val': 0.2184634503069209, 'psi': 0.9584802424181085}-{'f1_val': 0.9908522410827455, 'auprc': 0.989315752960053, 'loss_val': 0.04807661860714773, 'psi': 0.9902376458336686}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=2.229682 cos_to_last_merge=0.9953 (last merge round=25)
[S17] round=47 local utility u=1.000000 metrics={'f1_val': 0.811410291865342, 'auprc': 0.8118372217810342, 'loss_val': 0.7032489635415283, 'psi': 0.8115810638316189}-{'f1_val': 0.5116688074576419, 'auprc': 0.6746815237774156, 'loss_val': 1.757412856925279, 'psi': 0.5768738939855513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=48 head_norm_before_train=1.989409 cos_to_last_merge=0.9948 (last merge round=29)
[S2] round=48 local utility u=0.039178 metrics={'f1_val': 0.8315071592437895, 'auprc': 0.9179622277251185, 'loss_val': 0.39372042623594344, 'psi': 0.8660891866363212}-{'f1_val': 0.8315071592437895, 'auprc': 0.9040630302372803, 'loss_val': 0.4303796384623283, 'psi': 0.8605295076411859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=48 head_norm_before_train=1.924940 cos_to_last_merge=0.9890 (last merge round=28)
[S3] round=48 local utility u=0.207828 metrics={'f1_val': 0.9969520501205896, 'auprc': 0.9979575578012684, 'loss_val': 0.02610916649557902, 'psi': 0.9973542531928611}-{'f1_val': 0.9477099838211495, 'auprc': 0.9960029106224488, 'loss_val': 0.14044858674540703, 'psi': 0.9670271545416692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=48 head_norm_before_train=1.658251 cos_to_last_merge=0.9927 (last merge round=30)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.941869423431669, 'auprc': 0.9436996860455831, 'loss_val': 0.3016950494725788, 'psi': 0.9426015284772347}-{'f1_val': 0.9429113991336645, 'auprc': 0.9632663009668131, 'loss_val': 0.287136144532285, 'psi': 0.951053359866924}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.951742 cos_to_last_merge=0.9938 (last merge round=27)
[S5] round=48 local utility u=0.389956 metrics={'f1_val': 0.6079229957102815, 'auprc': 0.8644663932333813, 'loss_val': 0.540134088665717, 'psi': 0.7105403547195215}-{'f1_val': 0.5310137561015893, 'auprc': 0.8554401251841747, 'loss_val': 0.8315123499824809, 'psi': 0.6607843037346235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=48 head_norm_before_train=1.954084 cos_to_last_merge=0.9899 (last merge round=30)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.5982318313970253, 'auprc': 0.6557799948056205, 'loss_val': 1.3584455928805321, 'psi': 0.6212510967604634}-{'f1_val': 0.8287694676252786, 'auprc': 0.9450165267049764, 'loss_val': 0.3696585459610944, 'psi': 0.8752682912571577}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.556763 cos_to_last_merge=0.9938 (last merge round=29)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5468779769504204, 'auprc': 0.7864902692698501, 'loss_val': 0.8479553154045738, 'psi': 0.6427228938781923}-{'f1_val': 0.6988766735852125, 'auprc': 0.9672446335011418, 'loss_val': 0.2722721017799734, 'psi': 0.8062238575515843}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.702004 cos_to_last_merge=0.9825 (last merge round=29)
[S8] round=48 local utility u=0.003071 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9982173015117151, 'loss_val': 0.03201518071636255, 'psi': 0.9972708451933457}-{'f1_val': 0.9962031034001528, 'auprc': 0.9982982892639768, 'loss_val': 0.03578041818811734, 'psi': 0.9970411777456825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=48 head_norm_before_train=1.882055 cos_to_last_merge=0.9937 (last merge round=25)
[S9] round=48 local utility u=0.008412 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9980724508327543, 'loss_val': 0.018997645600004033, 'psi': 0.9974907278403874}-{'f1_val': 0.994356655862817, 'auprc': 0.9997615657745538, 'loss_val': 0.024411914759928394, 'psi': 0.9965186198275118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=48 head_norm_before_train=2.261421 cos_to_last_merge=0.9956 (last merge round=30)
[S10] round=48 local utility u=0.000017 metrics={'f1_val': 0.9940169738272144, 'auprc': 0.9971908665456185, 'loss_val': 0.03273688463133732, 'psi': 0.9952865309145761}-{'f1_val': 0.9938221244917009, 'auprc': 0.9970227730024529, 'loss_val': 0.031097177310794633, 'psi': 0.9951023838960018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=48 head_norm_before_train=2.237846 cos_to_last_merge=0.9968 (last merge round=28)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997947896176723, 'loss_val': 0.021200208741519306, 'psi': 0.9971073611788429}-{'f1_val': 0.9968091830929121, 'auprc': 0.9979465662524079, 'loss_val': 0.019044749310531264, 'psi': 0.9972641363567104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=2.205968 cos_to_last_merge=0.9958 (last merge round=29)
[S13] round=48 local utility u=0.172917 metrics={'f1_val': 0.7344951816999647, 'auprc': 0.7313438929928079, 'loss_val': 1.063413797372547, 'psi': 0.733234666217102}-{'f1_val': 0.689408605152851, 'auprc': 0.7238312254549476, 'loss_val': 1.1161895689453016, 'psi': 0.7031776532736896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] sending update (kind=head size=1791 to 1 peers)
[S14] START round=48 head_norm_before_train=2.236934 cos_to_last_merge=0.9977 (last merge round=30)
[S14] round=48 local utility u=0.028050 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9985129630052633, 'loss_val': 0.024032479495795806, 'psi': 0.9974734897063886}-{'f1_val': 0.9900098468022962, 'auprc': 0.9989438347762172, 'loss_val': 0.04080177613473596, 'psi': 0.9935834419918645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=48 head_norm_before_train=1.941504 cos_to_last_merge=0.9764 (last merge round=27)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.9753905134296438, 'auprc': 0.9931317777117584, 'loss_val': 0.049068522578484604, 'psi': 0.9824870191424896}-{'f1_val': 0.9963324108488076, 'auprc': 0.995979070103656, 'loss_val': 0.026773480199771438, 'psi': 0.996191074550747}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.727205 cos_to_last_merge=0.9909 (last merge round=29)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.8513192897737134, 'auprc': 0.9852864708561798, 'loss_val': 0.815268581445593, 'psi': 0.9049061622067}-{'f1_val': 0.9398603916842213, 'auprc': 0.9864100185189391, 'loss_val': 0.2184634503069209, 'psi': 0.9584802424181085}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=2.233351 cos_to_last_merge=0.9952 (last merge round=25)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.641157114993363, 'auprc': 0.8891620357063945, 'loss_val': 1.1226632148611944, 'psi': 0.7403590832785756}-{'f1_val': 0.811410291865342, 'auprc': 0.8118372217810342, 'loss_val': 0.7032489635415283, 'psi': 0.8115810638316189}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.993446 cos_to_last_merge=0.9943 (last merge round=29)
[S2] round=49 local utility u=0.060039 metrics={'f1_val': 0.830733455770276, 'auprc': 0.9743295516712569, 'loss_val': 0.4381022938632286, 'psi': 0.8881718941306683}-{'f1_val': 0.8315071592437895, 'auprc': 0.9179622277251185, 'loss_val': 0.39372042623594344, 'psi': 0.8660891866363212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=49 head_norm_before_train=1.932175 cos_to_last_merge=0.9885 (last merge round=28)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9678748498626185, 'auprc': 0.9903606195721213, 'loss_val': 0.08734896538920323, 'psi': 0.9768691577464197}-{'f1_val': 0.9969520501205896, 'auprc': 0.9979575578012684, 'loss_val': 0.02610916649557902, 'psi': 0.9973542531928611}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.668252 cos_to_last_merge=0.9920 (last merge round=30)
[S4] round=49 local utility u=0.063123 metrics={'f1_val': 0.9504652445379093, 'auprc': 0.960479524098819, 'loss_val': 0.2773639748288972, 'psi': 0.9544709563622731}-{'f1_val': 0.941869423431669, 'auprc': 0.9436996860455831, 'loss_val': 0.3016950494725788, 'psi': 0.9426015284772347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=49 head_norm_before_train=1.957800 cos_to_last_merge=0.9936 (last merge round=27)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.5649912151376348, 'auprc': 0.8566666316222398, 'loss_val': 0.6875136677570072, 'psi': 0.6816613817314768}-{'f1_val': 0.6079229957102815, 'auprc': 0.8644663932333813, 'loss_val': 0.540134088665717, 'psi': 0.7105403547195215}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.963874 cos_to_last_merge=0.9893 (last merge round=30)
[S6] round=49 local utility u=1.000000 metrics={'f1_val': 0.822646181206372, 'auprc': 0.9222216751030032, 'loss_val': 0.5162383580870531, 'psi': 0.8624763787650245}-{'f1_val': 0.5982318313970253, 'auprc': 0.6557799948056205, 'loss_val': 1.3584455928805321, 'psi': 0.6212510967604634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=49 head_norm_before_train=1.562593 cos_to_last_merge=0.9934 (last merge round=29)
[S7] round=49 local utility u=1.000000 metrics={'f1_val': 0.6989627483556798, 'auprc': 0.9779954771201758, 'loss_val': 0.2638964000297261, 'psi': 0.8105758398614782}-{'f1_val': 0.5468779769504204, 'auprc': 0.7864902692698501, 'loss_val': 0.8479553154045738, 'psi': 0.6427228938781923}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=49 head_norm_before_train=1.715054 cos_to_last_merge=0.9817 (last merge round=29)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9957762472918722, 'loss_val': 0.03715290948439401, 'psi': 0.9960323609568407}-{'f1_val': 0.9966398743144329, 'auprc': 0.9982173015117151, 'loss_val': 0.03201518071636255, 'psi': 0.9972708451933457}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.888865 cos_to_last_merge=0.9935 (last merge round=25)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9973361402837442, 'loss_val': 0.018815608589330107, 'psi': 0.9971962036207833}-{'f1_val': 0.9971029125121428, 'auprc': 0.9980724508327543, 'loss_val': 0.018997645600004033, 'psi': 0.9974907278403874}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.268660 cos_to_last_merge=0.9953 (last merge round=30)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9937976313733077, 'auprc': 0.9974896662500885, 'loss_val': 0.03368235716360451, 'psi': 0.9952744453240201}-{'f1_val': 0.9940169738272144, 'auprc': 0.9971908665456185, 'loss_val': 0.03273688463133732, 'psi': 0.9952865309145761}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.245347 cos_to_last_merge=0.9966 (last merge round=28)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9806844940670087, 'auprc': 0.9974572728594707, 'loss_val': 0.07328012344238052, 'psi': 0.9873936055839936}-{'f1_val': 0.9965470045135896, 'auprc': 0.997947896176723, 'loss_val': 0.021200208741519306, 'psi': 0.9971073611788429}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=2.211069 cos_to_last_merge=0.9955 (last merge round=29)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.7221805699984762, 'auprc': 0.7459293756563506, 'loss_val': 1.1935626251746365, 'psi': 0.731680092261626}-{'f1_val': 0.7344951816999647, 'auprc': 0.7313438929928079, 'loss_val': 1.063413797372547, 'psi': 0.733234666217102}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=2.241820 cos_to_last_merge=0.9975 (last merge round=30)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9897876557670613, 'auprc': 0.998939842576458, 'loss_val': 0.04168992274107802, 'psi': 0.99344853049082}-{'f1_val': 0.9967805075071389, 'auprc': 0.9985129630052633, 'loss_val': 0.024032479495795806, 'psi': 0.9974734897063886}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.954924 cos_to_last_merge=0.9757 (last merge round=27)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.9103381395256694, 'auprc': 0.9932072734545428, 'loss_val': 0.18289540954368194, 'psi': 0.9434857930972187}-{'f1_val': 0.9753905134296438, 'auprc': 0.9931317777117584, 'loss_val': 0.049068522578484604, 'psi': 0.9824870191424896}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.735541 cos_to_last_merge=0.9905 (last merge round=29)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.8407192159852966, 'auprc': 0.9858603043920584, 'loss_val': 0.9456453641777011, 'psi': 0.8987756513480014}-{'f1_val': 0.8513192897737134, 'auprc': 0.9852864708561798, 'loss_val': 0.815268581445593, 'psi': 0.9049061622067}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=2.241976 cos_to_last_merge=0.9949 (last merge round=25)
[S17] round=49 local utility u=0.540794 metrics={'f1_val': 0.7857045189824212, 'auprc': 0.8503041678223429, 'loss_val': 0.7917851053080668, 'psi': 0.8115443785183898}-{'f1_val': 0.641157114993363, 'auprc': 0.8891620357063945, 'loss_val': 1.1226632148611944, 'psi': 0.7403590832785756}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
