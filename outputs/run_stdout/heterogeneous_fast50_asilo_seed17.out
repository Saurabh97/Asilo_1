[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:38403
[S3] → join 127.0.0.1:38402
[S4] → join 127.0.0.1:38402
[S5] → join 127.0.0.1:38402
[S6] → join 127.0.0.1:38402
[S7] → join 127.0.0.1:38402
[S8] → join 127.0.0.1:38402
[S9] → join 127.0.0.1:38402
[S10] → join 127.0.0.1:38402
[S11] → join 127.0.0.1:38402
[S13] → join 127.0.0.1:38402
[S14] → join 127.0.0.1:38402
[S15] → join 127.0.0.1:38402
[S16] → join 127.0.0.1:38402
[S17] → join 127.0.0.1:38402
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.204055 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.212228 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.147721 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.178678 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.138291 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.102842 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.265890 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.177196 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.235473 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.157969 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.169947 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.168340 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.150796 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.108963 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.164394 (no previous merge yet)
[S6]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S10
[S3] + discovered S9
[S3] + discovered S17
[S3] + discovered S8
[S3] + discovered S16
[S3] + discovered S4
[S3] + discovered S7
[S3] + discovered S6
[S3] + discovered S15
[S3] + discovered S14
[S3] + discovered S5
[S3] + discovered S13
[S3] + discovered S11
[S5] + discovered S4
[S5] + discovered S2
[S5] + discovered S3
[S4] + discovered S10
[S4] + discovered S9
[S4] + discovered S14
[S4] + discovered S8
[S4] + discovered S16
[S4] + discovered S7
[S4] + discovered S17
[S4] + discovered S6
[S4] + discovered S15
[S4] + discovered S5
[S4] + discovered S13
[S4] + discovered S11
[S5] + discovered S11
[S5] + discovered S6
[S5] + discovered S9
[S6] + discovered S2
[S6] + discovered S3
[S5] + discovered S10
[S6] + discovered S5
[S5] + discovered S17
[S6] + discovered S4
[S5] + discovered S14
[S5] + discovered S15
[S5] + discovered S13
[S5] + discovered S16
[S5] + discovered S7
[S5] + discovered S8
[S6] + discovered S16
[S6] + discovered S7
[S6] + discovered S10
[S6] + discovered S8
[S6] + discovered S17
[S6] + discovered S11
[S6] + discovered S13
[S6] + discovered S15
[S6] + discovered S14
[S6] + discovered S9
[S7] + discovered S2
[S7] + discovered S3
[S7] + discovered S4
[S7] + discovered S6
[S7] + discovered S5
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S2
[S8] + discovered S7
[S8] + discovered S3
[S8] + discovered S4
[S7] + discovered S16
[S7] + discovered S8
[S7] + discovered S13
[S7] + discovered S10
[S7] + discovered S17
[S7] + discovered S11
[S7] + discovered S15
[S7] + discovered S14
[S7] + discovered S9
[S9] + discovered S4
[S9] + discovered S3
[S8] + discovered S13
[S9] + discovered S2
[S8] + discovered S15
[S9] + discovered S6
[S8] + discovered S14
[S9] + discovered S5
[S8] + discovered S11
[S8] + discovered S16
[S9] + discovered S7
[S9] + discovered S8
[S8] + discovered S9
[S8] + discovered S17
[S8] + discovered S10
[S10] + discovered S5
[S10] + discovered S8
[S10] + discovered S9
[S10] + discovered S7
[S9] + discovered S11
[S9] + discovered S17
[S9] + discovered S15
[S9] + discovered S16
[S9] + discovered S14
[S9] + discovered S13
[S9] + discovered S10
[S10] + discovered S4
[S10] + discovered S3
[S10] + discovered S2
[S10] + discovered S6
[S10] + discovered S11
[S10] + discovered S14
[S11] + discovered S7
[S11] + discovered S9
[S11] + discovered S8
[S10] + discovered S16
[S11] + discovered S4
[S11] + discovered S3
[S11] + discovered S2
[S10] + discovered S15
[S10] + discovered S17
[S11] + discovered S6
[S11] + discovered S5
[S11] + discovered S10
[S10] + discovered S13
[S13] + discovered S8
[S13] + discovered S3
[S13] + discovered S9
[S13] + discovered S2
[S13] + discovered S5
[S13] + discovered S11
[S13] + discovered S10
[S13] + discovered S6
[S11] + discovered S13
[S11] + discovered S16
[S11] + discovered S15
[S11] + discovered S14
[S11] + discovered S17
[S13] + discovered S4
[S13] + discovered S7
[S14] + discovered S3
[S13] + discovered S14
[S14] + discovered S4
[S14] + discovered S6
[S14] + discovered S13
[S14] + discovered S10
[S14] + discovered S7
[S14] + discovered S11
[S13] + discovered S15
[S14] + discovered S8
[S14] + discovered S5
[S14] + discovered S2
[S13] + discovered S17
[S13] + discovered S16
[S14] + discovered S9
[S15] + discovered S3
[S15] + discovered S9
[S15] + discovered S14
[S15] + discovered S2
[S15] + discovered S4
[S14] + discovered S16
[S14] + discovered S15
[S14] + discovered S17
[S15] + discovered S6
[S15] + discovered S7
[S15] + discovered S13
[S15] + discovered S11
[S15] + discovered S8
[S15] + discovered S5
[S15] + discovered S10
[S16] + discovered S10
[S16] + discovered S3
[S16] + discovered S14
[S16] + discovered S9
[S16] + discovered S2
[S16] + discovered S4
[S16] + discovered S15
[S16] + discovered S7
[S16] + discovered S6
[S16] + discovered S13
[S16] + discovered S11
[S16] + discovered S5
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S8
[S17] + discovered S5
[S17] + discovered S10
[S17] + discovered S3
[S17] + discovered S8
[S17] + discovered S2
[S16] + discovered S17
[S17] + discovered S15
[S17] + discovered S14
[S17] + discovered S9
[S17] + discovered S4
[S17] + discovered S11
[S17] + discovered S6
[S17] + discovered S13
[S17] + discovered S7
[S17] + discovered S16
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=1.000 → S8@127.0.0.1:38409
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:38407
[S15] ⇄ pheromone p=1.000 → S7@127.0.0.1:38408
[S10] ⇄ pheromone p=1.000 → S7@127.0.0.1:38408
[S11] ⇄ pheromone p=1.000 → S10@127.0.0.1:38411
[S13] ⇄ pheromone p=1.000 → S16@127.0.0.1:38416
[S6] ⇄ pheromone p=1.000 → S7@127.0.0.1:38408
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:38409
[S9] ⇄ pheromone p=1.000 → S3@127.0.0.1:38403
[S8] ⇄ pheromone p=1.000 → S16@127.0.0.1:38416
[S2] ⇄ pheromone p=1.000 → S5@127.0.0.1:38405
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:38403
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:38404
[S14] ⇄ pheromone p=1.000 → S13@127.0.0.1:38413
[S17] ⇄ pheromone p=1.000 → S14@127.0.0.1:38414
[S2] START round=1 head_norm_before_train=1.219010 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7854335038527691, 'loss_val': 1.2434653262281188, 'psi': 0.3992396815742477}-{'f1_val': 0.1417771333885667, 'auprc': 0.8945385703944427, 'loss_val': 1.3247536576587848, 'psi': 0.44288170819091716}
[S3] START round=1 head_norm_before_train=1.227766 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9490753662283447, 'loss_val': 1.2987660718222704, 'psi': 0.4635341858598021}-{'f1_val': 0.24843823807274446, 'auprc': 0.9112395589359085, 'loss_val': 1.328678612884437, 'psi': 0.51355876641801}
[S4] START round=1 head_norm_before_train=1.160323 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.6282535288984107, 'loss_val': 1.283712889214155, 'psi': 0.3354373888964748}-{'f1_val': 0.3687705109895312, 'auprc': 0.5932976495576636, 'loss_val': 1.3460918433704714, 'psi': 0.45858136641678415}
[S5] START round=1 head_norm_before_train=1.175547 (no previous merge yet)
[S5] round=1 local utility u=1.000000 metrics={'f1_val': 0.41593474276216175, 'auprc': 0.49054667647289363, 'loss_val': 1.330069534657795, 'psi': 0.4457795162464545}-{'f1_val': 0.0885440438156093, 'auprc': 0.4003436804348857, 'loss_val': 1.362471727610918, 'psi': 0.2132638984633199}
[S6] START round=1 head_norm_before_train=1.154051 (no previous merge yet)
[S6] round=1 local utility u=0.028441 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6241977256948417, 'loss_val': 1.2510296355378223, 'psi': 0.3345348595087059}-{'f1_val': 0.14142628205128205, 'auprc': 0.6267707232081772, 'loss_val': 1.3156311389294417, 'psi': 0.3355640585140401}
[S7] START round=1 head_norm_before_train=1.114400 (no previous merge yet)
[S7] round=1 local utility u=1.000000 metrics={'f1_val': 0.42341651994924456, 'auprc': 0.7655000709072586, 'loss_val': 1.3258231926228152, 'psi': 0.5602499403324501}-{'f1_val': 0.10429108604291086, 'auprc': 0.6391981263183152, 'loss_val': 1.356390235017212, 'psi': 0.3182539021530726}
[S8] START round=1 head_norm_before_train=1.274434 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7159970986845152, 'loss_val': 1.2783917618401925, 'psi': 0.37037242890958044}-{'f1_val': 0.3730877481939384, 'auprc': 0.6575233481692788, 'loss_val': 1.3474517656443512, 'psi': 0.48686198818407456}
[S9] START round=1 head_norm_before_train=1.176765 (no previous merge yet)
[S9] round=1 local utility u=1.000000 metrics={'f1_val': 0.4156511382980026, 'auprc': 0.9792876922470789, 'loss_val': 1.3301599846827756, 'psi': 0.6411057598776331}-{'f1_val': 0.08895775941230487, 'auprc': 0.814910775866474, 'loss_val': 1.3755889942806885, 'psi': 0.37933896599397254}
[S10] START round=1 head_norm_before_train=1.251281 (no previous merge yet)
[S10] round=1 local utility u=0.082394 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6245933935266137, 'loss_val': 1.2674937864834042, 'psi': 0.33301033993567986}-{'f1_val': 0.13862163754172394, 'auprc': 0.5886928106455285, 'loss_val': 1.3245799873170832, 'psi': 0.3186501067832458}
[S11] START round=1 head_norm_before_train=1.162543 (no previous merge yet)
[S11] round=1 local utility u=0.259122 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7726558265648066, 'loss_val': 1.3200808527623589, 'psi': 0.393310540649789}-{'f1_val': 0.14041368337311058, 'auprc': 0.6094908249654885, 'loss_val': 1.3488306310050118, 'psi': 0.3280445400100617}
[S13] START round=1 head_norm_before_train=1.186570 (no previous merge yet)
[S13] round=1 local utility u=0.009873 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6354183503536506, 'loss_val': 1.2716666545719824, 'psi': 0.3383987976876921}-{'f1_val': 0.1403857625770531, 'auprc': 0.6438857344410017, 'loss_val': 1.3168153241047815, 'psi': 0.34178575132263256}
[S14] START round=1 head_norm_before_train=1.168826 (no previous merge yet)
[S14] round=1 local utility u=0.237801 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6485399919648223, 'loss_val': 1.3382165866968574, 'psi': 0.34363070851555116}-{'f1_val': 0.14035785288270378, 'auprc': 0.4987370259900342, 'loss_val': 1.3644105663003931, 'psi': 0.28370952212563594}
[S15] START round=1 head_norm_before_train=1.154415 (no previous merge yet)
[S15] round=1 local utility u=0.027404 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7694233376102405, 'loss_val': 1.2992220490354862, 'psi': 0.3916095258610312}-{'f1_val': 0.13973365136155833, 'auprc': 0.7666517909117355, 'loss_val': 1.3457149122464904, 'psi': 0.3905009071816292}
[S16] START round=1 head_norm_before_train=1.117239 (no previous merge yet)
[S16] round=1 local utility u=0.068945 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7580988580846804, 'loss_val': 1.3002483815931092, 'psi': 0.3876220133533941}-{'f1_val': 0.14063745019920318, 'auprc': 0.7228751420965387, 'loss_val': 1.3324665718496211, 'psi': 0.37353252695813743}
[S17] START round=1 head_norm_before_train=1.177131 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.644461763003521, 'loss_val': 1.276394146662564, 'psi': 0.342354083191839}-{'f1_val': 0.3828881359018414, 'auprc': 0.6956555721858525, 'loss_val': 1.3363839811177267, 'psi': 0.5079951104154459}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:38402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:38402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:38404
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:38416
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:38402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:38412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S7] → sending delta(kind=head bytes=1787) to S2@127.0.0.1:38402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:38402
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1787 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1794) from S10
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.293749)
[S2] loaded HEAD from S10 (vec_in norm=1.293749)
[S2] cosine check vs S10: cos=-0.0776
[S2] DROPPED delta from S10 (cos=-0.0776 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1790) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.190272)
[S2] loaded HEAD from S9 (vec_in norm=1.190272)
[S2] cosine check vs S9: cos=-0.0241
[S2] DROPPED delta from S9 (cos=-0.0241 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1793) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.186182)
[S11] loaded HEAD from S15 (vec_in norm=1.186182)
[S11] cosine check vs S15: cos=0.0643
[S11] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1787) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.134459)
[S2] loaded HEAD from S7 (vec_in norm=1.134459)
[S2] cosine check vs S7: cos=-0.0124
[S2] DROPPED delta from S7 (cos=-0.0124 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.175990)
[S16] loaded HEAD from S11 (vec_in norm=1.175990)
[S16] cosine check vs S11: cos=0.0388
[S16] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1793) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.180405)
[S7] loaded HEAD from S14 (vec_in norm=1.180405)
[S7] cosine check vs S14: cos=0.0933
[S7] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1793) from S6
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.192075)
[S2] loaded HEAD from S6 (vec_in norm=1.192075)
[S2] cosine check vs S6: cos=0.0279
[S2] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1791) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.183110)
[S4] loaded HEAD from S5 (vec_in norm=1.183110)
[S4] cosine check vs S5: cos=0.0409
[S4] BUFFERED delta from S5 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1796) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.220195)
[S2] loaded HEAD from S13 (vec_in norm=1.220195)
[S2] cosine check vs S13: cos=-0.0351
[S2] DROPPED delta from S13 (cos=-0.0351 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1793) from S16
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.137081)
[S10] loaded HEAD from S16 (vec_in norm=1.137081)
[S10] cosine check vs S16: cos=-0.0611
[S10] DROPPED delta from S16 (cos=-0.0611 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.262051
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.558446e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.880021 delta_norm=0.855845
[S2] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1402 head_norm=1.197252
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.242047e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1402 head_norm=0.858643 delta_norm=0.824205
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.4234 head_norm=1.134459
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.794948e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.855900 delta_norm=0.779495
[S7] aggregate: ROLLBACK (f1_val pre=0.423 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.175990
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.078834e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.861577 delta_norm=0.807883
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.137081
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.018950e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.833617 delta_norm=0.801895
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.880021 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6056882794406134, 'loss_val': 1.2292875695140777, 'psi': 0.32734159180938543}-{'f1_val': 0.1417771333885667, 'auprc': 0.7854335038527691, 'loss_val': 1.2434653262281188, 'psi': 0.3992396815742477}
[S3] START round=2 head_norm_before_train=1.250232 (no previous merge yet)
[S3] round=2 local utility u=0.063035 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9768768500693439, 'loss_val': 1.256100181786776, 'psi': 0.4746547793962018}-{'f1_val': 0.13984006561410703, 'auprc': 0.9490753662283447, 'loss_val': 1.2987660718222704, 'psi': 0.4635341858598021}
[S4] START round=2 head_norm_before_train=0.858643 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.032285 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.6369993144012085, 'loss_val': 1.245380336406926, 'psi': 0.3389357030975939}-{'f1_val': 0.14022662889518414, 'auprc': 0.6282535288984107, 'loss_val': 1.283712889214155, 'psi': 0.3354373888964748}
[S5] START round=2 head_norm_before_train=1.183110 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5265511103763363, 'loss_val': 1.2938599760712188, 'psi': 0.2959775870076774}-{'f1_val': 0.41593474276216175, 'auprc': 0.49054667647289363, 'loss_val': 1.330069534657795, 'psi': 0.4457795162464545}
[S6] START round=2 head_norm_before_train=1.192075 (no previous merge yet)
[S6] round=2 local utility u=0.021600 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6135734034459395, 'loss_val': 1.1759566138573476, 'psi': 0.330285130609145}-{'f1_val': 0.14142628205128205, 'auprc': 0.6241977256948417, 'loss_val': 1.2510296355378223, 'psi': 0.3345348595087059}
[S7] START round=2 head_norm_before_train=0.855900 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7875723208186907, 'loss_val': 1.3134326070931808, 'psi': 0.4002630219649313}-{'f1_val': 0.42341651994924456, 'auprc': 0.7655000709072586, 'loss_val': 1.3258231926228152, 'psi': 0.5602499403324501}
[S8] START round=2 head_norm_before_train=1.305112 (no previous merge yet)
[S8] round=2 local utility u=0.121915 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7652090009321778, 'loss_val': 1.1821979780649172, 'psi': 0.39005718980864545}-{'f1_val': 0.13995598239295717, 'auprc': 0.7159970986845152, 'loss_val': 1.2783917618401925, 'psi': 0.37037242890958044}
[S9] START round=2 head_norm_before_train=1.190272 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9918301201671668, 'loss_val': 1.2721326197900498, 'psi': 0.48157082235086435}-{'f1_val': 0.4156511382980026, 'auprc': 0.9792876922470789, 'loss_val': 1.3301599846827756, 'psi': 0.6411057598776331}
[S10] START round=2 head_norm_before_train=1.293749 (no previous merge yet)
[S10] round=2 local utility u=0.054625 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6329125380626545, 'loss_val': 1.1832013682716978, 'psi': 0.33633799775009615}-{'f1_val': 0.13862163754172394, 'auprc': 0.6245933935266137, 'loss_val': 1.2674937864834042, 'psi': 0.33301033993567986}
[S11] START round=2 head_norm_before_train=0.861577 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6387986015008367, 'loss_val': 1.3239455577957675, 'psi': 0.339767650624201}-{'f1_val': 0.14041368337311058, 'auprc': 0.7726558265648066, 'loss_val': 1.3200808527623589, 'psi': 0.393310540649789}
[S13] START round=2 head_norm_before_train=1.220195 (no previous merge yet)
[S13] round=2 local utility u=0.078316 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6688959663696081, 'loss_val': 1.2154667064264142, 'psi': 0.3517898440940751}-{'f1_val': 0.1403857625770531, 'auprc': 0.6354183503536506, 'loss_val': 1.2716666545719824, 'psi': 0.3383987976876921}
[S14] START round=2 head_norm_before_train=1.180405 (no previous merge yet)
[S14] round=2 local utility u=0.081170 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6930876275624338, 'loss_val': 1.3095188761365273, 'psi': 0.3614497627545958}-{'f1_val': 0.14035785288270378, 'auprc': 0.6485399919648223, 'loss_val': 1.3382165866968574, 'psi': 0.34363070851555116}
[S15] START round=2 head_norm_before_train=1.186182 (no previous merge yet)
[S15] round=2 local utility u=0.041415 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7765882682439554, 'loss_val': 1.2378875689965132, 'psi': 0.3944754981145172}-{'f1_val': 0.13973365136155833, 'auprc': 0.7694233376102405, 'loss_val': 1.2992220490354862, 'psi': 0.3916095258610312}
[S16] START round=2 head_norm_before_train=0.833617 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7511659448620076, 'loss_val': 1.299443113299464, 'psi': 0.38484884806432496}-{'f1_val': 0.14063745019920318, 'auprc': 0.7580988580846804, 'loss_val': 1.3002483815931092, 'psi': 0.3876220133533941}
[S17] START round=2 head_norm_before_train=1.213142 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5841189828385923, 'loss_val': 1.1673387293000965, 'psi': 0.31821697112586755}-{'f1_val': 0.14094896331738438, 'auprc': 0.644461763003521, 'loss_val': 1.276394146662564, 'psi': 0.342354083191839}
[S14] not sending this round → trigger blocked (psi=0.361)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:38408
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:38408
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.394)
[S10] not sending this round → trigger blocked (psi=0.336)
[S6] not sending this round → trigger blocked (psi=0.330)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.352)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:38407
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.282255)
[S7] loaded HEAD from S3 (vec_in norm=1.282255)
[S7] cosine check vs S3: cos=0.0775
[S7] BUFFERED delta from S3 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.353581)
[S7] loaded HEAD from S8 (vec_in norm=1.353581)
[S7] cosine check vs S8: cos=0.0183
[S7] BUFFERED delta from S8 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1794) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.905292)
[S6] loaded HEAD from S4 (vec_in norm=0.905292)
[S6] cosine check vs S4: cos=-0.0398
[S6] DROPPED delta from S4 (cos=-0.0398 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=2 metric=0.1421 head_norm=0.882010
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.197462e-01
[S7] stored merged vector for next round verification (round=2)
[S7] DEBUG after merge:  round=2 metric=0.1421 head_norm=0.662450 delta_norm=0.619746
[S7] aggregate: ACCEPT kept=['S3', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.932835 cos_to_last_merge=0.9938 (last merge round=1)
[S2] round=3 local utility u=0.257412 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7522526369442714, 'loss_val': 1.1541567680612153, 'psi': 0.3859673348108486}-{'f1_val': 0.1417771333885667, 'auprc': 0.6056882794406134, 'loss_val': 1.2292875695140777, 'psi': 0.32734159180938543}
[S3] START round=3 head_norm_before_train=1.282255 (no previous merge yet)
[S3] round=3 local utility u=0.057407 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9957430532273525, 'loss_val': 1.1978846799298635, 'psi': 0.4822012606594053}-{'f1_val': 0.13984006561410703, 'auprc': 0.9768768500693439, 'loss_val': 1.256100181786776, 'psi': 0.4746547793962018}
[S4] START round=3 head_norm_before_train=0.905292 cos_to_last_merge=0.9911 (last merge round=1)
[S4] round=3 local utility u=0.611797 metrics={'f1_val': 0.2450673568396431, 'auprc': 0.7764516239885816, 'loss_val': 1.0691885264176966, 'psi': 0.4576210636992185}-{'f1_val': 0.14022662889518414, 'auprc': 0.6369993144012085, 'loss_val': 1.245380336406926, 'psi': 0.3389357030975939}
[S5] START round=3 head_norm_before_train=1.200948 (no previous merge yet)
[S5] round=3 local utility u=0.021431 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5263982738261823, 'loss_val': 1.2505399957142838, 'psi': 0.29591645238761577}-{'f1_val': 0.14226190476190476, 'auprc': 0.5265511103763363, 'loss_val': 1.2938599760712188, 'psi': 0.2959775870076774}
[S6] START round=3 head_norm_before_train=1.246021 (no previous merge yet)
[S6] round=3 local utility u=1.000000 metrics={'f1_val': 0.4122657983127228, 'auprc': 0.7389326551935825, 'loss_val': 0.9947226181164741, 'psi': 0.5429325410650667}-{'f1_val': 0.14142628205128205, 'auprc': 0.6135734034459395, 'loss_val': 1.1759566138573476, 'psi': 0.330285130609145}
[S7] START round=3 head_norm_before_train=0.662450 cos_to_last_merge=1.0000 (last merge round=2)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776515465690663, 'loss_val': 1.313720415122633, 'psi': 0.39629471226508156}-{'f1_val': 0.14205682272909165, 'auprc': 0.7875723208186907, 'loss_val': 1.3134326070931808, 'psi': 0.4002630219649313}
[S8] START round=3 head_norm_before_train=1.353581 (no previous merge yet)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.7153201919565738, 'auprc': 0.6567807327947149, 'loss_val': 1.0582653443400867, 'psi': 0.6919044082918302}-{'f1_val': 0.13995598239295717, 'auprc': 0.7652090009321778, 'loss_val': 1.1821979780649172, 'psi': 0.39005718980864545}
[S9] START round=3 head_norm_before_train=1.217309 (no previous merge yet)
[S9] round=3 local utility u=0.010666 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9753246011884505, 'loss_val': 1.20128430408439, 'psi': 0.47496861475937785}-{'f1_val': 0.141397957139996, 'auprc': 0.9918301201671668, 'loss_val': 1.2721326197900498, 'psi': 0.48157082235086435}
[S10] START round=3 head_norm_before_train=1.340218 (no previous merge yet)
[S10] round=3 local utility u=1.000000 metrics={'f1_val': 0.41689270364329833, 'auprc': 0.6862479097199421, 'loss_val': 0.9624584522007047, 'psi': 0.5246347860739559}-{'f1_val': 0.13862163754172394, 'auprc': 0.6329125380626545, 'loss_val': 1.1832013682716978, 'psi': 0.33633799775009615}
[S11] START round=3 head_norm_before_train=0.880014 cos_to_last_merge=0.9965 (last merge round=1)
[S11] round=3 local utility u=0.146148 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7244894769977792, 'loss_val': 1.2887219436823159, 'psi': 0.37404400082297806}-{'f1_val': 0.14041368337311058, 'auprc': 0.6387986015008367, 'loss_val': 1.3239455577957675, 'psi': 0.339767650624201}
[S13] START round=3 head_norm_before_train=1.254923 (no previous merge yet)
[S13] round=3 local utility u=0.777765 metrics={'f1_val': 0.41655034241240063, 'auprc': 0.5955215673901414, 'loss_val': 1.096801916451813, 'psi': 0.488138832403497}-{'f1_val': 0.1403857625770531, 'auprc': 0.6688959663696081, 'loss_val': 1.2154667064264142, 'psi': 0.3517898440940751}
[S14] START round=3 head_norm_before_train=1.200445 (no previous merge yet)
[S14] round=3 local utility u=0.055237 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7170345581609634, 'loss_val': 1.2708858998278825, 'psi': 0.3710285349940076}-{'f1_val': 0.14035785288270378, 'auprc': 0.6930876275624338, 'loss_val': 1.3095188761365273, 'psi': 0.3614497627545958}
[S15] START round=3 head_norm_before_train=1.234083 (no previous merge yet)
[S15] round=3 local utility u=0.273405 metrics={'f1_val': 0.21005404608825584, 'auprc': 0.7770481861851364, 'loss_val': 1.1143789611793298, 'psi': 0.4368517021270081}-{'f1_val': 0.13973365136155833, 'auprc': 0.7765882682439554, 'loss_val': 1.2378875689965132, 'psi': 0.3944754981145172}
[S16] START round=3 head_norm_before_train=0.858670 cos_to_last_merge=0.9967 (last merge round=1)
[S16] round=3 local utility u=0.122910 metrics={'f1_val': 0.16652990806607898, 'auprc': 0.76210980511792, 'loss_val': 1.2418093642371983, 'psi': 0.4047618668868154}-{'f1_val': 0.14063745019920318, 'auprc': 0.7511659448620076, 'loss_val': 1.299443113299464, 'psi': 0.38484884806432496}
[S17] START round=3 head_norm_before_train=1.268034 (no previous merge yet)
[S17] round=3 local utility u=0.942138 metrics={'f1_val': 0.39190299739728274, 'auprc': 0.658713132506658, 'loss_val': 1.0125696802825765, 'psi': 0.4986270514410328}-{'f1_val': 0.14094896331738438, 'auprc': 0.5841189828385923, 'loss_val': 1.1673387293000965, 'psi': 0.31821697112586755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:38409
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38416
[S9] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.289095)
[S16] loaded HEAD from S13 (vec_in norm=1.289095)
[S16] cosine check vs S13: cos=0.0191
[S16] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.959983)
[S5] loaded HEAD from S2 (vec_in norm=0.959983)
[S5] cosine check vs S2: cos=-0.0767
[S5] DROPPED delta from S2 (cos=-0.0767 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1790) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.320087)
[S6] loaded HEAD from S3 (vec_in norm=1.320087)
[S6] cosine check vs S3: cos=-0.0323
[S6] DROPPED delta from S3 (cos=-0.0323 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1805) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.895924)
[S4] loaded HEAD from S16 (vec_in norm=0.895924)
[S4] cosine check vs S16: cos=-0.1106
[S4] DROPPED delta from S16 (cos=-0.1106 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.250873)
[S3] loaded HEAD from S9 (vec_in norm=1.250873)
[S3] cosine check vs S9: cos=0.0505
[S3] BUFFERED delta from S9 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.223444)
[S3] loaded HEAD from S5 (vec_in norm=1.223444)
[S3] cosine check vs S5: cos=-0.1400
[S3] DROPPED delta from S5 (cos=-0.1400 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.390748)
[S16] loaded HEAD from S8 (vec_in norm=1.390748)
[S16] cosine check vs S8: cos=-0.0294
[S16] DROPPED delta from S8 (cos=-0.0294 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1793) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.968546)
[S8] loaded HEAD from S4 (vec_in norm=0.968546)
[S8] cosine check vs S4: cos=-0.0553
[S8] DROPPED delta from S4 (cos=-0.0553 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.295321)
[S7] loaded HEAD from S15 (vec_in norm=1.295321)
[S7] cosine check vs S15: cos=0.0081
[S7] BUFFERED delta from S15 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1793) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.229094)
[S13] loaded HEAD from S14 (vec_in norm=1.229094)
[S13] cosine check vs S14: cos=0.0889
[S13] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1792) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.908143)
[S10] loaded HEAD from S11 (vec_in norm=0.908143)
[S10] cosine check vs S11: cos=0.0178
[S10] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.406099)
[S7] loaded HEAD from S10 (vec_in norm=1.406099)
[S7] cosine check vs S10: cos=-0.0078
[S7] DROPPED delta from S10 (cos=-0.0078 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.287831)
[S7] loaded HEAD from S6 (vec_in norm=1.287831)
[S7] cosine check vs S6: cos=0.0052
[S7] BUFFERED delta from S6 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.321179)
[S14] loaded HEAD from S17 (vec_in norm=1.321179)
[S14] cosine check vs S17: cos=0.0308
[S14] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=0.685469
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.615655e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.566758 delta_norm=0.561565
[S7] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1665 head_norm=0.895924
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.778649e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.791928 delta_norm=0.777865
[S16] aggregate: ROLLBACK (f1_val pre=0.167 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=1.320087
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.860931e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.931931 delta_norm=0.886093
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.4166 head_norm=1.289095
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.501183e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.4155 head_norm=0.929256 delta_norm=0.850118
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.4169 head_norm=1.406099
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.301258e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.4169 head_norm=0.843688 delta_norm=0.830126
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.229094
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.882576e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.6491 head_norm=0.916019 delta_norm=0.888258
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.959983 cos_to_last_merge=0.9874 (last merge round=1)
[S2] round=4 local utility u=0.870042 metrics={'f1_val': 0.4158821818019893, 'auprc': 0.7348035443459148, 'loss_val': 1.0063549623506787, 'psi': 0.5434507268195595}-{'f1_val': 0.1417771333885667, 'auprc': 0.7522526369442714, 'loss_val': 1.1541567680612153, 'psi': 0.3859673348108486}
[S3] START round=4 head_norm_before_train=0.931931 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9809086069648532, 'loss_val': 1.1848308385323574, 'psi': 0.4762674821544055}-{'f1_val': 0.13984006561410703, 'auprc': 0.9957430532273525, 'loss_val': 1.1978846799298635, 'psi': 0.4822012606594053}
[S4] START round=4 head_norm_before_train=0.968546 cos_to_last_merge=0.9717 (last merge round=1)
[S4] round=4 local utility u=0.355893 metrics={'f1_val': 0.3749387785509547, 'auprc': 0.6717362008860066, 'loss_val': 0.8224839581796614, 'psi': 0.4936577474849755}-{'f1_val': 0.2450673568396431, 'auprc': 0.7764516239885816, 'loss_val': 1.0691885264176966, 'psi': 0.4576210636992185}
[S5] START round=4 head_norm_before_train=1.223444 (no previous merge yet)
[S5] round=4 local utility u=0.024174 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5266376911659973, 'loss_val': 1.2029100048771693, 'psi': 0.2960122193235418}-{'f1_val': 0.14226190476190476, 'auprc': 0.5263982738261823, 'loss_val': 1.2505399957142838, 'psi': 0.29591645238761577}
[S6] START round=4 head_norm_before_train=1.287831 (no previous merge yet)
[S6] round=4 local utility u=0.259766 metrics={'f1_val': 0.4805961022788812, 'auprc': 0.7236575083053016, 'loss_val': 0.8393471314602907, 'psi': 0.5778206646894494}-{'f1_val': 0.4122657983127228, 'auprc': 0.7389326551935825, 'loss_val': 0.9947226181164741, 'psi': 0.5429325410650667}
[S7] START round=4 head_norm_before_train=0.566758 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.028311 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.79458204152703, 'loss_val': 1.307890546680823, 'psi': 0.403066910248267}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776515465690663, 'loss_val': 1.313720415122633, 'psi': 0.39629471226508156}
[S8] START round=4 head_norm_before_train=1.390748 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.7817554669895359, 'loss_val': 0.855272069642106, 'psi': 0.5364216071091203}-{'f1_val': 0.7153201919565738, 'auprc': 0.6567807327947149, 'loss_val': 1.0582653443400867, 'psi': 0.6919044082918302}
[S9] START round=4 head_norm_before_train=1.250873 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8662388550846489, 'loss_val': 1.1214719378856073, 'psi': 0.4313343163178572}-{'f1_val': 0.141397957139996, 'auprc': 0.9753246011884505, 'loss_val': 1.20128430408439, 'psi': 0.47496861475937785}
[S10] START round=4 head_norm_before_train=0.843688 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=0.458416 metrics={'f1_val': 0.3865622016457787, 'auprc': 0.9965941158354815, 'loss_val': 0.7946826269390537, 'psi': 0.6305749673216599}-{'f1_val': 0.41689270364329833, 'auprc': 0.6862479097199421, 'loss_val': 0.9624584522007047, 'psi': 0.5246347860739559}
[S11] START round=4 head_norm_before_train=0.908143 cos_to_last_merge=0.9872 (last merge round=1)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6607718786151959, 'loss_val': 1.2508941017022994, 'psi': 0.34855696146994475}-{'f1_val': 0.14041368337311058, 'auprc': 0.7244894769977792, 'loss_val': 1.2887219436823159, 'psi': 0.37404400082297806}
[S13] START round=4 head_norm_before_train=0.929256 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.091583 metrics={'f1_val': 0.4161203556905605, 'auprc': 0.6279837884648757, 'loss_val': 1.0084433151098153, 'psi': 0.5008657288002866}-{'f1_val': 0.41655034241240063, 'auprc': 0.5955215673901414, 'loss_val': 1.096801916451813, 'psi': 0.488138832403497}
[S14] START round=4 head_norm_before_train=0.916019 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.009589 metrics={'f1_val': 0.1415964701163257, 'auprc': 0.7204847871588638, 'loss_val': 1.2694905294894703, 'psi': 0.37315179693334094}-{'f1_val': 0.14035785288270378, 'auprc': 0.7170345581609634, 'loss_val': 1.2708858998278825, 'psi': 0.3710285349940076}
[S15] START round=4 head_norm_before_train=1.295321 (no previous merge yet)
[S15] round=4 local utility u=0.774218 metrics={'f1_val': 0.4184204409136383, 'auprc': 0.7900456268043197, 'loss_val': 0.8551328607497993, 'psi': 0.5670705152699109}-{'f1_val': 0.21005404608825584, 'auprc': 0.7770481861851364, 'loss_val': 1.1143789611793298, 'psi': 0.4368517021270081}
[S16] START round=4 head_norm_before_train=0.791928 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5528133652691618, 'loss_val': 1.2350704651107733, 'psi': 0.30550781622718665}-{'f1_val': 0.16652990806607898, 'auprc': 0.76210980511792, 'loss_val': 1.2418093642371983, 'psi': 0.4047618668868154}
[S17] START round=4 head_norm_before_train=1.321179 (no previous merge yet)
[S17] round=4 local utility u=0.432891 metrics={'f1_val': 0.38008921281217706, 'auprc': 0.9089663561928614, 'loss_val': 0.8266642223337646, 'psi': 0.5916400701644507}-{'f1_val': 0.39190299739728274, 'auprc': 0.658713132506658, 'loss_val': 1.0125696802825765, 'psi': 0.4986270514410328}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.296)
[S14] not sending this round → trigger blocked (psi=0.373)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.567)
[S4] not sending this round → trigger blocked (psi=0.494)
[S6] not sending this round → trigger blocked (psi=0.578)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:38409
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.543)
[S13] not sending this round → trigger blocked (psi=0.501)
[S10] not sending this round → trigger blocked (psi=0.631)
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.585483)
[S8] loaded HEAD from S7 (vec_in norm=0.585483)
[S8] cosine check vs S7: cos=0.3209
[S8] BUFFERED delta from S7 (total buffered=1)
[S17] not sending this round → trigger blocked (psi=0.592)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.3729 head_norm=1.436516
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.831115e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.5686 head_norm=0.858221 delta_norm=0.683111
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.013328 cos_to_last_merge=0.9744 (last merge round=1)
[S2] round=5 local utility u=0.823952 metrics={'f1_val': 0.7008717589696155, 'auprc': 0.6625999044005941, 'loss_val': 0.8517771108686498, 'psi': 0.685563017142007}-{'f1_val': 0.4158821818019893, 'auprc': 0.7348035443459148, 'loss_val': 1.0063549623506787, 'psi': 0.5434507268195595}
[S3] START round=5 head_norm_before_train=0.970100 cos_to_last_merge=0.9974 (last merge round=3)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8240394186075977, 'loss_val': 1.0762726153861497, 'psi': 0.41351980681150335}-{'f1_val': 0.13984006561410703, 'auprc': 0.9809086069648532, 'loss_val': 1.1848308385323574, 'psi': 0.4762674821544055}
[S4] START round=5 head_norm_before_train=1.046889 cos_to_last_merge=0.9471 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.947
[S4] round=5 local utility u=0.723882 metrics={'f1_val': 0.581028157593043, 'auprc': 0.6782257334687339, 'loss_val': 0.6307253222679098, 'psi': 0.6199071879433194}-{'f1_val': 0.3749387785509547, 'auprc': 0.6717362008860066, 'loss_val': 0.8224839581796614, 'psi': 0.4936577474849755}
[S5] START round=5 head_norm_before_train=1.240666 (no previous merge yet)
[S5] round=5 local utility u=0.721682 metrics={'f1_val': 0.3581784661372577, 'auprc': 0.5503142152979814, 'loss_val': 1.1260744658931494, 'psi': 0.43503276580154715}-{'f1_val': 0.14226190476190476, 'auprc': 0.5266376911659973, 'loss_val': 1.2029100048771693, 'psi': 0.2960122193235418}
[S6] START round=5 head_norm_before_train=1.347124 (no previous merge yet)
[S6] round=5 local utility u=0.114533 metrics={'f1_val': 0.3821497143817618, 'auprc': 0.9379360807014505, 'loss_val': 0.6624375910544309, 'psi': 0.6044642609096373}-{'f1_val': 0.4805961022788812, 'auprc': 0.7236575083053016, 'loss_val': 0.8393471314602907, 'psi': 0.5778206646894494}
[S7] START round=5 head_norm_before_train=0.585483 cos_to_last_merge=0.9923 (last merge round=3)
[S7] round=5 local utility u=0.020592 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7950653127326538, 'loss_val': 1.2681563341523188, 'psi': 0.40326021873051654}-{'f1_val': 0.14205682272909165, 'auprc': 0.79458204152703, 'loss_val': 1.307890546680823, 'psi': 0.403066910248267}
[S8] START round=5 head_norm_before_train=0.858221 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.324145 metrics={'f1_val': 0.3727318090052443, 'auprc': 0.9876988876003205, 'loss_val': 0.8240088342885483, 'psi': 0.6187186404432748}-{'f1_val': 0.3728657005221765, 'auprc': 0.7817554669895359, 'loss_val': 0.855272069642106, 'psi': 0.5364216071091203}
[S9] START round=5 head_norm_before_train=1.288225 (no previous merge yet)
[S9] round=5 local utility u=0.243115 metrics={'f1_val': 0.141397957139996, 'auprc': 0.979344579946335, 'loss_val': 0.9745586323631894, 'psi': 0.4765766062625316}-{'f1_val': 0.141397957139996, 'auprc': 0.8662388550846489, 'loss_val': 1.1214719378856073, 'psi': 0.4313343163178572}
[S10] START round=5 head_norm_before_train=0.924066 cos_to_last_merge=0.9904 (last merge round=3)
[S10] round=5 local utility u=0.916447 metrics={'f1_val': 0.6640108122227506, 'auprc': 0.9726410246883854, 'loss_val': 0.5546218034767852, 'psi': 0.7874628972090045}-{'f1_val': 0.3865622016457787, 'auprc': 0.9965941158354815, 'loss_val': 0.7946826269390537, 'psi': 0.6305749673216599}
[S11] START round=5 head_norm_before_train=0.943976 cos_to_last_merge=0.9743 (last merge round=1)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5950242396535722, 'loss_val': 1.2072822220449886, 'psi': 0.32225790588529524}-{'f1_val': 0.14041368337311058, 'auprc': 0.6607718786151959, 'loss_val': 1.2508941017022994, 'psi': 0.34855696146994475}
[S13] START round=5 head_norm_before_train=0.990280 cos_to_last_merge=0.9933 (last merge round=3)
[S13] round=5 local utility u=0.248090 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.726868450408076, 'loss_val': 0.8070395675914928, 'psi': 0.5402317413546487}-{'f1_val': 0.4161203556905605, 'auprc': 0.6279837884648757, 'loss_val': 1.0084433151098153, 'psi': 0.5008657288002866}
[S14] START round=5 head_norm_before_train=0.942891 cos_to_last_merge=0.9973 (last merge round=3)
[S14] round=5 local utility u=0.030993 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.721194234751398, 'loss_val': 1.202200790076638, 'psi': 0.37269240563018147}-{'f1_val': 0.1415964701163257, 'auprc': 0.7204847871588638, 'loss_val': 1.2694905294894703, 'psi': 0.37315179693334094}
[S15] START round=5 head_norm_before_train=1.365035 (no previous merge yet)
[S15] round=5 local utility u=0.953649 metrics={'f1_val': 0.6899602330378454, 'auprc': 0.798582584234697, 'loss_val': 0.6026841848239861, 'psi': 0.733409173516586}-{'f1_val': 0.4184204409136383, 'auprc': 0.7900456268043197, 'loss_val': 0.8551328607497993, 'psi': 0.5670705152699109}
[S16] START round=5 head_norm_before_train=0.817151 cos_to_last_merge=0.9951 (last merge round=3)
[S16] round=5 local utility u=0.843028 metrics={'f1_val': 0.4150731431819776, 'auprc': 0.5264897054360188, 'loss_val': 1.1166576909763102, 'psi': 0.4596397680835941}-{'f1_val': 0.14063745019920318, 'auprc': 0.5528133652691618, 'loss_val': 1.2350704651107733, 'psi': 0.30550781622718665}
[S17] START round=5 head_norm_before_train=1.387059 (no previous merge yet)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.35263946760923376, 'auprc': 0.7145042153633832, 'loss_val': 0.8866943390234068, 'psi': 0.4973853667108935}-{'f1_val': 0.38008921281217706, 'auprc': 0.9089663561928614, 'loss_val': 0.8266642223337646, 'psi': 0.5916400701644507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:38404
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:38409
[S7] not sending this round → trigger blocked (psi=0.403)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S13] → sending delta(kind=head bytes=1787) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:38405
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38416
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1787 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.324804)
[S3] loaded HEAD from S9 (vec_in norm=1.324804)
[S3] cosine check vs S9: cos=0.6592
[S3] BUFFERED delta from S9 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.257018)
[S3] loaded HEAD from S5 (vec_in norm=1.257018)
[S3] cosine check vs S5: cos=-0.1258
[S3] DROPPED delta from S5 (cos=-0.1258 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.450814)
[S7] loaded HEAD from S15 (vec_in norm=1.450814)
[S7] cosine check vs S15: cos=0.5036
[S7] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.082502)
[S5] loaded HEAD from S2 (vec_in norm=1.082502)
[S5] cosine check vs S2: cos=-0.0701
[S5] DROPPED delta from S2 (cos=-0.0701 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.932677)
[S16] loaded HEAD from S8 (vec_in norm=0.932677)
[S16] cosine check vs S8: cos=0.0392
[S16] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.037440)
[S7] loaded HEAD from S10 (vec_in norm=1.037440)
[S7] cosine check vs S10: cos=0.1646
[S7] BUFFERED delta from S10 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.391020)
[S7] loaded HEAD from S6 (vec_in norm=1.391020)
[S7] cosine check vs S6: cos=0.5099
[S7] BUFFERED delta from S6 (total buffered=3)
[S16] RECEIVED delta(kind=head bytes=1787) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.063369)
[S16] loaded HEAD from S13 (vec_in norm=1.063369)
[S16] cosine check vs S13: cos=0.6140
[S16] BUFFERED delta from S13 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1793) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.977550)
[S13] loaded HEAD from S14 (vec_in norm=0.977550)
[S13] cosine check vs S14: cos=0.4778
[S13] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.853486)
[S4] loaded HEAD from S16 (vec_in norm=0.853486)
[S4] cosine check vs S16: cos=-0.1077
[S4] DROPPED delta from S16 (cos=-0.1077 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.140977)
[S8] loaded HEAD from S4 (vec_in norm=1.140977)
[S8] cosine check vs S4: cos=-0.0897
[S8] DROPPED delta from S4 (cos=-0.0897 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.610004
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.390792e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.628027 delta_norm=0.339079
[S7] aggregate: ACCEPT kept=['S15', 'S10', 'S6'] (k=3/3) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.418 → S8@127.0.0.1:38409
[S11] ⇄ pheromone p=0.368 → S10@127.0.0.1:38411
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=1.011496
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.028459e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.1398 head_norm=1.065955 delta_norm=0.502846
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.341 → S6@127.0.0.1:38407
[S5] ⇄ pheromone p=0.561 → S3@127.0.0.1:38403
[S8] ⇄ pheromone p=0.533 → S16@127.0.0.1:38416
[S4] ⇄ pheromone p=0.611 → S8@127.0.0.1:38409
[S6] ⇄ pheromone p=0.525 → S7@127.0.0.1:38408
[S14] ⇄ pheromone p=0.370 → S13@127.0.0.1:38413
[S2] ⇄ pheromone p=0.665 → S5@127.0.0.1:38405
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.4151 head_norm=0.853486
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.184014e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.4145 head_norm=0.685053 delta_norm=0.418401
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.518 → S4@127.0.0.1:38404
[S10] ⇄ pheromone p=0.725 → S7@127.0.0.1:38408
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.4158 head_norm=1.063369
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.227294e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.4158 head_norm=0.877458 delta_norm=0.522729
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.500 → S16@127.0.0.1:38416
[S15] ⇄ pheromone p=0.684 → S7@127.0.0.1:38408
[S9] ⇄ pheromone p=0.460 → S3@127.0.0.1:38403
[S17] ⇄ pheromone p=0.518 → S14@127.0.0.1:38414
[S2] START round=6 head_norm_before_train=1.082502 cos_to_last_merge=0.9563 (last merge round=1)
[S2] round=6 local utility u=0.184074 metrics={'f1_val': 0.7016512288906386, 'auprc': 0.7097495086080824, 'loss_val': 0.6297537880303117, 'psi': 0.704890540777616}-{'f1_val': 0.7008717589696155, 'auprc': 0.6625999044005941, 'loss_val': 0.8517771108686498, 'psi': 0.685563017142007}
[S3] START round=6 head_norm_before_train=1.065955 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.913080 metrics={'f1_val': 0.396483704974271, 'auprc': 0.9027666054117637, 'loss_val': 1.0261559803870521, 'psi': 0.5989968651492681}-{'f1_val': 0.13984006561410703, 'auprc': 0.8240394186075977, 'loss_val': 1.0762726153861497, 'psi': 0.41351980681150335}
[S4] START round=6 head_norm_before_train=1.140977 cos_to_last_merge=0.9169 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.917
[S4] round=6 local utility u=0.645402 metrics={'f1_val': 0.6905306128828427, 'auprc': 0.8353795534839279, 'loss_val': 0.4683976334161077, 'psi': 0.7484701891232768}-{'f1_val': 0.581028157593043, 'auprc': 0.6782257334687339, 'loss_val': 0.6307253222679098, 'psi': 0.6199071879433194}
[S5] START round=6 head_norm_before_train=1.257018 (no previous merge yet)
[S5] round=6 local utility u=0.575281 metrics={'f1_val': 0.41795135763108626, 'auprc': 0.7744780629226395, 'loss_val': 1.0066418355118196, 'psi': 0.5605620397477076}-{'f1_val': 0.3581784661372577, 'auprc': 0.5503142152979814, 'loss_val': 1.1260744658931494, 'psi': 0.43503276580154715}
[S6] START round=6 head_norm_before_train=1.391020 (no previous merge yet)
[S6] round=6 local utility u=0.664216 metrics={'f1_val': 0.6490071945475131, 'auprc': 0.8200330901502532, 'loss_val': 0.5814424007057681, 'psi': 0.7174175527886091}-{'f1_val': 0.3821497143817618, 'auprc': 0.9379360807014505, 'loss_val': 0.6624375910544309, 'psi': 0.6044642609096373}
[S7] START round=6 head_norm_before_train=0.628027 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.002503 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7950866859908484, 'loss_val': 1.2632137018514016, 'psi': 0.40326876803379436}-{'f1_val': 0.14205682272909165, 'auprc': 0.7950653127326538, 'loss_val': 1.2681563341523188, 'psi': 0.40326021873051654}
[S8] START round=6 head_norm_before_train=0.932677 cos_to_last_merge=0.9928 (last merge round=4)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7137586021136586, 'auprc': 0.9935780198232207, 'loss_val': 0.5719532797114115, 'psi': 0.8256863691974834}-{'f1_val': 0.3727318090052443, 'auprc': 0.9876988876003205, 'loss_val': 0.8240088342885483, 'psi': 0.6187186404432748}
[S9] START round=6 head_norm_before_train=1.324804 (no previous merge yet)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.43625879546239904, 'auprc': 0.9939604201039489, 'loss_val': 0.7794773689105203, 'psi': 0.659339445319019}-{'f1_val': 0.141397957139996, 'auprc': 0.979344579946335, 'loss_val': 0.9745586323631894, 'psi': 0.4765766062625316}
[S10] START round=6 head_norm_before_train=1.037440 cos_to_last_merge=0.9653 (last merge round=3)
[S10] round=6 local utility u=0.247694 metrics={'f1_val': 0.6998932897468348, 'auprc': 0.9978011296311118, 'loss_val': 0.3500092310413988, 'psi': 0.8190564257005456}-{'f1_val': 0.6640108122227506, 'auprc': 0.9726410246883854, 'loss_val': 0.5546218034767852, 'psi': 0.7874628972090045}
[S11] START round=6 head_norm_before_train=0.976800 cos_to_last_merge=0.9619 (last merge round=1)
[S11] round=6 local utility u=0.339866 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7978876018644967, 'loss_val': 1.1361400214392694, 'psi': 0.40340325076966504}-{'f1_val': 0.14041368337311058, 'auprc': 0.5950242396535722, 'loss_val': 1.2072822220449886, 'psi': 0.32225790588529524}
[S13] START round=6 head_norm_before_train=0.877458 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.030397 metrics={'f1_val': 0.49620805558721043, 'auprc': 0.6188062800038454, 'loss_val': 0.904462816410811, 'psi': 0.5452473453538644}-{'f1_val': 0.41580726865236384, 'auprc': 0.726868450408076, 'loss_val': 0.8070395675914928, 'psi': 0.5402317413546487}
[S14] START round=6 head_norm_before_train=0.977550 cos_to_last_merge=0.9893 (last merge round=3)
[S14] round=6 local utility u=0.812952 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.7219486639806153, 'loss_val': 1.1157765864937175, 'psi': 0.5267157869784411}-{'f1_val': 0.14035785288270378, 'auprc': 0.721194234751398, 'loss_val': 1.202200790076638, 'psi': 0.37269240563018147}
[S15] START round=6 head_norm_before_train=1.450814 (no previous merge yet)
[S15] round=6 local utility u=0.122113 metrics={'f1_val': 0.6970308342015898, 'auprc': 0.8005589305899699, 'loss_val': 0.4068099971931868, 'psi': 0.7384420727569418}-{'f1_val': 0.6899602330378454, 'auprc': 0.798582584234697, 'loss_val': 0.6026841848239861, 'psi': 0.733409173516586}
[S16] START round=6 head_norm_before_train=0.685053 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.4171583814486223, 'auprc': 0.48938805469669744, 'loss_val': 1.1415000391845993, 'psi': 0.4460502507478524}-{'f1_val': 0.4150731431819776, 'auprc': 0.5264897054360188, 'loss_val': 1.1166576909763102, 'psi': 0.4596397680835941}
[S17] START round=6 head_norm_before_train=1.445531 (no previous merge yet)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.35465806268110145, 'auprc': 0.6731744814003119, 'loss_val': 0.8666719174309243, 'psi': 0.48206463016878565}-{'f1_val': 0.35263946760923376, 'auprc': 0.7145042153633832, 'loss_val': 0.8866943390234068, 'psi': 0.4973853667108935}
[S15] not sending this round → trigger blocked (psi=0.738)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:38409
[S5] not sending this round → trigger blocked (psi=0.561)
[S6] not sending this round → trigger blocked (psi=0.717)
[S9] not sending this round → trigger blocked (psi=0.659)
[S13] not sending this round → trigger blocked (psi=0.545)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:38407
[S14] not sending this round → trigger blocked (psi=0.527)
[S4] not sending this round → trigger blocked (psi=0.748)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.705)
[S10] not sending this round → trigger blocked (psi=0.819)
[S8] not sending this round → trigger blocked (psi=0.826)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:38411
[S11] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1789) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.094063)
[S6] loaded HEAD from S3 (vec_in norm=1.094063)
[S6] cosine check vs S3: cos=-0.0832
[S6] DROPPED delta from S3 (cos=-0.0832 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1804) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.005069)
[S10] loaded HEAD from S11 (vec_in norm=1.005069)
[S10] cosine check vs S11: cos=0.4456
[S10] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.642797)
[S8] loaded HEAD from S7 (vec_in norm=0.642797)
[S8] cosine check vs S7: cos=0.3832
[S8] BUFFERED delta from S7 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.6999 head_norm=1.152936
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.715432e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.6999 head_norm=0.918178 delta_norm=0.571543
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.7138 head_norm=1.025076
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.896284e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.6125 head_norm=0.701604 delta_norm=0.489628
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.613 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=1.165608 cos_to_last_merge=0.9352 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.935
[S2] round=7 local utility u=0.177066 metrics={'f1_val': 0.7013896806394065, 'auprc': 0.7796363388412628, 'loss_val': 0.48371347117269226, 'psi': 0.732688343920149}-{'f1_val': 0.7016512288906386, 'auprc': 0.7097495086080824, 'loss_val': 0.6297537880303117, 'psi': 0.704890540777616}
[S3] START round=7 head_norm_before_train=1.094063 cos_to_last_merge=0.9972 (last merge round=5)
[S3] round=7 local utility u=0.191632 metrics={'f1_val': 0.39638969140647473, 'auprc': 0.9785484166439807, 'loss_val': 0.8696728670939514, 'psi': 0.6292531815014771}-{'f1_val': 0.396483704974271, 'auprc': 0.9027666054117637, 'loss_val': 1.0261559803870521, 'psi': 0.5989968651492681}
[S4] START round=7 head_norm_before_train=1.240055 cos_to_last_merge=0.8875 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.888
[S4] round=7 local utility u=0.223509 metrics={'f1_val': 0.6928686931642583, 'auprc': 0.950176505503999, 'loss_val': 0.37979861284559246, 'psi': 0.7957918181001545}-{'f1_val': 0.6905306128828427, 'auprc': 0.8353795534839279, 'loss_val': 0.4683976334161077, 'psi': 0.7484701891232768}
[S5] START round=7 head_norm_before_train=1.284827 (no previous merge yet)
[S5] round=7 local utility u=0.061222 metrics={'f1_val': 0.41778804395810054, 'auprc': 0.7786263541762385, 'loss_val': 0.89566374379327, 'psi': 0.5621233680453557}-{'f1_val': 0.41795135763108626, 'auprc': 0.7744780629226395, 'loss_val': 1.0066418355118196, 'psi': 0.5605620397477076}
[S6] START round=7 head_norm_before_train=1.447146 (no previous merge yet)
[S6] round=7 local utility u=0.332444 metrics={'f1_val': 0.7114649646660434, 'auprc': 0.8826723685202995, 'loss_val': 0.4792183843832429, 'psi': 0.7799479262077458}-{'f1_val': 0.6490071945475131, 'auprc': 0.8200330901502532, 'loss_val': 0.5814424007057681, 'psi': 0.7174175527886091}
[S7] START round=7 head_norm_before_train=0.642797 cos_to_last_merge=0.9946 (last merge round=5)
[S7] round=7 local utility u=0.020724 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7948329135311385, 'loss_val': 1.2210045157096052, 'psi': 0.4031672590499104}-{'f1_val': 0.14205682272909165, 'auprc': 0.7950866859908484, 'loss_val': 1.2632137018514016, 'psi': 0.40326876803379436}
[S8] START round=7 head_norm_before_train=0.701604 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.029654 metrics={'f1_val': 0.7139807753193125, 'auprc': 0.9931873838259795, 'loss_val': 0.5128073033899754, 'psi': 0.8256634187219793}-{'f1_val': 0.7137586021136586, 'auprc': 0.9935780198232207, 'loss_val': 0.5719532797114115, 'psi': 0.8256863691974834}
[S9] START round=7 head_norm_before_train=1.366687 (no previous merge yet)
[S9] round=7 local utility u=0.923156 metrics={'f1_val': 0.7017640638110727, 'auprc': 0.9999983436167129, 'loss_val': 0.544310787192612, 'psi': 0.8210577757333288}-{'f1_val': 0.43625879546239904, 'auprc': 0.9939604201039489, 'loss_val': 0.7794773689105203, 'psi': 0.659339445319019}
[S10] START round=7 head_norm_before_train=0.918178 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.006699 metrics={'f1_val': 0.7004176676980365, 'auprc': 0.997474924780711, 'loss_val': 0.3387781034522888, 'psi': 0.8192405705311063}-{'f1_val': 0.6998932897468348, 'auprc': 0.9978011296311118, 'loss_val': 0.3500092310413988, 'psi': 0.8190564257005456}
[S11] START round=7 head_norm_before_train=1.005069 cos_to_last_merge=0.9500 (last merge round=1)
[S11] round=7 local utility u=1.000000 metrics={'f1_val': 0.42282222891848775, 'auprc': 0.9019375751412398, 'loss_val': 0.9976268161459281, 'psi': 0.6144683674075886}-{'f1_val': 0.14041368337311058, 'auprc': 0.7978876018644967, 'loss_val': 1.1361400214392694, 'psi': 0.40340325076966504}
[S13] START round=7 head_norm_before_train=0.939134 cos_to_last_merge=0.9905 (last merge round=5)
[S13] round=7 local utility u=0.879729 metrics={'f1_val': 0.6904607843814428, 'auprc': 0.7436072696255092, 'loss_val': 0.6849239494140427, 'psi': 0.7117193784790693}-{'f1_val': 0.49620805558721043, 'auprc': 0.6188062800038454, 'loss_val': 0.904462816410811, 'psi': 0.5452473453538644}
[S14] START round=7 head_norm_before_train=1.013782 cos_to_last_merge=0.9794 (last merge round=3)
[S14] round=7 local utility u=0.232891 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.8280274254376403, 'loss_val': 0.9680331962451814, 'psi': 0.5691275128222107}-{'f1_val': 0.39656053564365834, 'auprc': 0.7219486639806153, 'loss_val': 1.1157765864937175, 'psi': 0.5267157869784411}
[S15] START round=7 head_norm_before_train=1.538516 (no previous merge yet)
[S15] round=7 local utility u=0.319702 metrics={'f1_val': 0.6945836169482897, 'auprc': 0.9850163820431123, 'loss_val': 0.30609460715396086, 'psi': 0.8107567229862187}-{'f1_val': 0.6970308342015898, 'auprc': 0.8005589305899699, 'loss_val': 0.4068099971931868, 'psi': 0.7384420727569418}
[S16] START round=7 head_norm_before_train=0.721279 cos_to_last_merge=0.9917 (last merge round=5)
[S16] round=7 local utility u=0.120455 metrics={'f1_val': 0.42153655641345483, 'auprc': 0.5168156637266917, 'loss_val': 1.0091428030843066, 'psi': 0.45964819933874956}-{'f1_val': 0.4171583814486223, 'auprc': 0.48938805469669744, 'loss_val': 1.1415000391845993, 'psi': 0.4460502507478524}
[S17] START round=7 head_norm_before_train=1.489025 (no previous merge yet)
[S17] round=7 local utility u=0.157096 metrics={'f1_val': 0.401580798923697, 'auprc': 0.682017171637757, 'loss_val': 0.8605453259707525, 'psi': 0.513755348009321}-{'f1_val': 0.35465806268110145, 'auprc': 0.6731744814003119, 'loss_val': 0.8666719174309243, 'psi': 0.48206463016878565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S3] → sending delta(kind=head bytes=1787) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:38411
[S11] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1787 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1791) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.811971)
[S16] loaded HEAD from S8 (vec_in norm=0.811971)
[S16] cosine check vs S8: cos=0.3670
[S16] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.511014)
[S7] loaded HEAD from S6 (vec_in norm=1.511014)
[S7] cosine check vs S6: cos=0.5104
[S7] BUFFERED delta from S6 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1787) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.133499)
[S6] loaded HEAD from S3 (vec_in norm=1.133499)
[S6] cosine check vs S3: cos=-0.0844
[S6] DROPPED delta from S3 (cos=-0.0844 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1792) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.322219)
[S3] loaded HEAD from S5 (vec_in norm=1.322219)
[S3] cosine check vs S5: cos=-0.0842
[S3] DROPPED delta from S5 (cos=-0.0842 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.661430)
[S8] loaded HEAD from S7 (vec_in norm=0.661430)
[S8] cosine check vs S7: cos=0.6635
[S8] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1795) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.044222)
[S10] loaded HEAD from S11 (vec_in norm=1.044222)
[S10] cosine check vs S11: cos=0.7751
[S10] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.256097)
[S5] loaded HEAD from S2 (vec_in norm=1.256097)
[S5] cosine check vs S2: cos=-0.0659
[S5] DROPPED delta from S2 (cos=-0.0659 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.422994)
[S3] loaded HEAD from S9 (vec_in norm=1.422994)
[S3] cosine check vs S9: cos=0.8875
[S3] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1794) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.327097)
[S8] loaded HEAD from S4 (vec_in norm=1.327097)
[S8] cosine check vs S4: cos=-0.1490
[S8] DROPPED delta from S4 (cos=-0.1490 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:38413
[S14] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.053402)
[S13] loaded HEAD from S14 (vec_in norm=1.053402)
[S13] cosine check vs S14: cos=0.7577
[S13] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:38416
[S16] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.771577)
[S4] loaded HEAD from S16 (vec_in norm=0.771577)
[S4] cosine check vs S16: cos=-0.1659
[S4] DROPPED delta from S16 (cos=-0.1659 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.605686)
[S7] loaded HEAD from S15 (vec_in norm=1.605686)
[S7] cosine check vs S15: cos=0.6250
[S7] BUFFERED delta from S15 (total buffered=2)
[S13] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.005696)
[S16] loaded HEAD from S13 (vec_in norm=1.005696)
[S16] cosine check vs S13: cos=0.5929
[S16] BUFFERED delta from S13 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.014118)
[S7] loaded HEAD from S10 (vec_in norm=1.014118)
[S7] cosine check vs S10: cos=0.6031
[S7] BUFFERED delta from S10 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.522690)
[S14] loaded HEAD from S17 (vec_in norm=1.522690)
[S14] cosine check vs S17: cos=0.6111
[S14] BUFFERED delta from S17 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.7140 head_norm=0.811971
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.099002e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.7137 head_norm=0.672573 delta_norm=0.309900
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.3964 head_norm=1.133499
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.342364e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.3964 head_norm=1.242237 delta_norm=0.334236
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.661430
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.423615e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=0.741487 delta_norm=0.242361
[S7] aggregate: ACCEPT kept=['S6', 'S15', 'S10'] (k=3/3) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4215 head_norm=0.771577
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.069978e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4181 head_norm=0.662746 delta_norm=0.306998
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.6905 head_norm=1.005696
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.590414e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.6892 head_norm=0.965210 delta_norm=0.359041
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.7004 head_norm=1.014118
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.454015e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.9926 head_norm=0.969595 delta_norm=0.345401
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.3965 head_norm=1.053402
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.057454e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.3397 head_norm=1.160686 delta_norm=0.605745
[S14] aggregate: ROLLBACK (f1_val pre=0.397 post=0.340 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=1.256097 cos_to_last_merge=0.9149 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.915
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.7195022343649049, 'loss_val': 0.3744000694242104, 'psi': 0.7085894039894485}-{'f1_val': 0.7013896806394065, 'auprc': 0.7796363388412628, 'loss_val': 0.48371347117269226, 'psi': 0.732688343920149}
[S3] START round=8 head_norm_before_train=1.242237 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.39990358896325445, 'auprc': 0.7385793323662738, 'loss_val': 0.9273894165248889, 'psi': 0.5353738863244621}-{'f1_val': 0.39638969140647473, 'auprc': 0.9785484166439807, 'loss_val': 0.8696728670939514, 'psi': 0.6292531815014771}
[S4] START round=8 head_norm_before_train=1.327097 cos_to_last_merge=0.8649 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.865
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.6728379955966002, 'auprc': 0.9525454590236814, 'loss_val': 0.35064476799126865, 'psi': 0.7847209809674327}-{'f1_val': 0.6928686931642583, 'auprc': 0.950176505503999, 'loss_val': 0.37979861284559246, 'psi': 0.7957918181001545}
[S5] START round=8 head_norm_before_train=1.322219 (no previous merge yet)
[S5] round=8 local utility u=0.046473 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.787582534461345, 'loss_val': 0.8288618472057424, 'psi': 0.5656333251643852}-{'f1_val': 0.41778804395810054, 'auprc': 0.7786263541762385, 'loss_val': 0.89566374379327, 'psi': 0.5621233680453557}
[S6] START round=8 head_norm_before_train=1.511014 (no previous merge yet)
[S6] round=8 local utility u=0.174441 metrics={'f1_val': 0.7119363637585827, 'auprc': 0.9587202478992096, 'loss_val': 0.3613090013194942, 'psi': 0.8106499174148334}-{'f1_val': 0.7114649646660434, 'auprc': 0.8826723685202995, 'loss_val': 0.4792183843832429, 'psi': 0.7799479262077458}
[S7] START round=8 head_norm_before_train=0.741487 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.025883 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.79388389544169, 'loss_val': 1.1663919332386805, 'psi': 0.402787651814131}-{'f1_val': 0.14205682272909165, 'auprc': 0.7948329135311385, 'loss_val': 1.2210045157096052, 'psi': 0.4031672590499104}
[S8] START round=8 head_norm_before_train=0.672573 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.7938267031842963, 'loss_val': 0.5774718438426953, 'psi': 0.7458631613521874}-{'f1_val': 0.7139807753193125, 'auprc': 0.9931873838259795, 'loss_val': 0.5128073033899754, 'psi': 0.8256634187219793}
[S9] START round=8 head_norm_before_train=1.422994 (no previous merge yet)
[S9] round=8 local utility u=0.086479 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9995890988962726, 'loss_val': 0.369229277699851, 'psi': 0.820804548989446}-{'f1_val': 0.7017640638110727, 'auprc': 0.9999983436167129, 'loss_val': 0.544310787192612, 'psi': 0.8210577757333288}
[S10] START round=8 head_norm_before_train=0.969595 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.864223 metrics={'f1_val': 0.9914978898360015, 'auprc': 0.9967142720394457, 'loss_val': 0.3545305888857463, 'psi': 0.9935844427173792}-{'f1_val': 0.7004176676980365, 'auprc': 0.997474924780711, 'loss_val': 0.3387781034522888, 'psi': 0.8192405705311063}
[S11] START round=8 head_norm_before_train=1.044222 cos_to_last_merge=0.9355 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=8 local utility u=0.152094 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9961869055799863, 'loss_val': 0.8183653696380253, 'psi': 0.6363858948774942}-{'f1_val': 0.42282222891848775, 'auprc': 0.9019375751412398, 'loss_val': 0.9976268161459281, 'psi': 0.6144683674075886}
[S13] START round=8 head_norm_before_train=0.965210 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.5996969635441869, 'auprc': 0.7242276263564682, 'loss_val': 0.7472616197547696, 'psi': 0.6495092286690994}-{'f1_val': 0.6904607843814428, 'auprc': 0.7436072696255092, 'loss_val': 0.6849239494140427, 'psi': 0.7117193784790693}
[S14] START round=8 head_norm_before_train=1.160686 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.990508 metrics={'f1_val': 0.6372530246775182, 'auprc': 0.989698305766338, 'loss_val': 0.9163820197831517, 'psi': 0.7782311371130461}-{'f1_val': 0.39652757107859105, 'auprc': 0.8280274254376403, 'loss_val': 0.9680331962451814, 'psi': 0.5691275128222107}
[S15] START round=8 head_norm_before_train=1.605686 (no previous merge yet)
[S15] round=8 local utility u=0.212522 metrics={'f1_val': 0.760085766366195, 'auprc': 0.9810523582717763, 'loss_val': 0.2621720394598785, 'psi': 0.8484724031284274}-{'f1_val': 0.6945836169482897, 'auprc': 0.9850163820431123, 'loss_val': 0.30609460715396086, 'psi': 0.8107567229862187}
[S16] START round=8 head_norm_before_train=0.662746 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.047178 metrics={'f1_val': 0.3512360338586254, 'auprc': 0.7162343956505829, 'loss_val': 1.091240432479301, 'psi': 0.4972353785754084}-{'f1_val': 0.42153655641345483, 'auprc': 0.5168156637266917, 'loss_val': 1.0091428030843066, 'psi': 0.45964819933874956}
[S17] START round=8 head_norm_before_train=1.522690 (no previous merge yet)
[S17] round=8 local utility u=0.097628 metrics={'f1_val': 0.36595254555290246, 'auprc': 0.773192975618757, 'loss_val': 0.7250481848730055, 'psi': 0.5288487175792443}-{'f1_val': 0.401580798923697, 'auprc': 0.682017171637757, 'loss_val': 0.8605453259707525, 'psi': 0.513755348009321}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:38409
[S7] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.037959)
[S7] loaded HEAD from S10 (vec_in norm=1.037959)
[S7] cosine check vs S10: cos=0.7626
[S7] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.573883)
[S7] loaded HEAD from S6 (vec_in norm=1.573883)
[S7] cosine check vs S6: cos=0.4467
[S7] BUFFERED delta from S6 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.757899)
[S8] loaded HEAD from S7 (vec_in norm=0.757899)
[S8] cosine check vs S7: cos=0.7349
[S8] BUFFERED delta from S7 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1795) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.188650)
[S13] loaded HEAD from S14 (vec_in norm=1.188650)
[S13] cosine check vs S14: cos=0.7712
[S13] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1805) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.481954)
[S3] loaded HEAD from S9 (vec_in norm=1.481954)
[S3] cosine check vs S9: cos=0.9610
[S3] BUFFERED delta from S9 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1795) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.351164)
[S3] loaded HEAD from S5 (vec_in norm=1.351164)
[S3] cosine check vs S5: cos=-0.0521
[S3] DROPPED delta from S5 (cos=-0.0521 < 0.0)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:38411
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:38404
[S11] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.665691)
[S7] loaded HEAD from S15 (vec_in norm=1.665691)
[S7] cosine check vs S15: cos=0.7000
[S7] BUFFERED delta from S15 (total buffered=3)
[S10] RECEIVED delta(kind=head bytes=1801) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.093114)
[S10] loaded HEAD from S11 (vec_in norm=1.093114)
[S10] cosine check vs S11: cos=0.9071
[S10] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.558295)
[S14] loaded HEAD from S17 (vec_in norm=1.558295)
[S14] cosine check vs S17: cos=0.9080
[S14] BUFFERED delta from S17 (total buffered=1)
[S16] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.706932)
[S4] loaded HEAD from S16 (vec_in norm=0.706932)
[S4] cosine check vs S16: cos=-0.2094
[S4] DROPPED delta from S16 (cos=-0.2094 < 0.0)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.1421 head_norm=0.757899
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.760473e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.1421 head_norm=0.830413 delta_norm=0.176047
[S7] aggregate: ACCEPT kept=['S10', 'S6', 'S15'] (k=3/3) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.7139 head_norm=0.774410
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.790640e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.7139 head_norm=0.713571 delta_norm=0.279064
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.9915 head_norm=1.037959
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.312235e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.9915 head_norm=1.040512 delta_norm=0.231224
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.6373 head_norm=1.188650
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.454988e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3400 head_norm=1.342094 delta_norm=0.345499
[S14] aggregate: ROLLBACK (f1_val pre=0.637 post=0.340 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.5997 head_norm=1.024145
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.821695e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.4156 head_norm=1.041550 delta_norm=0.382170
[S13] aggregate: ROLLBACK (f1_val pre=0.600 post=0.416 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.3999 head_norm=1.270673
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.187387e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.4013 head_norm=1.362920 delta_norm=0.218739
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.345993 cos_to_last_merge=0.8967 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.897
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.701390464132351, 'auprc': 0.6842518791677019, 'loss_val': 0.3685483960259363, 'psi': 0.6945350301464914}-{'f1_val': 0.7013141837391442, 'auprc': 0.7195022343649049, 'loss_val': 0.3744000694242104, 'psi': 0.7085894039894485}
[S3] START round=9 head_norm_before_train=1.362920 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.478996 metrics={'f1_val': 0.5248595947667195, 'auprc': 0.7938577865411018, 'loss_val': 0.8849686446449444, 'psi': 0.6324588714764725}-{'f1_val': 0.39990358896325445, 'auprc': 0.7385793323662738, 'loss_val': 0.9273894165248889, 'psi': 0.5353738863244621}
[S4] START round=9 head_norm_before_train=1.387923 cos_to_last_merge=0.8516 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.852
[S4] round=9 local utility u=0.828614 metrics={'f1_val': 0.9482608857638944, 'auprc': 0.9613911250147851, 'loss_val': 0.3724914571997643, 'psi': 0.9535129814642507}-{'f1_val': 0.6728379955966002, 'auprc': 0.9525454590236814, 'loss_val': 0.35064476799126865, 'psi': 0.7847209809674327}
[S5] START round=9 head_norm_before_train=1.351164 (no previous merge yet)
[S5] round=9 local utility u=0.156071 metrics={'f1_val': 0.4175465518408786, 'auprc': 0.8649024826910523, 'loss_val': 0.7479566795694472, 'psi': 0.5964889241809481}-{'f1_val': 0.4176671856330787, 'auprc': 0.787582534461345, 'loss_val': 0.8288618472057424, 'psi': 0.5656333251643852}
[S6] START round=9 head_norm_before_train=1.573883 (no previous merge yet)
[S6] round=9 local utility u=0.012392 metrics={'f1_val': 0.7102913164102467, 'auprc': 0.9524353953300659, 'loss_val': 0.3078005290264523, 'psi': 0.8071489479781744}-{'f1_val': 0.7119363637585827, 'auprc': 0.9587202478992096, 'loss_val': 0.3613090013194942, 'psi': 0.8106499174148334}
[S7] START round=9 head_norm_before_train=0.830413 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.856054 metrics={'f1_val': 0.416467909967687, 'auprc': 0.7930095035997761, 'loss_val': 1.0981269034179035, 'psi': 0.5670845474205226}-{'f1_val': 0.14205682272909165, 'auprc': 0.79388389544169, 'loss_val': 1.1663919332386805, 'psi': 0.402787651814131}
[S8] START round=9 head_norm_before_train=0.713571 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.340337 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.9910900461239477, 'loss_val': 0.48858699838706343, 'psi': 0.824768498528048}-{'f1_val': 0.7138874667974482, 'auprc': 0.7938267031842963, 'loss_val': 0.5774718438426953, 'psi': 0.7458631613521874}
[S9] START round=9 head_norm_before_train=1.481954 (no previous merge yet)
[S9] round=9 local utility u=0.038232 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9987291653871564, 'loss_val': 0.28974100298773864, 'psi': 0.8204160646760258}-{'f1_val': 0.7016148490515617, 'auprc': 0.9995890988962726, 'loss_val': 0.369229277699851, 'psi': 0.820804548989446}
[S10] START round=9 head_norm_before_train=1.040512 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.004484 metrics={'f1_val': 0.9953369833117514, 'auprc': 0.993810985174726, 'loss_val': 0.35988731630103094, 'psi': 0.9947265840569413}-{'f1_val': 0.9914978898360015, 'auprc': 0.9967142720394457, 'loss_val': 0.3545305888857463, 'psi': 0.9935844427173792}
[S11] START round=9 head_norm_before_train=1.093114 cos_to_last_merge=0.9182 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.918
[S11] round=9 local utility u=0.065179 metrics={'f1_val': 0.3925123205210987, 'auprc': 0.9984582934593992, 'loss_val': 0.6707836075738013, 'psi': 0.6348907096964189}-{'f1_val': 0.39651855440916606, 'auprc': 0.9961869055799863, 'loss_val': 0.8183653696380253, 'psi': 0.6363858948774942}
[S13] START round=9 head_norm_before_train=1.041550 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.267971 metrics={'f1_val': 0.6904607843814428, 'auprc': 0.7036196894510073, 'loss_val': 0.6940782655016312, 'psi': 0.6957243464092686}-{'f1_val': 0.5996969635441869, 'auprc': 0.7242276263564682, 'loss_val': 0.7472616197547696, 'psi': 0.6495092286690994}
[S14] START round=9 head_norm_before_train=1.342094 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.060395 metrics={'f1_val': 0.6402185341730398, 'auprc': 0.9854304181682791, 'loss_val': 0.8005816594478197, 'psi': 0.7783032877711356}-{'f1_val': 0.6372530246775182, 'auprc': 0.989698305766338, 'loss_val': 0.9163820197831517, 'psi': 0.7782311371130461}
[S15] START round=9 head_norm_before_train=1.665691 (no previous merge yet)
[S15] round=9 local utility u=0.368178 metrics={'f1_val': 0.8623548889796755, 'auprc': 0.9919425705492229, 'loss_val': 0.17210106272951384, 'psi': 0.9141899616074944}-{'f1_val': 0.760085766366195, 'auprc': 0.9810523582717763, 'loss_val': 0.2621720394598785, 'psi': 0.8484724031284274}
[S16] START round=9 head_norm_before_train=0.706932 cos_to_last_merge=0.9911 (last merge round=7)
[S16] round=9 local utility u=0.056484 metrics={'f1_val': 0.3565896094385295, 'auprc': 0.7180745183193313, 'loss_val': 1.015913945762979, 'psi': 0.5011835729908503}-{'f1_val': 0.3512360338586254, 'auprc': 0.7162343956505829, 'loss_val': 1.091240432479301, 'psi': 0.4972353785754084}
[S17] START round=9 head_norm_before_train=1.558295 (no previous merge yet)
[S17] round=9 local utility u=0.380144 metrics={'f1_val': 0.4204517160990364, 'auprc': 0.8658392661166198, 'loss_val': 0.5696948276009846, 'psi': 0.5986067361060697}-{'f1_val': 0.36595254555290246, 'auprc': 0.773192975618757, 'loss_val': 0.7250481848730055, 'psi': 0.5288487175792443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:38413
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38408
[S11] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.386955)
[S6] loaded HEAD from S3 (vec_in norm=1.386955)
[S6] cosine check vs S3: cos=-0.1130
[S6] DROPPED delta from S3 (cos=-0.1130 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1793) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.110133)
[S7] loaded HEAD from S10 (vec_in norm=1.110133)
[S7] cosine check vs S10: cos=0.8179
[S7] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1797) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.364159)
[S13] loaded HEAD from S14 (vec_in norm=1.364159)
[S13] cosine check vs S14: cos=0.8600
[S13] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1805) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.146554)
[S10] loaded HEAD from S11 (vec_in norm=1.146554)
[S10] cosine check vs S11: cos=0.9486
[S10] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.763018)
[S4] loaded HEAD from S16 (vec_in norm=0.763018)
[S4] cosine check vs S16: cos=-0.2192
[S4] DROPPED delta from S16 (cos=-0.2192 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.814692)
[S16] loaded HEAD from S8 (vec_in norm=0.814692)
[S16] cosine check vs S8: cos=0.4609
[S16] BUFFERED delta from S8 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.379267)
[S3] loaded HEAD from S5 (vec_in norm=1.379267)
[S3] cosine check vs S5: cos=-0.0361
[S3] DROPPED delta from S5 (cos=-0.0361 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.846373)
[S8] loaded HEAD from S7 (vec_in norm=0.846373)
[S8] cosine check vs S7: cos=0.8107
[S8] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.723286)
[S7] loaded HEAD from S15 (vec_in norm=1.723286)
[S7] cosine check vs S15: cos=0.7390
[S7] BUFFERED delta from S15 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1796) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.430507)
[S8] loaded HEAD from S4 (vec_in norm=1.430507)
[S8] cosine check vs S4: cos=-0.1903
[S8] DROPPED delta from S4 (cos=-0.1903 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.105458)
[S16] loaded HEAD from S13 (vec_in norm=1.105458)
[S16] cosine check vs S13: cos=0.4698
[S16] BUFFERED delta from S13 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.537617)
[S3] loaded HEAD from S9 (vec_in norm=1.537617)
[S3] cosine check vs S9: cos=0.9806
[S3] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.640219)
[S7] loaded HEAD from S6 (vec_in norm=1.640219)
[S7] cosine check vs S6: cos=0.3900
[S7] BUFFERED delta from S6 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1793 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1793) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.588507)
[S14] loaded HEAD from S17 (vec_in norm=1.588507)
[S14] cosine check vs S17: cos=0.9662
[S14] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4165 head_norm=0.846373
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.396545e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4169 head_norm=0.909276 delta_norm=0.139655
[S7] aggregate: ACCEPT kept=['S10', 'S15', 'S6'] (k=3/3) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.5249 head_norm=1.386955
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.622992e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.5298 head_norm=1.455202 delta_norm=0.162299
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.9953 head_norm=1.110133
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.818630e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.9952 head_norm=1.113740 delta_norm=0.181863
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.6402 head_norm=1.364159
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.219435e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.6642 head_norm=1.463859 delta_norm=0.221944
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.6905 head_norm=1.105458
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.497235e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.6894 head_norm=1.191292 delta_norm=0.349724
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3566 head_norm=0.763018
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.168377e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3623 head_norm=0.664655 delta_norm=0.316838
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.7139 head_norm=0.814692
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.559517e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.7141 head_norm=0.790268 delta_norm=0.255952
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.414921 cos_to_last_merge=0.8830 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.883
[S2] round=10 local utility u=0.133811 metrics={'f1_val': 0.7013027369713671, 'auprc': 0.766437244558332, 'loss_val': 0.3469569444847522, 'psi': 0.727356540006153}-{'f1_val': 0.701390464132351, 'auprc': 0.6842518791677019, 'loss_val': 0.3685483960259363, 'psi': 0.6945350301464914}
[S3] START round=10 head_norm_before_train=1.455202 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.492880 metrics={'f1_val': 0.6009882427071007, 'auprc': 0.9354907410799819, 'loss_val': 0.780880233316841, 'psi': 0.7347892420562532}-{'f1_val': 0.5248595947667195, 'auprc': 0.7938577865411018, 'loss_val': 0.8849686446449444, 'psi': 0.6324588714764725}
[S4] START round=10 head_norm_before_train=1.430507 cos_to_last_merge=0.8432 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.843
[S4] round=10 local utility u=0.057262 metrics={'f1_val': 0.9537426363657193, 'auprc': 0.9610121509234837, 'loss_val': 0.2897204265175721, 'psi': 0.956650442188825}-{'f1_val': 0.9482608857638944, 'auprc': 0.9613911250147851, 'loss_val': 0.3724914571997643, 'psi': 0.9535129814642507}
[S5] START round=10 head_norm_before_train=1.379267 (no previous merge yet)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.860711074456159, 'loss_val': 0.7861685253714576, 'psi': 0.5948847411623108}-{'f1_val': 0.4175465518408786, 'auprc': 0.8649024826910523, 'loss_val': 0.7479566795694472, 'psi': 0.5964889241809481}
[S6] START round=10 head_norm_before_train=1.640219 (no previous merge yet)
[S6] round=10 local utility u=0.844643 metrics={'f1_val': 0.9614299792379238, 'auprc': 0.9757923865642273, 'loss_val': 0.1954177017466225, 'psi': 0.9671749421684452}-{'f1_val': 0.7102913164102467, 'auprc': 0.9524353953300659, 'loss_val': 0.3078005290264523, 'psi': 0.8071489479781744}
[S7] START round=10 head_norm_before_train=0.909276 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.044219 metrics={'f1_val': 0.4172381946317165, 'auprc': 0.7909913487700178, 'loss_val': 1.0082562624202587, 'psi': 0.566739456287037}-{'f1_val': 0.416467909967687, 'auprc': 0.7930095035997761, 'loss_val': 1.0981269034179035, 'psi': 0.5670845474205226}
[S8] START round=10 head_norm_before_train=0.790268 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.023078 metrics={'f1_val': 0.7139540394217572, 'auprc': 0.9922498802084553, 'loss_val': 0.44630920804401236, 'psi': 0.8252723757364364}-{'f1_val': 0.7138874667974482, 'auprc': 0.9910900461239477, 'loss_val': 0.48858699838706343, 'psi': 0.824768498528048}
[S9] START round=10 head_norm_before_train=1.537617 (no previous merge yet)
[S9] round=10 local utility u=0.026824 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9982117909475462, 'loss_val': 0.23409823583907527, 'psi': 0.8201647727572215}-{'f1_val': 0.7015406642019387, 'auprc': 0.9987291653871564, 'loss_val': 0.28974100298773864, 'psi': 0.8204160646760258}
[S10] START round=10 head_norm_before_train=1.113740 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.9750770453257788, 'auprc': 0.9881717516494174, 'loss_val': 0.3355759874881668, 'psi': 0.9803149278552343}-{'f1_val': 0.9953369833117514, 'auprc': 0.993810985174726, 'loss_val': 0.35988731630103094, 'psi': 0.9947265840569413}
[S11] START round=10 head_norm_before_train=1.146554 cos_to_last_merge=0.8998 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.900
[S11] round=10 local utility u=0.843697 metrics={'f1_val': 0.6568526506220156, 'auprc': 0.9956019661233825, 'loss_val': 0.560862570282117, 'psi': 0.7923523768225624}-{'f1_val': 0.3925123205210987, 'auprc': 0.9984582934593992, 'loss_val': 0.6707836075738013, 'psi': 0.6348907096964189}
[S13] START round=10 head_norm_before_train=1.191292 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.6274538359889893, 'auprc': 0.696532977003208, 'loss_val': 0.6687225800043185, 'psi': 0.6550854923946767}-{'f1_val': 0.6904607843814428, 'auprc': 0.7036196894510073, 'loss_val': 0.6940782655016312, 'psi': 0.6957243464092686}
[S14] START round=10 head_norm_before_train=1.463859 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.083389 metrics={'f1_val': 0.6398927699600341, 'auprc': 0.9949106710682843, 'loss_val': 0.660290621793961, 'psi': 0.7818999304033342}-{'f1_val': 0.6402185341730398, 'auprc': 0.9854304181682791, 'loss_val': 0.8005816594478197, 'psi': 0.7783032877711356}
[S15] START round=10 head_norm_before_train=1.723286 (no previous merge yet)
[S15] round=10 local utility u=0.433095 metrics={'f1_val': 0.9931028100218317, 'auprc': 0.995950243197959, 'loss_val': 0.10242227847733112, 'psi': 0.9942417832922825}-{'f1_val': 0.8623548889796755, 'auprc': 0.9919425705492229, 'loss_val': 0.17210106272951384, 'psi': 0.9141899616074944}
[S16] START round=10 head_norm_before_train=0.664655 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.43598219705946156, 'auprc': 0.5266505843781495, 'loss_val': 1.0008700409740703, 'psi': 0.47224955198693674}-{'f1_val': 0.3565896094385295, 'auprc': 0.7180745183193313, 'loss_val': 1.015913945762979, 'psi': 0.5011835729908503}
[S17] START round=10 head_norm_before_train=1.588507 (no previous merge yet)
[S17] round=10 local utility u=0.232665 metrics={'f1_val': 0.5097513985530273, 'auprc': 0.838956252581649, 'loss_val': 0.5595130854228338, 'psi': 0.6414333401644761}-{'f1_val': 0.4204517160990364, 'auprc': 0.8658392661166198, 'loss_val': 0.5696948276009846, 'psi': 0.5986067361060697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38416
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38408
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:38403
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:38409
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.487795)
[S13] loaded HEAD from S14 (vec_in norm=1.487795)
[S13] cosine check vs S14: cos=0.9270
[S13] BUFFERED delta from S14 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.881536)
[S16] loaded HEAD from S8 (vec_in norm=0.881536)
[S16] cosine check vs S8: cos=0.5475
[S16] BUFFERED delta from S8 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1802) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.196317)
[S10] loaded HEAD from S11 (vec_in norm=1.196317)
[S10] cosine check vs S11: cos=0.9689
[S10] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.930264)
[S8] loaded HEAD from S7 (vec_in norm=0.930264)
[S8] cosine check vs S7: cos=0.8722
[S8] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.763078)
[S7] loaded HEAD from S15 (vec_in norm=1.763078)
[S7] cosine check vs S15: cos=0.7583
[S7] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.468008)
[S5] loaded HEAD from S2 (vec_in norm=1.468008)
[S5] cosine check vs S2: cos=-0.0777
[S5] DROPPED delta from S2 (cos=-0.0777 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.587841)
[S3] loaded HEAD from S9 (vec_in norm=1.587841)
[S3] cosine check vs S9: cos=0.9873
[S3] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.682277)
[S7] loaded HEAD from S6 (vec_in norm=1.682277)
[S7] cosine check vs S6: cos=0.3608
[S7] BUFFERED delta from S6 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1802) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.480907)
[S6] loaded HEAD from S3 (vec_in norm=1.480907)
[S6] cosine check vs S3: cos=-0.1199
[S6] DROPPED delta from S3 (cos=-0.1199 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.475839)
[S8] loaded HEAD from S4 (vec_in norm=1.475839)
[S8] cosine check vs S4: cos=-0.2061
[S8] DROPPED delta from S4 (cos=-0.2061 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.618649)
[S14] loaded HEAD from S17 (vec_in norm=1.618649)
[S14] cosine check vs S17: cos=0.9807
[S14] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.6275 head_norm=1.249310
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.864346e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.6346 head_norm=1.343543 delta_norm=0.286435
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.299 → S16@127.0.0.1:38416
[S5] ⇄ pheromone p=0.268 → S3@127.0.0.1:38403
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.9751 head_norm=1.169470
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.480683e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.9773 head_norm=1.173667 delta_norm=0.148068
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.370 → S7@127.0.0.1:38408
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.4360 head_norm=0.713088
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.864266e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.4365 head_norm=0.702477 delta_norm=0.386427
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.197 → S4@127.0.0.1:38404
[S6] ⇄ pheromone p=0.454 → S7@127.0.0.1:38408
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4172 head_norm=0.930264
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.617944e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4171 head_norm=1.017383 delta_norm=0.361794
[S7] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.289 → S8@127.0.0.1:38409
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.7140 head_norm=0.881536
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.302227e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.9076 head_norm=0.876497 delta_norm=0.230223
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.319 → S16@127.0.0.1:38416
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.6010 head_norm=1.480907
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.334610e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.6037 head_norm=1.529494 delta_norm=0.133461
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.382 → S6@127.0.0.1:38407
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.6399 head_norm=1.487795
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.658081e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.6575 head_norm=1.545732 delta_norm=0.165808
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.365 → S13@127.0.0.1:38413
[S9] ⇄ pheromone p=0.350 → S3@127.0.0.1:38403
[S11] ⇄ pheromone p=0.449 → S10@127.0.0.1:38411
[S4] ⇄ pheromone p=0.420 → S8@127.0.0.1:38409
[S15] ⇄ pheromone p=0.440 → S7@127.0.0.1:38408
[S2] ⇄ pheromone p=0.278 → S5@127.0.0.1:38405
[S17] ⇄ pheromone p=0.306 → S14@127.0.0.1:38414
[S2] START round=11 head_norm_before_train=1.468008 cos_to_last_merge=0.8732 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.873
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.5916602579396946, 'auprc': 0.6644860812979366, 'loss_val': 0.5587453226586826, 'psi': 0.6207905872829914}-{'f1_val': 0.7013027369713671, 'auprc': 0.766437244558332, 'loss_val': 0.3469569444847522, 'psi': 0.727356540006153}
[S3] START round=11 head_norm_before_train=1.529494 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.47200161424867004, 'auprc': 0.7898981521556279, 'loss_val': 0.8195176260946347, 'psi': 0.5991602294114532}-{'f1_val': 0.6009882427071007, 'auprc': 0.9354907410799819, 'loss_val': 0.780880233316841, 'psi': 0.7347892420562532}
[S4] START round=11 head_norm_before_train=1.475839 cos_to_last_merge=0.8362 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.836
[S4] round=11 local utility u=0.047770 metrics={'f1_val': 0.9567405748570246, 'auprc': 0.9732820168439855, 'loss_val': 0.2489774456806303, 'psi': 0.9633571516518089}-{'f1_val': 0.9537426363657193, 'auprc': 0.9610121509234837, 'loss_val': 0.2897204265175721, 'psi': 0.956650442188825}
[S5] START round=11 head_norm_before_train=1.400347 (no previous merge yet)
[S5] round=11 local utility u=0.059654 metrics={'f1_val': 0.42068724819760683, 'auprc': 0.8650539708514287, 'loss_val': 0.6980089375672576, 'psi': 0.5984339372591356}-{'f1_val': 0.4176671856330787, 'auprc': 0.860711074456159, 'loss_val': 0.7861685253714576, 'psi': 0.5948847411623108}
[S6] START round=11 head_norm_before_train=1.682277 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.6434322430308198, 'auprc': 0.817640823370737, 'loss_val': 0.3848243999206104, 'psi': 0.7131156751667866}-{'f1_val': 0.9614299792379238, 'auprc': 0.9757923865642273, 'loss_val': 0.1954177017466225, 'psi': 0.9671749421684452}
[S7] START round=11 head_norm_before_train=1.017383 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.053961 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.7910341350978589, 'loss_val': 0.8992454241719475, 'psi': 0.5666349103319124}-{'f1_val': 0.4172381946317165, 'auprc': 0.7909913487700178, 'loss_val': 1.0082562624202587, 'psi': 0.566739456287037}
[S8] START round=11 head_norm_before_train=0.876497 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.011726 metrics={'f1_val': 0.7140186993020905, 'auprc': 0.9906843461725632, 'loss_val': 0.4185482265780325, 'psi': 0.8246849580502795}-{'f1_val': 0.7139540394217572, 'auprc': 0.9922498802084553, 'loss_val': 0.44630920804401236, 'psi': 0.8252723757364364}
[S9] START round=11 head_norm_before_train=1.587841 (no previous merge yet)
[S9] round=11 local utility u=0.010120 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981901974436473, 'loss_val': 0.21229176056531443, 'psi': 0.8200060274414701}-{'f1_val': 0.7014667606303384, 'auprc': 0.9982117909475462, 'loss_val': 0.23409823583907527, 'psi': 0.8201647727572215}
[S10] START round=11 head_norm_before_train=1.173667 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.086032 metrics={'f1_val': 0.9947781979029806, 'auprc': 0.9911229641321735, 'loss_val': 0.29057237327098473, 'psi': 0.9933161043946577}-{'f1_val': 0.9750770453257788, 'auprc': 0.9881717516494174, 'loss_val': 0.3355759874881668, 'psi': 0.9803149278552343}
[S11] START round=11 head_norm_before_train=1.196317 cos_to_last_merge=0.8821 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.882
[S11] round=11 local utility u=0.203249 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9977864447175939, 'loss_val': 0.431414532397395, 'psi': 0.8202757678660296}-{'f1_val': 0.6568526506220156, 'auprc': 0.9956019661233825, 'loss_val': 0.560862570282117, 'psi': 0.7923523768225624}
[S13] START round=11 head_norm_before_train=1.343543 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.6132314134049761, 'auprc': 0.6616032496895494, 'loss_val': 0.639507208965976, 'psi': 0.6325801479188055}-{'f1_val': 0.6274538359889893, 'auprc': 0.696532977003208, 'loss_val': 0.6687225800043185, 'psi': 0.6550854923946767}
[S14] START round=11 head_norm_before_train=1.545732 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.237675 metrics={'f1_val': 0.7003499143523644, 'auprc': 0.992594695387675, 'loss_val': 0.5407349663859384, 'psi': 0.8172478267664887}-{'f1_val': 0.6398927699600341, 'auprc': 0.9949106710682843, 'loss_val': 0.660290621793961, 'psi': 0.7818999304033342}
[S15] START round=11 head_norm_before_train=1.763078 (no previous merge yet)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.6990496044962369, 'auprc': 0.8337074218878147, 'loss_val': 0.4450962764186555, 'psi': 0.7529127314528681}-{'f1_val': 0.9931028100218317, 'auprc': 0.995950243197959, 'loss_val': 0.10242227847733112, 'psi': 0.9942417832922825}
[S16] START round=11 head_norm_before_train=0.702477 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.667830 metrics={'f1_val': 0.5431253686912437, 'auprc': 0.7469546112368728, 'loss_val': 0.9689812632655962, 'psi': 0.6246570657094954}-{'f1_val': 0.43598219705946156, 'auprc': 0.5266505843781495, 'loss_val': 1.0008700409740703, 'psi': 0.47224955198693674}
[S17] START round=11 head_norm_before_train=1.618649 (no previous merge yet)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.5466857508385657, 'auprc': 0.7389789902403517, 'loss_val': 0.6164875491843418, 'psi': 0.6236030465992801}-{'f1_val': 0.5097513985530273, 'auprc': 0.838956252581649, 'loss_val': 0.5595130854228338, 'psi': 0.6414333401644761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:38404
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38416
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:38409
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:38413
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:38411
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.571035)
[S13] loaded HEAD from S14 (vec_in norm=1.571035)
[S13] cosine check vs S14: cos=0.9587
[S13] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1803) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.244561)
[S10] loaded HEAD from S11 (vec_in norm=1.244561)
[S10] cosine check vs S11: cos=0.9789
[S10] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.524223)
[S8] loaded HEAD from S4 (vec_in norm=1.524223)
[S8] cosine check vs S4: cos=-0.2174
[S8] DROPPED delta from S4 (cos=-0.2174 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.044249)
[S8] loaded HEAD from S7 (vec_in norm=1.044249)
[S8] cosine check vs S7: cos=0.8849
[S8] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.221265)
[S7] loaded HEAD from S10 (vec_in norm=1.221265)
[S7] cosine check vs S10: cos=0.6119
[S7] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.747261)
[S4] loaded HEAD from S16 (vec_in norm=0.747261)
[S4] cosine check vs S16: cos=-0.2686
[S4] DROPPED delta from S16 (cos=-0.2686 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.629252)
[S3] loaded HEAD from S9 (vec_in norm=1.629252)
[S3] cosine check vs S9: cos=0.9908
[S3] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.966924)
[S16] loaded HEAD from S8 (vec_in norm=0.966924)
[S16] cosine check vs S8: cos=0.8552
[S16] BUFFERED delta from S8 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.421656)
[S3] loaded HEAD from S5 (vec_in norm=1.421656)
[S3] cosine check vs S5: cos=-0.0215
[S3] DROPPED delta from S5 (cos=-0.0215 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6132 head_norm=1.396346
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.300647e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.6137 head_norm=1.468345 delta_norm=0.230065
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.4720 head_norm=1.555779
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.141102e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.4822 head_norm=1.588847 delta_norm=0.114110
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.9948 head_norm=1.221265
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.272273e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.9948 head_norm=1.226386 delta_norm=0.127227
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.5431 head_norm=0.747261
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.536917e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.4678 head_norm=0.826021 delta_norm=0.253692
[S16] aggregate: ROLLBACK (f1_val pre=0.543 post=0.468 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.7140 head_norm=0.966924
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.441665e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.8435 head_norm=0.976259 delta_norm=0.244167
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4170 head_norm=1.044249
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.052565e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.7144 head_norm=1.017688 delta_norm=0.505257
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.502969 cos_to_last_merge=0.8678 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.868
[S2] round=12 local utility u=0.523793 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.7141630727730737, 'loss_val': 0.3191802711105496, 'psi': 0.706560318847537}-{'f1_val': 0.5916602579396946, 'auprc': 0.6644860812979366, 'loss_val': 0.5587453226586826, 'psi': 0.6207905872829914}
[S3] START round=12 head_norm_before_train=1.588847 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.44994374304626317, 'auprc': 0.8057677843254645, 'loss_val': 0.8320812267993491, 'psi': 0.5922733595579437}-{'f1_val': 0.47200161424867004, 'auprc': 0.7898981521556279, 'loss_val': 0.8195176260946347, 'psi': 0.5991602294114532}
[S4] START round=12 head_norm_before_train=1.524223 cos_to_last_merge=0.8302 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.830
[S4] round=12 local utility u=0.003886 metrics={'f1_val': 0.9554697318760369, 'auprc': 0.9730493764604115, 'loss_val': 0.23288303270091668, 'psi': 0.9625015897097867}-{'f1_val': 0.9567405748570246, 'auprc': 0.9732820168439855, 'loss_val': 0.2489774456806303, 'psi': 0.9633571516518089}
[S5] START round=12 head_norm_before_train=1.421656 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.41758505646266003, 'auprc': 0.8591648653815505, 'loss_val': 0.7046405690595492, 'psi': 0.5942169800302162}-{'f1_val': 0.42068724819760683, 'auprc': 0.8650539708514287, 'loss_val': 0.6980089375672576, 'psi': 0.5984339372591356}
[S6] START round=12 head_norm_before_train=1.707858 (no previous merge yet)
[S6] round=12 local utility u=0.213403 metrics={'f1_val': 0.7359546909609953, 'auprc': 0.8148433236660914, 'loss_val': 0.5047599203080311, 'psi': 0.7675101440430337}-{'f1_val': 0.6434322430308198, 'auprc': 0.817640823370737, 'loss_val': 0.3848243999206104, 'psi': 0.7131156751667866}
[S7] START round=12 head_norm_before_train=1.017688 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.215037 metrics={'f1_val': 0.4832669184921618, 'auprc': 0.7890198242229735, 'loss_val': 0.8605170485361282, 'psi': 0.6055680807844864}-{'f1_val': 0.41703542715461484, 'auprc': 0.7910341350978589, 'loss_val': 0.8992454241719475, 'psi': 0.5666349103319124}
[S8] START round=12 head_norm_before_train=0.976259 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.924142 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9969799529490877, 'loss_val': 0.2822582378458741, 'psi': 0.9965138432197268}-{'f1_val': 0.7140186993020905, 'auprc': 0.9906843461725632, 'loss_val': 0.4185482265780325, 'psi': 0.8246849580502795}
[S9] START round=12 head_norm_before_train=1.629252 (no previous merge yet)
[S9] round=12 local utility u=0.359130 metrics={'f1_val': 0.8148181907057095, 'auprc': 0.9984401581850479, 'loss_val': 0.1763905966518203, 'psi': 0.8882669776974449}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981901974436473, 'loss_val': 0.21229176056531443, 'psi': 0.8200060274414701}
[S10] START round=12 head_norm_before_train=1.226386 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.041621 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9938324966699225, 'loss_val': 0.22044818138457467, 'psi': 0.9948987907769808}-{'f1_val': 0.9947781979029806, 'auprc': 0.9911229641321735, 'loss_val': 0.29057237327098473, 'psi': 0.9933161043946577}
[S11] START round=12 head_norm_before_train=1.244561 cos_to_last_merge=0.8672 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.867
[S11] round=12 local utility u=0.038941 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9979536063257551, 'loss_val': 0.35403365908722, 'psi': 0.8203426325092942}-{'f1_val': 0.7019353166316534, 'auprc': 0.9977864447175939, 'loss_val': 0.431414532397395, 'psi': 0.8202757678660296}
[S13] START round=12 head_norm_before_train=1.468345 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.5846399627404595, 'auprc': 0.6423449856789885, 'loss_val': 0.6956262269908379, 'psi': 0.6077219719158711}-{'f1_val': 0.6132314134049761, 'auprc': 0.6616032496895494, 'loss_val': 0.639507208965976, 'psi': 0.6325801479188055}
[S14] START round=12 head_norm_before_train=1.571035 cos_to_last_merge=0.9985 (last merge round=10)
[S14] round=12 local utility u=0.064870 metrics={'f1_val': 0.7010081335770806, 'auprc': 0.9930315470553304, 'loss_val': 0.4162555498755227, 'psi': 0.8178174989683805}-{'f1_val': 0.7003499143523644, 'auprc': 0.992594695387675, 'loss_val': 0.5407349663859384, 'psi': 0.8172478267664887}
[S15] START round=12 head_norm_before_train=1.789519 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.691025800215684, 'auprc': 0.8501735389113431, 'loss_val': 0.47847909323443083, 'psi': 0.7546848956939476}-{'f1_val': 0.6990496044962369, 'auprc': 0.8337074218878147, 'loss_val': 0.4450962764186555, 'psi': 0.7529127314528681}
[S16] START round=12 head_norm_before_train=0.826021 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.4421723573278846, 'auprc': 0.737152079848219, 'loss_val': 0.9637287656605065, 'psi': 0.5601642463360184}-{'f1_val': 0.5431253686912437, 'auprc': 0.7469546112368728, 'loss_val': 0.9689812632655962, 'psi': 0.6246570657094954}
[S17] START round=12 head_norm_before_train=1.660577 (no previous merge yet)
[S17] round=12 local utility u=0.104864 metrics={'f1_val': 0.5789287364026232, 'auprc': 0.7797774383928084, 'loss_val': 0.7226119619842168, 'psi': 0.6592682171986973}-{'f1_val': 0.5466857508385657, 'auprc': 0.7389789902403517, 'loss_val': 0.6164875491843418, 'psi': 0.6236030465992801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:38403
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:38411
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[S8] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.060679)
[S16] loaded HEAD from S8 (vec_in norm=1.060679)
[S16] cosine check vs S8: cos=0.9259
[S16] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.603682)
[S13] loaded HEAD from S14 (vec_in norm=1.603682)
[S13] cosine check vs S14: cos=0.9801
[S13] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.294598)
[S10] loaded HEAD from S11 (vec_in norm=1.294598)
[S10] cosine check vs S11: cos=0.9790
[S10] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.556060)
[S8] loaded HEAD from S4 (vec_in norm=1.556060)
[S8] cosine check vs S4: cos=-0.1974
[S8] DROPPED delta from S4 (cos=-0.1974 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.044662)
[S8] loaded HEAD from S7 (vec_in norm=1.044662)
[S8] cosine check vs S7: cos=0.8813
[S8] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.732267)
[S7] loaded HEAD from S6 (vec_in norm=1.732267)
[S7] cosine check vs S6: cos=0.3169
[S7] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.303645)
[S7] loaded HEAD from S10 (vec_in norm=1.303645)
[S7] cosine check vs S10: cos=0.8967
[S7] BUFFERED delta from S10 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.528911)
[S5] loaded HEAD from S2 (vec_in norm=1.528911)
[S5] cosine check vs S2: cos=-0.0845
[S5] DROPPED delta from S2 (cos=-0.0845 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1805) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.668583)
[S3] loaded HEAD from S9 (vec_in norm=1.668583)
[S3] cosine check vs S9: cos=0.9927
[S3] BUFFERED delta from S9 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.711146)
[S14] loaded HEAD from S17 (vec_in norm=1.711146)
[S14] cosine check vs S17: cos=0.9752
[S14] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.5846 head_norm=1.516901
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.614724e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.5844 head_norm=1.552520 delta_norm=0.161472
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.4499 head_norm=1.616929
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.024994e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.4535 head_norm=1.639759 delta_norm=0.102499
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.9956 head_norm=1.303645
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.330537e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.9956 head_norm=1.292298 delta_norm=0.133054
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.9962 head_norm=1.060679
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.565703e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.9962 head_norm=1.020956 delta_norm=0.256570
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.7010 head_norm=1.603682
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.922455e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.7010 head_norm=1.647103 delta_norm=0.192246
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.4833 head_norm=1.044662
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.571751e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.4169 head_norm=1.012354 delta_norm=0.357175
[S7] aggregate: ROLLBACK (f1_val pre=0.483 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.4422 head_norm=0.867616
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.083883e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4333 head_norm=0.946294 delta_norm=0.208388
[S16] aggregate: ROLLBACK (f1_val pre=0.442 post=0.433 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.528911 cos_to_last_merge=0.8646 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.865
[S2] round=13 local utility u=0.193703 metrics={'f1_val': 0.7513255299842652, 'auprc': 0.7636699955606381, 'loss_val': 0.3792976944798491, 'psi': 0.7562633162148142}-{'f1_val': 0.7014918162305126, 'auprc': 0.7141630727730737, 'loss_val': 0.3191802711105496, 'psi': 0.706560318847537}
[S3] START round=13 head_norm_before_train=1.639759 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.843741 metrics={'f1_val': 0.5962555682558184, 'auprc': 0.9939059725037591, 'loss_val': 0.5868842965906359, 'psi': 0.7553157299549946}-{'f1_val': 0.44994374304626317, 'auprc': 0.8057677843254645, 'loss_val': 0.8320812267993491, 'psi': 0.5922733595579437}
[S4] START round=13 head_norm_before_train=1.556060 cos_to_last_merge=0.8261 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.826
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.9523449915125606, 'auprc': 0.967373797009682, 'loss_val': 0.22910643328427305, 'psi': 0.9583565137114092}-{'f1_val': 0.9554697318760369, 'auprc': 0.9730493764604115, 'loss_val': 0.23288303270091668, 'psi': 0.9625015897097867}
[S5] START round=13 head_norm_before_train=1.445211 (no previous merge yet)
[S5] round=13 local utility u=0.115926 metrics={'f1_val': 0.43729965937461046, 'auprc': 0.8650262659731056, 'loss_val': 0.6086599993458409, 'psi': 0.6083903020140085}-{'f1_val': 0.41758505646266003, 'auprc': 0.8591648653815505, 'loss_val': 0.7046405690595492, 'psi': 0.5942169800302162}
[S6] START round=13 head_norm_before_train=1.732267 (no previous merge yet)
[S6] round=13 local utility u=0.585581 metrics={'f1_val': 0.8247622065956011, 'auprc': 0.9634340637408473, 'loss_val': 0.3122152004263123, 'psi': 0.8802309494536995}-{'f1_val': 0.7359546909609953, 'auprc': 0.8148433236660914, 'loss_val': 0.5047599203080311, 'psi': 0.7675101440430337}
[S7] START round=13 head_norm_before_train=1.012354 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.600201 metrics={'f1_val': 0.6861380767195698, 'auprc': 0.7890120934243205, 'loss_val': 0.8773181930204619, 'psi': 0.7272876834014701}-{'f1_val': 0.4832669184921618, 'auprc': 0.7890198242229735, 'loss_val': 0.8605170485361282, 'psi': 0.6055680807844864}
[S8] START round=13 head_norm_before_train=1.020956 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.014881 metrics={'f1_val': 0.9960662206126181, 'auprc': 0.9958672153319592, 'loss_val': 0.24833595034906134, 'psi': 0.9959866185003545}-{'f1_val': 0.9962031034001528, 'auprc': 0.9969799529490877, 'loss_val': 0.2822582378458741, 'psi': 0.9965138432197268}
[S9] START round=13 head_norm_before_train=1.668583 (no previous merge yet)
[S9] round=13 local utility u=0.564402 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9982178555446201, 'loss_val': 0.12046449685346622, 'psi': 0.9955324472116731}-{'f1_val': 0.8148181907057095, 'auprc': 0.9984401581850479, 'loss_val': 0.1763905966518203, 'psi': 0.8882669776974449}
[S10] START round=13 head_norm_before_train=1.292298 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.039643 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9959967181513912, 'loss_val': 0.14765432448639862, 'psi': 0.9957644793695684}-{'f1_val': 0.9956096535150197, 'auprc': 0.9938324966699225, 'loss_val': 0.22044818138457467, 'psi': 0.9948987907769808}
[S11] START round=13 head_norm_before_train=1.294598 cos_to_last_merge=0.8535 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.853
[S11] round=13 local utility u=0.296326 metrics={'f1_val': 0.7884801627519138, 'auprc': 0.9980945053295296, 'loss_val': 0.28107436450842355, 'psi': 0.8723258997829602}-{'f1_val': 0.7019353166316534, 'auprc': 0.9979536063257551, 'loss_val': 0.35403365908722, 'psi': 0.8203426325092942}
[S13] START round=13 head_norm_before_train=1.552520 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.570571696880624, 'auprc': 0.6305301757658046, 'loss_val': 0.7469460880408492, 'psi': 0.5945550884346963}-{'f1_val': 0.5846399627404595, 'auprc': 0.6423449856789885, 'loss_val': 0.6956262269908379, 'psi': 0.6077219719158711}
[S14] START round=13 head_norm_before_train=1.647103 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.045318 metrics={'f1_val': 0.7018173705706284, 'auprc': 0.9984519989740938, 'loss_val': 0.34673548826041617, 'psi': 0.8204712219320145}-{'f1_val': 0.7010081335770806, 'auprc': 0.9930315470553304, 'loss_val': 0.4162555498755227, 'psi': 0.8178174989683805}
[S15] START round=13 head_norm_before_train=1.818003 (no previous merge yet)
[S15] round=13 local utility u=1.000000 metrics={'f1_val': 0.9253727151054073, 'auprc': 0.9713084744158864, 'loss_val': 0.15117682226713597, 'psi': 0.943747018829599}-{'f1_val': 0.691025800215684, 'auprc': 0.8501735389113431, 'loss_val': 0.47847909323443083, 'psi': 0.7546848956939476}
[S16] START round=13 head_norm_before_train=0.946294 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.142612 metrics={'f1_val': 0.47412000487849754, 'auprc': 0.7553080200802949, 'loss_val': 0.9246575554225561, 'psi': 0.5865952109592165}-{'f1_val': 0.4421723573278846, 'auprc': 0.737152079848219, 'loss_val': 0.9637287656605065, 'psi': 0.5601642463360184}
[S17] START round=13 head_norm_before_train=1.711146 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.466019862620632, 'auprc': 0.6774204909075443, 'loss_val': 0.9221989815015906, 'psi': 0.550580113935397}-{'f1_val': 0.5789287364026232, 'auprc': 0.7797774383928084, 'loss_val': 0.7226119619842168, 'psi': 0.6592682171986973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:38403
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:38411
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38416
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.679686)
[S13] loaded HEAD from S14 (vec_in norm=1.679686)
[S13] cosine check vs S14: cos=0.9817
[S13] BUFFERED delta from S14 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.108765)
[S16] loaded HEAD from S8 (vec_in norm=1.108765)
[S16] cosine check vs S8: cos=0.9620
[S16] BUFFERED delta from S8 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1804) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.340473)
[S10] loaded HEAD from S11 (vec_in norm=1.340473)
[S10] cosine check vs S11: cos=0.9760
[S10] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1795) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.040662)
[S8] loaded HEAD from S7 (vec_in norm=1.040662)
[S8] cosine check vs S7: cos=0.9133
[S8] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.395124)
[S7] loaded HEAD from S10 (vec_in norm=1.395124)
[S7] cosine check vs S10: cos=0.7894
[S7] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.849315)
[S7] loaded HEAD from S15 (vec_in norm=1.849315)
[S7] cosine check vs S15: cos=0.5304
[S7] BUFFERED delta from S15 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1803) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.758486)
[S7] loaded HEAD from S6 (vec_in norm=1.758486)
[S7] cosine check vs S6: cos=0.5966
[S7] BUFFERED delta from S6 (total buffered=3)
[S6] RECEIVED delta(kind=head bytes=1803) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.668567)
[S6] loaded HEAD from S3 (vec_in norm=1.668567)
[S6] cosine check vs S3: cos=-0.1333
[S6] DROPPED delta from S3 (cos=-0.1333 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.552785)
[S5] loaded HEAD from S2 (vec_in norm=1.552785)
[S5] cosine check vs S2: cos=-0.0870
[S5] DROPPED delta from S2 (cos=-0.0870 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.982994)
[S4] loaded HEAD from S16 (vec_in norm=0.982994)
[S4] cosine check vs S16: cos=-0.2392
[S4] DROPPED delta from S16 (cos=-0.2392 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.704487)
[S3] loaded HEAD from S9 (vec_in norm=1.704487)
[S3] cosine check vs S9: cos=0.9941
[S3] BUFFERED delta from S9 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.475405)
[S3] loaded HEAD from S5 (vec_in norm=1.475405)
[S3] cosine check vs S5: cos=-0.0160
[S3] DROPPED delta from S5 (cos=-0.0160 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.5706 head_norm=1.597984
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.617833e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.5719 head_norm=1.631342 delta_norm=0.161783
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.9956 head_norm=1.395124
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.523823e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.9956 head_norm=1.359558 delta_norm=0.152382
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.9961 head_norm=1.108765
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.262708e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.9961 head_norm=1.051176 delta_norm=0.226271
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.4741 head_norm=0.982994
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.570102e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.4730 head_norm=1.035937 delta_norm=0.157010
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.5963 head_norm=1.668567
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.368041e-02
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.6044 head_norm=1.684019 delta_norm=0.093680
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.6861 head_norm=1.040662
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.223835e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.6830 head_norm=1.070716 delta_norm=0.222384
[S7] aggregate: ACCEPT kept=['S10', 'S15', 'S6'] (k=3/3) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.552785 cos_to_last_merge=0.8622 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.862
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.6820559091210608, 'auprc': 0.731400696142701, 'loss_val': 0.718290690031676, 'psi': 0.7017938239297169}-{'f1_val': 0.7513255299842652, 'auprc': 0.7636699955606381, 'loss_val': 0.3792976944798491, 'psi': 0.7562633162148142}
[S3] START round=14 head_norm_before_train=1.684019 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.365311 metrics={'f1_val': 0.6899361217114872, 'auprc': 0.9997951260434469, 'loss_val': 0.4360124751714165, 'psi': 0.8138797234442711}-{'f1_val': 0.5962555682558184, 'auprc': 0.9939059725037591, 'loss_val': 0.5868842965906359, 'psi': 0.7553157299549946}
[S4] START round=14 head_norm_before_train=1.578308 cos_to_last_merge=0.8237 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.824
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.9468766393168293, 'auprc': 0.9495243023000574, 'loss_val': 0.25342005557338615, 'psi': 0.9479357045101205}-{'f1_val': 0.9523449915125606, 'auprc': 0.967373797009682, 'loss_val': 0.22910643328427305, 'psi': 0.9583565137114092}
[S5] START round=14 head_norm_before_train=1.475405 (no previous merge yet)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.4372504082391554, 'auprc': 0.8642344784924402, 'loss_val': 0.6206226559638652, 'psi': 0.6080440363404693}-{'f1_val': 0.43729965937461046, 'auprc': 0.8650262659731056, 'loss_val': 0.6086599993458409, 'psi': 0.6083903020140085}
[S6] START round=14 head_norm_before_train=1.758486 (no previous merge yet)
[S6] round=14 local utility u=0.144386 metrics={'f1_val': 0.8488544412208994, 'auprc': 0.97605254578706, 'loss_val': 0.20585273180211963, 'psi': 0.8997336830473636}-{'f1_val': 0.8247622065956011, 'auprc': 0.9634340637408473, 'loss_val': 0.3122152004263123, 'psi': 0.8802309494536995}
[S7] START round=14 head_norm_before_train=1.070716 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.6697572737335069, 'auprc': 0.7891476571322542, 'loss_val': 0.7819514585595164, 'psi': 0.7175134270930058}-{'f1_val': 0.6861380767195698, 'auprc': 0.7890120934243205, 'loss_val': 0.8773181930204619, 'psi': 0.7272876834014701}
[S8] START round=14 head_norm_before_train=1.051176 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.002738 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9945013061397152, 'loss_val': 0.23958297775908582, 'psi': 0.9955223844959777}-{'f1_val': 0.9960662206126181, 'auprc': 0.9958672153319592, 'loss_val': 0.24833595034906134, 'psi': 0.9959866185003545}
[S9] START round=14 head_norm_before_train=1.704487 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.918681035873368, 'auprc': 0.9984939597777938, 'loss_val': 0.12765836986675883, 'psi': 0.9506062054351383}-{'f1_val': 0.9937421749897083, 'auprc': 0.9982178555446201, 'loss_val': 0.12046449685346622, 'psi': 0.9955324472116731}
[S10] START round=14 head_norm_before_train=1.359558 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.015428 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9959300741037403, 'loss_val': 0.1165986251138371, 'psi': 0.995737821750508}-{'f1_val': 0.9956096535150197, 'auprc': 0.9959967181513912, 'loss_val': 0.14765432448639862, 'psi': 0.9957644793695684}
[S11] START round=14 head_norm_before_train=1.340473 cos_to_last_merge=0.8425 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.842
[S11] round=14 local utility u=0.521153 metrics={'f1_val': 0.9547246252056056, 'auprc': 0.9980693683479362, 'loss_val': 0.23616029770003494, 'psi': 0.9720625224625379}-{'f1_val': 0.7884801627519138, 'auprc': 0.9980945053295296, 'loss_val': 0.28107436450842355, 'psi': 0.8723258997829602}
[S13] START round=14 head_norm_before_train=1.631342 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.258701 metrics={'f1_val': 0.6184215551673421, 'auprc': 0.6585674044519261, 'loss_val': 0.6007541763085196, 'psi': 0.6344798948811757}-{'f1_val': 0.570571696880624, 'auprc': 0.6305301757658046, 'loss_val': 0.7469460880408492, 'psi': 0.5945550884346963}
[S14] START round=14 head_norm_before_train=1.679686 cos_to_last_merge=0.9990 (last merge round=12)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.7002405945881325, 'auprc': 0.9885836430270956, 'loss_val': 0.36157906583302935, 'psi': 0.8155778139637178}-{'f1_val': 0.7018173705706284, 'auprc': 0.9984519989740938, 'loss_val': 0.34673548826041617, 'psi': 0.8204712219320145}
[S15] START round=14 head_norm_before_train=1.849315 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.7708162966197251, 'auprc': 0.9705449381202345, 'loss_val': 0.3692519494705435, 'psi': 0.8507077532199288}-{'f1_val': 0.9253727151054073, 'auprc': 0.9713084744158864, 'loss_val': 0.15117682226713597, 'psi': 0.943747018829599}
[S16] START round=14 head_norm_before_train=1.035937 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.381688 metrics={'f1_val': 0.5676086390212289, 'auprc': 0.8002073832798399, 'loss_val': 0.8569121951997014, 'psi': 0.6606481367246733}-{'f1_val': 0.47412000487849754, 'auprc': 0.7553080200802949, 'loss_val': 0.9246575554225561, 'psi': 0.5865952109592165}
[S17] START round=14 head_norm_before_train=1.763318 (no previous merge yet)
[S17] round=14 local utility u=0.468807 metrics={'f1_val': 0.5503950111977938, 'auprc': 0.7853845960425515, 'loss_val': 0.8147275035121517, 'psi': 0.6443908451356968}-{'f1_val': 0.466019862620632, 'auprc': 0.6774204909075443, 'loss_val': 0.9221989815015906, 'psi': 0.550580113935397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38416
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:38407
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:38411
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1803) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.385738)
[S10] loaded HEAD from S11 (vec_in norm=1.385738)
[S10] cosine check vs S11: cos=0.9784
[S10] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.777793)
[S7] loaded HEAD from S6 (vec_in norm=1.777793)
[S7] cosine check vs S6: cos=0.4667
[S7] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.454165)
[S7] loaded HEAD from S10 (vec_in norm=1.454165)
[S7] cosine check vs S10: cos=0.8266
[S7] BUFFERED delta from S10 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1806) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.712879)
[S6] loaded HEAD from S3 (vec_in norm=1.712879)
[S6] cosine check vs S3: cos=-0.1352
[S6] DROPPED delta from S3 (cos=-0.1352 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.072629)
[S4] loaded HEAD from S16 (vec_in norm=1.072629)
[S4] cosine check vs S16: cos=-0.2420
[S4] DROPPED delta from S16 (cos=-0.2420 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.128140)
[S16] loaded HEAD from S8 (vec_in norm=1.128140)
[S16] cosine check vs S8: cos=0.9700
[S16] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.669632)
[S16] loaded HEAD from S13 (vec_in norm=1.669632)
[S16] cosine check vs S13: cos=0.0151
[S16] BUFFERED delta from S13 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.808371)
[S14] loaded HEAD from S17 (vec_in norm=1.808371)
[S14] cosine check vs S17: cos=0.9794
[S14] BUFFERED delta from S17 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.7002 head_norm=1.709910
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.849765e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.7002 head_norm=1.750081 delta_norm=0.184976
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.6698 head_norm=1.100686
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.911580e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.6813 head_norm=1.096764 delta_norm=0.291158
[S7] aggregate: ACCEPT kept=['S6', 'S10'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.5676 head_norm=1.072629
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.922742e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.5611 head_norm=0.917979 delta_norm=0.492274
[S16] aggregate: ROLLBACK (f1_val pre=0.568 post=0.561 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.9956 head_norm=1.454165
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.513886e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.9954 head_norm=1.412273 delta_norm=0.151389
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.576260 cos_to_last_merge=0.8605 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.860
[S2] round=15 local utility u=0.725007 metrics={'f1_val': 0.8144685311891179, 'auprc': 0.8097670064732996, 'loss_val': 0.29785075452904125, 'psi': 0.8125879213027906}-{'f1_val': 0.6820559091210608, 'auprc': 0.731400696142701, 'loss_val': 0.718290690031676, 'psi': 0.7017938239297169}
[S3] START round=15 head_norm_before_train=1.712879 cos_to_last_merge=0.9992 (last merge round=13)
[S3] round=15 local utility u=0.089986 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9996207438958938, 'loss_val': 0.32089051211408043, 'psi': 0.820347338573644}-{'f1_val': 0.6899361217114872, 'auprc': 0.9997951260434469, 'loss_val': 0.4360124751714165, 'psi': 0.8138797234442711}
[S4] START round=15 head_norm_before_train=1.603049 cos_to_last_merge=0.8218 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.822
[S4] round=15 local utility u=0.005454 metrics={'f1_val': 0.9476191935646532, 'auprc': 0.9485493863758825, 'loss_val': 0.24404345639611788, 'psi': 0.9479912706891449}-{'f1_val': 0.9468766393168293, 'auprc': 0.9495243023000574, 'loss_val': 0.25342005557338615, 'psi': 0.9479357045101205}
[S5] START round=15 head_norm_before_train=1.505093 (no previous merge yet)
[S5] round=15 local utility u=0.881104 metrics={'f1_val': 0.7005699347162762, 'auprc': 0.8618163926131086, 'loss_val': 0.4310766412561335, 'psi': 0.7650685178750092}-{'f1_val': 0.4372504082391554, 'auprc': 0.8642344784924402, 'loss_val': 0.6206226559638652, 'psi': 0.6080440363404693}
[S6] START round=15 head_norm_before_train=1.777793 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.41697448575925256, 'auprc': 0.7286176201861725, 'loss_val': 1.5659946428240248, 'psi': 0.5416317395300205}-{'f1_val': 0.8488544412208994, 'auprc': 0.97605254578706, 'loss_val': 0.20585273180211963, 'psi': 0.8997336830473636}
[S7] START round=15 head_norm_before_train=1.096764 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.115929 metrics={'f1_val': 0.6894516764570611, 'auprc': 0.791766169567947, 'loss_val': 0.6761151080835381, 'psi': 0.7303774737014155}-{'f1_val': 0.6697572737335069, 'auprc': 0.7891476571322542, 'loss_val': 0.7819514585595164, 'psi': 0.7175134270930058}
[S8] START round=15 head_norm_before_train=1.128140 cos_to_last_merge=0.9941 (last merge round=13)
[S8] round=15 local utility u=0.044770 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9953348725292637, 'loss_val': 0.15254341219331444, 'psi': 0.9958558110517972}-{'f1_val': 0.9962031034001528, 'auprc': 0.9945013061397152, 'loss_val': 0.23958297775908582, 'psi': 0.9955223844959777}
[S9] START round=15 head_norm_before_train=1.734455 (no previous merge yet)
[S9] round=15 local utility u=0.236959 metrics={'f1_val': 0.9895217784513768, 'auprc': 0.9984798402041553, 'loss_val': 0.07874332517824749, 'psi': 0.9931050031524882}-{'f1_val': 0.918681035873368, 'auprc': 0.9984939597777938, 'loss_val': 0.12765836986675883, 'psi': 0.9506062054351383}
[S10] START round=15 head_norm_before_train=1.412273 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.003101 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.993631076554269, 'loss_val': 0.10096899280606457, 'psi': 0.9945651340333324}-{'f1_val': 0.9956096535150197, 'auprc': 0.9959300741037403, 'loss_val': 0.1165986251138371, 'psi': 0.995737821750508}
[S11] START round=15 head_norm_before_train=1.385738 cos_to_last_merge=0.8340 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.834
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.9312464814995471, 'auprc': 0.9979658606619893, 'loss_val': 0.2338827579449575, 'psi': 0.957934233164524}-{'f1_val': 0.9547246252056056, 'auprc': 0.9980693683479362, 'loss_val': 0.23616029770003494, 'psi': 0.9720625224625379}
[S13] START round=15 head_norm_before_train=1.669632 cos_to_last_merge=0.9985 (last merge round=13)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6080433223449477, 'auprc': 0.6895501957654341, 'loss_val': 0.6653400410401465, 'psi': 0.6406460717131424}-{'f1_val': 0.6184215551673421, 'auprc': 0.6585674044519261, 'loss_val': 0.6007541763085196, 'psi': 0.6344798948811757}
[S14] START round=15 head_norm_before_train=1.750081 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.916410 metrics={'f1_val': 0.9979303781545898, 'auprc': 0.9942964781472645, 'loss_val': 0.33203725705237785, 'psi': 0.9964768181516598}-{'f1_val': 0.7002405945881325, 'auprc': 0.9885836430270956, 'loss_val': 0.36157906583302935, 'psi': 0.8155778139637178}
[S15] START round=15 head_norm_before_train=1.880290 (no previous merge yet)
[S15] round=15 local utility u=0.835187 metrics={'f1_val': 0.9880919698354318, 'auprc': 0.9952337365628132, 'loss_val': 0.07659804543413881, 'psi': 0.9909486765263844}-{'f1_val': 0.7708162966197251, 'auprc': 0.9705449381202345, 'loss_val': 0.3692519494705435, 'psi': 0.8507077532199288}
[S16] START round=15 head_norm_before_train=0.917979 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.515212559861, 'auprc': 0.8344541995972169, 'loss_val': 0.789554962832156, 'psi': 0.6429092157554868}-{'f1_val': 0.5676086390212289, 'auprc': 0.8002073832798399, 'loss_val': 0.8569121951997014, 'psi': 0.6606481367246733}
[S17] START round=15 head_norm_before_train=1.808371 (no previous merge yet)
[S17] round=15 local utility u=0.091804 metrics={'f1_val': 0.5707710041791525, 'auprc': 0.8239525598704773, 'loss_val': 0.8690787228928252, 'psi': 0.6720436264556824}-{'f1_val': 0.5503950111977938, 'auprc': 0.7853845960425515, 'loss_val': 0.8147275035121517, 'psi': 0.6443908451356968}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:38407
[S14] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1805) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.776386)
[S13] loaded HEAD from S14 (vec_in norm=1.776386)
[S13] cosine check vs S14: cos=0.9797
[S13] BUFFERED delta from S14 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.216514)
[S16] loaded HEAD from S8 (vec_in norm=1.216514)
[S16] cosine check vs S8: cos=0.8741
[S16] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.629441)
[S8] loaded HEAD from S4 (vec_in norm=1.629441)
[S8] cosine check vs S4: cos=-0.2336
[S8] DROPPED delta from S4 (cos=-0.2336 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.123976)
[S8] loaded HEAD from S7 (vec_in norm=1.123976)
[S8] cosine check vs S7: cos=0.9182
[S8] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.495290)
[S7] loaded HEAD from S10 (vec_in norm=1.495290)
[S7] cosine check vs S10: cos=0.7543
[S7] BUFFERED delta from S10 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.534384)
[S3] loaded HEAD from S5 (vec_in norm=1.534384)
[S3] cosine check vs S5: cos=-0.0171
[S3] DROPPED delta from S5 (cos=-0.0171 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.909445)
[S7] loaded HEAD from S15 (vec_in norm=1.909445)
[S7] cosine check vs S15: cos=0.5055
[S7] BUFFERED delta from S15 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1802) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.741457)
[S6] loaded HEAD from S3 (vec_in norm=1.741457)
[S6] cosine check vs S3: cos=-0.1382
[S6] DROPPED delta from S3 (cos=-0.1382 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.597069)
[S5] loaded HEAD from S2 (vec_in norm=1.597069)
[S5] cosine check vs S2: cos=-0.0931
[S5] DROPPED delta from S2 (cos=-0.0931 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1804) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.761983)
[S3] loaded HEAD from S9 (vec_in norm=1.761983)
[S3] cosine check vs S9: cos=0.9902
[S3] BUFFERED delta from S9 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.853249)
[S14] loaded HEAD from S17 (vec_in norm=1.853249)
[S14] cosine check vs S17: cos=0.9905
[S14] BUFFERED delta from S17 (total buffered=1)
[S6] ⇄ pheromone p=0.269 → S7@127.0.0.1:38408
[S11] ⇄ pheromone p=0.289 → S10@127.0.0.1:38411
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6080 head_norm=1.699456
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.793350e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6093 head_norm=1.729071 delta_norm=0.179335
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.139 → S16@127.0.0.1:38416
[S15] ⇄ pheromone p=0.439 → S7@127.0.0.1:38408
[S4] ⇄ pheromone p=0.143 → S8@127.0.0.1:38409
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9962 head_norm=1.216514
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.410295e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.9962 head_norm=1.146088 delta_norm=0.241030
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.211 → S16@127.0.0.1:38416
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.6895 head_norm=1.123976
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.149832e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.6820 head_norm=1.200654 delta_norm=0.514983
[S7] aggregate: ROLLBACK (f1_val pre=0.689 post=0.682 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.221 → S8@127.0.0.1:38409
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9979 head_norm=1.776386
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.309265e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.7017 head_norm=1.810496 delta_norm=0.130926
[S14] aggregate: ROLLBACK (f1_val pre=0.998 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.335 → S13@127.0.0.1:38413
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.7008 head_norm=1.741457
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.230745e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.7008 head_norm=1.747421 delta_norm=0.123075
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.309 → S6@127.0.0.1:38407
[S10] ⇄ pheromone p=0.141 → S7@127.0.0.1:38408
[S2] ⇄ pheromone p=0.314 → S5@127.0.0.1:38405
[S9] ⇄ pheromone p=0.272 → S3@127.0.0.1:38403
[S5] ⇄ pheromone p=0.284 → S3@127.0.0.1:38403
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.5152 head_norm=0.959130
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.000605e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.5095 head_norm=1.053509 delta_norm=0.300060
[S16] aggregate: ROLLBACK (f1_val pre=0.515 post=0.510 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.199 → S4@127.0.0.1:38404
[S17] ⇄ pheromone p=0.204 → S14@127.0.0.1:38414
[S2] START round=16 head_norm_before_train=1.597069 cos_to_last_merge=0.8588 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.859
[S2] round=16 local utility u=0.033325 metrics={'f1_val': 0.8257574807180053, 'auprc': 0.8170990392060239, 'loss_val': 0.32093012197776427, 'psi': 0.8222941041132128}-{'f1_val': 0.8144685311891179, 'auprc': 0.8097670064732996, 'loss_val': 0.29785075452904125, 'psi': 0.8125879213027906}
[S3] START round=16 head_norm_before_train=1.747421 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.011304 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9996237805680428, 'loss_val': 0.297839109005213, 'psi': 0.8203032344683969}-{'f1_val': 0.7008317350254774, 'auprc': 0.9996207438958938, 'loss_val': 0.32089051211408043, 'psi': 0.820347338573644}
[S4] START round=16 head_norm_before_train=1.629441 cos_to_last_merge=0.8209 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.821
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9439948845004138, 'auprc': 0.9533114663036327, 'loss_val': 0.25323296483421187, 'psi': 0.9477215172217013}-{'f1_val': 0.9476191935646532, 'auprc': 0.9485493863758825, 'loss_val': 0.24404345639611788, 'psi': 0.9479912706891449}
[S5] START round=16 head_norm_before_train=1.534384 (no previous merge yet)
[S5] round=16 local utility u=0.007250 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.8492565979418488, 'loss_val': 0.3791325240699974, 'psi': 0.7600680955802079}-{'f1_val': 0.7005699347162762, 'auprc': 0.8618163926131086, 'loss_val': 0.4310766412561335, 'psi': 0.7650685178750092}
[S6] START round=16 head_norm_before_train=1.796956 (no previous merge yet)
[S6] round=16 local utility u=1.000000 metrics={'f1_val': 0.914508462643443, 'auprc': 0.9673300417432258, 'loss_val': 0.17608786568305984, 'psi': 0.9356370942833561}-{'f1_val': 0.41697448575925256, 'auprc': 0.7286176201861725, 'loss_val': 1.5659946428240248, 'psi': 0.5416317395300205}
[S7] START round=16 head_norm_before_train=1.200654 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.6127583448604375, 'auprc': 0.7884176198925998, 'loss_val': 0.7351694019192911, 'psi': 0.6830220548733024}-{'f1_val': 0.6894516764570611, 'auprc': 0.791766169567947, 'loss_val': 0.6761151080835381, 'psi': 0.7303774737014155}
[S8] START round=16 head_norm_before_train=1.146088 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9973228182935565, 'loss_val': 0.15880427857607843, 'psi': 0.9966509893575144}-{'f1_val': 0.9962031034001528, 'auprc': 0.9953348725292637, 'loss_val': 0.15254341219331444, 'psi': 0.9958558110517972}
[S9] START round=16 head_norm_before_train=1.761983 (no previous merge yet)
[S9] round=16 local utility u=0.017903 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9984741331575568, 'loss_val': 0.05818219491756817, 'psi': 0.9946288453910588}-{'f1_val': 0.9895217784513768, 'auprc': 0.9984798402041553, 'loss_val': 0.07874332517824749, 'psi': 0.9931050031524882}
[S10] START round=16 head_norm_before_train=1.495290 cos_to_last_merge=0.9969 (last merge round=14)
[S10] round=16 local utility u=0.012317 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9916513107597277, 'loss_val': 0.07039603209374742, 'psi': 0.9937732277155159}-{'f1_val': 0.9951878390193748, 'auprc': 0.993631076554269, 'loss_val': 0.10096899280606457, 'psi': 0.9945651340333324}
[S11] START round=16 head_norm_before_train=1.427619 cos_to_last_merge=0.8280 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.828
[S11] round=16 local utility u=0.117880 metrics={'f1_val': 0.959446266417366, 'auprc': 0.9980089961853131, 'loss_val': 0.16745041891812343, 'psi': 0.9748713583245447}-{'f1_val': 0.9312464814995471, 'auprc': 0.9979658606619893, 'loss_val': 0.2338827579449575, 'psi': 0.957934233164524}
[S13] START round=16 head_norm_before_train=1.729071 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.602958904980532, 'auprc': 0.6737242192438041, 'loss_val': 0.696132261278918, 'psi': 0.6312650306858407}-{'f1_val': 0.6080433223449477, 'auprc': 0.6895501957654341, 'loss_val': 0.6653400410401465, 'psi': 0.6406460717131424}
[S14] START round=16 head_norm_before_train=1.810496 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.034132 metrics={'f1_val': 0.997736520409153, 'auprc': 0.9970421245432229, 'loss_val': 0.27084731709706533, 'psi': 0.9974587620627811}-{'f1_val': 0.9979303781545898, 'auprc': 0.9942964781472645, 'loss_val': 0.33203725705237785, 'psi': 0.9964768181516598}
[S15] START round=16 head_norm_before_train=1.909445 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.7073658115776129, 'auprc': 0.9114184294507685, 'loss_val': 0.4724096017998035, 'psi': 0.7889868587268751}-{'f1_val': 0.9880919698354318, 'auprc': 0.9952337365628132, 'loss_val': 0.07659804543413881, 'psi': 0.9909486765263844}
[S16] START round=16 head_norm_before_train=1.053509 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.999508 metrics={'f1_val': 0.805836236767465, 'auprc': 0.8946995711415348, 'loss_val': 0.7150168743388703, 'psi': 0.8413815705170928}-{'f1_val': 0.515212559861, 'auprc': 0.8344541995972169, 'loss_val': 0.789554962832156, 'psi': 0.6429092157554868}
[S17] START round=16 head_norm_before_train=1.853249 (no previous merge yet)
[S17] round=16 local utility u=0.273119 metrics={'f1_val': 0.5964531899481764, 'auprc': 0.939891011397985, 'loss_val': 0.8247497753074324, 'psi': 0.7338283185280998}-{'f1_val': 0.5707710041791525, 'auprc': 0.8239525598704773, 'loss_val': 0.8690787228928252, 'psi': 0.6720436264556824}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:38407
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38408
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[S6] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.834415)
[S13] loaded HEAD from S14 (vec_in norm=1.834415)
[S13] cosine check vs S14: cos=0.9892
[S13] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.094897)
[S4] loaded HEAD from S16 (vec_in norm=1.094897)
[S4] cosine check vs S16: cos=-0.2563
[S4] DROPPED delta from S16 (cos=-0.2563 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.465976)
[S10] loaded HEAD from S11 (vec_in norm=1.465976)
[S10] cosine check vs S11: cos=0.9716
[S10] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.570007)
[S7] loaded HEAD from S10 (vec_in norm=1.570007)
[S7] cosine check vs S10: cos=0.8465
[S7] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1804) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.803565)
[S7] loaded HEAD from S6 (vec_in norm=1.803565)
[S7] cosine check vs S6: cos=0.3152
[S7] BUFFERED delta from S6 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1805) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.772738)
[S6] loaded HEAD from S3 (vec_in norm=1.772738)
[S6] cosine check vs S3: cos=-0.1385
[S6] DROPPED delta from S3 (cos=-0.1385 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.565377)
[S3] loaded HEAD from S5 (vec_in norm=1.565377)
[S3] cosine check vs S5: cos=-0.0165
[S3] DROPPED delta from S5 (cos=-0.0165 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.625919)
[S5] loaded HEAD from S2 (vec_in norm=1.625919)
[S5] cosine check vs S2: cos=-0.0950
[S5] DROPPED delta from S2 (cos=-0.0950 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.788110)
[S3] loaded HEAD from S9 (vec_in norm=1.788110)
[S3] cosine check vs S9: cos=0.9945
[S3] BUFFERED delta from S9 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.884670)
[S14] loaded HEAD from S17 (vec_in norm=1.884670)
[S14] cosine check vs S17: cos=0.9951
[S14] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.6128 head_norm=1.222717
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.050399e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.6476 head_norm=1.150689 delta_norm=0.405040
[S7] aggregate: ACCEPT kept=['S10', 'S6'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6030 head_norm=1.748535
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.382230e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6045 head_norm=1.786651 delta_norm=0.138223
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.7008 head_norm=1.772738
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.386794e-02
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.7008 head_norm=1.777964 delta_norm=0.093868
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.9952 head_norm=1.570007
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.882425e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.9952 head_norm=1.507172 delta_norm=0.188242
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9977 head_norm=1.834415
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.580661e-02
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.7021 head_norm=1.857242 delta_norm=0.095807
[S14] aggregate: ROLLBACK (f1_val pre=0.998 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.625919 cos_to_last_merge=0.8572 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.857
[S2] round=17 local utility u=0.077130 metrics={'f1_val': 0.8557955469571764, 'auprc': 0.8324409179819177, 'loss_val': 0.39292356625585917, 'psi': 0.8464536953670729}-{'f1_val': 0.8257574807180053, 'auprc': 0.8170990392060239, 'loss_val': 0.32093012197776427, 'psi': 0.8222941041132128}
[S3] START round=17 head_norm_before_train=1.777964 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.012683 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9996230908115751, 'loss_val': 0.2724701794047354, 'psi': 0.8203029585658098}-{'f1_val': 0.7007562037352997, 'auprc': 0.9996237805680428, 'loss_val': 0.297839109005213, 'psi': 0.8203032344683969}
[S4] START round=17 head_norm_before_train=1.662259 cos_to_last_merge=0.8186 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.819
[S4] round=17 local utility u=0.036590 metrics={'f1_val': 0.9460229634202881, 'auprc': 0.9751701719586792, 'loss_val': 0.2577970138287834, 'psi': 0.9576818468356445}-{'f1_val': 0.9439948845004138, 'auprc': 0.9533114663036327, 'loss_val': 0.25323296483421187, 'psi': 0.9477215172217013}
[S5] START round=17 head_norm_before_train=1.565377 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7896953828472985, 'loss_val': 0.3486889439594001, 'psi': 0.736243188736524}-{'f1_val': 0.7006090940057808, 'auprc': 0.8492565979418488, 'loss_val': 0.3791325240699974, 'psi': 0.7600680955802079}
[S6] START round=17 head_norm_before_train=1.803565 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.6140785458445084, 'auprc': 0.8157223447798205, 'loss_val': 0.6342791357578978, 'psi': 0.6947360654186332}-{'f1_val': 0.914508462643443, 'auprc': 0.9673300417432258, 'loss_val': 0.17608786568305984, 'psi': 0.9356370942833561}
[S7] START round=17 head_norm_before_train=1.150689 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.41754733483868445, 'auprc': 0.7810206027781499, 'loss_val': 0.9051703252103936, 'psi': 0.5629366420144706}-{'f1_val': 0.6127583448604375, 'auprc': 0.7884176198925998, 'loss_val': 0.7351694019192911, 'psi': 0.6830220548733024}
[S8] START round=17 head_norm_before_train=1.234740 cos_to_last_merge=0.9954 (last merge round=15)
[S8] round=17 local utility u=0.026340 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9975777363461675, 'loss_val': 0.10688951458104977, 'psi': 0.9967529565785587}-{'f1_val': 0.9962031034001528, 'auprc': 0.9973228182935565, 'loss_val': 0.15880427857607843, 'psi': 0.9966509893575144}
[S9] START round=17 head_norm_before_train=1.788110 (no previous merge yet)
[S9] round=17 local utility u=0.008175 metrics={'f1_val': 0.9933237369199828, 'auprc': 0.9984686069835444, 'loss_val': 0.049365928201869164, 'psi': 0.9953816849454074}-{'f1_val': 0.9920653202133933, 'auprc': 0.9984741331575568, 'loss_val': 0.05818219491756817, 'psi': 0.9946288453910588}
[S10] START round=17 head_norm_before_train=1.507172 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.992026221099396, 'loss_val': 0.07665794496345145, 'psi': 0.9939231918513832}-{'f1_val': 0.9951878390193748, 'auprc': 0.9916513107597277, 'loss_val': 0.07039603209374742, 'psi': 0.9937732277155159}
[S11] START round=17 head_norm_before_train=1.465976 cos_to_last_merge=0.8236 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.824
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.9212326911058029, 'auprc': 0.9944127770693092, 'loss_val': 0.23215505936567485, 'psi': 0.9505047254912053}-{'f1_val': 0.959446266417366, 'auprc': 0.9980089961853131, 'loss_val': 0.16745041891812343, 'psi': 0.9748713583245447}
[S13] START round=17 head_norm_before_train=1.786651 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5674804442591501, 'auprc': 0.6763584890684672, 'loss_val': 0.7822515717216317, 'psi': 0.611031662182877}-{'f1_val': 0.602958904980532, 'auprc': 0.6737242192438041, 'loss_val': 0.696132261278918, 'psi': 0.6312650306858407}
[S14] START round=17 head_norm_before_train=1.857242 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.701467377271745, 'auprc': 0.9981571165247144, 'loss_val': 0.2053280739061888, 'psi': 0.8201432729729328}-{'f1_val': 0.997736520409153, 'auprc': 0.9970421245432229, 'loss_val': 0.27084731709706533, 'psi': 0.9974587620627811}
[S15] START round=17 head_norm_before_train=1.932267 (no previous merge yet)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6986544317778979, 'auprc': 0.8854102377719786, 'loss_val': 0.4882122794647001, 'psi': 0.7733567541755302}-{'f1_val': 0.7073658115776129, 'auprc': 0.9114184294507685, 'loss_val': 0.4724096017998035, 'psi': 0.7889868587268751}
[S16] START round=17 head_norm_before_train=1.094897 cos_to_last_merge=0.9973 (last merge round=15)
[S16] round=17 local utility u=0.630510 metrics={'f1_val': 0.9365816120124786, 'auprc': 0.9558443945291941, 'loss_val': 0.42190332686618026, 'psi': 0.9442867250191648}-{'f1_val': 0.805836236767465, 'auprc': 0.8946995711415348, 'loss_val': 0.7150168743388703, 'psi': 0.8413815705170928}
[S17] START round=17 head_norm_before_train=1.884670 (no previous merge yet)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.5859975938823074, 'auprc': 0.92347426898501, 'loss_val': 0.9179370034203559, 'psi': 0.7209882639233884}-{'f1_val': 0.5964531899481764, 'auprc': 0.939891011397985, 'loss_val': 0.8247497753074324, 'psi': 0.7338283185280998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:38407
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38405
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:38409
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.682897)
[S8] loaded HEAD from S4 (vec_in norm=1.682897)
[S8] cosine check vs S4: cos=-0.2360
[S8] DROPPED delta from S4 (cos=-0.2360 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.316426)
[S16] loaded HEAD from S8 (vec_in norm=1.316426)
[S16] cosine check vs S8: cos=0.9487
[S16] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.799966)
[S6] loaded HEAD from S3 (vec_in norm=1.799966)
[S6] cosine check vs S3: cos=-0.1380
[S6] DROPPED delta from S3 (cos=-0.1380 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.656106)
[S5] loaded HEAD from S2 (vec_in norm=1.656106)
[S5] cosine check vs S2: cos=-0.0959
[S5] DROPPED delta from S2 (cos=-0.0959 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.145408)
[S4] loaded HEAD from S16 (vec_in norm=1.145408)
[S4] cosine check vs S16: cos=-0.2611
[S4] DROPPED delta from S16 (cos=-0.2611 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.811003)
[S3] loaded HEAD from S9 (vec_in norm=1.811003)
[S3] cosine check vs S9: cos=0.9964
[S3] BUFFERED delta from S9 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.7008 head_norm=1.799966
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.696487e-02
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.7008 head_norm=1.803852 delta_norm=0.076965
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.9366 head_norm=1.145408
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.144346e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.9339 head_norm=1.215107 delta_norm=0.214435
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.656106 cos_to_last_merge=0.8559 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.856
[S2] round=18 local utility u=0.074022 metrics={'f1_val': 0.8291512345247573, 'auprc': 0.9203917376935151, 'loss_val': 0.3488667465698236, 'psi': 0.8656474357922603}-{'f1_val': 0.8557955469571764, 'auprc': 0.8324409179819177, 'loss_val': 0.39292356625585917, 'psi': 0.8464536953670729}
[S3] START round=18 head_norm_before_train=1.803852 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.016192 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9992453774677269, 'loss_val': 0.23850181597755124, 'psi': 0.8201067267862916}-{'f1_val': 0.7007562037352997, 'auprc': 0.9996230908115751, 'loss_val': 0.2724701794047354, 'psi': 0.8203029585658098}
[S4] START round=18 head_norm_before_train=1.682897 cos_to_last_merge=0.8175 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.818
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9459439718011965, 'auprc': 0.9614619289008135, 'loss_val': 0.22341464846449424, 'psi': 0.9521511546410433}-{'f1_val': 0.9460229634202881, 'auprc': 0.9751701719586792, 'loss_val': 0.2577970138287834, 'psi': 0.9576818468356445}
[S5] START round=18 head_norm_before_train=1.589962 (no previous merge yet)
[S5] round=18 local utility u=0.070180 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.8212524459091067, 'loss_val': 0.3030040259062336, 'psi': 0.7488664347671112}-{'f1_val': 0.7006083926626743, 'auprc': 0.7896953828472985, 'loss_val': 0.3486889439594001, 'psi': 0.736243188736524}
[S6] START round=18 head_norm_before_train=1.811833 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.5985355562372294, 'auprc': 0.7881886931171921, 'loss_val': 0.9350127901671064, 'psi': 0.6743968109892144}-{'f1_val': 0.6140785458445084, 'auprc': 0.8157223447798205, 'loss_val': 0.6342791357578978, 'psi': 0.6947360654186332}
[S7] START round=18 head_norm_before_train=1.172866 cos_to_last_merge=0.9994 (last merge round=16)
[S7] round=18 local utility u=0.000172 metrics={'f1_val': 0.42967132650217543, 'auprc': 0.763246883935386, 'loss_val': 0.9242493123207828, 'psi': 0.5631015494754597}-{'f1_val': 0.41754733483868445, 'auprc': 0.7810206027781499, 'loss_val': 0.9051703252103936, 'psi': 0.5629366420144706}
[S8] START round=18 head_norm_before_train=1.316426 cos_to_last_merge=0.9868 (last merge round=15)
[S8] round=18 local utility u=0.009608 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9980397896585251, 'loss_val': 0.08905989192855913, 'psi': 0.9969377779035018}-{'f1_val': 0.9962031034001528, 'auprc': 0.9975777363461675, 'loss_val': 0.10688951458104977, 'psi': 0.9967529565785587}
[S9] START round=18 head_norm_before_train=1.811003 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9913944794912241, 'auprc': 0.9984710607007579, 'loss_val': 0.04644303598979986, 'psi': 0.9942251119750376}-{'f1_val': 0.9933237369199828, 'auprc': 0.9984686069835444, 'loss_val': 0.049365928201869164, 'psi': 0.9953816849454074}
[S10] START round=18 head_norm_before_train=1.566259 cos_to_last_merge=0.9988 (last merge round=16)
[S10] round=18 local utility u=0.012046 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9957467994340465, 'loss_val': 0.061093000965994106, 'psi': 0.9951478853052421}-{'f1_val': 0.9951878390193748, 'auprc': 0.992026221099396, 'loss_val': 0.07665794496345145, 'psi': 0.9939231918513832}
[S11] START round=18 head_norm_before_train=1.504788 cos_to_last_merge=0.8200 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.820
[S11] round=18 local utility u=0.287372 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9983029756022993, 'loss_val': 0.1219986130661666, 'psi': 0.9973525858608593}-{'f1_val': 0.9212326911058029, 'auprc': 0.9944127770693092, 'loss_val': 0.23215505936567485, 'psi': 0.9505047254912053}
[S13] START round=18 head_norm_before_train=1.811951 cos_to_last_merge=0.9995 (last merge round=16)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5499858682548915, 'auprc': 0.658358554548763, 'loss_val': 0.8365434330449159, 'psi': 0.5933349427724401}-{'f1_val': 0.5674804442591501, 'auprc': 0.6763584890684672, 'loss_val': 0.7822515717216317, 'psi': 0.611031662182877}
[S14] START round=18 head_norm_before_train=1.877935 cos_to_last_merge=0.9997 (last merge round=16)
[S14] round=18 local utility u=0.899793 metrics={'f1_val': 0.9966401574178428, 'auprc': 0.9960934390565245, 'loss_val': 0.17058676625946012, 'psi': 0.9964214700733155}-{'f1_val': 0.701467377271745, 'auprc': 0.9981571165247144, 'loss_val': 0.2053280739061888, 'psi': 0.8201432729729328}
[S15] START round=18 head_norm_before_train=1.953342 (no previous merge yet)
[S15] round=18 local utility u=0.060680 metrics={'f1_val': 0.7164022469742977, 'auprc': 0.8841202688791832, 'loss_val': 0.46946919078119814, 'psi': 0.783489455736252}-{'f1_val': 0.6986544317778979, 'auprc': 0.8854102377719786, 'loss_val': 0.4882122794647001, 'psi': 0.7733567541755302}
[S16] START round=18 head_norm_before_train=1.215107 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.076076 metrics={'f1_val': 0.9428695418293165, 'auprc': 0.9729913426071674, 'loss_val': 0.3589187898311064, 'psi': 0.9549182621404568}-{'f1_val': 0.9365816120124786, 'auprc': 0.9558443945291941, 'loss_val': 0.42190332686618026, 'psi': 0.9442867250191648}
[S17] START round=18 head_norm_before_train=1.906210 (no previous merge yet)
[S17] round=18 local utility u=0.013258 metrics={'f1_val': 0.5914390864147545, 'auprc': 0.933979559059608, 'loss_val': 0.9555850622723253, 'psi': 0.728455275472696}-{'f1_val': 0.5859975938823074, 'auprc': 0.92347426898501, 'loss_val': 0.9179370034203559, 'psi': 0.7209882639233884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:38413
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38416
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:38407
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.896155)
[S13] loaded HEAD from S14 (vec_in norm=1.896155)
[S13] cosine check vs S14: cos=0.9908
[S13] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1803) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.541604)
[S10] loaded HEAD from S11 (vec_in norm=1.541604)
[S10] cosine check vs S11: cos=0.9783
[S10] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1803) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.198701)
[S8] loaded HEAD from S7 (vec_in norm=1.198701)
[S8] cosine check vs S7: cos=0.9239
[S8] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.616756)
[S7] loaded HEAD from S10 (vec_in norm=1.616756)
[S7] cosine check vs S10: cos=0.7958
[S7] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.969292)
[S7] loaded HEAD from S15 (vec_in norm=1.969292)
[S7] cosine check vs S15: cos=0.5774
[S7] BUFFERED delta from S15 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.825541)
[S6] loaded HEAD from S3 (vec_in norm=1.825541)
[S6] cosine check vs S3: cos=-0.1368
[S6] DROPPED delta from S3 (cos=-0.1368 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.685635)
[S5] loaded HEAD from S2 (vec_in norm=1.685635)
[S5] cosine check vs S2: cos=-0.0951
[S5] DROPPED delta from S2 (cos=-0.0951 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.612669)
[S3] loaded HEAD from S5 (vec_in norm=1.612669)
[S3] cosine check vs S5: cos=-0.0149
[S3] DROPPED delta from S5 (cos=-0.0149 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.257730)
[S4] loaded HEAD from S16 (vec_in norm=1.257730)
[S4] cosine check vs S16: cos=-0.2559
[S4] DROPPED delta from S16 (cos=-0.2559 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.374207)
[S16] loaded HEAD from S8 (vec_in norm=1.374207)
[S16] cosine check vs S8: cos=0.9814
[S16] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.926888)
[S14] loaded HEAD from S17 (vec_in norm=1.926888)
[S14] cosine check vs S17: cos=0.9954
[S14] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.5500 head_norm=1.836288
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.300560e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.5525 head_norm=1.861925 delta_norm=0.130056
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9966 head_norm=1.896155
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.264486e-02
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9415 head_norm=1.909337 delta_norm=0.092645
[S14] aggregate: ROLLBACK (f1_val pre=0.997 post=0.942 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9962 head_norm=1.374207
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.653571e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9962 head_norm=1.261844 delta_norm=0.265357
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.4297 head_norm=1.198701
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.706625e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.4274 head_norm=1.293904 delta_norm=0.470663
[S7] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.9947 head_norm=1.616756
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.687441e-01
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.9945 head_norm=1.570588 delta_norm=0.168744
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.9429 head_norm=1.257730
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.393994e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.9447 head_norm=1.309860 delta_norm=0.139399
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.685635 cos_to_last_merge=0.8543 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.854
[S2] round=19 local utility u=0.033558 metrics={'f1_val': 0.8312579936770956, 'auprc': 0.9324689055857899, 'loss_val': 0.33062224516826066, 'psi': 0.8717423584405732}-{'f1_val': 0.8291512345247573, 'auprc': 0.9203917376935151, 'loss_val': 0.3488667465698236, 'psi': 0.8656474357922603}
[S3] START round=19 head_norm_before_train=1.825541 cos_to_last_merge=0.9996 (last merge round=17)
[S3] round=19 local utility u=0.009288 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.999591241681524, 'loss_val': 0.22096267494434846, 'psi': 0.8202450724718104}-{'f1_val': 0.7006809596653347, 'auprc': 0.9992453774677269, 'loss_val': 0.23850181597755124, 'psi': 0.8201067267862916}
[S4] START round=19 head_norm_before_train=1.693590 cos_to_last_merge=0.8175 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.817
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9400099618145197, 'auprc': 0.9332369910624806, 'loss_val': 0.27106100551463924, 'psi': 0.937300773513704}-{'f1_val': 0.9459439718011965, 'auprc': 0.9614619289008135, 'loss_val': 0.22341464846449424, 'psi': 0.9521511546410433}
[S5] START round=19 head_norm_before_train=1.612669 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7434046628417013, 'loss_val': 0.3284630111678057, 'psi': 0.717726900734285}-{'f1_val': 0.7006090940057808, 'auprc': 0.8212524459091067, 'loss_val': 0.3030040259062336, 'psi': 0.7488664347671112}
[S6] START round=19 head_norm_before_train=1.821968 (no previous merge yet)
[S6] round=19 local utility u=0.929333 metrics={'f1_val': 0.7620842028532379, 'auprc': 0.9596606215885253, 'loss_val': 0.5720537695323477, 'psi': 0.8411147703473528}-{'f1_val': 0.5985355562372294, 'auprc': 0.7881886931171921, 'loss_val': 0.9350127901671064, 'psi': 0.6743968109892144}
[S7] START round=19 head_norm_before_train=1.293904 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.4218057267795088, 'auprc': 0.7616953460258173, 'loss_val': 0.9796124921310153, 'psi': 0.5577615744780322}-{'f1_val': 0.42967132650217543, 'auprc': 0.763246883935386, 'loss_val': 0.9242493123207828, 'psi': 0.5631015494754597}
[S8] START round=19 head_norm_before_train=1.261844 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9983614390101829, 'loss_val': 0.13345743060075316, 'psi': 0.9955197778727711}-{'f1_val': 0.9962031034001528, 'auprc': 0.9980397896585251, 'loss_val': 0.08905989192855913, 'psi': 0.9969377779035018}
[S9] START round=19 head_norm_before_train=1.832282 (no previous merge yet)
[S9] round=19 local utility u=0.015908 metrics={'f1_val': 0.9951604951085576, 'auprc': 0.9984606170163901, 'loss_val': 0.03719207949811564, 'psi': 0.9964805438716906}-{'f1_val': 0.9913944794912241, 'auprc': 0.9984710607007579, 'loss_val': 0.04644303598979986, 'psi': 0.9942251119750376}
[S10] START round=19 head_norm_before_train=1.570588 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9940570891637008, 'loss_val': 0.06817054023410148, 'psi': 0.994603747584526}-{'f1_val': 0.9947486092193725, 'auprc': 0.9957467994340465, 'loss_val': 0.061093000965994106, 'psi': 0.9951478853052421}
[S11] START round=19 head_norm_before_train=1.541604 cos_to_last_merge=0.8169 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.817
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.9561236359570857, 'auprc': 0.9910523780159222, 'loss_val': 0.25871715166508114, 'psi': 0.9700951327806203}-{'f1_val': 0.9967189926998994, 'auprc': 0.9983029756022993, 'loss_val': 0.1219986130661666, 'psi': 0.9973525858608593}
[S13] START round=19 head_norm_before_train=1.861925 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.229398 metrics={'f1_val': 0.5881229715646552, 'auprc': 0.6650333026035371, 'loss_val': 0.6265938537389235, 'psi': 0.618887103980208}-{'f1_val': 0.5499858682548915, 'auprc': 0.658358554548763, 'loss_val': 0.8365434330449159, 'psi': 0.5933349427724401}
[S14] START round=19 head_norm_before_train=1.909337 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.023266 metrics={'f1_val': 0.9979077116553055, 'auprc': 0.9987007152107654, 'loss_val': 0.13948154122377632, 'psi': 0.9982249130774894}-{'f1_val': 0.9966401574178428, 'auprc': 0.9960934390565245, 'loss_val': 0.17058676625946012, 'psi': 0.9964214700733155}
[S15] START round=19 head_norm_before_train=1.969292 (no previous merge yet)
[S15] round=19 local utility u=0.290327 metrics={'f1_val': 0.7673876097271551, 'auprc': 0.9612051250752895, 'loss_val': 0.42598212256760243, 'psi': 0.8449146158664089}-{'f1_val': 0.7164022469742977, 'auprc': 0.8841202688791832, 'loss_val': 0.46946919078119814, 'psi': 0.783489455736252}
[S16] START round=19 head_norm_before_train=1.309860 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8617574956899079, 'auprc': 0.970996885040638, 'loss_val': 0.6702324406344483, 'psi': 0.9054532514302}-{'f1_val': 0.9428695418293165, 'auprc': 0.9729913426071674, 'loss_val': 0.3589187898311064, 'psi': 0.9549182621404568}
[S17] START round=19 head_norm_before_train=1.926888 (no previous merge yet)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.5608752701695906, 'auprc': 0.7503378199783576, 'loss_val': 1.1751542176947554, 'psi': 0.6366602900930974}-{'f1_val': 0.5914390864147545, 'auprc': 0.933979559059608, 'loss_val': 0.9555850622723253, 'psi': 0.728455275472696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:38403
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:38405
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:38407
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38408
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.931033)
[S13] loaded HEAD from S14 (vec_in norm=1.931033)
[S13] cosine check vs S14: cos=0.9945
[S13] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1804) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.832276)
[S7] loaded HEAD from S6 (vec_in norm=1.832276)
[S7] cosine check vs S6: cos=0.2787
[S7] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.990223)
[S7] loaded HEAD from S15 (vec_in norm=1.990223)
[S7] cosine check vs S15: cos=0.7886
[S7] BUFFERED delta from S15 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1802) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.850603)
[S6] loaded HEAD from S3 (vec_in norm=1.850603)
[S6] cosine check vs S3: cos=-0.1367
[S6] DROPPED delta from S3 (cos=-0.1367 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1805) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.707951)
[S5] loaded HEAD from S2 (vec_in norm=1.707951)
[S5] cosine check vs S2: cos=-0.0955
[S5] DROPPED delta from S2 (cos=-0.0955 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.850829)
[S3] loaded HEAD from S9 (vec_in norm=1.850829)
[S3] cosine check vs S9: cos=0.9939
[S3] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.882449)
[S16] loaded HEAD from S13 (vec_in norm=1.882449)
[S16] cosine check vs S13: cos=0.0732
[S16] BUFFERED delta from S13 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=20 psi=0.937 u=0.0000 p_local=0.0633 f1=0.940 auprc=0.933 bytes=17964
[S10] r=20 psi=0.995 u=0.0000 p_local=0.0608 f1=0.995 auprc=0.994 bytes=23380
[S11] r=20 psi=0.970 u=0.0000 p_local=0.1765 f1=0.956 auprc=0.991 bytes=23407
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.4218 head_norm=1.315392
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.551903e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.4939 head_norm=1.255138 delta_norm=0.455190
[S7] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S7] r=20 psi=0.558 u=0.0000 p_local=0.0905 f1=0.422 auprc=0.762 bytes=21579
[S5] r=20 psi=0.718 u=0.0000 p_local=0.1282 f1=0.701 auprc=0.743 bytes=19776
[S8] r=20 psi=0.996 u=0.0000 p_local=0.0915 f1=0.994 auprc=0.998 bytes=23364
[S14] r=20 psi=0.998 u=0.0233 p_local=0.2892 f1=0.998 auprc=0.999 bytes=25178
[S2] r=20 psi=0.872 u=0.0336 p_local=0.1606 f1=0.831 auprc=0.932 bytes=19807
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.7007 head_norm=1.850603
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.020034e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.7007 head_norm=1.847903 delta_norm=0.102003
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] r=20 psi=0.820 u=0.0093 p_local=0.1340 f1=0.701 auprc=1.000 bytes=23381
[S6] r=20 psi=0.841 u=0.9293 p_local=0.3983 f1=0.762 auprc=0.960 bytes=21610
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.5881 head_norm=1.882449
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.027103e-01
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.5891 head_norm=1.904127 delta_norm=0.102710
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.619 u=0.2294 p_local=0.1030 f1=0.588 auprc=0.665 bytes=12579
[S9] r=20 psi=0.996 u=0.0159 p_local=0.1174 f1=0.995 auprc=0.998 bytes=25199
[S15] r=20 psi=0.845 u=0.2903 p_local=0.2476 f1=0.767 auprc=0.961 bytes=19804
[S17] r=20 psi=0.637 u=0.0000 p_local=0.1137 f1=0.561 auprc=0.750 bytes=17985
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.8618 head_norm=1.347002
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.116563e+00
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.8523 head_norm=1.196788 delta_norm=1.116563
[S16] aggregate: ROLLBACK (f1_val pre=0.862 post=0.852 tol_abs=0.005 tol_rel=0.0)
[S16] r=20 psi=0.905 u=0.0000 p_local=0.2766 f1=0.862 auprc=0.971 bytes=21579
[S2] START round=20 head_norm_before_train=1.707951 cos_to_last_merge=0.8527 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.853
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7848595292908733, 'auprc': 0.8153121812704335, 'loss_val': 0.5519636847754561, 'psi': 0.7970405900826973}-{'f1_val': 0.8312579936770956, 'auprc': 0.9324689055857899, 'loss_val': 0.33062224516826066, 'psi': 0.8717423584405732}
[S3] START round=20 head_norm_before_train=1.847903 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.934146 metrics={'f1_val': 0.9971122502560278, 'auprc': 0.9996018560426514, 'loss_val': 0.13129024098216635, 'psi': 0.9981080925706772}-{'f1_val': 0.7006809596653347, 'auprc': 0.999591241681524, 'loss_val': 0.22096267494434846, 'psi': 0.8202450724718104}
[S4] START round=20 head_norm_before_train=1.697597 cos_to_last_merge=0.8168 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.817
[S4] round=20 local utility u=0.008185 metrics={'f1_val': 0.9415013863521953, 'auprc': 0.9358557952866425, 'loss_val': 0.27149659181299873, 'psi': 0.9392431499259741}-{'f1_val': 0.9400099618145197, 'auprc': 0.9332369910624806, 'loss_val': 0.27106100551463924, 'psi': 0.937300773513704}
[S5] START round=20 head_norm_before_train=1.632010 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7274940050227754, 'loss_val': 0.33383278743965067, 'psi': 0.7113626376067148}-{'f1_val': 0.7006083926626743, 'auprc': 0.7434046628417013, 'loss_val': 0.3284630111678057, 'psi': 0.717726900734285}
[S6] START round=20 head_norm_before_train=1.832276 (no previous merge yet)
[S6] round=20 local utility u=0.621730 metrics={'f1_val': 0.9170505736446793, 'auprc': 0.9648882473207613, 'loss_val': 0.27407512899810277, 'psi': 0.9361856431151121}-{'f1_val': 0.7620842028532379, 'auprc': 0.9596606215885253, 'loss_val': 0.5720537695323477, 'psi': 0.8411147703473528}
[S7] START round=20 head_norm_before_train=1.255138 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.819287 metrics={'f1_val': 0.6180435246962976, 'auprc': 0.8074709920455649, 'loss_val': 0.6557928679952335, 'psi': 0.6938145116360046}-{'f1_val': 0.4218057267795088, 'auprc': 0.7616953460258173, 'loss_val': 0.9796124921310153, 'psi': 0.5577615744780322}
[S8] START round=20 head_norm_before_train=1.310714 cos_to_last_merge=0.9990 (last merge round=18)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.990363285929422, 'auprc': 0.9982884393081276, 'loss_val': 0.1443305500364336, 'psi': 0.9935333472809043}-{'f1_val': 0.9936253371144965, 'auprc': 0.9983614390101829, 'loss_val': 0.13345743060075316, 'psi': 0.9955197778727711}
[S9] START round=20 head_norm_before_train=1.850829 (no previous merge yet)
[S9] round=20 local utility u=0.002894 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9984688936909859, 'loss_val': 0.03392515191740016, 'psi': 0.9967333928069031}-{'f1_val': 0.9951604951085576, 'auprc': 0.9984606170163901, 'loss_val': 0.03719207949811564, 'psi': 0.9964805438716906}
[S10] START round=20 head_norm_before_train=1.617416 cos_to_last_merge=0.9993 (last merge round=18)
[S10] round=20 local utility u=0.006800 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9941667652323719, 'loss_val': 0.05489944477801975, 'psi': 0.9946476180119945}-{'f1_val': 0.9949681865317428, 'auprc': 0.9940570891637008, 'loss_val': 0.06817054023410148, 'psi': 0.994603747584526}
[S11] START round=20 head_norm_before_train=1.576309 cos_to_last_merge=0.8136 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.814
[S11] round=20 local utility u=0.209816 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9984334987252036, 'loss_val': 0.10231859880497973, 'psi': 0.997156499971398}-{'f1_val': 0.9561236359570857, 'auprc': 0.9910523780159222, 'loss_val': 0.25871715166508114, 'psi': 0.9700951327806203}
[S13] START round=20 head_norm_before_train=1.904127 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5714696139381825, 'auprc': 0.6786927971204271, 'loss_val': 0.7368079626351516, 'psi': 0.6143588872110803}-{'f1_val': 0.5881229715646552, 'auprc': 0.6650333026035371, 'loss_val': 0.6265938537389235, 'psi': 0.618887103980208}
[S14] START round=20 head_norm_before_train=1.931033 cos_to_last_merge=0.9997 (last merge round=18)
[S14] round=20 local utility u=0.004929 metrics={'f1_val': 0.9964554352703425, 'auprc': 0.9955139877855145, 'loss_val': 0.11134961294310204, 'psi': 0.9960788562764114}-{'f1_val': 0.9979077116553055, 'auprc': 0.9987007152107654, 'loss_val': 0.13948154122377632, 'psi': 0.9982249130774894}
[S15] START round=20 head_norm_before_train=1.990223 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6995794768811698, 'auprc': 0.8370992594330006, 'loss_val': 0.5592639079894232, 'psi': 0.7545873899019022}-{'f1_val': 0.7673876097271551, 'auprc': 0.9612051250752895, 'loss_val': 0.42598212256760243, 'psi': 0.8449146158664089}
[S16] START round=20 head_norm_before_train=1.196788 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8529531475172131, 'auprc': 0.9703803434278403, 'loss_val': 0.7108301422769492, 'psi': 0.899924025881464}-{'f1_val': 0.8617574956899079, 'auprc': 0.970996885040638, 'loss_val': 0.6702324406344483, 'psi': 0.9054532514302}
[S17] START round=20 head_norm_before_train=1.937405 (no previous merge yet)
[S17] round=20 local utility u=0.527785 metrics={'f1_val': 0.604287333435341, 'auprc': 0.9406282886093188, 'loss_val': 0.9509284171561301, 'psi': 0.7388237155049322}-{'f1_val': 0.5608752701695906, 'auprc': 0.7503378199783576, 'loss_val': 1.1751542176947554, 'psi': 0.6366602900930974}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:38409
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:38407
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.955421)
[S13] loaded HEAD from S14 (vec_in norm=1.955421)
[S13] cosine check vs S14: cos=0.9975
[S13] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.605766)
[S10] loaded HEAD from S11 (vec_in norm=1.605766)
[S10] cosine check vs S11: cos=0.9836
[S10] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1803) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.272195)
[S8] loaded HEAD from S7 (vec_in norm=1.272195)
[S8] cosine check vs S7: cos=0.8954
[S8] BUFFERED delta from S7 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1794) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.704911)
[S8] loaded HEAD from S4 (vec_in norm=1.704911)
[S8] cosine check vs S4: cos=-0.2361
[S8] DROPPED delta from S4 (cos=-0.2361 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.841483)
[S7] loaded HEAD from S6 (vec_in norm=1.841483)
[S7] cosine check vs S6: cos=0.5131
[S7] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1793) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.665294)
[S7] loaded HEAD from S10 (vec_in norm=1.665294)
[S7] cosine check vs S10: cos=0.6365
[S7] BUFFERED delta from S10 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.868793)
[S6] loaded HEAD from S3 (vec_in norm=1.868793)
[S6] cosine check vs S3: cos=-0.1359
[S6] DROPPED delta from S3 (cos=-0.1359 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.870135)
[S3] loaded HEAD from S9 (vec_in norm=1.870135)
[S3] cosine check vs S9: cos=0.9966
[S3] BUFFERED delta from S9 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1793 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1793) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.950466)
[S14] loaded HEAD from S17 (vec_in norm=1.950466)
[S14] cosine check vs S17: cos=0.9950
[S14] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.5715 head_norm=1.920234
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.110159e-02
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.5720 head_norm=1.936603 delta_norm=0.071102
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.082 → S16@127.0.0.1:38416
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9904 head_norm=1.363794
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.046741e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9854 head_norm=1.283114 delta_norm=0.304674
[S8] aggregate: ROLLBACK (f1_val pre=0.990 post=0.985 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.073 → S16@127.0.0.1:38416
[S5] ⇄ pheromone p=0.103 → S3@127.0.0.1:38403
[S2] ⇄ pheromone p=0.129 → S5@127.0.0.1:38405
[S15] ⇄ pheromone p=0.198 → S7@127.0.0.1:38408
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9965 head_norm=1.955421
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.726856e-02
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9965 head_norm=1.950521 delta_norm=0.097269
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.232 → S13@127.0.0.1:38413
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.9971 head_norm=1.868793
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.683186e-02
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.9979 head_norm=1.867885 delta_norm=0.076832
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.294 → S6@127.0.0.1:38407
[S11] ⇄ pheromone p=0.183 → S10@127.0.0.1:38411
[S6] ⇄ pheromone p=0.443 → S7@127.0.0.1:38408
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.6180 head_norm=1.272195
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.074856e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.6144 head_norm=1.200570 delta_norm=0.407486
[S7] aggregate: ACCEPT kept=['S6', 'S10'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.236 → S8@127.0.0.1:38409
[S4] ⇄ pheromone p=0.052 → S8@127.0.0.1:38409
[S9] ⇄ pheromone p=0.094 → S3@127.0.0.1:38403
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9950 head_norm=1.665294
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.511702e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9950 head_norm=1.628801 delta_norm=0.151170
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.050 → S7@127.0.0.1:38408
[S16] ⇄ pheromone p=0.221 → S4@127.0.0.1:38404
[S17] ⇄ pheromone p=0.197 → S14@127.0.0.1:38414
[S2] START round=21 head_norm_before_train=1.724539 cos_to_last_merge=0.8510 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.851
[S2] round=21 local utility u=0.423877 metrics={'f1_val': 0.8580267283469978, 'auprc': 0.8536976154513152, 'loss_val': 0.2583689244969703, 'psi': 0.8562950831887248}-{'f1_val': 0.7848595292908733, 'auprc': 0.8153121812704335, 'loss_val': 0.5519636847754561, 'psi': 0.7970405900826973}
[S3] START round=21 head_norm_before_train=1.867885 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.9308051276438501, 'auprc': 0.999962835808643, 'loss_val': 0.18779666710308857, 'psi': 0.9584682109097673}-{'f1_val': 0.9971122502560278, 'auprc': 0.9996018560426514, 'loss_val': 0.13129024098216635, 'psi': 0.9981080925706772}
[S4] START round=21 head_norm_before_train=1.704911 cos_to_last_merge=0.8167 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.817
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9396571370039271, 'auprc': 0.9295752490535347, 'loss_val': 0.29155523791279514, 'psi': 0.9356243818237701}-{'f1_val': 0.9415013863521953, 'auprc': 0.9358557952866425, 'loss_val': 0.27149659181299873, 'psi': 0.9392431499259741}
[S5] START round=21 head_norm_before_train=1.646941 (no previous merge yet)
[S5] round=21 local utility u=0.360490 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9498936826673383, 'loss_val': 0.2800517610608974, 'psi': 0.8003225086645399}-{'f1_val': 0.7006083926626743, 'auprc': 0.7274940050227754, 'loss_val': 0.33383278743965067, 'psi': 0.7113626376067148}
[S6] START round=21 head_norm_before_train=1.841483 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.5968092990847267, 'auprc': 0.8017798032538721, 'loss_val': 0.9066060409571813, 'psi': 0.6787975007523849}-{'f1_val': 0.9170505736446793, 'auprc': 0.9648882473207613, 'loss_val': 0.27407512899810277, 'psi': 0.9361856431151121}
[S7] START round=21 head_norm_before_train=1.200570 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.288059 metrics={'f1_val': 0.6711677187750216, 'auprc': 0.8571621373083707, 'loss_val': 0.547493912408727, 'psi': 0.7455654861883612}-{'f1_val': 0.6180435246962976, 'auprc': 0.8074709920455649, 'loss_val': 0.6557928679952335, 'psi': 0.6938145116360046}
[S8] START round=21 head_norm_before_train=1.283114 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.011237 metrics={'f1_val': 0.9946534232918708, 'auprc': 0.9976931875756068, 'loss_val': 0.14581144561954426, 'psi': 0.9958693290053652}-{'f1_val': 0.990363285929422, 'auprc': 0.9982884393081276, 'loss_val': 0.1443305500364336, 'psi': 0.9935333472809043}
[S9] START round=21 head_norm_before_train=1.870135 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9984626089591803, 'loss_val': 0.033788881331753534, 'psi': 0.9954801528894947}-{'f1_val': 0.9955763922175147, 'auprc': 0.9984688936909859, 'loss_val': 0.03392515191740016, 'psi': 0.9967333928069031}
[S10] START round=21 head_norm_before_train=1.628801 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9952269183065199, 'loss_val': 0.05951054864561, 'psi': 0.9948082314016445}-{'f1_val': 0.9949681865317428, 'auprc': 0.9941667652323719, 'loss_val': 0.05489944477801975, 'psi': 0.9946476180119945}
[S11] START round=21 head_norm_before_train=1.605766 cos_to_last_merge=0.8108 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.811
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9530150323353951, 'auprc': 0.9831156868494769, 'loss_val': 0.2673756602082838, 'psi': 0.9650552941410279}-{'f1_val': 0.996305167468861, 'auprc': 0.9984334987252036, 'loss_val': 0.10231859880497973, 'psi': 0.997156499971398}
[S13] START round=21 head_norm_before_train=1.936603 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5712749777490473, 'auprc': 0.6903350142871039, 'loss_val': 0.7942593001589165, 'psi': 0.6188989923642699}-{'f1_val': 0.5714696139381825, 'auprc': 0.6786927971204271, 'loss_val': 0.7368079626351516, 'psi': 0.6143588872110803}
[S14] START round=21 head_norm_before_train=1.950521 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.007167 metrics={'f1_val': 0.9970858939020174, 'auprc': 0.9990781510152971, 'loss_val': 0.11149146921181298, 'psi': 0.9978827967473293}-{'f1_val': 0.9964554352703425, 'auprc': 0.9955139877855145, 'loss_val': 0.11134961294310204, 'psi': 0.9960788562764114}
[S15] START round=21 head_norm_before_train=2.007650 (no previous merge yet)
[S15] round=21 local utility u=1.000000 metrics={'f1_val': 0.987771431331365, 'auprc': 0.9934699798075445, 'loss_val': 0.07850942880913539, 'psi': 0.9900508507218369}-{'f1_val': 0.6995794768811698, 'auprc': 0.8370992594330006, 'loss_val': 0.5592639079894232, 'psi': 0.7545873899019022}
[S16] START round=21 head_norm_before_train=1.228422 cos_to_last_merge=0.9979 (last merge round=19)
[S16] round=21 local utility u=0.333938 metrics={'f1_val': 0.9140715127060433, 'auprc': 0.988349787643811, 'loss_val': 0.4635717819106552, 'psi': 0.9437828226811503}-{'f1_val': 0.8529531475172131, 'auprc': 0.9703803434278403, 'loss_val': 0.7108301422769492, 'psi': 0.899924025881464}
[S17] START round=21 head_norm_before_train=1.950466 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.5811712916265299, 'auprc': 0.8906761209284955, 'loss_val': 1.1279202884482327, 'psi': 0.7049732233473162}-{'f1_val': 0.604287333435341, 'auprc': 0.9406282886093188, 'loss_val': 0.9509284171561301, 'psi': 0.7388237155049322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:38404
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:38416
[S7] not sending this round → trigger blocked (psi=0.746)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38408
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:38403
[S8] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.324628)
[S16] loaded HEAD from S8 (vec_in norm=1.324628)
[S16] cosine check vs S8: cos=0.5781
[S16] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.745510)
[S5] loaded HEAD from S2 (vec_in norm=1.745510)
[S5] cosine check vs S2: cos=-0.0945
[S5] DROPPED delta from S2 (cos=-0.0945 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1805) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.269667)
[S4] loaded HEAD from S16 (vec_in norm=1.269667)
[S4] cosine check vs S16: cos=-0.2108
[S4] DROPPED delta from S16 (cos=-0.2108 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.664486)
[S3] loaded HEAD from S5 (vec_in norm=1.664486)
[S3] cosine check vs S5: cos=-0.0141
[S3] DROPPED delta from S5 (cos=-0.0141 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.027478)
[S7] loaded HEAD from S15 (vec_in norm=2.027478)
[S7] cosine check vs S15: cos=0.5848
[S7] BUFFERED delta from S15 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.6712 head_norm=1.214338
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.224417e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.6748 head_norm=1.454727 delta_norm=0.822442
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.9141 head_norm=1.269667
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.962933e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.9159 head_norm=1.152294 delta_norm=0.596293
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.745510 cos_to_last_merge=0.8491 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.849
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.8617945244009938, 'auprc': 0.8125325794611132, 'loss_val': 0.3288116581442857, 'psi': 0.8420897464250415}-{'f1_val': 0.8580267283469978, 'auprc': 0.8536976154513152, 'loss_val': 0.2583689244969703, 'psi': 0.8562950831887248}
[S3] START round=22 head_norm_before_train=1.887352 cos_to_last_merge=0.9997 (last merge round=20)
[S3] round=22 local utility u=0.237711 metrics={'f1_val': 0.9971434701490716, 'auprc': 0.9999802369787341, 'loss_val': 0.11045689235965674, 'psi': 0.9982781768809366}-{'f1_val': 0.9308051276438501, 'auprc': 0.999962835808643, 'loss_val': 0.18779666710308857, 'psi': 0.9584682109097673}
[S4] START round=22 head_norm_before_train=1.708939 cos_to_last_merge=0.8168 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.817
[S4] round=22 local utility u=0.017985 metrics={'f1_val': 0.9407285379542252, 'auprc': 0.9357121887686622, 'loss_val': 0.2804248367687474, 'psi': 0.93872199828}-{'f1_val': 0.9396571370039271, 'auprc': 0.9295752490535347, 'loss_val': 0.29155523791279514, 'psi': 0.9356243818237701}
[S5] START round=22 head_norm_before_train=1.664486 (no previous merge yet)
[S5] round=22 local utility u=0.072737 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9896838526614777, 'loss_val': 0.25394887286716145, 'psi': 0.8162385766621957}-{'f1_val': 0.7006083926626743, 'auprc': 0.9498936826673383, 'loss_val': 0.2800517610608974, 'psi': 0.8003225086645399}
[S6] START round=22 head_norm_before_train=1.856468 (no previous merge yet)
[S6] round=22 local utility u=1.000000 metrics={'f1_val': 0.9547192657815825, 'auprc': 0.9678455067359095, 'loss_val': 0.21567427837489367, 'psi': 0.9599697621633133}-{'f1_val': 0.5968092990847267, 'auprc': 0.8017798032538721, 'loss_val': 0.9066060409571813, 'psi': 0.6787975007523849}
[S7] START round=22 head_norm_before_train=1.454727 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.3781163403482364, 'auprc': 0.653074307197449, 'loss_val': 1.0615674925641596, 'psi': 0.4880995270879214}-{'f1_val': 0.6711677187750216, 'auprc': 0.8571621373083707, 'loss_val': 0.547493912408727, 'psi': 0.7455654861883612}
[S8] START round=22 head_norm_before_train=1.324628 cos_to_last_merge=0.9992 (last merge round=20)
[S8] round=22 local utility u=0.015212 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.9982276211038799, 'loss_val': 0.10862598811162615, 'psi': 0.9952466450496698}-{'f1_val': 0.9946534232918708, 'auprc': 0.9976931875756068, 'loss_val': 0.14581144561954426, 'psi': 0.9958693290053652}
[S9] START round=22 head_norm_before_train=1.888156 (no previous merge yet)
[S9] round=22 local utility u=0.001208 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9984530252892556, 'loss_val': 0.03134480930242459, 'psi': 0.9954763194215248}-{'f1_val': 0.9934918488430377, 'auprc': 0.9984626089591803, 'loss_val': 0.033788881331753534, 'psi': 0.9954801528894947}
[S10] START round=22 head_norm_before_train=1.675345 cos_to_last_merge=0.9994 (last merge round=20)
[S10] round=22 local utility u=0.005075 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9951114204466306, 'loss_val': 0.04901418142091762, 'psi': 0.9947620322576889}-{'f1_val': 0.9945291067983943, 'auprc': 0.9952269183065199, 'loss_val': 0.05951054864561, 'psi': 0.9948082314016445}
[S11] START round=22 head_norm_before_train=1.635156 cos_to_last_merge=0.8082 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.808
[S11] round=22 local utility u=0.253659 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980858021247091, 'loss_val': 0.064709387609672, 'psi': 0.9970174213312002}-{'f1_val': 0.9530150323353951, 'auprc': 0.9831156868494769, 'loss_val': 0.2673756602082838, 'psi': 0.9650552941410279}
[S13] START round=22 head_norm_before_train=1.954744 cos_to_last_merge=0.9998 (last merge round=20)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.46051799671785715, 'auprc': 0.5599065511152278, 'loss_val': 1.1594748420924696, 'psi': 0.5002734184768054}-{'f1_val': 0.5712749777490473, 'auprc': 0.6903350142871039, 'loss_val': 0.7942593001589165, 'psi': 0.6188989923642699}
[S14] START round=22 head_norm_before_train=1.967113 cos_to_last_merge=0.9998 (last merge round=20)
[S14] round=22 local utility u=0.002432 metrics={'f1_val': 0.996645795236444, 'auprc': 0.9942960262895413, 'loss_val': 0.08964059004374676, 'psi': 0.995705887657683}-{'f1_val': 0.9970858939020174, 'auprc': 0.9990781510152971, 'loss_val': 0.11149146921181298, 'psi': 0.9978827967473293}
[S15] START round=22 head_norm_before_train=2.027478 (no previous merge yet)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7010691361715489, 'auprc': 0.7762188754342719, 'loss_val': 0.6857844515111053, 'psi': 0.7311290318766381}-{'f1_val': 0.987771431331365, 'auprc': 0.9934699798075445, 'loss_val': 0.07850942880913539, 'psi': 0.9900508507218369}
[S16] START round=22 head_norm_before_train=1.152294 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.355629 metrics={'f1_val': 0.9900773944423605, 'auprc': 0.9911415981294144, 'loss_val': 0.21672350411783475, 'psi': 0.9905030759171821}-{'f1_val': 0.9140715127060433, 'auprc': 0.988349787643811, 'loss_val': 0.4635717819106552, 'psi': 0.9437828226811503}
[S17] START round=22 head_norm_before_train=1.966284 (no previous merge yet)
[S17] round=22 local utility u=0.179384 metrics={'f1_val': 0.6062308198726074, 'auprc': 0.920124332650359, 'loss_val': 1.0078537464715063, 'psi': 0.731788224983708}-{'f1_val': 0.5811712916265299, 'auprc': 0.8906761209284955, 'loss_val': 1.1279202884482327, 'psi': 0.7049732233473162}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:38403
[S5] not sending this round → trigger blocked (psi=0.816)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:38411
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.991)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:38413
[S8] not sending this round → trigger blocked (psi=0.995)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38408
[S6] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.981098)
[S13] loaded HEAD from S14 (vec_in norm=1.981098)
[S13] cosine check vs S14: cos=0.9967
[S13] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.875469)
[S7] loaded HEAD from S6 (vec_in norm=1.875469)
[S7] cosine check vs S6: cos=0.2837
[S7] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.730272)
[S8] loaded HEAD from S4 (vec_in norm=1.730272)
[S8] cosine check vs S4: cos=-0.2158
[S8] DROPPED delta from S4 (cos=-0.2158 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.664149)
[S10] loaded HEAD from S11 (vec_in norm=1.664149)
[S10] cosine check vs S11: cos=0.9868
[S10] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.720788)
[S7] loaded HEAD from S10 (vec_in norm=1.720788)
[S7] cosine check vs S10: cos=0.5977
[S7] BUFFERED delta from S10 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.906216)
[S3] loaded HEAD from S9 (vec_in norm=1.906216)
[S3] cosine check vs S9: cos=0.9962
[S3] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.906923)
[S6] loaded HEAD from S3 (vec_in norm=1.906923)
[S6] cosine check vs S3: cos=-0.1355
[S6] DROPPED delta from S3 (cos=-0.1355 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.982136)
[S14] loaded HEAD from S17 (vec_in norm=1.982136)
[S14] cosine check vs S17: cos=0.9964
[S14] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.4605 head_norm=1.971842
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.012688e-02
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.4607 head_norm=1.974851 delta_norm=0.080127
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.3781 head_norm=1.468586
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.215922e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.3777 head_norm=1.237835 delta_norm=0.621592
[S7] aggregate: ACCEPT kept=['S6', 'S10'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9945 head_norm=1.720788
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.401241e-01
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9939 head_norm=1.686896 delta_norm=0.140124
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.9971 head_norm=1.906923
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.303532e-02
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.9971 head_norm=1.904761 delta_norm=0.083035
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9966 head_norm=1.981098
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.392030e-02
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9966 head_norm=1.979839 delta_norm=0.083920
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.771118 cos_to_last_merge=0.8471 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.847
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.8373256835120382, 'auprc': 0.85579995490007, 'loss_val': 0.32315163096563815, 'psi': 0.8447153920672509}-{'f1_val': 0.8617945244009938, 'auprc': 0.8125325794611132, 'loss_val': 0.3288116581442857, 'psi': 0.8420897464250415}
[S3] START round=23 head_norm_before_train=1.904761 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9600800976779673, 'auprc': 0.9998049893215532, 'loss_val': 0.20040637622826066, 'psi': 0.9759700543354016}-{'f1_val': 0.9971434701490716, 'auprc': 0.9999802369787341, 'loss_val': 0.11045689235965674, 'psi': 0.9982781768809366}
[S4] START round=23 head_norm_before_train=1.730272 cos_to_last_merge=0.8154 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.815
[S4] round=23 local utility u=0.038860 metrics={'f1_val': 0.9415132228846284, 'auprc': 0.9611974317700731, 'loss_val': 0.28386873662445333, 'psi': 0.9493869064388063}-{'f1_val': 0.9407285379542252, 'auprc': 0.9357121887686622, 'loss_val': 0.2804248367687474, 'psi': 0.93872199828}
[S5] START round=23 head_norm_before_train=1.681094 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.5439904091932868, 'auprc': 0.8554173201908957, 'loss_val': 0.5016703345445273, 'psi': 0.6685611735923304}-{'f1_val': 0.7006083926626743, 'auprc': 0.9896838526614777, 'loss_val': 0.25394887286716145, 'psi': 0.8162385766621957}
[S6] START round=23 head_norm_before_train=1.875469 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.8239315995902052, 'auprc': 0.9645796473479948, 'loss_val': 0.4380389410904207, 'psi': 0.8801908186933212}-{'f1_val': 0.9547192657815825, 'auprc': 0.9678455067359095, 'loss_val': 0.21567427837489367, 'psi': 0.9599697621633133}
[S7] START round=23 head_norm_before_train=1.237835 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=1.000000 metrics={'f1_val': 0.6769263228598701, 'auprc': 0.8755508623797381, 'loss_val': 0.4894305030511265, 'psi': 0.7563761386678173}-{'f1_val': 0.3781163403482364, 'auprc': 0.653074307197449, 'loss_val': 1.0615674925641596, 'psi': 0.4880995270879214}
[S8] START round=23 head_norm_before_train=1.361958 cos_to_last_merge=0.9973 (last merge round=20)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.990351025081079, 'auprc': 0.9980564736542055, 'loss_val': 0.09399313391879337, 'psi': 0.9934332045103296}-{'f1_val': 0.9932593276801964, 'auprc': 0.9982276211038799, 'loss_val': 0.10862598811162615, 'psi': 0.9952466450496698}
[S9] START round=23 head_norm_before_train=1.906216 (no previous merge yet)
[S9] round=23 local utility u=0.003707 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9979716475698184, 'loss_val': 0.03499472468259771, 'psi': 0.9965344943584362}-{'f1_val': 0.9934918488430377, 'auprc': 0.9984530252892556, 'loss_val': 0.03134480930242459, 'psi': 0.9954763194215248}
[S10] START round=23 head_norm_before_train=1.686896 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9933955329347417, 'loss_val': 0.0522050378689548, 'psi': 0.9943391250929423}-{'f1_val': 0.9945291067983943, 'auprc': 0.9951114204466306, 'loss_val': 0.04901418142091762, 'psi': 0.9947620322576889}
[S11] START round=23 head_norm_before_train=1.664149 cos_to_last_merge=0.8056 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.806
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9550353105533866, 'auprc': 0.9920202510579508, 'loss_val': 0.21639346569623596, 'psi': 0.9698292867552123}-{'f1_val': 0.996305167468861, 'auprc': 0.9980858021247091, 'loss_val': 0.064709387609672, 'psi': 0.9970174213312002}
[S13] START round=23 head_norm_before_train=1.974851 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.579733 metrics={'f1_val': 0.539185534273122, 'auprc': 0.6745005234984582, 'loss_val': 0.8157965060283822, 'psi': 0.5933115299632565}-{'f1_val': 0.46051799671785715, 'auprc': 0.5599065511152278, 'loss_val': 1.1594748420924696, 'psi': 0.5002734184768054}
[S14] START round=23 head_norm_before_train=1.979839 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.001238 metrics={'f1_val': 0.9950002216535363, 'auprc': 0.9988916671067888, 'loss_val': 0.0910779524932464, 'psi': 0.9965567998348372}-{'f1_val': 0.996645795236444, 'auprc': 0.9942960262895413, 'loss_val': 0.08964059004374676, 'psi': 0.995705887657683}
[S15] START round=23 head_norm_before_train=2.049365 (no previous merge yet)
[S15] round=23 local utility u=1.000000 metrics={'f1_val': 0.8818913278174388, 'auprc': 0.990686500300852, 'loss_val': 0.1793003014237576, 'psi': 0.9254093968108041}-{'f1_val': 0.7010691361715489, 'auprc': 0.7762188754342719, 'loss_val': 0.6857844515111053, 'psi': 0.7311290318766381}
[S16] START round=23 head_norm_before_train=1.201375 cos_to_last_merge=0.9977 (last merge round=21)
[S16] round=23 local utility u=0.019093 metrics={'f1_val': 0.9905063795534047, 'auprc': 0.9864864588607749, 'loss_val': 0.16714684712557362, 'psi': 0.9888984112763528}-{'f1_val': 0.9900773944423605, 'auprc': 0.9911415981294144, 'loss_val': 0.21672350411783475, 'psi': 0.9905030759171821}
[S17] START round=23 head_norm_before_train=1.982136 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.5960082751780957, 'auprc': 0.8649735354418373, 'loss_val': 1.10006746359271, 'psi': 0.7035943792835924}-{'f1_val': 0.6062308198726074, 'auprc': 0.920124332650359, 'loss_val': 1.0078537464715063, 'psi': 0.731788224983708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:38403
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:38409
[S7] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.750470)
[S8] loaded HEAD from S4 (vec_in norm=1.750470)
[S8] cosine check vs S4: cos=-0.2227
[S8] DROPPED delta from S4 (cos=-0.2227 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.248903)
[S8] loaded HEAD from S7 (vec_in norm=1.248903)
[S8] cosine check vs S7: cos=0.9588
[S8] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.066511)
[S7] loaded HEAD from S15 (vec_in norm=2.066511)
[S7] cosine check vs S15: cos=0.7098
[S7] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.251234)
[S4] loaded HEAD from S16 (vec_in norm=1.251234)
[S4] cosine check vs S16: cos=-0.2476
[S4] DROPPED delta from S16 (cos=-0.2476 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.920442)
[S3] loaded HEAD from S9 (vec_in norm=1.920442)
[S3] cosine check vs S9: cos=0.9980
[S3] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.986614)
[S16] loaded HEAD from S13 (vec_in norm=1.986614)
[S16] cosine check vs S13: cos=0.4235
[S16] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1797) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.997231)
[S13] loaded HEAD from S14 (vec_in norm=1.997231)
[S13] cosine check vs S14: cos=0.9977
[S13] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9904 head_norm=1.413248
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.076613e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9896 head_norm=1.317342 delta_norm=0.207661
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.9601 head_norm=1.921369
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.093640e-02
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.9604 head_norm=1.919939 delta_norm=0.060936
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.6769 head_norm=1.248903
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.359254e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.6785 head_norm=1.540626 delta_norm=0.735925
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.5392 head_norm=1.986614
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.805135e-02
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.5390 head_norm=1.990766 delta_norm=0.068051
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9905 head_norm=1.251234
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.228672e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9901 head_norm=1.380009 delta_norm=0.922867
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.797295 cos_to_last_merge=0.8451 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.845
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.8299128935530112, 'auprc': 0.8957579051290058, 'loss_val': 0.4207543013022069, 'psi': 0.856250898183409}-{'f1_val': 0.8373256835120382, 'auprc': 0.85579995490007, 'loss_val': 0.32315163096563815, 'psi': 0.8447153920672509}
[S3] START round=24 head_norm_before_train=1.919939 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.163106 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9999850940911872, 'loss_val': 0.1011146446095875, 'psi': 0.9986800581970506}-{'f1_val': 0.9600800976779673, 'auprc': 0.9998049893215532, 'loss_val': 0.20040637622826066, 'psi': 0.9759700543354016}
[S4] START round=24 head_norm_before_train=1.750470 cos_to_last_merge=0.8140 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.814
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9408444832793613, 'auprc': 0.9428334267353362, 'loss_val': 0.2876806262116679, 'psi': 0.9416400606617512}-{'f1_val': 0.9415132228846284, 'auprc': 0.9611974317700731, 'loss_val': 0.28386873662445333, 'psi': 0.9493869064388063}
[S5] START round=24 head_norm_before_train=1.696220 (no previous merge yet)
[S5] round=24 local utility u=0.220712 metrics={'f1_val': 0.5985773114445506, 'auprc': 0.858333800434985, 'loss_val': 0.39651795431132464, 'psi': 0.7024799070407244}-{'f1_val': 0.5439904091932868, 'auprc': 0.8554173201908957, 'loss_val': 0.5016703345445273, 'psi': 0.6685611735923304}
[S6] START round=24 head_norm_before_train=1.892775 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.7237289142715966, 'auprc': 0.9562767369027576, 'loss_val': 0.6414828377565339, 'psi': 0.816748043324061}-{'f1_val': 0.8239315995902052, 'auprc': 0.9645796473479948, 'loss_val': 0.4380389410904207, 'psi': 0.8801908186933212}
[S7] START round=24 head_norm_before_train=1.540626 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.6495772725704347, 'auprc': 0.7776045965192571, 'loss_val': 0.5543104374144302, 'psi': 0.7007882021499636}-{'f1_val': 0.6769263228598701, 'auprc': 0.8755508623797381, 'loss_val': 0.4894305030511265, 'psi': 0.7563761386678173}
[S8] START round=24 head_norm_before_train=1.317342 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9908644703267051, 'auprc': 0.9983981361234648, 'loss_val': 0.12600377759507375, 'psi': 0.9938779366454089}-{'f1_val': 0.990351025081079, 'auprc': 0.9980564736542055, 'loss_val': 0.09399313391879337, 'psi': 0.9934332045103296}
[S9] START round=24 head_norm_before_train=1.920442 (no previous merge yet)
[S9] round=24 local utility u=0.003399 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9952647941003852, 'loss_val': 0.026580648718866694, 'psi': 0.996102224728489}-{'f1_val': 0.9955763922175147, 'auprc': 0.9979716475698184, 'loss_val': 0.03499472468259771, 'psi': 0.9965344943584362}
[S10] START round=24 head_norm_before_train=1.726154 cos_to_last_merge=0.9995 (last merge round=22)
[S10] round=24 local utility u=0.005620 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9944754175211173, 'loss_val': 0.04420509489405985, 'psi': 0.9947710789274926}-{'f1_val': 0.9949681865317428, 'auprc': 0.9933955329347417, 'loss_val': 0.0522050378689548, 'psi': 0.9943391250929423}
[S11] START round=24 head_norm_before_train=1.689089 cos_to_last_merge=0.8031 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.803
[S11] round=24 local utility u=0.216517 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9984446697588615, 'loss_val': 0.050251640858680884, 'psi': 0.9971609683848612}-{'f1_val': 0.9550353105533866, 'auprc': 0.9920202510579508, 'loss_val': 0.21639346569623596, 'psi': 0.9698292867552123}
[S13] START round=24 head_norm_before_train=1.990766 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.127259 metrics={'f1_val': 0.5710188105738838, 'auprc': 0.6892798637827502, 'loss_val': 0.7966156400541163, 'psi': 0.6183232318574303}-{'f1_val': 0.539185534273122, 'auprc': 0.6745005234984582, 'loss_val': 0.8157965060283822, 'psi': 0.5933115299632565}
[S14] START round=24 head_norm_before_train=1.997231 cos_to_last_merge=0.9998 (last merge round=22)
[S14] round=24 local utility u=0.013965 metrics={'f1_val': 0.99705655548382, 'auprc': 0.9972628046106651, 'loss_val': 0.07059845903531412, 'psi': 0.997139055134558}-{'f1_val': 0.9950002216535363, 'auprc': 0.9988916671067888, 'loss_val': 0.0910779524932464, 'psi': 0.9965567998348372}
[S15] START round=24 head_norm_before_train=2.066511 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7680105259179802, 'auprc': 0.8990130521139635, 'loss_val': 0.4886065930211047, 'psi': 0.8204115363963735}-{'f1_val': 0.8818913278174388, 'auprc': 0.990686500300852, 'loss_val': 0.1793003014237576, 'psi': 0.9254093968108041}
[S16] START round=24 head_norm_before_train=1.380009 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.9257206504813893, 'auprc': 0.9829816025962196, 'loss_val': 0.43047749289580456, 'psi': 0.9486250313273213}-{'f1_val': 0.9905063795534047, 'auprc': 0.9864864588607749, 'loss_val': 0.16714684712557362, 'psi': 0.9888984112763528}
[S17] START round=24 head_norm_before_train=1.991738 (no previous merge yet)
[S17] round=24 local utility u=0.051395 metrics={'f1_val': 0.6089134839785926, 'auprc': 0.8690585713277106, 'loss_val': 1.086963109419808, 'psi': 0.7129715189182397}-{'f1_val': 0.5960082751780957, 'auprc': 0.8649735354418373, 'loss_val': 1.10006746359271, 'psi': 0.7035943792835924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:38411
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38408
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.764214)
[S7] loaded HEAD from S10 (vec_in norm=1.764214)
[S7] cosine check vs S10: cos=0.5795
[S7] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1802) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.018329)
[S13] loaded HEAD from S14 (vec_in norm=2.018329)
[S13] cosine check vs S14: cos=0.9988
[S13] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1803) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.710465)
[S10] loaded HEAD from S11 (vec_in norm=1.710465)
[S10] cosine check vs S11: cos=0.9897
[S10] BUFFERED delta from S11 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.931884)
[S3] loaded HEAD from S9 (vec_in norm=1.931884)
[S3] cosine check vs S9: cos=0.9985
[S3] BUFFERED delta from S9 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.706967)
[S3] loaded HEAD from S5 (vec_in norm=1.706967)
[S3] cosine check vs S5: cos=-0.0130
[S3] DROPPED delta from S5 (cos=-0.0130 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=2.007407)
[S16] loaded HEAD from S13 (vec_in norm=2.007407)
[S16] cosine check vs S13: cos=0.8960
[S16] BUFFERED delta from S13 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:38414
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.005222)
[S14] loaded HEAD from S17 (vec_in norm=2.005222)
[S14] cosine check vs S17: cos=0.9967
[S14] BUFFERED delta from S17 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:38407
[S3] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.937921)
[S6] loaded HEAD from S3 (vec_in norm=1.937921)
[S6] cosine check vs S3: cos=-0.1374
[S6] DROPPED delta from S3 (cos=-0.1374 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.9978 head_norm=1.937921
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.220461e-02
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.9978 head_norm=1.934201 delta_norm=0.052205
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.6496 head_norm=1.546904
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.652813e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.6291 head_norm=1.472082 delta_norm=0.765281
[S7] aggregate: ROLLBACK (f1_val pre=0.650 post=0.629 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9971 head_norm=2.018329
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.202067e-02
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9971 head_norm=2.010113 delta_norm=0.082021
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.9257 head_norm=1.413505
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.855137e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.9159 head_norm=1.666768 delta_norm=0.485514
[S16] aggregate: ROLLBACK (f1_val pre=0.926 post=0.916 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.5710 head_norm=2.007407
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.022244e-02
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.5708 head_norm=2.012249 delta_norm=0.050222
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=24 metric=0.9950 head_norm=1.764214
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.272757e-01
[S10] stored merged vector for next round verification (round=24)
[S10] DEBUG after merge:  round=24 metric=0.9947 head_norm=1.732879 delta_norm=0.127276
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.814737 cos_to_last_merge=0.8436 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.844
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.8299422246109674, 'auprc': 0.8883359367301478, 'loss_val': 0.4265299320003873, 'psi': 0.8532997094586396}-{'f1_val': 0.8299128935530112, 'auprc': 0.8957579051290058, 'loss_val': 0.4207543013022069, 'psi': 0.856250898183409}
[S3] START round=25 head_norm_before_train=1.934201 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9968311306697817, 'auprc': 0.9996172779726581, 'loss_val': 0.13075213177028808, 'psi': 0.9979455895909323}-{'f1_val': 0.9978100342676263, 'auprc': 0.9999850940911872, 'loss_val': 0.1011146446095875, 'psi': 0.9986800581970506}
[S4] START round=25 head_norm_before_train=1.769497 cos_to_last_merge=0.8124 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.812
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9410192037565325, 'auprc': 0.9398196687224396, 'loss_val': 0.28897989238974114, 'psi': 0.9405393897428953}-{'f1_val': 0.9408444832793613, 'auprc': 0.9428334267353362, 'loss_val': 0.2876806262116679, 'psi': 0.9416400606617512}
[S5] START round=25 head_norm_before_train=1.706967 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.4404155503931504, 'auprc': 0.8536752994949668, 'loss_val': 0.6515482842107714, 'psi': 0.605719450033877}-{'f1_val': 0.5985773114445506, 'auprc': 0.858333800434985, 'loss_val': 0.39651795431132464, 'psi': 0.7024799070407244}
[S6] START round=25 head_norm_before_train=1.905774 (no previous merge yet)
[S6] round=25 local utility u=0.510371 metrics={'f1_val': 0.8626422356845004, 'auprc': 0.9597851327109526, 'loss_val': 0.4647456897508963, 'psi': 0.9014993944950813}-{'f1_val': 0.7237289142715966, 'auprc': 0.9562767369027576, 'loss_val': 0.6414828377565339, 'psi': 0.816748043324061}
[S7] START round=25 head_norm_before_train=1.472082 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.5935399293680651, 'auprc': 0.7797592949157719, 'loss_val': 0.7632352279088599, 'psi': 0.6680276755871478}-{'f1_val': 0.6495772725704347, 'auprc': 0.7776045965192571, 'loss_val': 0.5543104374144302, 'psi': 0.7007882021499636}
[S8] START round=25 head_norm_before_train=1.369576 cos_to_last_merge=0.9987 (last merge round=23)
[S8] round=25 local utility u=0.022853 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9975095518033631, 'loss_val': 0.08761830564913178, 'psi': 0.994521202315737}-{'f1_val': 0.9908644703267051, 'auprc': 0.9983981361234648, 'loss_val': 0.12600377759507375, 'psi': 0.9938779366454089}
[S9] START round=25 head_norm_before_train=1.931884 (no previous merge yet)
[S9] round=25 local utility u=0.006860 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9992606779136122, 'loss_val': 0.0250192743468164, 'psi': 0.997717760144148}-{'f1_val': 0.9966605118138915, 'auprc': 0.9952647941003852, 'loss_val': 0.026580648718866694, 'psi': 0.996102224728489}
[S10] START round=25 head_norm_before_train=1.732879 cos_to_last_merge=1.0000 (last merge round=24)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9939865028250828, 'loss_val': 0.04760896240654526, 'psi': 0.9945755130490788}-{'f1_val': 0.9949681865317428, 'auprc': 0.9944754175211173, 'loss_val': 0.04420509489405985, 'psi': 0.9947710789274926}
[S11] START round=25 head_norm_before_train=1.710465 cos_to_last_merge=0.8006 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.801
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9915134273819638, 'auprc': 0.998388327379904, 'loss_val': 0.05862902387163014, 'psi': 0.9942633873811398}-{'f1_val': 0.996305167468861, 'auprc': 0.9984446697588615, 'loss_val': 0.050251640858680884, 'psi': 0.9971609683848612}
[S13] START round=25 head_norm_before_train=2.012249 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.5326182159761579, 'auprc': 0.6757411757646031, 'loss_val': 0.9150788247681971, 'psi': 0.589867399891536}-{'f1_val': 0.5710188105738838, 'auprc': 0.6892798637827502, 'loss_val': 0.7966156400541163, 'psi': 0.6183232318574303}
[S14] START round=25 head_norm_before_train=2.010113 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9643320756656351, 'auprc': 0.9991185109400599, 'loss_val': 0.09289013369827596, 'psi': 0.978246649775405}-{'f1_val': 0.99705655548382, 'auprc': 0.9972628046106651, 'loss_val': 0.07059845903531412, 'psi': 0.997139055134558}
[S15] START round=25 head_norm_before_train=2.082335 (no previous merge yet)
[S15] round=25 local utility u=0.414176 metrics={'f1_val': 0.823231059584243, 'auprc': 0.9900723927006111, 'loss_val': 0.26475663481870426, 'psi': 0.8899675928307902}-{'f1_val': 0.7680105259179802, 'auprc': 0.8990130521139635, 'loss_val': 0.4886065930211047, 'psi': 0.8204115363963735}
[S16] START round=25 head_norm_before_train=1.666768 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.8732296239194419, 'auprc': 0.9699308680228018, 'loss_val': 0.5654984215305721, 'psi': 0.9119101215607859}-{'f1_val': 0.9257206504813893, 'auprc': 0.9829816025962196, 'loss_val': 0.43047749289580456, 'psi': 0.9486250313273213}
[S17] START round=25 head_norm_before_train=2.005222 (no previous merge yet)
[S17] round=25 local utility u=0.107420 metrics={'f1_val': 0.6100235415806355, 'auprc': 0.9553682231159429, 'loss_val': 1.137713056531722, 'psi': 0.7481614141947586}-{'f1_val': 0.6089134839785926, 'auprc': 0.8690585713277106, 'loss_val': 1.086963109419808, 'psi': 0.7129715189182397}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38408
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:38403
[S8] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.925748)
[S7] loaded HEAD from S6 (vec_in norm=1.925748)
[S7] cosine check vs S6: cos=0.1473
[S7] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1804) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.093831)
[S7] loaded HEAD from S15 (vec_in norm=2.093831)
[S7] cosine check vs S15: cos=0.7608
[S7] BUFFERED delta from S15 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1798) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.421416)
[S16] loaded HEAD from S8 (vec_in norm=1.421416)
[S16] cosine check vs S8: cos=0.2303
[S16] BUFFERED delta from S8 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.945361)
[S3] loaded HEAD from S9 (vec_in norm=1.945361)
[S3] cosine check vs S9: cos=0.9988
[S3] BUFFERED delta from S9 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.021637)
[S14] loaded HEAD from S17 (vec_in norm=2.021637)
[S14] cosine check vs S17: cos=0.9982
[S14] BUFFERED delta from S17 (total buffered=1)
[S13] ⇄ pheromone p=0.122 → S16@127.0.0.1:38416
[S2] ⇄ pheromone p=0.077 → S5@127.0.0.1:38405
[S10] ⇄ pheromone p=0.018 → S7@127.0.0.1:38408
[S11] ⇄ pheromone p=0.121 → S10@127.0.0.1:38411
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.5935 head_norm=1.478455
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.007975e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.6207 head_norm=1.322228 delta_norm=0.600798
[S7] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.229 → S8@127.0.0.1:38409
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.9968 head_norm=1.951165
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.691917e-02
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.9968 head_norm=1.947700 delta_norm=0.046919
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.147 → S6@127.0.0.1:38407
[S5] ⇄ pheromone p=0.106 → S3@127.0.0.1:38403
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9643 head_norm=2.029061
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.107440e-02
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9597 head_norm=2.024431 delta_norm=0.061074
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.079 → S13@127.0.0.1:38413
[S4] ⇄ pheromone p=0.024 → S8@127.0.0.1:38409
[S15] ⇄ pheromone p=0.358 → S7@127.0.0.1:38408
[S8] ⇄ pheromone p=0.031 → S16@127.0.0.1:38416
[S6] ⇄ pheromone p=0.350 → S7@127.0.0.1:38408
[S9] ⇄ pheromone p=0.033 → S3@127.0.0.1:38403
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.8732 head_norm=1.691948
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.715425e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.8773 head_norm=1.223790 delta_norm=0.971543
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.139 → S4@127.0.0.1:38404
[S17] ⇄ pheromone p=0.112 → S14@127.0.0.1:38414
[S2] START round=26 head_norm_before_train=1.825785 cos_to_last_merge=0.8424 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.842
[S2] round=26 local utility u=0.011128 metrics={'f1_val': 0.8291915756590541, 'auprc': 0.9002887728866271, 'loss_val': 0.43562784562717566, 'psi': 0.8576304545500832}-{'f1_val': 0.8299422246109674, 'auprc': 0.8883359367301478, 'loss_val': 0.4265299320003873, 'psi': 0.8532997094586396}
[S3] START round=26 head_norm_before_train=1.947700 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9746816052812316, 'auprc': 0.9999897502082206, 'loss_val': 0.09476043199452182, 'psi': 0.9848048632520272}-{'f1_val': 0.9968311306697817, 'auprc': 0.9996172779726581, 'loss_val': 0.13075213177028808, 'psi': 0.9979455895909323}
[S4] START round=26 head_norm_before_train=1.783334 cos_to_last_merge=0.8120 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.812
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.940869660232084, 'auprc': 0.9362531092517231, 'loss_val': 0.2992520831148972, 'psi': 0.9390230398399396}-{'f1_val': 0.9410192037565325, 'auprc': 0.9398196687224396, 'loss_val': 0.28897989238974114, 'psi': 0.9405393897428953}
[S5] START round=26 head_norm_before_train=1.716257 (no previous merge yet)
[S5] round=26 local utility u=1.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9735272267703766, 'loss_val': 0.27276814534898103, 'psi': 0.809603249802966}-{'f1_val': 0.4404155503931504, 'auprc': 0.8536752994949668, 'loss_val': 0.6515482842107714, 'psi': 0.605719450033877}
[S6] START round=26 head_norm_before_train=1.925748 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.7177102106134503, 'auprc': 0.9573899567394801, 'loss_val': 0.7264435206978344, 'psi': 0.8135821090638622}-{'f1_val': 0.8626422356845004, 'auprc': 0.9597851327109526, 'loss_val': 0.4647456897508963, 'psi': 0.9014993944950813}
[S7] START round=26 head_norm_before_train=1.322228 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5410370585545663, 'auprc': 0.7820321365552062, 'loss_val': 0.8129252446885668, 'psi': 0.6374350897548222}-{'f1_val': 0.5935399293680651, 'auprc': 0.7797592949157719, 'loss_val': 0.7632352279088599, 'psi': 0.6680276755871478}
[S8] START round=26 head_norm_before_train=1.421416 cos_to_last_merge=0.9957 (last merge round=23)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9729833356986195, 'auprc': 0.9985006672858683, 'loss_val': 0.11218444747327004, 'psi': 0.983190268333519}-{'f1_val': 0.9925289693239863, 'auprc': 0.9975095518033631, 'loss_val': 0.08761830564913178, 'psi': 0.994521202315737}
[S9] START round=26 head_norm_before_train=1.945361 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9893026945281196, 'auprc': 0.9990227136558688, 'loss_val': 0.039490464794227007, 'psi': 0.9931907021792192}-{'f1_val': 0.9966891482978385, 'auprc': 0.9992606779136122, 'loss_val': 0.0250192743468164, 'psi': 0.997717760144148}
[S10] START round=26 head_norm_before_train=1.766433 cos_to_last_merge=0.9997 (last merge round=24)
[S10] round=26 local utility u=0.004302 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9942004369861824, 'loss_val': 0.04096504160681709, 'psi': 0.9947928782060977}-{'f1_val': 0.9949681865317428, 'auprc': 0.9939865028250828, 'loss_val': 0.04760896240654526, 'psi': 0.9945755130490788}
[S11] START round=26 head_norm_before_train=1.732338 cos_to_last_merge=0.7984 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.798
[S11] round=26 local utility u=0.012793 metrics={'f1_val': 0.9943832894246155, 'auprc': 0.9984054907317805, 'loss_val': 0.05031305161847824, 'psi': 0.9959921699474816}-{'f1_val': 0.9915134273819638, 'auprc': 0.998388327379904, 'loss_val': 0.05862902387163014, 'psi': 0.9942633873811398}
[S13] START round=26 head_norm_before_train=2.023580 cos_to_last_merge=0.9999 (last merge round=24)
[S13] round=26 local utility u=0.083857 metrics={'f1_val': 0.5472278852389965, 'auprc': 0.6820448343718425, 'loss_val': 0.8539328957885746, 'psi': 0.6011546648921349}-{'f1_val': 0.5326182159761579, 'auprc': 0.6757411757646031, 'loss_val': 0.9150788247681971, 'psi': 0.589867399891536}
[S14] START round=26 head_norm_before_train=2.024431 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.025958 metrics={'f1_val': 0.9716264204096879, 'auprc': 0.999027011478061, 'loss_val': 0.08446598055006346, 'psi': 0.9825866568370372}-{'f1_val': 0.9643320756656351, 'auprc': 0.9991185109400599, 'loss_val': 0.09289013369827596, 'psi': 0.978246649775405}
[S15] START round=26 head_norm_before_train=2.093831 (no previous merge yet)
[S15] round=26 local utility u=0.546172 metrics={'f1_val': 0.9704797095968619, 'auprc': 0.9920665112888367, 'loss_val': 0.06188778143004386, 'psi': 0.9791144302736519}-{'f1_val': 0.823231059584243, 'auprc': 0.9900723927006111, 'loss_val': 0.26475663481870426, 'psi': 0.8899675928307902}
[S16] START round=26 head_norm_before_train=1.223790 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.010244 metrics={'f1_val': 0.872460733208773, 'auprc': 0.9788090649967514, 'loss_val': 0.5670307840846738, 'psi': 0.9150000659239643}-{'f1_val': 0.8732296239194419, 'auprc': 0.9699308680228018, 'loss_val': 0.5654984215305721, 'psi': 0.9119101215607859}
[S17] START round=26 head_norm_before_train=2.021637 (no previous merge yet)
[S17] round=26 local utility u=0.163705 metrics={'f1_val': 0.6327754163687345, 'auprc': 0.9935801664834574, 'loss_val': 1.0614501461399688, 'psi': 0.7770973164146237}-{'f1_val': 0.6100235415806355, 'auprc': 0.9553682231159429, 'loss_val': 1.137713056531722, 'psi': 0.7481614141947586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:38411
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:38411
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.979)
[S11] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=2.035794)
[S16] loaded HEAD from S13 (vec_in norm=2.035794)
[S16] cosine check vs S13: cos=0.6767
[S16] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.040327)
[S13] loaded HEAD from S14 (vec_in norm=2.040327)
[S13] cosine check vs S14: cos=0.9974
[S13] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.751992)
[S10] loaded HEAD from S11 (vec_in norm=1.751992)
[S10] cosine check vs S11: cos=0.9922
[S10] BUFFERED delta from S11 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1803) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.721781)
[S10] loaded HEAD from S5 (vec_in norm=1.721781)
[S10] cosine check vs S5: cos=0.0074
[S10] BUFFERED delta from S5 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.800763)
[S7] loaded HEAD from S10 (vec_in norm=1.800763)
[S7] cosine check vs S10: cos=0.6851
[S7] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.271934)
[S4] loaded HEAD from S16 (vec_in norm=1.271934)
[S4] cosine check vs S16: cos=-0.2246
[S4] DROPPED delta from S16 (cos=-0.2246 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.777)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.5410 head_norm=1.331804
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.576729e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.4733 head_norm=1.440726 delta_norm=0.657673
[S7] aggregate: ROLLBACK (f1_val pre=0.541 post=0.473 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.8725 head_norm=1.271934
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.513245e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.8660 head_norm=1.522054 delta_norm=0.751325
[S16] aggregate: ROLLBACK (f1_val pre=0.872 post=0.866 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.9952 head_norm=1.800763
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.341979e-01
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.9952 head_norm=1.406663 delta_norm=0.634198
[S10] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.5472 head_norm=2.035794
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.329480e-02
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.5507 head_norm=2.036743 delta_norm=0.073295
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.842098 cos_to_last_merge=0.8411 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.841
[S2] round=27 local utility u=0.141905 metrics={'f1_val': 0.887405310943439, 'auprc': 0.8341921318964498, 'loss_val': 0.30281046442478, 'psi': 0.8661200393246433}-{'f1_val': 0.8291915756590541, 'auprc': 0.9002887728866271, 'loss_val': 0.43562784562717566, 'psi': 0.8576304545500832}
[S3] START round=27 head_norm_before_train=1.964639 cos_to_last_merge=0.9998 (last merge round=25)
[S3] round=27 local utility u=0.059783 metrics={'f1_val': 0.9935429260875812, 'auprc': 0.9998587872393954, 'loss_val': 0.08796936351693793, 'psi': 0.9960692705483069}-{'f1_val': 0.9746816052812316, 'auprc': 0.9999897502082206, 'loss_val': 0.09476043199452182, 'psi': 0.9848048632520272}
[S4] START round=27 head_norm_before_train=1.795166 cos_to_last_merge=0.8121 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.812
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.940471371504316, 'auprc': 0.9356051517124846, 'loss_val': 0.3119874378090535, 'psi': 0.9385248835875835}-{'f1_val': 0.940869660232084, 'auprc': 0.9362531092517231, 'loss_val': 0.2992520831148972, 'psi': 0.9390230398399396}
[S5] START round=27 head_norm_before_train=1.721781 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8516178633054365, 'loss_val': 0.3674335936691919, 'psi': 0.76083950441699}-{'f1_val': 0.700320598491359, 'auprc': 0.9735272267703766, 'loss_val': 0.27276814534898103, 'psi': 0.809603249802966}
[S6] START round=27 head_norm_before_train=1.940265 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.5963143634065974, 'auprc': 0.9349176392099865, 'loss_val': 1.0545759575809983, 'psi': 0.731755673727953}-{'f1_val': 0.7177102106134503, 'auprc': 0.9573899567394801, 'loss_val': 0.7264435206978344, 'psi': 0.8135821090638622}
[S7] START round=27 head_norm_before_train=1.440726 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.066023 metrics={'f1_val': 0.563634198585137, 'auprc': 0.7821918050162542, 'loss_val': 0.8169409500064391, 'psi': 0.6510572411575839}-{'f1_val': 0.5410370585545663, 'auprc': 0.7820321365552062, 'loss_val': 0.8129252446885668, 'psi': 0.6374350897548222}
[S8] START round=27 head_norm_before_train=1.467826 cos_to_last_merge=0.9923 (last merge round=23)
[S8] round=27 local utility u=0.049228 metrics={'f1_val': 0.9843044951922839, 'auprc': 0.9985517177258103, 'loss_val': 0.08180877283498889, 'psi': 0.9900033842056946}-{'f1_val': 0.9729833356986195, 'auprc': 0.9985006672858683, 'loss_val': 0.11218444747327004, 'psi': 0.983190268333519}
[S9] START round=27 head_norm_before_train=1.959652 (no previous merge yet)
[S9] round=27 local utility u=0.028846 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9989571487942812, 'loss_val': 0.02341152863241338, 'psi': 0.9973454769559562}-{'f1_val': 0.9893026945281196, 'auprc': 0.9990227136558688, 'loss_val': 0.039490464794227007, 'psi': 0.9931907021792192}
[S10] START round=27 head_norm_before_train=1.406663 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9932243975866697, 'loss_val': 0.07634003653363448, 'psi': 0.9944024624462927}-{'f1_val': 0.9951878390193748, 'auprc': 0.9942004369861824, 'loss_val': 0.04096504160681709, 'psi': 0.9947928782060977}
[S11] START round=27 head_norm_before_train=1.751992 cos_to_last_merge=0.7966 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.797
[S11] round=27 local utility u=0.006772 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9984781465735129, 'loss_val': 0.04603921027131482, 'psi': 0.9969263613505536}-{'f1_val': 0.9943832894246155, 'auprc': 0.9984054907317805, 'loss_val': 0.05031305161847824, 'psi': 0.9959921699474816}
[S13] START round=27 head_norm_before_train=2.036743 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.162646 metrics={'f1_val': 0.5727316621376325, 'auprc': 0.6853152385598994, 'loss_val': 0.6914738139061712, 'psi': 0.6177650927065392}-{'f1_val': 0.5472278852389965, 'auprc': 0.6820448343718425, 'loss_val': 0.8539328957885746, 'psi': 0.6011546648921349}
[S14] START round=27 head_norm_before_train=2.040327 cos_to_last_merge=0.9999 (last merge round=25)
[S14] round=27 local utility u=0.092361 metrics={'f1_val': 0.9974537796719909, 'auprc': 0.9991120964261389, 'loss_val': 0.054963439642237204, 'psi': 0.99811710637365}-{'f1_val': 0.9716264204096879, 'auprc': 0.999027011478061, 'loss_val': 0.08446598055006346, 'psi': 0.9825866568370372}
[S15] START round=27 head_norm_before_train=2.108133 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.8522305479345378, 'auprc': 0.990298219181581, 'loss_val': 0.24777841579990706, 'psi': 0.907457616433355}-{'f1_val': 0.9704797095968619, 'auprc': 0.9920665112888367, 'loss_val': 0.06188778143004386, 'psi': 0.9791144302736519}
[S16] START round=27 head_norm_before_train=1.522054 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.453164 metrics={'f1_val': 0.9699945136603371, 'auprc': 0.9850904030725465, 'loss_val': 0.2647486415361286, 'psi': 0.9760328694252208}-{'f1_val': 0.872460733208773, 'auprc': 0.9788090649967514, 'loss_val': 0.5670307840846738, 'psi': 0.9150000659239643}
[S17] START round=27 head_norm_before_train=2.039100 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.6191767912481538, 'auprc': 0.8413003660254412, 'loss_val': 1.2226990605803334, 'psi': 0.7080262211590689}-{'f1_val': 0.6327754163687345, 'auprc': 0.9935801664834574, 'loss_val': 1.0614501461399688, 'psi': 0.7770973164146237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:38408
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:38417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38414
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:38413
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:38415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=2.045412)
[S14] loaded HEAD from S13 (vec_in norm=2.045412)
[S14] cosine check vs S13: cos=0.9991
[S14] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.448647)
[S15] loaded HEAD from S7 (vec_in norm=1.448647)
[S15] cosine check vs S7: cos=0.6445
[S15] BUFFERED delta from S7 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1804) from S16
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.553136)
[S13] loaded HEAD from S16 (vec_in norm=1.553136)
[S13] cosine check vs S16: cos=0.9394
[S13] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.505813)
[S7] loaded HEAD from S8 (vec_in norm=1.505813)
[S7] cosine check vs S8: cos=0.8569
[S7] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.983192)
[S5] loaded HEAD from S3 (vec_in norm=1.983192)
[S5] cosine check vs S3: cos=-0.0133
[S5] DROPPED delta from S3 (cos=-0.0133 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.058725)
[S17] loaded HEAD from S14 (vec_in norm=2.058725)
[S17] cosine check vs S14: cos=0.9976
[S17] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.5636 head_norm=1.448647
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.961330e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.5876 head_norm=1.423413 delta_norm=0.396133
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9975 head_norm=2.058725
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.509566e-02
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9975 head_norm=2.051584 delta_norm=0.045096
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.5727 head_norm=2.045412
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.960779e-01
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.5889 head_norm=1.772313 delta_norm=0.396078
[S13] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.8522 head_norm=2.125382
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.134929e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.8336 head_norm=1.626697 delta_norm=0.813493
[S15] aggregate: ROLLBACK (f1_val pre=0.852 post=0.834 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.6192 head_norm=2.052867
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.058465e-02
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.6212 head_norm=2.054586 delta_norm=0.070585
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.856131 cos_to_last_merge=0.8398 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.840
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.781637567820822, 'auprc': 0.7938994625456766, 'loss_val': 0.6226915189774096, 'psi': 0.7865423257107639}-{'f1_val': 0.887405310943439, 'auprc': 0.8341921318964498, 'loss_val': 0.30281046442478, 'psi': 0.8661200393246433}
[S3] START round=28 head_norm_before_train=1.983192 cos_to_last_merge=0.9994 (last merge round=25)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9636501394989305, 'auprc': 0.9989748305107773, 'loss_val': 0.128060836690066, 'psi': 0.9777800159036693}-{'f1_val': 0.9935429260875812, 'auprc': 0.9998587872393954, 'loss_val': 0.08796936351693793, 'psi': 0.9960692705483069}
[S4] START round=28 head_norm_before_train=1.803238 cos_to_last_merge=0.8120 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.812
[S4] round=28 local utility u=0.036260 metrics={'f1_val': 0.943401653147767, 'auprc': 0.9442144464498394, 'loss_val': 0.2828764735895205, 'psi': 0.943726770468596}-{'f1_val': 0.940471371504316, 'auprc': 0.9356051517124846, 'loss_val': 0.3119874378090535, 'psi': 0.9385248835875835}
[S5] START round=28 head_norm_before_train=1.728593 (no previous merge yet)
[S5] round=28 local utility u=0.301420 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.9908427654815799, 'loss_val': 0.18382704314820564, 'psi': 0.8166852569110362}-{'f1_val': 0.700320598491359, 'auprc': 0.8516178633054365, 'loss_val': 0.3674335936691919, 'psi': 0.76083950441699}
[S6] START round=28 head_norm_before_train=1.947790 (no previous merge yet)
[S6] round=28 local utility u=0.979413 metrics={'f1_val': 0.8116881063064152, 'auprc': 0.9686108268720485, 'loss_val': 0.4890710923234476, 'psi': 0.8744571945326685}-{'f1_val': 0.5963143634065974, 'auprc': 0.9349176392099865, 'loss_val': 1.0545759575809983, 'psi': 0.731755673727953}
[S7] START round=28 head_norm_before_train=1.423413 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.206886 metrics={'f1_val': 0.6054232208772445, 'auprc': 0.794560399127634, 'loss_val': 0.6910079615583744, 'psi': 0.6810780921774002}-{'f1_val': 0.563634198585137, 'auprc': 0.7821918050162542, 'loss_val': 0.8169409500064391, 'psi': 0.6510572411575839}
[S8] START round=28 head_norm_before_train=1.505813 cos_to_last_merge=0.9891 (last merge round=23)
[S8] round=28 local utility u=0.037255 metrics={'f1_val': 0.993235056744646, 'auprc': 0.9978564632923909, 'loss_val': 0.058795411942108154, 'psi': 0.9950836193637439}-{'f1_val': 0.9843044951922839, 'auprc': 0.9985517177258103, 'loss_val': 0.08180877283498889, 'psi': 0.9900033842056946}
[S9] START round=28 head_norm_before_train=1.973622 (no previous merge yet)
[S9] round=28 local utility u=0.003498 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987923922098945, 'loss_val': 0.020913335656206223, 'psi': 0.9977787043912435}-{'f1_val': 0.9962710290637395, 'auprc': 0.9989571487942812, 'loss_val': 0.02341152863241338, 'psi': 0.9973454769559562}
[S10] START round=28 head_norm_before_train=1.461608 cos_to_last_merge=0.9987 (last merge round=26)
[S10] round=28 local utility u=0.011830 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9946799275909922, 'loss_val': 0.055728870107450625, 'psi': 0.9948528829554426}-{'f1_val': 0.9951878390193748, 'auprc': 0.9932243975866697, 'loss_val': 0.07634003653363448, 'psi': 0.9944024624462927}
[S11] START round=28 head_norm_before_train=1.771174 cos_to_last_merge=0.7948 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.795
[S11] round=28 local utility u=0.000836 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9984709196718771, 'loss_val': 0.0443456782756328, 'psi': 0.9969234705898993}-{'f1_val': 0.9958918378685807, 'auprc': 0.9984781465735129, 'loss_val': 0.04603921027131482, 'psi': 0.9969263613505536}
[S13] START round=28 head_norm_before_train=1.772313 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5543752279804832, 'auprc': 0.6975673465461997, 'loss_val': 0.8843011698856891, 'psi': 0.6116520754067698}-{'f1_val': 0.5727316621376325, 'auprc': 0.6853152385598994, 'loss_val': 0.6914738139061712, 'psi': 0.6177650927065392}
[S14] START round=28 head_norm_before_train=2.051584 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.003497 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9992531464084529, 'loss_val': 0.04579092475657074, 'psi': 0.9979134322371066}-{'f1_val': 0.9974537796719909, 'auprc': 0.9991120964261389, 'loss_val': 0.054963439642237204, 'psi': 0.99811710637365}
[S15] START round=28 head_norm_before_train=1.626697 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.022213 metrics={'f1_val': 0.8526568384337321, 'auprc': 0.9902703608577885, 'loss_val': 0.20582641168027208, 'psi': 0.9077022474033547}-{'f1_val': 0.8522305479345378, 'auprc': 0.990298219181581, 'loss_val': 0.24777841579990706, 'psi': 0.907457616433355}
[S16] START round=28 head_norm_before_train=1.553136 cos_to_last_merge=0.9981 (last merge round=26)
[S16] round=28 local utility u=0.120368 metrics={'f1_val': 0.9899000894778215, 'auprc': 0.9886904796847132, 'loss_val': 0.15424625012250265, 'psi': 0.9894162455605782}-{'f1_val': 0.9699945136603371, 'auprc': 0.9850904030725465, 'loss_val': 0.2647486415361286, 'psi': 0.9760328694252208}
[S17] START round=28 head_norm_before_train=2.054586 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.343413 metrics={'f1_val': 0.6418812464759479, 'auprc': 0.9740223884121512, 'loss_val': 1.0702658436306192, 'psi': 0.7747377032504292}-{'f1_val': 0.6191767912481538, 'auprc': 0.8413003660254412, 'loss_val': 1.2226990605803334, 'psi': 0.7080262211590689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:38415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:38402
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:38412
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:38417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[S6] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S16
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.590155)
[S13] loaded HEAD from S16 (vec_in norm=1.590155)
[S13] cosine check vs S16: cos=0.9717
[S13] BUFFERED delta from S16 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.432764)
[S15] loaded HEAD from S7 (vec_in norm=1.432764)
[S15] cosine check vs S7: cos=0.8662
[S15] BUFFERED delta from S7 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S10
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.526675)
[S11] loaded HEAD from S10 (vec_in norm=1.526675)
[S11] cosine check vs S10: cos=0.9445
[S11] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.537857)
[S7] loaded HEAD from S8 (vec_in norm=1.537857)
[S7] cosine check vs S8: cos=0.9630
[S7] BUFFERED delta from S8 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1802) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.955305)
[S3] loaded HEAD from S6 (vec_in norm=1.955305)
[S3] cosine check vs S6: cos=-0.1377
[S3] DROPPED delta from S6 (cos=-0.1377 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1806) from S5
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.735711)
[S2] loaded HEAD from S5 (vec_in norm=1.735711)
[S2] cosine check vs S5: cos=-0.0903
[S2] DROPPED delta from S5 (cos=-0.0903 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.071347)
[S17] loaded HEAD from S14 (vec_in norm=2.071347)
[S17] cosine check vs S14: cos=0.9982
[S17] BUFFERED delta from S14 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.808754)
[S16] loaded HEAD from S4 (vec_in norm=1.808754)
[S16] cosine check vs S4: cos=-0.1640
[S16] DROPPED delta from S4 (cos=-0.1640 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.5544 head_norm=1.787043
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.234452e-01
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.5639 head_norm=1.676643 delta_norm=0.223445
[S13] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=28 metric=0.9959 head_norm=1.790216
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.051938e-01
[S11] stored merged vector for next round verification (round=28)
[S11] DEBUG after merge:  round=28 metric=0.9959 head_norm=1.635439 delta_norm=0.305194
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.6054 head_norm=1.432764
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.085243e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.6126 head_norm=1.471539 delta_norm=0.208524
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.6419 head_norm=2.067281
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.171300e-02
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.6440 head_norm=2.068394 delta_norm=0.061713
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.8527 head_norm=1.656045
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.137497e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.8454 head_norm=1.492133 delta_norm=0.413750
[S15] aggregate: ROLLBACK (f1_val pre=0.853 post=0.845 tol_abs=0.005 tol_rel=0.0)
[S2] START round=29 head_norm_before_train=1.870313 cos_to_last_merge=0.8386 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.839
[S2] round=29 local utility u=0.422133 metrics={'f1_val': 0.8312269254611401, 'auprc': 0.9071540309637618, 'loss_val': 0.41572550328800467, 'psi': 0.8615977676621888}-{'f1_val': 0.781637567820822, 'auprc': 0.7938994625456766, 'loss_val': 0.6226915189774096, 'psi': 0.7865423257107639}
[S3] START round=29 head_norm_before_train=2.002637 cos_to_last_merge=0.9985 (last merge round=25)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.7891584458153569, 'auprc': 0.9985619324771158, 'loss_val': 0.33770620658891165, 'psi': 0.8729198404800604}-{'f1_val': 0.9636501394989305, 'auprc': 0.9989748305107773, 'loss_val': 0.128060836690066, 'psi': 0.9777800159036693}
[S4] START round=29 head_norm_before_train=1.808754 cos_to_last_merge=0.8117 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.812
[S4] round=29 local utility u=0.033219 metrics={'f1_val': 0.943382822776673, 'auprc': 0.9669424360972831, 'loss_val': 0.2845089576798114, 'psi': 0.952806668104917}-{'f1_val': 0.943401653147767, 'auprc': 0.9442144464498394, 'loss_val': 0.2828764735895205, 'psi': 0.943726770468596}
[S5] START round=29 head_norm_before_train=1.735711 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.6545164603411766, 'auprc': 0.8559583387080291, 'loss_val': 0.47630557198886075, 'psi': 0.7350932116879176}-{'f1_val': 0.7005802511973405, 'auprc': 0.9908427654815799, 'loss_val': 0.18382704314820564, 'psi': 0.8166852569110362}
[S6] START round=29 head_norm_before_train=1.955305 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.7795198218710073, 'auprc': 0.9656939024309553, 'loss_val': 0.5757685047393722, 'psi': 0.8539894540949865}-{'f1_val': 0.8116881063064152, 'auprc': 0.9686108268720485, 'loss_val': 0.4890710923234476, 'psi': 0.8744571945326685}
[S7] START round=29 head_norm_before_train=1.471539 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.363832 metrics={'f1_val': 0.6713424126740902, 'auprc': 0.8317325546151677, 'loss_val': 0.4703756643167426, 'psi': 0.7354984694505212}-{'f1_val': 0.6054232208772445, 'auprc': 0.794560399127634, 'loss_val': 0.6910079615583744, 'psi': 0.6810780921774002}
[S8] START round=29 head_norm_before_train=1.537857 cos_to_last_merge=0.9863 (last merge round=23)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9864258722700556, 'auprc': 0.9986356842315258, 'loss_val': 0.06246225158479674, 'psi': 0.9913097970546437}-{'f1_val': 0.993235056744646, 'auprc': 0.9978564632923909, 'loss_val': 0.058795411942108154, 'psi': 0.9950836193637439}
[S9] START round=29 head_norm_before_train=1.987369 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9985304069299563, 'loss_val': 0.02534722630062331, 'psi': 0.9956574677658075}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987923922098945, 'loss_val': 0.020913335656206223, 'psi': 0.9977787043912435}
[S10] START round=29 head_norm_before_train=1.526675 cos_to_last_merge=0.9950 (last merge round=26)
[S10] round=29 local utility u=0.005536 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.995002509837227, 'loss_val': 0.04562446903975681, 'psi': 0.9949819158539366}-{'f1_val': 0.9949681865317428, 'auprc': 0.9946799275909922, 'loss_val': 0.055728870107450625, 'psi': 0.9948528829554426}
[S11] START round=29 head_norm_before_train=1.635439 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.998442881882434, 'loss_val': 0.04548076083091037, 'psi': 0.9969122554741221}-{'f1_val': 0.9958918378685807, 'auprc': 0.9984709196718771, 'loss_val': 0.0443456782756328, 'psi': 0.9969234705898993}
[S13] START round=29 head_norm_before_train=1.676643 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5316219263097961, 'auprc': 0.6515689161705581, 'loss_val': 0.8821685140293088, 'psi': 0.5796007222541009}-{'f1_val': 0.5543752279804832, 'auprc': 0.6975673465461997, 'loss_val': 0.8843011698856891, 'psi': 0.6116520754067698}
[S14] START round=29 head_norm_before_train=2.071347 cos_to_last_merge=0.9998 (last merge round=27)
[S14] round=29 local utility u=0.003321 metrics={'f1_val': 0.9970857023581083, 'auprc': 0.9994912988179171, 'loss_val': 0.04025553427520971, 'psi': 0.9980479409420319}-{'f1_val': 0.9970202894562089, 'auprc': 0.9992531464084529, 'loss_val': 0.04579092475657074, 'psi': 0.9979134322371066}
[S15] START round=29 head_norm_before_train=1.492133 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.279795 metrics={'f1_val': 0.9314749012826308, 'auprc': 0.9918369111630816, 'loss_val': 0.12384530587074087, 'psi': 0.955619705234811}-{'f1_val': 0.8526568384337321, 'auprc': 0.9902703608577885, 'loss_val': 0.20582641168027208, 'psi': 0.9077022474033547}
[S16] START round=29 head_norm_before_train=1.590155 cos_to_last_merge=0.9932 (last merge round=26)
[S16] round=29 local utility u=0.015724 metrics={'f1_val': 0.9894624497877258, 'auprc': 0.9891117585034825, 'loss_val': 0.12143592189609692, 'psi': 0.9893221732740285}-{'f1_val': 0.9899000894778215, 'auprc': 0.9886904796847132, 'loss_val': 0.15424625012250265, 'psi': 0.9894162455605782}
[S17] START round=29 head_norm_before_train=2.068394 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.6373240113161047, 'auprc': 0.9905391303965491, 'loss_val': 1.1133843897872484, 'psi': 0.7786100589482825}-{'f1_val': 0.6418812464759479, 'auprc': 0.9740223884121512, 'loss_val': 1.0702658436306192, 'psi': 0.7747377032504292}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:38417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:38412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:38416
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:38415
[S4] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1789 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S16
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.626129)
[S13] loaded HEAD from S16 (vec_in norm=1.626129)
[S13] cosine check vs S16: cos=0.9866
[S13] BUFFERED delta from S16 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1789) from S10
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.582182)
[S11] loaded HEAD from S10 (vec_in norm=1.582182)
[S11] cosine check vs S10: cos=0.9813
[S11] BUFFERED delta from S10 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1794) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.822130)
[S16] loaded HEAD from S4 (vec_in norm=1.822130)
[S16] cosine check vs S4: cos=-0.1699
[S16] DROPPED delta from S4 (cos=-0.1699 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.477903)
[S15] loaded HEAD from S7 (vec_in norm=1.477903)
[S15] cosine check vs S7: cos=0.9284
[S15] BUFFERED delta from S7 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.090343)
[S17] loaded HEAD from S14 (vec_in norm=2.090343)
[S17] cosine check vs S14: cos=0.9990
[S17] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9959 head_norm=1.651817
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.601501e-01
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9959 head_norm=1.609426 delta_norm=0.160150
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.5316 head_norm=1.693403
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.400834e-01
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.5440 head_norm=1.654186 delta_norm=0.140083
[S13] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.6373 head_norm=2.083498
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.770913e-02
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.6379 head_norm=2.086378 delta_norm=0.047709
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.9315 head_norm=1.565073
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.910331e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.9308 head_norm=1.494030 delta_norm=0.291033
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.884690 cos_to_last_merge=0.8374 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.837
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.8311877609271694, 'auprc': 0.8931238914538082, 'loss_val': 0.4293513928346101, 'psi': 0.8559622131378248}-{'f1_val': 0.8312269254611401, 'auprc': 0.9071540309637618, 'loss_val': 0.41572550328800467, 'psi': 0.8615977676621888}
[S3] START round=30 head_norm_before_train=2.018776 cos_to_last_merge=0.9976 (last merge round=25)
[S3] round=30 local utility u=0.753363 metrics={'f1_val': 0.995746663567042, 'auprc': 0.9992906980476065, 'loss_val': 0.07269603444841498, 'psi': 0.9971642773592678}-{'f1_val': 0.7891584458153569, 'auprc': 0.9985619324771158, 'loss_val': 0.33770620658891165, 'psi': 0.8729198404800604}
[S4] START round=30 head_norm_before_train=1.822130 cos_to_last_merge=0.8102 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.810
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9416553292583736, 'auprc': 0.9563176875882771, 'loss_val': 0.28647170591700916, 'psi': 0.9475202725903349}-{'f1_val': 0.943382822776673, 'auprc': 0.9669424360972831, 'loss_val': 0.2845089576798114, 'psi': 0.952806668104917}
[S5] START round=30 head_norm_before_train=1.739700 (no previous merge yet)
[S5] round=30 local utility u=1.000000 metrics={'f1_val': 0.9561633254331291, 'auprc': 0.9952530094395116, 'loss_val': 0.148264740322164, 'psi': 0.971799199035682}-{'f1_val': 0.6545164603411766, 'auprc': 0.8559583387080291, 'loss_val': 0.47630557198886075, 'psi': 0.7350932116879176}
[S6] START round=30 head_norm_before_train=1.963807 (no previous merge yet)
[S6] round=30 local utility u=0.299587 metrics={'f1_val': 0.8329795314042641, 'auprc': 0.975498269960098, 'loss_val': 0.32676617295420785, 'psi': 0.8899870268265977}-{'f1_val': 0.7795198218710073, 'auprc': 0.9656939024309553, 'loss_val': 0.5757685047393722, 'psi': 0.8539894540949865}
[S7] START round=30 head_norm_before_train=1.477903 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5808389581982245, 'auprc': 0.7815200691604203, 'loss_val': 0.7351586133998452, 'psi': 0.6611114025831029}-{'f1_val': 0.6713424126740902, 'auprc': 0.8317325546151677, 'loss_val': 0.4703756643167426, 'psi': 0.7354984694505212}
[S8] START round=30 head_norm_before_train=1.567456 cos_to_last_merge=0.9836 (last merge round=23)
[S8] round=30 local utility u=0.028653 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9978631530388566, 'loss_val': 0.04603547681706361, 'psi': 0.9953204634842405}-{'f1_val': 0.9864258722700556, 'auprc': 0.9986356842315258, 'loss_val': 0.06246225158479674, 'psi': 0.9913097970546437}
[S9] START round=30 head_norm_before_train=2.000070 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9863222816204869, 'auprc': 0.9985134023812219, 'loss_val': 0.05289770888088782, 'psi': 0.9911987299247809}-{'f1_val': 0.9937421749897083, 'auprc': 0.9985304069299563, 'loss_val': 0.02534722630062331, 'psi': 0.9956574677658075}
[S10] START round=30 head_norm_before_train=1.582182 cos_to_last_merge=0.9909 (last merge round=26)
[S10] round=30 local utility u=0.000917 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9937365984279736, 'loss_val': 0.039992743776258256, 'psi': 0.9944755512902351}-{'f1_val': 0.9949681865317428, 'auprc': 0.995002509837227, 'loss_val': 0.04562446903975681, 'psi': 0.9949819158539366}
[S11] START round=30 head_norm_before_train=1.609426 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.000899 metrics={'f1_val': 0.996305167468861, 'auprc': 0.998392877582804, 'loss_val': 0.046013215238446634, 'psi': 0.9971402515144382}-{'f1_val': 0.9958918378685807, 'auprc': 0.998442881882434, 'loss_val': 0.04548076083091037, 'psi': 0.9969122554741221}
[S13] START round=30 head_norm_before_train=1.654186 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.344829 metrics={'f1_val': 0.5936486921902766, 'auprc': 0.6857024431256812, 'loss_val': 0.667071412342129, 'psi': 0.6304701925644385}-{'f1_val': 0.5316219263097961, 'auprc': 0.6515689161705581, 'loss_val': 0.8821685140293088, 'psi': 0.5796007222541009}
[S14] START round=30 head_norm_before_train=2.090343 cos_to_last_merge=0.9995 (last merge round=27)
[S14] round=30 local utility u=0.002023 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9997602119776796, 'loss_val': 0.036623298511410336, 'psi': 0.9981162584647972}-{'f1_val': 0.9970857023581083, 'auprc': 0.9994912988179171, 'loss_val': 0.04025553427520971, 'psi': 0.9980479409420319}
[S15] START round=30 head_norm_before_train=1.494030 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.8175022345362182, 'auprc': 0.9735550354435931, 'loss_val': 0.28928903435145864, 'psi': 0.8799233548991682}-{'f1_val': 0.9314749012826308, 'auprc': 0.9918369111630816, 'loss_val': 0.12384530587074087, 'psi': 0.955619705234811}
[S16] START round=30 head_norm_before_train=1.626129 cos_to_last_merge=0.9876 (last merge round=26)
[S16] round=30 local utility u=0.014317 metrics={'f1_val': 0.9903464907486326, 'auprc': 0.9885774909383523, 'loss_val': 0.09650237570367115, 'psi': 0.9896388908245205}-{'f1_val': 0.9894624497877258, 'auprc': 0.9891117585034825, 'loss_val': 0.12143592189609692, 'psi': 0.9893221732740285}
[S17] START round=30 head_norm_before_train=2.086378 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.49760657009587544, 'auprc': 0.7973994727178757, 'loss_val': 1.53394205684048, 'psi': 0.6175237311446755}-{'f1_val': 0.6373240113161047, 'auprc': 0.9905391303965491, 'loss_val': 1.1133843897872484, 'psi': 0.7786100589482825}
[S3]  timeout peer S2
[S2]  timeout peer S3
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:38412
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:38402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:38413
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:38417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:38414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.106954)
[S17] loaded HEAD from S14 (vec_in norm=2.106954)
[S17] cosine check vs S14: cos=0.9993
[S17] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.676342)
[S14] loaded HEAD from S13 (vec_in norm=1.676342)
[S14] cosine check vs S13: cos=0.9432
[S14] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1794) from S16
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.659429)
[S13] loaded HEAD from S16 (vec_in norm=1.659429)
[S13] cosine check vs S16: cos=0.9930
[S13] BUFFERED delta from S16 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S10
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.628610)
[S11] loaded HEAD from S10 (vec_in norm=1.628610)
[S11] cosine check vs S10: cos=0.9935
[S11] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.592022)
[S7] loaded HEAD from S8 (vec_in norm=1.592022)
[S7] cosine check vs S8: cos=0.9890
[S7] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.032892)
[S5] loaded HEAD from S3 (vec_in norm=2.032892)
[S5] cosine check vs S3: cos=-0.0161
[S5] DROPPED delta from S3 (cos=-0.0161 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.974082)
[S3] loaded HEAD from S6 (vec_in norm=1.974082)
[S3] cosine check vs S6: cos=-0.1384
[S3] DROPPED delta from S6 (cos=-0.1384 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S5
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.742553)
[S2] loaded HEAD from S5 (vec_in norm=1.742553)
[S2] cosine check vs S5: cos=-0.0899
[S2] DROPPED delta from S5 (cos=-0.0899 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.5808 head_norm=1.484241
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.260682e-01
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.5892 head_norm=1.533903 delta_norm=0.126068
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.167 → S15@127.0.0.1:38415
[S4] ⇄ pheromone p=0.018 → S16@127.0.0.1:38416
[S3] ⇄ pheromone p=0.205 → S5@127.0.0.1:38405
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=30 metric=0.9963 head_norm=1.627347
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.256279e-02
[S11] stored merged vector for next round verification (round=30)
[S11] DEBUG after merge:  round=30 metric=0.9963 head_norm=1.625345 delta_norm=0.092563
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.009 → S11@127.0.0.1:38412
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9970 head_norm=2.106954
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.829235e-01
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9970 head_norm=1.864955 delta_norm=0.382924
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.039 → S17@127.0.0.1:38417
[S5] ⇄ pheromone p=0.355 → S2@127.0.0.1:38402
[S8] ⇄ pheromone p=0.026 → S7@127.0.0.1:38408
[S16] ⇄ pheromone p=0.113 → S13@127.0.0.1:38413
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=30 metric=0.5936 head_norm=1.676342
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.922218e-02
[S13] stored merged vector for next round verification (round=30)
[S13] DEBUG after merge:  round=30 metric=0.6091 head_norm=1.664953 delta_norm=0.099222
[S13] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.132 → S14@127.0.0.1:38414
[S6] ⇄ pheromone p=0.300 → S3@127.0.0.1:38403
[S15] ⇄ pheromone p=0.210 → S7@127.0.0.1:38408
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.4976 head_norm=2.103664
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.976401e-02
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.5010 head_norm=2.104934 delta_norm=0.039764
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.094 → S14@127.0.0.1:38414
[S2] START round=31 head_norm_before_train=1.897549 cos_to_last_merge=0.8361 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.836
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.8279591786536556, 'auprc': 0.8817399976368199, 'loss_val': 0.4483971015851232, 'psi': 0.8494715062469214}-{'f1_val': 0.8311877609271694, 'auprc': 0.8931238914538082, 'loss_val': 0.4293513928346101, 'psi': 0.8559622131378248}
[S3] START round=31 head_norm_before_train=2.032892 cos_to_last_merge=0.9967 (last merge round=25)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.6648262775122084, 'auprc': 0.9981559563137931, 'loss_val': 0.5792475402011156, 'psi': 0.7981581490328422}-{'f1_val': 0.995746663567042, 'auprc': 0.9992906980476065, 'loss_val': 0.07269603444841498, 'psi': 0.9971642773592678}
[S4] START round=31 head_norm_before_train=1.831640 cos_to_last_merge=0.8095 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.809
[S4] round=31 local utility u=0.007235 metrics={'f1_val': 0.9413361547918607, 'auprc': 0.9633297843984592, 'loss_val': 0.291123679675096, 'psi': 0.9501336066345001}-{'f1_val': 0.9416553292583736, 'auprc': 0.9563176875882771, 'loss_val': 0.28647170591700916, 'psi': 0.9475202725903349}
[S5] START round=31 head_norm_before_train=1.742553 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.6238134226196211, 'auprc': 0.8562048060058894, 'loss_val': 0.481932381158868, 'psi': 0.7167699759741285}-{'f1_val': 0.9561633254331291, 'auprc': 0.9952530094395116, 'loss_val': 0.148264740322164, 'psi': 0.971799199035682}
[S6] START round=31 head_norm_before_train=1.974082 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.7060520920466566, 'auprc': 0.9586690096409786, 'loss_val': 0.7348913514765973, 'psi': 0.8070988590843855}-{'f1_val': 0.8329795314042641, 'auprc': 0.975498269960098, 'loss_val': 0.32676617295420785, 'psi': 0.8899870268265977}
[S7] START round=31 head_norm_before_train=1.533903 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.821304 metrics={'f1_val': 0.6986006433866752, 'auprc': 0.9601735458167076, 'loss_val': 0.335081624317868, 'psi': 0.8032298043586881}-{'f1_val': 0.5808389581982245, 'auprc': 0.7815200691604203, 'loss_val': 0.7351586133998452, 'psi': 0.6611114025831029}
[S8] START round=31 head_norm_before_train=1.592022 cos_to_last_merge=0.9812 (last merge round=23)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.997975703424808, 'loss_val': 0.04542359950882095, 'psi': 0.994707662964315}-{'f1_val': 0.9936253371144965, 'auprc': 0.9978631530388566, 'loss_val': 0.04603547681706361, 'psi': 0.9953204634842405}
[S9] START round=31 head_norm_before_train=2.010694 (no previous merge yet)
[S9] round=31 local utility u=0.046208 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9971385624402404, 'loss_val': 0.021040402402038222, 'psi': 0.9971171724833818}-{'f1_val': 0.9863222816204869, 'auprc': 0.9985134023812219, 'loss_val': 0.05289770888088782, 'psi': 0.9911987299247809}
[S10] START round=31 head_norm_before_train=1.628610 cos_to_last_merge=0.9874 (last merge round=26)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9919352040703275, 'loss_val': 0.03748686281587136, 'psi': 0.9937549935471768}-{'f1_val': 0.9949681865317428, 'auprc': 0.9937365984279736, 'loss_val': 0.039992743776258256, 'psi': 0.9944755512902351}
[S11] START round=31 head_norm_before_train=1.625345 cos_to_last_merge=1.0000 (last merge round=30)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9548105981686719, 'auprc': 0.994106567914523, 'loss_val': 0.2039389110799824, 'psi': 0.9705289860670123}-{'f1_val': 0.996305167468861, 'auprc': 0.998392877582804, 'loss_val': 0.046013215238446634, 'psi': 0.9971402515144382}
[S13] START round=31 head_norm_before_train=1.664953 cos_to_last_merge=1.0000 (last merge round=30)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5239492941208812, 'auprc': 0.6140365885847783, 'loss_val': 1.013147335640417, 'psi': 0.55998421190644}-{'f1_val': 0.5936486921902766, 'auprc': 0.6857024431256812, 'loss_val': 0.667071412342129, 'psi': 0.6304701925644385}
[S14] START round=31 head_norm_before_train=1.864955 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.999899863824422, 'loss_val': 0.04757426464110495, 'psi': 0.9984185758341464}-{'f1_val': 0.9970202894562089, 'auprc': 0.9997602119776796, 'loss_val': 0.036623298511410336, 'psi': 0.9981162584647972}
[S15] START round=31 head_norm_before_train=1.587159 cos_to_last_merge=0.9963 (last merge round=29)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7005696205678431, 'auprc': 0.7811128855673903, 'loss_val': 0.5550033907422779, 'psi': 0.7327869265676621}-{'f1_val': 0.8175022345362182, 'auprc': 0.9735550354435931, 'loss_val': 0.28928903435145864, 'psi': 0.8799233548991682}
[S16] START round=31 head_norm_before_train=1.659429 cos_to_last_merge=0.9826 (last merge round=26)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8321060116582808, 'auprc': 0.8105035530702261, 'loss_val': 0.8504473020709478, 'psi': 0.8234650282230589}-{'f1_val': 0.9903464907486326, 'auprc': 0.9885774909383523, 'loss_val': 0.09650237570367115, 'psi': 0.9896388908245205}
[S17] START round=31 head_norm_before_train=2.104934 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.711485 metrics={'f1_val': 0.6217639354055318, 'auprc': 0.8938985407593766, 'loss_val': 1.14541399501983, 'psi': 0.7306177775470697}-{'f1_val': 0.49760657009587544, 'auprc': 0.7973994727178757, 'loss_val': 1.53394205684048, 'psi': 0.6175237311446755}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:38407
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:38416
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.838754)
[S16] loaded HEAD from S4 (vec_in norm=1.838754)
[S16] cosine check vs S4: cos=-0.1785
[S16] DROPPED delta from S4 (cos=-0.1785 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.540699)
[S6] loaded HEAD from S7 (vec_in norm=1.540699)
[S6] cosine check vs S7: cos=0.5079
[S6] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.118290)
[S14] loaded HEAD from S17 (vec_in norm=2.118290)
[S14] cosine check vs S17: cos=0.9880
[S14] BUFFERED delta from S17 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9974 head_norm=1.881613
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.945773e-01
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9974 head_norm=1.993978 delta_norm=0.194577
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.7061 head_norm=1.988832
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.967125e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.7212 head_norm=1.536395 delta_norm=0.896712
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.912899 cos_to_last_merge=0.8349 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.835
[S2] round=32 local utility u=0.085599 metrics={'f1_val': 0.832549463982728, 'auprc': 0.9176152020626953, 'loss_val': 0.41236593169778857, 'psi': 0.866575759214715}-{'f1_val': 0.8279591786536556, 'auprc': 0.8817399976368199, 'loss_val': 0.4483971015851232, 'psi': 0.8494715062469214}
[S3] START round=32 head_norm_before_train=2.046639 cos_to_last_merge=0.9959 (last merge round=25)
[S3] round=32 local utility u=1.000000 metrics={'f1_val': 0.9565401493177781, 'auprc': 0.998794787079869, 'loss_val': 0.11738626402078826, 'psi': 0.9734420044226145}-{'f1_val': 0.6648262775122084, 'auprc': 0.9981559563137931, 'loss_val': 0.5792475402011156, 'psi': 0.7981581490328422}
[S4] START round=32 head_norm_before_train=1.838754 cos_to_last_merge=0.8081 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.808
[S4] round=32 local utility u=0.025254 metrics={'f1_val': 0.9478632778456038, 'auprc': 0.9654914788239706, 'loss_val': 0.28626342327570337, 'psi': 0.9549145582369505}-{'f1_val': 0.9413361547918607, 'auprc': 0.9633297843984592, 'loss_val': 0.291123679675096, 'psi': 0.9501336066345001}
[S5] START round=32 head_norm_before_train=1.745595 (no previous merge yet)
[S5] round=32 local utility u=0.345062 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.8807562286438733, 'loss_val': 0.3255444060105392, 'psi': 0.7725988111232232}-{'f1_val': 0.6238134226196211, 'auprc': 0.8562048060058894, 'loss_val': 0.481932381158868, 'psi': 0.7167699759741285}
[S6] START round=32 head_norm_before_train=1.536395 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.278598 metrics={'f1_val': 0.7728409320197916, 'auprc': 0.9520256010260144, 'loss_val': 0.5584988478245506, 'psi': 0.8445147996222808}-{'f1_val': 0.7060520920466566, 'auprc': 0.9586690096409786, 'loss_val': 0.7348913514765973, 'psi': 0.8070988590843855}
[S7] START round=32 head_norm_before_train=1.540699 cos_to_last_merge=0.9999 (last merge round=30)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.40556942801695106, 'auprc': 0.7785863646150816, 'loss_val': 1.1354817740562722, 'psi': 0.5547762026562033}-{'f1_val': 0.6986006433866752, 'auprc': 0.9601735458167076, 'loss_val': 0.335081624317868, 'psi': 0.8032298043586881}
[S8] START round=32 head_norm_before_train=1.617887 cos_to_last_merge=0.9790 (last merge round=23)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9122850681079695, 'auprc': 0.9984234343166831, 'loss_val': 0.17500371123721226, 'psi': 0.946740414591455}-{'f1_val': 0.9925289693239863, 'auprc': 0.997975703424808, 'loss_val': 0.04542359950882095, 'psi': 0.994707662964315}
[S9] START round=32 head_norm_before_train=2.018132 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9908329001136983, 'auprc': 0.9996886938846359, 'loss_val': 0.03289080210154133, 'psi': 0.9943752176220733}-{'f1_val': 0.9971029125121428, 'auprc': 0.9971385624402404, 'loss_val': 0.021040402402038222, 'psi': 0.9971171724833818}
[S10] START round=32 head_norm_before_train=1.663045 cos_to_last_merge=0.9848 (last merge round=26)
[S10] round=32 local utility u=0.001853 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9923493608499275, 'loss_val': 0.03502365486749999, 'psi': 0.9939206562590167}-{'f1_val': 0.9949681865317428, 'auprc': 0.9919352040703275, 'loss_val': 0.03748686281587136, 'psi': 0.9937549935471768}
[S11] START round=32 head_norm_before_train=1.647005 cos_to_last_merge=0.9999 (last merge round=30)
[S11] round=32 local utility u=0.212277 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9982252822577352, 'loss_val': 0.04070775506418057, 'psi': 0.9970732133844107}-{'f1_val': 0.9548105981686719, 'auprc': 0.994106567914523, 'loss_val': 0.2039389110799824, 'psi': 0.9705289860670123}
[S13] START round=32 head_norm_before_train=1.689186 cos_to_last_merge=0.9996 (last merge round=30)
[S13] round=32 local utility u=0.473560 metrics={'f1_val': 0.6051379776912725, 'auprc': 0.6688459885713121, 'loss_val': 0.7175871219551615, 'psi': 0.6306211820432883}-{'f1_val': 0.5239492941208812, 'auprc': 0.6140365885847783, 'loss_val': 1.013147335640417, 'psi': 0.55998421190644}
[S14] START round=32 head_norm_before_train=1.993978 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.003919 metrics={'f1_val': 0.997211058727947, 'auprc': 0.9999552287892856, 'loss_val': 0.03858211852553574, 'psi': 0.9983087267524824}-{'f1_val': 0.9974310505072961, 'auprc': 0.999899863824422, 'loss_val': 0.04757426464110495, 'psi': 0.9984185758341464}
[S15] START round=32 head_norm_before_train=1.689377 cos_to_last_merge=0.9882 (last merge round=29)
[S15] round=32 local utility u=1.000000 metrics={'f1_val': 0.9510105370444278, 'auprc': 0.9911408101827774, 'loss_val': 0.09667747477090773, 'psi': 0.9670626462997676}-{'f1_val': 0.7005696205678431, 'auprc': 0.7811128855673903, 'loss_val': 0.5550033907422779, 'psi': 0.7327869265676621}
[S16] START round=32 head_norm_before_train=1.687285 cos_to_last_merge=0.9785 (last merge round=26)
[S16] round=32 local utility u=1.000000 metrics={'f1_val': 0.9881633162594368, 'auprc': 0.980053167921182, 'loss_val': 0.08689230689787097, 'psi': 0.9849192569241348}-{'f1_val': 0.8321060116582808, 'auprc': 0.8105035530702261, 'loss_val': 0.8504473020709478, 'psi': 0.8234650282230589}
[S17] START round=32 head_norm_before_train=2.118290 cos_to_last_merge=0.9999 (last merge round=30)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6015516547952902, 'auprc': 0.8918565747935339, 'loss_val': 1.3420430087505206, 'psi': 0.7176736227945877}-{'f1_val': 0.6217639354055318, 'auprc': 0.8938985407593766, 'loss_val': 1.14541399501983, 'psi': 0.7306177775470697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38405
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.927903)
[S5] loaded HEAD from S2 (vec_in norm=1.927903)
[S5] cosine check vs S2: cos=-0.0878
[S5] DROPPED delta from S2 (cos=-0.0878 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.058779)
[S6] loaded HEAD from S3 (vec_in norm=2.058779)
[S6] cosine check vs S3: cos=-0.1305
[S6] DROPPED delta from S3 (cos=-0.1305 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:38412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:38403
[S10] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.752736)
[S3] loaded HEAD from S5 (vec_in norm=1.752736)
[S3] cosine check vs S5: cos=-0.0174
[S3] DROPPED delta from S5 (cos=-0.0174 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.667894)
[S10] loaded HEAD from S11 (vec_in norm=1.667894)
[S10] cosine check vs S11: cos=0.9962
[S10] BUFFERED delta from S11 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.569939)
[S3] loaded HEAD from S6 (vec_in norm=1.569939)
[S3] cosine check vs S6: cos=-0.1305
[S3] DROPPED delta from S6 (cos=-0.1305 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.709522)
[S16] loaded HEAD from S13 (vec_in norm=1.709522)
[S16] cosine check vs S13: cos=0.9937
[S16] BUFFERED delta from S13 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S10
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.693176)
[S11] loaded HEAD from S10 (vec_in norm=1.693176)
[S11] cosine check vs S10: cos=0.9962
[S11] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:38413
[S16] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:38416
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S16
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.706167)
[S13] loaded HEAD from S16 (vec_in norm=1.706167)
[S13] cosine check vs S16: cos=0.9937
[S13] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1799) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.010272)
[S13] loaded HEAD from S14 (vec_in norm=2.010272)
[S13] cosine check vs S14: cos=0.9490
[S13] BUFFERED delta from S14 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.768476)
[S7] loaded HEAD from S15 (vec_in norm=1.768476)
[S7] cosine check vs S15: cos=0.9242
[S7] BUFFERED delta from S15 (total buffered=1)
[S4] sending update (kind=head size=1793 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.854509)
[S16] loaded HEAD from S4 (vec_in norm=1.854509)
[S16] cosine check vs S4: cos=-0.1809
[S16] DROPPED delta from S4 (cos=-0.1809 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.4056 head_norm=1.547642
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.404094e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.4106 head_norm=1.626491 delta_norm=0.340409
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9963 head_norm=1.667894
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.462668e-02
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9963 head_norm=1.678925 delta_norm=0.074627
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=32 metric=0.9950 head_norm=1.693176
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.462668e-02
[S10] stored merged vector for next round verification (round=32)
[S10] DEBUG after merge:  round=32 metric=0.9950 head_norm=1.678925 delta_norm=0.074627
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.6051 head_norm=1.709522
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.403338e-01
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.6050 head_norm=1.760547 delta_norm=0.140334
[S13] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9882 head_norm=1.706167
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.569393e-02
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9882 head_norm=1.705162 delta_norm=0.095694
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.927903 cos_to_last_merge=0.8339 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.834
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.8326521987773643, 'auprc': 0.9008256212835185, 'loss_val': 0.4254413823276859, 'psi': 0.859921567779826}-{'f1_val': 0.832549463982728, 'auprc': 0.9176152020626953, 'loss_val': 0.41236593169778857, 'psi': 0.866575759214715}
[S3] START round=33 head_norm_before_train=2.058779 cos_to_last_merge=0.9951 (last merge round=25)
[S3] round=33 local utility u=0.039406 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.99989263009383, 'loss_val': 0.06907816262704443, 'psi': 0.9766021032772043}-{'f1_val': 0.9565401493177781, 'auprc': 0.998794787079869, 'loss_val': 0.11738626402078826, 'psi': 0.9734420044226145}
[S4] START round=33 head_norm_before_train=1.854509 cos_to_last_merge=0.8067 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.807
[S4] round=33 local utility u=0.065080 metrics={'f1_val': 0.9571826657607709, 'auprc': 0.9427877466019978, 'loss_val': 0.14390759733740738, 'psi': 0.9514246980972617}-{'f1_val': 0.9478632778456038, 'auprc': 0.9654914788239706, 'loss_val': 0.28626342327570337, 'psi': 0.9549145582369505}
[S5] START round=33 head_norm_before_train=1.752736 (no previous merge yet)
[S5] round=33 local utility u=0.221884 metrics={'f1_val': 0.7179800003524142, 'auprc': 0.9668512543864123, 'loss_val': 0.24497735565605683, 'psi': 0.8175285019660135}-{'f1_val': 0.7004938661094564, 'auprc': 0.8807562286438733, 'loss_val': 0.3255444060105392, 'psi': 0.7725988111232232}
[S6] START round=33 head_norm_before_train=1.569939 cos_to_last_merge=0.9997 (last merge round=31)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.6198277069948945, 'auprc': 0.8889353181992365, 'loss_val': 0.8322436725664891, 'psi': 0.7274707514766313}-{'f1_val': 0.7728409320197916, 'auprc': 0.9520256010260144, 'loss_val': 0.5584988478245506, 'psi': 0.8445147996222808}
[S7] START round=33 head_norm_before_train=1.626491 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=1.000000 metrics={'f1_val': 0.6881421388683497, 'auprc': 0.8598133877278512, 'loss_val': 0.3596330657257964, 'psi': 0.7568106384121503}-{'f1_val': 0.40556942801695106, 'auprc': 0.7785863646150816, 'loss_val': 1.1354817740562722, 'psi': 0.5547762026562033}
[S8] START round=33 head_norm_before_train=1.641970 cos_to_last_merge=0.9769 (last merge round=23)
[S8] round=33 local utility u=0.310754 metrics={'f1_val': 0.9936102940920961, 'auprc': 0.9977926435823926, 'loss_val': 0.03955521908408016, 'psi': 0.9952832338882147}-{'f1_val': 0.9122850681079695, 'auprc': 0.9984234343166831, 'loss_val': 0.17500371123721226, 'psi': 0.946740414591455}
[S9] START round=33 head_norm_before_train=2.027395 (no previous merge yet)
[S9] round=33 local utility u=0.012817 metrics={'f1_val': 0.9937719190709611, 'auprc': 0.9996576288878514, 'loss_val': 0.02479807970721551, 'psi': 0.9961262029977171}-{'f1_val': 0.9908329001136983, 'auprc': 0.9996886938846359, 'loss_val': 0.03289080210154133, 'psi': 0.9943752176220733}
[S10] START round=33 head_norm_before_train=1.678925 cos_to_last_merge=1.0000 (last merge round=32)
[S10] round=33 local utility u=0.000870 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9944867107169915, 'loss_val': 0.035744098430095204, 'psi': 0.9943804916779773}-{'f1_val': 0.9949681865317428, 'auprc': 0.9923493608499275, 'loss_val': 0.03502365486749999, 'psi': 0.9939206562590167}
[S11] START round=33 head_norm_before_train=1.678925 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.000755 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981064357627384, 'loss_val': 0.038841923601227644, 'psi': 0.9970256747864119}-{'f1_val': 0.996305167468861, 'auprc': 0.9982252822577352, 'loss_val': 0.04070775506418057, 'psi': 0.9970732133844107}
[S13] START round=33 head_norm_before_train=1.760547 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5410506818812459, 'auprc': 0.7093340737917913, 'loss_val': 0.8298363871551413, 'psi': 0.6083640386454641}-{'f1_val': 0.6051379776912725, 'auprc': 0.6688459885713121, 'loss_val': 0.7175871219551615, 'psi': 0.6306211820432883}
[S14] START round=33 head_norm_before_train=2.010272 cos_to_last_merge=0.9999 (last merge round=31)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9965992529308234, 'auprc': 0.9998764998984613, 'loss_val': 0.03766827743786839, 'psi': 0.9979101517178786}-{'f1_val': 0.997211058727947, 'auprc': 0.9999552287892856, 'loss_val': 0.03858211852553574, 'psi': 0.9983087267524824}
[S15] START round=33 head_norm_before_train=1.768476 cos_to_last_merge=0.9811 (last merge round=29)
[S15] round=33 local utility u=0.063558 metrics={'f1_val': 0.9677990932698507, 'auprc': 0.9913477210226055, 'loss_val': 0.07091337559916264, 'psi': 0.9772185443709527}-{'f1_val': 0.9510105370444278, 'auprc': 0.9911408101827774, 'loss_val': 0.09667747477090773, 'psi': 0.9670626462997676}
[S16] START round=33 head_norm_before_train=1.705162 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9726345853397699, 'auprc': 0.9846445846389735, 'loss_val': 0.12455064174814254, 'psi': 0.9774385850594514}-{'f1_val': 0.9881633162594368, 'auprc': 0.980053167921182, 'loss_val': 0.08689230689787097, 'psi': 0.9849192569241348}
[S17] START round=33 head_norm_before_train=2.128963 cos_to_last_merge=0.9998 (last merge round=30)
[S17] round=33 local utility u=1.000000 metrics={'f1_val': 0.823159124235231, 'auprc': 0.9520318523207146, 'loss_val': 0.6123511228194723, 'psi': 0.8747082154694245}-{'f1_val': 0.6015516547952902, 'auprc': 0.8918565747935339, 'loss_val': 1.3420430087505206, 'psi': 0.7176736227945877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:38407
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:38412
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:38411
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S5] → sending delta(kind=head bytes=1810) to S3@127.0.0.1:38403
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:38407
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:38416
[S6] RECEIVED delta(kind=head bytes=1805) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.070225)
[S6] loaded HEAD from S3 (vec_in norm=2.070225)
[S6] cosine check vs S3: cos=-0.1338
[S6] DROPPED delta from S3 (cos=-0.1338 < 0.0)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1810 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.829531)
[S7] loaded HEAD from S15 (vec_in norm=1.829531)
[S7] cosine check vs S15: cos=0.9789
[S7] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1805) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.631907)
[S6] loaded HEAD from S7 (vec_in norm=1.631907)
[S6] cosine check vs S7: cos=0.7314
[S6] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1792) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.852647)
[S16] loaded HEAD from S4 (vec_in norm=1.852647)
[S16] cosine check vs S4: cos=-0.1750
[S16] DROPPED delta from S4 (cos=-0.1750 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1810) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.759837)
[S3] loaded HEAD from S5 (vec_in norm=1.759837)
[S3] cosine check vs S5: cos=-0.0179
[S3] DROPPED delta from S5 (cos=-0.0179 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S10
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.706764)
[S11] loaded HEAD from S10 (vec_in norm=1.706764)
[S11] cosine check vs S10: cos=0.9998
[S11] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1796) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.699520)
[S10] loaded HEAD from S11 (vec_in norm=1.699520)
[S10] cosine check vs S11: cos=0.9998
[S10] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.661715)
[S7] loaded HEAD from S8 (vec_in norm=1.661715)
[S7] cosine check vs S8: cos=0.9647
[S7] BUFFERED delta from S8 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.140820)
[S14] loaded HEAD from S17 (vec_in norm=2.140820)
[S14] cosine check vs S17: cos=0.9967
[S14] BUFFERED delta from S17 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.9966 head_norm=2.028147
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.014989e-01
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.9966 head_norm=2.082773 delta_norm=0.101499
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.6198 head_norm=1.621765
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.961781e-01
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.6193 head_norm=1.513669 delta_norm=0.596178
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9963 head_norm=1.699520
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.523459e-02
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9963 head_norm=1.703078 delta_norm=0.015235
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=33 metric=0.6881 head_norm=1.631907
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.597849e-02
[S7] stored merged vector for next round verification (round=33)
[S7] DEBUG after merge:  round=33 metric=0.6874 head_norm=1.665086 delta_norm=0.055978
[S7] aggregate: ACCEPT kept=['S15', 'S8'] (k=2/2) mode=median trim_p=0.1
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S15
[S14]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S15
[S17]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S9
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S7]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S15
[S13]  timeout peer S17
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.9943 head_norm=1.706764
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.523459e-02
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.9943 head_norm=1.703078 delta_norm=0.015235
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.943250 cos_to_last_merge=0.8328 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.833
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.8360816807701478, 'auprc': 0.8578285442457837, 'loss_val': 0.3635494314220643, 'psi': 0.8447804261604022}-{'f1_val': 0.8326521987773643, 'auprc': 0.9008256212835185, 'loss_val': 0.4254413823276859, 'psi': 0.859921567779826}
[S3] START round=34 head_norm_before_train=2.070225 cos_to_last_merge=0.9944 (last merge round=25)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.999371732213167, 'loss_val': 0.10068117714929196, 'psi': 0.9762464582680049}-{'f1_val': 0.9610750853994537, 'auprc': 0.99989263009383, 'loss_val': 0.06907816262704443, 'psi': 0.9766021032772043}
[S4] START round=34 head_norm_before_train=1.852647 cos_to_last_merge=0.8066 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.807
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9524196913948821, 'auprc': 0.9623913029693023, 'loss_val': 0.27498940730371135, 'psi': 0.9564083360246503}-{'f1_val': 0.9571826657607709, 'auprc': 0.9427877466019978, 'loss_val': 0.14390759733740738, 'psi': 0.9514246980972617}
[S5] START round=34 head_norm_before_train=1.759837 (no previous merge yet)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.4588883096036524, 'auprc': 0.8558860947499283, 'loss_val': 0.7512869730202694, 'psi': 0.6176874236621628}-{'f1_val': 0.7179800003524142, 'auprc': 0.9668512543864123, 'loss_val': 0.24497735565605683, 'psi': 0.8175285019660135}
[S6] START round=34 head_norm_before_train=1.513669 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.973833 metrics={'f1_val': 0.8251985149178367, 'auprc': 0.9676195521836536, 'loss_val': 0.35285573361323896, 'psi': 0.8821669298241634}-{'f1_val': 0.6198277069948945, 'auprc': 0.8889353181992365, 'loss_val': 0.8322436725664891, 'psi': 0.7274707514766313}
[S7] START round=34 head_norm_before_train=1.665086 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.47593686391027057, 'auprc': 0.7813827969214177, 'loss_val': 0.9788284667445466, 'psi': 0.5981152371147294}-{'f1_val': 0.6881421388683497, 'auprc': 0.8598133877278512, 'loss_val': 0.3596330657257964, 'psi': 0.7568106384121503}
[S8] START round=34 head_norm_before_train=1.661715 cos_to_last_merge=0.9750 (last merge round=23)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9918008107316822, 'auprc': 0.9988591387615052, 'loss_val': 0.03916543189497673, 'psi': 0.9946241419436115}-{'f1_val': 0.9936102940920961, 'auprc': 0.9977926435823926, 'loss_val': 0.03955521908408016, 'psi': 0.9952832338882147}
[S9] START round=34 head_norm_before_train=2.034326 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9888785659900814, 'auprc': 0.9990392309078674, 'loss_val': 0.03825372444609321, 'psi': 0.9929428319571958}-{'f1_val': 0.9937719190709611, 'auprc': 0.9996576288878514, 'loss_val': 0.02479807970721551, 'psi': 0.9961262029977171}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.703078 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.992234950400423, 'loss_val': 0.034109988624337284, 'psi': 0.9938748920792149}-{'f1_val': 0.9943096789853013, 'auprc': 0.9944867107169915, 'loss_val': 0.035744098430095204, 'psi': 0.9943804916779773}
[S11] START round=34 head_norm_before_train=1.703078 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9640766163804018, 'auprc': 0.9979623161038965, 'loss_val': 0.10675253853281001, 'psi': 0.9776308962697997}-{'f1_val': 0.996305167468861, 'auprc': 0.9981064357627384, 'loss_val': 0.038841923601227644, 'psi': 0.9970256747864119}
[S13] START round=34 head_norm_before_train=1.779285 cos_to_last_merge=0.9999 (last merge round=32)
[S13] round=34 local utility u=0.153664 metrics={'f1_val': 0.5850241819958146, 'auprc': 0.6874496927827347, 'loss_val': 0.7206959477265571, 'psi': 0.6259943863105827}-{'f1_val': 0.5410506818812459, 'auprc': 0.7093340737917913, 'loss_val': 0.8298363871551413, 'psi': 0.6083640386454641}
[S14] START round=34 head_norm_before_train=2.082773 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.005934 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.99983463972372, 'loss_val': 0.030664568601932743, 'psi': 0.9983924861938657}-{'f1_val': 0.9965992529308234, 'auprc': 0.9998764998984613, 'loss_val': 0.03766827743786839, 'psi': 0.9979101517178786}
[S15] START round=34 head_norm_before_train=1.829531 cos_to_last_merge=0.9759 (last merge round=29)
[S15] round=34 local utility u=0.106404 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9931910189683185, 'loss_val': 0.035094376138608746, 'psi': 0.9951017157735211}-{'f1_val': 0.9677990932698507, 'auprc': 0.9913477210226055, 'loss_val': 0.07091337559916264, 'psi': 0.9772185443709527}
[S16] START round=34 head_norm_before_train=1.720691 cos_to_last_merge=0.9999 (last merge round=32)
[S16] round=34 local utility u=0.020647 metrics={'f1_val': 0.9816361562737551, 'auprc': 0.9799114059585722, 'loss_val': 0.1230667180552592, 'psi': 0.9809462561476819}-{'f1_val': 0.9726345853397699, 'auprc': 0.9846445846389735, 'loss_val': 0.12455064174814254, 'psi': 0.9774385850594514}
[S17] START round=34 head_norm_before_train=2.140820 cos_to_last_merge=0.9997 (last merge round=30)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.629136532585131, 'auprc': 0.9233423065437492, 'loss_val': 1.279792774701586, 'psi': 0.7468188421685783}-{'f1_val': 0.823159124235231, 'auprc': 0.9520318523207146, 'loss_val': 0.6123511228194723, 'psi': 0.8747082154694245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:38403
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1803 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.561140)
[S3] loaded HEAD from S6 (vec_in norm=1.561140)
[S3] cosine check vs S6: cos=-0.1153
[S3] DROPPED delta from S6 (cos=-0.1153 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.873070)
[S7] loaded HEAD from S15 (vec_in norm=1.873070)
[S7] cosine check vs S15: cos=0.9747
[S7] BUFFERED delta from S15 (total buffered=1)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:38413
[S14] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.098831)
[S13] loaded HEAD from S14 (vec_in norm=2.098831)
[S13] cosine check vs S14: cos=0.9578
[S13] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[S13] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.804014)
[S16] loaded HEAD from S13 (vec_in norm=1.804014)
[S16] cosine check vs S13: cos=0.9910
[S16] BUFFERED delta from S13 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=34 metric=0.5850 head_norm=1.804014
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.186647e-01
[S13] stored merged vector for next round verification (round=34)
[S13] DEBUG after merge:  round=34 metric=0.5988 head_norm=1.930863 delta_norm=0.318665
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:38413
[S16] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S16
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.736590)
[S13] loaded HEAD from S16 (vec_in norm=1.736590)
[S13] cosine check vs S16: cos=0.9607
[S13] BUFFERED delta from S16 (total buffered=1)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.9816 head_norm=1.736590
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.236803e-01
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.9832 head_norm=1.766298 delta_norm=0.123680
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] RoundReady barrier timeout: have=2 need=3 — continuing
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8]  timeout peer S4
[S8]  timeout peer S7
[S13]  timeout peer S14
[S3]  timeout peer S5
[S3]  timeout peer S9
[S6]  timeout peer S3
[S10]  timeout peer S11
[S4]  timeout peer S16
[S7]  timeout peer S6
[S7]  timeout peer S10
[S5]  timeout peer S2
[S16]  timeout peer S8
[S16]  timeout peer S13
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.4759 head_norm=1.669359
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.234985e-01
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.4830 head_norm=1.760007 delta_norm=0.223498
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.959502 cos_to_last_merge=0.8315 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.832
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.796897290656757, 'auprc': 0.8501256573104042, 'loss_val': 0.6083995185328205, 'psi': 0.8181886373182159}-{'f1_val': 0.8360816807701478, 'auprc': 0.8578285442457837, 'loss_val': 0.3635494314220643, 'psi': 0.8447804261604022}
[S3] START round=35 head_norm_before_train=2.080964 cos_to_last_merge=0.9937 (last merge round=25)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9514947630095069, 'auprc': 0.992349890004207, 'loss_val': 0.14177473410862287, 'psi': 0.967836813807387}-{'f1_val': 0.9608296089712303, 'auprc': 0.999371732213167, 'loss_val': 0.10068117714929196, 'psi': 0.9762464582680049}
[S4] START round=35 head_norm_before_train=1.843216 cos_to_last_merge=0.8043 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.804
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9417292384939981, 'auprc': 0.9355872680890778, 'loss_val': 0.2972146427301653, 'psi': 0.93927245033203}-{'f1_val': 0.9524196913948821, 'auprc': 0.9623913029693023, 'loss_val': 0.27498940730371135, 'psi': 0.9564083360246503}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.766593 (no previous merge yet)
[S5] round=35 local utility u=1.000000 metrics={'f1_val': 0.8070453020980113, 'auprc': 0.9964307922468338, 'loss_val': 0.14439135448721926, 'psi': 0.8827994981575403}-{'f1_val': 0.4588883096036524, 'auprc': 0.8558860947499283, 'loss_val': 0.7512869730202694, 'psi': 0.6176874236621628}
[S6] START round=35 head_norm_before_train=1.561140 cos_to_last_merge=0.9990 (last merge round=33)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.6932055559520411, 'auprc': 0.9517430209501112, 'loss_val': 0.5747591994092046, 'psi': 0.7966205419512692}-{'f1_val': 0.8251985149178367, 'auprc': 0.9676195521836536, 'loss_val': 0.35285573361323896, 'psi': 0.8821669298241634}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.760007 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.844899 metrics={'f1_val': 0.6576966994530343, 'auprc': 0.8175759296809129, 'loss_val': 0.4881680512183909, 'psi': 0.7216483915441858}-{'f1_val': 0.47593686391027057, 'auprc': 0.7813827969214177, 'loss_val': 0.9788284667445466, 'psi': 0.5981152371147294}
[S8] START round=35 head_norm_before_train=1.677780 cos_to_last_merge=0.9737 (last merge round=23)
[S8] round=35 local utility u=0.006965 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9981160540312254, 'loss_val': 0.036151814493017666, 'psi': 0.9956415633655982}-{'f1_val': 0.9918008107316822, 'auprc': 0.9988591387615052, 'loss_val': 0.03916543189497673, 'psi': 0.9946241419436115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=35 head_norm_before_train=2.042018 (no previous merge yet)
[S9] round=35 local utility u=0.031079 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9970301114183204, 'loss_val': 0.01941538556854897, 'psi': 0.9970737920746139}-{'f1_val': 0.9888785659900814, 'auprc': 0.9990392309078674, 'loss_val': 0.03825372444609321, 'psi': 0.9929428319571958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=35 head_norm_before_train=1.726442 cos_to_last_merge=0.9999 (last merge round=33)
[S10] round=35 local utility u=0.001400 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9937111634484963, 'loss_val': 0.03310491729601636, 'psi': 0.9942019294584351}-{'f1_val': 0.9949681865317428, 'auprc': 0.992234950400423, 'loss_val': 0.034109988624337284, 'psi': 0.9938748920792149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=35 head_norm_before_train=1.722085 cos_to_last_merge=0.9999 (last merge round=33)
[S11] round=35 local utility u=0.133484 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981808467733841, 'loss_val': 0.03381147298050309, 'psi': 0.9970554391906703}-{'f1_val': 0.9640766163804018, 'auprc': 0.9979623161038965, 'loss_val': 0.10675253853281001, 'psi': 0.9776308962697997}
[S13] START round=35 head_norm_before_train=1.930863 cos_to_last_merge=1.0000 (last merge round=34)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5686987883641226, 'auprc': 0.7046504155010935, 'loss_val': 1.0266538322489895, 'psi': 0.623079439218911}-{'f1_val': 0.5850241819958146, 'auprc': 0.6874496927827347, 'loss_val': 0.7206959477265571, 'psi': 0.6259943863105827}
[S14] START round=35 head_norm_before_train=2.098831 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=35 local utility u=0.000149 metrics={'f1_val': 0.9972630104447024, 'auprc': 0.9995677360949119, 'loss_val': 0.028558519314377015, 'psi': 0.9981849007047863}-{'f1_val': 0.9974310505072961, 'auprc': 0.99983463972372, 'loss_val': 0.030664568601932743, 'psi': 0.9983924861938657}
[S15] START round=35 head_norm_before_train=1.873070 cos_to_last_merge=0.9722 (last merge round=29)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.9143298520397746, 'auprc': 0.9909170596558794, 'loss_val': 0.15476287839921285, 'psi': 0.9449647350862165}-{'f1_val': 0.9963755136436562, 'auprc': 0.9931910189683185, 'loss_val': 0.035094376138608746, 'psi': 0.9951017157735211}
[S16] START round=35 head_norm_before_train=1.766298 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.051115 metrics={'f1_val': 0.9904949689748352, 'auprc': 0.9817779258200305, 'loss_val': 0.07958925533437021, 'psi': 0.9870081517129135}-{'f1_val': 0.9816361562737551, 'auprc': 0.9799114059585722, 'loss_val': 0.1230667180552592, 'psi': 0.9809462561476819}
[S17] START round=35 head_norm_before_train=2.148220 cos_to_last_merge=0.9996 (last merge round=30)
[S17] round=35 local utility u=0.081367 metrics={'f1_val': 0.6374800003830063, 'auprc': 0.9591985462314941, 'loss_val': 1.2746884631131463, 'psi': 0.7661674187224015}-{'f1_val': 0.629136532585131, 'auprc': 0.9233423065437492, 'loss_val': 1.279792774701586, 'psi': 0.7468188421685783}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=35 metric=0.5687 head_norm=1.946979
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.763544e-01
[S13] stored merged vector for next round verification (round=35)
[S13] DEBUG after merge:  round=35 metric=0.5577 head_norm=1.823969 delta_norm=0.276354
[S13] aggregate: ROLLBACK (f1_val pre=0.569 post=0.558 tol_abs=0.005 tol_rel=0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S2] START round=36 head_norm_before_train=1.965382 cos_to_last_merge=0.8304 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.830
[S2] round=36 local utility u=0.223892 metrics={'f1_val': 0.8312556076982343, 'auprc': 0.880936113195002, 'loss_val': 0.4591966181628692, 'psi': 0.8511278098969414}-{'f1_val': 0.796897290656757, 'auprc': 0.8501256573104042, 'loss_val': 0.6083995185328205, 'psi': 0.8181886373182159}
[S3] START round=36 head_norm_before_train=2.089962 cos_to_last_merge=0.9930 (last merge round=25)
[S3] round=36 local utility u=0.199668 metrics={'f1_val': 0.9968752412829052, 'auprc': 0.9996633184193846, 'loss_val': 0.03666188517469621, 'psi': 0.997990472137497}-{'f1_val': 0.9514947630095069, 'auprc': 0.992349890004207, 'loss_val': 0.14177473410862287, 'psi': 0.967836813807387}
[S4] START round=36 head_norm_before_train=1.841111 cos_to_last_merge=0.8032 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.803
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9415180139533708, 'auprc': 0.9346985804114212, 'loss_val': 0.30007015904818973, 'psi': 0.9387902405365909}-{'f1_val': 0.9417292384939981, 'auprc': 0.9355872680890778, 'loss_val': 0.2972146427301653, 'psi': 0.93927245033203}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.772750 (no previous merge yet)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.6750678059155606, 'auprc': 0.8614745903649661, 'loss_val': 0.39968084066132203, 'psi': 0.7496305196953228}-{'f1_val': 0.8070453020980113, 'auprc': 0.9964307922468338, 'loss_val': 0.14439135448721926, 'psi': 0.8827994981575403}
[S6] START round=36 head_norm_before_train=1.616190 cos_to_last_merge=0.9960 (last merge round=33)
[S6] round=36 local utility u=0.950289 metrics={'f1_val': 0.9455823217045957, 'auprc': 0.9705962920199471, 'loss_val': 0.24500250575425153, 'psi': 0.9555879098307363}-{'f1_val': 0.6932055559520411, 'auprc': 0.9517430209501112, 'loss_val': 0.5747591994092046, 'psi': 0.7966205419512692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=36 head_norm_before_train=1.764195 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.6365047536411934, 'auprc': 0.8000738610093088, 'loss_val': 0.5959135976521783, 'psi': 0.7019323965884396}-{'f1_val': 0.6576966994530343, 'auprc': 0.8175759296809129, 'loss_val': 0.4881680512183909, 'psi': 0.7216483915441858}
[S8] START round=36 head_norm_before_train=1.692685 cos_to_last_merge=0.9724 (last merge round=23)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9930382012516658, 'auprc': 0.9988008488999736, 'loss_val': 0.03618371811619815, 'psi': 0.9953432603109889}-{'f1_val': 0.9939919029218467, 'auprc': 0.9981160540312254, 'loss_val': 0.036151814493017666, 'psi': 0.9956415633655982}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=2.049489 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9985416719500733, 'loss_val': 0.021249252619381372, 'psi': 0.9969126997985406}-{'f1_val': 0.9971029125121428, 'auprc': 0.9970301114183204, 'loss_val': 0.01941538556854897, 'psi': 0.9970737920746139}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.747185 cos_to_last_merge=0.9998 (last merge round=33)
[S10] round=36 local utility u=0.001147 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9926165190407367, 'loss_val': 0.03147992486193124, 'psi': 0.9941593110279194}-{'f1_val': 0.9945291067983943, 'auprc': 0.9937111634484963, 'loss_val': 0.03310491729601636, 'psi': 0.9942019294584351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=36 head_norm_before_train=1.739832 cos_to_last_merge=0.9998 (last merge round=33)
[S11] round=36 local utility u=0.000102 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9982933213174838, 'loss_val': 0.031464611175112796, 'psi': 0.9968524312481419}-{'f1_val': 0.996305167468861, 'auprc': 0.9981808467733841, 'loss_val': 0.03381147298050309, 'psi': 0.9970554391906703}
[S13] START round=36 head_norm_before_train=1.823969 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=36 local utility u=0.117549 metrics={'f1_val': 0.5707744149468605, 'auprc': 0.7135937727248923, 'loss_val': 0.8308405581176942, 'psi': 0.6279021580580733}-{'f1_val': 0.5686987883641226, 'auprc': 0.7046504155010935, 'loss_val': 1.0266538322489895, 'psi': 0.623079439218911}
[S14] START round=36 head_norm_before_train=2.111553 cos_to_last_merge=0.9999 (last merge round=33)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9961701069502772, 'auprc': 0.9954917038688746, 'loss_val': 0.0319657026945827, 'psi': 0.9958987457177162}-{'f1_val': 0.9972630104447024, 'auprc': 0.9995677360949119, 'loss_val': 0.028558519314377015, 'psi': 0.9981849007047863}
[S15] START round=36 head_norm_before_train=1.907249 cos_to_last_merge=0.9692 (last merge round=29)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.8762738286585734, 'auprc': 0.9859695828900771, 'loss_val': 0.2208336513064372, 'psi': 0.9201521303511749}-{'f1_val': 0.9143298520397746, 'auprc': 0.9909170596558794, 'loss_val': 0.15476287839921285, 'psi': 0.9449647350862165}
[S16] START round=36 head_norm_before_train=1.782480 cos_to_last_merge=0.9999 (last merge round=34)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9202705189684159, 'auprc': 0.9772479888864883, 'loss_val': 0.39237804217915395, 'psi': 0.9430615069356449}-{'f1_val': 0.9904949689748352, 'auprc': 0.9817779258200305, 'loss_val': 0.07958925533437021, 'psi': 0.9870081517129135}
[S17] START round=36 head_norm_before_train=2.165225 cos_to_last_merge=0.9995 (last merge round=30)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5737213637658101, 'auprc': 0.7859035408867276, 'loss_val': 1.5261672525813033, 'psi': 0.6585942346141771}-{'f1_val': 0.6374800003830063, 'auprc': 0.9591985462314941, 'loss_val': 1.2746884631131463, 'psi': 0.7661674187224015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.975622 cos_to_last_merge=0.8296 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.830
[S2] round=37 local utility u=0.017056 metrics={'f1_val': 0.8326085835518359, 'auprc': 0.8779950361587767, 'loss_val': 0.424378540492254, 'psi': 0.8507631645946122}-{'f1_val': 0.8312556076982343, 'auprc': 0.880936113195002, 'loss_val': 0.4591966181628692, 'psi': 0.8511278098969414}
[S3] START round=37 head_norm_before_train=2.097845 cos_to_last_merge=0.9926 (last merge round=25)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9478304869565217, 'auprc': 0.9988262381617214, 'loss_val': 0.1169786985277648, 'psi': 0.9682287874386015}-{'f1_val': 0.9968752412829052, 'auprc': 0.9996633184193846, 'loss_val': 0.03666188517469621, 'psi': 0.997990472137497}
[S4] START round=37 head_norm_before_train=1.851722 cos_to_last_merge=0.8027 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.803
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9322093961212755, 'auprc': 0.9346652687887095, 'loss_val': 0.36188429941887357, 'psi': 0.9331917451882492}-{'f1_val': 0.9415180139533708, 'auprc': 0.9346985804114212, 'loss_val': 0.30007015904818973, 'psi': 0.9387902405365909}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.779508 (no previous merge yet)
[S5] round=37 local utility u=0.280885 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9545460779317515, 'loss_val': 0.2686454964061235, 'psi': 0.8020112216330488}-{'f1_val': 0.6750678059155606, 'auprc': 0.8614745903649661, 'loss_val': 0.39968084066132203, 'psi': 0.7496305196953228}
[S6] START round=37 head_norm_before_train=1.679837 cos_to_last_merge=0.9920 (last merge round=33)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6484032226297514, 'auprc': 0.7871104252061252, 'loss_val': 0.8134959379019291, 'psi': 0.7038861036603009}-{'f1_val': 0.9455823217045957, 'auprc': 0.9705962920199471, 'loss_val': 0.24500250575425153, 'psi': 0.9555879098307363}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.769745 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5849426518070089, 'auprc': 0.7902496739270796, 'loss_val': 0.7576621262536443, 'psi': 0.6670654606550372}-{'f1_val': 0.6365047536411934, 'auprc': 0.8000738610093088, 'loss_val': 0.5959135976521783, 'psi': 0.7019323965884396}
[S8] START round=37 head_norm_before_train=1.708804 cos_to_last_merge=0.9710 (last merge round=23)
[S8] round=37 local utility u=0.004992 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9983252166526535, 'loss_val': 0.03269727366720382, 'psi': 0.9959455030203773}-{'f1_val': 0.9930382012516658, 'auprc': 0.9988008488999736, 'loss_val': 0.03618371811619815, 'psi': 0.9953432603109889}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=37 head_norm_before_train=2.053459 (no previous merge yet)
[S9] round=37 local utility u=0.000080 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9985516868903941, 'loss_val': 0.02111965116548255, 'psi': 0.9969167057746688}-{'f1_val': 0.9958267183641853, 'auprc': 0.9985416719500733, 'loss_val': 0.021249252619381372, 'psi': 0.9969126997985406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=37 head_norm_before_train=1.765855 cos_to_last_merge=0.9995 (last merge round=33)
[S10] round=37 local utility u=0.001894 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9940114707351667, 'loss_val': 0.030558181585156004, 'psi': 0.9945855002131123}-{'f1_val': 0.9951878390193748, 'auprc': 0.9926165190407367, 'loss_val': 0.03147992486193124, 'psi': 0.9941593110279194}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=37 head_norm_before_train=1.758826 cos_to_last_merge=0.9995 (last merge round=33)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9963294104943571, 'auprc': 0.9983813096950463, 'loss_val': 0.04728014804697919, 'psi': 0.9971501701746328}-{'f1_val': 0.9958918378685807, 'auprc': 0.9982933213174838, 'loss_val': 0.031464611175112796, 'psi': 0.9968524312481419}
[S13] START round=37 head_norm_before_train=1.839595 cos_to_last_merge=0.9999 (last merge round=35)
[S13] round=37 local utility u=0.243199 metrics={'f1_val': 0.6273103968768603, 'auprc': 0.7150600336806328, 'loss_val': 0.6880562365484795, 'psi': 0.6624102515983692}-{'f1_val': 0.5707744149468605, 'auprc': 0.7135937727248923, 'loss_val': 0.8308405581176942, 'psi': 0.6279021580580733}
[S14] START round=37 head_norm_before_train=2.119077 cos_to_last_merge=0.9997 (last merge round=33)
[S14] round=37 local utility u=0.010082 metrics={'f1_val': 0.9970633655553506, 'auprc': 0.9991946961767968, 'loss_val': 0.028270726879617628, 'psi': 0.9979158978039291}-{'f1_val': 0.9961701069502772, 'auprc': 0.9954917038688746, 'loss_val': 0.0319657026945827, 'psi': 0.9958987457177162}
[S15] START round=37 head_norm_before_train=1.934728 cos_to_last_merge=0.9668 (last merge round=29)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.8577101544289044, 'auprc': 0.9734037646593459, 'loss_val': 0.29228686614556093, 'psi': 0.903987598521081}-{'f1_val': 0.8762738286585734, 'auprc': 0.9859695828900771, 'loss_val': 0.2208336513064372, 'psi': 0.9201521303511749}
[S16] START round=37 head_norm_before_train=1.798666 cos_to_last_merge=0.9997 (last merge round=34)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8910969013479304, 'auprc': 0.9787427028611237, 'loss_val': 0.48940222352113366, 'psi': 0.9261552219532077}-{'f1_val': 0.9202705189684159, 'auprc': 0.9772479888864883, 'loss_val': 0.39237804217915395, 'psi': 0.9430615069356449}
[S17] START round=37 head_norm_before_train=2.177944 cos_to_last_merge=0.9993 (last merge round=30)
[S17] round=37 local utility u=0.433637 metrics={'f1_val': 0.6189937143638975, 'auprc': 0.931239139322002, 'loss_val': 1.366535097317391, 'psi': 0.7438918843471394}-{'f1_val': 0.5737213637658101, 'auprc': 0.7859035408867276, 'loss_val': 1.5261672525813033, 'psi': 0.6585942346141771}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.851)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] sending update (kind=head size=1808 to 1 peers)
[S13] not sending this round → trigger blocked (psi=0.662)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S2] START round=38 head_norm_before_train=1.987937 cos_to_last_merge=0.8287 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.829
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.7914051704886549, 'auprc': 0.7804467010085312, 'loss_val': 0.6146259169415405, 'psi': 0.7870217826966055}-{'f1_val': 0.8326085835518359, 'auprc': 0.8779950361587767, 'loss_val': 0.424378540492254, 'psi': 0.8507631645946122}
[S3] START round=38 head_norm_before_train=2.104434 cos_to_last_merge=0.9922 (last merge round=25)
[S3] round=38 local utility u=0.051665 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.9998299376853064, 'loss_val': 0.09459969427320036, 'psi': 0.9764241669356033}-{'f1_val': 0.9478304869565217, 'auprc': 0.9988262381617214, 'loss_val': 0.1169786985277648, 'psi': 0.9682287874386015}
[S4] START round=38 head_norm_before_train=1.865241 cos_to_last_merge=0.8025 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.803
[S4] round=38 local utility u=0.081532 metrics={'f1_val': 0.9407709846528929, 'auprc': 0.9352662430741286, 'loss_val': 0.2519932093094636, 'psi': 0.9385690880213872}-{'f1_val': 0.9322093961212755, 'auprc': 0.9346652687887095, 'loss_val': 0.36188429941887357, 'psi': 0.9331917451882492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=38 head_norm_before_train=1.785775 (no previous merge yet)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8558247506164747, 'loss_val': 0.9573501381488599, 'psi': 0.6043896385498131}-{'f1_val': 0.7003213174339138, 'auprc': 0.9545460779317515, 'loss_val': 0.2686454964061235, 'psi': 0.8020112216330488}
[S6] START round=38 head_norm_before_train=1.736153 cos_to_last_merge=0.9876 (last merge round=33)
[S6] round=38 local utility u=0.345761 metrics={'f1_val': 0.6870736087440107, 'auprc': 0.9412024766385627, 'loss_val': 0.8162725802643648, 'psi': 0.7887251559018316}-{'f1_val': 0.6484032226297514, 'auprc': 0.7871104252061252, 'loss_val': 0.8134959379019291, 'psi': 0.7038861036603009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=38 head_norm_before_train=1.775422 cos_to_last_merge=0.9999 (last merge round=34)
[S7] round=38 local utility u=0.224096 metrics={'f1_val': 0.6315429259348084, 'auprc': 0.7990473283815901, 'loss_val': 0.61546481881833, 'psi': 0.6985446869135211}-{'f1_val': 0.5849426518070089, 'auprc': 0.7902496739270796, 'loss_val': 0.7576621262536443, 'psi': 0.6670654606550372}
[S8] START round=38 head_norm_before_train=1.723958 cos_to_last_merge=0.9696 (last merge round=23)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9990331680552568, 'loss_val': 0.03493861379068103, 'psi': 0.9949120368951341}-{'f1_val': 0.9943590272655265, 'auprc': 0.9983252166526535, 'loss_val': 0.03269727366720382, 'psi': 0.9959455030203773}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=2.059110 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9986438825706455, 'loss_val': 0.023237906563129424, 'psi': 0.996204061723825}-{'f1_val': 0.9958267183641853, 'auprc': 0.9985516868903941, 'loss_val': 0.02111965116548255, 'psi': 0.9969167057746688}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.785430 cos_to_last_merge=0.9992 (last merge round=33)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9922627265192521, 'loss_val': 0.0301625992694985, 'psi': 0.9938860025267465}-{'f1_val': 0.9949681865317428, 'auprc': 0.9940114707351667, 'loss_val': 0.030558181585156004, 'psi': 0.9945855002131123}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.776179 cos_to_last_merge=0.9991 (last merge round=33)
[S11] round=38 local utility u=0.007196 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9983948257359525, 'loss_val': 0.03030424417314521, 'psi': 0.9968930330155295}-{'f1_val': 0.9963294104943571, 'auprc': 0.9983813096950463, 'loss_val': 0.04728014804697919, 'psi': 0.9971501701746328}
[S13] START round=38 head_norm_before_train=1.861004 cos_to_last_merge=0.9995 (last merge round=35)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5843475867084464, 'auprc': 0.7206836101519623, 'loss_val': 0.9752308490792684, 'psi': 0.6388819960858527}-{'f1_val': 0.6273103968768603, 'auprc': 0.7150600336806328, 'loss_val': 0.6880562365484795, 'psi': 0.6624102515983692}
[S14] START round=38 head_norm_before_train=2.126030 cos_to_last_merge=0.9996 (last merge round=33)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9969682102907778, 'auprc': 0.999477980822541, 'loss_val': 0.029213213110066756, 'psi': 0.9979721185034831}-{'f1_val': 0.9970633655553506, 'auprc': 0.9991946961767968, 'loss_val': 0.028270726879617628, 'psi': 0.9979158978039291}
[S15] START round=38 head_norm_before_train=1.959698 cos_to_last_merge=0.9646 (last merge round=29)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7748172784019252, 'auprc': 0.8583758271899777, 'loss_val': 0.5815310416493864, 'psi': 0.8082406979171461}-{'f1_val': 0.8577101544289044, 'auprc': 0.9734037646593459, 'loss_val': 0.29228686614556093, 'psi': 0.903987598521081}
[S16] START round=38 head_norm_before_train=1.815120 cos_to_last_merge=0.9993 (last merge round=34)
[S16] round=38 local utility u=0.219293 metrics={'f1_val': 0.9318921594191384, 'auprc': 0.9924633632019431, 'loss_val': 0.33675049452726735, 'psi': 0.9561206409322602}-{'f1_val': 0.8910969013479304, 'auprc': 0.9787427028611237, 'loss_val': 0.48940222352113366, 'psi': 0.9261552219532077}
[S17] START round=38 head_norm_before_train=2.181304 cos_to_last_merge=0.9994 (last merge round=30)
[S17] round=38 local utility u=0.602335 metrics={'f1_val': 0.7034677025112218, 'auprc': 0.9924439850792757, 'loss_val': 0.8523232026586408, 'psi': 0.8190582155384434}-{'f1_val': 0.6189937143638975, 'auprc': 0.931239139322002, 'loss_val': 1.366535097317391, 'psi': 0.7438918843471394}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.998128 cos_to_last_merge=0.8277 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.828
[S2] round=39 local utility u=0.316099 metrics={'f1_val': 0.8280273081062476, 'auprc': 0.8734837567607504, 'loss_val': 0.48127154577795883, 'psi': 0.8462098875680487}-{'f1_val': 0.7914051704886549, 'auprc': 0.7804467010085312, 'loss_val': 0.6146259169415405, 'psi': 0.7870217826966055}
[S3] START round=39 head_norm_before_train=2.111550 cos_to_last_merge=0.9917 (last merge round=25)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9285204626249796, 'auprc': 0.9987506373753463, 'loss_val': 0.14005786915702162, 'psi': 0.9566125325251262}-{'f1_val': 0.9608203197691346, 'auprc': 0.9998299376853064, 'loss_val': 0.09459969427320036, 'psi': 0.9764241669356033}
[S4] START round=39 head_norm_before_train=1.879933 cos_to_last_merge=0.8024 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.802
[S4] round=39 local utility u=0.014410 metrics={'f1_val': 0.9404634462620276, 'auprc': 0.9371758526505226, 'loss_val': 0.22705748500842948, 'psi': 0.9391484088174256}-{'f1_val': 0.9407709846528929, 'auprc': 0.9352662430741286, 'loss_val': 0.2519932093094636, 'psi': 0.9385690880213872}
[S4] not sending this round → trigger blocked (psi=0.939)
[S4] r=40 psi=0.939 u=0.0144 p_local=0.0230 f1=0.940 auprc=0.937 bytes=34119
[S5] START round=39 head_norm_before_train=1.792836 (no previous merge yet)
[S5] round=39 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9883121366759378, 'loss_val': 0.2740404695806593, 'psi': 0.8155176451307233}-{'f1_val': 0.43676623050537206, 'auprc': 0.8558247506164747, 'loss_val': 0.9573501381488599, 'psi': 0.6043896385498131}
[S6] START round=39 head_norm_before_train=1.769255 cos_to_last_merge=0.9846 (last merge round=33)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.41632933299599967, 'auprc': 0.8486560627518409, 'loss_val': 1.0398569981079056, 'psi': 0.5892600248983362}-{'f1_val': 0.6870736087440107, 'auprc': 0.9412024766385627, 'loss_val': 0.8162725802643648, 'psi': 0.7887251559018316}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.589 u=0.0000 p_local=0.2684 f1=0.416 auprc=0.849 bytes=37823
[S7] START round=39 head_norm_before_train=1.779916 cos_to_last_merge=0.9999 (last merge round=34)
[S7] round=39 local utility u=0.164976 metrics={'f1_val': 0.6532445306106756, 'auprc': 0.8172302819007666, 'loss_val': 0.47027219334247644, 'psi': 0.718838831126712}-{'f1_val': 0.6315429259348084, 'auprc': 0.7990473283815901, 'loss_val': 0.61546481881833, 'psi': 0.6985446869135211}
[S8] START round=39 head_norm_before_train=1.741171 cos_to_last_merge=0.9681 (last merge round=23)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.8956290660361086, 'auprc': 0.9940378530203369, 'loss_val': 0.18498027688674984, 'psi': 0.9349925808298}-{'f1_val': 0.9921646161217188, 'auprc': 0.9990331680552568, 'loss_val': 0.03493861379068103, 'psi': 0.9949120368951341}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.935 u=0.0000 p_local=0.0210 f1=0.896 auprc=0.994 bytes=37755
[S9] START round=39 head_norm_before_train=2.066339 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.998614354517855, 'loss_val': 0.024624672973316972, 'psi': 0.995691046800967}-{'f1_val': 0.9945775144926113, 'auprc': 0.9986438825706455, 'loss_val': 0.023237906563129424, 'psi': 0.996204061723825}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.996 u=0.0000 p_local=0.0067 f1=0.994 auprc=0.999 bytes=44982
[S10] START round=39 head_norm_before_train=1.803712 cos_to_last_merge=0.9989 (last merge round=33)
[S10] round=39 local utility u=0.000436 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9923209109224034, 'loss_val': 0.02946546356406164, 'psi': 0.9939092762880071}-{'f1_val': 0.9949681865317428, 'auprc': 0.9922627265192521, 'loss_val': 0.0301625992694985, 'psi': 0.9938860025267465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S10] r=40 psi=0.994 u=0.0004 p_local=0.0019 f1=0.995 auprc=0.992 bytes=44961
[S11] START round=39 head_norm_before_train=1.794695 cos_to_last_merge=0.9987 (last merge round=33)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9927721206646234, 'auprc': 0.9982183431237872, 'loss_val': 0.03765790587881277, 'psi': 0.994950609648289}-{'f1_val': 0.9958918378685807, 'auprc': 0.9983948257359525, 'loss_val': 0.03030424417314521, 'psi': 0.9968930330155295}
[S13] START round=39 head_norm_before_train=1.873494 cos_to_last_merge=0.9992 (last merge round=35)
[S13] round=39 local utility u=0.254623 metrics={'f1_val': 0.630855390698799, 'auprc': 0.7671110853057415, 'loss_val': 0.8843141405439411, 'psi': 0.6853576685415761}-{'f1_val': 0.5843475867084464, 'auprc': 0.7206836101519623, 'loss_val': 0.9752308490792684, 'psi': 0.6388819960858527}
[S14] START round=39 head_norm_before_train=2.131605 cos_to_last_merge=0.9995 (last merge round=33)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9930010897137757, 'auprc': 0.9972303269853944, 'loss_val': 0.03975684949165605, 'psi': 0.9946927846224232}-{'f1_val': 0.9969682102907778, 'auprc': 0.999477980822541, 'loss_val': 0.029213213110066756, 'psi': 0.9979721185034831}
[S15] START round=39 head_norm_before_train=1.983657 cos_to_last_merge=0.9626 (last merge round=29)
[S15] round=39 local utility u=0.242530 metrics={'f1_val': 0.8029611479511941, 'auprc': 0.9273233717205214, 'loss_val': 0.47217715468418503, 'psi': 0.852706037458925}-{'f1_val': 0.7748172784019252, 'auprc': 0.8583758271899777, 'loss_val': 0.5815310416493864, 'psi': 0.8082406979171461}
[S16] START round=39 head_norm_before_train=1.830227 cos_to_last_merge=0.9989 (last merge round=34)
[S16] round=39 local utility u=0.284872 metrics={'f1_val': 0.9887353986392995, 'auprc': 0.9786026298594108, 'loss_val': 0.06648406726160648, 'psi': 0.984682291127344}-{'f1_val': 0.9318921594191384, 'auprc': 0.9924633632019431, 'loss_val': 0.33675049452726735, 'psi': 0.9561206409322602}
[S17] START round=39 head_norm_before_train=2.189225 cos_to_last_merge=0.9994 (last merge round=30)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.3548765028752196, 'auprc': 0.7514702442808764, 'loss_val': 2.365590121536709, 'psi': 0.5135139994374823}-{'f1_val': 0.7034677025112218, 'auprc': 0.9924439850792757, 'loss_val': 0.8523232026586408, 'psi': 0.8190582155384434}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.985)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S13] r=40 psi=0.685 u=0.2546 p_local=0.1418 f1=0.631 auprc=0.767 bytes=28796
[S17] r=40 psi=0.514 u=0.0000 p_local=0.2475 f1=0.355 auprc=0.751 bytes=34157
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.719)
[S2] r=40 psi=0.846 u=0.3161 p_local=0.1064 f1=0.828 auprc=0.873 bytes=32417
[S16] r=40 psi=0.985 u=0.2849 p_local=0.1548 f1=0.989 auprc=0.979 bytes=41370
[S15] r=40 psi=0.853 u=0.2425 p_local=0.1289 f1=0.803 auprc=0.927 bytes=36017
[S3] r=40 psi=0.957 u=0.0000 p_local=0.1002 f1=0.929 auprc=0.999 bytes=39580
[S11] r=40 psi=0.995 u=0.0000 p_local=0.0266 f1=0.993 auprc=0.998 bytes=44996
[S5] r=40 psi=0.816 u=1.0000 p_local=0.3917 f1=0.700 auprc=0.988 bytes=37812
[S14] r=40 psi=0.995 u=0.0000 p_local=0.0071 f1=0.993 auprc=0.997 bytes=48585
[S7] r=40 psi=0.719 u=0.1650 p_local=0.2404 f1=0.653 auprc=0.817 bytes=37801
[S2] START round=40 head_norm_before_train=1.997482 cos_to_last_merge=0.8273 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.827
[S2] round=40 local utility u=0.020701 metrics={'f1_val': 0.8312746782286757, 'auprc': 0.8721534922653857, 'loss_val': 0.4553634736375904, 'psi': 0.8476262038433597}-{'f1_val': 0.8280273081062476, 'auprc': 0.8734837567607504, 'loss_val': 0.48127154577795883, 'psi': 0.8462098875680487}
[S3] START round=40 head_norm_before_train=2.118722 cos_to_last_merge=0.9912 (last merge round=25)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.824795981392553, 'auprc': 0.9985806378727278, 'loss_val': 0.33011386179001456, 'psi': 0.8943098439846229}-{'f1_val': 0.9285204626249796, 'auprc': 0.9987506373753463, 'loss_val': 0.14005786915702162, 'psi': 0.9566125325251262}
[S4] START round=40 head_norm_before_train=1.895156 cos_to_last_merge=0.8019 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.802
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9415933088420522, 'auprc': 0.9415441257482567, 'loss_val': 0.2503290810919665, 'psi': 0.941573635604534}-{'f1_val': 0.9404634462620276, 'auprc': 0.9371758526505226, 'loss_val': 0.22705748500842948, 'psi': 0.9391484088174256}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.795060 (no previous merge yet)
[S5] round=40 local utility u=0.389124 metrics={'f1_val': 0.8086753935393363, 'auprc': 0.9923879697728117, 'loss_val': 0.1581444990658847, 'psi': 0.8821604240327264}-{'f1_val': 0.7003213174339138, 'auprc': 0.9883121366759378, 'loss_val': 0.2740404695806593, 'psi': 0.8155176451307233}
[S6] START round=40 head_norm_before_train=1.801047 cos_to_last_merge=0.9812 (last merge round=33)
[S6] round=40 local utility u=1.000000 metrics={'f1_val': 0.777416219905966, 'auprc': 0.9484619047856783, 'loss_val': 0.6678512637566469, 'psi': 0.8458344938578509}-{'f1_val': 0.41632933299599967, 'auprc': 0.8486560627518409, 'loss_val': 1.0398569981079056, 'psi': 0.5892600248983362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=40 head_norm_before_train=1.783572 cos_to_last_merge=0.9998 (last merge round=34)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5941800657190617, 'auprc': 0.7880995115818034, 'loss_val': 0.6895578516385611, 'psi': 0.6717478440641584}-{'f1_val': 0.6532445306106756, 'auprc': 0.8172302819007666, 'loss_val': 0.47027219334247644, 'psi': 0.718838831126712}
[S8] START round=40 head_norm_before_train=1.753644 cos_to_last_merge=0.9669 (last merge round=23)
[S8] round=40 local utility u=0.380169 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9983459952237597, 'loss_val': 0.029946360626903385, 'psi': 0.9959538144488198}-{'f1_val': 0.8956290660361086, 'auprc': 0.9940378530203369, 'loss_val': 0.18498027688674984, 'psi': 0.9349925808298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=40 head_norm_before_train=2.074054 (no previous merge yet)
[S9] round=40 local utility u=0.005088 metrics={'f1_val': 0.994994420763055, 'auprc': 0.9985693847980962, 'loss_val': 0.021827353799529776, 'psi': 0.9964244063770715}-{'f1_val': 0.9937421749897083, 'auprc': 0.998614354517855, 'loss_val': 0.024624672973316972, 'psi': 0.995691046800967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=40 head_norm_before_train=1.818000 cos_to_last_merge=0.9986 (last merge round=33)
[S10] round=40 local utility u=0.001417 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9931015554833138, 'loss_val': 0.02897415582238568, 'psi': 0.9942215341123712}-{'f1_val': 0.9949681865317428, 'auprc': 0.9923209109224034, 'loss_val': 0.02946546356406164, 'psi': 0.9939092762880071}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=40 head_norm_before_train=1.810744 cos_to_last_merge=0.9983 (last merge round=33)
[S11] round=40 local utility u=0.015855 metrics={'f1_val': 0.996305167468861, 'auprc': 0.998188291450445, 'loss_val': 0.02705683125759783, 'psi': 0.9970584170614946}-{'f1_val': 0.9927721206646234, 'auprc': 0.9982183431237872, 'loss_val': 0.03765790587881277, 'psi': 0.994950609648289}
[S13] START round=40 head_norm_before_train=1.885476 cos_to_last_merge=0.9987 (last merge round=35)
[S13] round=40 local utility u=0.279497 metrics={'f1_val': 0.700724102329632, 'auprc': 0.7661580413863598, 'loss_val': 0.7416730545253618, 'psi': 0.7268976779523231}-{'f1_val': 0.630855390698799, 'auprc': 0.7671110853057415, 'loss_val': 0.8843141405439411, 'psi': 0.6853576685415761}
[S14] START round=40 head_norm_before_train=2.136671 cos_to_last_merge=0.9994 (last merge round=33)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9327597766792559, 'auprc': 0.9987895985533428, 'loss_val': 0.13219088736346615, 'psi': 0.9591717054288907}-{'f1_val': 0.9930010897137757, 'auprc': 0.9972303269853944, 'loss_val': 0.03975684949165605, 'psi': 0.9946927846224232}
[S15] START round=40 head_norm_before_train=2.007038 cos_to_last_merge=0.9606 (last merge round=29)
[S15] round=40 local utility u=0.831180 metrics={'f1_val': 0.9780178316435939, 'auprc': 0.9910977019301572, 'loss_val': 0.05147993627563633, 'psi': 0.9832497797582193}-{'f1_val': 0.8029611479511941, 'auprc': 0.9273233717205214, 'loss_val': 0.47217715468418503, 'psi': 0.852706037458925}
[S16] START round=40 head_norm_before_train=1.844318 cos_to_last_merge=0.9985 (last merge round=34)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.9421256333733121, 'auprc': 0.9939503682038334, 'loss_val': 0.1675128428472157, 'psi': 0.9628555273055206}-{'f1_val': 0.9887353986392995, 'auprc': 0.9786026298594108, 'loss_val': 0.06648406726160648, 'psi': 0.984682291127344}
[S17] START round=40 head_norm_before_train=2.194337 cos_to_last_merge=0.9992 (last merge round=30)
[S17] round=40 local utility u=1.000000 metrics={'f1_val': 0.5761196492576384, 'auprc': 0.904996663691173, 'loss_val': 1.278274247727449, 'psi': 0.7076704550310522}-{'f1_val': 0.3548765028752196, 'auprc': 0.7514702442808764, 'loss_val': 2.365590121536709, 'psi': 0.5135139994374823}
[S13] not sending this round → trigger blocked (psi=0.727)
[S5] not sending this round → trigger blocked (psi=0.882)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.848)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S15] not sending this round → trigger blocked (psi=0.983)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.999897 cos_to_last_merge=0.8269 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.827
[S2] round=41 local utility u=0.003392 metrics={'f1_val': 0.8310236605904664, 'auprc': 0.8747861343838805, 'loss_val': 0.4549703834067091, 'psi': 0.8485286501078321}-{'f1_val': 0.8312746782286757, 'auprc': 0.8721534922653857, 'loss_val': 0.4553634736375904, 'psi': 0.8476262038433597}
[S3] START round=41 head_norm_before_train=2.124481 cos_to_last_merge=0.9908 (last merge round=25)
[S3] round=41 local utility u=0.652605 metrics={'f1_val': 0.9935429260875812, 'auprc': 0.9994307394909698, 'loss_val': 0.03993533361168195, 'psi': 0.9958980514489366}-{'f1_val': 0.824795981392553, 'auprc': 0.9985806378727278, 'loss_val': 0.33011386179001456, 'psi': 0.8943098439846229}
[S4] START round=41 head_norm_before_train=1.908848 cos_to_last_merge=0.8011 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.801
[S4] round=41 local utility u=0.085972 metrics={'f1_val': 0.9508891136584692, 'auprc': 0.9472937559853991, 'loss_val': 0.15140809168711963, 'psi': 0.9494509705892411}-{'f1_val': 0.9415933088420522, 'auprc': 0.9415441257482567, 'loss_val': 0.2503290810919665, 'psi': 0.941573635604534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=41 head_norm_before_train=1.797152 (no previous merge yet)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.5791087457520409, 'auprc': 0.8559680439992573, 'loss_val': 0.6665947253281641, 'psi': 0.6898524650509275}-{'f1_val': 0.8086753935393363, 'auprc': 0.9923879697728117, 'loss_val': 0.1581444990658847, 'psi': 0.8821604240327264}
[S6] START round=41 head_norm_before_train=1.827886 cos_to_last_merge=0.9789 (last merge round=33)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.7502509430249906, 'auprc': 0.9186877886992418, 'loss_val': 0.7754054136790892, 'psi': 0.8176256812946912}-{'f1_val': 0.777416219905966, 'auprc': 0.9484619047856783, 'loss_val': 0.6678512637566469, 'psi': 0.8458344938578509}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.787507 cos_to_last_merge=0.9998 (last merge round=34)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.478988723249877, 'auprc': 0.7801624952844917, 'loss_val': 1.0265813780277029, 'psi': 0.599458232063723}-{'f1_val': 0.5941800657190617, 'auprc': 0.7880995115818034, 'loss_val': 0.6895578516385611, 'psi': 0.6717478440641584}
[S8] START round=41 head_norm_before_train=1.767876 cos_to_last_merge=0.9657 (last merge round=23)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9991135394690387, 'loss_val': 0.03116505111785508, 'psi': 0.9958206180563134}-{'f1_val': 0.9943590272655265, 'auprc': 0.9983459952237597, 'loss_val': 0.029946360626903385, 'psi': 0.9959538144488198}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=2.082678 (no previous merge yet)
[S9] round=41 local utility u=0.003301 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9964321308600123, 'loss_val': 0.018810871606391347, 'psi': 0.9965691594323398}-{'f1_val': 0.994994420763055, 'auprc': 0.9985693847980962, 'loss_val': 0.021827353799529776, 'psi': 0.9964244063770715}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=41 head_norm_before_train=1.833454 cos_to_last_merge=0.9983 (last merge round=33)
[S10] round=41 local utility u=0.000333 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9932300316046959, 'loss_val': 0.028694125196711582, 'psi': 0.9942729245609241}-{'f1_val': 0.9949681865317428, 'auprc': 0.9931015554833138, 'loss_val': 0.02897415582238568, 'psi': 0.9942215341123712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=41 head_norm_before_train=1.824138 cos_to_last_merge=0.9980 (last merge round=33)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9915134273819638, 'auprc': 0.9980663230981448, 'loss_val': 0.039027288457352816, 'psi': 0.9941345856684362}-{'f1_val': 0.996305167468861, 'auprc': 0.998188291450445, 'loss_val': 0.02705683125759783, 'psi': 0.9970584170614946}
[S13] START round=41 head_norm_before_train=1.897012 cos_to_last_merge=0.9984 (last merge round=35)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.601358972555726, 'auprc': 0.7718966525932587, 'loss_val': 1.012197391036807, 'psi': 0.6695740445707391}-{'f1_val': 0.700724102329632, 'auprc': 0.7661580413863598, 'loss_val': 0.7416730545253618, 'psi': 0.7268976779523231}
[S14] START round=41 head_norm_before_train=2.143193 cos_to_last_merge=0.9993 (last merge round=33)
[S14] round=41 local utility u=0.238025 metrics={'f1_val': 0.9972338633037168, 'auprc': 0.9941715541476666, 'loss_val': 0.02913128800661528, 'psi': 0.9960089396412968}-{'f1_val': 0.9327597766792559, 'auprc': 0.9987895985533428, 'loss_val': 0.13219088736346615, 'psi': 0.9591717054288907}
[S15] START round=41 head_norm_before_train=2.022749 cos_to_last_merge=0.9591 (last merge round=29)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.7009180804352899, 'auprc': 0.7085833177406126, 'loss_val': 0.8297615132807615, 'psi': 0.703984175357419}-{'f1_val': 0.9780178316435939, 'auprc': 0.9910977019301572, 'loss_val': 0.05147993627563633, 'psi': 0.9832497797582193}
[S16] START round=41 head_norm_before_train=1.858054 cos_to_last_merge=0.9981 (last merge round=34)
[S16] round=41 local utility u=0.189344 metrics={'f1_val': 0.9903276314588833, 'auprc': 0.9876638675130318, 'loss_val': 0.05917802499199618, 'psi': 0.9892621258805427}-{'f1_val': 0.9421256333733121, 'auprc': 0.9939503682038334, 'loss_val': 0.1675128428472157, 'psi': 0.9628555273055206}
[S17] START round=41 head_norm_before_train=2.200300 cos_to_last_merge=0.9990 (last merge round=30)
[S17] round=41 local utility u=0.159362 metrics={'f1_val': 0.6297563012970093, 'auprc': 0.9437807580907761, 'loss_val': 1.3977231940672037, 'psi': 0.755366084014516}-{'f1_val': 0.5761196492576384, 'auprc': 0.904996663691173, 'loss_val': 1.278274247727449, 'psi': 0.7076704550310522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] not sending this round → trigger blocked (psi=0.755)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S2] START round=42 head_norm_before_train=2.009652 cos_to_last_merge=0.8261 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.826
[S2] round=42 local utility u=0.005953 metrics={'f1_val': 0.8306797636065559, 'auprc': 0.8850823174241931, 'loss_val': 0.47188855360606197, 'psi': 0.8524407851336108}-{'f1_val': 0.8310236605904664, 'auprc': 0.8747861343838805, 'loss_val': 0.4549703834067091, 'psi': 0.8485286501078321}
[S3] START round=42 head_norm_before_train=2.130241 cos_to_last_merge=0.9905 (last merge round=25)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9100305827221182, 'auprc': 0.9780883737005343, 'loss_val': 0.21616699406396173, 'psi': 0.9372536991134846}-{'f1_val': 0.9935429260875812, 'auprc': 0.9994307394909698, 'loss_val': 0.03993533361168195, 'psi': 0.9958980514489366}
[S4] START round=42 head_norm_before_train=1.918587 cos_to_last_merge=0.7999 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.800
[S4] round=42 local utility u=0.025132 metrics={'f1_val': 0.9522980144127811, 'auprc': 0.9591443155675715, 'loss_val': 0.14514963614392618, 'psi': 0.9550365348746973}-{'f1_val': 0.9508891136584692, 'auprc': 0.9472937559853991, 'loss_val': 0.15140809168711963, 'psi': 0.9494509705892411}
[S4] not sending this round → trigger blocked (psi=0.955)
[S5] START round=42 head_norm_before_train=1.799700 (no previous merge yet)
[S5] round=42 local utility u=0.936819 metrics={'f1_val': 0.7519191884310261, 'auprc': 0.9848145868375251, 'loss_val': 0.216358677883101, 'psi': 0.8450773477936258}-{'f1_val': 0.5791087457520409, 'auprc': 0.8559680439992573, 'loss_val': 0.6665947253281641, 'psi': 0.6898524650509275}
[S6] START round=42 head_norm_before_train=1.853821 cos_to_last_merge=0.9768 (last merge round=33)
[S6] round=42 local utility u=0.076232 metrics={'f1_val': 0.7377840123090978, 'auprc': 0.9588975307872831, 'loss_val': 0.6687684041093456, 'psi': 0.826229419700372}-{'f1_val': 0.7502509430249906, 'auprc': 0.9186877886992418, 'loss_val': 0.7754054136790892, 'psi': 0.8176256812946912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=42 head_norm_before_train=1.792980 cos_to_last_merge=0.9997 (last merge round=34)
[S7] round=42 local utility u=0.951886 metrics={'f1_val': 0.669252572351141, 'auprc': 0.8273689733505323, 'loss_val': 0.40601262987103803, 'psi': 0.7324991327508976}-{'f1_val': 0.478988723249877, 'auprc': 0.7801624952844917, 'loss_val': 1.0265813780277029, 'psi': 0.599458232063723}
[S8] START round=42 head_norm_before_train=1.782045 cos_to_last_merge=0.9645 (last merge round=23)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9595527125010317, 'auprc': 0.9964414137916036, 'loss_val': 0.10815697177168851, 'psi': 0.9743081930172605}-{'f1_val': 0.9936253371144965, 'auprc': 0.9991135394690387, 'loss_val': 0.03116505111785508, 'psi': 0.9958206180563134}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=2.090189 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9953630299979683, 'loss_val': 0.018648536479267824, 'psi': 0.9961415190875222}-{'f1_val': 0.9966605118138915, 'auprc': 0.9964321308600123, 'loss_val': 0.018810871606391347, 'psi': 0.9965691594323398}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.846663 cos_to_last_merge=0.9979 (last merge round=33)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9931406946214593, 'loss_val': 0.028458638273232674, 'psi': 0.9942371897676294}-{'f1_val': 0.9949681865317428, 'auprc': 0.9932300316046959, 'loss_val': 0.028694125196711582, 'psi': 0.9942729245609241}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.836223 cos_to_last_merge=0.9976 (last merge round=33)
[S11] round=42 local utility u=0.020810 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980971161666812, 'loss_val': 0.026249824079575833, 'psi': 0.9970219469479891}-{'f1_val': 0.9915134273819638, 'auprc': 0.9980663230981448, 'loss_val': 0.039027288457352816, 'psi': 0.9941345856684362}
[S13] START round=42 head_norm_before_train=1.906868 cos_to_last_merge=0.9981 (last merge round=35)
[S13] round=42 local utility u=0.195028 metrics={'f1_val': 0.6387150684749008, 'auprc': 0.7634673940007364, 'loss_val': 0.820989377116024, 'psi': 0.6886159986852349}-{'f1_val': 0.601358972555726, 'auprc': 0.7718966525932587, 'loss_val': 1.012197391036807, 'psi': 0.6695740445707391}
[S14] START round=42 head_norm_before_train=2.148208 cos_to_last_merge=0.9991 (last merge round=33)
[S14] round=42 local utility u=0.004263 metrics={'f1_val': 0.9961839019930665, 'auprc': 0.9991824666027529, 'loss_val': 0.029339103313921543, 'psi': 0.9973833278369411}-{'f1_val': 0.9972338633037168, 'auprc': 0.9941715541476666, 'loss_val': 0.02913128800661528, 'psi': 0.9960089396412968}
[S15] START round=42 head_norm_before_train=2.036947 cos_to_last_merge=0.9578 (last merge round=29)
[S15] round=42 local utility u=1.000000 metrics={'f1_val': 0.9171300932658597, 'auprc': 0.9920303075566732, 'loss_val': 0.16051788546064014, 'psi': 0.9470901789821852}-{'f1_val': 0.7009180804352899, 'auprc': 0.7085833177406126, 'loss_val': 0.8297615132807615, 'psi': 0.703984175357419}
[S16] START round=42 head_norm_before_train=1.869277 cos_to_last_merge=0.9976 (last merge round=34)
[S16] round=42 local utility u=0.016702 metrics={'f1_val': 0.9915721878737821, 'auprc': 0.9939882256589652, 'loss_val': 0.05221436287482128, 'psi': 0.9925386029878553}-{'f1_val': 0.9903276314588833, 'auprc': 0.9876638675130318, 'loss_val': 0.05917802499199618, 'psi': 0.9892621258805427}
[S17] START round=42 head_norm_before_train=2.210444 cos_to_last_merge=0.9989 (last merge round=30)
[S17] round=42 local utility u=1.000000 metrics={'f1_val': 0.8519709145390293, 'auprc': 0.9649380454692535, 'loss_val': 0.5943700762758639, 'psi': 0.8971577669111189}-{'f1_val': 0.6297563012970093, 'auprc': 0.9437807580907761, 'loss_val': 1.3977231940672037, 'psi': 0.755366084014516}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.993)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] not sending this round → trigger blocked (psi=0.852)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.997)
[S2] START round=43 head_norm_before_train=2.021577 cos_to_last_merge=0.8252 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.825
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.728335578846905, 'auprc': 0.8525848171828363, 'loss_val': 0.9577419398307039, 'psi': 0.7780352741812775}-{'f1_val': 0.8306797636065559, 'auprc': 0.8850823174241931, 'loss_val': 0.47188855360606197, 'psi': 0.8524407851336108}
[S3] START round=43 head_norm_before_train=2.136602 cos_to_last_merge=0.9900 (last merge round=25)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.7430487617487415, 'auprc': 0.9984681804703224, 'loss_val': 0.52247281849283, 'psi': 0.8452165292373739}-{'f1_val': 0.9100305827221182, 'auprc': 0.9780883737005343, 'loss_val': 0.21616699406396173, 'psi': 0.9372536991134846}
[S4] START round=43 head_norm_before_train=1.920905 cos_to_last_merge=0.7992 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.799
[S4] round=43 local utility u=0.005375 metrics={'f1_val': 0.9529923952889041, 'auprc': 0.9578841735477931, 'loss_val': 0.13478616758314965, 'psi': 0.9549491065924598}-{'f1_val': 0.9522980144127811, 'auprc': 0.9591443155675715, 'loss_val': 0.14514963614392618, 'psi': 0.9550365348746973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=43 head_norm_before_train=1.801859 (no previous merge yet)
[S5] round=43 local utility u=0.270776 metrics={'f1_val': 0.8338451275282144, 'auprc': 0.9914038178295779, 'loss_val': 0.18612925123415966, 'psi': 0.8968686036487599}-{'f1_val': 0.7519191884310261, 'auprc': 0.9848145868375251, 'loss_val': 0.216358677883101, 'psi': 0.8450773477936258}
[S6] START round=43 head_norm_before_train=1.862947 cos_to_last_merge=0.9752 (last merge round=33)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.6402765106301634, 'auprc': 0.9061641563754788, 'loss_val': 0.9173287381386431, 'psi': 0.7466315689282896}-{'f1_val': 0.7377840123090978, 'auprc': 0.9588975307872831, 'loss_val': 0.6687684041093456, 'psi': 0.826229419700372}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.796992 cos_to_last_merge=0.9996 (last merge round=34)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.6616005717302068, 'auprc': 0.8174072338785989, 'loss_val': 0.4693038271044964, 'psi': 0.7239232365895636}-{'f1_val': 0.669252572351141, 'auprc': 0.8273689733505323, 'loss_val': 0.40601262987103803, 'psi': 0.7324991327508976}
[S8] START round=43 head_norm_before_train=1.792716 cos_to_last_merge=0.9635 (last merge round=23)
[S8] round=43 local utility u=0.138566 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9991021705082263, 'loss_val': 0.03467895639451257, 'psi': 0.9949396378763218}-{'f1_val': 0.9595527125010317, 'auprc': 0.9964414137916036, 'loss_val': 0.10815697177168851, 'psi': 0.9743081930172605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=43 head_norm_before_train=2.097379 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9890975148541, 'auprc': 0.9986631387357289, 'loss_val': 0.03870204714597454, 'psi': 0.9929237644067516}-{'f1_val': 0.9966605118138915, 'auprc': 0.9953630299979683, 'loss_val': 0.018648536479267824, 'psi': 0.9961415190875222}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.859058 cos_to_last_merge=0.9976 (last merge round=33)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9922205171455187, 'loss_val': 0.028099171124324775, 'psi': 0.9940009102698324}-{'f1_val': 0.9949681865317428, 'auprc': 0.9931406946214593, 'loss_val': 0.028458638273232674, 'psi': 0.9942371897676294}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.844826 cos_to_last_merge=0.9974 (last merge round=33)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9485298455816207, 'auprc': 0.9965176439678971, 'loss_val': 0.2528551921345995, 'psi': 0.9677249649361312}-{'f1_val': 0.996305167468861, 'auprc': 0.9980971161666812, 'loss_val': 0.026249824079575833, 'psi': 0.9970219469479891}
[S13] START round=43 head_norm_before_train=1.915076 cos_to_last_merge=0.9977 (last merge round=35)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6079823851472452, 'auprc': 0.7769922264247677, 'loss_val': 1.0012291219696965, 'psi': 0.6755863216582543}-{'f1_val': 0.6387150684749008, 'auprc': 0.7634673940007364, 'loss_val': 0.820989377116024, 'psi': 0.6886159986852349}
[S14] START round=43 head_norm_before_train=2.153625 cos_to_last_merge=0.9990 (last merge round=33)
[S14] round=43 local utility u=0.006117 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9995531924979395, 'loss_val': 0.02424394797211695, 'psi': 0.9981341982012898}-{'f1_val': 0.9961839019930665, 'auprc': 0.9991824666027529, 'loss_val': 0.029339103313921543, 'psi': 0.9973833278369411}
[S15] START round=43 head_norm_before_train=2.051072 cos_to_last_merge=0.9565 (last merge round=29)
[S15] round=43 local utility u=0.302622 metrics={'f1_val': 0.9959176576326709, 'auprc': 0.9914999606332544, 'loss_val': 0.026409026264374618, 'psi': 0.9941505788329044}-{'f1_val': 0.9171300932658597, 'auprc': 0.9920303075566732, 'loss_val': 0.16051788546064014, 'psi': 0.9470901789821852}
[S16] START round=43 head_norm_before_train=1.879622 cos_to_last_merge=0.9972 (last merge round=34)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9892375565720886, 'auprc': 0.9912140273090576, 'loss_val': 0.06816039562724352, 'psi': 0.9900281448668762}-{'f1_val': 0.9915721878737821, 'auprc': 0.9939882256589652, 'loss_val': 0.05221436287482128, 'psi': 0.9925386029878553}
[S17] START round=43 head_norm_before_train=2.218712 cos_to_last_merge=0.9987 (last merge round=30)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6146816634958128, 'auprc': 0.8494814739693282, 'loss_val': 1.5034491174366575, 'psi': 0.708601587685219}-{'f1_val': 0.8519709145390293, 'auprc': 0.9649380454692535, 'loss_val': 0.5943700762758639, 'psi': 0.8971577669111189}
[S5] not sending this round → trigger blocked (psi=0.897)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.994)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=2.030722 cos_to_last_merge=0.8242 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.824
[S2] round=44 local utility u=0.557338 metrics={'f1_val': 0.8322243379710316, 'auprc': 0.845715493804023, 'loss_val': 0.4457910662707688, 'psi': 0.8376208003042281}-{'f1_val': 0.728335578846905, 'auprc': 0.8525848171828363, 'loss_val': 0.9577419398307039, 'psi': 0.7780352741812775}
[S3] START round=44 head_norm_before_train=2.143801 cos_to_last_merge=0.9896 (last merge round=25)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.7295740893245332, 'auprc': 0.9985520129162349, 'loss_val': 0.5389845957302266, 'psi': 0.8371652587612138}-{'f1_val': 0.7430487617487415, 'auprc': 0.9984681804703224, 'loss_val': 0.52247281849283, 'psi': 0.8452165292373739}
[S4] START round=44 head_norm_before_train=1.930425 cos_to_last_merge=0.7988 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.799
[S4] round=44 local utility u=0.059534 metrics={'f1_val': 0.9665923235050334, 'auprc': 0.9641820439326855, 'loss_val': 0.11621160923434495, 'psi': 0.9656282116760941}-{'f1_val': 0.9529923952889041, 'auprc': 0.9578841735477931, 'loss_val': 0.13478616758314965, 'psi': 0.9549491065924598}
[S4] not sending this round → trigger blocked (psi=0.966)
[S5] START round=44 head_norm_before_train=1.805632 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.42927607633489984, 'auprc': 0.8557102676988607, 'loss_val': 1.2645790257504235, 'psi': 0.5998497528804843}-{'f1_val': 0.8338451275282144, 'auprc': 0.9914038178295779, 'loss_val': 0.18612925123415966, 'psi': 0.8968686036487599}
[S6] START round=44 head_norm_before_train=1.881143 cos_to_last_merge=0.9734 (last merge round=33)
[S6] round=44 local utility u=0.060986 metrics={'f1_val': 0.6281272065793115, 'auprc': 0.9591464592520813, 'loss_val': 0.8814074679936347, 'psi': 0.7605349076484195}-{'f1_val': 0.6402765106301634, 'auprc': 0.9061641563754788, 'loss_val': 0.9173287381386431, 'psi': 0.7466315689282896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=44 head_norm_before_train=1.799651 cos_to_last_merge=0.9995 (last merge round=34)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5447083830875246, 'auprc': 0.7806459918093188, 'loss_val': 0.9115808655516813, 'psi': 0.6390834265762423}-{'f1_val': 0.6616005717302068, 'auprc': 0.8174072338785989, 'loss_val': 0.4693038271044964, 'psi': 0.7239232365895636}
[S8] START round=44 head_norm_before_train=1.801098 cos_to_last_merge=0.9626 (last merge round=23)
[S8] round=44 local utility u=0.009785 metrics={'f1_val': 0.9945058427751525, 'auprc': 0.999359134297028, 'loss_val': 0.029927164216027098, 'psi': 0.9964471593839027}-{'f1_val': 0.9921646161217188, 'auprc': 0.9991021705082263, 'loss_val': 0.03467895639451257, 'psi': 0.9949396378763218}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=44 head_norm_before_train=2.101304 (no previous merge yet)
[S9] round=44 local utility u=0.026611 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9946834916950077, 'loss_val': 0.01891909880227773, 'psi': 0.995869703766338}-{'f1_val': 0.9890975148541, 'auprc': 0.9986631387357289, 'loss_val': 0.03870204714597454, 'psi': 0.9929237644067516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=44 head_norm_before_train=1.872513 cos_to_last_merge=0.9972 (last merge round=33)
[S10] round=44 local utility u=0.001900 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9938701555328832, 'loss_val': 0.027930029245365896, 'psi': 0.994528974132199}-{'f1_val': 0.9951878390193748, 'auprc': 0.9922205171455187, 'loss_val': 0.028099171124324775, 'psi': 0.9940009102698324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=44 head_norm_before_train=1.852753 cos_to_last_merge=0.9971 (last merge round=33)
[S11] round=44 local utility u=0.259379 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981119595601671, 'loss_val': 0.025532208543781503, 'psi': 0.9970278843053835}-{'f1_val': 0.9485298455816207, 'auprc': 0.9965176439678971, 'loss_val': 0.2528551921345995, 'psi': 0.9677249649361312}
[S13] START round=44 head_norm_before_train=1.925117 cos_to_last_merge=0.9973 (last merge round=35)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6074636410936891, 'auprc': 0.7533445409829086, 'loss_val': 0.9897002867460607, 'psi': 0.665816001049377}-{'f1_val': 0.6079823851472452, 'auprc': 0.7769922264247677, 'loss_val': 1.0012291219696965, 'psi': 0.6755863216582543}
[S14] START round=44 head_norm_before_train=2.161841 cos_to_last_merge=0.9988 (last merge round=33)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9987374221528765, 'loss_val': 0.025901953079877395, 'psi': 0.9975632733654339}-{'f1_val': 0.9971882020035234, 'auprc': 0.9995531924979395, 'loss_val': 0.02424394797211695, 'psi': 0.9981341982012898}
[S15] START round=44 head_norm_before_train=2.066939 cos_to_last_merge=0.9550 (last merge round=29)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7021207024995553, 'auprc': 0.8048007841361347, 'loss_val': 0.7814240393163768, 'psi': 0.743192735154187}-{'f1_val': 0.9959176576326709, 'auprc': 0.9914999606332544, 'loss_val': 0.026409026264374618, 'psi': 0.9941505788329044}
[S16] START round=44 head_norm_before_train=1.888764 cos_to_last_merge=0.9968 (last merge round=34)
[S16] round=44 local utility u=0.003140 metrics={'f1_val': 0.9904975852675362, 'auprc': 0.9863214708356831, 'loss_val': 0.05476279772941194, 'psi': 0.988827139494795}-{'f1_val': 0.9892375565720886, 'auprc': 0.9912140273090576, 'loss_val': 0.06816039562724352, 'psi': 0.9900281448668762}
[S17] START round=44 head_norm_before_train=2.225260 cos_to_last_merge=0.9985 (last merge round=30)
[S17] round=44 local utility u=1.000000 metrics={'f1_val': 0.8658037226140547, 'auprc': 0.9204682487320942, 'loss_val': 0.5847239434694163, 'psi': 0.8876695330612705}-{'f1_val': 0.6146816634958128, 'auprc': 0.8494814739693282, 'loss_val': 1.5034491174366575, 'psi': 0.708601587685219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=2.037495 cos_to_last_merge=0.8234 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.823
[S2] round=45 local utility u=0.020920 metrics={'f1_val': 0.8318180083647636, 'auprc': 0.8682189161235845, 'loss_val': 0.4690231113713153, 'psi': 0.846378371468292}-{'f1_val': 0.8322243379710316, 'auprc': 0.845715493804023, 'loss_val': 0.4457910662707688, 'psi': 0.8376208003042281}
[S3] START round=45 head_norm_before_train=2.149894 cos_to_last_merge=0.9891 (last merge round=25)
[S3] round=45 local utility u=0.826365 metrics={'f1_val': 0.9497605478144417, 'auprc': 0.9823157145543779, 'loss_val': 0.15866392616885125, 'psi': 0.9627826145104161}-{'f1_val': 0.7295740893245332, 'auprc': 0.9985520129162349, 'loss_val': 0.5389845957302266, 'psi': 0.8371652587612138}
[S4] START round=45 head_norm_before_train=1.941232 cos_to_last_merge=0.7980 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.798
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9273820565918031, 'auprc': 0.9541932962047279, 'loss_val': 0.22495001371843917, 'psi': 0.9381065524369729}-{'f1_val': 0.9665923235050334, 'auprc': 0.9641820439326855, 'loss_val': 0.11621160923434495, 'psi': 0.9656282116760941}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.810901 (no previous merge yet)
[S5] round=45 local utility u=1.000000 metrics={'f1_val': 0.667424634376281, 'auprc': 0.8992897547127119, 'loss_val': 0.35642400188032786, 'psi': 0.7601706825108534}-{'f1_val': 0.42927607633489984, 'auprc': 0.8557102676988607, 'loss_val': 1.2645790257504235, 'psi': 0.5998497528804843}
[S6] START round=45 head_norm_before_train=1.894435 cos_to_last_merge=0.9717 (last merge round=33)
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.8648710105877193, 'auprc': 0.9755204812210647, 'loss_val': 0.3215637548251312, 'psi': 0.9091307988410575}-{'f1_val': 0.6281272065793115, 'auprc': 0.9591464592520813, 'loss_val': 0.8814074679936347, 'psi': 0.7605349076484195}
[S6] not sending this round → trigger blocked (psi=0.909)
[S7] START round=45 head_norm_before_train=1.801735 cos_to_last_merge=0.9994 (last merge round=34)
[S7] round=45 local utility u=0.779328 metrics={'f1_val': 0.6839512574202906, 'auprc': 0.8369226662174833, 'loss_val': 0.3572113792749928, 'psi': 0.7451398209391678}-{'f1_val': 0.5447083830875246, 'auprc': 0.7806459918093188, 'loss_val': 0.9115808655516813, 'psi': 0.6390834265762423}
[S8] START round=45 head_norm_before_train=1.810873 cos_to_last_merge=0.9616 (last merge round=23)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9991571983562761, 'loss_val': 0.02842493204362251, 'psi': 0.9960580210956185}-{'f1_val': 0.9945058427751525, 'auprc': 0.999359134297028, 'loss_val': 0.029927164216027098, 'psi': 0.9964471593839027}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=2.105289 (no previous merge yet)
[S9] round=45 local utility u=0.001554 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.995682256924092, 'loss_val': 0.01880768783028779, 'psi': 0.9962692098579716}-{'f1_val': 0.9966605118138915, 'auprc': 0.9946834916950077, 'loss_val': 0.01891909880227773, 'psi': 0.995869703766338}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=45 head_norm_before_train=1.885834 cos_to_last_merge=0.9969 (last merge round=33)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9920918567683912, 'loss_val': 0.027875777439237182, 'psi': 0.9938176546264021}-{'f1_val': 0.9949681865317428, 'auprc': 0.9938701555328832, 'loss_val': 0.027930029245365896, 'psi': 0.994528974132199}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.859913 cos_to_last_merge=0.9969 (last merge round=33)
[S11] round=45 local utility u=0.000111 metrics={'f1_val': 0.996305167468861, 'auprc': 0.998102760677968, 'loss_val': 0.02528240852267631, 'psi': 0.9970242047525038}-{'f1_val': 0.996305167468861, 'auprc': 0.9981119595601671, 'loss_val': 0.025532208543781503, 'psi': 0.9970278843053835}
[S13] START round=45 head_norm_before_train=1.937774 cos_to_last_merge=0.9968 (last merge round=35)
[S13] round=45 local utility u=0.101358 metrics={'f1_val': 0.6246987378006416, 'auprc': 0.7786315711104465, 'loss_val': 0.9662564158944636, 'psi': 0.6862718711245634}-{'f1_val': 0.6074636410936891, 'auprc': 0.7533445409829086, 'loss_val': 0.9897002867460607, 'psi': 0.665816001049377}
[S14] START round=45 head_norm_before_train=2.168298 cos_to_last_merge=0.9987 (last merge round=33)
[S14] round=45 local utility u=0.001198 metrics={'f1_val': 0.9970233560109115, 'auprc': 0.9988448349616459, 'loss_val': 0.02528481725102423, 'psi': 0.9977519475912053}-{'f1_val': 0.9967805075071389, 'auprc': 0.9987374221528765, 'loss_val': 0.025901953079877395, 'psi': 0.9975632733654339}
[S15] START round=45 head_norm_before_train=2.083480 cos_to_last_merge=0.9536 (last merge round=29)
[S15] round=45 local utility u=1.000000 metrics={'f1_val': 0.992840618097343, 'auprc': 0.9968020337077541, 'loss_val': 0.03360216140189907, 'psi': 0.9944251843415075}-{'f1_val': 0.7021207024995553, 'auprc': 0.8048007841361347, 'loss_val': 0.7814240393163768, 'psi': 0.743192735154187}
[S16] START round=45 head_norm_before_train=1.898583 cos_to_last_merge=0.9964 (last merge round=34)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9898059715009404, 'auprc': 0.9859286911414419, 'loss_val': 0.05419902917648546, 'psi': 0.988255059357141}-{'f1_val': 0.9904975852675362, 'auprc': 0.9863214708356831, 'loss_val': 0.05476279772941194, 'psi': 0.988827139494795}
[S17] START round=45 head_norm_before_train=2.232411 cos_to_last_merge=0.9983 (last merge round=30)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6143082801096009, 'auprc': 0.9323983423341324, 'loss_val': 1.4994123133178123, 'psi': 0.7415443049994135}-{'f1_val': 0.8658037226140547, 'auprc': 0.9204682487320942, 'loss_val': 0.5847239434694163, 'psi': 0.8876695330612705}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.846)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S2] START round=46 head_norm_before_train=2.048258 cos_to_last_merge=0.8228 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.823
[S2] round=46 local utility u=0.031279 metrics={'f1_val': 0.8293178026893622, 'auprc': 0.8908762177123455, 'loss_val': 0.4594358216188282, 'psi': 0.8539411686985555}-{'f1_val': 0.8318180083647636, 'auprc': 0.8682189161235845, 'loss_val': 0.4690231113713153, 'psi': 0.846378371468292}
[S3] START round=46 head_norm_before_train=2.156548 cos_to_last_merge=0.9886 (last merge round=25)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9327799420242187, 'auprc': 0.9986812857357046, 'loss_val': 0.13154907701108157, 'psi': 0.9591404795088131}-{'f1_val': 0.9497605478144417, 'auprc': 0.9823157145543779, 'loss_val': 0.15866392616885125, 'psi': 0.9627826145104161}
[S4] START round=46 head_norm_before_train=1.945640 cos_to_last_merge=0.7975 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.797
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9320084824575132, 'auprc': 0.9403171930184541, 'loss_val': 0.22733030404966076, 'psi': 0.9353319666818896}-{'f1_val': 0.9273820565918031, 'auprc': 0.9541932962047279, 'loss_val': 0.22495001371843917, 'psi': 0.9381065524369729}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.816548 (no previous merge yet)
[S5] round=46 local utility u=0.694772 metrics={'f1_val': 0.8146472907606168, 'auprc': 0.9970886662084952, 'loss_val': 0.1436117347794091, 'psi': 0.8876238409397682}-{'f1_val': 0.667424634376281, 'auprc': 0.8992897547127119, 'loss_val': 0.35642400188032786, 'psi': 0.7601706825108534}
[S6] START round=46 head_norm_before_train=1.901520 cos_to_last_merge=0.9707 (last merge round=33)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6037437584416929, 'auprc': 0.8972080342478824, 'loss_val': 0.9955498497905804, 'psi': 0.7211294687641687}-{'f1_val': 0.8648710105877193, 'auprc': 0.9755204812210647, 'loss_val': 0.3215637548251312, 'psi': 0.9091307988410575}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.803934 cos_to_last_merge=0.9994 (last merge round=34)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.5046347482491677, 'auprc': 0.7805387194401481, 'loss_val': 0.9362730599792953, 'psi': 0.6149963367255598}-{'f1_val': 0.6839512574202906, 'auprc': 0.8369226662174833, 'loss_val': 0.3572113792749928, 'psi': 0.7451398209391678}
[S8] START round=46 head_norm_before_train=1.822226 cos_to_last_merge=0.9606 (last merge round=23)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9915794263117453, 'auprc': 0.9990466486621014, 'loss_val': 0.03331769234497176, 'psi': 0.9945663152518878}-{'f1_val': 0.9939919029218467, 'auprc': 0.9991571983562761, 'loss_val': 0.02842493204362251, 'psi': 0.9960580210956185}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=2.111736 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9912134460920485, 'auprc': 0.9986303247341629, 'loss_val': 0.034335978621724016, 'psi': 0.9941801975488943}-{'f1_val': 0.9966605118138915, 'auprc': 0.995682256924092, 'loss_val': 0.01880768783028779, 'psi': 0.9962692098579716}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.897511 cos_to_last_merge=0.9966 (last merge round=33)
[S10] round=46 local utility u=0.001782 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.99325563792367, 'loss_val': 0.02780365002125836, 'psi': 0.9942831670885137}-{'f1_val': 0.9949681865317428, 'auprc': 0.9920918567683912, 'loss_val': 0.027875777439237182, 'psi': 0.9938176546264021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=46 head_norm_before_train=1.867806 cos_to_last_merge=0.9967 (last merge round=33)
[S11] round=46 local utility u=0.001501 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980654454011657, 'loss_val': 0.02361999698071775, 'psi': 0.9971543808686201}-{'f1_val': 0.996305167468861, 'auprc': 0.998102760677968, 'loss_val': 0.02528240852267631, 'psi': 0.9970242047525038}
[S13] START round=46 head_norm_before_train=1.947277 cos_to_last_merge=0.9964 (last merge round=35)
[S13] round=46 local utility u=0.041003 metrics={'f1_val': 0.6307357161388814, 'auprc': 0.7756674398089848, 'loss_val': 0.9115802033009373, 'psi': 0.6887084056069227}-{'f1_val': 0.6246987378006416, 'auprc': 0.7786315711104465, 'loss_val': 0.9662564158944636, 'psi': 0.6862718711245634}
[S14] START round=46 head_norm_before_train=2.176735 cos_to_last_merge=0.9985 (last merge round=33)
[S14] round=46 local utility u=0.001859 metrics={'f1_val': 0.9975262299374879, 'auprc': 0.998987509628872, 'loss_val': 0.025012743124487615, 'psi': 0.9981107418140415}-{'f1_val': 0.9970233560109115, 'auprc': 0.9988448349616459, 'loss_val': 0.02528481725102423, 'psi': 0.9977519475912053}
[S15] START round=46 head_norm_before_train=2.089350 cos_to_last_merge=0.9528 (last merge round=29)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.7125532690113519, 'auprc': 0.8364547280832786, 'loss_val': 0.6763489527530858, 'psi': 0.7621138526401225}-{'f1_val': 0.992840618097343, 'auprc': 0.9968020337077541, 'loss_val': 0.03360216140189907, 'psi': 0.9944251843415075}
[S16] START round=46 head_norm_before_train=1.908726 cos_to_last_merge=0.9959 (last merge round=34)
[S16] round=46 local utility u=0.016473 metrics={'f1_val': 0.9904434299427851, 'auprc': 0.9948440412556034, 'loss_val': 0.051824000796974655, 'psi': 0.9922036744679124}-{'f1_val': 0.9898059715009404, 'auprc': 0.9859286911414419, 'loss_val': 0.05419902917648546, 'psi': 0.988255059357141}
[S17] START round=46 head_norm_before_train=2.238159 cos_to_last_merge=0.9980 (last merge round=30)
[S17] round=46 local utility u=1.000000 metrics={'f1_val': 0.8839578902727903, 'auprc': 0.9893674029240402, 'loss_val': 0.4758227561456938, 'psi': 0.9261216953332903}-{'f1_val': 0.6143082801096009, 'auprc': 0.9323983423341324, 'loss_val': 1.4994123133178123, 'psi': 0.7415443049994135}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S5] not sending this round → trigger blocked (psi=0.888)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → trigger blocked (psi=0.689)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.998)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15]  timeout peer S7
[S3]  timeout peer S6
[S11]  timeout peer S10
[S2]  timeout peer S5
[S13]  timeout peer S16
[S17]  timeout peer S14
[S14]  timeout peer S13
[S14]  timeout peer S17
[S7]  timeout peer S8
[S7]  timeout peer S15
[S5]  timeout peer S3
[S16]  timeout peer S4
[S2] START round=47 head_norm_before_train=2.058332 cos_to_last_merge=0.8219 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.822
[S2] round=47 local utility u=0.017308 metrics={'f1_val': 0.8320322562498496, 'auprc': 0.8859791853138861, 'loss_val': 0.4264160919203925, 'psi': 0.8536110278754642}-{'f1_val': 0.8293178026893622, 'auprc': 0.8908762177123455, 'loss_val': 0.4594358216188282, 'psi': 0.8539411686985555}
[S2] not sending this round → trigger blocked (psi=0.854)
[S3] START round=47 head_norm_before_train=2.161287 cos_to_last_merge=0.9884 (last merge round=25)
[S3] round=47 local utility u=0.094140 metrics={'f1_val': 0.9584129377497363, 'auprc': 0.9987665991675501, 'loss_val': 0.09732279597426961, 'psi': 0.9745544023168619}-{'f1_val': 0.9327799420242187, 'auprc': 0.9986812857357046, 'loss_val': 0.13154907701108157, 'psi': 0.9591404795088131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=47 head_norm_before_train=1.946088 cos_to_last_merge=0.7972 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.797
[S4] round=47 local utility u=0.191469 metrics={'f1_val': 0.9685513910654029, 'auprc': 0.9556452798056708, 'loss_val': 0.10963439132971177, 'psi': 0.9633889465615101}-{'f1_val': 0.9320084824575132, 'auprc': 0.9403171930184541, 'loss_val': 0.22733030404966076, 'psi': 0.9353319666818896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] sending update (kind=head size=1790 to 1 peers)
[S5] START round=47 head_norm_before_train=1.821721 (no previous merge yet)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.7895568803848518, 'auprc': 0.994683281141676, 'loss_val': 0.1825011774766891, 'psi': 0.8716074406875816}-{'f1_val': 0.8146472907606168, 'auprc': 0.9970886662084952, 'loss_val': 0.1436117347794091, 'psi': 0.8876238409397682}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.908384 cos_to_last_merge=0.9696 (last merge round=33)
[S6] round=47 local utility u=1.000000 metrics={'f1_val': 0.8644692258966061, 'auprc': 0.975237181014776, 'loss_val': 0.2484405710900608, 'psi': 0.908776407943874}-{'f1_val': 0.6037437584416929, 'auprc': 0.8972080342478824, 'loss_val': 0.9955498497905804, 'psi': 0.7211294687641687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=47 head_norm_before_train=1.806813 cos_to_last_merge=0.9993 (last merge round=34)
[S7] round=47 local utility u=1.000000 metrics={'f1_val': 0.7920613507824423, 'auprc': 0.9036365102426311, 'loss_val': 0.26589470227800277, 'psi': 0.8366914145665179}-{'f1_val': 0.5046347482491677, 'auprc': 0.7805387194401481, 'loss_val': 0.9362730599792953, 'psi': 0.6149963367255598}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=47 head_norm_before_train=1.831733 cos_to_last_merge=0.9595 (last merge round=23)
[S8] round=47 local utility u=0.003638 metrics={'f1_val': 0.992750298431487, 'auprc': 0.9985529765641568, 'loss_val': 0.03158639424123901, 'psi': 0.9950713696845549}-{'f1_val': 0.9915794263117453, 'auprc': 0.9990466486621014, 'loss_val': 0.03331769234497176, 'psi': 0.9945663152518878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=47 head_norm_before_train=2.115758 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9907913321404518, 'auprc': 0.9986459795895872, 'loss_val': 0.03481654287608753, 'psi': 0.9939331911201059}-{'f1_val': 0.9912134460920485, 'auprc': 0.9986303247341629, 'loss_val': 0.034335978621724016, 'psi': 0.9941801975488943}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.906187 cos_to_last_merge=0.9962 (last merge round=33)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9923811977057758, 'loss_val': 0.02742621236810361, 'psi': 0.993933391001356}-{'f1_val': 0.9949681865317428, 'auprc': 0.99325563792367, 'loss_val': 0.02780365002125836, 'psi': 0.9942831670885137}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.877411 cos_to_last_merge=0.9964 (last merge round=33)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9963061018870393, 'auprc': 0.998431638194879, 'loss_val': 0.025061859830841023, 'psi': 0.9971563164101752}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980654454011657, 'loss_val': 0.02361999698071775, 'psi': 0.9971543808686201}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.953797 cos_to_last_merge=0.9961 (last merge round=35)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6119952711165869, 'auprc': 0.7778575023746012, 'loss_val': 0.9764103526794512, 'psi': 0.6783401636197925}-{'f1_val': 0.6307357161388814, 'auprc': 0.7756674398089848, 'loss_val': 0.9115802033009373, 'psi': 0.6887084056069227}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.183851 cos_to_last_merge=0.9983 (last merge round=33)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9988457186817448, 'loss_val': 0.022622674958770173, 'psi': 0.9976047520441597}-{'f1_val': 0.9975262299374879, 'auprc': 0.998987509628872, 'loss_val': 0.025012743124487615, 'psi': 0.9981107418140415}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=2.094467 cos_to_last_merge=0.9521 (last merge round=29)
[S15] round=47 local utility u=1.000000 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9916736868969059, 'loss_val': 0.023945218946551817, 'psi': 0.9944689212680469}-{'f1_val': 0.7125532690113519, 'auprc': 0.8364547280832786, 'loss_val': 0.6763489527530858, 'psi': 0.7621138526401225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=47 head_norm_before_train=1.918036 cos_to_last_merge=0.9955 (last merge round=34)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9785328972412484, 'auprc': 0.9916950248658525, 'loss_val': 0.0892157816802613, 'psi': 0.98379774829109}-{'f1_val': 0.9904434299427851, 'auprc': 0.9948440412556034, 'loss_val': 0.051824000796974655, 'psi': 0.9922036744679124}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=2.243605 cos_to_last_merge=0.9980 (last merge round=30)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6088700237998311, 'auprc': 0.9452212882538423, 'loss_val': 1.4991676122269049, 'psi': 0.7434105295814357}-{'f1_val': 0.8839578902727903, 'auprc': 0.9893674029240402, 'loss_val': 0.4758227561456938, 'psi': 0.9261216953332903}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=2.062057 cos_to_last_merge=0.8210 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.821
[S2] round=48 local utility u=0.035400 metrics={'f1_val': 0.8318402016337899, 'auprc': 0.9126614008108495, 'loss_val': 0.434510115093587, 'psi': 0.8641686813046137}-{'f1_val': 0.8320322562498496, 'auprc': 0.8859791853138861, 'loss_val': 0.4264160919203925, 'psi': 0.8536110278754642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=48 head_norm_before_train=2.166183 cos_to_last_merge=0.9881 (last merge round=25)
[S3] round=48 local utility u=0.064636 metrics={'f1_val': 0.972683585425923, 'auprc': 0.9997957691995131, 'loss_val': 0.05676185885270303, 'psi': 0.983528458935359}-{'f1_val': 0.9584129377497363, 'auprc': 0.9987665991675501, 'loss_val': 0.09732279597426961, 'psi': 0.9745544023168619}
[S3] not sending this round → trigger blocked (psi=0.984)
[S4] START round=48 head_norm_before_train=1.954008 cos_to_last_merge=0.7969 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.797
[S4] round=48 local utility u=0.045976 metrics={'f1_val': 0.9690953932553825, 'auprc': 0.9840157044711328, 'loss_val': 0.1060577914623842, 'psi': 0.9750635177416827}-{'f1_val': 0.9685513910654029, 'auprc': 0.9556452798056708, 'loss_val': 0.10963439132971177, 'psi': 0.9633889465615101}
[S4] not sending this round → trigger blocked (psi=0.975)
[S5] START round=48 head_norm_before_train=1.828280 (no previous merge yet)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.6920562256569861, 'auprc': 0.90582152865466, 'loss_val': 0.37100125513737686, 'psi': 0.7775623468560557}-{'f1_val': 0.7895568803848518, 'auprc': 0.994683281141676, 'loss_val': 0.1825011774766891, 'psi': 0.8716074406875816}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.910764 cos_to_last_merge=0.9687 (last merge round=33)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.7086636901283421, 'auprc': 0.9165523273760514, 'loss_val': 0.9164711648339827, 'psi': 0.7918191450274259}-{'f1_val': 0.8644692258966061, 'auprc': 0.975237181014776, 'loss_val': 0.2484405710900608, 'psi': 0.908776407943874}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.810695 cos_to_last_merge=0.9992 (last merge round=34)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.4474916876587105, 'auprc': 0.7792690841002052, 'loss_val': 1.1472347584454723, 'psi': 0.5802026462353085}-{'f1_val': 0.7920613507824423, 'auprc': 0.9036365102426311, 'loss_val': 0.26589470227800277, 'psi': 0.8366914145665179}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.840739 cos_to_last_merge=0.9587 (last merge round=23)
[S8] round=48 local utility u=0.011385 metrics={'f1_val': 0.9950949602617258, 'auprc': 0.9992920429495808, 'loss_val': 0.025101607842298767, 'psi': 0.9967737933368679}-{'f1_val': 0.992750298431487, 'auprc': 0.9985529765641568, 'loss_val': 0.03158639424123901, 'psi': 0.9950713696845549}
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] START round=48 head_norm_before_train=2.121386 (no previous merge yet)
[S9] round=48 local utility u=0.022258 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9986825370508657, 'loss_val': 0.020622486644830837, 'psi': 0.9969690458388576}-{'f1_val': 0.9907913321404518, 'auprc': 0.9986459795895872, 'loss_val': 0.03481654287608753, 'psi': 0.9939331911201059}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=48 head_norm_before_train=1.916994 cos_to_last_merge=0.9959 (last merge round=33)
[S10] round=48 local utility u=0.001723 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9935004838376843, 'loss_val': 0.02733783433572655, 'psi': 0.9943811054541194}-{'f1_val': 0.9949681865317428, 'auprc': 0.9923811977057758, 'loss_val': 0.02742621236810361, 'psi': 0.993933391001356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=48 head_norm_before_train=1.888559 cos_to_last_merge=0.9961 (last merge round=33)
[S11] round=48 local utility u=0.000147 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981175927165983, 'loss_val': 0.023820806054293927, 'psi': 0.9970301375679559}-{'f1_val': 0.9963061018870393, 'auprc': 0.998431638194879, 'loss_val': 0.025061859830841023, 'psi': 0.9971563164101752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=48 head_norm_before_train=1.961349 cos_to_last_merge=0.9957 (last merge round=35)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.5850339792422594, 'auprc': 0.7905181154466637, 'loss_val': 1.2108637224428136, 'psi': 0.6672276337240212}-{'f1_val': 0.6119952711165869, 'auprc': 0.7778575023746012, 'loss_val': 0.9764103526794512, 'psi': 0.6783401636197925}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.190887 cos_to_last_merge=0.9982 (last merge round=33)
[S14] round=48 local utility u=0.002517 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9995294986141385, 'loss_val': 0.02210492549617092, 'psi': 0.9981247206477695}-{'f1_val': 0.9967774409524363, 'auprc': 0.9988457186817448, 'loss_val': 0.022622674958770173, 'psi': 0.9976047520441597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=48 head_norm_before_train=2.103195 cos_to_last_merge=0.9513 (last merge round=29)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.7033095065017607, 'auprc': 0.8306756903171646, 'loss_val': 0.7283185206494391, 'psi': 0.7542559800279223}-{'f1_val': 0.9963324108488076, 'auprc': 0.9916736868969059, 'loss_val': 0.023945218946551817, 'psi': 0.9944689212680469}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.926216 cos_to_last_merge=0.9951 (last merge round=34)
[S16] round=48 local utility u=0.022295 metrics={'f1_val': 0.9836982042477774, 'auprc': 0.9917295923429175, 'loss_val': 0.07572200521232844, 'psi': 0.9869107594858335}-{'f1_val': 0.9785328972412484, 'auprc': 0.9916950248658525, 'loss_val': 0.0892157816802613, 'psi': 0.98379774829109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=48 head_norm_before_train=2.250719 cos_to_last_merge=0.9978 (last merge round=30)
[S17] round=48 local utility u=1.000000 metrics={'f1_val': 0.9135646010459947, 'auprc': 0.993343432575882, 'loss_val': 0.42291539483226004, 'psi': 0.9454761336579496}-{'f1_val': 0.6088700237998311, 'auprc': 0.9452212882538423, 'loss_val': 1.4991676122269049, 'psi': 0.7434105295814357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=49 head_norm_before_train=2.070422 cos_to_last_merge=0.8202 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.820
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.8315411337814905, 'auprc': 0.9096294048783538, 'loss_val': 0.4485294703110399, 'psi': 0.8627764422202358}-{'f1_val': 0.8318402016337899, 'auprc': 0.9126614008108495, 'loss_val': 0.434510115093587, 'psi': 0.8641686813046137}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.172164 cos_to_last_merge=0.9877 (last merge round=25)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.8680847097637723, 'auprc': 0.9960739367148486, 'loss_val': 0.2466331331355288, 'psi': 0.9192804005442028}-{'f1_val': 0.972683585425923, 'auprc': 0.9997957691995131, 'loss_val': 0.05676185885270303, 'psi': 0.983528458935359}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.962168 cos_to_last_merge=0.7960 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.796
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9648227320381808, 'auprc': 0.9637430774180687, 'loss_val': 0.13686938780345304, 'psi': 0.964390870190136}-{'f1_val': 0.9690953932553825, 'auprc': 0.9840157044711328, 'loss_val': 0.1060577914623842, 'psi': 0.9750635177416827}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.835723 (no previous merge yet)
[S5] round=49 local utility u=0.236830 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.9961027108318681, 'loss_val': 0.21925838355636879, 'psi': 0.8187821903355383}-{'f1_val': 0.6920562256569861, 'auprc': 0.90582152865466, 'loss_val': 0.37100125513737686, 'psi': 0.7775623468560557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=49 head_norm_before_train=1.919439 cos_to_last_merge=0.9675 (last merge round=33)
[S6] round=49 local utility u=0.176694 metrics={'f1_val': 0.7242133129036675, 'auprc': 0.9419179774681194, 'loss_val': 0.73247685180018, 'psi': 0.8112951787294483}-{'f1_val': 0.7086636901283421, 'auprc': 0.9165523273760514, 'loss_val': 0.9164711648339827, 'psi': 0.7918191450274259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=49 head_norm_before_train=1.816272 cos_to_last_merge=0.9990 (last merge round=34)
[S7] round=49 local utility u=0.996680 metrics={'f1_val': 0.6515312260419169, 'auprc': 0.8083421318873878, 'loss_val': 0.4653302891827753, 'psi': 0.7142555883801054}-{'f1_val': 0.4474916876587105, 'auprc': 0.7792690841002052, 'loss_val': 1.1472347584454723, 'psi': 0.5802026462353085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=49 head_norm_before_train=1.849750 cos_to_last_merge=0.9580 (last merge round=23)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9492069692819598, 'auprc': 0.9962527933727101, 'loss_val': 0.12760011333435653, 'psi': 0.9680252989182598}-{'f1_val': 0.9950949602617258, 'auprc': 0.9992920429495808, 'loss_val': 0.025101607842298767, 'psi': 0.9967737933368679}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=2.127507 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9986610836154081, 'loss_val': 0.020605849084758706, 'psi': 0.9969604644646745}-{'f1_val': 0.9958267183641853, 'auprc': 0.9986825370508657, 'loss_val': 0.020622486644830837, 'psi': 0.9969690458388576}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.924751 cos_to_last_merge=0.9955 (last merge round=33)
[S10] round=49 local utility u=0.000204 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9936635881992973, 'loss_val': 0.027418149824503982, 'psi': 0.9944463471987646}-{'f1_val': 0.9949681865317428, 'auprc': 0.9935004838376843, 'loss_val': 0.02733783433572655, 'psi': 0.9943811054541194}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=49 head_norm_before_train=1.894261 cos_to_last_merge=0.9958 (last merge round=33)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9983829127398044, 'loss_val': 0.02606580182524387, 'psi': 0.9969005473717086}-{'f1_val': 0.996305167468861, 'auprc': 0.9981175927165983, 'loss_val': 0.023820806054293927, 'psi': 0.9970301375679559}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.970150 cos_to_last_merge=0.9952 (last merge round=35)
[S13] round=49 local utility u=0.203067 metrics={'f1_val': 0.6187706087472944, 'auprc': 0.7822352853644163, 'loss_val': 0.9823002674294724, 'psi': 0.6841564793941433}-{'f1_val': 0.5850339792422594, 'auprc': 0.7905181154466637, 'loss_val': 1.2108637224428136, 'psi': 0.6672276337240212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=49 head_norm_before_train=2.197615 cos_to_last_merge=0.9980 (last merge round=33)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9992120915204112, 'loss_val': 0.021603219437938928, 'psi': 0.9977513011796262}-{'f1_val': 0.9971882020035234, 'auprc': 0.9995294986141385, 'loss_val': 0.02210492549617092, 'psi': 0.9981247206477695}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.111672 cos_to_last_merge=0.9503 (last merge round=29)
[S15] round=49 local utility u=0.841236 metrics={'f1_val': 0.848033071675866, 'auprc': 0.9709271820171611, 'loss_val': 0.3349416338835534, 'psi': 0.897190715812384}-{'f1_val': 0.7033095065017607, 'auprc': 0.8306756903171646, 'loss_val': 0.7283185206494391, 'psi': 0.7542559800279223}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=49 head_norm_before_train=1.934845 cos_to_last_merge=0.9946 (last merge round=34)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9143863375070831, 'auprc': 0.9834645015273509, 'loss_val': 0.4302561221540966, 'psi': 0.9420176031151901}-{'f1_val': 0.9836982042477774, 'auprc': 0.9917295923429175, 'loss_val': 0.07572200521232844, 'psi': 0.9869107594858335}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=2.253127 cos_to_last_merge=0.9980 (last merge round=30)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.7162721511671319, 'auprc': 0.8608880113953119, 'loss_val': 1.0550073509209923, 'psi': 0.7741184952584039}-{'f1_val': 0.9135646010459947, 'auprc': 0.993343432575882, 'loss_val': 0.42291539483226004, 'psi': 0.9454761336579496}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
