[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:42003
[S3] → join 127.0.0.1:42002
[S4] → join 127.0.0.1:42002
[S5] → join 127.0.0.1:42002
[S6] → join 127.0.0.1:42002
[S7] → join 127.0.0.1:42002
[S8] → join 127.0.0.1:42002
[S9] → join 127.0.0.1:42002
[S10] → join 127.0.0.1:42002
[S11] → join 127.0.0.1:42002
[S13] → join 127.0.0.1:42002
[S14] → join 127.0.0.1:42002
[S15] → join 127.0.0.1:42002
[S16] → join 127.0.0.1:42002
[S17] → join 127.0.0.1:42002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.167089 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.172803 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.188351 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.118505 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.108143 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.187174 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.128035 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.211264 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.161458 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.117220 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.193523 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.184965 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.160326 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.126372 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.140442 (no previous merge yet)
[S2]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S13
[S3] + discovered S11
[S3] + discovered S10
[S3] + discovered S4
[S3] + discovered S9
[S3] + discovered S17
[S3] + discovered S8
[S3] + discovered S16
[S3] + discovered S7
[S3] + discovered S15
[S3] + discovered S6
[S3] + discovered S14
[S3] + discovered S5
[S4] + discovered S13
[S4] + discovered S11
[S4] + discovered S10
[S4] + discovered S9
[S4] + discovered S17
[S4] + discovered S8
[S4] + discovered S16
[S4] + discovered S7
[S4] + discovered S15
[S4] + discovered S6
[S4] + discovered S14
[S4] + discovered S5
[S5] + discovered S2
[S5] + discovered S4
[S5] + discovered S3
[S5] + discovered S15
[S5] + discovered S13
[S5] + discovered S16
[S5] + discovered S9
[S5] + discovered S10
[S6] + discovered S5
[S5] + discovered S11
[S6] + discovered S2
[S5] + discovered S14
[S5] + discovered S6
[S6] + discovered S3
[S6] + discovered S4
[S5] + discovered S17
[S5] + discovered S7
[S5] + discovered S8
[S7] + discovered S3
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S6
[S6] + discovered S15
[S6] + discovered S10
[S6] + discovered S14
[S6] + discovered S16
[S6] + discovered S7
[S6] + discovered S13
[S6] + discovered S9
[S6] + discovered S11
[S6] + discovered S17
[S6] + discovered S8
[S8] + discovered S6
[S8] + discovered S3
[S8] + discovered S5
[S8] + discovered S4
[S8] + discovered S7
[S8] + discovered S2
[S7] + discovered S8
[S7] + discovered S9
[S7] + discovered S13
[S7] + discovered S16
[S7] + discovered S10
[S7] + discovered S17
[S7] + discovered S11
[S7] + discovered S14
[S7] + discovered S15
[S8] + discovered S11
[S8] + discovered S9
[S8] + discovered S16
[S9] + discovered S4
[S8] + discovered S10
[S9] + discovered S6
[S9] + discovered S7
[S8] + discovered S17
[S8] + discovered S14
[S8] + discovered S15
[S9] + discovered S2
[S9] + discovered S5
[S9] + discovered S3
[S9] + discovered S8
[S8] + discovered S13
[S10] + discovered S5
[S10] + discovered S9
[S10] + discovered S6
[S10] + discovered S4
[S10] + discovered S2
[S10] + discovered S8
[S9] + discovered S13
[S9] + discovered S11
[S9] + discovered S16
[S9] + discovered S10
[S9] + discovered S17
[S9] + discovered S14
[S9] + discovered S15
[S10] + discovered S3
[S10] + discovered S7
[S11] + discovered S2
[S11] + discovered S8
[S11] + discovered S10
[S10] + discovered S17
[S10] + discovered S14
[S10] + discovered S13
[S11] + discovered S9
[S11] + discovered S3
[S11] + discovered S4
[S11] + discovered S5
[S10] + discovered S11
[S10] + discovered S16
[S10] + discovered S15
[S11] + discovered S7
[S11] + discovered S6
[S13] + discovered S6
[S13] + discovered S8
[S13] + discovered S2
[S11] + discovered S17
[S11] + discovered S13
[S13] + discovered S11
[S13] + discovered S4
[S13] + discovered S3
[S11] + discovered S14
[S13] + discovered S5
[S11] + discovered S16
[S11] + discovered S15
[S13] + discovered S9
[S13] + discovered S10
[S13] + discovered S7
[S14] + discovered S8
[S14] + discovered S6
[S14] + discovered S7
[S14] + discovered S13
[S13] + discovered S14
[S14] + discovered S3
[S14] + discovered S4
[S13] + discovered S16
[S14] + discovered S11
[S14] + discovered S9
[S13] + discovered S15
[S13] + discovered S17
[S14] + discovered S10
[S14] + discovered S2
[S14] + discovered S5
[S15] + discovered S3
[S15] + discovered S5
[S15] + discovered S6
[S14] + discovered S16
[S15] + discovered S8
[S15] + discovered S9
[S15] + discovered S7
[S15] + discovered S10
[S14] + discovered S17
[S15] + discovered S4
[S15] + discovered S13
[S15] + discovered S14
[S15] + discovered S11
[S15] + discovered S2
[S14] + discovered S15
[S16] + discovered S14
[S16] + discovered S11
[S16] + discovered S2
[S16] + discovered S10
[S16] + discovered S8
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S4
[S16] + discovered S6
[S16] + discovered S7
[S16] + discovered S5
[S16] + discovered S3
[S16] + discovered S13
[S16] + discovered S9
[S16] + discovered S15
[S17] + discovered S2
[S17] + discovered S14
[S17] + discovered S13
[S17] + discovered S9
[S17] + discovered S5
[S17] + discovered S11
[S16] + discovered S17
[S17] + discovered S4
[S17] + discovered S3
[S17] + discovered S6
[S17] + discovered S15
[S17] + discovered S8
[S17] + discovered S16
[S17] + discovered S10
[S17] + discovered S7
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=1.000 → S11@127.0.0.1:42012
[S8] ⇄ pheromone p=1.000 → S4@127.0.0.1:42004
[S10] ⇄ pheromone p=1.000 → S3@127.0.0.1:42003
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:42014
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:42012
[S13] ⇄ pheromone p=1.000 → S4@127.0.0.1:42004
[S14] ⇄ pheromone p=1.000 → S15@127.0.0.1:42015
[S3] ⇄ pheromone p=1.000 → S9@127.0.0.1:42010
[S2] ⇄ pheromone p=1.000 → S13@127.0.0.1:42013
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:42009
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:42013
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:42016
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:42017
[S16] ⇄ pheromone p=1.000 → S17@127.0.0.1:42017
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:42003
[S2] START round=1 head_norm_before_train=1.177555 (no previous merge yet)
[S2] round=1 local utility u=0.011145 metrics={'f1_val': 0.37889941036315866, 'auprc': 0.6137573117479012, 'loss_val': 1.2903038691838102, 'psi': 0.4728425709170556}-{'f1_val': 0.38240292521106256, 'auprc': 0.6141380689242404, 'loss_val': 1.3347578248982215, 'psi': 0.4750969826963337}
[S3] START round=1 head_norm_before_train=1.189053 (no previous merge yet)
[S3] round=1 local utility u=0.280770 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9984602099380587, 'loss_val': 1.2676901202269661, 'psi': 0.48328812334368776}-{'f1_val': 0.13984006561410703, 'auprc': 0.8279830615147824, 'loss_val': 1.3177981915166468, 'psi': 0.4150972639743772}
[S4] START round=1 head_norm_before_train=1.191012 (no previous merge yet)
[S4] round=1 local utility u=0.942208 metrics={'f1_val': 0.22073347044424274, 'auprc': 0.6327165692122438, 'loss_val': 1.355887023781035, 'psi': 0.38552670995144317}-{'f1_val': 0.08833063209076175, 'auprc': 0.2797928683784172, 'loss_val': 1.387115703954095, 'psi': 0.16491552660582393}
[S5] START round=1 head_norm_before_train=1.136747 (no previous merge yet)
[S5] round=1 local utility u=0.038725 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7758973365949852, 'loss_val': 1.2522498149580314, 'psi': 0.39571607749513693}-{'f1_val': 0.14226190476190476, 'auprc': 0.7715801569894111, 'loss_val': 1.3167484249466432, 'psi': 0.3939892056529073}
[S6] START round=1 head_norm_before_train=1.111764 (no previous merge yet)
[S6] round=1 local utility u=0.173439 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8010829366500665, 'loss_val': 1.3269660155946943, 'psi': 0.40528894389079584}-{'f1_val': 0.10435916795124837, 'auprc': 0.7716515836560096, 'loss_val': 1.363147782496245, 'psi': 0.37127613423315287}
[S7] START round=1 head_norm_before_train=1.202898 (no previous merge yet)
[S7] round=1 local utility u=0.625834 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7731309766828856, 'loss_val': 1.2876074497389214, 'psi': 0.39448648431060923}-{'f1_val': 0.14205682272909165, 'auprc': 0.3756186584712078, 'loss_val': 1.346739122781034, 'psi': 0.23548155702593812}
[S8] START round=1 head_norm_before_train=1.131461 (no previous merge yet)
[S8] round=1 local utility u=0.225862 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6323897839070275, 'loss_val': 1.3098418282330249, 'psi': 0.3369295029985853}-{'f1_val': 0.13995598239295717, 'auprc': 0.49074759244205135, 'loss_val': 1.3366394479489594, 'psi': 0.28027262641259487}
[S9] START round=1 head_norm_before_train=1.239592 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.894012314891755, 'loss_val': 1.1922368517154334, 'psi': 0.4424437002406996}-{'f1_val': 0.141397957139996, 'auprc': 0.9959042522620721, 'loss_val': 1.2895853339273675, 'psi': 0.4832004751888265}
[S10] START round=1 head_norm_before_train=1.168494 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8509752156024445, 'loss_val': 1.2998414727567655, 'psi': 0.4235630687660122}-{'f1_val': 0.16714015151515152, 'auprc': 0.9665344502935462, 'loss_val': 1.329386533556039, 'psi': 0.48689787102650944}
[S11] START round=1 head_norm_before_train=1.126161 (no previous merge yet)
[S11] round=1 local utility u=0.054539 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6131142850548543, 'loss_val': 1.3185184794099996, 'psi': 0.3294939240458081}-{'f1_val': 0.14041368337311058, 'auprc': 0.5880675667450055, 'loss_val': 1.3524560144178084, 'psi': 0.31947523672186856}
[S13] START round=1 head_norm_before_train=1.201894 (no previous merge yet)
[S13] round=1 local utility u=0.031409 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5588145384352782, 'loss_val': 1.3133064913595993, 'psi': 0.30775727292034316}-{'f1_val': 0.1403857625770531, 'auprc': 0.5504606009191548, 'loss_val': 1.351062841173176, 'psi': 0.3044156979138938}
[S14] START round=1 head_norm_before_train=1.197221 (no previous merge yet)
[S14] round=1 local utility u=0.430669 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6889130946017255, 'loss_val': 1.3366336781715324, 'psi': 0.35977994957031245}-{'f1_val': 0.09155565590426733, 'auprc': 0.5100560350269563, 'loss_val': 1.368587523578829, 'psi': 0.2589558075533429}
[S15] START round=1 head_norm_before_train=1.166906 (no previous merge yet)
[S15] round=1 local utility u=0.102710 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7663950254560971, 'loss_val': 1.3175681978255642, 'psi': 0.39039820099937383}-{'f1_val': 0.13973365136155833, 'auprc': 0.7066086921918351, 'loss_val': 1.3436285456491595, 'psi': 0.366483667693669}
[S16] START round=1 head_norm_before_train=1.130056 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.99161419838969, 'loss_val': 1.3394256630279493, 'psi': 0.48102814947539796}-{'f1_val': 0.3838204553891831, 'auprc': 0.8151994807308667, 'loss_val': 1.367253797742652, 'psi': 0.5563720655258565}
[S17] START round=1 head_norm_before_train=1.139735 (no previous merge yet)
[S17] round=1 local utility u=0.048859 metrics={'f1_val': 0.15061780997017468, 'auprc': 0.518719034665368, 'loss_val': 1.3425452558183177, 'psi': 0.297858299848252}-{'f1_val': 0.14856627293967734, 'auprc': 0.49954967422407626, 'loss_val': 1.370446523289539, 'psi': 0.2889596334534369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:42002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S14] → sending delta(kind=head bytes=1785) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S8] → sending delta(kind=head bytes=1787) to S2@127.0.0.1:42002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:42012
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S11] → sending delta(kind=head bytes=1784) to S7@127.0.0.1:42008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:42005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:42009
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:42009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S2] → sending delta(kind=head bytes=1785) to S10@127.0.0.1:42011
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1785 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1788 to 1 peers)
[S14] sending update (kind=head size=1785 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1784 to 1 peers)
[S8] sending update (kind=head size=1787 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1791) from S4
[S2] cosine check vs S4: cos=-0.0019
[S2] DROPPED delta from S4 (cos=-0.0019 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1784) from S11
[S7] cosine check vs S11: cos=-0.0053
[S7] DROPPED delta from S11 (cos=-0.0053 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1785) from S14
[S9] cosine check vs S14: cos=0.0687
[S11] RECEIVED delta(kind=head bytes=1790) from S6
[S11] cosine check vs S6: cos=-0.1448
[S11] DROPPED delta from S6 (cos=-0.1448 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1789) from S15
[S8] cosine check vs S15: cos=-0.0512
[S8] DROPPED delta from S15 (cos=-0.0512 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1788) from S13
[S5] cosine check vs S13: cos=-0.0893
[S5] DROPPED delta from S13 (cos=-0.0893 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1785) from S2
[S10] cosine check vs S2: cos=-0.1576
[S10] DROPPED delta from S2 (cos=-0.1576 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S5
[S10] cosine check vs S5: cos=0.0402
[S2] RECEIVED delta(kind=head bytes=1787) from S8
[S2] cosine check vs S8: cos=0.0903
[S13] RECEIVED delta(kind=head bytes=1792) from S3
[S13] cosine check vs S3: cos=-0.0021
[S13] DROPPED delta from S3 (cos=-0.0021 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S7
[S8] cosine check vs S7: cos=0.0441
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:42004
[S17] sending update (kind=head size=1793 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1793) from S17
[S4] cosine check vs S17: cos=0.1047
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.184550
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.180737e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.851672 delta_norm=0.818074
[S10] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.292212
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.564559e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.917335 delta_norm=0.856456
[S9] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.2207 head_norm=1.202609
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.871298e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1064 head_norm=0.874256 delta_norm=0.787130
[S4] aggregate: ROLLBACK (f1_val pre=0.221 post=0.106 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.142188
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.244066e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.861445 delta_norm=0.824407
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.3789 head_norm=1.197204
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.891515e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.4165 head_norm=0.863820 delta_norm=0.789151
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.863820 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6137061254456838, 'loss_val': 1.291325295455889, 'psi': 0.33054873021141357}-{'f1_val': 0.37889941036315866, 'auprc': 0.6137573117479012, 'loss_val': 1.2903038691838102, 'psi': 0.4728425709170556}
[S3] START round=2 head_norm_before_train=1.228523 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8841153183117525, 'loss_val': 1.1792541825813811, 'psi': 0.43755016669316527}-{'f1_val': 0.13984006561410703, 'auprc': 0.9984602099380587, 'loss_val': 1.2676901202269661, 'psi': 0.48328812334368776}
[S4] START round=2 head_norm_before_train=0.874256 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.10637591321673677, 'auprc': 0.7763731713171714, 'loss_val': 1.3509290768225526, 'psi': 0.3743748164569106}-{'f1_val': 0.22073347044424274, 'auprc': 0.6327165692122438, 'loss_val': 1.355887023781035, 'psi': 0.38552670995144317}
[S5] START round=2 head_norm_before_train=1.177293 (no previous merge yet)
[S5] round=2 local utility u=0.034046 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7700877250699008, 'loss_val': 1.1667283274257676, 'psi': 0.39339223288510317}-{'f1_val': 0.14226190476190476, 'auprc': 0.7758973365949852, 'loss_val': 1.2522498149580314, 'psi': 0.39571607749513693}
[S6] START round=2 head_norm_before_train=1.126652 (no previous merge yet)
[S6] round=2 local utility u=0.028008 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8050304832688515, 'loss_val': 1.2827925251090744, 'psi': 0.4068679625383098}-{'f1_val': 0.14142628205128205, 'auprc': 0.8010829366500665, 'loss_val': 1.3269660155946943, 'psi': 0.40528894389079584}
[S7] START round=2 head_norm_before_train=1.240514 (no previous merge yet)
[S7] round=2 local utility u=0.017490 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7749315173401629, 'loss_val': 1.2580293449190276, 'psi': 0.39520670057352014}-{'f1_val': 0.14205682272909165, 'auprc': 0.7731309766828856, 'loss_val': 1.2876074497389214, 'psi': 0.39448648431060923}
[S8] START round=2 head_norm_before_train=0.861445 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.180239 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7507702718886865, 'loss_val': 1.3045062391530375, 'psi': 0.38428169819124897}-{'f1_val': 0.13995598239295717, 'auprc': 0.6323897839070275, 'loss_val': 1.3098418282330249, 'psi': 0.3369295029985853}
[S9] START round=2 head_norm_before_train=0.917335 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8447410230948943, 'loss_val': 1.1120581932794167, 'psi': 0.4227351835219553}-{'f1_val': 0.141397957139996, 'auprc': 0.894012314891755, 'loss_val': 1.1922368517154334, 'psi': 0.4424437002406996}
[S10] START round=2 head_norm_before_train=0.851672 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7761788760032761, 'loss_val': 1.301052439744771, 'psi': 0.3936445329263448}-{'f1_val': 0.13862163754172394, 'auprc': 0.8509752156024445, 'loss_val': 1.2998414727567655, 'psi': 0.4235630687660122}
[S11] START round=2 head_norm_before_train=1.143164 (no previous merge yet)
[S11] round=2 local utility u=0.083939 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6551181803888948, 'loss_val': 1.2766527600015103, 'psi': 0.3462954821794243}-{'f1_val': 0.14041368337311058, 'auprc': 0.6131142850548543, 'loss_val': 1.3185184794099996, 'psi': 0.3294939240458081}
[S13] START round=2 head_norm_before_train=1.218913 (no previous merge yet)
[S13] round=2 local utility u=0.024556 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5622710826163603, 'loss_val': 1.274563721357459, 'psi': 0.30913989059277597}-{'f1_val': 0.1403857625770531, 'auprc': 0.5588145384352782, 'loss_val': 1.3133064913595993, 'psi': 0.30775727292034316}
[S14] START round=2 head_norm_before_train=1.216647 (no previous merge yet)
[S14] round=2 local utility u=0.155235 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7793058786617166, 'loss_val': 1.2973426133062689, 'psi': 0.39593706319430894}-{'f1_val': 0.14035785288270378, 'auprc': 0.6889130946017255, 'loss_val': 1.3366336781715324, 'psi': 0.35977994957031245}
[S15] START round=2 head_norm_before_train=1.181713 (no previous merge yet)
[S15] round=2 local utility u=0.035260 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7796695225505589, 'loss_val': 1.2868715394218289, 'psi': 0.3957079998371586}-{'f1_val': 0.13973365136155833, 'auprc': 0.7663950254560971, 'loss_val': 1.3175681978255642, 'psi': 0.39039820099937383}
[S16] START round=2 head_norm_before_train=1.138425 (no previous merge yet)
[S16] round=2 local utility u=0.014456 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.990888160640545, 'loss_val': 1.308335051775821, 'psi': 0.48073773437573997}-{'f1_val': 0.14063745019920318, 'auprc': 0.99161419838969, 'loss_val': 1.3394256630279493, 'psi': 0.48102814947539796}
[S17] START round=2 head_norm_before_train=1.149577 (no previous merge yet)
[S17] round=2 local utility u=0.056607 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5640023947274672, 'loss_val': 1.3071687711656599, 'psi': 0.3101703358814175}-{'f1_val': 0.15061780997017468, 'auprc': 0.518719034665368, 'loss_val': 1.3425452558183177, 'psi': 0.297858299848252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:42002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S6] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:42008
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:42013
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:42013
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:42005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:42017
[S13] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] cosine check vs S15: cos=-0.0705
[S5] DROPPED delta from S15 (cos=-0.0705 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1792) from S11
[S2] cosine check vs S11: cos=-0.0869
[S2] DROPPED delta from S11 (cos=-0.0869 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1791) from S14
[S7] cosine check vs S14: cos=-0.0107
[S7] DROPPED delta from S14 (cos=-0.0107 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S13
[S17] cosine check vs S13: cos=-0.0226
[S17] DROPPED delta from S13 (cos=-0.0226 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1789) from S6
[S16] cosine check vs S6: cos=0.0464
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=0.0181
[S13] RECEIVED delta(kind=head bytes=1798) from S5
[S13] cosine check vs S5: cos=-0.0872
[S13] DROPPED delta from S5 (cos=-0.0872 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1796) from S7
[S13] cosine check vs S7: cos=0.0462
[S10] RECEIVED delta(kind=head bytes=1794) from S8
[S10] cosine check vs S8: cos=-0.0306
[S10] DROPPED delta from S8 (cos=-0.0306 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:42010
[S17] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S17
[S9] cosine check vs S17: cos=-0.0201
[S9] DROPPED delta from S17 (cos=-0.0201 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=2 metric=0.1404 head_norm=1.240420
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.644851e-01
[S13] stored merged vector for next round verification (round=2)
[S13] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.905404 delta_norm=0.864485
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=1.156585
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.972480e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.4154 head_norm=0.835157 delta_norm=0.797248
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=2 metric=0.1404 head_norm=1.244015
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.415914e-01
[S14] stored merged vector for next round verification (round=2)
[S14] DEBUG after merge:  round=2 metric=0.3889 head_norm=0.856945 delta_norm=0.841591
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.879539 cos_to_last_merge=0.9961 (last merge round=1)
[S2] round=3 local utility u=0.031633 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.613421556257747, 'loss_val': 1.227205388189945, 'psi': 0.3304349025362388}-{'f1_val': 0.1417771333885667, 'auprc': 0.6137061254456838, 'loss_val': 1.291325295455889, 'psi': 0.33054873021141357}
[S3] START round=3 head_norm_before_train=1.283481 (no previous merge yet)
[S3] round=3 local utility u=0.403875 metrics={'f1_val': 0.2805115801817649, 'auprc': 0.795791209393393, 'loss_val': 0.9505610485973115, 'psi': 0.48662343186641616}-{'f1_val': 0.13984006561410703, 'auprc': 0.8841153183117525, 'loss_val': 1.1792541825813811, 'psi': 0.43755016669316527}
[S4] START round=3 head_norm_before_train=0.888469 cos_to_last_merge=0.9973 (last merge round=1)
[S4] round=3 local utility u=1.000000 metrics={'f1_val': 0.6893780184768293, 'auprc': 0.7814164831370927, 'loss_val': 1.3154935972081894, 'psi': 0.7261934043409347}-{'f1_val': 0.10637591321673677, 'auprc': 0.7763731713171714, 'loss_val': 1.3509290768225526, 'psi': 0.3743748164569106}
[S5] START round=3 head_norm_before_train=1.225345 (no previous merge yet)
[S5] round=3 local utility u=0.934549 metrics={'f1_val': 0.4183549486166547, 'auprc': 0.7777825771652217, 'loss_val': 0.9772735894296938, 'psi': 0.5621260000360815}-{'f1_val': 0.14226190476190476, 'auprc': 0.7700877250699008, 'loss_val': 1.1667283274257676, 'psi': 0.39339223288510317}
[S6] START round=3 head_norm_before_train=1.152603 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7896317927750722, 'loss_val': 1.2425000365931032, 'psi': 0.40070848634079814}-{'f1_val': 0.14142628205128205, 'auprc': 0.8050304832688515, 'loss_val': 1.2827925251090744, 'psi': 0.4068679625383098}
[S7] START round=3 head_norm_before_train=1.263146 (no previous merge yet)
[S7] round=3 local utility u=0.022068 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777587494253826, 'loss_val': 1.2223741836381752, 'psi': 0.39633759340760805}-{'f1_val': 0.14205682272909165, 'auprc': 0.7749315173401629, 'loss_val': 1.2580293449190276, 'psi': 0.39520670057352014}
[S8] START round=3 head_norm_before_train=0.879221 cos_to_last_merge=0.9970 (last merge round=1)
[S8] round=3 local utility u=0.034513 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7603091075997582, 'loss_val': 1.2640960680814992, 'psi': 0.3880972324756776}-{'f1_val': 0.13995598239295717, 'auprc': 0.7507702718886865, 'loss_val': 1.3045062391530375, 'psi': 0.38428169819124897}
[S9] START round=3 head_norm_before_train=0.979649 cos_to_last_merge=0.9930 (last merge round=1)
[S9] round=3 local utility u=1.000000 metrics={'f1_val': 0.7002705913112235, 'auprc': 0.8654852044694183, 'loss_val': 0.8063589465067633, 'psi': 0.7663564365745015}-{'f1_val': 0.141397957139996, 'auprc': 0.8447410230948943, 'loss_val': 1.1120581932794167, 'psi': 0.4227351835219553}
[S10] START round=3 head_norm_before_train=0.872989 cos_to_last_merge=0.9970 (last merge round=1)
[S10] round=3 local utility u=0.020161 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7763868534770036, 'loss_val': 1.261354262500931, 'psi': 0.3937277239158358}-{'f1_val': 0.13862163754172394, 'auprc': 0.7761788760032761, 'loss_val': 1.301052439744771, 'psi': 0.3936445329263448}
[S11] START round=3 head_norm_before_train=1.167431 (no previous merge yet)
[S11] round=3 local utility u=0.192927 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7695384176714861, 'loss_val': 1.234058546112854, 'psi': 0.3920635770924608}-{'f1_val': 0.14041368337311058, 'auprc': 0.6551181803888948, 'loss_val': 1.2766527600015103, 'psi': 0.3462954821794243}
[S13] START round=3 head_norm_before_train=0.905404 cos_to_last_merge=1.0000 (last merge round=2)
[S13] round=3 local utility u=0.170813 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6763950216739242, 'loss_val': 1.2753086500035735, 'psi': 0.35478946621580154}-{'f1_val': 0.1403857625770531, 'auprc': 0.5622710826163603, 'loss_val': 1.274563721357459, 'psi': 0.30913989059277597}
[S14] START round=3 head_norm_before_train=0.856945 cos_to_last_merge=1.0000 (last merge round=2)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7523419715113036, 'loss_val': 1.2990372042058487, 'psi': 0.3851515003341437}-{'f1_val': 0.14035785288270378, 'auprc': 0.7793058786617166, 'loss_val': 1.2973426133062689, 'psi': 0.39593706319430894}
[S15] START round=3 head_norm_before_train=1.206255 (no previous merge yet)
[S15] round=3 local utility u=0.012018 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7775803734156358, 'loss_val': 1.2565686980500443, 'psi': 0.39487234018318934}-{'f1_val': 0.13973365136155833, 'auprc': 0.7796695225505589, 'loss_val': 1.2868715394218289, 'psi': 0.3957079998371586}
[S16] START round=3 head_norm_before_train=0.835157 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.005238 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9948634634041296, 'loss_val': 1.309784670294815, 'psi': 0.48232785548117374}-{'f1_val': 0.14063745019920318, 'auprc': 0.990888160640545, 'loss_val': 1.308335051775821, 'psi': 0.48073773437573997}
[S17] START round=3 head_norm_before_train=1.167861 (no previous merge yet)
[S17] round=3 local utility u=0.012911 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5566750072406855, 'loss_val': 1.2593639129740797, 'psi': 0.3072393808867049}-{'f1_val': 0.14094896331738438, 'auprc': 0.5640023947274672, 'loss_val': 1.3071687711656599, 'psi': 0.3101703358814175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:42017
[S8] not sending this round → trigger blocked (psi=0.388)
[S7] not sending this round → trigger blocked (psi=0.396)
[S11] not sending this round → trigger blocked (psi=0.392)
[S13] not sending this round → trigger blocked (psi=0.355)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:42013
[S16] not sending this round → trigger blocked (psi=0.482)
[S15] not sending this round → trigger blocked (psi=0.395)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:42011
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:42003
[S5] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:42010
[S4] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1792) from S9
[S17] cosine check vs S9: cos=-0.0140
[S17] DROPPED delta from S9 (cos=-0.0140 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1793) from S2
[S13] cosine check vs S2: cos=0.0905
[S10] RECEIVED delta(kind=head bytes=1804) from S4
[S10] cosine check vs S4: cos=-0.0716
[S10] DROPPED delta from S4 (cos=-0.0716 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S3
[S9] cosine check vs S3: cos=-0.0306
[S9] DROPPED delta from S3 (cos=-0.0306 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S10
[S3] cosine check vs S10: cos=0.0906
[S17] not sending this round → trigger blocked (psi=0.307)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.1404 head_norm=0.928383
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.186183e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.677348 delta_norm=0.618618
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.2805 head_norm=1.346927
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.754145e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.843319 delta_norm=0.775414
[S3] aggregate: ROLLBACK (f1_val pre=0.281 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S2] START round=4 head_norm_before_train=0.906137 cos_to_last_merge=0.9851 (last merge round=1)
[S2] round=4 local utility u=0.186355 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7169669026007895, 'loss_val': 1.1651305119586928, 'psi': 0.37185304107345585}-{'f1_val': 0.1417771333885667, 'auprc': 0.613421556257747, 'loss_val': 1.227205388189945, 'psi': 0.3304349025362388}
[S3] START round=4 head_norm_before_train=0.843319 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.512224 metrics={'f1_val': 0.4038388831837816, 'auprc': 0.8400310034697454, 'loss_val': 0.7987971785179578, 'psi': 0.578315731298167}-{'f1_val': 0.2805115801817649, 'auprc': 0.795791209393393, 'loss_val': 0.9505610485973115, 'psi': 0.48662343186641616}
[S4] START round=4 head_norm_before_train=0.912940 cos_to_last_merge=0.9895 (last merge round=1)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.4351515886664372, 'auprc': 0.7838362831016418, 'loss_val': 1.260469381786933, 'psi': 0.574625466440519}-{'f1_val': 0.6893780184768293, 'auprc': 0.7814164831370927, 'loss_val': 1.3154935972081894, 'psi': 0.7261934043409347}
[S5] START round=4 head_norm_before_train=1.272401 (no previous merge yet)
[S5] round=4 local utility u=1.000000 metrics={'f1_val': 0.7149582255866307, 'auprc': 0.7950603456233647, 'loss_val': 0.7134530745676528, 'psi': 0.7469990736013243}-{'f1_val': 0.4183549486166547, 'auprc': 0.7777825771652217, 'loss_val': 0.9772735894296938, 'psi': 0.5621260000360815}
[S6] START round=4 head_norm_before_train=1.182256 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6065802866844185, 'loss_val': 1.22478301110636, 'psi': 0.32748788390453665}-{'f1_val': 0.14142628205128205, 'auprc': 0.7896317927750722, 'loss_val': 1.2425000365931032, 'psi': 0.40070848634079814}
[S7] START round=4 head_norm_before_train=1.283566 (no previous merge yet)
[S7] round=4 local utility u=0.050482 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777958855402228, 'loss_val': 1.1215218463324015, 'psi': 0.3963524478535441}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777587494253826, 'loss_val': 1.2223741836381752, 'psi': 0.39633759340760805}
[S8] START round=4 head_norm_before_train=0.909836 cos_to_last_merge=0.9891 (last merge round=1)
[S8] round=4 local utility u=0.032704 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7684655176356912, 'loss_val': 1.22315757858634, 'psi': 0.3913597964900508}-{'f1_val': 0.13995598239295717, 'auprc': 0.7603091075997582, 'loss_val': 1.2640960680814992, 'psi': 0.3880972324756776}
[S9] START round=4 head_norm_before_train=1.051376 cos_to_last_merge=0.9782 (last merge round=1)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.40253198729167655, 'auprc': 0.9993227940445377, 'loss_val': 0.6152314495723458, 'psi': 0.641248309992821}-{'f1_val': 0.7002705913112235, 'auprc': 0.8654852044694183, 'loss_val': 0.8063589465067633, 'psi': 0.7663564365745015}
[S10] START round=4 head_norm_before_train=0.900387 cos_to_last_merge=0.9893 (last merge round=1)
[S10] round=4 local utility u=0.028352 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7753455711581119, 'loss_val': 1.2015273533165933, 'psi': 0.39331121098827915}-{'f1_val': 0.13862163754172394, 'auprc': 0.7763868534770036, 'loss_val': 1.261354262500931, 'psi': 0.3937277239158358}
[S11] START round=4 head_norm_before_train=1.192345 (no previous merge yet)
[S11] round=4 local utility u=0.023453 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.767825178248484, 'loss_val': 1.1820129648036106, 'psi': 0.39137828132325997}-{'f1_val': 0.14041368337311058, 'auprc': 0.7695384176714861, 'loss_val': 1.234058546112854, 'psi': 0.3920635770924608}
[S13] START round=4 head_norm_before_train=0.677348 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.062392 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7157239370875323, 'loss_val': 1.2685122942849694, 'psi': 0.3705210323812448}-{'f1_val': 0.1403857625770531, 'auprc': 0.6763950216739242, 'loss_val': 1.2753086500035735, 'psi': 0.35478946621580154}
[S14] START round=4 head_norm_before_train=0.883824 cos_to_last_merge=0.9972 (last merge round=2)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6468953621209094, 'loss_val': 1.2450181087904484, 'psi': 0.342972856577986}-{'f1_val': 0.14035785288270378, 'auprc': 0.7523419715113036, 'loss_val': 1.2990372042058487, 'psi': 0.3851515003341437}
[S15] START round=4 head_norm_before_train=1.232208 (no previous merge yet)
[S15] round=4 local utility u=0.012097 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770047978747705, 'loss_val': 1.2306472473366037, 'psi': 0.39464210996684324}-{'f1_val': 0.13973365136155833, 'auprc': 0.7775803734156358, 'loss_val': 1.2565686980500443, 'psi': 0.39487234018318934}
[S16] START round=4 head_norm_before_train=0.860259 cos_to_last_merge=0.9969 (last merge round=2)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8669880676140511, 'loss_val': 1.2513688777385976, 'psi': 0.4311776971651424}-{'f1_val': 0.14063745019920318, 'auprc': 0.9948634634041296, 'loss_val': 1.309784670294815, 'psi': 0.48232785548117374}
[S17] START round=4 head_norm_before_train=1.193659 (no previous merge yet)
[S17] round=4 local utility u=0.030524 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5557403678373982, 'loss_val': 1.1955119898386368, 'psi': 0.3068655251253899}-{'f1_val': 0.14094896331738438, 'auprc': 0.5566750072406855, 'loss_val': 1.2593639129740797, 'psi': 0.3072393808867049}
[S10] not sending this round → trigger blocked (psi=0.393)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:42012
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.372)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S13@127.0.0.1:42013
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:42014
[S3] not sending this round → trigger blocked (psi=0.578)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:42004
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:42017
[S7] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1790) from S8
[S17] cosine check vs S8: cos=-0.0595
[S17] DROPPED delta from S8 (cos=-0.0595 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=-0.0380
[S16] DROPPED delta from S5 (cos=-0.0380 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S15
[S11] cosine check vs S15: cos=-0.0168
[S11] DROPPED delta from S15 (cos=-0.0168 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1805) from S13
[S4] cosine check vs S13: cos=-0.0448
[S4] DROPPED delta from S13 (cos=-0.0448 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S7
[S14] cosine check vs S7: cos=-0.0803
[S14] DROPPED delta from S7 (cos=-0.0803 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1789) from S11
[S13] cosine check vs S11: cos=-0.0442
[S13] DROPPED delta from S11 (cos=-0.0442 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=-0.0637
[S3] DROPPED delta from S17 (cos=-0.0637 < 0.0)
[S2] START round=5 head_norm_before_train=0.935339 cos_to_last_merge=0.9709 (last merge round=1)
[S2] round=5 local utility u=0.131582 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7770653970210172, 'loss_val': 1.0822617392742189, 'psi': 0.39589243884154696}-{'f1_val': 0.1417771333885667, 'auprc': 0.7169669026007895, 'loss_val': 1.1651305119586928, 'psi': 0.37185304107345585}
[S3] START round=5 head_norm_before_train=0.925487 cos_to_last_merge=0.9913 (last merge round=3)
[S3] round=5 local utility u=0.887193 metrics={'f1_val': 0.6993228192077114, 'auprc': 0.7765692835459838, 'loss_val': 0.6069294797334904, 'psi': 0.7302214049430203}-{'f1_val': 0.4038388831837816, 'auprc': 0.8400310034697454, 'loss_val': 0.7987971785179578, 'psi': 0.578315731298167}
[S4] START round=5 head_norm_before_train=0.945253 cos_to_last_merge=0.9777 (last merge round=1)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7887542759076718, 'loss_val': 1.1698858318967869, 'psi': 0.3996376877001792}-{'f1_val': 0.4351515886664372, 'auprc': 0.7838362831016418, 'loss_val': 1.260469381786933, 'psi': 0.574625466440519}
[S5] START round=5 head_norm_before_train=1.336466 (no previous merge yet)
[S5] round=5 local utility u=0.049477 metrics={'f1_val': 0.7008162875368863, 'auprc': 0.795128917757403, 'loss_val': 0.5298522876584972, 'psi': 0.738541339625093}-{'f1_val': 0.7149582255866307, 'auprc': 0.7950603456233647, 'loss_val': 0.7134530745676528, 'psi': 0.7469990736013243}
[S6] START round=5 head_norm_before_train=1.212345 (no previous merge yet)
[S6] round=5 local utility u=0.037839 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6106088345643416, 'loss_val': 1.1611905108456644, 'psi': 0.32909930305650587}-{'f1_val': 0.14142628205128205, 'auprc': 0.6065802866844185, 'loss_val': 1.22478301110636, 'psi': 0.32748788390453665}
[S7] START round=5 head_norm_before_train=1.310192 (no previous merge yet)
[S7] round=5 local utility u=0.910521 metrics={'f1_val': 0.4170778520170104, 'auprc': 0.7776085090411115, 'loss_val': 0.9500434923821465, 'psi': 0.5612901148266509}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777958855402228, 'loss_val': 1.1215218463324015, 'psi': 0.3963524478535441}
[S8] START round=5 head_norm_before_train=0.937028 cos_to_last_merge=0.9805 (last merge round=1)
[S8] round=5 local utility u=0.041606 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.777082444477193, 'loss_val': 1.1657967218478604, 'psi': 0.39480656722665153}-{'f1_val': 0.13995598239295717, 'auprc': 0.7684655176356912, 'loss_val': 1.22315757858634, 'psi': 0.3913597964900508}
[S9] START round=5 head_norm_before_train=1.151536 cos_to_last_merge=0.9567 (last merge round=1)
[S9] round=5 local utility u=0.988206 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.999376504158191, 'loss_val': 0.43242423555513154, 'psi': 0.8206140818322493}-{'f1_val': 0.40253198729167655, 'auprc': 0.9993227940445377, 'loss_val': 0.6152314495723458, 'psi': 0.641248309992821}
[S10] START round=5 head_norm_before_train=0.933353 cos_to_last_merge=0.9783 (last merge round=1)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.1433851792258872, 'auprc': 0.6399538781883753, 'loss_val': 1.1041770897200454, 'psi': 0.3420126588108825}-{'f1_val': 0.13862163754172394, 'auprc': 0.7753455711581119, 'loss_val': 1.2015273533165933, 'psi': 0.39331121098827915}
[S11] START round=5 head_norm_before_train=1.221058 (no previous merge yet)
[S11] round=5 local utility u=0.043727 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7686068360338529, 'loss_val': 1.0969045015844843, 'psi': 0.39169094443740754}-{'f1_val': 0.14041368337311058, 'auprc': 0.767825178248484, 'loss_val': 1.1820129648036106, 'psi': 0.39137828132325997}
[S13] START round=5 head_norm_before_train=0.701254 cos_to_last_merge=0.9954 (last merge round=3)
[S13] round=5 local utility u=0.037862 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7219997975619958, 'loss_val': 1.2116151646818296, 'psi': 0.3730313765710302}-{'f1_val': 0.1403857625770531, 'auprc': 0.7157239370875323, 'loss_val': 1.2685122942849694, 'psi': 0.3705210323812448}
[S14] START round=5 head_norm_before_train=0.918943 cos_to_last_merge=0.9897 (last merge round=2)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5961653412250585, 'loss_val': 1.1808838800484232, 'psi': 0.32268084821964566}-{'f1_val': 0.14035785288270378, 'auprc': 0.6468953621209094, 'loss_val': 1.2450181087904484, 'psi': 0.342972856577986}
[S15] START round=5 head_norm_before_train=1.251453 (no previous merge yet)
[S15] round=5 local utility u=0.027636 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770302643714244, 'loss_val': 1.1754511648049568, 'psi': 0.39465229656550477}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770047978747705, 'loss_val': 1.2306472473366037, 'psi': 0.39464210996684324}
[S16] START round=5 head_norm_before_train=0.895284 cos_to_last_merge=0.9882 (last merge round=2)
[S16] round=5 local utility u=0.004907 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8488471673530994, 'loss_val': 1.187131613755501, 'psi': 0.42392133706076174}-{'f1_val': 0.14063745019920318, 'auprc': 0.8669880676140511, 'loss_val': 1.2513688777385976, 'psi': 0.4311776971651424}
[S17] START round=5 head_norm_before_train=1.225015 (no previous merge yet)
[S17] round=5 local utility u=0.782999 metrics={'f1_val': 0.3853679263808666, 'auprc': 0.5608363278034119, 'loss_val': 1.1113150498746418, 'psi': 0.4555552869498847}-{'f1_val': 0.14094896331738438, 'auprc': 0.5557403678373982, 'loss_val': 1.1955119898386368, 'psi': 0.3068655251253899}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.395)
[S7] not sending this round → trigger blocked (psi=0.561)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.373)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[S8] not sending this round → trigger blocked (psi=0.395)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:42013
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.739)
[S11] not sending this round → trigger blocked (psi=0.392)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:42017
[S16] sending update (kind=head size=1806 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1806) from S16
[S17] cosine check vs S16: cos=-0.0396
[S17] DROPPED delta from S16 (cos=-0.0396 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=-0.0026
[S17] DROPPED delta from S9 (cos=-0.0026 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1794) from S2
[S13] cosine check vs S2: cos=0.6822
[S9] RECEIVED delta(kind=head bytes=1793) from S3
[S9] cosine check vs S3: cos=-0.0526
[S9] DROPPED delta from S3 (cos=-0.0526 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] cosine check vs S6: cos=-0.1569
[S11] DROPPED delta from S6 (cos=-0.1569 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.456)
[S5] ⇄ pheromone p=0.624 → S16@127.0.0.1:42016
[S11] ⇄ pheromone p=0.378 → S13@127.0.0.1:42013
[S4] ⇄ pheromone p=0.533 → S10@127.0.0.1:42011
[S14] ⇄ pheromone p=0.379 → S15@127.0.0.1:42015
[S7] ⇄ pheromone p=0.574 → S14@127.0.0.1:42014
[S8] ⇄ pheromone p=0.383 → S17@127.0.0.1:42017
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.1404 head_norm=0.725221
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.549016e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.777289 delta_norm=0.354902
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.372 → S4@127.0.0.1:42004
[S10] ⇄ pheromone p=0.335 → S3@127.0.0.1:42003
[S16] ⇄ pheromone p=0.331 → S17@127.0.0.1:42017
[S9] ⇄ pheromone p=0.653 → S17@127.0.0.1:42017
[S6] ⇄ pheromone p=0.352 → S11@127.0.0.1:42012
[S2] ⇄ pheromone p=0.389 → S13@127.0.0.1:42013
[S3] ⇄ pheromone p=0.662 → S9@127.0.0.1:42010
[S17] ⇄ pheromone p=0.501 → S3@127.0.0.1:42003
[S15] ⇄ pheromone p=0.349 → S11@127.0.0.1:42012
[S2] START round=6 head_norm_before_train=0.966603 cos_to_last_merge=0.9562 (last merge round=1)
[S2] round=6 local utility u=1.000000 metrics={'f1_val': 0.5928426210292284, 'auprc': 0.7747617452221838, 'loss_val': 0.9543438269397154, 'psi': 0.6656102707064105}-{'f1_val': 0.1417771333885667, 'auprc': 0.7770653970210172, 'loss_val': 1.0822617392742189, 'psi': 0.39589243884154696}
[S3] START round=6 head_norm_before_train=1.027057 cos_to_last_merge=0.9695 (last merge round=3)
[S3] round=6 local utility u=0.190397 metrics={'f1_val': 0.6927498788157274, 'auprc': 0.8734005305297377, 'loss_val': 0.4771908293760215, 'psi': 0.7650101395013315}-{'f1_val': 0.6993228192077114, 'auprc': 0.7765692835459838, 'loss_val': 0.6069294797334904, 'psi': 0.7302214049430203}
[S4] START round=6 head_norm_before_train=0.987303 cos_to_last_merge=0.9630 (last merge round=1)
[S4] round=6 local utility u=0.449051 metrics={'f1_val': 0.27261042012022574, 'auprc': 0.7840880213955544, 'loss_val': 1.0520882237486053, 'psi': 0.47720146063035723}-{'f1_val': 0.14022662889518414, 'auprc': 0.7887542759076718, 'loss_val': 1.1698858318967869, 'psi': 0.3996376877001792}
[S5] START round=6 head_norm_before_train=1.404446 (no previous merge yet)
[S5] round=6 local utility u=0.189089 metrics={'f1_val': 0.7086915262602674, 'auprc': 0.8681744265457318, 'loss_val': 0.41806267820688986, 'psi': 0.7724846863744532}-{'f1_val': 0.7008162875368863, 'auprc': 0.795128917757403, 'loss_val': 0.5298522876584972, 'psi': 0.738541339625093}
[S6] START round=6 head_norm_before_train=1.230390 (no previous merge yet)
[S6] round=6 local utility u=0.914037 metrics={'f1_val': 0.4166544795555117, 'auprc': 0.644717109347613, 'loss_val': 1.0868110500572103, 'psi': 0.5078795314723522}-{'f1_val': 0.14142628205128205, 'auprc': 0.6106088345643416, 'loss_val': 1.1611905108456644, 'psi': 0.32909930305650587}
[S7] START round=6 head_norm_before_train=1.343418 (no previous merge yet)
[S7] round=6 local utility u=0.928511 metrics={'f1_val': 0.7144313640572862, 'auprc': 0.7653801601392181, 'loss_val': 0.840458459424815, 'psi': 0.734810882490059}-{'f1_val': 0.4170778520170104, 'auprc': 0.7776085090411115, 'loss_val': 0.9500434923821465, 'psi': 0.5612901148266509}
[S8] START round=6 head_norm_before_train=0.967661 cos_to_last_merge=0.9702 (last merge round=1)
[S8] round=6 local utility u=0.885289 metrics={'f1_val': 0.41549694000722615, 'auprc': 0.7771093285979479, 'loss_val': 1.0485458577345137, 'psi': 0.5601418954435149}-{'f1_val': 0.13995598239295717, 'auprc': 0.777082444477193, 'loss_val': 1.1657967218478604, 'psi': 0.39480656722665153}
[S9] START round=6 head_norm_before_train=1.241214 cos_to_last_merge=0.9383 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.938
[S9] round=6 local utility u=0.076865 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9993740239994607, 'loss_val': 0.2782409094508719, 'psi': 0.8205684102312898}-{'f1_val': 0.7014391336149548, 'auprc': 0.999376504158191, 'loss_val': 0.43242423555513154, 'psi': 0.8206140818322493}
[S10] START round=6 head_norm_before_train=0.969409 cos_to_last_merge=0.9664 (last merge round=1)
[S10] round=6 local utility u=1.000000 metrics={'f1_val': 0.4168455130671376, 'auprc': 0.7978638061903569, 'loss_val': 0.9456385555782522, 'psi': 0.5692528303164253}-{'f1_val': 0.1433851792258872, 'auprc': 0.6399538781883753, 'loss_val': 1.1041770897200454, 'psi': 0.3420126588108825}
[S11] START round=6 head_norm_before_train=1.246400 (no previous merge yet)
[S11] round=6 local utility u=0.951292 metrics={'f1_val': 0.4222126204677117, 'auprc': 0.8025817671816251, 'loss_val': 0.9870391157806143, 'psi': 0.5743602791532771}-{'f1_val': 0.14041368337311058, 'auprc': 0.7686068360338529, 'loss_val': 1.0969045015844843, 'psi': 0.39169094443740754}
[S13] START round=6 head_norm_before_train=0.777289 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.863879 metrics={'f1_val': 0.415486691627877, 'auprc': 0.737130003213665, 'loss_val': 1.1798539687751997, 'psi': 0.5441440162621922}-{'f1_val': 0.1403857625770531, 'auprc': 0.7219997975619958, 'loss_val': 1.2116151646818296, 'psi': 0.3730313765710302}
[S14] START round=6 head_norm_before_train=0.954684 cos_to_last_merge=0.9807 (last merge round=2)
[S14] round=6 local utility u=1.000000 metrics={'f1_val': 0.39649470961585787, 'auprc': 0.8920066814363123, 'loss_val': 1.1064330155374857, 'psi': 0.5946994983440397}-{'f1_val': 0.14035785288270378, 'auprc': 0.5961653412250585, 'loss_val': 1.1808838800484232, 'psi': 0.32268084821964566}
[S15] START round=6 head_norm_before_train=1.280857 (no previous merge yet)
[S15] round=6 local utility u=0.758915 metrics={'f1_val': 0.37460706801295485, 'auprc': 0.7768116276388876, 'loss_val': 1.0662065536843177, 'psi': 0.5354888918633279}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770302643714244, 'loss_val': 1.1754511648049568, 'psi': 0.39465229656550477}
[S16] START round=6 head_norm_before_train=0.934326 cos_to_last_merge=0.9766 (last merge round=2)
[S16] round=6 local utility u=0.771782 metrics={'f1_val': 0.4138892987575528, 'auprc': 0.7812841995382894, 'loss_val': 1.0803901568377887, 'psi': 0.5608472590698474}-{'f1_val': 0.14063745019920318, 'auprc': 0.8488471673530994, 'loss_val': 1.187131613755501, 'psi': 0.42392133706076174}
[S17] START round=6 head_norm_before_train=1.252710 (no previous merge yet)
[S17] round=6 local utility u=0.107170 metrics={'f1_val': 0.3921336576542863, 'auprc': 0.5854932334827075, 'loss_val': 1.0115405284559202, 'psi': 0.4694774879856548}-{'f1_val': 0.3853679263808666, 'auprc': 0.5608363278034119, 'loss_val': 1.1113150498746418, 'psi': 0.4555552869498847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S16] → sending delta(kind=head bytes=1808) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:42014
[S15] sending update (kind=head size=1789 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1808 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1789) from S15
[S11] cosine check vs S15: cos=-0.0146
[S11] DROPPED delta from S15 (cos=-0.0146 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S4
[S10] cosine check vs S4: cos=-0.0516
[S10] DROPPED delta from S4 (cos=-0.0516 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=-0.0331
[S16] DROPPED delta from S5 (cos=-0.0331 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] cosine check vs S14: cos=0.0615
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] cosine check vs S6: cos=-0.1597
[S11] DROPPED delta from S6 (cos=-0.1597 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] cosine check vs S2: cos=0.9178
[S13] RECEIVED delta(kind=head bytes=1796) from S11
[S13] cosine check vs S11: cos=-0.0674
[S13] DROPPED delta from S11 (cos=-0.0674 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1808) from S16
[S17] cosine check vs S16: cos=-0.0420
[S17] DROPPED delta from S16 (cos=-0.0420 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=-0.0485
[S17] DROPPED delta from S8 (cos=-0.0485 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S13
[S4] cosine check vs S13: cos=-0.0197
[S4] DROPPED delta from S13 (cos=-0.0197 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=-0.0524
[S9] DROPPED delta from S3 (cos=-0.0524 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S10
[S3] cosine check vs S10: cos=0.4575
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=-0.0946
[S14] DROPPED delta from S7 (cos=-0.0946 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1805) from S9
[S17] cosine check vs S9: cos=0.0002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=-0.0723
[S3] DROPPED delta from S17 (cos=-0.0723 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.6927 head_norm=1.118016
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.555655e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.7003 head_norm=0.907857 delta_norm=0.555566
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.3746 head_norm=1.316611
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.988527e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.4158 head_norm=0.847520 delta_norm=0.798853
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.4155 head_norm=0.794456
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.089686e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.4155 head_norm=0.880450 delta_norm=0.208969
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.3921 head_norm=1.285251
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.196387e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.3921 head_norm=0.919843 delta_norm=0.919639
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.003274 cos_to_last_merge=0.9405 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.940
[S2] round=7 local utility u=0.409509 metrics={'f1_val': 0.7122443001715099, 'auprc': 0.7595378408273108, 'loss_val': 0.8060642412191853, 'psi': 0.7311617164338302}-{'f1_val': 0.5928426210292284, 'auprc': 0.7747617452221838, 'loss_val': 0.9543438269397154, 'psi': 0.6656102707064105}
[S3] START round=7 head_norm_before_train=0.907857 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.008371 metrics={'f1_val': 0.6685683783079235, 'auprc': 0.9546941274148796, 'loss_val': 0.5592414618653547, 'psi': 0.7830186779507059}-{'f1_val': 0.6927498788157274, 'auprc': 0.8734005305297377, 'loss_val': 0.4771908293760215, 'psi': 0.7650101395013315}
[S4] START round=7 head_norm_before_train=1.030896 cos_to_last_merge=0.9490 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.949
[S4] round=7 local utility u=1.000000 metrics={'f1_val': 0.6730434083003268, 'auprc': 0.78755438484261, 'loss_val': 0.9047426901267028, 'psi': 0.7188477989172402}-{'f1_val': 0.27261042012022574, 'auprc': 0.7840880213955544, 'loss_val': 1.0520882237486053, 'psi': 0.47720146063035723}
[S5] START round=7 head_norm_before_train=1.460831 (no previous merge yet)
[S5] round=7 local utility u=0.221681 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.9980886600921058, 'loss_val': 0.31743248157527176, 'psi': 0.819749257572769}-{'f1_val': 0.7086915262602674, 'auprc': 0.8681744265457318, 'loss_val': 0.41806267820688986, 'psi': 0.7724846863744532}
[S6] START round=7 head_norm_before_train=1.253091 (no previous merge yet)
[S6] round=7 local utility u=0.230375 metrics={'f1_val': 0.4166544795555117, 'auprc': 0.7540097173400213, 'loss_val': 0.9539379367783407, 'psi': 0.5515965746693156}-{'f1_val': 0.4166544795555117, 'auprc': 0.644717109347613, 'loss_val': 1.0868110500572103, 'psi': 0.5078795314723522}
[S7] START round=7 head_norm_before_train=1.379172 (no previous merge yet)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.41727946905461333, 'auprc': 0.7934975569439482, 'loss_val': 0.739382726620954, 'psi': 0.5677667042103474}-{'f1_val': 0.7144313640572862, 'auprc': 0.7653801601392181, 'loss_val': 0.840458459424815, 'psi': 0.734810882490059}
[S8] START round=7 head_norm_before_train=1.011097 cos_to_last_merge=0.9576 (last merge round=1)
[S8] round=7 local utility u=0.976078 metrics={'f1_val': 0.7150337453891538, 'auprc': 0.7768563987384658, 'loss_val': 0.8928528873392361, 'psi': 0.7397628067288786}-{'f1_val': 0.41549694000722615, 'auprc': 0.7771093285979479, 'loss_val': 1.0485458577345137, 'psi': 0.5601418954435149}
[S9] START round=7 head_norm_before_train=1.315987 cos_to_last_merge=0.9226 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.923
[S9] round=7 local utility u=0.013962 metrics={'f1_val': 0.7005695952202671, 'auprc': 0.9975990264465238, 'loss_val': 0.2402215082120984, 'psi': 0.8193813677107697}-{'f1_val': 0.7013646677191758, 'auprc': 0.9993740239994607, 'loss_val': 0.2782409094508719, 'psi': 0.8205684102312898}
[S10] START round=7 head_norm_before_train=1.007846 cos_to_last_merge=0.9533 (last merge round=1)
[S10] round=7 local utility u=0.053382 metrics={'f1_val': 0.38610662554053643, 'auprc': 0.8350383379604783, 'loss_val': 0.7659641170182369, 'psi': 0.5656793105085132}-{'f1_val': 0.4168455130671376, 'auprc': 0.7978638061903569, 'loss_val': 0.9456385555782522, 'psi': 0.5692528303164253}
[S11] START round=7 head_norm_before_train=1.269822 (no previous merge yet)
[S11] round=7 local utility u=0.297452 metrics={'f1_val': 0.4148404227119303, 'auprc': 0.9656416898363098, 'loss_val': 0.8370826763809074, 'psi': 0.6351609295616821}-{'f1_val': 0.4222126204677117, 'auprc': 0.8025817671816251, 'loss_val': 0.9870391157806143, 'psi': 0.5743602791532771}
[S13] START round=7 head_norm_before_train=0.880450 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.040775 metrics={'f1_val': 0.4161203556905605, 'auprc': 0.743044505380222, 'loss_val': 1.1198501235551621, 'psi': 0.5468900155664251}-{'f1_val': 0.415486691627877, 'auprc': 0.737130003213665, 'loss_val': 1.1798539687751997, 'psi': 0.5441440162621922}
[S14] START round=7 head_norm_before_train=0.989670 cos_to_last_merge=0.9713 (last merge round=2)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.8337944890149813, 'loss_val': 0.9512443806092297, 'psi': 0.5714343382531472}-{'f1_val': 0.39649470961585787, 'auprc': 0.8920066814363123, 'loss_val': 1.1064330155374857, 'psi': 0.5946994983440397}
[S15] START round=7 head_norm_before_train=0.847520 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.175825 metrics={'f1_val': 0.4169508412658852, 'auprc': 0.7790708824325934, 'loss_val': 0.9753971371721037, 'psi': 0.5617988577325685}-{'f1_val': 0.37460706801295485, 'auprc': 0.7768116276388876, 'loss_val': 1.0662065536843177, 'psi': 0.5354888918633279}
[S16] START round=7 head_norm_before_train=0.965575 cos_to_last_merge=0.9640 (last merge round=2)
[S16] round=7 local utility u=0.023725 metrics={'f1_val': 0.41727255530994717, 'auprc': 0.7433648819305572, 'loss_val': 0.9394813528796158, 'psi': 0.5477094859581911}-{'f1_val': 0.4138892987575528, 'auprc': 0.7812841995382894, 'loss_val': 1.0803901568377887, 'psi': 0.5608472590698474}
[S17] START round=7 head_norm_before_train=0.919843 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.39206469802415145, 'auprc': 0.5537909537520994, 'loss_val': 0.9402247577934697, 'psi': 0.4567552003153306}-{'f1_val': 0.3921336576542863, 'auprc': 0.5854932334827075, 'loss_val': 1.0115405284559202, 'psi': 0.4694774879856548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] → sending delta(kind=head bytes=1807) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:42011
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:42012
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:42012
[S6] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S4
[S10] cosine check vs S4: cos=-0.0486
[S10] DROPPED delta from S4 (cos=-0.0486 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1792) from S3
[S9] cosine check vs S3: cos=-0.0478
[S9] DROPPED delta from S3 (cos=-0.0478 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S15
[S11] cosine check vs S15: cos=-0.0578
[S11] DROPPED delta from S15 (cos=-0.0578 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1807) from S16
[S17] cosine check vs S16: cos=0.0275
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=0.0098
[S17] RECEIVED delta(kind=head bytes=1801) from S9
[S17] cosine check vs S9: cos=0.6883
[S4] RECEIVED delta(kind=head bytes=1795) from S13
[S4] cosine check vs S13: cos=-0.0148
[S4] DROPPED delta from S13 (cos=-0.0148 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S10
[S3] cosine check vs S10: cos=0.7779
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=-0.0388
[S16] DROPPED delta from S5 (cos=-0.0388 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S11
[S13] cosine check vs S11: cos=-0.0747
[S13] DROPPED delta from S11 (cos=-0.0747 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S2
[S13] cosine check vs S2: cos=0.9661
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] cosine check vs S6: cos=-0.1606
[S11] DROPPED delta from S6 (cos=-0.1606 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.6686 head_norm=0.978200
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.412131e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.6998 head_norm=0.959694 delta_norm=0.341213
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4161 head_norm=0.898536
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.451903e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4161 head_norm=0.962362 delta_norm=0.145190
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3921 head_norm=0.954094
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.501831e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3919 head_norm=0.692103 delta_norm=0.450183
[S17] aggregate: ACCEPT kept=['S16', 'S8', 'S9'] (k=3/3) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.042630 cos_to_last_merge=0.9249 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.925
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.7016326066040468, 'auprc': 0.6450287137892464, 'loss_val': 0.7063268619753531, 'psi': 0.6789910494781266}-{'f1_val': 0.7122443001715099, 'auprc': 0.7595378408273108, 'loss_val': 0.8060642412191853, 'psi': 0.7311617164338302}
[S3] START round=8 head_norm_before_train=0.959694 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.054782 metrics={'f1_val': 0.6712739518685666, 'auprc': 0.9890942208915527, 'loss_val': 0.5691109347697855, 'psi': 0.7984020594777611}-{'f1_val': 0.6685683783079235, 'auprc': 0.9546941274148796, 'loss_val': 0.5592414618653547, 'psi': 0.7830186779507059}
[S4] START round=8 head_norm_before_train=1.073409 cos_to_last_merge=0.9354 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.935
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.6705985905812799, 'auprc': 0.6657882902569575, 'loss_val': 0.7265373111775281, 'psi': 0.668674470451551}-{'f1_val': 0.6730434083003268, 'auprc': 0.78755438484261, 'loss_val': 0.9047426901267028, 'psi': 0.7188477989172402}
[S5] START round=8 head_norm_before_train=1.512763 (no previous merge yet)
[S5] round=8 local utility u=0.016550 metrics={'f1_val': 0.7006073928698142, 'auprc': 0.9979173880941943, 'loss_val': 0.2823258198717575, 'psi': 0.8195313909595663}-{'f1_val': 0.7008563225598777, 'auprc': 0.9980886600921058, 'loss_val': 0.31743248157527176, 'psi': 0.819749257572769}
[S6] START round=8 head_norm_before_train=1.282304 (no previous merge yet)
[S6] round=8 local utility u=0.123747 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.7920926186089405, 'loss_val': 0.8231009430958334, 'psi': 0.5670704701680966}-{'f1_val': 0.4166544795555117, 'auprc': 0.7540097173400213, 'loss_val': 0.9539379367783407, 'psi': 0.5515965746693156}
[S7] START round=8 head_norm_before_train=1.426285 (no previous merge yet)
[S7] round=8 local utility u=0.825464 metrics={'f1_val': 0.6833067617036236, 'auprc': 0.7911699573895191, 'loss_val': 0.677636540527433, 'psi': 0.7264520399779819}-{'f1_val': 0.41727946905461333, 'auprc': 0.7934975569439482, 'loss_val': 0.739382726620954, 'psi': 0.5677667042103474}
[S8] START round=8 head_norm_before_train=1.054279 cos_to_last_merge=0.9462 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=8 local utility u=0.118390 metrics={'f1_val': 0.7143962130222558, 'auprc': 0.7940524088869516, 'loss_val': 0.7038349099696457, 'psi': 0.7462586913681342}-{'f1_val': 0.7150337453891538, 'auprc': 0.7768563987384658, 'loss_val': 0.8928528873392361, 'psi': 0.7397628067288786}
[S9] START round=8 head_norm_before_train=1.381403 cos_to_last_merge=0.9074 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.907
[S9] round=8 local utility u=0.948423 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9983272994637054, 'loss_val': 0.12457041769201059, 'psi': 0.9975737677071023}-{'f1_val': 0.7005695952202671, 'auprc': 0.9975990264465238, 'loss_val': 0.2402215082120984, 'psi': 0.8193813677107697}
[S10] START round=8 head_norm_before_train=1.057357 cos_to_last_merge=0.9368 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=8 local utility u=0.244845 metrics={'f1_val': 0.3865622016457787, 'auprc': 0.964161349403769, 'loss_val': 0.6663757968206966, 'psi': 0.6176018607489748}-{'f1_val': 0.38610662554053643, 'auprc': 0.8350383379604783, 'loss_val': 0.7659641170182369, 'psi': 0.5656793105085132}
[S11] START round=8 head_norm_before_train=1.304648 (no previous merge yet)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.4005844218082196, 'auprc': 0.9012832721030124, 'loss_val': 0.7061795644053662, 'psi': 0.6008639619261367}-{'f1_val': 0.4148404227119303, 'auprc': 0.9656416898363098, 'loss_val': 0.8370826763809074, 'psi': 0.6351609295616821}
[S13] START round=8 head_norm_before_train=0.962362 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.3716355219467268, 'auprc': 0.7553334001841618, 'loss_val': 1.0326385421752637, 'psi': 0.5251146732417008}-{'f1_val': 0.4161203556905605, 'auprc': 0.743044505380222, 'loss_val': 1.1198501235551621, 'psi': 0.5468900155664251}
[S14] START round=8 head_norm_before_train=1.036397 cos_to_last_merge=0.9571 (last merge round=2)
[S14] round=8 local utility u=1.000000 metrics={'f1_val': 0.6888313817562489, 'auprc': 0.9514225271834672, 'loss_val': 0.8144345614913104, 'psi': 0.7938678399271362}-{'f1_val': 0.39652757107859105, 'auprc': 0.8337944890149813, 'loss_val': 0.9512443806092297, 'psi': 0.5714343382531472}
[S15] START round=8 head_norm_before_train=0.889401 cos_to_last_merge=0.9969 (last merge round=6)
[S15] round=8 local utility u=0.723304 metrics={'f1_val': 0.6217655779155353, 'auprc': 0.7998161058558976, 'loss_val': 0.8199132114155648, 'psi': 0.6929857890916802}-{'f1_val': 0.4169508412658852, 'auprc': 0.7790708824325934, 'loss_val': 0.9753971371721037, 'psi': 0.5617988577325685}
[S16] START round=8 head_norm_before_train=1.001526 cos_to_last_merge=0.9480 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=8 local utility u=0.051888 metrics={'f1_val': 0.41696372269722326, 'auprc': 0.7434067427643867, 'loss_val': 0.8339778601997802, 'psi': 0.5475409307240886}-{'f1_val': 0.41727255530994717, 'auprc': 0.7433648819305572, 'loss_val': 0.9394813528796158, 'psi': 0.5477094859581911}
[S17] START round=8 head_norm_before_train=0.692103 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.3916865758460034, 'auprc': 0.5231082798004276, 'loss_val': 0.9383289317048294, 'psi': 0.4442552574277731}-{'f1_val': 0.39206469802415145, 'auprc': 0.5537909537520994, 'loss_val': 0.9402247577934697, 'psi': 0.4567552003153306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:42017
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:42016
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:42003
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] cosine check vs S16: cos=0.2754
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] cosine check vs S6: cos=-0.1595
[S11] DROPPED delta from S6 (cos=-0.1595 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S15
[S11] cosine check vs S15: cos=-0.0593
[S11] DROPPED delta from S15 (cos=-0.0593 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] cosine check vs S3: cos=-0.0371
[S9] DROPPED delta from S3 (cos=-0.0371 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=-0.0419
[S16] DROPPED delta from S5 (cos=-0.0419 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1806) from S9
[S17] cosine check vs S9: cos=0.7561
[S17] RECEIVED delta(kind=head bytes=1790) from S8
[S17] cosine check vs S8: cos=0.2581
[S3] RECEIVED delta(kind=head bytes=1803) from S10
[S3] cosine check vs S10: cos=0.8915
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] cosine check vs S14: cos=0.5826
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=-0.1020
[S14] DROPPED delta from S7 (cos=-0.1020 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.6713 head_norm=1.031023
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.521878e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.7003 head_norm=1.040871 delta_norm=0.252188
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.6218 head_norm=0.938567
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.673852e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.3836 head_norm=0.901565 delta_norm=0.467385
[S15] aggregate: ROLLBACK (f1_val pre=0.622 post=0.384 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3917 head_norm=0.732697
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.603803e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3899 head_norm=0.669832 delta_norm=0.260380
[S17] aggregate: ACCEPT kept=['S16', 'S9', 'S8'] (k=3/3) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.088005 cos_to_last_merge=0.9092 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.909
[S2] round=9 local utility u=0.061659 metrics={'f1_val': 0.7013740235548288, 'auprc': 0.6582076098630162, 'loss_val': 0.6209933250673817, 'psi': 0.6841074580781037}-{'f1_val': 0.7016326066040468, 'auprc': 0.6450287137892464, 'loss_val': 0.7063268619753531, 'psi': 0.6789910494781266}
[S3] START round=9 head_norm_before_train=1.040871 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.142405 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9879167582919524, 'loss_val': 0.45811445988693683, 'psi': 0.8156657443320674}-{'f1_val': 0.6712739518685666, 'auprc': 0.9890942208915527, 'loss_val': 0.5691109347697855, 'psi': 0.7984020594777611}
[S4] START round=9 head_norm_before_train=1.130358 cos_to_last_merge=0.9176 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.918
[S4] round=9 local utility u=0.118448 metrics={'f1_val': 0.6894202803374219, 'auprc': 0.6716883485273315, 'loss_val': 0.6202708042707742, 'psi': 0.6823275076133857}-{'f1_val': 0.6705985905812799, 'auprc': 0.6657882902569575, 'loss_val': 0.7265373111775281, 'psi': 0.668674470451551}
[S5] START round=9 head_norm_before_train=1.545526 (no previous merge yet)
[S5] round=9 local utility u=0.040848 metrics={'f1_val': 0.7077354046380494, 'auprc': 0.9980294651423819, 'loss_val': 0.24373409210974842, 'psi': 0.8238530288397824}-{'f1_val': 0.7006073928698142, 'auprc': 0.9979173880941943, 'loss_val': 0.2823258198717575, 'psi': 0.8195313909595663}
[S6] START round=9 head_norm_before_train=1.313606 (no previous merge yet)
[S6] round=9 local utility u=0.078794 metrics={'f1_val': 0.4171358730402079, 'auprc': 0.8006829196980327, 'loss_val': 0.6917654352007708, 'psi': 0.5705546917033378}-{'f1_val': 0.41705570454086727, 'auprc': 0.7920926186089405, 'loss_val': 0.8231009430958334, 'psi': 0.5670704701680966}
[S7] START round=9 head_norm_before_train=1.473006 (no previous merge yet)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.5860038384482522, 'auprc': 0.7971226815468331, 'loss_val': 0.7187425287468486, 'psi': 0.6704513756876845}-{'f1_val': 0.6833067617036236, 'auprc': 0.7911699573895191, 'loss_val': 0.677636540527433, 'psi': 0.7264520399779819}
[S8] START round=9 head_norm_before_train=1.106183 cos_to_last_merge=0.9317 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.932
[S8] round=9 local utility u=0.100095 metrics={'f1_val': 0.7141096062959231, 'auprc': 0.7941991109538742, 'loss_val': 0.5023649227174496, 'psi': 0.7461454081591036}-{'f1_val': 0.7143962130222558, 'auprc': 0.7940524088869516, 'loss_val': 0.7038349099696457, 'psi': 0.7462586913681342}
[S9] START round=9 head_norm_before_train=1.440435 cos_to_last_merge=0.8953 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.895
[S9] round=9 local utility u=0.022087 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9988671346193738, 'loss_val': 0.0820154903406026, 'psi': 0.9977897017693697}-{'f1_val': 0.9970714132027002, 'auprc': 0.9983272994637054, 'loss_val': 0.12457041769201059, 'psi': 0.9975737677071023}
[S10] START round=9 head_norm_before_train=1.109511 cos_to_last_merge=0.9195 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.919
[S10] round=9 local utility u=0.617586 metrics={'f1_val': 0.5709130416704471, 'auprc': 0.9673010197499858, 'loss_val': 0.5467268619349697, 'psi': 0.7294682329022626}-{'f1_val': 0.3865622016457787, 'auprc': 0.964161349403769, 'loss_val': 0.6663757968206966, 'psi': 0.6176018607489748}
[S11] START round=9 head_norm_before_train=1.348105 (no previous merge yet)
[S11] round=9 local utility u=0.829010 metrics={'f1_val': 0.607332164264025, 'auprc': 0.9960428596510763, 'loss_val': 0.57292497732099, 'psi': 0.7628164424188455}-{'f1_val': 0.4005844218082196, 'auprc': 0.9012832721030124, 'loss_val': 0.7061795644053662, 'psi': 0.6008639619261367}
[S13] START round=9 head_norm_before_train=0.984181 cos_to_last_merge=0.9964 (last merge round=7)
[S13] round=9 local utility u=0.040356 metrics={'f1_val': 0.37145502080491366, 'auprc': 0.7499421561831541, 'loss_val': 0.9346702306879737, 'psi': 0.5228498749562098}-{'f1_val': 0.3716355219467268, 'auprc': 0.7553334001841618, 'loss_val': 1.0326385421752637, 'psi': 0.5251146732417008}
[S14] START round=9 head_norm_before_train=1.087028 cos_to_last_merge=0.9397 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=9 local utility u=0.464030 metrics={'f1_val': 0.8089930718515668, 'auprc': 0.9908115605427782, 'loss_val': 0.7255125692639908, 'psi': 0.8817204673280513}-{'f1_val': 0.6888313817562489, 'auprc': 0.9514225271834672, 'loss_val': 0.8144345614913104, 'psi': 0.7938678399271362}
[S15] START round=9 head_norm_before_train=0.901565 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.043098 metrics={'f1_val': 0.6082078206572672, 'auprc': 0.8400983741170991, 'loss_val': 0.7732170834674753, 'psi': 0.7009640420412}-{'f1_val': 0.6217655779155353, 'auprc': 0.7998161058558976, 'loss_val': 0.8199132114155648, 'psi': 0.6929857890916802}
[S16] START round=9 head_norm_before_train=1.048381 cos_to_last_merge=0.9290 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.929
[S16] round=9 local utility u=0.075500 metrics={'f1_val': 0.436000405240677, 'auprc': 0.7426767807529111, 'loss_val': 0.7950088746819598, 'psi': 0.5586709554455707}-{'f1_val': 0.41696372269722326, 'auprc': 0.7434067427643867, 'loss_val': 0.8339778601997802, 'psi': 0.5475409307240886}
[S17] START round=9 head_norm_before_train=0.669832 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.134965 metrics={'f1_val': 0.35703828151437567, 'auprc': 0.6940295435422753, 'loss_val': 0.9732722690010398, 'psi': 0.49183478632553557}-{'f1_val': 0.3916865758460034, 'auprc': 0.5231082798004276, 'loss_val': 0.9383289317048294, 'psi': 0.4442552574277731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:42012
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:42013
[S3] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S2
[S13] cosine check vs S2: cos=0.9589
[S17] RECEIVED delta(kind=head bytes=1799) from S16
[S17] cosine check vs S16: cos=0.4203
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=0.4015
[S16] RECEIVED delta(kind=head bytes=1794) from S5
[S16] cosine check vs S5: cos=-0.0408
[S16] DROPPED delta from S5 (cos=-0.0408 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] cosine check vs S9: cos=0.7240
[S11] RECEIVED delta(kind=head bytes=1796) from S15
[S11] cosine check vs S15: cos=-0.0918
[S11] DROPPED delta from S15 (cos=-0.0918 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] cosine check vs S14: cos=0.8710
[S4] RECEIVED delta(kind=head bytes=1793) from S13
[S4] cosine check vs S13: cos=-0.0074
[S4] DROPPED delta from S13 (cos=-0.0074 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S6
[S11] cosine check vs S6: cos=-0.1573
[S11] DROPPED delta from S6 (cos=-0.1573 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S4
[S10] cosine check vs S4: cos=-0.0446
[S10] DROPPED delta from S4 (cos=-0.0446 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1793) from S3
[S9] cosine check vs S3: cos=-0.0284
[S9] DROPPED delta from S3 (cos=-0.0284 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1804) from S11
[S13] cosine check vs S11: cos=-0.0775
[S13] DROPPED delta from S11 (cos=-0.0775 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=0.9277
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] cosine check vs S17: cos=-0.1003
[S3] DROPPED delta from S17 (cos=-0.1003 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.6082 head_norm=0.939448
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.800795e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.4356 head_norm=1.003871 delta_norm=0.280079
[S15] aggregate: ROLLBACK (f1_val pre=0.608 post=0.436 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.7008 head_norm=1.114110
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.172769e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.7008 head_norm=1.116287 delta_norm=0.217277
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.3715 head_norm=1.013498
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.659575e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.3715 head_norm=1.064446 delta_norm=0.165957
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3570 head_norm=0.713453
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.819173e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3567 head_norm=0.701871 delta_norm=0.181917
[S17] aggregate: ACCEPT kept=['S16', 'S8', 'S9'] (k=3/3) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.137540 cos_to_last_merge=0.8944 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.894
[S2] round=10 local utility u=0.110419 metrics={'f1_val': 0.7015542259878702, 'auprc': 0.7074343999056096, 'loss_val': 0.5489169898730388, 'psi': 0.703906295554966}-{'f1_val': 0.7013740235548288, 'auprc': 0.6582076098630162, 'loss_val': 0.6209933250673817, 'psi': 0.6841074580781037}
[S3] START round=10 head_norm_before_train=1.116287 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.015906 metrics={'f1_val': 0.7010863553524592, 'auprc': 0.9900909921795614, 'loss_val': 0.43435267840207864, 'psi': 0.8166882100833002}-{'f1_val': 0.7008317350254774, 'auprc': 0.9879167582919524, 'loss_val': 0.45811445988693683, 'psi': 0.8156657443320674}
[S4] START round=10 head_norm_before_train=1.192450 cos_to_last_merge=0.8990 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.899
[S4] round=10 local utility u=0.051349 metrics={'f1_val': 0.6919867656142801, 'auprc': 0.6601988839657594, 'loss_val': 0.4985039844870795, 'psi': 0.6792716129548718}-{'f1_val': 0.6894202803374219, 'auprc': 0.6716883485273315, 'loss_val': 0.6202708042707742, 'psi': 0.6823275076133857}
[S5] START round=10 head_norm_before_train=1.583214 (no previous merge yet)
[S5] round=10 local utility u=0.011969 metrics={'f1_val': 0.7077354046380494, 'auprc': 0.9978434899345328, 'loss_val': 0.21923781949962343, 'psi': 0.8237786387566428}-{'f1_val': 0.7077354046380494, 'auprc': 0.9980294651423819, 'loss_val': 0.24373409210974842, 'psi': 0.8238530288397824}
[S6] START round=10 head_norm_before_train=1.349437 (no previous merge yet)
[S6] round=10 local utility u=0.011003 metrics={'f1_val': 0.4168135083356663, 'auprc': 0.7889270120665903, 'loss_val': 0.6325569052305011, 'psi': 0.5656589098280359}-{'f1_val': 0.4171358730402079, 'auprc': 0.8006829196980327, 'loss_val': 0.6917654352007708, 'psi': 0.5705546917033378}
[S7] START round=10 head_norm_before_train=1.508516 (no previous merge yet)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.5780734249255197, 'auprc': 0.7789384257139482, 'loss_val': 0.6806880870098735, 'psi': 0.6584194252408911}-{'f1_val': 0.5860038384482522, 'auprc': 0.7971226815468331, 'loss_val': 0.7187425287468486, 'psi': 0.6704513756876845}
[S8] START round=10 head_norm_before_train=1.164494 cos_to_last_merge=0.9147 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.915
[S8] round=10 local utility u=0.343533 metrics={'f1_val': 0.7011436638604759, 'auprc': 0.996352045517057, 'loss_val': 0.34396129008191056, 'psi': 0.8192270165231084}-{'f1_val': 0.7141096062959231, 'auprc': 0.7941991109538742, 'loss_val': 0.5023649227174496, 'psi': 0.7461454081591036}
[S9] START round=10 head_norm_before_train=1.495323 cos_to_last_merge=0.8843 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.884
[S9] round=10 local utility u=0.010631 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9971532803169811, 'loss_val': 0.05314636597890757, 'psi': 0.9968576192151273}-{'f1_val': 0.9970714132027002, 'auprc': 0.9988671346193738, 'loss_val': 0.0820154903406026, 'psi': 0.9977897017693697}
[S10] START round=10 head_norm_before_train=1.159900 cos_to_last_merge=0.9026 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.903
[S10] round=10 local utility u=0.501528 metrics={'f1_val': 0.6998932897468348, 'auprc': 0.9963800819352114, 'loss_val': 0.4047891661742595, 'psi': 0.8184880066221855}-{'f1_val': 0.5709130416704471, 'auprc': 0.9673010197499858, 'loss_val': 0.5467268619349697, 'psi': 0.7294682329022626}
[S11] START round=10 head_norm_before_train=1.395393 (no previous merge yet)
[S11] round=10 local utility u=0.331062 metrics={'f1_val': 0.7014095185520394, 'auprc': 0.9974501961445419, 'loss_val': 0.4794877509187912, 'psi': 0.8198257895890404}-{'f1_val': 0.607332164264025, 'auprc': 0.9960428596510763, 'loss_val': 0.57292497732099, 'psi': 0.7628164424188455}
[S13] START round=10 head_norm_before_train=1.064446 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.3744186655303705, 'auprc': 0.5683020247054981, 'loss_val': 0.9692148606640794, 'psi': 0.4519720092004216}-{'f1_val': 0.37145502080491366, 'auprc': 0.7499421561831541, 'loss_val': 0.9346702306879737, 'psi': 0.5228498749562098}
[S14] START round=10 head_norm_before_train=1.135712 cos_to_last_merge=0.9222 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.922
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.7457490802168782, 'auprc': 0.9991712925749083, 'loss_val': 0.5526427102168341, 'psi': 0.8471179651600903}-{'f1_val': 0.8089930718515668, 'auprc': 0.9908115605427782, 'loss_val': 0.7255125692639908, 'psi': 0.8817204673280513}
[S15] START round=10 head_norm_before_train=1.003871 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.509785 metrics={'f1_val': 0.7017648309669897, 'auprc': 0.9822019976678298, 'loss_val': 0.741300312298346, 'psi': 0.8139396976473257}-{'f1_val': 0.6082078206572672, 'auprc': 0.8400983741170991, 'loss_val': 0.7732170834674753, 'psi': 0.7009640420412}
[S16] START round=10 head_norm_before_train=1.096335 cos_to_last_merge=0.9114 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.911
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.405464151747156, 'auprc': 0.7486937077303937, 'loss_val': 0.7407163087197471, 'psi': 0.5427559741404511}-{'f1_val': 0.436000405240677, 'auprc': 0.7426767807529111, 'loss_val': 0.7950088746819598, 'psi': 0.5586709554455707}
[S17] START round=10 head_norm_before_train=0.701871 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.161692 metrics={'f1_val': 0.35302995561043005, 'auprc': 0.8133426362143721, 'loss_val': 0.9837785832243792, 'psi': 0.5371550278520069}-{'f1_val': 0.35703828151437567, 'auprc': 0.6940295435422753, 'loss_val': 0.9732722690010398, 'psi': 0.49183478632553557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:42012
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:42016
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:42017
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:42017
[S9] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=-0.0871
[S13] DROPPED delta from S11 (cos=-0.0871 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S15
[S11] cosine check vs S15: cos=-0.1040
[S11] DROPPED delta from S15 (cos=-0.1040 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S2
[S13] cosine check vs S2: cos=0.9791
[S11] RECEIVED delta(kind=head bytes=1805) from S6
[S11] cosine check vs S6: cos=-0.1556
[S11] DROPPED delta from S6 (cos=-0.1556 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S10
[S3] cosine check vs S10: cos=0.9477
[S10] RECEIVED delta(kind=head bytes=1798) from S4
[S10] cosine check vs S4: cos=-0.0471
[S10] DROPPED delta from S4 (cos=-0.0471 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.4605
[S17] RECEIVED delta(kind=head bytes=1804) from S9
[S17] cosine check vs S9: cos=0.6869
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=-0.0235
[S9] DROPPED delta from S3 (cos=-0.0235 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=-0.0406
[S16] DROPPED delta from S5 (cos=-0.0406 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] cosine check vs S17: cos=-0.0921
[S3] DROPPED delta from S17 (cos=-0.0921 < 0.0)
[S14] ⇄ pheromone p=0.408 → S15@127.0.0.1:42015
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.3744 head_norm=1.089419
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.256719e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.3715 head_norm=1.131203 delta_norm=0.125672
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.203 → S4@127.0.0.1:42004
[S7] ⇄ pheromone p=0.370 → S14@127.0.0.1:42014
[S10] ⇄ pheromone p=0.428 → S3@127.0.0.1:42003
[S2] ⇄ pheromone p=0.283 → S13@127.0.0.1:42013
[S6] ⇄ pheromone p=0.245 → S11@127.0.0.1:42012
[S9] ⇄ pheromone p=0.349 → S17@127.0.0.1:42017
[S11] ⇄ pheromone p=0.431 → S13@127.0.0.1:42013
[S4] ⇄ pheromone p=0.343 → S10@127.0.0.1:42011
[S5] ⇄ pheromone p=0.254 → S16@127.0.0.1:42016
[S15] ⇄ pheromone p=0.396 → S11@127.0.0.1:42012
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.7011 head_norm=1.178082
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.937729e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.7010 head_norm=1.178601 delta_norm=0.193773
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.266 → S9@127.0.0.1:42010
[S8] ⇄ pheromone p=0.398 → S17@127.0.0.1:42017
[S16] ⇄ pheromone p=0.193 → S17@127.0.0.1:42017
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3530 head_norm=0.746002
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.966833e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3530 head_norm=0.834222 delta_norm=0.296683
[S17] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.227 → S3@127.0.0.1:42003
[S2] START round=11 head_norm_before_train=1.184901 cos_to_last_merge=0.8824 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.882
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.7013938903161618, 'auprc': 0.6635450183098577, 'loss_val': 0.47099161912413556, 'psi': 0.6862543415136402}-{'f1_val': 0.7015542259878702, 'auprc': 0.7074343999056096, 'loss_val': 0.5489169898730388, 'psi': 0.703906295554966}
[S3] START round=11 head_norm_before_train=1.178601 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.029682 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9976949108055123, 'loss_val': 0.39536888247453783, 'psi': 0.8194865401214058}-{'f1_val': 0.7010863553524592, 'auprc': 0.9900909921795614, 'loss_val': 0.43435267840207864, 'psi': 0.8166882100833002}
[S4] START round=11 head_norm_before_train=1.254439 cos_to_last_merge=0.8800 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.880
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.6758164093507885, 'auprc': 0.6606283455193498, 'loss_val': 0.4307350830704311, 'psi': 0.669741183818213}-{'f1_val': 0.6919867656142801, 'auprc': 0.6601988839657594, 'loss_val': 0.4985039844870795, 'psi': 0.6792716129548718}
[S5] START round=11 head_norm_before_train=1.617635 (no previous merge yet)
[S5] round=11 local utility u=0.018862 metrics={'f1_val': 0.7112348455757793, 'auprc': 0.9977842281577168, 'loss_val': 0.20233258400834178, 'psi': 0.8258545986085544}-{'f1_val': 0.7077354046380494, 'auprc': 0.9978434899345328, 'loss_val': 0.21923781949962343, 'psi': 0.8237786387566428}
[S6] START round=11 head_norm_before_train=1.387247 (no previous merge yet)
[S6] round=11 local utility u=1.000000 metrics={'f1_val': 0.7098091106032804, 'auprc': 0.9633566273278753, 'loss_val': 0.46950489189590694, 'psi': 0.8112281172931184}-{'f1_val': 0.4168135083356663, 'auprc': 0.7889270120665903, 'loss_val': 0.6325569052305011, 'psi': 0.5656589098280359}
[S7] START round=11 head_norm_before_train=1.534184 (no previous merge yet)
[S7] round=11 local utility u=0.397988 metrics={'f1_val': 0.6804051284469534, 'auprc': 0.7990222264953434, 'loss_val': 0.5589527943248973, 'psi': 0.7278519676663093}-{'f1_val': 0.5780734249255197, 'auprc': 0.7789384257139482, 'loss_val': 0.6806880870098735, 'psi': 0.6584194252408911}
[S8] START round=11 head_norm_before_train=1.222867 cos_to_last_merge=0.8978 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.898
[S8] round=11 local utility u=0.058809 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9957976263366097, 'loss_val': 0.30325349868773277, 'psi': 0.8268625137733414}-{'f1_val': 0.7011436638604759, 'auprc': 0.996352045517057, 'loss_val': 0.34396129008191056, 'psi': 0.8192270165231084}
[S9] START round=11 head_norm_before_train=1.552765 cos_to_last_merge=0.8733 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.873
[S9] round=11 local utility u=0.005888 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.996272345360433, 'loss_val': 0.038728027994290086, 'psi': 0.996505245232508}-{'f1_val': 0.9966605118138915, 'auprc': 0.9971532803169811, 'loss_val': 0.05314636597890757, 'psi': 0.9968576192151273}
[S10] START round=11 head_norm_before_train=1.210546 cos_to_last_merge=0.8863 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.886
[S10] round=11 local utility u=0.037922 metrics={'f1_val': 0.6984413351386141, 'auprc': 0.9946600553695566, 'loss_val': 0.3150742207129488, 'psi': 0.816928823230991}-{'f1_val': 0.6998932897468348, 'auprc': 0.9963800819352114, 'loss_val': 0.4047891661742595, 'psi': 0.8184880066221855}
[S11] START round=11 head_norm_before_train=1.437688 (no previous merge yet)
[S11] round=11 local utility u=0.322204 metrics={'f1_val': 0.7892502385755524, 'auprc': 0.9966858463444856, 'loss_val': 0.35983189961130735, 'psi': 0.8722244816831257}-{'f1_val': 0.7014095185520394, 'auprc': 0.9974501961445419, 'loss_val': 0.4794877509187912, 'psi': 0.8198257895890404}
[S13] START round=11 head_norm_before_train=1.131203 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=1.000000 metrics={'f1_val': 0.7131602690408223, 'auprc': 0.77610523304495, 'loss_val': 0.7869398562894552, 'psi': 0.7383382546424735}-{'f1_val': 0.3744186655303705, 'auprc': 0.5683020247054981, 'loss_val': 0.9692148606640794, 'psi': 0.4519720092004216}
[S14] START round=11 head_norm_before_train=1.187949 cos_to_last_merge=0.9074 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.907
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.6344469680900204, 'auprc': 0.9498199499482723, 'loss_val': 0.5108962202456061, 'psi': 0.7605961608333212}-{'f1_val': 0.7457490802168782, 'auprc': 0.9991712925749083, 'loss_val': 0.5526427102168341, 'psi': 0.8471179651600903}
[S15] START round=11 head_norm_before_train=1.036224 cos_to_last_merge=0.9934 (last merge round=9)
[S15] round=11 local utility u=0.094198 metrics={'f1_val': 0.6961029617569878, 'auprc': 0.9982398171237511, 'loss_val': 0.5670471046582419, 'psi': 0.816957703903693}-{'f1_val': 0.7017648309669897, 'auprc': 0.9822019976678298, 'loss_val': 0.741300312298346, 'psi': 0.8139396976473257}
[S16] START round=11 head_norm_before_train=1.141087 cos_to_last_merge=0.8966 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.897
[S16] round=11 local utility u=0.126487 metrics={'f1_val': 0.43674626892334123, 'auprc': 0.7519871112974714, 'loss_val': 0.6853143361969238, 'psi': 0.5628426058729933}-{'f1_val': 0.405464151747156, 'auprc': 0.7486937077303937, 'loss_val': 0.7407163087197471, 'psi': 0.5427559741404511}
[S17] START round=11 head_norm_before_train=0.834222 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.136031 metrics={'f1_val': 0.3723089407878861, 'auprc': 0.8566235687446102, 'loss_val': 0.9572337793615583, 'psi': 0.5660347919705757}-{'f1_val': 0.35302995561043005, 'auprc': 0.8133426362143721, 'loss_val': 0.9837785832243792, 'psi': 0.5371550278520069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:42010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:42004
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] cosine check vs S6: cos=-0.1563
[S11] DROPPED delta from S6 (cos=-0.1563 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=-0.0245
[S9] DROPPED delta from S3 (cos=-0.0245 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S15
[S11] cosine check vs S15: cos=-0.1069
[S11] DROPPED delta from S15 (cos=-0.1069 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1805) from S16
[S17] cosine check vs S16: cos=0.2229
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] cosine check vs S9: cos=0.7626
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=-0.0415
[S16] DROPPED delta from S5 (cos=-0.0415 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.5672
[S4] RECEIVED delta(kind=head bytes=1795) from S13
[S4] cosine check vs S13: cos=-0.0164
[S4] DROPPED delta from S13 (cos=-0.0164 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1804) from S10
[S3] cosine check vs S10: cos=0.9609
[S13] RECEIVED delta(kind=head bytes=1796) from S11
[S13] cosine check vs S11: cos=-0.0964
[S13] DROPPED delta from S11 (cos=-0.0964 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=-0.1164
[S14] DROPPED delta from S7 (cos=-0.1164 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=-0.0982
[S3] DROPPED delta from S17 (cos=-0.0982 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.7007 head_norm=1.236983
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.752651e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.7007 head_norm=1.237885 delta_norm=0.175265
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3723 head_norm=0.877879
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.126557e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3521 head_norm=0.810218 delta_norm=0.212656
[S17] aggregate: ROLLBACK (f1_val pre=0.372 post=0.352 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.232255 cos_to_last_merge=0.8708 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.871
[S2] round=12 local utility u=0.033192 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6618451474644949, 'loss_val': 0.40057074696663975, 'psi': 0.685680694408947}-{'f1_val': 0.7013938903161618, 'auprc': 0.6635450183098577, 'loss_val': 0.47099161912413556, 'psi': 0.6862543415136402}
[S3] START round=12 head_norm_before_train=1.237885 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.018179 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9980054988960695, 'loss_val': 0.3599425582754184, 'psi': 0.8196107753576287}-{'f1_val': 0.7006809596653347, 'auprc': 0.9976949108055123, 'loss_val': 0.39536888247453783, 'psi': 0.8194865401214058}
[S4] START round=12 head_norm_before_train=1.312577 cos_to_last_merge=0.8627 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.863
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.6686910199121354, 'auprc': 0.6606456530312421, 'loss_val': 0.4329667516315963, 'psi': 0.6654728731597781}-{'f1_val': 0.6758164093507885, 'auprc': 0.6606283455193498, 'loss_val': 0.4307350830704311, 'psi': 0.669741183818213}
[S5] START round=12 head_norm_before_train=1.641326 (no previous merge yet)
[S5] round=12 local utility u=0.857525 metrics={'f1_val': 0.9926851108319906, 'auprc': 0.9977732641317855, 'loss_val': 0.17595204798545472, 'psi': 0.9947203721519086}-{'f1_val': 0.7112348455757793, 'auprc': 0.9977842281577168, 'loss_val': 0.20233258400834178, 'psi': 0.8258545986085544}
[S6] START round=12 head_norm_before_train=1.429525 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.41588308903900795, 'auprc': 0.7798000477149902, 'loss_val': 0.7112433161548406, 'psi': 0.5614498725094008}-{'f1_val': 0.7098091106032804, 'auprc': 0.9633566273278753, 'loss_val': 0.46950489189590694, 'psi': 0.8112281172931184}
[S7] START round=12 head_norm_before_train=1.553181 (no previous merge yet)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.6551187900840476, 'auprc': 0.7875245747967015, 'loss_val': 0.5551171268523117, 'psi': 0.7080811039691092}-{'f1_val': 0.6804051284469534, 'auprc': 0.7990222264953434, 'loss_val': 0.5589527943248973, 'psi': 0.7278519676663093}
[S8] START round=12 head_norm_before_train=1.274438 cos_to_last_merge=0.8830 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.883
[S8] round=12 local utility u=0.891198 metrics={'f1_val': 0.9948584086455744, 'auprc': 0.9976950393697289, 'loss_val': 0.21026514102099556, 'psi': 0.9959930609352362}-{'f1_val': 0.7142391053978291, 'auprc': 0.9957976263366097, 'loss_val': 0.30325349868773277, 'psi': 0.8268625137733414}
[S9] START round=12 head_norm_before_train=1.604508 cos_to_last_merge=0.8642 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.864
[S9] round=12 local utility u=0.001546 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9944421981469391, 'loss_val': 0.03279915042137024, 'psi': 0.9960386267660614}-{'f1_val': 0.9966605118138915, 'auprc': 0.996272345360433, 'loss_val': 0.038728027994290086, 'psi': 0.996505245232508}
[S10] START round=12 head_norm_before_train=1.263340 cos_to_last_merge=0.8720 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.872
[S10] round=12 local utility u=0.807527 metrics={'f1_val': 0.9546063900006218, 'auprc': 0.9976582271645799, 'loss_val': 0.24600407496747576, 'psi': 0.9718271248662049}-{'f1_val': 0.6984413351386141, 'auprc': 0.9946600553695566, 'loss_val': 0.3150742207129488, 'psi': 0.816928823230991}
[S11] START round=12 head_norm_before_train=1.477301 (no previous merge yet)
[S11] round=12 local utility u=0.537033 metrics={'f1_val': 0.9559560007695084, 'auprc': 0.9981392086160943, 'loss_val': 0.2903607896256, 'psi': 0.9728292839081427}-{'f1_val': 0.7892502385755524, 'auprc': 0.9966858463444856, 'loss_val': 0.35983189961130735, 'psi': 0.8722244816831257}
[S13] START round=12 head_norm_before_train=1.156585 cos_to_last_merge=0.9981 (last merge round=10)
[S13] round=12 local utility u=0.038080 metrics={'f1_val': 0.7132262943575028, 'auprc': 0.763008685616068, 'loss_val': 0.6718854572461963, 'psi': 0.7331392508609289}-{'f1_val': 0.7131602690408223, 'auprc': 0.77610523304495, 'loss_val': 0.7869398562894552, 'psi': 0.7383382546424735}
[S14] START round=12 head_norm_before_train=1.233188 cos_to_last_merge=0.8974 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.897
[S14] round=12 local utility u=1.000000 metrics={'f1_val': 0.9302569445337014, 'auprc': 0.9975480271496985, 'loss_val': 0.41644069837753594, 'psi': 0.9571733775801003}-{'f1_val': 0.6344469680900204, 'auprc': 0.9498199499482723, 'loss_val': 0.5108962202456061, 'psi': 0.7605961608333212}
[S15] START round=12 head_norm_before_train=1.086877 cos_to_last_merge=0.9776 (last merge round=9)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.7013484921390984, 'auprc': 0.6468549044919161, 'loss_val': 0.5258294792406184, 'psi': 0.6795510570802255}-{'f1_val': 0.6961029617569878, 'auprc': 0.9982398171237511, 'loss_val': 0.5670471046582419, 'psi': 0.816957703903693}
[S16] START round=12 head_norm_before_train=1.185825 cos_to_last_merge=0.8843 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.884
[S16] round=12 local utility u=0.423534 metrics={'f1_val': 0.5581916058137473, 'auprc': 0.7803832634419474, 'loss_val': 0.6521066692927019, 'psi': 0.6470682688650273}-{'f1_val': 0.43674626892334123, 'auprc': 0.7519871112974714, 'loss_val': 0.6853143361969238, 'psi': 0.5628426058729933}
[S17] START round=12 head_norm_before_train=0.810218 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.35332541874877144, 'auprc': 0.8271600169023445, 'loss_val': 0.9491612201988621, 'psi': 0.5428592580102007}-{'f1_val': 0.3723089407878861, 'auprc': 0.8566235687446102, 'loss_val': 0.9572337793615583, 'psi': 0.5660347919705757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:42013
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:42010
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] cosine check vs S9: cos=0.7157
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] cosine check vs S2: cos=0.9759
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=-0.0438
[S16] DROPPED delta from S5 (cos=-0.0438 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.5528
[S3] RECEIVED delta(kind=head bytes=1803) from S10
[S3] cosine check vs S10: cos=0.9675
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:42013
[S13] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S13
[S4] cosine check vs S13: cos=-0.0136
[S4] DROPPED delta from S13 (cos=-0.0136 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=-0.0939
[S13] DROPPED delta from S11 (cos=-0.0939 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:42015
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S14
[S15] cosine check vs S14: cos=0.8813
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] → sending delta(kind=head bytes=1807) to S17@127.0.0.1:42017
[S3] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S3
[S9] cosine check vs S3: cos=-0.0300
[S9] DROPPED delta from S3 (cos=-0.0300 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1807) from S16
[S17] cosine check vs S16: cos=0.3846
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.7007 head_norm=1.301815
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.666646e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.7007 head_norm=1.296478 delta_norm=0.166665
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.7132 head_norm=1.189933
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.425630e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.7132 head_norm=1.227343 delta_norm=0.142563
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.7013 head_norm=1.139394
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.999858e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.7013 head_norm=1.167833 delta_norm=0.299986
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3533 head_norm=0.852483
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.559250e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3532 head_norm=0.822046 delta_norm=0.155925
[S17] aggregate: ACCEPT kept=['S9', 'S8', 'S16'] (k=3/3) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.279629 cos_to_last_merge=0.8600 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.860
[S2] round=13 local utility u=0.054264 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.6792111471628735, 'loss_val': 0.3436644096918516, 'psi': 0.6925795486034569}-{'f1_val': 0.7015710590385817, 'auprc': 0.6618451474644949, 'loss_val': 0.40057074696663975, 'psi': 0.685680694408947}
[S3] START round=13 head_norm_before_train=1.296478 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.015251 metrics={'f1_val': 0.7010108237857944, 'auprc': 0.9990124885210828, 'loss_val': 0.3344407741061471, 'psi': 0.8202114896799098}-{'f1_val': 0.7006809596653347, 'auprc': 0.9980054988960695, 'loss_val': 0.3599425582754184, 'psi': 0.8196107753576287}
[S4] START round=13 head_norm_before_train=1.364709 cos_to_last_merge=0.8481 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.848
[S4] round=13 local utility u=0.264062 metrics={'f1_val': 0.6674501589407289, 'auprc': 0.8547323182555167, 'loss_val': 0.4796574917938174, 'psi': 0.742363022666644}-{'f1_val': 0.6686910199121354, 'auprc': 0.6606456530312421, 'loss_val': 0.4329667516315963, 'psi': 0.6654728731597781}
[S5] START round=13 head_norm_before_train=1.661547 (no previous merge yet)
[S5] round=13 local utility u=0.007679 metrics={'f1_val': 0.991180867805401, 'auprc': 0.997786552429434, 'loss_val': 0.1516078236252841, 'psi': 0.9938231416550143}-{'f1_val': 0.9926851108319906, 'auprc': 0.9977732641317855, 'loss_val': 0.17595204798545472, 'psi': 0.9947203721519086}
[S6] START round=13 head_norm_before_train=1.474115 (no previous merge yet)
[S6] round=13 local utility u=0.883978 metrics={'f1_val': 0.6019972116904874, 'auprc': 0.9269432224897973, 'loss_val': 0.5014018233347949, 'psi': 0.7319756160102113}-{'f1_val': 0.41588308903900795, 'auprc': 0.7798000477149902, 'loss_val': 0.7112433161548406, 'psi': 0.5614498725094008}
[S7] START round=13 head_norm_before_train=1.573451 (no previous merge yet)
[S7] round=13 local utility u=0.529586 metrics={'f1_val': 0.6994980260379424, 'auprc': 0.9779930859563308, 'loss_val': 0.33362688643738864, 'psi': 0.8108960500052977}-{'f1_val': 0.6551187900840476, 'auprc': 0.7875245747967015, 'loss_val': 0.5551171268523117, 'psi': 0.7080811039691092}
[S8] START round=13 head_norm_before_train=1.316563 cos_to_last_merge=0.8704 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.870
[S8] round=13 local utility u=0.001146 metrics={'f1_val': 0.9937777583442691, 'auprc': 0.9900419269658358, 'loss_val': 0.17852980160473797, 'psi': 0.9922834257928957}-{'f1_val': 0.9948584086455744, 'auprc': 0.9976950393697289, 'loss_val': 0.21026514102099556, 'psi': 0.9959930609352362}
[S9] START round=13 head_norm_before_train=1.642203 cos_to_last_merge=0.8582 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.858
[S9] round=13 local utility u=0.005479 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9967261480856366, 'loss_val': 0.028693298026235353, 'psi': 0.9969522067415404}-{'f1_val': 0.9971029125121428, 'auprc': 0.9944421981469391, 'loss_val': 0.03279915042137024, 'psi': 0.9960386267660614}
[S10] START round=13 head_norm_before_train=1.312456 cos_to_last_merge=0.8606 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.861
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.7972712848278857, 'auprc': 0.957847808045456, 'loss_val': 0.38996638045806764, 'psi': 0.8615018941149138}-{'f1_val': 0.9546063900006218, 'auprc': 0.9976582271645799, 'loss_val': 0.24600407496747576, 'psi': 0.9718271248662049}
[S11] START round=13 head_norm_before_train=1.519710 (no previous merge yet)
[S11] round=13 local utility u=0.041030 metrics={'f1_val': 0.9575857740575427, 'auprc': 0.9981825860916582, 'loss_val': 0.21820932699968407, 'psi': 0.9738244988711889}-{'f1_val': 0.9559560007695084, 'auprc': 0.9981392086160943, 'loss_val': 0.2903607896256, 'psi': 0.9728292839081427}
[S13] START round=13 head_norm_before_train=1.227343 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6814513609209951, 'auprc': 0.7583596624467476, 'loss_val': 0.662912511958645, 'psi': 0.7122146815312961}-{'f1_val': 0.7132262943575028, 'auprc': 0.763008685616068, 'loss_val': 0.6718854572461963, 'psi': 0.7331392508609289}
[S14] START round=13 head_norm_before_train=1.268634 cos_to_last_merge=0.8895 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.889
[S14] round=13 local utility u=0.252380 metrics={'f1_val': 0.9968417501632585, 'auprc': 0.997372910054618, 'loss_val': 0.31066325879576634, 'psi': 0.9970542141198023}-{'f1_val': 0.9302569445337014, 'auprc': 0.9975480271496985, 'loss_val': 0.41644069837753594, 'psi': 0.9571733775801003}
[S15] START round=13 head_norm_before_train=1.167833 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=1.000000 metrics={'f1_val': 0.9919720011977874, 'auprc': 0.9980938631676922, 'loss_val': 0.418567855306496, 'psi': 0.9944207459857493}-{'f1_val': 0.7013484921390984, 'auprc': 0.6468549044919161, 'loss_val': 0.5258294792406184, 'psi': 0.6795510570802255}
[S16] START round=13 head_norm_before_train=1.232404 cos_to_last_merge=0.8739 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.874
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.48778652244216714, 'auprc': 0.7848091802211714, 'loss_val': 0.627818684423152, 'psi': 0.6065955855537688}-{'f1_val': 0.5581916058137473, 'auprc': 0.7803832634419474, 'loss_val': 0.6521066692927019, 'psi': 0.6470682688650273}
[S17] START round=13 head_norm_before_train=0.822046 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.249272 metrics={'f1_val': 0.3838475949968764, 'auprc': 0.8956441957483862, 'loss_val': 0.8392024604805215, 'psi': 0.5885662352974803}-{'f1_val': 0.35332541874877144, 'auprc': 0.8271600169023445, 'loss_val': 0.9491612201988621, 'psi': 0.5428592580102007}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:42012
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:42010
[S2] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S2
[S13] cosine check vs S2: cos=0.9864
[S10] RECEIVED delta(kind=head bytes=1804) from S4
[S10] cosine check vs S4: cos=-0.0583
[S10] DROPPED delta from S4 (cos=-0.0583 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] cosine check vs S9: cos=0.6849
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.5394
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] cosine check vs S14: cos=0.9567
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=-0.1244
[S14] DROPPED delta from S7 (cos=-0.1244 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] cosine check vs S11: cos=-0.1007
[S13] DROPPED delta from S11 (cos=-0.1007 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S15
[S11] cosine check vs S15: cos=-0.1181
[S11] DROPPED delta from S15 (cos=-0.1181 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S6
[S11] cosine check vs S6: cos=-0.1604
[S11] DROPPED delta from S6 (cos=-0.1604 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=-0.0981
[S3] DROPPED delta from S17 (cos=-0.0981 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:42016
[S3] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S3
[S9] cosine check vs S3: cos=-0.0332
[S9] DROPPED delta from S3 (cos=-0.0332 < 0.0)
[S5] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=-0.0453
[S16] DROPPED delta from S5 (cos=-0.0453 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.6815 head_norm=1.261460
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.113431e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.6916 head_norm=1.288824 delta_norm=0.111343
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.9920 head_norm=1.209629
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.901462e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.9926 head_norm=1.241832 delta_norm=0.190146
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3838 head_norm=0.862851
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.810508e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3843 head_norm=0.942593 delta_norm=0.281051
[S17] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.325009 cos_to_last_merge=0.8503 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.850
[S2] round=14 local utility u=0.041670 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.7034819958089806, 'loss_val': 0.3331360134207695, 'psi': 0.7022878880618998}-{'f1_val': 0.7014918162305126, 'auprc': 0.6792111471628735, 'loss_val': 0.3436644096918516, 'psi': 0.6925795486034569}
[S3] START round=14 head_norm_before_train=1.359867 cos_to_last_merge=0.9949 (last merge round=12)
[S3] round=14 local utility u=0.022812 metrics={'f1_val': 0.7005014381049806, 'auprc': 0.997953300751961, 'loss_val': 0.2825820697058525, 'psi': 0.8194821831637727}-{'f1_val': 0.7010108237857944, 'auprc': 0.9990124885210828, 'loss_val': 0.3344407741061471, 'psi': 0.8202114896799098}
[S4] START round=14 head_norm_before_train=1.408384 cos_to_last_merge=0.8363 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.836
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.6660049374502517, 'auprc': 0.858208352038202, 'loss_val': 0.48458098561870455, 'psi': 0.7428863032854318}-{'f1_val': 0.6674501589407289, 'auprc': 0.8547323182555167, 'loss_val': 0.4796574917938174, 'psi': 0.742363022666644}
[S5] START round=14 head_norm_before_train=1.685142 (no previous merge yet)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.8642580224527998, 'auprc': 0.9946045444218712, 'loss_val': 0.15783674439999623, 'psi': 0.9163966312404284}-{'f1_val': 0.991180867805401, 'auprc': 0.997786552429434, 'loss_val': 0.1516078236252841, 'psi': 0.9938231416550143}
[S6] START round=14 head_norm_before_train=1.505251 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.404653371320038, 'auprc': 0.6932886078621272, 'loss_val': 0.8671420416701621, 'psi': 0.5201074659368736}-{'f1_val': 0.6019972116904874, 'auprc': 0.9269432224897973, 'loss_val': 0.5014018233347949, 'psi': 0.7319756160102113}
[S7] START round=14 head_norm_before_train=1.590454 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.5740214445545091, 'auprc': 0.7815817873770711, 'loss_val': 0.6943577885829743, 'psi': 0.6570455816835339}-{'f1_val': 0.6994980260379424, 'auprc': 0.9779930859563308, 'loss_val': 0.33362688643738864, 'psi': 0.8108960500052977}
[S8] START round=14 head_norm_before_train=1.356555 cos_to_last_merge=0.8584 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.858
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7948299317982787, 'auprc': 0.993627158765885, 'loss_val': 0.19786066817120207, 'psi': 0.8743488225853212}-{'f1_val': 0.9937777583442691, 'auprc': 0.9900419269658358, 'loss_val': 0.17852980160473797, 'psi': 0.9922834257928957}
[S9] START round=14 head_norm_before_train=1.671085 cos_to_last_merge=0.8545 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.855
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.9993723272977015, 'loss_val': 0.02708935049493057, 'psi': 0.9969954236722176}-{'f1_val': 0.9971029125121428, 'auprc': 0.9967261480856366, 'loss_val': 0.028693298026235353, 'psi': 0.9969522067415404}
[S10] START round=14 head_norm_before_train=1.354005 cos_to_last_merge=0.8519 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.852
[S10] round=14 local utility u=0.378114 metrics={'f1_val': 0.8733745822808757, 'auprc': 0.99691339723186, 'loss_val': 0.20755523380774604, 'psi': 0.9227901082612694}-{'f1_val': 0.7972712848278857, 'auprc': 0.957847808045456, 'loss_val': 0.38996638045806764, 'psi': 0.8615018941149138}
[S11] START round=14 head_norm_before_train=1.562956 (no previous merge yet)
[S11] round=14 local utility u=0.013571 metrics={'f1_val': 0.9602221375407527, 'auprc': 0.9985460732614762, 'loss_val': 0.20797540363553507, 'psi': 0.9755517118290421}-{'f1_val': 0.9575857740575427, 'auprc': 0.9981825860916582, 'loss_val': 0.21820932699968407, 'psi': 0.9738244988711889}
[S13] START round=14 head_norm_before_train=1.288824 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.032044 metrics={'f1_val': 0.6995036019002208, 'auprc': 0.7292464977671325, 'loss_val': 0.6197985413999777, 'psi': 0.7114007602469854}-{'f1_val': 0.6814513609209951, 'auprc': 0.7583596624467476, 'loss_val': 0.662912511958645, 'psi': 0.7122146815312961}
[S14] START round=14 head_norm_before_train=1.301309 cos_to_last_merge=0.8827 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.883
[S14] round=14 local utility u=0.047618 metrics={'f1_val': 0.9977416434963992, 'auprc': 0.9974727418047566, 'loss_val': 0.2211257902403217, 'psi': 0.9976340828197421}-{'f1_val': 0.9968417501632585, 'auprc': 0.997372910054618, 'loss_val': 0.31066325879576634, 'psi': 0.9970542141198023}
[S15] START round=14 head_norm_before_train=1.241832 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.7014343247357921, 'auprc': 0.9881266290003436, 'loss_val': 0.4182946129779412, 'psi': 0.8161112464416127}-{'f1_val': 0.9919720011977874, 'auprc': 0.9980938631676922, 'loss_val': 0.418567855306496, 'psi': 0.9944207459857493}
[S16] START round=14 head_norm_before_train=1.280717 cos_to_last_merge=0.8646 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.865
[S16] round=14 local utility u=0.217330 metrics={'f1_val': 0.5543709581551954, 'auprc': 0.8153385361441015, 'loss_val': 0.6842529912666687, 'psi': 0.6587579893507578}-{'f1_val': 0.48778652244216714, 'auprc': 0.7848091802211714, 'loss_val': 0.627818684423152, 'psi': 0.6065955855537688}
[S17] START round=14 head_norm_before_train=0.942593 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.020454 metrics={'f1_val': 0.389297715881587, 'auprc': 0.8764199833565722, 'loss_val': 0.7733226148066173, 'psi': 0.584146622871581}-{'f1_val': 0.3838475949968764, 'auprc': 0.8956441957483862, 'loss_val': 0.8392024604805215, 'psi': 0.5885662352974803}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:42003
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:42010
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:42013
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:42017
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1804) from S13
[S4] cosine check vs S13: cos=-0.0139
[S4] DROPPED delta from S13 (cos=-0.0139 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.9795
[S13] RECEIVED delta(kind=head bytes=1802) from S11
[S13] cosine check vs S11: cos=-0.1067
[S13] DROPPED delta from S11 (cos=-0.1067 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S2
[S13] cosine check vs S2: cos=0.9914
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=-0.0426
[S9] DROPPED delta from S3 (cos=-0.0426 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1805) from S16
[S17] cosine check vs S16: cos=0.2232
[S3] RECEIVED delta(kind=head bytes=1801) from S10
[S3] cosine check vs S10: cos=0.9550
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S17
[S3] cosine check vs S17: cos=-0.1086
[S3] DROPPED delta from S17 (cos=-0.1086 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.7005 head_norm=1.417179
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.110868e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.7004 head_norm=1.388099 delta_norm=0.211087
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.6995 head_norm=1.315991
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.203258e-02
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.7016 head_norm=1.339786 delta_norm=0.092033
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.7014 head_norm=1.276686
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.362633e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.9055 head_norm=1.302328 delta_norm=0.136263
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3893 head_norm=0.984231
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.320268e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3893 head_norm=0.909435 delta_norm=0.732027
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.369365 cos_to_last_merge=0.8419 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.842
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.701230889339113, 'auprc': 0.691516202253519, 'loss_val': 0.3058554872574071, 'psi': 0.6973450145048754}-{'f1_val': 0.7014918162305126, 'auprc': 0.7034819958089806, 'loss_val': 0.3331360134207695, 'psi': 0.7022878880618998}
[S3] START round=15 head_norm_before_train=1.388099 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.004758 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9981665856746234, 'loss_val': 0.2752351990592787, 'psi': 0.8197203565110291}-{'f1_val': 0.7005014381049806, 'auprc': 0.997953300751961, 'loss_val': 0.2825820697058525, 'psi': 0.8194821831637727}
[S4] START round=15 head_norm_before_train=1.443562 cos_to_last_merge=0.8287 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.829
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.624589528989788, 'auprc': 0.9270391697252016, 'loss_val': 0.4770271815118921, 'psi': 0.7455693852839536}-{'f1_val': 0.6660049374502517, 'auprc': 0.858208352038202, 'loss_val': 0.48458098561870455, 'psi': 0.7428863032854318}
[S5] START round=15 head_norm_before_train=1.702469 (no previous merge yet)
[S5] round=15 local utility u=0.285485 metrics={'f1_val': 0.9560848134015029, 'auprc': 0.9946028821691736, 'loss_val': 0.13782201236831623, 'psi': 0.9714920409085712}-{'f1_val': 0.8642580224527998, 'auprc': 0.9946045444218712, 'loss_val': 0.15783674439999623, 'psi': 0.9163966312404284}
[S6] START round=15 head_norm_before_train=1.528176 (no previous merge yet)
[S6] round=15 local utility u=1.000000 metrics={'f1_val': 0.7077380463841179, 'auprc': 0.9600230894785584, 'loss_val': 0.3298679225029684, 'psi': 0.8086520636218941}-{'f1_val': 0.404653371320038, 'auprc': 0.6932886078621272, 'loss_val': 0.8671420416701621, 'psi': 0.5201074659368736}
[S7] START round=15 head_norm_before_train=1.609121 (no previous merge yet)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.44109815431301247, 'auprc': 0.7796710502420489, 'loss_val': 1.004777648990421, 'psi': 0.5765273126846271}-{'f1_val': 0.5740214445545091, 'auprc': 0.7815817873770711, 'loss_val': 0.6943577885829743, 'psi': 0.6570455816835339}
[S8] START round=15 head_norm_before_train=1.392674 cos_to_last_merge=0.8486 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.849
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.7754204109564474, 'auprc': 0.9920314882561814, 'loss_val': 0.1852547365777524, 'psi': 0.862064841876341}-{'f1_val': 0.7948299317982787, 'auprc': 0.993627158765885, 'loss_val': 0.19786066817120207, 'psi': 0.8743488225853212}
[S9] START round=15 head_norm_before_train=1.695177 cos_to_last_merge=0.8519 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.852
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.990399656971262, 'auprc': 0.9996071160848035, 'loss_val': 0.03803514676987237, 'psi': 0.9940826406166786}-{'f1_val': 0.9954108212552283, 'auprc': 0.9993723272977015, 'loss_val': 0.02708935049493057, 'psi': 0.9969954236722176}
[S10] START round=15 head_norm_before_train=1.390811 cos_to_last_merge=0.8449 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.845
[S10] round=15 local utility u=0.383665 metrics={'f1_val': 0.9945588208961169, 'auprc': 0.9955350225990555, 'loss_val': 0.16319488049803368, 'psi': 0.9949493015772923}-{'f1_val': 0.8733745822808757, 'auprc': 0.99691339723186, 'loss_val': 0.20755523380774604, 'psi': 0.9227901082612694}
[S11] START round=15 head_norm_before_train=1.601961 (no previous merge yet)
[S11] round=15 local utility u=0.133834 metrics={'f1_val': 0.9971537809852418, 'auprc': 0.9984342470790708, 'loss_val': 0.16156120359124615, 'psi': 0.9976659674227734}-{'f1_val': 0.9602221375407527, 'auprc': 0.9985460732614762, 'loss_val': 0.20797540363553507, 'psi': 0.9755517118290421}
[S13] START round=15 head_norm_before_train=1.339786 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6058353194524617, 'auprc': 0.7050598131471559, 'loss_val': 0.6615823867097899, 'psi': 0.6455251169303394}-{'f1_val': 0.6995036019002208, 'auprc': 0.7292464977671325, 'loss_val': 0.6197985413999777, 'psi': 0.7114007602469854}
[S14] START round=15 head_norm_before_train=1.341389 cos_to_last_merge=0.8757 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.876
[S14] round=15 local utility u=0.021101 metrics={'f1_val': 0.9975740214689254, 'auprc': 0.999008871671555, 'loss_val': 0.18252705908342096, 'psi': 0.9981479615499772}-{'f1_val': 0.9977416434963992, 'auprc': 0.9974727418047566, 'loss_val': 0.2211257902403217, 'psi': 0.9976340828197421}
[S15] START round=15 head_norm_before_train=1.302328 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.240904 metrics={'f1_val': 0.77322014004256, 'auprc': 0.9941810046184414, 'loss_val': 0.3853655031853206, 'psi': 0.8616044858729126}-{'f1_val': 0.7014343247357921, 'auprc': 0.9881266290003436, 'loss_val': 0.4182946129779412, 'psi': 0.8161112464416127}
[S16] START round=15 head_norm_before_train=1.325579 cos_to_last_merge=0.8567 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.857
[S16] round=15 local utility u=1.000000 metrics={'f1_val': 0.841451044177303, 'auprc': 0.9181975688375956, 'loss_val': 0.505147555535146, 'psi': 0.8721496540414201}-{'f1_val': 0.5543709581551954, 'auprc': 0.8153385361441015, 'loss_val': 0.6842529912666687, 'psi': 0.6587579893507578}
[S17] START round=15 head_norm_before_train=0.909435 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.38925608737168776, 'auprc': 0.7398977147905984, 'loss_val': 0.822711158709588, 'psi': 0.529512738339252}-{'f1_val': 0.389297715881587, 'auprc': 0.8764199833565722, 'loss_val': 0.7733226148066173, 'psi': 0.584146622871581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:42013
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:42010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:42015
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:42016
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S10
[S3] cosine check vs S10: cos=0.9758
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] cosine check vs S5: cos=-0.0502
[S16] DROPPED delta from S5 (cos=-0.0502 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] cosine check vs S14: cos=0.9870
[S13] RECEIVED delta(kind=head bytes=1805) from S11
[S13] cosine check vs S11: cos=-0.1138
[S13] DROPPED delta from S11 (cos=-0.1138 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1804) from S15
[S11] cosine check vs S15: cos=-0.1214
[S11] DROPPED delta from S15 (cos=-0.1214 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] cosine check vs S6: cos=-0.1650
[S11] DROPPED delta from S6 (cos=-0.1650 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1804) from S3
[S9] cosine check vs S3: cos=-0.0378
[S9] DROPPED delta from S3 (cos=-0.0378 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S16
[S17] cosine check vs S16: cos=0.8189
[S5] ⇄ pheromone p=0.231 → S16@127.0.0.1:42016
[S7] ⇄ pheromone p=0.222 → S14@127.0.0.1:42014
[S10] ⇄ pheromone p=0.363 → S3@127.0.0.1:42003
[S9] ⇄ pheromone p=0.116 → S17@127.0.0.1:42017
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.7008 head_norm=1.440325
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.575242e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.7008 head_norm=1.421212 delta_norm=0.157524
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.098 → S9@127.0.0.1:42010
[S8] ⇄ pheromone p=0.227 → S17@127.0.0.1:42017
[S13] ⇄ pheromone p=0.158 → S4@127.0.0.1:42004
[S4] ⇄ pheromone p=0.146 → S10@127.0.0.1:42011
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.7732 head_norm=1.336592
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.108149e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.8591 head_norm=1.351280 delta_norm=0.110815
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.314 → S11@127.0.0.1:42012
[S11] ⇄ pheromone p=0.257 → S13@127.0.0.1:42013
[S14] ⇄ pheromone p=0.280 → S15@127.0.0.1:42015
[S6] ⇄ pheromone p=0.475 → S11@127.0.0.1:42012
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3893 head_norm=0.940045
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.014482e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3893 head_norm=1.100660 delta_norm=0.401448
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.121 → S3@127.0.0.1:42003
[S16] ⇄ pheromone p=0.352 → S17@127.0.0.1:42017
[S2] ⇄ pheromone p=0.110 → S13@127.0.0.1:42013
[S2] START round=16 head_norm_before_train=1.407966 cos_to_last_merge=0.8362 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.836
[S2] round=16 local utility u=0.144584 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.7780802824601064, 'loss_val': 0.27794522047210984, 'psi': 0.7321272027223501}-{'f1_val': 0.701230889339113, 'auprc': 0.691516202253519, 'loss_val': 0.3058554872574071, 'psi': 0.6973450145048754}
[S3] START round=16 head_norm_before_train=1.421212 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.720400 metrics={'f1_val': 0.932299243516838, 'auprc': 0.9968415236177574, 'loss_val': 0.21971843213889272, 'psi': 0.9581161555572058}-{'f1_val': 0.7007562037352997, 'auprc': 0.9981665856746234, 'loss_val': 0.2752351990592787, 'psi': 0.8197203565110291}
[S4] START round=16 head_norm_before_train=1.467207 cos_to_last_merge=0.8248 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.825
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.6199309041135019, 'auprc': 0.6772198354760182, 'loss_val': 0.4842362557086754, 'psi': 0.6428464766585085}-{'f1_val': 0.624589528989788, 'auprc': 0.9270391697252016, 'loss_val': 0.4770271815118921, 'psi': 0.7455693852839536}
[S5] START round=16 head_norm_before_train=1.727101 (no previous merge yet)
[S5] round=16 local utility u=0.145147 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9966340274769001, 'loss_val': 0.0968677478168636, 'psi': 0.9966291564489018}-{'f1_val': 0.9560848134015029, 'auprc': 0.9946028821691736, 'loss_val': 0.13782201236831623, 'psi': 0.9714920409085712}
[S6] START round=16 head_norm_before_train=1.546604 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6409565551740835, 'auprc': 0.8997625114753843, 'loss_val': 0.4183173853612039, 'psi': 0.7444789376946037}-{'f1_val': 0.7077380463841179, 'auprc': 0.9600230894785584, 'loss_val': 0.3298679225029684, 'psi': 0.8086520636218941}
[S7] START round=16 head_norm_before_train=1.629747 (no previous merge yet)
[S7] round=16 local utility u=0.475337 metrics={'f1_val': 0.5546947906449867, 'auprc': 0.782101526644075, 'loss_val': 0.7429748817617134, 'psi': 0.6456574850446221}-{'f1_val': 0.44109815431301247, 'auprc': 0.7796710502420489, 'loss_val': 1.004777648990421, 'psi': 0.5765273126846271}
[S8] START round=16 head_norm_before_train=1.421653 cos_to_last_merge=0.8415 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.842
[S8] round=16 local utility u=0.665883 metrics={'f1_val': 0.9907243993413981, 'auprc': 0.9877444355538111, 'loss_val': 0.13245201230794984, 'psi': 0.9895324138263634}-{'f1_val': 0.7754204109564474, 'auprc': 0.9920314882561814, 'loss_val': 0.1852547365777524, 'psi': 0.862064841876341}
[S9] START round=16 head_norm_before_train=1.714864 cos_to_last_merge=0.8496 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.850
[S9] round=16 local utility u=0.016955 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9941310370601848, 'loss_val': 0.025453083878129616, 'psi': 0.9956679095829313}-{'f1_val': 0.990399656971262, 'auprc': 0.9996071160848035, 'loss_val': 0.03803514676987237, 'psi': 0.9940826406166786}
[S10] START round=16 head_norm_before_train=1.419429 cos_to_last_merge=0.8397 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.840
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9947781979029806, 'auprc': 0.993414154742077, 'loss_val': 0.1759994081886767, 'psi': 0.9942325806386192}-{'f1_val': 0.9945588208961169, 'auprc': 0.9955350225990555, 'loss_val': 0.16319488049803368, 'psi': 0.9949493015772923}
[S11] START round=16 head_norm_before_train=1.638224 (no previous merge yet)
[S11] round=16 local utility u=0.012199 metrics={'f1_val': 0.9969812955738739, 'auprc': 0.9984718030715505, 'loss_val': 0.13624029229291984, 'psi': 0.9975774985729445}-{'f1_val': 0.9971537809852418, 'auprc': 0.9984342470790708, 'loss_val': 0.16156120359124615, 'psi': 0.9976659674227734}
[S13] START round=16 head_norm_before_train=1.362290 cos_to_last_merge=0.9994 (last merge round=14)
[S13] round=16 local utility u=0.332396 metrics={'f1_val': 0.7012797604023846, 'auprc': 0.6786688799831324, 'loss_val': 0.49028435031289946, 'psi': 0.6922354082346838}-{'f1_val': 0.6058353194524617, 'auprc': 0.7050598131471559, 'loss_val': 0.6615823867097899, 'psi': 0.6455251169303394}
[S14] START round=16 head_norm_before_train=1.374771 cos_to_last_merge=0.8704 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.870
[S14] round=16 local utility u=0.010838 metrics={'f1_val': 0.997266076999405, 'auprc': 0.9958169917328061, 'loss_val': 0.14942718489570428, 'psi': 0.9966864428927655}-{'f1_val': 0.9975740214689254, 'auprc': 0.999008871671555, 'loss_val': 0.18252705908342096, 'psi': 0.9981479615499772}
[S15] START round=16 head_norm_before_train=1.351280 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.701196517572327, 'auprc': 0.9847281224406226, 'loss_val': 0.39850796189001453, 'psi': 0.8146091595196452}-{'f1_val': 0.77322014004256, 'auprc': 0.9941810046184414, 'loss_val': 0.3853655031853206, 'psi': 0.8616044858729126}
[S16] START round=16 head_norm_before_train=1.364384 cos_to_last_merge=0.8505 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.850
[S16] round=16 local utility u=0.104553 metrics={'f1_val': 0.8409212755758683, 'auprc': 0.9376666503718841, 'loss_val': 0.35126933256962645, 'psi': 0.8796194254942746}-{'f1_val': 0.841451044177303, 'auprc': 0.9181975688375956, 'loss_val': 0.505147555535146, 'psi': 0.8721496540414201}
[S17] START round=16 head_norm_before_train=1.100660 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.38925608737168776, 'auprc': 0.6440696605951908, 'loss_val': 0.8462434497383831, 'psi': 0.491181516661089}-{'f1_val': 0.38925608737168776, 'auprc': 0.7398977147905984, 'loss_val': 0.822711158709588, 'psi': 0.529512738339252}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:42013
[S7] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1807 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] cosine check vs S9: cos=0.2682
[S17] RECEIVED delta(kind=head bytes=1807) from S8
[S17] cosine check vs S8: cos=0.1275
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=-0.1342
[S14] DROPPED delta from S7 (cos=-0.1342 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=-0.0352
[S9] DROPPED delta from S3 (cos=-0.0352 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S2
[S13] cosine check vs S2: cos=0.9911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:42004
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:42013
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S13
[S4] cosine check vs S13: cos=-0.0189
[S4] DROPPED delta from S13 (cos=-0.0189 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1804) from S11
[S13] cosine check vs S11: cos=-0.1136
[S13] DROPPED delta from S11 (cos=-0.1136 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:42015
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S16
[S17] cosine check vs S16: cos=0.9493
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] cosine check vs S14: cos=0.9905
[S5] sending update (kind=head size=1790 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1790) from S5
[S16] cosine check vs S5: cos=-0.0513
[S16] DROPPED delta from S5 (cos=-0.0513 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.7013 head_norm=1.380160
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.906185e-02
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.7017 head_norm=1.407548 delta_norm=0.099062
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.7012 head_norm=1.385466
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.713731e-02
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.7013 head_norm=1.393281 delta_norm=0.097137
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.3893 head_norm=1.120240
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.627516e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.3893 head_norm=0.949368 delta_norm=0.362752
[S17] aggregate: ACCEPT kept=['S9', 'S8', 'S16'] (k=3/3) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.441238 cos_to_last_merge=0.8323 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.832
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.701230889339113, 'auprc': 0.7490385343694181, 'loss_val': 0.2816390295378443, 'psi': 0.720353947351235}-{'f1_val': 0.7014918162305126, 'auprc': 0.7780802824601064, 'loss_val': 0.27794522047210984, 'psi': 0.7321272027223501}
[S3] START round=17 head_norm_before_train=1.481660 cos_to_last_merge=0.9973 (last merge round=15)
[S3] round=17 local utility u=0.116293 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9969956766857017, 'loss_val': 0.16001193219474746, 'psi': 0.9754194213375469}-{'f1_val': 0.932299243516838, 'auprc': 0.9968415236177574, 'loss_val': 0.21971843213889272, 'psi': 0.9581161555572058}
[S4] START round=17 head_norm_before_train=1.489351 cos_to_last_merge=0.8218 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.822
[S4] round=17 local utility u=0.395993 metrics={'f1_val': 0.6177364050413701, 'auprc': 0.9451078860081995, 'loss_val': 0.4827469575337284, 'psi': 0.7486849974281018}-{'f1_val': 0.6199309041135019, 'auprc': 0.6772198354760182, 'loss_val': 0.4842362557086754, 'psi': 0.6428464766585085}
[S5] START round=17 head_norm_before_train=1.746868 (no previous merge yet)
[S5] round=17 local utility u=0.011370 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9979413070972388, 'loss_val': 0.07804949027383992, 'psi': 0.9971520682970374}-{'f1_val': 0.996625909096903, 'auprc': 0.9966340274769001, 'loss_val': 0.0968677478168636, 'psi': 0.9966291564489018}
[S6] START round=17 head_norm_before_train=1.566856 (no previous merge yet)
[S6] round=17 local utility u=1.000000 metrics={'f1_val': 0.960962682470222, 'auprc': 0.9615772160933155, 'loss_val': 0.25843422587622117, 'psi': 0.9612084959194594}-{'f1_val': 0.6409565551740835, 'auprc': 0.8997625114753843, 'loss_val': 0.4183173853612039, 'psi': 0.7444789376946037}
[S7] START round=17 head_norm_before_train=1.644217 (no previous merge yet)
[S7] round=17 local utility u=0.739575 metrics={'f1_val': 0.698448323217846, 'auprc': 0.8508615504123219, 'loss_val': 0.33262568985244906, 'psi': 0.7594136140956363}-{'f1_val': 0.5546947906449867, 'auprc': 0.782101526644075, 'loss_val': 0.7429748817617134, 'psi': 0.6456574850446221}
[S8] START round=17 head_norm_before_train=1.445731 cos_to_last_merge=0.8363 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.836
[S8] round=17 local utility u=0.026546 metrics={'f1_val': 0.9934667705418724, 'auprc': 0.9924122044682147, 'loss_val': 0.1098173461447618, 'psi': 0.9930449441124094}-{'f1_val': 0.9907243993413981, 'auprc': 0.9877444355538111, 'loss_val': 0.13245201230794984, 'psi': 0.9895324138263634}
[S9] START round=17 head_norm_before_train=1.733148 cos_to_last_merge=0.8478 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.848
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9912134460920485, 'auprc': 0.9996127184522015, 'loss_val': 0.03199655932593511, 'psi': 0.9945731550361097}-{'f1_val': 0.9966924912647621, 'auprc': 0.9941310370601848, 'loss_val': 0.025453083878129616, 'psi': 0.9956679095829313}
[S10] START round=17 head_norm_before_train=1.447936 cos_to_last_merge=0.8351 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.835
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.9465330925375011, 'auprc': 0.9932523685023673, 'loss_val': 0.20448388253422076, 'psi': 0.9652208029234475}-{'f1_val': 0.9947781979029806, 'auprc': 0.993414154742077, 'loss_val': 0.1759994081886767, 'psi': 0.9942325806386192}
[S11] START round=17 head_norm_before_train=1.674711 (no previous merge yet)
[S11] round=17 local utility u=0.010984 metrics={'f1_val': 0.996960829744628, 'auprc': 0.998451295288636, 'loss_val': 0.11408714829060501, 'psi': 0.9975570159622311}-{'f1_val': 0.9969812955738739, 'auprc': 0.9984718030715505, 'loss_val': 0.13624029229291984, 'psi': 0.9975774985729445}
[S13] START round=17 head_norm_before_train=1.407548 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6195257118802989, 'auprc': 0.6468972399689084, 'loss_val': 0.6171786807676989, 'psi': 0.6304743231157427}-{'f1_val': 0.7012797604023846, 'auprc': 0.6786688799831324, 'loss_val': 0.49028435031289946, 'psi': 0.6922354082346838}
[S14] START round=17 head_norm_before_train=1.407770 cos_to_last_merge=0.8657 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.866
[S14] round=17 local utility u=0.015384 metrics={'f1_val': 0.9972657600632533, 'auprc': 0.9955399059984122, 'loss_val': 0.11782637575156306, 'psi': 0.9965754184373168}-{'f1_val': 0.997266076999405, 'auprc': 0.9958169917328061, 'loss_val': 0.14942718489570428, 'psi': 0.9966864428927655}
[S15] START round=17 head_norm_before_train=1.393281 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.642034 metrics={'f1_val': 0.8959681801899696, 'auprc': 0.9930591346077131, 'loss_val': 0.30806384404892967, 'psi': 0.9348045619570671}-{'f1_val': 0.701196517572327, 'auprc': 0.9847281224406226, 'loss_val': 0.39850796189001453, 'psi': 0.8146091595196452}
[S16] START round=17 head_norm_before_train=1.406396 cos_to_last_merge=0.8447 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.845
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.8389900535243947, 'auprc': 0.9925820690550287, 'loss_val': 0.5651793663338024, 'psi': 0.9004268597366483}-{'f1_val': 0.8409212755758683, 'auprc': 0.9376666503718841, 'loss_val': 0.35126933256962645, 'psi': 0.8796194254942746}
[S17] START round=17 head_norm_before_train=0.949368 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.387065 metrics={'f1_val': 0.3891856552001068, 'auprc': 0.878977821645662, 'loss_val': 0.7764143976558798, 'psi': 0.5851025217783289}-{'f1_val': 0.38925608737168776, 'auprc': 0.6440696605951908, 'loss_val': 0.8462434497383831, 'psi': 0.491181516661089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:42010
[S3] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S3
[S9] cosine check vs S3: cos=-0.0407
[S9] DROPPED delta from S3 (cos=-0.0407 < 0.0)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:42011
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:42016
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] cosine check vs S4: cos=-0.0625
[S10] DROPPED delta from S4 (cos=-0.0625 < 0.0)
[S5] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:42014
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=-0.0526
[S16] DROPPED delta from S5 (cos=-0.0526 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:42012
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:42013
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S7
[S14] cosine check vs S7: cos=-0.1361
[S14] DROPPED delta from S7 (cos=-0.1361 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] cosine check vs S6: cos=-0.1701
[S11] DROPPED delta from S6 (cos=-0.1701 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.3352
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.9930
[S11] RECEIVED delta(kind=head bytes=1799) from S15
[S11] cosine check vs S15: cos=-0.1171
[S11] DROPPED delta from S15 (cos=-0.1171 < 0.0)
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] cosine check vs S11: cos=-0.1198
[S13] DROPPED delta from S11 (cos=-0.1198 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S17
[S3] cosine check vs S17: cos=-0.0823
[S3] DROPPED delta from S17 (cos=-0.0823 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.8960 head_norm=1.424261
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.599882e-02
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.9104 head_norm=1.433852 delta_norm=0.085999
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.3892 head_norm=0.980954
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.342798e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.3892 head_norm=1.011227 delta_norm=0.734280
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.469524 cos_to_last_merge=0.8293 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.829
[S2] round=18 local utility u=0.039293 metrics={'f1_val': 0.701230889339113, 'auprc': 0.7790458780552718, 'loss_val': 0.29307595213079685, 'psi': 0.7323568848255766}-{'f1_val': 0.701230889339113, 'auprc': 0.7490385343694181, 'loss_val': 0.2816390295378443, 'psi': 0.720353947351235}
[S3] START round=18 head_norm_before_train=1.542027 cos_to_last_merge=0.9914 (last merge round=15)
[S3] round=18 local utility u=0.095306 metrics={'f1_val': 0.9847295211690302, 'auprc': 0.9973830458428465, 'loss_val': 0.11272679383413504, 'psi': 0.9897909310385569}-{'f1_val': 0.9610352511054436, 'auprc': 0.9969956766857017, 'loss_val': 0.16001193219474746, 'psi': 0.9754194213375469}
[S4] START round=18 head_norm_before_train=1.507002 cos_to_last_merge=0.8197 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.820
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.6169981963740847, 'auprc': 0.9004267252419511, 'loss_val': 0.4924165173100239, 'psi': 0.7303696079212313}-{'f1_val': 0.6177364050413701, 'auprc': 0.9451078860081995, 'loss_val': 0.4827469575337284, 'psi': 0.7486849974281018}
[S5] START round=18 head_norm_before_train=1.764482 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9946060486294224, 'loss_val': 0.08029255050311365, 'psi': 0.9958179649099108}-{'f1_val': 0.996625909096903, 'auprc': 0.9979413070972388, 'loss_val': 0.07804949027383992, 'psi': 0.9971520682970374}
[S6] START round=18 head_norm_before_train=1.585016 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.789322771064556, 'auprc': 0.9402458012296463, 'loss_val': 0.515798837185309, 'psi': 0.849691983130592}-{'f1_val': 0.960962682470222, 'auprc': 0.9615772160933155, 'loss_val': 0.25843422587622117, 'psi': 0.9612084959194594}
[S7] START round=18 head_norm_before_train=1.656325 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.6146323497238092, 'auprc': 0.7944671413965655, 'loss_val': 0.586844717787202, 'psi': 0.6865662663929117}-{'f1_val': 0.698448323217846, 'auprc': 0.8508615504123219, 'loss_val': 0.33262568985244906, 'psi': 0.7594136140956363}
[S8] START round=18 head_norm_before_train=1.470110 cos_to_last_merge=0.8318 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.832
[S8] round=18 local utility u=0.012820 metrics={'f1_val': 0.9925803045490724, 'auprc': 0.9973961625853406, 'loss_val': 0.0938097622077239, 'psi': 0.9945066477635797}-{'f1_val': 0.9934667705418724, 'auprc': 0.9924122044682147, 'loss_val': 0.1098173461447618, 'psi': 0.9930449441124094}
[S9] START round=18 head_norm_before_train=1.747599 cos_to_last_merge=0.8464 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.846
[S9] round=18 local utility u=0.014015 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9941418384499092, 'loss_val': 0.02288982064907515, 'psi': 0.9959184828872494}-{'f1_val': 0.9912134460920485, 'auprc': 0.9996127184522015, 'loss_val': 0.03199655932593511, 'psi': 0.9945731550361097}
[S10] START round=18 head_norm_before_train=1.472628 cos_to_last_merge=0.8312 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.831
[S10] round=18 local utility u=0.195391 metrics={'f1_val': 0.9933750578586366, 'auprc': 0.9964112357115055, 'loss_val': 0.10423087649218192, 'psi': 0.9945895289997841}-{'f1_val': 0.9465330925375011, 'auprc': 0.9932523685023673, 'loss_val': 0.20448388253422076, 'psi': 0.9652208029234475}
[S11] START round=18 head_norm_before_train=1.705682 (no previous merge yet)
[S11] round=18 local utility u=0.005585 metrics={'f1_val': 0.996567470639547, 'auprc': 0.998428252446137, 'loss_val': 0.10048861976826534, 'psi': 0.997311783362183}-{'f1_val': 0.996960829744628, 'auprc': 0.998451295288636, 'loss_val': 0.11408714829060501, 'psi': 0.9975570159622311}
[S13] START round=18 head_norm_before_train=1.424661 cos_to_last_merge=0.9997 (last merge round=16)
[S13] round=18 local utility u=0.421024 metrics={'f1_val': 0.7097259425234543, 'auprc': 0.6880397857897462, 'loss_val': 0.439759441831822, 'psi': 0.7010514798299711}-{'f1_val': 0.6195257118802989, 'auprc': 0.6468972399689084, 'loss_val': 0.6171786807676989, 'psi': 0.6304743231157427}
[S14] START round=18 head_norm_before_train=1.448495 cos_to_last_merge=0.8600 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.860
[S14] round=18 local utility u=0.011191 metrics={'f1_val': 0.9975084813078557, 'auprc': 0.9956132213508677, 'loss_val': 0.09711999633629392, 'psi': 0.9967503773250606}-{'f1_val': 0.9972657600632533, 'auprc': 0.9955399059984122, 'loss_val': 0.11782637575156306, 'psi': 0.9965754184373168}
[S15] START round=18 head_norm_before_train=1.433852 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.322549 metrics={'f1_val': 0.99083815768444, 'auprc': 0.996984220700051, 'loss_val': 0.24396184631739504, 'psi': 0.9932965828906843}-{'f1_val': 0.8959681801899696, 'auprc': 0.9930591346077131, 'loss_val': 0.30806384404892967, 'psi': 0.9348045619570671}
[S16] START round=18 head_norm_before_train=1.444346 cos_to_last_merge=0.8401 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.840
[S16] round=18 local utility u=0.335127 metrics={'f1_val': 0.9116826386584878, 'auprc': 0.9939829064302446, 'loss_val': 0.33528365413508016, 'psi': 0.9446027457671905}-{'f1_val': 0.8389900535243947, 'auprc': 0.9925820690550287, 'loss_val': 0.5651793663338024, 'psi': 0.9004268597366483}
[S17] START round=18 head_norm_before_train=1.011227 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.3891856552001068, 'auprc': 0.6356781118972519, 'loss_val': 0.7591444913427333, 'psi': 0.4877826378789648}-{'f1_val': 0.3891856552001068, 'auprc': 0.878977821645662, 'loss_val': 0.7764143976558798, 'psi': 0.5851025217783289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:42013
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:42012
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:42017
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:42004
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S10
[S3] cosine check vs S10: cos=0.9580
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.8770
[S17] RECEIVED delta(kind=head bytes=1795) from S9
[S17] cosine check vs S9: cos=0.2613
[S15] RECEIVED delta(kind=head bytes=1804) from S14
[S15] cosine check vs S14: cos=0.9944
[S17] RECEIVED delta(kind=head bytes=1806) from S16
[S17] cosine check vs S16: cos=0.3619
[S13] RECEIVED delta(kind=head bytes=1804) from S2
[S13] cosine check vs S2: cos=0.9924
[S13] RECEIVED delta(kind=head bytes=1804) from S11
[S13] cosine check vs S11: cos=-0.1186
[S13] DROPPED delta from S11 (cos=-0.1186 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S15
[S11] cosine check vs S15: cos=-0.1154
[S11] DROPPED delta from S15 (cos=-0.1154 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=-0.0439
[S9] DROPPED delta from S3 (cos=-0.0439 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S13
[S4] cosine check vs S13: cos=-0.0186
[S4] DROPPED delta from S13 (cos=-0.0186 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.9908 head_norm=1.465292
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.895372e-02
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.9904 head_norm=1.475272 delta_norm=0.078954
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.9847 head_norm=1.601585
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.306273e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.9826 head_norm=1.531493 delta_norm=0.230627
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.7097 head_norm=1.445227
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.376111e-02
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.7099 head_norm=1.465927 delta_norm=0.093761
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.3892 head_norm=1.042758
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.961034e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.3891 head_norm=0.943804 delta_norm=0.296103
[S17] aggregate: ACCEPT kept=['S8', 'S9', 'S16'] (k=3/3) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.492241 cos_to_last_merge=0.8280 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.828
[S2] round=19 local utility u=0.059221 metrics={'f1_val': 0.701230889339113, 'auprc': 0.8012590115769505, 'loss_val': 0.2412724061308903, 'psi': 0.741242138234248}-{'f1_val': 0.701230889339113, 'auprc': 0.7790458780552718, 'loss_val': 0.29307595213079685, 'psi': 0.7323568848255766}
[S3] START round=19 head_norm_before_train=1.531493 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.999050261026553, 'loss_val': 0.13560295128871908, 'psi': 0.9762412550738874}-{'f1_val': 0.9847295211690302, 'auprc': 0.9973830458428465, 'loss_val': 0.11272679383413504, 'psi': 0.9897909310385569}
[S4] START round=19 head_norm_before_train=1.523058 cos_to_last_merge=0.8186 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.819
[S4] round=19 local utility u=0.058469 metrics={'f1_val': 0.6136879965449822, 'auprc': 0.951206580315274, 'loss_val': 0.5079573852179106, 'psi': 0.748695430053099}-{'f1_val': 0.6169981963740847, 'auprc': 0.9004267252419511, 'loss_val': 0.4924165173100239, 'psi': 0.7303696079212313}
[S5] START round=19 head_norm_before_train=1.785034 (no previous merge yet)
[S5] round=19 local utility u=0.012392 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9955303609478696, 'loss_val': 0.05828245421008189, 'psi': 0.9961876898372897}-{'f1_val': 0.996625909096903, 'auprc': 0.9946060486294224, 'loss_val': 0.08029255050311365, 'psi': 0.9958179649099108}
[S6] START round=19 head_norm_before_train=1.601760 (no previous merge yet)
[S6] round=19 local utility u=0.152559 metrics={'f1_val': 0.8206561325025719, 'auprc': 0.9450727361849238, 'loss_val': 0.4131623678038539, 'psi': 0.8704227739755126}-{'f1_val': 0.789322771064556, 'auprc': 0.9402458012296463, 'loss_val': 0.515798837185309, 'psi': 0.849691983130592}
[S7] START round=19 head_norm_before_train=1.667853 (no previous merge yet)
[S7] round=19 local utility u=0.020068 metrics={'f1_val': 0.6173632840736019, 'auprc': 0.797712795613241, 'loss_val': 0.572831330380483, 'psi': 0.6895030886894575}-{'f1_val': 0.6146323497238092, 'auprc': 0.7944671413965655, 'loss_val': 0.586844717787202, 'psi': 0.6865662663929117}
[S8] START round=19 head_norm_before_train=1.495716 cos_to_last_merge=0.8268 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.827
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9934741586295472, 'auprc': 0.9874553911851833, 'loss_val': 0.08589958818688966, 'psi': 0.9910666516518016}-{'f1_val': 0.9925803045490724, 'auprc': 0.9973961625853406, 'loss_val': 0.0938097622077239, 'psi': 0.9945066477635797}
[S9] START round=19 head_norm_before_train=1.761948 cos_to_last_merge=0.8449 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.845
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9933237369199828, 'auprc': 0.9996245420898924, 'loss_val': 0.0271257476234991, 'psi': 0.9958440589879466}-{'f1_val': 0.9971029125121428, 'auprc': 0.9941418384499092, 'loss_val': 0.02288982064907515, 'psi': 0.9959184828872494}
[S10] START round=19 head_norm_before_train=1.494070 cos_to_last_merge=0.8277 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.828
[S10] round=19 local utility u=0.006158 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9955000025299502, 'loss_val': 0.0879637327263681, 'psi': 0.9941032573179098}-{'f1_val': 0.9933750578586366, 'auprc': 0.9964112357115055, 'loss_val': 0.10423087649218192, 'psi': 0.9945895289997841}
[S11] START round=19 head_norm_before_train=1.730838 (no previous merge yet)
[S11] round=19 local utility u=0.006341 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9984435669284809, 'loss_val': 0.08785341914996878, 'psi': 0.9973179091551205}-{'f1_val': 0.996567470639547, 'auprc': 0.998428252446137, 'loss_val': 0.10048861976826534, 'psi': 0.997311783362183}
[S13] START round=19 head_norm_before_train=1.465927 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6608575210440816, 'auprc': 0.6779500702690101, 'loss_val': 0.5168298217794468, 'psi': 0.667694540734053}-{'f1_val': 0.7097259425234543, 'auprc': 0.6880397857897462, 'loss_val': 0.439759441831822, 'psi': 0.7010514798299711}
[S14] START round=19 head_norm_before_train=1.489377 cos_to_last_merge=0.8542 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.854
[S14] round=19 local utility u=0.013213 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9987631468634643, 'loss_val': 0.0809997484154749, 'psi': 0.9980959295752979}-{'f1_val': 0.9975084813078557, 'auprc': 0.9956132213508677, 'loss_val': 0.09711999633629392, 'psi': 0.9967503773250606}
[S15] START round=19 head_norm_before_train=1.475272 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.701283085679465, 'auprc': 0.9905161380930361, 'loss_val': 0.31074220394759416, 'psi': 0.8169763066448934}-{'f1_val': 0.99083815768444, 'auprc': 0.996984220700051, 'loss_val': 0.24396184631739504, 'psi': 0.9932965828906843}
[S16] START round=19 head_norm_before_train=1.480626 cos_to_last_merge=0.8362 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.836
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8494837071437128, 'auprc': 0.9952073908872291, 'loss_val': 0.5616772768450562, 'psi': 0.9077731806411193}-{'f1_val': 0.9116826386584878, 'auprc': 0.9939829064302446, 'loss_val': 0.33528365413508016, 'psi': 0.9446027457671905}
[S17] START round=19 head_norm_before_train=0.943804 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.355197 metrics={'f1_val': 0.38987431820188556, 'auprc': 0.8656428732146964, 'loss_val': 0.7427763975134756, 'psi': 0.58018174020701}-{'f1_val': 0.3891856552001068, 'auprc': 0.6356781118972519, 'loss_val': 0.7591444913427333, 'psi': 0.4877826378789648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:42014
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:42013
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:42011
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:42015
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:42012
[S14] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S10
[S3] cosine check vs S10: cos=0.9810
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=-0.0534
[S16] DROPPED delta from S5 (cos=-0.0534 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] cosine check vs S14: cos=0.9956
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] cosine check vs S7: cos=-0.1399
[S14] DROPPED delta from S7 (cos=-0.1399 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] cosine check vs S2: cos=0.9963
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] cosine check vs S11: cos=-0.1231
[S13] DROPPED delta from S11 (cos=-0.1231 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=-0.1735
[S11] DROPPED delta from S6 (cos=-0.1735 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S4
[S10] cosine check vs S4: cos=-0.0641
[S10] DROPPED delta from S4 (cos=-0.0641 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=-0.1063
[S3] DROPPED delta from S17 (cos=-0.1063 < 0.0)
[S8] r=20 psi=0.991 u=0.0000 p_local=0.1664 f1=0.993 auprc=0.987 bytes=25159
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.6609 head_norm=1.482455
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.623862e-02
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.6623 head_norm=1.496465 delta_norm=0.066239
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.668 u=0.0000 p_local=0.1659 f1=0.661 auprc=0.678 bytes=19766
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.9610 head_norm=1.581103
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.543030e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.9610 head_norm=1.541081 delta_norm=0.154303
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] r=20 psi=0.976 u=0.0000 p_local=0.1441 f1=0.961 auprc=0.999 bytes=28760
[S9] r=20 psi=0.996 u=0.0000 p_local=0.0514 f1=0.993 auprc=1.000 bytes=21600
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.7013 head_norm=1.504864
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.246371e-02
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.7025 head_norm=1.515057 delta_norm=0.072464
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.817 u=0.0000 p_local=0.2622 f1=0.701 auprc=0.991 bytes=23354
[S6] r=20 psi=0.870 u=0.1526 p_local=0.3532 f1=0.821 auprc=0.945 bytes=23369
[S2] r=20 psi=0.741 u=0.0592 p_local=0.0779 f1=0.701 auprc=0.801 bytes=23381
[S11] r=20 psi=0.997 u=0.0063 p_local=0.1100 f1=0.997 auprc=0.998 bytes=28768
[S7] r=20 psi=0.690 u=0.0201 p_local=0.2381 f1=0.617 auprc=0.798 bytes=17985
[S5] r=20 psi=0.996 u=0.0124 p_local=0.1132 f1=0.997 auprc=0.996 bytes=26987
[S4] r=20 psi=0.749 u=0.0585 p_local=0.1223 f1=0.614 auprc=0.951 bytes=16191
[S14] r=20 psi=0.998 u=0.0132 p_local=0.1223 f1=0.998 auprc=0.999 bytes=23388
[S10] r=20 psi=0.994 u=0.0062 p_local=0.1812 f1=0.993 auprc=0.996 bytes=21609
[S16] r=20 psi=0.908 u=0.0000 p_local=0.2084 f1=0.849 auprc=0.995 bytes=21647
[S17] r=20 psi=0.580 u=0.3552 p_local=0.1700 f1=0.390 auprc=0.866 bytes=19772
[S2] START round=20 head_norm_before_train=1.513247 cos_to_last_merge=0.8268 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.827
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7079811630875148, 'auprc': 0.7650579190439286, 'loss_val': 0.2844657447253355, 'psi': 0.7308118654700804}-{'f1_val': 0.701230889339113, 'auprc': 0.8012590115769505, 'loss_val': 0.2412724061308903, 'psi': 0.741242138234248}
[S3] START round=20 head_norm_before_train=1.541081 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.087669 metrics={'f1_val': 0.9877596779361668, 'auprc': 0.998164162750922, 'loss_val': 0.11795343626409693, 'psi': 0.9919214718620688}-{'f1_val': 0.9610352511054436, 'auprc': 0.999050261026553, 'loss_val': 0.13560295128871908, 'psi': 0.9762412550738874}
[S4] START round=20 head_norm_before_train=1.537164 cos_to_last_merge=0.8174 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.817
[S4] round=20 local utility u=0.010363 metrics={'f1_val': 0.6172055500400164, 'auprc': 0.9513840842715694, 'loss_val': 0.5088701658561425, 'psi': 0.7508769637326376}-{'f1_val': 0.6136879965449822, 'auprc': 0.951206580315274, 'loss_val': 0.5079573852179106, 'psi': 0.748695430053099}
[S5] START round=20 head_norm_before_train=1.803977 (no previous merge yet)
[S5] round=20 local utility u=0.010058 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9983244043537753, 'loss_val': 0.04654933242550549, 'psi': 0.9973053071996519}-{'f1_val': 0.996625909096903, 'auprc': 0.9955303609478696, 'loss_val': 0.05828245421008189, 'psi': 0.9961876898372897}
[S6] START round=20 head_norm_before_train=1.615334 (no previous merge yet)
[S6] round=20 local utility u=0.526092 metrics={'f1_val': 0.9614234632811981, 'auprc': 0.9611532482352692, 'loss_val': 0.2538240500205184, 'psi': 0.9613153772628265}-{'f1_val': 0.8206561325025719, 'auprc': 0.9450727361849238, 'loss_val': 0.4131623678038539, 'psi': 0.8704227739755126}
[S7] START round=20 head_norm_before_train=1.679545 (no previous merge yet)
[S7] round=20 local utility u=0.422511 metrics={'f1_val': 0.6921988051447983, 'auprc': 0.8480823178228312, 'loss_val': 0.3279316886948051, 'psi': 0.7545522102160114}-{'f1_val': 0.6173632840736019, 'auprc': 0.797712795613241, 'loss_val': 0.572831330380483, 'psi': 0.6895030886894575}
[S8] START round=20 head_norm_before_train=1.522988 cos_to_last_merge=0.8231 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.823
[S8] round=20 local utility u=0.000589 metrics={'f1_val': 0.9922164873423569, 'auprc': 0.987623271918808, 'loss_val': 0.07767969880565982, 'psi': 0.9903792011729373}-{'f1_val': 0.9934741586295472, 'auprc': 0.9874553911851833, 'loss_val': 0.08589958818688966, 'psi': 0.9910666516518016}
[S9] START round=20 head_norm_before_train=1.780816 cos_to_last_merge=0.8433 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.843
[S9] round=20 local utility u=0.010110 metrics={'f1_val': 0.9958557717480525, 'auprc': 0.9996102230861927, 'loss_val': 0.022054151010408352, 'psi': 0.9973575522833086}-{'f1_val': 0.9933237369199828, 'auprc': 0.9996245420898924, 'loss_val': 0.0271257476234991, 'psi': 0.9958440589879466}
[S10] START round=20 head_norm_before_train=1.515781 cos_to_last_merge=0.8245 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.824
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9928827653876859, 'loss_val': 0.10565663334445359, 'psi': 0.9937669451821272}-{'f1_val': 0.9931720938432163, 'auprc': 0.9955000025299502, 'loss_val': 0.0879637327263681, 'psi': 0.9941032573179098}
[S11] START round=20 head_norm_before_train=1.756257 (no previous merge yet)
[S11] round=20 local utility u=0.005498 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9984857924067654, 'loss_val': 0.07698334053058811, 'psi': 0.9973347993464343}-{'f1_val': 0.996567470639547, 'auprc': 0.9984435669284809, 'loss_val': 0.08785341914996878, 'psi': 0.9973179091551205}
[S13] START round=20 head_norm_before_train=1.496465 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.6283815865613624, 'auprc': 0.6221052527973391, 'loss_val': 0.6057151857464406, 'psi': 0.6258710530557531}-{'f1_val': 0.6608575210440816, 'auprc': 0.6779500702690101, 'loss_val': 0.5168298217794468, 'psi': 0.667694540734053}
[S14] START round=20 head_norm_before_train=1.528621 cos_to_last_merge=0.8487 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.849
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9455518821365693, 'auprc': 0.9957875802374181, 'loss_val': 0.11862722759353939, 'psi': 0.9656461613769087}-{'f1_val': 0.9976511180498535, 'auprc': 0.9987631468634643, 'loss_val': 0.0809997484154749, 'psi': 0.9980959295752979}
[S15] START round=20 head_norm_before_train=1.515057 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6969688456788847, 'auprc': 0.8736629594446286, 'loss_val': 0.3881446416851726, 'psi': 0.7676464911851824}-{'f1_val': 0.701283085679465, 'auprc': 0.9905161380930361, 'loss_val': 0.31074220394759416, 'psi': 0.8169763066448934}
[S16] START round=20 head_norm_before_train=1.516505 cos_to_last_merge=0.8327 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.833
[S16] round=20 local utility u=0.320296 metrics={'f1_val': 0.9158339699631162, 'auprc': 0.9941874353715004, 'loss_val': 0.3161260184908685, 'psi': 0.9471753561264699}-{'f1_val': 0.8494837071437128, 'auprc': 0.9952073908872291, 'loss_val': 0.5616772768450562, 'psi': 0.9077731806411193}
[S17] START round=20 head_norm_before_train=0.975058 cos_to_last_merge=0.9964 (last merge round=18)
[S17] round=20 local utility u=0.011020 metrics={'f1_val': 0.39289809565183353, 'auprc': 0.8568209395936147, 'loss_val': 0.7124139131222241, 'psi': 0.5784672332285461}-{'f1_val': 0.38987431820188556, 'auprc': 0.8656428732146964, 'loss_val': 0.7427763975134756, 'psi': 0.58018174020701}
[S5] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:42010
[S4] not sending this round → trigger blocked (psi=0.751)
[S6] not sending this round → trigger blocked (psi=0.961)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.755)
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:42017
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[S8] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S16
[S17] cosine check vs S16: cos=0.4690
[S17] RECEIVED delta(kind=head bytes=1801) from S9
[S17] cosine check vs S9: cos=0.4767
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.7225
[S9] RECEIVED delta(kind=head bytes=1798) from S3
[S9] cosine check vs S3: cos=-0.0285
[S9] DROPPED delta from S3 (cos=-0.0285 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.578)
[S11] ⇄ pheromone p=0.089 → S13@127.0.0.1:42013
[S14] ⇄ pheromone p=0.098 → S15@127.0.0.1:42015
[S13] ⇄ pheromone p=0.133 → S4@127.0.0.1:42004
[S4] ⇄ pheromone p=0.100 → S10@127.0.0.1:42011
[S6] ⇄ pheromone p=0.388 → S11@127.0.0.1:42012
[S7] ⇄ pheromone p=0.275 → S14@127.0.0.1:42014
[S2] ⇄ pheromone p=0.062 → S13@127.0.0.1:42013
[S5] ⇄ pheromone p=0.093 → S16@127.0.0.1:42016
[S10] ⇄ pheromone p=0.145 → S3@127.0.0.1:42003
[S3] ⇄ pheromone p=0.133 → S9@127.0.0.1:42010
[S16] ⇄ pheromone p=0.231 → S17@127.0.0.1:42017
[S9] ⇄ pheromone p=0.043 → S17@127.0.0.1:42017
[S8] ⇄ pheromone p=0.133 → S17@127.0.0.1:42017
[S15] ⇄ pheromone p=0.210 → S11@127.0.0.1:42012
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.3929 head_norm=1.008398
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.851276e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.3935 head_norm=0.969515 delta_norm=0.185128
[S17] aggregate: ACCEPT kept=['S16', 'S9', 'S8'] (k=3/3) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.138 → S3@127.0.0.1:42003
[S2] START round=21 head_norm_before_train=1.533343 cos_to_last_merge=0.8258 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.826
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.6833040729422969, 'auprc': 0.7800951525853106, 'loss_val': 0.27116545023451244, 'psi': 0.7220205047995023}-{'f1_val': 0.7079811630875148, 'auprc': 0.7650579190439286, 'loss_val': 0.2844657447253355, 'psi': 0.7308118654700804}
[S3] START round=21 head_norm_before_train=1.591607 cos_to_last_merge=0.9987 (last merge round=19)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9988904625595094, 'loss_val': 0.10216842735721868, 'psi': 0.976201236263476}-{'f1_val': 0.9877596779361668, 'auprc': 0.998164162750922, 'loss_val': 0.11795343626409693, 'psi': 0.9919214718620688}
[S4] START round=21 head_norm_before_train=1.551154 cos_to_last_merge=0.8164 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.816
[S4] round=21 local utility u=0.000652 metrics={'f1_val': 0.6175256250795313, 'auprc': 0.9488316727607391, 'loss_val': 0.5018291913607822, 'psi': 0.7500480441520145}-{'f1_val': 0.6172055500400164, 'auprc': 0.9513840842715694, 'loss_val': 0.5088701658561425, 'psi': 0.7508769637326376}
[S5] START round=21 head_norm_before_train=1.829469 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9946646963897834, 'loss_val': 0.04752494468174901, 'psi': 0.9957535667275514}-{'f1_val': 0.996625909096903, 'auprc': 0.9983244043537753, 'loss_val': 0.04654933242550549, 'psi': 0.9973053071996519}
[S6] START round=21 head_norm_before_train=1.630414 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.8170748653770862, 'auprc': 0.9438926076476364, 'loss_val': 0.4384597348683943, 'psi': 0.8678019622853063}-{'f1_val': 0.9614234632811981, 'auprc': 0.9611532482352692, 'loss_val': 0.2538240500205184, 'psi': 0.9613153772628265}
[S7] START round=21 head_norm_before_train=1.691005 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.573504013655348, 'auprc': 0.790801622039775, 'loss_val': 0.7601851007715545, 'psi': 0.6604230570091187}-{'f1_val': 0.6921988051447983, 'auprc': 0.8480823178228312, 'loss_val': 0.3279316886948051, 'psi': 0.7545522102160114}
[S8] START round=21 head_norm_before_train=1.548283 cos_to_last_merge=0.8191 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.819
[S8] round=21 local utility u=0.000438 metrics={'f1_val': 0.9932883265732785, 'auprc': 0.9854925707306478, 'loss_val': 0.07684330734409553, 'psi': 0.9901700242362261}-{'f1_val': 0.9922164873423569, 'auprc': 0.987623271918808, 'loss_val': 0.07767969880565982, 'psi': 0.9903792011729373}
[S9] START round=21 head_norm_before_train=1.798848 cos_to_last_merge=0.8418 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.842
[S9] round=21 local utility u=0.001182 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9970514220630093, 'loss_val': 0.019497158529792998, 'psi': 0.9970823163324894}-{'f1_val': 0.9958557717480525, 'auprc': 0.9996102230861927, 'loss_val': 0.022054151010408352, 'psi': 0.9973575522833086}
[S10] START round=21 head_norm_before_train=1.536745 cos_to_last_merge=0.8217 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.822
[S10] round=21 local utility u=0.014544 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9936999064595966, 'loss_val': 0.08137385301446795, 'psi': 0.9943291281154621}-{'f1_val': 0.9943563983784213, 'auprc': 0.9928827653876859, 'loss_val': 0.10565663334445359, 'psi': 0.9937669451821272}
[S11] START round=21 head_norm_before_train=1.780264 (no previous merge yet)
[S11] round=21 local utility u=0.004815 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9982908740046906, 'loss_val': 0.06519532227445789, 'psi': 0.9970994500831929}-{'f1_val': 0.996567470639547, 'auprc': 0.9984857924067654, 'loss_val': 0.07698334053058811, 'psi': 0.9973347993464343}
[S13] START round=21 head_norm_before_train=1.514530 cos_to_last_merge=0.9997 (last merge round=19)
[S13] round=21 local utility u=0.122854 metrics={'f1_val': 0.6420296171408194, 'auprc': 0.6578436211436398, 'loss_val': 0.5491111851008137, 'psi': 0.6483552187419476}-{'f1_val': 0.6283815865613624, 'auprc': 0.6221052527973391, 'loss_val': 0.6057151857464406, 'psi': 0.6258710530557531}
[S14] START round=21 head_norm_before_train=1.556433 cos_to_last_merge=0.8449 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.845
[S14] round=21 local utility u=0.182721 metrics={'f1_val': 0.9968231030563408, 'auprc': 0.9974655798421687, 'loss_val': 0.0658460883512052, 'psi': 0.9970800937706719}-{'f1_val': 0.9455518821365693, 'auprc': 0.9957875802374181, 'loss_val': 0.11862722759353939, 'psi': 0.9656461613769087}
[S15] START round=21 head_norm_before_train=1.545038 cos_to_last_merge=0.9993 (last merge round=19)
[S15] round=21 local utility u=1.000000 metrics={'f1_val': 0.9430564199781426, 'auprc': 0.9901425561052699, 'loss_val': 0.185209340271276, 'psi': 0.9618908744289936}-{'f1_val': 0.6969688456788847, 'auprc': 0.8736629594446286, 'loss_val': 0.3881446416851726, 'psi': 0.7676464911851824}
[S16] START round=21 head_norm_before_train=1.550050 cos_to_last_merge=0.8301 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.830
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8413579053544309, 'auprc': 0.996682474892574, 'loss_val': 0.6485770618268323, 'psi': 0.9034877331696881}-{'f1_val': 0.9158339699631162, 'auprc': 0.9941874353715004, 'loss_val': 0.3161260184908685, 'psi': 0.9471753561264699}
[S17] START round=21 head_norm_before_train=0.969515 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.3929527750876963, 'auprc': 0.8486548965510013, 'loss_val': 0.7209228402481743, 'psi': 0.5752336236730183}-{'f1_val': 0.39289809565183353, 'auprc': 0.8568209395936147, 'loss_val': 0.7124139131222241, 'psi': 0.5784672332285461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:42011
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:42013
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:42012
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:42003
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.6362
[S17] RECEIVED delta(kind=head bytes=1801) from S9
[S17] cosine check vs S9: cos=0.5677
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=0.9936
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=0.9828
[S4] RECEIVED delta(kind=head bytes=1796) from S13
[S4] cosine check vs S13: cos=-0.0123
[S4] DROPPED delta from S13 (cos=-0.0123 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] cosine check vs S11: cos=-0.1259
[S13] DROPPED delta from S11 (cos=-0.1259 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] cosine check vs S15: cos=-0.1086
[S11] DROPPED delta from S15 (cos=-0.1086 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] cosine check vs S4: cos=-0.0663
[S10] DROPPED delta from S4 (cos=-0.0663 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.9611 head_norm=1.641285
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.546194e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.9610 head_norm=1.590580 delta_norm=0.154619
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.9431 head_norm=1.568642
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.945750e-02
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.9883 head_norm=1.572049 delta_norm=0.089457
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.3930 head_norm=0.997290
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.322486e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.3930 head_norm=1.059987 delta_norm=0.332249
[S17] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.552329 cos_to_last_merge=0.8248 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.825
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.6730018178928177, 'auprc': 0.7464787820799017, 'loss_val': 0.35326694718560037, 'psi': 0.7023926035676513}-{'f1_val': 0.6833040729422969, 'auprc': 0.7800951525853106, 'loss_val': 0.27116545023451244, 'psi': 0.7220205047995023}
[S3] START round=22 head_norm_before_train=1.590580 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.063700 metrics={'f1_val': 0.9821381472866884, 'auprc': 0.9987986768215672, 'loss_val': 0.10087134547316746, 'psi': 0.98880235910064}-{'f1_val': 0.9610750853994537, 'auprc': 0.9988904625595094, 'loss_val': 0.10216842735721868, 'psi': 0.976201236263476}
[S4] START round=22 head_norm_before_train=1.565754 cos_to_last_merge=0.8155 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.815
[S4] round=22 local utility u=0.016440 metrics={'f1_val': 0.6199372916436641, 'auprc': 0.9518895699958427, 'loss_val': 0.4925921187568087, 'psi': 0.7527182029845356}-{'f1_val': 0.6175256250795313, 'auprc': 0.9488316727607391, 'loss_val': 0.5018291913607822, 'psi': 0.7500480441520145}
[S5] START round=22 head_norm_before_train=1.850154 (no previous merge yet)
[S5] round=22 local utility u=0.011556 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9982312143588764, 'loss_val': 0.03599159484894687, 'psi': 0.9972680312016924}-{'f1_val': 0.9964794802860635, 'auprc': 0.9946646963897834, 'loss_val': 0.04752494468174901, 'psi': 0.9957535667275514}
[S6] START round=22 head_norm_before_train=1.652604 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.622980124658146, 'auprc': 0.9153418964489745, 'loss_val': 0.7558394133193793, 'psi': 0.7399248333744775}-{'f1_val': 0.8170748653770862, 'auprc': 0.9438926076476364, 'loss_val': 0.4384597348683943, 'psi': 0.8678019622853063}
[S7] START round=22 head_norm_before_train=1.701969 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.499171677737436, 'auprc': 0.7814238922819785, 'loss_val': 1.0772648450882936, 'psi': 0.6120725635552531}-{'f1_val': 0.573504013655348, 'auprc': 0.790801622039775, 'loss_val': 0.7601851007715545, 'psi': 0.6604230570091187}
[S8] START round=22 head_norm_before_train=1.573444 cos_to_last_merge=0.8154 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.815
[S8] round=22 local utility u=0.001196 metrics={'f1_val': 0.9896426608072839, 'auprc': 0.9905980384416686, 'loss_val': 0.0678937787744631, 'psi': 0.9900248118610377}-{'f1_val': 0.9932883265732785, 'auprc': 0.9854925707306478, 'loss_val': 0.07684330734409553, 'psi': 0.9901700242362261}
[S9] START round=22 head_norm_before_train=1.815745 cos_to_last_merge=0.8402 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.840
[S9] round=22 local utility u=0.001385 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9996167354931197, 'loss_val': 0.01943243628393481, 'psi': 0.9976093116354916}-{'f1_val': 0.9971029125121428, 'auprc': 0.9970514220630093, 'loss_val': 0.019497158529792998, 'psi': 0.9970823163324894}
[S10] START round=22 head_norm_before_train=1.553669 cos_to_last_merge=0.8195 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.819
[S10] round=22 local utility u=0.004664 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9944502779441594, 'loss_val': 0.07297979643450214, 'psi': 0.9944975752567004}-{'f1_val': 0.9947486092193725, 'auprc': 0.9936999064595966, 'loss_val': 0.08137385301446795, 'psi': 0.9943291281154621}
[S11] START round=22 head_norm_before_train=1.803821 (no previous merge yet)
[S11] round=22 local utility u=0.003217 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9984391757430523, 'loss_val': 0.060779512543129494, 'psi': 0.9973161526809491}-{'f1_val': 0.996305167468861, 'auprc': 0.9982908740046906, 'loss_val': 0.06519532227445789, 'psi': 0.9970994500831929}
[S13] START round=22 head_norm_before_train=1.532184 cos_to_last_merge=0.9990 (last merge round=19)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.6138394431140596, 'auprc': 0.629669073652782, 'loss_val': 0.6701028980521069, 'psi': 0.6201712953295485}-{'f1_val': 0.6420296171408194, 'auprc': 0.6578436211436398, 'loss_val': 0.5491111851008137, 'psi': 0.6483552187419476}
[S14] START round=22 head_norm_before_train=1.580521 cos_to_last_merge=0.8415 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.841
[S14] round=22 local utility u=0.001784 metrics={'f1_val': 0.9976483782674455, 'auprc': 0.9955671512873414, 'loss_val': 0.06153506963184912, 'psi': 0.9968158874754038}-{'f1_val': 0.9968231030563408, 'auprc': 0.9974655798421687, 'loss_val': 0.0658460883512052, 'psi': 0.9970800937706719}
[S15] START round=22 head_norm_before_train=1.572049 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.169647 metrics={'f1_val': 0.9938830298648659, 'auprc': 0.9925988876726018, 'loss_val': 0.1582448323547806, 'psi': 0.9933693729879602}-{'f1_val': 0.9430564199781426, 'auprc': 0.9901425561052699, 'loss_val': 0.185209340271276, 'psi': 0.9618908744289936}
[S16] START round=22 head_norm_before_train=1.581180 cos_to_last_merge=0.8277 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.828
[S16] round=22 local utility u=0.328514 metrics={'f1_val': 0.9022007233612653, 'auprc': 0.9963272967764917, 'loss_val': 0.35553973783871234, 'psi': 0.939851352727356}-{'f1_val': 0.8413579053544309, 'auprc': 0.996682474892574, 'loss_val': 0.6485770618268323, 'psi': 0.9034877331696881}
[S17] START round=22 head_norm_before_train=1.059987 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.39418340490972636, 'auprc': 0.8282038107619566, 'loss_val': 0.706108190713817, 'psi': 0.5677915672506184}-{'f1_val': 0.3929527750876963, 'auprc': 0.8486548965510013, 'loss_val': 0.7209228402481743, 'psi': 0.5752336236730183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:42013
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:42012
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:42011
[S10] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S10
[S3] cosine check vs S10: cos=0.9912
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] cosine check vs S9: cos=0.6968
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.6784
[S17] RECEIVED delta(kind=head bytes=1798) from S16
[S17] cosine check vs S16: cos=0.2701
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=-0.0561
[S16] DROPPED delta from S5 (cos=-0.0561 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] cosine check vs S14: cos=0.9966
[S13] RECEIVED delta(kind=head bytes=1806) from S11
[S13] cosine check vs S11: cos=-0.1270
[S13] DROPPED delta from S11 (cos=-0.1270 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] cosine check vs S15: cos=-0.1074
[S11] DROPPED delta from S15 (cos=-0.1074 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S4
[S10] cosine check vs S4: cos=-0.0674
[S10] DROPPED delta from S4 (cos=-0.0674 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S3
[S9] cosine check vs S3: cos=-0.0274
[S9] DROPPED delta from S3 (cos=-0.0274 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.9939 head_norm=1.592254
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.629743e-02
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.9947 head_norm=1.597555 delta_norm=0.066297
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.9821 head_norm=1.633958
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.110607e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.9800 head_norm=1.599189 delta_norm=0.111061
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.3942 head_norm=1.085094
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.085656e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.4010 head_norm=1.019790 delta_norm=0.208566
[S17] aggregate: ACCEPT kept=['S9', 'S8', 'S16'] (k=3/3) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.569864 cos_to_last_merge=0.8243 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.824
[S2] round=23 local utility u=0.533510 metrics={'f1_val': 0.8184952379684663, 'auprc': 0.782223023421984, 'loss_val': 0.26643942650181895, 'psi': 0.8039863521498734}-{'f1_val': 0.6730018178928177, 'auprc': 0.7464787820799017, 'loss_val': 0.35326694718560037, 'psi': 0.7023926035676513}
[S3] START round=23 head_norm_before_train=1.599189 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9258238413038519, 'auprc': 0.9957509916076623, 'loss_val': 0.18487750584662577, 'psi': 0.953794701425376}-{'f1_val': 0.9821381472866884, 'auprc': 0.9987986768215672, 'loss_val': 0.10087134547316746, 'psi': 0.98880235910064}
[S4] START round=23 head_norm_before_train=1.579838 cos_to_last_merge=0.8144 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.814
[S4] round=23 local utility u=0.001017 metrics={'f1_val': 0.6214256830631697, 'auprc': 0.9471189224143846, 'loss_val': 0.48517566386205274, 'psi': 0.7517029788036557}-{'f1_val': 0.6199372916436641, 'auprc': 0.9518895699958427, 'loss_val': 0.4925921187568087, 'psi': 0.7527182029845356}
[S5] START round=23 head_norm_before_train=1.875020 (no previous merge yet)
[S5] round=23 local utility u=0.002065 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9984072458599933, 'loss_val': 0.032388924163565966, 'psi': 0.9973384438021391}-{'f1_val': 0.996625909096903, 'auprc': 0.9982312143588764, 'loss_val': 0.03599159484894687, 'psi': 0.9972680312016924}
[S6] START round=23 head_norm_before_train=1.674695 (no previous merge yet)
[S6] round=23 local utility u=0.764027 metrics={'f1_val': 0.8125267757757415, 'auprc': 0.9524104010049502, 'loss_val': 0.4762702533975043, 'psi': 0.868480225867425}-{'f1_val': 0.622980124658146, 'auprc': 0.9153418964489745, 'loss_val': 0.7558394133193793, 'psi': 0.7399248333744775}
[S7] START round=23 head_norm_before_train=1.710290 (no previous merge yet)
[S7] round=23 local utility u=1.000000 metrics={'f1_val': 0.7566647186624278, 'auprc': 0.9868319200541265, 'loss_val': 0.1920036874016578, 'psi': 0.8487315992191072}-{'f1_val': 0.499171677737436, 'auprc': 0.7814238922819785, 'loss_val': 1.0772648450882936, 'psi': 0.6120725635552531}
[S8] START round=23 head_norm_before_train=1.601443 cos_to_last_merge=0.8111 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.811
[S8] round=23 local utility u=0.007828 metrics={'f1_val': 0.9936566772467331, 'auprc': 0.9866886652446127, 'loss_val': 0.0645945606656539, 'psi': 0.990869472445885}-{'f1_val': 0.9896426608072839, 'auprc': 0.9905980384416686, 'loss_val': 0.0678937787744631, 'psi': 0.9900248118610377}
[S9] START round=23 head_norm_before_train=1.828960 cos_to_last_merge=0.8389 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.839
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9953842149046986, 'loss_val': 0.019211698828422906, 'psi': 0.9964154334691652}-{'f1_val': 0.9962710290637395, 'auprc': 0.9996167354931197, 'loss_val': 0.01943243628393481, 'psi': 0.9976093116354916}
[S10] START round=23 head_norm_before_train=1.571515 cos_to_last_merge=0.8174 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.817
[S10] round=23 local utility u=0.002509 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.996489932958165, 'loss_val': 0.06462591447429059, 'psi': 0.994367919201061}-{'f1_val': 0.9945291067983943, 'auprc': 0.9944502779441594, 'loss_val': 0.07297979643450214, 'psi': 0.9944975752567004}
[S11] START round=23 head_norm_before_train=1.828103 (no previous merge yet)
[S11] round=23 local utility u=0.004615 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9984900030062132, 'loss_val': 0.05025100683244646, 'psi': 0.997191381015553}-{'f1_val': 0.996567470639547, 'auprc': 0.9984391757430523, 'loss_val': 0.060779512543129494, 'psi': 0.9973161526809491}
[S13] START round=23 head_norm_before_train=1.546209 cos_to_last_merge=0.9981 (last merge round=19)
[S13] round=23 local utility u=0.247825 metrics={'f1_val': 0.6485577296195193, 'auprc': 0.6728659215314191, 'loss_val': 0.5123541396420462, 'psi': 0.6582810063842792}-{'f1_val': 0.6138394431140596, 'auprc': 0.629669073652782, 'loss_val': 0.6701028980521069, 'psi': 0.6201712953295485}
[S14] START round=23 head_norm_before_train=1.605578 cos_to_last_merge=0.8378 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.838
[S14] round=23 local utility u=0.001902 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9964799559387127, 'loss_val': 0.05556064338110991, 'psi': 0.996690030470812}-{'f1_val': 0.9976483782674455, 'auprc': 0.9955671512873414, 'loss_val': 0.06153506963184912, 'psi': 0.9968158874754038}
[S15] START round=23 head_norm_before_train=1.597555 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.9109198243677132, 'auprc': 0.9919831880264885, 'loss_val': 0.17890623738550143, 'psi': 0.9433451698312234}-{'f1_val': 0.9938830298648659, 'auprc': 0.9925988876726018, 'loss_val': 0.1582448323547806, 'psi': 0.9933693729879602}
[S16] START round=23 head_norm_before_train=1.611215 cos_to_last_merge=0.8252 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.825
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8747296034718095, 'auprc': 0.997283340237205, 'loss_val': 0.4692048937292572, 'psi': 0.9237510981779676}-{'f1_val': 0.9022007233612653, 'auprc': 0.9963272967764917, 'loss_val': 0.35553973783871234, 'psi': 0.939851352727356}
[S17] START round=23 head_norm_before_train=1.019790 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.071723 metrics={'f1_val': 0.4764274583641479, 'auprc': 0.7123030465611059, 'loss_val': 0.7084249601362232, 'psi': 0.5707776936429311}-{'f1_val': 0.39418340490972636, 'auprc': 0.8282038107619566, 'loss_val': 0.706108190713817, 'psi': 0.5677915672506184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:42014
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:42012
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:42015
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:42016
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S10
[S3] cosine check vs S10: cos=0.9941
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.6192
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=-0.0557
[S16] DROPPED delta from S5 (cos=-0.0557 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] cosine check vs S14: cos=0.9975
[S4] RECEIVED delta(kind=head bytes=1805) from S13
[S4] cosine check vs S13: cos=-0.0185
[S4] DROPPED delta from S13 (cos=-0.0185 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] cosine check vs S7: cos=-0.1424
[S14] DROPPED delta from S7 (cos=-0.1424 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1806) from S11
[S13] cosine check vs S11: cos=-0.1279
[S13] DROPPED delta from S11 (cos=-0.1279 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S2
[S13] cosine check vs S2: cos=0.9885
[S11] RECEIVED delta(kind=head bytes=1796) from S6
[S11] cosine check vs S6: cos=-0.1799
[S11] DROPPED delta from S6 (cos=-0.1799 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S4
[S10] cosine check vs S4: cos=-0.0690
[S10] DROPPED delta from S4 (cos=-0.0690 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] cosine check vs S17: cos=-0.0892
[S3] DROPPED delta from S17 (cos=-0.0892 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.9258 head_norm=1.641943
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.142094e-02
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.9450 head_norm=1.613286 delta_norm=0.091421
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.9109 head_norm=1.620992
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.726396e-02
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.9254 head_norm=1.622561 delta_norm=0.057264
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.6486 head_norm=1.559606
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.199492e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.6530 head_norm=1.566953 delta_norm=0.119949
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.4764 head_norm=1.042977
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.388379e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.3893 head_norm=1.207638 delta_norm=0.638838
[S17] aggregate: ROLLBACK (f1_val pre=0.476 post=0.389 tol_abs=0.005 tol_rel=0.0)
[S2] START round=24 head_norm_before_train=1.583379 cos_to_last_merge=0.8243 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.824
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.6649607344209814, 'auprc': 0.7760123259337443, 'loss_val': 0.29694681744982304, 'psi': 0.7093813710260866}-{'f1_val': 0.8184952379684663, 'auprc': 0.782223023421984, 'loss_val': 0.26643942650181895, 'psi': 0.8039863521498734}
[S3] START round=24 head_norm_before_train=1.613286 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.219594 metrics={'f1_val': 0.9866128927318738, 'auprc': 0.9967070457609, 'loss_val': 0.1132926339783212, 'psi': 0.9906505539434843}-{'f1_val': 0.9258238413038519, 'auprc': 0.9957509916076623, 'loss_val': 0.18487750584662577, 'psi': 0.953794701425376}
[S4] START round=24 head_norm_before_train=1.590843 cos_to_last_merge=0.8138 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.814
[S4] round=24 local utility u=0.011399 metrics={'f1_val': 0.622450986783943, 'auprc': 0.9492342983052374, 'loss_val': 0.47487549983112304, 'psi': 0.7531643113924608}-{'f1_val': 0.6214256830631697, 'auprc': 0.9471189224143846, 'loss_val': 0.48517566386205274, 'psi': 0.7517029788036557}
[S5] START round=24 head_norm_before_train=1.901719 (no previous merge yet)
[S5] round=24 local utility u=0.001114 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9986367561972949, 'loss_val': 0.03084975307685547, 'psi': 0.9974302479370598}-{'f1_val': 0.996625909096903, 'auprc': 0.9984072458599933, 'loss_val': 0.032388924163565966, 'psi': 0.9973384438021391}
[S6] START round=24 head_norm_before_train=1.689914 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.7342466751370336, 'auprc': 0.9441440722009248, 'loss_val': 0.6371466172991199, 'psi': 0.81820563396259}-{'f1_val': 0.8125267757757415, 'auprc': 0.9524104010049502, 'loss_val': 0.4762702533975043, 'psi': 0.868480225867425}
[S7] START round=24 head_norm_before_train=1.716968 (no previous merge yet)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.689054912754409, 'auprc': 0.8349901858565266, 'loss_val': 0.32941240260066124, 'psi': 0.7474290219952561}-{'f1_val': 0.7566647186624278, 'auprc': 0.9868319200541265, 'loss_val': 0.1920036874016578, 'psi': 0.8487315992191072}
[S8] START round=24 head_norm_before_train=1.626408 cos_to_last_merge=0.8070 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.807
[S8] round=24 local utility u=0.001175 metrics={'f1_val': 0.9907243993413981, 'auprc': 0.9908107377969744, 'loss_val': 0.05701717263103528, 'psi': 0.9907589347236286}-{'f1_val': 0.9936566772467331, 'auprc': 0.9866886652446127, 'loss_val': 0.0645945606656539, 'psi': 0.990869472445885}
[S9] START round=24 head_norm_before_train=1.844028 cos_to_last_merge=0.8377 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.838
[S9] round=24 local utility u=0.003720 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9976178841500515, 'loss_val': 0.018471920851934512, 'psi': 0.9973089011673063}-{'f1_val': 0.9971029125121428, 'auprc': 0.9953842149046986, 'loss_val': 0.019211698828422906, 'psi': 0.9964154334691652}
[S10] START round=24 head_norm_before_train=1.589377 cos_to_last_merge=0.8153 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.815
[S10] round=24 local utility u=0.003398 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9962310817664195, 'loss_val': 0.05836703172350556, 'psi': 0.9943956890124976}-{'f1_val': 0.9929532433629917, 'auprc': 0.996489932958165, 'loss_val': 0.06462591447429059, 'psi': 0.994367919201061}
[S11] START round=24 head_norm_before_train=1.848423 (no previous merge yet)
[S11] round=24 local utility u=0.000434 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9984659309068925, 'loss_val': 0.04828089645717853, 'psi': 0.9970788572092042}-{'f1_val': 0.9963256330217796, 'auprc': 0.9984900030062132, 'loss_val': 0.05025100683244646, 'psi': 0.997191381015553}
[S13] START round=24 head_norm_before_train=1.566953 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5903394365270934, 'auprc': 0.6672846587739448, 'loss_val': 0.7454521112673742, 'psi': 0.621117525425834}-{'f1_val': 0.6485577296195193, 'auprc': 0.6728659215314191, 'loss_val': 0.5123541396420462, 'psi': 0.6582810063842792}
[S14] START round=24 head_norm_before_train=1.626146 cos_to_last_merge=0.8344 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.834
[S14] round=24 local utility u=0.000612 metrics={'f1_val': 0.9963896402394217, 'auprc': 0.9965255060063275, 'loss_val': 0.05183141085540306, 'psi': 0.996443986546184}-{'f1_val': 0.9968300801588782, 'auprc': 0.9964799559387127, 'loss_val': 0.05556064338110991, 'psi': 0.996690030470812}
[S15] START round=24 head_norm_before_train=1.622561 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.277167 metrics={'f1_val': 0.9958336155610112, 'auprc': 0.9940316116407245, 'loss_val': 0.1402000666774039, 'psi': 0.9951128139928966}-{'f1_val': 0.9109198243677132, 'auprc': 0.9919831880264885, 'loss_val': 0.17890623738550143, 'psi': 0.9433451698312234}
[S16] START round=24 head_norm_before_train=1.637592 cos_to_last_merge=0.8230 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.823
[S16] round=24 local utility u=0.550121 metrics={'f1_val': 0.9915742365658657, 'auprc': 0.9945391563981106, 'loss_val': 0.06179890367605781, 'psi': 0.9927602044987637}-{'f1_val': 0.8747296034718095, 'auprc': 0.997283340237205, 'loss_val': 0.4692048937292572, 'psi': 0.9237510981779676}
[S17] START round=24 head_norm_before_train=1.207638 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.3890507240309052, 'auprc': 0.7089610629209985, 'loss_val': 0.7001065507452288, 'psi': 0.5170148595869425}-{'f1_val': 0.4764274583641479, 'auprc': 0.7123030465611059, 'loss_val': 0.7084249601362232, 'psi': 0.5707776936429311}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:42011
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:42007
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:42005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:42008
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S11
[S6] cosine check vs S11: cos=-0.1811
[S6] DROPPED delta from S11 (cos=-0.1811 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S9
[S3] cosine check vs S9: cos=-0.0227
[S3] DROPPED delta from S9 (cos=-0.0227 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S16
[S5] cosine check vs S16: cos=-0.0542
[S5] DROPPED delta from S16 (cos=-0.0542 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=-0.0703
[S4] DROPPED delta from S10 (cos=-0.0703 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S3
[S10] cosine check vs S3: cos=0.9955
[S13] RECEIVED delta(kind=head bytes=1799) from S4
[S13] cosine check vs S4: cos=-0.0147
[S13] DROPPED delta from S4 (cos=-0.0147 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=0.9979
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=-0.1440
[S7] DROPPED delta from S14 (cos=-0.1440 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9964 head_norm=1.647884
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.349061e-02
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9964 head_norm=1.647720 delta_norm=0.053491
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=24 metric=0.9932 head_norm=1.610523
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.106623e-02
[S10] stored merged vector for next round verification (round=24)
[S10] DEBUG after merge:  round=24 metric=0.9932 head_norm=1.632168 delta_norm=0.081066
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.598894 cos_to_last_merge=0.8239 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.824
[S2] round=25 local utility u=0.206864 metrics={'f1_val': 0.7200274379619908, 'auprc': 0.7943666377750929, 'loss_val': 0.2686810768889949, 'psi': 0.7497631178872317}-{'f1_val': 0.6649607344209814, 'auprc': 0.7760123259337443, 'loss_val': 0.29694681744982304, 'psi': 0.7093813710260866}
[S3] START round=25 head_norm_before_train=1.657500 cos_to_last_merge=0.9992 (last merge round=23)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.8914319928643797, 'auprc': 0.9214616622979233, 'loss_val': 0.25585243957883297, 'psi': 0.9034438606377971}-{'f1_val': 0.9866128927318738, 'auprc': 0.9967070457609, 'loss_val': 0.1132926339783212, 'psi': 0.9906505539434843}
[S4] START round=25 head_norm_before_train=1.602269 cos_to_last_merge=0.8131 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.813
[S4] round=25 local utility u=0.985827 metrics={'f1_val': 0.9471135201694358, 'auprc': 0.944035784580193, 'loss_val': 0.4356020436000785, 'psi': 0.9458824259337387}-{'f1_val': 0.622450986783943, 'auprc': 0.9492342983052374, 'loss_val': 0.47487549983112304, 'psi': 0.7531643113924608}
[S5] START round=25 head_norm_before_train=1.917867 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9984253630645491, 'loss_val': 0.029574308088778492, 'psi': 0.9972578333974578}-{'f1_val': 0.996625909096903, 'auprc': 0.9986367561972949, 'loss_val': 0.03084975307685547, 'psi': 0.9974302479370598}
[S6] START round=25 head_norm_before_train=1.704316 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.7081972702368542, 'auprc': 0.9064784941059737, 'loss_val': 0.696425745987736, 'psi': 0.787509759784502}-{'f1_val': 0.7342466751370336, 'auprc': 0.9441440722009248, 'loss_val': 0.6371466172991199, 'psi': 0.81820563396259}
[S7] START round=25 head_norm_before_train=1.729392 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.6728012049947698, 'auprc': 0.830449903263019, 'loss_val': 0.3509603180181777, 'psi': 0.7358606843020695}-{'f1_val': 0.689054912754409, 'auprc': 0.8349901858565266, 'loss_val': 0.32941240260066124, 'psi': 0.7474290219952561}
[S8] START round=25 head_norm_before_train=1.651191 cos_to_last_merge=0.8029 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.803
[S8] round=25 local utility u=0.003760 metrics={'f1_val': 0.9931069890632681, 'auprc': 0.9869813406073843, 'loss_val': 0.05230484733142482, 'psi': 0.9906567296809146}-{'f1_val': 0.9907243993413981, 'auprc': 0.9908107377969744, 'loss_val': 0.05701717263103528, 'psi': 0.9907589347236286}
[S9] START round=25 head_norm_before_train=1.860454 cos_to_last_merge=0.8363 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.836
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9971267289738366, 'loss_val': 0.018378587459663625, 'psi': 0.9971124390968203}-{'f1_val': 0.9971029125121428, 'auprc': 0.9976178841500515, 'loss_val': 0.018471920851934512, 'psi': 0.9973089011673063}
[S10] START round=25 head_norm_before_train=1.632168 cos_to_last_merge=1.0000 (last merge round=24)
[S10] round=25 local utility u=0.003827 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9939337784459246, 'loss_val': 0.05459747103313188, 'psi': 0.9945544232974155}-{'f1_val': 0.9931720938432163, 'auprc': 0.9962310817664195, 'loss_val': 0.05836703172350556, 'psi': 0.9943956890124976}
[S11] START round=25 head_norm_before_train=1.868755 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9965919014202035, 'auprc': 0.9971863034691597, 'loss_val': 0.06596339039405738, 'psi': 0.996829662239786}-{'f1_val': 0.9961541414107454, 'auprc': 0.9984659309068925, 'loss_val': 0.04828089645717853, 'psi': 0.9970788572092042}
[S13] START round=25 head_norm_before_train=1.580555 cos_to_last_merge=0.9998 (last merge round=23)
[S13] round=25 local utility u=0.028374 metrics={'f1_val': 0.6076136162652075, 'auprc': 0.6383475520861638, 'loss_val': 0.7055387097243049, 'psi': 0.61990719059359}-{'f1_val': 0.5903394365270934, 'auprc': 0.6672846587739448, 'loss_val': 0.7454521112673742, 'psi': 0.621117525425834}
[S14] START round=25 head_norm_before_train=1.647720 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000195 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9955285422246971, 'loss_val': 0.05454682024685095, 'psi': 0.9966547347214694}-{'f1_val': 0.9963896402394217, 'auprc': 0.9965255060063275, 'loss_val': 0.05183141085540306, 'psi': 0.996443986546184}
[S15] START round=25 head_norm_before_train=1.649292 cos_to_last_merge=0.9996 (last merge round=23)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.7001698709267209, 'auprc': 0.9691898797946029, 'loss_val': 0.3515019131391849, 'psi': 0.8077778744738737}-{'f1_val': 0.9958336155610112, 'auprc': 0.9940316116407245, 'loss_val': 0.1402000666774039, 'psi': 0.9951128139928966}
[S16] START round=25 head_norm_before_train=1.660759 cos_to_last_merge=0.8211 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.821
[S16] round=25 local utility u=0.000960 metrics={'f1_val': 0.9913761943236954, 'auprc': 0.9941410762596856, 'loss_val': 0.057496177143992126, 'psi': 0.9924821470980916}-{'f1_val': 0.9915742365658657, 'auprc': 0.9945391563981106, 'loss_val': 0.06179890367605781, 'psi': 0.9927602044987637}
[S17] START round=25 head_norm_before_train=1.225445 cos_to_last_merge=0.9991 (last merge round=23)
[S17] round=25 local utility u=0.337676 metrics={'f1_val': 0.48132128371665833, 'auprc': 0.7426750319511244, 'loss_val': 0.6795205486971102, 'psi': 0.5858627830104448}-{'f1_val': 0.3890507240309052, 'auprc': 0.7089610629209985, 'loss_val': 0.7001065507452288, 'psi': 0.5170148595869425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:42005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:42008
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:42013
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:42012
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=-0.1472
[S7] DROPPED delta from S14 (cos=-0.1472 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S13
[S11] cosine check vs S13: cos=-0.1325
[S11] DROPPED delta from S13 (cos=-0.1325 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1804) from S10
[S4] cosine check vs S10: cos=-0.0710
[S4] DROPPED delta from S10 (cos=-0.0710 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1804) from S4
[S13] cosine check vs S4: cos=-0.0149
[S13] DROPPED delta from S4 (cos=-0.0149 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S16
[S5] cosine check vs S16: cos=-0.0536
[S5] DROPPED delta from S16 (cos=-0.0536 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:42016
[S17] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S17
[S16] cosine check vs S17: cos=0.1734
[S9] ⇄ pheromone p=0.015 → S3@127.0.0.1:42003
[S11] ⇄ pheromone p=0.031 → S6@127.0.0.1:42007
[S3] ⇄ pheromone p=0.085 → S10@127.0.0.1:42011
[S10] ⇄ pheromone p=0.051 → S4@127.0.0.1:42004
[S13] ⇄ pheromone p=0.091 → S11@127.0.0.1:42012
[S4] ⇄ pheromone p=0.234 → S13@127.0.0.1:42013
[S14] ⇄ pheromone p=0.048 → S7@127.0.0.1:42008
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.9914 head_norm=1.682338
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.554353e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.9913 head_norm=1.129446 delta_norm=0.955435
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.197 → S5@127.0.0.1:42005
[S15] ⇄ pheromone p=0.212 → S14@127.0.0.1:42014
[S17] ⇄ pheromone p=0.122 → S16@127.0.0.1:42016
[S2] START round=26 head_norm_before_train=1.613862 cos_to_last_merge=0.8231 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.823
[S2] round=26 local utility u=0.030815 metrics={'f1_val': 0.7496535629968568, 'auprc': 0.7720060187286016, 'loss_val': 0.31772502286839466, 'psi': 0.7585945452895547}-{'f1_val': 0.7200274379619908, 'auprc': 0.7943666377750929, 'loss_val': 0.2686810768889949, 'psi': 0.7497631178872317}
[S3] START round=26 head_norm_before_train=1.696425 cos_to_last_merge=0.9975 (last merge round=23)
[S3] round=26 local utility u=0.232614 metrics={'f1_val': 0.9194071573772031, 'auprc': 0.9948558281293641, 'loss_val': 0.17865844061714217, 'psi': 0.9495866256780676}-{'f1_val': 0.8914319928643797, 'auprc': 0.9214616622979233, 'loss_val': 0.25585243957883297, 'psi': 0.9034438606377971}
[S4] START round=26 head_norm_before_train=1.617416 cos_to_last_merge=0.8117 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.812
[S4] round=26 local utility u=0.090438 metrics={'f1_val': 0.9570884805252605, 'auprc': 0.9549479777740505, 'loss_val': 0.3473123972910435, 'psi': 0.9562322794247765}-{'f1_val': 0.9471135201694358, 'auprc': 0.944035784580193, 'loss_val': 0.4356020436000785, 'psi': 0.9458824259337387}
[S5] START round=26 head_norm_before_train=1.931665 (no previous merge yet)
[S5] round=26 local utility u=0.001229 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9984117350374285, 'loss_val': 0.027954022357681328, 'psi': 0.9973402394731132}-{'f1_val': 0.9964794802860635, 'auprc': 0.9984253630645491, 'loss_val': 0.029574308088778492, 'psi': 0.9972578333974578}
[S6] START round=26 head_norm_before_train=1.718426 (no previous merge yet)
[S6] round=26 local utility u=0.221285 metrics={'f1_val': 0.7598570928369788, 'auprc': 0.9178134147287587, 'loss_val': 0.5978192389340412, 'psi': 0.8230396215936907}-{'f1_val': 0.7081972702368542, 'auprc': 0.9064784941059737, 'loss_val': 0.696425745987736, 'psi': 0.787509759784502}
[S7] START round=26 head_norm_before_train=1.739037 (no previous merge yet)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5571539753771946, 'auprc': 0.7872138546808312, 'loss_val': 0.8123457028626813, 'psi': 0.6491779270986492}-{'f1_val': 0.6728012049947698, 'auprc': 0.830449903263019, 'loss_val': 0.3509603180181777, 'psi': 0.7358606843020695}
[S8] START round=26 head_norm_before_train=1.672738 cos_to_last_merge=0.8013 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.801
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9877157558738866, 'auprc': 0.99834017532868, 'loss_val': 0.05598718131458189, 'psi': 0.991965523655804}-{'f1_val': 0.9931069890632681, 'auprc': 0.9869813406073843, 'loss_val': 0.05230484733142482, 'psi': 0.9906567296809146}
[S9] START round=26 head_norm_before_train=1.872255 cos_to_last_merge=0.8349 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.835
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.990399656971262, 'auprc': 0.9997490510084439, 'loss_val': 0.0344278947759782, 'psi': 0.9941394145861348}-{'f1_val': 0.9971029125121428, 'auprc': 0.9971267289738366, 'loss_val': 0.018378587459663625, 'psi': 0.9971124390968203}
[S10] START round=26 head_norm_before_train=1.655944 cos_to_last_merge=0.9999 (last merge round=24)
[S10] round=26 local utility u=0.001362 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9952786246560678, 'loss_val': 0.049325129900579204, 'psi': 0.994434077492754}-{'f1_val': 0.9949681865317428, 'auprc': 0.9939337784459246, 'loss_val': 0.05459747103313188, 'psi': 0.9945544232974155}
[S11] START round=26 head_norm_before_train=1.890740 (no previous merge yet)
[S11] round=26 local utility u=0.014698 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9985585804882653, 'loss_val': 0.0380585684034478, 'psi': 0.9971159170417534}-{'f1_val': 0.9965919014202035, 'auprc': 0.9971863034691597, 'loss_val': 0.06596339039405738, 'psi': 0.996829662239786}
[S13] START round=26 head_norm_before_train=1.597354 cos_to_last_merge=0.9994 (last merge round=23)
[S13] round=26 local utility u=0.162152 metrics={'f1_val': 0.6281046613173676, 'auprc': 0.6719014007225823, 'loss_val': 0.6048416124016158, 'psi': 0.6456233570794535}-{'f1_val': 0.6076136162652075, 'auprc': 0.6383475520861638, 'loss_val': 0.7055387097243049, 'psi': 0.61990719059359}
[S14] START round=26 head_norm_before_train=1.667435 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=26 local utility u=0.004392 metrics={'f1_val': 0.9976483782674455, 'auprc': 0.9955680827568774, 'loss_val': 0.04733953194513802, 'psi': 0.9968162600632182}-{'f1_val': 0.9974055297193176, 'auprc': 0.9955285422246971, 'loss_val': 0.05454682024685095, 'psi': 0.9966547347214694}
[S15] START round=26 head_norm_before_train=1.673538 cos_to_last_merge=0.9987 (last merge round=23)
[S15] round=26 local utility u=1.000000 metrics={'f1_val': 0.9897459504511322, 'auprc': 0.9897661850164239, 'loss_val': 0.1095816059876466, 'psi': 0.989754044277249}-{'f1_val': 0.7001698709267209, 'auprc': 0.9691898797946029, 'loss_val': 0.3515019131391849, 'psi': 0.8077778744738737}
[S16] START round=26 head_norm_before_train=1.129446 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.857461438091461, 'auprc': 0.9948250683026848, 'loss_val': 0.4695274667289622, 'psi': 0.9124068901759506}-{'f1_val': 0.9913761943236954, 'auprc': 0.9941410762596856, 'loss_val': 0.057496177143992126, 'psi': 0.9924821470980916}
[S17] START round=26 head_norm_before_train=1.243683 cos_to_last_merge=0.9971 (last merge round=23)
[S17] round=26 local utility u=0.018468 metrics={'f1_val': 0.45063208224144113, 'auprc': 0.8086325610493101, 'loss_val': 0.656320995804819, 'psi': 0.5938322737645887}-{'f1_val': 0.48132128371665833, 'auprc': 0.7426750319511244, 'loss_val': 0.6795205486971102, 'psi': 0.5858627830104448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:42007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:42004
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:42008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:42016
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S3
[S10] cosine check vs S3: cos=0.9948
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=-0.0576
[S16] DROPPED delta from S5 (cos=-0.0576 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S11
[S6] cosine check vs S11: cos=-0.1822
[S6] DROPPED delta from S11 (cos=-0.1822 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1804) from S4
[S13] cosine check vs S4: cos=-0.0156
[S13] DROPPED delta from S4 (cos=-0.0156 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=-0.0715
[S4] DROPPED delta from S10 (cos=-0.0715 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1804) from S13
[S4] cosine check vs S13: cos=-0.0156
[S4] DROPPED delta from S13 (cos=-0.0156 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=0.9971
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] cosine check vs S6: cos=-0.1822
[S11] DROPPED delta from S6 (cos=-0.1822 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=-0.1481
[S7] DROPPED delta from S14 (cos=-0.1481 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:42016
[S17] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S17
[S16] cosine check vs S17: cos=0.6649
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9976 head_norm=1.686817
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.411857e-02
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9976 head_norm=1.690444 delta_norm=0.064119
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.9939 head_norm=1.679590
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.975930e-02
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.9939 head_norm=1.701293 delta_norm=0.089759
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.8575 head_norm=1.167616
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.995747e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.8644 head_norm=1.109365 delta_norm=0.499575
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.626289 cos_to_last_merge=0.8223 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.822
[S2] round=27 local utility u=0.314176 metrics={'f1_val': 0.7900348724071018, 'auprc': 0.8708031578857179, 'loss_val': 0.22805262622994452, 'psi': 0.8223421865985483}-{'f1_val': 0.7496535629968568, 'auprc': 0.7720060187286016, 'loss_val': 0.31772502286839466, 'psi': 0.7585945452895547}
[S3] START round=27 head_norm_before_train=1.727393 cos_to_last_merge=0.9957 (last merge round=23)
[S3] round=27 local utility u=0.147581 metrics={'f1_val': 0.9601460646946383, 'auprc': 0.9983896228404661, 'loss_val': 0.1385304937007399, 'psi': 0.9754434879529694}-{'f1_val': 0.9194071573772031, 'auprc': 0.9948558281293641, 'loss_val': 0.17865844061714217, 'psi': 0.9495866256780676}
[S4] START round=27 head_norm_before_train=1.628625 cos_to_last_merge=0.8109 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.811
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.94461338749814, 'auprc': 0.9612094410274774, 'loss_val': 0.32391094176818885, 'psi': 0.9512518089098749}-{'f1_val': 0.9570884805252605, 'auprc': 0.9549479777740505, 'loss_val': 0.3473123972910435, 'psi': 0.9562322794247765}
[S5] START round=27 head_norm_before_train=1.950889 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9957107362291499, 'loss_val': 0.026697884994697683, 'psi': 0.996171982663298}-{'f1_val': 0.996625909096903, 'auprc': 0.9984117350374285, 'loss_val': 0.027954022357681328, 'psi': 0.9973402394731132}
[S6] START round=27 head_norm_before_train=1.733359 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.6814855915872027, 'auprc': 0.9122066206590229, 'loss_val': 0.7710708811442887, 'psi': 0.7737740032159308}-{'f1_val': 0.7598570928369788, 'auprc': 0.9178134147287587, 'loss_val': 0.5978192389340412, 'psi': 0.8230396215936907}
[S7] START round=27 head_norm_before_train=1.747677 (no previous merge yet)
[S7] round=27 local utility u=0.766922 metrics={'f1_val': 0.6976669962820359, 'auprc': 0.854331833632382, 'loss_val': 0.32293295192958693, 'psi': 0.7603329312221743}-{'f1_val': 0.5571539753771946, 'auprc': 0.7872138546808312, 'loss_val': 0.8123457028626813, 'psi': 0.6491779270986492}
[S8] START round=27 head_norm_before_train=1.692811 cos_to_last_merge=0.7989 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.799
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9927318893430277, 'auprc': 0.9853549411238189, 'loss_val': 0.048017454330663435, 'psi': 0.9897811100553442}-{'f1_val': 0.9877157558738866, 'auprc': 0.99834017532868, 'loss_val': 0.05598718131458189, 'psi': 0.991965523655804}
[S9] START round=27 head_norm_before_train=1.884631 cos_to_last_merge=0.8337 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.834
[S9] round=27 local utility u=0.023379 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9963714858204178, 'loss_val': 0.017757323057506883, 'psi': 0.9968103418354528}-{'f1_val': 0.990399656971262, 'auprc': 0.9997490510084439, 'loss_val': 0.0344278947759782, 'psi': 0.9941394145861348}
[S10] START round=27 head_norm_before_train=1.701293 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.000717 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9960346307792137, 'loss_val': 0.045965616715246016, 'psi': 0.9943171086176152}-{'f1_val': 0.993871046050545, 'auprc': 0.9952786246560678, 'loss_val': 0.049325129900579204, 'psi': 0.994434077492754}
[S11] START round=27 head_norm_before_train=1.912239 (no previous merge yet)
[S11] round=27 local utility u=0.003159 metrics={'f1_val': 0.996567470639547, 'auprc': 0.998599358113228, 'loss_val': 0.034343734010629734, 'psi': 0.9973802256290194}-{'f1_val': 0.9961541414107454, 'auprc': 0.9985585804882653, 'loss_val': 0.0380585684034478, 'psi': 0.9971159170417534}
[S13] START round=27 head_norm_before_train=1.611793 cos_to_last_merge=0.9988 (last merge round=23)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5917909351819425, 'auprc': 0.6706819578654017, 'loss_val': 0.7619710840696965, 'psi': 0.6233473442553261}-{'f1_val': 0.6281046613173676, 'auprc': 0.6719014007225823, 'loss_val': 0.6048416124016158, 'psi': 0.6456233570794535}
[S14] START round=27 head_norm_before_train=1.690444 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.001394 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9956377724391694, 'loss_val': 0.04331956042888846, 'psi': 0.9967000706767031}-{'f1_val': 0.9976483782674455, 'auprc': 0.9955680827568774, 'loss_val': 0.04733953194513802, 'psi': 0.9968162600632182}
[S15] START round=27 head_norm_before_train=1.696488 cos_to_last_merge=0.9976 (last merge round=23)
[S15] round=27 local utility u=0.023269 metrics={'f1_val': 0.996248502210966, 'auprc': 0.9909389989849902, 'loss_val': 0.1055770509432891, 'psi': 0.9941247009205756}-{'f1_val': 0.9897459504511322, 'auprc': 0.9897661850164239, 'loss_val': 0.1095816059876466, 'psi': 0.989754044277249}
[S16] START round=27 head_norm_before_train=1.109365 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.024579 metrics={'f1_val': 0.8650831924316706, 'auprc': 0.9964362784745209, 'loss_val': 0.4709332601778132, 'psi': 0.9176244268488107}-{'f1_val': 0.857461438091461, 'auprc': 0.9948250683026848, 'loss_val': 0.4695274667289622, 'psi': 0.9124068901759506}
[S17] START round=27 head_norm_before_train=1.263804 cos_to_last_merge=0.9945 (last merge round=23)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.408606374729818, 'auprc': 0.8244985551318634, 'loss_val': 0.6467136741295878, 'psi': 0.5749632468906362}-{'f1_val': 0.45063208224144113, 'auprc': 0.8086325610493101, 'loss_val': 0.656320995804819, 'psi': 0.5938322737645887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:42008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:42014
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:42014
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:42007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:42011
[S15] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=-0.0311
[S3] DROPPED delta from S9 (cos=-0.0311 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S16
[S17] cosine check vs S16: cos=0.8935
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=-0.0710
[S4] DROPPED delta from S10 (cos=-0.0710 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=-0.1488
[S14] DROPPED delta from S7 (cos=-0.1488 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] cosine check vs S15: cos=0.9985
[S10] RECEIVED delta(kind=head bytes=1793) from S3
[S10] cosine check vs S3: cos=0.9977
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=-0.1488
[S7] DROPPED delta from S14 (cos=-0.1488 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S11
[S6] cosine check vs S11: cos=-0.1822
[S6] DROPPED delta from S11 (cos=-0.1822 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=27 metric=0.9932 head_norm=1.723532
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.963832e-02
[S10] stored merged vector for next round verification (round=27)
[S10] DEBUG after merge:  round=27 metric=0.9934 head_norm=1.735217 delta_norm=0.059638
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9974 head_norm=1.708800
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.789385e-02
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9974 head_norm=1.712638 delta_norm=0.047894
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.4086 head_norm=1.284700
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.884662e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.4159 head_norm=1.189730 delta_norm=0.288466
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S2] START round=28 head_norm_before_train=1.638297 cos_to_last_merge=0.8215 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.822
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7549605625342926, 'auprc': 0.7671604920842671, 'loss_val': 0.3509974611754992, 'psi': 0.7598405343542824}-{'f1_val': 0.7900348724071018, 'auprc': 0.8708031578857179, 'loss_val': 0.22805262622994452, 'psi': 0.8223421865985483}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=28 head_norm_before_train=1.748858 cos_to_last_merge=0.9943 (last merge round=23)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9683962351338649, 'auprc': 0.9613807915359303, 'loss_val': 0.14757869268308402, 'psi': 0.965590057694691}-{'f1_val': 0.9601460646946383, 'auprc': 0.9983896228404661, 'loss_val': 0.1385304937007399, 'psi': 0.9754434879529694}
[S4] START round=28 head_norm_before_train=1.641289 cos_to_last_merge=0.8101 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.810
[S4] round=28 local utility u=0.026438 metrics={'f1_val': 0.9442088481900579, 'auprc': 0.9716968579058483, 'loss_val': 0.3000689889473072, 'psi': 0.955204052076374}-{'f1_val': 0.94461338749814, 'auprc': 0.9612094410274774, 'loss_val': 0.32391094176818885, 'psi': 0.9512518089098749}
[S5] START round=28 head_norm_before_train=1.972513 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9946830915489526, 'loss_val': 0.02645052119752323, 'psi': 0.9957609247912191}-{'f1_val': 0.9964794802860635, 'auprc': 0.9957107362291499, 'loss_val': 0.026697884994697683, 'psi': 0.996171982663298}
[S6] START round=28 head_norm_before_train=1.745106 (no previous merge yet)
[S6] round=28 local utility u=0.881456 metrics={'f1_val': 0.8679172354029232, 'auprc': 0.9701123347059656, 'loss_val': 0.3004662111452383, 'psi': 0.9087952751241402}-{'f1_val': 0.6814855915872027, 'auprc': 0.9122066206590229, 'loss_val': 0.7710708811442887, 'psi': 0.7737740032159308}
[S7] START round=28 head_norm_before_train=1.754051 (no previous merge yet)
[S7] round=28 local utility u=0.062214 metrics={'f1_val': 0.6984773709663084, 'auprc': 0.879192330931326, 'loss_val': 0.2779491586710829, 'psi': 0.7707633549523154}-{'f1_val': 0.6976669962820359, 'auprc': 0.854331833632382, 'loss_val': 0.32293295192958693, 'psi': 0.7603329312221743}
[S8] START round=28 head_norm_before_train=1.711836 cos_to_last_merge=0.7959 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.796
[S8] round=28 local utility u=0.001903 metrics={'f1_val': 0.9918532151771823, 'auprc': 0.9879386864536456, 'loss_val': 0.046690212857585005, 'psi': 0.9902874036877676}-{'f1_val': 0.9927318893430277, 'auprc': 0.9853549411238189, 'loss_val': 0.048017454330663435, 'psi': 0.9897811100553442}
[S9] START round=28 head_norm_before_train=1.896262 cos_to_last_merge=0.8328 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.833
[S9] round=28 local utility u=0.002795 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9979630921787962, 'loss_val': 0.016941951608592798, 'psi': 0.9974469843788042}-{'f1_val': 0.9971029125121428, 'auprc': 0.9963714858204178, 'loss_val': 0.017757323057506883, 'psi': 0.9968103418354528}
[S10] START round=28 head_norm_before_train=1.735217 cos_to_last_merge=1.0000 (last merge round=27)
[S10] round=28 local utility u=0.002218 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9953534129864223, 'loss_val': 0.04368029726531152, 'psi': 0.994463992824896}-{'f1_val': 0.9931720938432163, 'auprc': 0.9960346307792137, 'loss_val': 0.045965616715246016, 'psi': 0.9943171086176152}
[S11] START round=28 head_norm_before_train=1.930440 (no previous merge yet)
[S11] round=28 local utility u=0.001214 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9985134283489037, 'loss_val': 0.03165788420259808, 'psi': 0.9973458537232898}-{'f1_val': 0.996567470639547, 'auprc': 0.998599358113228, 'loss_val': 0.034343734010629734, 'psi': 0.9973802256290194}
[S13] START round=28 head_norm_before_train=1.624686 cos_to_last_merge=0.9981 (last merge round=23)
[S13] round=28 local utility u=0.186243 metrics={'f1_val': 0.6324241386725259, 'auprc': 0.6532866507488584, 'loss_val': 0.5810980106549583, 'psi': 0.6407691435030589}-{'f1_val': 0.5917909351819425, 'auprc': 0.6706819578654017, 'loss_val': 0.7619710840696965, 'psi': 0.6233473442553261}
[S14] START round=28 head_norm_before_train=1.712638 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9619915771706287, 'auprc': 0.9955922762918428, 'loss_val': 0.0651001876433248, 'psi': 0.9754318568191144}-{'f1_val': 0.9974082695017256, 'auprc': 0.9956377724391694, 'loss_val': 0.04331956042888846, 'psi': 0.9967000706767031}
[S15] START round=28 head_norm_before_train=1.717802 cos_to_last_merge=0.9964 (last merge round=23)
[S15] round=28 local utility u=0.005176 metrics={'f1_val': 0.9904279158851892, 'auprc': 0.9985096433850416, 'loss_val': 0.08301443032412922, 'psi': 0.9936606068851301}-{'f1_val': 0.996248502210966, 'auprc': 0.9909389989849902, 'loss_val': 0.1055770509432891, 'psi': 0.9941247009205756}
[S16] START round=28 head_norm_before_train=1.160554 cos_to_last_merge=0.9971 (last merge round=26)
[S16] round=28 local utility u=0.335826 metrics={'f1_val': 0.9411607240283303, 'auprc': 0.9949294060120524, 'loss_val': 0.2512255947910585, 'psi': 0.9626681968218191}-{'f1_val': 0.8650831924316706, 'auprc': 0.9964362784745209, 'loss_val': 0.4709332601778132, 'psi': 0.9176244268488107}
[S17] START round=28 head_norm_before_train=1.189730 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.058771 metrics={'f1_val': 0.42585539251604876, 'auprc': 0.8264349626372778, 'loss_val': 0.6384758767550889, 'psi': 0.5860872205645404}-{'f1_val': 0.408606374729818, 'auprc': 0.8244985551318634, 'loss_val': 0.6467136741295878, 'psi': 0.5749632468906362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:42014
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:42012
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=-0.1496
[S14] DROPPED delta from S7 (cos=-0.1496 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S6
[S11] cosine check vs S6: cos=-0.1825
[S11] DROPPED delta from S6 (cos=-0.1825 < 0.0)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:42013
[S4] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S4
[S13] cosine check vs S4: cos=-0.0172
[S13] DROPPED delta from S4 (cos=-0.0172 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S10]  timeout peer S2
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S4]  timeout peer S8
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S8]  timeout peer S4
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S13]  timeout peer S3
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S16
[S14]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S14
[S11]  timeout peer S16
[S11]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:42003
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:42007
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] cosine check vs S16: cos=0.9497
[S16] RECEIVED delta(kind=head bytes=1796) from S17
[S16] cosine check vs S17: cos=0.9497
[S4] RECEIVED delta(kind=head bytes=1805) from S13
[S4] cosine check vs S13: cos=-0.0172
[S4] DROPPED delta from S13 (cos=-0.0172 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S11
[S6] cosine check vs S11: cos=-0.1825
[S6] DROPPED delta from S11 (cos=-0.1825 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1793) from S9
[S3] cosine check vs S9: cos=-0.0322
[S3] DROPPED delta from S9 (cos=-0.0322 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] cosine check vs S10: cos=-0.0703
[S4] DROPPED delta from S10 (cos=-0.0703 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=0.9990
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9620 head_norm=1.730336
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.831420e-02
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9611 head_norm=1.733521 delta_norm=0.038314
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.9412 head_norm=1.232199
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.940718e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.9435 head_norm=1.206055 delta_norm=0.194072
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.4259 head_norm=1.210847
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.940718e-01
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.4838 head_norm=1.206055 delta_norm=0.194072
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.647912 cos_to_last_merge=0.8211 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.821
[S2] round=29 local utility u=0.596245 metrics={'f1_val': 0.8451955591104661, 'auprc': 0.9304279871819454, 'loss_val': 0.18971965932152063, 'psi': 0.8792885303390577}-{'f1_val': 0.7549605625342926, 'auprc': 0.7671604920842671, 'loss_val': 0.3509974611754992, 'psi': 0.7598405343542824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=29 head_norm_before_train=1.768941 cos_to_last_merge=0.9929 (last merge round=23)
[S3] round=29 local utility u=0.171579 metrics={'f1_val': 0.9912882673626904, 'auprc': 0.9982702276554081, 'loss_val': 0.05244187529572748, 'psi': 0.9940810514797774}-{'f1_val': 0.9683962351338649, 'auprc': 0.9613807915359303, 'loss_val': 0.14757869268308402, 'psi': 0.965590057694691}
[S4] START round=29 head_norm_before_train=1.653610 cos_to_last_merge=0.8089 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.809
[S4] round=29 local utility u=0.016835 metrics={'f1_val': 0.9435517300389705, 'auprc': 0.9780727109445436, 'loss_val': 0.2815834841092891, 'psi': 0.9573601224011997}-{'f1_val': 0.9442088481900579, 'auprc': 0.9716968579058483, 'loss_val': 0.3000689889473072, 'psi': 0.955204052076374}
[S5] START round=29 head_norm_before_train=1.988354 (no previous merge yet)
[S5] round=29 local utility u=0.001586 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9960655364440624, 'loss_val': 0.025665627407966032, 'psi': 0.9961378285632115}-{'f1_val': 0.9964794802860635, 'auprc': 0.9946830915489526, 'loss_val': 0.02645052119752323, 'psi': 0.9957609247912191}
[S6] START round=29 head_norm_before_train=1.760161 (no previous merge yet)
[S6] round=29 local utility u=0.304014 metrics={'f1_val': 0.9437528631505121, 'auprc': 0.9830986173126561, 'loss_val': 0.18641147727319654, 'psi': 0.9594911648153697}-{'f1_val': 0.8679172354029232, 'auprc': 0.9701123347059656, 'loss_val': 0.3004662111452383, 'psi': 0.9087952751241402}
[S7] START round=29 head_norm_before_train=1.755835 (no previous merge yet)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5815423246201945, 'auprc': 0.7939080036379312, 'loss_val': 0.6857468582480013, 'psi': 0.6664885962272893}-{'f1_val': 0.6984773709663084, 'auprc': 0.879192330931326, 'loss_val': 0.2779491586710829, 'psi': 0.7707633549523154}
[S8] START round=29 head_norm_before_train=1.726715 cos_to_last_merge=0.7946 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.795
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9895051223904946, 'auprc': 0.9934870607591179, 'loss_val': 0.04957701440493787, 'psi': 0.9910978977379439}-{'f1_val': 0.9918532151771823, 'auprc': 0.9879386864536456, 'loss_val': 0.046690212857585005, 'psi': 0.9902874036877676}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=1.908726 cos_to_last_merge=0.8317 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.832
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9967096853058537, 'loss_val': 0.017424711364264753, 'psi': 0.9969456216296272}-{'f1_val': 0.9971029125121428, 'auprc': 0.9979630921787962, 'loss_val': 0.016941951608592798, 'psi': 0.9974469843788042}
[S10] START round=29 head_norm_before_train=1.755271 cos_to_last_merge=0.9999 (last merge round=27)
[S10] round=29 local utility u=0.001556 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9949238511018543, 'loss_val': 0.04191234340785429, 'psi': 0.9945553478319225}-{'f1_val': 0.993871046050545, 'auprc': 0.9953534129864223, 'loss_val': 0.04368029726531152, 'psi': 0.994463992824896}
[S11] START round=29 head_norm_before_train=1.947019 (no previous merge yet)
[S11] round=29 local utility u=0.000973 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9985484779273356, 'loss_val': 0.02981793339639008, 'psi': 0.9973598735546625}-{'f1_val': 0.996567470639547, 'auprc': 0.9985134283489037, 'loss_val': 0.03165788420259808, 'psi': 0.9973458537232898}
[S13] START round=29 head_norm_before_train=1.635610 cos_to_last_merge=0.9974 (last merge round=23)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5712136227730665, 'auprc': 0.6290205987332844, 'loss_val': 0.9234018512659602, 'psi': 0.5943364131571537}-{'f1_val': 0.6324241386725259, 'auprc': 0.6532866507488584, 'loss_val': 0.5810980106549583, 'psi': 0.6407691435030589}
[S14] START round=29 head_norm_before_train=1.733521 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.123894 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9970689428499164, 'loss_val': 0.03569985569286977, 'psi': 0.9974182479698788}-{'f1_val': 0.9619915771706287, 'auprc': 0.9955922762918428, 'loss_val': 0.0651001876433248, 'psi': 0.9754318568191144}
[S15] START round=29 head_norm_before_train=1.737546 cos_to_last_merge=0.9952 (last merge round=23)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.7010443585704017, 'auprc': 0.9889232017283549, 'loss_val': 0.3695172262062633, 'psi': 0.8161958958335831}-{'f1_val': 0.9904279158851892, 'auprc': 0.9985096433850416, 'loss_val': 0.08301443032412922, 'psi': 0.9936606068851301}
[S16] START round=29 head_norm_before_train=1.206055 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8927107517813402, 'auprc': 0.9921358008083347, 'loss_val': 0.4001056655779178, 'psi': 0.932480771392138}-{'f1_val': 0.9411607240283303, 'auprc': 0.9949294060120524, 'loss_val': 0.2512255947910585, 'psi': 0.9626681968218191}
[S17] START round=29 head_norm_before_train=1.206055 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=0.625538 metrics={'f1_val': 0.5991734078055165, 'auprc': 0.8755489765840854, 'loss_val': 0.5746500240032604, 'psi': 0.709723635316944}-{'f1_val': 0.42585539251604876, 'auprc': 0.8264349626372778, 'loss_val': 0.6384758767550889, 'psi': 0.5860872205645404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:42012
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:42008
[S6] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S10] not sending this round → trigger blocked (psi=0.995)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=-0.0506
[S16] DROPPED delta from S5 (cos=-0.0506 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] cosine check vs S6: cos=-0.1826
[S11] DROPPED delta from S6 (cos=-0.1826 < 0.0)
[S14] sending update (kind=head size=1800 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:42011
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=-0.1505
[S7] DROPPED delta from S14 (cos=-0.1505 < 0.0)
[S3] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S3
[S10] cosine check vs S3: cos=0.9981
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:42013
[S11] not sending this round → trigger blocked (psi=0.997)
[S17] not sending this round → trigger blocked (psi=0.710)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=29 metric=0.9943 head_norm=1.771063
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.568311e-02
[S10] stored merged vector for next round verification (round=29)
[S10] DEBUG after merge:  round=29 metric=0.9943 head_norm=1.777662 delta_norm=0.055683
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S4
[S13] cosine check vs S4: cos=-0.0178
[S13] DROPPED delta from S4 (cos=-0.0178 < 0.0)
[S2] START round=30 head_norm_before_train=1.657932 cos_to_last_merge=0.8208 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.821
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.8031793155061386, 'auprc': 0.7514775696935316, 'loss_val': 0.4112072146969729, 'psi': 0.7824986171810958}-{'f1_val': 0.8451955591104661, 'auprc': 0.9304279871819454, 'loss_val': 0.18971965932152063, 'psi': 0.8792885303390577}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.785975 cos_to_last_merge=0.9916 (last merge round=23)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9562710266150495, 'auprc': 0.9932982567799098, 'loss_val': 0.14810735916288154, 'psi': 0.9710819186809936}-{'f1_val': 0.9912882673626904, 'auprc': 0.9982702276554081, 'loss_val': 0.05244187529572748, 'psi': 0.9940810514797774}
[S4] START round=30 head_norm_before_train=1.666635 cos_to_last_merge=0.8075 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.807
[S4] round=30 local utility u=0.043698 metrics={'f1_val': 0.9539835102193917, 'auprc': 0.9803319429651711, 'loss_val': 0.2635562638366887, 'psi': 0.9645228833177035}-{'f1_val': 0.9435517300389705, 'auprc': 0.9780727109445436, 'loss_val': 0.2815834841092891, 'psi': 0.9573601224011997}
[S5] START round=30 head_norm_before_train=1.992383 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9960329371665898, 'loss_val': 0.026047361285594317, 'psi': 0.9961247888522226}-{'f1_val': 0.996186023309311, 'auprc': 0.9960655364440624, 'loss_val': 0.025665627407966032, 'psi': 0.9961378285632115}
[S6] START round=30 head_norm_before_train=1.774733 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.6077629955477328, 'auprc': 0.8979528626394504, 'loss_val': 1.1214486291691161, 'psi': 0.7238389423844198}-{'f1_val': 0.9437528631505121, 'auprc': 0.9830986173126561, 'loss_val': 0.18641147727319654, 'psi': 0.9594911648153697}
[S7] START round=30 head_norm_before_train=1.758408 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5557458458448095, 'auprc': 0.7856556557325205, 'loss_val': 0.8679930613766049, 'psi': 0.6477097697998939}-{'f1_val': 0.5815423246201945, 'auprc': 0.7939080036379312, 'loss_val': 0.6857468582480013, 'psi': 0.6664885962272893}
[S8] START round=30 head_norm_before_train=1.740413 cos_to_last_merge=0.7930 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.793
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9820996140735471, 'auprc': 0.9985681814054588, 'loss_val': 0.06585331143343898, 'psi': 0.9886870410063118}-{'f1_val': 0.9895051223904946, 'auprc': 0.9934870607591179, 'loss_val': 0.04957701440493787, 'psi': 0.9910978977379439}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=1.918269 cos_to_last_merge=0.8305 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.830
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9954400132154921, 'auprc': 0.9999359411739336, 'loss_val': 0.019826978857514825, 'psi': 0.9972383843988687}-{'f1_val': 0.9971029125121428, 'auprc': 0.9967096853058537, 'loss_val': 0.017424711364264753, 'psi': 0.9969456216296272}
[S10] START round=30 head_norm_before_train=1.777662 cos_to_last_merge=1.0000 (last merge round=29)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9929233027381024, 'loss_val': 0.04395696705877219, 'psi': 0.9941502330142866}-{'f1_val': 0.9943096789853013, 'auprc': 0.9949238511018543, 'loss_val': 0.04191234340785429, 'psi': 0.9945553478319225}
[S11] START round=30 head_norm_before_train=1.963420 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9882049638887829, 'auprc': 0.9986099525460899, 'loss_val': 0.05943691004688861, 'psi': 0.9923669593517057}-{'f1_val': 0.996567470639547, 'auprc': 0.9985484779273356, 'loss_val': 0.02981793339639008, 'psi': 0.9973598735546625}
[S13] START round=30 head_norm_before_train=1.645398 cos_to_last_merge=0.9968 (last merge round=23)
[S13] round=30 local utility u=0.398682 metrics={'f1_val': 0.6309866868300341, 'auprc': 0.6637085378169688, 'loss_val': 0.5887407580698287, 'psi': 0.6440754272248079}-{'f1_val': 0.5712136227730665, 'auprc': 0.6290205987332844, 'loss_val': 0.9234018512659602, 'psi': 0.5943364131571537}
[S14] START round=30 head_norm_before_train=1.750836 cos_to_last_merge=0.9999 (last merge round=28)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9921499617343783, 'loss_val': 0.03693561092354759, 'psi': 0.9948123236602016}-{'f1_val': 0.9976511180498535, 'auprc': 0.9970689428499164, 'loss_val': 0.03569985569286977, 'psi': 0.9974182479698788}
[S15] START round=30 head_norm_before_train=1.757286 cos_to_last_merge=0.9939 (last merge round=23)
[S15] round=30 local utility u=1.000000 metrics={'f1_val': 0.9966196520233872, 'auprc': 0.9938279052369887, 'loss_val': 0.05033321838734135, 'psi': 0.9955029533088278}-{'f1_val': 0.7010443585704017, 'auprc': 0.9889232017283549, 'loss_val': 0.3695172262062633, 'psi': 0.8161958958335831}
[S16] START round=30 head_norm_before_train=1.275459 cos_to_last_merge=0.9970 (last merge round=28)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8523555376298984, 'auprc': 0.990366370175318, 'loss_val': 0.5739985466624294, 'psi': 0.9075598706480663}-{'f1_val': 0.8927107517813402, 'auprc': 0.9921358008083347, 'loss_val': 0.4001056655779178, 'psi': 0.932480771392138}
[S17] START round=30 head_norm_before_train=1.226034 cos_to_last_merge=0.9994 (last merge round=28)
[S17] round=30 local utility u=0.086222 metrics={'f1_val': 0.6172193722984635, 'auprc': 0.8874988133169015, 'loss_val': 0.5463311268588572, 'psi': 0.7253311487058387}-{'f1_val': 0.5991734078055165, 'auprc': 0.8755489765840854, 'loss_val': 0.5746500240032604, 'psi': 0.709723635316944}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:42014
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.008 → S3@127.0.0.1:42003
[S6] ⇄ pheromone p=0.253 → S11@127.0.0.1:42012
[S5] ⇄ pheromone p=0.011 → S16@127.0.0.1:42016
[S7] ⇄ pheromone p=0.158 → S14@127.0.0.1:42014
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1805) from S15
[S14] cosine check vs S15: cos=0.9986
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=0.355 → S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:42004
[S13] sending update (kind=head size=1806 to 1 peers)
[S16] ⇄ pheromone p=0.110 → S17@127.0.0.1:42017
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9966 head_norm=1.766061
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.630827e-02
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9966 head_norm=1.770531 delta_norm=0.046308
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.036 → S15@127.0.0.1:42015
[S4] RECEIVED delta(kind=head bytes=1806) from S13
[S4] cosine check vs S13: cos=-0.0173
[S4] DROPPED delta from S13 (cos=-0.0173 < 0.0)
[S3] ⇄ pheromone p=0.090 → S10@127.0.0.1:42011
[S4] not sending this round → trigger blocked (psi=0.965)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:42009
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=0.7837
[S4] ⇄ pheromone p=0.099 → S13@127.0.0.1:42013
[S11] ⇄ pheromone p=0.012 → S6@127.0.0.1:42007
[S13] ⇄ pheromone p=0.147 → S4@127.0.0.1:42004
[S10] ⇄ pheromone p=0.017 → S4@127.0.0.1:42004
[S17] ⇄ pheromone p=0.166 → S8@127.0.0.1:42009
[S2] START round=31 head_norm_before_train=1.667466 cos_to_last_merge=0.8203 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.820
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.708277345000521, 'auprc': 0.824432334739839, 'loss_val': 0.34787137820354896, 'psi': 0.7547393408962482}-{'f1_val': 0.8031793155061386, 'auprc': 0.7514775696935316, 'loss_val': 0.4112072146969729, 'psi': 0.7824986171810958}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=1.802980 cos_to_last_merge=0.9904 (last merge round=23)
[S3] round=31 local utility u=0.168054 metrics={'f1_val': 0.9932158172020483, 'auprc': 0.9984237858332357, 'loss_val': 0.04904526293134524, 'psi': 0.9952990046545233}-{'f1_val': 0.9562710266150495, 'auprc': 0.9932982567799098, 'loss_val': 0.14810735916288154, 'psi': 0.9710819186809936}
[S4] START round=31 head_norm_before_train=1.683367 cos_to_last_merge=0.8055 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.806
[S4] round=31 local utility u=0.001720 metrics={'f1_val': 0.9569084130325927, 'auprc': 0.9748529533382932, 'loss_val': 0.2612294841587932, 'psi': 0.9640862291548729}-{'f1_val': 0.9539835102193917, 'auprc': 0.9803319429651711, 'loss_val': 0.2635562638366887, 'psi': 0.9645228833177035}
[S5] START round=31 head_norm_before_train=1.992530 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9959482890945295, 'loss_val': 0.026632301153353834, 'psi': 0.9960909296233984}-{'f1_val': 0.996186023309311, 'auprc': 0.9960329371665898, 'loss_val': 0.026047361285594317, 'psi': 0.9961247888522226}
[S6] START round=31 head_norm_before_train=1.786920 (no previous merge yet)
[S6] round=31 local utility u=1.000000 metrics={'f1_val': 0.8645091783390065, 'auprc': 0.9387413818578749, 'loss_val': 0.41358408382061057, 'psi': 0.8942020597465539}-{'f1_val': 0.6077629955477328, 'auprc': 0.8979528626394504, 'loss_val': 1.1214486291691161, 'psi': 0.7238389423844198}
[S7] START round=31 head_norm_before_train=1.769987 (no previous merge yet)
[S7] round=31 local utility u=0.482618 metrics={'f1_val': 0.6449546507692889, 'auprc': 0.8029762161325384, 'loss_val': 0.4899718461129107, 'psi': 0.7081632769145887}-{'f1_val': 0.5557458458448095, 'auprc': 0.7856556557325205, 'loss_val': 0.8679930613766049, 'psi': 0.6477097697998939}
[S8] START round=31 head_norm_before_train=1.754047 cos_to_last_merge=0.7916 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.792
[S8] round=31 local utility u=0.014956 metrics={'f1_val': 0.9932810269810869, 'auprc': 0.9843487759841972, 'loss_val': 0.0603705980191028, 'psi': 0.9897081265823311}-{'f1_val': 0.9820996140735471, 'auprc': 0.9985681814054588, 'loss_val': 0.06585331143343898, 'psi': 0.9886870410063118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9933 head_norm=1.762502
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.508696e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9929 head_norm=1.424159 delta_norm=0.550870
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] START round=31 head_norm_before_train=1.930011 cos_to_last_merge=0.8296 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.830
[S9] round=31 local utility u=0.005038 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9999354061010153, 'loss_val': 0.017073078152705472, 'psi': 0.997970469528741}-{'f1_val': 0.9954400132154921, 'auprc': 0.9999359411739336, 'loss_val': 0.019826978857514825, 'psi': 0.9972383843988687}
[S10] START round=31 head_norm_before_train=1.793714 cos_to_last_merge=1.0000 (last merge round=29)
[S10] round=31 local utility u=0.001636 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9961078926699983, 'loss_val': 0.03946281765377068, 'psi': 0.9943464133739291}-{'f1_val': 0.9949681865317428, 'auprc': 0.9929233027381024, 'loss_val': 0.04395696705877219, 'psi': 0.9941502330142866}
[S11] START round=31 head_norm_before_train=1.977726 (no previous merge yet)
[S11] round=31 local utility u=0.039904 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.998553024142061, 'loss_val': 0.028181812869162205, 'psi': 0.9972165894698921}-{'f1_val': 0.9882049638887829, 'auprc': 0.9986099525460899, 'loss_val': 0.05943691004688861, 'psi': 0.9923669593517057}
[S13] START round=31 head_norm_before_train=1.653976 cos_to_last_merge=0.9963 (last merge round=23)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5737136772764142, 'auprc': 0.6738579633677437, 'loss_val': 0.9187367486898727, 'psi': 0.6137713917129459}-{'f1_val': 0.6309866868300341, 'auprc': 0.6637085378169688, 'loss_val': 0.5887407580698287, 'psi': 0.6440754272248079}
[S14] START round=31 head_norm_before_train=1.770531 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.010671 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9978650531294679, 'loss_val': 0.03520096188737441, 'psi': 0.9973445261463862}-{'f1_val': 0.9965872316107504, 'auprc': 0.9921499617343783, 'loss_val': 0.03693561092354759, 'psi': 0.9948123236602016}
[S15] START round=31 head_norm_before_train=1.776198 cos_to_last_merge=0.9927 (last merge round=23)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.9047737315097867, 'auprc': 0.9936576577304939, 'loss_val': 0.1332035159884906, 'psi': 0.9403273019980696}-{'f1_val': 0.9966196520233872, 'auprc': 0.9938279052369887, 'loss_val': 0.05033321838734135, 'psi': 0.9955029533088278}
[S16] START round=31 head_norm_before_train=1.345521 cos_to_last_merge=0.9906 (last merge round=28)
[S16] round=31 local utility u=0.391628 metrics={'f1_val': 0.9325658166717724, 'auprc': 0.9949138774788668, 'loss_val': 0.2856470012685112, 'psi': 0.9575050409946102}-{'f1_val': 0.8523555376298984, 'auprc': 0.990366370175318, 'loss_val': 0.5739985466624294, 'psi': 0.9075598706480663}
[S17] START round=31 head_norm_before_train=1.247782 cos_to_last_merge=0.9978 (last merge round=28)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.5900816915313641, 'auprc': 0.8382315740605183, 'loss_val': 0.5937866210574765, 'psi': 0.6893416445430258}-{'f1_val': 0.6172193722984635, 'auprc': 0.8874988133169015, 'loss_val': 0.5463311268588572, 'psi': 0.7253311487058387}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:42004
[S7] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:42017
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=-0.1523
[S14] DROPPED delta from S7 (cos=-0.1523 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] cosine check vs S6: cos=-0.1829
[S11] DROPPED delta from S6 (cos=-0.1829 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S9
[S3] cosine check vs S9: cos=-0.0352
[S3] DROPPED delta from S9 (cos=-0.0352 < 0.0)
[S16] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:42011
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RECEIVED delta(kind=head bytes=1805) from S16
[S17] cosine check vs S16: cos=0.9778
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=-0.0683
[S4] DROPPED delta from S10 (cos=-0.0683 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] cosine check vs S14: cos=0.9992
[S3] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S3
[S10] cosine check vs S3: cos=0.9985
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:42013
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:42007
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=31 metric=0.9932 head_norm=1.809907
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.067509e-02
[S10] stored merged vector for next round verification (round=31)
[S10] DEBUG after merge:  round=31 metric=0.9932 head_norm=1.815265 delta_norm=0.050675
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S11
[S6] cosine check vs S11: cos=-0.1829
[S6] DROPPED delta from S11 (cos=-0.1829 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S4
[S13] cosine check vs S4: cos=-0.0180
[S13] DROPPED delta from S4 (cos=-0.0180 < 0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.5901 head_norm=1.270665
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.561920e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.5896 head_norm=1.330833 delta_norm=0.156192
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.675133 cos_to_last_merge=0.8204 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.820
[S2] round=32 local utility u=0.501279 metrics={'f1_val': 0.8393779661722529, 'auprc': 0.8681230788441168, 'loss_val': 0.2629889288013959, 'psi': 0.8508760112409984}-{'f1_val': 0.708277345000521, 'auprc': 0.824432334739839, 'loss_val': 0.34787137820354896, 'psi': 0.7547393408962482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=32 head_norm_before_train=1.822017 cos_to_last_merge=0.9891 (last merge round=23)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9607813444027129, 'auprc': 0.9976173699374861, 'loss_val': 0.12350770722936122, 'psi': 0.9755157546166222}-{'f1_val': 0.9932158172020483, 'auprc': 0.9984237858332357, 'loss_val': 0.04904526293134524, 'psi': 0.9952990046545233}
[S4] START round=32 head_norm_before_train=1.700489 cos_to_last_merge=0.8036 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.804
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9563987363717491, 'auprc': 0.9731256102919056, 'loss_val': 0.26107308122778056, 'psi': 0.9630894859398117}-{'f1_val': 0.9569084130325927, 'auprc': 0.9748529533382932, 'loss_val': 0.2612294841587932, 'psi': 0.9640862291548729}
[S5] START round=32 head_norm_before_train=1.995614 (no previous merge yet)
[S5] round=32 local utility u=0.000314 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9958697636062881, 'loss_val': 0.0257684901115944, 'psi': 0.9960595194281019}-{'f1_val': 0.996186023309311, 'auprc': 0.9959482890945295, 'loss_val': 0.026632301153353834, 'psi': 0.9960909296233984}
[S6] START round=32 head_norm_before_train=1.794832 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.8083382588453297, 'auprc': 0.9456841256673363, 'loss_val': 0.41822003846961886, 'psi': 0.8632766055741323}-{'f1_val': 0.8645091783390065, 'auprc': 0.9387413818578749, 'loss_val': 0.41358408382061057, 'psi': 0.8942020597465539}
[S7] START round=32 head_norm_before_train=1.775870 (no previous merge yet)
[S7] round=32 local utility u=0.204661 metrics={'f1_val': 0.6702891305427374, 'auprc': 0.8393819758489983, 'loss_val': 0.34187486767800407, 'psi': 0.7379262686652418}-{'f1_val': 0.6449546507692889, 'auprc': 0.8029762161325384, 'loss_val': 0.4899718461129107, 'psi': 0.7081632769145887}
[S8] START round=32 head_norm_before_train=1.424159 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9933016371923923, 'auprc': 0.9855464782099288, 'loss_val': 0.06846409859816245, 'psi': 0.9901995735994069}-{'f1_val': 0.9932810269810869, 'auprc': 0.9843487759841972, 'loss_val': 0.0603705980191028, 'psi': 0.9897081265823311}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.936945 cos_to_last_merge=0.8288 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.829
[S9] round=32 local utility u=0.001739 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999383067223536, 'loss_val': 0.016258137624928455, 'psi': 0.9982370701962271}-{'f1_val': 0.9966605118138915, 'auprc': 0.9999354061010153, 'loss_val': 0.017073078152705472, 'psi': 0.997970469528741}
[S10] START round=32 head_norm_before_train=1.815265 cos_to_last_merge=1.0000 (last merge round=31)
[S10] round=32 local utility u=0.001185 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9941198841314831, 'loss_val': 0.03927079233349624, 'psi': 0.9943654177316299}-{'f1_val': 0.9931720938432163, 'auprc': 0.9961078926699983, 'loss_val': 0.03946281765377068, 'psi': 0.9943464133739291}
[S11] START round=32 head_norm_before_train=1.988922 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9115367532868003, 'auprc': 0.9976459429466973, 'loss_val': 0.23799429130399918, 'psi': 0.945980429150759}-{'f1_val': 0.9963256330217796, 'auprc': 0.998553024142061, 'loss_val': 0.028181812869162205, 'psi': 0.9972165894698921}
[S13] START round=32 head_norm_before_train=1.662442 cos_to_last_merge=0.9957 (last merge round=23)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5731495819341927, 'auprc': 0.6221775837527203, 'loss_val': 0.9569874348725262, 'psi': 0.5927607826616037}-{'f1_val': 0.5737136772764142, 'auprc': 0.6738579633677437, 'loss_val': 0.9187367486898727, 'psi': 0.6137713917129459}
[S14] START round=32 head_norm_before_train=1.783865 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9961116742524201, 'loss_val': 0.03403929294193817, 'psi': 0.9963970086674182}-{'f1_val': 0.9969975081576651, 'auprc': 0.9978650531294679, 'loss_val': 0.03520096188737441, 'psi': 0.9973445261463862}
[S15] START round=32 head_norm_before_train=1.794239 cos_to_last_merge=0.9913 (last merge round=23)
[S15] round=32 local utility u=0.271514 metrics={'f1_val': 0.9817869000540929, 'auprc': 0.9972456333677985, 'loss_val': 0.06301890643811404, 'psi': 0.9879703933795752}-{'f1_val': 0.9047737315097867, 'auprc': 0.9936576577304939, 'loss_val': 0.1332035159884906, 'psi': 0.9403273019980696}
[S16] START round=32 head_norm_before_train=1.405858 cos_to_last_merge=0.9838 (last merge round=28)
[S16] round=32 local utility u=0.276659 metrics={'f1_val': 0.990757972508145, 'auprc': 0.9966191588076305, 'loss_val': 0.08659872672735758, 'psi': 0.9931024470279393}-{'f1_val': 0.9325658166717724, 'auprc': 0.9949138774788668, 'loss_val': 0.2856470012685112, 'psi': 0.9575050409946102}
[S17] START round=32 head_norm_before_train=1.330833 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.016052 metrics={'f1_val': 0.6341030330883803, 'auprc': 0.7922790543951258, 'loss_val': 0.6879529965233177, 'psi': 0.6973734416110785}-{'f1_val': 0.5900816915313641, 'auprc': 0.8382315740605183, 'loss_val': 0.5937866210574765, 'psi': 0.6893416445430258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:42014
[S9] not sending this round → trigger blocked (psi=0.998)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.738)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:42016
[S10] not sending this round → trigger blocked (psi=0.994)
[S5] sending update (kind=head size=1799 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.993)
[S15] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.9986
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=-0.0496
[S16] DROPPED delta from S5 (cos=-0.0496 < 0.0)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.9818 head_norm=1.812087
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.600036e-02
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.9831 head_norm=1.797443 delta_norm=0.046000
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9966 head_norm=1.795115
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.833968e-02
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9970 head_norm=1.802973 delta_norm=0.048340
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:42009
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.8947
[S2] START round=33 head_norm_before_train=1.683731 cos_to_last_merge=0.8200 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.820
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.7051910083820243, 'auprc': 0.7752713699943461, 'loss_val': 0.3774401888229857, 'psi': 0.7332231530269531}-{'f1_val': 0.8393779661722529, 'auprc': 0.8681230788441168, 'loss_val': 0.2629889288013959, 'psi': 0.8508760112409984}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.840485 cos_to_last_merge=0.9877 (last merge round=23)
[S3] round=33 local utility u=0.117377 metrics={'f1_val': 0.9864458943787179, 'auprc': 0.9985969955155489, 'loss_val': 0.04568020925416752, 'psi': 0.9913063348334503}-{'f1_val': 0.9607813444027129, 'auprc': 0.9976173699374861, 'loss_val': 0.12350770722936122, 'psi': 0.9755157546166222}
[S4] START round=33 head_norm_before_train=1.714160 cos_to_last_merge=0.8018 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.802
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.943735058665853, 'auprc': 0.9467317810909232, 'loss_val': 0.27651677183773454, 'psi': 0.9449337476358811}-{'f1_val': 0.9563987363717491, 'auprc': 0.9731256102919056, 'loss_val': 0.26107308122778056, 'psi': 0.9630894859398117}
[S5] START round=33 head_norm_before_train=2.005983 (no previous merge yet)
[S5] round=33 local utility u=0.001188 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9962900661501164, 'loss_val': 0.02641498593285577, 'psi': 0.9964037146316846}-{'f1_val': 0.996186023309311, 'auprc': 0.9958697636062881, 'loss_val': 0.0257684901115944, 'psi': 0.9960595194281019}
[S6] START round=33 head_norm_before_train=1.801615 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.5957175251851234, 'auprc': 0.9172556382422625, 'loss_val': 1.169933183837835, 'psi': 0.724332770407979}-{'f1_val': 0.8083382588453297, 'auprc': 0.9456841256673363, 'loss_val': 0.41822003846961886, 'psi': 0.8632766055741323}
[S7] START round=33 head_norm_before_train=1.784773 (no previous merge yet)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.660030083324718, 'auprc': 0.840901415017614, 'loss_val': 0.3662211622234779, 'psi': 0.7323786160018764}-{'f1_val': 0.6702891305427374, 'auprc': 0.8393819758489983, 'loss_val': 0.34187486767800407, 'psi': 0.7379262686652418}
[S8] START round=33 head_norm_before_train=1.437729 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=33 local utility u=0.003028 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.988010026067788, 'loss_val': 0.06323135695195505, 'psi': 0.9905281663857999}-{'f1_val': 0.9933016371923923, 'auprc': 0.9855464782099288, 'loss_val': 0.06846409859816245, 'psi': 0.9901995735994069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.9922 head_norm=1.462196
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.300932e-01
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.9922 head_norm=1.369489 delta_norm=0.330093
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] START round=33 head_norm_before_train=1.944344 cos_to_last_merge=0.8282 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.828
[S9] round=33 local utility u=0.000036 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999400635275082, 'loss_val': 0.016190548226934005, 'psi': 0.998237772918289}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999383067223536, 'loss_val': 0.016258137624928455, 'psi': 0.9982370701962271}
[S10] START round=33 head_norm_before_train=1.830734 cos_to_last_merge=1.0000 (last merge round=31)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9926422229500576, 'loss_val': 0.04593553452211375, 'psi': 0.9940378010990687}-{'f1_val': 0.9945291067983943, 'auprc': 0.9941198841314831, 'loss_val': 0.03927079233349624, 'psi': 0.9943654177316299}
[S11] START round=33 head_norm_before_train=1.997629 (no previous merge yet)
[S11] round=33 local utility u=0.362470 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9986603833670524, 'loss_val': 0.02628145671668614, 'psi': 0.9974046357305493}-{'f1_val': 0.9115367532868003, 'auprc': 0.9976459429466973, 'loss_val': 0.23799429130399918, 'psi': 0.945980429150759}
[S13] START round=33 head_norm_before_train=1.671980 cos_to_last_merge=0.9951 (last merge round=23)
[S13] round=33 local utility u=0.292120 metrics={'f1_val': 0.6055582438877259, 'auprc': 0.6776545949512354, 'loss_val': 0.7336307526467285, 'psi': 0.6343967843131297}-{'f1_val': 0.5731495819341927, 'auprc': 0.6221775837527203, 'loss_val': 0.9569874348725262, 'psi': 0.5927607826616037}
[S14] START round=33 head_norm_before_train=1.802973 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.002741 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9970821646711974, 'loss_val': 0.03261037313993846, 'psi': 0.9968993304399407}-{'f1_val': 0.9965872316107504, 'auprc': 0.9961116742524201, 'loss_val': 0.03403929294193817, 'psi': 0.9963970086674182}
[S15] START round=33 head_norm_before_train=1.797443 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.8833161985915213, 'auprc': 0.9935696847027418, 'loss_val': 0.17837392525212178, 'psi': 0.9274175930360096}-{'f1_val': 0.9817869000540929, 'auprc': 0.9972456333677985, 'loss_val': 0.06301890643811404, 'psi': 0.9879703933795752}
[S16] START round=33 head_norm_before_train=1.457397 cos_to_last_merge=0.9778 (last merge round=28)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9090784021894673, 'auprc': 0.9855513628160963, 'loss_val': 0.36798428860211635, 'psi': 0.9396675864401189}-{'f1_val': 0.990757972508145, 'auprc': 0.9966191588076305, 'loss_val': 0.08659872672735758, 'psi': 0.9931024470279393}
[S17] START round=33 head_norm_before_train=1.353110 cos_to_last_merge=0.9996 (last merge round=31)
[S17] round=33 local utility u=0.442010 metrics={'f1_val': 0.7076381200304255, 'auprc': 0.8947152107677956, 'loss_val': 0.5524517914399427, 'psi': 0.7824689563253735}-{'f1_val': 0.6341030330883803, 'auprc': 0.7922790543951258, 'loss_val': 0.6879529965233177, 'psi': 0.6973734416110785}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:42003
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.996)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:42015
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=-0.0376
[S3] DROPPED delta from S9 (cos=-0.0376 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:42004
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] cosine check vs S14: cos=0.9999
[S13] sending update (kind=head size=1806 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1804) from S3
[S10] cosine check vs S3: cos=0.9987
[S4] RECEIVED delta(kind=head bytes=1806) from S13
[S4] cosine check vs S13: cos=-0.0176
[S4] DROPPED delta from S13 (cos=-0.0176 < 0.0)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:42007
[S17] not sending this round → trigger blocked (psi=0.782)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.9950 head_norm=1.845664
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.787510e-02
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.9950 head_norm=1.851875 delta_norm=0.047875
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S11
[S6] cosine check vs S11: cos=-0.1836
[S6] DROPPED delta from S11 (cos=-0.1836 < 0.0)
[S2] START round=34 head_norm_before_train=1.696907 cos_to_last_merge=0.8190 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.819
[S2] round=34 local utility u=0.402905 metrics={'f1_val': 0.7656031640975691, 'auprc': 0.8867418394251003, 'loss_val': 0.2685139113261677, 'psi': 0.8140586342285816}-{'f1_val': 0.7051910083820243, 'auprc': 0.7752713699943461, 'loss_val': 0.3774401888229857, 'psi': 0.7332231530269531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=34 head_norm_before_train=1.859299 cos_to_last_merge=0.9862 (last merge round=23)
[S3] round=34 local utility u=0.031057 metrics={'f1_val': 0.9951163222833479, 'auprc': 0.9983962424407453, 'loss_val': 0.03498593990335047, 'psi': 0.9964282903463069}-{'f1_val': 0.9864458943787179, 'auprc': 0.9985969955155489, 'loss_val': 0.04568020925416752, 'psi': 0.9913063348334503}
[S4] START round=34 head_norm_before_train=1.726474 cos_to_last_merge=0.7998 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.800
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.943441656745952, 'auprc': 0.936714891748289, 'loss_val': 0.2809052111677437, 'psi': 0.9407509507468867}-{'f1_val': 0.943735058665853, 'auprc': 0.9467317810909232, 'loss_val': 0.27651677183773454, 'psi': 0.9449337476358811}
[S5] START round=34 head_norm_before_train=2.012880 (no previous merge yet)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9929797312719582, 'loss_val': 0.02739961450544359, 'psi': 0.9949035064943699}-{'f1_val': 0.9964794802860635, 'auprc': 0.9962900661501164, 'loss_val': 0.02641498593285577, 'psi': 0.9964037146316846}
[S6] START round=34 head_norm_before_train=1.805593 (no previous merge yet)
[S6] round=34 local utility u=1.000000 metrics={'f1_val': 0.9588312993063366, 'auprc': 0.9566162509812531, 'loss_val': 0.21728694158218273, 'psi': 0.9579452799763032}-{'f1_val': 0.5957175251851234, 'auprc': 0.9172556382422625, 'loss_val': 1.169933183837835, 'psi': 0.724332770407979}
[S7] START round=34 head_norm_before_train=1.790290 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6073860952241669, 'auprc': 0.8013883216528058, 'loss_val': 0.5701099175396503, 'psi': 0.6849869857956224}-{'f1_val': 0.660030083324718, 'auprc': 0.840901415017614, 'loss_val': 0.3662211622234779, 'psi': 0.7323786160018764}
[S8] START round=34 head_norm_before_train=1.369489 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9895051223904946, 'auprc': 0.9971923475319696, 'loss_val': 0.08148766759639611, 'psi': 0.9925800124470846}-{'f1_val': 0.9922069265978078, 'auprc': 0.988010026067788, 'loss_val': 0.06323135695195505, 'psi': 0.9905281663857999}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.952071 cos_to_last_merge=0.8273 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.827
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995214555718779, 'loss_val': 0.01645277945816995, 'psi': 0.9980703297360368}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999400635275082, 'loss_val': 0.016190548226934005, 'psi': 0.998237772918289}
[S10] START round=34 head_norm_before_train=1.851875 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.004062 metrics={'f1_val': 0.9932136491405474, 'auprc': 0.9958265231934895, 'loss_val': 0.03683687710227517, 'psi': 0.9942587987617243}-{'f1_val': 0.9949681865317428, 'auprc': 0.9926422229500576, 'loss_val': 0.04593553452211375, 'psi': 0.9940378010990687}
[S11] START round=34 head_norm_before_train=2.006196 (no previous merge yet)
[S11] round=34 local utility u=0.000286 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9986357176976864, 'loss_val': 0.025634684230190136, 'psi': 0.9973947694628028}-{'f1_val': 0.996567470639547, 'auprc': 0.9986603833670524, 'loss_val': 0.02628145671668614, 'psi': 0.9974046357305493}
[S13] START round=34 head_norm_before_train=1.680550 cos_to_last_merge=0.9945 (last merge round=23)
[S13] round=34 local utility u=0.049431 metrics={'f1_val': 0.6132897673598888, 'auprc': 0.6786742014275507, 'loss_val': 0.6842160136238136, 'psi': 0.6394435409869537}-{'f1_val': 0.6055582438877259, 'auprc': 0.6776545949512354, 'loss_val': 0.7336307526467285, 'psi': 0.6343967843131297}
[S14] START round=34 head_norm_before_train=1.815213 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9954437427030103, 'loss_val': 0.036015351360558834, 'psi': 0.9964766728798593}-{'f1_val': 0.9967774409524363, 'auprc': 0.9970821646711974, 'loss_val': 0.03261037313993846, 'psi': 0.9968993304399407}
[S15] START round=34 head_norm_before_train=1.813486 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7010443585704017, 'auprc': 0.9878486824464335, 'loss_val': 0.412760170837852, 'psi': 0.8157660881208144}-{'f1_val': 0.8833161985915213, 'auprc': 0.9935696847027418, 'loss_val': 0.17837392525212178, 'psi': 0.9274175930360096}
[S16] START round=34 head_norm_before_train=1.499671 cos_to_last_merge=0.9728 (last merge round=28)
[S16] round=34 local utility u=0.414573 metrics={'f1_val': 0.9914121018744944, 'auprc': 0.9964861080920715, 'loss_val': 0.06564428333827567, 'psi': 0.9934417043615251}-{'f1_val': 0.9090784021894673, 'auprc': 0.9855513628160963, 'loss_val': 0.36798428860211635, 'psi': 0.9396675864401189}
[S17] START round=34 head_norm_before_train=1.375849 cos_to_last_merge=0.9985 (last merge round=31)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.41520255225706715, 'auprc': 0.6925475572347977, 'loss_val': 0.7903840144462768, 'psi': 0.5261405542481593}-{'f1_val': 0.7076381200304255, 'auprc': 0.8947152107677956, 'loss_val': 0.5524517914399427, 'psi': 0.7824689563253735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:42012
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:42004
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.7010 head_norm=1.828799
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.011346e-02
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.7010 head_norm=1.821907 delta_norm=0.020113
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[S6] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=-0.1837
[S11] DROPPED delta from S6 (cos=-0.1837 < 0.0)
[S16] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S3] not sending this round → trigger blocked (psi=0.996)
[S13] not sending this round → trigger blocked (psi=0.639)
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] cosine check vs S16: cos=0.9788
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] cosine check vs S10: cos=-0.0646
[S4] DROPPED delta from S10 (cos=-0.0646 < 0.0)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=34 metric=0.4152 head_norm=1.398533
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.656529e-01
[S17] stored merged vector for next round verification (round=34)
[S17] DEBUG after merge:  round=34 metric=0.4143 head_norm=1.458882 delta_norm=0.165653
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.708650 cos_to_last_merge=0.8182 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.818
[S2] round=35 local utility u=0.057334 metrics={'f1_val': 0.8288524325061347, 'auprc': 0.8177121379305148, 'loss_val': 0.32625203319214124, 'psi': 0.8243963146758868}-{'f1_val': 0.7656031640975691, 'auprc': 0.8867418394251003, 'loss_val': 0.2685139113261677, 'psi': 0.8140586342285816}
[S2] not sending this round → trigger blocked (psi=0.824)
[S3] START round=35 head_norm_before_train=1.878099 cos_to_last_merge=0.9847 (last merge round=23)
[S3] round=35 local utility u=0.005640 metrics={'f1_val': 0.9970129389118929, 'auprc': 0.9981592271045978, 'loss_val': 0.034374570045926534, 'psi': 0.9974714541889749}-{'f1_val': 0.9951163222833479, 'auprc': 0.9983962424407453, 'loss_val': 0.03498593990335047, 'psi': 0.9964282903463069}
[S4] START round=35 head_norm_before_train=1.734508 cos_to_last_merge=0.7988 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.799
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9395787386565705, 'auprc': 0.9100957092059861, 'loss_val': 0.3209822292119241, 'psi': 0.9277855268763369}-{'f1_val': 0.943441656745952, 'auprc': 0.936714891748289, 'loss_val': 0.2809052111677437, 'psi': 0.9407509507468867}
[S5] START round=35 head_norm_before_train=2.021365 (no previous merge yet)
[S5] round=35 local utility u=0.004978 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9957759357543148, 'loss_val': 0.025832408949544045, 'psi': 0.9960219882873125}-{'f1_val': 0.996186023309311, 'auprc': 0.9929797312719582, 'loss_val': 0.02739961450544359, 'psi': 0.9949035064943699}
[S6] START round=35 head_norm_before_train=1.809048 (no previous merge yet)
[S6] round=35 local utility u=0.038488 metrics={'f1_val': 0.9619112110702768, 'auprc': 0.9646575983154355, 'loss_val': 0.18291527032502172, 'psi': 0.9630097659683403}-{'f1_val': 0.9588312993063366, 'auprc': 0.9566162509812531, 'loss_val': 0.21728694158218273, 'psi': 0.9579452799763032}
[S7] START round=35 head_norm_before_train=1.799968 (no previous merge yet)
[S7] round=35 local utility u=1.000000 metrics={'f1_val': 0.883800548337561, 'auprc': 0.9002304171663114, 'loss_val': 0.2043212925956026, 'psi': 0.8903724958690612}-{'f1_val': 0.6073860952241669, 'auprc': 0.8013883216528058, 'loss_val': 0.5701099175396503, 'psi': 0.6849869857956224}
[S8] START round=35 head_norm_before_train=1.406725 cos_to_last_merge=0.9997 (last merge round=33)
[S8] round=35 local utility u=0.007443 metrics={'f1_val': 0.990363285929422, 'auprc': 0.9968317360397293, 'loss_val': 0.07066955865486027, 'psi': 0.992950665973545}-{'f1_val': 0.9895051223904946, 'auprc': 0.9971923475319696, 'loss_val': 0.08148766759639611, 'psi': 0.9925800124470846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=35 head_norm_before_train=1.958240 cos_to_last_merge=0.8268 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.827
[S9] round=35 local utility u=0.002320 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9999366741243153, 'loss_val': 0.015523371865103924, 'psi': 0.9984829601037727}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995214555718779, 'loss_val': 0.01645277945816995, 'psi': 0.9980703297360368}
[S10] START round=35 head_norm_before_train=1.865054 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=35 local utility u=0.000953 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9956600510297633, 'loss_val': 0.03574615785744657, 'psi': 0.9943236453044488}-{'f1_val': 0.9932136491405474, 'auprc': 0.9958265231934895, 'loss_val': 0.03683687710227517, 'psi': 0.9942587987617243}
[S11] START round=35 head_norm_before_train=2.016325 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9987155063776048, 'loss_val': 0.025005371683715943, 'psi': 0.9971786873974892}-{'f1_val': 0.996567470639547, 'auprc': 0.9986357176976864, 'loss_val': 0.025634684230190136, 'psi': 0.9973947694628028}
[S13] START round=35 head_norm_before_train=1.689020 cos_to_last_merge=0.9937 (last merge round=23)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5808200325665038, 'auprc': 0.5914309228210846, 'loss_val': 0.911443928932375, 'psi': 0.5850643886683361}-{'f1_val': 0.6132897673598888, 'auprc': 0.6786742014275507, 'loss_val': 0.6842160136238136, 'psi': 0.6394435409869537}
[S14] START round=35 head_norm_before_train=1.825148 cos_to_last_merge=0.9999 (last merge round=32)
[S14] round=35 local utility u=0.004083 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9970277448460622, 'loss_val': 0.03159544981439209, 'psi': 0.997009602833024}-{'f1_val': 0.9971652929977585, 'auprc': 0.9954437427030103, 'loss_val': 0.036015351360558834, 'psi': 0.9964766728798593}
[S15] START round=35 head_norm_before_train=1.821907 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9964716055286862, 'loss_val': 0.04361878173060227, 'psi': 0.9966366432439868}-{'f1_val': 0.7010443585704017, 'auprc': 0.9878486824464335, 'loss_val': 0.412760170837852, 'psi': 0.8157660881208144}
[S16] START round=35 head_norm_before_train=1.534816 cos_to_last_merge=0.9687 (last merge round=28)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.991392641722511, 'auprc': 0.9952723484574054, 'loss_val': 0.06297863905641943, 'psi': 0.9929445244164687}-{'f1_val': 0.9914121018744944, 'auprc': 0.9964861080920715, 'loss_val': 0.06564428333827567, 'psi': 0.9934417043615251}
[S17] START round=35 head_norm_before_train=1.458882 cos_to_last_merge=1.0000 (last merge round=34)
[S17] round=35 local utility u=0.451380 metrics={'f1_val': 0.5199622002978224, 'auprc': 0.7528686997122651, 'loss_val': 0.69714483898889, 'psi': 0.6131248000635995}-{'f1_val': 0.41520255225706715, 'auprc': 0.6925475572347977, 'loss_val': 0.7903840144462768, 'psi': 0.5261405542481593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:42016
[S6] not sending this round → trigger blocked (psi=0.963)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:42014
[S15] sending update (kind=head size=1793 to 1 peers)
[S10] not sending this round → trigger blocked (psi=0.994)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:42015
[S6] ⇄ pheromone p=0.333 → S11@127.0.0.1:42012
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=-0.0398
[S3] DROPPED delta from S9 (cos=-0.0398 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=-0.0476
[S16] DROPPED delta from S5 (cos=-0.0476 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1793) from S15
[S14] cosine check vs S15: cos=0.9996
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=-0.1536
[S14] DROPPED delta from S7 (cos=-0.1536 < 0.0)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.004 → S3@127.0.0.1:42003
[S14] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:42011
[S5] ⇄ pheromone p=0.005 → S16@127.0.0.1:42016
[S7] ⇄ pheromone p=0.312 → S14@127.0.0.1:42014
[S15] ⇄ pheromone p=0.344 → S14@127.0.0.1:42014
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] cosine check vs S14: cos=0.9996
[S16] ⇄ pheromone p=0.163 → S17@127.0.0.1:42017
[S3] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S3
[S10] cosine check vs S3: cos=0.9989
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=35 metric=0.9970 head_norm=1.836990
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.610013e-02
[S14] stored merged vector for next round verification (round=35)
[S14] DEBUG after merge:  round=35 metric=0.9970 head_norm=1.835846 delta_norm=0.026100
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.014 → S15@127.0.0.1:42015
[S3] ⇄ pheromone p=0.064 → S10@127.0.0.1:42011
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:42016
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=35 metric=0.9934 head_norm=1.874286
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.511257e-02
[S10] stored merged vector for next round verification (round=35)
[S10] DEBUG after merge:  round=35 metric=0.9937 head_norm=1.884340 delta_norm=0.045113
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.007 → S4@127.0.0.1:42004
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S17
[S16] cosine check vs S17: cos=0.9926
[S4] ⇄ pheromone p=0.033 → S13@127.0.0.1:42013
[S11] ⇄ pheromone p=0.054 → S6@127.0.0.1:42007
[S17] ⇄ pheromone p=0.203 → S16@127.0.0.1:42016
[S13] ⇄ pheromone p=0.093 → S11@127.0.0.1:42012
[S2] START round=36 head_norm_before_train=1.718934 cos_to_last_merge=0.8173 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.817
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.7154086653314312, 'auprc': 0.869695361049357, 'loss_val': 0.36149654321762775, 'psi': 0.7771233436186016}-{'f1_val': 0.8288524325061347, 'auprc': 0.8177121379305148, 'loss_val': 0.32625203319214124, 'psi': 0.8243963146758868}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.895416 cos_to_last_merge=0.9833 (last merge round=23)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9575013794688827, 'auprc': 0.9896153989741109, 'loss_val': 0.16332197525005288, 'psi': 0.970346987270974}-{'f1_val': 0.9970129389118929, 'auprc': 0.9981592271045978, 'loss_val': 0.034374570045926534, 'psi': 0.9974714541889749}
[S4] START round=36 head_norm_before_train=1.740591 cos_to_last_merge=0.7983 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.798
[S4] round=36 local utility u=0.133694 metrics={'f1_val': 0.9483883866053646, 'auprc': 0.9631099820741715, 'loss_val': 0.2654942030333203, 'psi': 0.9542770247928873}-{'f1_val': 0.9395787386565705, 'auprc': 0.9100957092059861, 'loss_val': 0.3209822292119241, 'psi': 0.9277855268763369}
[S5] START round=36 head_norm_before_train=2.025042 (no previous merge yet)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9959600157197334, 'loss_val': 0.027718278111730076, 'psi': 0.99609562027348}-{'f1_val': 0.996186023309311, 'auprc': 0.9957759357543148, 'loss_val': 0.025832408949544045, 'psi': 0.9960219882873125}
[S6] START round=36 head_norm_before_train=1.814412 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.5951063478500271, 'auprc': 0.8801708737008455, 'loss_val': 1.1955039036719683, 'psi': 0.7091321581903545}-{'f1_val': 0.9619112110702768, 'auprc': 0.9646575983154355, 'loss_val': 0.18291527032502172, 'psi': 0.9630097659683403}
[S7] START round=36 head_norm_before_train=1.815981 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.5944040542603864, 'auprc': 0.7970818284104519, 'loss_val': 0.7043973585630571, 'psi': 0.6754751639204126}-{'f1_val': 0.883800548337561, 'auprc': 0.9002304171663114, 'loss_val': 0.2043212925956026, 'psi': 0.8903724958690612}
[S8] START round=36 head_norm_before_train=1.448130 cos_to_last_merge=0.9988 (last merge round=33)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9880725843114774, 'auprc': 0.998490835235254, 'loss_val': 0.06882103422738646, 'psi': 0.992239884680988}-{'f1_val': 0.990363285929422, 'auprc': 0.9968317360397293, 'loss_val': 0.07066955865486027, 'psi': 0.992950665973545}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.967819 cos_to_last_merge=0.8263 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.826
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9999306452197061, 'loss_val': 0.01993164734894818, 'psi': 0.9969865087363599}-{'f1_val': 0.9975138174234109, 'auprc': 0.9999366741243153, 'loss_val': 0.015523371865103924, 'psi': 0.9984829601037727}
[S10] START round=36 head_norm_before_train=1.884340 cos_to_last_merge=1.0000 (last merge round=35)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9918284670862121, 'loss_val': 0.05007524474904889, 'psi': 0.9933452258615376}-{'f1_val': 0.9934327081542391, 'auprc': 0.9956600510297633, 'loss_val': 0.03574615785744657, 'psi': 0.9943236453044488}
[S11] START round=36 head_norm_before_train=2.026056 (no previous merge yet)
[S11] round=36 local utility u=0.000362 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9988291793496613, 'loss_val': 0.024622731724002388, 'psi': 0.9972241565863118}-{'f1_val': 0.9961541414107454, 'auprc': 0.9987155063776048, 'loss_val': 0.025005371683715943, 'psi': 0.9971786873974892}
[S13] START round=36 head_norm_before_train=1.696665 cos_to_last_merge=0.9931 (last merge round=23)
[S13] round=36 local utility u=0.006319 metrics={'f1_val': 0.5562673835641271, 'auprc': 0.6474830461441147, 'loss_val': 0.9196469692069779, 'psi': 0.5927536485961221}-{'f1_val': 0.5808200325665038, 'auprc': 0.5914309228210846, 'loss_val': 0.911443928932375, 'psi': 0.5850643886683361}
[S14] START round=36 head_norm_before_train=1.835846 cos_to_last_merge=1.0000 (last merge round=35)
[S14] round=36 local utility u=0.005048 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9989161530428299, 'loss_val': 0.028620831711192094, 'psi': 0.9979106752406077}-{'f1_val': 0.9969975081576651, 'auprc': 0.9970277448460622, 'loss_val': 0.03159544981439209, 'psi': 0.997009602833024}
[S15] START round=36 head_norm_before_train=1.835074 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.70343979112343, 'auprc': 0.9897647383758397, 'loss_val': 0.30683575904527194, 'psi': 0.8179697700243939}-{'f1_val': 0.9967466683875206, 'auprc': 0.9964716055286862, 'loss_val': 0.04361878173060227, 'psi': 0.9966366432439868}
[S16] START round=36 head_norm_before_train=1.565001 cos_to_last_merge=0.9653 (last merge round=28)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.938419251385388, 'auprc': 0.9889055828583946, 'loss_val': 0.2386173928395654, 'psi': 0.9586137839745905}-{'f1_val': 0.991392641722511, 'auprc': 0.9952723484574054, 'loss_val': 0.06297863905641943, 'psi': 0.9929445244164687}
[S17] START round=36 head_norm_before_train=1.476084 cos_to_last_merge=0.9998 (last merge round=34)
[S17] round=36 local utility u=0.655443 metrics={'f1_val': 0.6591225134171631, 'auprc': 0.8603717836541831, 'loss_val': 0.5437297148852275, 'psi': 0.7396222215119711}-{'f1_val': 0.5199622002978224, 'auprc': 0.7528686997122651, 'loss_val': 0.69714483898889, 'psi': 0.6131248000635995}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.7034 head_norm=1.849799
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.177226e-02
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.7058 head_norm=1.843132 delta_norm=0.031772
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:42012
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.9384 head_norm=1.591942
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.151946e-01
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.9386 head_norm=1.530778 delta_norm=0.115195
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] sending update (kind=head size=1805 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1805) from S13
[S11] cosine check vs S13: cos=-0.1282
[S11] DROPPED delta from S13 (cos=-0.1282 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:42013
[S4] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S4
[S13] cosine check vs S4: cos=-0.0190
[S13] DROPPED delta from S4 (cos=-0.0190 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.740)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:42007
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S11
[S6] cosine check vs S11: cos=-0.1846
[S6] DROPPED delta from S11 (cos=-0.1846 < 0.0)
[S2] START round=37 head_norm_before_train=1.731590 cos_to_last_merge=0.8163 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.816
[S2] round=37 local utility u=0.137553 metrics={'f1_val': 0.806396975517121, 'auprc': 0.7860079490453984, 'loss_val': 0.3812578427871646, 'psi': 0.7982413649284319}-{'f1_val': 0.7154086653314312, 'auprc': 0.869695361049357, 'loss_val': 0.36149654321762775, 'psi': 0.7771233436186016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=37 head_norm_before_train=1.909503 cos_to_last_merge=0.9821 (last merge round=23)
[S3] round=37 local utility u=0.030819 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9984682578953222, 'loss_val': 0.14666066716924658, 'psi': 0.9757298875795044}-{'f1_val': 0.9575013794688827, 'auprc': 0.9896153989741109, 'loss_val': 0.16332197525005288, 'psi': 0.970346987270974}
[S4] START round=37 head_norm_before_train=1.748655 cos_to_last_merge=0.7978 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.798
[S4] round=37 local utility u=0.026316 metrics={'f1_val': 0.956946111371503, 'auprc': 0.9633518721369446, 'loss_val': 0.26493342640326034, 'psi': 0.9595084156776796}-{'f1_val': 0.9483883866053646, 'auprc': 0.9631099820741715, 'loss_val': 0.2654942030333203, 'psi': 0.9542770247928873}
[S5] START round=37 head_norm_before_train=2.019869 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9956715230599009, 'loss_val': 0.02702330801399589, 'psi': 0.9959802232095469}-{'f1_val': 0.996186023309311, 'auprc': 0.9959600157197334, 'loss_val': 0.027718278111730076, 'psi': 0.99609562027348}
[S6] START round=37 head_norm_before_train=1.824066 (no previous merge yet)
[S6] round=37 local utility u=0.961597 metrics={'f1_val': 0.7916756414304783, 'auprc': 0.9252263577055594, 'loss_val': 0.5868919120478588, 'psi': 0.8450959279405108}-{'f1_val': 0.5951063478500271, 'auprc': 0.8801708737008455, 'loss_val': 1.1955039036719683, 'psi': 0.7091321581903545}
[S7] START round=37 head_norm_before_train=1.824669 (no previous merge yet)
[S7] round=37 local utility u=0.758365 metrics={'f1_val': 0.6948168385359526, 'auprc': 0.961195373365499, 'loss_val': 0.2824841625262545, 'psi': 0.8013682524677712}-{'f1_val': 0.5944040542603864, 'auprc': 0.7970818284104519, 'loss_val': 0.7043973585630571, 'psi': 0.6754751639204126}
[S8] START round=37 head_norm_before_train=1.488125 cos_to_last_merge=0.9975 (last merge round=33)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.9852687075919312, 'loss_val': 0.061185129080368474, 'psi': 0.9899669121589925}-{'f1_val': 0.9880725843114774, 'auprc': 0.998490835235254, 'loss_val': 0.06882103422738646, 'psi': 0.992239884680988}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.978656 cos_to_last_merge=0.8258 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.826
[S9] round=37 local utility u=0.003021 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9966622641055641, 'loss_val': 0.016558971104496036, 'psi': 0.9969266531495113}-{'f1_val': 0.9950237510807955, 'auprc': 0.9999306452197061, 'loss_val': 0.01993164734894818, 'psi': 0.9969865087363599}
[S10] START round=37 head_norm_before_train=1.894630 cos_to_last_merge=1.0000 (last merge round=35)
[S10] round=37 local utility u=0.010081 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9959153083370721, 'loss_val': 0.03506730086707321, 'psi': 0.9942693796407587}-{'f1_val': 0.9943563983784213, 'auprc': 0.9918284670862121, 'loss_val': 0.05007524474904889, 'psi': 0.9933452258615376}
[S11] START round=37 head_norm_before_train=2.036006 (no previous merge yet)
[S11] round=37 local utility u=0.000426 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9989470588671779, 'loss_val': 0.024124731103093044, 'psi': 0.9972713083933185}-{'f1_val': 0.9961541414107454, 'auprc': 0.9988291793496613, 'loss_val': 0.024622731724002388, 'psi': 0.9972241565863118}
[S13] START round=37 head_norm_before_train=1.704293 cos_to_last_merge=0.9923 (last merge round=23)
[S13] round=37 local utility u=0.441743 metrics={'f1_val': 0.6316521599238277, 'auprc': 0.6622385246476944, 'loss_val': 0.5327358606449385, 'psi': 0.6438867058133744}-{'f1_val': 0.5562673835641271, 'auprc': 0.6474830461441147, 'loss_val': 0.9196469692069779, 'psi': 0.5927536485961221}
[S14] START round=37 head_norm_before_train=1.847383 cos_to_last_merge=1.0000 (last merge round=35)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9944935406943898, 'auprc': 0.9969949750331583, 'loss_val': 0.04679403540711176, 'psi': 0.9954941144298972}-{'f1_val': 0.997240356705793, 'auprc': 0.9989161530428299, 'loss_val': 0.028620831711192094, 'psi': 0.9979106752406077}
[S15] START round=37 head_norm_before_train=1.843132 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=0.986138 metrics={'f1_val': 0.990308826759725, 'auprc': 0.9917397956662868, 'loss_val': 0.0616986164805446, 'psi': 0.9908812143223497}-{'f1_val': 0.70343979112343, 'auprc': 0.9897647383758397, 'loss_val': 0.30683575904527194, 'psi': 0.8179697700243939}
[S16] START round=37 head_norm_before_train=1.530778 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9330028049344223, 'auprc': 0.9912306791214, 'loss_val': 0.26084134130342984, 'psi': 0.9562939546092133}-{'f1_val': 0.938419251385388, 'auprc': 0.9889055828583946, 'loss_val': 0.2386173928395654, 'psi': 0.9586137839745905}
[S17] START round=37 head_norm_before_train=1.491287 cos_to_last_merge=0.9993 (last merge round=34)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.40906029146449463, 'auprc': 0.682513865131447, 'loss_val': 0.8983248100561837, 'psi': 0.5184417209312756}-{'f1_val': 0.6591225134171631, 'auprc': 0.8603717836541831, 'loss_val': 0.5437297148852275, 'psi': 0.7396222215119711}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:42012
[S9] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:42004
[S6] sending update (kind=head size=1796 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1793) from S9
[S3] cosine check vs S9: cos=-0.0409
[S3] DROPPED delta from S9 (cos=-0.0409 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S6
[S11] cosine check vs S6: cos=-0.1846
[S11] DROPPED delta from S6 (cos=-0.1846 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] cosine check vs S7: cos=-0.1564
[S14] DROPPED delta from S7 (cos=-0.1564 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.9999
[S10] sending update (kind=head size=1805 to 1 peers)
[S13] not sending this round → trigger blocked (psi=0.644)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:42011
[S4] RECEIVED delta(kind=head bytes=1805) from S10
[S4] cosine check vs S10: cos=-0.0654
[S4] DROPPED delta from S10 (cos=-0.0654 < 0.0)
[S3] sending update (kind=head size=1800 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9945 head_norm=1.859356
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.406484e-02
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9937 head_norm=1.857501 delta_norm=0.014065
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] RECEIVED delta(kind=head bytes=1800) from S3
[S10] cosine check vs S3: cos=0.9992
[S4] not sending this round → trigger blocked (psi=0.960)
[S11] not sending this round → trigger blocked (psi=0.997)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=37 metric=0.9932 head_norm=1.905555
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.010220e-02
[S10] stored merged vector for next round verification (round=37)
[S10] DEBUG after merge:  round=37 metric=0.9932 head_norm=1.915062 delta_norm=0.040102
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.742678 cos_to_last_merge=0.8153 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.815
[S2] round=38 local utility u=0.231329 metrics={'f1_val': 0.8185131483812869, 'auprc': 0.8786423842436846, 'loss_val': 0.26920072106670834, 'psi': 0.842564842726246}-{'f1_val': 0.806396975517121, 'auprc': 0.7860079490453984, 'loss_val': 0.3812578427871646, 'psi': 0.7982413649284319}
[S2] not sending this round → trigger blocked (psi=0.843)
[S3] START round=38 head_norm_before_train=1.925358 cos_to_last_merge=0.9809 (last merge round=23)
[S3] round=38 local utility u=0.118752 metrics={'f1_val': 0.9846959016818335, 'auprc': 0.9979288892020617, 'loss_val': 0.05228719900325205, 'psi': 0.9899890966899247}-{'f1_val': 0.9605709740356257, 'auprc': 0.9984682578953222, 'loss_val': 0.14666066716924658, 'psi': 0.9757298875795044}
[S4] START round=38 head_norm_before_train=1.759089 cos_to_last_merge=0.7968 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.797
[S4] round=38 local utility u=0.015008 metrics={'f1_val': 0.9603993307125003, 'auprc': 0.964754822125931, 'loss_val': 0.2598458154163402, 'psi': 0.9621415272778726}-{'f1_val': 0.956946111371503, 'auprc': 0.9633518721369446, 'loss_val': 0.26493342640326034, 'psi': 0.9595084156776796}
[S5] START round=38 head_norm_before_train=2.028346 (no previous merge yet)
[S5] round=38 local utility u=0.000659 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9961957971944708, 'loss_val': 0.027278704085365982, 'psi': 0.996189932863375}-{'f1_val': 0.996186023309311, 'auprc': 0.9956715230599009, 'loss_val': 0.02702330801399589, 'psi': 0.9959802232095469}
[S6] START round=38 head_norm_before_train=1.832255 (no previous merge yet)
[S6] round=38 local utility u=0.292759 metrics={'f1_val': 0.8537908483201664, 'auprc': 0.9411421811828709, 'loss_val': 0.4218123126101627, 'psi': 0.8887313814652482}-{'f1_val': 0.7916756414304783, 'auprc': 0.9252263577055594, 'loss_val': 0.5868919120478588, 'psi': 0.8450959279405108}
[S7] START round=38 head_norm_before_train=1.832504 (no previous merge yet)
[S7] round=38 local utility u=1.000000 metrics={'f1_val': 0.9934773749467849, 'auprc': 0.9914582138593433, 'loss_val': 0.1485485565238643, 'psi': 0.9926697105118083}-{'f1_val': 0.6948168385359526, 'auprc': 0.961195373365499, 'loss_val': 0.2824841625262545, 'psi': 0.8013682524677712}
[S8] START round=38 head_norm_before_train=1.521676 cos_to_last_merge=0.9962 (last merge round=33)
[S8] round=38 local utility u=0.004801 metrics={'f1_val': 0.9878503457462027, 'auprc': 0.9987817779700718, 'loss_val': 0.060630218917151785, 'psi': 0.9922229186357504}-{'f1_val': 0.9930990485370332, 'auprc': 0.9852687075919312, 'loss_val': 0.061185129080368474, 'psi': 0.9899669121589925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=38 head_norm_before_train=1.986602 cos_to_last_merge=0.8248 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.825
[S9] round=38 local utility u=0.002349 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9999393386210954, 'loss_val': 0.016701456197184904, 'psi': 0.9977383528866819}-{'f1_val': 0.9971029125121428, 'auprc': 0.9966622641055641, 'loss_val': 0.016558971104496036, 'psi': 0.9969266531495113}
[S10] START round=38 head_norm_before_train=1.915062 cos_to_last_merge=1.0000 (last merge round=37)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9926350440250158, 'loss_val': 0.036242113833668294, 'psi': 0.994034929529052}-{'f1_val': 0.9931720938432163, 'auprc': 0.9959153083370721, 'loss_val': 0.03506730086707321, 'psi': 0.9942693796407587}
[S11] START round=38 head_norm_before_train=2.047405 (no previous merge yet)
[S11] round=38 local utility u=0.000197 metrics={'f1_val': 0.9961749345434856, 'auprc': 0.9990181158934571, 'loss_val': 0.024068719849862003, 'psi': 0.9973122070834742}-{'f1_val': 0.9961541414107454, 'auprc': 0.9989470588671779, 'loss_val': 0.024124731103093044, 'psi': 0.9972713083933185}
[S13] START round=38 head_norm_before_train=1.711017 cos_to_last_merge=0.9918 (last merge round=23)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5678460132497984, 'auprc': 0.6403667831461901, 'loss_val': 1.0920299239042244, 'psi': 0.596854321208355}-{'f1_val': 0.6316521599238277, 'auprc': 0.6622385246476944, 'loss_val': 0.5327358606449385, 'psi': 0.6438867058133744}
[S14] START round=38 head_norm_before_train=1.857501 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.017466 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9970431298969159, 'loss_val': 0.0270299108820393, 'psi': 0.9970157568533654}-{'f1_val': 0.9944935406943898, 'auprc': 0.9969949750331583, 'loss_val': 0.04679403540711176, 'psi': 0.9954941144298972}
[S15] START round=38 head_norm_before_train=1.855751 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=38 local utility u=0.042651 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976672439675024, 'loss_val': 0.03280635804004199, 'psi': 0.9971148986195133}-{'f1_val': 0.990308826759725, 'auprc': 0.9917397956662868, 'loss_val': 0.0616986164805446, 'psi': 0.9908812143223497}
[S16] START round=38 head_norm_before_train=1.555253 cos_to_last_merge=0.9999 (last merge round=36)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8558225727226189, 'auprc': 0.9842631880480184, 'loss_val': 0.5897315544859199, 'psi': 0.9071988188527786}-{'f1_val': 0.9330028049344223, 'auprc': 0.9912306791214, 'loss_val': 0.26084134130342984, 'psi': 0.9562939546092133}
[S17] START round=38 head_norm_before_train=1.506888 cos_to_last_merge=0.9986 (last merge round=34)
[S17] round=38 local utility u=0.787489 metrics={'f1_val': 0.6265338638530147, 'auprc': 0.7265662092243922, 'loss_val': 0.7603442993226224, 'psi': 0.6665468020015657}-{'f1_val': 0.40906029146449463, 'auprc': 0.682513865131447, 'loss_val': 0.8983248100561837, 'psi': 0.5184417209312756}
[S15] not sending this round → trigger blocked (psi=0.997)
[S6] not sending this round → trigger blocked (psi=0.889)
[S9] not sending this round → trigger blocked (psi=0.998)
[S7] not sending this round → trigger blocked (psi=0.993)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:42016
[S5] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:42015
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=-0.0479
[S16] DROPPED delta from S5 (cos=-0.0479 < 0.0)
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.990)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=0.9999
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:42007
[S11] sending update (kind=head size=1803 to 1 peers)
[S17] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S17
[S16] cosine check vs S17: cos=0.9933
[S13] RECEIVED delta(kind=head bytes=1804) from S4
[S13] cosine check vs S4: cos=-0.0172
[S13] DROPPED delta from S4 (cos=-0.0172 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S11
[S6] cosine check vs S11: cos=-0.1843
[S6] DROPPED delta from S11 (cos=-0.1843 < 0.0)
[S2] START round=39 head_norm_before_train=1.754333 cos_to_last_merge=0.8144 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.814
[S2] round=39 local utility u=0.007288 metrics={'f1_val': 0.8363881950502858, 'auprc': 0.8715918562983636, 'loss_val': 0.3407240607197443, 'psi': 0.8504696595495169}-{'f1_val': 0.8185131483812869, 'auprc': 0.8786423842436846, 'loss_val': 0.26920072106670834, 'psi': 0.842564842726246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S2] r=40 psi=0.850 u=0.0073 p_local=0.1314 f1=0.836 auprc=0.872 bytes=39611
[S3] START round=39 head_norm_before_train=1.939457 cos_to_last_merge=0.9798 (last merge round=23)
[S3] round=39 local utility u=0.053446 metrics={'f1_val': 0.9969869110332736, 'auprc': 0.9988054376533354, 'loss_val': 0.021770645101252407, 'psi': 0.9977143216812983}-{'f1_val': 0.9846959016818335, 'auprc': 0.9979288892020617, 'loss_val': 0.05228719900325205, 'psi': 0.9899890966899247}
[S4] START round=39 head_norm_before_train=1.766621 cos_to_last_merge=0.7959 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.796
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9570626014577301, 'auprc': 0.9641283851252921, 'loss_val': 0.2652789682099617, 'psi': 0.9598889149247549}-{'f1_val': 0.9603993307125003, 'auprc': 0.964754822125931, 'loss_val': 0.2598458154163402, 'psi': 0.9621415272778726}
[S5] START round=39 head_norm_before_train=2.031814 (no previous merge yet)
[S5] round=39 local utility u=0.005892 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9987401867243695, 'loss_val': 0.024888226882739645, 'psi': 0.9973837628613859}-{'f1_val': 0.996186023309311, 'auprc': 0.9961957971944708, 'loss_val': 0.027278704085365982, 'psi': 0.996189932863375}
[S6] START round=39 head_norm_before_train=1.840401 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.6727812370875986, 'auprc': 0.8812495343395673, 'loss_val': 0.9013699834773033, 'psi': 0.7561685559883862}-{'f1_val': 0.8537908483201664, 'auprc': 0.9411421811828709, 'loss_val': 0.4218123126101627, 'psi': 0.8887313814652482}
[S7] START round=39 head_norm_before_train=1.835747 (no previous merge yet)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5801607602617977, 'auprc': 0.8092409770255559, 'loss_val': 0.6313363996122255, 'psi': 0.671792846967301}-{'f1_val': 0.9934773749467849, 'auprc': 0.9914582138593433, 'loss_val': 0.1485485565238643, 'psi': 0.9926697105118083}
[S8] START round=39 head_norm_before_train=1.551107 cos_to_last_merge=0.9949 (last merge round=33)
[S8] round=39 local utility u=0.011413 metrics={'f1_val': 0.9922164873423569, 'auprc': 0.9941732185860066, 'loss_val': 0.050175758249638575, 'psi': 0.9929991798398168}-{'f1_val': 0.9878503457462027, 'auprc': 0.9987817779700718, 'loss_val': 0.060630218917151785, 'psi': 0.9922229186357504}
[S8] not sending this round → trigger blocked (psi=0.993)
[S8] r=40 psi=0.993 u=0.0114 p_local=0.0064 f1=0.992 auprc=0.994 bytes=44954
[S9] START round=39 head_norm_before_train=1.994758 cos_to_last_merge=0.8240 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.824
[S9] round=39 local utility u=0.002904 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9999053312365809, 'loss_val': 0.015594417101652852, 'psi': 0.9982049804162525}-{'f1_val': 0.9962710290637395, 'auprc': 0.9999393386210954, 'loss_val': 0.016701456197184904, 'psi': 0.9977383528866819}
[S10] START round=39 head_norm_before_train=1.925898 cos_to_last_merge=1.0000 (last merge round=37)
[S10] round=39 local utility u=0.000848 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9960635711429815, 'loss_val': 0.03405435578554451, 'psi': 0.9943286847631224}-{'f1_val': 0.9949681865317428, 'auprc': 0.9926350440250158, 'loss_val': 0.036242113833668294, 'psi': 0.994034929529052}
[S11] START round=39 head_norm_before_train=2.055972 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9965919014202035, 'auprc': 0.9983282217804696, 'loss_val': 0.05922762691275918, 'psi': 0.99728642956431}-{'f1_val': 0.9961749345434856, 'auprc': 0.9990181158934571, 'loss_val': 0.024068719849862003, 'psi': 0.9973122070834742}
[S13] START round=39 head_norm_before_train=1.717732 cos_to_last_merge=0.9914 (last merge round=23)
[S13] round=39 local utility u=0.077350 metrics={'f1_val': 0.5735502512988251, 'auprc': 0.6627840660077996, 'loss_val': 1.038807603338405, 'psi': 0.6092437771824148}-{'f1_val': 0.5678460132497984, 'auprc': 0.6403667831461901, 'loss_val': 1.0920299239042244, 'psi': 0.596854321208355}
[S14] START round=39 head_norm_before_train=1.871471 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9954506890496057, 'loss_val': 0.027383099297548397, 'psi': 0.9961326145862924}-{'f1_val': 0.9969975081576651, 'auprc': 0.9970431298969159, 'loss_val': 0.0270299108820393, 'psi': 0.9970157568533654}
[S15] START round=39 head_norm_before_train=1.867963 cos_to_last_merge=0.9999 (last merge round=36)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.8347867984136412, 'auprc': 0.9882431679996131, 'loss_val': 0.1891715454128384, 'psi': 0.89616934624803}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976672439675024, 'loss_val': 0.03280635804004199, 'psi': 0.9971148986195133}
[S16] START round=39 head_norm_before_train=1.578201 cos_to_last_merge=0.9998 (last merge round=36)
[S16] round=39 local utility u=0.379681 metrics={'f1_val': 0.9247025856623541, 'auprc': 0.9957864521771546, 'loss_val': 0.2782193661115034, 'psi': 0.9531361322682743}-{'f1_val': 0.8558225727226189, 'auprc': 0.9842631880480184, 'loss_val': 0.5897315544859199, 'psi': 0.9071988188527786}
[S17] START round=39 head_norm_before_train=1.519708 cos_to_last_merge=0.9978 (last merge round=34)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.5715845479475379, 'auprc': 0.7520885478832621, 'loss_val': 0.7831463899479738, 'psi': 0.6437861479218276}-{'f1_val': 0.6265338638530147, 'auprc': 0.7265662092243922, 'loss_val': 0.7603442993226224, 'psi': 0.6665468020015657}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:42003
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.756 u=0.0000 p_local=0.3062 f1=0.673 auprc=0.881 bytes=35957
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:42004
[S9] sending update (kind=head size=1797 to 1 peers)
[S7] r=40 psi=0.672 u=0.0000 p_local=0.3850 f1=0.580 auprc=0.809 bytes=28789
[S5] r=40 psi=0.997 u=0.0059 p_local=0.0032 f1=0.996 auprc=0.999 bytes=41374
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.8348 head_norm=1.879254
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.015950e-02
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.8377 head_norm=1.875258 delta_norm=0.020159
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.896 u=0.0000 p_local=0.2739 f1=0.835 auprc=0.988 bytes=41360
[S3] RECEIVED delta(kind=head bytes=1797) from S9
[S3] cosine check vs S9: cos=-0.0420
[S3] DROPPED delta from S9 (cos=-0.0420 < 0.0)
[S9] r=40 psi=0.998 u=0.0029 p_local=0.0028 f1=0.997 auprc=1.000 bytes=41372
[S10] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:42012
[S16] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=-0.0655
[S4] DROPPED delta from S10 (cos=-0.0655 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S16
[S17] cosine check vs S16: cos=0.9915
[S13] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S14] r=40 psi=0.996 u=0.0000 p_local=0.0090 f1=0.997 auprc=0.995 bytes=44977
[S11] RECEIVED delta(kind=head bytes=1804) from S13
[S11] cosine check vs S13: cos=-0.1250
[S11] DROPPED delta from S13 (cos=-0.1250 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S3
[S10] cosine check vs S3: cos=0.9994
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=39 metric=0.9247 head_norm=1.599862
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.033958e-01
[S16] stored merged vector for next round verification (round=39)
[S16] DEBUG after merge:  round=39 metric=0.9249 head_norm=1.556870 delta_norm=0.103396
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] r=40 psi=0.953 u=0.3797 p_local=0.1426 f1=0.925 auprc=0.996 bytes=37854
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.998 u=0.0534 p_local=0.0599 f1=0.997 auprc=0.999 bytes=48560
[S4] r=40 psi=0.960 u=0.0000 p_local=0.0328 f1=0.957 auprc=0.964 bytes=35996
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=39 metric=0.5716 head_norm=1.533414
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.076006e-01
[S17] stored merged vector for next round verification (round=39)
[S17] DEBUG after merge:  round=39 metric=0.5728 head_norm=1.563291 delta_norm=0.107601
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] r=40 psi=0.644 u=0.0000 p_local=0.2763 f1=0.572 auprc=0.752 bytes=34149
[S11] r=40 psi=0.997 u=0.0000 p_local=0.0221 f1=0.997 auprc=0.998 bytes=48584
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=39 metric=0.9932 head_norm=1.933156
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.601204e-02
[S10] stored merged vector for next round verification (round=39)
[S10] DEBUG after merge:  round=39 metric=0.9932 head_norm=1.942517 delta_norm=0.036012
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] r=40 psi=0.994 u=0.0008 p_local=0.0042 f1=0.993 auprc=0.996 bytes=43216
[S13] r=40 psi=0.609 u=0.0773 p_local=0.1109 f1=0.574 auprc=0.663 bytes=35999
[S2] START round=40 head_norm_before_train=1.766088 cos_to_last_merge=0.8134 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.813
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.7902753542082784, 'auprc': 0.8787636219840801, 'loss_val': 0.32549873238753557, 'psi': 0.8256706613185991}-{'f1_val': 0.8363881950502858, 'auprc': 0.8715918562983636, 'loss_val': 0.3407240607197443, 'psi': 0.8504696595495169}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.952497 cos_to_last_merge=0.9788 (last merge round=23)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9219104387232753, 'auprc': 0.9153718929241805, 'loss_val': 0.2979560718482447, 'psi': 0.9192950204036373}-{'f1_val': 0.9969869110332736, 'auprc': 0.9988054376533354, 'loss_val': 0.021770645101252407, 'psi': 0.9977143216812983}
[S4] START round=40 head_norm_before_train=1.771707 cos_to_last_merge=0.7951 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.795
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9442629692461948, 'auprc': 0.9499208502912226, 'loss_val': 0.27947781112369624, 'psi': 0.9465261216642059}-{'f1_val': 0.9570626014577301, 'auprc': 0.9641283851252921, 'loss_val': 0.2652789682099617, 'psi': 0.9598889149247549}
[S5] START round=40 head_norm_before_train=2.043377 (no previous merge yet)
[S5] round=40 local utility u=0.000302 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9986883547156093, 'loss_val': 0.025006415907265333, 'psi': 0.9974508873443856}-{'f1_val': 0.9964794802860635, 'auprc': 0.9987401867243695, 'loss_val': 0.024888226882739645, 'psi': 0.9973837628613859}
[S6] START round=40 head_norm_before_train=1.850379 (no previous merge yet)
[S6] round=40 local utility u=0.783297 metrics={'f1_val': 0.8238662243678114, 'auprc': 0.950172544381682, 'loss_val': 0.4480543699807078, 'psi': 0.8743887523733597}-{'f1_val': 0.6727812370875986, 'auprc': 0.8812495343395673, 'loss_val': 0.9013699834773033, 'psi': 0.7561685559883862}
[S7] START round=40 head_norm_before_train=1.837038 (no previous merge yet)
[S7] round=40 local utility u=0.650497 metrics={'f1_val': 0.7226426462058108, 'auprc': 0.8590536960382272, 'loss_val': 0.3346716769890241, 'psi': 0.7772070661387773}-{'f1_val': 0.5801607602617977, 'auprc': 0.8092409770255559, 'loss_val': 0.6313363996122255, 'psi': 0.671792846967301}
[S8] START round=40 head_norm_before_train=1.578956 cos_to_last_merge=0.9938 (last merge round=33)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.9853574652842205, 'loss_val': 0.04962827021117625, 'psi': 0.9900024152359082}-{'f1_val': 0.9922164873423569, 'auprc': 0.9941732185860066, 'loss_val': 0.050175758249638575, 'psi': 0.9929991798398168}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=2.001835 cos_to_last_merge=0.8230 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.823
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9998882643824883, 'loss_val': 0.01606176027577316, 'psi': 0.9981981536746154}-{'f1_val': 0.9970714132027002, 'auprc': 0.9999053312365809, 'loss_val': 0.015594417101652852, 'psi': 0.9982049804162525}
[S10] START round=40 head_norm_before_train=1.942517 cos_to_last_merge=1.0000 (last merge round=39)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9924122385599103, 'loss_val': 0.0393942169887354, 'psi': 0.9939458073430099}-{'f1_val': 0.9931720938432163, 'auprc': 0.9960635711429815, 'loss_val': 0.03405435578554451, 'psi': 0.9943286847631224}
[S11] START round=40 head_norm_before_train=2.065479 (no previous merge yet)
[S11] round=40 local utility u=0.018218 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9991065305929807, 'loss_val': 0.0224996494312879, 'psi': 0.9973350970836395}-{'f1_val': 0.9965919014202035, 'auprc': 0.9983282217804696, 'loss_val': 0.05922762691275918, 'psi': 0.99728642956431}
[S13] START round=40 head_norm_before_train=1.721359 cos_to_last_merge=0.9912 (last merge round=23)
[S13] round=40 local utility u=0.228286 metrics={'f1_val': 0.5837351275052416, 'auprc': 0.675936495777032, 'loss_val': 0.682802548065002, 'psi': 0.6206156748139577}-{'f1_val': 0.5735502512988251, 'auprc': 0.6627840660077996, 'loss_val': 1.038807603338405, 'psi': 0.6092437771824148}
[S14] START round=40 head_norm_before_train=1.884419 cos_to_last_merge=0.9999 (last merge round=37)
[S14] round=40 local utility u=0.000529 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9958728289061227, 'loss_val': 0.02759129431821215, 'psi': 0.9963014705288993}-{'f1_val': 0.9965872316107504, 'auprc': 0.9954506890496057, 'loss_val': 0.027383099297548397, 'psi': 0.9961326145862924}
[S15] START round=40 head_norm_before_train=1.875258 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.566747 metrics={'f1_val': 0.9940615510743026, 'auprc': 0.9988187857316512, 'loss_val': 0.043052580405714955, 'psi': 0.995964444937242}-{'f1_val': 0.8347867984136412, 'auprc': 0.9882431679996131, 'loss_val': 0.1891715454128384, 'psi': 0.89616934624803}
[S16] START round=40 head_norm_before_train=1.556870 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=40 local utility u=0.119885 metrics={'f1_val': 0.9422494066035002, 'auprc': 0.9954160426615255, 'loss_val': 0.14261807737015814, 'psi': 0.9635160610267103}-{'f1_val': 0.9247025856623541, 'auprc': 0.9957864521771546, 'loss_val': 0.2782193661115034, 'psi': 0.9531361322682743}
[S17] START round=40 head_norm_before_train=1.563291 cos_to_last_merge=1.0000 (last merge round=39)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.45699306097740056, 'auprc': 0.6826515833082671, 'loss_val': 0.9087834816219859, 'psi': 0.5472564699097472}-{'f1_val': 0.5715845479475379, 'auprc': 0.7520885478832621, 'loss_val': 0.7831463899479738, 'psi': 0.6437861479218276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:42014
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:42014
[S16] not sending this round → trigger blocked (psi=0.964)
[S9] ⇄ pheromone p=0.002 → S3@127.0.0.1:42003
[S7] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:42015
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=-0.0499
[S16] DROPPED delta from S5 (cos=-0.0499 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=-0.1545
[S14] DROPPED delta from S7 (cos=-0.1545 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=0.9996
[S11] RECEIVED delta(kind=head bytes=1794) from S6
[S11] cosine check vs S6: cos=-0.1841
[S11] DROPPED delta from S6 (cos=-0.1841 < 0.0)
[S14] sending update (kind=head size=1792 to 1 peers)
[S6] ⇄ pheromone p=0.402 → S11@127.0.0.1:42012
[S5] ⇄ pheromone p=0.003 → S16@127.0.0.1:42016
[S13] not sending this round → trigger blocked (psi=0.621)
[S15] ⇄ pheromone p=0.333 → S14@127.0.0.1:42014
[S7] ⇄ pheromone p=0.438 → S14@127.0.0.1:42014
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1792) from S14
[S15] cosine check vs S14: cos=0.9996
[S16] ⇄ pheromone p=0.138 → S17@127.0.0.1:42017
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=40 metric=0.9966 head_norm=1.894286
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.586662e-02
[S14] stored merged vector for next round verification (round=40)
[S14] DEBUG after merge:  round=40 metric=0.9966 head_norm=1.890286 delta_norm=0.025867
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.007 → S7@127.0.0.1:42008
[S3] ⇄ pheromone p=0.048 → S10@127.0.0.1:42011
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:42007
[S10] ⇄ pheromone p=0.003 → S4@127.0.0.1:42004
[S11] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S11
[S6] cosine check vs S11: cos=-0.1841
[S6] DROPPED delta from S11 (cos=-0.1841 < 0.0)
[S4] ⇄ pheromone p=0.026 → S13@127.0.0.1:42013
[S17] ⇄ pheromone p=0.221 → S16@127.0.0.1:42016
[S11] ⇄ pheromone p=0.021 → S6@127.0.0.1:42007
[S13] ⇄ pheromone p=0.134 → S11@127.0.0.1:42012
[S2] START round=41 head_norm_before_train=1.777196 cos_to_last_merge=0.8125 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.812
[S2] round=41 local utility u=0.098788 metrics={'f1_val': 0.8382735640047402, 'auprc': 0.8568914342936573, 'loss_val': 0.3502958567027402, 'psi': 0.845720712120307}-{'f1_val': 0.7902753542082784, 'auprc': 0.8787636219840801, 'loss_val': 0.32549873238753557, 'psi': 0.8256706613185991}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=41 head_norm_before_train=1.960983 cos_to_last_merge=0.9780 (last merge round=23)
[S3] round=41 local utility u=0.447905 metrics={'f1_val': 0.9890359117677164, 'auprc': 0.9980778417815275, 'loss_val': 0.05301720141602401, 'psi': 0.9926526837732409}-{'f1_val': 0.9219104387232753, 'auprc': 0.9153718929241805, 'loss_val': 0.2979560718482447, 'psi': 0.9192950204036373}
[S4] START round=41 head_norm_before_train=1.775787 cos_to_last_merge=0.7944 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.794
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9406455632038122, 'auprc': 0.9360377672904949, 'loss_val': 0.30035847262856474, 'psi': 0.9388024448384853}-{'f1_val': 0.9442629692461948, 'auprc': 0.9499208502912226, 'loss_val': 0.27947781112369624, 'psi': 0.9465261216642059}
[S5] START round=41 head_norm_before_train=2.052604 (no previous merge yet)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9986478133865476, 'loss_val': 0.02529960580757427, 'psi': 0.9974346708127608}-{'f1_val': 0.996625909096903, 'auprc': 0.9986883547156093, 'loss_val': 0.025006415907265333, 'psi': 0.9974508873443856}
[S6] START round=41 head_norm_before_train=1.859886 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.5959213185441545, 'auprc': 0.9078183168142266, 'loss_val': 1.0814978811518092, 'psi': 0.7206801178521833}-{'f1_val': 0.8238662243678114, 'auprc': 0.950172544381682, 'loss_val': 0.4480543699807078, 'psi': 0.8743887523733597}
[S7] START round=41 head_norm_before_train=1.840316 (no previous merge yet)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.6195737995565531, 'auprc': 0.8016268796394797, 'loss_val': 0.5708509651245005, 'psi': 0.6923950315897238}-{'f1_val': 0.7226426462058108, 'auprc': 0.8590536960382272, 'loss_val': 0.3346716769890241, 'psi': 0.7772070661387773}
[S8] START round=41 head_norm_before_train=1.606801 cos_to_last_merge=0.9926 (last merge round=33)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9859393502901527, 'auprc': 0.9987565217485637, 'loss_val': 0.055551374767039044, 'psi': 0.9910662188735171}-{'f1_val': 0.9930990485370332, 'auprc': 0.9853574652842205, 'loss_val': 0.04962827021117625, 'psi': 0.9900024152359082}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=2.009060 cos_to_last_merge=0.8224 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.822
[S9] round=41 local utility u=0.001798 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9999366115443288, 'loss_val': 0.015265041364093552, 'psi': 0.9984829350717781}-{'f1_val': 0.9970714132027002, 'auprc': 0.9998882643824883, 'loss_val': 0.01606176027577316, 'psi': 0.9981981536746154}
[S10] START round=41 head_norm_before_train=1.950790 cos_to_last_merge=1.0000 (last merge round=39)
[S10] round=41 local utility u=0.003838 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9958509200729502, 'loss_val': 0.032822344799669056, 'psi': 0.9943999929217235}-{'f1_val': 0.9949681865317428, 'auprc': 0.9924122385599103, 'loss_val': 0.0393942169887354, 'psi': 0.9939458073430099}
[S11] START round=41 head_norm_before_train=2.076454 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9987823784531236, 'loss_val': 0.02184249794799307, 'psi': 0.9972054362276966}-{'f1_val': 0.9961541414107454, 'auprc': 0.9991065305929807, 'loss_val': 0.0224996494312879, 'psi': 0.9973350970836395}
[S13] START round=41 head_norm_before_train=1.724707 cos_to_last_merge=0.9907 (last merge round=23)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.5435509561680956, 'auprc': 0.6718221115872134, 'loss_val': 1.0580034738189743, 'psi': 0.5948594183357427}-{'f1_val': 0.5837351275052416, 'auprc': 0.675936495777032, 'loss_val': 0.682802548065002, 'psi': 0.6206156748139577}
[S14] START round=41 head_norm_before_train=1.890286 cos_to_last_merge=1.0000 (last merge round=40)
[S14] round=41 local utility u=0.003240 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9977547111403213, 'loss_val': 0.02675766083554359, 'psi': 0.9970542234225788}-{'f1_val': 0.9965872316107504, 'auprc': 0.9958728289061227, 'loss_val': 0.02759129431821215, 'psi': 0.9963014705288993}
[S15] START round=41 head_norm_before_train=1.886632 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.8119925276997084, 'auprc': 0.9951955987961204, 'loss_val': 0.2996732503023708, 'psi': 0.8852737561382732}-{'f1_val': 0.9940615510743026, 'auprc': 0.9988187857316512, 'loss_val': 0.043052580405714955, 'psi': 0.995964444937242}
[S16] START round=41 head_norm_before_train=1.577227 cos_to_last_merge=0.9999 (last merge round=39)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.8926656048350127, 'auprc': 0.9941393729731209, 'loss_val': 0.3576438164940759, 'psi': 0.933255112090256}-{'f1_val': 0.9422494066035002, 'auprc': 0.9954160426615255, 'loss_val': 0.14261807737015814, 'psi': 0.9635160610267103}
[S17] START round=41 head_norm_before_train=1.576443 cos_to_last_merge=0.9999 (last merge round=39)
[S17] round=41 local utility u=0.467422 metrics={'f1_val': 0.5535503982323681, 'auprc': 0.7399465599283105, 'loss_val': 0.7251682036426955, 'psi': 0.628108862910745}-{'f1_val': 0.45699306097740056, 'auprc': 0.6826515833082671, 'loss_val': 0.9087834816219859, 'psi': 0.5472564699097472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:42003
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=41 metric=0.8120 head_norm=1.897483
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.948408e-02
[S15] stored merged vector for next round verification (round=41)
[S15] DEBUG after merge:  round=41 metric=0.8128 head_norm=1.895655 delta_norm=0.029484
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:42004
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=-0.0426
[S3] DROPPED delta from S9 (cos=-0.0426 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:42011
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=-0.0652
[S4] DROPPED delta from S10 (cos=-0.0652 < 0.0)
[S3] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S3
[S10] cosine check vs S3: cos=0.9995
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:42016
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] cosine check vs S17: cos=0.9993
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=41 metric=0.9934 head_norm=1.958999
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.011463e-02
[S10] stored merged vector for next round verification (round=41)
[S10] DEBUG after merge:  round=41 metric=0.9934 head_norm=1.963850 delta_norm=0.030115
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.787334 cos_to_last_merge=0.8118 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.812
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.8255766790091693, 'auprc': 0.8747543491243842, 'loss_val': 0.3277573361044728, 'psi': 0.8452477470552553}-{'f1_val': 0.8382735640047402, 'auprc': 0.8568914342936573, 'loss_val': 0.3502958567027402, 'psi': 0.845720712120307}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.969149 cos_to_last_merge=0.9773 (last merge round=23)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.8852011798210022, 'auprc': 0.9377215897062303, 'loss_val': 0.2862623061158528, 'psi': 0.9062093437750935}-{'f1_val': 0.9890359117677164, 'auprc': 0.9980778417815275, 'loss_val': 0.05301720141602401, 'psi': 0.9926526837732409}
[S4] START round=42 head_norm_before_train=1.777269 cos_to_last_merge=0.7943 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.794
[S4] round=42 local utility u=0.056815 metrics={'f1_val': 0.945941931109548, 'auprc': 0.955572152496438, 'loss_val': 0.2771091771504956, 'psi': 0.949794019664304}-{'f1_val': 0.9406455632038122, 'auprc': 0.9360377672904949, 'loss_val': 0.30035847262856474, 'psi': 0.9388024448384853}
[S5] START round=42 head_norm_before_train=2.055546 (no previous merge yet)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9961130303197829, 'loss_val': 0.024394675377085045, 'psi': 0.9961568261134998}-{'f1_val': 0.996625909096903, 'auprc': 0.9986478133865476, 'loss_val': 0.02529960580757427, 'psi': 0.9974346708127608}
[S6] START round=42 head_norm_before_train=1.866227 (no previous merge yet)
[S6] round=42 local utility u=1.000000 metrics={'f1_val': 0.8533845373344457, 'auprc': 0.9460937525166184, 'loss_val': 0.4728014131732515, 'psi': 0.8904682234073148}-{'f1_val': 0.5959213185441545, 'auprc': 0.9078183168142266, 'loss_val': 1.0814978811518092, 'psi': 0.7206801178521833}
[S7] START round=42 head_norm_before_train=1.846626 (no previous merge yet)
[S7] round=42 local utility u=0.142892 metrics={'f1_val': 0.6460440100592728, 'auprc': 0.8095757340715383, 'loss_val': 0.4677339960489839, 'psi': 0.711456699664179}-{'f1_val': 0.6195737995565531, 'auprc': 0.8016268796394797, 'loss_val': 0.5708509651245005, 'psi': 0.6923950315897238}
[S8] START round=42 head_norm_before_train=1.630790 cos_to_last_merge=0.9914 (last merge round=33)
[S8] round=42 local utility u=0.015144 metrics={'f1_val': 0.9896849108621378, 'auprc': 0.9987620133963571, 'loss_val': 0.04775288278384494, 'psi': 0.9933157518758255}-{'f1_val': 0.9859393502901527, 'auprc': 0.9987565217485637, 'loss_val': 0.055551374767039044, 'psi': 0.9910662188735171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=42 head_norm_before_train=2.019293 cos_to_last_merge=0.8219 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.822
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9939925354962436, 'loss_val': 0.016530040821721107, 'psi': 0.9958587617057831}-{'f1_val': 0.9975138174234109, 'auprc': 0.9999366115443288, 'loss_val': 0.015265041364093552, 'psi': 0.9984829350717781}
[S10] START round=42 head_norm_before_train=1.963850 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=42 local utility u=0.000832 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9937365872536732, 'loss_val': 0.03271141325697849, 'psi': 0.9943438004330928}-{'f1_val': 0.9934327081542391, 'auprc': 0.9958509200729502, 'loss_val': 0.032822344799669056, 'psi': 0.9943999929217235}
[S11] START round=42 head_norm_before_train=2.087883 (no previous merge yet)
[S11] round=42 local utility u=0.001315 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9987454935800277, 'loss_val': 0.021581134604015638, 'psi': 0.9974386798157393}-{'f1_val': 0.9961541414107454, 'auprc': 0.9987823784531236, 'loss_val': 0.02184249794799307, 'psi': 0.9972054362276966}
[S13] START round=42 head_norm_before_train=1.731177 cos_to_last_merge=0.9902 (last merge round=23)
[S13] round=42 local utility u=0.080565 metrics={'f1_val': 0.6021100815527003, 'auprc': 0.5405798332878932, 'loss_val': 0.8545019843210232, 'psi': 0.5774979822467774}-{'f1_val': 0.5435509561680956, 'auprc': 0.6718221115872134, 'loss_val': 1.0580034738189743, 'psi': 0.5948594183357427}
[S14] START round=42 head_norm_before_train=1.902248 cos_to_last_merge=1.0000 (last merge round=40)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.996409494171709, 'loss_val': 0.0257768269570148, 'psi': 0.9965161366351338}-{'f1_val': 0.9965872316107504, 'auprc': 0.9977547111403213, 'loss_val': 0.02675766083554359, 'psi': 0.9970542234225788}
[S15] START round=42 head_norm_before_train=1.895655 cos_to_last_merge=1.0000 (last merge round=41)
[S15] round=42 local utility u=0.329232 metrics={'f1_val': 0.9008967941393231, 'auprc': 0.9958711385078962, 'loss_val': 0.1766613183112697, 'psi': 0.9388865318867523}-{'f1_val': 0.8119925276997084, 'auprc': 0.9951955987961204, 'loss_val': 0.2996732503023708, 'psi': 0.8852737561382732}
[S16] START round=42 head_norm_before_train=1.598802 cos_to_last_merge=0.9998 (last merge round=39)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.8407767498199903, 'auprc': 0.9072022936467209, 'loss_val': 0.7837200367161552, 'psi': 0.8673469673506826}-{'f1_val': 0.8926656048350127, 'auprc': 0.9941393729731209, 'loss_val': 0.3576438164940759, 'psi': 0.933255112090256}
[S17] START round=42 head_norm_before_train=1.588291 cos_to_last_merge=0.9997 (last merge round=39)
[S17] round=42 local utility u=0.103494 metrics={'f1_val': 0.587779025072937, 'auprc': 0.7364503241576525, 'loss_val': 0.7130640120640783, 'psi': 0.6472475447068232}-{'f1_val': 0.5535503982323681, 'auprc': 0.7399465599283105, 'loss_val': 0.7251682036426955, 'psi': 0.628108862910745}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:42012
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.994)
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=-0.1548
[S14] DROPPED delta from S7 (cos=-0.1548 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] cosine check vs S6: cos=-0.1838
[S11] DROPPED delta from S6 (cos=-0.1838 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:42012
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=42 metric=0.9966 head_norm=1.913529
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.537004e-02
[S14] stored merged vector for next round verification (round=42)
[S14] DEBUG after merge:  round=42 metric=0.9966 head_norm=1.910858 delta_norm=0.015370
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=42 metric=0.8408 head_norm=1.619880
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.911337e-02
[S16] stored merged vector for next round verification (round=42)
[S16] DEBUG after merge:  round=42 metric=0.8406 head_norm=1.603686 delta_norm=0.039113
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] RECEIVED delta(kind=head bytes=1802) from S13
[S11] cosine check vs S13: cos=-0.1245
[S11] DROPPED delta from S13 (cos=-0.1245 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:42013
[S17] not sending this round → trigger blocked (psi=0.647)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:42007
[S11] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1793) from S4
[S13] cosine check vs S4: cos=-0.0165
[S13] DROPPED delta from S4 (cos=-0.0165 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S11
[S6] cosine check vs S11: cos=-0.1838
[S6] DROPPED delta from S11 (cos=-0.1838 < 0.0)
[S2] START round=43 head_norm_before_train=1.794289 cos_to_last_merge=0.8116 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.812
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.8175557612924349, 'auprc': 0.8740620857926346, 'loss_val': 0.3360841121524232, 'psi': 0.8401582910925147}-{'f1_val': 0.8255766790091693, 'auprc': 0.8747543491243842, 'loss_val': 0.3277573361044728, 'psi': 0.8452477470552553}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.978046 cos_to_last_merge=0.9765 (last merge round=23)
[S3] round=43 local utility u=0.400408 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9981695701546364, 'loss_val': 0.12203309641762924, 'psi': 0.9759128793015268}-{'f1_val': 0.8852011798210022, 'auprc': 0.9377215897062303, 'loss_val': 0.2862623061158528, 'psi': 0.9062093437750935}
[S4] START round=43 head_norm_before_train=1.783291 cos_to_last_merge=0.7937 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.794
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9424919809573055, 'auprc': 0.9252579926184388, 'loss_val': 0.29305111417696506, 'psi': 0.9355983856217589}-{'f1_val': 0.945941931109548, 'auprc': 0.955572152496438, 'loss_val': 0.2771091771504956, 'psi': 0.949794019664304}
[S5] START round=43 head_norm_before_train=2.057886 (no previous merge yet)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9958505182290647, 'loss_val': 0.025025235308184676, 'psi': 0.9960518212772125}-{'f1_val': 0.996186023309311, 'auprc': 0.9961130303197829, 'loss_val': 0.024394675377085045, 'psi': 0.9961568261134998}
[S6] START round=43 head_norm_before_train=1.872798 (no previous merge yet)
[S6] round=43 local utility u=0.015067 metrics={'f1_val': 0.8590370914250104, 'auprc': 0.9420292046873195, 'loss_val': 0.464388325951619, 'psi': 0.8922339367299341}-{'f1_val': 0.8533845373344457, 'auprc': 0.9460937525166184, 'loss_val': 0.4728014131732515, 'psi': 0.8904682234073148}
[S7] START round=43 head_norm_before_train=1.849913 (no previous merge yet)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5609560952666898, 'auprc': 0.7909670152024637, 'loss_val': 0.8314521740607221, 'psi': 0.6529604632409993}-{'f1_val': 0.6460440100592728, 'auprc': 0.8095757340715383, 'loss_val': 0.4677339960489839, 'psi': 0.711456699664179}
[S8] START round=43 head_norm_before_train=1.652840 cos_to_last_merge=0.9902 (last merge round=33)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9932810269810869, 'auprc': 0.9852525964432777, 'loss_val': 0.048847266811300194, 'psi': 0.9900696547659633}-{'f1_val': 0.9896849108621378, 'auprc': 0.9987620133963571, 'loss_val': 0.04775288278384494, 'psi': 0.9933157518758255}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=2.023362 cos_to_last_merge=0.8215 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.821
[S9] round=43 local utility u=0.009603 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999468430448762, 'loss_val': 0.015186134993704664, 'psi': 0.9982404847252362}-{'f1_val': 0.9971029125121428, 'auprc': 0.9939925354962436, 'loss_val': 0.016530040821721107, 'psi': 0.9958587617057831}
[S10] START round=43 head_norm_before_train=1.969235 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=43 local utility u=0.000391 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9934812206340962, 'loss_val': 0.03248151658284898, 'psi': 0.9943734001726842}-{'f1_val': 0.9947486092193725, 'auprc': 0.9937365872536732, 'loss_val': 0.03271141325697849, 'psi': 0.9943438004330928}
[S11] START round=43 head_norm_before_train=2.098184 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9990883583780636, 'loss_val': 0.02139789673372186, 'psi': 0.9973278281976727}-{'f1_val': 0.996567470639547, 'auprc': 0.9987454935800277, 'loss_val': 0.021581134604015638, 'psi': 0.9974386798157393}
[S13] START round=43 head_norm_before_train=1.736388 cos_to_last_merge=0.9898 (last merge round=23)
[S13] round=43 local utility u=0.077407 metrics={'f1_val': 0.563412324873035, 'auprc': 0.6833082257262209, 'loss_val': 0.8956875383645218, 'psi': 0.6113706852143094}-{'f1_val': 0.6021100815527003, 'auprc': 0.5405798332878932, 'loss_val': 0.8545019843210232, 'psi': 0.5774979822467774}
[S14] START round=43 head_norm_before_train=1.910858 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=43 local utility u=0.002502 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9970168038656644, 'loss_val': 0.025056321689110404, 'psi': 0.9970052264408649}-{'f1_val': 0.9965872316107504, 'auprc': 0.996409494171709, 'loss_val': 0.0257768269570148, 'psi': 0.9965161366351338}
[S15] START round=43 head_norm_before_train=1.908307 cos_to_last_merge=1.0000 (last merge round=41)
[S15] round=43 local utility u=0.365226 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980284576220666, 'loss_val': 0.027781015932253753, 'psi': 0.997259384081339}-{'f1_val': 0.9008967941393231, 'auprc': 0.9958711385078962, 'loss_val': 0.1766613183112697, 'psi': 0.9388865318867523}
[S16] START round=43 head_norm_before_train=1.603686 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=43 local utility u=0.570356 metrics={'f1_val': 0.9035913702895774, 'auprc': 0.9853230265285208, 'loss_val': 0.25425814107244277, 'psi': 0.9362840327851547}-{'f1_val': 0.8407767498199903, 'auprc': 0.9072022936467209, 'loss_val': 0.7837200367161552, 'psi': 0.8673469673506826}
[S17] START round=43 head_norm_before_train=1.602392 cos_to_last_merge=0.9992 (last merge round=39)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.45606496976422484, 'auprc': 0.702085333054708, 'loss_val': 0.9840109360379095, 'psi': 0.5544731150804181}-{'f1_val': 0.587779025072937, 'auprc': 0.7364503241576525, 'loss_val': 0.7130640120640783, 'psi': 0.6472475447068232}
[S6] not sending this round → trigger blocked (psi=0.892)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:42003
[S15] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:42004
[S9] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:42008
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=-0.0444
[S3] DROPPED delta from S9 (cos=-0.0444 < 0.0)
[S16] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S13] not sending this round → trigger blocked (psi=0.611)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:42011
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=-0.1544
[S7] DROPPED delta from S14 (cos=-0.1544 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1805) from S10
[S4] cosine check vs S10: cos=-0.0651
[S4] DROPPED delta from S10 (cos=-0.0651 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] cosine check vs S16: cos=0.9987
[S3] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S3
[S10] cosine check vs S3: cos=0.9996
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=43 metric=0.9950 head_norm=1.976524
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.830269e-02
[S10] stored merged vector for next round verification (round=43)
[S10] DEBUG after merge:  round=43 metric=0.9950 head_norm=1.982404 delta_norm=0.028303
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=43 metric=0.4561 head_norm=1.617182
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.129978e-02
[S17] stored merged vector for next round verification (round=43)
[S17] DEBUG after merge:  round=43 metric=0.4561 head_norm=1.618575 delta_norm=0.041300
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.799794 cos_to_last_merge=0.8114 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.811
[S2] round=44 local utility u=0.341697 metrics={'f1_val': 0.8762311552156987, 'auprc': 0.9329770553509668, 'loss_val': 0.1814877255680552, 'psi': 0.898929515269806}-{'f1_val': 0.8175557612924349, 'auprc': 0.8740620857926346, 'loss_val': 0.3360841121524232, 'psi': 0.8401582910925147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=44 head_norm_before_train=1.988668 cos_to_last_merge=0.9757 (last merge round=23)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9473002352720539, 'auprc': 0.9880146812452708, 'loss_val': 0.1804789128473041, 'psi': 0.9635860136613407}-{'f1_val': 0.9610750853994537, 'auprc': 0.9981695701546364, 'loss_val': 0.12203309641762924, 'psi': 0.9759128793015268}
[S4] START round=44 head_norm_before_train=1.787883 cos_to_last_merge=0.7930 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.793
[S4] round=44 local utility u=0.025037 metrics={'f1_val': 0.9446115777050441, 'auprc': 0.9355683606662535, 'loss_val': 0.2866263333236753, 'psi': 0.9409942908895278}-{'f1_val': 0.9424919809573055, 'auprc': 0.9252579926184388, 'loss_val': 0.29305111417696506, 'psi': 0.9355983856217589}
[S5] START round=44 head_norm_before_train=2.053521 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9960108907411449, 'loss_val': 0.025865934293491377, 'psi': 0.9961159702820446}-{'f1_val': 0.996186023309311, 'auprc': 0.9958505182290647, 'loss_val': 0.025025235308184676, 'psi': 0.9960518212772125}
[S6] START round=44 head_norm_before_train=1.879506 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6584385153835453, 'auprc': 0.8705505582167294, 'loss_val': 0.9200911866093656, 'psi': 0.7432833325168189}-{'f1_val': 0.8590370914250104, 'auprc': 0.9420292046873195, 'loss_val': 0.464388325951619, 'psi': 0.8922339367299341}
[S7] START round=44 head_norm_before_train=1.854543 (no previous merge yet)
[S7] round=44 local utility u=0.037721 metrics={'f1_val': 0.5690181210418548, 'auprc': 0.7941670169314998, 'loss_val': 0.8139818391180962, 'psi': 0.6590776793977129}-{'f1_val': 0.5609560952666898, 'auprc': 0.7909670152024637, 'loss_val': 0.8314521740607221, 'psi': 0.6529604632409993}
[S8] START round=44 head_norm_before_train=1.672204 cos_to_last_merge=0.9892 (last merge round=33)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9846769408645597, 'auprc': 0.9988780639041747, 'loss_val': 0.05707175983847645, 'psi': 0.9903573900804057}-{'f1_val': 0.9932810269810869, 'auprc': 0.9852525964432777, 'loss_val': 0.048847266811300194, 'psi': 0.9900696547659633}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=2.025799 cos_to_last_merge=0.8215 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.822
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999341057697437, 'loss_val': 0.015721395439113398, 'psi': 0.9982353898151832}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999468430448762, 'loss_val': 0.015186134993704664, 'psi': 0.9982404847252362}
[S10] START round=44 head_norm_before_train=1.982404 cos_to_last_merge=1.0000 (last merge round=43)
[S10] round=44 local utility u=0.000114 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9941039448197192, 'loss_val': 0.03148821046656752, 'psi': 0.9943590420069243}-{'f1_val': 0.9949681865317428, 'auprc': 0.9934812206340962, 'loss_val': 0.03248151658284898, 'psi': 0.9943734001726842}
[S11] START round=44 head_norm_before_train=2.103234 (no previous merge yet)
[S11] round=44 local utility u=0.000207 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9990884710336156, 'loss_val': 0.020983299941907056, 'psi': 0.9973278732598935}-{'f1_val': 0.9961541414107454, 'auprc': 0.9990883583780636, 'loss_val': 0.02139789673372186, 'psi': 0.9973278281976727}
[S13] START round=44 head_norm_before_train=1.739913 cos_to_last_merge=0.9894 (last merge round=23)
[S13] round=44 local utility u=0.006925 metrics={'f1_val': 0.553769168277834, 'auprc': 0.6799235388251202, 'loss_val': 0.8138253636662894, 'psi': 0.6042309164967485}-{'f1_val': 0.563412324873035, 'auprc': 0.6833082257262209, 'loss_val': 0.8956875383645218, 'psi': 0.6113706852143094}
[S14] START round=44 head_norm_before_train=1.917183 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9970175845917043, 'loss_val': 0.02563766438029443, 'psi': 0.9970055387312808}-{'f1_val': 0.9969975081576651, 'auprc': 0.9970168038656644, 'loss_val': 0.025056321689110404, 'psi': 0.9970052264408649}
[S15] START round=44 head_norm_before_train=1.921855 cos_to_last_merge=0.9999 (last merge round=41)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7010443585704017, 'auprc': 0.9904524627886553, 'loss_val': 0.36288529788537804, 'psi': 0.8168076002577032}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980284576220666, 'loss_val': 0.027781015932253753, 'psi': 0.997259384081339}
[S16] START round=44 head_norm_before_train=1.621019 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=44 local utility u=0.378442 metrics={'f1_val': 0.991829070036266, 'auprc': 0.9935029475012114, 'loss_val': 0.051340467551195035, 'psi': 0.9924986210222441}-{'f1_val': 0.9035913702895774, 'auprc': 0.9853230265285208, 'loss_val': 0.25425814107244277, 'psi': 0.9362840327851547}
[S17] START round=44 head_norm_before_train=1.618575 cos_to_last_merge=1.0000 (last merge round=43)
[S17] round=44 local utility u=0.323385 metrics={'f1_val': 0.539960199607369, 'auprc': 0.7196735404451697, 'loss_val': 0.8933776599663839, 'psi': 0.6118455359424892}-{'f1_val': 0.45606496976422484, 'auprc': 0.702085333054708, 'loss_val': 0.9840109360379095, 'psi': 0.5544731150804181}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:42014
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1806 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.992)
[S10] not sending this round → trigger blocked (psi=0.994)
[S14] RECEIVED delta(kind=head bytes=1806) from S7
[S14] cosine check vs S7: cos=-0.1546
[S14] DROPPED delta from S7 (cos=-0.1546 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:42012
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1806 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1806) from S13
[S11] cosine check vs S13: cos=-0.1244
[S11] DROPPED delta from S13 (cos=-0.1244 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:42007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:42016
[S11] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S17
[S16] cosine check vs S17: cos=0.9992
[S6] RECEIVED delta(kind=head bytes=1799) from S11
[S6] cosine check vs S11: cos=-0.1846
[S6] DROPPED delta from S11 (cos=-0.1846 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S4
[S13] cosine check vs S4: cos=-0.0171
[S13] DROPPED delta from S4 (cos=-0.0171 < 0.0)
[S2] START round=45 head_norm_before_train=1.806655 cos_to_last_merge=0.8109 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.811
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.7701589466496357, 'auprc': 0.7761932336103302, 'loss_val': 0.43071697753847454, 'psi': 0.7725726614339135}-{'f1_val': 0.8762311552156987, 'auprc': 0.9329770553509668, 'loss_val': 0.1814877255680552, 'psi': 0.898929515269806}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.999563 cos_to_last_merge=0.9748 (last merge round=23)
[S3] round=45 local utility u=0.094604 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.998765545219052, 'loss_val': 0.10593437881506672, 'psi': 0.9761273687508869}-{'f1_val': 0.9473002352720539, 'auprc': 0.9880146812452708, 'loss_val': 0.1804789128473041, 'psi': 0.9635860136613407}
[S4] START round=45 head_norm_before_train=1.794056 cos_to_last_merge=0.7922 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=45 local utility u=0.088394 metrics={'f1_val': 0.9516436283085787, 'auprc': 0.9742517911444537, 'loss_val': 0.2680801622297423, 'psi': 0.9606868934429287}-{'f1_val': 0.9446115777050441, 'auprc': 0.9355683606662535, 'loss_val': 0.2866263333236753, 'psi': 0.9409942908895278}
[S5] START round=45 head_norm_before_train=2.058498 (no previous merge yet)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9932463111266743, 'loss_val': 0.026141953416179475, 'psi': 0.9950101384362563}-{'f1_val': 0.996186023309311, 'auprc': 0.9960108907411449, 'loss_val': 0.025865934293491377, 'psi': 0.9961159702820446}
[S6] START round=45 head_norm_before_train=1.887387 (no previous merge yet)
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.8674482550857228, 'auprc': 0.9394514623249226, 'loss_val': 0.34465053200371365, 'psi': 0.8962495379814026}-{'f1_val': 0.6584385153835453, 'auprc': 0.8705505582167294, 'loss_val': 0.9200911866093656, 'psi': 0.7432833325168189}
[S7] START round=45 head_norm_before_train=1.859446 (no previous merge yet)
[S7] round=45 local utility u=0.303797 metrics={'f1_val': 0.5774423380588862, 'auprc': 0.9388918114101032, 'loss_val': 0.6911074518773984, 'psi': 0.722022127399373}-{'f1_val': 0.5690181210418548, 'auprc': 0.7941670169314998, 'loss_val': 0.8139818391180962, 'psi': 0.6590776793977129}
[S8] START round=45 head_norm_before_train=1.688803 cos_to_last_merge=0.9885 (last merge round=33)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9794510226230733, 'auprc': 0.9988695589485104, 'loss_val': 0.06570042699790578, 'psi': 0.9872184371532482}-{'f1_val': 0.9846769408645597, 'auprc': 0.9988780639041747, 'loss_val': 0.05707175983847645, 'psi': 0.9903573900804057}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=2.032187 cos_to_last_merge=0.8214 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.821
[S9] round=45 local utility u=0.001483 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9999361486543448, 'loss_val': 0.01522680912998317, 'psi': 0.9984827499157845}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999341057697437, 'loss_val': 0.015721395439113398, 'psi': 0.9982353898151832}
[S10] START round=45 head_norm_before_train=1.990681 cos_to_last_merge=1.0000 (last merge round=43)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9939659265830832, 'loss_val': 0.031138783846754493, 'psi': 0.9943038347122699}-{'f1_val': 0.9945291067983943, 'auprc': 0.9941039448197192, 'loss_val': 0.03148821046656752, 'psi': 0.9943590420069243}
[S11] START round=45 head_norm_before_train=2.110111 (no previous merge yet)
[S11] round=45 local utility u=0.000133 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9990829065940987, 'loss_val': 0.020700885932301318, 'psi': 0.9973256474840867}-{'f1_val': 0.9961541414107454, 'auprc': 0.9990884710336156, 'loss_val': 0.020983299941907056, 'psi': 0.9973278732598935}
[S13] START round=45 head_norm_before_train=1.742812 cos_to_last_merge=0.9890 (last merge round=23)
[S13] round=45 local utility u=0.150801 metrics={'f1_val': 0.5851064270792831, 'auprc': 0.6714719270351315, 'loss_val': 0.6748928419115038, 'psi': 0.6196526270616224}-{'f1_val': 0.553769168277834, 'auprc': 0.6799235388251202, 'loss_val': 0.8138253636662894, 'psi': 0.6042309164967485}
[S14] START round=45 head_norm_before_train=1.924794 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=45 local utility u=0.000056 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9970363893227517, 'loss_val': 0.025582768923061223, 'psi': 0.9970130606236998}-{'f1_val': 0.9969975081576651, 'auprc': 0.9970175845917043, 'loss_val': 0.02563766438029443, 'psi': 0.9970055387312808}
[S15] START round=45 head_norm_before_train=1.934821 cos_to_last_merge=0.9998 (last merge round=41)
[S15] round=45 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9968108687355741, 'loss_val': 0.02721852460190871, 'psi': 0.996772348526742}-{'f1_val': 0.7010443585704017, 'auprc': 0.9904524627886553, 'loss_val': 0.36288529788537804, 'psi': 0.8168076002577032}
[S16] START round=45 head_norm_before_train=1.637384 cos_to_last_merge=0.9999 (last merge round=42)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8318179021245237, 'auprc': 0.8624499493356429, 'loss_val': 0.9588483494107872, 'psi': 0.8440707210089714}-{'f1_val': 0.991829070036266, 'auprc': 0.9935029475012114, 'loss_val': 0.051340467551195035, 'psi': 0.9924986210222441}
[S17] START round=45 head_norm_before_train=1.633409 cos_to_last_merge=0.9999 (last merge round=43)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.5424920253434373, 'auprc': 0.7304202394338695, 'loss_val': 0.9468804367188899, 'psi': 0.6176633109796101}-{'f1_val': 0.539960199607369, 'auprc': 0.7196735404451697, 'loss_val': 0.8933776599663839, 'psi': 0.6118455359424892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:42012
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.722)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:42008
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=0.225 → S14@127.0.0.1:42014
[S5] ⇄ pheromone p=0.001 → S16@127.0.0.1:42016
[S6] sending update (kind=head size=1793 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1793) from S6
[S11] cosine check vs S6: cos=-0.1848
[S11] DROPPED delta from S6 (cos=-0.1848 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1793) from S9
[S3] cosine check vs S9: cos=-0.0458
[S3] DROPPED delta from S9 (cos=-0.0458 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.9996
[S13] not sending this round → trigger blocked (psi=0.620)
[S15] ⇄ pheromone p=0.389 → S14@127.0.0.1:42014
[S9] ⇄ pheromone p=0.002 → S3@127.0.0.1:42003
[S6] ⇄ pheromone p=0.436 → S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:42011
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=-0.1559
[S7] DROPPED delta from S14 (cos=-0.1559 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=45 metric=0.8318 head_norm=1.649675
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.776873e-02
[S16] stored merged vector for next round verification (round=45)
[S16] DEBUG after merge:  round=45 metric=0.8318 head_norm=1.641127 delta_norm=0.037769
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.179 → S17@127.0.0.1:42017
[S3] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S3
[S10] cosine check vs S3: cos=0.9996
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=45 metric=0.9970 head_norm=1.932739
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.901541e-02
[S14] stored merged vector for next round verification (round=45)
[S14] DEBUG after merge:  round=45 metric=0.9970 head_norm=1.938927 delta_norm=0.029015
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.003 → S15@127.0.0.1:42015
[S4] not sending this round → trigger blocked (psi=0.961)
[S11] not sending this round → trigger blocked (psi=0.997)
[S3] ⇄ pheromone p=0.123 → S10@127.0.0.1:42011
[S4] ⇄ pheromone p=0.036 → S13@127.0.0.1:42013
[S11] ⇄ pheromone p=0.007 → S6@127.0.0.1:42007
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=45 metric=0.9945 head_norm=1.996273
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.779105e-02
[S10] stored merged vector for next round verification (round=45)
[S10] DEBUG after merge:  round=45 metric=0.9945 head_norm=2.003286 delta_norm=0.027791
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.002 → S3@127.0.0.1:42003
[S13] ⇄ pheromone p=0.093 → S11@127.0.0.1:42012
[S17] ⇄ pheromone p=0.173 → S16@127.0.0.1:42016
[S2] START round=46 head_norm_before_train=1.813570 cos_to_last_merge=0.8104 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.810
[S2] round=46 local utility u=0.815735 metrics={'f1_val': 0.9110572239632473, 'auprc': 0.9477296887312039, 'loss_val': 0.15924529443587732, 'psi': 0.92572620987043}-{'f1_val': 0.7701589466496357, 'auprc': 0.7761932336103302, 'loss_val': 0.43071697753847454, 'psi': 0.7725726614339135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=46 head_norm_before_train=2.010659 cos_to_last_merge=0.9739 (last merge round=23)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9063182721334043, 'auprc': 0.9089879968978994, 'loss_val': 0.27946159603857257, 'psi': 0.9073861620392024}-{'f1_val': 0.9610352511054436, 'auprc': 0.998765545219052, 'loss_val': 0.10593437881506672, 'psi': 0.9761273687508869}
[S4] START round=46 head_norm_before_train=1.802508 cos_to_last_merge=0.7912 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.791
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9428240054146135, 'auprc': 0.9336247211290839, 'loss_val': 0.2945323871130274, 'psi': 0.9391442917004016}-{'f1_val': 0.9516436283085787, 'auprc': 0.9742517911444537, 'loss_val': 0.2680801622297423, 'psi': 0.9606868934429287}
[S5] START round=46 head_norm_before_train=2.068922 (no previous merge yet)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9925765770696849, 'loss_val': 0.026266933114619116, 'psi': 0.9949183189995121}-{'f1_val': 0.996186023309311, 'auprc': 0.9932463111266743, 'loss_val': 0.026141953416179475, 'psi': 0.9950101384362563}
[S6] START round=46 head_norm_before_train=1.900901 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7652347158645305, 'auprc': 0.9375750513924075, 'loss_val': 0.7880229119937057, 'psi': 0.8341708500756813}-{'f1_val': 0.8674482550857228, 'auprc': 0.9394514623249226, 'loss_val': 0.34465053200371365, 'psi': 0.8962495379814026}
[S7] START round=46 head_norm_before_train=1.867955 (no previous merge yet)
[S7] round=46 local utility u=1.000000 metrics={'f1_val': 0.9110210141643249, 'auprc': 0.9801972704472193, 'loss_val': 0.32659351096004247, 'psi': 0.9386915166774827}-{'f1_val': 0.5774423380588862, 'auprc': 0.9388918114101032, 'loss_val': 0.6911074518773984, 'psi': 0.722022127399373}
[S8] START round=46 head_norm_before_train=1.703386 cos_to_last_merge=0.9879 (last merge round=33)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9728726833726263, 'auprc': 0.9986948509428812, 'loss_val': 0.07534616670628153, 'psi': 0.9832015504007283}-{'f1_val': 0.9794510226230733, 'auprc': 0.9988695589485104, 'loss_val': 0.06570042699790578, 'psi': 0.9872184371532482}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=2.035776 cos_to_last_merge=0.8206 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.821
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9940606670340656, 'loss_val': 0.01660884675628169, 'psi': 0.995886014320912}-{'f1_val': 0.9975138174234109, 'auprc': 0.9999361486543448, 'loss_val': 0.01522680912998317, 'psi': 0.9984827499157845}
[S10] START round=46 head_norm_before_train=2.003286 cos_to_last_merge=1.0000 (last merge round=45)
[S10] round=46 local utility u=0.000060 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9939374188936894, 'loss_val': 0.030932526656833718, 'psi': 0.9942924316365124}-{'f1_val': 0.9945291067983943, 'auprc': 0.9939659265830832, 'loss_val': 0.031138783846754493, 'psi': 0.9943038347122699}
[S11] START round=46 head_norm_before_train=2.118092 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.999063256916084, 'loss_val': 0.02078811595150371, 'psi': 0.9973177876128808}-{'f1_val': 0.9961541414107454, 'auprc': 0.9990829065940987, 'loss_val': 0.020700885932301318, 'psi': 0.9973256474840867}
[S13] START round=46 head_norm_before_train=1.747398 cos_to_last_merge=0.9888 (last merge round=23)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.5200054148719071, 'auprc': 0.6715279074437119, 'loss_val': 1.1379093711629709, 'psi': 0.580614411900629}-{'f1_val': 0.5851064270792831, 'auprc': 0.6714719270351315, 'loss_val': 0.6748928419115038, 'psi': 0.6196526270616224}
[S14] START round=46 head_norm_before_train=1.938927 cos_to_last_merge=1.0000 (last merge round=45)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9970403632582, 'loss_val': 0.02440428754765809, 'psi': 0.9968826098747418}-{'f1_val': 0.9969975081576651, 'auprc': 0.9970363893227517, 'loss_val': 0.025582768923061223, 'psi': 0.9970130606236998}
[S15] START round=46 head_norm_before_train=1.945528 cos_to_last_merge=0.9997 (last merge round=41)
[S15] round=46 local utility u=0.005216 metrics={'f1_val': 0.996885986019492, 'auprc': 0.999285859720179, 'loss_val': 0.0250476126003815, 'psi': 0.9978459354997669}-{'f1_val': 0.9967466683875206, 'auprc': 0.9968108687355741, 'loss_val': 0.02721852460190871, 'psi': 0.996772348526742}
[S16] START round=46 head_norm_before_train=1.641127 cos_to_last_merge=1.0000 (last merge round=45)
[S16] round=46 local utility u=1.000000 metrics={'f1_val': 0.9925970590761196, 'auprc': 0.9924251449731297, 'loss_val': 0.04668406080662927, 'psi': 0.9925282934349237}-{'f1_val': 0.8318179021245237, 'auprc': 0.8624499493356429, 'loss_val': 0.9588483494107872, 'psi': 0.8440707210089714}
[S17] START round=46 head_norm_before_train=1.646777 cos_to_last_merge=0.9997 (last merge round=43)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.5334337201143601, 'auprc': 0.7142808925187389, 'loss_val': 0.985951157338368, 'psi': 0.6057725890761116}-{'f1_val': 0.5424920253434373, 'auprc': 0.7304202394338695, 'loss_val': 0.9468804367188899, 'psi': 0.6176633109796101}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.998)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:42014
[S7] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:42003
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=-0.1568
[S14] DROPPED delta from S7 (cos=-0.1568 < 0.0)
[S10] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RECEIVED delta(kind=head bytes=1803) from S16
[S17] cosine check vs S16: cos=0.9990
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] cosine check vs S10: cos=0.9998
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=46 metric=0.9063 head_norm=2.018377
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.034498e-02
[S3] stored merged vector for next round verification (round=46)
[S3] DEBUG after merge:  round=46 metric=0.9082 head_norm=2.013632 delta_norm=0.020345
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=46 metric=0.5334 head_norm=1.657728
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.632073e-02
[S17] stored merged vector for next round verification (round=46)
[S17] DEBUG after merge:  round=46 metric=0.5343 head_norm=1.656053 delta_norm=0.036321
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=1.819783 cos_to_last_merge=0.8100 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.810
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.8104680442856889, 'auprc': 0.9232515077335702, 'loss_val': 0.20571804021562468, 'psi': 0.8555814296648414}-{'f1_val': 0.9110572239632473, 'auprc': 0.9477296887312039, 'loss_val': 0.15924529443587732, 'psi': 0.92572620987043}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.013632 cos_to_last_merge=1.0000 (last merge round=46)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.7601420731358879, 'auprc': 0.9951071764928843, 'loss_val': 0.4356554805050674, 'psi': 0.8541281144786864}-{'f1_val': 0.9063182721334043, 'auprc': 0.9089879968978994, 'loss_val': 0.27946159603857257, 'psi': 0.9073861620392024}
[S4] START round=47 head_norm_before_train=1.808327 cos_to_last_merge=0.7906 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.791
[S4] round=47 local utility u=0.011261 metrics={'f1_val': 0.941675991424679, 'auprc': 0.9436509417319917, 'loss_val': 0.2952017104881099, 'psi': 0.942465971547604}-{'f1_val': 0.9428240054146135, 'auprc': 0.9336247211290839, 'loss_val': 0.2945323871130274, 'psi': 0.9391442917004016}
[S5] START round=47 head_norm_before_train=2.074309 (no previous merge yet)
[S5] round=47 local utility u=0.009185 metrics={'f1_val': 0.9969940732952631, 'auprc': 0.9970617572170241, 'loss_val': 0.024440999615453922, 'psi': 0.9970211468639676}-{'f1_val': 0.9964794802860635, 'auprc': 0.9925765770696849, 'loss_val': 0.026266933114619116, 'psi': 0.9949183189995121}
[S6] START round=47 head_norm_before_train=1.914017 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.5988204883128232, 'auprc': 0.7254915087065017, 'loss_val': 1.2419866614830255, 'psi': 0.6494888964702945}-{'f1_val': 0.7652347158645305, 'auprc': 0.9375750513924075, 'loss_val': 0.7880229119937057, 'psi': 0.8341708500756813}
[S7] START round=47 head_norm_before_train=1.876321 (no previous merge yet)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6928937434113988, 'auprc': 0.9310750731410421, 'loss_val': 0.6067901008605223, 'psi': 0.7881662753032561}-{'f1_val': 0.9110210141643249, 'auprc': 0.9801972704472193, 'loss_val': 0.32659351096004247, 'psi': 0.9386915166774827}
[S8] START round=47 head_norm_before_train=1.717358 cos_to_last_merge=0.9872 (last merge round=33)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.7135780681239317, 'auprc': 0.9830980202274827, 'loss_val': 0.40755737700700806, 'psi': 0.8213860489653522}-{'f1_val': 0.9728726833726263, 'auprc': 0.9986948509428812, 'loss_val': 0.07534616670628153, 'psi': 0.9832015504007283}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=2.041249 cos_to_last_merge=0.8200 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.820
[S9] round=47 local utility u=0.009277 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9999312713972975, 'loss_val': 0.015648929377645556, 'psi': 0.9982325382824571}-{'f1_val': 0.9971029125121428, 'auprc': 0.9940606670340656, 'loss_val': 0.01660884675628169, 'psi': 0.995886014320912}
[S10] START round=47 head_norm_before_train=2.009082 cos_to_last_merge=1.0000 (last merge round=45)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9940928359134814, 'loss_val': 0.030729137313875273, 'psi': 0.9942229417565733}-{'f1_val': 0.9945291067983943, 'auprc': 0.9939374188936894, 'loss_val': 0.030932526656833718, 'psi': 0.9942924316365124}
[S11] START round=47 head_norm_before_train=2.126484 (no previous merge yet)
[S11] round=47 local utility u=0.000257 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9990656700309029, 'loss_val': 0.020280997538989005, 'psi': 0.9973187528588083}-{'f1_val': 0.9961541414107454, 'auprc': 0.999063256916084, 'loss_val': 0.02078811595150371, 'psi': 0.9973177876128808}
[S13] START round=47 head_norm_before_train=1.751448 cos_to_last_merge=0.9885 (last merge round=23)
[S13] round=47 local utility u=0.217928 metrics={'f1_val': 0.5900284673241357, 'auprc': 0.5835356654993119, 'loss_val': 0.8582150822298581, 'psi': 0.5874313465942063}-{'f1_val': 0.5200054148719071, 'auprc': 0.6715279074437119, 'loss_val': 1.1379093711629709, 'psi': 0.580614411900629}
[S14] START round=47 head_norm_before_train=1.947390 cos_to_last_merge=1.0000 (last merge round=45)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.9970524619331844, 'loss_val': 0.02365354063879906, 'psi': 0.9966412836366645}-{'f1_val': 0.9967774409524363, 'auprc': 0.9970403632582, 'loss_val': 0.02440428754765809, 'psi': 0.9968826098747418}
[S15] START round=47 head_norm_before_train=1.954094 cos_to_last_merge=0.9996 (last merge round=41)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.7009601281218527, 'auprc': 0.8937827480751449, 'loss_val': 0.5671514391316974, 'psi': 0.7780891761031696}-{'f1_val': 0.996885986019492, 'auprc': 0.999285859720179, 'loss_val': 0.0250476126003815, 'psi': 0.9978459354997669}
[S16] START round=47 head_norm_before_train=1.655173 cos_to_last_merge=1.0000 (last merge round=45)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.7426606836960555, 'auprc': 0.70373098826926, 'loss_val': 1.10037840504167, 'psi': 0.7270888055253373}-{'f1_val': 0.9925970590761196, 'auprc': 0.9924251449731297, 'loss_val': 0.04668406080662927, 'psi': 0.9925282934349237}
[S17] START round=47 head_norm_before_train=1.656053 cos_to_last_merge=1.0000 (last merge round=46)
[S17] round=47 local utility u=0.336287 metrics={'f1_val': 0.5981926198402698, 'auprc': 0.7756470716377406, 'loss_val': 0.8860294487574867, 'psi': 0.6691744005592581}-{'f1_val': 0.5334337201143601, 'auprc': 0.7142808925187389, 'loss_val': 0.985951157338368, 'psi': 0.6057725890761116}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:42016
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1797) from S9
[S3] cosine check vs S9: cos=-0.0465
[S3] DROPPED delta from S9 (cos=-0.0465 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=-0.0490
[S16] DROPPED delta from S5 (cos=-0.0490 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:42012
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1804 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1804) from S13
[S11] cosine check vs S13: cos=-0.1230
[S11] DROPPED delta from S13 (cos=-0.1230 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:42007
[S17] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S11
[S6] cosine check vs S11: cos=-0.1842
[S6] DROPPED delta from S11 (cos=-0.1842 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S17
[S16] cosine check vs S17: cos=0.9994
[S13] RECEIVED delta(kind=head bytes=1797) from S4
[S13] cosine check vs S4: cos=-0.0159
[S13] DROPPED delta from S4 (cos=-0.0159 < 0.0)
[S2] START round=48 head_norm_before_train=1.826058 cos_to_last_merge=0.8095 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.810
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.773569293013857, 'auprc': 0.8176236620672807, 'loss_val': 0.37459822569967144, 'psi': 0.7911910406352265}-{'f1_val': 0.8104680442856889, 'auprc': 0.9232515077335702, 'loss_val': 0.20571804021562468, 'psi': 0.8555814296648414}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.019135 cos_to_last_merge=1.0000 (last merge round=46)
[S3] round=48 local utility u=0.758811 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9951077195101731, 'loss_val': 0.12363232094539403, 'psi': 0.9746881390437415}-{'f1_val': 0.7601420731358879, 'auprc': 0.9951071764928843, 'loss_val': 0.4356554805050674, 'psi': 0.8541281144786864}
[S4] START round=48 head_norm_before_train=1.812730 cos_to_last_merge=0.7899 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.790
[S4] round=48 local utility u=0.055150 metrics={'f1_val': 0.9447790778396742, 'auprc': 0.9684224884804115, 'loss_val': 0.2778350300179838, 'psi': 0.9542364420959691}-{'f1_val': 0.941675991424679, 'auprc': 0.9436509417319917, 'loss_val': 0.2952017104881099, 'psi': 0.942465971547604}
[S5] START round=48 head_norm_before_train=2.079222 (no previous merge yet)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9976478213821514, 'loss_val': 0.026135162654202813, 'psi': 0.9970346740110023}-{'f1_val': 0.9969940732952631, 'auprc': 0.9970617572170241, 'loss_val': 0.024440999615453922, 'psi': 0.9970211468639676}
[S6] START round=48 head_norm_before_train=1.919711 (no previous merge yet)
[S6] round=48 local utility u=1.000000 metrics={'f1_val': 0.8669763138133338, 'auprc': 0.9709312350068655, 'loss_val': 0.31801576437557016, 'psi': 0.9085582822907465}-{'f1_val': 0.5988204883128232, 'auprc': 0.7254915087065017, 'loss_val': 1.2419866614830255, 'psi': 0.6494888964702945}
[S7] START round=48 head_norm_before_train=1.886652 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5495197219439177, 'auprc': 0.7481276432276805, 'loss_val': 1.0496517960422365, 'psi': 0.6289628904574228}-{'f1_val': 0.6928937434113988, 'auprc': 0.9310750731410421, 'loss_val': 0.6067901008605223, 'psi': 0.7881662753032561}
[S8] START round=48 head_norm_before_train=1.731335 cos_to_last_merge=0.9865 (last merge round=33)
[S8] round=48 local utility u=0.995884 metrics={'f1_val': 0.9803653013759591, 'auprc': 0.9986909142646633, 'loss_val': 0.06329110828275401, 'psi': 0.9876955465314408}-{'f1_val': 0.7135780681239317, 'auprc': 0.9830980202274827, 'loss_val': 0.40755737700700806, 'psi': 0.8213860489653522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=48 head_norm_before_train=2.041682 cos_to_last_merge=0.8200 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.820
[S9] round=48 local utility u=0.000111 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9999255931980778, 'loss_val': 0.01541024587842738, 'psi': 0.9982302670027692}-{'f1_val': 0.9971000495392299, 'auprc': 0.9999312713972975, 'loss_val': 0.015648929377645556, 'psi': 0.9982325382824571}
[S10] START round=48 head_norm_before_train=2.016167 cos_to_last_merge=1.0000 (last merge round=45)
[S10] round=48 local utility u=0.000902 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9937830148098388, 'loss_val': 0.030629481310198783, 'psi': 0.994362371455559}-{'f1_val': 0.9943096789853013, 'auprc': 0.9940928359134814, 'loss_val': 0.030729137313875273, 'psi': 0.9942229417565733}
[S11] START round=48 head_norm_before_train=2.132670 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9965919014202035, 'auprc': 0.999060000710684, 'loss_val': 0.023095851640139213, 'psi': 0.9975791411363957}-{'f1_val': 0.9961541414107454, 'auprc': 0.9990656700309029, 'loss_val': 0.020280997538989005, 'psi': 0.9973187528588083}
[S13] START round=48 head_norm_before_train=1.755320 cos_to_last_merge=0.9881 (last merge round=23)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.5583817118979175, 'auprc': 0.6799396422545704, 'loss_val': 1.0223840451426975, 'psi': 0.6070048840405786}-{'f1_val': 0.5900284673241357, 'auprc': 0.5835356654993119, 'loss_val': 0.8582150822298581, 'psi': 0.5874313465942063}
[S14] START round=48 head_norm_before_train=1.952710 cos_to_last_merge=1.0000 (last merge round=45)
[S14] round=48 local utility u=0.002101 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9981306075789597, 'loss_val': 0.026468767030553144, 'psi': 0.9974507479261829}-{'f1_val': 0.9963671647723179, 'auprc': 0.9970524619331844, 'loss_val': 0.02365354063879906, 'psi': 0.9966412836366645}
[S15] START round=48 head_norm_before_train=1.960872 cos_to_last_merge=0.9995 (last merge round=41)
[S15] round=48 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976500585881745, 'loss_val': 0.026886913898557598, 'psi': 0.9971080244677821}-{'f1_val': 0.7009601281218527, 'auprc': 0.8937827480751449, 'loss_val': 0.5671514391316974, 'psi': 0.7780891761031696}
[S16] START round=48 head_norm_before_train=1.670820 cos_to_last_merge=0.9999 (last merge round=45)
[S16] round=48 local utility u=1.000000 metrics={'f1_val': 0.9847845278454612, 'auprc': 0.9942114724102646, 'loss_val': 0.06783322357444929, 'psi': 0.9885553056713826}-{'f1_val': 0.7426606836960555, 'auprc': 0.70373098826926, 'loss_val': 1.10037840504167, 'psi': 0.7270888055253373}
[S17] START round=48 head_norm_before_train=1.667721 cos_to_last_merge=1.0000 (last merge round=46)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.45533383964688795, 'auprc': 0.6600184714557705, 'loss_val': 1.1757114819425085, 'psi': 0.537207692370441}-{'f1_val': 0.5981926198402698, 'auprc': 0.7756470716377406, 'loss_val': 0.8860294487574867, 'psi': 0.6691744005592581}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:42012
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:42015
[S6] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] cosine check vs S6: cos=-0.1839
[S11] DROPPED delta from S6 (cos=-0.1839 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.9995
[S16] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=0.9998
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] cosine check vs S16: cos=0.9989
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.9995
[S3] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S3
[S17] cosine check vs S3: cos=-0.1166
[S17] DROPPED delta from S3 (cos=-0.1166 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=48 metric=0.9848 head_norm=1.685986
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.290055e-02
[S16] stored merged vector for next round verification (round=48)
[S16] DEBUG after merge:  round=48 metric=0.9848 head_norm=1.676555 delta_norm=0.032901
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=48 metric=0.9970 head_norm=1.957368
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.093649e-02
[S14] stored merged vector for next round verification (round=48)
[S14] DEBUG after merge:  round=48 metric=0.9970 head_norm=1.962085 delta_norm=0.030936
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] not sending this round → trigger blocked (psi=0.954)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=48 metric=0.9611 head_norm=2.024503
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.010755e-02
[S3] stored merged vector for next round verification (round=48)
[S3] DEBUG after merge:  round=48 metric=0.9611 head_norm=2.024072 delta_norm=0.020108
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=48 metric=0.4553 head_norm=1.680099
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.901900e-02
[S17] stored merged vector for next round verification (round=48)
[S17] DEBUG after merge:  round=48 metric=0.4553 head_norm=1.682593 delta_norm=0.039019
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.833274 cos_to_last_merge=0.8090 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.809
[S2] round=49 local utility u=0.523451 metrics={'f1_val': 0.8501838487380862, 'auprc': 0.9399484318758086, 'loss_val': 0.15435762186694416, 'psi': 0.8860896819931752}-{'f1_val': 0.773569293013857, 'auprc': 0.8176236620672807, 'loss_val': 0.37459822569967144, 'psi': 0.7911910406352265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=49 head_norm_before_train=2.024072 cos_to_last_merge=1.0000 (last merge round=48)
[S3] round=49 local utility u=0.166256 metrics={'f1_val': 0.9969552203206308, 'auprc': 0.9989852073860688, 'loss_val': 0.018032633427565205, 'psi': 0.997767215146806}-{'f1_val': 0.9610750853994537, 'auprc': 0.9951077195101731, 'loss_val': 0.12363232094539403, 'psi': 0.9746881390437415}
[S4] START round=49 head_norm_before_train=1.819888 cos_to_last_merge=0.7888 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.789
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9445596677063015, 'auprc': 0.9598007127803596, 'loss_val': 0.28347104212428265, 'psi': 0.9506560857359247}-{'f1_val': 0.9447790778396742, 'auprc': 0.9684224884804115, 'loss_val': 0.2778350300179838, 'psi': 0.9542364420959691}
[S5] START round=49 head_norm_before_train=2.081278 (no previous merge yet)
[S5] round=49 local utility u=0.000596 metrics={'f1_val': 0.9966287944473372, 'auprc': 0.9977043868188105, 'loss_val': 0.025129202426585086, 'psi': 0.9970590313959264}-{'f1_val': 0.996625909096903, 'auprc': 0.9976478213821514, 'loss_val': 0.026135162654202813, 'psi': 0.9970346740110023}
[S6] START round=49 head_norm_before_train=1.923697 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.7627300458004533, 'auprc': 0.9164096538400118, 'loss_val': 0.6032783349137908, 'psi': 0.8242018890162768}-{'f1_val': 0.8669763138133338, 'auprc': 0.9709312350068655, 'loss_val': 0.31801576437557016, 'psi': 0.9085582822907465}
[S7] START round=49 head_norm_before_train=1.900468 (no previous merge yet)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5438429829638353, 'auprc': 0.7747676975391005, 'loss_val': 1.1540816803387386, 'psi': 0.6362128687939413}-{'f1_val': 0.5495197219439177, 'auprc': 0.7481276432276805, 'loss_val': 1.0496517960422365, 'psi': 0.6289628904574228}
[S8] START round=49 head_norm_before_train=1.739270 cos_to_last_merge=0.9861 (last merge round=33)
[S8] round=49 local utility u=0.011580 metrics={'f1_val': 0.9848998381436169, 'auprc': 0.9941266843650463, 'loss_val': 0.05364660552353534, 'psi': 0.9885905766321887}-{'f1_val': 0.9803653013759591, 'auprc': 0.9986909142646633, 'loss_val': 0.06329110828275401, 'psi': 0.9876955465314408}
[S8] not sending this round → trigger blocked (psi=0.989)
[S9] START round=49 head_norm_before_train=2.049103 cos_to_last_merge=0.8198 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.820
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9970167788442306, 'loss_val': 0.01693947482703254, 'psi': 0.996803018626027}-{'f1_val': 0.9971000495392299, 'auprc': 0.9999255931980778, 'loss_val': 0.01541024587842738, 'psi': 0.9982302670027692}
[S10] START round=49 head_norm_before_train=2.023841 cos_to_last_merge=0.9999 (last merge round=45)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9939241487875072, 'loss_val': 0.030362099343840716, 'psi': 0.9942871235940395}-{'f1_val': 0.9947486092193725, 'auprc': 0.9937830148098388, 'loss_val': 0.030629481310198783, 'psi': 0.994362371455559}
[S11] START round=49 head_norm_before_train=2.138152 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9965919014202035, 'auprc': 0.9990416950072816, 'loss_val': 0.023673845386588413, 'psi': 0.9975718188550348}-{'f1_val': 0.9965919014202035, 'auprc': 0.999060000710684, 'loss_val': 0.023095851640139213, 'psi': 0.9975791411363957}
[S13] START round=49 head_norm_before_train=1.758245 cos_to_last_merge=0.9878 (last merge round=23)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5266622859506023, 'auprc': 0.6786216674996952, 'loss_val': 1.1543380179750249, 'psi': 0.5874460385702394}-{'f1_val': 0.5583817118979175, 'auprc': 0.6799396422545704, 'loss_val': 1.0223840451426975, 'psi': 0.6070048840405786}
[S14] START round=49 head_norm_before_train=1.962085 cos_to_last_merge=1.0000 (last merge round=48)
[S14] round=49 local utility u=0.001816 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9989895853622619, 'loss_val': 0.02541280996427088, 'psi': 0.9977943390395039}-{'f1_val': 0.9969975081576651, 'auprc': 0.9981306075789597, 'loss_val': 0.026468767030553144, 'psi': 0.9974507479261829}
[S15] START round=49 head_norm_before_train=1.967278 cos_to_last_merge=0.9994 (last merge round=41)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.996959685900218, 'loss_val': 0.025536988918851058, 'psi': 0.9968318753925995}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976500585881745, 'loss_val': 0.026886913898557598, 'psi': 0.9971080244677821}
[S16] START round=49 head_norm_before_train=1.676555 cos_to_last_merge=1.0000 (last merge round=48)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.8399301976886928, 'auprc': 0.9875768077196897, 'loss_val': 0.8514449536707664, 'psi': 0.8989888417010916}-{'f1_val': 0.9847845278454612, 'auprc': 0.9942114724102646, 'loss_val': 0.06783322357444929, 'psi': 0.9885553056713826}
[S17] START round=49 head_norm_before_train=1.682593 cos_to_last_merge=1.0000 (last merge round=48)
[S17] round=49 local utility u=0.742404 metrics={'f1_val': 0.5938374409364974, 'auprc': 0.7889818134230993, 'loss_val': 0.9088142926194571, 'psi': 0.6718951899311381}-{'f1_val': 0.45533383964688795, 'auprc': 0.6600184714557705, 'loss_val': 1.1757114819425085, 'psi': 0.537207692370441}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:42016
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=49 metric=0.9967 head_norm=1.974132
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.417488e-02
[S15] stored merged vector for next round verification (round=49)
[S15] DEBUG after merge:  round=49 metric=0.9967 head_norm=1.965471 delta_norm=0.034175
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1795 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.998)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=-0.0482
[S16] DROPPED delta from S5 (cos=-0.0482 < 0.0)
[S3] not sending this round → trigger blocked (psi=0.998)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:42016
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S17
[S16] cosine check vs S17: cos=0.9998
[runner] rounds complete.
[runner] all agents stopped.
