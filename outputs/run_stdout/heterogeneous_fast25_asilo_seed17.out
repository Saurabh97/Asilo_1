[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:50303
[S3] → join 127.0.0.1:50302
[S4] → join 127.0.0.1:50302
[S5] → join 127.0.0.1:50302
[S6] → join 127.0.0.1:50302
[S7] → join 127.0.0.1:50302
[S8] → join 127.0.0.1:50302
[S9] → join 127.0.0.1:50302
[S10] → join 127.0.0.1:50302
[S11] → join 127.0.0.1:50302
[S13] → join 127.0.0.1:50302
[S14] → join 127.0.0.1:50302
[S15] → join 127.0.0.1:50302
[S16] → join 127.0.0.1:50302
[S17] → join 127.0.0.1:50302
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.153144 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.162729 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.182490 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.171113 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.168268 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.178346 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.141985 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.141418 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.171018 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.148702 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.180373 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.138806 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.177514 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.091154 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.212172 (no previous merge yet)
[S17]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S3] + discovered S11
[S3] + discovered S10
[S3] + discovered S13
[S3] + discovered S15
[S3] + discovered S16
[S3] + discovered S4
[S3] + discovered S8
[S3] + discovered S5
[S3] + discovered S14
[S3] + discovered S17
[S3] + discovered S9
[S3] + discovered S7
[S3] + discovered S6
[S4] + discovered S2
[S4] + discovered S3
[S4] + discovered S11
[S4] + discovered S10
[S4] + discovered S13
[S4] + discovered S15
[S4] + discovered S16
[S4] + discovered S8
[S4] + discovered S5
[S4] + discovered S14
[S4] + discovered S17
[S4] + discovered S9
[S4] + discovered S7
[S4] + discovered S6
[S5] + discovered S3
[S5] + discovered S4
[S5] + discovered S2
[S6] + discovered S5
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S4
[S5] + discovered S7
[S5] + discovered S8
[S5] + discovered S17
[S5] + discovered S16
[S5] + discovered S13
[S5] + discovered S11
[S5] + discovered S6
[S5] + discovered S9
[S5] + discovered S14
[S5] + discovered S15
[S5] + discovered S10
[S6] + discovered S11
[S6] + discovered S9
[S6] + discovered S15
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S6
[S7] + discovered S4
[S7] + discovered S3
[S6] + discovered S8
[S6] + discovered S14
[S6] + discovered S10
[S6] + discovered S7
[S6] + discovered S17
[S6] + discovered S16
[S6] + discovered S13
[S7] + discovered S13
[S7] + discovered S14
[S8] + discovered S6
[S7] + discovered S17
[S7] + discovered S16
[S7] + discovered S15
[S7] + discovered S9
[S8] + discovered S4
[S7] + discovered S10
[S7] + discovered S11
[S8] + discovered S5
[S7] + discovered S8
[S8] + discovered S7
[S8] + discovered S2
[S8] + discovered S3
[S8] + discovered S15
[S8] + discovered S16
[S8] + discovered S10
[S8] + discovered S9
[S8] + discovered S11
[S8] + discovered S13
[S8] + discovered S17
[S9] + discovered S7
[S9] + discovered S3
[S8] + discovered S14
[S9] + discovered S6
[S9] + discovered S4
[S9] + discovered S2
[S9] + discovered S5
[S9] + discovered S8
[S10] + discovered S6
[S9] + discovered S11
[S9] + discovered S10
[S9] + discovered S15
[S9] + discovered S14
[S10] + discovered S7
[S9] + discovered S16
[S9] + discovered S17
[S9] + discovered S13
[S10] + discovered S2
[S10] + discovered S9
[S10] + discovered S3
[S10] + discovered S5
[S10] + discovered S8
[S10] + discovered S4
[S10] + discovered S17
[S11] + discovered S10
[S11] + discovered S9
[S10] + discovered S15
[S11] + discovered S5
[S11] + discovered S7
[S10] + discovered S11
[S11] + discovered S6
[S11] + discovered S4
[S11] + discovered S2
[S11] + discovered S8
[S11] + discovered S3
[S10] + discovered S13
[S10] + discovered S14
[S10] + discovered S16
[S13] + discovered S9
[S13] + discovered S8
[S11] + discovered S16
[S11] + discovered S13
[S11] + discovered S15
[S11] + discovered S17
[S11] + discovered S14
[S13] + discovered S11
[S13] + discovered S6
[S13] + discovered S2
[S13] + discovered S3
[S13] + discovered S10
[S13] + discovered S5
[S13] + discovered S7
[S13] + discovered S4
[S14] + discovered S4
[S14] + discovered S7
[S14] + discovered S5
[S14] + discovered S10
[S13] + discovered S15
[S13] + discovered S16
[S13] + discovered S14
[S14] + discovered S9
[S13] + discovered S17
[S14] + discovered S8
[S14] + discovered S13
[S14] + discovered S11
[S14] + discovered S6
[S14] + discovered S2
[S14] + discovered S3
[S15] + discovered S13
[S15] + discovered S11
[S15] + discovered S6
[S15] + discovered S2
[S15] + discovered S3
[S15] + discovered S14
[S15] + discovered S10
[S15] + discovered S5
[S15] + discovered S7
[S15] + discovered S4
[S15] + discovered S9
[S15] + discovered S8
[S14] + discovered S16
[S14] + discovered S15
[S14] + discovered S17
[S16] + discovered S9
[S16] + discovered S4
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S8
[S16] + discovered S7
[S16] + discovered S11
[S16] + discovered S5
[S16] + discovered S10
[S16] + discovered S14
[S16] + discovered S15
[S16] + discovered S2
[S16] + discovered S6
[S16] + discovered S3
[S16] + discovered S13
[S17] + discovered S6
[S16] + discovered S17
[S17] + discovered S9
[S17] + discovered S13
[S17] + discovered S16
[S17] + discovered S3
[S17] + discovered S15
[S17] + discovered S5
[S17] + discovered S11
[S17] + discovered S7
[S17] + discovered S4
[S17] + discovered S2
[S17] + discovered S14
[S17] + discovered S10
[S17] + discovered S8
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=1.000 → S5@127.0.0.1:50305
[S10] ⇄ pheromone p=1.000 → S7@127.0.0.1:50308
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:50304
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:50309
[S15] ⇄ pheromone p=1.000 → S7@127.0.0.1:50308
[S11] ⇄ pheromone p=1.000 → S10@127.0.0.1:50311
[S14] ⇄ pheromone p=1.000 → S13@127.0.0.1:50313
[S7] ⇄ pheromone p=1.000 → S8@127.0.0.1:50309
[S13] ⇄ pheromone p=1.000 → S16@127.0.0.1:50316
[S9] ⇄ pheromone p=1.000 → S3@127.0.0.1:50303
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:50303
[S8] ⇄ pheromone p=1.000 → S16@127.0.0.1:50316
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:50307
[S6] ⇄ pheromone p=1.000 → S7@127.0.0.1:50308
[S17] ⇄ pheromone p=1.000 → S14@127.0.0.1:50314
[S2] START round=1 head_norm_before_train=1.161395 (no previous merge yet)
[S2] round=1 local utility u=0.527354 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6455944458706175, 'loss_val': 1.3358175367701697, 'psi': 0.34330405838138706}-{'f1_val': 0.09816449814126393, 'auprc': 0.39628149947579433, 'loss_val': 1.380911291194314, 'psi': 0.21741129867507608}
[S3] START round=1 head_norm_before_train=1.186709 (no previous merge yet)
[S3] round=1 local utility u=0.014802 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9291343080846733, 'loss_val': 1.273508432545335, 'psi': 0.4555577626023336}-{'f1_val': 0.13984006561410703, 'auprc': 0.9434279167919235, 'loss_val': 1.3459939970015027, 'psi': 0.46127520608523365}
[S4] START round=1 head_norm_before_train=1.192337 (no previous merge yet)
[S4] round=1 local utility u=0.104816 metrics={'f1_val': 0.14897275853197883, 'auprc': 0.6002623839189422, 'loss_val': 1.3155246805703456, 'psi': 0.32948860868676416}-{'f1_val': 0.14022662889518414, 'auprc': 0.5571051591344709, 'loss_val': 1.3432077703267258, 'psi': 0.30697804099089887}
[S5] START round=1 head_norm_before_train=1.176170 (no previous merge yet)
[S5] round=1 local utility u=0.137439 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.733715972487473, 'loss_val': 1.273869627059992, 'psi': 0.37884353185213204}-{'f1_val': 0.14226190476190476, 'auprc': 0.6634159976874328, 'loss_val': 1.3378484759032274, 'psi': 0.35072354193211597}
[S6] START round=1 head_norm_before_train=1.172166 (no previous merge yet)
[S6] round=1 local utility u=0.021737 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6615322021762257, 'loss_val': 1.3076967803628292, 'psi': 0.3494686501012595}-{'f1_val': 0.14142628205128205, 'auprc': 0.6586081572278374, 'loss_val': 1.3423976538534366, 'psi': 0.34829903212190416}
[S7] START round=1 head_norm_before_train=1.202565 (no previous merge yet)
[S7] round=1 local utility u=0.064779 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6113469859283478, 'loss_val': 1.2691439702755756, 'psi': 0.3297728880087941}-{'f1_val': 0.14205682272909165, 'auprc': 0.5864486054972251, 'loss_val': 1.324007695164965, 'psi': 0.31981353583634503}
[S8] START round=1 head_norm_before_train=1.146260 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.24593373456651346, 'auprc': 0.7825338727471942, 'loss_val': 1.3088853861960505, 'psi': 0.4605737898387857}-{'f1_val': 0.4224904288344162, 'auprc': 0.7424262737332367, 'loss_val': 1.3431196311831395, 'psi': 0.5504647667939444}
[S9] START round=1 head_norm_before_train=1.158906 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8149053086789033, 'loss_val': 1.2171440412440988, 'psi': 0.41080089775555895}-{'f1_val': 0.4014082105837425, 'auprc': 0.7954722583165789, 'loss_val': 1.3224952407527688, 'psi': 0.5590338296768771}
[S10] START round=1 head_norm_before_train=1.168791 (no previous merge yet)
[S10] round=1 local utility u=0.603620 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.47973044700789264, 'loss_val': 1.3463038470167517, 'psi': 0.2750651613281914}-{'f1_val': 0.0, 'auprc': 0.3636082402138323, 'loss_val': 1.3734475383522449, 'psi': 0.14544329608553294}
[S11] START round=1 head_norm_before_train=1.155563 (no previous merge yet)
[S11] round=1 local utility u=0.062058 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8593246947634526, 'loss_val': 1.322156786026872, 'psi': 0.4279780879292474}-{'f1_val': 0.14041368337311058, 'auprc': 0.8284128174835169, 'loss_val': 1.3535381369312023, 'psi': 0.41561333701727315}
[S13] START round=1 head_norm_before_train=1.182372 (no previous merge yet)
[S13] round=1 local utility u=0.126326 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6040126890866943, 'loss_val': 1.3251512596412314, 'psi': 0.32583653318090955}-{'f1_val': 0.1403857625770531, 'auprc': 0.5289500641685678, 'loss_val': 1.35261454660732, 'psi': 0.295811483213659}
[S14] START round=1 head_norm_before_train=1.151220 (no previous merge yet)
[S14] round=1 local utility u=1.000000 metrics={'f1_val': 0.42250899536887043, 'auprc': 0.8484487033658548, 'loss_val': 1.3237312226636972, 'psi': 0.5928848785676641}-{'f1_val': 0.1038107752956636, 'auprc': 0.8138922792847508, 'loss_val': 1.3515964298152463, 'psi': 0.3878433768912985}
[S15] START round=1 head_norm_before_train=1.178633 (no previous merge yet)
[S15] round=1 local utility u=0.766266 metrics={'f1_val': 0.30796603743780115, 'auprc': 0.7617275981332443, 'loss_val': 1.344518866799159, 'psi': 0.4894706617159784}-{'f1_val': 0.054777695897813804, 'auprc': 0.7687859441288906, 'loss_val': 1.379095627992435, 'psi': 0.34038099519024456}
[S16] START round=1 head_norm_before_train=1.108055 (no previous merge yet)
[S16] round=1 local utility u=0.023723 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9953993457604318, 'loss_val': 1.29069150949457, 'psi': 0.48254220842369466}-{'f1_val': 0.14063745019920318, 'auprc': 0.9916499838597063, 'loss_val': 1.3268886786363752, 'psi': 0.4810424636634044}
[S17] START round=1 head_norm_before_train=1.218257 (no previous merge yet)
[S17] round=1 local utility u=0.955862 metrics={'f1_val': 0.39132285320344584, 'auprc': 0.6613770110315742, 'loss_val': 1.3483094375519036, 'psi': 0.4993445163346972}-{'f1_val': 0.09718183851487364, 'auprc': 0.6208454338308521, 'loss_val': 1.3735919282389972, 'psi': 0.306647276641265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S6] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:50302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1782 reason=None
[S2] → sending delta(kind=head bytes=1782) to S3@127.0.0.1:50303
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:50315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] → sending delta(kind=head bytes=1788) to S2@127.0.0.1:50302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:50302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:50302
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:50305
[S5] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1782 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1788 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1789 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1795) from S15
[S2] cosine check vs S15: cos=0.0820
[S2] RECEIVED delta(kind=head bytes=1788) from S13
[S2] cosine check vs S13: cos=-0.0519
[S2] DROPPED delta from S13 (cos=-0.0519 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S14
[S10] cosine check vs S14: cos=-0.0129
[S10] DROPPED delta from S14 (cos=-0.0129 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S5
[S8] cosine check vs S5: cos=0.1505
[S2] RECEIVED delta(kind=head bytes=1789) from S6
[S2] cosine check vs S6: cos=0.0404
[S6] RECEIVED delta(kind=head bytes=1790) from S11
[S6] cosine check vs S11: cos=-0.0122
[S6] DROPPED delta from S11 (cos=-0.0122 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1792) from S16
[S15] cosine check vs S16: cos=-0.1786
[S15] DROPPED delta from S16 (cos=-0.1786 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1791) from S10
[S5] cosine check vs S10: cos=-0.0742
[S5] DROPPED delta from S10 (cos=-0.0742 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1782) from S2
[S3] cosine check vs S2: cos=0.0389
[S5] RECEIVED delta(kind=head bytes=1793) from S3
[S5] cosine check vs S3: cos=-0.0037
[S5] DROPPED delta from S3 (cos=-0.0037 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1793) from S4
[S13] cosine check vs S4: cos=0.1641
[S2] RECEIVED delta(kind=head bytes=1796) from S7
[S2] cosine check vs S7: cos=0.0055
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] → sending delta(kind=head bytes=1789) to S13@127.0.0.1:50313
[S17] sending update (kind=head size=1789 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1789) from S17
[S13] cosine check vs S17: cos=-0.0654
[S13] DROPPED delta from S17 (cos=-0.0654 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.2459 head_norm=1.162504
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.711965e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.3914 head_norm=0.897385 delta_norm=0.771197
[S8] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.179105
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.671122e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.709930 delta_norm=0.667112
[S2] aggregate: ACCEPT kept=['S15', 'S6', 'S7'] (k=3/3) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.1404 head_norm=1.192274
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.767146e-01
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.916559 delta_norm=0.776715
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=1 metric=0.1398 head_norm=1.235783
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.372828e-01
[S3] stored merged vector for next round verification (round=1)
[S3] DEBUG after merge:  round=1 metric=0.1398 head_norm=0.870449 delta_norm=0.837283
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.709930 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.108083 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7120672523243795, 'loss_val': 1.3190699988883943, 'psi': 0.36989318096289187}-{'f1_val': 0.1417771333885667, 'auprc': 0.6455944458706175, 'loss_val': 1.3358175367701697, 'psi': 0.34330405838138706}
[S3] START round=2 head_norm_before_train=0.870449 cos_to_last_merge=1.0000 (last merge round=1)
[S3] round=2 local utility u=0.010349 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9249683335556291, 'loss_val': 1.2403117994780217, 'psi': 0.4538913727907159}-{'f1_val': 0.13984006561410703, 'auprc': 0.9291343080846733, 'loss_val': 1.273508432545335, 'psi': 0.4555577626023336}
[S4] START round=2 head_norm_before_train=1.210460 (no previous merge yet)
[S4] round=2 local utility u=0.835302 metrics={'f1_val': 0.41151162790697676, 'auprc': 0.6211444281682895, 'loss_val': 1.2827991423779184, 'psi': 0.4953647480115019}-{'f1_val': 0.14897275853197883, 'auprc': 0.6002623839189422, 'loss_val': 1.3155246805703456, 'psi': 0.32948860868676416}
[S5] START round=2 head_norm_before_train=1.203607 (no previous merge yet)
[S5] round=2 local utility u=0.021671 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7287214707822925, 'loss_val': 1.215545093607359, 'psi': 0.37684573117005987}-{'f1_val': 0.14226190476190476, 'auprc': 0.733715972487473, 'loss_val': 1.273869627059992, 'psi': 0.37884353185213204}
[S6] START round=2 head_norm_before_train=1.186639 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6465292261500839, 'loss_val': 1.268488233023439, 'psi': 0.3434674596908028}-{'f1_val': 0.14142628205128205, 'auprc': 0.6615322021762257, 'loss_val': 1.3076967803628292, 'psi': 0.3494686501012595}
[S7] START round=2 head_norm_before_train=1.245276 (no previous merge yet)
[S7] round=2 local utility u=0.264730 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7748287051323282, 'loss_val': 1.2301292272027646, 'psi': 0.3951655756903863}-{'f1_val': 0.14205682272909165, 'auprc': 0.6113469859283478, 'loss_val': 1.2691439702755756, 'psi': 0.3297728880087941}
[S8] START round=2 head_norm_before_train=0.897385 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.663181 metrics={'f1_val': 0.465983828556829, 'auprc': 0.782831976100853, 'loss_val': 1.30371838235647, 'psi': 0.5927230875744386}-{'f1_val': 0.24593373456651346, 'auprc': 0.7825338727471942, 'loss_val': 1.3088853861960505, 'psi': 0.4605737898387857}
[S9] START round=2 head_norm_before_train=1.203418 (no previous merge yet)
[S9] round=2 local utility u=0.056713 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8051301519183325, 'loss_val': 1.074392245619215, 'psi': 0.4068908350513306}-{'f1_val': 0.141397957139996, 'auprc': 0.8149053086789033, 'loss_val': 1.2171440412440988, 'psi': 0.41080089775555895}
[S10] START round=2 head_norm_before_train=1.179181 (no previous merge yet)
[S10] round=2 local utility u=0.107672 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5424776423127887, 'loss_val': 1.3192014861917605, 'psi': 0.30016403945014986}-{'f1_val': 0.13862163754172394, 'auprc': 0.47973044700789264, 'loss_val': 1.3463038470167517, 'psi': 0.2750651613281914}
[S11] START round=2 head_norm_before_train=1.172371 (no previous merge yet)
[S11] round=2 local utility u=0.010930 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8541182020653125, 'loss_val': 1.284677040979908, 'psi': 0.4258954908499914}-{'f1_val': 0.14041368337311058, 'auprc': 0.8593246947634526, 'loss_val': 1.322156786026872, 'psi': 0.4279780879292474}
[S13] START round=2 head_norm_before_train=0.916559 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.021544 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.618018372951949, 'loss_val': 1.3240804823384567, 'psi': 0.3314388067270114}-{'f1_val': 0.1403857625770531, 'auprc': 0.6040126890866943, 'loss_val': 1.3251512596412314, 'psi': 0.32583653318090955}
[S14] START round=2 head_norm_before_train=1.171070 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8739126287695859, 'loss_val': 1.2922396558149898, 'psi': 0.4337797632374566}-{'f1_val': 0.42250899536887043, 'auprc': 0.8484487033658548, 'loss_val': 1.3237312226636972, 'psi': 0.5928848785676641}
[S15] START round=2 head_norm_before_train=1.187264 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7707053266695355, 'loss_val': 1.302672639508527, 'psi': 0.39212232148474924}-{'f1_val': 0.30796603743780115, 'auprc': 0.7617275981332443, 'loss_val': 1.344518866799159, 'psi': 0.4894706617159784}
[S16] START round=2 head_norm_before_train=1.132201 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8634236489943263, 'loss_val': 1.2483102910926833, 'psi': 0.4297519297172525}-{'f1_val': 0.14063745019920318, 'auprc': 0.9953993457604318, 'loss_val': 1.29069150949457, 'psi': 0.48254220842369466}
[S17] START round=2 head_norm_before_train=1.231598 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.29919824947405027, 'auprc': 0.6700537720254508, 'loss_val': 1.3158108785268539, 'psi': 0.4475404584946105}-{'f1_val': 0.39132285320344584, 'auprc': 0.6613770110315742, 'loss_val': 1.3483094375519036, 'psi': 0.4993445163346972}
[S7] not sending this round → trigger blocked (psi=0.395)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.300)
[S3] not sending this round → trigger blocked (psi=0.454)
[S5] not sending this round → trigger blocked (psi=0.377)
[S11] not sending this round → trigger blocked (psi=0.426)
[S13] not sending this round → trigger blocked (psi=0.331)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:50305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:50314
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.495)
[S2] not sending this round → trigger blocked (psi=0.370)
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] cosine check vs S8: cos=0.7578
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=-0.0482
[S14] DROPPED delta from S9 (cos=-0.0482 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=2 metric=0.1423 head_norm=1.237815
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.039122e-01
[S5] stored merged vector for next round verification (round=2)
[S5] DEBUG after merge:  round=2 metric=0.1423 head_norm=1.013256 delta_norm=0.403912
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.732577 cos_to_last_merge=0.9950 (last merge round=1)
[S2] round=3 local utility u=0.017525 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7050615691641297, 'loss_val': 1.2630037035173265, 'psi': 0.36709090769879194}-{'f1_val': 0.1417771333885667, 'auprc': 0.7120672523243795, 'loss_val': 1.3190699988883943, 'psi': 0.36989318096289187}
[S3] START round=3 head_norm_before_train=0.926864 cos_to_last_merge=0.9930 (last merge round=1)
[S3] round=3 local utility u=0.928772 metrics={'f1_val': 0.4226526521515814, 'auprc': 0.9372466544034314, 'loss_val': 1.1164774929440258, 'psi': 0.6284902530523213}-{'f1_val': 0.13984006561410703, 'auprc': 0.9249683335556291, 'loss_val': 1.2403117994780217, 'psi': 0.4538913727907159}
[S4] START round=3 head_norm_before_train=1.233444 (no previous merge yet)
[S4] round=3 local utility u=0.143313 metrics={'f1_val': 0.4148894379909772, 'auprc': 0.6920991024899075, 'loss_val': 1.229303373460358, 'psi': 0.5257733037905493}-{'f1_val': 0.41151162790697676, 'auprc': 0.6211444281682895, 'loss_val': 1.2827991423779184, 'psi': 0.4953647480115019}
[S5] START round=3 head_norm_before_train=1.013256 cos_to_last_merge=1.0000 (last merge round=2)
[S5] round=3 local utility u=0.171448 metrics={'f1_val': 0.1703440801421625, 'auprc': 0.7596146337674609, 'loss_val': 1.1338218458336748, 'psi': 0.40605230159228184}-{'f1_val': 0.14226190476190476, 'auprc': 0.7287214707822925, 'loss_val': 1.215545093607359, 'psi': 0.37684573117005987}
[S6] START round=3 head_norm_before_train=1.210378 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6147616157506864, 'loss_val': 1.2301564284142565, 'psi': 0.3307604155310438}-{'f1_val': 0.14142628205128205, 'auprc': 0.6465292261500839, 'loss_val': 1.268488233023439, 'psi': 0.3434674596908028}
[S7] START round=3 head_norm_before_train=1.284730 (no previous merge yet)
[S7] round=3 local utility u=0.519093 metrics={'f1_val': 0.395727656552918, 'auprc': 0.5911774725801745, 'loss_val': 1.1630144981900332, 'psi': 0.4739075829638206}-{'f1_val': 0.14205682272909165, 'auprc': 0.7748287051323282, 'loss_val': 1.2301292272027646, 'psi': 0.3951655756903863}
[S8] START round=3 head_norm_before_train=0.920586 cos_to_last_merge=0.9972 (last merge round=1)
[S8] round=3 local utility u=0.035660 metrics={'f1_val': 0.4701738317030317, 'auprc': 0.7827449528690847, 'loss_val': 1.2572771392304924, 'psi': 0.595202280169453}-{'f1_val': 0.465983828556829, 'auprc': 0.782831976100853, 'loss_val': 1.30371838235647, 'psi': 0.5927230875744386}
[S9] START round=3 head_norm_before_train=1.262615 (no previous merge yet)
[S9] round=3 local utility u=0.968207 metrics={'f1_val': 0.3817889609771921, 'auprc': 0.8660666202395035, 'loss_val': 0.7631342224383297, 'psi': 0.5755000246821167}-{'f1_val': 0.141397957139996, 'auprc': 0.8051301519183325, 'loss_val': 1.074392245619215, 'psi': 0.4068908350513306}
[S10] START round=3 head_norm_before_train=1.197790 (no previous merge yet)
[S10] round=3 local utility u=0.072620 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.580063233965952, 'loss_val': 1.286719021593574, 'psi': 0.31519827611141515}-{'f1_val': 0.13862163754172394, 'auprc': 0.5424776423127887, 'loss_val': 1.3192014861917605, 'psi': 0.30016403945014986}
[S11] START round=3 head_norm_before_train=1.197422 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7842961035530946, 'loss_val': 1.2300324128850528, 'psi': 0.39796665144510424}-{'f1_val': 0.14041368337311058, 'auprc': 0.8541182020653125, 'loss_val': 1.284677040979908, 'psi': 0.4258954908499914}
[S13] START round=3 head_norm_before_train=0.932542 cos_to_last_merge=0.9979 (last merge round=1)
[S13] round=3 local utility u=0.096181 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6715632688912374, 'loss_val': 1.2923530781839943, 'psi': 0.35285676510272684}-{'f1_val': 0.1403857625770531, 'auprc': 0.618018372951949, 'loss_val': 1.3240804823384567, 'psi': 0.3314388067270114}
[S14] START round=3 head_norm_before_train=1.198102 (no previous merge yet)
[S14] round=3 local utility u=0.019683 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8742011891578381, 'loss_val': 1.253740242980551, 'psi': 0.4338951873927575}-{'f1_val': 0.14035785288270378, 'auprc': 0.8739126287695859, 'loss_val': 1.2922396558149898, 'psi': 0.4337797632374566}
[S15] START round=3 head_norm_before_train=1.205520 (no previous merge yet)
[S15] round=3 local utility u=0.024475 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7699523842087667, 'loss_val': 1.2514632658669875, 'psi': 0.3918211445004417}-{'f1_val': 0.13973365136155833, 'auprc': 0.7707053266695355, 'loss_val': 1.302672639508527, 'psi': 0.39212232148474924}
[S16] START round=3 head_norm_before_train=1.160180 (no previous merge yet)
[S16] round=3 local utility u=0.011209 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8516115112644934, 'loss_val': 1.1904553071985085, 'psi': 0.4250270746253193}-{'f1_val': 0.14063745019920318, 'auprc': 0.8634236489943263, 'loss_val': 1.2483102910926833, 'psi': 0.4297519297172525}
[S17] START round=3 head_norm_before_train=1.254147 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6713998111313189, 'loss_val': 1.266265438627637, 'psi': 0.3531293024429582}-{'f1_val': 0.29919824947405027, 'auprc': 0.6700537720254508, 'loss_val': 1.3158108785268539, 'psi': 0.4475404584946105}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:50313
[S9] not sending this round → trigger blocked (psi=0.576)
[S8] not sending this round → trigger blocked (psi=0.595)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:50308
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:50304
[S15] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=0.0609
[S8] RECEIVED delta(kind=head bytes=1796) from S4
[S8] cosine check vs S4: cos=-0.0561
[S8] DROPPED delta from S4 (cos=-0.0561 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S16
[S4] cosine check vs S16: cos=0.0423
[S16] RECEIVED delta(kind=head bytes=1792) from S13
[S16] cosine check vs S13: cos=-0.0429
[S16] DROPPED delta from S13 (cos=-0.0429 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S3
[S6] cosine check vs S3: cos=0.0107
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] cosine check vs S2: cos=0.1271
[S7] RECEIVED delta(kind=head bytes=1794) from S15
[S7] cosine check vs S15: cos=0.0651
[S3] RECEIVED delta(kind=head bytes=1791) from S5
[S3] cosine check vs S5: cos=0.0685
[S7] RECEIVED delta(kind=head bytes=1795) from S10
[S7] cosine check vs S10: cos=-0.0728
[S7] DROPPED delta from S10 (cos=-0.0728 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1791) from S14
[S13] cosine check vs S14: cos=0.0018
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=1.240420
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.875351e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.795766 delta_norm=0.787535
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.4702 head_norm=0.952182
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.850998e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.4214 head_norm=0.831990 delta_norm=0.785100
[S8] aggregate: ROLLBACK (f1_val pre=0.470 post=0.421 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.4149 head_norm=1.270530
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.521077e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.4148 head_norm=0.888853 delta_norm=0.852108
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.4227 head_norm=0.984006
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.935994e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.742731 delta_norm=0.693599
[S3] aggregate: ROLLBACK (f1_val pre=0.423 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1703 head_norm=1.047469
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.085787e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.3876 head_norm=0.687360 delta_norm=0.608579
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.3957 head_norm=1.307871
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.684835e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.926913 delta_norm=0.868483
[S7] aggregate: ROLLBACK (f1_val pre=0.396 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.1404 head_norm=0.957480
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.792588e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.780606 delta_norm=0.779259
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.767120 cos_to_last_merge=0.9815 (last merge round=1)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6061300089443933, 'loss_val': 1.2335758222922981, 'psi': 0.32751828361089735}-{'f1_val': 0.1417771333885667, 'auprc': 0.7050615691641297, 'loss_val': 1.2630037035173265, 'psi': 0.36709090769879194}
[S3] START round=4 head_norm_before_train=0.742731 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.39645225981545407, 'auprc': 0.8423190384758675, 'loss_val': 0.9775051302867451, 'psi': 0.5747989712796195}-{'f1_val': 0.4226526521515814, 'auprc': 0.9372466544034314, 'loss_val': 1.1164774929440258, 'psi': 0.6284902530523213}
[S4] START round=4 head_norm_before_train=0.888853 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.055159 metrics={'f1_val': 0.4154217366275759, 'auprc': 0.723961477258015, 'loss_val': 1.2177663785944104, 'psi': 0.5388376328797515}-{'f1_val': 0.4148894379909772, 'auprc': 0.6920991024899075, 'loss_val': 1.229303373460358, 'psi': 0.5257733037905493}
[S5] START round=4 head_norm_before_train=0.687360 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.811826 metrics={'f1_val': 0.41762898496828804, 'auprc': 0.7712295197656872, 'loss_val': 1.0287230574542312, 'psi': 0.5590691988872477}-{'f1_val': 0.1703440801421625, 'auprc': 0.7596146337674609, 'loss_val': 1.1338218458336748, 'psi': 0.40605230159228184}
[S6] START round=4 head_norm_before_train=0.795766 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.597116467544804, 'loss_val': 1.2527994152123274, 'psi': 0.3237023562486908}-{'f1_val': 0.14142628205128205, 'auprc': 0.6147616157506864, 'loss_val': 1.2301564284142565, 'psi': 0.3307604155310438}
[S7] START round=4 head_norm_before_train=0.926913 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.067134 metrics={'f1_val': 0.41606030461571797, 'auprc': 0.5751274747343011, 'loss_val': 1.1025933049867238, 'psi': 0.47968717266315125}-{'f1_val': 0.395727656552918, 'auprc': 0.5911774725801745, 'loss_val': 1.1630144981900332, 'psi': 0.4739075829638206}
[S8] START round=4 head_norm_before_train=0.831990 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.42257860386146096, 'auprc': 0.7828806422463238, 'loss_val': 1.2536471430250802, 'psi': 0.5666994192154061}-{'f1_val': 0.4701738317030317, 'auprc': 0.7827449528690847, 'loss_val': 1.2572771392304924, 'psi': 0.595202280169453}
[S9] START round=4 head_norm_before_train=1.325956 (no previous merge yet)
[S9] round=4 local utility u=0.935068 metrics={'f1_val': 0.6116014435826839, 'auprc': 0.96577282016615, 'loss_val': 0.5709922310169759, 'psi': 0.7532699942160703}-{'f1_val': 0.3817889609771921, 'auprc': 0.8660666202395035, 'loss_val': 0.7631342224383297, 'psi': 0.5755000246821167}
[S10] START round=4 head_norm_before_train=1.223242 (no previous merge yet)
[S10] round=4 local utility u=0.034925 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5905882537665225, 'loss_val': 1.2484440777813608, 'psi': 0.31940828403164334}-{'f1_val': 0.13862163754172394, 'auprc': 0.580063233965952, 'loss_val': 1.286719021593574, 'psi': 0.31519827611141515}
[S11] START round=4 head_norm_before_train=1.228313 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6962163571180919, 'loss_val': 1.1553680002524105, 'psi': 0.3627347528711031}-{'f1_val': 0.14041368337311058, 'auprc': 0.7842961035530946, 'loss_val': 1.2300324128850528, 'psi': 0.39796665144510424}
[S13] START round=4 head_norm_before_train=0.780606 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5630596612624827, 'loss_val': 1.3056220737383482, 'psi': 0.30945532205122495}-{'f1_val': 0.1403857625770531, 'auprc': 0.6715632688912374, 'loss_val': 1.2923530781839943, 'psi': 0.35285676510272684}
[S14] START round=4 head_norm_before_train=1.231426 (no previous merge yet)
[S14] round=4 local utility u=0.026511 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8744638920535247, 'loss_val': 1.2015054850141307, 'psi': 0.43400026855103213}-{'f1_val': 0.14035785288270378, 'auprc': 0.8742011891578381, 'loss_val': 1.253740242980551, 'psi': 0.4338951873927575}
[S15] START round=4 head_norm_before_train=1.231396 (no previous merge yet)
[S15] round=4 local utility u=0.033857 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7742374718461288, 'loss_val': 1.19660449108856, 'psi': 0.3935351795553865}-{'f1_val': 0.13973365136155833, 'auprc': 0.7699523842087667, 'loss_val': 1.2514632658669875, 'psi': 0.3918211445004417}
[S16] START round=4 head_norm_before_train=1.190819 (no previous merge yet)
[S16] round=4 local utility u=0.130986 metrics={'f1_val': 0.27348423153645807, 'auprc': 0.6440070649364871, 'loss_val': 1.102751575699385, 'psi': 0.4216933648964697}-{'f1_val': 0.14063745019920318, 'auprc': 0.8516115112644934, 'loss_val': 1.1904553071985085, 'psi': 0.4250270746253193}
[S17] START round=4 head_norm_before_train=1.284629 (no previous merge yet)
[S17] round=4 local utility u=0.045011 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6723592854864204, 'loss_val': 1.1791213414410957, 'psi': 0.3535130921849988}-{'f1_val': 0.14094896331738438, 'auprc': 0.6713998111313189, 'loss_val': 1.266265438627637, 'psi': 0.3531293024429582}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:50303
[S14] not sending this round → trigger blocked (psi=0.434)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.319)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.422)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.480)
[S4] not sending this round → trigger blocked (psi=0.539)
[S5] not sending this round → trigger blocked (psi=0.559)
[S15] not sending this round → trigger blocked (psi=0.394)
[S9] sending update (kind=head size=1807 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1807) from S9
[S3] cosine check vs S9: cos=0.0014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1792 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1792) from S17
[S14] cosine check vs S17: cos=-0.0316
[S14] DROPPED delta from S17 (cos=-0.0316 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.3965 head_norm=0.796827
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.039894e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.7008 head_norm=0.804978 delta_norm=0.803989
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.790883 cos_to_last_merge=0.9708 (last merge round=1)
[S2] round=5 local utility u=0.222830 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7384537683583422, 'loss_val': 1.184886496386409, 'psi': 0.38044778737647694}-{'f1_val': 0.1417771333885667, 'auprc': 0.6061300089443933, 'loss_val': 1.2335758222922981, 'psi': 0.32751828361089735}
[S3] START round=5 head_norm_before_train=0.804978 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.776606 metrics={'f1_val': 0.615840179746314, 'auprc': 0.8682226679312549, 'loss_val': 0.8183314010291751, 'psi': 0.7167931750202903}-{'f1_val': 0.39645225981545407, 'auprc': 0.8423190384758675, 'loss_val': 0.9775051302867451, 'psi': 0.5747989712796195}
[S4] START round=5 head_norm_before_train=0.923954 cos_to_last_merge=0.9974 (last merge round=3)
[S4] round=5 local utility u=0.099904 metrics={'f1_val': 0.4145993087620933, 'auprc': 0.7496623971628963, 'loss_val': 1.090125926088076, 'psi': 0.5486245441224145}-{'f1_val': 0.4154217366275759, 'auprc': 0.723961477258015, 'loss_val': 1.2177663785944104, 'psi': 0.5388376328797515}
[S5] START round=5 head_norm_before_train=0.754320 cos_to_last_merge=0.9895 (last merge round=3)
[S5] round=5 local utility u=0.058641 metrics={'f1_val': 0.4175465518408786, 'auprc': 0.7563269190591445, 'loss_val': 0.8662382534896538, 'psi': 0.5530586987281849}-{'f1_val': 0.41762898496828804, 'auprc': 0.7712295197656872, 'loss_val': 1.0287230574542312, 'psi': 0.5590691988872477}
[S6] START round=5 head_norm_before_train=0.823171 cos_to_last_merge=0.9969 (last merge round=3)
[S6] round=5 local utility u=0.035649 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6099833376674607, 'loss_val': 1.220102627966591, 'psi': 0.3288491042977535}-{'f1_val': 0.14142628205128205, 'auprc': 0.597116467544804, 'loss_val': 1.2527994152123274, 'psi': 0.3237023562486908}
[S7] START round=5 head_norm_before_train=0.968442 cos_to_last_merge=0.9955 (last merge round=3)
[S7] round=5 local utility u=0.084456 metrics={'f1_val': 0.41711588266717814, 'auprc': 0.5767923733530854, 'loss_val': 0.9450098919926151, 'psi': 0.480986478941541}-{'f1_val': 0.41606030461571797, 'auprc': 0.5751274747343011, 'loss_val': 1.1025933049867238, 'psi': 0.47968717266315125}
[S8] START round=5 head_norm_before_train=0.859778 cos_to_last_merge=0.9961 (last merge round=3)
[S8] round=5 local utility u=0.075394 metrics={'f1_val': 0.440259775135895, 'auprc': 0.7659778500917802, 'loss_val': 1.1582386428179603, 'psi': 0.5705470051182491}-{'f1_val': 0.42257860386146096, 'auprc': 0.7828806422463238, 'loss_val': 1.2536471430250802, 'psi': 0.5666994192154061}
[S9] START round=5 head_norm_before_train=1.397799 (no previous merge yet)
[S9] round=5 local utility u=0.417907 metrics={'f1_val': 0.7012182915391405, 'auprc': 0.9985515831569695, 'loss_val': 0.3712155338090997, 'psi': 0.8201516081862721}-{'f1_val': 0.6116014435826839, 'auprc': 0.96577282016615, 'loss_val': 0.5709922310169759, 'psi': 0.7532699942160703}
[S10] START round=5 head_norm_before_train=1.248936 (no previous merge yet)
[S10] round=5 local utility u=0.044196 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6026573645561553, 'loss_val': 1.196259222532301, 'psi': 0.3242359283474965}-{'f1_val': 0.13862163754172394, 'auprc': 0.5905882537665225, 'loss_val': 1.2484440777813608, 'psi': 0.31940828403164334}
[S11] START round=5 head_norm_before_train=1.262707 (no previous merge yet)
[S11] round=5 local utility u=1.000000 metrics={'f1_val': 0.41885958740975004, 'auprc': 0.959400751544301, 'loss_val': 1.0207591275530288, 'psi': 0.6350760530635704}-{'f1_val': 0.14041368337311058, 'auprc': 0.6962163571180919, 'loss_val': 1.1553680002524105, 'psi': 0.3627347528711031}
[S13] START round=5 head_norm_before_train=0.804056 cos_to_last_merge=0.9964 (last merge round=3)
[S13] round=5 local utility u=0.132431 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6339189544624716, 'loss_val': 1.253338570575114, 'psi': 0.3377990393312205}-{'f1_val': 0.1403857625770531, 'auprc': 0.5630596612624827, 'loss_val': 1.3056220737383482, 'psi': 0.30945532205122495}
[S14] START round=5 head_norm_before_train=1.272309 (no previous merge yet)
[S14] round=5 local utility u=0.952253 metrics={'f1_val': 0.4110890784033079, 'auprc': 0.938200975729678, 'loss_val': 1.1125981400054834, 'psi': 0.6219338373338559}-{'f1_val': 0.14035785288270378, 'auprc': 0.8744638920535247, 'loss_val': 1.2015054850141307, 'psi': 0.43400026855103213}
[S15] START round=5 head_norm_before_train=1.261414 (no previous merge yet)
[S15] round=5 local utility u=0.578629 metrics={'f1_val': 0.31812347608655084, 'auprc': 0.7770166863395892, 'loss_val': 1.1180221424720644, 'psi': 0.5016807601877662}-{'f1_val': 0.13973365136155833, 'auprc': 0.7742374718461288, 'loss_val': 1.19660449108856, 'psi': 0.3935351795553865}
[S16] START round=5 head_norm_before_train=1.220894 (no previous merge yet)
[S16] round=5 local utility u=0.412898 metrics={'f1_val': 0.41727255530994717, 'auprc': 0.5884590262622157, 'loss_val': 0.9730416542320808, 'psi': 0.4857471436908546}-{'f1_val': 0.27348423153645807, 'auprc': 0.6440070649364871, 'loss_val': 1.102751575699385, 'psi': 0.4216933648964697}
[S17] START round=5 head_norm_before_train=1.320680 (no previous merge yet)
[S17] round=5 local utility u=0.800196 metrics={'f1_val': 0.39568488713617067, 'auprc': 0.6485655651349155, 'loss_val': 1.0357645737512664, 'psi': 0.4968371583356686}-{'f1_val': 0.14094896331738438, 'auprc': 0.6723592854864204, 'loss_val': 1.1791213414410957, 'psi': 0.3535130921849988}
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S8] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:50304
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1788 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1793) from S3
[S6] cosine check vs S3: cos=0.1858
[S16] RECEIVED delta(kind=head bytes=1791) from S13
[S16] cosine check vs S13: cos=-0.1095
[S16] DROPPED delta from S13 (cos=-0.1095 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1788) from S8
[S16] cosine check vs S8: cos=0.0893
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=0.6384
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] cosine check vs S10: cos=-0.0222
[S7] DROPPED delta from S10 (cos=-0.0222 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1793) from S6
[S7] cosine check vs S6: cos=0.0399
[S3] RECEIVED delta(kind=head bytes=1789) from S5
[S3] cosine check vs S5: cos=0.3664
[S5] RECEIVED delta(kind=head bytes=1798) from S2
[S5] cosine check vs S2: cos=0.5519
[S10] RECEIVED delta(kind=head bytes=1794) from S11
[S10] cosine check vs S11: cos=-0.0381
[S10] DROPPED delta from S11 (cos=-0.0381 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S7
[S8] cosine check vs S7: cos=0.6162
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] cosine check vs S16: cos=0.6439
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=0.0301
[S13] RECEIVED delta(kind=head bytes=1796) from S14
[S13] cosine check vs S14: cos=0.7330
[S17] not sending this round → trigger blocked (psi=0.497)
[S9] ⇄ pheromone p=0.691 → S3@127.0.0.1:50303
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.4146 head_norm=0.970602
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.858944e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.4156 head_norm=1.009114 delta_norm=0.485894
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.469 → S8@127.0.0.1:50309
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.4173 head_norm=1.251695
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.367588e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.4174 head_norm=0.801912 delta_norm=0.736759
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.435 → S4@127.0.0.1:50304
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.1404 head_norm=0.836096
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.498037e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.1404 head_norm=1.002538 delta_norm=0.449804
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.379 → S16@127.0.0.1:50316
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.6158 head_norm=0.872892
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.814394e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.6782 head_norm=0.706729 delta_norm=0.481439
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.604 → S6@127.0.0.1:50307
[S15] ⇄ pheromone p=0.515 → S7@127.0.0.1:50308
[S11] ⇄ pheromone p=0.534 → S10@127.0.0.1:50311
[S2] ⇄ pheromone p=0.429 → S5@127.0.0.1:50305
[S10] ⇄ pheromone p=0.412 → S7@127.0.0.1:50308
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.853324
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.507366e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.664636 delta_norm=0.550737
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.337 → S7@127.0.0.1:50308
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.4403 head_norm=0.897225
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.182914e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.3914 head_norm=0.685818 delta_norm=0.418291
[S8] aggregate: ROLLBACK (f1_val pre=0.440 post=0.391 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.415 → S16@127.0.0.1:50316
[S14] ⇄ pheromone p=0.607 → S13@127.0.0.1:50313
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.4175 head_norm=0.836994
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.904322e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.4175 head_norm=0.726298 delta_norm=0.390432
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.505 → S3@127.0.0.1:50303
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.4171 head_norm=1.021131
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.377855e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.4170 head_norm=0.794360 delta_norm=0.437786
[S7] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.454 → S8@127.0.0.1:50309
[S17] ⇄ pheromone p=0.573 → S14@127.0.0.1:50314
[S2] START round=6 head_norm_before_train=0.811994 cos_to_last_merge=0.9607 (last merge round=1)
[S2] round=6 local utility u=0.115547 metrics={'f1_val': 0.1521791495973306, 'auprc': 0.7750841838654366, 'loss_val': 1.1260953792318544, 'psi': 0.40134116330457303}-{'f1_val': 0.1417771333885667, 'auprc': 0.7384537683583422, 'loss_val': 1.184886496386409, 'psi': 0.38044778737647694}
[S3] START round=6 head_norm_before_train=0.706729 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.338356 metrics={'f1_val': 0.6452197899136212, 'auprc': 0.9950124940620558, 'loss_val': 0.6982666173753291, 'psi': 0.7851368715729949}-{'f1_val': 0.615840179746314, 'auprc': 0.8682226679312549, 'loss_val': 0.8183314010291751, 'psi': 0.7167931750202903}
[S4] START round=6 head_norm_before_train=1.009114 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.098983 metrics={'f1_val': 0.415377677628442, 'auprc': 0.7831315306564607, 'loss_val': 0.9972381709655197, 'psi': 0.5624792188396495}-{'f1_val': 0.4145993087620933, 'auprc': 0.7496623971628963, 'loss_val': 1.090125926088076, 'psi': 0.5486245441224145}
[S5] START round=6 head_norm_before_train=0.726298 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.260793 metrics={'f1_val': 0.43709025581367167, 'auprc': 0.8686482179787766, 'loss_val': 0.7988781369528386, 'psi': 0.6097134406797136}-{'f1_val': 0.4175465518408786, 'auprc': 0.7563269190591445, 'loss_val': 0.8662382534896538, 'psi': 0.5530586987281849}
[S6] START round=6 head_norm_before_train=0.664636 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6114563534637568, 'loss_val': 1.231412885638394, 'psi': 0.32943831061627193}-{'f1_val': 0.14142628205128205, 'auprc': 0.6099833376674607, 'loss_val': 1.220102627966591, 'psi': 0.3288491042977535}
[S7] START round=6 head_norm_before_train=0.794360 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.030200 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.5885445202967876, 'loss_val': 0.9174321306004446, 'psi': 0.4854438789853291}-{'f1_val': 0.41711588266717814, 'auprc': 0.5767923733530854, 'loss_val': 0.9450098919926151, 'psi': 0.480986478941541}
[S8] START round=6 head_norm_before_train=0.685818 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.856023 metrics={'f1_val': 0.7141723980650027, 'auprc': 0.7732614476361713, 'loss_val': 1.1115194564320734, 'psi': 0.7378080178934702}-{'f1_val': 0.440259775135895, 'auprc': 0.7659778500917802, 'loss_val': 1.1582386428179603, 'psi': 0.5705470051182491}
[S9] START round=6 head_norm_before_train=1.473760 (no previous merge yet)
[S9] round=6 local utility u=0.053313 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982292345789957, 'loss_val': 0.26361193550522044, 'psi': 0.8200216422956095}-{'f1_val': 0.7012182915391405, 'auprc': 0.9985515831569695, 'loss_val': 0.3712155338090997, 'psi': 0.8201516081862721}
[S10] START round=6 head_norm_before_train=1.278257 (no previous merge yet)
[S10] round=6 local utility u=1.000000 metrics={'f1_val': 0.41597454042981274, 'auprc': 0.774329922030237, 'loss_val': 1.1114353629935616, 'psi': 0.5593166930699824}-{'f1_val': 0.13862163754172394, 'auprc': 0.6026573645561553, 'loss_val': 1.196259222532301, 'psi': 0.3242359283474965}
[S11] START round=6 head_norm_before_train=1.296530 (no previous merge yet)
[S11] round=6 local utility u=0.089202 metrics={'f1_val': 0.396484976660716, 'auprc': 0.9983597711430859, 'loss_val': 0.8249835653600325, 'psi': 0.637234894453664}-{'f1_val': 0.41885958740975004, 'auprc': 0.959400751544301, 'loss_val': 1.0207591275530288, 'psi': 0.6350760530635704}
[S13] START round=6 head_norm_before_train=1.002538 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.131728 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7152512552884506, 'loss_val': 1.2338800646761356, 'psi': 0.3703319596616121}-{'f1_val': 0.1403857625770531, 'auprc': 0.6339189544624716, 'loss_val': 1.253338570575114, 'psi': 0.3377990393312205}
[S14] START round=6 head_norm_before_train=1.309869 (no previous merge yet)
[S14] round=6 local utility u=0.064529 metrics={'f1_val': 0.3915416722537795, 'auprc': 0.9659312068120944, 'loss_val': 0.9494468919967365, 'psi': 0.6212974860771054}-{'f1_val': 0.4110890784033079, 'auprc': 0.938200975729678, 'loss_val': 1.1125981400054834, 'psi': 0.6219338373338559}
[S15] START round=6 head_norm_before_train=1.294537 (no previous merge yet)
[S15] round=6 local utility u=1.000000 metrics={'f1_val': 0.7154079827876261, 'auprc': 0.777054945767405, 'loss_val': 1.0004937304981931, 'psi': 0.7400667679795376}-{'f1_val': 0.31812347608655084, 'auprc': 0.7770166863395892, 'loss_val': 1.1180221424720644, 'psi': 0.5016807601877662}
[S16] START round=6 head_norm_before_train=0.801912 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.003776 metrics={'f1_val': 0.4168831021970758, 'auprc': 0.5796475469099847, 'loss_val': 0.9367188917033423, 'psi': 0.4819888800822394}-{'f1_val': 0.41727255530994717, 'auprc': 0.5884590262622157, 'loss_val': 0.9730416542320808, 'psi': 0.4857471436908546}
[S17] START round=6 head_norm_before_train=1.358463 (no previous merge yet)
[S17] round=6 local utility u=0.404267 metrics={'f1_val': 0.3911334018808198, 'auprc': 0.9007996083517371, 'loss_val': 0.9566233771836588, 'psi': 0.5949998844691867}-{'f1_val': 0.39568488713617067, 'auprc': 0.6485655651349155, 'loss_val': 1.0357645737512664, 'psi': 0.4968371583356686}
[S13] not sending this round → trigger blocked (psi=0.370)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.621)
[S15] not sending this round → trigger blocked (psi=0.740)
[S10] not sending this round → trigger blocked (psi=0.559)
[S3] not sending this round → trigger blocked (psi=0.785)
[S16] not sending this round → trigger blocked (psi=0.482)
[S5] not sending this round → trigger blocked (psi=0.610)
[S7] not sending this round → trigger blocked (psi=0.485)
[S2] not sending this round → trigger blocked (psi=0.401)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:50303
[S8] not sending this round → trigger blocked (psi=0.738)
[S11] not sending this round → trigger blocked (psi=0.637)
[S4] not sending this round → trigger blocked (psi=0.562)
[S9] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=0.4756
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S17
[S14] cosine check vs S17: cos=-0.0359
[S14] DROPPED delta from S17 (cos=-0.0359 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.6452 head_norm=0.792321
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.756978e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.6795 head_norm=1.017254 delta_norm=0.675698
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.835071 cos_to_last_merge=0.9502 (last merge round=1)
[S2] round=7 local utility u=0.807241 metrics={'f1_val': 0.4165165486077186, 'auprc': 0.7547724593191942, 'loss_val': 1.0367028255172759, 'psi': 0.5518189128923089}-{'f1_val': 0.1521791495973306, 'auprc': 0.7750841838654366, 'loss_val': 1.1260953792318544, 'psi': 0.40134116330457303}
[S3] START round=7 head_norm_before_train=1.017254 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.5481320926237119, 'auprc': 0.9990888687059156, 'loss_val': 0.6745476160940574, 'psi': 0.7285148030565933}-{'f1_val': 0.6452197899136212, 'auprc': 0.9950124940620558, 'loss_val': 0.6982666173753291, 'psi': 0.7851368715729949}
[S4] START round=7 head_norm_before_train=1.045229 cos_to_last_merge=0.9963 (last merge round=5)
[S4] round=7 local utility u=0.069172 metrics={'f1_val': 0.4142737879287599, 'auprc': 0.7824695105400868, 'loss_val': 0.8502842832054303, 'psi': 0.5615520769732907}-{'f1_val': 0.415377677628442, 'auprc': 0.7831315306564607, 'loss_val': 0.9972381709655197, 'psi': 0.5624792188396495}
[S5] START round=7 head_norm_before_train=0.789824 cos_to_last_merge=0.9861 (last merge round=5)
[S5] round=7 local utility u=0.000000 metrics={'f1_val': 0.41754551926731287, 'auprc': 0.8084691516925623, 'loss_val': 0.7334122401115672, 'psi': 0.5739149722374126}-{'f1_val': 0.43709025581367167, 'auprc': 0.8686482179787766, 'loss_val': 0.7988781369528386, 'psi': 0.6097134406797136}
[S6] START round=7 head_norm_before_train=0.688390 cos_to_last_merge=0.9944 (last merge round=5)
[S6] round=7 local utility u=0.287846 metrics={'f1_val': 0.16509847798894206, 'auprc': 0.7206957800894538, 'loss_val': 1.1254720710825874, 'psi': 0.38733739882914675}-{'f1_val': 0.14142628205128205, 'auprc': 0.6114563534637568, 'loss_val': 1.231412885638394, 'psi': 0.32943831061627193}
[S7] START round=7 head_norm_before_train=0.854547 cos_to_last_merge=0.9887 (last merge round=5)
[S7] round=7 local utility u=0.188412 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.6896586399401138, 'loss_val': 0.8439510563808145, 'psi': 0.5258895268426595}-{'f1_val': 0.41671011811102343, 'auprc': 0.5885445202967876, 'loss_val': 0.9174321306004446, 'psi': 0.4854438789853291}
[S8] START round=7 head_norm_before_train=0.720952 cos_to_last_merge=0.9943 (last merge round=5)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.40134496674892456, 'auprc': 0.7657532841476103, 'loss_val': 0.9486231206253993, 'psi': 0.5471082937083989}-{'f1_val': 0.7141723980650027, 'auprc': 0.7732614476361713, 'loss_val': 1.1115194564320734, 'psi': 0.7378080178934702}
[S9] START round=7 head_norm_before_train=1.534592 (no previous merge yet)
[S9] round=7 local utility u=0.893143 metrics={'f1_val': 0.9878214512971564, 'auprc': 0.9982064395792736, 'loss_val': 0.19688643973965916, 'psi': 0.9919754466100033}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982292345789957, 'loss_val': 0.26361193550522044, 'psi': 0.8200216422956095}
[S10] START round=7 head_norm_before_train=1.302892 (no previous merge yet)
[S10] round=7 local utility u=0.178715 metrics={'f1_val': 0.41652587907229816, 'auprc': 0.8364018848826811, 'loss_val': 0.9435297855487124, 'psi': 0.5844762813964514}-{'f1_val': 0.41597454042981274, 'auprc': 0.774329922030237, 'loss_val': 1.1114353629935616, 'psi': 0.5593166930699824}
[S11] START round=7 head_norm_before_train=1.336810 (no previous merge yet)
[S11] round=7 local utility u=0.062899 metrics={'f1_val': 0.3936438436166054, 'auprc': 0.9993934010950527, 'loss_val': 0.6852405800862754, 'psi': 0.6359436666079844}-{'f1_val': 0.396484976660716, 'auprc': 0.9983597711430859, 'loss_val': 0.8249835653600325, 'psi': 0.637234894453664}
[S13] START round=7 head_norm_before_train=1.022057 cos_to_last_merge=0.9972 (last merge round=5)
[S13] round=7 local utility u=0.242881 metrics={'f1_val': 0.20358413782594276, 'auprc': 0.7251874639966072, 'loss_val': 1.1571173452950732, 'psi': 0.41222546829420853}-{'f1_val': 0.1403857625770531, 'auprc': 0.7152512552884506, 'loss_val': 1.2338800646761356, 'psi': 0.3703319596616121}
[S14] START round=7 head_norm_before_train=1.355940 (no previous merge yet)
[S14] round=7 local utility u=0.172694 metrics={'f1_val': 0.40206457297035714, 'auprc': 0.9953701397183894, 'loss_val': 0.7555134024962306, 'psi': 0.6393867996695701}-{'f1_val': 0.3915416722537795, 'auprc': 0.9659312068120944, 'loss_val': 0.9494468919967365, 'psi': 0.6212974860771054}
[S15] START round=7 head_norm_before_train=1.328433 (no previous merge yet)
[S15] round=7 local utility u=0.103570 metrics={'f1_val': 0.7154931559639712, 'auprc': 0.7770537932879346, 'loss_val': 0.7938621572461426, 'psi': 0.7401174108935565}-{'f1_val': 0.7154079827876261, 'auprc': 0.777054945767405, 'loss_val': 1.0004937304981931, 'psi': 0.7400667679795376}
[S16] START round=7 head_norm_before_train=0.840366 cos_to_last_merge=0.9964 (last merge round=5)
[S16] round=7 local utility u=0.198161 metrics={'f1_val': 0.3843760062322359, 'auprc': 0.7550610970376325, 'loss_val': 0.8715947074465625, 'psi': 0.5326500425543945}-{'f1_val': 0.4168831021970758, 'auprc': 0.5796475469099847, 'loss_val': 0.9367188917033423, 'psi': 0.4819888800822394}
[S17] START round=7 head_norm_before_train=1.395775 (no previous merge yet)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.35480128428545776, 'auprc': 0.9004888665075971, 'loss_val': 0.870336241024942, 'psi': 0.5730763171743135}-{'f1_val': 0.3911334018808198, 'auprc': 0.9007996083517371, 'loss_val': 0.9566233771836588, 'psi': 0.5949998844691867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:50304
[S9] not sending this round → trigger blocked (psi=0.992)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:50309
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:50308
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:50316
[S6] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S14
[S13] cosine check vs S14: cos=0.9207
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=0.5965
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] cosine check vs S16: cos=0.7328
[S10] RECEIVED delta(kind=head bytes=1793) from S11
[S10] cosine check vs S11: cos=-0.0387
[S10] DROPPED delta from S11 (cos=-0.0387 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1791) from S13
[S16] cosine check vs S13: cos=-0.1171
[S16] DROPPED delta from S13 (cos=-0.1171 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S10
[S7] cosine check vs S10: cos=-0.0181
[S7] DROPPED delta from S10 (cos=-0.0181 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] cosine check vs S6: cos=0.2674
[S8] RECEIVED delta(kind=head bytes=1804) from S4
[S8] cosine check vs S4: cos=0.3187
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] cosine check vs S15: cos=0.7109
[S5] RECEIVED delta(kind=head bytes=1797) from S2
[S5] cosine check vs S2: cos=0.7590
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4175 head_norm=0.852101
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.987174e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.5618 head_norm=0.806771 delta_norm=0.298717
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.4013 head_norm=0.768619
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.066283e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.6113 head_norm=0.663446 delta_norm=0.306628
[S8] aggregate: ACCEPT kept=['S7', 'S4'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.4143 head_norm=1.088647
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.731724e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.4143 head_norm=0.920925 delta_norm=0.373172
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.2036 head_norm=1.040816
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.010496e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.1724 head_norm=1.197814 delta_norm=0.301050
[S13] aggregate: ROLLBACK (f1_val pre=0.204 post=0.172 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.4167 head_norm=0.928291
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.147481e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.5907 head_norm=0.800030 delta_norm=0.314748
[S7] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.868416 cos_to_last_merge=0.9361 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.936
[S2] round=8 local utility u=0.599069 metrics={'f1_val': 0.5853341932590055, 'auprc': 0.7765943917029382, 'loss_val': 0.9169357791544428, 'psi': 0.6618382726365786}-{'f1_val': 0.4165165486077186, 'auprc': 0.7547724593191942, 'loss_val': 1.0367028255172759, 'psi': 0.5518189128923089}
[S3] START round=8 head_norm_before_train=1.090736 cos_to_last_merge=0.9918 (last merge round=6)
[S3] round=8 local utility u=0.574957 metrics={'f1_val': 0.6985736745320306, 'auprc': 0.99886647956024, 'loss_val': 0.4266157865850259, 'psi': 0.8186907965433143}-{'f1_val': 0.5481320926237119, 'auprc': 0.9990888687059156, 'loss_val': 0.6745476160940574, 'psi': 0.7285148030565933}
[S4] START round=8 head_norm_before_train=0.920925 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.551465 metrics={'f1_val': 0.6622143514177271, 'auprc': 0.6465798501582852, 'loss_val': 0.827329571720098, 'psi': 0.6559605509139503}-{'f1_val': 0.4142737879287599, 'auprc': 0.7824695105400868, 'loss_val': 0.8502842832054303, 'psi': 0.5615520769732907}
[S5] START round=8 head_norm_before_train=0.806771 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.634863 metrics={'f1_val': 0.6609687538309121, 'auprc': 0.7247764155942478, 'loss_val': 0.673146981934143, 'psi': 0.6864918185362464}-{'f1_val': 0.41754551926731287, 'auprc': 0.8084691516925623, 'loss_val': 0.7334122401115672, 'psi': 0.5739149722374126}
[S6] START round=8 head_norm_before_train=0.721239 cos_to_last_merge=0.9808 (last merge round=5)
[S6] round=8 local utility u=0.907320 metrics={'f1_val': 0.4154386543303195, 'auprc': 0.770803841085528, 'loss_val': 0.9631979491178023, 'psi': 0.557584729032403}-{'f1_val': 0.16509847798894206, 'auprc': 0.7206957800894538, 'loss_val': 1.1254720710825874, 'psi': 0.38733739882914675}
[S7] START round=8 head_norm_before_train=0.800030 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.659078 metrics={'f1_val': 0.5844917436819559, 'auprc': 0.8016949373071061, 'loss_val': 0.8685942634259888, 'psi': 0.6713730211320159}-{'f1_val': 0.41671011811102343, 'auprc': 0.6896586399401138, 'loss_val': 0.8439510563808145, 'psi': 0.5258895268426595}
[S8] START round=8 head_norm_before_train=0.663446 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.3727318090052443, 'auprc': 0.7787966787056019, 'loss_val': 0.9214548725234843, 'psi': 0.5351577568853874}-{'f1_val': 0.40134496674892456, 'auprc': 0.7657532841476103, 'loss_val': 0.9486231206253993, 'psi': 0.5471082937083989}
[S9] START round=8 head_norm_before_train=1.590250 (no previous merge yet)
[S9] round=8 local utility u=0.049928 metrics={'f1_val': 0.992904783397339, 'auprc': 0.9982009054153717, 'loss_val': 0.12751418126737987, 'psi': 0.9950232322045521}-{'f1_val': 0.9878214512971564, 'auprc': 0.9982064395792736, 'loss_val': 0.19688643973965916, 'psi': 0.9919754466100033}
[S10] START round=8 head_norm_before_train=1.340640 (no previous merge yet)
[S10] round=8 local utility u=0.171578 metrics={'f1_val': 0.43634809895669846, 'auprc': 0.8565929175803014, 'loss_val': 0.7798794295256963, 'psi': 0.6044460264061396}-{'f1_val': 0.41652587907229816, 'auprc': 0.8364018848826811, 'loss_val': 0.9435297855487124, 'psi': 0.5844762813964514}
[S11] START round=8 head_norm_before_train=1.384126 (no previous merge yet)
[S11] round=8 local utility u=0.586152 metrics={'f1_val': 0.5722364610733892, 'auprc': 0.9994788259651415, 'loss_val': 0.5847495370983148, 'psi': 0.7431334070300901}-{'f1_val': 0.3936438436166054, 'auprc': 0.9993934010950527, 'loss_val': 0.6852405800862754, 'psi': 0.6359436666079844}
[S13] START round=8 head_norm_before_train=1.197814 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.518733 metrics={'f1_val': 0.37312924291776256, 'auprc': 0.7123494231692773, 'loss_val': 1.0984086684814434, 'psi': 0.5088173150183685}-{'f1_val': 0.20358413782594276, 'auprc': 0.7251874639966072, 'loss_val': 1.1571173452950732, 'psi': 0.41222546829420853}
[S14] START round=8 head_norm_before_train=1.402670 (no previous merge yet)
[S14] round=8 local utility u=0.206266 metrics={'f1_val': 0.44103583854586387, 'auprc': 0.9943186280515105, 'loss_val': 0.5736548054258466, 'psi': 0.6623489543481225}-{'f1_val': 0.40206457297035714, 'auprc': 0.9953701397183894, 'loss_val': 0.7555134024962306, 'psi': 0.6393867996695701}
[S15] START round=8 head_norm_before_train=1.368234 (no previous merge yet)
[S15] round=8 local utility u=0.056763 metrics={'f1_val': 0.6974235364088363, 'auprc': 0.7947432409548059, 'loss_val': 0.6249866148598924, 'psi': 0.7363514182272242}-{'f1_val': 0.7154931559639712, 'auprc': 0.7770537932879346, 'loss_val': 0.7938621572461426, 'psi': 0.7401174108935565}
[S16] START round=8 head_norm_before_train=0.888577 cos_to_last_merge=0.9865 (last merge round=5)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.3771285152922366, 'auprc': 0.7626232940410589, 'loss_val': 0.8805753321775689, 'psi': 0.5313264267917656}-{'f1_val': 0.3843760062322359, 'auprc': 0.7550610970376325, 'loss_val': 0.8715947074465625, 'psi': 0.5326500425543945}
[S17] START round=8 head_norm_before_train=1.437434 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.35391622072494766, 'auprc': 0.8470008825126489, 'loss_val': 0.8559307698876588, 'psi': 0.5511500854400282}-{'f1_val': 0.35480128428545776, 'auprc': 0.9004888665075971, 'loss_val': 0.870336241024942, 'psi': 0.5730763171743135}
[S11] not sending this round → trigger blocked (psi=0.743)
[S6] not sending this round → trigger blocked (psi=0.558)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:50303
[S15] not sending this round → trigger blocked (psi=0.736)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:50303
[S2] not sending this round → trigger blocked (psi=0.662)
[S4] not sending this round → trigger blocked (psi=0.656)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:50307
[S14] not sending this round → trigger blocked (psi=0.662)
[S13] not sending this round → trigger blocked (psi=0.509)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.604)
[S7] not sending this round → trigger blocked (psi=0.671)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=0.8725
[S3] RECEIVED delta(kind=head bytes=1795) from S5
[S3] cosine check vs S5: cos=0.2401
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] cosine check vs S3: cos=0.5981
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.4154 head_norm=0.766866
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.673513e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.6951 head_norm=0.867048 delta_norm=0.467351
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.6986 head_norm=1.162883
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.658386e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.7001 head_norm=1.011937 delta_norm=0.265839
[S3] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.909276 cos_to_last_merge=0.9190 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.919
[S2] round=9 local utility u=0.392377 metrics={'f1_val': 0.7124996173874462, 'auprc': 0.7502229718959385, 'loss_val': 0.8160599206645001, 'psi': 0.7275889591908431}-{'f1_val': 0.5853341932590055, 'auprc': 0.7765943917029382, 'loss_val': 0.9169357791544428, 'psi': 0.6618382726365786}
[S3] START round=9 head_norm_before_train=1.011937 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.015565 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9991763428749679, 'loss_val': 0.40950972244706785, 'psi': 0.820124259391167}-{'f1_val': 0.6985736745320306, 'auprc': 0.99886647956024, 'loss_val': 0.4266157865850259, 'psi': 0.8186907965433143}
[S4] START round=9 head_norm_before_train=0.958717 cos_to_last_merge=0.9957 (last merge round=7)
[S4] round=9 local utility u=0.242803 metrics={'f1_val': 0.6156387601342491, 'auprc': 0.8537883832847093, 'loss_val': 0.6838958448881812, 'psi': 0.7108986093944332}-{'f1_val': 0.6622143514177271, 'auprc': 0.6465798501582852, 'loss_val': 0.827329571720098, 'psi': 0.6559605509139503}
[S5] START round=9 head_norm_before_train=0.870102 cos_to_last_merge=0.9907 (last merge round=7)
[S5] round=9 local utility u=0.324935 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.8024846546173168, 'loss_val': 0.4939998747395233, 'psi': 0.7413349678497178}-{'f1_val': 0.6609687538309121, 'auprc': 0.7247764155942478, 'loss_val': 0.673146981934143, 'psi': 0.6864918185362464}
[S6] START round=9 head_norm_before_train=0.867048 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.230191 metrics={'f1_val': 0.41572398475555894, 'auprc': 0.9361027917251594, 'loss_val': 1.0004248151139377, 'psi': 0.6238755075433992}-{'f1_val': 0.4154386543303195, 'auprc': 0.770803841085528, 'loss_val': 0.9631979491178023, 'psi': 0.557584729032403}
[S7] START round=9 head_norm_before_train=0.857632 cos_to_last_merge=0.9928 (last merge round=7)
[S7] round=9 local utility u=0.299345 metrics={'f1_val': 0.6660428844702327, 'auprc': 0.7775931528578375, 'loss_val': 0.6869066426753105, 'psi': 0.7106629918252747}-{'f1_val': 0.5844917436819559, 'auprc': 0.8016949373071061, 'loss_val': 0.8685942634259888, 'psi': 0.6713730211320159}
[S8] START round=9 head_norm_before_train=0.707908 cos_to_last_merge=0.9899 (last merge round=7)
[S8] round=9 local utility u=0.381072 metrics={'f1_val': 0.3727318090052443, 'auprc': 0.9916711049641607, 'loss_val': 0.7979332949565143, 'psi': 0.6203075273888109}-{'f1_val': 0.3727318090052443, 'auprc': 0.7787966787056019, 'loss_val': 0.9214548725234843, 'psi': 0.5351577568853874}
[S9] START round=9 head_norm_before_train=1.639750 (no previous merge yet)
[S9] round=9 local utility u=0.027775 metrics={'f1_val': 0.9933015149123428, 'auprc': 0.998914688716826, 'loss_val': 0.0764864490274653, 'psi': 0.995546784434136}-{'f1_val': 0.992904783397339, 'auprc': 0.9982009054153717, 'loss_val': 0.12751418126737987, 'psi': 0.9950232322045521}
[S10] START round=9 head_norm_before_train=1.380573 (no previous merge yet)
[S10] round=9 local utility u=0.535289 metrics={'f1_val': 0.5801089412594674, 'auprc': 0.8645732886150955, 'loss_val': 0.5958074650764005, 'psi': 0.6938946802017187}-{'f1_val': 0.43634809895669846, 'auprc': 0.8565929175803014, 'loss_val': 0.7798794295256963, 'psi': 0.6044460264061396}
[S11] START round=9 head_norm_before_train=1.424536 (no previous merge yet)
[S11] round=9 local utility u=0.448190 metrics={'f1_val': 0.7018246587012323, 'auprc': 0.9989058373294094, 'loss_val': 0.46417916317985225, 'psi': 0.8206571301525032}-{'f1_val': 0.5722364610733892, 'auprc': 0.9994788259651415, 'loss_val': 0.5847495370983148, 'psi': 0.7431334070300901}
[S13] START round=9 head_norm_before_train=1.211738 cos_to_last_merge=0.9985 (last merge round=7)
[S13] round=9 local utility u=1.000000 metrics={'f1_val': 0.7117313581776377, 'auprc': 0.7397015891018889, 'loss_val': 0.9010030719772671, 'psi': 0.7229194505473382}-{'f1_val': 0.37312924291776256, 'auprc': 0.7123494231692773, 'loss_val': 1.0984086684814434, 'psi': 0.5088173150183685}
[S14] START round=9 head_norm_before_train=1.449120 (no previous merge yet)
[S14] round=9 local utility u=0.831188 metrics={'f1_val': 0.6974762449117438, 'auprc': 0.996849779477464, 'loss_val': 0.45751380329587205, 'psi': 0.8172256587380319}-{'f1_val': 0.44103583854586387, 'auprc': 0.9943186280515105, 'loss_val': 0.5736548054258466, 'psi': 0.6623489543481225}
[S15] START round=9 head_norm_before_train=1.410419 (no previous merge yet)
[S15] round=9 local utility u=0.056638 metrics={'f1_val': 0.7016270041226991, 'auprc': 0.7876715214431009, 'loss_val': 0.5157160843359553, 'psi': 0.7360448110508598}-{'f1_val': 0.6974235364088363, 'auprc': 0.7947432409548059, 'loss_val': 0.6249866148598924, 'psi': 0.7363514182272242}
[S16] START round=9 head_norm_before_train=0.934242 cos_to_last_merge=0.9736 (last merge round=5)
[S16] round=9 local utility u=0.017025 metrics={'f1_val': 0.3852310432200632, 'auprc': 0.743849016204203, 'loss_val': 0.8388171578618829, 'psi': 0.5286782324137191}-{'f1_val': 0.3771285152922366, 'auprc': 0.7626232940410589, 'loss_val': 0.8805753321775689, 'psi': 0.5313264267917656}
[S17] START round=9 head_norm_before_train=1.476351 (no previous merge yet)
[S17] round=9 local utility u=0.020671 metrics={'f1_val': 0.35812635738491166, 'auprc': 0.8385764314117127, 'loss_val': 0.8145754607404544, 'psi': 0.5503063869956322}-{'f1_val': 0.35391622072494766, 'auprc': 0.8470008825126489, 'loss_val': 0.8559307698876588, 'psi': 0.5511500854400282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:50308
[S3] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:50304
[S9] not sending this round → trigger blocked (psi=0.996)
[S5] not sending this round → trigger blocked (psi=0.741)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:50316
[S8] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1794) from S11
[S10] cosine check vs S11: cos=-0.0325
[S10] DROPPED delta from S11 (cos=-0.0325 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S14
[S13] cosine check vs S14: cos=0.9612
[S8] RECEIVED delta(kind=head bytes=1797) from S4
[S8] cosine check vs S4: cos=0.6373
[S8] RECEIVED delta(kind=head bytes=1802) from S7
[S8] cosine check vs S7: cos=0.5573
[S4] RECEIVED delta(kind=head bytes=1805) from S16
[S4] cosine check vs S16: cos=0.8576
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] cosine check vs S13: cos=-0.1154
[S16] DROPPED delta from S13 (cos=-0.1154 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S8
[S16] cosine check vs S8: cos=0.6767
[S7] RECEIVED delta(kind=head bytes=1796) from S15
[S7] cosine check vs S15: cos=0.7707
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.0033
[S7] RECEIVED delta(kind=head bytes=1794) from S6
[S7] cosine check vs S6: cos=0.3241
[S5] RECEIVED delta(kind=head bytes=1795) from S2
[S5] cosine check vs S2: cos=0.8331
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=-0.0247
[S14] DROPPED delta from S17 (cos=-0.0247 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.7006 head_norm=0.950089
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.754849e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.7006 head_norm=0.912906 delta_norm=0.275485
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3727 head_norm=0.762238
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.025930e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.3727 head_norm=0.693633 delta_norm=0.202593
[S8] aggregate: ACCEPT kept=['S4', 'S7'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.6660 head_norm=0.915687
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.782240e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4167 head_norm=0.740422 delta_norm=0.378224
[S7] aggregate: ROLLBACK (f1_val pre=0.666 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6156 head_norm=1.011239
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.659777e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6137 head_norm=0.959149 delta_norm=0.265978
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.7117 head_norm=1.236819
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.268579e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.7121 head_norm=1.349214 delta_norm=0.226858
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3852 head_norm=0.979193
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.639151e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3850 head_norm=0.798423 delta_norm=0.363915
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.957032 cos_to_last_merge=0.8998 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.900
[S2] round=10 local utility u=0.027622 metrics={'f1_val': 0.7135097629993654, 'auprc': 0.7758885480700358, 'loss_val': 0.8438729254635955, 'psi': 0.7384612770276335}-{'f1_val': 0.7124996173874462, 'auprc': 0.7502229718959385, 'loss_val': 0.8160599206645001, 'psi': 0.7275889591908431}
[S3] START round=10 head_norm_before_train=1.074557 cos_to_last_merge=0.9967 (last merge round=8)
[S3] round=10 local utility u=0.027597 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.998961062177567, 'loss_val': 0.3526210986838362, 'psi': 0.8199332624662798}-{'f1_val': 0.7007562037352997, 'auprc': 0.9991763428749679, 'loss_val': 0.40950972244706785, 'psi': 0.820124259391167}
[S4] START round=10 head_norm_before_train=0.959149 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.054102 metrics={'f1_val': 0.6242120890631095, 'auprc': 0.8546683853064784, 'loss_val': 0.6297718684911094, 'psi': 0.716394607560457}-{'f1_val': 0.6156387601342491, 'auprc': 0.8537883832847093, 'loss_val': 0.6838958448881812, 'psi': 0.7108986093944332}
[S5] START round=10 head_norm_before_train=0.912906 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.295428 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9914402230270367, 'loss_val': 0.468527682327992, 'psi': 0.816768879671163}-{'f1_val': 0.7005685100046517, 'auprc': 0.8024846546173168, 'loss_val': 0.4939998747395233, 'psi': 0.7413349678497178}
[S6] START round=10 head_norm_before_train=0.898480 cos_to_last_merge=0.9950 (last merge round=8)
[S6] round=10 local utility u=0.856996 metrics={'f1_val': 0.6426085094750544, 'auprc': 0.965794462744543, 'loss_val': 0.7368145272169045, 'psi': 0.7718828907828499}-{'f1_val': 0.41572398475555894, 'auprc': 0.9361027917251594, 'loss_val': 1.0004248151139377, 'psi': 0.6238755075433992}
[S7] START round=10 head_norm_before_train=0.740422 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.100865 metrics={'f1_val': 0.7034162987109418, 'auprc': 0.7831201263494282, 'loss_val': 0.725997600535462, 'psi': 0.7352978297663364}-{'f1_val': 0.6660428844702327, 'auprc': 0.7775931528578375, 'loss_val': 0.6869066426753105, 'psi': 0.7106629918252747}
[S8] START round=10 head_norm_before_train=0.693633 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.021773 metrics={'f1_val': 0.37253128131745294, 'auprc': 0.9911040192749715, 'loss_val': 0.7514837727353242, 'psi': 0.6199603765004603}-{'f1_val': 0.3727318090052443, 'auprc': 0.9916711049641607, 'loss_val': 0.7979332949565143, 'psi': 0.6203075273888109}
[S9] START round=10 head_norm_before_train=1.684215 (no previous merge yet)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.9899395432128293, 'auprc': 0.9991036725461696, 'loss_val': 0.0656627787186956, 'psi': 0.9936051949461654}-{'f1_val': 0.9933015149123428, 'auprc': 0.998914688716826, 'loss_val': 0.0764864490274653, 'psi': 0.995546784434136}
[S10] START round=10 head_norm_before_train=1.425937 (no previous merge yet)
[S10] round=10 local utility u=0.507290 metrics={'f1_val': 0.6875141306593056, 'auprc': 0.9431888519128829, 'loss_val': 0.4615054744688886, 'psi': 0.7897840191607365}-{'f1_val': 0.5801089412594674, 'auprc': 0.8645732886150955, 'loss_val': 0.5958074650764005, 'psi': 0.6938946802017187}
[S11] START round=10 head_norm_before_train=1.460481 (no previous merge yet)
[S11] round=10 local utility u=0.027409 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9989976452640201, 'loss_val': 0.4106939387656928, 'psi': 0.8207995236731473}-{'f1_val': 0.7018246587012323, 'auprc': 0.9989058373294094, 'loss_val': 0.46417916317985225, 'psi': 0.8206571301525032}
[S13] START round=10 head_norm_before_train=1.349214 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.5233145168891509, 'auprc': 0.7286064217579163, 'loss_val': 0.782341927413878, 'psi': 0.605431278836657}-{'f1_val': 0.7117313581776377, 'auprc': 0.7397015891018889, 'loss_val': 0.9010030719772671, 'psi': 0.7229194505473382}
[S14] START round=10 head_norm_before_train=1.487940 (no previous merge yet)
[S14] round=10 local utility u=0.052071 metrics={'f1_val': 0.6974125774822649, 'auprc': 0.9974742012467578, 'loss_val': 0.3548625376789925, 'psi': 0.8174372269880621}-{'f1_val': 0.6974762449117438, 'auprc': 0.996849779477464, 'loss_val': 0.45751380329587205, 'psi': 0.8172256587380319}
[S15] START round=10 head_norm_before_train=1.455037 (no previous merge yet)
[S15] round=10 local utility u=0.068147 metrics={'f1_val': 0.6988278503480894, 'auprc': 0.8113205553232237, 'loss_val': 0.43357426286061523, 'psi': 0.7438249323381432}-{'f1_val': 0.7016270041226991, 'auprc': 0.7876715214431009, 'loss_val': 0.5157160843359553, 'psi': 0.7360448110508598}
[S16] START round=10 head_norm_before_train=0.798423 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.068757 metrics={'f1_val': 0.4041715882050423, 'auprc': 0.744407989563792, 'loss_val': 0.8166234291379011, 'psi': 0.5402661487485422}-{'f1_val': 0.3852310432200632, 'auprc': 0.743849016204203, 'loss_val': 0.8388171578618829, 'psi': 0.5286782324137191}
[S17] START round=10 head_norm_before_train=1.505729 (no previous merge yet)
[S17] round=10 local utility u=0.052351 metrics={'f1_val': 0.3779373442396944, 'auprc': 0.8150221270527864, 'loss_val': 0.7580769930467312, 'psi': 0.5527712573649313}-{'f1_val': 0.35812635738491166, 'auprc': 0.8385764314117127, 'loss_val': 0.8145754607404544, 'psi': 0.5503063869956322}
[S6] not sending this round → trigger blocked (psi=0.772)
[S10] not sending this round → trigger blocked (psi=0.790)
[S4] not sending this round → trigger blocked (psi=0.716)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.817)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:50303
[S16] not sending this round → trigger blocked (psi=0.540)
[S11] not sending this round → trigger blocked (psi=0.821)
[S15] not sending this round → trigger blocked (psi=0.744)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.735)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:50307
[S2] not sending this round → trigger blocked (psi=0.738)
[S8] not sending this round → trigger blocked (psi=0.620)
[S5] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S5
[S3] cosine check vs S5: cos=0.3333
[S6] RECEIVED delta(kind=head bytes=1795) from S3
[S6] cosine check vs S3: cos=0.8720
[S17] not sending this round → trigger blocked (psi=0.553)
[S15] ⇄ pheromone p=0.291 → S7@127.0.0.1:50308
[S14] ⇄ pheromone p=0.392 → S13@127.0.0.1:50313
[S11] ⇄ pheromone p=0.341 → S10@127.0.0.1:50311
[S7] ⇄ pheromone p=0.323 → S8@127.0.0.1:50309
[S4] ⇄ pheromone p=0.289 → S8@127.0.0.1:50309
[S2] ⇄ pheromone p=0.378 → S5@127.0.0.1:50305
[S13] ⇄ pheromone p=0.386 → S16@127.0.0.1:50316
[S8] ⇄ pheromone p=0.272 → S16@127.0.0.1:50316
[S9] ⇄ pheromone p=0.333 → S3@127.0.0.1:50303
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.6426 head_norm=0.941562
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.825499e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.6967 head_norm=1.011125 delta_norm=0.282550
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.464 → S7@127.0.0.1:50308
[S10] ⇄ pheromone p=0.444 → S7@127.0.0.1:50308
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.7006 head_norm=1.147988
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.188349e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.7006 head_norm=0.871213 delta_norm=0.618835
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.307 → S6@127.0.0.1:50307
[S5] ⇄ pheromone p=0.379 → S3@127.0.0.1:50303
[S16] ⇄ pheromone p=0.179 → S4@127.0.0.1:50304
[S17] ⇄ pheromone p=0.235 → S14@127.0.0.1:50314
[S2] START round=11 head_norm_before_train=1.007275 cos_to_last_merge=0.8807 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.881
[S2] round=11 local utility u=0.060101 metrics={'f1_val': 0.7127257279839823, 'auprc': 0.7762457994066214, 'loss_val': 0.7200383099376166, 'psi': 0.7381337565530379}-{'f1_val': 0.7135097629993654, 'auprc': 0.7758885480700358, 'loss_val': 0.8438729254635955, 'psi': 0.7384612770276335}
[S3] START round=11 head_norm_before_train=0.871213 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9986869907657943, 'loss_val': 0.4080158250994787, 'psi': 0.8199738373216041}-{'f1_val': 0.7005813959920884, 'auprc': 0.998961062177567, 'loss_val': 0.3526210986838362, 'psi': 0.8199332624662798}
[S4] START round=11 head_norm_before_train=1.007583 cos_to_last_merge=0.9962 (last merge round=9)
[S4] round=11 local utility u=0.220458 metrics={'f1_val': 0.6827792068206094, 'auprc': 0.8551082186170664, 'loss_val': 0.5415777336019238, 'psi': 0.7517108115391923}-{'f1_val': 0.6242120890631095, 'auprc': 0.8546683853064784, 'loss_val': 0.6297718684911094, 'psi': 0.716394607560457}
[S5] START round=11 head_norm_before_train=0.982884 cos_to_last_merge=0.9922 (last merge round=9)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.860033753281555, 'loss_val': 0.40782976203301685, 'psi': 0.7642062917729702}-{'f1_val': 0.7003213174339138, 'auprc': 0.9914402230270367, 'loss_val': 0.468527682327992, 'psi': 0.816768879671163}
[S6] START round=11 head_norm_before_train=1.011125 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.41555801085999516, 'auprc': 0.9301941241333638, 'loss_val': 0.8006671771466307, 'psi': 0.6214124561693426}-{'f1_val': 0.6426085094750544, 'auprc': 0.965794462744543, 'loss_val': 0.7368145272169045, 'psi': 0.7718828907828499}
[S7] START round=11 head_norm_before_train=0.786797 cos_to_last_merge=0.9950 (last merge round=9)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.3883478906207903, 'auprc': 0.7653914909306847, 'loss_val': 0.9182527368637239, 'psi': 0.539165330744748}-{'f1_val': 0.7034162987109418, 'auprc': 0.7831201263494282, 'loss_val': 0.725997600535462, 'psi': 0.7352978297663364}
[S8] START round=11 head_norm_before_train=0.746128 cos_to_last_merge=0.9929 (last merge round=9)
[S8] round=11 local utility u=0.070734 metrics={'f1_val': 0.37266438550987346, 'auprc': 0.9949282860861269, 'loss_val': 0.6222864288984569, 'psi': 0.6215699457403748}-{'f1_val': 0.37253128131745294, 'auprc': 0.9911040192749715, 'loss_val': 0.7514837727353242, 'psi': 0.6199603765004603}
[S9] START round=11 head_norm_before_train=1.726192 (no previous merge yet)
[S9] round=11 local utility u=0.006361 metrics={'f1_val': 0.9903923264803052, 'auprc': 0.9992897170385846, 'loss_val': 0.056214980554184335, 'psi': 0.993951282703617}-{'f1_val': 0.9899395432128293, 'auprc': 0.9991036725461696, 'loss_val': 0.0656627787186956, 'psi': 0.9936051949461654}
[S10] START round=11 head_norm_before_train=1.474765 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.5505895612062156, 'auprc': 0.8533332941088827, 'loss_val': 0.4549500506165461, 'psi': 0.6716870543672825}-{'f1_val': 0.6875141306593056, 'auprc': 0.9431888519128829, 'loss_val': 0.4615054744688886, 'psi': 0.7897840191607365}
[S11] START round=11 head_norm_before_train=1.502261 (no previous merge yet)
[S11] round=11 local utility u=0.041471 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9986878206646264, 'loss_val': 0.32682173964674316, 'psi': 0.8206755938333898}-{'f1_val': 0.7020007759458987, 'auprc': 0.9989976452640201, 'loss_val': 0.4106939387656928, 'psi': 0.8207995236731473}
[S13] START round=11 head_norm_before_train=1.377832 cos_to_last_merge=0.9983 (last merge round=9)
[S13] round=11 local utility u=0.365901 metrics={'f1_val': 0.6295727924520529, 'auprc': 0.724092084496004, 'loss_val': 0.6745460753081833, 'psi': 0.6673805092696333}-{'f1_val': 0.5233145168891509, 'auprc': 0.7286064217579163, 'loss_val': 0.782341927413878, 'psi': 0.605431278836657}
[S14] START round=11 head_norm_before_train=1.524513 (no previous merge yet)
[S14] round=11 local utility u=0.898215 metrics={'f1_val': 0.9950335354585476, 'auprc': 0.9961016505183147, 'loss_val': 0.3400402453417469, 'psi': 0.9954607814824543}-{'f1_val': 0.6974125774822649, 'auprc': 0.9974742012467578, 'loss_val': 0.3548625376789925, 'psi': 0.8174372269880621}
[S15] START round=11 head_norm_before_train=1.501589 (no previous merge yet)
[S15] round=11 local utility u=0.308135 metrics={'f1_val': 0.699247069653446, 'auprc': 0.9871036991744433, 'loss_val': 0.3471699697684621, 'psi': 0.814389721461845}-{'f1_val': 0.6988278503480894, 'auprc': 0.8113205553232237, 'loss_val': 0.43357426286061523, 'psi': 0.7438249323381432}
[S16] START round=11 head_norm_before_train=0.842943 cos_to_last_merge=0.9966 (last merge round=9)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.3666830837439352, 'auprc': 0.7639400438065678, 'loss_val': 0.7652546894772078, 'psi': 0.5255858677689883}-{'f1_val': 0.4041715882050423, 'auprc': 0.744407989563792, 'loss_val': 0.8166234291379011, 'psi': 0.5402661487485422}
[S17] START round=11 head_norm_before_train=1.530277 (no previous merge yet)
[S17] round=11 local utility u=0.236026 metrics={'f1_val': 0.398054922404719, 'auprc': 0.9040936122027483, 'loss_val': 0.6739455727767325, 'psi': 0.6004703983239308}-{'f1_val': 0.3779373442396944, 'auprc': 0.8150221270527864, 'loss_val': 0.7580769930467312, 'psi': 0.5527712573649313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:50305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:50309
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S11
[S10] cosine check vs S11: cos=-0.0295
[S10] DROPPED delta from S11 (cos=-0.0295 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S4
[S8] cosine check vs S4: cos=0.7014
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] cosine check vs S13: cos=-0.0797
[S16] DROPPED delta from S13 (cos=-0.0797 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1805) from S8
[S16] cosine check vs S8: cos=0.8501
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=0.7354
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=0.5429
[S5] RECEIVED delta(kind=head bytes=1790) from S2
[S5] cosine check vs S2: cos=0.8752
[S13] RECEIVED delta(kind=head bytes=1793) from S14
[S13] cosine check vs S14: cos=0.9721
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S17
[S14] cosine check vs S17: cos=-0.0170
[S14] DROPPED delta from S17 (cos=-0.0170 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7003 head_norm=1.056865
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.640821e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7003 head_norm=1.023781 delta_norm=0.264082
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.7008 head_norm=0.944224
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.397217e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.7020 head_norm=1.204233 delta_norm=0.739722
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.3883 head_norm=0.836958
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.440707e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.3967 head_norm=1.116481 delta_norm=0.544071
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.3667 head_norm=0.897434
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.370143e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.3504 head_norm=0.816648 delta_norm=0.237014
[S16] aggregate: ROLLBACK (f1_val pre=0.367 post=0.350 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.3727 head_norm=0.800494
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.804227e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.7138 head_norm=0.861672 delta_norm=0.380423
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6296 head_norm=1.409377
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.902938e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.6932 head_norm=1.473899 delta_norm=0.190294
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.057719 cos_to_last_merge=0.8642 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.864
[S2] round=12 local utility u=0.027051 metrics={'f1_val': 0.699311257249501, 'auprc': 0.7770493917394723, 'loss_val': 0.5878605296804049, 'psi': 0.7304065110454896}-{'f1_val': 0.7127257279839823, 'auprc': 0.7762457994066214, 'loss_val': 0.7200383099376166, 'psi': 0.7381337565530379}
[S3] START round=12 head_norm_before_train=1.204233 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.028895 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9993855090711625, 'loss_val': 0.35186724765934796, 'psi': 0.8202079258696449}-{'f1_val': 0.7008317350254774, 'auprc': 0.9986869907657943, 'loss_val': 0.4080158250994787, 'psi': 0.8199738373216041}
[S4] START round=12 head_norm_before_train=1.064711 cos_to_last_merge=0.9869 (last merge round=9)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.6626612403500605, 'auprc': 0.8439127102730263, 'loss_val': 0.49522796903524946, 'psi': 0.7351618283192468}-{'f1_val': 0.6827792068206094, 'auprc': 0.8551082186170664, 'loss_val': 0.5415777336019238, 'psi': 0.7517108115391923}
[S5] START round=12 head_norm_before_train=1.023781 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8535302143903769, 'loss_val': 0.6980275323126884, 'psi': 0.6034718240593739}-{'f1_val': 0.7003213174339138, 'auprc': 0.860033753281555, 'loss_val': 0.40782976203301685, 'psi': 0.7642062917729702}
[S6] START round=12 head_norm_before_train=1.042806 cos_to_last_merge=0.9969 (last merge round=10)
[S6] round=12 local utility u=0.948688 metrics={'f1_val': 0.692950778765043, 'auprc': 0.9475153579017064, 'loss_val': 0.6196124086949023, 'psi': 0.7947766104197084}-{'f1_val': 0.41555801085999516, 'auprc': 0.9301941241333638, 'loss_val': 0.8006671771466307, 'psi': 0.6214124561693426}
[S7] START round=12 head_norm_before_train=1.116481 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.3952505877768107, 'auprc': 0.7552367229133212, 'loss_val': 0.9510352549287123, 'psi': 0.539245041831415}-{'f1_val': 0.3883478906207903, 'auprc': 0.7653914909306847, 'loss_val': 0.9182527368637239, 'psi': 0.539165330744748}
[S8] START round=12 head_norm_before_train=0.861672 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=1.000000 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.9929314404850238, 'loss_val': 0.6212984508341854, 'psi': 0.8255050562724784}-{'f1_val': 0.37266438550987346, 'auprc': 0.9949282860861269, 'loss_val': 0.6222864288984569, 'psi': 0.6215699457403748}
[S9] START round=12 head_norm_before_train=1.761582 (no previous merge yet)
[S9] round=12 local utility u=0.023782 metrics={'f1_val': 0.9953911428861304, 'auprc': 0.9994013165126351, 'loss_val': 0.038979163636383686, 'psi': 0.9969952123367323}-{'f1_val': 0.9903923264803052, 'auprc': 0.9992897170385846, 'loss_val': 0.056214980554184335, 'psi': 0.993951282703617}
[S10] START round=12 head_norm_before_train=1.520145 (no previous merge yet)
[S10] round=12 local utility u=0.637506 metrics={'f1_val': 0.6874565438828282, 'auprc': 0.9570806864222268, 'loss_val': 0.3123830547224873, 'psi': 0.7953062008985876}-{'f1_val': 0.5505895612062156, 'auprc': 0.8533332941088827, 'loss_val': 0.4549500506165461, 'psi': 0.6716870543672825}
[S11] START round=12 head_norm_before_train=1.544140 (no previous merge yet)
[S11] round=12 local utility u=0.027738 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.998442766051439, 'loss_val': 0.26916012547901774, 'psi': 0.8204324694174544}-{'f1_val': 0.7020007759458987, 'auprc': 0.9986878206646264, 'loss_val': 0.32682173964674316, 'psi': 0.8206755938333898}
[S13] START round=12 head_norm_before_train=1.473899 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.130668 metrics={'f1_val': 0.6631933811149572, 'auprc': 0.7436133001746033, 'loss_val': 0.6734966088024728, 'psi': 0.6953613487388156}-{'f1_val': 0.6295727924520529, 'auprc': 0.724092084496004, 'loss_val': 0.6745460753081833, 'psi': 0.6673805092696333}
[S14] START round=12 head_norm_before_train=1.559115 (no previous merge yet)
[S14] round=12 local utility u=0.035971 metrics={'f1_val': 0.994777261319931, 'auprc': 0.9974682219323125, 'loss_val': 0.27065989708492905, 'psi': 0.9958536455648836}-{'f1_val': 0.9950335354585476, 'auprc': 0.9961016505183147, 'loss_val': 0.3400402453417469, 'psi': 0.9954607814824543}
[S15] START round=12 head_norm_before_train=1.544210 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.7052036647805424, 'auprc': 0.8647741269594982, 'loss_val': 0.4175296657927951, 'psi': 0.7690318496521247}-{'f1_val': 0.699247069653446, 'auprc': 0.9871036991744433, 'loss_val': 0.3471699697684621, 'psi': 0.814389721461845}
[S16] START round=12 head_norm_before_train=0.816648 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.3595361656340257, 'auprc': 0.7614887189034406, 'loss_val': 0.786122479806185, 'psi': 0.5203171869417917}-{'f1_val': 0.3666830837439352, 'auprc': 0.7639400438065678, 'loss_val': 0.7652546894772078, 'psi': 0.5255858677689883}
[S17] START round=12 head_norm_before_train=1.544665 (no previous merge yet)
[S17] round=12 local utility u=0.049217 metrics={'f1_val': 0.3926864105567096, 'auprc': 0.9366396150646621, 'loss_val': 0.6409388115123996, 'psi': 0.6102676923598906}-{'f1_val': 0.398054922404719, 'auprc': 0.9040936122027483, 'loss_val': 0.6739455727767325, 'psi': 0.6004703983239308}
[S14] not sending this round → trigger blocked (psi=0.996)
[S13] not sending this round → trigger blocked (psi=0.695)
[S9] not sending this round → trigger blocked (psi=0.997)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.826)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.730)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:50307
[S11] not sending this round → trigger blocked (psi=0.820)
[S3] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S3
[S6] cosine check vs S3: cos=0.9018
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=0.1246
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] cosine check vs S6: cos=0.2220
[S17] not sending this round → trigger blocked (psi=0.610)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.3953 head_norm=1.149681
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.693854e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.6818 head_norm=0.835355 delta_norm=0.669385
[S7] aggregate: ACCEPT kept=['S10', 'S6'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.6930 head_norm=1.081184
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.747751e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.9572 head_norm=1.143752 delta_norm=0.274775
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.107411 cos_to_last_merge=0.8503 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.850
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.6759764624792148, 'auprc': 0.6424471744086887, 'loss_val': 0.5897814907793717, 'psi': 0.6625647472510043}-{'f1_val': 0.699311257249501, 'auprc': 0.7770493917394723, 'loss_val': 0.5878605296804049, 'psi': 0.7304065110454896}
[S3] START round=13 head_norm_before_train=1.264271 cos_to_last_merge=0.9968 (last merge round=11)
[S3] round=13 local utility u=0.026107 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9987641064940267, 'loss_val': 0.2968872586170623, 'psi': 0.819869244097734}-{'f1_val': 0.7007562037352997, 'auprc': 0.9993855090711625, 'loss_val': 0.35186724765934796, 'psi': 0.8202079258696449}
[S4] START round=13 head_norm_before_train=1.121989 cos_to_last_merge=0.9756 (last merge round=9)
[S4] round=13 local utility u=0.091507 metrics={'f1_val': 0.6645260010920997, 'auprc': 0.89272214216011, 'loss_val': 0.46983120863299327, 'psi': 0.7558044575193038}-{'f1_val': 0.6626612403500605, 'auprc': 0.8439127102730263, 'loss_val': 0.49522796903524946, 'psi': 0.7351618283192468}
[S5] START round=13 head_norm_before_train=1.078106 cos_to_last_merge=0.9965 (last merge round=11)
[S5] round=13 local utility u=0.509346 metrics={'f1_val': 0.5808755261069142, 'auprc': 0.856029036086368, 'loss_val': 0.5514883320186473, 'psi': 0.6909369300986958}-{'f1_val': 0.43676623050537206, 'auprc': 0.8535302143903769, 'loss_val': 0.6980275323126884, 'psi': 0.6034718240593739}
[S6] START round=13 head_norm_before_train=1.143752 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.849462 metrics={'f1_val': 0.9578199796363056, 'auprc': 0.9631341075410913, 'loss_val': 0.5567595648091204, 'psi': 0.9599456307982199}-{'f1_val': 0.692950778765043, 'auprc': 0.9475153579017064, 'loss_val': 0.6196124086949023, 'psi': 0.7947766104197084}
[S7] START round=13 head_norm_before_train=0.835355 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.398291 metrics={'f1_val': 0.5144218034792591, 'auprc': 0.7681779595579477, 'loss_val': 0.9083042728986941, 'psi': 0.6159242659107346}-{'f1_val': 0.3952505877768107, 'auprc': 0.7552367229133212, 'loss_val': 0.9510352549287123, 'psi': 0.539245041831415}
[S8] START round=13 head_norm_before_train=0.902920 cos_to_last_merge=0.9974 (last merge round=11)
[S8] round=13 local utility u=0.043529 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9918479153677427, 'loss_val': 0.5313789491497976, 'psi': 0.8251104667874846}-{'f1_val': 0.7138874667974482, 'auprc': 0.9929314404850238, 'loss_val': 0.6212984508341854, 'psi': 0.8255050562724784}
[S9] START round=13 head_norm_before_train=1.793199 (no previous merge yet)
[S9] round=13 local utility u=0.002176 metrics={'f1_val': 0.9955666097086097, 'auprc': 0.9995780606161804, 'loss_val': 0.03621017227820674, 'psi': 0.997171190071638}-{'f1_val': 0.9953911428861304, 'auprc': 0.9994013165126351, 'loss_val': 0.038979163636383686, 'psi': 0.9969952123367323}
[S10] START round=13 head_norm_before_train=1.560548 (no previous merge yet)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.5765740758399718, 'auprc': 0.8797236310202874, 'loss_val': 0.4146949785549633, 'psi': 0.697833897912098}-{'f1_val': 0.6874565438828282, 'auprc': 0.9570806864222268, 'loss_val': 0.3123830547224873, 'psi': 0.7953062008985876}
[S11] START round=13 head_norm_before_train=1.584492 (no previous merge yet)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.6616379009254256, 'auprc': 0.9954083843707711, 'loss_val': 0.3567376982840677, 'psi': 0.7951460943035638}-{'f1_val': 0.7017589383281313, 'auprc': 0.998442766051439, 'loss_val': 0.26916012547901774, 'psi': 0.8204324694174544}
[S13] START round=13 head_norm_before_train=1.497904 cos_to_last_merge=0.9991 (last merge round=11)
[S13] round=13 local utility u=0.106270 metrics={'f1_val': 0.7047727418374559, 'auprc': 0.7048315973863116, 'loss_val': 0.5940874601720366, 'psi': 0.7047962840569981}-{'f1_val': 0.6631933811149572, 'auprc': 0.7436133001746033, 'loss_val': 0.6734966088024728, 'psi': 0.6953613487388156}
[S14] START round=13 head_norm_before_train=1.593312 (no previous merge yet)
[S14] round=13 local utility u=0.044796 metrics={'f1_val': 0.998352053376932, 'auprc': 0.9974567371088998, 'loss_val': 0.20248257281284968, 'psi': 0.9979939268697191}-{'f1_val': 0.994777261319931, 'auprc': 0.9974682219323125, 'loss_val': 0.27065989708492905, 'psi': 0.9958536455648836}
[S15] START round=13 head_norm_before_train=1.577861 (no previous merge yet)
[S15] round=13 local utility u=0.258102 metrics={'f1_val': 0.7008246444484028, 'auprc': 0.9923156628331915, 'loss_val': 0.2576752834714995, 'psi': 0.8174210518023183}-{'f1_val': 0.7052036647805424, 'auprc': 0.8647741269594982, 'loss_val': 0.4175296657927951, 'psi': 0.7690318496521247}
[S16] START round=13 head_norm_before_train=0.871840 cos_to_last_merge=0.9962 (last merge round=11)
[S16] round=13 local utility u=0.558600 metrics={'f1_val': 0.5226241557032408, 'auprc': 0.7791147524611604, 'loss_val': 0.7003294834341014, 'psi': 0.6252203944064086}-{'f1_val': 0.3595361656340257, 'auprc': 0.7614887189034406, 'loss_val': 0.786122479806185, 'psi': 0.5203171869417917}
[S17] START round=13 head_norm_before_train=1.560854 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.3926864105567096, 'auprc': 0.9195623536990091, 'loss_val': 0.6222035308723207, 'psi': 0.6034367878136294}-{'f1_val': 0.3926864105567096, 'auprc': 0.9366396150646621, 'loss_val': 0.6409388115123996, 'psi': 0.6102676923598906}
[S6] not sending this round → trigger blocked (psi=0.960)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:50303
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:50309
[S3] not sending this round → trigger blocked (psi=0.820)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:50304
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:50316
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S4
[S8] cosine check vs S4: cos=0.8958
[S8] RECEIVED delta(kind=head bytes=1795) from S7
[S8] cosine check vs S7: cos=0.1611
[S4] RECEIVED delta(kind=head bytes=1803) from S16
[S4] cosine check vs S16: cos=0.8260
[S13] RECEIVED delta(kind=head bytes=1794) from S14
[S13] cosine check vs S14: cos=0.9830
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=0.7036
[S16] RECEIVED delta(kind=head bytes=1801) from S8
[S16] cosine check vs S8: cos=0.9507
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] cosine check vs S13: cos=-0.0603
[S16] DROPPED delta from S13 (cos=-0.0603 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S5
[S3] cosine check vs S5: cos=0.2849
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=0.9148
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.7006 head_norm=1.313014
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.391556e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.7018 head_norm=1.167604 delta_norm=0.239156
[S3] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.5144 head_norm=0.877248
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.840008e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.5268 head_norm=1.153947 delta_norm=0.584001
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.5226 head_norm=0.937868
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.481917e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.4511 head_norm=0.931769 delta_norm=0.148192
[S16] aggregate: ROLLBACK (f1_val pre=0.523 post=0.451 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.7140 head_norm=0.949058
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.576916e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.6169 head_norm=0.794961 delta_norm=0.257692
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.617 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6645 head_norm=1.172649
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.308610e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6621 head_norm=1.008901 delta_norm=0.330861
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.7048 head_norm=1.524099
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.537613e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.7048 head_norm=1.568186 delta_norm=0.153761
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.150597 cos_to_last_merge=0.8381 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.838
[S2] round=14 local utility u=0.307564 metrics={'f1_val': 0.6995880223688264, 'auprc': 0.7565886414078953, 'loss_val': 0.4587472306342185, 'psi': 0.7223882699844539}-{'f1_val': 0.6759764624792148, 'auprc': 0.6424471744086887, 'loss_val': 0.5897814907793717, 'psi': 0.6625647472510043}
[S3] START round=14 head_norm_before_train=1.167604 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.7018617609834927, 'auprc': 0.9949406214845364, 'loss_val': 0.334986069607698, 'psi': 0.8190933051839102}-{'f1_val': 0.7006060025002057, 'auprc': 0.9987641064940267, 'loss_val': 0.2968872586170623, 'psi': 0.819869244097734}
[S4] START round=14 head_norm_before_train=1.008901 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.080614 metrics={'f1_val': 0.6650639114217731, 'auprc': 0.9435769177244208, 'loss_val': 0.46439401919230633, 'psi': 0.7764691139428321}-{'f1_val': 0.6645260010920997, 'auprc': 0.89272214216011, 'loss_val': 0.46983120863299327, 'psi': 0.7558044575193038}
[S5] START round=14 head_norm_before_train=1.123228 cos_to_last_merge=0.9903 (last merge round=11)
[S5] round=14 local utility u=0.673853 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9900593495292493, 'loss_val': 0.3225474293382963, 'psi': 0.816216530272048}-{'f1_val': 0.5808755261069142, 'auprc': 0.856029036086368, 'loss_val': 0.5514883320186473, 'psi': 0.6909369300986958}
[S6] START round=14 head_norm_before_train=1.171538 cos_to_last_merge=0.9986 (last merge round=12)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.4166802608918295, 'auprc': 0.7417701775842095, 'loss_val': 0.7768403189681115, 'psi': 0.5467162275687816}-{'f1_val': 0.9578199796363056, 'auprc': 0.9631341075410913, 'loss_val': 0.5567595648091204, 'psi': 0.9599456307982199}
[S7] START round=14 head_norm_before_train=1.153947 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.4339984714987852, 'auprc': 0.7679017092798269, 'loss_val': 0.9307959945372711, 'psi': 0.5675597666112019}-{'f1_val': 0.5144218034792591, 'auprc': 0.7681779595579477, 'loss_val': 0.9083042728986941, 'psi': 0.6159242659107346}
[S8] START round=14 head_norm_before_train=0.794961 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.009162 metrics={'f1_val': 0.7139540394217572, 'auprc': 0.9971354025381064, 'loss_val': 0.5289294570022783, 'psi': 0.8272265846682969}-{'f1_val': 0.7139521677339791, 'auprc': 0.9918479153677427, 'loss_val': 0.5313789491497976, 'psi': 0.8251104667874846}
[S9] START round=14 head_norm_before_train=1.824961 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.9958106265032698, 'auprc': 0.9946717720586717, 'loss_val': 0.03221299760477106, 'psi': 0.9953550847254306}-{'f1_val': 0.9955666097086097, 'auprc': 0.9995780606161804, 'loss_val': 0.03621017227820674, 'psi': 0.997171190071638}
[S10] START round=14 head_norm_before_train=1.592813 (no previous merge yet)
[S10] round=14 local utility u=0.596412 metrics={'f1_val': 0.6881904810151117, 'auprc': 0.9969672837664435, 'loss_val': 0.24330061079957452, 'psi': 0.8117012021156444}-{'f1_val': 0.5765740758399718, 'auprc': 0.8797236310202874, 'loss_val': 0.4146949785549633, 'psi': 0.697833897912098}
[S11] START round=14 head_norm_before_train=1.619282 (no previous merge yet)
[S11] round=14 local utility u=0.195798 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9985177788152677, 'loss_val': 0.21519523557177891, 'psi': 0.8204624745229858}-{'f1_val': 0.6616379009254256, 'auprc': 0.9954083843707711, 'loss_val': 0.3567376982840677, 'psi': 0.7951460943035638}
[S13] START round=14 head_norm_before_train=1.568186 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6661993234948989, 'auprc': 0.686562855177469, 'loss_val': 0.5759461900429587, 'psi': 0.6743447361679269}-{'f1_val': 0.7047727418374559, 'auprc': 0.7048315973863116, 'loss_val': 0.5940874601720366, 'psi': 0.7047962840569981}
[S14] START round=14 head_norm_before_train=1.625676 (no previous merge yet)
[S14] round=14 local utility u=0.019913 metrics={'f1_val': 0.998352053376932, 'auprc': 0.996013920184792, 'loss_val': 0.1583289029137622, 'psi': 0.9974168001000759}-{'f1_val': 0.998352053376932, 'auprc': 0.9974567371088998, 'loss_val': 0.20248257281284968, 'psi': 0.9979939268697191}
[S15] START round=14 head_norm_before_train=1.604910 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.7017086501842441, 'auprc': 0.9875932765281938, 'loss_val': 0.252798362294013, 'psi': 0.8160625007218241}-{'f1_val': 0.7008246444484028, 'auprc': 0.9923156628331915, 'loss_val': 0.2576752834714995, 'psi': 0.8174210518023183}
[S16] START round=14 head_norm_before_train=0.931769 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.43570627037991894, 'auprc': 0.7781414802807958, 'loss_val': 0.7028258915340097, 'psi': 0.5726803543402696}-{'f1_val': 0.5226241557032408, 'auprc': 0.7791147524611604, 'loss_val': 0.7003294834341014, 'psi': 0.6252203944064086}
[S17] START round=14 head_norm_before_train=1.581746 (no previous merge yet)
[S17] round=14 local utility u=0.065794 metrics={'f1_val': 0.40938440486781785, 'auprc': 0.9159809297549948, 'loss_val': 0.5800583509664838, 'psi': 0.6120230148226886}-{'f1_val': 0.3926864105567096, 'auprc': 0.9195623536990091, 'loss_val': 0.6222035308723207, 'psi': 0.6034367878136294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S8] not sending this round → trigger blocked (psi=0.827)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:50311
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.816)
[S4] not sending this round → trigger blocked (psi=0.776)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:50305
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S11
[S10] cosine check vs S11: cos=-0.0293
[S10] DROPPED delta from S11 (cos=-0.0293 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=0.2232
[S5] RECEIVED delta(kind=head bytes=1795) from S2
[S5] cosine check vs S2: cos=0.9017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=-0.0106
[S14] DROPPED delta from S17 (cos=-0.0106 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.4340 head_norm=1.211604
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.958229e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.4167 head_norm=1.113505 delta_norm=0.895823
[S7] aggregate: ROLLBACK (f1_val pre=0.434 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7003 head_norm=1.160665
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.611327e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7003 head_norm=1.146807 delta_norm=0.261133
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.191457 cos_to_last_merge=0.8251 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.825
[S2] round=15 local utility u=0.067797 metrics={'f1_val': 0.700136693919879, 'auprc': 0.7923488620274108, 'loss_val': 0.43372685355788404, 'psi': 0.7370215611628917}-{'f1_val': 0.6995880223688264, 'auprc': 0.7565886414078953, 'loss_val': 0.4587472306342185, 'psi': 0.7223882699844539}
[S3] START round=15 head_norm_before_train=1.222191 cos_to_last_merge=0.9983 (last merge round=13)
[S3] round=15 local utility u=0.046694 metrics={'f1_val': 0.701952049433578, 'auprc': 0.9992085095166517, 'loss_val': 0.2549442629274818, 'psi': 0.8208546334668075}-{'f1_val': 0.7018617609834927, 'auprc': 0.9949406214845364, 'loss_val': 0.334986069607698, 'psi': 0.8190933051839102}
[S4] START round=15 head_norm_before_train=1.057784 cos_to_last_merge=0.9982 (last merge round=13)
[S4] round=15 local utility u=0.847695 metrics={'f1_val': 0.9420913214739868, 'auprc': 0.9578877692292395, 'loss_val': 0.4741017798404727, 'psi': 0.9484099005760879}-{'f1_val': 0.6650639114217731, 'auprc': 0.9435769177244208, 'loss_val': 0.46439401919230633, 'psi': 0.7764691139428321}
[S5] START round=15 head_norm_before_train=1.146807 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9895844111749157, 'loss_val': 0.38781038048405886, 'psi': 0.8160265549303145}-{'f1_val': 0.7003213174339138, 'auprc': 0.9900593495292493, 'loss_val': 0.3225474293382963, 'psi': 0.816216530272048}
[S6] START round=15 head_norm_before_train=1.201393 cos_to_last_merge=0.9952 (last merge round=12)
[S6] round=15 local utility u=1.000000 metrics={'f1_val': 0.9041813434361097, 'auprc': 0.9470469902237327, 'loss_val': 0.4676221086074093, 'psi': 0.9213276021511588}-{'f1_val': 0.4166802608918295, 'auprc': 0.7417701775842095, 'loss_val': 0.7768403189681115, 'psi': 0.5467162275687816}
[S7] START round=15 head_norm_before_train=1.113505 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.877402 metrics={'f1_val': 0.6814565703512601, 'auprc': 0.7860141638778304, 'loss_val': 0.7150785711829473, 'psi': 0.7232796077618882}-{'f1_val': 0.4339984714987852, 'auprc': 0.7679017092798269, 'loss_val': 0.9307959945372711, 'psi': 0.5675597666112019}
[S8] START round=15 head_norm_before_train=0.842532 cos_to_last_merge=0.9968 (last merge round=13)
[S8] round=15 local utility u=0.026784 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9933059238169548, 'loss_val': 0.463861930162529, 'psi': 0.8256936701671693}-{'f1_val': 0.7139540394217572, 'auprc': 0.9971354025381064, 'loss_val': 0.5289294570022783, 'psi': 0.8272265846682969}
[S9] START round=15 head_norm_before_train=1.849933 (no previous merge yet)
[S9] round=15 local utility u=0.004377 metrics={'f1_val': 0.9947358838652685, 'auprc': 0.9995787597310063, 'loss_val': 0.0317321902713166, 'psi': 0.9966730342115636}-{'f1_val': 0.9958106265032698, 'auprc': 0.9946717720586717, 'loss_val': 0.03221299760477106, 'psi': 0.9953550847254306}
[S10] START round=15 head_norm_before_train=1.617653 (no previous merge yet)
[S10] round=15 local utility u=0.041612 metrics={'f1_val': 0.7012767113003361, 'auprc': 0.9901516892661048, 'loss_val': 0.21814707486613671, 'psi': 0.8168267024866436}-{'f1_val': 0.6881904810151117, 'auprc': 0.9969672837664435, 'loss_val': 0.24330061079957452, 'psi': 0.8117012021156444}
[S11] START round=15 head_norm_before_train=1.648417 (no previous merge yet)
[S11] round=15 local utility u=0.014582 metrics={'f1_val': 0.7029092941378408, 'auprc': 0.9984947003157354, 'loss_val': 0.19286410817939958, 'psi': 0.8211434566089986}-{'f1_val': 0.7017589383281313, 'auprc': 0.9985177788152677, 'loss_val': 0.21519523557177891, 'psi': 0.8204624745229858}
[S13] START round=15 head_norm_before_train=1.592393 cos_to_last_merge=0.9995 (last merge round=13)
[S13] round=15 local utility u=0.083599 metrics={'f1_val': 0.6932180910996982, 'auprc': 0.6759130828770439, 'loss_val': 0.5389116340994339, 'psi': 0.6862960878106366}-{'f1_val': 0.6661993234948989, 'auprc': 0.686562855177469, 'loss_val': 0.5759461900429587, 'psi': 0.6743447361679269}
[S14] START round=15 head_norm_before_train=1.661416 (no previous merge yet)
[S14] round=15 local utility u=0.007003 metrics={'f1_val': 0.9952592085101963, 'auprc': 0.9971602559454442, 'loss_val': 0.12920539251626692, 'psi': 0.9960196274842955}-{'f1_val': 0.998352053376932, 'auprc': 0.996013920184792, 'loss_val': 0.1583289029137622, 'psi': 0.9974168001000759}
[S15] START round=15 head_norm_before_train=1.633408 (no previous merge yet)
[S15] round=15 local utility u=0.037590 metrics={'f1_val': 0.701563712906115, 'auprc': 0.9913959299821884, 'loss_val': 0.18815684287215625, 'psi': 0.8174965997365443}-{'f1_val': 0.7017086501842441, 'auprc': 0.9875932765281938, 'loss_val': 0.252798362294013, 'psi': 0.8160625007218241}
[S16] START round=15 head_norm_before_train=0.986664 cos_to_last_merge=0.9978 (last merge round=13)
[S16] round=15 local utility u=0.457265 metrics={'f1_val': 0.5713406242361204, 'auprc': 0.8075638362361213, 'loss_val': 0.6903699618533927, 'psi': 0.6658299090361208}-{'f1_val': 0.43570627037991894, 'auprc': 0.7781414802807958, 'loss_val': 0.7028258915340097, 'psi': 0.5726803543402696}
[S17] START round=15 head_norm_before_train=1.610741 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.40844020527821534, 'auprc': 0.9190484055312802, 'loss_val': 0.6019959237630284, 'psi': 0.6126834853794413}-{'f1_val': 0.40938440486781785, 'auprc': 0.9159809297549948, 'loss_val': 0.5800583509664838, 'psi': 0.6120230148226886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:50309
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:50304
[S11] not sending this round → trigger blocked (psi=0.821)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[S10] not sending this round → trigger blocked (psi=0.817)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:50316
[S2] not sending this round → trigger blocked (psi=0.737)
[S9] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S4
[S8] cosine check vs S4: cos=0.9203
[S8] RECEIVED delta(kind=head bytes=1796) from S7
[S8] cosine check vs S7: cos=0.2168
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] cosine check vs S16: cos=0.9482
[S6] RECEIVED delta(kind=head bytes=1804) from S3
[S6] cosine check vs S3: cos=0.9486
[S16] RECEIVED delta(kind=head bytes=1793) from S8
[S16] cosine check vs S8: cos=0.9506
[S7] RECEIVED delta(kind=head bytes=1805) from S15
[S7] cosine check vs S15: cos=0.5736
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] cosine check vs S6: cos=0.2103
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] cosine check vs S13: cos=-0.0747
[S16] DROPPED delta from S13 (cos=-0.0747 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1804) from S9
[S3] cosine check vs S9: cos=0.8738
[S13] RECEIVED delta(kind=head bytes=1799) from S14
[S13] cosine check vs S14: cos=0.9886
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.297 → S3@127.0.0.1:50303
[S11] ⇄ pheromone p=0.152 → S10@127.0.0.1:50311
[S10] ⇄ pheromone p=0.315 → S7@127.0.0.1:50308
[S2] ⇄ pheromone p=0.194 → S5@127.0.0.1:50305
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.7020 head_norm=1.279730
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.877404e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.9986 head_norm=1.525970 delta_norm=0.487740
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.116 → S6@127.0.0.1:50307
[S15] ⇄ pheromone p=0.161 → S7@127.0.0.1:50308
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6932 head_norm=1.617659
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.317287e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6928 head_norm=1.654116 delta_norm=0.131729
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.200 → S16@127.0.0.1:50316
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.6815 head_norm=1.150923
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.156668e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.6442 head_norm=0.981265 delta_norm=0.515667
[S7] aggregate: ROLLBACK (f1_val pre=0.681 post=0.644 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.332 → S8@127.0.0.1:50309
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.7140 head_norm=0.893727
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.622991e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.7140 head_norm=0.797530 delta_norm=0.262299
[S8] aggregate: ACCEPT kept=['S4', 'S7'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.210 → S16@127.0.0.1:50316
[S14] ⇄ pheromone p=0.216 → S13@127.0.0.1:50313
[S9] ⇄ pheromone p=0.113 → S3@127.0.0.1:50303
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.5713 head_norm=1.038573
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.677872e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.5225 head_norm=0.954221 delta_norm=0.167787
[S16] aggregate: ROLLBACK (f1_val pre=0.571 post=0.522 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.222 → S4@127.0.0.1:50304
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.9042 head_norm=1.233907
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.027846e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.8791 head_norm=1.240563 delta_norm=0.202785
[S6] aggregate: ROLLBACK (f1_val pre=0.904 post=0.879 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.558 → S7@127.0.0.1:50308
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.9421 head_norm=1.108199
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.760571e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.6265 head_norm=1.059421 delta_norm=0.176057
[S4] aggregate: ROLLBACK (f1_val pre=0.942 post=0.627 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.307 → S8@127.0.0.1:50309
[S17] ⇄ pheromone p=0.112 → S14@127.0.0.1:50314
[S2] START round=16 head_norm_before_train=1.235037 cos_to_last_merge=0.8123 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.812
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7018201236037305, 'auprc': 0.7868988162651279, 'loss_val': 0.4460502396751412, 'psi': 0.7358516006682895}-{'f1_val': 0.700136693919879, 'auprc': 0.7923488620274108, 'loss_val': 0.43372685355788404, 'psi': 0.7370215611628917}
[S3] START round=16 head_norm_before_train=1.525970 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.695966 metrics={'f1_val': 0.9269694419987848, 'auprc': 0.9999923573236914, 'loss_val': 0.2154676763197144, 'psi': 0.9561786081287476}-{'f1_val': 0.701952049433578, 'auprc': 0.9992085095166517, 'loss_val': 0.2549442629274818, 'psi': 0.8208546334668075}
[S4] START round=16 head_norm_before_train=1.059421 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.027417 metrics={'f1_val': 0.9445231788185161, 'auprc': 0.9583157634288917, 'loss_val': 0.43514323055024595, 'psi': 0.9500402126626664}-{'f1_val': 0.9420913214739868, 'auprc': 0.9578877692292395, 'loss_val': 0.4741017798404727, 'psi': 0.9484099005760879}
[S5] START round=16 head_norm_before_train=1.177653 cos_to_last_merge=0.9990 (last merge round=14)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.6085360879760393, 'auprc': 0.8558139620446348, 'loss_val': 0.520190448175102, 'psi': 0.7074472376034775}-{'f1_val': 0.7003213174339138, 'auprc': 0.9895844111749157, 'loss_val': 0.38781038048405886, 'psi': 0.8160265549303145}
[S6] START round=16 head_norm_before_train=1.240563 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.8198644282338609, 'auprc': 0.9068787180735315, 'loss_val': 0.5116550097916494, 'psi': 0.8546701441697291}-{'f1_val': 0.9041813434361097, 'auprc': 0.9470469902237327, 'loss_val': 0.4676221086074093, 'psi': 0.9213276021511588}
[S7] START round=16 head_norm_before_train=0.981265 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.549066978700977, 'auprc': 0.7457349690801761, 'loss_val': 0.8330264594103357, 'psi': 0.6277341748526566}-{'f1_val': 0.6814565703512601, 'auprc': 0.7860141638778304, 'loss_val': 0.7150785711829473, 'psi': 0.7232796077618882}
[S8] START round=16 head_norm_before_train=0.797530 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.002726 metrics={'f1_val': 0.7142385069361679, 'auprc': 0.9932362203173942, 'loss_val': 0.4599185564501197, 'psi': 0.8258375922886585}-{'f1_val': 0.7139521677339791, 'auprc': 0.9933059238169548, 'loss_val': 0.463861930162529, 'psi': 0.8256936701671693}
[S9] START round=16 head_norm_before_train=1.869557 (no previous merge yet)
[S9] round=16 local utility u=0.003675 metrics={'f1_val': 0.9955666097086097, 'auprc': 0.9995777782059916, 'loss_val': 0.029363787418471943, 'psi': 0.9971710771075625}-{'f1_val': 0.9947358838652685, 'auprc': 0.9995787597310063, 'loss_val': 0.0317321902713166, 'psi': 0.9966730342115636}
[S10] START round=16 head_norm_before_train=1.642454 (no previous merge yet)
[S10] round=16 local utility u=0.814260 metrics={'f1_val': 0.9559249204692151, 'auprc': 0.9978527324256078, 'loss_val': 0.1406194299682275, 'psi': 0.9726960452517721}-{'f1_val': 0.7012767113003361, 'auprc': 0.9901516892661048, 'loss_val': 0.21814707486613671, 'psi': 0.8168267024866436}
[S11] START round=16 head_norm_before_train=1.670486 (no previous merge yet)
[S11] round=16 local utility u=0.275916 metrics={'f1_val': 0.7938585929952362, 'auprc': 0.9985451210935283, 'loss_val': 0.18687854171863666, 'psi': 0.875733204234553}-{'f1_val': 0.7029092941378408, 'auprc': 0.9984947003157354, 'loss_val': 0.19286410817939958, 'psi': 0.8211434566089986}
[S13] START round=16 head_norm_before_train=1.654116 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6292130471090802, 'auprc': 0.6639954736046576, 'loss_val': 0.6213892089864991, 'psi': 0.6431260177073111}-{'f1_val': 0.6932180910996982, 'auprc': 0.6759130828770439, 'loss_val': 0.5389116340994339, 'psi': 0.6862960878106366}
[S14] START round=16 head_norm_before_train=1.700025 (no previous merge yet)
[S14] round=16 local utility u=0.022710 metrics={'f1_val': 0.9979187620675374, 'auprc': 0.9957255491557491, 'loss_val': 0.0954394709337154, 'psi': 0.997041476902822}-{'f1_val': 0.9952592085101963, 'auprc': 0.9971602559454442, 'loss_val': 0.12920539251626692, 'psi': 0.9960196274842955}
[S15] START round=16 head_norm_before_train=1.659263 (no previous merge yet)
[S15] round=16 local utility u=0.619595 metrics={'f1_val': 0.9012792325678181, 'auprc': 0.992120466166102, 'loss_val': 0.14943411671958678, 'psi': 0.9376157260071316}-{'f1_val': 0.701563712906115, 'auprc': 0.9913959299821884, 'loss_val': 0.18815684287215625, 'psi': 0.8174965997365443}
[S16] START round=16 head_norm_before_train=0.954221 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.880232 metrics={'f1_val': 0.8331074377986252, 'auprc': 0.8381517610557332, 'loss_val': 0.5922705068603508, 'psi': 0.8351251671014683}-{'f1_val': 0.5713406242361204, 'auprc': 0.8075638362361213, 'loss_val': 0.6903699618533927, 'psi': 0.6658299090361208}
[S17] START round=16 head_norm_before_train=1.640538 (no previous merge yet)
[S17] round=16 local utility u=0.574244 metrics={'f1_val': 0.5901063308571086, 'auprc': 0.9260638500697925, 'loss_val': 0.5645509332322505, 'psi': 0.7244893385421822}-{'f1_val': 0.40844020527821534, 'auprc': 0.9190484055312802, 'loss_val': 0.6019959237630284, 'psi': 0.6126834853794413}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:50309
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:50307
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S4
[S8] cosine check vs S4: cos=0.8771
[S6] RECEIVED delta(kind=head bytes=1801) from S3
[S6] cosine check vs S3: cos=0.9425
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] cosine check vs S8: cos=0.9290
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:50303
[S9] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1805) from S9
[S3] cosine check vs S9: cos=0.9729
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:50311
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S11
[S10] cosine check vs S11: cos=-0.0323
[S10] DROPPED delta from S11 (cos=-0.0323 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:50308
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:50304
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:50313
[S10] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S10
[S7] cosine check vs S10: cos=0.4923
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=0.7767
[S13] RECEIVED delta(kind=head bytes=1800) from S14
[S13] cosine check vs S14: cos=0.9949
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=-0.0083
[S14] DROPPED delta from S17 (cos=-0.0083 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] cosine check vs S16: cos=0.9771
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.9270 head_norm=1.566543
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.562945e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.9641 head_norm=1.715159 delta_norm=0.256295
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.9445 head_norm=1.100027
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.223365e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9443 head_norm=1.045616 delta_norm=0.122337
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.5491 head_norm=1.040955
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.919304e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.5739 head_norm=1.092534 delta_norm=0.291930
[S7] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.7142 head_norm=0.845565
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.708138e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.7143 head_norm=0.942963 delta_norm=0.270814
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.8199 head_norm=1.268830
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.815474e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.8217 head_norm=1.397399 delta_norm=0.281547
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6292 head_norm=1.675638
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.058158e-02
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6292 head_norm=1.702445 delta_norm=0.090582
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.8331 head_norm=1.003244
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.905764e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.7969 head_norm=0.907976 delta_norm=0.190576
[S16] aggregate: ROLLBACK (f1_val pre=0.833 post=0.797 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.278483 cos_to_last_merge=0.8011 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.801
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.7132500630495248, 'auprc': 0.7762873330945359, 'loss_val': 0.7632143475019003, 'psi': 0.7384649710675293}-{'f1_val': 0.7018201236037305, 'auprc': 0.7868988162651279, 'loss_val': 0.4460502396751412, 'psi': 0.7358516006682895}
[S3] START round=17 head_norm_before_train=1.715159 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.8678451891634085, 'auprc': 0.8826014378873669, 'loss_val': 0.2976035019446317, 'psi': 0.8737476886529919}-{'f1_val': 0.9269694419987848, 'auprc': 0.9999923573236914, 'loss_val': 0.2154676763197144, 'psi': 0.9561786081287476}
[S4] START round=17 head_norm_before_train=1.045616 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.075486 metrics={'f1_val': 0.9569375721046207, 'auprc': 0.9625674544575263, 'loss_val': 0.3714124918388831, 'psi': 0.9591895250457829}-{'f1_val': 0.9445231788185161, 'auprc': 0.9583157634288917, 'loss_val': 0.43514323055024595, 'psi': 0.9500402126626664}
[S5] START round=17 head_norm_before_train=1.225663 cos_to_last_merge=0.9946 (last merge round=14)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.44958324851811304, 'auprc': 0.8555934479399074, 'loss_val': 0.663130694712255, 'psi': 0.6119873282868308}-{'f1_val': 0.6085360879760393, 'auprc': 0.8558139620446348, 'loss_val': 0.520190448175102, 'psi': 0.7074472376034775}
[S6] START round=17 head_norm_before_train=1.397399 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.092604 metrics={'f1_val': 0.8311878520729212, 'auprc': 0.9385850094210915, 'loss_val': 0.4895060056665262, 'psi': 0.8741467150121893}-{'f1_val': 0.8198644282338609, 'auprc': 0.9068787180735315, 'loss_val': 0.5116550097916494, 'psi': 0.8546701441697291}
[S7] START round=17 head_norm_before_train=1.092534 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.238395 metrics={'f1_val': 0.5877530082858207, 'auprc': 0.7905952379076767, 'loss_val': 0.7229344356885956, 'psi': 0.6688899001345632}-{'f1_val': 0.549066978700977, 'auprc': 0.7457349690801761, 'loss_val': 0.8330264594103357, 'psi': 0.6277341748526566}
[S8] START round=17 head_norm_before_train=0.942963 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.216679 metrics={'f1_val': 0.7640002041677841, 'auprc': 0.9960359180447658, 'loss_val': 0.3335298550187237, 'psi': 0.8568144897185768}-{'f1_val': 0.7142385069361679, 'auprc': 0.9932362203173942, 'loss_val': 0.4599185564501197, 'psi': 0.8258375922886585}
[S9] START round=17 head_norm_before_train=1.887024 (no previous merge yet)
[S9] round=17 local utility u=0.003859 metrics={'f1_val': 0.9962204214526479, 'auprc': 0.9994865020633296, 'loss_val': 0.025295525870192903, 'psi': 0.9975268536969206}-{'f1_val': 0.9955666097086097, 'auprc': 0.9995777782059916, 'loss_val': 0.029363787418471943, 'psi': 0.9971710771075625}
[S10] START round=17 head_norm_before_train=1.666309 (no previous merge yet)
[S10] round=17 local utility u=0.124304 metrics={'f1_val': 0.9938104102480718, 'auprc': 0.9974516915482903, 'loss_val': 0.11812088250510004, 'psi': 0.9952669227681592}-{'f1_val': 0.9559249204692151, 'auprc': 0.9978527324256078, 'loss_val': 0.1406194299682275, 'psi': 0.9726960452517721}
[S11] START round=17 head_norm_before_train=1.689277 (no previous merge yet)
[S11] round=17 local utility u=0.501807 metrics={'f1_val': 0.9561587356364768, 'auprc': 0.9984789991367995, 'loss_val': 0.15686701674013354, 'psi': 0.9730868410366059}-{'f1_val': 0.7938585929952362, 'auprc': 0.9985451210935283, 'loss_val': 0.18687854171863666, 'psi': 0.875733204234553}
[S13] START round=17 head_norm_before_train=1.702445 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6280062193895267, 'auprc': 0.6179801324369267, 'loss_val': 0.6648109305882626, 'psi': 0.6239957846084867}-{'f1_val': 0.6292130471090802, 'auprc': 0.6639954736046576, 'loss_val': 0.6213892089864991, 'psi': 0.6431260177073111}
[S14] START round=17 head_norm_before_train=1.733576 (no previous merge yet)
[S14] round=17 local utility u=0.010261 metrics={'f1_val': 0.9977165309073976, 'auprc': 0.9971582623993798, 'loss_val': 0.07800249315255818, 'psi': 0.9974932235041905}-{'f1_val': 0.9979187620675374, 'auprc': 0.9957255491557491, 'loss_val': 0.0954394709337154, 'psi': 0.997041476902822}
[S15] START round=17 head_norm_before_train=1.685681 (no previous merge yet)
[S15] round=17 local utility u=0.009812 metrics={'f1_val': 0.902630511867109, 'auprc': 0.990719734834901, 'loss_val': 0.13371572748729238, 'psi': 0.9378662010542258}-{'f1_val': 0.9012792325678181, 'auprc': 0.992120466166102, 'loss_val': 0.14943411671958678, 'psi': 0.9376157260071316}
[S16] START round=17 head_norm_before_train=0.907976 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.245200 metrics={'f1_val': 0.887027297484451, 'auprc': 0.8809605602736486, 'loss_val': 0.5538162171806551, 'psi': 0.8846006026001301}-{'f1_val': 0.8331074377986252, 'auprc': 0.8381517610557332, 'loss_val': 0.5922705068603508, 'psi': 0.8351251671014683}
[S17] START round=17 head_norm_before_train=1.668400 (no previous merge yet)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.575702472813292, 'auprc': 0.8627063210287561, 'loss_val': 0.7213106569924606, 'psi': 0.6905040120994776}-{'f1_val': 0.5901063308571086, 'auprc': 0.9260638500697925, 'loss_val': 0.5645509332322505, 'psi': 0.7244893385421822}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:50316
[S8] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S8
[S16] cosine check vs S8: cos=0.9914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] cosine check vs S6: cos=0.2705
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:50311
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S11
[S10] cosine check vs S11: cos=-0.0341
[S10] DROPPED delta from S11 (cos=-0.0341 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:50308
[S9] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] cosine check vs S9: cos=0.9911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S15
[S7] cosine check vs S15: cos=0.7774
[S13] RECEIVED delta(kind=head bytes=1797) from S14
[S13] cosine check vs S14: cos=0.9970
[S4] RECEIVED delta(kind=head bytes=1803) from S16
[S4] cosine check vs S16: cos=0.9730
[S7] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:50309
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=0.6135
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=0.2139
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1792 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S4
[S8] cosine check vs S4: cos=0.9847
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.8678 head_norm=1.751172
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.443892e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.8684 head_norm=1.824114 delta_norm=0.144389
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.5878 head_norm=1.129625
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.538720e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.6130 head_norm=1.027742 delta_norm=0.253872
[S7] aggregate: ACCEPT kept=['S6', 'S15', 'S10'] (k=3/3) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.7640 head_norm=0.996843
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.962993e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.7140 head_norm=0.859631 delta_norm=0.296299
[S8] aggregate: ROLLBACK (f1_val pre=0.764 post=0.714 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9569 head_norm=1.081403
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.320701e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.9573 head_norm=1.016594 delta_norm=0.132070
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.8870 head_norm=0.965599
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.613117e-02
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.8765 head_norm=0.979114 delta_norm=0.066131
[S16] aggregate: ROLLBACK (f1_val pre=0.887 post=0.876 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.6280 head_norm=1.724504
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.056772e-02
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6280 head_norm=1.743343 delta_norm=0.070568
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.318158 cos_to_last_merge=0.7916 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.792
[S2] round=18 local utility u=0.052225 metrics={'f1_val': 0.7132309197125686, 'auprc': 0.7759788457792256, 'loss_val': 0.6577231713125433, 'psi': 0.7383300901392313}-{'f1_val': 0.7132500630495248, 'auprc': 0.7762873330945359, 'loss_val': 0.7632143475019003, 'psi': 0.7384649710675293}
[S3] START round=18 head_norm_before_train=1.824114 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.640960 metrics={'f1_val': 0.9983545917651637, 'auprc': 0.9998300050059027, 'loss_val': 0.15042524890704123, 'psi': 0.9989447570614594}-{'f1_val': 0.8678451891634085, 'auprc': 0.8826014378873669, 'loss_val': 0.2976035019446317, 'psi': 0.8737476886529919}
[S4] START round=18 head_norm_before_train=1.016594 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9428454328962539, 'auprc': 0.9586331095275075, 'loss_val': 0.41457465793923515, 'psi': 0.9491605035487553}-{'f1_val': 0.9569375721046207, 'auprc': 0.9625674544575263, 'loss_val': 0.3714124918388831, 'psi': 0.9591895250457829}
[S5] START round=18 head_norm_before_train=1.270329 cos_to_last_merge=0.9892 (last merge round=14)
[S5] round=18 local utility u=0.977362 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.8955262347672466, 'loss_val': 0.33314710637034395, 'psi': 0.7784546397354597}-{'f1_val': 0.44958324851811304, 'auprc': 0.8555934479399074, 'loss_val': 0.663130694712255, 'psi': 0.6119873282868308}
[S6] START round=18 head_norm_before_train=1.424924 cos_to_last_merge=0.9990 (last merge round=16)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.7980834449677741, 'auprc': 0.9348513072912469, 'loss_val': 0.5125580396277389, 'psi': 0.8527905898971632}-{'f1_val': 0.8311878520729212, 'auprc': 0.9385850094210915, 'loss_val': 0.4895060056665262, 'psi': 0.8741467150121893}
[S7] START round=18 head_norm_before_train=1.027742 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.207223 metrics={'f1_val': 0.6420584020253252, 'auprc': 0.8066350610014282, 'loss_val': 0.6824393885813844, 'psi': 0.7078890656157664}-{'f1_val': 0.5877530082858207, 'auprc': 0.7905952379076767, 'loss_val': 0.7229344356885956, 'psi': 0.6688899001345632}
[S8] START round=18 head_norm_before_train=0.859631 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.7140186993020905, 'auprc': 0.9929252305124927, 'loss_val': 0.37738989359483555, 'psi': 0.8255813117862514}-{'f1_val': 0.7640002041677841, 'auprc': 0.9960359180447658, 'loss_val': 0.3335298550187237, 'psi': 0.8568144897185768}
[S9] START round=18 head_norm_before_train=1.905224 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9926423765407113, 'auprc': 0.9995775497543882, 'loss_val': 0.032646696089513615, 'psi': 0.995416445826182}-{'f1_val': 0.9962204214526479, 'auprc': 0.9994865020633296, 'loss_val': 0.025295525870192903, 'psi': 0.9975268536969206}
[S10] START round=18 head_norm_before_train=1.687055 (no previous merge yet)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9585016899087708, 'auprc': 0.9929683480274774, 'loss_val': 0.1307672739490909, 'psi': 0.9722883531562534}-{'f1_val': 0.9938104102480718, 'auprc': 0.9974516915482903, 'loss_val': 0.11812088250510004, 'psi': 0.9952669227681592}
[S11] START round=18 head_norm_before_train=1.709804 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.9001239574620362, 'auprc': 0.9921286355385321, 'loss_val': 0.35208080216837107, 'psi': 0.9369258286926346}-{'f1_val': 0.9561587356364768, 'auprc': 0.9984789991367995, 'loss_val': 0.15686701674013354, 'psi': 0.9730868410366059}
[S13] START round=18 head_norm_before_train=1.743343 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5757782911749391, 'auprc': 0.6824337857246695, 'loss_val': 0.7837639117572782, 'psi': 0.6184404889948312}-{'f1_val': 0.6280062193895267, 'auprc': 0.6179801324369267, 'loss_val': 0.6648109305882626, 'psi': 0.6239957846084867}
[S14] START round=18 head_norm_before_train=1.764805 (no previous merge yet)
[S14] round=18 local utility u=0.009099 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9971585290672189, 'loss_val': 0.060870092959940635, 'psi': 0.9975997150632165}-{'f1_val': 0.9977165309073976, 'auprc': 0.9971582623993798, 'loss_val': 0.07800249315255818, 'psi': 0.9974932235041905}
[S15] START round=18 head_norm_before_train=1.713657 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.9003349259678374, 'auprc': 0.9912599969436687, 'loss_val': 0.14831511192429847, 'psi': 0.9367049543581698}-{'f1_val': 0.902630511867109, 'auprc': 0.990719734834901, 'loss_val': 0.13371572748729238, 'psi': 0.9378662010542258}
[S16] START round=18 head_norm_before_train=0.979114 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8315373763834419, 'auprc': 0.8849473321740638, 'loss_val': 0.6491436552369775, 'psi': 0.8529013586996907}-{'f1_val': 0.887027297484451, 'auprc': 0.8809605602736486, 'loss_val': 0.5538162171806551, 'psi': 0.8846006026001301}
[S17] START round=18 head_norm_before_train=1.695859 (no previous merge yet)
[S17] round=18 local utility u=0.327952 metrics={'f1_val': 0.6657673118603061, 'auprc': 0.8917193728891732, 'loss_val': 0.6928352823139625, 'psi': 0.756148136271853}-{'f1_val': 0.575702472813292, 'auprc': 0.8627063210287561, 'loss_val': 0.7213106569924606, 'psi': 0.6905040120994776}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:50305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:50309
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S7
[S8] cosine check vs S7: cos=0.4548
[S5] RECEIVED delta(kind=head bytes=1803) from S2
[S5] cosine check vs S2: cos=0.9162
[S6] RECEIVED delta(kind=head bytes=1804) from S3
[S6] cosine check vs S3: cos=0.9458
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:50313
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S14
[S13] cosine check vs S14: cos=0.9977
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:50303
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:50314
[S5] sending update (kind=head size=1806 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1806) from S5
[S3] cosine check vs S5: cos=0.0209
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=-0.0058
[S14] DROPPED delta from S17 (cos=-0.0058 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.7140 head_norm=0.918449
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.199088e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.7142 head_norm=0.844321 delta_norm=0.519909
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.7981 head_norm=1.456368
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.373789e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.7808 head_norm=1.635232 delta_norm=0.337379
[S6] aggregate: ROLLBACK (f1_val pre=0.798 post=0.781 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.9984 head_norm=1.858657
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.123254e+00
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.9984 head_norm=1.145536 delta_norm=1.123254
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7004 head_norm=1.301268
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.728403e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7005 head_norm=1.299268 delta_norm=0.272840
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.5758 head_norm=1.764928
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.245714e-02
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.5761 head_norm=1.779443 delta_norm=0.062457
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.353433 cos_to_last_merge=0.7849 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.785
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.6951788812199772, 'auprc': 0.6572230801132098, 'loss_val': 0.38731977759573605, 'psi': 0.6799965607772702}-{'f1_val': 0.7132309197125686, 'auprc': 0.7759788457792256, 'loss_val': 0.6577231713125433, 'psi': 0.7383300901392313}
[S3] START round=19 head_norm_before_train=1.145536 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.9640279966928462, 'auprc': 0.9990290765723877, 'loss_val': 0.26286691497047177, 'psi': 0.9780284286446628}-{'f1_val': 0.9983545917651637, 'auprc': 0.9998300050059027, 'loss_val': 0.15042524890704123, 'psi': 0.9989447570614594}
[S4] START round=19 head_norm_before_train=1.047305 cos_to_last_merge=0.9993 (last merge round=17)
[S4] round=19 local utility u=0.084064 metrics={'f1_val': 0.9561227682378906, 'auprc': 0.9634240419400069, 'loss_val': 0.34048365480580006, 'psi': 0.9590432777187371}-{'f1_val': 0.9428454328962539, 'auprc': 0.9586331095275075, 'loss_val': 0.41457465793923515, 'psi': 0.9491605035487553}
[S5] START round=19 head_norm_before_train=1.299268 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.133471 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9866449201984553, 'loss_val': 0.3390477869920001, 'psi': 0.8148507585397304}-{'f1_val': 0.7004069097142683, 'auprc': 0.8955262347672466, 'loss_val': 0.33314710637034395, 'psi': 0.7784546397354597}
[S6] START round=19 head_norm_before_train=1.635232 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.7712931957474424, 'auprc': 0.7998393991681247, 'loss_val': 0.565207476223148, 'psi': 0.7827116771157153}-{'f1_val': 0.7980834449677741, 'auprc': 0.9348513072912469, 'loss_val': 0.5125580396277389, 'psi': 0.8527905898971632}
[S7] START round=19 head_norm_before_train=1.059631 cos_to_last_merge=0.9979 (last merge round=17)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.6152166070863397, 'auprc': 0.8046232308836446, 'loss_val': 0.6827714558012581, 'psi': 0.6909792566052617}-{'f1_val': 0.6420584020253252, 'auprc': 0.8066350610014282, 'loss_val': 0.6824393885813844, 'psi': 0.7078890656157664}
[S8] START round=19 head_norm_before_train=0.844321 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.7140186993020905, 'auprc': 0.9970601473631301, 'loss_val': 0.4698487297537161, 'psi': 0.8272352785265064}-{'f1_val': 0.7140186993020905, 'auprc': 0.9929252305124927, 'loss_val': 0.37738989359483555, 'psi': 0.8255813117862514}
[S9] START round=19 head_norm_before_train=1.922157 (no previous merge yet)
[S9] round=19 local utility u=0.012596 metrics={'f1_val': 0.9955666097086097, 'auprc': 0.9995776897560094, 'loss_val': 0.025000613062031173, 'psi': 0.9971710417275695}-{'f1_val': 0.9926423765407113, 'auprc': 0.9995775497543882, 'loss_val': 0.032646696089513615, 'psi': 0.995416445826182}
[S10] START round=19 head_norm_before_train=1.704608 (no previous merge yet)
[S10] round=19 local utility u=0.129941 metrics={'f1_val': 0.994504583556493, 'auprc': 0.9965848959081298, 'loss_val': 0.09775195419598878, 'psi': 0.9953367084971476}-{'f1_val': 0.9585016899087708, 'auprc': 0.9929683480274774, 'loss_val': 0.1307672739490909, 'psi': 0.9722883531562534}
[S11] START round=19 head_norm_before_train=1.730686 (no previous merge yet)
[S11] round=19 local utility u=0.410362 metrics={'f1_val': 0.9978104421256118, 'auprc': 0.998984737445982, 'loss_val': 0.13804470502699423, 'psi': 0.9982801602537599}-{'f1_val': 0.9001239574620362, 'auprc': 0.9921286355385321, 'loss_val': 0.35208080216837107, 'psi': 0.9369258286926346}
[S13] START round=19 head_norm_before_train=1.779443 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.173982 metrics={'f1_val': 0.6143488163997238, 'auprc': 0.6799506588666162, 'loss_val': 0.6597743551557368, 'psi': 0.6405895533864807}-{'f1_val': 0.5757782911749391, 'auprc': 0.6824337857246695, 'loss_val': 0.7837639117572782, 'psi': 0.6184404889948312}
[S14] START round=19 head_norm_before_train=1.796013 (no previous merge yet)
[S14] round=19 local utility u=0.003948 metrics={'f1_val': 0.997673454559638, 'auprc': 0.9971577490960675, 'loss_val': 0.0516489818318844, 'psi': 0.9974671723742098}-{'f1_val': 0.9978938390605482, 'auprc': 0.9971585290672189, 'loss_val': 0.060870092959940635, 'psi': 0.9975997150632165}
[S15] START round=19 head_norm_before_train=1.742816 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.775097560703673, 'auprc': 0.9884609901484921, 'loss_val': 0.19617925584299375, 'psi': 0.8604429324816005}-{'f1_val': 0.9003349259678374, 'auprc': 0.9912599969436687, 'loss_val': 0.14831511192429847, 'psi': 0.9367049543581698}
[S16] START round=19 head_norm_before_train=1.041151 cos_to_last_merge=0.9979 (last merge round=17)
[S16] round=19 local utility u=0.237792 metrics={'f1_val': 0.8714332882890292, 'auprc': 0.9184875000015255, 'loss_val': 0.5135555264633679, 'psi': 0.8902549729740277}-{'f1_val': 0.8315373763834419, 'auprc': 0.8849473321740638, 'loss_val': 0.6491436552369775, 'psi': 0.8529013586996907}
[S17] START round=19 head_norm_before_train=1.720226 (no previous merge yet)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.6240330258812516, 'auprc': 0.8755974390203629, 'loss_val': 0.5143384778937874, 'psi': 0.7246587911368962}-{'f1_val': 0.6657673118603061, 'auprc': 0.8917193728891732, 'loss_val': 0.6928352823139625, 'psi': 0.756148136271853}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:50311
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:50313
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1806) from S11
[S10] cosine check vs S11: cos=-0.0374
[S10] DROPPED delta from S11 (cos=-0.0374 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=0.6528
[S13] RECEIVED delta(kind=head bytes=1795) from S14
[S13] cosine check vs S14: cos=0.9981
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] cosine check vs S16: cos=0.9911
[S16] RECEIVED delta(kind=head bytes=1794) from S13
[S16] cosine check vs S13: cos=-0.0878
[S16] DROPPED delta from S13 (cos=-0.0878 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] cosine check vs S10: cos=0.6035
[S3] RECEIVED delta(kind=head bytes=1795) from S5
[S3] cosine check vs S5: cos=0.5560
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=0.7909
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.783 u=0.0000 p_local=0.2404 f1=0.771 auprc=0.800 bytes=12566
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.7140 head_norm=0.883934
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.191526e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.7424 head_norm=0.894288 delta_norm=0.419153
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.827 u=0.0000 p_local=0.1138 f1=0.714 auprc=0.997 bytes=14384
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.6152 head_norm=1.094062
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.862101e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.6994 head_norm=1.267371 delta_norm=0.686210
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.691 u=0.0000 p_local=0.1998 f1=0.615 auprc=0.805 bytes=16175
[S2] r=20 psi=0.680 u=0.0000 p_local=0.0879 f1=0.695 auprc=0.657 bytes=14361
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.9640 head_norm=1.203128
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.083907e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.9720 head_norm=1.174599 delta_norm=0.108391
[S3] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S3] r=20 psi=0.978 u=0.0000 p_local=0.2215 f1=0.964 auprc=0.999 bytes=16180
[S16] r=20 psi=0.890 u=0.2378 p_local=0.2599 f1=0.871 auprc=0.918 bytes=17987
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.6143 head_norm=1.799461
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.705398e-02
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.6158 head_norm=1.813039 delta_norm=0.057054
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.641 u=0.1740 p_local=0.1168 f1=0.614 auprc=0.680 bytes=16152
[S5] r=20 psi=0.815 u=0.1335 p_local=0.3048 f1=0.700 auprc=0.987 bytes=14365
[S10] r=20 psi=0.995 u=0.1299 p_local=0.2541 f1=0.995 auprc=0.997 bytes=17972
[S14] r=20 psi=0.997 u=0.0039 p_local=0.0943 f1=0.998 auprc=0.997 bytes=21552
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9561 head_norm=1.081452
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.319409e-02
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9563 head_norm=1.087063 delta_norm=0.073194
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.959 u=0.0841 p_local=0.1550 f1=0.956 auprc=0.963 bytes=19772
[S11] r=20 psi=0.998 u=0.4104 p_local=0.2369 f1=0.998 auprc=0.999 bytes=16173
[S9] r=20 psi=0.997 u=0.0126 p_local=0.0498 f1=0.996 auprc=1.000 bytes=18013
[S17] r=20 psi=0.725 u=0.0000 p_local=0.1571 f1=0.624 auprc=0.876 bytes=14381
[S15] r=20 psi=0.860 u=0.0000 p_local=0.1307 f1=0.775 auprc=0.988 bytes=17987
[S2] START round=20 head_norm_before_train=1.381573 cos_to_last_merge=0.7796 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.780
[S2] round=20 local utility u=0.150754 metrics={'f1_val': 0.6998367034125053, 'auprc': 0.7497897507142837, 'loss_val': 0.39145965407010547, 'psi': 0.7198179223332166}-{'f1_val': 0.6951788812199772, 'auprc': 0.6572230801132098, 'loss_val': 0.38731977759573605, 'psi': 0.6799965607772702}
[S3] START round=20 head_norm_before_train=1.174599 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.145333 metrics={'f1_val': 0.9983835929041498, 'auprc': 0.9996593829577143, 'loss_val': 0.18022555671265855, 'psi': 0.9988939089255756}-{'f1_val': 0.9640279966928462, 'auprc': 0.9990290765723877, 'loss_val': 0.26286691497047177, 'psi': 0.9780284286446628}
[S4] START round=20 head_norm_before_train=1.087063 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9417636209840625, 'auprc': 0.9604222126333652, 'loss_val': 0.3610872757916795, 'psi': 0.9492270576437836}-{'f1_val': 0.9561227682378906, 'auprc': 0.9634240419400069, 'loss_val': 0.34048365480580006, 'psi': 0.9590432777187371}
[S5] START round=20 head_norm_before_train=1.330659 cos_to_last_merge=0.9992 (last merge round=18)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8554912914873788, 'loss_val': 0.8526296165061309, 'psi': 0.6042562548981747}-{'f1_val': 0.7003213174339138, 'auprc': 0.9866449201984553, 'loss_val': 0.3390477869920001, 'psi': 0.8148507585397304}
[S6] START round=20 head_norm_before_train=1.660074 cos_to_last_merge=0.9994 (last merge round=18)
[S6] round=20 local utility u=0.345421 metrics={'f1_val': 0.8019027585389478, 'auprc': 0.9376621879986686, 'loss_val': 0.4714910116147028, 'psi': 0.8562065303228361}-{'f1_val': 0.7712931957474424, 'auprc': 0.7998393991681247, 'loss_val': 0.565207476223148, 'psi': 0.7827116771157153}
[S7] START round=20 head_norm_before_train=1.267371 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.5027046148843758, 'auprc': 0.7778771322752948, 'loss_val': 0.8804714413067415, 'psi': 0.6127736218407434}-{'f1_val': 0.6152166070863397, 'auprc': 0.8046232308836446, 'loss_val': 0.6827714558012581, 'psi': 0.6909792566052617}
[S8] START round=20 head_norm_before_train=0.894288 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.953460 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9990140305808213, 'loss_val': 0.26279669593586297, 'psi': 0.9974174571937033}-{'f1_val': 0.7140186993020905, 'auprc': 0.9970601473631301, 'loss_val': 0.4698487297537161, 'psi': 0.8272352785265064}
[S9] START round=20 head_norm_before_train=1.939607 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.987988202094968, 'auprc': 0.9877470711130667, 'loss_val': 0.051644683331449406, 'psi': 0.9878917497022075}-{'f1_val': 0.9955666097086097, 'auprc': 0.9995776897560094, 'loss_val': 0.025000613062031173, 'psi': 0.9971710417275695}
[S10] START round=20 head_norm_before_train=1.719668 (no previous merge yet)
[S10] round=20 local utility u=0.003708 metrics={'f1_val': 0.9953664288144173, 'auprc': 0.9954415825162916, 'loss_val': 0.09207742145552159, 'psi': 0.995396490295167}-{'f1_val': 0.994504583556493, 'auprc': 0.9965848959081298, 'loss_val': 0.09775195419598878, 'psi': 0.9953367084971476}
[S11] START round=20 head_norm_before_train=1.745750 (no previous merge yet)
[S11] round=20 local utility u=0.010775 metrics={'f1_val': 0.9971537809852418, 'auprc': 0.9989111087359077, 'loss_val': 0.11233357646325759, 'psi': 0.9978567120855082}-{'f1_val': 0.9978104421256118, 'auprc': 0.998984737445982, 'loss_val': 0.13804470502699423, 'psi': 0.9982801602537599}
[S13] START round=20 head_norm_before_train=1.813039 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5880569540477361, 'auprc': 0.6724773804240108, 'loss_val': 0.7268852087253702, 'psi': 0.621825124598246}-{'f1_val': 0.6143488163997238, 'auprc': 0.6799506588666162, 'loss_val': 0.6597743551557368, 'psi': 0.6405895533864807}
[S14] START round=20 head_norm_before_train=1.828297 (no previous merge yet)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9969910436891155, 'auprc': 0.9956804934159209, 'loss_val': 0.06048361505883523, 'psi': 0.9964668235798377}-{'f1_val': 0.997673454559638, 'auprc': 0.9971577490960675, 'loss_val': 0.0516489818318844, 'psi': 0.9974671723742098}
[S15] START round=20 head_norm_before_train=1.768711 (no previous merge yet)
[S15] round=20 local utility u=0.747032 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9966497133382722, 'loss_val': 0.058275311360744965, 'psi': 0.9968778427862968}-{'f1_val': 0.775097560703673, 'auprc': 0.9884609901484921, 'loss_val': 0.19617925584299375, 'psi': 0.8604429324816005}
[S16] START round=20 head_norm_before_train=1.097536 cos_to_last_merge=0.9936 (last merge round=17)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8547929676352883, 'auprc': 0.9062105871888226, 'loss_val': 0.599267012048542, 'psi': 0.8753600154567021}-{'f1_val': 0.8714332882890292, 'auprc': 0.9184875000015255, 'loss_val': 0.5135555264633679, 'psi': 0.8902549729740277}
[S17] START round=20 head_norm_before_train=1.741970 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.5778645109302707, 'auprc': 0.7451666700696596, 'loss_val': 0.9314385790710329, 'psi': 0.6447853745860262}-{'f1_val': 0.6240330258812516, 'auprc': 0.8755974390203629, 'loss_val': 0.5143384778937874, 'psi': 0.7246587911368962}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:50307
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:50305
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[S2] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] cosine check vs S10: cos=0.9216
[S5] RECEIVED delta(kind=head bytes=1794) from S2
[S5] cosine check vs S2: cos=0.9632
[S10] RECEIVED delta(kind=head bytes=1802) from S11
[S10] cosine check vs S11: cos=-0.0393
[S10] DROPPED delta from S11 (cos=-0.0393 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] cosine check vs S3: cos=0.8926
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] cosine check vs S6: cos=0.2707
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=0.3646
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] cosine check vs S8: cos=0.9445
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.124 → S8@127.0.0.1:50309
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.5027 head_norm=1.296264
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.368855e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.4771 head_norm=1.138483 delta_norm=0.336886
[S7] aggregate: ROLLBACK (f1_val pre=0.503 post=0.477 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.160 → S8@127.0.0.1:50309
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.4368 head_norm=1.360994
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.890789e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.4368 head_norm=1.370666 delta_norm=0.189079
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.244 → S3@127.0.0.1:50303
[S13] ⇄ pheromone p=0.093 → S16@127.0.0.1:50316
[S9] ⇄ pheromone p=0.040 → S3@127.0.0.1:50303
[S14] ⇄ pheromone p=0.075 → S13@127.0.0.1:50313
[S2] ⇄ pheromone p=0.100 → S5@127.0.0.1:50305
[S3] ⇄ pheromone p=0.206 → S6@127.0.0.1:50307
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.8019 head_norm=1.682398
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.018533e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.8019 head_norm=1.420362 delta_norm=0.401853
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.261 → S7@127.0.0.1:50308
[S10] ⇄ pheromone p=0.204 → S7@127.0.0.1:50308
[S15] ⇄ pheromone p=0.254 → S7@127.0.0.1:50308
[S8] ⇄ pheromone p=0.282 → S16@127.0.0.1:50316
[S11] ⇄ pheromone p=0.192 → S10@127.0.0.1:50311
[S17] ⇄ pheromone p=0.126 → S14@127.0.0.1:50314
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.8548 head_norm=1.151518
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.009853e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.8539 head_norm=1.036885 delta_norm=0.200985
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.208 → S4@127.0.0.1:50304
[S2] START round=21 head_norm_before_train=1.405933 cos_to_last_merge=0.7757 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.776
[S2] round=21 local utility u=0.004728 metrics={'f1_val': 0.7044840021221043, 'auprc': 0.767902529435249, 'loss_val': 0.4642250184469591, 'psi': 0.7298514130473621}-{'f1_val': 0.6998367034125053, 'auprc': 0.7497897507142837, 'loss_val': 0.39145965407010547, 'psi': 0.7198179223332166}
[S3] START round=21 head_norm_before_train=1.235867 cos_to_last_merge=0.9980 (last merge round=19)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.9356728806914578, 'auprc': 0.9985977219984445, 'loss_val': 0.23069030277558278, 'psi': 0.9608428172142525}-{'f1_val': 0.9983835929041498, 'auprc': 0.9996593829577143, 'loss_val': 0.18022555671265855, 'psi': 0.9988939089255756}
[S4] START round=21 head_norm_before_train=1.120296 cos_to_last_merge=0.9995 (last merge round=19)
[S4] round=21 local utility u=0.056659 metrics={'f1_val': 0.9494922347809454, 'auprc': 0.9669404249324174, 'loss_val': 0.31369611989019525, 'psi': 0.9564715108415343}-{'f1_val': 0.9417636209840625, 'auprc': 0.9604222126333652, 'loss_val': 0.3610872757916795, 'psi': 0.9492270576437836}
[S5] START round=21 head_norm_before_train=1.370666 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.118313 metrics={'f1_val': 0.44840197951749333, 'auprc': 0.8529992683819074, 'loss_val': 0.6783425927377053, 'psi': 0.610240895063259}-{'f1_val': 0.43676623050537206, 'auprc': 0.8554912914873788, 'loss_val': 0.8526296165061309, 'psi': 0.6042562548981747}
[S6] START round=21 head_norm_before_train=1.420362 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.102406 metrics={'f1_val': 0.8222358033584412, 'auprc': 0.9486749043233361, 'loss_val': 0.4217161905617511, 'psi': 0.8728114437443991}-{'f1_val': 0.8019027585389478, 'auprc': 0.9376621879986686, 'loss_val': 0.4714910116147028, 'psi': 0.8562065303228361}
[S7] START round=21 head_norm_before_train=1.138483 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=1.000000 metrics={'f1_val': 0.6988766735852125, 'auprc': 0.9901444302430877, 'loss_val': 0.46396199303576563, 'psi': 0.8153837762483627}-{'f1_val': 0.5027046148843758, 'auprc': 0.7778771322752948, 'loss_val': 0.8804714413067415, 'psi': 0.6127736218407434}
[S8] START round=21 head_norm_before_train=0.951346 cos_to_last_merge=0.9973 (last merge round=19)
[S8] round=21 local utility u=0.019817 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.996313302418388, 'loss_val': 0.21416005023843665, 'psi': 0.9962471830074469}-{'f1_val': 0.9963530749356245, 'auprc': 0.9990140305808213, 'loss_val': 0.26279669593586297, 'psi': 0.9974174571937033}
[S9] START round=21 head_norm_before_train=1.956318 (no previous merge yet)
[S9] round=21 local utility u=0.057114 metrics={'f1_val': 0.9963953425060355, 'auprc': 0.9993600563591954, 'loss_val': 0.022698253643427077, 'psi': 0.9975812280472995}-{'f1_val': 0.987988202094968, 'auprc': 0.9877470711130667, 'loss_val': 0.051644683331449406, 'psi': 0.9878917497022075}
[S10] START round=21 head_norm_before_train=1.733792 (no previous merge yet)
[S10] round=21 local utility u=0.007773 metrics={'f1_val': 0.995829755538387, 'auprc': 0.9951933278034805, 'loss_val': 0.07856601175431385, 'psi': 0.9955751844444244}-{'f1_val': 0.9953664288144173, 'auprc': 0.9954415825162916, 'loss_val': 0.09207742145552159, 'psi': 0.995396490295167}
[S11] START round=21 head_norm_before_train=1.764611 (no previous merge yet)
[S11] round=21 local utility u=0.003765 metrics={'f1_val': 0.9969812955738739, 'auprc': 0.9989851926760122, 'loss_val': 0.10399179655639458, 'psi': 0.9977828544147291}-{'f1_val': 0.9971537809852418, 'auprc': 0.9989111087359077, 'loss_val': 0.11233357646325759, 'psi': 0.9978567120855082}
[S13] START round=21 head_norm_before_train=1.832114 cos_to_last_merge=0.9998 (last merge round=19)
[S13] round=21 local utility u=0.084226 metrics={'f1_val': 0.6039262318527546, 'auprc': 0.6602111245373546, 'loss_val': 0.6168499106206782, 'psi': 0.6264401889265947}-{'f1_val': 0.5880569540477361, 'auprc': 0.6724773804240108, 'loss_val': 0.7268852087253702, 'psi': 0.621825124598246}
[S14] START round=21 head_norm_before_train=1.858031 (no previous merge yet)
[S14] round=21 local utility u=0.012518 metrics={'f1_val': 0.9970456931804658, 'auprc': 0.9971561375450443, 'loss_val': 0.040202834472731805, 'psi': 0.9970898709262972}-{'f1_val': 0.9969910436891155, 'auprc': 0.9956804934159209, 'loss_val': 0.06048361505883523, 'psi': 0.9964668235798377}
[S15] START round=21 head_norm_before_train=1.792292 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.9027338531963423, 'auprc': 0.9953572904660682, 'loss_val': 0.12004866507315962, 'psi': 0.9397832281042326}-{'f1_val': 0.9970299290849798, 'auprc': 0.9966497133382722, 'loss_val': 0.058275311360744965, 'psi': 0.9968778427862968}
[S16] START round=21 head_norm_before_train=1.036885 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.134899 metrics={'f1_val': 0.8479422184334424, 'auprc': 0.9365322872758212, 'loss_val': 0.3793301778147764, 'psi': 0.8833782459703938}-{'f1_val': 0.8547929676352883, 'auprc': 0.9062105871888226, 'loss_val': 0.599267012048542, 'psi': 0.8753600154567021}
[S17] START round=21 head_norm_before_train=1.760002 (no previous merge yet)
[S17] round=21 local utility u=0.408521 metrics={'f1_val': 0.6038754299287246, 'auprc': 0.9259033119685939, 'loss_val': 0.8126724962065176, 'psi': 0.7326865827446722}-{'f1_val': 0.5778645109302707, 'auprc': 0.7451666700696596, 'loss_val': 0.9314385790710329, 'psi': 0.6447853745860262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:50303
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:50313
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:50309
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] cosine check vs S2: cos=0.9844
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=0.4317
[S13] RECEIVED delta(kind=head bytes=1797) from S14
[S13] cosine check vs S14: cos=0.9971
[S4] RECEIVED delta(kind=head bytes=1793) from S16
[S4] cosine check vs S16: cos=0.9808
[S8] RECEIVED delta(kind=head bytes=1795) from S7
[S8] cosine check vs S7: cos=0.4015
[S10] RECEIVED delta(kind=head bytes=1798) from S11
[S10] cosine check vs S11: cos=-0.0414
[S10] DROPPED delta from S11 (cos=-0.0414 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S9
[S3] cosine check vs S9: cos=0.8080
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=0.5217
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=0.8145
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] cosine check vs S13: cos=-0.0772
[S16] DROPPED delta from S13 (cos=-0.0772 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S8
[S16] cosine check vs S8: cos=0.9769
[S8] RECEIVED delta(kind=head bytes=1797) from S4
[S8] cosine check vs S4: cos=0.9341
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=-0.0055
[S14] DROPPED delta from S17 (cos=-0.0055 < 0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.9357 head_norm=1.279746
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.341843e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.9633 head_norm=1.226232 delta_norm=0.134184
[S3] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.4484 head_norm=1.405323
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.256202e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.5456 head_norm=1.411595 delta_norm=0.125620
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.6039 head_norm=1.850518
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.262482e-02
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.6054 head_norm=1.865316 delta_norm=0.072625
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.8479 head_norm=1.088989
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.201190e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8482 head_norm=1.040304 delta_norm=0.120119
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9495 head_norm=1.153556
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.144061e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9497 head_norm=1.115888 delta_norm=0.114406
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.6989 head_norm=1.172678
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.995773e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.6989 head_norm=1.135521 delta_norm=0.299577
[S7] aggregate: ACCEPT kept=['S6', 'S10'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9962 head_norm=1.003706
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.346518e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9962 head_norm=0.912205 delta_norm=0.234652
[S8] aggregate: ACCEPT kept=['S7', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.428925 cos_to_last_merge=0.7723 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.772
[S2] round=22 local utility u=0.031579 metrics={'f1_val': 0.7073736171575752, 'auprc': 0.7884801035994952, 'loss_val': 0.4801367154448154, 'psi': 0.7398162117343432}-{'f1_val': 0.7044840021221043, 'auprc': 0.767902529435249, 'loss_val': 0.4642250184469591, 'psi': 0.7298514130473621}
[S3] START round=22 head_norm_before_train=1.226232 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.711347636850149, 'auprc': 0.9997323280986337, 'loss_val': 0.24588923843472976, 'psi': 0.8267015133495428}-{'f1_val': 0.9356728806914578, 'auprc': 0.9985977219984445, 'loss_val': 0.23069030277558278, 'psi': 0.9608428172142525}
[S4] START round=22 head_norm_before_train=1.115888 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9491100150877805, 'auprc': 0.9653908909563887, 'loss_val': 0.31545903801669023, 'psi': 0.9556223654352238}-{'f1_val': 0.9494922347809454, 'auprc': 0.9669404249324174, 'loss_val': 0.31369611989019525, 'psi': 0.9564715108415343}
[S5] START round=22 head_norm_before_train=1.411595 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=1.000000 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.984747856741523, 'loss_val': 0.27927029760615596, 'psi': 0.8142472934150135}-{'f1_val': 0.44840197951749333, 'auprc': 0.8529992683819074, 'loss_val': 0.6783425927377053, 'psi': 0.610240895063259}
[S6] START round=22 head_norm_before_train=1.444583 cos_to_last_merge=0.9995 (last merge round=20)
[S6] round=22 local utility u=0.509289 metrics={'f1_val': 0.9605944185011686, 'auprc': 0.962966385283588, 'loss_val': 0.27616333678184124, 'psi': 0.9615432052141364}-{'f1_val': 0.8222358033584412, 'auprc': 0.9486749043233361, 'loss_val': 0.4217161905617511, 'psi': 0.8728114437443991}
[S7] START round=22 head_norm_before_train=1.135521 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.6191243081684799, 'auprc': 0.8093789141941516, 'loss_val': 0.7355773442940499, 'psi': 0.6952261505787486}-{'f1_val': 0.6988766735852125, 'auprc': 0.9901444302430877, 'loss_val': 0.46396199303576563, 'psi': 0.8153837762483627}
[S8] START round=22 head_norm_before_train=0.912205 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9970843903944107, 'loss_val': 0.2550934938527947, 'psi': 0.996555618197856}-{'f1_val': 0.9962031034001528, 'auprc': 0.996313302418388, 'loss_val': 0.21416005023843665, 'psi': 0.9962471830074469}
[S9] START round=22 head_norm_before_train=1.965976 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9962204214526479, 'auprc': 0.9972325690384227, 'loss_val': 0.022679234000085837, 'psi': 0.9966252804869578}-{'f1_val': 0.9963953425060355, 'auprc': 0.9993600563591954, 'loss_val': 0.022698253643427077, 'psi': 0.9975812280472995}
[S10] START round=22 head_norm_before_train=1.746388 (no previous merge yet)
[S10] round=22 local utility u=0.002845 metrics={'f1_val': 0.9954570659705484, 'auprc': 0.9953375864845592, 'loss_val': 0.07107192212070984, 'psi': 0.9954092741761528}-{'f1_val': 0.995829755538387, 'auprc': 0.9951933278034805, 'loss_val': 0.07856601175431385, 'psi': 0.9955751844444244}
[S11] START round=22 head_norm_before_train=1.787341 (no previous merge yet)
[S11] round=22 local utility u=0.010702 metrics={'f1_val': 0.9967394579561065, 'auprc': 0.9989233745722227, 'loss_val': 0.08095171800908756, 'psi': 0.997613024602553}-{'f1_val': 0.9969812955738739, 'auprc': 0.9989851926760122, 'loss_val': 0.10399179655639458, 'psi': 0.9977828544147291}
[S13] START round=22 head_norm_before_train=1.865316 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5526173908027223, 'auprc': 0.7101580212694409, 'loss_val': 0.8613336093736932, 'psi': 0.6156336429894098}-{'f1_val': 0.6039262318527546, 'auprc': 0.6602111245373546, 'loss_val': 0.6168499106206782, 'psi': 0.6264401889265947}
[S14] START round=22 head_norm_before_train=1.882800 (no previous merge yet)
[S14] round=22 local utility u=0.001797 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9970620873532038, 'loss_val': 0.03749505757445972, 'psi': 0.9971690489647573}-{'f1_val': 0.9970456931804658, 'auprc': 0.9971561375450443, 'loss_val': 0.040202834472731805, 'psi': 0.9970898709262972}
[S15] START round=22 head_norm_before_train=1.815395 (no previous merge yet)
[S15] round=22 local utility u=0.010126 metrics={'f1_val': 0.9040558810671149, 'auprc': 0.9934013340474698, 'loss_val': 0.10186016509157557, 'psi': 0.9397940622592569}-{'f1_val': 0.9027338531963423, 'auprc': 0.9953572904660682, 'loss_val': 0.12004866507315962, 'psi': 0.9397832281042326}
[S16] START round=22 head_norm_before_train=1.040304 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.286749 metrics={'f1_val': 0.9265168493650977, 'auprc': 0.959599550165128, 'loss_val': 0.3464822109298412, 'psi': 0.9397499296851098}-{'f1_val': 0.8479422184334424, 'auprc': 0.9365322872758212, 'loss_val': 0.3793301778147764, 'psi': 0.8833782459703938}
[S17] START round=22 head_norm_before_train=1.777430 (no previous merge yet)
[S17] round=22 local utility u=0.113650 metrics={'f1_val': 0.6200022131450884, 'auprc': 0.916164492559207, 'loss_val': 0.6529176426925715, 'psi': 0.7384671249107359}-{'f1_val': 0.6038754299287246, 'auprc': 0.9259033119685939, 'loss_val': 0.8126724962065176, 'psi': 0.7326865827446722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:50305
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:50308
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:50311
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:50308
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:50304
[S16] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1795) from S11
[S10] cosine check vs S11: cos=-0.0433
[S10] DROPPED delta from S11 (cos=-0.0433 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=0.5280
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=0.3102
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] cosine check vs S16: cos=0.9835
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] cosine check vs S2: cos=0.9913
[S7] RECEIVED delta(kind=head bytes=1804) from S10
[S7] cosine check vs S10: cos=0.8213
[S13] RECEIVED delta(kind=head bytes=1799) from S14
[S13] cosine check vs S14: cos=0.9985
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] cosine check vs S6: cos=0.5681
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S17
[S14] cosine check vs S17: cos=-0.0042
[S14] DROPPED delta from S17 (cos=-0.0042 < 0.0)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.6191 head_norm=1.157845
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.260827e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.6147 head_norm=1.072397 delta_norm=0.226083
[S7] aggregate: ACCEPT kept=['S15', 'S10', 'S6'] (k=3/3) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9491 head_norm=1.152411
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.057697e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9491 head_norm=1.120140 delta_norm=0.105770
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.7113 head_norm=1.276299
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.648874e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.8847 head_norm=1.189715 delta_norm=0.664887
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.5526 head_norm=1.880545
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.247041e-02
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.5585 head_norm=1.891094 delta_norm=0.052470
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7006 head_norm=1.444317
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.546785e-02
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7268 head_norm=1.442979 delta_norm=0.095468
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.447948 cos_to_last_merge=0.7700 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.770
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.6090681788427581, 'auprc': 0.7382741668604458, 'loss_val': 0.6925846104736065, 'psi': 0.6607505740498332}-{'f1_val': 0.7073736171575752, 'auprc': 0.7884801035994952, 'loss_val': 0.4801367154448154, 'psi': 0.7398162117343432}
[S3] START round=23 head_norm_before_train=1.189715 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.734863 metrics={'f1_val': 0.9607804860280988, 'auprc': 0.9991133226176386, 'loss_val': 0.27090358384318036, 'psi': 0.9761136206639147}-{'f1_val': 0.711347636850149, 'auprc': 0.9997323280986337, 'loss_val': 0.24588923843472976, 'psi': 0.8267015133495428}
[S4] START round=23 head_norm_before_train=1.120140 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9469007439532153, 'auprc': 0.9657793672179465, 'loss_val': 0.31512132998725845, 'psi': 0.9544521932591078}-{'f1_val': 0.9491100150877805, 'auprc': 0.9653908909563887, 'loss_val': 0.31545903801669023, 'psi': 0.9556223654352238}
[S5] START round=23 head_norm_before_train=1.442979 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.937382429318611, 'loss_val': 0.3584051431288543, 'psi': 0.7951457621877926}-{'f1_val': 0.7005802511973405, 'auprc': 0.984747856741523, 'loss_val': 0.27927029760615596, 'psi': 0.8142472934150135}
[S6] START round=23 head_norm_before_train=1.471003 cos_to_last_merge=0.9980 (last merge round=20)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.7286578091927454, 'auprc': 0.7932156866148302, 'loss_val': 0.5936498822989815, 'psi': 0.7544809601615794}-{'f1_val': 0.9605944185011686, 'auprc': 0.962966385283588, 'loss_val': 0.27616333678184124, 'psi': 0.9615432052141364}
[S7] START round=23 head_norm_before_train=1.072397 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.40206653395721154, 'auprc': 0.7725121591574822, 'loss_val': 1.0258124288551813, 'psi': 0.5502447840373198}-{'f1_val': 0.6191243081684799, 'auprc': 0.8093789141941516, 'loss_val': 0.7355773442940499, 'psi': 0.6952261505787486}
[S8] START round=23 head_norm_before_train=0.961711 cos_to_last_merge=0.9985 (last merge round=21)
[S8] round=23 local utility u=0.023275 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9976081235455266, 'loss_val': 0.21011398306754708, 'psi': 0.9967651114583024}-{'f1_val': 0.9962031034001528, 'auprc': 0.9970843903944107, 'loss_val': 0.2550934938527947, 'psi': 0.996555618197856}
[S9] START round=23 head_norm_before_train=1.976636 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9900883575735152, 'auprc': 0.9986763953142821, 'loss_val': 0.036950813546483205, 'psi': 0.9935235726698219}-{'f1_val': 0.9962204214526479, 'auprc': 0.9972325690384227, 'loss_val': 0.022679234000085837, 'psi': 0.9966252804869578}
[S10] START round=23 head_norm_before_train=1.761603 (no previous merge yet)
[S10] round=23 local utility u=0.001022 metrics={'f1_val': 0.99518893327964, 'auprc': 0.9946260508207176, 'loss_val': 0.06528384332191718, 'psi': 0.994963780296071}-{'f1_val': 0.9954570659705484, 'auprc': 0.9953375864845592, 'loss_val': 0.07107192212070984, 'psi': 0.9954092741761528}
[S11] START round=23 head_norm_before_train=1.809268 (no previous merge yet)
[S11] round=23 local utility u=0.003607 metrics={'f1_val': 0.9970052357155487, 'auprc': 0.9993963591253644, 'loss_val': 0.07675194575226206, 'psi': 0.997961685079475}-{'f1_val': 0.9967394579561065, 'auprc': 0.9989233745722227, 'loss_val': 0.08095171800908756, 'psi': 0.997613024602553}
[S13] START round=23 head_norm_before_train=1.891094 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.329802 metrics={'f1_val': 0.6224748064119395, 'auprc': 0.7217039349641825, 'loss_val': 0.655511204446814, 'psi': 0.6621664578328368}-{'f1_val': 0.5526173908027223, 'auprc': 0.7101580212694409, 'loss_val': 0.8613336093736932, 'psi': 0.6156336429894098}
[S14] START round=23 head_norm_before_train=1.903031 (no previous merge yet)
[S14] round=23 local utility u=0.000899 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9970794685067594, 'loss_val': 0.035748249354244456, 'psi': 0.9971760014261797}-{'f1_val': 0.997240356705793, 'auprc': 0.9970620873532038, 'loss_val': 0.03749505757445972, 'psi': 0.9971690489647573}
[S15] START round=23 head_norm_before_train=1.838108 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.8913044320944368, 'auprc': 0.9889945890009717, 'loss_val': 0.17012675058480542, 'psi': 0.9303804948570507}-{'f1_val': 0.9040558810671149, 'auprc': 0.9934013340474698, 'loss_val': 0.10186016509157557, 'psi': 0.9397940622592569}
[S16] START round=23 head_norm_before_train=1.097156 cos_to_last_merge=0.9988 (last merge round=21)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8249485332794265, 'auprc': 0.8364179051439619, 'loss_val': 0.7828125402023277, 'psi': 0.8295362820252407}-{'f1_val': 0.9265168493650977, 'auprc': 0.959599550165128, 'loss_val': 0.3464822109298412, 'psi': 0.9397499296851098}
[S17] START round=23 head_norm_before_train=1.792967 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.5719886333314134, 'auprc': 0.8082762699354866, 'loss_val': 1.0352272799572384, 'psi': 0.6665036879730427}-{'f1_val': 0.6200022131450884, 'auprc': 0.916164492559207, 'loss_val': 0.6529176426925715, 'psi': 0.7384671249107359}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:50311
[S14] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S8
[S16] cosine check vs S8: cos=0.9572
[S13] RECEIVED delta(kind=head bytes=1801) from S14
[S13] cosine check vs S14: cos=0.9992
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=-0.0730
[S16] DROPPED delta from S13 (cos=-0.0730 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S11
[S10] cosine check vs S11: cos=-0.0449
[S10] DROPPED delta from S11 (cos=-0.0449 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S3
[S6] cosine check vs S3: cos=0.7133
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=0.7306
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.7287 head_norm=1.495612
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.303140e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.7258 head_norm=1.261898 delta_norm=0.530314
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.4021 head_norm=1.097137
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.164877e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.4554 head_norm=1.344514 delta_norm=0.616488
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.6225 head_norm=1.904262
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.972925e-02
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.6246 head_norm=1.910865 delta_norm=0.039729
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.8249 head_norm=1.153949
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.736061e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.8247 head_norm=1.070427 delta_norm=0.173606
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.465334 cos_to_last_merge=0.7678 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.768
[S2] round=24 local utility u=0.336958 metrics={'f1_val': 0.707146408563571, 'auprc': 0.7736326099648941, 'loss_val': 0.713212611598241, 'psi': 0.7337408891241003}-{'f1_val': 0.6090681788427581, 'auprc': 0.7382741668604458, 'loss_val': 0.6925846104736065, 'psi': 0.6607505740498332}
[S3] START round=24 head_norm_before_train=1.228977 cos_to_last_merge=0.9983 (last merge round=22)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.791986934743202, 'auprc': 0.9985255703480087, 'loss_val': 0.4194566092517974, 'psi': 0.8746023889851247}-{'f1_val': 0.9607804860280988, 'auprc': 0.9991133226176386, 'loss_val': 0.27090358384318036, 'psi': 0.9761136206639147}
[S4] START round=24 head_norm_before_train=1.163473 cos_to_last_merge=0.9990 (last merge round=22)
[S4] round=24 local utility u=0.015768 metrics={'f1_val': 0.9482476881798176, 'auprc': 0.9641854575346718, 'loss_val': 0.28688446817210345, 'psi': 0.9546227959217592}-{'f1_val': 0.9469007439532153, 'auprc': 0.9657793672179465, 'loss_val': 0.31512132998725845, 'psi': 0.9544521932591078}
[S5] START round=24 head_norm_before_train=1.473940 cos_to_last_merge=0.9987 (last merge round=22)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.43617722397947545, 'auprc': 0.8548807898330225, 'loss_val': 1.0336649510050036, 'psi': 0.6036586503208943}-{'f1_val': 0.7003213174339138, 'auprc': 0.937382429318611, 'loss_val': 0.3584051431288543, 'psi': 0.7951457621877926}
[S6] START round=24 head_norm_before_train=1.261898 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=1.000000 metrics={'f1_val': 0.9395337754186742, 'auprc': 0.9586376714099952, 'loss_val': 0.33880289559231797, 'psi': 0.9471753338152027}-{'f1_val': 0.7286578091927454, 'auprc': 0.7932156866148302, 'loss_val': 0.5936498822989815, 'psi': 0.7544809601615794}
[S7] START round=24 head_norm_before_train=1.344514 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=1.000000 metrics={'f1_val': 0.6987021783540206, 'auprc': 0.9203436625496353, 'loss_val': 0.5184563359483884, 'psi': 0.7873587720322665}-{'f1_val': 0.40206653395721154, 'auprc': 0.7725121591574822, 'loss_val': 1.0258124288551813, 'psi': 0.5502447840373198}
[S8] START round=24 head_norm_before_train=1.010103 cos_to_last_merge=0.9950 (last merge round=21)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9938004979256806, 'auprc': 0.9929792231170516, 'loss_val': 0.19152440047406086, 'psi': 0.9934719880022289}-{'f1_val': 0.9962031034001528, 'auprc': 0.9976081235455266, 'loss_val': 0.21011398306754708, 'psi': 0.9967651114583024}
[S9] START round=24 head_norm_before_train=1.983602 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9892428323638103, 'auprc': 0.9951001264430153, 'loss_val': 0.04081783282308039, 'psi': 0.9915857499954923}-{'f1_val': 0.9900883575735152, 'auprc': 0.9986763953142821, 'loss_val': 0.036950813546483205, 'psi': 0.9935235726698219}
[S10] START round=24 head_norm_before_train=1.780967 (no previous merge yet)
[S10] round=24 local utility u=0.003945 metrics={'f1_val': 0.9954570659705484, 'auprc': 0.9944249472346797, 'loss_val': 0.058400032671698916, 'psi': 0.995044218476201}-{'f1_val': 0.99518893327964, 'auprc': 0.9946260508207176, 'loss_val': 0.06528384332191718, 'psi': 0.994963780296071}
[S11] START round=24 head_norm_before_train=1.830395 (no previous merge yet)
[S11] round=24 local utility u=0.007520 metrics={'f1_val': 0.9965882633272201, 'auprc': 0.9993296194810632, 'loss_val': 0.05900946100401201, 'psi': 0.9976848057887573}-{'f1_val': 0.9970052357155487, 'auprc': 0.9993963591253644, 'loss_val': 0.07675194575226206, 'psi': 0.997961685079475}
[S13] START round=24 head_norm_before_train=1.910865 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5784607831627749, 'auprc': 0.7055409124380111, 'loss_val': 0.7782765440858291, 'psi': 0.6292928348728695}-{'f1_val': 0.6224748064119395, 'auprc': 0.7217039349641825, 'loss_val': 0.655511204446814, 'psi': 0.6621664578328368}
[S14] START round=24 head_norm_before_train=1.918268 (no previous merge yet)
[S14] round=24 local utility u=0.001700 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971256407618598, 'loss_val': 0.03248689924997937, 'psi': 0.9971944703282198}-{'f1_val': 0.997240356705793, 'auprc': 0.9970794685067594, 'loss_val': 0.035748249354244456, 'psi': 0.9971760014261797}
[S15] START round=24 head_norm_before_train=1.862336 (no previous merge yet)
[S15] round=24 local utility u=0.391642 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9976981713868812, 'loss_val': 0.047307317580082775, 'psi': 0.9972972260057403}-{'f1_val': 0.8913044320944368, 'auprc': 0.9889945890009717, 'loss_val': 0.17012675058480542, 'psi': 0.9303804948570507}
[S16] START round=24 head_norm_before_train=1.070427 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.892242 metrics={'f1_val': 0.9662830528980169, 'auprc': 0.975640012226063, 'loss_val': 0.2640012317835697, 'psi': 0.9700258366292354}-{'f1_val': 0.8249485332794265, 'auprc': 0.8364179051439619, 'loss_val': 0.7828125402023277, 'psi': 0.8295362820252407}
[S17] START round=24 head_norm_before_train=1.809753 (no previous merge yet)
[S17] round=24 local utility u=0.341216 metrics={'f1_val': 0.6045982742428119, 'auprc': 0.876919067288298, 'loss_val': 0.7543818740133647, 'psi': 0.7135265914610064}-{'f1_val': 0.5719886333314134, 'auprc': 0.8082762699354866, 'loss_val': 1.0352272799572384, 'psi': 0.6665036879730427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:50304
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:50309
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:50313
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:50311
[S4] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=0.2218
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=0.9543
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=0.9881
[S7] RECEIVED delta(kind=head bytes=1796) from S15
[S7] cosine check vs S15: cos=0.2450
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] cosine check vs S7: cos=0.4229
[S10] RECEIVED delta(kind=head bytes=1799) from S11
[S10] cosine check vs S11: cos=-0.0467
[S10] DROPPED delta from S11 (cos=-0.0467 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S4
[S8] cosine check vs S4: cos=0.9305
[S13] RECEIVED delta(kind=head bytes=1800) from S14
[S13] cosine check vs S14: cos=0.9995
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] cosine check vs S16: cos=0.9746
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S17
[S14] cosine check vs S17: cos=-0.0038
[S14] DROPPED delta from S17 (cos=-0.0038 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.5785 head_norm=1.923934
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.207952e-02
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.5799 head_norm=1.928697 delta_norm=0.032080
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.4362 head_norm=1.502792
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.158177e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.4368 head_norm=1.487234 delta_norm=0.115818
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9938 head_norm=1.058753
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.645671e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9562 head_norm=0.985543 delta_norm=0.264567
[S8] aggregate: ROLLBACK (f1_val pre=0.994 post=0.956 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9482 head_norm=1.209471
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.387474e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9484 head_norm=1.156840 delta_norm=0.138747
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.6987 head_norm=1.364531
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.495303e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.6963 head_norm=1.105063 delta_norm=0.449530
[S7] aggregate: ACCEPT kept=['S6', 'S10', 'S15'] (k=3/3) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.480599 cos_to_last_merge=0.7659 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.766
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6617661314195322, 'auprc': 0.7651207884179604, 'loss_val': 0.872942527699842, 'psi': 0.7031079942189036}-{'f1_val': 0.707146408563571, 'auprc': 0.7736326099648941, 'loss_val': 0.713212611598241, 'psi': 0.7337408891241003}
[S3] START round=25 head_norm_before_train=1.288719 cos_to_last_merge=0.9915 (last merge round=22)
[S3] round=25 local utility u=0.660480 metrics={'f1_val': 0.9672068131713183, 'auprc': 0.9993403165368855, 'loss_val': 0.15226107981797546, 'psi': 0.9800602145175452}-{'f1_val': 0.791986934743202, 'auprc': 0.9985255703480087, 'loss_val': 0.4194566092517974, 'psi': 0.8746023889851247}
[S4] START round=25 head_norm_before_train=1.156840 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9428982265679062, 'auprc': 0.9671322389459247, 'loss_val': 0.3037048494559891, 'psi': 0.9525918315191136}-{'f1_val': 0.9482476881798176, 'auprc': 0.9641854575346718, 'loss_val': 0.28688446817210345, 'psi': 0.9546227959217592}
[S5] START round=25 head_norm_before_train=1.487234 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.854965 metrics={'f1_val': 0.6255174120207246, 'auprc': 0.8621265289629954, 'loss_val': 0.48151238054522616, 'psi': 0.7201610587976329}-{'f1_val': 0.43617722397947545, 'auprc': 0.8548807898330225, 'loss_val': 1.0336649510050036, 'psi': 0.6036586503208943}
[S6] START round=25 head_norm_before_train=1.287083 cos_to_last_merge=0.9996 (last merge round=23)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.5959038702889727, 'auprc': 0.7313805349185313, 'loss_val': 0.7860483373507041, 'psi': 0.6500945361407962}-{'f1_val': 0.9395337754186742, 'auprc': 0.9586376714099952, 'loss_val': 0.33880289559231797, 'psi': 0.9471753338152027}
[S7] START round=25 head_norm_before_train=1.105063 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.6718782576116658, 'auprc': 0.858397341076291, 'loss_val': 0.5492314663803562, 'psi': 0.7464858909975158}-{'f1_val': 0.6987021783540206, 'auprc': 0.9203436625496353, 'loss_val': 0.5184563359483884, 'psi': 0.7873587720322665}
[S8] START round=25 head_norm_before_train=0.985543 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.003259 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9985673245538069, 'loss_val': 0.21618546391260593, 'psi': 0.9971487918616144}-{'f1_val': 0.9938004979256806, 'auprc': 0.9929792231170516, 'loss_val': 0.19152440047406086, 'psi': 0.9934719880022289}
[S9] START round=25 head_norm_before_train=1.993409 (no previous merge yet)
[S9] round=25 local utility u=0.032693 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9958436573835022, 'loss_val': 0.022167750526605832, 'psi': 0.9963337700417357}-{'f1_val': 0.9892428323638103, 'auprc': 0.9951001264430153, 'loss_val': 0.04081783282308039, 'psi': 0.9915857499954923}
[S10] START round=25 head_norm_before_train=1.799342 (no previous merge yet)
[S10] round=25 local utility u=0.002869 metrics={'f1_val': 0.9952875488246157, 'auprc': 0.9946635810581477, 'loss_val': 0.05236174962010173, 'psi': 0.9950379617180285}-{'f1_val': 0.9954570659705484, 'auprc': 0.9944249472346797, 'loss_val': 0.058400032671698916, 'psi': 0.995044218476201}
[S11] START round=25 head_norm_before_train=1.857264 (no previous merge yet)
[S11] round=25 local utility u=0.003808 metrics={'f1_val': 0.9965882633272201, 'auprc': 0.9990395939773655, 'loss_val': 0.05052339091945714, 'psi': 0.9975687955872782}-{'f1_val': 0.9965882633272201, 'auprc': 0.9993296194810632, 'loss_val': 0.05900946100401201, 'psi': 0.9976848057887573}
[S13] START round=25 head_norm_before_train=1.928697 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.5787541894602604, 'auprc': 0.6727626436503847, 'loss_val': 0.8210373605373166, 'psi': 0.6163575711363101}-{'f1_val': 0.5784607831627749, 'auprc': 0.7055409124380111, 'loss_val': 0.7782765440858291, 'psi': 0.6292928348728695}
[S14] START round=25 head_norm_before_train=1.933980 (no previous merge yet)
[S14] round=25 local utility u=0.001455 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971177393070783, 'loss_val': 0.029553276397386693, 'psi': 0.9971913097463072}-{'f1_val': 0.997240356705793, 'auprc': 0.9971256407618598, 'loss_val': 0.03248689924997937, 'psi': 0.9971944703282198}
[S15] START round=25 head_norm_before_train=1.882334 (no previous merge yet)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.823348783120767, 'auprc': 0.9929417235187421, 'loss_val': 0.22903772897622665, 'psi': 0.891185959279957}-{'f1_val': 0.9970299290849798, 'auprc': 0.9976981713868812, 'loss_val': 0.047307317580082775, 'psi': 0.9972972260057403}
[S16] START round=25 head_norm_before_train=1.119035 cos_to_last_merge=0.9991 (last merge round=23)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.9321976636612335, 'auprc': 0.9832962215325739, 'loss_val': 0.27187748296262476, 'psi': 0.9526370868097696}-{'f1_val': 0.9662830528980169, 'auprc': 0.975640012226063, 'loss_val': 0.2640012317835697, 'psi': 0.9700258366292354}
[S17] START round=25 head_norm_before_train=1.823522 (no previous merge yet)
[S17] round=25 local utility u=0.700196 metrics={'f1_val': 0.7252342391953398, 'auprc': 0.9744290717624747, 'loss_val': 0.370335651052963, 'psi': 0.8249121722221938}-{'f1_val': 0.6045982742428119, 'auprc': 0.876919067288298, 'loss_val': 0.7543818740133647, 'psi': 0.7135265914610064}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:50303
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:50316
[S8] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S8
[S16] cosine check vs S8: cos=0.9366
[S10] RECEIVED delta(kind=head bytes=1797) from S11
[S10] cosine check vs S11: cos=-0.0486
[S10] DROPPED delta from S11 (cos=-0.0486 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S9
[S3] cosine check vs S9: cos=0.4756
[S13] RECEIVED delta(kind=head bytes=1804) from S14
[S13] cosine check vs S14: cos=0.9995
[S6] RECEIVED delta(kind=head bytes=1805) from S3
[S6] cosine check vs S3: cos=0.9202
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] cosine check vs S5: cos=0.8231
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=0.8253
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=-0.0036
[S14] DROPPED delta from S17 (cos=-0.0036 < 0.0)
[S15] ⇄ pheromone p=0.147 → S7@127.0.0.1:50308
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.5788 head_norm=1.941767
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.045311e-02
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.5710 head_norm=1.946566 delta_norm=0.030453
[S13] aggregate: ROLLBACK (f1_val pre=0.579 post=0.571 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.080 → S16@127.0.0.1:50316
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.6719 head_norm=1.137547
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.446351e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.6902 head_norm=1.415533 delta_norm=0.544635
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.294 → S8@127.0.0.1:50309
[S4] ⇄ pheromone p=0.048 → S8@127.0.0.1:50309
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.5959 head_norm=1.313500
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.647563e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.5944 head_norm=1.297705 delta_norm=0.264756
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.306 → S7@127.0.0.1:50308
[S2] ⇄ pheromone p=0.090 → S5@127.0.0.1:50305
[S10] ⇄ pheromone p=0.069 → S7@127.0.0.1:50308
[S5] ⇄ pheromone p=0.363 → S3@127.0.0.1:50303
[S11] ⇄ pheromone p=0.067 → S10@127.0.0.1:50311
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.9672 head_norm=1.335285
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.983533e-01
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.9866 head_norm=1.246080 delta_norm=0.298353
[S3] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.294 → S6@127.0.0.1:50307
[S14] ⇄ pheromone p=0.027 → S13@127.0.0.1:50313
[S8] ⇄ pheromone p=0.098 → S16@127.0.0.1:50316
[S9] ⇄ pheromone p=0.024 → S3@127.0.0.1:50303
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.9322 head_norm=1.169145
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.072644e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.9312 head_norm=1.083159 delta_norm=0.207264
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.251 → S4@127.0.0.1:50304
[S17] ⇄ pheromone p=0.281 → S14@127.0.0.1:50314
[S2] START round=26 head_norm_before_train=1.495710 cos_to_last_merge=0.7643 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.764
[S2] round=26 local utility u=0.159190 metrics={'f1_val': 0.7009423871620388, 'auprc': 0.7440975089025137, 'loss_val': 0.7265503883600788, 'psi': 0.7182044358582287}-{'f1_val': 0.6617661314195322, 'auprc': 0.7651207884179604, 'loss_val': 0.872942527699842, 'psi': 0.7031079942189036}
[S3] START round=26 head_norm_before_train=1.246080 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.102732 metrics={'f1_val': 0.997089561800744, 'auprc': 0.9988838855374773, 'loss_val': 0.12472368398756986, 'psi': 0.9978072912954373}-{'f1_val': 0.9672068131713183, 'auprc': 0.9993403165368855, 'loss_val': 0.15226107981797546, 'psi': 0.9800602145175452}
[S4] START round=26 head_norm_before_train=1.196401 cos_to_last_merge=0.9993 (last merge round=24)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9396678109652956, 'auprc': 0.9415159857934703, 'loss_val': 0.3152910788108573, 'psi': 0.9404070808965654}-{'f1_val': 0.9428982265679062, 'auprc': 0.9671322389459247, 'loss_val': 0.3037048494559891, 'psi': 0.9525918315191136}
[S5] START round=26 head_norm_before_train=1.507904 cos_to_last_merge=0.9996 (last merge round=24)
[S5] round=26 local utility u=0.531422 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9891183975123872, 'loss_val': 0.24950202159220256, 'psi': 0.8159436786706287}-{'f1_val': 0.6255174120207246, 'auprc': 0.8621265289629954, 'loss_val': 0.48151238054522616, 'psi': 0.7201610587976329}
[S6] START round=26 head_norm_before_train=1.297705 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.8051185654032442, 'auprc': 0.9485528371674785, 'loss_val': 0.42603166098072726, 'psi': 0.8624922741089379}-{'f1_val': 0.5959038702889727, 'auprc': 0.7313805349185313, 'loss_val': 0.7860483373507041, 'psi': 0.6500945361407962}
[S7] START round=26 head_norm_before_train=1.415533 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.6180280937906326, 'auprc': 0.8012710743405574, 'loss_val': 0.6702757271049153, 'psi': 0.6913252860106025}-{'f1_val': 0.6718782576116658, 'auprc': 0.858397341076291, 'loss_val': 0.5492314663803562, 'psi': 0.7464858909975158}
[S8] START round=26 head_norm_before_train=1.032224 cos_to_last_merge=0.9988 (last merge round=24)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9949298416680252, 'auprc': 0.9915490580002233, 'loss_val': 0.19235602125679876, 'psi': 0.9935775282009045}-{'f1_val': 0.9962031034001528, 'auprc': 0.9985673245538069, 'loss_val': 0.21618546391260593, 'psi': 0.9971487918616144}
[S9] START round=26 head_norm_before_train=1.999821 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.988413286695067, 'auprc': 0.9974278715825713, 'loss_val': 0.04554797376192687, 'psi': 0.9920191206500687}-{'f1_val': 0.9966605118138915, 'auprc': 0.9958436573835022, 'loss_val': 0.022167750526605832, 'psi': 0.9963337700417357}
[S10] START round=26 head_norm_before_train=1.818436 (no previous merge yet)
[S10] round=26 local utility u=0.000876 metrics={'f1_val': 0.9949142108706692, 'auprc': 0.9949625340469671, 'loss_val': 0.04926706704512879, 'psi': 0.9949335401411883}-{'f1_val': 0.9952875488246157, 'auprc': 0.9946635810581477, 'loss_val': 0.05236174962010173, 'psi': 0.9950379617180285}
[S11] START round=26 head_norm_before_train=1.884484 (no previous merge yet)
[S11] round=26 local utility u=0.004586 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9989957758774676, 'loss_val': 0.04109465766498819, 'psi': 0.9975387927347152}-{'f1_val': 0.9965882633272201, 'auprc': 0.9990395939773655, 'loss_val': 0.05052339091945714, 'psi': 0.9975687955872782}
[S13] START round=26 head_norm_before_train=1.946566 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.000161 metrics={'f1_val': 0.5673860798081369, 'auprc': 0.667094681432278, 'loss_val': 0.7355032237955484, 'psi': 0.6072695204577934}-{'f1_val': 0.5787541894602604, 'auprc': 0.6727626436503847, 'loss_val': 0.8210373605373166, 'psi': 0.6163575711363101}
[S14] START round=26 head_norm_before_train=1.951829 (no previous merge yet)
[S14] round=26 local utility u=0.000912 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9970824850662139, 'loss_val': 0.027623812273553476, 'psi': 0.9971772080499615}-{'f1_val': 0.997240356705793, 'auprc': 0.9971177393070783, 'loss_val': 0.029553276397386693, 'psi': 0.9971913097463072}
[S15] START round=26 head_norm_before_train=1.899595 (no previous merge yet)
[S15] round=26 local utility u=0.324382 metrics={'f1_val': 0.9106414753211285, 'auprc': 0.9909491347520901, 'loss_val': 0.09805196592786172, 'psi': 0.9427645390935131}-{'f1_val': 0.823348783120767, 'auprc': 0.9929417235187421, 'loss_val': 0.22903772897622665, 'psi': 0.891185959279957}
[S16] START round=26 head_norm_before_train=1.083159 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8265745486664435, 'auprc': 0.9667907861147123, 'loss_val': 0.7367453176699156, 'psi': 0.882661043645751}-{'f1_val': 0.9321976636612335, 'auprc': 0.9832962215325739, 'loss_val': 0.27187748296262476, 'psi': 0.9526370868097696}
[S17] START round=26 head_norm_before_train=1.833876 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.6103578344866739, 'auprc': 0.931251831336877, 'loss_val': 0.78757163445181, 'psi': 0.7387154332267551}-{'f1_val': 0.7252342391953398, 'auprc': 0.9744290717624747, 'loss_val': 0.370335651052963, 'psi': 0.8249121722221938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:50305
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:50308
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[S11] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1794) from S15
[S7] cosine check vs S15: cos=0.2426
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] cosine check vs S5: cos=0.7115
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=0.9671
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] cosine check vs S2: cos=0.9910
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] cosine check vs S13: cos=-0.0644
[S16] DROPPED delta from S13 (cos=-0.0644 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1793) from S11
[S10] cosine check vs S11: cos=-0.0505
[S10] DROPPED delta from S11 (cos=-0.0505 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S3
[S6] cosine check vs S3: cos=0.9927
[S13] RECEIVED delta(kind=head bytes=1797) from S14
[S13] cosine check vs S14: cos=0.9996
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=0.1330
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.6180 head_norm=1.442822
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.129167e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.5864 head_norm=1.136662 delta_norm=0.512917
[S7] aggregate: ROLLBACK (f1_val pre=0.618 post=0.586 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.5674 head_norm=1.958741
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.908235e-02
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.5677 head_norm=1.962719 delta_norm=0.029082
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.7005 head_norm=1.527098
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.024039e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.7065 head_norm=1.515704 delta_norm=0.102404
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.9971 head_norm=1.299499
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.469947e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.9971 head_norm=1.308113 delta_norm=0.546995
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.8051 head_norm=1.317814
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.984920e-02
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.8055 head_norm=1.306250 delta_norm=0.079849
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.511178 cos_to_last_merge=0.7626 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.763
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6006644432921253, 'auprc': 0.7226913270227806, 'loss_val': 1.0575252158835369, 'psi': 0.6494751967843875}-{'f1_val': 0.7009423871620388, 'auprc': 0.7440975089025137, 'loss_val': 0.7265503883600788, 'psi': 0.7182044358582287}
[S3] START round=27 head_norm_before_train=1.308113 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9978120882326802, 'auprc': 0.9994697963507106, 'loss_val': 0.18285551288749607, 'psi': 0.9984751714798924}-{'f1_val': 0.997089561800744, 'auprc': 0.9988838855374773, 'loss_val': 0.12472368398756986, 'psi': 0.9978072912954373}
[S4] START round=27 head_norm_before_train=1.226540 cos_to_last_merge=0.9980 (last merge round=24)
[S4] round=27 local utility u=0.026406 metrics={'f1_val': 0.9409292412376302, 'auprc': 0.9500988375442441, 'loss_val': 0.29579701800101227, 'psi': 0.9445970797602758}-{'f1_val': 0.9396678109652956, 'auprc': 0.9415159857934703, 'loss_val': 0.3152910788108573, 'psi': 0.9404070808965654}
[S5] START round=27 head_norm_before_train=1.515704 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.6255174120207246, 'auprc': 0.8551971324265502, 'loss_val': 0.5034711223275244, 'psi': 0.7173893001830549}-{'f1_val': 0.7004938661094564, 'auprc': 0.9891183975123872, 'loss_val': 0.24950202159220256, 'psi': 0.8159436786706287}
[S6] START round=27 head_norm_before_train=1.306250 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.8202704625596904, 'auprc': 0.8478846840326173, 'loss_val': 0.4826237822756396, 'psi': 0.8313161511488611}-{'f1_val': 0.8051185654032442, 'auprc': 0.9485528371674785, 'loss_val': 0.42603166098072726, 'psi': 0.8624922741089379}
[S7] START round=27 head_norm_before_train=1.136662 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.032138 metrics={'f1_val': 0.623037924856626, 'auprc': 0.8056155292310448, 'loss_val': 0.6490914279204454, 'psi': 0.6960689666063935}-{'f1_val': 0.6180280937906326, 'auprc': 0.8012710743405574, 'loss_val': 0.6702757271049153, 'psi': 0.6913252860106025}
[S8] START round=27 head_norm_before_train=1.076726 cos_to_last_merge=0.9958 (last merge round=24)
[S8] round=27 local utility u=0.031043 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9970459487897879, 'loss_val': 0.15440116682169272, 'psi': 0.996540241556007}-{'f1_val': 0.9949298416680252, 'auprc': 0.9915490580002233, 'loss_val': 0.19235602125679876, 'psi': 0.9935775282009045}
[S9] START round=27 head_norm_before_train=2.010191 (no previous merge yet)
[S9] round=27 local utility u=0.034216 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9957210460439956, 'loss_val': 0.02147804123877317, 'psi': 0.996284725505933}-{'f1_val': 0.988413286695067, 'auprc': 0.9974278715825713, 'loss_val': 0.04554797376192687, 'psi': 0.9920191206500687}
[S10] START round=27 head_norm_before_train=1.837756 (no previous merge yet)
[S10] round=27 local utility u=0.000923 metrics={'f1_val': 0.9951396934075509, 'auprc': 0.9938014746642987, 'loss_val': 0.04529016595516973, 'psi': 0.99460440591025}-{'f1_val': 0.9949142108706692, 'auprc': 0.9949625340469671, 'loss_val': 0.04926706704512879, 'psi': 0.9949335401411883}
[S11] START round=27 head_norm_before_train=1.911728 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9989212642809946, 'loss_val': 0.04486042912207224, 'psi': 0.9975089880961261}-{'f1_val': 0.996567470639547, 'auprc': 0.9989957758774676, 'loss_val': 0.04109465766498819, 'psi': 0.9975387927347152}
[S13] START round=27 head_norm_before_train=1.962719 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5654098150250562, 'auprc': 0.7080178176147103, 'loss_val': 0.9389724836009589, 'psi': 0.6224530160609179}-{'f1_val': 0.5673860798081369, 'auprc': 0.667094681432278, 'loss_val': 0.7355032237955484, 'psi': 0.6072695204577934}
[S14] START round=27 head_norm_before_train=1.967119 (no previous merge yet)
[S14] round=27 local utility u=0.003834 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9987553212660392, 'loss_val': 0.027439065021293542, 'psi': 0.9980927993363278}-{'f1_val': 0.997240356705793, 'auprc': 0.9970824850662139, 'loss_val': 0.027623812273553476, 'psi': 0.9971772080499615}
[S15] START round=27 head_norm_before_train=1.914655 (no previous merge yet)
[S15] round=27 local utility u=0.165559 metrics={'f1_val': 0.9579264308019508, 'auprc': 0.9959527786648933, 'loss_val': 0.06565363901066622, 'psi': 0.9731369699471278}-{'f1_val': 0.9106414753211285, 'auprc': 0.9909491347520901, 'loss_val': 0.09805196592786172, 'psi': 0.9427645390935131}
[S16] START round=27 head_norm_before_train=1.131261 cos_to_last_merge=0.9991 (last merge round=25)
[S16] round=27 local utility u=0.726025 metrics={'f1_val': 0.9709918090037818, 'auprc': 0.9845684752765023, 'loss_val': 0.20453170532374132, 'psi': 0.9764224755128699}-{'f1_val': 0.8265745486664435, 'auprc': 0.9667907861147123, 'loss_val': 0.7367453176699156, 'psi': 0.882661043645751}
[S17] START round=27 head_norm_before_train=1.841910 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.5904748107753796, 'auprc': 0.8258697044747831, 'loss_val': 0.7921432712546355, 'psi': 0.684632768255141}-{'f1_val': 0.6103578344866739, 'auprc': 0.931251831336877, 'loss_val': 0.78757163445181, 'psi': 0.7387154332267551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:50303
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:50309
[S15] not sending this round → trigger blocked (psi=0.973)
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:50316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:50309
[S8] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] cosine check vs S7: cos=0.6004
[S8] RECEIVED delta(kind=head bytes=1798) from S4
[S8] cosine check vs S4: cos=0.9082
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] cosine check vs S16: cos=0.9673
[S16] RECEIVED delta(kind=head bytes=1802) from S8
[S16] cosine check vs S8: cos=0.9729
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=0.3256
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.9978 head_norm=1.354174
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.017203e+00
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.9982 head_norm=1.387882 delta_norm=1.017203
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9962 head_norm=1.116992
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.735629e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9962 head_norm=1.028267 delta_norm=0.173563
[S8] aggregate: ACCEPT kept=['S7', 'S4'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9409 head_norm=1.252849
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.595884e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9411 head_norm=1.206803 delta_norm=0.159588
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9710 head_norm=1.180701
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.373717e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9764 head_norm=1.141048 delta_norm=0.137372
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.522906 cos_to_last_merge=0.7611 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.761
[S2] round=28 local utility u=0.234160 metrics={'f1_val': 0.6592827235549326, 'auprc': 0.737102102451148, 'loss_val': 0.9841472087548087, 'psi': 0.6904104751134188}-{'f1_val': 0.6006644432921253, 'auprc': 0.7226913270227806, 'loss_val': 1.0575252158835369, 'psi': 0.6494751967843875}
[S3] START round=28 head_norm_before_train=1.387882 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9603561684511364, 'auprc': 0.999583017549831, 'loss_val': 0.13794530049860193, 'psi': 0.9760469080906142}-{'f1_val': 0.9978120882326802, 'auprc': 0.9994697963507106, 'loss_val': 0.18285551288749607, 'psi': 0.9984751714798924}
[S4] START round=28 head_norm_before_train=1.206803 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.063297 metrics={'f1_val': 0.9558128686758699, 'auprc': 0.9572982247712699, 'loss_val': 0.28010387957615257, 'psi': 0.9564070111140299}-{'f1_val': 0.9409292412376302, 'auprc': 0.9500988375442441, 'loss_val': 0.29579701800101227, 'psi': 0.9445970797602758}
[S5] START round=28 head_norm_before_train=1.528639 cos_to_last_merge=0.9999 (last merge round=26)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8547468018107478, 'loss_val': 0.8850328243436987, 'psi': 0.6039584590275224}-{'f1_val': 0.6255174120207246, 'auprc': 0.8551971324265502, 'loss_val': 0.5034711223275244, 'psi': 0.7173893001830549}
[S6] START round=28 head_norm_before_train=1.330934 cos_to_last_merge=0.9995 (last merge round=26)
[S6] round=28 local utility u=0.616108 metrics={'f1_val': 0.9390509779838541, 'auprc': 0.9604550356566361, 'loss_val': 0.3008025504520875, 'psi': 0.9476126010529669}-{'f1_val': 0.8202704625596904, 'auprc': 0.8478846840326173, 'loss_val': 0.4826237822756396, 'psi': 0.8313161511488611}
[S7] START round=28 head_norm_before_train=1.168115 cos_to_last_merge=0.9988 (last merge round=26)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.5851672203059505, 'auprc': 0.7933288978880577, 'loss_val': 0.7120784656540652, 'psi': 0.6684318913387934}-{'f1_val': 0.623037924856626, 'auprc': 0.8056155292310448, 'loss_val': 0.6490914279204454, 'psi': 0.6960689666063935}
[S8] START round=28 head_norm_before_train=1.028267 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9982481442301213, 'loss_val': 0.17500455247555316, 'psi': 0.9970211197321402}-{'f1_val': 0.9962031034001528, 'auprc': 0.9970459487897879, 'loss_val': 0.15440116682169272, 'psi': 0.996540241556007}
[S9] START round=28 head_norm_before_train=2.021892 (no previous merge yet)
[S9] round=28 local utility u=0.002188 metrics={'f1_val': 0.9955375568978275, 'auprc': 0.999582287219152, 'loss_val': 0.02194903155947711, 'psi': 0.9971554490263573}-{'f1_val': 0.9966605118138915, 'auprc': 0.9957210460439956, 'loss_val': 0.02147804123877317, 'psi': 0.996284725505933}
[S10] START round=28 head_norm_before_train=1.857838 (no previous merge yet)
[S10] round=28 local utility u=0.002571 metrics={'f1_val': 0.9955978191757338, 'auprc': 0.9936787996987535, 'loss_val': 0.04252941527070368, 'psi': 0.9948302113849417}-{'f1_val': 0.9951396934075509, 'auprc': 0.9938014746642987, 'loss_val': 0.04529016595516973, 'psi': 0.99460440591025}
[S11] START round=28 head_norm_before_train=1.935483 (no previous merge yet)
[S11] round=28 local utility u=0.006116 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9989484721757835, 'loss_val': 0.03270936763887543, 'psi': 0.9975198712540416}-{'f1_val': 0.996567470639547, 'auprc': 0.9989212642809946, 'loss_val': 0.04486042912207224, 'psi': 0.9975089880961261}
[S13] START round=28 head_norm_before_train=1.972583 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=28 local utility u=0.176441 metrics={'f1_val': 0.5816520024582419, 'auprc': 0.7231062159112892, 'loss_val': 0.7288093725135596, 'psi': 0.6382336878394608}-{'f1_val': 0.5654098150250562, 'auprc': 0.7080178176147103, 'loss_val': 0.9389724836009589, 'psi': 0.6224530160609179}
[S14] START round=28 head_norm_before_train=1.980564 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9961605687915402, 'auprc': 0.9975065601822694, 'loss_val': 0.03243454883338175, 'psi': 0.9966989653478319}-{'f1_val': 0.9976511180498535, 'auprc': 0.9987553212660392, 'loss_val': 0.027439065021293542, 'psi': 0.9980927993363278}
[S15] START round=28 head_norm_before_train=1.927677 (no previous merge yet)
[S15] round=28 local utility u=0.055554 metrics={'f1_val': 0.9778997699729323, 'auprc': 0.9913324722261427, 'loss_val': 0.06052486979015238, 'psi': 0.9832728508742166}-{'f1_val': 0.9579264308019508, 'auprc': 0.9959527786648933, 'loss_val': 0.06565363901066622, 'psi': 0.9731369699471278}
[S16] START round=28 head_norm_before_train=1.141048 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8568172484619628, 'auprc': 0.9804920260507954, 'loss_val': 0.6062090891762645, 'psi': 0.9062871594974958}-{'f1_val': 0.9709918090037818, 'auprc': 0.9845684752765023, 'loss_val': 0.20453170532374132, 'psi': 0.9764224755128699}
[S17] START round=28 head_norm_before_train=1.854111 (no previous merge yet)
[S17] round=28 local utility u=0.019185 metrics={'f1_val': 0.596880496250235, 'auprc': 0.8203276051516031, 'loss_val': 0.775581771872492, 'psi': 0.6862593398107822}-{'f1_val': 0.5904748107753796, 'auprc': 0.8258697044747831, 'loss_val': 0.7921432712546355, 'psi': 0.684632768255141}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.997)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:50312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:50314
[S4] not sending this round → trigger blocked (psi=0.956)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S6
[S3] cosine check vs S6: cos=0.9253
[S14] RECEIVED delta(kind=head bytes=1800) from S13
[S14] cosine check vs S13: cos=0.9994
[S11] RECEIVED delta(kind=head bytes=1798) from S10
[S11] cosine check vs S10: cos=-0.0539
[S11] DROPPED delta from S10 (cos=-0.0539 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.9604 head_norm=1.436152
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.726378e-01
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.9604 head_norm=1.369175 delta_norm=0.272638
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9962 head_norm=1.991948
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.540814e-02
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9957 head_norm=1.986012 delta_norm=0.035408
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.533126 cos_to_last_merge=0.7597 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.760
[S2] round=29 local utility u=0.225541 metrics={'f1_val': 0.7087485397641943, 'auprc': 0.7349563037103948, 'loss_val': 0.823422945672386, 'psi': 0.7192316453426745}-{'f1_val': 0.6592827235549326, 'auprc': 0.737102102451148, 'loss_val': 0.9841472087548087, 'psi': 0.6904104751134188}
[S3] START round=29 head_norm_before_train=1.369175 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.133947 metrics={'f1_val': 0.9971122502560278, 'auprc': 0.999416171660649, 'loss_val': 0.09008664590975, 'psi': 0.9980338188178763}-{'f1_val': 0.9603561684511364, 'auprc': 0.999583017549831, 'loss_val': 0.13794530049860193, 'psi': 0.9760469080906142}
[S4] START round=29 head_norm_before_train=1.233607 cos_to_last_merge=0.9998 (last merge round=27)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9481958515682168, 'auprc': 0.9648797404260518, 'loss_val': 0.2816300100969752, 'psi': 0.9548694071113508}-{'f1_val': 0.9558128686758699, 'auprc': 0.9572982247712699, 'loss_val': 0.28010387957615257, 'psi': 0.9564070111140299}
[S5] START round=29 head_norm_before_train=1.549744 cos_to_last_merge=0.9991 (last merge round=26)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8561597960997711, 'loss_val': 0.9337958285068001, 'psi': 0.6045236567431317}-{'f1_val': 0.43676623050537206, 'auprc': 0.8547468018107478, 'loss_val': 0.8850328243436987, 'psi': 0.6039584590275224}
[S6] START round=29 head_norm_before_train=1.354773 cos_to_last_merge=0.9984 (last merge round=26)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.8230937848021066, 'auprc': 0.9388515915580647, 'loss_val': 0.4170220542722399, 'psi': 0.8693969075044898}-{'f1_val': 0.9390509779838541, 'auprc': 0.9604550356566361, 'loss_val': 0.3008025504520875, 'psi': 0.9476126010529669}
[S7] START round=29 head_norm_before_train=1.203076 cos_to_last_merge=0.9957 (last merge round=26)
[S7] round=29 local utility u=0.343659 metrics={'f1_val': 0.651174235232584, 'auprc': 0.8263919191232794, 'loss_val': 0.5199920043679642, 'psi': 0.7212613087888622}-{'f1_val': 0.5851672203059505, 'auprc': 0.7933288978880577, 'loss_val': 0.7120784656540652, 'psi': 0.6684318913387934}
[S8] START round=29 head_norm_before_train=1.071520 cos_to_last_merge=0.9991 (last merge round=27)
[S8] round=29 local utility u=0.004411 metrics={'f1_val': 0.9960539056390789, 'auprc': 0.9924937602414079, 'loss_val': 0.1480245402920792, 'psi': 0.9946298474800105}-{'f1_val': 0.9962031034001528, 'auprc': 0.9982481442301213, 'loss_val': 0.17500455247555316, 'psi': 0.9970211197321402}
[S9] START round=29 head_norm_before_train=2.028836 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.995888774193962, 'loss_val': 0.020823656499136683, 'psi': 0.9963518167659197}-{'f1_val': 0.9955375568978275, 'auprc': 0.999582287219152, 'loss_val': 0.02194903155947711, 'psi': 0.9971554490263573}
[S10] START round=29 head_norm_before_train=1.878112 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.995829755538387, 'auprc': 0.9900281596604401, 'loss_val': 0.04012710033199393, 'psi': 0.9935091171872082}-{'f1_val': 0.9955978191757338, 'auprc': 0.9936787996987535, 'loss_val': 0.04252941527070368, 'psi': 0.9948302113849417}
[S11] START round=29 head_norm_before_train=1.957770 (no previous merge yet)
[S11] round=29 local utility u=0.000457 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9988926960868447, 'loss_val': 0.030177210406578652, 'psi': 0.9973524582478057}-{'f1_val': 0.996567470639547, 'auprc': 0.9989484721757835, 'loss_val': 0.03270936763887543, 'psi': 0.9975198712540416}
[S13] START round=29 head_norm_before_train=1.980692 cos_to_last_merge=0.9999 (last merge round=26)
[S13] round=29 local utility u=0.189163 metrics={'f1_val': 0.6626012606147161, 'auprc': 0.7379443965193694, 'loss_val': 0.8806935262650779, 'psi': 0.6927385149765775}-{'f1_val': 0.5816520024582419, 'auprc': 0.7231062159112892, 'loss_val': 0.7288093725135596, 'psi': 0.6382336878394608}
[S14] START round=29 head_norm_before_train=1.986012 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9373447330971028, 'auprc': 0.9957325126341319, 'loss_val': 0.10324755884289888, 'psi': 0.9606998449119144}-{'f1_val': 0.9961605687915402, 'auprc': 0.9975065601822694, 'loss_val': 0.03243454883338175, 'psi': 0.9966989653478319}
[S15] START round=29 head_norm_before_train=1.940761 (no previous merge yet)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.9013277441892558, 'auprc': 0.9926054585517554, 'loss_val': 0.17695838625889965, 'psi': 0.9378388299342556}-{'f1_val': 0.9778997699729323, 'auprc': 0.9913324722261427, 'loss_val': 0.06052486979015238, 'psi': 0.9832728508742166}
[S16] START round=29 head_norm_before_train=1.184652 cos_to_last_merge=0.9993 (last merge round=27)
[S16] round=29 local utility u=0.393179 metrics={'f1_val': 0.9290181357322624, 'auprc': 0.993231575990435, 'loss_val': 0.29127586711964126, 'psi': 0.9547035118355315}-{'f1_val': 0.8568172484619628, 'auprc': 0.9804920260507954, 'loss_val': 0.6062090891762645, 'psi': 0.9062871594974958}
[S17] START round=29 head_norm_before_train=1.868499 (no previous merge yet)
[S17] round=29 local utility u=0.161734 metrics={'f1_val': 0.6115752171673581, 'auprc': 0.9711357307297889, 'loss_val': 0.9927071236588739, 'psi': 0.7553994225923304}-{'f1_val': 0.596880496250235, 'auprc': 0.8203276051516031, 'loss_val': 0.775581771872492, 'psi': 0.6862593398107822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:50305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.693)
[S16] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1806) from S16
[S8] cosine check vs S16: cos=0.9735
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] cosine check vs S7: cos=0.3524
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] cosine check vs S8: cos=0.6612
[S5] RECEIVED delta(kind=head bytes=1800) from S3
[S5] cosine check vs S3: cos=0.5533
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.8231 head_norm=1.377270
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.465479e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.8231 head_norm=1.076434 delta_norm=0.746548
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.4368 head_norm=1.566730
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.050457e-01
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.4368 head_norm=1.308334 delta_norm=0.705046
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.6512 head_norm=1.239038
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.881789e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.6582 head_norm=1.074249 delta_norm=0.488179
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9961 head_norm=1.117786
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.467648e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9961 head_norm=1.167081 delta_norm=0.146765
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.543039 cos_to_last_merge=0.7586 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.759
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.5965561727260098, 'auprc': 0.7012743913922584, 'loss_val': 1.1653470104264905, 'psi': 0.6384434601925093}-{'f1_val': 0.7087485397641943, 'auprc': 0.7349563037103948, 'loss_val': 0.823422945672386, 'psi': 0.7192316453426745}
[S3] START round=30 head_norm_before_train=1.401075 cos_to_last_merge=0.9997 (last merge round=28)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9582387538923269, 'auprc': 0.9996029362619768, 'loss_val': 0.13547575276860652, 'psi': 0.9747844268401868}-{'f1_val': 0.9971122502560278, 'auprc': 0.999416171660649, 'loss_val': 0.09008664590975, 'psi': 0.9980338188178763}
[S4] START round=30 head_norm_before_train=1.251942 cos_to_last_merge=0.9993 (last merge round=27)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9391108422882299, 'auprc': 0.940741825144312, 'loss_val': 0.3035422328444684, 'psi': 0.9397632354306629}-{'f1_val': 0.9481958515682168, 'auprc': 0.9648797404260518, 'loss_val': 0.2816300100969752, 'psi': 0.9548694071113508}
[S5] START round=30 head_norm_before_train=1.308334 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9917482689214223, 'loss_val': 0.25276766338270024, 'psi': 0.8168920980289172}-{'f1_val': 0.43676623050537206, 'auprc': 0.8561597960997711, 'loss_val': 0.9337958285068001, 'psi': 0.6045236567431317}
[S6] START round=30 head_norm_before_train=1.076434 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.089317 metrics={'f1_val': 0.8471362768645889, 'auprc': 0.9514180256983298, 'loss_val': 0.42034254544673205, 'psi': 0.8888489763980852}-{'f1_val': 0.8230937848021066, 'auprc': 0.9388515915580647, 'loss_val': 0.4170220542722399, 'psi': 0.8693969075044898}
[S7] START round=30 head_norm_before_train=1.074249 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.619513268287774, 'auprc': 0.8036038869194262, 'loss_val': 0.6354475134737062, 'psi': 0.6931495157404348}-{'f1_val': 0.651174235232584, 'auprc': 0.8263919191232794, 'loss_val': 0.5199920043679642, 'psi': 0.7212613087888622}
[S8] START round=30 head_norm_before_train=1.167081 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.027426 metrics={'f1_val': 0.9950949602617258, 'auprc': 0.9972803294292512, 'loss_val': 0.10177912733385816, 'psi': 0.9959691079287359}-{'f1_val': 0.9960539056390789, 'auprc': 0.9924937602414079, 'loss_val': 0.1480245402920792, 'psi': 0.9946298474800105}
[S9] START round=30 head_norm_before_train=2.034487 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9909317508950798, 'auprc': 0.9991560423850736, 'loss_val': 0.03217499981966017, 'psi': 0.9942214674910773}-{'f1_val': 0.9966605118138915, 'auprc': 0.995888774193962, 'loss_val': 0.020823656499136683, 'psi': 0.9963518167659197}
[S10] START round=30 head_norm_before_train=1.896291 (no previous merge yet)
[S10] round=30 local utility u=0.005492 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.992883082401869, 'loss_val': 0.03796548724363623, 'psi': 0.9946767586950034}-{'f1_val': 0.995829755538387, 'auprc': 0.9900281596604401, 'loss_val': 0.04012710033199393, 'psi': 0.9935091171872082}
[S11] START round=30 head_norm_before_train=1.978798 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9960854162000905, 'auprc': 0.9988610022269981, 'loss_val': 0.03493070452922785, 'psi': 0.9971956506108535}-{'f1_val': 0.9963256330217796, 'auprc': 0.9988926960868447, 'loss_val': 0.030177210406578652, 'psi': 0.9973524582478057}
[S13] START round=30 head_norm_before_train=1.988169 cos_to_last_merge=0.9997 (last merge round=26)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5892810934172543, 'auprc': 0.7113143449994808, 'loss_val': 0.7676820032818655, 'psi': 0.6380943940501449}-{'f1_val': 0.6626012606147161, 'auprc': 0.7379443965193694, 'loss_val': 0.8806935262650779, 'psi': 0.6927385149765775}
[S14] START round=30 head_norm_before_train=1.997905 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=30 local utility u=0.225098 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9987602885673673, 'loss_val': 0.023973043632318933, 'psi': 0.9980947862568591}-{'f1_val': 0.9373447330971028, 'auprc': 0.9957325126341319, 'loss_val': 0.10324755884289888, 'psi': 0.9606998449119144}
[S15] START round=30 head_norm_before_train=1.954773 (no previous merge yet)
[S15] round=30 local utility u=0.372004 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9981514560655824, 'loss_val': 0.02432515613678463, 'psi': 0.997530934543093}-{'f1_val': 0.9013277441892558, 'auprc': 0.9926054585517554, 'loss_val': 0.17695838625889965, 'psi': 0.9378388299342556}
[S16] START round=30 head_norm_before_train=1.231987 cos_to_last_merge=0.9972 (last merge round=27)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8608530638566912, 'auprc': 0.993853473490758, 'loss_val': 0.5660947601609143, 'psi': 0.9140532277103179}-{'f1_val': 0.9290181357322624, 'auprc': 0.993231575990435, 'loss_val': 0.29127586711964126, 'psi': 0.9547035118355315}
[S17] START round=30 head_norm_before_train=1.885209 (no previous merge yet)
[S17] round=30 local utility u=0.057679 metrics={'f1_val': 0.6252854742074341, 'auprc': 0.9371557535937631, 'loss_val': 0.8576715239210296, 'psi': 0.7500335859619657}-{'f1_val': 0.6115752171673581, 'auprc': 0.9711357307297889, 'loss_val': 0.9927071236588739, 'psi': 0.7553994225923304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:50303
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:50312
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:50317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:50302
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S5
[S2] cosine check vs S5: cos=0.8789
[S17] RECEIVED delta(kind=head bytes=1802) from S14
[S17] cosine check vs S14: cos=-0.0026
[S17] DROPPED delta from S14 (cos=-0.0026 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S6
[S3] cosine check vs S6: cos=0.8423
[S11] RECEIVED delta(kind=head bytes=1799) from S10
[S11] cosine check vs S10: cos=-0.0563
[S11] DROPPED delta from S10 (cos=-0.0563 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.750)
[S4] ⇄ pheromone p=0.026 → S16@127.0.0.1:50316
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.9582 head_norm=1.424731
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.869723e-01
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.9606 head_norm=1.214587 delta_norm=0.386972
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.126 → S5@127.0.0.1:50305
[S8] ⇄ pheromone p=0.041 → S7@127.0.0.1:50308
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=30 metric=0.5966 head_norm=1.549715
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.701074e-01
[S2] stored merged vector for next round verification (round=30)
[S2] DEBUG after merge:  round=30 metric=0.5978 head_norm=1.392792 delta_norm=0.370107
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.155 → S6@127.0.0.1:50307
[S13] ⇄ pheromone p=0.079 → S14@127.0.0.1:50314
[S10] ⇄ pheromone p=0.024 → S11@127.0.0.1:50312
[S6] ⇄ pheromone p=0.279 → S3@127.0.0.1:50303
[S5] ⇄ pheromone p=0.362 → S2@127.0.0.1:50302
[S14] ⇄ pheromone p=0.054 → S17@127.0.0.1:50317
[S17] ⇄ pheromone p=0.132 → S14@127.0.0.1:50314
[S16] ⇄ pheromone p=0.220 → S8@127.0.0.1:50309
[S2] START round=31 head_norm_before_train=1.392792 cos_to_last_merge=1.0000 (last merge round=30)
[S2] round=31 local utility u=0.555075 metrics={'f1_val': 0.7026284145739801, 'auprc': 0.7332370164807107, 'loss_val': 0.7875182522014805, 'psi': 0.7148718553366723}-{'f1_val': 0.5965561727260098, 'auprc': 0.7012743913922584, 'loss_val': 1.1653470104264905, 'psi': 0.6384434601925093}
[S3] START round=31 head_norm_before_train=1.214587 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.047236 metrics={'f1_val': 0.9730927139137879, 'auprc': 0.9997671509329619, 'loss_val': 0.13061927245417598, 'psi': 0.9837624887214576}-{'f1_val': 0.9582387538923269, 'auprc': 0.9996029362619768, 'loss_val': 0.13547575276860652, 'psi': 0.9747844268401868}
[S4] START round=31 head_norm_before_train=1.274980 cos_to_last_merge=0.9986 (last merge round=27)
[S4] round=31 local utility u=0.094498 metrics={'f1_val': 0.9482398565559294, 'auprc': 0.9732656658795684, 'loss_val': 0.2668923059633549, 'psi': 0.958250180285385}-{'f1_val': 0.9391108422882299, 'auprc': 0.940741825144312, 'loss_val': 0.3035422328444684, 'psi': 0.9397632354306629}
[S5] START round=31 head_norm_before_train=1.323661 cos_to_last_merge=0.9997 (last merge round=29)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.6537472471297209, 'auprc': 0.9044775703246305, 'loss_val': 0.38906264039300337, 'psi': 0.7540393764076847}-{'f1_val': 0.7003213174339138, 'auprc': 0.9917482689214223, 'loss_val': 0.25276766338270024, 'psi': 0.8168920980289172}
[S6] START round=31 head_norm_before_train=1.104571 cos_to_last_merge=0.9993 (last merge round=29)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.7855174165365963, 'auprc': 0.7955113568257793, 'loss_val': 0.5396515845400295, 'psi': 0.7895149926522695}-{'f1_val': 0.8471362768645889, 'auprc': 0.9514180256983298, 'loss_val': 0.42034254544673205, 'psi': 0.8888489763980852}
[S7] START round=31 head_norm_before_train=1.105987 cos_to_last_merge=0.9993 (last merge round=29)
[S7] round=31 local utility u=0.143752 metrics={'f1_val': 0.6327141965872364, 'auprc': 0.8330706144946465, 'loss_val': 0.5155487429621832, 'psi': 0.7128567637502004}-{'f1_val': 0.619513268287774, 'auprc': 0.8036038869194262, 'loss_val': 0.6354475134737062, 'psi': 0.6931495157404348}
[S8] START round=31 head_norm_before_train=1.211725 cos_to_last_merge=0.9995 (last merge round=29)
[S8] round=31 local utility u=0.007925 metrics={'f1_val': 0.9950949602617258, 'auprc': 0.9985748737839424, 'loss_val': 0.08981196931541034, 'psi': 0.9964869256706124}-{'f1_val': 0.9950949602617258, 'auprc': 0.9972803294292512, 'loss_val': 0.10177912733385816, 'psi': 0.9959691079287359}
[S9] START round=31 head_norm_before_train=2.042630 (no previous merge yet)
[S9] round=31 local utility u=0.020024 metrics={'f1_val': 0.9959523101139645, 'auprc': 0.9985334171116234, 'loss_val': 0.020382486975856495, 'psi': 0.996984752913028}-{'f1_val': 0.9909317508950798, 'auprc': 0.9991560423850736, 'loss_val': 0.03217499981966017, 'psi': 0.9942214674910773}
[S10] START round=31 head_norm_before_train=1.915298 (no previous merge yet)
[S10] round=31 local utility u=0.001131 metrics={'f1_val': 0.9955978191757338, 'auprc': 0.9935451644533791, 'loss_val': 0.036041835227767084, 'psi': 0.9947767572867918}-{'f1_val': 0.9958725428904263, 'auprc': 0.992883082401869, 'loss_val': 0.03796548724363623, 'psi': 0.9946767586950034}
[S11] START round=31 head_norm_before_train=1.997472 (no previous merge yet)
[S11] round=31 local utility u=0.005338 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9988982036678162, 'loss_val': 0.027259632420231376, 'psi': 0.9974997638508547}-{'f1_val': 0.9960854162000905, 'auprc': 0.9988610022269981, 'loss_val': 0.03493070452922785, 'psi': 0.9971956506108535}
[S13] START round=31 head_norm_before_train=1.995395 cos_to_last_merge=0.9996 (last merge round=26)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.58451698956342, 'auprc': 0.7044791087125153, 'loss_val': 0.8844784175900886, 'psi': 0.6325018372230582}-{'f1_val': 0.5892810934172543, 'auprc': 0.7113143449994808, 'loss_val': 0.7676820032818655, 'psi': 0.6380943940501449}
[S14] START round=31 head_norm_before_train=2.010651 cos_to_last_merge=0.9999 (last merge round=28)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9974862827730671, 'auprc': 0.9989202642087802, 'loss_val': 0.025828078438134252, 'psi': 0.9980598753473523}-{'f1_val': 0.9976511180498535, 'auprc': 0.9987602885673673, 'loss_val': 0.023973043632318933, 'psi': 0.9980947862568591}
[S15] START round=31 head_norm_before_train=1.968432 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.8779326952638483, 'auprc': 0.9958456825856242, 'loss_val': 0.2493066739608128, 'psi': 0.9250978901925587}-{'f1_val': 0.9971172535281002, 'auprc': 0.9981514560655824, 'loss_val': 0.02432515613678463, 'psi': 0.997530934543093}
[S16] START round=31 head_norm_before_train=1.273478 cos_to_last_merge=0.9947 (last merge round=27)
[S16] round=31 local utility u=0.138560 metrics={'f1_val': 0.8843321241184631, 'auprc': 0.9942781226173388, 'loss_val': 0.43112254476738826, 'psi': 0.9283105235180134}-{'f1_val': 0.8608530638566912, 'auprc': 0.993853473490758, 'loss_val': 0.5660947601609143, 'psi': 0.9140532277103179}
[S17] START round=31 head_norm_before_train=1.901781 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.5632293478578685, 'auprc': 0.7210574539018937, 'loss_val': 1.2155719771857758, 'psi': 0.6263605902754785}-{'f1_val': 0.6252854742074341, 'auprc': 0.9371557535937631, 'loss_val': 0.8576715239210296, 'psi': 0.7500335859619657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:50307
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:50312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:50305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:50316
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S10
[S11] cosine check vs S10: cos=-0.0571
[S11] DROPPED delta from S10 (cos=-0.0571 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S3
[S5] cosine check vs S3: cos=0.8383
[S5] RECEIVED delta(kind=head bytes=1803) from S2
[S5] cosine check vs S2: cos=0.9633
[S7] RECEIVED delta(kind=head bytes=1802) from S8
[S7] cosine check vs S8: cos=0.8283
[S16] RECEIVED delta(kind=head bytes=1794) from S4
[S16] cosine check vs S4: cos=0.9763
[S8] RECEIVED delta(kind=head bytes=1796) from S16
[S8] cosine check vs S16: cos=0.9878
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] cosine check vs S7: cos=0.7341
[S10] RECEIVED delta(kind=head bytes=1794) from S11
[S10] cosine check vs S11: cos=-0.0571
[S10] DROPPED delta from S11 (cos=-0.0571 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.6537 head_norm=1.348779
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.332212e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.6591 head_norm=1.278256 delta_norm=0.133221
[S5] aggregate: ACCEPT kept=['S3', 'S2'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.8843 head_norm=1.311560
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.424562e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.8828 head_norm=1.299740 delta_norm=0.142456
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2]  timeout peer S3
[S3]  timeout peer S2
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9951 head_norm=1.248141
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.049198e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9951 head_norm=1.275937 delta_norm=0.104920
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.6327 head_norm=1.139241
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.535673e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.6460 head_norm=1.141426 delta_norm=0.353567
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.7855 head_norm=1.142217
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.159265e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.7782 head_norm=1.062200 delta_norm=0.415927
[S6] aggregate: ROLLBACK (f1_val pre=0.786 post=0.778 tol_abs=0.005 tol_rel=0.0)
[S2] START round=32 head_norm_before_train=1.399872 cos_to_last_merge=1.0000 (last merge round=30)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.6756612088781512, 'auprc': 0.7308325859228004, 'loss_val': 0.831299466997511, 'psi': 0.6977297596960108}-{'f1_val': 0.7026284145739801, 'auprc': 0.7332370164807107, 'loss_val': 0.7875182522014805, 'psi': 0.7148718553366723}
[S3] START round=32 head_norm_before_train=1.250231 cos_to_last_merge=0.9996 (last merge round=30)
[S3] round=32 local utility u=0.085318 metrics={'f1_val': 0.9969808748199115, 'auprc': 0.9997391210377922, 'loss_val': 0.10322740030357971, 'psi': 0.9980841733070638}-{'f1_val': 0.9730927139137879, 'auprc': 0.9997671509329619, 'loss_val': 0.13061927245417598, 'psi': 0.9837624887214576}
[S4] START round=32 head_norm_before_train=1.303475 cos_to_last_merge=0.9973 (last merge round=27)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.941278983772784, 'auprc': 0.9529288119320182, 'loss_val': 0.2790557999346432, 'psi': 0.9459389150364776}-{'f1_val': 0.9482398565559294, 'auprc': 0.9732656658795684, 'loss_val': 0.2668923059633549, 'psi': 0.958250180285385}
[S5] START round=32 head_norm_before_train=1.278256 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.309155 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.9882706325717814, 'loss_val': 0.30313044461495164, 'psi': 0.8156564037471168}-{'f1_val': 0.6537472471297209, 'auprc': 0.9044775703246305, 'loss_val': 0.38906264039300337, 'psi': 0.7540393764076847}
[S6] START round=32 head_norm_before_train=1.062200 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.640273 metrics={'f1_val': 0.9004555017118153, 'auprc': 0.9608240293170243, 'loss_val': 0.4446730375761942, 'psi': 0.9246029127538988}-{'f1_val': 0.7855174165365963, 'auprc': 0.7955113568257793, 'loss_val': 0.5396515845400295, 'psi': 0.7895149926522695}
[S7] START round=32 head_norm_before_train=1.141426 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.45573040033798967, 'auprc': 0.7781330359454233, 'loss_val': 0.9484682367283411, 'psi': 0.5846914545809632}-{'f1_val': 0.6327141965872364, 'auprc': 0.8330706144946465, 'loss_val': 0.5155487429621832, 'psi': 0.7128567637502004}
[S8] START round=32 head_norm_before_train=1.275937 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9941775362873223, 'auprc': 0.9977772608416778, 'loss_val': 0.0993206673152, 'psi': 0.9956174261090646}-{'f1_val': 0.9950949602617258, 'auprc': 0.9985748737839424, 'loss_val': 0.08981196931541034, 'psi': 0.9964869256706124}
[S9] START round=32 head_norm_before_train=2.053514 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9934493384257997, 'auprc': 0.9990804922073009, 'loss_val': 0.027968071768950734, 'psi': 0.9957017999384002}-{'f1_val': 0.9959523101139645, 'auprc': 0.9985334171116234, 'loss_val': 0.020382486975856495, 'psi': 0.996984752913028}
[S10] START round=32 head_norm_before_train=1.934508 (no previous merge yet)
[S10] round=32 local utility u=0.000867 metrics={'f1_val': 0.9955978191757338, 'auprc': 0.9935285572256198, 'loss_val': 0.03425858608122014, 'psi': 0.9947701143956882}-{'f1_val': 0.9955978191757338, 'auprc': 0.9935451644533791, 'loss_val': 0.036041835227767084, 'psi': 0.9947767572867918}
[S11] START round=32 head_norm_before_train=2.013043 (no previous merge yet)
[S11] round=32 local utility u=0.000980 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9989328358083223, 'loss_val': 0.025404351206416112, 'psi': 0.9975136167070571}-{'f1_val': 0.996567470639547, 'auprc': 0.9988982036678162, 'loss_val': 0.027259632420231376, 'psi': 0.9974997638508547}
[S13] START round=32 head_norm_before_train=2.004090 cos_to_last_merge=0.9995 (last merge round=26)
[S13] round=32 local utility u=0.069544 metrics={'f1_val': 0.5945583038586056, 'auprc': 0.7225389079308093, 'loss_val': 0.8598172498879532, 'psi': 0.6457505454874871}-{'f1_val': 0.58451698956342, 'auprc': 0.7044791087125153, 'loss_val': 0.8844784175900886, 'psi': 0.6325018372230582}
[S14] START round=32 head_norm_before_train=2.023411 cos_to_last_merge=0.9998 (last merge round=28)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9987496907400979, 'loss_val': 0.024069545250194446, 'psi': 0.9978460133534626}-{'f1_val': 0.9974862827730671, 'auprc': 0.9989202642087802, 'loss_val': 0.025828078438134252, 'psi': 0.9980598753473523}
[S15] START round=32 head_norm_before_train=1.982547 (no previous merge yet)
[S15] round=32 local utility u=0.465453 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9966464426123467, 'loss_val': 0.03538549176800481, 'psi': 0.9968765344959265}-{'f1_val': 0.8779326952638483, 'auprc': 0.9958456825856242, 'loss_val': 0.2493066739608128, 'psi': 0.9250978901925587}
[S16] START round=32 head_norm_before_train=1.299740 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.851230940819134, 'auprc': 0.9923143623430211, 'loss_val': 0.6600732837471015, 'psi': 0.9076643094286888}-{'f1_val': 0.8843321241184631, 'auprc': 0.9942781226173388, 'loss_val': 0.43112254476738826, 'psi': 0.9283105235180134}
[S17] START round=32 head_norm_before_train=1.916805 (no previous merge yet)
[S17] round=32 local utility u=0.413450 metrics={'f1_val': 0.6044706191901998, 'auprc': 0.8882876132704782, 'loss_val': 1.1378110179042675, 'psi': 0.7179974168223112}-{'f1_val': 0.5632293478578685, 'auprc': 0.7210574539018937, 'loss_val': 1.2155719771857758, 'psi': 0.6263605902754785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:50305
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:50312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:50303
[S3] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:50303
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:50314
[S5] RECEIVED delta(kind=head bytes=1801) from S3
[S5] cosine check vs S3: cos=0.8672
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S13
[S14] cosine check vs S13: cos=0.9987
[S10] RECEIVED delta(kind=head bytes=1801) from S11
[S10] cosine check vs S11: cos=-0.0578
[S10] DROPPED delta from S11 (cos=-0.0578 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S6
[S3] cosine check vs S6: cos=0.8060
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=0.8672
[S11] RECEIVED delta(kind=head bytes=1800) from S10
[S11] cosine check vs S10: cos=-0.0578
[S11] DROPPED delta from S10 (cos=-0.0578 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=-0.0016
[S14] DROPPED delta from S17 (cos=-0.0016 < 0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=32 metric=0.9970 head_norm=1.292529
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.314105e-01
[S3] stored merged vector for next round verification (round=32)
[S3] DEBUG after merge:  round=32 metric=0.9978 head_norm=1.166386 delta_norm=0.231410
[S3] aggregate: ACCEPT kept=['S6', 'S5'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9972 head_norm=2.036648
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.273721e-02
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9972 head_norm=2.024578 delta_norm=0.052737
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.7006 head_norm=1.315893
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.362114e-01
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.7006 head_norm=1.260185 delta_norm=0.336211
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.410073 cos_to_last_merge=0.9998 (last merge round=30)
[S2] round=33 local utility u=0.136976 metrics={'f1_val': 0.7164179378626974, 'auprc': 0.7323502620881652, 'loss_val': 0.8064401426603134, 'psi': 0.7227908675528845}-{'f1_val': 0.6756612088781512, 'auprc': 0.7308325859228004, 'loss_val': 0.831299466997511, 'psi': 0.6977297596960108}
[S3] START round=33 head_norm_before_train=1.166386 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9685594499479135, 'auprc': 0.9990588922203462, 'loss_val': 0.18733552530631845, 'psi': 0.9807592268568865}-{'f1_val': 0.9969808748199115, 'auprc': 0.9997391210377922, 'loss_val': 0.10322740030357971, 'psi': 0.9980841733070638}
[S4] START round=33 head_norm_before_train=1.332603 cos_to_last_merge=0.9957 (last merge round=27)
[S4] round=33 local utility u=0.056625 metrics={'f1_val': 0.9457106065992862, 'auprc': 0.9770748427252567, 'loss_val': 0.2648328349148595, 'psi': 0.9582563010496744}-{'f1_val': 0.941278983772784, 'auprc': 0.9529288119320182, 'loss_val': 0.2790557999346432, 'psi': 0.9459389150364776}
[S5] START round=33 head_norm_before_train=1.260185 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.6685563276263454, 'auprc': 0.8296291550746289, 'loss_val': 0.4842433357418098, 'psi': 0.7329854586056588}-{'f1_val': 0.7005802511973405, 'auprc': 0.9882706325717814, 'loss_val': 0.30313044461495164, 'psi': 0.8156564037471168}
[S6] START round=33 head_norm_before_train=1.093135 cos_to_last_merge=0.9988 (last merge round=31)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7765633863207645, 'auprc': 0.9416587184646845, 'loss_val': 0.5103825530511018, 'psi': 0.8426015191783325}-{'f1_val': 0.9004555017118153, 'auprc': 0.9608240293170243, 'loss_val': 0.4446730375761942, 'psi': 0.9246029127538988}
[S7] START round=33 head_norm_before_train=1.168617 cos_to_last_merge=0.9993 (last merge round=31)
[S7] round=33 local utility u=0.224161 metrics={'f1_val': 0.5188283784505912, 'auprc': 0.7809510661675502, 'loss_val': 0.8871886121220041, 'psi': 0.6236774535373748}-{'f1_val': 0.45573040033798967, 'auprc': 0.7781330359454233, 'loss_val': 0.9484682367283411, 'psi': 0.5846914545809632}
[S8] START round=33 head_norm_before_train=1.306804 cos_to_last_merge=0.9998 (last merge round=31)
[S8] round=33 local utility u=0.019695 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9983405223795213, 'loss_val': 0.07377450950909105, 'psi': 0.9970580709919002}-{'f1_val': 0.9941775362873223, 'auprc': 0.9977772608416778, 'loss_val': 0.0993206673152, 'psi': 0.9956174261090646}
[S9] START round=33 head_norm_before_train=2.060093 (no previous merge yet)
[S9] round=33 local utility u=0.010491 metrics={'f1_val': 0.9959523101139645, 'auprc': 0.9984622625532427, 'loss_val': 0.02014952942297554, 'psi': 0.9969562910896758}-{'f1_val': 0.9934493384257997, 'auprc': 0.9990804922073009, 'loss_val': 0.027968071768950734, 'psi': 0.9957017999384002}
[S10] START round=33 head_norm_before_train=1.953062 (no previous merge yet)
[S10] round=33 local utility u=0.001160 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.9934525739477824, 'loss_val': 0.033359718031098474, 'psi': 0.9949045553133686}-{'f1_val': 0.9955978191757338, 'auprc': 0.9935285572256198, 'loss_val': 0.03425858608122014, 'psi': 0.9947701143956882}
[S11] START round=33 head_norm_before_train=2.028647 (no previous merge yet)
[S11] round=33 local utility u=0.000405 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9989240385979256, 'loss_val': 0.024567675070815986, 'psi': 0.9975100978228985}-{'f1_val': 0.996567470639547, 'auprc': 0.9989328358083223, 'loss_val': 0.025404351206416112, 'psi': 0.9975136167070571}
[S13] START round=33 head_norm_before_train=2.013817 cos_to_last_merge=0.9992 (last merge round=26)
[S13] round=33 local utility u=0.148348 metrics={'f1_val': 0.6365391115304415, 'auprc': 0.7506097913055128, 'loss_val': 0.8992177934093198, 'psi': 0.68216738344047}-{'f1_val': 0.5945583038586056, 'auprc': 0.7225389079308093, 'loss_val': 0.8598172498879532, 'psi': 0.6457505454874871}
[S14] START round=33 head_norm_before_train=2.024578 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9970334363251732, 'loss_val': 0.02610725694842242, 'psi': 0.9970138024586159}-{'f1_val': 0.9972435617623723, 'auprc': 0.9987496907400979, 'loss_val': 0.024069545250194446, 'psi': 0.9978460133534626}
[S15] START round=33 head_norm_before_train=1.996851 (no previous merge yet)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9903765087746887, 'loss_val': 0.023913765116063666, 'psi': 0.9941986045423878}-{'f1_val': 0.9970299290849798, 'auprc': 0.9966464426123467, 'loss_val': 0.03538549176800481, 'psi': 0.9968765344959265}
[S16] START round=33 head_norm_before_train=1.333884 cos_to_last_merge=0.9998 (last merge round=31)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8435979769598273, 'auprc': 0.874569779158913, 'loss_val': 0.7859329068763429, 'psi': 0.8559866978394616}-{'f1_val': 0.851230940819134, 'auprc': 0.9923143623430211, 'loss_val': 0.6600732837471015, 'psi': 0.9076643094286888}
[S17] START round=33 head_norm_before_train=1.930983 (no previous merge yet)
[S17] round=33 local utility u=0.322311 metrics={'f1_val': 0.6364072821041955, 'auprc': 0.9652622892287004, 'loss_val': 0.9157338741338021, 'psi': 0.7679492849539975}-{'f1_val': 0.6044706191901998, 'auprc': 0.8882876132704782, 'loss_val': 1.1378110179042675, 'psi': 0.7179974168223112}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:50312
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:50316
[S2] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:50307
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:50314
[S5] RECEIVED delta(kind=head bytes=1797) from S2
[S5] cosine check vs S2: cos=0.8530
[S7] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S11
[S10] cosine check vs S11: cos=-0.0587
[S10] DROPPED delta from S11 (cos=-0.0587 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] cosine check vs S7: cos=0.8289
[S16] RECEIVED delta(kind=head bytes=1797) from S4
[S16] cosine check vs S4: cos=0.9901
[S7] RECEIVED delta(kind=head bytes=1801) from S8
[S7] cosine check vs S8: cos=0.9273
[S14] RECEIVED delta(kind=head bytes=1798) from S13
[S14] cosine check vs S13: cos=0.9994
[S11] RECEIVED delta(kind=head bytes=1802) from S10
[S11] cosine check vs S10: cos=-0.0587
[S11] DROPPED delta from S10 (cos=-0.0587 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=-0.0023
[S14] DROPPED delta from S17 (cos=-0.0023 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.6686 head_norm=1.300820
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.734097e-01
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.6750 head_norm=1.309884 delta_norm=0.373410
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.9970 head_norm=2.037071
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.598215e-02
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.9970 head_norm=2.029181 delta_norm=0.035982
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.7766 head_norm=1.132960
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.419912e-01
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.7646 head_norm=1.113882 delta_norm=0.341991
[S6] aggregate: ROLLBACK (f1_val pre=0.777 post=0.765 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=33 metric=0.5188 head_norm=1.196572
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.500684e-01
[S7] stored merged vector for next round verification (round=33)
[S7] DEBUG after merge:  round=33 metric=0.5294 head_norm=1.241171 delta_norm=0.250068
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.8436 head_norm=1.363228
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.566624e-02
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.8429 head_norm=1.356603 delta_norm=0.095666
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.420680 cos_to_last_merge=0.9996 (last merge round=30)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6639079401071045, 'auprc': 0.7126560060018311, 'loss_val': 0.8794027305268783, 'psi': 0.6834071664649952}-{'f1_val': 0.7164179378626974, 'auprc': 0.7323502620881652, 'loss_val': 0.8064401426603134, 'psi': 0.7227908675528845}
[S3] START round=34 head_norm_before_train=1.208803 cos_to_last_merge=0.9994 (last merge round=32)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9396996737046746, 'auprc': 0.996431291990175, 'loss_val': 0.19856266200346784, 'psi': 0.9623923210188747}-{'f1_val': 0.9685594499479135, 'auprc': 0.9990588922203462, 'loss_val': 0.18733552530631845, 'psi': 0.9807592268568865}
[S4] START round=34 head_norm_before_train=1.356708 cos_to_last_merge=0.9943 (last merge round=27)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.809945077365898, 'auprc': 0.9346256443309426, 'loss_val': 0.4266252250915647, 'psi': 0.8598173041519159}-{'f1_val': 0.9457106065992862, 'auprc': 0.9770748427252567, 'loss_val': 0.2648328349148595, 'psi': 0.9582563010496744}
[S5] START round=34 head_norm_before_train=1.309884 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.6201402623977791, 'auprc': 0.8408213979236799, 'loss_val': 0.5735631835493323, 'psi': 0.7084127166081395}-{'f1_val': 0.6685563276263454, 'auprc': 0.8296291550746289, 'loss_val': 0.4842433357418098, 'psi': 0.7329854586056588}
[S6] START round=34 head_norm_before_train=1.113882 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.185968 metrics={'f1_val': 0.8228321636258997, 'auprc': 0.953399724043561, 'loss_val': 0.4512813654104891, 'psi': 0.8750591877929642}-{'f1_val': 0.7765633863207645, 'auprc': 0.9416587184646845, 'loss_val': 0.5103825530511018, 'psi': 0.8426015191783325}
[S7] START round=34 head_norm_before_train=1.241171 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=34 local utility u=0.253061 metrics={'f1_val': 0.5743603778654973, 'auprc': 0.7919596094522634, 'loss_val': 0.7472842296087998, 'psi': 0.6614000705002038}-{'f1_val': 0.5188283784505912, 'auprc': 0.7809510661675502, 'loss_val': 0.8871886121220041, 'psi': 0.6236774535373748}
[S8] START round=34 head_norm_before_train=1.332027 cos_to_last_merge=0.9995 (last merge round=31)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9950949602617258, 'auprc': 0.9985635441085102, 'loss_val': 0.06988531876835628, 'psi': 0.9964823938004396}-{'f1_val': 0.9962031034001528, 'auprc': 0.9983405223795213, 'loss_val': 0.07377450950909105, 'psi': 0.9970580709919002}
[S9] START round=34 head_norm_before_train=2.067181 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9951223056421215, 'auprc': 0.99846546722082, 'loss_val': 0.021454174314246545, 'psi': 0.9964595702736008}-{'f1_val': 0.9959523101139645, 'auprc': 0.9984622625532427, 'loss_val': 0.02014952942297554, 'psi': 0.9969562910896758}
[S10] START round=34 head_norm_before_train=1.969487 (no previous merge yet)
[S10] round=34 local utility u=0.000728 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.9935253655322019, 'loss_val': 0.032122444841710625, 'psi': 0.9949336719471364}-{'f1_val': 0.9958725428904263, 'auprc': 0.9934525739477824, 'loss_val': 0.033359718031098474, 'psi': 0.9949045553133686}
[S11] START round=34 head_norm_before_train=2.041016 (no previous merge yet)
[S11] round=34 local utility u=0.000209 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9988927439650161, 'loss_val': 0.02405513298849919, 'psi': 0.9974975799697348}-{'f1_val': 0.996567470639547, 'auprc': 0.9989240385979256, 'loss_val': 0.024567675070815986, 'psi': 0.9975100978228985}
[S13] START round=34 head_norm_before_train=2.021901 cos_to_last_merge=0.9989 (last merge round=26)
[S13] round=34 local utility u=0.070001 metrics={'f1_val': 0.6302070482241353, 'auprc': 0.7405068791045786, 'loss_val': 0.6909143516576067, 'psi': 0.6743269805763126}-{'f1_val': 0.6365391115304415, 'auprc': 0.7506097913055128, 'loss_val': 0.8992177934093198, 'psi': 0.68216738344047}
[S14] START round=34 head_norm_before_train=2.029181 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9970623733264309, 'loss_val': 0.0266451578939246, 'psi': 0.9970253772591191}-{'f1_val': 0.9970007132142444, 'auprc': 0.9970334363251732, 'loss_val': 0.02610725694842242, 'psi': 0.9970138024586159}
[S15] START round=34 head_norm_before_train=2.010234 (no previous merge yet)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7010443585704017, 'auprc': 0.9889421511883798, 'loss_val': 0.42708354710919344, 'psi': 0.816203475617593}-{'f1_val': 0.9967466683875206, 'auprc': 0.9903765087746887, 'loss_val': 0.023913765116063666, 'psi': 0.9941986045423878}
[S16] START round=34 head_norm_before_train=1.356603 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.7527190846654908, 'auprc': 0.9133430350007117, 'loss_val': 0.8223371699086316, 'psi': 0.8169686647995791}-{'f1_val': 0.8435979769598273, 'auprc': 0.874569779158913, 'loss_val': 0.7859329068763429, 'psi': 0.8559866978394616}
[S17] START round=34 head_norm_before_train=1.941941 (no previous merge yet)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6352786070446526, 'auprc': 0.9575642634618604, 'loss_val': 0.9291440773488973, 'psi': 0.7641928696115357}-{'f1_val': 0.6364072821041955, 'auprc': 0.9652622892287004, 'loss_val': 0.9157338741338021, 'psi': 0.7679492849539975}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:50312
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:50314
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:50303
[S6] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S6
[S3] cosine check vs S6: cos=0.7312
[S14] RECEIVED delta(kind=head bytes=1798) from S13
[S14] cosine check vs S13: cos=0.9997
[S11] RECEIVED delta(kind=head bytes=1805) from S10
[S11] cosine check vs S10: cos=-0.0592
[S11] DROPPED delta from S10 (cos=-0.0592 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S11
[S10] cosine check vs S11: cos=-0.0592
[S10] DROPPED delta from S11 (cos=-0.0592 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] cosine check vs S7: cos=0.8907
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=34 metric=0.9397 head_norm=1.259840
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.456460e-01
[S3] stored merged vector for next round verification (round=34)
[S3] DEBUG after merge:  round=34 metric=0.9347 head_norm=1.124656 delta_norm=0.445646
[S3] aggregate: ROLLBACK (f1_val pre=0.940 post=0.935 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.9970 head_norm=2.039865
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.649768e-02
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.9970 head_norm=2.034480 delta_norm=0.026498
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.8228 head_norm=1.157457
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.874492e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.8241 head_norm=1.176641 delta_norm=0.287449
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.428811 cos_to_last_merge=0.9994 (last merge round=30)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6086292833770517, 'auprc': 0.6888520965173103, 'loss_val': 1.317182827295432, 'psi': 0.6407184086331552}-{'f1_val': 0.6639079401071045, 'auprc': 0.7126560060018311, 'loss_val': 0.8794027305268783, 'psi': 0.6834071664649952}
[S3] START round=35 head_norm_before_train=1.124656 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=35 local utility u=0.079681 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.999700347370572, 'loss_val': 0.17573120747662171, 'psi': 0.9763723308097095}-{'f1_val': 0.9396996737046746, 'auprc': 0.996431291990175, 'loss_val': 0.19856266200346784, 'psi': 0.9623923210188747}
[S4] START round=35 head_norm_before_train=1.373507 cos_to_last_merge=0.9932 (last merge round=27)
[S4] round=35 local utility u=0.539931 metrics={'f1_val': 0.9440904909451322, 'auprc': 0.9738614385510984, 'loss_val': 0.26934382450449745, 'psi': 0.9559988699875187}-{'f1_val': 0.809945077365898, 'auprc': 0.9346256443309426, 'loss_val': 0.4266252250915647, 'psi': 0.8598173041519159}
[S5] START round=35 head_norm_before_train=1.343601 cos_to_last_merge=0.9994 (last merge round=33)
[S5] round=35 local utility u=0.554932 metrics={'f1_val': 0.6911984735985716, 'auprc': 0.9728559052452966, 'loss_val': 0.2861524434504196, 'psi': 0.8038614462572616}-{'f1_val': 0.6201402623977791, 'auprc': 0.8408213979236799, 'loss_val': 0.5735631835493323, 'psi': 0.7084127166081395}
[S6] START round=35 head_norm_before_train=1.176641 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.305407 metrics={'f1_val': 0.9180333553290181, 'auprc': 0.9552416426030983, 'loss_val': 0.4172000172135906, 'psi': 0.9329166702386502}-{'f1_val': 0.8228321636258997, 'auprc': 0.953399724043561, 'loss_val': 0.4512813654104891, 'psi': 0.8750591877929642}
[S7] START round=35 head_norm_before_train=1.262741 cos_to_last_merge=0.9995 (last merge round=33)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5416924967147805, 'auprc': 0.784348007989446, 'loss_val': 0.8202302502733758, 'psi': 0.6387547012246466}-{'f1_val': 0.5743603778654973, 'auprc': 0.7919596094522634, 'loss_val': 0.7472842296087998, 'psi': 0.6614000705002038}
[S8] START round=35 head_norm_before_train=1.353193 cos_to_last_merge=0.9991 (last merge round=31)
[S8] round=35 local utility u=0.003895 metrics={'f1_val': 0.9957412378129044, 'auprc': 0.998749125331348, 'loss_val': 0.06652949851122178, 'psi': 0.9969443928202818}-{'f1_val': 0.9950949602617258, 'auprc': 0.9985635441085102, 'loss_val': 0.06988531876835628, 'psi': 0.9964823938004396}
[S9] START round=35 head_norm_before_train=2.077878 (no previous merge yet)
[S9] round=35 local utility u=0.000227 metrics={'f1_val': 0.9951223056421215, 'auprc': 0.9985755926060313, 'loss_val': 0.021329891602396445, 'psi': 0.9965036204276854}-{'f1_val': 0.9951223056421215, 'auprc': 0.99846546722082, 'loss_val': 0.021454174314246545, 'psi': 0.9964595702736008}
[S10] START round=35 head_norm_before_train=1.981447 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9954570659705484, 'auprc': 0.9935555705193357, 'loss_val': 0.031302485986909524, 'psi': 0.9946964677900634}-{'f1_val': 0.9958725428904263, 'auprc': 0.9935253655322019, 'loss_val': 0.032122444841710625, 'psi': 0.9949336719471364}
[S11] START round=35 head_norm_before_train=2.052594 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9951227841624052, 'auprc': 0.9988582793509945, 'loss_val': 0.028252160507866105, 'psi': 0.9966169822378409}-{'f1_val': 0.996567470639547, 'auprc': 0.9988927439650161, 'loss_val': 0.02405513298849919, 'psi': 0.9974975799697348}
[S13] START round=35 head_norm_before_train=2.029427 cos_to_last_merge=0.9987 (last merge round=26)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5691333517762122, 'auprc': 0.7584632195565739, 'loss_val': 1.0871895566527, 'psi': 0.6448652988883569}-{'f1_val': 0.6302070482241353, 'auprc': 0.7405068791045786, 'loss_val': 0.6909143516576067, 'psi': 0.6743269805763126}
[S14] START round=35 head_norm_before_train=2.034480 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.002369 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9971027074766017, 'loss_val': 0.023484976382412745, 'psi': 0.997187220048064}-{'f1_val': 0.9970007132142444, 'auprc': 0.9970623733264309, 'loss_val': 0.0266451578939246, 'psi': 0.9970253772591191}
[S15] START round=35 head_norm_before_train=2.023234 (no previous merge yet)
[S15] round=35 local utility u=1.000000 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9981733941011428, 'loss_val': 0.01853790014588186, 'psi': 0.9975397097573172}-{'f1_val': 0.7010443585704017, 'auprc': 0.9889421511883798, 'loss_val': 0.42708354710919344, 'psi': 0.816203475617593}
[S16] START round=35 head_norm_before_train=1.382889 cos_to_last_merge=0.9999 (last merge round=33)
[S16] round=35 local utility u=1.000000 metrics={'f1_val': 0.9652509662650669, 'auprc': 0.9932903715425074, 'loss_val': 0.12409698379937191, 'psi': 0.9764667283760431}-{'f1_val': 0.7527190846654908, 'auprc': 0.9133430350007117, 'loss_val': 0.8223371699086316, 'psi': 0.8169686647995791}
[S17] START round=35 head_norm_before_train=1.954810 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6239526609285356, 'auprc': 0.914292632677096, 'loss_val': 1.1479278326002265, 'psi': 0.7400886496279598}-{'f1_val': 0.6352786070446526, 'auprc': 0.9575642634618604, 'loss_val': 0.9291440773488973, 'psi': 0.7641928696115357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:50305
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:50303
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:50317
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:50303
[S3] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:50308
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:50316
[S5] RECEIVED delta(kind=head bytes=1806) from S3
[S5] cosine check vs S3: cos=0.7353
[S8] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=0.7353
[S8] RECEIVED delta(kind=head bytes=1803) from S16
[S8] cosine check vs S16: cos=0.9732
[S16] RECEIVED delta(kind=head bytes=1796) from S4
[S16] cosine check vs S4: cos=0.9954
[S7] RECEIVED delta(kind=head bytes=1802) from S8
[S7] cosine check vs S8: cos=0.9733
[S17] RECEIVED delta(kind=head bytes=1798) from S14
[S17] cosine check vs S14: cos=-0.0035
[S17] DROPPED delta from S14 (cos=-0.0035 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1803) from S6
[S3] cosine check vs S6: cos=0.8441
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.099 → S5@127.0.0.1:50305
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=35 metric=0.9608 head_norm=1.191185
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.919145e-01
[S3] stored merged vector for next round verification (round=35)
[S3] DEBUG after merge:  round=35 metric=0.9608 head_norm=1.117524 delta_norm=0.191914
[S3] aggregate: ACCEPT kept=['S5', 'S6'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.070 → S5@127.0.0.1:50305
[S11] ⇄ pheromone p=0.008 → S10@127.0.0.1:50311
[S10] ⇄ pheromone p=0.008 → S11@127.0.0.1:50312
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.5417 head_norm=1.285880
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.597007e-01
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.5569 head_norm=1.321205 delta_norm=0.159701
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.132 → S6@127.0.0.1:50307
[S13] ⇄ pheromone p=0.063 → S14@127.0.0.1:50314
[S4] ⇄ pheromone p=0.132 → S16@127.0.0.1:50316
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.6912 head_norm=1.369179
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.730273e-01
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.6872 head_norm=1.192909 delta_norm=0.473027
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.261 → S2@127.0.0.1:50302
[S6] ⇄ pheromone p=0.248 → S3@127.0.0.1:50303
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=35 metric=0.9653 head_norm=1.405166
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.717612e-02
[S16] stored merged vector for next round verification (round=35)
[S16] DEBUG after merge:  round=35 metric=0.9642 head_norm=1.395115 delta_norm=0.067176
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.283 → S8@127.0.0.1:50309
[S14] ⇄ pheromone p=0.018 → S17@127.0.0.1:50317
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9957 head_norm=1.374295
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.615876e-01
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9957 head_norm=1.380391 delta_norm=0.161588
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.017 → S7@127.0.0.1:50308
[S17] ⇄ pheromone p=0.127 → S14@127.0.0.1:50314
[S2] START round=36 head_norm_before_train=1.435687 cos_to_last_merge=0.9992 (last merge round=30)
[S2] round=36 local utility u=0.627495 metrics={'f1_val': 0.7025884668007494, 'auprc': 0.7354652552114276, 'loss_val': 0.7657874742260056, 'psi': 0.7157391821650206}-{'f1_val': 0.6086292833770517, 'auprc': 0.6888520965173103, 'loss_val': 1.317182827295432, 'psi': 0.6407184086331552}
[S3] START round=36 head_norm_before_train=1.117524 cos_to_last_merge=1.0000 (last merge round=35)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9585412103933568, 'auprc': 0.9971295308959846, 'loss_val': 0.17791196206565144, 'psi': 0.9739765385944079}-{'f1_val': 0.9608203197691346, 'auprc': 0.999700347370572, 'loss_val': 0.17573120747662171, 'psi': 0.9763723308097095}
[S4] START round=36 head_norm_before_train=1.388244 cos_to_last_merge=0.9922 (last merge round=27)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.940034809362639, 'auprc': 0.953205395164952, 'loss_val': 0.28379334665328193, 'psi': 0.9453030436835641}-{'f1_val': 0.9440904909451322, 'auprc': 0.9738614385510984, 'loss_val': 0.26934382450449745, 'psi': 0.9559988699875187}
[S5] START round=36 head_norm_before_train=1.192909 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.477206 metrics={'f1_val': 0.8536697867598855, 'auprc': 0.9726826690793959, 'loss_val': 0.3060477703592286, 'psi': 0.9012749396876897}-{'f1_val': 0.6911984735985716, 'auprc': 0.9728559052452966, 'loss_val': 0.2861524434504196, 'psi': 0.8038614462572616}
[S6] START round=36 head_norm_before_train=1.218062 cos_to_last_merge=0.9969 (last merge round=34)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.6315232096598473, 'auprc': 0.8056440329195371, 'loss_val': 0.6346195620225457, 'psi': 0.7011715389637232}-{'f1_val': 0.9180333553290181, 'auprc': 0.9552416426030983, 'loss_val': 0.4172000172135906, 'psi': 0.9329166702386502}
[S7] START round=36 head_norm_before_train=1.321205 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=0.427140 metrics={'f1_val': 0.6370652554876424, 'auprc': 0.8041743837234133, 'loss_val': 0.5976659727666842, 'psi': 0.7039089067819507}-{'f1_val': 0.5416924967147805, 'auprc': 0.784348007989446, 'loss_val': 0.8202302502733758, 'psi': 0.6387547012246466}
[S8] START round=36 head_norm_before_train=1.380391 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9939988207001527, 'auprc': 0.9987639451896668, 'loss_val': 0.06331178813848815, 'psi': 0.9959048704959583}-{'f1_val': 0.9957412378129044, 'auprc': 0.998749125331348, 'loss_val': 0.06652949851122178, 'psi': 0.9969443928202818}
[S9] START round=36 head_norm_before_train=2.084917 (no previous merge yet)
[S9] round=36 local utility u=0.002052 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9964551052897291, 'loss_val': 0.020094045272566873, 'psi': 0.9965783492042265}-{'f1_val': 0.9951223056421215, 'auprc': 0.9985755926060313, 'loss_val': 0.021329891602396445, 'psi': 0.9965036204276854}
[S10] START round=36 head_norm_before_train=1.994505 (no previous merge yet)
[S10] round=36 local utility u=0.000948 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.9929756849577543, 'loss_val': 0.030159386696581372, 'psi': 0.9947137997173574}-{'f1_val': 0.9954570659705484, 'auprc': 0.9935555705193357, 'loss_val': 0.031302485986909524, 'psi': 0.9946964677900634}
[S11] START round=36 head_norm_before_train=2.064088 (no previous merge yet)
[S11] round=36 local utility u=0.007143 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9989198481903965, 'loss_val': 0.022818939410359857, 'psi': 0.9975084216598868}-{'f1_val': 0.9951227841624052, 'auprc': 0.9988582793509945, 'loss_val': 0.028252160507866105, 'psi': 0.9966169822378409}
[S13] START round=36 head_norm_before_train=2.035850 cos_to_last_merge=0.9985 (last merge round=26)
[S13] round=36 local utility u=0.231144 metrics={'f1_val': 0.626564673997468, 'auprc': 0.7627572101450604, 'loss_val': 0.9823720655887108, 'psi': 0.6810416884565049}-{'f1_val': 0.5691333517762122, 'auprc': 0.7584632195565739, 'loss_val': 1.0871895566527, 'psi': 0.6448652988883569}
[S14] START round=36 head_norm_before_train=2.042564 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=36 local utility u=0.005593 metrics={'f1_val': 0.997871830388708, 'auprc': 0.9988010744034725, 'loss_val': 0.021164578805688936, 'psi': 0.9982435279946138}-{'f1_val': 0.9972435617623723, 'auprc': 0.9971027074766017, 'loss_val': 0.023484976382412745, 'psi': 0.997187220048064}
[S15] START round=36 head_norm_before_train=2.032822 (no previous merge yet)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.9662409873460617, 'auprc': 0.9977694129210082, 'loss_val': 0.05271389995223637, 'psi': 0.9788523575760403}-{'f1_val': 0.9971172535281002, 'auprc': 0.9981733941011428, 'loss_val': 0.01853790014588186, 'psi': 0.9975397097573172}
[S16] START round=36 head_norm_before_train=1.395115 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.8268143808071998, 'auprc': 0.8593246397630896, 'loss_val': 0.9519707923819878, 'psi': 0.8398184843895558}-{'f1_val': 0.9652509662650669, 'auprc': 0.9932903715425074, 'loss_val': 0.12409698379937191, 'psi': 0.9764667283760431}
[S17] START round=36 head_norm_before_train=1.968560 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6293266468721218, 'auprc': 0.8744247799801046, 'loss_val': 1.132113371650872, 'psi': 0.727365900115315}-{'f1_val': 0.6239526609285356, 'auprc': 0.914292632677096, 'loss_val': 1.1479278326002265, 'psi': 0.7400886496279598}
[S3]  timeout peer S4
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S15
[S14]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S9
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S7]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S15
[S17]  timeout peer S16
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:50305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:50314
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:50302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:50317
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:50312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:50307
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:50311
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S11
[S10] cosine check vs S11: cos=-0.0601
[S10] DROPPED delta from S11 (cos=-0.0601 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S14
[S17] cosine check vs S14: cos=-0.0040
[S17] DROPPED delta from S14 (cos=-0.0040 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1806) from S5
[S2] cosine check vs S5: cos=0.8412
[S14] RECEIVED delta(kind=head bytes=1798) from S13
[S14] cosine check vs S13: cos=0.9998
[S11] RECEIVED delta(kind=head bytes=1798) from S10
[S11] cosine check vs S10: cos=-0.0601
[S11] DROPPED delta from S10 (cos=-0.0601 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.9979 head_norm=2.050267
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.269426e-02
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.9979 head_norm=2.044841 delta_norm=0.022694
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=0.8412
[S7] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S7
[S6] cosine check vs S7: cos=0.9245
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=36 metric=0.7026 head_norm=1.442761
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.902639e-01
[S2] stored merged vector for next round verification (round=36)
[S2] DEBUG after merge:  round=36 metric=0.7059 head_norm=1.286428 delta_norm=0.390264
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] CommDone barrier timeout: have=2 need=3 — continuing
[S2] START round=37 head_norm_before_train=1.286428 cos_to_last_merge=1.0000 (last merge round=36)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.6028105683268111, 'auprc': 0.7298155534247901, 'loss_val': 0.9513481489388577, 'psi': 0.6536125623660027}-{'f1_val': 0.7025884668007494, 'auprc': 0.7354652552114276, 'loss_val': 0.7657874742260056, 'psi': 0.7157391821650206}
[S3] START round=37 head_norm_before_train=1.206444 cos_to_last_merge=0.9964 (last merge round=35)
[S3] round=37 local utility u=0.168955 metrics={'f1_val': 0.9975552686373071, 'auprc': 0.9996624195168706, 'loss_val': 0.0816846148598776, 'psi': 0.9983981289891326}-{'f1_val': 0.9585412103933568, 'auprc': 0.9971295308959846, 'loss_val': 0.17791196206565144, 'psi': 0.9739765385944079}
[S4] START round=37 head_norm_before_train=1.403267 cos_to_last_merge=0.9912 (last merge round=27)
[S4] round=37 local utility u=0.069867 metrics={'f1_val': 0.9501541100614448, 'auprc': 0.9724130371665483, 'loss_val': 0.262398331811519, 'psi': 0.9590576809034861}-{'f1_val': 0.940034809362639, 'auprc': 0.953205395164952, 'loss_val': 0.28379334665328193, 'psi': 0.9453030436835641}
[S5] START round=37 head_norm_before_train=1.238082 cos_to_last_merge=0.9987 (last merge round=35)
[S5] round=37 local utility u=0.516620 metrics={'f1_val': 0.995996280939491, 'auprc': 0.9894672776997709, 'loss_val': 0.17711962530719685, 'psi': 0.993384679643603}-{'f1_val': 0.8536697867598855, 'auprc': 0.9726826690793959, 'loss_val': 0.3060477703592286, 'psi': 0.9012749396876897}
[S6] START round=37 head_norm_before_train=1.259063 cos_to_last_merge=0.9902 (last merge round=34)
[S6] round=37 local utility u=0.851172 metrics={'f1_val': 0.8061654588726509, 'auprc': 0.944029367680983, 'loss_val': 0.39528444456874345, 'psi': 0.8613110223959837}-{'f1_val': 0.6315232096598473, 'auprc': 0.8056440329195371, 'loss_val': 0.6346195620225457, 'psi': 0.7011715389637232}
[S7] START round=37 head_norm_before_train=1.337426 cos_to_last_merge=0.9997 (last merge round=35)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.6320530302957348, 'auprc': 0.8055650694220833, 'loss_val': 0.6003412851659563, 'psi': 0.7014578459462741}-{'f1_val': 0.6370652554876424, 'auprc': 0.8041743837234133, 'loss_val': 0.5976659727666842, 'psi': 0.7039089067819507}
[S8] START round=37 head_norm_before_train=1.401046 cos_to_last_merge=0.9999 (last merge round=35)
[S8] round=37 local utility u=0.001189 metrics={'f1_val': 0.9942129748679404, 'auprc': 0.9970401738316734, 'loss_val': 0.05704663942017328, 'psi': 0.9953438544534337}-{'f1_val': 0.9939988207001527, 'auprc': 0.9987639451896668, 'loss_val': 0.06331178813848815, 'psi': 0.9959048704959583}
[S9] START round=37 head_norm_before_train=2.094343 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9892428323638103, 'auprc': 0.9993912732035155, 'loss_val': 0.03780867773154773, 'psi': 0.9933022086996923}-{'f1_val': 0.9966605118138915, 'auprc': 0.9964551052897291, 'loss_val': 0.020094045272566873, 'psi': 0.9965783492042265}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=2.008102 (no previous merge yet)
[S10] round=37 local utility u=0.000964 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.9935504841264219, 'loss_val': 0.02995530463947742, 'psi': 0.9949437193848245}-{'f1_val': 0.9958725428904263, 'auprc': 0.9929756849577543, 'loss_val': 0.030159386696581372, 'psi': 0.9947137997173574}
[S11] START round=37 head_norm_before_train=2.074443 (no previous merge yet)
[S11] round=37 local utility u=0.000096 metrics={'f1_val': 0.996567470639547, 'auprc': 0.998830703430055, 'loss_val': 0.02235950382682725, 'psi': 0.9974727637557502}-{'f1_val': 0.996567470639547, 'auprc': 0.9989198481903965, 'loss_val': 0.022818939410359857, 'psi': 0.9975084216598868}
[S13] START round=37 head_norm_before_train=2.039652 cos_to_last_merge=0.9984 (last merge round=26)
[S13] round=37 local utility u=0.254637 metrics={'f1_val': 0.6897857458940219, 'auprc': 0.7551233564776172, 'loss_val': 0.829523660770342, 'psi': 0.71592079012746}-{'f1_val': 0.626564673997468, 'auprc': 0.7627572101450604, 'loss_val': 0.9823720655887108, 'psi': 0.6810416884565049}
[S14] START round=37 head_norm_before_train=2.044841 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9971100594385134, 'loss_val': 0.02082949501529764, 'psi': 0.9975803272117343}-{'f1_val': 0.997871830388708, 'auprc': 0.9988010744034725, 'loss_val': 0.021164578805688936, 'psi': 0.9982435279946138}
[S15] START round=37 head_norm_before_train=2.039437 (no previous merge yet)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.9023467669152074, 'auprc': 0.993902195014818, 'loss_val': 0.13846367363007692, 'psi': 0.9389689381550517}-{'f1_val': 0.9662409873460617, 'auprc': 0.9977694129210082, 'loss_val': 0.05271389995223637, 'psi': 0.9788523575760403}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.413609 cos_to_last_merge=0.9999 (last merge round=35)
[S16] round=37 local utility u=0.521360 metrics={'f1_val': 0.8509220138351001, 'auprc': 0.9865270280649959, 'loss_val': 0.43550381736430377, 'psi': 0.9051640195270585}-{'f1_val': 0.8268143808071998, 'auprc': 0.8593246397630896, 'loss_val': 0.9519707923819878, 'psi': 0.8398184843895558}
[S17] START round=37 head_norm_before_train=1.983111 (no previous merge yet)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6280604079437181, 'auprc': 0.8735260999791725, 'loss_val': 1.2116406307790084, 'psi': 0.7262466847578999}-{'f1_val': 0.6293266468721218, 'auprc': 0.8744247799801046, 'loss_val': 1.132113371650872, 'psi': 0.727365900115315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:50314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:50311
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:50312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:50303
[S10] sending update (kind=head size=1797 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S5] → sending delta(kind=head bytes=1810) to S2@127.0.0.1:50302
[S10] RECEIVED delta(kind=head bytes=1796) from S11
[S10] cosine check vs S11: cos=-0.0604
[S10] DROPPED delta from S11 (cos=-0.0604 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S13
[S14] cosine check vs S13: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1795) from S4
[S16] cosine check vs S4: cos=0.9974
[S11] RECEIVED delta(kind=head bytes=1797) from S10
[S11] cosine check vs S10: cos=-0.0604
[S11] DROPPED delta from S10 (cos=-0.0604 < 0.0)
[S5] sending update (kind=head size=1810 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[S6] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S6
[S3] cosine check vs S6: cos=0.8243
[S2] RECEIVED delta(kind=head bytes=1810) from S5
[S2] cosine check vs S5: cos=0.9521
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9979 head_norm=2.051299
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.690656e-02
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9979 head_norm=2.048554 delta_norm=0.016907
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] cosine check vs S8: cos=0.9726
[S5] RECEIVED delta(kind=head bytes=1804) from S3
[S5] cosine check vs S3: cos=0.9435
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=37 metric=0.9960 head_norm=1.283106
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.294983e-01
[S5] stored merged vector for next round verification (round=37)
[S5] DEBUG after merge:  round=37 metric=0.9960 head_norm=1.254298 delta_norm=0.129498
[S5] aggregate: ACCEPT kept=['S2', 'S3'] (k=2/2) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:50304
[S16] sending update (kind=head size=1806 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1806) from S16
[S4] cosine check vs S16: cos=0.9974
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.9976 head_norm=1.278754
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.811591e-01
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.9971 head_norm=1.227897 delta_norm=0.381159
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.8509 head_norm=1.431046
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.211786e-02
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.8560 head_norm=1.421752 delta_norm=0.052118
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=37 metric=0.8062 head_norm=1.292600
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.764822e-01
[S6] stored merged vector for next round verification (round=37)
[S6] DEBUG after merge:  round=37 metric=0.8070 head_norm=1.285815 delta_norm=0.276482
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3]  timeout peer S5
[S3]  timeout peer S9
[S4]  timeout peer S16
[S7]  timeout peer S6
[S7]  timeout peer S10
[S7]  timeout peer S15
[S8]  timeout peer S4
[S8]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S13
[S13]  timeout peer S14
[S6]  timeout peer S3
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.6321 head_norm=1.356866
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.655720e-01
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.6392 head_norm=1.378847 delta_norm=0.165572
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.302386 cos_to_last_merge=0.9999 (last merge round=36)
[S2] round=38 local utility u=0.009422 metrics={'f1_val': 0.6100447302145233, 'auprc': 0.7276793663007606, 'loss_val': 0.9695009707116417, 'psi': 0.6570985846490183}-{'f1_val': 0.6028105683268111, 'auprc': 0.7298155534247901, 'loss_val': 0.9513481489388577, 'psi': 0.6536125623660027}
[S3] START round=38 head_norm_before_train=1.227897 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.999654943587575, 'loss_val': 0.15042363386183577, 'psi': 0.9765311317757215}-{'f1_val': 0.9975552686373071, 'auprc': 0.9996624195168706, 'loss_val': 0.0816846148598776, 'psi': 0.9983981289891326}
[S4] START round=38 head_norm_before_train=1.414318 cos_to_last_merge=0.9904 (last merge round=27)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9468025927760451, 'auprc': 0.9671318055363203, 'loss_val': 0.27072572204323764, 'psi': 0.9549342778801552}-{'f1_val': 0.9501541100614448, 'auprc': 0.9724130371665483, 'loss_val': 0.262398331811519, 'psi': 0.9590576809034861}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=38 metric=0.9468 head_norm=1.428147
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.607227e-02
[S4] stored merged vector for next round verification (round=38)
[S4] DEBUG after merge:  round=38 metric=0.9461 head_norm=1.428497 delta_norm=0.056072
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] START round=38 head_norm_before_train=1.254298 cos_to_last_merge=1.0000 (last merge round=37)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9846386910781622, 'loss_val': 0.36117390134516664, 'psi': 0.8141517960969387}-{'f1_val': 0.995996280939491, 'auprc': 0.9894672776997709, 'loss_val': 0.17711962530719685, 'psi': 0.993384679643603}
[S6] START round=38 head_norm_before_train=1.285815 cos_to_last_merge=1.0000 (last merge round=37)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.8211293723462305, 'auprc': 0.9416178827256602, 'loss_val': 0.49123505520442107, 'psi': 0.8693247764980023}-{'f1_val': 0.8061654588726509, 'auprc': 0.944029367680983, 'loss_val': 0.39528444456874345, 'psi': 0.8613110223959837}
[S7] START round=38 head_norm_before_train=1.378847 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.033890 metrics={'f1_val': 0.6410170951950268, 'auprc': 0.8072725270056114, 'loss_val': 0.5914678150186221, 'psi': 0.7075192679192606}-{'f1_val': 0.6320530302957348, 'auprc': 0.8055650694220833, 'loss_val': 0.6003412851659563, 'psi': 0.7014578459462741}
[S8] START round=38 head_norm_before_train=1.419923 cos_to_last_merge=0.9997 (last merge round=35)
[S8] round=38 local utility u=0.004034 metrics={'f1_val': 0.9953051132645551, 'auprc': 0.9984243400597276, 'loss_val': 0.05968306375688708, 'psi': 0.996552803982624}-{'f1_val': 0.9942129748679404, 'auprc': 0.9970401738316734, 'loss_val': 0.05704663942017328, 'psi': 0.9953438544534337}
[S9] START round=38 head_norm_before_train=2.104051 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9871043330004933, 'auprc': 0.99818032715261, 'loss_val': 0.04816402335286182, 'psi': 0.99153473066134}-{'f1_val': 0.9892428323638103, 'auprc': 0.9993912732035155, 'loss_val': 0.03780867773154773, 'psi': 0.9933022086996923}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=2.018499 (no previous merge yet)
[S10] round=38 local utility u=0.000133 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.9934029148063444, 'loss_val': 0.02924585038885333, 'psi': 0.9948846916567935}-{'f1_val': 0.9958725428904263, 'auprc': 0.9935504841264219, 'loss_val': 0.02995530463947742, 'psi': 0.9949437193848245}
[S11] START round=38 head_norm_before_train=2.084969 (no previous merge yet)
[S11] round=38 local utility u=0.000212 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9988303519475417, 'loss_val': 0.021934452930659834, 'psi': 0.9974726231627449}-{'f1_val': 0.996567470639547, 'auprc': 0.998830703430055, 'loss_val': 0.02235950382682725, 'psi': 0.9974727637557502}
[S13] START round=38 head_norm_before_train=2.045945 cos_to_last_merge=0.9981 (last merge round=26)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6418893051364499, 'auprc': 0.7801958382768341, 'loss_val': 1.0797706119883903, 'psi': 0.6972119183926037}-{'f1_val': 0.6897857458940219, 'auprc': 0.7551233564776172, 'loss_val': 0.829523660770342, 'psi': 0.71592079012746}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=2.048554 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971025526801229, 'loss_val': 0.021581426573022606, 'psi': 0.9974316919019613}-{'f1_val': 0.9978938390605482, 'auprc': 0.9971100594385134, 'loss_val': 0.02082949501529764, 'psi': 0.9975803272117343}
[S15] START round=38 head_norm_before_train=2.047132 (no previous merge yet)
[S15] round=38 local utility u=0.351978 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9989940393982918, 'loss_val': 0.01840703430997025, 'psi': 0.9978679678761768}-{'f1_val': 0.9023467669152074, 'auprc': 0.993902195014818, 'loss_val': 0.13846367363007692, 'psi': 0.9389689381550517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=38 head_norm_before_train=1.421752 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.623108 metrics={'f1_val': 0.9925570925529779, 'auprc': 0.9932542373533431, 'loss_val': 0.059278994548781605, 'psi': 0.992835950473124}-{'f1_val': 0.8509220138351001, 'auprc': 0.9865270280649959, 'loss_val': 0.43550381736430377, 'psi': 0.9051640195270585}
[S17] START round=38 head_norm_before_train=1.998996 (no previous merge yet)
[S17] round=38 local utility u=0.192577 metrics={'f1_val': 0.6468270144118407, 'auprc': 0.8794847821912599, 'loss_val': 0.956961667570608, 'psi': 0.7398901215236083}-{'f1_val': 0.6280604079437181, 'auprc': 0.8735260999791725, 'loss_val': 1.2116406307790084, 'psi': 0.7262466847578999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:50316
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:50314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:50312
[S7] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] sending update (kind=head size=1793 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1802) from S7
[S8] cosine check vs S7: cos=0.9913
[S11] RECEIVED delta(kind=head bytes=1797) from S10
[S11] cosine check vs S10: cos=-0.0608
[S11] DROPPED delta from S10 (cos=-0.0608 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S2
[S5] cosine check vs S2: cos=0.9721
[S14] RECEIVED delta(kind=head bytes=1793) from S17
[S14] cosine check vs S17: cos=-0.0030
[S14] DROPPED delta from S17 (cos=-0.0030 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S8
[S16] cosine check vs S8: cos=0.9836
[S10] RECEIVED delta(kind=head bytes=1795) from S11
[S10] cosine check vs S11: cos=-0.0608
[S10] DROPPED delta from S11 (cos=-0.0608 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] cosine check vs S16: cos=0.9999
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=38 metric=0.6100 head_norm=1.322724
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.101093e-01
[S2] stored merged vector for next round verification (round=38)
[S2] DEBUG after merge:  round=38 metric=0.6162 head_norm=1.286015 delta_norm=0.210109
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.9926 head_norm=1.435953
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.299265e-01
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.9926 head_norm=1.430385 delta_norm=0.129927
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=38 metric=0.9953 head_norm=1.436594
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.601145e-02
[S8] stored merged vector for next round verification (round=38)
[S8] DEBUG after merge:  round=38 metric=0.9953 head_norm=1.411707 delta_norm=0.096011
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.7005 head_norm=1.280621
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.552140e-01
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.7005 head_norm=1.292557 delta_norm=0.155214
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.286015 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=39 local utility u=0.327315 metrics={'f1_val': 0.6939316839754699, 'auprc': 0.7263602790001766, 'loss_val': 0.814235800004826, 'psi': 0.7069031219853525}-{'f1_val': 0.6100447302145233, 'auprc': 0.7276793663007606, 'loss_val': 0.9695009707116417, 'psi': 0.6570985846490183}
[S3] START round=39 head_norm_before_train=1.285593 cos_to_last_merge=0.9985 (last merge round=37)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9117027899539037, 'auprc': 0.9934805181208712, 'loss_val': 0.22390406326663245, 'psi': 0.9444138812206908}-{'f1_val': 0.9611152572344858, 'auprc': 0.999654943587575, 'loss_val': 0.15042363386183577, 'psi': 0.9765311317757215}
[S4] START round=39 head_norm_before_train=1.428497 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=39 local utility u=0.002951 metrics={'f1_val': 0.9460997851006584, 'auprc': 0.9706784031253728, 'loss_val': 0.27124739481711513, 'psi': 0.9559312323105442}-{'f1_val': 0.9468025927760451, 'auprc': 0.9671318055363203, 'loss_val': 0.27072572204323764, 'psi': 0.9549342778801552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=39 metric=0.9461 head_norm=1.443172
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.216552e-02
[S4] stored merged vector for next round verification (round=39)
[S4] DEBUG after merge:  round=39 metric=0.9461 head_norm=1.439515 delta_norm=0.012166
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] r=40 psi=0.956 u=0.0030 p_local=0.0635 f1=0.946 auprc=0.971 bytes=34142
[S5] START round=39 head_norm_before_train=1.292557 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.7071938683203258, 'auprc': 0.8752632050187005, 'loss_val': 0.6036340670103364, 'psi': 0.7744216029996757}-{'f1_val': 0.7004938661094564, 'auprc': 0.9846386910781622, 'loss_val': 0.36117390134516664, 'psi': 0.8141517960969387}
[S6] START round=39 head_norm_before_train=1.317718 cos_to_last_merge=0.9988 (last merge round=37)
[S6] round=39 local utility u=0.452812 metrics={'f1_val': 0.9335028024178673, 'auprc': 0.9562406878407347, 'loss_val': 0.3037206400465865, 'psi': 0.9425979565870143}-{'f1_val': 0.8211293723462305, 'auprc': 0.9416178827256602, 'loss_val': 0.49123505520442107, 'psi': 0.8693247764980023}
[S7] START round=39 head_norm_before_train=1.393006 cos_to_last_merge=0.9998 (last merge round=37)
[S7] round=39 local utility u=0.328549 metrics={'f1_val': 0.6875871940960814, 'auprc': 0.8621773226154734, 'loss_val': 0.3785053540109327, 'psi': 0.7574232455038382}-{'f1_val': 0.6410170951950268, 'auprc': 0.8072725270056114, 'loss_val': 0.5914678150186221, 'psi': 0.7075192679192606}
[S8] START round=39 head_norm_before_train=1.411707 cos_to_last_merge=1.0000 (last merge round=38)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9988694115779174, 'loss_val': 0.06332297968525974, 'psi': 0.995070599380468}-{'f1_val': 0.9953051132645551, 'auprc': 0.9984243400597276, 'loss_val': 0.05968306375688708, 'psi': 0.996552803982624}
[S9] START round=39 head_norm_before_train=2.114016 (no previous merge yet)
[S9] round=39 local utility u=0.039803 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9959769081748993, 'loss_val': 0.019283898515927822, 'psi': 0.9963870703582945}-{'f1_val': 0.9871043330004933, 'auprc': 0.99818032715261, 'loss_val': 0.04816402335286182, 'psi': 0.99153473066134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S9] r=40 psi=0.996 u=0.0398 p_local=0.0110 f1=0.997 auprc=0.996 bytes=32383
[S10] START round=39 head_norm_before_train=2.027801 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.992919335403246, 'loss_val': 0.028707458181029846, 'psi': 0.9946912598955542}-{'f1_val': 0.9958725428904263, 'auprc': 0.9934029148063444, 'loss_val': 0.02924585038885333, 'psi': 0.9948846916567935}
[S11] START round=39 head_norm_before_train=2.096251 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9487531255012639, 'auprc': 0.9988447855974849, 'loss_val': 0.1852229176257625, 'psi': 0.9687897895397523}-{'f1_val': 0.996567470639547, 'auprc': 0.9988303519475417, 'loss_val': 0.021934452930659834, 'psi': 0.9974726231627449}
[S13] START round=39 head_norm_before_train=2.052323 cos_to_last_merge=0.9979 (last merge round=26)
[S13] round=39 local utility u=0.070890 metrics={'f1_val': 0.6336279802136635, 'auprc': 0.7394575426410591, 'loss_val': 0.7662087309602877, 'psi': 0.6759598051846218}-{'f1_val': 0.6418893051364499, 'auprc': 0.7801958382768341, 'loss_val': 1.0797706119883903, 'psi': 0.6972119183926037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S13] r=40 psi=0.676 u=0.0709 p_local=0.0963 f1=0.634 auprc=0.739 bytes=34143
[S14] START round=39 head_norm_before_train=2.057095 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9987404211341825, 'loss_val': 0.028143156894403176, 'psi': 0.9980736342906094}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971025526801229, 'loss_val': 0.021581426573022606, 'psi': 0.9974316919019613}
[S15] START round=39 head_norm_before_train=2.054889 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.9024734609139418, 'auprc': 0.9972953858000101, 'loss_val': 0.18755619194759873, 'psi': 0.940402230868369}-{'f1_val': 0.9971172535281002, 'auprc': 0.9989940393982918, 'loss_val': 0.01840703430997025, 'psi': 0.9978679678761768}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.940 u=0.0000 p_local=0.1810 f1=0.902 auprc=0.997 bytes=34157
[S16] START round=39 head_norm_before_train=1.430385 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8822519875416224, 'auprc': 0.9880709819198795, 'loss_val': 0.5023506846987041, 'psi': 0.9245795852929253}-{'f1_val': 0.9925570925529779, 'auprc': 0.9932542373533431, 'loss_val': 0.059278994548781605, 'psi': 0.992835950473124}
[S17] START round=39 head_norm_before_train=2.012652 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6265586980663934, 'auprc': 0.8552282769590165, 'loss_val': 1.2838064181784985, 'psi': 0.7180265296234427}-{'f1_val': 0.6468270144118407, 'auprc': 0.8794847821912599, 'loss_val': 0.956961667570608, 'psi': 0.7398901215236083}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.757)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.707)
[S2] r=40 psi=0.707 u=0.3273 p_local=0.1716 f1=0.694 auprc=0.726 bytes=34164
[S6] sending update (kind=head size=1801 to 1 peers)
[S11] r=40 psi=0.969 u=0.0000 p_local=0.0041 f1=0.949 auprc=0.999 bytes=44922
[S17] r=40 psi=0.718 u=0.0000 p_local=0.0828 f1=0.627 auprc=0.855 bytes=30550
[S3] r=40 psi=0.944 u=0.0000 p_local=0.0502 f1=0.912 auprc=0.993 bytes=32394
[S7] r=40 psi=0.757 u=0.3285 p_local=0.1688 f1=0.688 auprc=0.862 bytes=32371
[S16] r=40 psi=0.925 u=0.0000 p_local=0.2825 f1=0.882 auprc=0.988 bytes=34185
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.995 u=0.0000 p_local=0.0080 f1=0.993 auprc=0.999 bytes=34184
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0037 f1=0.996 auprc=0.993 bytes=46767
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] cosine check vs S6: cos=0.9436
[S6] r=40 psi=0.943 u=0.4528 p_local=0.3010 f1=0.934 auprc=0.956 bytes=34164
[S14] r=40 psi=0.998 u=0.0000 p_local=0.0080 f1=0.998 auprc=0.999 bytes=37752
[S5] r=40 psi=0.774 u=0.0000 p_local=0.2221 f1=0.707 auprc=0.875 bytes=30587
[S2] START round=40 head_norm_before_train=1.307961 cos_to_last_merge=0.9997 (last merge round=38)
[S2] round=40 local utility u=0.038167 metrics={'f1_val': 0.7061728182400482, 'auprc': 0.7260091376980591, 'loss_val': 0.8102942822056236, 'psi': 0.7141073460232525}-{'f1_val': 0.6939316839754699, 'auprc': 0.7263602790001766, 'loss_val': 0.814235800004826, 'psi': 0.7069031219853525}
[S3] START round=40 head_norm_before_train=1.345710 cos_to_last_merge=0.9947 (last merge round=37)
[S3] round=40 local utility u=0.028410 metrics={'f1_val': 0.9206075825351991, 'auprc': 0.9883970262104749, 'loss_val': 0.20526278658724997, 'psi': 0.9477233600053094}-{'f1_val': 0.9117027899539037, 'auprc': 0.9934805181208712, 'loss_val': 0.22390406326663245, 'psi': 0.9444138812206908}
[S4] START round=40 head_norm_before_train=1.439515 cos_to_last_merge=1.0000 (last merge round=39)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.938104223900665, 'auprc': 0.9338430845172577, 'loss_val': 0.327918765909932, 'psi': 0.936399768147302}-{'f1_val': 0.9460997851006584, 'auprc': 0.9706784031253728, 'loss_val': 0.27124739481711513, 'psi': 0.9559312323105442}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.314812 cos_to_last_merge=0.9996 (last merge round=38)
[S5] round=40 local utility u=0.246724 metrics={'f1_val': 0.6988624099127507, 'auprc': 0.9656081344438621, 'loss_val': 0.33123230009245197, 'psi': 0.8055606997251953}-{'f1_val': 0.7071938683203258, 'auprc': 0.8752632050187005, 'loss_val': 0.6036340670103364, 'psi': 0.7744216029996757}
[S6] START round=40 head_norm_before_train=1.352030 cos_to_last_merge=0.9957 (last merge round=37)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.5777703931845608, 'auprc': 0.7571844891107582, 'loss_val': 0.8316077492206289, 'psi': 0.6495360315550398}-{'f1_val': 0.9335028024178673, 'auprc': 0.9562406878407347, 'loss_val': 0.3037206400465865, 'psi': 0.9425979565870143}
[S7] START round=40 head_norm_before_train=1.406321 cos_to_last_merge=0.9992 (last merge round=37)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6849900205834148, 'auprc': 0.8529850673866749, 'loss_val': 0.3761483555518187, 'psi': 0.7521880393047189}-{'f1_val': 0.6875871940960814, 'auprc': 0.8621773226154734, 'loss_val': 0.3785053540109327, 'psi': 0.7574232455038382}
[S8] START round=40 head_norm_before_train=1.426259 cos_to_last_merge=1.0000 (last merge round=38)
[S8] round=40 local utility u=0.008123 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9991032230803579, 'loss_val': 0.05215327281021028, 'psi': 0.9956016911530672}-{'f1_val': 0.9925380579155019, 'auprc': 0.9988694115779174, 'loss_val': 0.06332297968525974, 'psi': 0.995070599380468}
[S9] START round=40 head_norm_before_train=2.114229 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9896852703122735, 'auprc': 0.9988044973716413, 'loss_val': 0.03398021866831123, 'psi': 0.9933329611360207}-{'f1_val': 0.9966605118138915, 'auprc': 0.9959769081748993, 'loss_val': 0.019283898515927822, 'psi': 0.9963870703582945}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.038311 (no previous merge yet)
[S10] round=40 local utility u=0.000279 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.9932055148923958, 'loss_val': 0.029007585762844863, 'psi': 0.994805731691214}-{'f1_val': 0.9958725428904263, 'auprc': 0.992919335403246, 'loss_val': 0.028707458181029846, 'psi': 0.9946912598955542}
[S11] START round=40 head_norm_before_train=2.105309 (no previous merge yet)
[S11] round=40 local utility u=0.225438 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9988448847663745, 'loss_val': 0.021234018014448467, 'psi': 0.997478436290278}-{'f1_val': 0.9487531255012639, 'auprc': 0.9988447855974849, 'loss_val': 0.1852229176257625, 'psi': 0.9687897895397523}
[S13] START round=40 head_norm_before_train=2.057069 cos_to_last_merge=0.9978 (last merge round=26)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6287466306394405, 'auprc': 0.7607641859936921, 'loss_val': 0.957976514140389, 'psi': 0.6815536527811411}-{'f1_val': 0.6336279802136635, 'auprc': 0.7394575426410591, 'loss_val': 0.7662087309602877, 'psi': 0.6759598051846218}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=2.065972 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=40 local utility u=0.004021 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9991916983298903, 'loss_val': 0.021603216361707443, 'psi': 0.9982689850215297}-{'f1_val': 0.9976291097282272, 'auprc': 0.9987404211341825, 'loss_val': 0.028143156894403176, 'psi': 0.9980736342906094}
[S15] START round=40 head_norm_before_train=2.062582 (no previous merge yet)
[S15] round=40 local utility u=0.004842 metrics={'f1_val': 0.9030444739236343, 'auprc': 0.9973883426472594, 'loss_val': 0.18157804027159893, 'psi': 0.9407820214130844}-{'f1_val': 0.9024734609139418, 'auprc': 0.9972953858000101, 'loss_val': 0.18755619194759873, 'psi': 0.940402230868369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=40 head_norm_before_train=1.445881 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=40 local utility u=0.315111 metrics={'f1_val': 0.9394514970204144, 'auprc': 0.9919609253984273, 'loss_val': 0.22699654525150179, 'psi': 0.9604552683716195}-{'f1_val': 0.8822519875416224, 'auprc': 0.9880709819198795, 'loss_val': 0.5023506846987041, 'psi': 0.9245795852929253}
[S17] START round=40 head_norm_before_train=2.023043 (no previous merge yet)
[S17] round=40 local utility u=0.078499 metrics={'f1_val': 0.6324997107992694, 'auprc': 0.8353310402689172, 'loss_val': 1.1027627781262315, 'psi': 0.7136322425871285}-{'f1_val': 0.6265586980663934, 'auprc': 0.8552282769590165, 'loss_val': 1.2838064181784985, 'psi': 0.7180265296234427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:50314
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:50312
[S10] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1795 to 1 peers)
[S6] ⇄ pheromone p=0.241 → S7@127.0.0.1:50308
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=40 metric=0.6850 head_norm=1.419343
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.313446e-01
[S7] stored merged vector for next round verification (round=40)
[S7] DEBUG after merge:  round=40 metric=0.6830 head_norm=1.366653 delta_norm=0.231345
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.135 → S8@127.0.0.1:50309
[S11] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:50302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:50317
[S10] RECEIVED delta(kind=head bytes=1794) from S11
[S10] cosine check vs S11: cos=-0.0618
[S10] DROPPED delta from S11 (cos=-0.0618 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1794) from S16
[S4] cosine check vs S16: cos=0.9948
[S14] RECEIVED delta(kind=head bytes=1795) from S17
[S14] cosine check vs S17: cos=-0.0023
[S14] DROPPED delta from S17 (cos=-0.0023 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] cosine check vs S3: cos=0.8896
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] cosine check vs S8: cos=0.9889
[S11] RECEIVED delta(kind=head bytes=1799) from S10
[S11] cosine check vs S10: cos=-0.0618
[S11] DROPPED delta from S10 (cos=-0.0618 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S2
[S5] cosine check vs S2: cos=0.9978
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=40 metric=0.9395 head_norm=1.463471
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.086824e-01
[S16] stored merged vector for next round verification (round=40)
[S16] DEBUG after merge:  round=40 metric=0.9395 head_norm=1.449100 delta_norm=0.108682
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.289 → S4@127.0.0.1:50304
[S11] ⇄ pheromone p=0.048 → S10@127.0.0.1:50311
[S14] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S17] ⇄ pheromone p=0.082 → S14@127.0.0.1:50314
[S8] ⇄ pheromone p=0.008 → S16@127.0.0.1:50316
[S3] ⇄ pheromone p=0.046 → S6@127.0.0.1:50307
[S2] ⇄ pheromone p=0.145 → S5@127.0.0.1:50305
[S10] ⇄ pheromone p=0.003 → S11@127.0.0.1:50312
[S2] RECEIVED delta(kind=head bytes=1802) from S5
[S2] cosine check vs S5: cos=0.9978
[S17] RECEIVED delta(kind=head bytes=1801) from S14
[S17] cosine check vs S14: cos=-0.0023
[S17] DROPPED delta from S14 (cos=-0.0023 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=40 metric=0.6989 head_norm=1.339106
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.465575e-02
[S5] stored merged vector for next round verification (round=40)
[S5] DEBUG after merge:  round=40 metric=0.7006 head_norm=1.339392 delta_norm=0.044656
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.227 → S2@127.0.0.1:50302
[S14] ⇄ pheromone p=0.007 → S17@127.0.0.1:50317
[S2] START round=41 head_norm_before_train=1.341166 cos_to_last_merge=0.9981 (last merge round=38)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.6264830993910548, 'auprc': 0.7182564183640259, 'loss_val': 1.0280937199827147, 'psi': 0.6631924269802433}-{'f1_val': 0.7061728182400482, 'auprc': 0.7260091376980591, 'loss_val': 0.8102942822056236, 'psi': 0.7141073460232525}
[S3] START round=41 head_norm_before_train=1.393683 cos_to_last_merge=0.9907 (last merge round=37)
[S3] round=41 local utility u=0.306732 metrics={'f1_val': 0.9945689632895839, 'auprc': 0.9994342397206197, 'loss_val': 0.06867854755591599, 'psi': 0.9965150738619981}-{'f1_val': 0.9206075825351991, 'auprc': 0.9883970262104749, 'loss_val': 0.20526278658724997, 'psi': 0.9477233600053094}
[S4] START round=41 head_norm_before_train=1.453228 cos_to_last_merge=1.0000 (last merge round=39)
[S4] round=41 local utility u=0.082291 metrics={'f1_val': 0.9433312631550368, 'auprc': 0.9613310733240344, 'loss_val': 0.27716358339398667, 'psi': 0.9505311872226359}-{'f1_val': 0.938104223900665, 'auprc': 0.9338430845172577, 'loss_val': 0.327918765909932, 'psi': 0.936399768147302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=41 metric=0.9433 head_norm=1.466331
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.953928e-02
[S4] stored merged vector for next round verification (round=41)
[S4] DEBUG after merge:  round=41 metric=0.9433 head_norm=1.462741 delta_norm=0.079539
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] START round=41 head_norm_before_train=1.339392 cos_to_last_merge=1.0000 (last merge round=40)
[S5] round=41 local utility u=1.000000 metrics={'f1_val': 0.9964092673554392, 'auprc': 0.9919076450837893, 'loss_val': 0.13534812386148787, 'psi': 0.9946086184467793}-{'f1_val': 0.6988624099127507, 'auprc': 0.9656081344438621, 'loss_val': 0.33123230009245197, 'psi': 0.8055606997251953}
[S6] START round=41 head_norm_before_train=1.383644 cos_to_last_merge=0.9919 (last merge round=37)
[S6] round=41 local utility u=1.000000 metrics={'f1_val': 0.8978935052771322, 'auprc': 0.9639639071518316, 'loss_val': 0.29518921363082934, 'psi': 0.9243216660270119}-{'f1_val': 0.5777703931845608, 'auprc': 0.7571844891107582, 'loss_val': 0.8316077492206289, 'psi': 0.6495360315550398}
[S7] START round=41 head_norm_before_train=1.366653 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.651036328708931, 'auprc': 0.8062301000470348, 'loss_val': 0.5566828036971344, 'psi': 0.7131138372441725}-{'f1_val': 0.6849900205834148, 'auprc': 0.8529850673866749, 'loss_val': 0.3761483555518187, 'psi': 0.7521880393047189}
[S8] START round=41 head_norm_before_train=1.442795 cos_to_last_merge=0.9998 (last merge round=38)
[S8] round=41 local utility u=0.004652 metrics={'f1_val': 0.9942129748679404, 'auprc': 0.9991182735169343, 'loss_val': 0.04856859163072688, 'psi': 0.9961750943275379}-{'f1_val': 0.9932673365348732, 'auprc': 0.9991032230803579, 'loss_val': 0.05215327281021028, 'psi': 0.9956016911530672}
[S9] START round=41 head_norm_before_train=2.121411 (no previous merge yet)
[S9] round=41 local utility u=0.004309 metrics={'f1_val': 0.9905411564608659, 'auprc': 0.9988034314715769, 'loss_val': 0.03049476280333771, 'psi': 0.9938460664651503}-{'f1_val': 0.9896852703122735, 'auprc': 0.9988044973716413, 'loss_val': 0.03398021866831123, 'psi': 0.9933329611360207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=41 head_norm_before_train=2.049368 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.9906004137309338, 'loss_val': 0.02794560257410275, 'psi': 0.9937636912266292}-{'f1_val': 0.9958725428904263, 'auprc': 0.9932055148923958, 'loss_val': 0.029007585762844863, 'psi': 0.994805731691214}
[S11] START round=41 head_norm_before_train=2.111880 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9989115686135406, 'loss_val': 0.022274935576750563, 'psi': 0.9975051098291445}-{'f1_val': 0.996567470639547, 'auprc': 0.9988448847663745, 'loss_val': 0.021234018014448467, 'psi': 0.997478436290278}
[S13] START round=41 head_norm_before_train=2.061857 cos_to_last_merge=0.9976 (last merge round=26)
[S13] round=41 local utility u=0.243855 metrics={'f1_val': 0.654218900768436, 'auprc': 0.7679000583460572, 'loss_val': 0.6445075409093048, 'psi': 0.6996913637994845}-{'f1_val': 0.6287466306394405, 'auprc': 0.7607641859936921, 'loss_val': 0.957976514140389, 'psi': 0.6815536527811411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=41 head_norm_before_train=2.073683 cos_to_last_merge=0.9999 (last merge round=37)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971084281309313, 'loss_val': 0.023616775236782128, 'psi': 0.9971875852758483}-{'f1_val': 0.9976538428159559, 'auprc': 0.9991916983298903, 'loss_val': 0.021603216361707443, 'psi': 0.9982689850215297}
[S15] START round=41 head_norm_before_train=2.070861 (no previous merge yet)
[S15] round=41 local utility u=0.349899 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9899453369216275, 'loss_val': 0.023362931710970942, 'psi': 0.9941960922196389}-{'f1_val': 0.9030444739236343, 'auprc': 0.9973883426472594, 'loss_val': 0.18157804027159893, 'psi': 0.9407820214130844}
[S15] not sending this round → trigger blocked (psi=0.994)
[S16] START round=41 head_norm_before_train=1.449100 cos_to_last_merge=1.0000 (last merge round=40)
[S16] round=41 local utility u=0.224022 metrics={'f1_val': 0.9873022029430034, 'auprc': 0.9955747474228747, 'loss_val': 0.07689913222590496, 'psi': 0.990611220734952}-{'f1_val': 0.9394514970204144, 'auprc': 0.9919609253984273, 'loss_val': 0.22699654525150179, 'psi': 0.9604552683716195}
[S17] START round=41 head_norm_before_train=2.031463 (no previous merge yet)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6262881491065535, 'auprc': 0.8557704663329943, 'loss_val': 1.2866660724182268, 'psi': 0.7180810759971299}-{'f1_val': 0.6324997107992694, 'auprc': 0.8353310402689172, 'loss_val': 1.1027627781262315, 'psi': 0.7136322425871285}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.997)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → trigger blocked (psi=0.995)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=41 metric=0.6265 head_norm=1.371964
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.237725e-02
[S2] stored merged vector for next round verification (round=41)
[S2] DEBUG after merge:  round=41 metric=0.6288 head_norm=1.354199 delta_norm=0.062377
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] cosine check vs S6: cos=0.9771
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=41 metric=0.8979 head_norm=1.405234
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.218275e-01
[S6] stored merged vector for next round verification (round=41)
[S6] DEBUG after merge:  round=41 metric=0.9075 head_norm=1.361963 delta_norm=0.321828
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.354199 cos_to_last_merge=1.0000 (last merge round=41)
[S2] round=42 local utility u=0.344291 metrics={'f1_val': 0.7069337023576296, 'auprc': 0.723128684583493, 'loss_val': 0.8368319947225514, 'psi': 0.713411695247975}-{'f1_val': 0.6264830993910548, 'auprc': 0.7182564183640259, 'loss_val': 1.0280937199827147, 'psi': 0.6631924269802433}
[S3] START round=42 head_norm_before_train=1.439533 cos_to_last_merge=0.9866 (last merge round=37)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.8962850033517519, 'auprc': 0.9876386576821787, 'loss_val': 0.22445667608822, 'psi': 0.9328264650839226}-{'f1_val': 0.9945689632895839, 'auprc': 0.9994342397206197, 'loss_val': 0.06867854755591599, 'psi': 0.9965150738619981}
[S4] START round=42 head_norm_before_train=1.462741 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=42 local utility u=0.019620 metrics={'f1_val': 0.9498218922271102, 'auprc': 0.9591097703908771, 'loss_val': 0.2702027679056942, 'psi': 0.9535370434926169}-{'f1_val': 0.9433312631550368, 'auprc': 0.9613310733240344, 'loss_val': 0.27716358339398667, 'psi': 0.9505311872226359}
[S4] not sending this round → trigger blocked (psi=0.954)
[S5] START round=42 head_norm_before_train=1.366942 cos_to_last_merge=0.9998 (last merge round=40)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.7006542225197299, 'auprc': 0.983732473344505, 'loss_val': 0.3515678799149909, 'psi': 0.81388552284964}-{'f1_val': 0.9964092673554392, 'auprc': 0.9919076450837893, 'loss_val': 0.13534812386148787, 'psi': 0.9946086184467793}
[S6] START round=42 head_norm_before_train=1.361963 cos_to_last_merge=1.0000 (last merge round=41)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.8219221056116066, 'auprc': 0.9270205818530259, 'loss_val': 0.43531614459535123, 'psi': 0.8639614961081743}-{'f1_val': 0.8978935052771322, 'auprc': 0.9639639071518316, 'loss_val': 0.29518921363082934, 'psi': 0.9243216660270119}
[S7] START round=42 head_norm_before_train=1.384740 cos_to_last_merge=0.9998 (last merge round=40)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.6237085514684706, 'auprc': 0.7982600475886551, 'loss_val': 0.6025675650717373, 'psi': 0.6935291499165444}-{'f1_val': 0.651036328708931, 'auprc': 0.8062301000470348, 'loss_val': 0.5566828036971344, 'psi': 0.7131138372441725}
[S8] START round=42 head_norm_before_train=1.459834 cos_to_last_merge=0.9997 (last merge round=38)
[S8] round=42 local utility u=0.000912 metrics={'f1_val': 0.9942129748679404, 'auprc': 0.9990679511874689, 'loss_val': 0.04659397627883822, 'psi': 0.9961549653957518}-{'f1_val': 0.9942129748679404, 'auprc': 0.9991182735169343, 'loss_val': 0.04856859163072688, 'psi': 0.9961750943275379}
[S9] START round=42 head_norm_before_train=2.132385 (no previous merge yet)
[S9] round=42 local utility u=0.018045 metrics={'f1_val': 0.9963665676526772, 'auprc': 0.9952891526472015, 'loss_val': 0.01881357824996086, 'psi': 0.9959356016504869}-{'f1_val': 0.9905411564608659, 'auprc': 0.9988034314715769, 'loss_val': 0.03049476280333771, 'psi': 0.9938460664651503}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=42 head_norm_before_train=2.058453 (no previous merge yet)
[S10] round=42 local utility u=0.003901 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.993284510586938, 'loss_val': 0.028196299804002158, 'psi': 0.994837329969031}-{'f1_val': 0.9958725428904263, 'auprc': 0.9906004137309338, 'loss_val': 0.02794560257410275, 'psi': 0.9937636912266292}
[S11] START round=42 head_norm_before_train=2.116089 (no previous merge yet)
[S11] round=42 local utility u=0.000643 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9989274867309144, 'loss_val': 0.02103660399199896, 'psi': 0.997511477076094}-{'f1_val': 0.996567470639547, 'auprc': 0.9989115686135406, 'loss_val': 0.022274935576750563, 'psi': 0.9975051098291445}
[S13] START round=42 head_norm_before_train=2.067664 cos_to_last_merge=0.9975 (last merge round=26)
[S13] round=42 local utility u=0.044970 metrics={'f1_val': 0.7119373359902182, 'auprc': 0.78091683700867, 'loss_val': 0.939928395430505, 'psi': 0.7395291363975989}-{'f1_val': 0.654218900768436, 'auprc': 0.7679000583460572, 'loss_val': 0.6445075409093048, 'psi': 0.6996913637994845}
[S13] not sending this round → trigger blocked (psi=0.740)
[S14] START round=42 head_norm_before_train=2.081936 cos_to_last_merge=0.9999 (last merge round=37)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9938997974446084, 'auprc': 0.9988049998047315, 'loss_val': 0.0346930743740499, 'psi': 0.9958618783886577}-{'f1_val': 0.997240356705793, 'auprc': 0.9971084281309313, 'loss_val': 0.023616775236782128, 'psi': 0.9971875852758483}
[S15] START round=42 head_norm_before_train=2.080179 (no previous merge yet)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.9400258950573728, 'auprc': 0.9982380694351807, 'loss_val': 0.06518984793995831, 'psi': 0.963310764808496}-{'f1_val': 0.9970299290849798, 'auprc': 0.9899453369216275, 'loss_val': 0.023362931710970942, 'psi': 0.9941960922196389}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.468174 cos_to_last_merge=1.0000 (last merge round=40)
[S16] round=42 local utility u=0.023447 metrics={'f1_val': 0.9920992257655132, 'auprc': 0.9951930254182617, 'loss_val': 0.057641171851983225, 'psi': 0.9933367456266126}-{'f1_val': 0.9873022029430034, 'auprc': 0.9955747474228747, 'loss_val': 0.07689913222590496, 'psi': 0.990611220734952}
[S17] START round=42 head_norm_before_train=2.040858 (no previous merge yet)
[S17] round=42 local utility u=0.000933 metrics={'f1_val': 0.6257203074160709, 'auprc': 0.8305445686554194, 'loss_val': 1.2057152827152051, 'psi': 0.7076500119118103}-{'f1_val': 0.6262881491065535, 'auprc': 0.8557704663329943, 'loss_val': 1.2866660724182268, 'psi': 0.7180810759971299}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:50314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:50312
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=42 metric=0.6237 head_norm=1.402293
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.496371e-01
[S7] stored merged vector for next round verification (round=42)
[S7] DEBUG after merge:  round=42 metric=0.6199 head_norm=1.395766 delta_norm=0.149637
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1796) from S11
[S10] cosine check vs S11: cos=-0.0625
[S10] DROPPED delta from S11 (cos=-0.0625 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] cosine check vs S16: cos=0.9920
[S16] RECEIVED delta(kind=head bytes=1795) from S8
[S16] cosine check vs S8: cos=0.9961
[S5] RECEIVED delta(kind=head bytes=1804) from S2
[S5] cosine check vs S2: cos=0.9986
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=-0.0011
[S14] DROPPED delta from S17 (cos=-0.0011 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S10
[S11] cosine check vs S10: cos=-0.0625
[S11] DROPPED delta from S10 (cos=-0.0625 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=42 metric=0.9921 head_norm=1.486239
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.569166e-02
[S16] stored merged vector for next round verification (round=42)
[S16] DEBUG after merge:  round=42 metric=0.9921 head_norm=1.479931 delta_norm=0.065692
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=42 metric=0.7007 head_norm=1.380699
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.671143e-02
[S5] stored merged vector for next round verification (round=42)
[S5] DEBUG after merge:  round=42 metric=0.7007 head_norm=1.379437 delta_norm=0.036711
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.379152 cos_to_last_merge=0.9997 (last merge round=41)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.6964145427949349, 'auprc': 0.7168315076448217, 'loss_val': 0.8827779265989413, 'psi': 0.7045813287348897}-{'f1_val': 0.7069337023576296, 'auprc': 0.723128684583493, 'loss_val': 0.8368319947225514, 'psi': 0.713411695247975}
[S3] START round=43 head_norm_before_train=1.485129 cos_to_last_merge=0.9822 (last merge round=37)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.8451077402156508, 'auprc': 0.991300593345645, 'loss_val': 0.3556978169967207, 'psi': 0.9035848814676485}-{'f1_val': 0.8962850033517519, 'auprc': 0.9876386576821787, 'loss_val': 0.22445667608822, 'psi': 0.9328264650839226}
[S4] START round=43 head_norm_before_train=1.474684 cos_to_last_merge=0.9999 (last merge round=41)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9445439638953047, 'auprc': 0.9601331893992229, 'loss_val': 0.2780349254049563, 'psi': 0.9507796540968719}-{'f1_val': 0.9498218922271102, 'auprc': 0.9591097703908771, 'loss_val': 0.2702027679056942, 'psi': 0.9535370434926169}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=43 metric=0.9445 head_norm=1.487733
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.855153e-02
[S4] stored merged vector for next round verification (round=43)
[S4] DEBUG after merge:  round=43 metric=0.9443 head_norm=1.483717 delta_norm=0.098552
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] START round=43 head_norm_before_train=1.379437 cos_to_last_merge=1.0000 (last merge round=42)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.6738397768402224, 'auprc': 0.9629575952500251, 'loss_val': 0.32037935194745354, 'psi': 0.7894869042041435}-{'f1_val': 0.7006542225197299, 'auprc': 0.983732473344505, 'loss_val': 0.3515678799149909, 'psi': 0.81388552284964}
[S6] START round=43 head_norm_before_train=1.379124 cos_to_last_merge=0.9999 (last merge round=41)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.7809961439662415, 'auprc': 0.8469966688551861, 'loss_val': 0.5115613331673973, 'psi': 0.8073963539218193}-{'f1_val': 0.8219221056116066, 'auprc': 0.9270205818530259, 'loss_val': 0.43531614459535123, 'psi': 0.8639614961081743}
[S7] START round=43 head_norm_before_train=1.395766 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=43 local utility u=0.465271 metrics={'f1_val': 0.6903123946795335, 'auprc': 0.8797961439495328, 'loss_val': 0.31625647092472786, 'psi': 0.7661058943875332}-{'f1_val': 0.6237085514684706, 'auprc': 0.7982600475886551, 'loss_val': 0.6025675650717373, 'psi': 0.6935291499165444}
[S8] START round=43 head_norm_before_train=1.476521 cos_to_last_merge=0.9994 (last merge round=38)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9938464732474644, 'auprc': 0.9988845638634234, 'loss_val': 0.04411269865049108, 'psi': 0.995861709493848}-{'f1_val': 0.9942129748679404, 'auprc': 0.9990679511874689, 'loss_val': 0.04659397627883822, 'psi': 0.9961549653957518}
[S9] START round=43 head_norm_before_train=2.136593 (no previous merge yet)
[S9] round=43 local utility u=0.002352 metrics={'f1_val': 0.9955375568978275, 'auprc': 0.9986111976262677, 'loss_val': 0.019102557276728695, 'psi': 0.9967670131892037}-{'f1_val': 0.9963665676526772, 'auprc': 0.9952891526472015, 'loss_val': 0.01881357824996086, 'psi': 0.9959356016504869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=43 head_norm_before_train=2.065301 (no previous merge yet)
[S10] round=43 local utility u=0.000286 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.9933516991869487, 'loss_val': 0.02782675510587628, 'psi': 0.9948642054090352}-{'f1_val': 0.9958725428904263, 'auprc': 0.993284510586938, 'loss_val': 0.028196299804002158, 'psi': 0.994837329969031}
[S11] START round=43 head_norm_before_train=2.120911 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9988503087270515, 'loss_val': 0.021118276288796294, 'psi': 0.9973355033038884}-{'f1_val': 0.996567470639547, 'auprc': 0.9989274867309144, 'loss_val': 0.02103660399199896, 'psi': 0.997511477076094}
[S13] START round=43 head_norm_before_train=2.073012 cos_to_last_merge=0.9973 (last merge round=26)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6252407589566603, 'auprc': 0.7685388094295256, 'loss_val': 0.834652604026625, 'psi': 0.6825599791458064}-{'f1_val': 0.7119373359902182, 'auprc': 0.78091683700867, 'loss_val': 0.939928395430505, 'psi': 0.7395291363975989}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.092937 cos_to_last_merge=0.9998 (last merge round=37)
[S14] round=43 local utility u=0.001407 metrics={'f1_val': 0.9947139726721735, 'auprc': 0.998757683420779, 'loss_val': 0.03662212907014703, 'psi': 0.9963314569716157}-{'f1_val': 0.9938997974446084, 'auprc': 0.9988049998047315, 'loss_val': 0.0346930743740499, 'psi': 0.9958618783886577}
[S15] START round=43 head_norm_before_train=2.089137 (no previous merge yet)
[S15] round=43 local utility u=0.105480 metrics={'f1_val': 0.9717528675944708, 'auprc': 0.9986665917113453, 'loss_val': 0.04587756760878128, 'psi': 0.9825183572412206}-{'f1_val': 0.9400258950573728, 'auprc': 0.9982380694351807, 'loss_val': 0.06518984793995831, 'psi': 0.963310764808496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=43 head_norm_before_train=1.479931 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9178776123689271, 'auprc': 0.98958343888164, 'loss_val': 0.3707972472971157, 'psi': 0.9465599429740121}-{'f1_val': 0.9920992257655132, 'auprc': 0.9951930254182617, 'loss_val': 0.057641171851983225, 'psi': 0.9933367456266126}
[S17] START round=43 head_norm_before_train=2.050785 (no previous merge yet)
[S17] round=43 local utility u=0.274179 metrics={'f1_val': 0.6582020675862359, 'auprc': 0.8432700257644044, 'loss_val': 0.8904248621417635, 'psi': 0.7322292508575032}-{'f1_val': 0.6257203074160709, 'auprc': 0.8305445686554194, 'loss_val': 1.2057152827152051, 'psi': 0.7076500119118103}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.732)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:50309
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:50317
[S8] RECEIVED delta(kind=head bytes=1796) from S7
[S8] cosine check vs S7: cos=0.9391
[S14] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S14
[S17] cosine check vs S14: cos=-0.0013
[S17] DROPPED delta from S14 (cos=-0.0013 < 0.0)
[S2] START round=44 head_norm_before_train=1.401401 cos_to_last_merge=0.9991 (last merge round=41)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.649376038699789, 'auprc': 0.7157951820796263, 'loss_val': 1.0207961021248186, 'psi': 0.675943696051724}-{'f1_val': 0.6964145427949349, 'auprc': 0.7168315076448217, 'loss_val': 0.8827779265989413, 'psi': 0.7045813287348897}
[S3] START round=44 head_norm_before_train=1.524051 cos_to_last_merge=0.9782 (last merge round=37)
[S3] round=44 local utility u=0.495833 metrics={'f1_val': 0.9613238019923649, 'auprc': 0.9994365292720585, 'loss_val': 0.08573597002323963, 'psi': 0.9765688929042423}-{'f1_val': 0.8451077402156508, 'auprc': 0.991300593345645, 'loss_val': 0.3556978169967207, 'psi': 0.9035848814676485}
[S4] START round=44 head_norm_before_train=1.483717 cos_to_last_merge=1.0000 (last merge round=43)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9406590316989897, 'auprc': 0.9435369770932072, 'loss_val': 0.2911304420367116, 'psi': 0.9418102098566767}-{'f1_val': 0.9445439638953047, 'auprc': 0.9601331893992229, 'loss_val': 0.2780349254049563, 'psi': 0.9507796540968719}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.389472 cos_to_last_merge=0.9999 (last merge round=42)
[S5] round=44 local utility u=1.000000 metrics={'f1_val': 0.995996280939491, 'auprc': 0.9898271872768973, 'loss_val': 0.13649236565900086, 'psi': 0.9935286434744536}-{'f1_val': 0.6738397768402224, 'auprc': 0.9629575952500251, 'loss_val': 0.32037935194745354, 'psi': 0.7894869042041435}
[S6] START round=44 head_norm_before_train=1.394921 cos_to_last_merge=0.9997 (last merge round=41)
[S6] round=44 local utility u=0.950808 metrics={'f1_val': 0.9663027985744668, 'auprc': 0.9863578937819518, 'loss_val': 0.1398680738965781, 'psi': 0.9743248366574608}-{'f1_val': 0.7809961439662415, 'auprc': 0.8469966688551861, 'loss_val': 0.5115613331673973, 'psi': 0.8073963539218193}
[S7] START round=44 head_norm_before_train=1.410126 cos_to_last_merge=0.9999 (last merge round=42)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.6826953220948351, 'auprc': 0.8496351271912215, 'loss_val': 0.34799034825521313, 'psi': 0.7494712441333897}-{'f1_val': 0.6903123946795335, 'auprc': 0.8797961439495328, 'loss_val': 0.31625647092472786, 'psi': 0.7661058943875332}
[S8] START round=44 head_norm_before_train=1.492663 cos_to_last_merge=0.9992 (last merge round=38)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.998787107152719, 'loss_val': 0.05941968388755308, 'psi': 0.9946014235587934}-{'f1_val': 0.9938464732474644, 'auprc': 0.9988845638634234, 'loss_val': 0.04411269865049108, 'psi': 0.995861709493848}
[S9] START round=44 head_norm_before_train=2.140842 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9938671257720713, 'auprc': 0.9987073801779052, 'loss_val': 0.024875849602239323, 'psi': 0.9958032275344049}-{'f1_val': 0.9955375568978275, 'auprc': 0.9986111976262677, 'loss_val': 0.019102557276728695, 'psi': 0.9967670131892037}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.073837 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.9921133205936365, 'loss_val': 0.026852282395676497, 'psi': 0.9943688539717104}-{'f1_val': 0.9958725428904263, 'auprc': 0.9933516991869487, 'loss_val': 0.02782675510587628, 'psi': 0.9948642054090352}
[S11] START round=44 head_norm_before_train=2.127987 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9932033366335061, 'auprc': 0.9988772607356371, 'loss_val': 0.03537334984167089, 'psi': 0.9954729062743586}-{'f1_val': 0.9963256330217796, 'auprc': 0.9988503087270515, 'loss_val': 0.021118276288796294, 'psi': 0.9973355033038884}
[S13] START round=44 head_norm_before_train=2.078408 cos_to_last_merge=0.9971 (last merge round=26)
[S13] round=44 local utility u=0.283512 metrics={'f1_val': 0.71591994055614, 'auprc': 0.7798867713844435, 'loss_val': 0.8457484209248597, 'psi': 0.7415066728874615}-{'f1_val': 0.6252407589566603, 'auprc': 0.7685388094295256, 'loss_val': 0.834652604026625, 'psi': 0.6825599791458064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=44 head_norm_before_train=2.103389 cos_to_last_merge=0.9997 (last merge round=37)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9751754894714044, 'auprc': 0.9991591384946967, 'loss_val': 0.04493845388255571, 'psi': 0.9847689490807213}-{'f1_val': 0.9947139726721735, 'auprc': 0.998757683420779, 'loss_val': 0.03662212907014703, 'psi': 0.9963314569716157}
[S15] START round=44 head_norm_before_train=2.097758 (no previous merge yet)
[S15] round=44 local utility u=0.086326 metrics={'f1_val': 0.9965996979826623, 'auprc': 0.9976666893912841, 'loss_val': 0.01930629732282837, 'psi': 0.997026494546111}-{'f1_val': 0.9717528675944708, 'auprc': 0.9986665917113453, 'loss_val': 0.04587756760878128, 'psi': 0.9825183572412206}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=44 head_norm_before_train=1.496899 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=44 local utility u=0.119587 metrics={'f1_val': 0.939184756004408, 'auprc': 0.9902398655382192, 'loss_val': 0.2614354632498382, 'psi': 0.9596067998179325}-{'f1_val': 0.9178776123689271, 'auprc': 0.98958343888164, 'loss_val': 0.3707972472971157, 'psi': 0.9465599429740121}
[S17] START round=44 head_norm_before_train=2.056990 (no previous merge yet)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6158875992148054, 'auprc': 0.9108111098511154, 'loss_val': 1.4207238603370878, 'psi': 0.7338570034693295}-{'f1_val': 0.6582020675862359, 'auprc': 0.8432700257644044, 'loss_val': 0.8904248621417635, 'psi': 0.7322292508575032}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:50302
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=44 metric=0.9918 head_norm=1.505646
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.598034e-01
[S8] stored merged vector for next round verification (round=44)
[S8] DEBUG after merge:  round=44 metric=0.9918 head_norm=1.435345 delta_norm=0.259803
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S5
[S2] cosine check vs S5: cos=0.9968
[S2] START round=45 head_norm_before_train=1.423653 cos_to_last_merge=0.9982 (last merge round=41)
[S2] round=45 local utility u=0.199031 metrics={'f1_val': 0.697209327673967, 'auprc': 0.7168622479555332, 'loss_val': 0.9129346975697918, 'psi': 0.7050704957865935}-{'f1_val': 0.649376038699789, 'auprc': 0.7157951820796263, 'loss_val': 1.0207961021248186, 'psi': 0.675943696051724}
[S3] START round=45 head_norm_before_train=1.557802 cos_to_last_merge=0.9748 (last merge round=37)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9991122398826349, 'loss_val': 0.10102045313497839, 'psi': 0.9763140502937454}-{'f1_val': 0.9613238019923649, 'auprc': 0.9994365292720585, 'loss_val': 0.08573597002323963, 'psi': 0.9765688929042423}
[S4] START round=45 head_norm_before_train=1.498970 cos_to_last_merge=1.0000 (last merge round=43)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.6360691601653811, 'auprc': 0.9194302499318809, 'loss_val': 0.6120234781191536, 'psi': 0.749413596071981}-{'f1_val': 0.9406590316989897, 'auprc': 0.9435369770932072, 'loss_val': 0.2911304420367116, 'psi': 0.9418102098566767}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.402133 cos_to_last_merge=0.9995 (last merge round=42)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.580192687847815, 'auprc': 0.8511089482063608, 'loss_val': 0.7674067373900019, 'psi': 0.6885591919912333}-{'f1_val': 0.995996280939491, 'auprc': 0.9898271872768973, 'loss_val': 0.13649236565900086, 'psi': 0.9935286434744536}
[S6] START round=45 head_norm_before_train=1.409710 cos_to_last_merge=0.9994 (last merge round=41)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.6310393903266668, 'auprc': 0.7945009662022343, 'loss_val': 0.671162184401686, 'psi': 0.6964240206768938}-{'f1_val': 0.9663027985744668, 'auprc': 0.9863578937819518, 'loss_val': 0.1398680738965781, 'psi': 0.9743248366574608}
[S7] START round=45 head_norm_before_train=1.419423 cos_to_last_merge=0.9998 (last merge round=42)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5547892019844443, 'auprc': 0.7826097931967154, 'loss_val': 0.8780799339392521, 'psi': 0.6459174384693527}-{'f1_val': 0.6826953220948351, 'auprc': 0.8496351271912215, 'loss_val': 0.34799034825521313, 'psi': 0.7494712441333897}
[S8] START round=45 head_norm_before_train=1.435345 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9927147755654583, 'auprc': 0.9985272860154714, 'loss_val': 0.08878091352007762, 'psi': 0.9950397797454635}-{'f1_val': 0.9918109678295097, 'auprc': 0.998787107152719, 'loss_val': 0.05941968388755308, 'psi': 0.9946014235587934}
[S9] START round=45 head_norm_before_train=2.144294 (no previous merge yet)
[S9] round=45 local utility u=0.011490 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9987790910482043, 'loss_val': 0.018872188908985007, 'psi': 0.9975079435076166}-{'f1_val': 0.9938671257720713, 'auprc': 0.9987073801779052, 'loss_val': 0.024875849602239323, 'psi': 0.9958032275344049}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=45 head_norm_before_train=2.083389 (no previous merge yet)
[S10] round=45 local utility u=0.001733 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.9933658700208501, 'loss_val': 0.027144469364826646, 'psi': 0.9948698737425958}-{'f1_val': 0.9958725428904263, 'auprc': 0.9921133205936365, 'loss_val': 0.026852282395676497, 'psi': 0.9943688539717104}
[S11] START round=45 head_norm_before_train=2.136159 (no previous merge yet)
[S11] round=45 local utility u=0.017461 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9988410242309609, 'loss_val': 0.02052700044478072, 'psi': 0.9974768920761126}-{'f1_val': 0.9932033366335061, 'auprc': 0.9988772607356371, 'loss_val': 0.03537334984167089, 'psi': 0.9954729062743586}
[S13] START round=45 head_norm_before_train=2.084419 cos_to_last_merge=0.9969 (last merge round=26)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6266835477464396, 'auprc': 0.7723204473480095, 'loss_val': 0.8678334494111397, 'psi': 0.6849383075870676}-{'f1_val': 0.71591994055614, 'auprc': 0.7798867713844435, 'loss_val': 0.8457484209248597, 'psi': 0.7415066728874615}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=2.113994 cos_to_last_merge=0.9996 (last merge round=37)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9504177617451961, 'auprc': 0.9977068564928476, 'loss_val': 0.07199617394307535, 'psi': 0.9693333996442567}-{'f1_val': 0.9751754894714044, 'auprc': 0.9991591384946967, 'loss_val': 0.04493845388255571, 'psi': 0.9847689490807213}
[S15] START round=45 head_norm_before_train=2.106425 (no previous merge yet)
[S15] round=45 local utility u=0.001965 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9980732791104197, 'loss_val': 0.019700749673545268, 'psi': 0.9974996637610279}-{'f1_val': 0.9965996979826623, 'auprc': 0.9976666893912841, 'loss_val': 0.01930629732282837, 'psi': 0.997026494546111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=45 head_norm_before_train=1.512609 cos_to_last_merge=0.9999 (last merge round=42)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8865094087306836, 'auprc': 0.9882250364125036, 'loss_val': 0.4743389275480686, 'psi': 0.9271956598034116}-{'f1_val': 0.939184756004408, 'auprc': 0.9902398655382192, 'loss_val': 0.2614354632498382, 'psi': 0.9596067998179325}
[S17] START round=45 head_norm_before_train=2.063557 (no previous merge yet)
[S17] round=45 local utility u=0.747001 metrics={'f1_val': 0.7346199450813758, 'auprc': 0.9168251012307012, 'loss_val': 0.657157536640672, 'psi': 0.8075020075411059}-{'f1_val': 0.6158875992148054, 'auprc': 0.9108111098511154, 'loss_val': 1.4207238603370878, 'psi': 0.7338570034693295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:50312
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:50305
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:50314
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:50311
[S11] sending update (kind=head size=1798 to 1 peers)
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1804 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=0.9951
[S11] RECEIVED delta(kind=head bytes=1804) from S10
[S11] cosine check vs S10: cos=-0.0634
[S11] DROPPED delta from S10 (cos=-0.0634 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S11
[S10] cosine check vs S11: cos=-0.0634
[S10] DROPPED delta from S11 (cos=-0.0634 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=-0.0015
[S14] DROPPED delta from S17 (cos=-0.0015 < 0.0)
[S10] ⇄ pheromone p=0.002 → S11@127.0.0.1:50312
[S17] ⇄ pheromone p=0.211 → S14@127.0.0.1:50314
[S11] ⇄ pheromone p=0.019 → S10@127.0.0.1:50311
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=45 metric=0.6972 head_norm=1.444611
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.850294e-02
[S2] stored merged vector for next round verification (round=45)
[S2] DEBUG after merge:  round=45 metric=0.6979 head_norm=1.421881 delta_norm=0.068503
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.123 → S5@127.0.0.1:50305
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=45 metric=0.5802 head_norm=1.414171
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.254327e-02
[S5] stored merged vector for next round verification (round=45)
[S5] DEBUG after merge:  round=45 metric=0.5829 head_norm=1.427630 delta_norm=0.072543
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.316 → S2@127.0.0.1:50302
[S14] ⇄ pheromone p=0.003 → S17@127.0.0.1:50317
[S2] START round=46 head_norm_before_train=1.421881 cos_to_last_merge=1.0000 (last merge round=45)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6543988321439753, 'auprc': 0.7198767613378494, 'loss_val': 1.0754977961219119, 'psi': 0.6805900038215249}-{'f1_val': 0.697209327673967, 'auprc': 0.7168622479555332, 'loss_val': 0.9129346975697918, 'psi': 0.7050704957865935}
[S3] START round=46 head_norm_before_train=1.586730 cos_to_last_merge=0.9718 (last merge round=37)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9323114271337183, 'auprc': 0.9876236079727216, 'loss_val': 0.169960836900704, 'psi': 0.9544362994693196}-{'f1_val': 0.9611152572344858, 'auprc': 0.9991122398826349, 'loss_val': 0.10102045313497839, 'psi': 0.9763140502937454}
[S4] START round=46 head_norm_before_train=1.512152 cos_to_last_merge=0.9998 (last merge round=43)
[S4] round=46 local utility u=1.000000 metrics={'f1_val': 0.9431181165173055, 'auprc': 0.9502940675444824, 'loss_val': 0.28933149012365683, 'psi': 0.9459884969281762}-{'f1_val': 0.6360691601653811, 'auprc': 0.9194302499318809, 'loss_val': 0.6120234781191536, 'psi': 0.749413596071981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=46 head_norm_before_train=1.427630 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=46 local utility u=1.000000 metrics={'f1_val': 0.9081918500330214, 'auprc': 0.9843825088231349, 'loss_val': 0.1895081255400956, 'psi': 0.9386681135490669}-{'f1_val': 0.580192687847815, 'auprc': 0.8511089482063608, 'loss_val': 0.7674067373900019, 'psi': 0.6885591919912333}
[S6] START round=46 head_norm_before_train=1.426279 cos_to_last_merge=0.9990 (last merge round=41)
[S6] round=46 local utility u=1.000000 metrics={'f1_val': 0.8998337999488282, 'auprc': 0.9708608301800812, 'loss_val': 0.21990651906178912, 'psi': 0.9282446120413295}-{'f1_val': 0.6310393903266668, 'auprc': 0.7945009662022343, 'loss_val': 0.671162184401686, 'psi': 0.6964240206768938}
[S7] START round=46 head_norm_before_train=1.426879 cos_to_last_merge=0.9996 (last merge round=42)
[S7] round=46 local utility u=0.340607 metrics={'f1_val': 0.6202491626048152, 'auprc': 0.795618566384133, 'loss_val': 0.6286527477577053, 'psi': 0.6903969241165424}-{'f1_val': 0.5547892019844443, 'auprc': 0.7826097931967154, 'loss_val': 0.8780799339392521, 'psi': 0.6459174384693527}
[S8] START round=46 head_norm_before_train=1.446568 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=46 local utility u=0.005563 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9984094075727142, 'loss_val': 0.07405885331382638, 'psi': 0.9946683072471527}-{'f1_val': 0.9927147755654583, 'auprc': 0.9985272860154714, 'loss_val': 0.08878091352007762, 'psi': 0.9950397797454635}
[S9] START round=46 head_norm_before_train=2.150880 (no previous merge yet)
[S9] round=46 local utility u=0.000211 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988025909287256, 'loss_val': 0.018521088790403123, 'psi': 0.9975173434598251}-{'f1_val': 0.9966605118138915, 'auprc': 0.9987790910482043, 'loss_val': 0.018872188908985007, 'psi': 0.9975079435076166}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=46 head_norm_before_train=2.093220 (no previous merge yet)
[S10] round=46 local utility u=0.000636 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.9936081923918629, 'loss_val': 0.026599624376437626, 'psi': 0.9949668026910009}-{'f1_val': 0.9958725428904263, 'auprc': 0.9933658700208501, 'loss_val': 0.027144469364826646, 'psi': 0.9948698737425958}
[S11] START round=46 head_norm_before_train=2.144679 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9988544803090411, 'loss_val': 0.020672474350019513, 'psi': 0.9973371719366841}-{'f1_val': 0.996567470639547, 'auprc': 0.9988410242309609, 'loss_val': 0.02052700044478072, 'psi': 0.9974768920761126}
[S13] START round=46 head_norm_before_train=2.090976 cos_to_last_merge=0.9966 (last merge round=26)
[S13] round=46 local utility u=0.227756 metrics={'f1_val': 0.7191291971101362, 'auprc': 0.7839560323455146, 'loss_val': 1.0019017234216654, 'psi': 0.7450599312042876}-{'f1_val': 0.6266835477464396, 'auprc': 0.7723204473480095, 'loss_val': 0.8678334494111397, 'psi': 0.6849383075870676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=46 head_norm_before_train=2.123188 cos_to_last_merge=0.9995 (last merge round=37)
[S14] round=46 local utility u=0.167325 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.997091553339356, 'loss_val': 0.01991139617487989, 'psi': 0.9975283321160734}-{'f1_val': 0.9504177617451961, 'auprc': 0.9977068564928476, 'loss_val': 0.07199617394307535, 'psi': 0.9693333996442567}
[S15] START round=46 head_norm_before_train=2.114791 (no previous merge yet)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.9013277441892558, 'auprc': 0.9961639969997503, 'loss_val': 0.2367377863151341, 'psi': 0.9392622453134536}-{'f1_val': 0.9971172535281002, 'auprc': 0.9980732791104197, 'loss_val': 0.019700749673545268, 'psi': 0.9974996637610279}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.529249 cos_to_last_merge=0.9997 (last merge round=42)
[S16] round=46 local utility u=0.543402 metrics={'f1_val': 0.991756566477358, 'auprc': 0.9970888374817961, 'loss_val': 0.0456094187402767, 'psi': 0.9938894748791332}-{'f1_val': 0.8865094087306836, 'auprc': 0.9882250364125036, 'loss_val': 0.4743389275480686, 'psi': 0.9271956598034116}
[S17] START round=46 head_norm_before_train=2.070455 (no previous merge yet)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6323736674341893, 'auprc': 0.8988897215144487, 'loss_val': 1.2581016051944849, 'psi': 0.738980089066293}-{'f1_val': 0.7346199450813758, 'auprc': 0.9168251012307012, 'loss_val': 0.657157536640672, 'psi': 0.8075020075411059}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:50302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:50317
[S14] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S14
[S17] cosine check vs S14: cos=-0.0014
[S17] DROPPED delta from S14 (cos=-0.0014 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S5
[S2] cosine check vs S5: cos=0.9998
[S2] START round=47 head_norm_before_train=1.439548 cos_to_last_merge=0.9999 (last merge round=45)
[S2] round=47 local utility u=0.120981 metrics={'f1_val': 0.6767632998715798, 'auprc': 0.718158713246301, 'loss_val': 0.9625693289602415, 'psi': 0.6933214652214683}-{'f1_val': 0.6543988321439753, 'auprc': 0.7198767613378494, 'loss_val': 1.0754977961219119, 'psi': 0.6805900038215249}
[S3] START round=47 head_norm_before_train=1.608068 cos_to_last_merge=0.9696 (last merge round=37)
[S3] round=47 local utility u=0.093875 metrics={'f1_val': 0.9507845816230601, 'auprc': 0.9982244517608867, 'loss_val': 0.12485180877854052, 'psi': 0.9697605296781908}-{'f1_val': 0.9323114271337183, 'auprc': 0.9876236079727216, 'loss_val': 0.169960836900704, 'psi': 0.9544362994693196}
[S4] START round=47 head_norm_before_train=1.523165 cos_to_last_merge=0.9996 (last merge round=43)
[S4] round=47 local utility u=0.016281 metrics={'f1_val': 0.9452821779758592, 'auprc': 0.9557962206375513, 'loss_val': 0.2862610194252261, 'psi': 0.949487795040536}-{'f1_val': 0.9431181165173055, 'auprc': 0.9502940675444824, 'loss_val': 0.28933149012365683, 'psi': 0.9459884969281762}
[S4] not sending this round → trigger blocked (psi=0.949)
[S5] START round=47 head_norm_before_train=1.437608 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.8687621953392932, 'auprc': 0.9617131263334715, 'loss_val': 0.2969587516969171, 'psi': 0.9059425677369646}-{'f1_val': 0.9081918500330214, 'auprc': 0.9843825088231349, 'loss_val': 0.1895081255400956, 'psi': 0.9386681135490669}
[S6] START round=47 head_norm_before_train=1.443178 cos_to_last_merge=0.9984 (last merge round=41)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.7856911025111666, 'auprc': 0.8828897050973095, 'loss_val': 0.5118754319490585, 'psi': 0.8245705435456236}-{'f1_val': 0.8998337999488282, 'auprc': 0.9708608301800812, 'loss_val': 0.21990651906178912, 'psi': 0.9282446120413295}
[S7] START round=47 head_norm_before_train=1.436627 cos_to_last_merge=0.9993 (last merge round=42)
[S7] round=47 local utility u=0.279728 metrics={'f1_val': 0.671547595246919, 'auprc': 0.8188475145965926, 'loss_val': 0.4466733110893225, 'psi': 0.7304675629867885}-{'f1_val': 0.6202491626048152, 'auprc': 0.795618566384133, 'loss_val': 0.6286527477577053, 'psi': 0.6903969241165424}
[S8] START round=47 head_norm_before_train=1.457968 cos_to_last_merge=0.9999 (last merge round=44)
[S8] round=47 local utility u=0.014453 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9977027103870854, 'loss_val': 0.055660478279326735, 'psi': 0.9956483885062521}-{'f1_val': 0.992174240363445, 'auprc': 0.9984094075727142, 'loss_val': 0.07405885331382638, 'psi': 0.9946683072471527}
[S9] START round=47 head_norm_before_train=2.159479 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9938671257720713, 'auprc': 0.9988141074916991, 'loss_val': 0.02306911367347049, 'psi': 0.9958459184599224}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988025909287256, 'loss_val': 0.018521088790403123, 'psi': 0.9975173434598251}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.102890 (no previous merge yet)
[S10] round=47 local utility u=0.000147 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.9936158829360346, 'loss_val': 0.02632821397234744, 'psi': 0.9949698789086696}-{'f1_val': 0.9958725428904263, 'auprc': 0.9936081923918629, 'loss_val': 0.026599624376437626, 'psi': 0.9949668026910009}
[S11] START round=47 head_norm_before_train=2.152077 (no previous merge yet)
[S11] round=47 local utility u=0.000755 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9988520425950526, 'loss_val': 0.020605582200919834, 'psi': 0.9974812994217492}-{'f1_val': 0.9963256330217796, 'auprc': 0.9988544803090411, 'loss_val': 0.020672474350019513, 'psi': 0.9973371719366841}
[S13] START round=47 head_norm_before_train=2.098036 cos_to_last_merge=0.9963 (last merge round=26)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6506175179170434, 'auprc': 0.756844276862852, 'loss_val': 0.8077349145355107, 'psi': 0.6931082214953668}-{'f1_val': 0.7191291971101362, 'auprc': 0.7839560323455146, 'loss_val': 1.0019017234216654, 'psi': 0.7450599312042876}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.134003 cos_to_last_merge=0.9994 (last merge round=37)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9970954520462775, 'loss_val': 0.020401129904324813, 'psi': 0.997284777379208}-{'f1_val': 0.9978195179672185, 'auprc': 0.997091553339356, 'loss_val': 0.01991139617487989, 'psi': 0.9975283321160734}
[S15] START round=47 head_norm_before_train=2.122702 (no previous merge yet)
[S15] round=47 local utility u=0.104726 metrics={'f1_val': 0.9125493608016491, 'auprc': 0.9975325591775812, 'loss_val': 0.09872171821766966, 'psi': 0.9465426401520219}-{'f1_val': 0.9013277441892558, 'auprc': 0.9961639969997503, 'loss_val': 0.2367377863151341, 'psi': 0.9392622453134536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=47 head_norm_before_train=1.545506 cos_to_last_merge=0.9995 (last merge round=42)
[S16] round=47 local utility u=0.003557 metrics={'f1_val': 0.992756046859643, 'auprc': 0.9967739075429056, 'loss_val': 0.043546794607497344, 'psi': 0.994363191132948}-{'f1_val': 0.991756566477358, 'auprc': 0.9970888374817961, 'loss_val': 0.0456094187402767, 'psi': 0.9938894748791332}
[S17] START round=47 head_norm_before_train=2.078380 (no previous merge yet)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6258023443740538, 'auprc': 0.9148219850315165, 'loss_val': 1.4148968431684659, 'psi': 0.7414102006370389}-{'f1_val': 0.6323736674341893, 'auprc': 0.8988897215144487, 'loss_val': 1.2581016051944849, 'psi': 0.738980089066293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:50305
[S16] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:50312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:50311
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.730)
[S8] not sending this round → trigger blocked (psi=0.996)
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1797 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1798) from S11
[S10] cosine check vs S11: cos=-0.0638
[S10] DROPPED delta from S11 (cos=-0.0638 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S2
[S5] cosine check vs S2: cos=0.9994
[S11] RECEIVED delta(kind=head bytes=1795) from S10
[S11] cosine check vs S10: cos=-0.0638
[S11] DROPPED delta from S10 (cos=-0.0638 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=47 metric=0.6768 head_norm=1.460648
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.508900e-02
[S2] stored merged vector for next round verification (round=47)
[S2] DEBUG after merge:  round=47 metric=0.6756 head_norm=1.448957 delta_norm=0.025089
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=47 metric=0.8688 head_norm=1.450521
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.623958e-02
[S5] stored merged vector for next round verification (round=47)
[S5] DEBUG after merge:  round=47 metric=0.8695 head_norm=1.455357 delta_norm=0.026240
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.448957 cos_to_last_merge=1.0000 (last merge round=47)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.6069226872921031, 'auprc': 0.6997442686115471, 'loss_val': 1.332517150347742, 'psi': 0.6440513198198807}-{'f1_val': 0.6767632998715798, 'auprc': 0.718158713246301, 'loss_val': 0.9625693289602415, 'psi': 0.6933214652214683}
[S3] START round=48 head_norm_before_train=1.627640 cos_to_last_merge=0.9677 (last merge round=37)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.9499042710922065, 'auprc': 0.9934294229893486, 'loss_val': 0.11661309589928791, 'psi': 0.9673143318510634}-{'f1_val': 0.9507845816230601, 'auprc': 0.9982244517608867, 'loss_val': 0.12485180877854052, 'psi': 0.9697605296781908}
[S4] START round=48 head_norm_before_train=1.534479 cos_to_last_merge=0.9994 (last merge round=43)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9354685810051859, 'auprc': 0.9365315600693533, 'loss_val': 0.3277376371842622, 'psi': 0.9358937726308529}-{'f1_val': 0.9452821779758592, 'auprc': 0.9557962206375513, 'loss_val': 0.2862610194252261, 'psi': 0.949487795040536}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.455357 cos_to_last_merge=1.0000 (last merge round=47)
[S5] round=48 local utility u=0.507326 metrics={'f1_val': 0.995441773933888, 'auprc': 0.989784049236626, 'loss_val': 0.12659795445359132, 'psi': 0.9931786840549832}-{'f1_val': 0.8687621953392932, 'auprc': 0.9617131263334715, 'loss_val': 0.2969587516969171, 'psi': 0.9059425677369646}
[S6] START round=48 head_norm_before_train=1.458039 cos_to_last_merge=0.9978 (last merge round=41)
[S6] round=48 local utility u=0.374320 metrics={'f1_val': 0.8308023117208834, 'auprc': 0.9560011659532142, 'loss_val': 0.25323691363903855, 'psi': 0.8808818534138156}-{'f1_val': 0.7856911025111666, 'auprc': 0.8828897050973095, 'loss_val': 0.5118754319490585, 'psi': 0.8245705435456236}
[S7] START round=48 head_norm_before_train=1.452440 cos_to_last_merge=0.9987 (last merge round=42)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6197645350937626, 'auprc': 0.7972533485895656, 'loss_val': 0.6242924600781425, 'psi': 0.6907600604920838}-{'f1_val': 0.671547595246919, 'auprc': 0.8188475145965926, 'loss_val': 0.4466733110893225, 'psi': 0.7304675629867885}
[S8] START round=48 head_norm_before_train=1.472106 cos_to_last_merge=0.9998 (last merge round=44)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9923956988118909, 'auprc': 0.9988980336962621, 'loss_val': 0.0486849297260603, 'psi': 0.9949966327656394}-{'f1_val': 0.9942788405856967, 'auprc': 0.9977027103870854, 'loss_val': 0.055660478279326735, 'psi': 0.9956483885062521}
[S9] START round=48 head_norm_before_train=2.166042 (no previous merge yet)
[S9] round=48 local utility u=0.010249 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998522339294393, 'loss_val': 0.018455312104525477, 'psi': 0.9974052428060921}-{'f1_val': 0.9938671257720713, 'auprc': 0.9988141074916991, 'loss_val': 0.02306911367347049, 'psi': 0.9958459184599224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=48 head_norm_before_train=2.107133 (no previous merge yet)
[S10] round=48 local utility u=0.000006 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.9936199212242443, 'loss_val': 0.026327931474207592, 'psi': 0.9949714942239534}-{'f1_val': 0.9958725428904263, 'auprc': 0.9936158829360346, 'loss_val': 0.02632821397234744, 'psi': 0.9949698789086696}
[S11] START round=48 head_norm_before_train=2.159834 (no previous merge yet)
[S11] round=48 local utility u=0.000323 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9988401591880322, 'loss_val': 0.019923725889933682, 'psi': 0.9974765460589411}-{'f1_val': 0.996567470639547, 'auprc': 0.9988520425950526, 'loss_val': 0.020605582200919834, 'psi': 0.9974812994217492}
[S13] START round=48 head_norm_before_train=2.104259 cos_to_last_merge=0.9960 (last merge round=26)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6442839698285099, 'auprc': 0.7783928100931814, 'loss_val': 1.0117496982868814, 'psi': 0.6979275059343785}-{'f1_val': 0.6506175179170434, 'auprc': 0.756844276862852, 'loss_val': 0.8077349145355107, 'psi': 0.6931082214953668}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.141320 cos_to_last_merge=0.9993 (last merge round=37)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9974420253673204, 'loss_val': 0.02130151015563948, 'psi': 0.9971772380754749}-{'f1_val': 0.9974109942678281, 'auprc': 0.9970954520462775, 'loss_val': 0.020401129904324813, 'psi': 0.997284777379208}
[S15] START round=48 head_norm_before_train=2.130576 (no previous merge yet)
[S15] round=48 local utility u=0.291376 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9972213335088332, 'loss_val': 0.020219361837909136, 'psi': 0.9969365344360457}-{'f1_val': 0.9125493608016491, 'auprc': 0.9975325591775812, 'loss_val': 0.09872171821766966, 'psi': 0.9465426401520219}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=48 head_norm_before_train=1.559365 cos_to_last_merge=0.9993 (last merge round=42)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9408848564026114, 'auprc': 0.9952114630885094, 'loss_val': 0.20225767008959888, 'psi': 0.9626154990769706}-{'f1_val': 0.992756046859643, 'auprc': 0.9967739075429056, 'loss_val': 0.043546794607497344, 'psi': 0.994363191132948}
[S17] START round=48 head_norm_before_train=2.086344 (no previous merge yet)
[S17] round=48 local utility u=1.000000 metrics={'f1_val': 0.8639028791665224, 'auprc': 0.8951868662203385, 'loss_val': 0.49738868007269843, 'psi': 0.8764164739880489}-{'f1_val': 0.6258023443740538, 'auprc': 0.9148219850315165, 'loss_val': 1.4148968431684659, 'psi': 0.7414102006370389}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:50314
[S10] not sending this round → trigger blocked (psi=0.995)
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:50302
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=-0.0009
[S14] DROPPED delta from S17 (cos=-0.0009 < 0.0)
[S5] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S5
[S2] cosine check vs S5: cos=0.9997
[S2] START round=49 head_norm_before_train=1.474341 cos_to_last_merge=0.9998 (last merge round=47)
[S2] round=49 local utility u=0.548991 metrics={'f1_val': 0.7070819249128482, 'auprc': 0.7144988727654594, 'loss_val': 0.8797551877740519, 'psi': 0.7100487040538926}-{'f1_val': 0.6069226872921031, 'auprc': 0.6997442686115471, 'loss_val': 1.332517150347742, 'psi': 0.6440513198198807}
[S3] START round=49 head_norm_before_train=1.649347 cos_to_last_merge=0.9656 (last merge round=37)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.8832931151730617, 'auprc': 0.9983085105679876, 'loss_val': 0.2942874020993033, 'psi': 0.9292992733310321}-{'f1_val': 0.9499042710922065, 'auprc': 0.9934294229893486, 'loss_val': 0.11661309589928791, 'psi': 0.9673143318510634}
[S4] START round=49 head_norm_before_train=1.545605 cos_to_last_merge=0.9991 (last merge round=43)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.8844806851837832, 'auprc': 0.9320747860224328, 'loss_val': 0.3707174996429505, 'psi': 0.9035183255192429}-{'f1_val': 0.9354685810051859, 'auprc': 0.9365315600693533, 'loss_val': 0.3277376371842622, 'psi': 0.9358937726308529}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.473850 cos_to_last_merge=0.9999 (last merge round=47)
[S5] round=49 local utility u=0.026470 metrics={'f1_val': 0.9958547499419321, 'auprc': 0.9930884617694103, 'loss_val': 0.08604990101033587, 'psi': 0.9947482346729235}-{'f1_val': 0.995441773933888, 'auprc': 0.989784049236626, 'loss_val': 0.12659795445359132, 'psi': 0.9931786840549832}
[S6] START round=49 head_norm_before_train=1.468550 cos_to_last_merge=0.9971 (last merge round=41)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.8313087051003729, 'auprc': 0.9549817507877062, 'loss_val': 0.2994350509551882, 'psi': 0.8807779233753061}-{'f1_val': 0.8308023117208834, 'auprc': 0.9560011659532142, 'loss_val': 0.25323691363903855, 'psi': 0.8808818534138156}
[S7] START round=49 head_norm_before_train=1.463490 cos_to_last_merge=0.9982 (last merge round=42)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6070843590413451, 'auprc': 0.7948015611293114, 'loss_val': 0.6720218461218193, 'psi': 0.6821712398765316}-{'f1_val': 0.6197645350937626, 'auprc': 0.7972533485895656, 'loss_val': 0.6242924600781425, 'psi': 0.6907600604920838}
[S8] START round=49 head_norm_before_train=1.485442 cos_to_last_merge=0.9996 (last merge round=44)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.974894355125736, 'auprc': 0.9982409747490064, 'loss_val': 0.07625657610821703, 'psi': 0.9842330029750441}-{'f1_val': 0.9923956988118909, 'auprc': 0.9988980336962621, 'loss_val': 0.0486849297260603, 'psi': 0.9949966327656394}
[S9] START round=49 head_norm_before_train=2.172858 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9955331911028912, 'auprc': 0.9988174978292945, 'loss_val': 0.019680276263783436, 'psi': 0.9968469137934526}-{'f1_val': 0.9966605118138915, 'auprc': 0.998522339294393, 'loss_val': 0.018455312104525477, 'psi': 0.9974052428060921}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.113634 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9958725428904263, 'auprc': 0.9935707072803319, 'loss_val': 0.026276026841179374, 'psi': 0.9949518086463884}-{'f1_val': 0.9958725428904263, 'auprc': 0.9936199212242443, 'loss_val': 0.026327931474207592, 'psi': 0.9949714942239534}
[S11] START round=49 head_norm_before_train=2.167704 (no previous merge yet)
[S11] round=49 local utility u=0.000218 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9989296008461138, 'loss_val': 0.019756489978347763, 'psi': 0.9975123227221738}-{'f1_val': 0.996567470639547, 'auprc': 0.9988401591880322, 'loss_val': 0.019923725889933682, 'psi': 0.9974765460589411}
[S13] START round=49 head_norm_before_train=2.108920 cos_to_last_merge=0.9959 (last merge round=26)
[S13] round=49 local utility u=0.232316 metrics={'f1_val': 0.7111210095163845, 'auprc': 0.7822275647821039, 'loss_val': 0.9596442966683373, 'psi': 0.7395636316226722}-{'f1_val': 0.6442839698285099, 'auprc': 0.7783928100931814, 'loss_val': 1.0117496982868814, 'psi': 0.6979275059343785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=49 head_norm_before_train=2.145962 cos_to_last_merge=0.9992 (last merge round=37)
[S14] round=49 local utility u=0.003672 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9991768180418044, 'loss_val': 0.020619189978618068, 'psi': 0.9980168642741452}-{'f1_val': 0.9970007132142444, 'auprc': 0.9974420253673204, 'loss_val': 0.02130151015563948, 'psi': 0.9971772380754749}
[S15] START round=49 head_norm_before_train=2.138059 (no previous merge yet)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.9013069076647195, 'auprc': 0.9960245070279279, 'loss_val': 0.2771105509832343, 'psi': 0.9391939474100028}-{'f1_val': 0.9967466683875206, 'auprc': 0.9972213335088332, 'loss_val': 0.020219361837909136, 'psi': 0.9969365344360457}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.571113 cos_to_last_merge=0.9990 (last merge round=42)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.8809666237965679, 'auprc': 0.9938103337908587, 'loss_val': 0.46683056248626953, 'psi': 0.9261041077942842}-{'f1_val': 0.9408848564026114, 'auprc': 0.9952114630885094, 'loss_val': 0.20225767008959888, 'psi': 0.9626154990769706}
[S17] START round=49 head_norm_before_train=2.094096 (no previous merge yet)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.611862789326458, 'auprc': 0.8127423471281319, 'loss_val': 1.1598629904057212, 'psi': 0.6922146124471276}-{'f1_val': 0.8639028791665224, 'auprc': 0.8951868662203385, 'loss_val': 0.49738868007269843, 'psi': 0.8764164739880489}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:50305
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:50311
[S11] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:50317
[S10] RECEIVED delta(kind=head bytes=1797) from S11
[S10] cosine check vs S11: cos=-0.0645
[S10] DROPPED delta from S11 (cos=-0.0645 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] cosine check vs S2: cos=0.9991
[S14] sending update (kind=head size=1797 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=49 metric=0.7071 head_norm=1.491969
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.616928e-02
[S2] stored merged vector for next round verification (round=49)
[S2] DEBUG after merge:  round=49 metric=0.7075 head_norm=1.482706 delta_norm=0.026169
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1797) from S14
[S17] cosine check vs S14: cos=-0.0007
[S17] DROPPED delta from S14 (cos=-0.0007 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=49 metric=0.9959 head_norm=1.495303
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.196051e-02
[S5] stored merged vector for next round verification (round=49)
[S5] DEBUG after merge:  round=49 metric=0.9959 head_norm=1.493295 delta_norm=0.031961
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
