[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:50303
[S3] → join 127.0.0.1:50302
[S4] → join 127.0.0.1:50302
[S5] → join 127.0.0.1:50302
[S6] → join 127.0.0.1:50302
[S7] → join 127.0.0.1:50302
[S8] → join 127.0.0.1:50302
[S9] → join 127.0.0.1:50302
[S10] → join 127.0.0.1:50302
[S11] → join 127.0.0.1:50302
[S13] → join 127.0.0.1:50302
[S14] → join 127.0.0.1:50302
[S15] → join 127.0.0.1:50302
[S16] → join 127.0.0.1:50302
[S17] → join 127.0.0.1:50302
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.122709 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.154248 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.196646 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.261622 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.142171 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.143757 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.153284 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.122440 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.106469 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.089372 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.159583 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.138446 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.127543 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.143098 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.183507 (no previous merge yet)
[S15]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3] + discovered S13
[S3] + discovered S16
[S3] + discovered S4
[S3] + discovered S7
[S3] + discovered S8
[S3] + discovered S15
[S3] + discovered S17
[S3] + discovered S5
[S3] + discovered S9
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S14
[S3] + discovered S10
[S3] + discovered S11
[S3] + discovered S6
[S5] + discovered S3
[S5] + discovered S2
[S5] + discovered S4
[S4] + discovered S10
[S4] + discovered S14
[S4] + discovered S9
[S4] + discovered S5
[S4] + discovered S17
[S4] + discovered S15
[S4] + discovered S8
[S4] + discovered S11
[S4] + discovered S7
[S4] + discovered S16
[S4] + discovered S13
[S4] + discovered S6
[S5] + discovered S16
[S5] + discovered S6
[S6] + discovered S3
[S6] + discovered S2
[S6] + discovered S4
[S6] + discovered S5
[S5] + discovered S14
[S5] + discovered S17
[S5] + discovered S15
[S5] + discovered S7
[S5] + discovered S10
[S5] + discovered S13
[S5] + discovered S9
[S5] + discovered S11
[S5] + discovered S8
[S7] + discovered S6
[S7] + discovered S5
[S7] + discovered S4
[S7] + discovered S2
[S6] + discovered S13
[S6] + discovered S10
[S6] + discovered S7
[S6] + discovered S15
[S6] + discovered S14
[S7] + discovered S3
[S6] + discovered S8
[S6] + discovered S16
[S6] + discovered S11
[S6] + discovered S9
[S6] + discovered S17
[S8] + discovered S4
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S3
[S8] + discovered S2
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S15
[S7] + discovered S11
[S7] + discovered S16
[S7] + discovered S10
[S7] + discovered S13
[S7] + discovered S9
[S7] + discovered S17
[S8] + discovered S15
[S9] + discovered S5
[S8] + discovered S17
[S8] + discovered S10
[S8] + discovered S13
[S9] + discovered S2
[S9] + discovered S4
[S9] + discovered S8
[S9] + discovered S6
[S9] + discovered S7
[S9] + discovered S3
[S8] + discovered S16
[S8] + discovered S9
[S8] + discovered S14
[S8] + discovered S11
[S9] + discovered S15
[S9] + discovered S16
[S9] + discovered S17
[S9] + discovered S11
[S9] + discovered S10
[S10] + discovered S2
[S10] + discovered S9
[S10] + discovered S6
[S10] + discovered S5
[S10] + discovered S8
[S9] + discovered S13
[S10] + discovered S7
[S9] + discovered S14
[S10] + discovered S4
[S10] + discovered S3
[S11] + discovered S6
[S10] + discovered S13
[S10] + discovered S11
[S10] + discovered S17
[S10] + discovered S14
[S11] + discovered S7
[S10] + discovered S15
[S11] + discovered S8
[S11] + discovered S10
[S10] + discovered S16
[S11] + discovered S4
[S11] + discovered S9
[S11] + discovered S3
[S11] + discovered S2
[S11] + discovered S5
[S13] + discovered S7
[S13] + discovered S8
[S13] + discovered S6
[S13] + discovered S3
[S13] + discovered S10
[S13] + discovered S5
[S13] + discovered S9
[S13] + discovered S4
[S13] + discovered S11
[S13] + discovered S2
[S11] + discovered S17
[S11] + discovered S13
[S11] + discovered S14
[S11] + discovered S15
[S11] + discovered S16
[S13] + discovered S14
[S14] + discovered S9
[S14] + discovered S10
[S14] + discovered S3
[S14] + discovered S2
[S14] + discovered S13
[S13] + discovered S15
[S14] + discovered S11
[S14] + discovered S6
[S14] + discovered S4
[S14] + discovered S7
[S13] + discovered S16
[S13] + discovered S17
[S14] + discovered S8
[S14] + discovered S5
[S15] + discovered S8
[S15] + discovered S4
[S15] + discovered S14
[S15] + discovered S13
[S15] + discovered S10
[S15] + discovered S6
[S15] + discovered S11
[S15] + discovered S2
[S15] + discovered S5
[S15] + discovered S3
[S15] + discovered S7
[S15] + discovered S9
[S14] + discovered S15
[S14] + discovered S17
[S14] + discovered S16
[S16] + discovered S11
[S16] + discovered S4
[S16] + discovered S9
[S15] + discovered S16
[S16] + discovered S15
[S16] + discovered S10
[S16] + discovered S13
[S16] + discovered S5
[S15] + discovered S17
[S16] + discovered S14
[S16] + discovered S2
[S16] + discovered S3
[S16] + discovered S7
[S16] + discovered S6
[S16] + discovered S8
[S17] + discovered S8
[S17] + discovered S3
[S17] + discovered S16
[S17] + discovered S7
[S17] + discovered S15
[S17] + discovered S9
[S17] + discovered S5
[S17] + discovered S13
[S17] + discovered S11
[S16] + discovered S17
[S17] + discovered S2
[S17] + discovered S4
[S17] + discovered S10
[S17] + discovered S14
[S17] + discovered S6
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=1.000 → S10@127.0.0.1:50311
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:50303
[S14] ⇄ pheromone p=1.000 → S13@127.0.0.1:50313
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:50304
[S10] ⇄ pheromone p=1.000 → S7@127.0.0.1:50308
[S2] ⇄ pheromone p=1.000 → S5@127.0.0.1:50305
[S9] ⇄ pheromone p=1.000 → S3@127.0.0.1:50303
[S15] ⇄ pheromone p=1.000 → S7@127.0.0.1:50308
[S13] ⇄ pheromone p=1.000 → S16@127.0.0.1:50316
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:50307
[S7] ⇄ pheromone p=1.000 → S8@127.0.0.1:50309
[S8] ⇄ pheromone p=1.000 → S16@127.0.0.1:50316
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:50309
[S6] ⇄ pheromone p=1.000 → S7@127.0.0.1:50308
[S17] ⇄ pheromone p=1.000 → S14@127.0.0.1:50314
[S2] START round=1 head_norm_before_train=1.126553 (no previous merge yet)
[S2] round=1 local utility u=0.095382 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.8007995027630919, 'loss_val': 1.3181369569878687, 'psi': 0.4053860811383768}-{'f1_val': 0.1417771333885667, 'auprc': 0.746865662854216, 'loss_val': 1.3470989098636674, 'psi': 0.38381254517482644}
[S3] START round=1 head_norm_before_train=1.159331 (no previous merge yet)
[S3] round=1 local utility u=0.040349 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7981494672565462, 'loss_val': 1.2793394563266738, 'psi': 0.4031638262710827}-{'f1_val': 0.13984006561410703, 'auprc': 0.7885847412919534, 'loss_val': 1.3313441352541746, 'psi': 0.3993379358852456}
[S4] START round=1 head_norm_before_train=1.212069 (no previous merge yet)
[S4] round=1 local utility u=0.659445 metrics={'f1_val': 0.35365246058629607, 'auprc': 0.7924816198599566, 'loss_val': 1.2932840728017485, 'psi': 0.5291841242957602}-{'f1_val': 0.14132182240888586, 'auprc': 0.7867683324735811, 'loss_val': 1.321049462474817, 'psi': 0.399500426434764}
[S5] START round=1 head_norm_before_train=1.265419 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7676799807643216, 'loss_val': 1.261320520270928, 'psi': 0.39242913516287153}-{'f1_val': 0.4248650736430116, 'auprc': 0.7699100052238463, 'loss_val': 1.336965773005221, 'psi': 0.5628830462753456}
[S6] START round=1 head_norm_before_train=1.150604 (no previous merge yet)
[S6] round=1 local utility u=0.136180 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7925545961222503, 'loss_val': 1.3349551879301451, 'psi': 0.40187760767966935}-{'f1_val': 0.14171015656362906, 'auprc': 0.71291851661386, 'loss_val': 1.3701095688416058, 'psi': 0.37019350058372147}
[S7] START round=1 head_norm_before_train=1.153441 (no previous merge yet)
[S7] round=1 local utility u=0.215909 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7743360269662074, 'loss_val': 1.275485257331284, 'psi': 0.394968504423938}-{'f1_val': 0.14205682272909165, 'auprc': 0.6486679894981019, 'loss_val': 1.3302995047516841, 'psi': 0.34470128943669576}
[S8] START round=1 head_norm_before_train=1.153232 (no previous merge yet)
[S8] round=1 local utility u=0.158525 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6706813843748136, 'loss_val': 1.3310251977025214, 'psi': 0.3522461431856998}-{'f1_val': 0.12276419312471147, 'auprc': 0.6101700512898047, 'loss_val': 1.3633907055524546, 'psi': 0.31772653639074877}
[S9] START round=1 head_norm_before_train=1.121867 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.865499972997017, 'loss_val': 1.2617804793025453, 'psi': 0.4310387634828044}-{'f1_val': 0.141397957139996, 'auprc': 0.9457313314361735, 'loss_val': 1.3312067172375062, 'psi': 0.46313130685846704}
[S10] START round=1 head_norm_before_train=1.116333 (no previous merge yet)
[S10] round=1 local utility u=0.192181 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7929947673502755, 'loss_val': 1.305707437561015, 'psi': 0.4003708894651446}-{'f1_val': 0.13862163754172394, 'auprc': 0.6759136627560972, 'loss_val': 1.3388271024280227, 'psi': 0.3535384476274733}
[S11] START round=1 head_norm_before_train=1.088964 (no previous merge yet)
[S11] round=1 local utility u=0.603687 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8168945505812374, 'loss_val': 1.3507742697947376, 'psi': 0.41100603025636134}-{'f1_val': 0.054460325283390836, 'auprc': 0.5966631918566951, 'loss_val': 1.381734918194921, 'psi': 0.2713414719127126}
[S13] START round=1 head_norm_before_train=1.163082 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1410394656008953, 'auprc': 0.6129608323962845, 'loss_val': 1.3251579363150172, 'psi': 0.329808012319051}-{'f1_val': 0.6283552383835217, 'auprc': 0.5825126584161341, 'loss_val': 1.3638505547470532, 'psi': 0.6100182063965667}
[S14] START round=1 head_norm_before_train=1.143789 (no previous merge yet)
[S14] round=1 local utility u=0.172672 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.616442607984108, 'loss_val': 1.3465345400283402, 'psi': 0.33079175492326546}-{'f1_val': 0.14035785288270378, 'auprc': 0.5087128575248727, 'loss_val': 1.3686900395978252, 'psi': 0.2876998547395714}
[S15] START round=1 head_norm_before_train=1.139188 (no previous merge yet)
[S15] round=1 local utility u=0.010898 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7995750758716628, 'loss_val': 1.309415457308781, 'psi': 0.40367022116560014}-{'f1_val': 0.13973365136155833, 'auprc': 0.799367746949659, 'loss_val': 1.3305900575213774, 'psi': 0.4035872895967986}
[S16] START round=1 head_norm_before_train=1.142798 (no previous merge yet)
[S16] round=1 local utility u=0.386139 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6412572290414009, 'loss_val': 1.3450119114424595, 'psi': 0.3408853617360823}-{'f1_val': 0.14063745019920318, 'auprc': 0.3932661884646691, 'loss_val': 1.3733158871489695, 'psi': 0.24168894550538955}
[S17] START round=1 head_norm_before_train=1.181582 (no previous merge yet)
[S17] round=1 local utility u=0.211446 metrics={'f1_val': 0.09866590897900904, 'auprc': 0.5028423007118774, 'loss_val': 1.3680712162111968, 'psi': 0.2603364656721564}-{'f1_val': 0.09754189944134078, 'auprc': 0.37250662598529555, 'loss_val': 1.393211944217618, 'psi': 0.2075277900589227}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:50302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] → sending delta(kind=head bytes=1789) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S15] → sending delta(kind=head bytes=1788) to S2@127.0.0.1:50302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:50313
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:50312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:50302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S16] → sending delta(kind=head bytes=1787) to S2@127.0.0.1:50302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:50307
[S7] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1787 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1788 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S10] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1789 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1792) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.191190)
[S6] loaded HEAD from S7 (vec_in norm=1.191190)
[S6] cosine check vs S7: cos=-0.0250
[S6] DROPPED delta from S7 (cos=-0.0250 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1789) from S14
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.157519)
[S16] loaded HEAD from S14 (vec_in norm=1.157519)
[S16] cosine check vs S14: cos=-0.0454
[S16] DROPPED delta from S14 (cos=-0.0454 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1794) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.229182)
[S2] loaded HEAD from S4 (vec_in norm=1.229182)
[S2] cosine check vs S4: cos=0.0199
[S2] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1788) from S15
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.156616)
[S2] loaded HEAD from S15 (vec_in norm=1.156616)
[S2] cosine check vs S15: cos=-0.0742
[S2] DROPPED delta from S15 (cos=-0.0742 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1792) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.189563)
[S2] loaded HEAD from S3 (vec_in norm=1.189563)
[S2] cosine check vs S3: cos=-0.0192
[S2] DROPPED delta from S3 (cos=-0.0192 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1789) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.139349)
[S3] loaded HEAD from S2 (vec_in norm=1.139349)
[S3] cosine check vs S2: cos=-0.0192
[S3] DROPPED delta from S2 (cos=-0.0192 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1789) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.132464)
[S4] loaded HEAD from S10 (vec_in norm=1.132464)
[S4] cosine check vs S10: cos=-0.0802
[S4] DROPPED delta from S10 (cos=-0.0802 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1795) from S8
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.164363)
[S11] loaded HEAD from S8 (vec_in norm=1.164363)
[S11] cosine check vs S8: cos=-0.0236
[S11] DROPPED delta from S8 (cos=-0.0236 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1787) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.151899)
[S2] loaded HEAD from S16 (vec_in norm=1.151899)
[S2] cosine check vs S16: cos=0.0846
[S2] BUFFERED delta from S16 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1792) from S6
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.163656)
[S13] loaded HEAD from S6 (vec_in norm=1.163656)
[S13] cosine check vs S6: cos=-0.0222
[S13] DROPPED delta from S6 (cos=-0.0222 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1792) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.098406)
[S7] loaded HEAD from S11 (vec_in norm=1.098406)
[S7] cosine check vs S11: cos=0.0368
[S7] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:50305
[S17] sending update (kind=head size=1792 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1792) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.188947)
[S5] loaded HEAD from S17 (vec_in norm=1.188947)
[S5] cosine check vs S17: cos=-0.0044
[S5] DROPPED delta from S17 (cos=-0.0044 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.191190
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.951741e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.824871 delta_norm=0.795174
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.139349
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.992401e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.747284 delta_norm=0.699240
[S2] aggregate: ACCEPT kept=['S4', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.747284 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7934333209433794, 'loss_val': 1.3190991769570446, 'psi': 0.4024396084104918}-{'f1_val': 0.1417771333885667, 'auprc': 0.8007995027630919, 'loss_val': 1.3181369569878687, 'psi': 0.4053860811383768}
[S3] START round=2 head_norm_before_train=1.189563 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6139885703280581, 'loss_val': 1.2248641522492862, 'psi': 0.3294994674996875}-{'f1_val': 0.13984006561410703, 'auprc': 0.7981494672565462, 'loss_val': 1.2793394563266738, 'psi': 0.4031638262710827}
[S4] START round=2 head_norm_before_train=1.229182 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.792953973818467, 'loss_val': 1.2549862846645892, 'psi': 0.4013175668644973}-{'f1_val': 0.35365246058629607, 'auprc': 0.7924816198599566, 'loss_val': 1.2932840728017485, 'psi': 0.5291841242957602}
[S5] START round=2 head_norm_before_train=1.293865 (no previous merge yet)
[S5] round=2 local utility u=0.034344 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7700381244378433, 'loss_val': 1.1997076692936512, 'psi': 0.3933723926322802}-{'f1_val': 0.14226190476190476, 'auprc': 0.7676799807643216, 'loss_val': 1.261320520270928, 'psi': 0.39242913516287153}
[S6] START round=2 head_norm_before_train=1.163656 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7644038152233124, 'loss_val': 1.2924848360285226, 'psi': 0.39061729532009415}-{'f1_val': 0.14142628205128205, 'auprc': 0.7925545961222503, 'loss_val': 1.3349551879301451, 'psi': 0.40187760767966935}
[S7] START round=2 head_norm_before_train=0.824871 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.006090 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7759149820652594, 'loss_val': 1.2680411416263504, 'psi': 0.39560008646355876}-{'f1_val': 0.14205682272909165, 'auprc': 0.7743360269662074, 'loss_val': 1.275485257331284, 'psi': 0.394968504423938}
[S8] START round=2 head_norm_before_train=1.164363 (no previous merge yet)
[S8] round=2 local utility u=0.018884 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6715329810960138, 'loss_val': 1.29581157059289, 'psi': 0.35258678187417986}-{'f1_val': 0.13995598239295717, 'auprc': 0.6706813843748136, 'loss_val': 1.3310251977025214, 'psi': 0.3522461431856998}
[S9] START round=2 head_norm_before_train=1.152852 (no previous merge yet)
[S9] round=2 local utility u=0.042908 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659796219321018, 'loss_val': 1.1774036523933442, 'psi': 0.43123062305683835}-{'f1_val': 0.141397957139996, 'auprc': 0.865499972997017, 'loss_val': 1.2617804793025453, 'psi': 0.4310387634828044}
[S10] START round=2 head_norm_before_train=1.132464 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7764249290052357, 'loss_val': 1.2715959635504357, 'psi': 0.3937429541271287}-{'f1_val': 0.13862163754172394, 'auprc': 0.7929947673502755, 'loss_val': 1.305707437561015, 'psi': 0.4003708894651446}
[S11] START round=2 head_norm_before_train=1.098406 (no previous merge yet)
[S11] round=2 local utility u=0.024432 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8196853739909108, 'loss_val': 1.3102827133925485, 'psi': 0.4121223596202307}-{'f1_val': 0.14041368337311058, 'auprc': 0.8168945505812374, 'loss_val': 1.3507742697947376, 'psi': 0.41100603025636134}
[S13] START round=2 head_norm_before_train=1.178664 (no previous merge yet)
[S13] round=2 local utility u=0.080529 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6537126639695732, 'loss_val': 1.2824339097900923, 'psi': 0.34571652313406115}-{'f1_val': 0.1410394656008953, 'auprc': 0.6129608323962845, 'loss_val': 1.3251579363150172, 'psi': 0.329808012319051}
[S14] START round=2 head_norm_before_train=1.157519 (no previous merge yet)
[S14] round=2 local utility u=0.064519 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.651590834624381, 'loss_val': 1.3229414831411288, 'psi': 0.3448510455793747}-{'f1_val': 0.14035785288270378, 'auprc': 0.616442607984108, 'loss_val': 1.3465345400283402, 'psi': 0.33079175492326546}
[S15] START round=2 head_norm_before_train=1.156616 (no previous merge yet)
[S15] round=2 local utility u=0.012786 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7988362226992513, 'loss_val': 1.2816267516915731, 'psi': 0.4033746798966355}-{'f1_val': 0.13973365136155833, 'auprc': 0.7995750758716628, 'loss_val': 1.309415457308781, 'psi': 0.40367022116560014}
[S16] START round=2 head_norm_before_train=1.151899 (no previous merge yet)
[S16] round=2 local utility u=0.264642 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8068309236462656, 'loss_val': 1.3124498864425098, 'psi': 0.4071148395780282}-{'f1_val': 0.14063745019920318, 'auprc': 0.6412572290414009, 'loss_val': 1.3450119114424595, 'psi': 0.3408853617360823}
[S17] START round=2 head_norm_before_train=1.188947 (no previous merge yet)
[S17] round=2 local utility u=1.000000 metrics={'f1_val': 0.39880708007539145, 'auprc': 0.6692404065673112, 'loss_val': 1.3381936817216384, 'psi': 0.5069804106721594}-{'f1_val': 0.09866590897900904, 'auprc': 0.5028423007118774, 'loss_val': 1.3680712162111968, 'psi': 0.2603364656721564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:50316
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.345)
[S16] not sending this round → trigger blocked (psi=0.407)
[S15] not sending this round → trigger blocked (psi=0.403)
[S8] not sending this round → trigger blocked (psi=0.353)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:50304
[S7] not sending this round → trigger blocked (psi=0.396)
[S11] not sending this round → trigger blocked (psi=0.412)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S13] → sending delta(kind=head bytes=1786) to S9@127.0.0.1:50310
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1786 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1786) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.202071)
[S9] loaded HEAD from S13 (vec_in norm=1.202071)
[S9] cosine check vs S13: cos=-0.0851
[S9] DROPPED delta from S13 (cos=-0.0851 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.328264)
[S16] loaded HEAD from S5 (vec_in norm=1.328264)
[S16] cosine check vs S5: cos=-0.0153
[S16] DROPPED delta from S5 (cos=-0.0153 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S9
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.207020)
[S4] loaded HEAD from S9 (vec_in norm=1.207020)
[S4] cosine check vs S9: cos=-0.0682
[S4] DROPPED delta from S9 (cos=-0.0682 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.507)
[S2] START round=3 head_norm_before_train=0.765868 cos_to_last_merge=0.9957 (last merge round=1)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7817895021811765, 'loss_val': 1.2852208101972455, 'psi': 0.3977820809056107}-{'f1_val': 0.1417771333885667, 'auprc': 0.7934333209433794, 'loss_val': 1.3190991769570446, 'psi': 0.4024396084104918}
[S3] START round=3 head_norm_before_train=1.236357 (no previous merge yet)
[S3] round=3 local utility u=0.330510 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7907969807184082, 'loss_val': 1.0942686699527657, 'psi': 0.4002228316558275}-{'f1_val': 0.13984006561410703, 'auprc': 0.6139885703280581, 'loss_val': 1.2248641522492862, 'psi': 0.3294994674996875}
[S4] START round=3 head_norm_before_train=1.254295 (no previous merge yet)
[S4] round=3 local utility u=0.121616 metrics={'f1_val': 0.1705853793868775, 'auprc': 0.7934432827393663, 'loss_val': 1.1953752268259032, 'psi': 0.419728540727873}-{'f1_val': 0.14022662889518414, 'auprc': 0.792953973818467, 'loss_val': 1.2549862846645892, 'psi': 0.4013175668644973}
[S5] START round=3 head_norm_before_train=1.328264 (no previous merge yet)
[S5] round=3 local utility u=0.881424 metrics={'f1_val': 0.41654174186412063, 'auprc': 0.7713886421778374, 'loss_val': 1.08659082515566, 'psi': 0.5584805019896073}-{'f1_val': 0.14226190476190476, 'auprc': 0.7700381244378433, 'loss_val': 1.1997076692936512, 'psi': 0.3933723926322802}
[S6] START round=3 head_norm_before_train=1.186673 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7294876832686302, 'loss_val': 1.2448379826982336, 'psi': 0.3766508425382213}-{'f1_val': 0.14142628205128205, 'auprc': 0.7644038152233124, 'loss_val': 1.2924848360285226, 'psi': 0.39061729532009415}
[S7] START round=3 head_norm_before_train=0.861553 cos_to_last_merge=0.9954 (last merge round=1)
[S7] round=3 local utility u=0.030172 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778104046595412, 'loss_val': 1.2133842642198258, 'psi': 0.3963582555012715}-{'f1_val': 0.14205682272909165, 'auprc': 0.7759149820652594, 'loss_val': 1.2680411416263504, 'psi': 0.39560008646355876}
[S8] START round=3 head_norm_before_train=1.184598 (no previous merge yet)
[S8] round=3 local utility u=0.025533 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6745060575781504, 'loss_val': 1.2536650306063033, 'psi': 0.3537760124670345}-{'f1_val': 0.13995598239295717, 'auprc': 0.6715329810960138, 'loss_val': 1.29581157059289, 'psi': 0.35258678187417986}
[S9] START round=3 head_norm_before_train=1.207020 (no previous merge yet)
[S9] round=3 local utility u=0.085613 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8661116769337953, 'loss_val': 1.0065746637485788, 'psi': 0.43128344505751576}-{'f1_val': 0.141397957139996, 'auprc': 0.8659796219321018, 'loss_val': 1.1774036523933442, 'psi': 0.43123062305683835}
[S10] START round=3 head_norm_before_train=1.155975 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6621539280920835, 'loss_val': 1.23797570488908, 'psi': 0.34803455376186776}-{'f1_val': 0.13862163754172394, 'auprc': 0.7764249290052357, 'loss_val': 1.2715959635504357, 'psi': 0.3937429541271287}
[S11] START round=3 head_norm_before_train=1.118398 (no previous merge yet)
[S11] round=3 local utility u=0.028786 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8196835203657367, 'loss_val': 1.2527043470922472, 'psi': 0.412121618170161}-{'f1_val': 0.14041368337311058, 'auprc': 0.8196853739909108, 'loss_val': 1.3102827133925485, 'psi': 0.4121223596202307}
[S13] START round=3 head_norm_before_train=1.202071 (no previous merge yet)
[S13] round=3 local utility u=0.094608 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7019029719050317, 'loss_val': 1.237788076611701, 'psi': 0.3649926463082445}-{'f1_val': 0.1403857625770531, 'auprc': 0.6537126639695732, 'loss_val': 1.2824339097900923, 'psi': 0.34571652313406115}
[S14] START round=3 head_norm_before_train=1.179536 (no previous merge yet)
[S14] round=3 local utility u=0.075709 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6936304842468594, 'loss_val': 1.2976414441888946, 'psi': 0.361666905428366}-{'f1_val': 0.14035785288270378, 'auprc': 0.651590834624381, 'loss_val': 1.3229414831411288, 'psi': 0.3448510455793747}
[S15] START round=3 head_norm_before_train=1.185356 (no previous merge yet)
[S15] round=3 local utility u=0.010915 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7927540384659265, 'loss_val': 1.24154948493647, 'psi': 0.4009418062033056}-{'f1_val': 0.13973365136155833, 'auprc': 0.7988362226992513, 'loss_val': 1.2816267516915731, 'psi': 0.4033746798966355}
[S16] START round=3 head_norm_before_train=1.166761 (no previous merge yet)
[S16] round=3 local utility u=0.038800 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.818468240822077, 'loss_val': 1.2697611254603782, 'psi': 0.4117697664483527}-{'f1_val': 0.14063745019920318, 'auprc': 0.8068309236462656, 'loss_val': 1.3124498864425098, 'psi': 0.4071148395780282}
[S17] START round=3 head_norm_before_train=1.204248 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6419709998002698, 'loss_val': 1.2966963420354438, 'psi': 0.34135777791053856}-{'f1_val': 0.39880708007539145, 'auprc': 0.6692404065673112, 'loss_val': 1.3381936817216384, 'psi': 0.5069804106721594}
[S9] not sending this round → trigger blocked (psi=0.431)
[S13] not sending this round → trigger blocked (psi=0.365)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:50316
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:50313
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.558)
[S14] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.225528)
[S7] loaded HEAD from S15 (vec_in norm=1.225528)
[S7] cosine check vs S15: cos=0.0771
[S7] BUFFERED delta from S15 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1791) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.147544)
[S10] loaded HEAD from S11 (vec_in norm=1.147544)
[S10] cosine check vs S11: cos=0.0131
[S10] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.273873)
[S6] loaded HEAD from S3 (vec_in norm=1.273873)
[S6] cosine check vs S3: cos=-0.0191
[S6] DROPPED delta from S3 (cos=-0.0191 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.894363)
[S8] loaded HEAD from S7 (vec_in norm=0.894363)
[S8] cosine check vs S7: cos=-0.0205
[S8] DROPPED delta from S7 (cos=-0.0205 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.289614)
[S8] loaded HEAD from S4 (vec_in norm=1.289614)
[S8] cosine check vs S4: cos=-0.0402
[S8] DROPPED delta from S4 (cos=-0.0402 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.211279)
[S16] loaded HEAD from S8 (vec_in norm=1.211279)
[S16] cosine check vs S8: cos=0.0354
[S16] BUFFERED delta from S8 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.188264)
[S4] loaded HEAD from S16 (vec_in norm=1.188264)
[S4] cosine check vs S16: cos=0.1199
[S4] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1797) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.206834)
[S13] loaded HEAD from S14 (vec_in norm=1.206834)
[S13] cosine check vs S14: cos=-0.0652
[S13] DROPPED delta from S14 (cos=-0.0652 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.1386 head_norm=1.179361
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.173564e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.1386 head_norm=0.828132 delta_norm=0.817356
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=1.188264
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.332482e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.863297 delta_norm=0.833248
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1706 head_norm=1.289614
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.227465e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.1402 head_norm=0.927699 delta_norm=0.822746
[S4] aggregate: ROLLBACK (f1_val pre=0.171 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=0.894363
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.302120e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.785935 delta_norm=0.730212
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.795505 cos_to_last_merge=0.9845 (last merge round=1)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7371076350904658, 'loss_val': 1.242311652452039, 'psi': 0.37990933406932637}-{'f1_val': 0.1417771333885667, 'auprc': 0.7817895021811765, 'loss_val': 1.2852208101972455, 'psi': 0.3977820809056107}
[S3] START round=4 head_norm_before_train=1.273873 (no previous merge yet)
[S3] round=4 local utility u=0.963342 metrics={'f1_val': 0.4225626028819525, 'auprc': 0.7958304937184459, 'loss_val': 0.8790211963925634, 'psi': 0.5718697592165499}-{'f1_val': 0.13984006561410703, 'auprc': 0.7907969807184082, 'loss_val': 1.0942686699527657, 'psi': 0.4002228316558275}
[S4] START round=4 head_norm_before_train=0.927699 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.601040 metrics={'f1_val': 0.37080087703021514, 'auprc': 0.7938262612645463, 'loss_val': 1.1957377738020905, 'psi': 0.5400110307239476}-{'f1_val': 0.1705853793868775, 'auprc': 0.7934432827393663, 'loss_val': 1.1953752268259032, 'psi': 0.419728540727873}
[S5] START round=4 head_norm_before_train=1.359939 (no previous merge yet)
[S5] round=4 local utility u=0.890365 metrics={'f1_val': 0.6730009793400413, 'auprc': 0.7781249646551375, 'loss_val': 0.8648250993287834, 'psi': 0.7150505734660797}-{'f1_val': 0.41654174186412063, 'auprc': 0.7713886421778374, 'loss_val': 1.08659082515566, 'psi': 0.5584805019896073}
[S6] START round=4 head_norm_before_train=1.218162 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6086223801189956, 'loss_val': 1.2216938090516964, 'psi': 0.32830472127836746}-{'f1_val': 0.14142628205128205, 'auprc': 0.7294876832686302, 'loss_val': 1.2448379826982336, 'psi': 0.3766508425382213}
[S7] START round=4 head_norm_before_train=0.785935 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.030142 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776099899262994, 'loss_val': 1.1524982201140728, 'psi': 0.3962780896079748}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778104046595412, 'loss_val': 1.2133842642198258, 'psi': 0.3963582555012715}
[S8] START round=4 head_norm_before_train=1.211279 (no previous merge yet)
[S8] round=4 local utility u=0.330063 metrics={'f1_val': 0.19695864186382517, 'auprc': 0.7628483708058513, 'loss_val': 1.2005820287352984, 'psi': 0.4233145334406357}-{'f1_val': 0.13995598239295717, 'auprc': 0.6745060575781504, 'loss_val': 1.2536650306063033, 'psi': 0.3537760124670345}
[S9] START round=4 head_norm_before_train=1.255153 (no previous merge yet)
[S9] round=4 local utility u=1.000000 metrics={'f1_val': 0.6581147335500233, 'auprc': 0.8654776585692818, 'loss_val': 0.6590060862097276, 'psi': 0.7410599035577268}-{'f1_val': 0.141397957139996, 'auprc': 0.8661116769337953, 'loss_val': 1.0065746637485788, 'psi': 0.43128344505751576}
[S10] START round=4 head_norm_before_train=0.828132 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6501019039044443, 'loss_val': 1.2592753940118702, 'psi': 0.3432137440868121}-{'f1_val': 0.13862163754172394, 'auprc': 0.6621539280920835, 'loss_val': 1.23797570488908, 'psi': 0.34803455376186776}
[S11] START round=4 head_norm_before_train=1.147544 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7692457805950175, 'loss_val': 1.188334182587258, 'psi': 0.3919465222618734}-{'f1_val': 0.14041368337311058, 'auprc': 0.8196835203657367, 'loss_val': 1.2527043470922472, 'psi': 0.412121618170161}
[S13] START round=4 head_norm_before_train=1.229696 (no previous merge yet)
[S13] round=4 local utility u=0.040036 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7151670224461544, 'loss_val': 1.1975079455910453, 'psi': 0.3702982665246936}-{'f1_val': 0.1403857625770531, 'auprc': 0.7019029719050317, 'loss_val': 1.237788076611701, 'psi': 0.3649926463082445}
[S14] START round=4 head_norm_before_train=1.206834 (no previous merge yet)
[S14] round=4 local utility u=0.281690 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8715230806909222, 'loss_val': 1.267940140238011, 'psi': 0.43282394400599117}-{'f1_val': 0.14035785288270378, 'auprc': 0.6936304842468594, 'loss_val': 1.2976414441888946, 'psi': 0.361666905428366}
[S15] START round=4 head_norm_before_train=1.225528 (no previous merge yet)
[S15] round=4 local utility u=0.001972 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.777041672367152, 'loss_val': 1.190468667922682, 'psi': 0.39465685976379583}-{'f1_val': 0.13973365136155833, 'auprc': 0.7927540384659265, 'loss_val': 1.24154948493647, 'psi': 0.4009418062033056}
[S16] START round=4 head_norm_before_train=0.863297 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8039908211418045, 'loss_val': 1.2610609658738718, 'psi': 0.40597879857624375}-{'f1_val': 0.14063745019920318, 'auprc': 0.818468240822077, 'loss_val': 1.2697611254603782, 'psi': 0.4117697664483527}
[S17] START round=4 head_norm_before_train=1.228322 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6221351075433925, 'loss_val': 1.2407174939240402, 'psi': 0.33342342100778766}-{'f1_val': 0.14094896331738438, 'auprc': 0.6419709998002698, 'loss_val': 1.2966963420354438, 'psi': 0.34135777791053856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:50303
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.423)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:50303
[S7] not sending this round → trigger blocked (psi=0.396)
[S15] not sending this round → trigger blocked (psi=0.395)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.433)
[S3] not sending this round → trigger blocked (psi=0.572)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.540)
[S9] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1790) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.255818)
[S16] loaded HEAD from S13 (vec_in norm=1.255818)
[S16] cosine check vs S13: cos=0.0345
[S16] BUFFERED delta from S13 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1793) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.400043)
[S3] loaded HEAD from S5 (vec_in norm=1.400043)
[S3] cosine check vs S5: cos=-0.0921
[S3] DROPPED delta from S5 (cos=-0.0921 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.337625)
[S3] loaded HEAD from S9 (vec_in norm=1.337625)
[S3] cosine check vs S9: cos=-0.1255
[S3] DROPPED delta from S9 (cos=-0.1255 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.887180
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.561755e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.781205 delta_norm=0.756175
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.831973 cos_to_last_merge=0.9693 (last merge round=1)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6148718341860857, 'loss_val': 1.2142496637140112, 'psi': 0.3310150137075743}-{'f1_val': 0.1417771333885667, 'auprc': 0.7371076350904658, 'loss_val': 1.242311652452039, 'psi': 0.37990933406932637}
[S3] START round=5 head_norm_before_train=1.327768 (no previous merge yet)
[S3] round=5 local utility u=0.872626 metrics={'f1_val': 0.6050756774701895, 'auprc': 0.9624445326963151, 'loss_val': 0.7286905941844769, 'psi': 0.7480232195606398}-{'f1_val': 0.4225626028819525, 'auprc': 0.7958304937184459, 'loss_val': 0.8790211963925634, 'psi': 0.5718697592165499}
[S4] START round=5 head_norm_before_train=0.961080 cos_to_last_merge=0.9967 (last merge round=3)
[S4] round=5 local utility u=0.199428 metrics={'f1_val': 0.41394826709542654, 'auprc': 0.7945590947124594, 'loss_val': 1.057963798833107, 'psi': 0.5661925981422398}-{'f1_val': 0.37080087703021514, 'auprc': 0.7938262612645463, 'loss_val': 1.1957377738020905, 'psi': 0.5400110307239476}
[S5] START round=5 head_norm_before_train=1.400043 (no previous merge yet)
[S5] round=5 local utility u=0.235148 metrics={'f1_val': 0.7053778084553269, 'auprc': 0.7951231117702937, 'loss_val': 0.6397850556672934, 'psi': 0.7412759297813136}-{'f1_val': 0.6730009793400413, 'auprc': 0.7781249646551375, 'loss_val': 0.8648250993287834, 'psi': 0.7150505734660797}
[S6] START round=5 head_norm_before_train=1.249558 (no previous merge yet)
[S6] round=5 local utility u=0.038214 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6128700574901539, 'loss_val': 1.1580081873713342, 'psi': 0.3300037922268308}-{'f1_val': 0.14142628205128205, 'auprc': 0.6086223801189956, 'loss_val': 1.2216938090516964, 'psi': 0.32830472127836746}
[S7] START round=5 head_norm_before_train=0.820863 cos_to_last_merge=0.9943 (last merge round=3)
[S7] round=5 local utility u=0.905205 metrics={'f1_val': 0.4169937999072137, 'auprc': 0.7768702586966252, 'loss_val': 0.9894909236961239, 'psi': 0.5609443834229784}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776099899262994, 'loss_val': 1.1524982201140728, 'psi': 0.3962780896079748}
[S8] START round=5 head_norm_before_train=1.237871 (no previous merge yet)
[S8] round=5 local utility u=0.710201 metrics={'f1_val': 0.4164753255908322, 'auprc': 0.7683083887445084, 'loss_val': 1.1136592040667117, 'psi': 0.5572085508523027}-{'f1_val': 0.19695864186382517, 'auprc': 0.7628483708058513, 'loss_val': 1.2005820287352984, 'psi': 0.4233145334406357}
[S9] START round=5 head_norm_before_train=1.337625 (no previous merge yet)
[S9] round=5 local utility u=0.480599 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9989214032231338, 'loss_val': 0.35913930204977274, 'psi': 0.8205374707201906}-{'f1_val': 0.6581147335500233, 'auprc': 0.8654776585692818, 'loss_val': 0.6590060862097276, 'psi': 0.7410599035577268}
[S10] START round=5 head_norm_before_train=0.851866 cos_to_last_merge=0.9970 (last merge round=3)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6057389750856526, 'loss_val': 1.1856153955484257, 'psi': 0.3254685725592954}-{'f1_val': 0.13862163754172394, 'auprc': 0.6501019039044443, 'loss_val': 1.2592753940118702, 'psi': 0.3432137440868121}
[S11] START round=5 head_norm_before_train=1.186641 (no previous merge yet)
[S11] round=5 local utility u=0.904159 metrics={'f1_val': 0.4223876636418746, 'auprc': 0.7735486694128716, 'loss_val': 1.084769609050175, 'psi': 0.5628520659502734}-{'f1_val': 0.14041368337311058, 'auprc': 0.7692457805950175, 'loss_val': 1.188334182587258, 'psi': 0.3919465222618734}
[S13] START round=5 head_norm_before_train=1.255818 (no previous merge yet)
[S13] round=5 local utility u=0.805561 metrics={'f1_val': 0.3993010844236631, 'auprc': 0.7170170141573425, 'loss_val': 1.1454288316286192, 'psi': 0.5263874563171349}-{'f1_val': 0.1403857625770531, 'auprc': 0.7151670224461544, 'loss_val': 1.1975079455910453, 'psi': 0.3702982665246936}
[S14] START round=5 head_norm_before_train=1.237156 (no previous merge yet)
[S14] round=5 local utility u=0.027731 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8756760259175802, 'loss_val': 1.2249369215438364, 'psi': 0.43448512209665435}-{'f1_val': 0.14035785288270378, 'auprc': 0.8715230806909222, 'loss_val': 1.267940140238011, 'psi': 0.43282394400599117}
[S15] START round=5 head_norm_before_train=1.271797 (no previous merge yet)
[S15] round=5 local utility u=0.038442 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7771921651070263, 'loss_val': 1.1140369719111036, 'psi': 0.3947170568597455}-{'f1_val': 0.13973365136155833, 'auprc': 0.777041672367152, 'loss_val': 1.190468667922682, 'psi': 0.39465685976379583}
[S16] START round=5 head_norm_before_train=0.781205 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5534954873106618, 'loss_val': 1.251874568602527, 'psi': 0.30578066504378665}-{'f1_val': 0.14063745019920318, 'auprc': 0.8039908211418045, 'loss_val': 1.2610609658738718, 'psi': 0.40597879857624375}
[S17] START round=5 head_norm_before_train=1.257525 (no previous merge yet)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5803075641803657, 'loss_val': 1.1461830793208219, 'psi': 0.3166924036625769}-{'f1_val': 0.14094896331738438, 'auprc': 0.6221351075433925, 'loss_val': 1.2407174939240402, 'psi': 0.33342342100778766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:50308
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:50307
[S9] not sending this round → trigger blocked (psi=0.821)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[S13] not sending this round → trigger blocked (psi=0.526)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:50309
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S8@127.0.0.1:50309
[S5] not sending this round → trigger blocked (psi=0.741)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1788 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1792) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.270747)
[S16] loaded HEAD from S8 (vec_in norm=1.270747)
[S16] cosine check vs S8: cos=0.4294
[S16] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.265828)
[S7] loaded HEAD from S6 (vec_in norm=1.265828)
[S7] cosine check vs S6: cos=0.0032
[S7] BUFFERED delta from S6 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1795) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.265785)
[S13] loaded HEAD from S14 (vec_in norm=1.265785)
[S13] cosine check vs S14: cos=-0.0679
[S13] DROPPED delta from S14 (cos=-0.0679 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.221961)
[S10] loaded HEAD from S11 (vec_in norm=1.221961)
[S10] cosine check vs S11: cos=0.6372
[S10] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.874141)
[S8] loaded HEAD from S7 (vec_in norm=0.874141)
[S8] cosine check vs S7: cos=-0.0629
[S8] DROPPED delta from S7 (cos=-0.0629 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1791) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.397146)
[S6] loaded HEAD from S3 (vec_in norm=1.397146)
[S6] cosine check vs S3: cos=-0.0233
[S6] DROPPED delta from S3 (cos=-0.0233 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1788) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.001853)
[S8] loaded HEAD from S4 (vec_in norm=1.001853)
[S8] cosine check vs S4: cos=-0.0261
[S8] DROPPED delta from S4 (cos=-0.0261 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.314835)
[S7] loaded HEAD from S15 (vec_in norm=1.314835)
[S7] cosine check vs S15: cos=0.7474
[S7] BUFFERED delta from S15 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.335 → S5@127.0.0.1:50305
[S9] ⇄ pheromone p=0.599 → S3@127.0.0.1:50303
[S5] ⇄ pheromone p=0.634 → S3@127.0.0.1:50303
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.1386 head_norm=0.886388
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.739585e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.1386 head_norm=0.956452 delta_norm=0.473959
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.343 → S7@127.0.0.1:50308
[S13] ⇄ pheromone p=0.516 → S16@127.0.0.1:50316
[S3] ⇄ pheromone p=0.702 → S6@127.0.0.1:50307
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.4170 head_norm=0.874141
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.283695e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.4170 head_norm=0.784108 delta_norm=0.428370
[S7] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.536 → S8@127.0.0.1:50309
[S4] ⇄ pheromone p=0.533 → S8@127.0.0.1:50309
[S11] ⇄ pheromone p=0.564 → S10@127.0.0.1:50311
[S6] ⇄ pheromone p=0.346 → S7@127.0.0.1:50308
[S8] ⇄ pheromone p=0.541 → S16@127.0.0.1:50316
[S15] ⇄ pheromone p=0.339 → S7@127.0.0.1:50308
[S14] ⇄ pheromone p=0.409 → S13@127.0.0.1:50313
[S17] ⇄ pheromone p=0.447 → S14@127.0.0.1:50314
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.802589
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.880194e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.885273 delta_norm=0.588019
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.391 → S4@127.0.0.1:50304
[S2] START round=6 head_norm_before_train=0.869985 cos_to_last_merge=0.9537 (last merge round=1)
[S2] round=6 local utility u=0.276223 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7767301796206465, 'loss_val': 1.1473792014064235, 'psi': 0.3957583518813987}-{'f1_val': 0.1417771333885667, 'auprc': 0.6148718341860857, 'loss_val': 1.2142496637140112, 'psi': 0.3310150137075743}
[S3] START round=6 head_norm_before_train=1.397146 (no previous merge yet)
[S3] round=6 local utility u=0.243678 metrics={'f1_val': 0.7003355634446948, 'auprc': 0.8677098721785732, 'loss_val': 0.5286891443891647, 'psi': 0.7672852869382462}-{'f1_val': 0.6050756774701895, 'auprc': 0.9624445326963151, 'loss_val': 0.7286905941844769, 'psi': 0.7480232195606398}
[S4] START round=6 head_norm_before_train=1.001853 cos_to_last_merge=0.9884 (last merge round=3)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.3750406592215114, 'auprc': 0.796837826714073, 'loss_val': 0.9026730623215363, 'psi': 0.5437595262185361}-{'f1_val': 0.41394826709542654, 'auprc': 0.7945590947124594, 'loss_val': 1.057963798833107, 'psi': 0.5661925981422398}
[S5] START round=6 head_norm_before_train=1.461158 (no previous merge yet)
[S5] round=6 local utility u=0.035750 metrics={'f1_val': 0.7008162875368863, 'auprc': 0.794933759464609, 'loss_val': 0.5403470510382237, 'psi': 0.7384632763079754}-{'f1_val': 0.7053778084553269, 'auprc': 0.7951231117702937, 'loss_val': 0.6397850556672934, 'psi': 0.7412759297813136}
[S6] START round=6 head_norm_before_train=1.265828 (no previous merge yet)
[S6] round=6 local utility u=1.000000 metrics={'f1_val': 0.41584976944180807, 'auprc': 0.7563945276703875, 'loss_val': 1.0667091526808878, 'psi': 0.5520676727332399}-{'f1_val': 0.14142628205128205, 'auprc': 0.6128700574901539, 'loss_val': 1.1580081873713342, 'psi': 0.3300037922268308}
[S7] START round=6 head_norm_before_train=0.784108 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.086861 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.8070396422412165, 'loss_val': 0.9045754624222553, 'psi': 0.5728419277631007}-{'f1_val': 0.4169937999072137, 'auprc': 0.7768702586966252, 'loss_val': 0.9894909236961239, 'psi': 0.5609443834229784}
[S8] START round=6 head_norm_before_train=1.270747 (no previous merge yet)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.3759809371920819, 'auprc': 0.7707562486125389, 'loss_val': 0.9740048242589188, 'psi': 0.5338910617602648}-{'f1_val': 0.4164753255908322, 'auprc': 0.7683083887445084, 'loss_val': 1.1136592040667117, 'psi': 0.5572085508523027}
[S9] START round=6 head_norm_before_train=1.443187 (no previous merge yet)
[S9] round=6 local utility u=0.035383 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9988292356767915, 'loss_val': 0.28765207442488017, 'psi': 0.8204560927918798}-{'f1_val': 0.7016148490515617, 'auprc': 0.9989214032231338, 'loss_val': 0.35913930204977274, 'psi': 0.8205374707201906}
[S10] START round=6 head_norm_before_train=0.956452 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.828512 metrics={'f1_val': 0.38652865058522834, 'auprc': 0.6558519986638858, 'loss_val': 1.1663730866914963, 'psi': 0.49425798981669133}-{'f1_val': 0.13862163754172394, 'auprc': 0.6057389750856526, 'loss_val': 1.1856153955484257, 'psi': 0.3254685725592954}
[S11] START round=6 head_norm_before_train=1.221961 (no previous merge yet)
[S11] round=6 local utility u=0.331193 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.9984319722433683, 'loss_val': 0.9622608037771215, 'psi': 0.6393280405788105}-{'f1_val': 0.4223876636418746, 'auprc': 0.7735486694128716, 'loss_val': 1.084769609050175, 'psi': 0.5628520659502734}
[S13] START round=6 head_norm_before_train=1.283595 (no previous merge yet)
[S13] round=6 local utility u=0.112564 metrics={'f1_val': 0.41607788054795825, 'auprc': 0.7249875945423634, 'loss_val': 1.0448727440674372, 'psi': 0.5396417661457202}-{'f1_val': 0.3993010844236631, 'auprc': 0.7170170141573425, 'loss_val': 1.1454288316286192, 'psi': 0.5263874563171349}
[S14] START round=6 head_norm_before_train=1.265785 (no previous merge yet)
[S14] round=6 local utility u=0.074485 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8955914580191824, 'loss_val': 1.135713967884292, 'psi': 0.44245129493729524}-{'f1_val': 0.14035785288270378, 'auprc': 0.8756760259175802, 'loss_val': 1.2249369215438364, 'psi': 0.43448512209665435}
[S15] START round=6 head_norm_before_train=1.314835 (no previous merge yet)
[S15] round=6 local utility u=0.924141 metrics={'f1_val': 0.416839147538149, 'auprc': 0.800129772548458, 'loss_val': 0.9972008779321075, 'psi': 0.5701553975422726}-{'f1_val': 0.13973365136155833, 'auprc': 0.7771921651070263, 'loss_val': 1.1140369719111036, 'psi': 0.3947170568597455}
[S16] START round=6 head_norm_before_train=0.885273 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.039836 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.564696302840781, 'loss_val': 1.2058046909653934, 'psi': 0.3102609912558343}-{'f1_val': 0.14063745019920318, 'auprc': 0.5534954873106618, 'loss_val': 1.251874568602527, 'psi': 0.30578066504378665}
[S17] START round=6 head_norm_before_train=1.291808 (no previous merge yet)
[S17] round=6 local utility u=0.929098 metrics={'f1_val': 0.3828498937174668, 'auprc': 0.6694346949993274, 'loss_val': 1.006773936790939, 'psi': 0.49748381423021104}-{'f1_val': 0.14094896331738438, 'auprc': 0.5803075641803657, 'loss_val': 1.1461830793208219, 'psi': 0.3166924036625769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:50316
[S14] not sending this round → trigger blocked (psi=0.442)
[S15] not sending this round → trigger blocked (psi=0.570)
[S6] not sending this round → trigger blocked (psi=0.552)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:50303
[S7] not sending this round → trigger blocked (psi=0.573)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:50304
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.639)
[S3] not sending this round → trigger blocked (psi=0.767)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[S16] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1794) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.905455)
[S4] loaded HEAD from S16 (vec_in norm=0.905455)
[S4] cosine check vs S16: cos=0.1568
[S4] BUFFERED delta from S16 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1792) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.316009)
[S16] loaded HEAD from S13 (vec_in norm=1.316009)
[S16] cosine check vs S13: cos=0.3860
[S16] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.976024)
[S7] loaded HEAD from S10 (vec_in norm=0.976024)
[S7] cosine check vs S10: cos=0.2538
[S7] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.898813)
[S5] loaded HEAD from S2 (vec_in norm=0.898813)
[S5] cosine check vs S2: cos=0.0234
[S5] BUFFERED delta from S2 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.538966)
[S3] loaded HEAD from S9 (vec_in norm=1.538966)
[S3] cosine check vs S9: cos=-0.1339
[S3] DROPPED delta from S9 (cos=-0.1339 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.502948)
[S3] loaded HEAD from S5 (vec_in norm=1.502948)
[S3] cosine check vs S5: cos=-0.1052
[S3] DROPPED delta from S5 (cos=-0.1052 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.325785)
[S14] loaded HEAD from S17 (vec_in norm=1.325785)
[S14] cosine check vs S17: cos=0.1089
[S14] BUFFERED delta from S17 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.3750 head_norm=1.039389
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.334442e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.6578 head_norm=0.740835 delta_norm=0.633444
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.4167 head_norm=0.843603
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.581990e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.6046 head_norm=0.721497 delta_norm=0.558199
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=1.301178
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.767970e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1696 head_norm=0.978065 delta_norm=0.876797
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.1406 head_norm=0.905455
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.387340e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.1406 head_norm=0.931602 delta_norm=0.638734
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.7008 head_norm=1.502948
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.665284e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.7011 head_norm=0.884583 delta_norm=0.866528
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.898813 cos_to_last_merge=0.9433 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.943
[S2] round=7 local utility u=0.697234 metrics={'f1_val': 0.3612010484119642, 'auprc': 0.7765543600605527, 'loss_val': 1.0689263097442951, 'psi': 0.5273423730713996}-{'f1_val': 0.1417771333885667, 'auprc': 0.7767301796206465, 'loss_val': 1.1473792014064235, 'psi': 0.3957583518813987}
[S3] START round=7 head_norm_before_train=1.481775 (no previous merge yet)
[S3] round=7 local utility u=0.174890 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9297949682480267, 'loss_val': 0.36768887944859435, 'psi': 0.7923717095403904}-{'f1_val': 0.7003355634446948, 'auprc': 0.8677098721785732, 'loss_val': 0.5286891443891647, 'psi': 0.7672852869382462}
[S4] START round=7 head_norm_before_train=0.740835 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.000475 metrics={'f1_val': 0.388018097094545, 'auprc': 0.7796415333785534, 'loss_val': 0.9279992057503926, 'psi': 0.5446674716081483}-{'f1_val': 0.3750406592215114, 'auprc': 0.796837826714073, 'loss_val': 0.9026730623215363, 'psi': 0.5437595262185361}
[S5] START round=7 head_norm_before_train=0.884583 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.007203 metrics={'f1_val': 0.7146935597656502, 'auprc': 0.7919247793285358, 'loss_val': 0.6001782183355981, 'psi': 0.7455860475908045}-{'f1_val': 0.7008162875368863, 'auprc': 0.794933759464609, 'loss_val': 0.5403470510382237, 'psi': 0.7384632763079754}
[S6] START round=7 head_norm_before_train=1.288409 (no previous merge yet)
[S6] round=7 local utility u=0.071345 metrics={'f1_val': 0.4164535851642239, 'auprc': 0.7600846022164423, 'loss_val': 0.9387131298452737, 'psi': 0.5539059919851113}-{'f1_val': 0.41584976944180807, 'auprc': 0.7563945276703875, 'loss_val': 1.0667091526808878, 'psi': 0.5520676727332399}
[S7] START round=7 head_norm_before_train=0.721497 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.109953 metrics={'f1_val': 0.4599077121255499, 'auprc': 0.7749259246201691, 'loss_val': 0.8475137995761789, 'psi': 0.5859149971233976}-{'f1_val': 0.41671011811102343, 'auprc': 0.8070396422412165, 'loss_val': 0.9045754624222553, 'psi': 0.5728419277631007}
[S8] START round=7 head_norm_before_train=1.310910 (no previous merge yet)
[S8] round=7 local utility u=0.095610 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.8012623294613431, 'loss_val': 0.8556108513908707, 'psi': 0.5442243520978431}-{'f1_val': 0.3759809371920819, 'auprc': 0.7707562486125389, 'loss_val': 0.9740048242589188, 'psi': 0.5338910617602648}
[S9] START round=7 head_norm_before_train=1.538966 (no previous merge yet)
[S9] round=7 local utility u=0.015292 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9988137336315795, 'loss_val': 0.25702081627427503, 'psi': 0.820449891973795}-{'f1_val': 0.7015406642019387, 'auprc': 0.9988292356767915, 'loss_val': 0.28765207442488017, 'psi': 0.8204560927918798}
[S10] START round=7 head_norm_before_train=0.976024 cos_to_last_merge=0.9964 (last merge round=5)
[S10] round=7 local utility u=0.189911 metrics={'f1_val': 0.4170518629654155, 'auprc': 0.6634293387607523, 'loss_val': 0.9924223810139502, 'psi': 0.5156028532835502}-{'f1_val': 0.38652865058522834, 'auprc': 0.6558519986638858, 'loss_val': 1.1663730866914963, 'psi': 0.49425798981669133}
[S11] START round=7 head_norm_before_train=1.260453 (no previous merge yet)
[S11] round=7 local utility u=0.097457 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9983619402095953, 'loss_val': 0.7466947413354345, 'psi': 0.6372559087293378}-{'f1_val': 0.39992541946910537, 'auprc': 0.9984319722433683, 'loss_val': 0.9622608037771215, 'psi': 0.6393280405788105}
[S13] START round=7 head_norm_before_train=1.316009 (no previous merge yet)
[S13] round=7 local utility u=0.693669 metrics={'f1_val': 0.6873008346558631, 'auprc': 0.6134589531445744, 'loss_val': 0.9502864371341442, 'psi': 0.6577640820513476}-{'f1_val': 0.41607788054795825, 'auprc': 0.7249875945423634, 'loss_val': 1.0448727440674372, 'psi': 0.5396417661457202}
[S14] START round=7 head_norm_before_train=0.978065 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.594487 metrics={'f1_val': 0.3020921471163082, 'auprc': 0.95971729127269, 'loss_val': 1.109524103876232, 'psi': 0.565142204778861}-{'f1_val': 0.14035785288270378, 'auprc': 0.8955914580191824, 'loss_val': 1.135713967884292, 'psi': 0.44245129493729524}
[S15] START round=7 head_norm_before_train=1.354634 (no previous merge yet)
[S15] round=7 local utility u=0.108463 metrics={'f1_val': 0.41816268809449036, 'auprc': 0.8000276962806632, 'loss_val': 0.7879094016374695, 'psi': 0.5709086913689595}-{'f1_val': 0.416839147538149, 'auprc': 0.800129772548458, 'loss_val': 0.9972008779321075, 'psi': 0.5701553975422726}
[S16] START round=7 head_norm_before_train=0.931602 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.777167 metrics={'f1_val': 0.4169598886486482, 'auprc': 0.5110381664596005, 'loss_val': 1.1484300039135222, 'psi': 0.45459119977302914}-{'f1_val': 0.14063745019920318, 'auprc': 0.564696302840781, 'loss_val': 1.2058046909653934, 'psi': 0.3102609912558343}
[S17] START round=7 head_norm_before_train=1.325785 (no previous merge yet)
[S17] round=7 local utility u=0.400077 metrics={'f1_val': 0.39720117639663666, 'auprc': 0.883572680235885, 'loss_val': 0.9351406218753883, 'psi': 0.591749777932336}-{'f1_val': 0.3828498937174668, 'auprc': 0.6694346949993274, 'loss_val': 1.006773936790939, 'psi': 0.49748381423021104}
[S2] not sending this round → trigger blocked (psi=0.527)
[S5] not sending this round → trigger blocked (psi=0.746)
[S13] not sending this round → trigger blocked (psi=0.658)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:50311
[S16] not sending this round → trigger blocked (psi=0.455)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:50313
[S10] not sending this round → trigger blocked (psi=0.516)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:50307
[S9] not sending this round → trigger blocked (psi=0.820)
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1796) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.302985)
[S10] loaded HEAD from S11 (vec_in norm=1.302985)
[S10] cosine check vs S11: cos=0.8758
[S10] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.350967)
[S16] loaded HEAD from S8 (vec_in norm=1.350967)
[S16] cosine check vs S8: cos=0.4660
[S16] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.015084)
[S13] loaded HEAD from S14 (vec_in norm=1.015084)
[S13] cosine check vs S14: cos=-0.0298
[S13] DROPPED delta from S14 (cos=-0.0298 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.782423)
[S8] loaded HEAD from S4 (vec_in norm=0.782423)
[S8] cosine check vs S4: cos=0.4879
[S8] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1796) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.564968)
[S6] loaded HEAD from S3 (vec_in norm=1.564968)
[S6] cosine check vs S3: cos=-0.0177
[S6] DROPPED delta from S3 (cos=-0.0177 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.401644)
[S7] loaded HEAD from S15 (vec_in norm=1.401644)
[S7] cosine check vs S15: cos=0.4917
[S7] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.787673)
[S8] loaded HEAD from S7 (vec_in norm=0.787673)
[S8] cosine check vs S7: cos=-0.0405
[S8] DROPPED delta from S7 (cos=-0.0405 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.322035)
[S7] loaded HEAD from S6 (vec_in norm=1.322035)
[S7] cosine check vs S6: cos=0.2300
[S7] BUFFERED delta from S6 (total buffered=2)
[S17] not sending this round → trigger blocked (psi=0.592)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.4171 head_norm=1.008244
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.214378e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.4167 head_norm=1.119750 delta_norm=0.321438
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.3729 head_norm=1.350967
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.928336e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.3729 head_norm=0.931234 delta_norm=0.592834
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.4599 head_norm=0.787673
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.406933e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.4166 head_norm=0.765105 delta_norm=0.440693
[S7] aggregate: ROLLBACK (f1_val pre=0.460 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4170 head_norm=0.950042
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.187605e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.1865 head_norm=0.990445 delta_norm=0.618761
[S16] aggregate: ROLLBACK (f1_val pre=0.417 post=0.186 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=0.939099 cos_to_last_merge=0.9296 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.930
[S2] round=8 local utility u=0.226824 metrics={'f1_val': 0.4168514471266894, 'auprc': 0.7763203768083804, 'loss_val': 0.9484796013045523, 'psi': 0.5606390189993657}-{'f1_val': 0.3612010484119642, 'auprc': 0.7765543600605527, 'loss_val': 1.0689263097442951, 'psi': 0.5273423730713996}
[S3] START round=8 head_norm_before_train=1.564968 (no previous merge yet)
[S3] round=8 local utility u=0.122134 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9950232631675678, 'loss_val': 0.31910604616770555, 'psi': 0.818463027508207}-{'f1_val': 0.7007562037352997, 'auprc': 0.9297949682480267, 'loss_val': 0.36768887944859435, 'psi': 0.7923717095403904}
[S4] START round=8 head_norm_before_train=0.782423 cos_to_last_merge=0.9943 (last merge round=6)
[S4] round=8 local utility u=0.031503 metrics={'f1_val': 0.37704596144844676, 'auprc': 0.7711799469799164, 'loss_val': 0.7737758470395126, 'psi': 0.5346995556610347}-{'f1_val': 0.388018097094545, 'auprc': 0.7796415333785534, 'loss_val': 0.9279992057503926, 'psi': 0.5446674716081483}
[S5] START round=8 head_norm_before_train=0.944763 cos_to_last_merge=0.9946 (last merge round=6)
[S5] round=8 local utility u=0.063004 metrics={'f1_val': 0.7143347548915031, 'auprc': 0.7927245283292644, 'loss_val': 0.4744172996654815, 'psi': 0.7456906642666077}-{'f1_val': 0.7146935597656502, 'auprc': 0.7919247793285358, 'loss_val': 0.6001782183355981, 'psi': 0.7455860475908045}
[S6] START round=8 head_norm_before_train=1.322035 (no previous merge yet)
[S6] round=8 local utility u=0.125291 metrics={'f1_val': 0.41745618053540323, 'auprc': 0.7890909286728205, 'loss_val': 0.7811651493078444, 'psi': 0.5661100797903702}-{'f1_val': 0.4164535851642239, 'auprc': 0.7600846022164423, 'loss_val': 0.9387131298452737, 'psi': 0.5539059919851113}
[S7] START round=8 head_norm_before_train=0.765105 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.732753 metrics={'f1_val': 0.6886777092045735, 'auprc': 0.7776898143564371, 'loss_val': 0.7629185601458119, 'psi': 0.7242825512653189}-{'f1_val': 0.4599077121255499, 'auprc': 0.7749259246201691, 'loss_val': 0.8475137995761789, 'psi': 0.5859149971233976}
[S8] START round=8 head_norm_before_train=0.931234 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.268351 metrics={'f1_val': 0.3727983816295533, 'auprc': 0.9784648455269058, 'loss_val': 0.8501126030405917, 'psi': 0.6150649671884943}-{'f1_val': 0.3728657005221765, 'auprc': 0.8012623294613431, 'loss_val': 0.8556108513908707, 'psi': 0.5442243520978431}
[S9] START round=8 head_norm_before_train=1.605777 (no previous merge yet)
[S9] round=8 local utility u=0.019474 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9983825389761114, 'loss_val': 0.21527716316737183, 'psi': 0.8201273057149826}-{'f1_val': 0.7015406642019387, 'auprc': 0.9988137336315795, 'loss_val': 0.25702081627427503, 'psi': 0.820449891973795}
[S10] START round=8 head_norm_before_train=1.119750 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.111388 metrics={'f1_val': 0.43675231540447756, 'auprc': 0.6661234017639328, 'loss_val': 0.8959316784611218, 'psi': 0.5285007499482597}-{'f1_val': 0.4170518629654155, 'auprc': 0.6634293387607523, 'loss_val': 0.9924223810139502, 'psi': 0.5156028532835502}
[S11] START round=8 head_norm_before_train=1.302985 (no previous merge yet)
[S11] round=8 local utility u=0.034130 metrics={'f1_val': 0.40062503679542427, 'auprc': 0.9994052098917401, 'loss_val': 0.7062033067813038, 'psi': 0.6401371060339506}-{'f1_val': 0.39651855440916606, 'auprc': 0.9983619402095953, 'loss_val': 0.7466947413354345, 'psi': 0.6372559087293378}
[S13] START round=8 head_norm_before_train=1.345255 (no previous merge yet)
[S13] round=8 local utility u=0.362894 metrics={'f1_val': 0.7113338601562683, 'auprc': 0.7506892228023916, 'loss_val': 0.7803872086396028, 'psi': 0.7270760052147176}-{'f1_val': 0.6873008346558631, 'auprc': 0.6134589531445744, 'loss_val': 0.9502864371341442, 'psi': 0.6577640820513476}
[S14] START round=8 head_norm_before_train=1.015084 cos_to_last_merge=0.9977 (last merge round=6)
[S14] round=8 local utility u=0.377360 metrics={'f1_val': 0.39649470961585787, 'auprc': 0.961705732214649, 'loss_val': 0.9271843126900493, 'psi': 0.6225791186553743}-{'f1_val': 0.3020921471163082, 'auprc': 0.95971729127269, 'loss_val': 1.109524103876232, 'psi': 0.565142204778861}
[S15] START round=8 head_norm_before_train=1.401644 (no previous merge yet)
[S15] round=8 local utility u=0.928457 metrics={'f1_val': 0.6963669533092582, 'auprc': 0.8019475282372293, 'loss_val': 0.605980449426636, 'psi': 0.7385991832804466}-{'f1_val': 0.41816268809449036, 'auprc': 0.8000276962806632, 'loss_val': 0.7879094016374695, 'psi': 0.5709086913689595}
[S16] START round=8 head_norm_before_train=0.990445 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.176861 metrics={'f1_val': 0.43635152710186276, 'auprc': 0.5530805879867264, 'loss_val': 1.0371843491541446, 'psi': 0.48304315145580823}-{'f1_val': 0.4169598886486482, 'auprc': 0.5110381664596005, 'loss_val': 1.1484300039135222, 'psi': 0.45459119977302914}
[S17] START round=8 head_norm_before_train=1.366977 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.35317697866335995, 'auprc': 0.6345181731576541, 'loss_val': 0.8871987274585855, 'psi': 0.46571345646107765}-{'f1_val': 0.39720117639663666, 'auprc': 0.883572680235885, 'loss_val': 0.9351406218753883, 'psi': 0.591749777932336}
[S3] not sending this round → trigger blocked (psi=0.818)
[S8] not sending this round → trigger blocked (psi=0.615)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:50316
[S15] not sending this round → trigger blocked (psi=0.739)
[S4] not sending this round → trigger blocked (psi=0.535)
[S6] not sending this round → trigger blocked (psi=0.566)
[S11] not sending this round → trigger blocked (psi=0.640)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:50303
[S14] not sending this round → trigger blocked (psi=0.623)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[S7] not sending this round → trigger blocked (psi=0.724)
[S2] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.029271)
[S3] loaded HEAD from S5 (vec_in norm=1.029271)
[S3] cosine check vs S5: cos=-0.1125
[S3] DROPPED delta from S5 (cos=-0.1125 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.649924)
[S3] loaded HEAD from S9 (vec_in norm=1.649924)
[S3] cosine check vs S9: cos=-0.1318
[S3] DROPPED delta from S9 (cos=-0.1318 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.147201)
[S7] loaded HEAD from S10 (vec_in norm=1.147201)
[S7] cosine check vs S10: cos=0.4112
[S7] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1791) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.982642)
[S5] loaded HEAD from S2 (vec_in norm=0.982642)
[S5] cosine check vs S2: cos=0.4725
[S5] BUFFERED delta from S2 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1790) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.386168)
[S16] loaded HEAD from S13 (vec_in norm=1.386168)
[S16] cosine check vs S13: cos=0.4461
[S16] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1791) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.014875)
[S4] loaded HEAD from S16 (vec_in norm=1.014875)
[S4] cosine check vs S16: cos=0.5761
[S4] BUFFERED delta from S16 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.3770 head_norm=0.842380
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.343291e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6614 head_norm=0.825316 delta_norm=0.434329
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.6887 head_norm=0.831970
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.530105e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.7140 head_norm=0.835644 delta_norm=0.553010
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4364 head_norm=1.014875
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.512308e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4363 head_norm=1.025483 delta_norm=0.651231
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.7143 head_norm=1.029271
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.170229e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.7143 head_norm=0.863238 delta_norm=0.517023
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.982642 cos_to_last_merge=0.9150 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.915
[S2] round=9 local utility u=0.938303 metrics={'f1_val': 0.7119307573250149, 'auprc': 0.7575459326965874, 'loss_val': 0.7860264107766703, 'psi': 0.730176827473644}-{'f1_val': 0.4168514471266894, 'auprc': 0.7763203768083804, 'loss_val': 0.9484796013045523, 'psi': 0.5606390189993657}
[S3] START round=9 head_norm_before_train=1.630286 (no previous merge yet)
[S3] round=9 local utility u=0.026564 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9965655605976562, 'loss_val': 0.26970460145056724, 'psi': 0.8189898257391859}-{'f1_val': 0.7007562037352997, 'auprc': 0.9950232631675678, 'loss_val': 0.31910604616770555, 'psi': 0.818463027508207}
[S4] START round=9 head_norm_before_train=0.825316 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.421203 metrics={'f1_val': 0.4285630329151936, 'auprc': 0.9603606623390628, 'loss_val': 0.8080142676239541, 'psi': 0.6412820846847413}-{'f1_val': 0.37704596144844676, 'auprc': 0.7711799469799164, 'loss_val': 0.7737758470395126, 'psi': 0.5346995556610347}
[S5] START round=9 head_norm_before_train=0.863238 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.79038702432243, 'loss_val': 0.4947345627688572, 'psi': 0.736495915731763}-{'f1_val': 0.7143347548915031, 'auprc': 0.7927245283292644, 'loss_val': 0.4744172996654815, 'psi': 0.7456906642666077}
[S6] START round=9 head_norm_before_train=1.362465 (no previous merge yet)
[S6] round=9 local utility u=0.697559 metrics={'f1_val': 0.6208549930910316, 'auprc': 0.7951086706440265, 'loss_val': 0.6244937961887893, 'psi': 0.6905564641122296}-{'f1_val': 0.41745618053540323, 'auprc': 0.7890909286728205, 'loss_val': 0.7811651493078444, 'psi': 0.5661100797903702}
[S7] START round=9 head_norm_before_train=0.835644 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.103592 metrics={'f1_val': 0.7139737313795297, 'auprc': 0.7730611251852282, 'loss_val': 0.6936250594925896, 'psi': 0.7376086889018091}-{'f1_val': 0.6886777092045735, 'auprc': 0.7776898143564371, 'loss_val': 0.7629185601458119, 'psi': 0.7242825512653189}
[S8] START round=9 head_norm_before_train=0.978055 cos_to_last_merge=0.9968 (last merge round=7)
[S8] round=9 local utility u=0.097783 metrics={'f1_val': 0.37266438550987346, 'auprc': 0.9943885056582642, 'loss_val': 0.701513218115399, 'psi': 0.6213540335692298}-{'f1_val': 0.3727983816295533, 'auprc': 0.9784648455269058, 'loss_val': 0.8501126030405917, 'psi': 0.6150649671884943}
[S9] START round=9 head_norm_before_train=1.649924 (no previous merge yet)
[S9] round=9 local utility u=0.014008 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9983800894907767, 'loss_val': 0.1872528435763089, 'psi': 0.8201263259208488}-{'f1_val': 0.7012904835408967, 'auprc': 0.9983825389761114, 'loss_val': 0.21527716316737183, 'psi': 0.8201273057149826}
[S10] START round=9 head_norm_before_train=1.147201 cos_to_last_merge=0.9964 (last merge round=7)
[S10] round=9 local utility u=1.000000 metrics={'f1_val': 0.6943995955462552, 'auprc': 0.9960008313287333, 'loss_val': 0.6747599225419905, 'psi': 0.8150400898592465}-{'f1_val': 0.43675231540447756, 'auprc': 0.6661234017639328, 'loss_val': 0.8959316784611218, 'psi': 0.5285007499482597}
[S11] START round=9 head_norm_before_train=1.338470 (no previous merge yet)
[S11] round=9 local utility u=0.714597 metrics={'f1_val': 0.611389636177291, 'auprc': 0.999669989604302, 'loss_val': 0.5423909115986355, 'psi': 0.7667017775480954}-{'f1_val': 0.40062503679542427, 'auprc': 0.9994052098917401, 'loss_val': 0.7062033067813038, 'psi': 0.6401371060339506}
[S13] START round=9 head_norm_before_train=1.386168 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.3622430817610063, 'auprc': 0.5936862131521516, 'loss_val': 0.8491780889207637, 'psi': 0.45482033431746444}-{'f1_val': 0.7113338601562683, 'auprc': 0.7506892228023916, 'loss_val': 0.7803872086396028, 'psi': 0.7270760052147176}
[S14] START round=9 head_norm_before_train=1.067793 cos_to_last_merge=0.9899 (last merge round=6)
[S14] round=9 local utility u=0.513417 metrics={'f1_val': 0.5172884215245506, 'auprc': 0.9934298576818876, 'loss_val': 0.7202858918899705, 'psi': 0.7077449959874854}-{'f1_val': 0.39649470961585787, 'auprc': 0.961705732214649, 'loss_val': 0.9271843126900493, 'psi': 0.6225791186553743}
[S15] START round=9 head_norm_before_train=1.448668 (no previous merge yet)
[S15] round=9 local utility u=0.026441 metrics={'f1_val': 0.6995495115536304, 'auprc': 0.7996488748495383, 'loss_val': 0.5652976391153911, 'psi': 0.7395892568719936}-{'f1_val': 0.6963669533092582, 'auprc': 0.8019475282372293, 'loss_val': 0.605980449426636, 'psi': 0.7385991832804466}
[S16] START round=9 head_norm_before_train=1.025483 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.3877422789982098, 'auprc': 0.5632695974643855, 'loss_val': 1.0408528972556361, 'psi': 0.45795320638468007}-{'f1_val': 0.43635152710186276, 'auprc': 0.5530805879867264, 'loss_val': 1.0371843491541446, 'psi': 0.48304315145580823}
[S17] START round=9 head_norm_before_train=1.409193 (no previous merge yet)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.35273268957802617, 'auprc': 0.5710209925045329, 'loss_val': 0.8976452277550144, 'psi': 0.44004801074862887}-{'f1_val': 0.35317697866335995, 'auprc': 0.6345181731576541, 'loss_val': 0.8871987274585855, 'psi': 0.46571345646107765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:50307
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.815)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:50309
[S2] not sending this round → trigger blocked (psi=0.730)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S4] → sending delta(kind=head bytes=1787) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1787 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1791) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.030193)
[S16] loaded HEAD from S8 (vec_in norm=1.030193)
[S16] cosine check vs S8: cos=0.5530
[S16] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.899782)
[S8] loaded HEAD from S7 (vec_in norm=0.899782)
[S8] cosine check vs S7: cos=-0.0506
[S8] DROPPED delta from S7 (cos=-0.0506 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.491138)
[S7] loaded HEAD from S15 (vec_in norm=1.491138)
[S7] cosine check vs S15: cos=0.3871
[S7] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.686762)
[S6] loaded HEAD from S3 (vec_in norm=1.686762)
[S6] cosine check vs S3: cos=-0.0096
[S6] DROPPED delta from S3 (cos=-0.0096 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1787) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.870437)
[S8] loaded HEAD from S4 (vec_in norm=0.870437)
[S8] cosine check vs S4: cos=0.8916
[S8] BUFFERED delta from S4 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1796) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.124630)
[S13] loaded HEAD from S14 (vec_in norm=1.124630)
[S13] cosine check vs S14: cos=-0.0113
[S13] DROPPED delta from S14 (cos=-0.0113 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.370086)
[S10] loaded HEAD from S11 (vec_in norm=1.370086)
[S10] cosine check vs S11: cos=0.9280
[S10] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.404696)
[S7] loaded HEAD from S6 (vec_in norm=1.404696)
[S7] cosine check vs S6: cos=0.2700
[S7] BUFFERED delta from S6 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.6944 head_norm=1.189996
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.584875e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.6952 head_norm=1.256900 delta_norm=0.258488
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3727 head_norm=1.030193
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.345251e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.4420 head_norm=0.924379 delta_norm=0.234525
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.7140 head_norm=0.899782
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.058233e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.7140 head_norm=0.828339 delta_norm=0.505823
[S7] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3877 head_norm=1.053434
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.926298e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.4053 head_norm=0.918056 delta_norm=0.492630
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.034853 cos_to_last_merge=0.8970 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.897
[S2] round=10 local utility u=0.082944 metrics={'f1_val': 0.7016193133453383, 'auprc': 0.7782134250244288, 'loss_val': 0.6202721490503572, 'psi': 0.7322569580169744}-{'f1_val': 0.7119307573250149, 'auprc': 0.7575459326965874, 'loss_val': 0.7860264107766703, 'psi': 0.730176827473644}
[S3] START round=10 head_norm_before_train=1.686762 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.8972283167396626, 'loss_val': 0.30327612715909297, 'psi': 0.7792549281959884}-{'f1_val': 0.7006060025002057, 'auprc': 0.9965655605976562, 'loss_val': 0.26970460145056724, 'psi': 0.8189898257391859}
[S4] START round=10 head_norm_before_train=0.870437 cos_to_last_merge=0.9923 (last merge round=8)
[S4] round=10 local utility u=0.109346 metrics={'f1_val': 0.4423517840449852, 'auprc': 0.9606104433398632, 'loss_val': 0.6728050461253907, 'psi': 0.6496552477629365}-{'f1_val': 0.4285630329151936, 'auprc': 0.9603606623390628, 'loss_val': 0.8080142676239541, 'psi': 0.6412820846847413}
[S5] START round=10 head_norm_before_train=0.945219 cos_to_last_merge=0.9891 (last merge round=8)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.6613125250314384, 'loss_val': 0.37433660091945675, 'psi': 0.6847178004729236}-{'f1_val': 0.7005685100046517, 'auprc': 0.79038702432243, 'loss_val': 0.4947345627688572, 'psi': 0.736495915731763}
[S6] START round=10 head_norm_before_train=1.404696 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.6107708564409499, 'auprc': 0.7861110186424332, 'loss_val': 0.5824328936587374, 'psi': 0.6809069213215432}-{'f1_val': 0.6208549930910316, 'auprc': 0.7951086706440265, 'loss_val': 0.6244937961887893, 'psi': 0.6905564641122296}
[S7] START round=10 head_norm_before_train=0.828339 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.035143 metrics={'f1_val': 0.7139737313795297, 'auprc': 0.7925469558733719, 'loss_val': 0.6817965278749981, 'psi': 0.7454030211770666}-{'f1_val': 0.7139737313795297, 'auprc': 0.7730611251852282, 'loss_val': 0.6936250594925896, 'psi': 0.7376086889018091}
[S8] START round=10 head_norm_before_train=0.924379 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=1.000000 metrics={'f1_val': 0.7136944380073925, 'auprc': 0.9945571382548442, 'loss_val': 0.6134497479901065, 'psi': 0.8260395181063731}-{'f1_val': 0.37266438550987346, 'auprc': 0.9943885056582642, 'loss_val': 0.701513218115399, 'psi': 0.6213540335692298}
[S9] START round=10 head_norm_before_train=1.686461 (no previous merge yet)
[S9] round=10 local utility u=0.883128 metrics={'f1_val': 0.9870000396042449, 'auprc': 0.9985714542168977, 'loss_val': 0.13582909564258022, 'psi': 0.991628605449306}-{'f1_val': 0.7012904835408967, 'auprc': 0.9983800894907767, 'loss_val': 0.1872528435763089, 'psi': 0.8201263259208488}
[S10] START round=10 head_norm_before_train=1.256900 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.047719 metrics={'f1_val': 0.6939580274555324, 'auprc': 0.998093256444854, 'loss_val': 0.5829500306087835, 'psi': 0.8156121190512611}-{'f1_val': 0.6943995955462552, 'auprc': 0.9960008313287333, 'loss_val': 0.6747599225419905, 'psi': 0.8150400898592465}
[S11] START round=10 head_norm_before_train=1.370086 (no previous merge yet)
[S11] round=10 local utility u=0.315901 metrics={'f1_val': 0.7021324793760719, 'auprc': 0.9990760477742316, 'loss_val': 0.45326403375629776, 'psi': 0.8209099067353358}-{'f1_val': 0.611389636177291, 'auprc': 0.999669989604302, 'loss_val': 0.5423909115986355, 'psi': 0.7667017775480954}
[S13] START round=10 head_norm_before_train=1.427363 (no previous merge yet)
[S13] round=10 local utility u=0.063714 metrics={'f1_val': 0.3692867347076341, 'auprc': 0.603792691808744, 'loss_val': 0.7943316367365852, 'psi': 0.463089117548078}-{'f1_val': 0.3622430817610063, 'auprc': 0.5936862131521516, 'loss_val': 0.8491780889207637, 'psi': 0.45482033431746444}
[S14] START round=10 head_norm_before_train=1.124630 cos_to_last_merge=0.9792 (last merge round=6)
[S14] round=10 local utility u=0.616881 metrics={'f1_val': 0.6995904974696577, 'auprc': 0.9872346637763585, 'loss_val': 0.5617504343871348, 'psi': 0.814648163992338}-{'f1_val': 0.5172884215245506, 'auprc': 0.9934298576818876, 'loss_val': 0.7202858918899705, 'psi': 0.7077449959874854}
[S15] START round=10 head_norm_before_train=1.491138 (no previous merge yet)
[S15] round=10 local utility u=0.025198 metrics={'f1_val': 0.6993742073100426, 'auprc': 0.7995690839726568, 'loss_val': 0.5136101755862404, 'psi': 0.7394521579750883}-{'f1_val': 0.6995495115536304, 'auprc': 0.7996488748495383, 'loss_val': 0.5652976391153911, 'psi': 0.7395892568719936}
[S16] START round=10 head_norm_before_train=0.918056 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.045338 metrics={'f1_val': 0.38505978651139977, 'auprc': 0.5648655432249212, 'loss_val': 0.9388690401812708, 'psi': 0.4569820891968084}-{'f1_val': 0.3877422789982098, 'auprc': 0.5632695974643855, 'loss_val': 1.0408528972556361, 'psi': 0.45795320638468007}
[S17] START round=10 head_norm_before_train=1.443648 (no previous merge yet)
[S17] round=10 local utility u=0.119703 metrics={'f1_val': 0.4079877385787043, 'auprc': 0.5449854705593904, 'loss_val': 0.911663092514467, 'psi': 0.46278683137097876}-{'f1_val': 0.35273268957802617, 'auprc': 0.5710209925045329, 'loss_val': 0.8976452277550144, 'psi': 0.44004801074862887}
[S7] not sending this round → trigger blocked (psi=0.745)
[S14] not sending this round → trigger blocked (psi=0.815)
[S4] not sending this round → trigger blocked (psi=0.650)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:50316
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:50304
[S15] not sending this round → trigger blocked (psi=0.739)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:50305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:50303
[S11] not sending this round → trigger blocked (psi=0.821)
[S8] not sending this round → trigger blocked (psi=0.826)
[S9] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1788 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.721238)
[S3] loaded HEAD from S9 (vec_in norm=1.721238)
[S3] cosine check vs S9: cos=-0.1325
[S3] DROPPED delta from S9 (cos=-0.1325 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.097017)
[S5] loaded HEAD from S2 (vec_in norm=1.097017)
[S5] cosine check vs S2: cos=0.7327
[S5] BUFFERED delta from S2 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1788) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.467188)
[S16] loaded HEAD from S13 (vec_in norm=1.467188)
[S16] cosine check vs S13: cos=0.5714
[S16] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.957942)
[S4] loaded HEAD from S16 (vec_in norm=0.957942)
[S4] cosine check vs S16: cos=0.8849
[S4] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.291892)
[S7] loaded HEAD from S10 (vec_in norm=1.291892)
[S7] cosine check vs S10: cos=0.4783
[S7] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.471153)
[S14] loaded HEAD from S17 (vec_in norm=1.471153)
[S14] cosine check vs S17: cos=0.6203
[S14] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.7140 head_norm=0.890782
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.834268e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.7137 head_norm=0.943849 delta_norm=0.583427
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.311 → S8@127.0.0.1:50309
[S3] ⇄ pheromone p=0.288 → S6@127.0.0.1:50307
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7003 head_norm=1.047692
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.927253e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7003 head_norm=0.998158 delta_norm=0.392725
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.219 → S3@127.0.0.1:50303
[S11] ⇄ pheromone p=0.404 → S10@127.0.0.1:50311
[S8] ⇄ pheromone p=0.437 → S16@127.0.0.1:50316
[S6] ⇄ pheromone p=0.330 → S7@127.0.0.1:50308
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.4424 head_norm=0.931143
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.269194e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6730 head_norm=0.916978 delta_norm=0.226919
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.268 → S8@127.0.0.1:50309
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.6996 head_norm=1.180251
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.923039e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.6997 head_norm=1.194914 delta_norm=0.592304
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.455 → S13@127.0.0.1:50313
[S2] ⇄ pheromone p=0.400 → S5@127.0.0.1:50305
[S10] ⇄ pheromone p=0.384 → S7@127.0.0.1:50308
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3851 head_norm=0.957942
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.049858e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.4363 head_norm=1.081267 delta_norm=0.604986
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.243 → S4@127.0.0.1:50304
[S13] ⇄ pheromone p=0.308 → S16@127.0.0.1:50316
[S9] ⇄ pheromone p=0.382 → S3@127.0.0.1:50303
[S15] ⇄ pheromone p=0.326 → S7@127.0.0.1:50308
[S17] ⇄ pheromone p=0.288 → S14@127.0.0.1:50314
[S2] START round=11 head_norm_before_train=1.097017 cos_to_last_merge=0.8770 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.877
[S2] round=11 local utility u=0.046305 metrics={'f1_val': 0.7019113741730649, 'auprc': 0.7559617479874512, 'loss_val': 0.4626595473615587, 'psi': 0.7235315236988195}-{'f1_val': 0.7016193133453383, 'auprc': 0.7782134250244288, 'loss_val': 0.6202721490503572, 'psi': 0.7322569580169744}
[S3] START round=11 head_norm_before_train=1.738610 (no previous merge yet)
[S3] round=11 local utility u=0.758397 metrics={'f1_val': 0.8996960954729234, 'auprc': 0.9690281057500028, 'loss_val': 0.19642126123279444, 'psi': 0.9274288995837551}-{'f1_val': 0.7006060025002057, 'auprc': 0.8972283167396626, 'loss_val': 0.30327612715909297, 'psi': 0.7792549281959884}
[S4] START round=11 head_norm_before_train=0.916978 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.686094 metrics={'f1_val': 0.671022402396934, 'auprc': 0.9541419371114735, 'loss_val': 0.6532347946095527, 'psi': 0.7842702162827498}-{'f1_val': 0.4423517840449852, 'auprc': 0.9606104433398632, 'loss_val': 0.6728050461253907, 'psi': 0.6496552477629365}
[S5] START round=11 head_norm_before_train=0.998158 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.158766 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7836038856880808, 'loss_val': 0.42540022199707006, 'psi': 0.733806589872837}-{'f1_val': 0.7003213174339138, 'auprc': 0.6613125250314384, 'loss_val': 0.37433660091945675, 'psi': 0.6847178004729236}
[S6] START round=11 head_norm_before_train=1.446129 (no previous merge yet)
[S6] round=11 local utility u=0.390605 metrics={'f1_val': 0.709607885514656, 'auprc': 0.8018057902995315, 'loss_val': 0.4413301470368959, 'psi': 0.7464870474286063}-{'f1_val': 0.6107708564409499, 'auprc': 0.7861110186424332, 'loss_val': 0.5824328936587374, 'psi': 0.6809069213215432}
[S7] START round=11 head_norm_before_train=0.943849 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.006426 metrics={'f1_val': 0.7139737313795297, 'auprc': 0.7794919647548748, 'loss_val': 0.6297793816563946, 'psi': 0.7401810247296677}-{'f1_val': 0.7139737313795297, 'auprc': 0.7925469558733719, 'loss_val': 0.6817965278749981, 'psi': 0.7454030211770666}
[S8] START round=11 head_norm_before_train=0.980924 cos_to_last_merge=0.9969 (last merge round=9)
[S8] round=11 local utility u=0.076569 metrics={'f1_val': 0.7141738056351523, 'auprc': 0.9957321718787775, 'loss_val': 0.4667125792439981, 'psi': 0.8267971521326024}-{'f1_val': 0.7136944380073925, 'auprc': 0.9945571382548442, 'loss_val': 0.6134497479901065, 'psi': 0.8260395181063731}
[S9] START round=11 head_norm_before_train=1.721238 (no previous merge yet)
[S9] round=11 local utility u=0.047561 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9986179374247721, 'loss_val': 0.10144563967872247, 'psi': 0.9977072046934469}-{'f1_val': 0.9870000396042449, 'auprc': 0.9985714542168977, 'loss_val': 0.13582909564258022, 'psi': 0.991628605449306}
[S10] START round=11 head_norm_before_train=1.291892 cos_to_last_merge=0.9979 (last merge round=9)
[S10] round=11 local utility u=0.021551 metrics={'f1_val': 0.6805845781690872, 'auprc': 0.9983574020469362, 'loss_val': 0.46039897194856094, 'psi': 0.8076937077202269}-{'f1_val': 0.6939580274555324, 'auprc': 0.998093256444854, 'loss_val': 0.5829500306087835, 'psi': 0.8156121190512611}
[S11] START round=11 head_norm_before_train=1.407907 (no previous merge yet)
[S11] round=11 local utility u=0.058901 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.998626174401812, 'loss_val': 0.3333211951612085, 'psi': 0.820650935328264}-{'f1_val': 0.7021324793760719, 'auprc': 0.9990760477742316, 'loss_val': 0.45326403375629776, 'psi': 0.8209099067353358}
[S13] START round=11 head_norm_before_train=1.467188 (no previous merge yet)
[S13] round=11 local utility u=1.000000 metrics={'f1_val': 0.7000871785040829, 'auprc': 0.7226972060501908, 'loss_val': 0.5368578132431344, 'psi': 0.7091311895225261}-{'f1_val': 0.3692867347076341, 'auprc': 0.603792691808744, 'loss_val': 0.7943316367365852, 'psi': 0.463089117548078}
[S14] START round=11 head_norm_before_train=1.194914 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.883668 metrics={'f1_val': 0.9966644730853187, 'auprc': 0.9970701882894923, 'loss_val': 0.606364735913377, 'psi': 0.9968267591669882}-{'f1_val': 0.6995904974696577, 'auprc': 0.9872346637763585, 'loss_val': 0.5617504343871348, 'psi': 0.814648163992338}
[S15] START round=11 head_norm_before_train=1.533841 (no previous merge yet)
[S15] round=11 local utility u=0.007902 metrics={'f1_val': 0.6972101099276564, 'auprc': 0.7995664999999159, 'loss_val': 0.48481327630465765, 'psi': 0.7381526659565603}-{'f1_val': 0.6993742073100426, 'auprc': 0.7995690839726568, 'loss_val': 0.5136101755862404, 'psi': 0.7394521579750883}
[S16] START round=11 head_norm_before_train=1.081267 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.256291 metrics={'f1_val': 0.4440126236761237, 'auprc': 0.6104877246507017, 'loss_val': 0.9168703301180677, 'psi': 0.5106026640659549}-{'f1_val': 0.38505978651139977, 'auprc': 0.5648655432249212, 'loss_val': 0.9388690401812708, 'psi': 0.4569820891968084}
[S17] START round=11 head_norm_before_train=1.471153 (no previous merge yet)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.3832036366702879, 'auprc': 0.5416611298237459, 'loss_val': 0.9586251447520526, 'psi': 0.4465866339316711}-{'f1_val': 0.4079877385787043, 'auprc': 0.5449854705593904, 'loss_val': 0.911663092514467, 'psi': 0.46278683137097876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[S13] not sending this round → trigger blocked (psi=0.709)
[S9] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:50303
[S10] not sending this round → trigger blocked (psi=0.808)
[S16] not sending this round → trigger blocked (psi=0.511)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[S2] not sending this round → trigger blocked (psi=0.724)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S8] → sending delta(kind=head bytes=1787) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:50313
[S5] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1787 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.236783)
[S13] loaded HEAD from S14 (vec_in norm=1.236783)
[S13] cosine check vs S14: cos=0.0041
[S13] BUFFERED delta from S14 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.996112)
[S8] loaded HEAD from S7 (vec_in norm=0.996112)
[S8] cosine check vs S7: cos=-0.0744
[S8] DROPPED delta from S7 (cos=-0.0744 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.970332)
[S8] loaded HEAD from S4 (vec_in norm=0.970332)
[S8] cosine check vs S4: cos=0.9298
[S8] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.570052)
[S7] loaded HEAD from S15 (vec_in norm=1.570052)
[S7] cosine check vs S15: cos=0.3481
[S7] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.489327)
[S7] loaded HEAD from S6 (vec_in norm=1.489327)
[S7] cosine check vs S6: cos=0.2794
[S7] BUFFERED delta from S6 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1800) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.454047)
[S10] loaded HEAD from S11 (vec_in norm=1.454047)
[S10] cosine check vs S11: cos=0.9537
[S10] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.787202)
[S6] loaded HEAD from S3 (vec_in norm=1.787202)
[S6] cosine check vs S3: cos=-0.0059
[S6] DROPPED delta from S3 (cos=-0.0059 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1787) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.042185)
[S16] loaded HEAD from S8 (vec_in norm=1.042185)
[S16] cosine check vs S8: cos=0.5843
[S16] BUFFERED delta from S8 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1793) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.058220)
[S3] loaded HEAD from S5 (vec_in norm=1.058220)
[S3] cosine check vs S5: cos=-0.0680
[S3] DROPPED delta from S5 (cos=-0.0680 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.6806 head_norm=1.330594
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.204819e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.6800 head_norm=1.376137 delta_norm=0.220482
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.7001 head_norm=1.498776
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.696335e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.5894 head_norm=0.973546 delta_norm=0.969634
[S13] aggregate: ROLLBACK (f1_val pre=0.700 post=0.589 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.7142 head_norm=1.042185
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.917498e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.7142 head_norm=0.988473 delta_norm=0.191750
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.7140 head_norm=0.996112
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.574680e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.7140 head_norm=0.888970 delta_norm=0.557468
[S7] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.4440 head_norm=1.116179
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.931244e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.5408 head_norm=0.960641 delta_norm=0.493124
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.162213 cos_to_last_merge=0.8586 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.859
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.6660201962268023, 'loss_val': 0.3652051980918581, 'psi': 0.6875071727834583}-{'f1_val': 0.7019113741730649, 'auprc': 0.7559617479874512, 'loss_val': 0.4626595473615587, 'psi': 0.7235315236988195}
[S3] START round=12 head_norm_before_train=1.787202 (no previous merge yet)
[S3] round=12 local utility u=0.280877 metrics={'f1_val': 0.9764896473060187, 'auprc': 0.9967612951060401, 'loss_val': 0.17862859399911643, 'psi': 0.9845983064260272}-{'f1_val': 0.8996960954729234, 'auprc': 0.9690281057500028, 'loss_val': 0.19642126123279444, 'psi': 0.9274288995837551}
[S4] START round=12 head_norm_before_train=0.970332 cos_to_last_merge=0.9949 (last merge round=10)
[S4] round=12 local utility u=0.909054 metrics={'f1_val': 0.959287033003998, 'auprc': 0.9530945968744141, 'loss_val': 0.5615718597786071, 'psi': 0.9568100585521645}-{'f1_val': 0.671022402396934, 'auprc': 0.9541419371114735, 'loss_val': 0.6532347946095527, 'psi': 0.7842702162827498}
[S5] START round=12 head_norm_before_train=1.058220 cos_to_last_merge=0.9949 (last merge round=10)
[S5] round=12 local utility u=0.031148 metrics={'f1_val': 0.7092565601557749, 'auprc': 0.7900231906669855, 'loss_val': 0.4342502503890329, 'psi': 0.7415632123602591}-{'f1_val': 0.7006083926626743, 'auprc': 0.7836038856880808, 'loss_val': 0.42540022199707006, 'psi': 0.733806589872837}
[S6] START round=12 head_norm_before_train=1.489327 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.7038671282793655, 'auprc': 0.786086764328547, 'loss_val': 0.46992579698617454, 'psi': 0.736754982699038}-{'f1_val': 0.709607885514656, 'auprc': 0.8018057902995315, 'loss_val': 0.4413301470368959, 'psi': 0.7464870474286063}
[S7] START round=12 head_norm_before_train=0.888970 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.014154 metrics={'f1_val': 0.6998498909218271, 'auprc': 0.7949713905871988, 'loss_val': 0.563166545651507, 'psi': 0.7378984907879758}-{'f1_val': 0.7139737313795297, 'auprc': 0.7794919647548748, 'loss_val': 0.6297793816563946, 'psi': 0.7401810247296677}
[S8] START round=12 head_norm_before_train=0.988473 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.041825 metrics={'f1_val': 0.7141092833849391, 'auprc': 0.9990418781023936, 'loss_val': 0.39260377640747557, 'psi': 0.8280823212719208}-{'f1_val': 0.7141738056351523, 'auprc': 0.9957321718787775, 'loss_val': 0.4667125792439981, 'psi': 0.8267971521326024}
[S9] START round=12 head_norm_before_train=1.751687 (no previous merge yet)
[S9] round=12 local utility u=0.012467 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984999563614141, 'loss_val': 0.07617536877294173, 'psi': 0.9976617300518513}-{'f1_val': 0.9971000495392299, 'auprc': 0.9986179374247721, 'loss_val': 0.10144563967872247, 'psi': 0.9977072046934469}
[S10] START round=12 head_norm_before_train=1.376137 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.051542 metrics={'f1_val': 0.688541343407157, 'auprc': 0.9986592534732092, 'loss_val': 0.40596208735557965, 'psi': 0.8125885074335779}-{'f1_val': 0.6805845781690872, 'auprc': 0.9983574020469362, 'loss_val': 0.46039897194856094, 'psi': 0.8076937077202269}
[S11] START round=12 head_norm_before_train=1.454047 (no previous merge yet)
[S11] round=12 local utility u=0.799552 metrics={'f1_val': 0.9545198724546704, 'auprc': 0.9985210373989748, 'loss_val': 0.24901694324864695, 'psi': 0.9721203384323922}-{'f1_val': 0.7020007759458987, 'auprc': 0.998626174401812, 'loss_val': 0.3333211951612085, 'psi': 0.820650935328264}
[S13] START round=12 head_norm_before_train=0.973546 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6009179082335273, 'auprc': 0.6224278704867852, 'loss_val': 0.7500460223544883, 'psi': 0.6095218931348304}-{'f1_val': 0.7000871785040829, 'auprc': 0.7226972060501908, 'loss_val': 0.5368578132431344, 'psi': 0.7091311895225261}
[S14] START round=12 head_norm_before_train=1.236783 cos_to_last_merge=0.9976 (last merge round=10)
[S14] round=12 local utility u=0.052125 metrics={'f1_val': 0.9910050061407945, 'auprc': 0.9948622674216919, 'loss_val': 0.4615343019203936, 'psi': 0.9925479106531534}-{'f1_val': 0.9966644730853187, 'auprc': 0.9970701882894923, 'loss_val': 0.606364735913377, 'psi': 0.9968267591669882}
[S15] START round=12 head_norm_before_train=1.570052 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.7011730619562222, 'auprc': 0.7994991869500425, 'loss_val': 0.5745451158381778, 'psi': 0.7405035119537504}-{'f1_val': 0.6972101099276564, 'auprc': 0.7995664999999159, 'loss_val': 0.48481327630465765, 'psi': 0.7381526659565603}
[S16] START round=12 head_norm_before_train=0.960641 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.714415 metrics={'f1_val': 0.6060859086406531, 'auprc': 0.7134069970683851, 'loss_val': 0.7692384547839209, 'psi': 0.649014344011746}-{'f1_val': 0.4440126236761237, 'auprc': 0.6104877246507017, 'loss_val': 0.9168703301180677, 'psi': 0.5106026640659549}
[S17] START round=12 head_norm_before_train=1.486529 (no previous merge yet)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.34948122844081253, 'auprc': 0.5857881492631893, 'loss_val': 0.9197103085414088, 'psi': 0.44400399676976327}-{'f1_val': 0.3832036366702879, 'auprc': 0.5416611298237459, 'loss_val': 0.9586251447520526, 'psi': 0.4465866339316711}
[S4] not sending this round → trigger blocked (psi=0.957)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:50303
[S7] not sending this round → trigger blocked (psi=0.738)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:50308
[S5] not sending this round → trigger blocked (psi=0.742)
[S8] not sending this round → trigger blocked (psi=0.828)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.993)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.972)
[S3] not sending this round → trigger blocked (psi=0.985)
[S10] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.787839)
[S3] loaded HEAD from S9 (vec_in norm=1.787839)
[S3] cosine check vs S9: cos=-0.1334
[S3] DROPPED delta from S9 (cos=-0.1334 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.008524)
[S4] loaded HEAD from S16 (vec_in norm=1.008524)
[S4] cosine check vs S16: cos=0.9297
[S4] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.411643)
[S7] loaded HEAD from S10 (vec_in norm=1.411643)
[S7] cosine check vs S10: cos=0.5148
[S7] BUFFERED delta from S10 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.9593 head_norm=1.029927
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.913098e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6690 head_norm=1.001167 delta_norm=0.191310
[S4] aggregate: ROLLBACK (f1_val pre=0.959 post=0.669 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.6998 head_norm=0.950947
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.154268e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.6993 head_norm=1.034296 delta_norm=0.615427
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.223870 cos_to_last_merge=0.8413 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.841
[S2] round=13 local utility u=0.018945 metrics={'f1_val': 0.7014868656050897, 'auprc': 0.666598165001722, 'loss_val': 0.32697871208746204, 'psi': 0.6875313853637426}-{'f1_val': 0.7018318238212289, 'auprc': 0.6660201962268023, 'loss_val': 0.3652051980918581, 'psi': 0.6875071727834583}
[S3] START round=13 head_norm_before_train=1.830371 (no previous merge yet)
[S3] round=13 local utility u=0.074258 metrics={'f1_val': 0.9838348379227521, 'auprc': 0.9966755950427053, 'loss_val': 0.07392734695370487, 'psi': 0.9889711407707333}-{'f1_val': 0.9764896473060187, 'auprc': 0.9967612951060401, 'loss_val': 0.17862859399911643, 'psi': 0.9845983064260272}
[S4] START round=13 head_norm_before_train=1.001167 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.9490650968576757, 'auprc': 0.944447906770749, 'loss_val': 0.5506191481170191, 'psi': 0.947218220822905}-{'f1_val': 0.959287033003998, 'auprc': 0.9530945968744141, 'loss_val': 0.5615718597786071, 'psi': 0.9568100585521645}
[S5] START round=13 head_norm_before_train=1.124125 cos_to_last_merge=0.9844 (last merge round=10)
[S5] round=13 local utility u=0.124496 metrics={'f1_val': 0.7029874431409654, 'auprc': 0.8590337396916434, 'loss_val': 0.35467485225515155, 'psi': 0.7654059617612367}-{'f1_val': 0.7092565601557749, 'auprc': 0.7900231906669855, 'loss_val': 0.4342502503890329, 'psi': 0.7415632123602591}
[S6] START round=13 head_norm_before_train=1.528986 (no previous merge yet)
[S6] round=13 local utility u=0.350296 metrics={'f1_val': 0.7132199009161767, 'auprc': 0.9579777011767626, 'loss_val': 0.34112286923994334, 'psi': 0.811123021020411}-{'f1_val': 0.7038671282793655, 'auprc': 0.786086764328547, 'loss_val': 0.46992579698617454, 'psi': 0.736754982699038}
[S7] START round=13 head_norm_before_train=1.034296 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.5902389916632733, 'auprc': 0.7905792275506573, 'loss_val': 0.6463815713257639, 'psi': 0.6703750860182269}-{'f1_val': 0.6998498909218271, 'auprc': 0.7949713905871988, 'loss_val': 0.563166545651507, 'psi': 0.7378984907879758}
[S8] START round=13 head_norm_before_train=1.042945 cos_to_last_merge=0.9972 (last merge round=11)
[S8] round=13 local utility u=0.034282 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.9971419633909906, 'loss_val': 0.3170083760520486, 'psi': 0.8271892654348652}-{'f1_val': 0.7141092833849391, 'auprc': 0.9990418781023936, 'loss_val': 0.39260377640747557, 'psi': 0.8280823212719208}
[S9] START round=13 head_norm_before_train=1.787839 (no previous merge yet)
[S9] round=13 local utility u=0.008635 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9984945976664852, 'loss_val': 0.05738659506873701, 'psi': 0.9975093903219484}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984999563614141, 'loss_val': 0.07617536877294173, 'psi': 0.9976617300518513}
[S10] START round=13 head_norm_before_train=1.411643 cos_to_last_merge=0.9987 (last merge round=11)
[S10] round=13 local utility u=0.061085 metrics={'f1_val': 0.695298717459693, 'auprc': 0.9981011548327844, 'loss_val': 0.32266253373023557, 'psi': 0.8164196924089295}-{'f1_val': 0.688541343407157, 'auprc': 0.9986592534732092, 'loss_val': 0.40596208735557965, 'psi': 0.8125885074335779}
[S11] START round=13 head_norm_before_train=1.505922 (no previous merge yet)
[S11] round=13 local utility u=0.035563 metrics={'f1_val': 0.956191288501426, 'auprc': 0.9984386091269899, 'loss_val': 0.1876714411340509, 'psi': 0.9730902167516515}-{'f1_val': 0.9545198724546704, 'auprc': 0.9985210373989748, 'loss_val': 0.24901694324864695, 'psi': 0.9721203384323922}
[S13] START round=13 head_norm_before_train=1.001303 cos_to_last_merge=0.9987 (last merge round=11)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.5958579058387075, 'auprc': 0.5817990169253668, 'loss_val': 0.7941049140590063, 'psi': 0.5902343502733712}-{'f1_val': 0.6009179082335273, 'auprc': 0.6224278704867852, 'loss_val': 0.7500460223544883, 'psi': 0.6095218931348304}
[S14] START round=13 head_norm_before_train=1.288634 cos_to_last_merge=0.9913 (last merge round=10)
[S14] round=13 local utility u=0.067470 metrics={'f1_val': 0.9963554325288462, 'auprc': 0.995633287302145, 'loss_val': 0.36101061523733996, 'psi': 0.9960665744381657}-{'f1_val': 0.9910050061407945, 'auprc': 0.9948622674216919, 'loss_val': 0.4615343019203936, 'psi': 0.9925479106531534}
[S15] START round=13 head_norm_before_train=1.601224 (no previous merge yet)
[S15] round=13 local utility u=0.088889 metrics={'f1_val': 0.6996597948496468, 'auprc': 0.7997783643050673, 'loss_val': 0.388524084072621, 'psi': 0.7397072226318151}-{'f1_val': 0.7011730619562222, 'auprc': 0.7994991869500425, 'loss_val': 0.5745451158381778, 'psi': 0.7405035119537504}
[S16] START round=13 head_norm_before_train=1.008524 cos_to_last_merge=0.9975 (last merge round=11)
[S16] round=13 local utility u=0.352742 metrics={'f1_val': 0.5973794209413927, 'auprc': 0.9340661283174295, 'loss_val': 0.6734932191639944, 'psi': 0.7320541038918074}-{'f1_val': 0.6060859086406531, 'auprc': 0.7134069970683851, 'loss_val': 0.7692384547839209, 'psi': 0.649014344011746}
[S17] START round=13 head_norm_before_train=1.497506 (no previous merge yet)
[S17] round=13 local utility u=0.105849 metrics={'f1_val': 0.34510286405808793, 'auprc': 0.6698555686148702, 'loss_val': 0.9339448509310991, 'psi': 0.47500394588080086}-{'f1_val': 0.34948122844081253, 'auprc': 0.5857881492631893, 'loss_val': 0.9197103085414088, 'psi': 0.44400399676976327}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:50313
[S9] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:50311
[S16] not sending this round → trigger blocked (psi=0.732)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:50316
[S10] not sending this round → trigger blocked (psi=0.816)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:50305
[S5] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.561953)
[S7] loaded HEAD from S6 (vec_in norm=1.561953)
[S7] cosine check vs S6: cos=0.2754
[S7] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.631582)
[S7] loaded HEAD from S15 (vec_in norm=1.631582)
[S7] cosine check vs S15: cos=0.3239
[S7] BUFFERED delta from S15 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1804) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.864862)
[S6] loaded HEAD from S3 (vec_in norm=1.864862)
[S6] cosine check vs S3: cos=-0.0019
[S6] DROPPED delta from S3 (cos=-0.0019 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.097512)
[S16] loaded HEAD from S8 (vec_in norm=1.097512)
[S16] cosine check vs S8: cos=0.9120
[S16] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.273599)
[S5] loaded HEAD from S2 (vec_in norm=1.273599)
[S5] cosine check vs S2: cos=0.8324
[S5] BUFFERED delta from S2 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1799) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.340496)
[S13] loaded HEAD from S14 (vec_in norm=1.340496)
[S13] cosine check vs S14: cos=0.5894
[S13] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.189171)
[S3] loaded HEAD from S5 (vec_in norm=1.189171)
[S3] cosine check vs S5: cos=-0.0747
[S3] DROPPED delta from S5 (cos=-0.0747 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.558435)
[S10] loaded HEAD from S11 (vec_in norm=1.558435)
[S10] cosine check vs S11: cos=0.9709
[S10] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1793 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1793) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.508677)
[S14] loaded HEAD from S17 (vec_in norm=1.508677)
[S14] cosine check vs S17: cos=0.8463
[S14] BUFFERED delta from S17 (total buffered=1)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.6953 head_norm=1.453075
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.890767e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.6913 head_norm=1.494765 delta_norm=0.189077
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.5902 head_norm=1.079693
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.023573e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.5951 head_norm=0.938265 delta_norm=0.602357
[S7] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.5959 head_norm=1.041672
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.558752e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.3774 head_norm=1.063958 delta_norm=0.555875
[S13] aggregate: ROLLBACK (f1_val pre=0.596 post=0.377 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.9964 head_norm=1.340496
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.031588e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.9787 head_norm=1.368934 delta_norm=0.403159
[S14] aggregate: ROLLBACK (f1_val pre=0.996 post=0.979 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.7030 head_norm=1.189171
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.587403e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.8695 head_norm=1.178726 delta_norm=0.358740
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.5974 head_norm=1.060008
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.270773e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.5705 head_norm=1.054756 delta_norm=0.227077
[S16] aggregate: ROLLBACK (f1_val pre=0.597 post=0.570 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.273599 cos_to_last_merge=0.8258 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.826
[S2] round=14 local utility u=0.003383 metrics={'f1_val': 0.7014868656050897, 'auprc': 0.6634807594474016, 'loss_val': 0.3108601921288375, 'psi': 0.6862844231420144}-{'f1_val': 0.7014868656050897, 'auprc': 0.666598165001722, 'loss_val': 0.32697871208746204, 'psi': 0.6875313853637426}
[S3] START round=14 head_norm_before_train=1.864862 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.9702559778372581, 'auprc': 0.9967483642970715, 'loss_val': 0.09053022990464296, 'psi': 0.9808529324211834}-{'f1_val': 0.9838348379227521, 'auprc': 0.9966755950427053, 'loss_val': 0.07392734695370487, 'psi': 0.9889711407707333}
[S4] START round=14 head_norm_before_train=1.054748 cos_to_last_merge=0.9971 (last merge round=12)
[S4] round=14 local utility u=0.041021 metrics={'f1_val': 0.9475007458203297, 'auprc': 0.9500851203591231, 'loss_val': 0.47610294777367873, 'psi': 0.9485344956358471}-{'f1_val': 0.9490650968576757, 'auprc': 0.944447906770749, 'loss_val': 0.5506191481170191, 'psi': 0.947218220822905}
[S5] START round=14 head_norm_before_train=1.178726 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7098281906053376, 'auprc': 0.7925998036976711, 'loss_val': 0.4630467395033234, 'psi': 0.742936835842271}-{'f1_val': 0.7029874431409654, 'auprc': 0.8590337396916434, 'loss_val': 0.35467485225515155, 'psi': 0.7654059617612367}
[S6] START round=14 head_norm_before_train=1.561953 (no previous merge yet)
[S6] round=14 local utility u=0.414946 metrics={'f1_val': 0.8603609333235493, 'auprc': 0.9497917360971677, 'loss_val': 0.36951952447526676, 'psi': 0.8961332544329967}-{'f1_val': 0.7132199009161767, 'auprc': 0.9579777011767626, 'loss_val': 0.34112286923994334, 'psi': 0.811123021020411}
[S7] START round=14 head_norm_before_train=0.938265 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.553905 metrics={'f1_val': 0.7138401711983833, 'auprc': 0.8599747361284847, 'loss_val': 0.48836584616585876, 'psi': 0.7722939971704239}-{'f1_val': 0.5902389916632733, 'auprc': 0.7905792275506573, 'loss_val': 0.6463815713257639, 'psi': 0.6703750860182269}
[S8] START round=14 head_norm_before_train=1.097512 cos_to_last_merge=0.9902 (last merge round=11)
[S8] round=14 local utility u=0.020473 metrics={'f1_val': 0.7141742661762565, 'auprc': 0.9981259946213219, 'loss_val': 0.28073587162602226, 'psi': 0.8277549575542826}-{'f1_val': 0.7138874667974482, 'auprc': 0.9971419633909906, 'loss_val': 0.3170083760520486, 'psi': 0.8271892654348652}
[S9] START round=14 head_norm_before_train=1.828783 (no previous merge yet)
[S9] round=14 local utility u=0.001746 metrics={'f1_val': 0.9956054446615002, 'auprc': 0.9984872281616212, 'loss_val': 0.04638887644211624, 'psi': 0.9967581580615485}-{'f1_val': 0.9968525854255906, 'auprc': 0.9984945976664852, 'loss_val': 0.05738659506873701, 'psi': 0.9975093903219484}
[S10] START round=14 head_norm_before_train=1.494765 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.273654 metrics={'f1_val': 0.7823546362722567, 'auprc': 0.9976638260126871, 'loss_val': 0.29637794812841634, 'psi': 0.8684783121684289}-{'f1_val': 0.695298717459693, 'auprc': 0.9981011548327844, 'loss_val': 0.32266253373023557, 'psi': 0.8164196924089295}
[S11] START round=14 head_norm_before_train=1.558435 (no previous merge yet)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.9176264618446967, 'auprc': 0.9984924947738569, 'loss_val': 0.22251044438803025, 'psi': 0.9499728750163607}-{'f1_val': 0.956191288501426, 'auprc': 0.9984386091269899, 'loss_val': 0.1876714411340509, 'psi': 0.9730902167516515}
[S13] START round=14 head_norm_before_train=1.063958 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.239380 metrics={'f1_val': 0.6285340262152905, 'auprc': 0.658032073937149, 'loss_val': 0.7401005005603308, 'psi': 0.640333245304034}-{'f1_val': 0.5958579058387075, 'auprc': 0.5817990169253668, 'loss_val': 0.7941049140590063, 'psi': 0.5902343502733712}
[S14] START round=14 head_norm_before_train=1.368934 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9986710121587361, 'loss_val': 0.44188085715371805, 'psi': 0.9976669097580935}-{'f1_val': 0.9963554325288462, 'auprc': 0.995633287302145, 'loss_val': 0.36101061523733996, 'psi': 0.9960665744381657}
[S15] START round=14 head_norm_before_train=1.631582 (no previous merge yet)
[S15] round=14 local utility u=0.366131 metrics={'f1_val': 0.7729415921390975, 'auprc': 0.863260776546416, 'loss_val': 0.286401045119984, 'psi': 0.8090692659020249}-{'f1_val': 0.6996597948496468, 'auprc': 0.7997783643050673, 'loss_val': 0.388524084072621, 'psi': 0.7397072226318151}
[S16] START round=14 head_norm_before_train=1.054756 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.536758251538806, 'auprc': 0.9345815768550555, 'loss_val': 0.6420794829203852, 'psi': 0.6958875816653058}-{'f1_val': 0.5973794209413927, 'auprc': 0.9340661283174295, 'loss_val': 0.6734932191639944, 'psi': 0.7320541038918074}
[S17] START round=14 head_norm_before_train=1.508677 (no previous merge yet)
[S17] round=14 local utility u=0.018035 metrics={'f1_val': 0.3456012079513039, 'auprc': 0.6834160065788162, 'loss_val': 0.9415471746023756, 'psi': 0.48072712740230883}-{'f1_val': 0.34510286405808793, 'auprc': 0.6698555686148702, 'loss_val': 0.9339448509310991, 'psi': 0.47500394588080086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:50316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:50308
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:50309
[S7] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.969666)
[S8] loaded HEAD from S7 (vec_in norm=0.969666)
[S8] cosine check vs S7: cos=-0.0917
[S8] DROPPED delta from S7 (cos=-0.0917 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.107296)
[S8] loaded HEAD from S4 (vec_in norm=1.107296)
[S8] cosine check vs S4: cos=0.9285
[S8] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.530788)
[S7] loaded HEAD from S10 (vec_in norm=1.530788)
[S7] cosine check vs S10: cos=0.5376
[S7] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.663189)
[S7] loaded HEAD from S15 (vec_in norm=1.663189)
[S7] cosine check vs S15: cos=0.6337
[S7] BUFFERED delta from S15 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.585808)
[S7] loaded HEAD from S6 (vec_in norm=1.585808)
[S7] cosine check vs S6: cos=0.5769
[S7] BUFFERED delta from S6 (total buffered=3)
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.090041)
[S16] loaded HEAD from S13 (vec_in norm=1.090041)
[S16] cosine check vs S13: cos=0.2111
[S16] BUFFERED delta from S13 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.147828)
[S16] loaded HEAD from S8 (vec_in norm=1.147828)
[S16] cosine check vs S8: cos=0.9666
[S16] BUFFERED delta from S8 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1803) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.316654)
[S5] loaded HEAD from S2 (vec_in norm=1.316654)
[S5] cosine check vs S2: cos=0.9340
[S5] BUFFERED delta from S2 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.870493)
[S3] loaded HEAD from S9 (vec_in norm=1.870493)
[S3] cosine check vs S9: cos=-0.1361
[S3] DROPPED delta from S9 (cos=-0.1361 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.524398)
[S14] loaded HEAD from S17 (vec_in norm=1.524398)
[S14] cosine check vs S17: cos=0.9506
[S14] BUFFERED delta from S17 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9970 head_norm=1.408107
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.375985e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9977 head_norm=1.448041 delta_norm=0.237598
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7098 head_norm=1.243886
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.352653e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.8259 head_norm=1.258994 delta_norm=0.235265
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.7142 head_norm=1.147828
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.141338e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.7142 head_norm=1.107228 delta_norm=0.214134
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.7138 head_norm=0.969666
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.666561e-02
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.7138 head_norm=0.952446 delta_norm=0.086666
[S7] aggregate: ACCEPT kept=['S10', 'S15', 'S6'] (k=3/3) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.5368 head_norm=1.104252
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.359627e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.5374 head_norm=0.923300 delta_norm=0.335963
[S16] aggregate: ACCEPT kept=['S13', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.316654 cos_to_last_merge=0.8141 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.814
[S2] round=15 local utility u=0.000493 metrics={'f1_val': 0.7014799340771918, 'auprc': 0.6677463049519996, 'loss_val': 0.32262920698216624, 'psi': 0.6879864824271149}-{'f1_val': 0.7014868656050897, 'auprc': 0.6634807594474016, 'loss_val': 0.3108601921288375, 'psi': 0.6862844231420144}
[S3] START round=15 head_norm_before_train=1.898244 (no previous merge yet)
[S3] round=15 local utility u=0.098003 metrics={'f1_val': 0.9953422023821595, 'auprc': 0.9967858400313694, 'loss_val': 0.045154426460742074, 'psi': 0.9959196574418435}-{'f1_val': 0.9702559778372581, 'auprc': 0.9967483642970715, 'loss_val': 0.09053022990464296, 'psi': 0.9808529324211834}
[S4] START round=15 head_norm_before_train=1.107296 cos_to_last_merge=0.9912 (last merge round=12)
[S4] round=15 local utility u=0.077258 metrics={'f1_val': 0.9543451717815256, 'auprc': 0.9560851871949934, 'loss_val': 0.3806539305965361, 'psi': 0.9550411779469126}-{'f1_val': 0.9475007458203297, 'auprc': 0.9500851203591231, 'loss_val': 0.47610294777367873, 'psi': 0.9485344956358471}
[S5] START round=15 head_norm_before_train=1.258994 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.150690 metrics={'f1_val': 0.7026871952913571, 'auprc': 0.8817249380648917, 'loss_val': 0.3861959012105908, 'psi': 0.774302292400771}-{'f1_val': 0.7098281906053376, 'auprc': 0.7925998036976711, 'loss_val': 0.4630467395033234, 'psi': 0.742936835842271}
[S6] START round=15 head_norm_before_train=1.585808 (no previous merge yet)
[S6] round=15 local utility u=0.260125 metrics={'f1_val': 0.9373986967897175, 'auprc': 0.9555844206371131, 'loss_val': 0.32887425505483137, 'psi': 0.9446729863286758}-{'f1_val': 0.8603609333235493, 'auprc': 0.9497917360971677, 'loss_val': 0.36951952447526676, 'psi': 0.8961332544329967}
[S7] START round=15 head_norm_before_train=0.952446 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.5077228451009588, 'auprc': 0.7759213693499424, 'loss_val': 0.8053791632647347, 'psi': 0.6150022548005523}-{'f1_val': 0.7138401711983833, 'auprc': 0.8599747361284847, 'loss_val': 0.48836584616585876, 'psi': 0.7722939971704239}
[S8] START round=15 head_norm_before_train=1.107228 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.014147 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9990767135310248, 'loss_val': 0.2531869882960163, 'psi': 0.827924452402766}-{'f1_val': 0.7141742661762565, 'auprc': 0.9981259946213219, 'loss_val': 0.28073587162602226, 'psi': 0.8277549575542826}
[S9] START round=15 head_norm_before_train=1.870493 (no previous merge yet)
[S9] round=15 local utility u=0.008855 metrics={'f1_val': 0.9968497224526777, 'auprc': 0.9985961672504902, 'loss_val': 0.03647073917425857, 'psi': 0.9975483003718026}-{'f1_val': 0.9956054446615002, 'auprc': 0.9984872281616212, 'loss_val': 0.04638887644211624, 'psi': 0.9967581580615485}
[S10] START round=15 head_norm_before_train=1.530788 cos_to_last_merge=0.9990 (last merge round=13)
[S10] round=15 local utility u=0.679852 metrics={'f1_val': 0.9939197551845682, 'auprc': 0.9979288921157683, 'loss_val': 0.20685919035768613, 'psi': 0.9955234099570482}-{'f1_val': 0.7823546362722567, 'auprc': 0.9976638260126871, 'loss_val': 0.29637794812841634, 'psi': 0.8684783121684289}
[S11] START round=15 head_norm_before_train=1.601018 (no previous merge yet)
[S11] round=15 local utility u=0.166602 metrics={'f1_val': 0.9595093614673276, 'auprc': 0.9984056687195064, 'loss_val': 0.14034351829858638, 'psi': 0.9750678843681991}-{'f1_val': 0.9176264618446967, 'auprc': 0.9984924947738569, 'loss_val': 0.22251044438803025, 'psi': 0.9499728750163607}
[S13] START round=15 head_norm_before_train=1.090041 cos_to_last_merge=0.9958 (last merge round=13)
[S13] round=15 local utility u=0.068883 metrics={'f1_val': 0.6283339528823488, 'auprc': 0.6725478033889488, 'loss_val': 0.6446813917130045, 'psi': 0.6460194930849888}-{'f1_val': 0.6285340262152905, 'auprc': 0.658032073937149, 'loss_val': 0.7401005005603308, 'psi': 0.640333245304034}
[S14] START round=15 head_norm_before_train=1.448041 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.011483 metrics={'f1_val': 0.9978849930363543, 'auprc': 0.9986708906313442, 'loss_val': 0.4242390611000757, 'psi': 0.9981993520743502}-{'f1_val': 0.9969975081576651, 'auprc': 0.9986710121587361, 'loss_val': 0.44188085715371805, 'psi': 0.9976669097580935}
[S15] START round=15 head_norm_before_train=1.663189 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.7005971591452436, 'auprc': 0.7997055223918634, 'loss_val': 0.4319850960186006, 'psi': 0.7402405044438916}-{'f1_val': 0.7729415921390975, 'auprc': 0.863260776546416, 'loss_val': 0.286401045119984, 'psi': 0.8090692659020249}
[S16] START round=15 head_norm_before_train=0.923300 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.580372 metrics={'f1_val': 0.6777423151668132, 'auprc': 0.9923237121183134, 'loss_val': 0.5004663085785748, 'psi': 0.8035748739474133}-{'f1_val': 0.536758251538806, 'auprc': 0.9345815768550555, 'loss_val': 0.6420794829203852, 'psi': 0.6958875816653058}
[S17] START round=15 head_norm_before_train=1.524398 (no previous merge yet)
[S17] round=15 local utility u=0.100755 metrics={'f1_val': 0.34960332519138915, 'auprc': 0.7308321397114699, 'loss_val': 0.9062976727637687, 'psi': 0.5020948509994214}-{'f1_val': 0.3456012079513039, 'auprc': 0.6834160065788162, 'loss_val': 0.9415471746023756, 'psi': 0.48072712740230883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:50305
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:50316
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.906618)
[S3] loaded HEAD from S9 (vec_in norm=1.906618)
[S3] cosine check vs S9: cos=-0.1361
[S3] DROPPED delta from S9 (cos=-0.1361 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.937535)
[S6] loaded HEAD from S3 (vec_in norm=1.937535)
[S6] cosine check vs S3: cos=0.0060
[S6] BUFFERED delta from S3 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.481022)
[S13] loaded HEAD from S14 (vec_in norm=1.481022)
[S13] cosine check vs S14: cos=0.8020
[S13] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1796) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.632536)
[S10] loaded HEAD from S11 (vec_in norm=1.632536)
[S10] cosine check vs S11: cos=0.9806
[S10] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.145687)
[S16] loaded HEAD from S8 (vec_in norm=1.145687)
[S16] cosine check vs S8: cos=0.9463
[S16] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.134961)
[S16] loaded HEAD from S13 (vec_in norm=1.134961)
[S16] cosine check vs S13: cos=0.4730
[S16] BUFFERED delta from S13 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1804) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.607771)
[S7] loaded HEAD from S6 (vec_in norm=1.607771)
[S7] cosine check vs S6: cos=0.5828
[S7] BUFFERED delta from S6 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.307793)
[S3] loaded HEAD from S5 (vec_in norm=1.307793)
[S3] cosine check vs S5: cos=-0.0416
[S3] DROPPED delta from S5 (cos=-0.0416 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.353992)
[S5] loaded HEAD from S2 (vec_in norm=1.353992)
[S5] cosine check vs S2: cos=0.9666
[S5] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.970663)
[S4] loaded HEAD from S16 (vec_in norm=0.970663)
[S4] cosine check vs S16: cos=0.9273
[S4] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.567397)
[S7] loaded HEAD from S10 (vec_in norm=1.567397)
[S7] cosine check vs S10: cos=0.5602
[S7] BUFFERED delta from S10 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.154008)
[S8] loaded HEAD from S4 (vec_in norm=1.154008)
[S8] cosine check vs S4: cos=0.9701
[S8] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.542037)
[S14] loaded HEAD from S17 (vec_in norm=1.542037)
[S14] cosine check vs S17: cos=0.9792
[S14] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.5077 head_norm=0.973469
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.424013e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.5022 head_norm=1.000349 delta_norm=0.342401
[S7] aggregate: ROLLBACK (f1_val pre=0.508 post=0.502 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.193 → S8@127.0.0.1:50309
[S15] ⇄ pheromone p=0.177 → S7@127.0.0.1:50308
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.9374 head_norm=1.607771
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.255131e+00
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.8979 head_norm=1.262588 delta_norm=1.255131
[S6] aggregate: ROLLBACK (f1_val pre=0.937 post=0.898 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.304 → S7@127.0.0.1:50308
[S3] ⇄ pheromone p=0.214 → S6@127.0.0.1:50307
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9979 head_norm=1.481022
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.569423e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9978 head_norm=1.503670 delta_norm=0.156942
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.238 → S13@127.0.0.1:50313
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.6777 head_norm=0.970663
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.931979e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.6737 head_norm=0.907748 delta_norm=0.193198
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.335 → S4@127.0.0.1:50304
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.9543 head_norm=1.154008
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.216788e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.9545 head_norm=1.042985 delta_norm=0.221679
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.259 → S8@127.0.0.1:50309
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6283 head_norm=1.134961
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.431118e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6901 head_norm=1.242753 delta_norm=0.443112
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.235 → S16@127.0.0.1:50316
[S2] ⇄ pheromone p=0.138 → S5@127.0.0.1:50305
[S9] ⇄ pheromone p=0.134 → S3@127.0.0.1:50303
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.7138 head_norm=1.145687
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.406845e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.7138 head_norm=1.141216 delta_norm=0.140685
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.164 → S16@127.0.0.1:50316
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7027 head_norm=1.307793
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.734546e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.8274 head_norm=1.319743 delta_norm=0.173455
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.134 → S3@127.0.0.1:50303
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.9939 head_norm=1.567397
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.610606e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.9933 head_norm=1.592172 delta_norm=0.161061
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.320 → S7@127.0.0.1:50308
[S11] ⇄ pheromone p=0.257 → S10@127.0.0.1:50311
[S17] ⇄ pheromone p=0.131 → S14@127.0.0.1:50314
[S2] START round=16 head_norm_before_train=1.353992 cos_to_last_merge=0.8049 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.805
[S2] round=16 local utility u=0.003235 metrics={'f1_val': 0.7014900204402302, 'auprc': 0.6656276865949557, 'loss_val': 0.30986366972831453, 'psi': 0.6871450869021205}-{'f1_val': 0.7014799340771918, 'auprc': 0.6677463049519996, 'loss_val': 0.32262920698216624, 'psi': 0.6879864824271149}
[S3] START round=16 head_norm_before_train=1.937535 (no previous merge yet)
[S3] round=16 local utility u=0.010041 metrics={'f1_val': 0.9973670153333725, 'auprc': 0.9966429082413397, 'loss_val': 0.03679296637113699, 'psi': 0.9970773724965594}-{'f1_val': 0.9953422023821595, 'auprc': 0.9967858400313694, 'loss_val': 0.045154426460742074, 'psi': 0.9959196574418435}
[S4] START round=16 head_norm_before_train=1.042985 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.943384908088432, 'auprc': 0.9560192934060859, 'loss_val': 0.39499405262462783, 'psi': 0.9484386622154936}-{'f1_val': 0.9543451717815256, 'auprc': 0.9560851871949934, 'loss_val': 0.3806539305965361, 'psi': 0.9550411779469126}
[S5] START round=16 head_norm_before_train=1.319743 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7140417197344127, 'auprc': 0.7924615012335265, 'loss_val': 0.508354636353682, 'psi': 0.7454096323340582}-{'f1_val': 0.7026871952913571, 'auprc': 0.8817249380648917, 'loss_val': 0.3861959012105908, 'psi': 0.774302292400771}
[S6] START round=16 head_norm_before_train=1.262588 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.8299638850806037, 'auprc': 0.9668371092705894, 'loss_val': 0.513070792045537, 'psi': 0.8847131747565979}-{'f1_val': 0.9373986967897175, 'auprc': 0.9555844206371131, 'loss_val': 0.32887425505483137, 'psi': 0.9446729863286758}
[S7] START round=16 head_norm_before_train=1.000349 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.146837 metrics={'f1_val': 0.5511662561682176, 'auprc': 0.7805511073099575, 'loss_val': 0.7862549501075934, 'psi': 0.6429201966249135}-{'f1_val': 0.5077228451009588, 'auprc': 0.7759213693499424, 'loss_val': 0.8053791632647347, 'psi': 0.6150022548005523}
[S8] START round=16 head_norm_before_train=1.141216 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.7141742661762565, 'auprc': 0.9991875076826854, 'loss_val': 0.25883439931515156, 'psi': 0.828179562778828}-{'f1_val': 0.7138229449839267, 'auprc': 0.9990767135310248, 'loss_val': 0.2531869882960163, 'psi': 0.827924452402766}
[S9] START round=16 head_norm_before_train=1.906618 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9969098866034776, 'loss_val': 0.0318981664326299, 'psi': 0.9968755058967453}-{'f1_val': 0.9968497224526777, 'auprc': 0.9985961672504902, 'loss_val': 0.03647073917425857, 'psi': 0.9975483003718026}
[S10] START round=16 head_norm_before_train=1.592172 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.009589 metrics={'f1_val': 0.9934963850121371, 'auprc': 0.997823620173389, 'loss_val': 0.1848257142590363, 'psi': 0.9952272790766379}-{'f1_val': 0.9939197551845682, 'auprc': 0.9979288921157683, 'loss_val': 0.20685919035768613, 'psi': 0.9955234099570482}
[S11] START round=16 head_norm_before_train=1.632536 (no previous merge yet)
[S11] round=16 local utility u=0.008488 metrics={'f1_val': 0.96069231861869, 'auprc': 0.9984486706470259, 'loss_val': 0.13059441897747603, 'psi': 0.9757948594300243}-{'f1_val': 0.9595093614673276, 'auprc': 0.9984056687195064, 'loss_val': 0.14034351829858638, 'psi': 0.9750678843681991}
[S13] START round=16 head_norm_before_train=1.242753 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.5951824181672156, 'auprc': 0.7003579568601689, 'loss_val': 0.7292934992110595, 'psi': 0.6372526336443969}-{'f1_val': 0.6283339528823488, 'auprc': 0.6725478033889488, 'loss_val': 0.6446813917130045, 'psi': 0.6460194930849888}
[S14] START round=16 head_norm_before_train=1.503670 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.9340303589430898, 'auprc': 0.9970587491631728, 'loss_val': 0.35479773450444513, 'psi': 0.959241715031123}-{'f1_val': 0.9978849930363543, 'auprc': 0.9986708906313442, 'loss_val': 0.4242390611000757, 'psi': 0.9981993520743502}
[S15] START round=16 head_norm_before_train=1.692768 (no previous merge yet)
[S15] round=16 local utility u=1.000000 metrics={'f1_val': 0.9969030960409148, 'auprc': 0.9977365884698632, 'loss_val': 0.14953421826167895, 'psi': 0.9972364930124942}-{'f1_val': 0.7005971591452436, 'auprc': 0.7997055223918634, 'loss_val': 0.4319850960186006, 'psi': 0.7402405044438916}
[S16] START round=16 head_norm_before_train=0.907748 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.057642 metrics={'f1_val': 0.6911154369348067, 'auprc': 0.9929821217994631, 'loss_val': 0.4673955692827483, 'psi': 0.8118621108806693}-{'f1_val': 0.6777423151668132, 'auprc': 0.9923237121183134, 'loss_val': 0.5004663085785748, 'psi': 0.8035748739474133}
[S17] START round=16 head_norm_before_train=1.542037 (no previous merge yet)
[S17] round=16 local utility u=0.153394 metrics={'f1_val': 0.37520235746749175, 'auprc': 0.7551853310950725, 'loss_val': 0.8261638354238796, 'psi': 0.5271955469185241}-{'f1_val': 0.34960332519138915, 'auprc': 0.7308321397114699, 'loss_val': 0.9062976727637687, 'psi': 0.5020948509994214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:50304
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:50311
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:50305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S3] → sending delta(kind=head bytes=1809) to S6@127.0.0.1:50307
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1809 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.384302)
[S5] loaded HEAD from S2 (vec_in norm=1.384302)
[S5] cosine check vs S2: cos=0.9778
[S5] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1792) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.957158)
[S4] loaded HEAD from S16 (vec_in norm=0.957158)
[S4] cosine check vs S16: cos=0.9406
[S4] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.721432)
[S7] loaded HEAD from S15 (vec_in norm=1.721432)
[S7] cosine check vs S15: cos=0.3332
[S7] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1792) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.025763)
[S8] loaded HEAD from S7 (vec_in norm=1.025763)
[S8] cosine check vs S7: cos=-0.1039
[S8] DROPPED delta from S7 (cos=-0.1039 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.659687)
[S10] loaded HEAD from S11 (vec_in norm=1.659687)
[S10] cosine check vs S11: cos=0.9913
[S10] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.622141)
[S7] loaded HEAD from S10 (vec_in norm=1.622141)
[S7] cosine check vs S10: cos=0.6727
[S7] BUFFERED delta from S10 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1809) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.969912)
[S6] loaded HEAD from S3 (vec_in norm=1.969912)
[S6] cosine check vs S3: cos=0.7551
[S6] BUFFERED delta from S3 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.561287)
[S14] loaded HEAD from S17 (vec_in norm=1.561287)
[S14] cosine check vs S17: cos=0.9877
[S14] BUFFERED delta from S17 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.9434 head_norm=1.086699
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.873079e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9445 head_norm=1.006702 delta_norm=0.187308
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7140 head_norm=1.370939
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.453463e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7223 head_norm=1.369948 delta_norm=0.145346
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.8300 head_norm=1.286663
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.535404e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.3446 head_norm=1.530004 delta_norm=0.653540
[S6] aggregate: ROLLBACK (f1_val pre=0.830 post=0.345 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9340 head_norm=1.537729
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.220689e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9315 head_norm=1.544737 delta_norm=0.122069
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.9935 head_norm=1.622141
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.096108e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.9928 head_norm=1.637357 delta_norm=0.109611
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.5512 head_norm=1.025763
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.362282e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.5468 head_norm=1.021815 delta_norm=0.436228
[S7] aggregate: ACCEPT kept=['S15', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.384302 cos_to_last_merge=0.7984 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.798
[S2] round=17 local utility u=0.002327 metrics={'f1_val': 0.7017474301177078, 'auprc': 0.6717279304439085, 'loss_val': 0.3250558267228819, 'psi': 0.6897396302481882}-{'f1_val': 0.7014900204402302, 'auprc': 0.6656276865949557, 'loss_val': 0.30986366972831453, 'psi': 0.6871450869021205}
[S3] START round=17 head_norm_before_train=1.969912 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.9485138145773777, 'auprc': 0.9968208710188953, 'loss_val': 0.12268817081322705, 'psi': 0.9678366371539847}-{'f1_val': 0.9973670153333725, 'auprc': 0.9966429082413397, 'loss_val': 0.03679296637113699, 'psi': 0.9970773724965594}
[S4] START round=17 head_norm_before_train=1.006702 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9455589488071613, 'auprc': 0.94863109934357, 'loss_val': 0.38956290462137444, 'psi': 0.9467878090217248}-{'f1_val': 0.943384908088432, 'auprc': 0.9560192934060859, 'loss_val': 0.39499405262462783, 'psi': 0.9484386622154936}
[S5] START round=17 head_norm_before_train=1.369948 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.191605 metrics={'f1_val': 0.7041630614027353, 'auprc': 0.8941943876470393, 'loss_val': 0.37107226531975346, 'psi': 0.7801755919004569}-{'f1_val': 0.7140417197344127, 'auprc': 0.7924615012335265, 'loss_val': 0.508354636353682, 'psi': 0.7454096323340582}
[S6] START round=17 head_norm_before_train=1.530004 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.5129236455879781, 'auprc': 0.8256030716496178, 'loss_val': 0.9135072965389618, 'psi': 0.637995416012634}-{'f1_val': 0.8299638850806037, 'auprc': 0.9668371092705894, 'loss_val': 0.513070792045537, 'psi': 0.8847131747565979}
[S7] START round=17 head_norm_before_train=1.021815 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.140160 metrics={'f1_val': 0.5774455764735942, 'auprc': 0.7844412600310209, 'loss_val': 0.6752820560104033, 'psi': 0.6602438498965648}-{'f1_val': 0.5511662561682176, 'auprc': 0.7805511073099575, 'loss_val': 0.7862549501075934, 'psi': 0.6429201966249135}
[S8] START round=17 head_norm_before_train=1.176377 cos_to_last_merge=0.9986 (last merge round=15)
[S8] round=17 local utility u=0.879838 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9991486709586279, 'loss_val': 0.19211382761450296, 'psi': 0.9974713133448259}-{'f1_val': 0.7141742661762565, 'auprc': 0.9991875076826854, 'loss_val': 0.25883439931515156, 'psi': 0.828179562778828}
[S9] START round=17 head_norm_before_train=1.937439 (no previous merge yet)
[S9] round=17 local utility u=0.005512 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987733053019665, 'loss_val': 0.027965725697754792, 'psi': 0.9977710696280723}-{'f1_val': 0.9968525854255906, 'auprc': 0.9969098866034776, 'loss_val': 0.0318981664326299, 'psi': 0.9968755058967453}
[S10] START round=17 head_norm_before_train=1.637357 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.014919 metrics={'f1_val': 0.9937298155689185, 'auprc': 0.9975733335946054, 'loss_val': 0.1556378238166242, 'psi': 0.9952672227791932}-{'f1_val': 0.9934963850121371, 'auprc': 0.997823620173389, 'loss_val': 0.1848257142590363, 'psi': 0.9952272790766379}
[S11] START round=17 head_norm_before_train=1.659687 (no previous merge yet)
[S11] round=17 local utility u=0.118317 metrics={'f1_val': 0.9973956186030093, 'auprc': 0.9984207462183381, 'loss_val': 0.11409604702394592, 'psi': 0.9978056696491407}-{'f1_val': 0.96069231861869, 'auprc': 0.9984486706470259, 'loss_val': 0.13059441897747603, 'psi': 0.9757948594300243}
[S13] START round=17 head_norm_before_train=1.275879 cos_to_last_merge=0.9962 (last merge round=15)
[S13] round=17 local utility u=0.250505 metrics={'f1_val': 0.6740720416900801, 'auprc': 0.6711367794687886, 'loss_val': 0.6139570624036698, 'psi': 0.6728979368015635}-{'f1_val': 0.5951824181672156, 'auprc': 0.7003579568601689, 'loss_val': 0.7292934992110595, 'psi': 0.6372526336443969}
[S14] START round=17 head_norm_before_train=1.544737 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.177006 metrics={'f1_val': 0.982216851385796, 'auprc': 0.9986864453643092, 'loss_val': 0.2947867895025191, 'psi': 0.9888046889772013}-{'f1_val': 0.9340303589430898, 'auprc': 0.9970587491631728, 'loss_val': 0.35479773450444513, 'psi': 0.959241715031123}
[S15] START round=17 head_norm_before_train=1.721432 (no previous merge yet)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.7745754467961371, 'auprc': 0.9042890579601329, 'loss_val': 0.2659316408339943, 'psi': 0.8264608912617355}-{'f1_val': 0.9969030960409148, 'auprc': 0.9977365884698632, 'loss_val': 0.14953421826167895, 'psi': 0.9972364930124942}
[S16] START round=17 head_norm_before_train=0.957158 cos_to_last_merge=0.9970 (last merge round=15)
[S16] round=17 local utility u=0.590030 metrics={'f1_val': 0.8730806718116921, 'auprc': 0.9905190985109777, 'loss_val': 0.3717386988371395, 'psi': 0.9200560424914064}-{'f1_val': 0.6911154369348067, 'auprc': 0.9929821217994631, 'loss_val': 0.4673955692827483, 'psi': 0.8118621108806693}
[S17] START round=17 head_norm_before_train=1.561287 (no previous merge yet)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.3742974460108212, 'auprc': 0.7200889570451373, 'loss_val': 0.8313597557412942, 'psi': 0.5126140504245477}-{'f1_val': 0.37520235746749175, 'auprc': 0.7551853310950725, 'loss_val': 0.8261638354238796, 'psi': 0.5271955469185241}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:50309
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:50316
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:50303
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:50305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:50303
[S16] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.059452)
[S8] loaded HEAD from S7 (vec_in norm=1.059452)
[S8] cosine check vs S7: cos=-0.1073
[S8] DROPPED delta from S7 (cos=-0.1073 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.017393)
[S4] loaded HEAD from S16 (vec_in norm=1.017393)
[S4] cosine check vs S16: cos=0.9769
[S4] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.667166)
[S7] loaded HEAD from S10 (vec_in norm=1.667166)
[S7] cosine check vs S10: cos=0.7340
[S7] BUFFERED delta from S10 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1805) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.218288)
[S16] loaded HEAD from S8 (vec_in norm=1.218288)
[S16] cosine check vs S8: cos=0.8906
[S16] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.314453)
[S16] loaded HEAD from S13 (vec_in norm=1.314453)
[S16] cosine check vs S13: cos=0.4982
[S16] BUFFERED delta from S13 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.409491)
[S5] loaded HEAD from S2 (vec_in norm=1.409491)
[S5] cosine check vs S2: cos=0.9828
[S5] BUFFERED delta from S2 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.419994)
[S3] loaded HEAD from S5 (vec_in norm=1.419994)
[S3] cosine check vs S5: cos=-0.0314
[S3] DROPPED delta from S5 (cos=-0.0314 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.580251)
[S13] loaded HEAD from S14 (vec_in norm=1.580251)
[S13] cosine check vs S14: cos=0.9050
[S13] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.683083)
[S10] loaded HEAD from S11 (vec_in norm=1.683083)
[S10] cosine check vs S11: cos=0.9948
[S10] BUFFERED delta from S11 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.967544)
[S3] loaded HEAD from S9 (vec_in norm=1.967544)
[S3] cosine check vs S9: cos=-0.1350
[S3] DROPPED delta from S9 (cos=-0.1350 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9456 head_norm=1.046435
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.118846e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.9465 head_norm=1.025933 delta_norm=0.111885
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.5774 head_norm=1.059452
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.720277e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.5501 head_norm=1.274255 delta_norm=0.572028
[S7] aggregate: ROLLBACK (f1_val pre=0.577 post=0.550 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.8731 head_norm=1.017393
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.010175e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.6906 head_norm=0.961994 delta_norm=0.201017
[S16] aggregate: ROLLBACK (f1_val pre=0.873 post=0.691 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9937 head_norm=1.667166
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.581724e-02
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9931 head_norm=1.672944 delta_norm=0.085817
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.6741 head_norm=1.314453
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.411031e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6790 head_norm=1.412848 delta_norm=0.341103
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.7042 head_norm=1.419994
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.314719e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.8304 head_norm=1.408630 delta_norm=0.131472
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.409491 cos_to_last_merge=0.7941 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.794
[S2] round=18 local utility u=0.000985 metrics={'f1_val': 0.701228211871511, 'auprc': 0.675741785662656, 'loss_val': 0.33201223625974446, 'psi': 0.691033641387969}-{'f1_val': 0.7017474301177078, 'auprc': 0.6717279304439085, 'loss_val': 0.3250558267228819, 'psi': 0.6897396302481882}
[S3] START round=18 head_norm_before_train=1.999953 (no previous merge yet)
[S3] round=18 local utility u=0.022973 metrics={'f1_val': 0.9583255004013783, 'auprc': 0.9969173395409513, 'loss_val': 0.13590073966313723, 'psi': 0.9737622360572076}-{'f1_val': 0.9485138145773777, 'auprc': 0.9968208710188953, 'loss_val': 0.12268817081322705, 'psi': 0.9678366371539847}
[S4] START round=18 head_norm_before_train=1.025933 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.069239 metrics={'f1_val': 0.9548243213746672, 'auprc': 0.9647239705961638, 'loss_val': 0.3549559969391971, 'psi': 0.9587841810632658}-{'f1_val': 0.9455589488071613, 'auprc': 0.94863109934357, 'loss_val': 0.38956290462137444, 'psi': 0.9467878090217248}
[S5] START round=18 head_norm_before_train=1.408630 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.166868 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9930630046347242, 'loss_val': 0.31261449569834215, 'psi': 0.8175902374514943}-{'f1_val': 0.7041630614027353, 'auprc': 0.8941943876470393, 'loss_val': 0.37107226531975346, 'psi': 0.7801755919004569}
[S6] START round=18 head_norm_before_train=1.543151 cos_to_last_merge=0.9978 (last merge round=16)
[S6] round=18 local utility u=1.000000 metrics={'f1_val': 0.8216630260074238, 'auprc': 0.9413855538701743, 'loss_val': 0.5787741190065636, 'psi': 0.869552037152524}-{'f1_val': 0.5129236455879781, 'auprc': 0.8256030716496178, 'loss_val': 0.9135072965389618, 'psi': 0.637995416012634}
[S7] START round=18 head_norm_before_train=1.274255 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.051044 metrics={'f1_val': 0.5860847531582773, 'auprc': 0.7955821341946461, 'loss_val': 0.6584516965305095, 'psi': 0.6698837055728248}-{'f1_val': 0.5774455764735942, 'auprc': 0.7844412600310209, 'loss_val': 0.6752820560104033, 'psi': 0.6602438498965648}
[S8] START round=18 head_norm_before_train=1.218288 cos_to_last_merge=0.9949 (last merge round=15)
[S8] round=18 local utility u=0.018406 metrics={'f1_val': 0.9948741547680577, 'auprc': 0.9991090655654792, 'loss_val': 0.1463091780844767, 'psi': 0.9965681190870264}-{'f1_val': 0.9963530749356245, 'auprc': 0.9991486709586279, 'loss_val': 0.19211382761450296, 'psi': 0.9974713133448259}
[S9] START round=18 head_norm_before_train=1.967544 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.990399656971262, 'auprc': 0.9987834539736682, 'loss_val': 0.038046282347978085, 'psi': 0.9937531757722244}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987733053019665, 'loss_val': 0.027965725697754792, 'psi': 0.9977710696280723}
[S10] START round=18 head_norm_before_train=1.672944 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.007181 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965424432373727, 'loss_val': 0.1469315993186178, 'psi': 0.9957296807065739}-{'f1_val': 0.9937298155689185, 'auprc': 0.9975733335946054, 'loss_val': 0.1556378238166242, 'psi': 0.9952672227791932}
[S11] START round=18 head_norm_before_train=1.683083 (no previous merge yet)
[S11] round=18 local utility u=0.003105 metrics={'f1_val': 0.9969812955738739, 'auprc': 0.9980166067913935, 'loss_val': 0.10418768923782169, 'psi': 0.9973954200608817}-{'f1_val': 0.9973956186030093, 'auprc': 0.9984207462183381, 'loss_val': 0.11409604702394592, 'psi': 0.9978056696491407}
[S13] START round=18 head_norm_before_train=1.412848 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.6080127322527463, 'auprc': 0.692557788125422, 'loss_val': 0.6761410847685879, 'psi': 0.6418307546018166}-{'f1_val': 0.6740720416900801, 'auprc': 0.6711367794687886, 'loss_val': 0.6139570624036698, 'psi': 0.6728979368015635}
[S14] START round=18 head_norm_before_train=1.580251 cos_to_last_merge=0.9984 (last merge round=16)
[S14] round=18 local utility u=0.079881 metrics={'f1_val': 0.9943183518468823, 'auprc': 0.998783755026025, 'loss_val': 0.20792551581377944, 'psi': 0.9961045131185394}-{'f1_val': 0.982216851385796, 'auprc': 0.9986864453643092, 'loss_val': 0.2947867895025191, 'psi': 0.9888046889772013}
[S15] START round=18 head_norm_before_train=1.753226 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.7036452742082118, 'auprc': 0.7995842727460448, 'loss_val': 0.526346764623752, 'psi': 0.742020873623345}-{'f1_val': 0.7745754467961371, 'auprc': 0.9042890579601329, 'loss_val': 0.2659316408339943, 'psi': 0.8264608912617355}
[S16] START round=18 head_norm_before_train=0.961994 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.5580796511310906, 'auprc': 0.992846686024013, 'loss_val': 0.7198699778302442, 'psi': 0.7319864650882596}-{'f1_val': 0.8730806718116921, 'auprc': 0.9905190985109777, 'loss_val': 0.3717386988371395, 'psi': 0.9200560424914064}
[S17] START round=18 head_norm_before_train=1.582679 (no previous merge yet)
[S17] round=18 local utility u=0.013212 metrics={'f1_val': 0.37332558539944904, 'auprc': 0.7490506294214784, 'loss_val': 0.8859887337322503, 'psi': 0.5236156030082608}-{'f1_val': 0.3742974460108212, 'auprc': 0.7200889570451373, 'loss_val': 0.8313597557412942, 'psi': 0.5126140504245477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:50309
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:50305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:50303
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:50307
[S3] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1807 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1807) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.462187)
[S3] loaded HEAD from S5 (vec_in norm=1.462187)
[S3] cosine check vs S5: cos=-0.0319
[S3] DROPPED delta from S5 (cos=-0.0319 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.304556)
[S8] loaded HEAD from S7 (vec_in norm=1.304556)
[S8] cosine check vs S7: cos=-0.1000
[S8] DROPPED delta from S7 (cos=-0.1000 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.566130)
[S7] loaded HEAD from S6 (vec_in norm=1.566130)
[S7] cosine check vs S6: cos=0.0324
[S7] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.697846)
[S7] loaded HEAD from S10 (vec_in norm=1.697846)
[S7] cosine check vs S10: cos=0.9526
[S7] BUFFERED delta from S10 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.023594)
[S6] loaded HEAD from S3 (vec_in norm=2.023594)
[S6] cosine check vs S3: cos=0.9304
[S6] BUFFERED delta from S3 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.070445)
[S8] loaded HEAD from S4 (vec_in norm=1.070445)
[S8] cosine check vs S4: cos=0.9313
[S8] BUFFERED delta from S4 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1803) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.704894)
[S10] loaded HEAD from S11 (vec_in norm=1.704894)
[S10] cosine check vs S11: cos=0.9965
[S10] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.625243)
[S13] loaded HEAD from S14 (vec_in norm=1.625243)
[S13] cosine check vs S14: cos=0.9729
[S13] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.430587)
[S5] loaded HEAD from S2 (vec_in norm=1.430587)
[S5] cosine check vs S2: cos=0.9847
[S5] BUFFERED delta from S2 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.266713)
[S16] loaded HEAD from S8 (vec_in norm=1.266713)
[S16] cosine check vs S8: cos=0.8319
[S16] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.604492)
[S14] loaded HEAD from S17 (vec_in norm=1.604492)
[S14] cosine check vs S17: cos=0.9821
[S14] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.6080 head_norm=1.437302
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.012854e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.6074 head_norm=1.520891 delta_norm=0.201285
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9943 head_norm=1.625243
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.533189e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9931 head_norm=1.607606 delta_norm=0.153319
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.5861 head_norm=1.304556
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.487525e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.5746 head_norm=1.135544 delta_norm=0.448752
[S7] aggregate: ROLLBACK (f1_val pre=0.586 post=0.575 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.9952 head_norm=1.697846
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.097314e-02
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.9952 head_norm=1.699893 delta_norm=0.070973
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9949 head_norm=1.266713
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.370870e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9952 head_norm=1.148476 delta_norm=0.237087
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7006 head_norm=1.462187
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.275118e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7006 head_norm=1.440842 delta_norm=0.127512
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.8217 head_norm=1.566130
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.031638e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.8221 head_norm=1.763890 delta_norm=0.403164
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.5581 head_norm=1.020776
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.518920e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.5485 head_norm=1.095192 delta_norm=0.351892
[S16] aggregate: ROLLBACK (f1_val pre=0.558 post=0.549 tol_abs=0.005 tol_rel=0.0)
[S2] START round=19 head_norm_before_train=1.430587 cos_to_last_merge=0.7906 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.791
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.5879647396047732, 'auprc': 0.6196005167014274, 'loss_val': 0.7233220655618198, 'psi': 0.6006190504434349}-{'f1_val': 0.701228211871511, 'auprc': 0.675741785662656, 'loss_val': 0.33201223625974446, 'psi': 0.691033641387969}
[S3] START round=19 head_norm_before_train=2.023594 (no previous merge yet)
[S3] round=19 local utility u=0.151760 metrics={'f1_val': 0.9940325657029188, 'auprc': 0.9968569370514371, 'loss_val': 0.0464415486286766, 'psi': 0.995162314242326}-{'f1_val': 0.9583255004013783, 'auprc': 0.9969173395409513, 'loss_val': 0.13590073966313723, 'psi': 0.9737622360572076}
[S4] START round=19 head_norm_before_train=1.070445 cos_to_last_merge=0.9985 (last merge round=17)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9424757221192303, 'auprc': 0.944591341950824, 'loss_val': 0.3498603626353549, 'psi': 0.9433219700518677}-{'f1_val': 0.9548243213746672, 'auprc': 0.9647239705961638, 'loss_val': 0.3549559969391971, 'psi': 0.9587841810632658}
[S5] START round=19 head_norm_before_train=1.440842 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7077051522975779, 'auprc': 0.8654701604589434, 'loss_val': 0.37859829763427394, 'psi': 0.7708111555621242}-{'f1_val': 0.7006083926626743, 'auprc': 0.9930630046347242, 'loss_val': 0.31261449569834215, 'psi': 0.8175902374514943}
[S6] START round=19 head_norm_before_train=1.763890 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.762713022071017, 'auprc': 0.9256632282035597, 'loss_val': 0.6914087724630634, 'psi': 0.8278931045240341}-{'f1_val': 0.8216630260074238, 'auprc': 0.9413855538701743, 'loss_val': 0.5787741190065636, 'psi': 0.869552037152524}
[S7] START round=19 head_norm_before_train=1.135544 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.048500 metrics={'f1_val': 0.6022781863999043, 'auprc': 0.7916168864334331, 'loss_val': 0.6467160540288427, 'psi': 0.6780136664133158}-{'f1_val': 0.5860847531582773, 'auprc': 0.7955821341946461, 'loss_val': 0.6584516965305095, 'psi': 0.6698837055728248}
[S8] START round=19 head_norm_before_train=1.148476 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9947267123181514, 'auprc': 0.9991689879818064, 'loss_val': 0.1566058017670164, 'psi': 0.9965036225836135}-{'f1_val': 0.9948741547680577, 'auprc': 0.9991090655654792, 'loss_val': 0.1463091780844767, 'psi': 0.9965681190870264}
[S9] START round=19 head_norm_before_train=1.992296 (no previous merge yet)
[S9] round=19 local utility u=0.026151 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9981293748143949, 'loss_val': 0.024002440819277198, 'psi': 0.9975134974330436}-{'f1_val': 0.990399656971262, 'auprc': 0.9987834539736682, 'loss_val': 0.038046282347978085, 'psi': 0.9937531757722244}
[S10] START round=19 head_norm_before_train=1.699893 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.006661 metrics={'f1_val': 0.9938290824763921, 'auprc': 0.9973568471827983, 'loss_val': 0.12789961880799658, 'psi': 0.9952401883589546}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965424432373727, 'loss_val': 0.1469315993186178, 'psi': 0.9957296807065739}
[S11] START round=19 head_norm_before_train=1.704894 (no previous merge yet)
[S11] round=19 local utility u=0.007143 metrics={'f1_val': 0.9967394579561065, 'auprc': 0.9981914539757156, 'loss_val': 0.08897519259056158, 'psi': 0.9973202563639503}-{'f1_val': 0.9969812955738739, 'auprc': 0.9980166067913935, 'loss_val': 0.10418768923782169, 'psi': 0.9973954200608817}
[S13] START round=19 head_norm_before_train=1.520891 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6129758879602825, 'auprc': 0.6716635308329965, 'loss_val': 0.6803072364637833, 'psi': 0.6364509451093681}-{'f1_val': 0.6080127322527463, 'auprc': 0.692557788125422, 'loss_val': 0.6761410847685879, 'psi': 0.6418307546018166}
[S14] START round=19 head_norm_before_train=1.607606 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.022248 metrics={'f1_val': 0.9976943331204965, 'auprc': 0.999163867108743, 'loss_val': 0.18482634916741078, 'psi': 0.9982821467157952}-{'f1_val': 0.9943183518468823, 'auprc': 0.998783755026025, 'loss_val': 0.20792551581377944, 'psi': 0.9961045131185394}
[S15] START round=19 head_norm_before_train=1.782226 (no previous merge yet)
[S15] round=19 local utility u=1.000000 metrics={'f1_val': 0.9944158033581959, 'auprc': 0.9983417516338309, 'loss_val': 0.07954336306041057, 'psi': 0.99598618266845}-{'f1_val': 0.7036452742082118, 'auprc': 0.7995842727460448, 'loss_val': 0.526346764623752, 'psi': 0.742020873623345}
[S16] START round=19 head_norm_before_train=1.095192 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=1.000000 metrics={'f1_val': 0.9870240672171267, 'auprc': 0.9914289848692539, 'loss_val': 0.2683018569405155, 'psi': 0.9887860342779775}-{'f1_val': 0.5580796511310906, 'auprc': 0.992846686024013, 'loss_val': 0.7198699778302442, 'psi': 0.7319864650882596}
[S17] START round=19 head_norm_before_train=1.604492 (no previous merge yet)
[S17] round=19 local utility u=0.121852 metrics={'f1_val': 0.3905940562196554, 'auprc': 0.7584450102201492, 'loss_val': 0.7740788475411677, 'psi': 0.537734437819853}-{'f1_val': 0.37332558539944904, 'auprc': 0.7490506294214784, 'loss_val': 0.8859887337322503, 'psi': 0.5236156030082608}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:50311
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:50313
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:50307
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:50308
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:50303
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.011076)
[S3] loaded HEAD from S9 (vec_in norm=2.011076)
[S3] cosine check vs S9: cos=-0.1332
[S3] DROPPED delta from S9 (cos=-0.1332 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.162179)
[S8] loaded HEAD from S7 (vec_in norm=1.162179)
[S8] cosine check vs S7: cos=-0.1002
[S8] DROPPED delta from S7 (cos=-0.1002 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1794) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.727109)
[S7] loaded HEAD from S10 (vec_in norm=1.727109)
[S7] cosine check vs S10: cos=0.9039
[S7] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.805026)
[S7] loaded HEAD from S15 (vec_in norm=1.805026)
[S7] cosine check vs S15: cos=0.1895
[S7] BUFFERED delta from S15 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1797) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.047469)
[S6] loaded HEAD from S3 (vec_in norm=2.047469)
[S6] cosine check vs S3: cos=0.9788
[S6] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1793) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.151907)
[S4] loaded HEAD from S16 (vec_in norm=1.151907)
[S4] cosine check vs S16: cos=0.9903
[S4] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.653083)
[S13] loaded HEAD from S14 (vec_in norm=1.653083)
[S13] cosine check vs S14: cos=0.9857
[S13] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.732614)
[S10] loaded HEAD from S11 (vec_in norm=1.732614)
[S10] cosine check vs S11: cos=0.9970
[S10] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.630950)
[S14] loaded HEAD from S17 (vec_in norm=1.630950)
[S14] cosine check vs S17: cos=0.9883
[S14] BUFFERED delta from S17 (total buffered=1)
[S5] r=20 psi=0.771 u=0.0000 p_local=0.1062 f1=0.708 auprc=0.865 bytes=16182
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.6130 head_norm=1.545692
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.453338e-01
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.6131 head_norm=1.593675 delta_norm=0.145334
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.636 u=0.0000 p_local=0.1283 f1=0.613 auprc=0.672 bytes=14343
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.7627 head_norm=1.779422
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.378345e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.7489 head_norm=1.903331 delta_norm=0.237834
[S6] aggregate: ROLLBACK (f1_val pre=0.763 post=0.749 tol_abs=0.005 tol_rel=0.0)
[S6] r=20 psi=0.828 u=0.0000 p_local=0.2843 f1=0.763 auprc=0.926 bytes=16185
[S2] r=20 psi=0.601 u=0.0000 p_local=0.0572 f1=0.588 auprc=0.620 bytes=17971
[S8] r=20 psi=0.997 u=0.0000 p_local=0.1828 f1=0.995 auprc=0.999 bytes=19766
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9425 head_norm=1.109378
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.155163e-02
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9429 head_norm=1.127898 delta_norm=0.081552
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.943 u=0.0000 p_local=0.1172 f1=0.942 auprc=0.945 bytes=16164
[S9] r=20 psi=0.998 u=0.0262 p_local=0.0606 f1=0.997 auprc=0.998 bytes=17989
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9938 head_norm=1.727109
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.715654e-02
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9934 head_norm=1.728560 delta_norm=0.067157
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.995 u=0.0067 p_local=0.1366 f1=0.994 auprc=0.997 bytes=19774
[S11] r=20 psi=0.997 u=0.0071 p_local=0.1232 f1=0.997 auprc=0.998 bytes=21553
[S16] r=20 psi=0.989 u=1.0000 p_local=0.4186 f1=0.987 auprc=0.991 bytes=17949
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9977 head_norm=1.653083
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.258591e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9977 head_norm=1.637223 delta_norm=0.125859
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.998 u=0.0222 p_local=0.1372 f1=0.998 auprc=0.999 bytes=19774
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.6023 head_norm=1.162179
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.221020e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.5975 head_norm=1.133213 delta_norm=0.422102
[S7] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S7] r=20 psi=0.678 u=0.0485 p_local=0.1297 f1=0.602 auprc=0.792 bytes=19770
[S3] r=20 psi=0.995 u=0.1518 p_local=0.1228 f1=0.994 auprc=0.997 bytes=19793
[S15] r=20 psi=0.996 u=1.0000 p_local=0.3751 f1=0.994 auprc=0.998 bytes=17992
[S17] r=20 psi=0.538 u=0.1219 p_local=0.0958 f1=0.391 auprc=0.758 bytes=16182
[S2] START round=20 head_norm_before_train=1.449701 cos_to_last_merge=0.7879 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.788
[S2] round=20 local utility u=0.686160 metrics={'f1_val': 0.7040348423333277, 'auprc': 0.7670896373670651, 'loss_val': 0.48989101539351915, 'psi': 0.7292567603468227}-{'f1_val': 0.5879647396047732, 'auprc': 0.6196005167014274, 'loss_val': 0.7233220655618198, 'psi': 0.6006190504434349}
[S3] START round=20 head_norm_before_train=2.047469 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.9656392588443294, 'auprc': 0.9967554850462017, 'loss_val': 0.07472416875132756, 'psi': 0.9780857493250784}-{'f1_val': 0.9940325657029188, 'auprc': 0.9968569370514371, 'loss_val': 0.0464415486286766, 'psi': 0.995162314242326}
[S4] START round=20 head_norm_before_train=1.127898 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.083311 metrics={'f1_val': 0.9550299031740676, 'auprc': 0.9608814866854076, 'loss_val': 0.30743437458166945, 'psi': 0.9573705365786036}-{'f1_val': 0.9424757221192303, 'auprc': 0.944591341950824, 'loss_val': 0.3498603626353549, 'psi': 0.9433219700518677}
[S5] START round=20 head_norm_before_train=1.484862 cos_to_last_merge=0.9979 (last merge round=18)
[S5] round=20 local utility u=0.224590 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.995141095057426, 'loss_val': 0.2758495641186573, 'psi': 0.818421473620575}-{'f1_val': 0.7077051522975779, 'auprc': 0.8654701604589434, 'loss_val': 0.37859829763427394, 'psi': 0.7708111555621242}
[S6] START round=20 head_norm_before_train=1.903331 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.6960038260132704, 'auprc': 0.9271527447837714, 'loss_val': 0.6726006112803489, 'psi': 0.7884633935214708}-{'f1_val': 0.762713022071017, 'auprc': 0.9256632282035597, 'loss_val': 0.6914087724630634, 'psi': 0.8278931045240341}
[S7] START round=20 head_norm_before_train=1.133213 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.5840532220362202, 'auprc': 0.7967277285048222, 'loss_val': 0.6682415554520035, 'psi': 0.669123024623661}-{'f1_val': 0.6022781863999043, 'auprc': 0.7916168864334331, 'loss_val': 0.6467160540288427, 'psi': 0.6780136664133158}
[S8] START round=20 head_norm_before_train=1.195505 cos_to_last_merge=0.9989 (last merge round=18)
[S8] round=20 local utility u=0.001988 metrics={'f1_val': 0.9919623662602236, 'auprc': 0.9984274420455178, 'loss_val': 0.13381926535260025, 'psi': 0.9945483965743414}-{'f1_val': 0.9947267123181514, 'auprc': 0.9991689879818064, 'loss_val': 0.1566058017670164, 'psi': 0.9965036225836135}
[S9] START round=20 head_norm_before_train=2.011076 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9955491700712952, 'loss_val': 0.02389828709258075, 'psi': 0.9964814155358037}-{'f1_val': 0.9971029125121428, 'auprc': 0.9981293748143949, 'loss_val': 0.024002440819277198, 'psi': 0.9975134974330436}
[S10] START round=20 head_norm_before_train=1.728560 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.011937 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9963658263209765, 'loss_val': 0.10920464121684541, 'psi': 0.9956590339400154}-{'f1_val': 0.9938290824763921, 'auprc': 0.9973568471827983, 'loss_val': 0.12789961880799658, 'psi': 0.9952401883589546}
[S11] START round=20 head_norm_before_train=1.732614 (no previous merge yet)
[S11] round=20 local utility u=0.005403 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9981895992604353, 'loss_val': 0.07713133712982823, 'psi': 0.9972163220879023}-{'f1_val': 0.9967394579561065, 'auprc': 0.9981914539757156, 'loss_val': 0.08897519259056158, 'psi': 0.9973202563639503}
[S13] START round=20 head_norm_before_train=1.593675 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.050292 metrics={'f1_val': 0.6230269294070041, 'auprc': 0.6701027533025592, 'loss_val': 0.6353476953376801, 'psi': 0.6418572589652262}-{'f1_val': 0.6129758879602825, 'auprc': 0.6716635308329965, 'loss_val': 0.6803072364637833, 'psi': 0.6364509451093681}
[S14] START round=20 head_norm_before_train=1.637223 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.011102 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9991611529165381, 'loss_val': 0.1623541875608304, 'psi': 0.9982551319965274}-{'f1_val': 0.9976943331204965, 'auprc': 0.999163867108743, 'loss_val': 0.18482634916741078, 'psi': 0.9982821467157952}
[S15] START round=20 head_norm_before_train=1.805026 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.7891988619681567, 'auprc': 0.9582153541486451, 'loss_val': 0.22312019742666936, 'psi': 0.8568054588403521}-{'f1_val': 0.9944158033581959, 'auprc': 0.9983417516338309, 'loss_val': 0.07954336306041057, 'psi': 0.99598618266845}
[S16] START round=20 head_norm_before_train=1.151907 cos_to_last_merge=0.9985 (last merge round=18)
[S16] round=20 local utility u=0.051362 metrics={'f1_val': 0.9907120088140093, 'auprc': 0.9946809292617806, 'loss_val': 0.19746060607223273, 'psi': 0.9922995769931178}-{'f1_val': 0.9870240672171267, 'auprc': 0.9914289848692539, 'loss_val': 0.2683018569405155, 'psi': 0.9887860342779775}
[S17] START round=20 head_norm_before_train=1.630950 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.38331048909414756, 'auprc': 0.7818061079663359, 'loss_val': 0.8146469572078764, 'psi': 0.5427087366430229}-{'f1_val': 0.3905940562196554, 'auprc': 0.7584450102201492, 'loss_val': 0.7740788475411677, 'psi': 0.537734437819853}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:50313
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:50316
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:50305
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.759590)
[S7] loaded HEAD from S10 (vec_in norm=1.759590)
[S7] cosine check vs S10: cos=0.8442
[S7] BUFFERED delta from S10 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.619130)
[S16] loaded HEAD from S13 (vec_in norm=1.619130)
[S16] cosine check vs S13: cos=0.2062
[S16] BUFFERED delta from S13 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.243307)
[S16] loaded HEAD from S8 (vec_in norm=1.243307)
[S16] cosine check vs S8: cos=0.9848
[S16] BUFFERED delta from S8 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.199951)
[S4] loaded HEAD from S16 (vec_in norm=1.199951)
[S4] cosine check vs S16: cos=0.9955
[S4] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.466530)
[S5] loaded HEAD from S2 (vec_in norm=1.466530)
[S5] cosine check vs S2: cos=0.9823
[S5] BUFFERED delta from S2 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1797) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.761191)
[S10] loaded HEAD from S11 (vec_in norm=1.761191)
[S10] cosine check vs S11: cos=0.9970
[S10] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1792) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.683247)
[S13] loaded HEAD from S14 (vec_in norm=1.683247)
[S13] cosine check vs S14: cos=0.9903
[S13] BUFFERED delta from S14 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1791) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.165461)
[S8] loaded HEAD from S4 (vec_in norm=1.165461)
[S8] cosine check vs S4: cos=0.9815
[S8] BUFFERED delta from S4 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.519610)
[S3] loaded HEAD from S5 (vec_in norm=1.519610)
[S3] cosine check vs S5: cos=-0.0294
[S3] DROPPED delta from S5 (cos=-0.0294 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.227 → S7@127.0.0.1:50308
[S3] ⇄ pheromone p=0.098 → S6@127.0.0.1:50307
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.5841 head_norm=1.170743
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.971408e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.5746 head_norm=1.409343 delta_norm=0.497141
[S7] aggregate: ROLLBACK (f1_val pre=0.584 post=0.575 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.104 → S8@127.0.0.1:50309
[S9] ⇄ pheromone p=0.049 → S3@127.0.0.1:50303
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.7006 head_norm=1.519610
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.429173e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.7006 head_norm=1.486451 delta_norm=0.142917
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.130 → S3@127.0.0.1:50303
[S11] ⇄ pheromone p=0.100 → S10@127.0.0.1:50311
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9952 head_norm=1.759590
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.778950e-02
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9952 head_norm=1.759085 delta_norm=0.067790
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.112 → S7@127.0.0.1:50308
[S2] ⇄ pheromone p=0.183 → S5@127.0.0.1:50305
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9907 head_norm=1.199951
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.249476e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9907 head_norm=1.056178 delta_norm=0.424948
[S16] aggregate: ACCEPT kept=['S13', 'S8'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.345 → S4@127.0.0.1:50304
[S14] ⇄ pheromone p=0.112 → S13@127.0.0.1:50313
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9920 head_norm=1.243307
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.222677e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9923 head_norm=1.198794 delta_norm=0.122268
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.147 → S16@127.0.0.1:50316
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.6230 head_norm=1.619130
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.193299e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.6240 head_norm=1.647183 delta_norm=0.119330
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.113 → S16@127.0.0.1:50316
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9550 head_norm=1.165461
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.880321e-02
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9552 head_norm=1.181369 delta_norm=0.058803
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.110 → S8@127.0.0.1:50309
[S17] ⇄ pheromone p=0.077 → S14@127.0.0.1:50314
[S15] ⇄ pheromone p=0.300 → S7@127.0.0.1:50308
[S2] START round=21 head_norm_before_train=1.466530 cos_to_last_merge=0.7855 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.785
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.48833158174498925, 'auprc': 0.6008191497179094, 'loss_val': 1.3443651452392547, 'psi': 0.5333266089341573}-{'f1_val': 0.7040348423333277, 'auprc': 0.7670896373670651, 'loss_val': 0.48989101539351915, 'psi': 0.7292567603468227}
[S3] START round=21 head_norm_before_train=2.071650 (no previous merge yet)
[S3] round=21 local utility u=0.018690 metrics={'f1_val': 0.9710742626949586, 'auprc': 0.9967592720254589, 'loss_val': 0.06996537977574563, 'psi': 0.9813482664271587}-{'f1_val': 0.9656392588443294, 'auprc': 0.9967554850462017, 'loss_val': 0.07472416875132756, 'psi': 0.9780857493250784}
[S4] START round=21 head_norm_before_train=1.181369 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9424651455292082, 'auprc': 0.9436589711254006, 'loss_val': 0.3171396995469675, 'psi': 0.9429426757676852}-{'f1_val': 0.9550299031740676, 'auprc': 0.9608814866854076, 'loss_val': 0.30743437458166945, 'psi': 0.9573705365786036}
[S5] START round=21 head_norm_before_train=1.486451 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.356773 metrics={'f1_val': 0.878082623374444, 'auprc': 0.8915030184226168, 'loss_val': 0.316233730003082, 'psi': 0.8834507813937131}-{'f1_val': 0.7006083926626743, 'auprc': 0.995141095057426, 'loss_val': 0.2758495641186573, 'psi': 0.818421473620575}
[S6] START round=21 head_norm_before_train=1.922100 cos_to_last_merge=0.9985 (last merge round=19)
[S6] round=21 local utility u=0.524911 metrics={'f1_val': 0.8134438659517268, 'auprc': 0.9571541503501644, 'loss_val': 0.41742305211572345, 'psi': 0.8709279797111018}-{'f1_val': 0.6960038260132704, 'auprc': 0.9271527447837714, 'loss_val': 0.6726006112803489, 'psi': 0.7884633935214708}
[S7] START round=21 head_norm_before_train=1.409343 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.384532 metrics={'f1_val': 0.6685956424871666, 'auprc': 0.815582021305711, 'loss_val': 0.4629953591528004, 'psi': 0.7273901940145844}-{'f1_val': 0.5840532220362202, 'auprc': 0.7967277285048222, 'loss_val': 0.6682415554520035, 'psi': 0.669123024623661}
[S8] START round=21 head_norm_before_train=1.198794 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.010480 metrics={'f1_val': 0.9948349509112366, 'auprc': 0.9992091949540665, 'loss_val': 0.13244008737404628, 'psi': 0.9965846485283686}-{'f1_val': 0.9919623662602236, 'auprc': 0.9984274420455178, 'loss_val': 0.13381926535260025, 'psi': 0.9945483965743414}
[S9] START round=21 head_norm_before_train=2.030232 (no previous merge yet)
[S9] round=21 local utility u=0.005601 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988125439459556, 'loss_val': 0.022487372566045948, 'psi': 0.997786765085668}-{'f1_val': 0.9971029125121428, 'auprc': 0.9955491700712952, 'loss_val': 0.02389828709258075, 'psi': 0.9964814155358037}
[S10] START round=21 head_norm_before_train=1.759085 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.008026 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9967854758193231, 'loss_val': 0.09522292349777961, 'psi': 0.9959080626659674}-{'f1_val': 0.9951878390193748, 'auprc': 0.9963658263209765, 'loss_val': 0.10920464121684541, 'psi': 0.9956590339400154}
[S11] START round=21 head_norm_before_train=1.761191 (no previous merge yet)
[S11] round=21 local utility u=0.006356 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983132382522564, 'loss_val': 0.06478948293459058, 'psi': 0.9972657776846308}-{'f1_val': 0.996567470639547, 'auprc': 0.9981895992604353, 'loss_val': 0.07713133712982823, 'psi': 0.9972163220879023}
[S13] START round=21 head_norm_before_train=1.647183 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5985872139176764, 'auprc': 0.6846015917142196, 'loss_val': 0.7297407273304907, 'psi': 0.6329929650362938}-{'f1_val': 0.6230269294070041, 'auprc': 0.6701027533025592, 'loss_val': 0.6353476953376801, 'psi': 0.6418572589652262}
[S14] START round=21 head_norm_before_train=1.683247 cos_to_last_merge=0.9987 (last merge round=19)
[S14] round=21 local utility u=0.018932 metrics={'f1_val': 0.9971043643590876, 'auprc': 0.998785749785024, 'loss_val': 0.12008414221316963, 'psi': 0.997776918529462}-{'f1_val': 0.9976511180498535, 'auprc': 0.9991611529165381, 'loss_val': 0.1623541875608304, 'psi': 0.9982551319965274}
[S15] START round=21 head_norm_before_train=1.827366 (no previous merge yet)
[S15] round=21 local utility u=0.771719 metrics={'f1_val': 0.9969902329512002, 'auprc': 0.9991396071527083, 'loss_val': 0.04920246563960419, 'psi': 0.9978499826318035}-{'f1_val': 0.7891988619681567, 'auprc': 0.9582153541486451, 'loss_val': 0.22312019742666936, 'psi': 0.8568054588403521}
[S16] START round=21 head_norm_before_train=1.056178 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.9912945452737276, 'auprc': 0.9940006196494903, 'loss_val': 0.2546027928049295, 'psi': 0.9923769750240328}-{'f1_val': 0.9907120088140093, 'auprc': 0.9946809292617806, 'loss_val': 0.19746060607223273, 'psi': 0.9922995769931178}
[S17] START round=21 head_norm_before_train=1.661182 (no previous merge yet)
[S17] round=21 local utility u=0.689225 metrics={'f1_val': 0.5714823382644079, 'auprc': 0.8324086746508106, 'loss_val': 0.7170355135187265, 'psi': 0.675852872818969}-{'f1_val': 0.38331048909414756, 'auprc': 0.7818061079663359, 'loss_val': 0.8146469572078764, 'psi': 0.5427087366430229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:50303
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:50308
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:50313
[S14] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1796) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.789734)
[S10] loaded HEAD from S11 (vec_in norm=1.789734)
[S10] cosine check vs S11: cos=0.9972
[S10] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.432320)
[S8] loaded HEAD from S7 (vec_in norm=1.432320)
[S8] cosine check vs S7: cos=-0.1023
[S8] DROPPED delta from S7 (cos=-0.1023 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.847812)
[S7] loaded HEAD from S15 (vec_in norm=1.847812)
[S7] cosine check vs S15: cos=0.2205
[S7] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.948257)
[S7] loaded HEAD from S6 (vec_in norm=1.948257)
[S7] cosine check vs S6: cos=0.0420
[S7] BUFFERED delta from S6 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.791395)
[S7] loaded HEAD from S10 (vec_in norm=1.791395)
[S7] cosine check vs S10: cos=0.9720
[S7] BUFFERED delta from S10 (total buffered=3)
[S3] RECEIVED delta(kind=head bytes=1797) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.048593)
[S3] loaded HEAD from S9 (vec_in norm=2.048593)
[S3] cosine check vs S9: cos=-0.1318
[S3] DROPPED delta from S9 (cos=-0.1318 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.092261)
[S6] loaded HEAD from S3 (vec_in norm=2.092261)
[S6] cosine check vs S3: cos=0.9817
[S6] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.236559)
[S16] loaded HEAD from S8 (vec_in norm=1.236559)
[S16] cosine check vs S8: cos=0.9238
[S16] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1802) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.726922)
[S13] loaded HEAD from S14 (vec_in norm=1.726922)
[S13] cosine check vs S14: cos=0.9940
[S13] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.523675)
[S3] loaded HEAD from S5 (vec_in norm=1.523675)
[S3] cosine check vs S5: cos=-0.0311
[S3] DROPPED delta from S5 (cos=-0.0311 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.693986)
[S14] loaded HEAD from S17 (vec_in norm=1.693986)
[S14] cosine check vs S17: cos=0.9845
[S14] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.5986 head_norm=1.672004
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.695481e-02
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.5984 head_norm=1.696917 delta_norm=0.096955
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.8134 head_norm=1.948257
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.058770e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.8222 head_norm=2.011031 delta_norm=0.205877
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.9953 head_norm=1.791395
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.647369e-02
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.9953 head_norm=1.789330 delta_norm=0.066474
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9971 head_norm=1.726922
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.514291e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9971 head_norm=1.703817 delta_norm=0.151429
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.6686 head_norm=1.432320
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.280896e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.6549 head_norm=1.158215 delta_norm=0.528090
[S7] aggregate: ROLLBACK (f1_val pre=0.669 post=0.655 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.9913 head_norm=1.101705
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.376270e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.9914 head_norm=1.146713 delta_norm=0.237627
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.478007 cos_to_last_merge=0.7838 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=22 local utility u=1.000000 metrics={'f1_val': 0.7016788878311805, 'auprc': 0.7482002723736572, 'loss_val': 0.3386294573466705, 'psi': 0.7202874416481712}-{'f1_val': 0.48833158174498925, 'auprc': 0.6008191497179094, 'loss_val': 1.3443651452392547, 'psi': 0.5333266089341573}
[S3] START round=22 head_norm_before_train=2.092261 (no previous merge yet)
[S3] round=22 local utility u=0.093847 metrics={'f1_val': 0.995622419706457, 'auprc': 0.9967331493210817, 'loss_val': 0.02948288880864806, 'psi': 0.996066711552307}-{'f1_val': 0.9710742626949586, 'auprc': 0.9967592720254589, 'loss_val': 0.06996537977574563, 'psi': 0.9813482664271587}
[S4] START round=22 head_norm_before_train=1.212415 cos_to_last_merge=0.9996 (last merge round=20)
[S4] round=22 local utility u=0.051615 metrics={'f1_val': 0.9477233459135956, 'auprc': 0.9592330334994889, 'loss_val': 0.29218012884107786, 'psi': 0.952327220947953}-{'f1_val': 0.9424651455292082, 'auprc': 0.9436589711254006, 'loss_val': 0.3171396995469675, 'psi': 0.9429426757676852}
[S5] START round=22 head_norm_before_train=1.523675 cos_to_last_merge=0.9991 (last merge round=20)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7143068537716434, 'auprc': 0.794150161496172, 'loss_val': 0.6203339955022968, 'psi': 0.7462441768614549}-{'f1_val': 0.878082623374444, 'auprc': 0.8915030184226168, 'loss_val': 0.316233730003082, 'psi': 0.8834507813937131}
[S6] START round=22 head_norm_before_train=2.011031 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.801664783660275, 'auprc': 0.9439808794092892, 'loss_val': 0.4834910466868003, 'psi': 0.8585912219598807}-{'f1_val': 0.8134438659517268, 'auprc': 0.9571541503501644, 'loss_val': 0.41742305211572345, 'psi': 0.8709279797111018}
[S7] START round=22 head_norm_before_train=1.158215 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.427844 metrics={'f1_val': 0.6997887433966556, 'auprc': 0.9877237425047782, 'loss_val': 0.3108909416150179, 'psi': 0.8149627430399047}-{'f1_val': 0.6685956424871666, 'auprc': 0.815582021305711, 'loss_val': 0.4629953591528004, 'psi': 0.7273901940145844}
[S8] START round=22 head_norm_before_train=1.236559 cos_to_last_merge=0.9995 (last merge round=20)
[S8] round=22 local utility u=0.000732 metrics={'f1_val': 0.9923257155964728, 'auprc': 0.99922802808691, 'loss_val': 0.11597644334445431, 'psi': 0.9950866405926476}-{'f1_val': 0.9948349509112366, 'auprc': 0.9992091949540665, 'loss_val': 0.13244008737404628, 'psi': 0.9965846485283686}
[S9] START round=22 head_norm_before_train=2.048593 (no previous merge yet)
[S9] round=22 local utility u=0.000604 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988024874169694, 'loss_val': 0.021249061787700196, 'psi': 0.9977827424740735}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988125439459556, 'loss_val': 0.022487372566045948, 'psi': 0.997786765085668}
[S10] START round=22 head_norm_before_train=1.789330 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.000478 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.997256712997614, 'loss_val': 0.08514948277480464, 'psi': 0.9950434790182022}-{'f1_val': 0.9953231205637304, 'auprc': 0.9967854758193231, 'loss_val': 0.09522292349777961, 'psi': 0.9959080626659674}
[S11] START round=22 head_norm_before_train=1.789734 (no previous merge yet)
[S11] round=22 local utility u=0.004308 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9983166773763288, 'loss_val': 0.05473262174920135, 'psi': 0.9971220507635993}-{'f1_val': 0.996567470639547, 'auprc': 0.9983132382522564, 'loss_val': 0.06478948293459058, 'psi': 0.9972657776846308}
[S13] START round=22 head_norm_before_train=1.696917 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.090144 metrics={'f1_val': 0.6298807084511842, 'auprc': 0.6558530409200058, 'loss_val': 0.650967218816553, 'psi': 0.6402696414387128}-{'f1_val': 0.5985872139176764, 'auprc': 0.6846015917142196, 'loss_val': 0.7297407273304907, 'psi': 0.6329929650362938}
[S14] START round=22 head_norm_before_train=1.703817 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9968189060544872, 'auprc': 0.9991121381191047, 'loss_val': 0.1265241895435368, 'psi': 0.9977361988803343}-{'f1_val': 0.9971043643590876, 'auprc': 0.998785749785024, 'loss_val': 0.12008414221316963, 'psi': 0.997776918529462}
[S15] START round=22 head_norm_before_train=1.847812 (no previous merge yet)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7576463282343734, 'auprc': 0.9133152099174804, 'loss_val': 0.33811957564190886, 'psi': 0.8199138809076162}-{'f1_val': 0.9969902329512002, 'auprc': 0.9991396071527083, 'loss_val': 0.04920246563960419, 'psi': 0.9978499826318035}
[S16] START round=22 head_norm_before_train=1.146713 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.041427 metrics={'f1_val': 0.9904268448090024, 'auprc': 0.9950533775451623, 'loss_val': 0.16970019212024268, 'psi': 0.9922774579034663}-{'f1_val': 0.9912945452737276, 'auprc': 0.9940006196494903, 'loss_val': 0.2546027928049295, 'psi': 0.9923769750240328}
[S17] START round=22 head_norm_before_train=1.693986 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.43023591045613646, 'auprc': 0.734919075653253, 'loss_val': 0.8213883433708109, 'psi': 0.552109176534983}-{'f1_val': 0.5714823382644079, 'auprc': 0.8324086746508106, 'loss_val': 0.7170355135187265, 'psi': 0.675852872818969}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:50309
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:50311
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:50307
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.240974)
[S8] loaded HEAD from S4 (vec_in norm=1.240974)
[S8] cosine check vs S4: cos=0.9904
[S8] BUFFERED delta from S4 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.173482)
[S8] loaded HEAD from S7 (vec_in norm=1.173482)
[S8] cosine check vs S7: cos=-0.0909
[S8] DROPPED delta from S7 (cos=-0.0909 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.820754)
[S7] loaded HEAD from S10 (vec_in norm=1.820754)
[S7] cosine check vs S10: cos=0.8485
[S7] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.110737)
[S6] loaded HEAD from S3 (vec_in norm=2.110737)
[S6] cosine check vs S3: cos=0.9905
[S6] BUFFERED delta from S3 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1801) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.820130)
[S10] loaded HEAD from S11 (vec_in norm=1.820130)
[S10] cosine check vs S11: cos=0.9975
[S10] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.280149)
[S16] loaded HEAD from S8 (vec_in norm=1.280149)
[S16] cosine check vs S8: cos=0.9798
[S16] BUFFERED delta from S8 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.196061)
[S4] loaded HEAD from S16 (vec_in norm=1.196061)
[S4] cosine check vs S16: cos=0.9888
[S4] BUFFERED delta from S16 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1795) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.066679)
[S3] loaded HEAD from S9 (vec_in norm=2.066679)
[S3] cosine check vs S9: cos=-0.1308
[S3] DROPPED delta from S9 (cos=-0.1308 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.721874)
[S16] loaded HEAD from S13 (vec_in norm=1.721874)
[S16] cosine check vs S13: cos=0.3107
[S16] BUFFERED delta from S13 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.488084)
[S5] loaded HEAD from S2 (vec_in norm=1.488084)
[S5] cosine check vs S2: cos=0.9859
[S5] BUFFERED delta from S2 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.8017 head_norm=2.035649
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.474565e-01
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.7918 head_norm=2.068283 delta_norm=0.147456
[S6] aggregate: ROLLBACK (f1_val pre=0.802 post=0.792 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7143 head_norm=1.555080
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.319558e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7143 head_norm=1.516219 delta_norm=0.131956
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.9904 head_norm=1.196061
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.861018e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.9894 head_norm=1.104131 delta_norm=0.386102
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9936 head_norm=1.820754
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.494899e-02
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9935 head_norm=1.819283 delta_norm=0.064949
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.6998 head_norm=1.173482
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.162801e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.6996 head_norm=1.442067 delta_norm=0.516280
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9477 head_norm=1.240974
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.371056e-02
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9475 head_norm=1.215116 delta_norm=0.093711
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9923 head_norm=1.280149
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.965429e-02
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9923 head_norm=1.257522 delta_norm=0.089654
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.488084 cos_to_last_merge=0.7827 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.783
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.6202231598736206, 'auprc': 0.6715014740758832, 'loss_val': 0.4057963150700721, 'psi': 0.6407344855545257}-{'f1_val': 0.7016788878311805, 'auprc': 0.7482002723736572, 'loss_val': 0.3386294573466705, 'psi': 0.7202874416481712}
[S3] START round=23 head_norm_before_train=2.110737 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9948698793475903, 'auprc': 0.9965438204843511, 'loss_val': 0.025263847648935987, 'psi': 0.9955394558022945}-{'f1_val': 0.995622419706457, 'auprc': 0.9967331493210817, 'loss_val': 0.02948288880864806, 'psi': 0.996066711552307}
[S4] START round=23 head_norm_before_train=1.215116 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.043280 metrics={'f1_val': 0.9546073784811724, 'auprc': 0.9695605893256406, 'loss_val': 0.27790632138700766, 'psi': 0.9605886628189597}-{'f1_val': 0.9477233459135956, 'auprc': 0.9592330334994889, 'loss_val': 0.29218012884107786, 'psi': 0.952327220947953}
[S5] START round=23 head_norm_before_train=1.516219 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.041457 metrics={'f1_val': 0.7143720012038259, 'auprc': 0.7946612745933789, 'loss_val': 0.5393442853925741, 'psi': 0.7464877105596471}-{'f1_val': 0.7143068537716434, 'auprc': 0.794150161496172, 'loss_val': 0.6203339955022968, 'psi': 0.7462441768614549}
[S6] START round=23 head_norm_before_train=2.068283 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.6230023450728747, 'auprc': 0.9459193986564092, 'loss_val': 0.7721276080406362, 'psi': 0.7521691665062884}-{'f1_val': 0.801664783660275, 'auprc': 0.9439808794092892, 'loss_val': 0.4834910466868003, 'psi': 0.8585912219598807}
[S7] START round=23 head_norm_before_train=1.442067 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.6528694542026686, 'auprc': 0.8177360684438577, 'loss_val': 0.4703979903182549, 'psi': 0.7188160998991443}-{'f1_val': 0.6997887433966556, 'auprc': 0.9877237425047782, 'loss_val': 0.3108909416150179, 'psi': 0.8149627430399047}
[S8] START round=23 head_norm_before_train=1.257522 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.010606 metrics={'f1_val': 0.993919739519144, 'auprc': 0.9993389934145651, 'loss_val': 0.1046611934318584, 'psi': 0.9960874410773125}-{'f1_val': 0.9923257155964728, 'auprc': 0.99922802808691, 'loss_val': 0.11597644334445431, 'psi': 0.9950866405926476}
[S9] START round=23 head_norm_before_train=2.066679 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9980359194076954, 'loss_val': 0.021279259625939437, 'psi': 0.9974761152703638}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988024874169694, 'loss_val': 0.021249061787700196, 'psi': 0.9977827424740735}
[S10] START round=23 head_norm_before_train=1.819283 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.004422 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9972853107727233, 'loss_val': 0.07639159019559506, 'psi': 0.995054918128246}-{'f1_val': 0.9935679896985945, 'auprc': 0.997256712997614, 'loss_val': 0.08514948277480464, 'psi': 0.9950434790182022}
[S11] START round=23 head_norm_before_train=1.820130 (no previous merge yet)
[S11] round=23 local utility u=0.004131 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982492937858497, 'loss_val': 0.047719551837343624, 'psi': 0.9972401998980681}-{'f1_val': 0.9963256330217796, 'auprc': 0.9983166773763288, 'loss_val': 0.05473262174920135, 'psi': 0.9971220507635993}
[S13] START round=23 head_norm_before_train=1.721874 cos_to_last_merge=0.9992 (last merge round=21)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6158209102782297, 'auprc': 0.6763188627315497, 'loss_val': 0.6505470896137641, 'psi': 0.6400200912595577}-{'f1_val': 0.6298807084511842, 'auprc': 0.6558530409200058, 'loss_val': 0.650967218816553, 'psi': 0.6402696414387128}
[S14] START round=23 head_norm_before_train=1.738002 cos_to_last_merge=0.9994 (last merge round=21)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9376141154829056, 'auprc': 0.9991037871365904, 'loss_val': 0.13682900186694166, 'psi': 0.9622099841443795}-{'f1_val': 0.9968189060544872, 'auprc': 0.9991121381191047, 'loss_val': 0.1265241895435368, 'psi': 0.9977361988803343}
[S15] START round=23 head_norm_before_train=1.866303 (no previous merge yet)
[S15] round=23 local utility u=0.648892 metrics={'f1_val': 0.9016073756837252, 'auprc': 0.995617373930578, 'loss_val': 0.15100756735412418, 'psi': 0.9392113749824662}-{'f1_val': 0.7576463282343734, 'auprc': 0.9133152099174804, 'loss_val': 0.33811957564190886, 'psi': 0.8199138809076162}
[S16] START round=23 head_norm_before_train=1.104131 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.867107256023358, 'auprc': 0.9951024785145635, 'loss_val': 0.48844725891033847, 'psi': 0.9183053450198402}-{'f1_val': 0.9904268448090024, 'auprc': 0.9950533775451623, 'loss_val': 0.16970019212024268, 'psi': 0.9922774579034663}
[S17] START round=23 head_norm_before_train=1.727306 (no previous merge yet)
[S17] round=23 local utility u=0.095643 metrics={'f1_val': 0.4986080369171524, 'auprc': 0.6989278923617471, 'loss_val': 0.932362260124839, 'psi': 0.5787359790949903}-{'f1_val': 0.43023591045613646, 'auprc': 0.734919075653253, 'loss_val': 0.8213883433708109, 'psi': 0.552109176534983}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:50303
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:50316
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.849424)
[S7] loaded HEAD from S10 (vec_in norm=1.849424)
[S7] cosine check vs S10: cos=0.9753
[S7] BUFFERED delta from S10 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.533069)
[S3] loaded HEAD from S5 (vec_in norm=1.533069)
[S3] cosine check vs S5: cos=-0.0350
[S3] DROPPED delta from S5 (cos=-0.0350 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.243890)
[S8] loaded HEAD from S4 (vec_in norm=1.243890)
[S8] cosine check vs S4: cos=0.9932
[S8] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.881516)
[S7] loaded HEAD from S15 (vec_in norm=1.881516)
[S7] cosine check vs S15: cos=0.1917
[S7] BUFFERED delta from S15 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1802) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.297201)
[S16] loaded HEAD from S8 (vec_in norm=1.297201)
[S16] cosine check vs S8: cos=0.8933
[S16] BUFFERED delta from S8 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1796) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.849522)
[S10] loaded HEAD from S11 (vec_in norm=1.849522)
[S10] cosine check vs S11: cos=0.9977
[S10] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.760044)
[S14] loaded HEAD from S17 (vec_in norm=1.760044)
[S14] cosine check vs S17: cos=0.9869
[S14] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.6529 head_norm=1.456887
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.286567e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.6563 head_norm=1.326798 delta_norm=0.428657
[S7] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9939 head_norm=1.297201
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.850814e-02
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9939 head_norm=1.268398 delta_norm=0.078508
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9936 head_norm=1.849424
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.267417e-02
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9936 head_norm=1.848411 delta_norm=0.062674
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9376 head_norm=1.771118
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.431487e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9356 head_norm=1.759777 delta_norm=0.143149
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.8671 head_norm=1.149470
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.915403e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.8686 head_norm=1.190382 delta_norm=0.291540
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.499806 cos_to_last_merge=0.7813 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.781
[S2] round=24 local utility u=0.389986 metrics={'f1_val': 0.7108765371778574, 'auprc': 0.767167607465487, 'loss_val': 0.45674321335573415, 'psi': 0.7333929652929092}-{'f1_val': 0.6202231598736206, 'auprc': 0.6715014740758832, 'loss_val': 0.4057963150700721, 'psi': 0.6407344855545257}
[S3] START round=24 head_norm_before_train=2.129832 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9940935351656541, 'auprc': 0.9964363350790273, 'loss_val': 0.0393137393554581, 'psi': 0.9950306551310034}-{'f1_val': 0.9948698793475903, 'auprc': 0.9965438204843511, 'loss_val': 0.025263847648935987, 'psi': 0.9955394558022945}
[S4] START round=24 head_norm_before_train=1.243890 cos_to_last_merge=0.9997 (last merge round=22)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9395800200584856, 'auprc': 0.9454332009808993, 'loss_val': 0.30094882686793206, 'psi': 0.9419212924274512}-{'f1_val': 0.9546073784811724, 'auprc': 0.9695605893256406, 'loss_val': 0.27790632138700766, 'psi': 0.9605886628189597}
[S5] START round=24 head_norm_before_train=1.533069 cos_to_last_merge=0.9998 (last merge round=22)
[S5] round=24 local utility u=1.000000 metrics={'f1_val': 0.9963332086366786, 'auprc': 0.997174718744355, 'loss_val': 0.19151227400659032, 'psi': 0.9966698126797493}-{'f1_val': 0.7143720012038259, 'auprc': 0.7946612745933789, 'loss_val': 0.5393442853925741, 'psi': 0.7464877105596471}
[S6] START round=24 head_norm_before_train=2.093917 cos_to_last_merge=0.9989 (last merge round=22)
[S6] round=24 local utility u=1.000000 metrics={'f1_val': 0.9055229867220729, 'auprc': 0.9696997090975575, 'loss_val': 0.3175845758308767, 'psi': 0.9311936756722667}-{'f1_val': 0.6230023450728747, 'auprc': 0.9459193986564092, 'loss_val': 0.7721276080406362, 'psi': 0.7521691665062884}
[S7] START round=24 head_norm_before_train=1.326798 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.6543578444510991, 'auprc': 0.8123838269090768, 'loss_val': 0.4699070703659695, 'psi': 0.7175682374342902}-{'f1_val': 0.6528694542026686, 'auprc': 0.8177360684438577, 'loss_val': 0.4703979903182549, 'psi': 0.7188160998991443}
[S8] START round=24 head_norm_before_train=1.268398 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9929679663698754, 'auprc': 0.9869184640496237, 'loss_val': 0.10234033286132378, 'psi': 0.9905481654417747}-{'f1_val': 0.993919739519144, 'auprc': 0.9993389934145651, 'loss_val': 0.1046611934318584, 'psi': 0.9960874410773125}
[S9] START round=24 head_norm_before_train=2.083985 (no previous merge yet)
[S9] round=24 local utility u=0.001397 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988189935661484, 'loss_val': 0.020834234411133093, 'psi': 0.997789344933745}-{'f1_val': 0.9971029125121428, 'auprc': 0.9980359194076954, 'loss_val': 0.021279259625939437, 'psi': 0.9974761152703638}
[S10] START round=24 head_norm_before_train=1.848411 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.008464 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9970453255514722, 'loss_val': 0.06927367825568163, 'psi': 0.996012002558827}-{'f1_val': 0.9935679896985945, 'auprc': 0.9972853107727233, 'loss_val': 0.07639159019559506, 'psi': 0.995054918128246}
[S11] START round=24 head_norm_before_train=1.849522 (no previous merge yet)
[S11] round=24 local utility u=0.002757 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9983055016736674, 'loss_val': 0.04092296610655059, 'psi': 0.9971175804825347}-{'f1_val': 0.996567470639547, 'auprc': 0.9982492937858497, 'loss_val': 0.047719551837343624, 'psi': 0.9972401998980681}
[S13] START round=24 head_norm_before_train=1.752186 cos_to_last_merge=0.9969 (last merge round=21)
[S13] round=24 local utility u=0.004937 metrics={'f1_val': 0.6167723088296188, 'auprc': 0.6809972551707696, 'loss_val': 0.6604170000022986, 'psi': 0.642462287366079}-{'f1_val': 0.6158209102782297, 'auprc': 0.6763188627315497, 'loss_val': 0.6505470896137641, 'psi': 0.6400200912595577}
[S14] START round=24 head_norm_before_train=1.759777 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.197016 metrics={'f1_val': 0.9970407855713329, 'auprc': 0.9992150962658183, 'loss_val': 0.09969080327229218, 'psi': 0.9979105098491271}-{'f1_val': 0.9376141154829056, 'auprc': 0.9991037871365904, 'loss_val': 0.13682900186694166, 'psi': 0.9622099841443795}
[S15] START round=24 head_norm_before_train=1.881516 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.792974902440046, 'auprc': 0.9899102539846314, 'loss_val': 0.2547599304761915, 'psi': 0.8717490430578801}-{'f1_val': 0.9016073756837252, 'auprc': 0.995617373930578, 'loss_val': 0.15100756735412418, 'psi': 0.9392113749824662}
[S16] START round=24 head_norm_before_train=1.190382 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.542535 metrics={'f1_val': 0.9897717360559292, 'auprc': 0.9953023983236111, 'loss_val': 0.1399634923826553, 'psi': 0.991984000963002}-{'f1_val': 0.867107256023358, 'auprc': 0.9951024785145635, 'loss_val': 0.48844725891033847, 'psi': 0.9183053450198402}
[S17] START round=24 head_norm_before_train=1.760044 (no previous merge yet)
[S17] round=24 local utility u=0.321463 metrics={'f1_val': 0.5730630751678665, 'auprc': 0.7491319416974801, 'loss_val': 0.8867788367512106, 'psi': 0.6434906217797118}-{'f1_val': 0.4986080369171524, 'auprc': 0.6989278923617471, 'loss_val': 0.932362260124839, 'psi': 0.5787359790949903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.549437)
[S3] loaded HEAD from S5 (vec_in norm=1.549437)
[S3] cosine check vs S5: cos=-0.0355
[S3] DROPPED delta from S5 (cos=-0.0355 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=2.115861)
[S7] loaded HEAD from S6 (vec_in norm=2.115861)
[S7] cosine check vs S6: cos=0.0661
[S7] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.876624)
[S7] loaded HEAD from S10 (vec_in norm=1.876624)
[S7] cosine check vs S10: cos=0.8882
[S7] BUFFERED delta from S10 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:50311
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.874104)
[S10] loaded HEAD from S11 (vec_in norm=1.874104)
[S10] cosine check vs S11: cos=0.9981
[S10] BUFFERED delta from S11 (total buffered=1)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:50313
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.778971)
[S16] loaded HEAD from S13 (vec_in norm=1.778971)
[S16] cosine check vs S13: cos=0.3780
[S16] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1792) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.791291)
[S13] loaded HEAD from S14 (vec_in norm=1.791291)
[S13] cosine check vs S14: cos=0.9831
[S13] BUFFERED delta from S14 (total buffered=1)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:50305
[S16] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.240021)
[S4] loaded HEAD from S16 (vec_in norm=1.240021)
[S4] cosine check vs S16: cos=0.9898
[S4] BUFFERED delta from S16 (total buffered=1)
[S2] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.508946)
[S5] loaded HEAD from S2 (vec_in norm=1.508946)
[S5] cosine check vs S2: cos=0.9923
[S5] BUFFERED delta from S2 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:50303
[S9] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.091745)
[S3] loaded HEAD from S9 (vec_in norm=2.091745)
[S3] cosine check vs S9: cos=-0.1295
[S3] DROPPED delta from S9 (cos=-0.1295 < 0.0)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.786994)
[S14] loaded HEAD from S17 (vec_in norm=1.786994)
[S14] cosine check vs S17: cos=0.9935
[S14] BUFFERED delta from S17 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9396 head_norm=1.268140
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.056213e-02
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9396 head_norm=1.250885 delta_norm=0.090562
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.9963 head_norm=1.549437
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.713433e-02
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.9962 head_norm=1.526238 delta_norm=0.097134
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=24 metric=0.9953 head_norm=1.876624
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.825084e-02
[S10] stored merged vector for next round verification (round=24)
[S10] DEBUG after merge:  round=24 metric=0.9953 head_norm=1.874459 delta_norm=0.058251
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.9898 head_norm=1.240021
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.709947e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.9874 head_norm=1.261968 delta_norm=0.870995
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.6168 head_norm=1.778971
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.643228e-01
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.6144 head_norm=1.777563 delta_norm=0.164323
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9970 head_norm=1.791291
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.016539e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9970 head_norm=1.786253 delta_norm=0.101654
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.6544 head_norm=1.341494
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.757054e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.6307 head_norm=1.242293 delta_norm=0.575705
[S7] aggregate: ROLLBACK (f1_val pre=0.654 post=0.631 tol_abs=0.005 tol_rel=0.0)
[S2] START round=25 head_norm_before_train=1.508946 cos_to_last_merge=0.7805 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.780
[S2] round=25 local utility u=0.155333 metrics={'f1_val': 0.7083028839006116, 'auprc': 0.855123430401398, 'loss_val': 0.39450247254522286, 'psi': 0.7670311025009262}-{'f1_val': 0.7108765371778574, 'auprc': 0.767167607465487, 'loss_val': 0.45674321335573415, 'psi': 0.7333929652929092}
[S3] START round=25 head_norm_before_train=2.143588 (no previous merge yet)
[S3] round=25 local utility u=0.011150 metrics={'f1_val': 0.9970158049264538, 'auprc': 0.9966515592725854, 'loss_val': 0.03519361537778818, 'psi': 0.9968701066649065}-{'f1_val': 0.9940935351656541, 'auprc': 0.9964363350790273, 'loss_val': 0.0393137393554581, 'psi': 0.9950306551310034}
[S4] START round=25 head_norm_before_train=1.250885 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.092990 metrics={'f1_val': 0.9541887221310338, 'auprc': 0.9685763183151604, 'loss_val': 0.2720499986366402, 'psi': 0.9599437606046844}-{'f1_val': 0.9395800200584856, 'auprc': 0.9454332009808993, 'loss_val': 0.30094882686793206, 'psi': 0.9419212924274512}
[S5] START round=25 head_norm_before_train=1.526238 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7015204954603708, 'auprc': 0.9975798522962123, 'loss_val': 0.2290566572404326, 'psi': 0.8199442381947073}-{'f1_val': 0.9963332086366786, 'auprc': 0.997174718744355, 'loss_val': 0.19151227400659032, 'psi': 0.9966698126797493}
[S6] START round=25 head_norm_before_train=2.115861 cos_to_last_merge=0.9970 (last merge round=22)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.41588308903900795, 'auprc': 0.9143564645934066, 'loss_val': 0.9702456105350166, 'psi': 0.6152724392607674}-{'f1_val': 0.9055229867220729, 'auprc': 0.9696997090975575, 'loss_val': 0.3175845758308767, 'psi': 0.9311936756722667}
[S7] START round=25 head_norm_before_train=1.242293 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.6658751212032741, 'auprc': 0.8019498108097614, 'loss_val': 0.543705028528998, 'psi': 0.720304997045869}-{'f1_val': 0.6543578444510991, 'auprc': 0.8123838269090768, 'loss_val': 0.4699070703659695, 'psi': 0.7175682374342902}
[S8] START round=25 head_norm_before_train=1.309100 cos_to_last_merge=0.9995 (last merge round=23)
[S8] round=25 local utility u=0.005899 metrics={'f1_val': 0.9885804511658192, 'auprc': 0.9994167113309208, 'loss_val': 0.10171263475396942, 'psi': 0.9929149552318599}-{'f1_val': 0.9929679663698754, 'auprc': 0.9869184640496237, 'loss_val': 0.10234033286132378, 'psi': 0.9905481654417747}
[S9] START round=25 head_norm_before_train=2.091745 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9972721046582873, 'loss_val': 0.02099553403054563, 'psi': 0.9971705893706007}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988189935661484, 'loss_val': 0.020834234411133093, 'psi': 0.997789344933745}
[S10] START round=25 head_norm_before_train=1.874459 cos_to_last_merge=1.0000 (last merge round=24)
[S10] round=25 local utility u=0.003351 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9969582727998643, 'loss_val': 0.06484533235774176, 'psi': 0.996230645566992}-{'f1_val': 0.9953231205637304, 'auprc': 0.9970453255514722, 'loss_val': 0.06927367825568163, 'psi': 0.996012002558827}
[S11] START round=25 head_norm_before_train=1.874104 (no previous merge yet)
[S11] round=25 local utility u=0.002423 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983691495662341, 'loss_val': 0.0377181692822276, 'psi': 0.9972881422102219}-{'f1_val': 0.9963256330217796, 'auprc': 0.9983055016736674, 'loss_val': 0.04092296610655059, 'psi': 0.9971175804825347}
[S13] START round=25 head_norm_before_train=1.777563 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.010865 metrics={'f1_val': 0.6188323059084685, 'auprc': 0.6782107626993298, 'loss_val': 0.642688328892933, 'psi': 0.6425836886248131}-{'f1_val': 0.6167723088296188, 'auprc': 0.6809972551707696, 'loss_val': 0.6604170000022986, 'psi': 0.642462287366079}
[S14] START round=25 head_norm_before_train=1.786253 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.004107 metrics={'f1_val': 0.9979369915016262, 'auprc': 0.9990634146446102, 'loss_val': 0.09639813094992367, 'psi': 0.9983875607588198}-{'f1_val': 0.9970407855713329, 'auprc': 0.9992150962658183, 'loss_val': 0.09969080327229218, 'psi': 0.9979105098491271}
[S15] START round=25 head_norm_before_train=1.897949 (no previous merge yet)
[S15] round=25 local utility u=0.409338 metrics={'f1_val': 0.9036621314007296, 'auprc': 0.9971124551844506, 'loss_val': 0.12181413132935698, 'psi': 0.941042260914218}-{'f1_val': 0.792974902440046, 'auprc': 0.9899102539846314, 'loss_val': 0.2547599304761915, 'psi': 0.8717490430578801}
[S16] START round=25 head_norm_before_train=1.261968 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.8475487285207005, 'auprc': 0.9897123328399656, 'loss_val': 0.6185860552968283, 'psi': 0.9044141702484065}-{'f1_val': 0.9897717360559292, 'auprc': 0.9953023983236111, 'loss_val': 0.1399634923826553, 'psi': 0.991984000963002}
[S17] START round=25 head_norm_before_train=1.786994 (no previous merge yet)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.5723369013908964, 'auprc': 0.7303810437244314, 'loss_val': 0.9736023534056631, 'psi': 0.6355545583243104}-{'f1_val': 0.5730630751678665, 'auprc': 0.7491319416974801, 'loss_val': 0.8867788367512106, 'psi': 0.6434906217797118}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:50307
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.275229)
[S8] loaded HEAD from S4 (vec_in norm=1.275229)
[S8] cosine check vs S4: cos=0.9908
[S8] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.349188)
[S16] loaded HEAD from S8 (vec_in norm=1.349188)
[S16] cosine check vs S8: cos=0.6582
[S16] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.160139)
[S6] loaded HEAD from S3 (vec_in norm=2.160139)
[S6] cosine check vs S3: cos=0.9864
[S6] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.519701)
[S5] loaded HEAD from S2 (vec_in norm=1.519701)
[S5] cosine check vs S2: cos=0.9962
[S5] BUFFERED delta from S2 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:50316
[S13] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.793122)
[S16] loaded HEAD from S13 (vec_in norm=1.793122)
[S16] cosine check vs S13: cos=0.8583
[S16] BUFFERED delta from S13 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:50313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:50311
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.815743)
[S13] loaded HEAD from S14 (vec_in norm=1.815743)
[S13] cosine check vs S14: cos=0.9916
[S13] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.914749)
[S7] loaded HEAD from S15 (vec_in norm=1.914749)
[S7] cosine check vs S15: cos=0.2892
[S7] BUFFERED delta from S15 (total buffered=1)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.892445)
[S10] loaded HEAD from S11 (vec_in norm=1.892445)
[S10] cosine check vs S11: cos=0.9984
[S10] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.901092)
[S7] loaded HEAD from S10 (vec_in norm=1.901092)
[S7] cosine check vs S10: cos=0.8490
[S7] BUFFERED delta from S10 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.256 → S5@127.0.0.1:50305
[S3] ⇄ pheromone p=0.046 → S6@127.0.0.1:50307
[S4] ⇄ pheromone p=0.066 → S8@127.0.0.1:50309
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.7015 head_norm=1.543955
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.764668e-02
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.9290 head_norm=1.530382 delta_norm=0.067647
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.237 → S3@127.0.0.1:50303
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9886 head_norm=1.349188
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.613867e-02
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9886 head_norm=1.309204 delta_norm=0.096139
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.052 → S16@127.0.0.1:50316
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.4159 head_norm=2.135730
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.775371e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.6061 head_norm=2.140620 delta_norm=0.177537
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.278 → S7@127.0.0.1:50308
[S11] ⇄ pheromone p=0.035 → S10@127.0.0.1:50311
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9957 head_norm=1.901092
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.352566e-02
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9957 head_norm=1.896018 delta_norm=0.053526
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.040 → S7@127.0.0.1:50308
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.6188 head_norm=1.793122
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.171883e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.6174 head_norm=1.800659 delta_norm=0.117188
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.049 → S16@127.0.0.1:50316
[S14] ⇄ pheromone p=0.071 → S13@127.0.0.1:50313
[S9] ⇄ pheromone p=0.017 → S3@127.0.0.1:50303
[S15] ⇄ pheromone p=0.326 → S7@127.0.0.1:50308
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.8475 head_norm=1.301393
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.441150e-02
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.8473 head_norm=1.258914 delta_norm=0.074412
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.204 → S4@127.0.0.1:50304
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.6659 head_norm=1.265036
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.208885e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.6665 head_norm=1.244324 delta_norm=0.420889
[S7] aggregate: ACCEPT kept=['S15', 'S10'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.109 → S8@127.0.0.1:50309
[S17] ⇄ pheromone p=0.145 → S14@127.0.0.1:50314
[S2] START round=26 head_norm_before_train=1.519701 cos_to_last_merge=0.7797 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.780
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.5532317221570059, 'auprc': 0.6223647491941025, 'loss_val': 1.0743288702424383, 'psi': 0.5808849329718445}-{'f1_val': 0.7083028839006116, 'auprc': 0.855123430401398, 'loss_val': 0.39450247254522286, 'psi': 0.7670311025009262}
[S3] START round=26 head_norm_before_train=2.160139 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9969001199741798, 'loss_val': 0.11225778923100138, 'psi': 0.9756593361536234}-{'f1_val': 0.9970158049264538, 'auprc': 0.9966515592725854, 'loss_val': 0.03519361537778818, 'psi': 0.9968701066649065}
[S4] START round=26 head_norm_before_train=1.275229 cos_to_last_merge=0.9998 (last merge round=24)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9500196502282248, 'auprc': 0.9572763081565281, 'loss_val': 0.2791491855518425, 'psi': 0.9529223133995461}-{'f1_val': 0.9541887221310338, 'auprc': 0.9685763183151604, 'loss_val': 0.2720499986366402, 'psi': 0.9599437606046844}
[S5] START round=26 head_norm_before_train=1.530382 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.801612 metrics={'f1_val': 0.9662224389452301, 'auprc': 0.9954803653374318, 'loss_val': 0.20774534629996613, 'psi': 0.9779256095021107}-{'f1_val': 0.7015204954603708, 'auprc': 0.9975798522962123, 'loss_val': 0.2290566572404326, 'psi': 0.8199442381947073}
[S6] START round=26 head_norm_before_train=2.140620 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.8058003436088534, 'auprc': 0.9420311986100056, 'loss_val': 0.4961928653547845, 'psi': 0.8602926856093143}-{'f1_val': 0.41588308903900795, 'auprc': 0.9143564645934066, 'loss_val': 0.9702456105350166, 'psi': 0.6152724392607674}
[S7] START round=26 head_norm_before_train=1.244324 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.6021549241977365, 'auprc': 0.797644074467329, 'loss_val': 0.7392157515444888, 'psi': 0.6803505843055735}-{'f1_val': 0.6658751212032741, 'auprc': 0.8019498108097614, 'loss_val': 0.543705028528998, 'psi': 0.720304997045869}
[S8] START round=26 head_norm_before_train=1.309204 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.004980 metrics={'f1_val': 0.9933751911041674, 'auprc': 0.9882275045218215, 'loss_val': 0.08695317314646873, 'psi': 0.991316116471229}-{'f1_val': 0.9885804511658192, 'auprc': 0.9994167113309208, 'loss_val': 0.10171263475396942, 'psi': 0.9929149552318599}
[S9] START round=26 head_norm_before_train=2.103644 (no previous merge yet)
[S9] round=26 local utility u=0.001574 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.998821423800171, 'loss_val': 0.02001347101057132, 'psi': 0.9975420584987715}-{'f1_val': 0.9971029125121428, 'auprc': 0.9972721046582873, 'loss_val': 0.02099553403054563, 'psi': 0.9971705893706007}
[S10] START round=26 head_norm_before_train=1.896018 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.000069 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.996299932487091, 'loss_val': 0.06019857915884847, 'psi': 0.9957138453330746}-{'f1_val': 0.9957455607450773, 'auprc': 0.9969582727998643, 'loss_val': 0.06484533235774176, 'psi': 0.996230645566992}
[S11] START round=26 head_norm_before_train=1.892445 (no previous merge yet)
[S11] round=26 local utility u=0.001489 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983933526276851, 'loss_val': 0.034812421047371755, 'psi': 0.9972978234348022}-{'f1_val': 0.996567470639547, 'auprc': 0.9983691495662341, 'loss_val': 0.0377181692822276, 'psi': 0.9972881422102219}
[S13] START round=26 head_norm_before_train=1.800659 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5983554996321123, 'auprc': 0.6842418112319086, 'loss_val': 0.7920128826109637, 'psi': 0.6327100242720308}-{'f1_val': 0.6188323059084685, 'auprc': 0.6782107626993298, 'loss_val': 0.642688328892933, 'psi': 0.6425836886248131}
[S14] START round=26 head_norm_before_train=1.815743 cos_to_last_merge=0.9996 (last merge round=24)
[S14] round=26 local utility u=0.003141 metrics={'f1_val': 0.997014101118975, 'auprc': 0.9987061174848564, 'loss_val': 0.083507758309259, 'psi': 0.9976909076653275}-{'f1_val': 0.9979369915016262, 'auprc': 0.9990634146446102, 'loss_val': 0.09639813094992367, 'psi': 0.9983875607588198}
[S15] START round=26 head_norm_before_train=1.914749 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.900365077766655, 'auprc': 0.9966126540267836, 'loss_val': 0.16850281231533468, 'psi': 0.9388641082707064}-{'f1_val': 0.9036621314007296, 'auprc': 0.9971124551844506, 'loss_val': 0.12181413132935698, 'psi': 0.941042260914218}
[S16] START round=26 head_norm_before_train=1.258914 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8124401326773338, 'auprc': 0.9198043207505024, 'loss_val': 0.6676342153542195, 'psi': 0.8553858079066012}-{'f1_val': 0.8475487285207005, 'auprc': 0.9897123328399656, 'loss_val': 0.6185860552968283, 'psi': 0.9044141702484065}
[S17] START round=26 head_norm_before_train=1.816021 (no previous merge yet)
[S17] round=26 local utility u=0.185325 metrics={'f1_val': 0.5909047550941133, 'auprc': 0.7864319911111254, 'loss_val': 0.8825121359723882, 'psi': 0.6691156495009182}-{'f1_val': 0.5723369013908964, 'auprc': 0.7303810437244314, 'loss_val': 0.9736023534056631, 'psi': 0.6355545583243104}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:50313
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:50303
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:50308
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.842078)
[S13] loaded HEAD from S14 (vec_in norm=1.842078)
[S13] cosine check vs S14: cos=0.9972
[S13] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.119413)
[S3] loaded HEAD from S9 (vec_in norm=2.119413)
[S3] cosine check vs S9: cos=-0.1284
[S3] DROPPED delta from S9 (cos=-0.1284 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.909820)
[S10] loaded HEAD from S11 (vec_in norm=1.909820)
[S10] cosine check vs S11: cos=0.9987
[S10] BUFFERED delta from S11 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1805) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.549417)
[S3] loaded HEAD from S5 (vec_in norm=1.549417)
[S3] cosine check vs S5: cos=-0.0405
[S3] DROPPED delta from S5 (cos=-0.0405 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.347160)
[S16] loaded HEAD from S8 (vec_in norm=1.347160)
[S16] cosine check vs S8: cos=0.7364
[S16] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.921036)
[S7] loaded HEAD from S10 (vec_in norm=1.921036)
[S7] cosine check vs S10: cos=0.8199
[S7] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=2.155369)
[S7] loaded HEAD from S6 (vec_in norm=2.155369)
[S7] cosine check vs S6: cos=0.2393
[S7] BUFFERED delta from S6 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.843576)
[S14] loaded HEAD from S17 (vec_in norm=1.843576)
[S14] cosine check vs S17: cos=0.9933
[S14] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.6022 head_norm=1.267131
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.028081e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.5936 head_norm=1.256016 delta_norm=0.502808
[S7] aggregate: ROLLBACK (f1_val pre=0.602 post=0.594 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.5984 head_norm=1.812937
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.948338e-02
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.5984 head_norm=1.826244 delta_norm=0.069483
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9970 head_norm=1.842078
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.066820e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9966 head_norm=1.839736 delta_norm=0.106682
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.9953 head_norm=1.921036
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.879198e-02
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.9953 head_norm=1.914814 delta_norm=0.048792
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.8124 head_norm=1.308139
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.823083e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.8139 head_norm=1.237098 delta_norm=0.482308
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.531115 cos_to_last_merge=0.7789 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.779
[S2] round=27 local utility u=0.697970 metrics={'f1_val': 0.7155654058770231, 'auprc': 0.689116678842758, 'loss_val': 0.8526465548985891, 'psi': 0.7049859150633171}-{'f1_val': 0.5532317221570059, 'auprc': 0.6223647491941025, 'loss_val': 1.0743288702424383, 'psi': 0.5808849329718445}
[S3] START round=27 head_norm_before_train=2.173058 (no previous merge yet)
[S3] round=27 local utility u=0.006611 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.996661604161746, 'loss_val': 0.09855837154731872, 'psi': 0.9755877548377069}-{'f1_val': 0.961498813606586, 'auprc': 0.9969001199741798, 'loss_val': 0.11225778923100138, 'psi': 0.9756593361536234}
[S4] START round=27 head_norm_before_train=1.300945 cos_to_last_merge=0.9993 (last merge round=24)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9472421608173066, 'auprc': 0.9511179592644641, 'loss_val': 0.2788917899328422, 'psi': 0.9487924801961696}-{'f1_val': 0.9500196502282248, 'auprc': 0.9572763081565281, 'loss_val': 0.2791491855518425, 'psi': 0.9529223133995461}
[S5] START round=27 head_norm_before_train=1.549417 cos_to_last_merge=0.9996 (last merge round=25)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.7144377451253945, 'auprc': 0.794085646259298, 'loss_val': 0.5762968330272474, 'psi': 0.7462969055789559}-{'f1_val': 0.9662224389452301, 'auprc': 0.9954803653374318, 'loss_val': 0.20774534629996613, 'psi': 0.9779256095021107}
[S6] START round=27 head_norm_before_train=2.155369 cos_to_last_merge=0.9998 (last merge round=25)
[S6] round=27 local utility u=0.277071 metrics={'f1_val': 0.8673551779970058, 'auprc': 0.9622807545666452, 'loss_val': 0.372128249394654, 'psi': 0.9053254086248614}-{'f1_val': 0.8058003436088534, 'auprc': 0.9420311986100056, 'loss_val': 0.4961928653547845, 'psi': 0.8602926856093143}
[S7] START round=27 head_norm_before_train=1.256016 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.565422218544491, 'auprc': 0.7766155687083467, 'loss_val': 0.8566089512983278, 'psi': 0.6498995586100333}-{'f1_val': 0.6021549241977365, 'auprc': 0.797644074467329, 'loss_val': 0.7392157515444888, 'psi': 0.6803505843055735}
[S8] START round=27 head_norm_before_train=1.347160 cos_to_last_merge=0.9996 (last merge round=25)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9836444136069047, 'auprc': 0.999360049943941, 'loss_val': 0.09741297664262874, 'psi': 0.9899306681417193}-{'f1_val': 0.9933751911041674, 'auprc': 0.9882275045218215, 'loss_val': 0.08695317314646873, 'psi': 0.991316116471229}
[S9] START round=27 head_norm_before_train=2.119413 (no previous merge yet)
[S9] round=27 local utility u=0.001133 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9986827156820708, 'loss_val': 0.01981360466881276, 'psi': 0.997734833780114}-{'f1_val': 0.9966891482978385, 'auprc': 0.998821423800171, 'loss_val': 0.02001347101057132, 'psi': 0.9975420584987715}
[S10] START round=27 head_norm_before_train=1.914814 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9932066944136535, 'loss_val': 0.058135584037914585, 'psi': 0.9944765501036996}-{'f1_val': 0.9953231205637304, 'auprc': 0.996299932487091, 'loss_val': 0.06019857915884847, 'psi': 0.9957138453330746}
[S11] START round=27 head_norm_before_train=1.909820 (no previous merge yet)
[S11] round=27 local utility u=0.000952 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9984376026462065, 'loss_val': 0.03304034620444761, 'psi': 0.9973155234422109}-{'f1_val': 0.996567470639547, 'auprc': 0.9983933526276851, 'loss_val': 0.034812421047371755, 'psi': 0.9972978234348022}
[S13] START round=27 head_norm_before_train=1.826244 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.206533 metrics={'f1_val': 0.6469176311977538, 'auprc': 0.6488434279392246, 'loss_val': 0.5641235890168733, 'psi': 0.6476879498943421}-{'f1_val': 0.5983554996321123, 'auprc': 0.6842418112319086, 'loss_val': 0.7920128826109637, 'psi': 0.6327100242720308}
[S14] START round=27 head_norm_before_train=1.839736 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.996673987435767, 'auprc': 0.9989076633426065, 'loss_val': 0.08224758544039672, 'psi': 0.9975674577985028}-{'f1_val': 0.997014101118975, 'auprc': 0.9987061174848564, 'loss_val': 0.083507758309259, 'psi': 0.9976909076653275}
[S15] START round=27 head_norm_before_train=1.932164 (no previous merge yet)
[S15] round=27 local utility u=0.354358 metrics={'f1_val': 0.9966196520233872, 'auprc': 0.99619966359869, 'loss_val': 0.036076214643080556, 'psi': 0.9964516566535084}-{'f1_val': 0.900365077766655, 'auprc': 0.9966126540267836, 'loss_val': 0.16850281231533468, 'psi': 0.9388641082707064}
[S16] START round=27 head_norm_before_train=1.237098 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.434043 metrics={'f1_val': 0.8801284065907671, 'auprc': 0.9901442310984274, 'loss_val': 0.41669806848028945, 'psi': 0.9241347363938313}-{'f1_val': 0.8124401326773338, 'auprc': 0.9198043207505024, 'loss_val': 0.6676342153542195, 'psi': 0.8553858079066012}
[S17] START round=27 head_norm_before_train=1.843576 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.591842771272945, 'auprc': 0.8071930936424088, 'loss_val': 0.9630618294350185, 'psi': 0.6779829002207305}-{'f1_val': 0.5909047550941133, 'auprc': 0.7864319911111254, 'loss_val': 0.8825121359723882, 'psi': 0.6691156495009182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:50316
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:50311
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:50303
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:50308
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.947965)
[S7] loaded HEAD from S15 (vec_in norm=1.947965)
[S7] cosine check vs S15: cos=0.3096
[S7] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.842569)
[S16] loaded HEAD from S13 (vec_in norm=1.842569)
[S16] cosine check vs S13: cos=0.5304
[S16] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1794) from S6
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=2.170477)
[S7] loaded HEAD from S6 (vec_in norm=2.170477)
[S7] cosine check vs S6: cos=0.5345
[S7] BUFFERED delta from S6 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.183875)
[S6] loaded HEAD from S3 (vec_in norm=2.183875)
[S6] cosine check vs S3: cos=0.9930
[S6] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.543251)
[S5] loaded HEAD from S2 (vec_in norm=1.543251)
[S5] cosine check vs S2: cos=0.9953
[S5] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1804) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.294225)
[S4] loaded HEAD from S16 (vec_in norm=1.294225)
[S4] cosine check vs S16: cos=0.9537
[S4] BUFFERED delta from S16 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.134940)
[S3] loaded HEAD from S9 (vec_in norm=2.134940)
[S3] cosine check vs S9: cos=-0.1277
[S3] DROPPED delta from S9 (cos=-0.1277 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.927459)
[S10] loaded HEAD from S11 (vec_in norm=1.927459)
[S10] cosine check vs S11: cos=0.9990
[S10] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=27 metric=0.9953 head_norm=1.937890
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.365462e-02
[S10] stored merged vector for next round verification (round=27)
[S10] DEBUG after merge:  round=27 metric=0.9949 head_norm=1.932188 delta_norm=0.043655
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9472 head_norm=1.326482
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.000305e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9477 head_norm=1.295096 delta_norm=0.200031
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.7144 head_norm=1.565144
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.646965e-02
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.7144 head_norm=1.552354 delta_norm=0.076470
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.5654 head_norm=1.277778
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.387855e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.5594 head_norm=1.238762 delta_norm=0.638785
[S7] aggregate: ROLLBACK (f1_val pre=0.565 post=0.559 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.8801 head_norm=1.294225
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.969599e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.8713 head_norm=1.378366 delta_norm=0.796960
[S16] aggregate: ROLLBACK (f1_val pre=0.880 post=0.871 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.8674 head_norm=2.170477
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.286520e-01
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.8236 head_norm=2.173382 delta_norm=0.128652
[S6] aggregate: ROLLBACK (f1_val pre=0.867 post=0.824 tol_abs=0.005 tol_rel=0.0)
[S2] START round=28 head_norm_before_train=1.543251 cos_to_last_merge=0.7781 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.778
[S2] round=28 local utility u=0.385593 metrics={'f1_val': 0.7136575999483578, 'auprc': 0.8540439482381408, 'loss_val': 0.5647964754039267, 'psi': 0.769812139264271}-{'f1_val': 0.7155654058770231, 'auprc': 0.689116678842758, 'loss_val': 0.8526465548985891, 'psi': 0.7049859150633171}
[S3] START round=28 head_norm_before_train=2.183875 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9974576466942975, 'loss_val': 0.10254653215046931, 'psi': 0.9758823468416705}-{'f1_val': 0.9615385219550141, 'auprc': 0.996661604161746, 'loss_val': 0.09855837154731872, 'psi': 0.9755877548377069}
[S4] START round=28 head_norm_before_train=1.295096 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.036545 metrics={'f1_val': 0.9493566748457934, 'auprc': 0.968688746561775, 'loss_val': 0.27120160206677313, 'psi': 0.957089503532186}-{'f1_val': 0.9472421608173066, 'auprc': 0.9511179592644641, 'loss_val': 0.2788917899328422, 'psi': 0.9487924801961696}
[S5] START round=28 head_norm_before_train=1.552354 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=1.000000 metrics={'f1_val': 0.9961867794578795, 'auprc': 0.9927322615987608, 'loss_val': 0.17683601772273014, 'psi': 0.994804972314232}-{'f1_val': 0.7144377451253945, 'auprc': 0.794085646259298, 'loss_val': 0.5762968330272474, 'psi': 0.7462969055789559}
[S6] START round=28 head_norm_before_train=2.173382 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.8041518967219647, 'auprc': 0.9455997326929684, 'loss_val': 0.5117105108395396, 'psi': 0.8607310311103662}-{'f1_val': 0.8673551779970058, 'auprc': 0.9622807545666452, 'loss_val': 0.372128249394654, 'psi': 0.9053254086248614}
[S7] START round=28 head_norm_before_train=1.238762 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.529238 metrics={'f1_val': 0.6681152748181721, 'auprc': 0.8098895055857622, 'loss_val': 0.5141140166199992, 'psi': 0.7248249671252082}-{'f1_val': 0.565422218544491, 'auprc': 0.7766155687083467, 'loss_val': 0.8566089512983278, 'psi': 0.6498995586100333}
[S8] START round=28 head_norm_before_train=1.385904 cos_to_last_merge=0.9986 (last merge round=25)
[S8] round=28 local utility u=0.014004 metrics={'f1_val': 0.9927720833909908, 'auprc': 0.987264205554689, 'loss_val': 0.08788264317755387, 'psi': 0.99056893225647}-{'f1_val': 0.9836444136069047, 'auprc': 0.999360049943941, 'loss_val': 0.09741297664262874, 'psi': 0.9899306681417193}
[S9] START round=28 head_norm_before_train=2.134940 (no previous merge yet)
[S9] round=28 local utility u=0.000372 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988175154376636, 'loss_val': 0.01947461039733116, 'psi': 0.9977887536823511}-{'f1_val': 0.9971029125121428, 'auprc': 0.9986827156820708, 'loss_val': 0.01981360466881276, 'psi': 0.997734833780114}
[S10] START round=28 head_norm_before_train=1.932188 cos_to_last_merge=1.0000 (last merge round=27)
[S10] round=28 local utility u=0.005451 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9966369530785023, 'loss_val': 0.05357280380288203, 'psi': 0.9954534142370508}-{'f1_val': 0.9953231205637304, 'auprc': 0.9932066944136535, 'loss_val': 0.058135584037914585, 'psi': 0.9944765501036996}
[S11] START round=28 head_norm_before_train=1.927459 (no previous merge yet)
[S11] round=28 local utility u=0.001187 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9984357685036014, 'loss_val': 0.030660837359536675, 'psi': 0.9973147897851689}-{'f1_val': 0.996567470639547, 'auprc': 0.9984376026462065, 'loss_val': 0.03304034620444761, 'psi': 0.9973155234422109}
[S13] START round=28 head_norm_before_train=1.842569 cos_to_last_merge=0.9997 (last merge round=26)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6320254081769656, 'auprc': 0.6673550183108896, 'loss_val': 0.6417644364361804, 'psi': 0.6461572522305352}-{'f1_val': 0.6469176311977538, 'auprc': 0.6488434279392246, 'loss_val': 0.5641235890168733, 'psi': 0.6476879498943421}
[S14] START round=28 head_norm_before_train=1.865656 cos_to_last_merge=0.9997 (last merge round=26)
[S14] round=28 local utility u=0.008495 metrics={'f1_val': 0.9975194887544496, 'auprc': 0.9989831764573913, 'loss_val': 0.07055790161848714, 'psi': 0.9981049638356263}-{'f1_val': 0.996673987435767, 'auprc': 0.9989076633426065, 'loss_val': 0.08224758544039672, 'psi': 0.9975674577985028}
[S15] START round=28 head_norm_before_train=1.947965 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.9949596624323498, 'auprc': 0.995810773586605, 'loss_val': 0.04893464490186064, 'psi': 0.9953001068940519}-{'f1_val': 0.9966196520233872, 'auprc': 0.99619966359869, 'loss_val': 0.036076214643080556, 'psi': 0.9964516566535084}
[S16] START round=28 head_norm_before_train=1.378366 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.428371 metrics={'f1_val': 0.9875970963632649, 'auprc': 0.9962928542996188, 'loss_val': 0.22321349463894294, 'psi': 0.9910753995378064}-{'f1_val': 0.8801284065907671, 'auprc': 0.9901442310984274, 'loss_val': 0.41669806848028945, 'psi': 0.9241347363938313}
[S17] START round=28 head_norm_before_train=1.867453 (no previous merge yet)
[S17] round=28 local utility u=0.351796 metrics={'f1_val': 0.636911021450775, 'auprc': 0.8874249544925287, 'loss_val': 0.770574103454413, 'psi': 0.7371165946674765}-{'f1_val': 0.591842771272945, 'auprc': 0.8071930936424088, 'loss_val': 0.9630618294350185, 'psi': 0.6779829002207305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:50313
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:50305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:50309
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1807 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.954339)
[S7] loaded HEAD from S10 (vec_in norm=1.954339)
[S7] cosine check vs S10: cos=0.4230
[S7] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.557325)
[S5] loaded HEAD from S2 (vec_in norm=1.557325)
[S5] cosine check vs S2: cos=0.9976
[S5] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.312749)
[S8] loaded HEAD from S4 (vec_in norm=1.312749)
[S8] cosine check vs S4: cos=0.9746
[S8] BUFFERED delta from S4 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1803) from S7
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.255959)
[S8] loaded HEAD from S7 (vec_in norm=1.255959)
[S8] cosine check vs S7: cos=-0.0405
[S8] DROPPED delta from S7 (cos=-0.0405 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.889358)
[S13] loaded HEAD from S14 (vec_in norm=1.889358)
[S13] cosine check vs S14: cos=0.9958
[S13] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1807) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.562808)
[S3] loaded HEAD from S5 (vec_in norm=1.562808)
[S3] cosine check vs S5: cos=-0.0421
[S3] DROPPED delta from S5 (cos=-0.0421 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.144632)
[S3] loaded HEAD from S9 (vec_in norm=2.144632)
[S3] cosine check vs S9: cos=-0.1272
[S3] DROPPED delta from S9 (cos=-0.1272 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:50314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:50304
[S16] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.416244)
[S4] loaded HEAD from S16 (vec_in norm=1.416244)
[S4] cosine check vs S16: cos=0.7529
[S4] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:50316
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.945836)
[S10] loaded HEAD from S11 (vec_in norm=1.945836)
[S10] cosine check vs S11: cos=0.9992
[S10] BUFFERED delta from S11 (total buffered=1)
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.888420)
[S14] loaded HEAD from S17 (vec_in norm=1.888420)
[S14] cosine check vs S17: cos=0.9944
[S14] BUFFERED delta from S17 (total buffered=1)
[S8] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.421783)
[S16] loaded HEAD from S8 (vec_in norm=1.421783)
[S16] cosine check vs S8: cos=0.6057
[S16] BUFFERED delta from S8 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9494 head_norm=1.312749
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.820300e-01
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9499 head_norm=1.277566 delta_norm=0.482030
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.9962 head_norm=1.562808
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.432979e-02
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.9962 head_norm=1.559123 delta_norm=0.054330
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.6681 head_norm=1.255959
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.111096e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.6853 head_norm=1.366863 delta_norm=0.911110
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.6320 head_norm=1.855758
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.756903e-02
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.6320 head_norm=1.870585 delta_norm=0.087569
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9975 head_norm=1.889358
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.000061e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9971 head_norm=1.886240 delta_norm=0.100006
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.9947 head_norm=1.954339
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.975463e-02
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.9947 head_norm=1.949687 delta_norm=0.039755
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.9876 head_norm=1.416244
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.301044e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.9868 head_norm=1.271446 delta_norm=0.630104
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9928 head_norm=1.421783
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.634010e-01
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.9928 head_norm=1.358561 delta_norm=0.163401
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.557325 cos_to_last_merge=0.7772 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.777
[S2] round=29 local utility u=0.165997 metrics={'f1_val': 0.7684485446991441, 'auprc': 0.8323487159170085, 'loss_val': 0.49646227286367545, 'psi': 0.7940086131862899}-{'f1_val': 0.7136575999483578, 'auprc': 0.8540439482381408, 'loss_val': 0.5647964754039267, 'psi': 0.769812139264271}
[S3] START round=29 head_norm_before_train=2.194664 (no previous merge yet)
[S3] round=29 local utility u=0.097269 metrics={'f1_val': 0.9882245168844831, 'auprc': 0.9972320764464605, 'loss_val': 0.06768569230480091, 'psi': 0.991827540709274}-{'f1_val': 0.961498813606586, 'auprc': 0.9974576466942975, 'loss_val': 0.10254653215046931, 'psi': 0.9758823468416705}
[S4] START round=29 head_norm_before_train=1.277566 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9406198480635815, 'auprc': 0.9445528304005356, 'loss_val': 0.34028622454265606, 'psi': 0.9421930409983631}-{'f1_val': 0.9493566748457934, 'auprc': 0.968688746561775, 'loss_val': 0.27120160206677313, 'psi': 0.957089503532186}
[S5] START round=29 head_norm_before_train=1.559123 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7143720012038259, 'auprc': 0.7946588797686669, 'loss_val': 0.48402854939407836, 'psi': 0.7464867526297623}-{'f1_val': 0.9961867794578795, 'auprc': 0.9927322615987608, 'loss_val': 0.17683601772273014, 'psi': 0.994804972314232}
[S6] START round=29 head_norm_before_train=2.188443 cos_to_last_merge=0.9998 (last merge round=27)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.7585625361501127, 'auprc': 0.9375940896586766, 'loss_val': 0.5413340716213895, 'psi': 0.8301751575535383}-{'f1_val': 0.8041518967219647, 'auprc': 0.9455997326929684, 'loss_val': 0.5117105108395396, 'psi': 0.8607310311103662}
[S7] START round=29 head_norm_before_train=1.366863 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.345093 metrics={'f1_val': 0.698536194685276, 'auprc': 0.9158740734702622, 'loss_val': 0.32440815405348694, 'psi': 0.7854713461992704}-{'f1_val': 0.6681152748181721, 'auprc': 0.8098895055857622, 'loss_val': 0.5141140166199992, 'psi': 0.7248249671252082}
[S8] START round=29 head_norm_before_train=1.358561 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.028405 metrics={'f1_val': 0.9935462653440466, 'auprc': 0.9992970493342871, 'loss_val': 0.07181535173432077, 'psi': 0.9958465789401427}-{'f1_val': 0.9927720833909908, 'auprc': 0.987264205554689, 'loss_val': 0.08788264317755387, 'psi': 0.99056893225647}
[S9] START round=29 head_norm_before_train=2.144632 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9974151648539451, 'loss_val': 0.019406869107719958, 'psi': 0.9972278134488637}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988175154376636, 'loss_val': 0.01947461039733116, 'psi': 0.9977887536823511}
[S10] START round=29 head_norm_before_train=1.949687 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.000662 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9961998878574125, 'loss_val': 0.05093781646992286, 'psi': 0.9952785881486148}-{'f1_val': 0.9946643883427498, 'auprc': 0.9966369530785023, 'loss_val': 0.05357280380288203, 'psi': 0.9954534142370508}
[S11] START round=29 head_norm_before_train=1.945836 (no previous merge yet)
[S11] round=29 local utility u=0.000626 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983828668318028, 'loss_val': 0.029250713509542104, 'psi': 0.9972936291164494}-{'f1_val': 0.996567470639547, 'auprc': 0.9984357685036014, 'loss_val': 0.030660837359536675, 'psi': 0.9973147897851689}
[S13] START round=29 head_norm_before_train=1.870585 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5739344515189169, 'auprc': 0.6880583387199536, 'loss_val': 0.8699275165277173, 'psi': 0.6195840063993315}-{'f1_val': 0.6320254081769656, 'auprc': 0.6673550183108896, 'loss_val': 0.6417644364361804, 'psi': 0.6461572522305352}
[S14] START round=29 head_norm_before_train=1.886240 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.002456 metrics={'f1_val': 0.9970407855713329, 'auprc': 0.9992293169138778, 'loss_val': 0.06351304157648781, 'psi': 0.9979161981083509}-{'f1_val': 0.9975194887544496, 'auprc': 0.9989831764573913, 'loss_val': 0.07055790161848714, 'psi': 0.9981049638356263}
[S15] START round=29 head_norm_before_train=1.964566 (no previous merge yet)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.7962296663063557, 'auprc': 0.9359727025742651, 'loss_val': 0.3118284066330207, 'psi': 0.8521268808135195}-{'f1_val': 0.9949596624323498, 'auprc': 0.995810773586605, 'loss_val': 0.04893464490186064, 'psi': 0.9953001068940519}
[S16] START round=29 head_norm_before_train=1.271446 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.073759 metrics={'f1_val': 0.9913080547123103, 'auprc': 0.9961321645222032, 'loss_val': 0.09747908561447224, 'psi': 0.9932376986362674}-{'f1_val': 0.9875970963632649, 'auprc': 0.9962928542996188, 'loss_val': 0.22321349463894294, 'psi': 0.9910753995378064}
[S17] START round=29 head_norm_before_train=1.888420 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5721422729660353, 'auprc': 0.7437073555590703, 'loss_val': 1.130027385228185, 'psi': 0.6407683060032493}-{'f1_val': 0.636911021450775, 'auprc': 0.8874249544925287, 'loss_val': 0.770574103454413, 'psi': 0.7371165946674765}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:50315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:50305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:50317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:50312
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:50309
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.909876)
[S17] loaded HEAD from S14 (vec_in norm=1.909876)
[S17] cosine check vs S14: cos=0.9972
[S17] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.204425)
[S5] loaded HEAD from S3 (vec_in norm=2.204425)
[S5] cosine check vs S3: cos=-0.0444
[S5] DROPPED delta from S3 (cos=-0.0444 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.395611)
[S15] loaded HEAD from S7 (vec_in norm=1.395611)
[S15] cosine check vs S7: cos=0.2863
[S15] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.384061)
[S7] loaded HEAD from S8 (vec_in norm=1.384061)
[S7] cosine check vs S8: cos=-0.0830
[S7] DROPPED delta from S8 (cos=-0.0830 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.326640)
[S8] loaded HEAD from S16 (vec_in norm=1.326640)
[S8] cosine check vs S16: cos=0.9389
[S8] BUFFERED delta from S16 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S10
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.970754)
[S11] loaded HEAD from S10 (vec_in norm=1.970754)
[S11] cosine check vs S10: cos=0.9993
[S11] BUFFERED delta from S10 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9935 head_norm=1.384061
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.385516e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9936 head_norm=1.334501 delta_norm=0.238552
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9966 head_norm=1.964068
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.655946e-02
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9966 head_norm=1.967074 delta_norm=0.036559
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.7962 head_norm=1.980667
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.035392e+00
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.8026 head_norm=1.365046 delta_norm=1.035392
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.5721 head_norm=1.907308
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.129994e-02
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.5731 head_norm=1.907260 delta_norm=0.071300
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.573472 cos_to_last_merge=0.7762 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.776
[S2] round=30 local utility u=0.085773 metrics={'f1_val': 0.8225578453378234, 'auprc': 0.7845661747283165, 'loss_val': 0.5062235901676609, 'psi': 0.8073611770940206}-{'f1_val': 0.7684485446991441, 'auprc': 0.8323487159170085, 'loss_val': 0.49646227286367545, 'psi': 0.7940086131862899}
[S3] START round=30 head_norm_before_train=2.204425 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9774458230504863, 'auprc': 0.9969355128872422, 'loss_val': 0.07877420172878508, 'psi': 0.9852416989851887}-{'f1_val': 0.9882245168844831, 'auprc': 0.9972320764464605, 'loss_val': 0.06768569230480091, 'psi': 0.991827540709274}
[S4] START round=30 head_norm_before_train=1.295792 cos_to_last_merge=0.9998 (last merge round=28)
[S4] round=30 local utility u=0.058881 metrics={'f1_val': 0.9413886024674616, 'auprc': 0.9728781085788994, 'loss_val': 0.3121130633283735, 'psi': 0.9539844049120367}-{'f1_val': 0.9406198480635815, 'auprc': 0.9445528304005356, 'loss_val': 0.34028622454265606, 'psi': 0.9421930409983631}
[S5] START round=30 head_norm_before_train=1.580377 cos_to_last_merge=0.9996 (last merge round=28)
[S5] round=30 local utility u=1.000000 metrics={'f1_val': 0.9963332086366786, 'auprc': 0.9972263339347922, 'loss_val': 0.14048334035823898, 'psi': 0.9966904587559241}-{'f1_val': 0.7143720012038259, 'auprc': 0.7946588797686669, 'loss_val': 0.48402854939407836, 'psi': 0.7464867526297623}
[S6] START round=30 head_norm_before_train=2.204758 cos_to_last_merge=0.9992 (last merge round=27)
[S6] round=30 local utility u=0.219150 metrics={'f1_val': 0.805168446924964, 'auprc': 0.9385951040621122, 'loss_val': 0.38567335912467, 'psi': 0.8585391097798233}-{'f1_val': 0.7585625361501127, 'auprc': 0.9375940896586766, 'loss_val': 0.5413340716213895, 'psi': 0.8301751575535383}
[S7] START round=30 head_norm_before_train=1.395611 cos_to_last_merge=0.9992 (last merge round=28)
[S7] round=30 local utility u=0.144975 metrics={'f1_val': 0.6994393639004253, 'auprc': 0.9837103976278866, 'loss_val': 0.24338650428566963, 'psi': 0.8131477773914098}-{'f1_val': 0.698536194685276, 'auprc': 0.9158740734702622, 'loss_val': 0.32440815405348694, 'psi': 0.7854713461992704}
[S8] START round=30 head_norm_before_train=1.334501 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9994329683278234, 'loss_val': 0.0856988004590943, 'psi': 0.9946421302569655}-{'f1_val': 0.9935462653440466, 'auprc': 0.9992970493342871, 'loss_val': 0.07181535173432077, 'psi': 0.9958465789401427}
[S9] START round=30 head_norm_before_train=2.154613 (no previous merge yet)
[S9] round=30 local utility u=0.002254 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987987983137486, 'loss_val': 0.019050581256665998, 'psi': 0.9977812668327851}-{'f1_val': 0.9971029125121428, 'auprc': 0.9974151648539451, 'loss_val': 0.019406869107719958, 'psi': 0.9972278134488637}
[S10] START round=30 head_norm_before_train=1.970754 cos_to_last_merge=0.9999 (last merge round=28)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.992869746824563, 'auprc': 0.9968193190102278, 'loss_val': 0.05204472837680303, 'psi': 0.9944495756988289}-{'f1_val': 0.9946643883427498, 'auprc': 0.9961998878574125, 'loss_val': 0.05093781646992286, 'psi': 0.9952785881486148}
[S11] START round=30 head_norm_before_train=1.967074 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9697867487192809, 'auprc': 0.9981679555654457, 'loss_val': 0.07362718056344164, 'psi': 0.9811392314577468}-{'f1_val': 0.996567470639547, 'auprc': 0.9983828668318028, 'loss_val': 0.029250713509542104, 'psi': 0.9972936291164494}
[S13] START round=30 head_norm_before_train=1.880498 cos_to_last_merge=0.9999 (last merge round=28)
[S13] round=30 local utility u=0.134609 metrics={'f1_val': 0.6007663994484332, 'auprc': 0.6838393207445682, 'loss_val': 0.7490445227076501, 'psi': 0.6339955679668872}-{'f1_val': 0.5739344515189169, 'auprc': 0.6880583387199536, 'loss_val': 0.8699275165277173, 'psi': 0.6195840063993315}
[S14] START round=30 head_norm_before_train=1.909876 cos_to_last_merge=0.9998 (last merge round=28)
[S14] round=30 local utility u=0.002749 metrics={'f1_val': 0.9970340443882946, 'auprc': 0.9993537719973391, 'loss_val': 0.05834861665622497, 'psi': 0.9979619354319124}-{'f1_val': 0.9970407855713329, 'auprc': 0.9992293169138778, 'loss_val': 0.06351304157648781, 'psi': 0.9979161981083509}
[S15] START round=30 head_norm_before_train=1.365046 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.804688 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9966855756999164, 'loss_val': 0.08769266668068963, 'psi': 0.996722231312479}-{'f1_val': 0.7962296663063557, 'auprc': 0.9359727025742651, 'loss_val': 0.3118284066330207, 'psi': 0.8521268808135195}
[S16] START round=30 head_norm_before_train=1.326640 cos_to_last_merge=0.9992 (last merge round=28)
[S16] round=30 local utility u=0.003444 metrics={'f1_val': 0.9919650973427813, 'auprc': 0.9939643214325805, 'loss_val': 0.0880289331762638, 'psi': 0.992764786978701}-{'f1_val': 0.9913080547123103, 'auprc': 0.9961321645222032, 'loss_val': 0.09747908561447224, 'psi': 0.9932376986362674}
[S17] START round=30 head_norm_before_train=1.907260 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.181896 metrics={'f1_val': 0.6011587092175085, 'auprc': 0.731969355768182, 'loss_val': 0.905120145869772, 'psi': 0.6534829678377779}-{'f1_val': 0.5721422729660353, 'auprc': 0.7437073555590703, 'loss_val': 1.130027385228185, 'psi': 0.6407683060032493}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:50317
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:50302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:50314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:50315
[S7] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.369400)
[S8] loaded HEAD from S16 (vec_in norm=1.369400)
[S8] cosine check vs S16: cos=0.9830
[S8] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1804) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.934378)
[S17] loaded HEAD from S14 (vec_in norm=1.934378)
[S17] cosine check vs S14: cos=0.9984
[S17] BUFFERED delta from S14 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.326358)
[S16] loaded HEAD from S4 (vec_in norm=1.326358)
[S16] cosine check vs S4: cos=0.9904
[S16] BUFFERED delta from S4 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.409891)
[S15] loaded HEAD from S7 (vec_in norm=1.409891)
[S15] cosine check vs S7: cos=0.7092
[S15] BUFFERED delta from S7 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S5
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.600174)
[S2] loaded HEAD from S5 (vec_in norm=1.600174)
[S2] cosine check vs S5: cos=0.9960
[S2] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.892080)
[S14] loaded HEAD from S13 (vec_in norm=1.892080)
[S14] cosine check vs S13: cos=0.9962
[S14] BUFFERED delta from S13 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1795) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=2.219503)
[S3] loaded HEAD from S6 (vec_in norm=2.219503)
[S3] cosine check vs S6: cos=0.9938
[S3] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=30 metric=0.8226 head_norm=1.586970
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.134216e-02
[S2] stored merged vector for next round verification (round=30)
[S2] DEBUG after merge:  round=30 metric=0.8144 head_norm=1.591988 delta_norm=0.071342
[S2] aggregate: ROLLBACK (f1_val pre=0.823 post=0.814 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9914 head_norm=1.366114
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.261564e-01
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9914 head_norm=1.361927 delta_norm=0.126156
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.024 → S7@127.0.0.1:50308
[S10] ⇄ pheromone p=0.014 → S11@127.0.0.1:50312
[S13] ⇄ pheromone p=0.064 → S14@127.0.0.1:50314
[S6] ⇄ pheromone p=0.245 → S3@127.0.0.1:50303
[S4] ⇄ pheromone p=0.038 → S16@127.0.0.1:50316
[S7] ⇄ pheromone p=0.188 → S15@127.0.0.1:50315
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.9774 head_norm=2.214769
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.234696e-01
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.9777 head_norm=2.213696 delta_norm=0.123470
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.031 → S6@127.0.0.1:50307
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.9967 head_norm=1.401906
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.361333e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.9967 head_norm=1.299664 delta_norm=0.536133
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.304 → S7@127.0.0.1:50308
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9970 head_norm=1.934378
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.637196e-02
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9970 head_norm=1.911396 delta_norm=0.086372
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.025 → S17@127.0.0.1:50317
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.6012 head_norm=1.923422
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.563267e-02
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.6014 head_norm=1.928106 delta_norm=0.055633
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=30 metric=0.9920 head_norm=1.369400
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.578723e-02
[S16] stored merged vector for next round verification (round=30)
[S16] DEBUG after merge:  round=30 metric=0.9920 head_norm=1.344644 delta_norm=0.095787
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.179 → S8@127.0.0.1:50309
[S5] ⇄ pheromone p=0.471 → S2@127.0.0.1:50302
[S2] START round=31 head_norm_before_train=1.591988 cos_to_last_merge=1.0000 (last merge round=30)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.7138978444305555, 'auprc': 0.8477425605221973, 'loss_val': 0.569422841297641, 'psi': 0.7674357308672122}-{'f1_val': 0.8225578453378234, 'auprc': 0.7845661747283165, 'loss_val': 0.5062235901676609, 'psi': 0.8073611770940206}
[S3] START round=31 head_norm_before_train=2.213696 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.042057 metrics={'f1_val': 0.9842660191206474, 'auprc': 0.9970267035205485, 'loss_val': 0.03585590288454497, 'psi': 0.9893702928806078}-{'f1_val': 0.9774458230504863, 'auprc': 0.9969355128872422, 'loss_val': 0.07877420172878508, 'psi': 0.9852416989851887}
[S4] START round=31 head_norm_before_train=1.326358 cos_to_last_merge=0.9985 (last merge round=28)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9409388535164868, 'auprc': 0.9664756636659615, 'loss_val': 0.2933547697881629, 'psi': 0.9511535775762767}-{'f1_val': 0.9413886024674616, 'auprc': 0.9728781085788994, 'loss_val': 0.3121130633283735, 'psi': 0.9539844049120367}
[S5] START round=31 head_norm_before_train=1.600174 cos_to_last_merge=0.9988 (last merge round=28)
[S5] round=31 local utility u=0.001243 metrics={'f1_val': 0.9961867794578795, 'auprc': 0.9945988204652589, 'loss_val': 0.1292364333516149, 'psi': 0.9955515958608312}-{'f1_val': 0.9963332086366786, 'auprc': 0.9972263339347922, 'loss_val': 0.14048334035823898, 'psi': 0.9966904587559241}
[S6] START round=31 head_norm_before_train=2.219503 cos_to_last_merge=0.9985 (last merge round=27)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.6520538844186268, 'auprc': 0.9101460771641867, 'loss_val': 0.6531169881268104, 'psi': 0.7552907615168507}-{'f1_val': 0.805168446924964, 'auprc': 0.9385951040621122, 'loss_val': 0.38567335912467, 'psi': 0.8585391097798233}
[S7] START round=31 head_norm_before_train=1.409891 cos_to_last_merge=0.9984 (last merge round=28)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.6664713323261571, 'auprc': 0.8146138968682196, 'loss_val': 0.4541782122532648, 'psi': 0.7257283581429821}-{'f1_val': 0.6994393639004253, 'auprc': 0.9837103976278866, 'loss_val': 0.24338650428566963, 'psi': 0.8131477773914098}
[S8] START round=31 head_norm_before_train=1.361927 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.003457 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9986488057899672, 'loss_val': 0.08297075278008617, 'psi': 0.994982357065288}-{'f1_val': 0.9914482382097267, 'auprc': 0.9994329683278234, 'loss_val': 0.0856988004590943, 'psi': 0.9946421302569655}
[S9] START round=31 head_norm_before_train=2.163252 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9988244106587717, 'loss_val': 0.018738765241449434, 'psi': 0.9975432532422118}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987987983137486, 'loss_val': 0.019050581256665998, 'psi': 0.9977812668327851}
[S10] START round=31 head_norm_before_train=1.990692 cos_to_last_merge=0.9995 (last merge round=28)
[S10] round=31 local utility u=0.004163 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9967643935054766, 'loss_val': 0.046428570301161085, 'psi': 0.9947151158131324}-{'f1_val': 0.992869746824563, 'auprc': 0.9968193190102278, 'loss_val': 0.05204472837680303, 'psi': 0.9944495756988289}
[S11] START round=31 head_norm_before_train=1.982010 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=31 local utility u=0.103885 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983245347739359, 'loss_val': 0.027011047845526107, 'psi': 0.9972702962933027}-{'f1_val': 0.9697867487192809, 'auprc': 0.9981679555654457, 'loss_val': 0.07362718056344164, 'psi': 0.9811392314577468}
[S13] START round=31 head_norm_before_train=1.892080 cos_to_last_merge=0.9996 (last merge round=28)
[S13] round=31 local utility u=0.110109 metrics={'f1_val': 0.6210535976255465, 'auprc': 0.6587810000435624, 'loss_val': 0.5753757237900521, 'psi': 0.6361445585927529}-{'f1_val': 0.6007663994484332, 'auprc': 0.6838393207445682, 'loss_val': 0.7490445227076501, 'psi': 0.6339955679668872}
[S14] START round=31 head_norm_before_train=1.911396 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9460707229319721, 'auprc': 0.9990072876873113, 'loss_val': 0.08182662501279357, 'psi': 0.9672453488341077}-{'f1_val': 0.9970340443882946, 'auprc': 0.9993537719973391, 'loss_val': 0.05834861665622497, 'psi': 0.9979619354319124}
[S15] START round=31 head_norm_before_train=1.299664 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.9007742193944058, 'auprc': 0.9940926179920985, 'loss_val': 0.2602216404128612, 'psi': 0.9381015788334828}-{'f1_val': 0.9967466683875206, 'auprc': 0.9966855756999164, 'loss_val': 0.08769266668068963, 'psi': 0.996722231312479}
[S16] START round=31 head_norm_before_train=1.344644 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=31 local utility u=0.006500 metrics={'f1_val': 0.9915815154501953, 'auprc': 0.995340269414774, 'loss_val': 0.07685433640653805, 'psi': 0.9930850170360268}-{'f1_val': 0.9919650973427813, 'auprc': 0.9939643214325805, 'loss_val': 0.0880289331762638, 'psi': 0.992764786978701}
[S17] START round=31 head_norm_before_train=1.928106 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.5667568354761335, 'auprc': 0.79701674521647, 'loss_val': 1.095340588041401, 'psi': 0.6588607993722682}-{'f1_val': 0.6011587092175085, 'auprc': 0.731969355768182, 'loss_val': 0.905120145869772, 'psi': 0.6534829678377779}
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S15
[S14]  timeout peer S16
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S15
[S17]  timeout peer S16
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S17
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S9
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S7]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:50312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:50316
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:50314
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:50307
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:50311
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.378451)
[S8] loaded HEAD from S16 (vec_in norm=1.378451)
[S8] cosine check vs S16: cos=0.9866
[S8] BUFFERED delta from S16 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1796) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.993196)
[S10] loaded HEAD from S11 (vec_in norm=1.993196)
[S10] cosine check vs S11: cos=0.9990
[S10] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.224642)
[S6] loaded HEAD from S3 (vec_in norm=2.224642)
[S6] cosine check vs S3: cos=0.9978
[S6] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.397963)
[S16] loaded HEAD from S8 (vec_in norm=1.397963)
[S16] cosine check vs S8: cos=0.9866
[S16] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1794) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.899227)
[S14] loaded HEAD from S13 (vec_in norm=1.899227)
[S14] cosine check vs S13: cos=0.9987
[S14] BUFFERED delta from S13 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S10
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.007358)
[S11] loaded HEAD from S10 (vec_in norm=2.007358)
[S11] cosine check vs S10: cos=0.9990
[S11] BUFFERED delta from S10 (total buffered=1)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=31 metric=0.9933 head_norm=2.007358
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.542834e-02
[S10] stored merged vector for next round verification (round=31)
[S10] DEBUG after merge:  round=31 metric=0.9933 head_norm=1.999773 delta_norm=0.045428
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.9966 head_norm=1.993196
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.542834e-02
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.9966 head_norm=1.999773 delta_norm=0.045428
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9461 head_norm=1.934262
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.232774e-02
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9461 head_norm=1.916110 delta_norm=0.052328
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9925 head_norm=1.397963
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.139232e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9925 head_norm=1.383559 delta_norm=0.113923
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:50302
[S5] sending update (kind=head size=1803 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S5
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.621720)
[S2] loaded HEAD from S5 (vec_in norm=1.621720)
[S2] cosine check vs S5: cos=0.9977
[S2] BUFFERED delta from S5 (total buffered=1)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.9916 head_norm=1.378451
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.139232e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.9916 head_norm=1.383559 delta_norm=0.113923
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] CommDone barrier timeout: have=1 need=2 — continuing
[S7] CommDone barrier timeout: have=2 need=3 — continuing
[S2] START round=32 head_norm_before_train=1.608056 cos_to_last_merge=0.9999 (last merge round=30)
[S2] round=32 local utility u=0.012809 metrics={'f1_val': 0.7742777083606102, 'auprc': 0.768884406411385, 'loss_val': 0.6695100022181378, 'psi': 0.7721203875809202}-{'f1_val': 0.7138978444305555, 'auprc': 0.8477425605221973, 'loss_val': 0.569422841297641, 'psi': 0.7674357308672122}
[S3] START round=32 head_norm_before_train=2.224642 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.96376887347958, 'auprc': 0.9973796527468136, 'loss_val': 0.09099943209739259, 'psi': 0.9772131851864735}-{'f1_val': 0.9842660191206474, 'auprc': 0.9970267035205485, 'loss_val': 0.03585590288454497, 'psi': 0.9893702928806078}
[S4] START round=32 head_norm_before_train=1.356143 cos_to_last_merge=0.9966 (last merge round=28)
[S4] round=32 local utility u=0.000542 metrics={'f1_val': 0.9421030762880356, 'auprc': 0.9609796194729077, 'loss_val': 0.28276751909378833, 'psi': 0.9496536935619844}-{'f1_val': 0.9409388535164868, 'auprc': 0.9664756636659615, 'loss_val': 0.2933547697881629, 'psi': 0.9511535775762767}
[S5] START round=32 head_norm_before_train=1.621720 cos_to_last_merge=0.9974 (last merge round=28)
[S5] round=32 local utility u=0.025589 metrics={'f1_val': 0.9961867794578795, 'auprc': 0.9978667936349741, 'loss_val': 0.08786295896536526, 'psi': 0.9968587851287173}-{'f1_val': 0.9961867794578795, 'auprc': 0.9945988204652589, 'loss_val': 0.1292364333516149, 'psi': 0.9955515958608312}
[S6] START round=32 head_norm_before_train=2.231222 cos_to_last_merge=0.9979 (last merge round=27)
[S6] round=32 local utility u=0.883167 metrics={'f1_val': 0.8654554087222619, 'auprc': 0.9607600032958796, 'loss_val': 0.3190333170911301, 'psi': 0.903577246551709}-{'f1_val': 0.6520538844186268, 'auprc': 0.9101460771641867, 'loss_val': 0.6531169881268104, 'psi': 0.7552907615168507}
[S7] START round=32 head_norm_before_train=1.420364 cos_to_last_merge=0.9979 (last merge round=28)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5843042244640962, 'auprc': 0.7976571260601275, 'loss_val': 0.769463736772257, 'psi': 0.6696453851025088}-{'f1_val': 0.6664713323261571, 'auprc': 0.8146138968682196, 'loss_val': 0.4541782122532648, 'psi': 0.7257283581429821}
[S8] START round=32 head_norm_before_train=1.383559 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.999356767966725, 'loss_val': 0.08636186139016827, 'psi': 0.9946116501125261}-{'f1_val': 0.9925380579155019, 'auprc': 0.9986488057899672, 'loss_val': 0.08297075278008617, 'psi': 0.994982357065288}
[S9] START round=32 head_norm_before_train=2.172390 (no previous merge yet)
[S9] round=32 local utility u=0.001138 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988292606364371, 'loss_val': 0.018960191284770198, 'psi': 0.9977934517618605}-{'f1_val': 0.9966891482978385, 'auprc': 0.9988244106587717, 'loss_val': 0.018738765241449434, 'psi': 0.9975432532422118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=32 head_norm_before_train=1.999773 cos_to_last_merge=1.0000 (last merge round=31)
[S10] round=32 local utility u=0.001418 metrics={'f1_val': 0.9949076444438805, 'auprc': 0.9932227604850675, 'loss_val': 0.042320088224111735, 'psi': 0.9942336908603553}-{'f1_val': 0.9933489306849028, 'auprc': 0.9967643935054766, 'loss_val': 0.046428570301161085, 'psi': 0.9947151158131324}
[S11] START round=32 head_norm_before_train=1.999773 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.998177956446274, 'loss_val': 0.027657992170425943, 'psi': 0.9972116649622378}-{'f1_val': 0.996567470639547, 'auprc': 0.9983245347739359, 'loss_val': 0.027011047845526107, 'psi': 0.9972702962933027}
[S13] START round=32 head_norm_before_train=1.899227 cos_to_last_merge=0.9993 (last merge round=28)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5593743246152446, 'auprc': 0.6922467955354126, 'loss_val': 0.844398043543575, 'psi': 0.6125233129833119}-{'f1_val': 0.6210535976255465, 'auprc': 0.6587810000435624, 'loss_val': 0.5753757237900521, 'psi': 0.6361445585927529}
[S14] START round=32 head_norm_before_train=1.916110 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.140678 metrics={'f1_val': 0.9897257583990072, 'auprc': 0.998769996648837, 'loss_val': 0.06168876377210101, 'psi': 0.9933434536989392}-{'f1_val': 0.9460707229319721, 'auprc': 0.9990072876873113, 'loss_val': 0.08182662501279357, 'psi': 0.9672453488341077}
[S15] START round=32 head_norm_before_train=1.350685 cos_to_last_merge=0.9976 (last merge round=30)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.8877058616035283, 'auprc': 0.9953161801659746, 'loss_val': 0.24125253991478163, 'psi': 0.9307499890285068}-{'f1_val': 0.9007742193944058, 'auprc': 0.9940926179920985, 'loss_val': 0.2602216404128612, 'psi': 0.9381015788334828}
[S16] START round=32 head_norm_before_train=1.383559 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.8485593746409589, 'auprc': 0.9555924179222373, 'loss_val': 0.5615937750348297, 'psi': 0.8913725919534703}-{'f1_val': 0.9915815154501953, 'auprc': 0.995340269414774, 'loss_val': 0.07685433640653805, 'psi': 0.9930850170360268}
[S17] START round=32 head_norm_before_train=1.941506 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=32 local utility u=0.078144 metrics={'f1_val': 0.5798236080759133, 'auprc': 0.8089387226239483, 'loss_val': 1.0532197545792061, 'psi': 0.6714696538951272}-{'f1_val': 0.5667568354761335, 'auprc': 0.79701674521647, 'loss_val': 1.095340588041401, 'psi': 0.6588607993722682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:50312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:50302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:50314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:50316
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:50317
[S4] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=2.241440)
[S3] loaded HEAD from S6 (vec_in norm=2.241440)
[S3] cosine check vs S6: cos=0.9973
[S3] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.388030)
[S16] loaded HEAD from S4 (vec_in norm=1.388030)
[S16] cosine check vs S4: cos=0.9878
[S16] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.627263)
[S5] loaded HEAD from S2 (vec_in norm=1.627263)
[S5] cosine check vs S2: cos=0.9953
[S5] BUFFERED delta from S2 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.954327)
[S14] loaded HEAD from S17 (vec_in norm=1.954327)
[S14] cosine check vs S17: cos=0.9945
[S14] BUFFERED delta from S17 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1794) from S5
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.653451)
[S2] loaded HEAD from S5 (vec_in norm=1.653451)
[S2] cosine check vs S5: cos=0.9953
[S2] BUFFERED delta from S5 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1794) from S10
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.015000)
[S11] loaded HEAD from S10 (vec_in norm=2.015000)
[S11] cosine check vs S10: cos=0.9999
[S11] BUFFERED delta from S10 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.8655 head_norm=2.241440
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.206034e-02
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.8687 head_norm=2.231548 delta_norm=0.082060
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.9962 head_norm=1.653451
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.073622e-02
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.9962 head_norm=1.638421 delta_norm=0.080736
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=32 metric=0.7743 head_norm=1.627263
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.156797e-02
[S2] stored merged vector for next round verification (round=32)
[S2] DEBUG after merge:  round=32 metric=0.7760 head_norm=1.630771 delta_norm=0.071568
[S2] aggregate: ACCEPT kept=['S5', 'S5'] (k=2/2) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.937336)
[S17] loaded HEAD from S14 (vec_in norm=1.937336)
[S17] cosine check vs S14: cos=0.9945
[S17] BUFFERED delta from S14 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9897 head_norm=1.937336
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.028296e-01
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9897 head_norm=1.943131 delta_norm=0.102830
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.8486 head_norm=1.413898
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.099725e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.8463 head_norm=1.396701 delta_norm=0.109972
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8]  timeout peer S4
[S8]  timeout peer S7
[S5]  timeout peer S2
[S14]  timeout peer S17
[S16]  timeout peer S8
[S16]  timeout peer S13
[S4]  timeout peer S16
[S7]  timeout peer S6
[S7]  timeout peer S10
[S13]  timeout peer S14
[S10]  timeout peer S11
[S3]  timeout peer S5
[S3]  timeout peer S9
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=32 metric=0.9638 head_norm=2.234903
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.249652e-02
[S3] stored merged vector for next round verification (round=32)
[S3] DEBUG after merge:  round=32 metric=0.9629 head_norm=2.236653 delta_norm=0.082497
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.630771 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.716454762563625, 'auprc': 0.833559611208907, 'loss_val': 0.5949992798401077, 'psi': 0.7632967020217378}-{'f1_val': 0.7742777083606102, 'auprc': 0.768884406411385, 'loss_val': 0.6695100022181378, 'psi': 0.7721203875809202}
[S3] START round=33 head_norm_before_train=2.236653 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=33 local utility u=0.134360 metrics={'f1_val': 0.9969583726029951, 'auprc': 0.9965955080423827, 'loss_val': 0.019064530709389814, 'psi': 0.9968132267787502}-{'f1_val': 0.96376887347958, 'auprc': 0.9973796527468136, 'loss_val': 0.09099943209739259, 'psi': 0.9772131851864735}
[S4] START round=33 head_norm_before_train=1.388030 cos_to_last_merge=0.9940 (last merge round=28)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9412016308844395, 'auprc': 0.9597979847290508, 'loss_val': 0.28841196053129714, 'psi': 0.948640172422284}-{'f1_val': 0.9421030762880356, 'auprc': 0.9609796194729077, 'loss_val': 0.28276751909378833, 'psi': 0.9496536935619844}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.638421 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.9961107503232163, 'auprc': 0.9924208712024645, 'loss_val': 0.1028660197198853, 'psi': 0.9946347986749156}-{'f1_val': 0.9961867794578795, 'auprc': 0.9978667936349741, 'loss_val': 0.08786295896536526, 'psi': 0.9968587851287173}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=2.231548 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.783468427645344, 'auprc': 0.9365944075360275, 'loss_val': 0.5401748794793284, 'psi': 0.8447188196016173}-{'f1_val': 0.8654554087222619, 'auprc': 0.9607600032958796, 'loss_val': 0.3190333170911301, 'psi': 0.903577246551709}
[S7] START round=33 head_norm_before_train=1.431702 cos_to_last_merge=0.9973 (last merge round=28)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.56304309604439, 'auprc': 0.7947099707282801, 'loss_val': 0.8506045170164037, 'psi': 0.655709845917946}-{'f1_val': 0.5843042244640962, 'auprc': 0.7976571260601275, 'loss_val': 0.769463736772257, 'psi': 0.6696453851025088}
[S8] START round=33 head_norm_before_train=1.424777 cos_to_last_merge=0.9995 (last merge round=31)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9935462653440466, 'auprc': 0.9869800887319544, 'loss_val': 0.07208572374278967, 'psi': 0.9909197946992097}-{'f1_val': 0.9914482382097267, 'auprc': 0.999356767966725, 'loss_val': 0.08636186139016827, 'psi': 0.9946116501125261}
[S9] START round=33 head_norm_before_train=2.182630 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9971329229875023, 'loss_val': 0.018775618537762908, 'psi': 0.9971149167022866}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988292606364371, 'loss_val': 0.018960191284770198, 'psi': 0.9977934517618605}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=2.015000 cos_to_last_merge=0.9999 (last merge round=31)
[S10] round=33 local utility u=0.001889 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9969042905228933, 'loss_val': 0.04154846945482402, 'psi': 0.994902510028314}-{'f1_val': 0.9949076444438805, 'auprc': 0.9932227604850675, 'loss_val': 0.042320088224111735, 'psi': 0.9942336908603553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=33 head_norm_before_train=2.010057 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=33 local utility u=0.001034 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982571517027647, 'loss_val': 0.025826637335181354, 'psi': 0.9972433430648342}-{'f1_val': 0.996567470639547, 'auprc': 0.998177956446274, 'loss_val': 0.027657992170425943, 'psi': 0.9972116649622378}
[S13] START round=33 head_norm_before_train=1.906994 cos_to_last_merge=0.9989 (last merge round=28)
[S13] round=33 local utility u=0.209061 metrics={'f1_val': 0.6061373935299312, 'auprc': 0.6723548781186443, 'loss_val': 0.6471780937818099, 'psi': 0.6326243873654165}-{'f1_val': 0.5593743246152446, 'auprc': 0.6922467955354126, 'loss_val': 0.844398043543575, 'psi': 0.6125233129833119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=33 head_norm_before_train=1.943131 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.033745 metrics={'f1_val': 0.9974515471354712, 'auprc': 0.9993981265371477, 'loss_val': 0.04243821325774316, 'psi': 0.9982301788961417}-{'f1_val': 0.9897257583990072, 'auprc': 0.998769996648837, 'loss_val': 0.06168876377210101, 'psi': 0.9933434536989392}
[S15] START round=33 head_norm_before_train=1.430069 cos_to_last_merge=0.9889 (last merge round=30)
[S15] round=33 local utility u=0.412892 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9966534434602042, 'loss_val': 0.07372584256124527, 'psi': 0.996709378416594}-{'f1_val': 0.8877058616035283, 'auprc': 0.9953161801659746, 'loss_val': 0.24125253991478163, 'psi': 0.9307499890285068}
[S16] START round=33 head_norm_before_train=1.396701 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.740736 metrics={'f1_val': 0.9922353369773327, 'auprc': 0.9976627566000814, 'loss_val': 0.0683894111010567, 'psi': 0.9944063048264322}-{'f1_val': 0.8485593746409589, 'auprc': 0.9555924179222373, 'loss_val': 0.5615937750348297, 'psi': 0.8913725919534703}
[S17] START round=33 head_norm_before_train=1.954327 cos_to_last_merge=0.9998 (last merge round=30)
[S17] round=33 local utility u=0.124870 metrics={'f1_val': 0.596520053404952, 'auprc': 0.8369845475352798, 'loss_val': 0.9877952173400707, 'psi': 0.6927058510570832}-{'f1_val': 0.5798236080759133, 'auprc': 0.8089387226239483, 'loss_val': 1.0532197545792061, 'psi': 0.6714696538951272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:50313
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:50314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:50304
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:50311
[S11] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.963452)
[S14] loaded HEAD from S17 (vec_in norm=1.963452)
[S14] cosine check vs S17: cos=0.9980
[S14] BUFFERED delta from S17 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.424231)
[S4] loaded HEAD from S16 (vec_in norm=1.424231)
[S4] cosine check vs S16: cos=0.9961
[S4] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1795) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.961052)
[S13] loaded HEAD from S14 (vec_in norm=1.961052)
[S13] cosine check vs S14: cos=0.9965
[S13] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1792) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.019863)
[S10] loaded HEAD from S11 (vec_in norm=2.019863)
[S10] cosine check vs S11: cos=0.9998
[S10] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.509783)
[S7] loaded HEAD from S15 (vec_in norm=1.509783)
[S7] cosine check vs S15: cos=0.8488
[S7] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1792) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.249109)
[S6] loaded HEAD from S3 (vec_in norm=2.249109)
[S6] cosine check vs S3: cos=0.9999
[S6] BUFFERED delta from S3 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.9975 head_norm=1.961052
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.158447e-02
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.9975 head_norm=1.961285 delta_norm=0.061584
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.5965 head_norm=1.963452
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.079365e-01
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.5978 head_norm=1.947449 delta_norm=0.107936
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9966 head_norm=2.019863
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.303828e-02
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9966 head_norm=2.017391 delta_norm=0.013038
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=33 metric=0.5630 head_norm=1.439775
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.068701e-01
[S7] stored merged vector for next round verification (round=33)
[S7] DEBUG after merge:  round=33 metric=0.5756 head_norm=1.417976 delta_norm=0.406870
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.652939 cos_to_last_merge=0.9997 (last merge round=32)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6737352569281995, 'auprc': 0.7243808174445913, 'loss_val': 1.3959893011205438, 'psi': 0.6939934811347562}-{'f1_val': 0.716454762563625, 'auprc': 0.833559611208907, 'loss_val': 0.5949992798401077, 'psi': 0.7632967020217378}
[S3] START round=34 head_norm_before_train=2.249109 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9893971724872102, 'auprc': 0.9967964923621089, 'loss_val': 0.028159661504687055, 'psi': 0.9923569004371696}-{'f1_val': 0.9969583726029951, 'auprc': 0.9965955080423827, 'loss_val': 0.019064530709389814, 'psi': 0.9968132267787502}
[S4] START round=34 head_norm_before_train=1.418671 cos_to_last_merge=0.9913 (last merge round=28)
[S4] round=34 local utility u=0.000798 metrics={'f1_val': 0.9418234375104546, 'auprc': 0.9584589498711581, 'loss_val': 0.28652900188692493, 'psi': 0.948477642454736}-{'f1_val': 0.9412016308844395, 'auprc': 0.9597979847290508, 'loss_val': 0.28841196053129714, 'psi': 0.948640172422284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=34 metric=0.9418 head_norm=1.444841
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.866742e-02
[S4] stored merged vector for next round verification (round=34)
[S4] DEBUG after merge:  round=34 metric=0.9418 head_norm=1.432929 delta_norm=0.068667
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] START round=34 head_norm_before_train=1.665976 cos_to_last_merge=0.9997 (last merge round=32)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.7145028925575769, 'auprc': 0.7945416621673281, 'loss_val': 0.5249009117574965, 'psi': 0.7465184004014774}-{'f1_val': 0.9961107503232163, 'auprc': 0.9924208712024645, 'loss_val': 0.1028660197198853, 'psi': 0.9946347986749156}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=2.244566 cos_to_last_merge=0.9999 (last merge round=32)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.5876976476363038, 'auprc': 0.9016150914832853, 'loss_val': 1.0177925733215596, 'psi': 0.7132646251750965}-{'f1_val': 0.783468427645344, 'auprc': 0.9365944075360275, 'loss_val': 0.5401748794793284, 'psi': 0.8447188196016173}
[S7] START round=34 head_norm_before_train=1.417976 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=34 local utility u=0.102270 metrics={'f1_val': 0.5718156544309351, 'auprc': 0.7978252566266042, 'loss_val': 0.7080464413891616, 'psi': 0.6622194953092027}-{'f1_val': 0.56304309604439, 'auprc': 0.7947099707282801, 'loss_val': 0.8506045170164037, 'psi': 0.655709845917946}
[S8] START round=34 head_norm_before_train=1.467214 cos_to_last_merge=0.9981 (last merge round=31)
[S8] round=34 local utility u=0.016171 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9994326138288114, 'loss_val': 0.06451277360565057, 'psi': 0.9946419884573606}-{'f1_val': 0.9935462653440466, 'auprc': 0.9869800887319544, 'loss_val': 0.07208572374278967, 'psi': 0.9909197946992097}
[S9] START round=34 head_norm_before_train=2.195619 (no previous merge yet)
[S9] round=34 local utility u=0.001409 metrics={'f1_val': 0.9966857875385419, 'auprc': 0.9988220855899884, 'loss_val': 0.018521833367016276, 'psi': 0.9975403067591205}-{'f1_val': 0.9971029125121428, 'auprc': 0.9971329229875023, 'loss_val': 0.018775618537762908, 'psi': 0.9971149167022866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=34 head_norm_before_train=2.030147 cos_to_last_merge=0.9998 (last merge round=31)
[S10] round=34 local utility u=0.005949 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9958747027045972, 'loss_val': 0.03709211101687577, 'psi': 0.9955437534200771}-{'f1_val': 0.9935679896985945, 'auprc': 0.9969042905228933, 'loss_val': 0.04154846945482402, 'psi': 0.994902510028314}
[S10] not sending this round → trigger blocked (psi=0.996)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=34 metric=0.9953 head_norm=2.044258
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.206998e-02
[S10] stored merged vector for next round verification (round=34)
[S10] DEBUG after merge:  round=34 metric=0.9953 head_norm=2.031844 delta_norm=0.032070
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] START round=34 head_norm_before_train=2.017391 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.000203 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982411845578194, 'loss_val': 0.025372748030153318, 'psi': 0.9972369562068559}-{'f1_val': 0.996567470639547, 'auprc': 0.9982571517027647, 'loss_val': 0.025826637335181354, 'psi': 0.9972433430648342}
[S13] START round=34 head_norm_before_train=1.916062 cos_to_last_merge=0.9983 (last merge round=28)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5916469131058018, 'auprc': 0.675954362330857, 'loss_val': 0.6660977252592339, 'psi': 0.6253698927958239}-{'f1_val': 0.6061373935299312, 'auprc': 0.6723548781186443, 'loss_val': 0.6471780937818099, 'psi': 0.6326243873654165}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=34 metric=0.5916 head_norm=1.924242
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.954804e-02
[S13] stored merged vector for next round verification (round=34)
[S13] DEBUG after merge:  round=34 metric=0.5925 head_norm=1.940669 delta_norm=0.089548
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] START round=34 head_norm_before_train=1.961285 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.002212 metrics={'f1_val': 0.9976943331204965, 'auprc': 0.9991705044297156, 'loss_val': 0.03878831681387645, 'psi': 0.9982848016441841}-{'f1_val': 0.9974515471354712, 'auprc': 0.9993981265371477, 'loss_val': 0.04243821325774316, 'psi': 0.9982301788961417}
[S15] START round=34 head_norm_before_train=1.509783 cos_to_last_merge=0.9783 (last merge round=30)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.870658071739961, 'auprc': 0.9901957747753674, 'loss_val': 0.2561209369098837, 'psi': 0.9184731529541235}-{'f1_val': 0.9967466683875206, 'auprc': 0.9966534434602042, 'loss_val': 0.07372584256124527, 'psi': 0.996709378416594}
[S16] START round=34 head_norm_before_train=1.424231 cos_to_last_merge=0.9999 (last merge round=32)
[S16] round=34 local utility u=0.004723 metrics={'f1_val': 0.9918242256299163, 'auprc': 0.9986996304901056, 'loss_val': 0.05958785889505621, 'psi': 0.9945743875739921}-{'f1_val': 0.9922353369773327, 'auprc': 0.9976627566000814, 'loss_val': 0.0683894111010567, 'psi': 0.9944063048264322}
[S17] START round=34 head_norm_before_train=1.947449 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.5783349747113331, 'auprc': 0.7715678172297704, 'loss_val': 1.0607267835645977, 'psi': 0.655628111718708}-{'f1_val': 0.596520053404952, 'auprc': 0.8369845475352798, 'loss_val': 0.9877952173400707, 'psi': 0.6927058510570832}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S14] not sending this round → trigger blocked (psi=0.998)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:50316
[S8] sending update (kind=head size=1804 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.5877 head_norm=2.259727
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.574052e-02
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.5877 head_norm=2.254277 delta_norm=0.025741
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] → sending delta(kind=head bytes=1808) to S15@127.0.0.1:50315
[S16] RECEIVED delta(kind=head bytes=1804) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.500784)
[S16] loaded HEAD from S8 (vec_in norm=1.500784)
[S16] cosine check vs S8: cos=0.9900
[S16] BUFFERED delta from S8 (total buffered=1)
[S7] sending update (kind=head size=1808 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1808) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.426815)
[S15] loaded HEAD from S7 (vec_in norm=1.426815)
[S15] cosine check vs S7: cos=0.9528
[S15] BUFFERED delta from S7 (total buffered=1)
[S2] START round=35 head_norm_before_train=1.674380 cos_to_last_merge=0.9991 (last merge round=32)
[S2] round=35 local utility u=0.727915 metrics={'f1_val': 0.726429626124175, 'auprc': 0.8415461161370195, 'loss_val': 0.6078222627800686, 'psi': 0.7724762221293129}-{'f1_val': 0.6737352569281995, 'auprc': 0.7243808174445913, 'loss_val': 1.3959893011205438, 'psi': 0.6939934811347562}
[S3] START round=35 head_norm_before_train=2.261713 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9706621159647217, 'auprc': 0.9971621173488076, 'loss_val': 0.08693505182922037, 'psi': 0.981262116518356}-{'f1_val': 0.9893971724872102, 'auprc': 0.9967964923621089, 'loss_val': 0.028159661504687055, 'psi': 0.9923569004371696}
[S4] START round=35 head_norm_before_train=1.432929 cos_to_last_merge=1.0000 (last merge round=34)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9386579716470154, 'auprc': 0.9465907746898745, 'loss_val': 0.31876362475549536, 'psi': 0.9418310928641591}-{'f1_val': 0.9418234375104546, 'auprc': 0.9584589498711581, 'loss_val': 0.28652900188692493, 'psi': 0.948477642454736}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.684923 cos_to_last_merge=0.9993 (last merge round=32)
[S5] round=35 local utility u=1.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9921767330257277, 'loss_val': 0.0818262280020275, 'psi': 0.9947583813819292}-{'f1_val': 0.7145028925575769, 'auprc': 0.7945416621673281, 'loss_val': 0.5249009117574965, 'psi': 0.7465184004014774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=35 head_norm_before_train=2.254277 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=1.000000 metrics={'f1_val': 0.9432527354440734, 'auprc': 0.981521808849382, 'loss_val': 0.21397760567709123, 'psi': 0.9585603648061969}-{'f1_val': 0.5876976476363038, 'auprc': 0.9016150914832853, 'loss_val': 1.0177925733215596, 'psi': 0.7132646251750965}
[S7] START round=35 head_norm_before_train=1.426815 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=35 local utility u=0.378386 metrics={'f1_val': 0.6459653518433182, 'auprc': 0.819284999373781, 'loss_val': 0.4605518664582083, 'psi': 0.7152932108555032}-{'f1_val': 0.5718156544309351, 'auprc': 0.7978252566266042, 'loss_val': 0.7080464413891616, 'psi': 0.6622194953092027}
[S8] START round=35 head_norm_before_train=1.500784 cos_to_last_merge=0.9966 (last merge round=31)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9794778985830488, 'auprc': 0.999284347774062, 'loss_val': 0.08850619687259127, 'psi': 0.9874004782594541}-{'f1_val': 0.9914482382097267, 'auprc': 0.9994326138288114, 'loss_val': 0.06451277360565057, 'psi': 0.9946419884573606}
[S9] START round=35 head_norm_before_train=2.205454 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9939662133308943, 'loss_val': 0.019463482745244086, 'psi': 0.995601980091215}-{'f1_val': 0.9966857875385419, 'auprc': 0.9988220855899884, 'loss_val': 0.018521833367016276, 'psi': 0.9975403067591205}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=2.031844 cos_to_last_merge=1.0000 (last merge round=34)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.993456571603148, 'loss_val': 0.037869203451563554, 'psi': 0.9945765009794973}-{'f1_val': 0.9953231205637304, 'auprc': 0.9958747027045972, 'loss_val': 0.03709211101687577, 'psi': 0.9955437534200771}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=2.028133 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9953632585843827, 'auprc': 0.9981914121261558, 'loss_val': 0.035562636484235105, 'psi': 0.996494520001092}-{'f1_val': 0.996567470639547, 'auprc': 0.9982411845578194, 'loss_val': 0.025372748030153318, 'psi': 0.9972369562068559}
[S13] START round=35 head_norm_before_train=1.940669 cos_to_last_merge=1.0000 (last merge round=34)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5533642372618508, 'auprc': 0.6905065406304186, 'loss_val': 0.837788980884832, 'psi': 0.608221158609278}-{'f1_val': 0.5916469131058018, 'auprc': 0.675954362330857, 'loss_val': 0.6660977252592339, 'psi': 0.6253698927958239}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.977134 cos_to_last_merge=0.9999 (last merge round=33)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9970842644973595, 'auprc': 0.9991721831534561, 'loss_val': 0.03560418472673603, 'psi': 0.9979194319597982}-{'f1_val': 0.9976943331204965, 'auprc': 0.9991705044297156, 'loss_val': 0.03878831681387645, 'psi': 0.9982848016441841}
[S15] START round=35 head_norm_before_train=1.575074 cos_to_last_merge=0.9695 (last merge round=30)
[S15] round=35 local utility u=0.278941 metrics={'f1_val': 0.9342321065629388, 'auprc': 0.9967211052569084, 'loss_val': 0.09925983815416418, 'psi': 0.9592277060405265}-{'f1_val': 0.870658071739961, 'auprc': 0.9901957747753674, 'loss_val': 0.2561209369098837, 'psi': 0.9184731529541235}
[S16] START round=35 head_norm_before_train=1.447729 cos_to_last_merge=0.9995 (last merge round=32)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9926032220843122, 'auprc': 0.9976182758172096, 'loss_val': 0.06147481119452687, 'psi': 0.9946092435774712}-{'f1_val': 0.9918242256299163, 'auprc': 0.9986996304901056, 'loss_val': 0.05958785889505621, 'psi': 0.9945743875739921}
[S17] START round=35 head_norm_before_train=1.957149 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.5805181359713059, 'auprc': 0.7463531160873124, 'loss_val': 1.1109789246860367, 'psi': 0.6468521280177084}-{'f1_val': 0.5783349747113331, 'auprc': 0.7715678172297704, 'loss_val': 1.0607267835645977, 'psi': 0.655628111718708}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:50305
[S15] sending update (kind=head size=1803 to 1 peers)
[S14] ⇄ pheromone p=0.027 → S13@127.0.0.1:50313
[S3] ⇄ pheromone p=0.031 → S6@127.0.0.1:50307
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] ⇄ pheromone p=0.013 → S10@127.0.0.1:50311
[S17] ⇄ pheromone p=0.071 → S14@127.0.0.1:50314
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=35 metric=0.9926 head_norm=1.467285
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.071094e-01
[S16] stored merged vector for next round verification (round=35)
[S16] DEBUG after merge:  round=35 metric=0.9926 head_norm=1.480259 delta_norm=0.107109
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.155 → S4@127.0.0.1:50304
[S6] sending update (kind=head size=1796 to 1 peers)
[S8] ⇄ pheromone p=0.011 → S16@127.0.0.1:50316
[S7] not sending this round → trigger blocked (psi=0.715)
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.627169)
[S7] loaded HEAD from S15 (vec_in norm=1.627169)
[S7] cosine check vs S15: cos=0.9444
[S7] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=2.264891)
[S3] loaded HEAD from S6 (vec_in norm=2.264891)
[S3] cosine check vs S6: cos=0.9998
[S3] BUFFERED delta from S6 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.688590)
[S5] loaded HEAD from S2 (vec_in norm=1.688590)
[S5] cosine check vs S2: cos=0.9977
[S5] BUFFERED delta from S2 (total buffered=1)
[S6] ⇄ pheromone p=0.371 → S3@127.0.0.1:50303
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=35 metric=0.9342 head_norm=1.627169
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.716300e-01
[S15] stored merged vector for next round verification (round=35)
[S15] DEBUG after merge:  round=35 metric=0.9358 head_norm=1.505974 delta_norm=0.271630
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.208 → S7@127.0.0.1:50308
[S2] ⇄ pheromone p=0.228 → S5@127.0.0.1:50305
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.6460 head_norm=1.442105
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.716649e-01
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.6576 head_norm=1.513232 delta_norm=0.271665
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.154 → S15@127.0.0.1:50315
[S2] START round=36 head_norm_before_train=1.688590 cos_to_last_merge=0.9986 (last merge round=32)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.7161788435149609, 'auprc': 0.8413246247665692, 'loss_val': 0.7657852104007311, 'psi': 0.7662371560156043}-{'f1_val': 0.726429626124175, 'auprc': 0.8415461161370195, 'loss_val': 0.6078222627800686, 'psi': 0.7724762221293129}
[S3] START round=36 head_norm_before_train=2.271610 cos_to_last_merge=0.9999 (last merge round=32)
[S3] round=36 local utility u=0.056449 metrics={'f1_val': 0.9851894697234876, 'auprc': 0.9969454349835714, 'loss_val': 0.06055059058254146, 'psi': 0.9898918558275211}-{'f1_val': 0.9706621159647217, 'auprc': 0.9971621173488076, 'loss_val': 0.08693505182922037, 'psi': 0.981262116518356}
[S4] START round=36 head_norm_before_train=1.455854 cos_to_last_merge=0.9999 (last merge round=34)
[S4] round=36 local utility u=0.030008 metrics={'f1_val': 0.9421909372409631, 'auprc': 0.9496731481469315, 'loss_val': 0.28919265894316, 'psi': 0.9451838216033506}-{'f1_val': 0.9386579716470154, 'auprc': 0.9465907746898745, 'loss_val': 0.31876362475549536, 'psi': 0.9418310928641591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=36 head_norm_before_train=1.694008 cos_to_last_merge=0.9990 (last merge round=32)
[S5] round=36 local utility u=0.007291 metrics={'f1_val': 0.9961867794578795, 'auprc': 0.9935549555978088, 'loss_val': 0.06962332860742892, 'psi': 0.9951340499138512}-{'f1_val': 0.9964794802860635, 'auprc': 0.9921767330257277, 'loss_val': 0.0818262280020275, 'psi': 0.9947583813819292}
[S5] not sending this round → trigger blocked (psi=0.995)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=36 metric=0.9962 head_norm=1.703519
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.202431e-02
[S5] stored merged vector for next round verification (round=36)
[S5] DEBUG after merge:  round=36 metric=0.9962 head_norm=1.694937 delta_norm=0.062024
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] START round=36 head_norm_before_train=2.264891 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.6908398431782886, 'auprc': 0.8921319677430348, 'loss_val': 0.6938779065218591, 'psi': 0.7713566930041871}-{'f1_val': 0.9432527354440734, 'auprc': 0.981521808849382, 'loss_val': 0.21397760567709123, 'psi': 0.9585603648061969}
[S7] START round=36 head_norm_before_train=1.513232 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.591584101973571, 'auprc': 0.7959845947685199, 'loss_val': 0.787538584217607, 'psi': 0.6733442990915506}-{'f1_val': 0.6459653518433182, 'auprc': 0.819284999373781, 'loss_val': 0.4605518664582083, 'psi': 0.7152932108555032}
[S8] START round=36 head_norm_before_train=1.527268 cos_to_last_merge=0.9952 (last merge round=31)
[S8] round=36 local utility u=0.049589 metrics={'f1_val': 0.9928159069878363, 'auprc': 0.9934874368087043, 'loss_val': 0.051964655938682686, 'psi': 0.9930845189161834}-{'f1_val': 0.9794778985830488, 'auprc': 0.999284347774062, 'loss_val': 0.08850619687259127, 'psi': 0.9874004782594541}
[S9] START round=36 head_norm_before_train=2.211664 (no previous merge yet)
[S9] round=36 local utility u=0.007984 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9988254490380801, 'loss_val': 0.01805327692819993, 'psi': 0.9975436685939352}-{'f1_val': 0.9966924912647621, 'auprc': 0.9939662133308943, 'loss_val': 0.019463482745244086, 'psi': 0.995601980091215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=36 head_norm_before_train=2.042980 cos_to_last_merge=1.0000 (last merge round=34)
[S10] round=36 local utility u=0.003529 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.996745907079485, 'loss_val': 0.03672625777975558, 'psi': 0.9954969958374438}-{'f1_val': 0.9953231205637304, 'auprc': 0.993456571603148, 'loss_val': 0.037869203451563554, 'psi': 0.9945765009794973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=36 head_norm_before_train=2.037697 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=36 local utility u=0.009808 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9984436517412154, 'loss_val': 0.023928874364466377, 'psi': 0.9973179430802144}-{'f1_val': 0.9953632585843827, 'auprc': 0.9981914121261558, 'loss_val': 0.035562636484235105, 'psi': 0.996494520001092}
[S13] START round=36 head_norm_before_train=1.950502 cos_to_last_merge=1.0000 (last merge round=34)
[S13] round=36 local utility u=0.135958 metrics={'f1_val': 0.5998838502264823, 'auprc': 0.6659854988783943, 'loss_val': 0.7714278374588309, 'psi': 0.6263245096872471}-{'f1_val': 0.5533642372618508, 'auprc': 0.6905065406304186, 'loss_val': 0.837788980884832, 'psi': 0.608221158609278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=36 head_norm_before_train=1.993059 cos_to_last_merge=0.9998 (last merge round=33)
[S14] round=36 local utility u=0.000398 metrics={'f1_val': 0.9970569010868009, 'auprc': 0.9991312104267901, 'loss_val': 0.03452030017321566, 'psi': 0.9978866248227966}-{'f1_val': 0.9970842644973595, 'auprc': 0.9991721831534561, 'loss_val': 0.03560418472673603, 'psi': 0.9979194319597982}
[S15] START round=36 head_norm_before_train=1.505974 cos_to_last_merge=1.0000 (last merge round=35)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.8934936190873561, 'auprc': 0.9929563747351079, 'loss_val': 0.2070811813916015, 'psi': 0.9332787213464568}-{'f1_val': 0.9342321065629388, 'auprc': 0.9967211052569084, 'loss_val': 0.09925983815416418, 'psi': 0.9592277060405265}
[S16] START round=36 head_norm_before_train=1.480259 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=36 local utility u=0.004065 metrics={'f1_val': 0.9922353369773327, 'auprc': 0.9983923182756651, 'loss_val': 0.05345949426927443, 'psi': 0.9946981294966657}-{'f1_val': 0.9926032220843122, 'auprc': 0.9976182758172096, 'loss_val': 0.06147481119452687, 'psi': 0.9946092435774712}
[S17] START round=36 head_norm_before_train=1.972421 cos_to_last_merge=0.9998 (last merge round=33)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5721401371038632, 'auprc': 0.7570261819358883, 'loss_val': 1.1988297529144487, 'psi': 0.6460945550366732}-{'f1_val': 0.5805181359713059, 'auprc': 0.7463531160873124, 'loss_val': 1.1109789246860367, 'psi': 0.6468521280177084}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:50304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:50313
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:50316
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:50311
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:50307
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.549960)
[S16] loaded HEAD from S8 (vec_in norm=1.549960)
[S16] cosine check vs S8: cos=0.9950
[S16] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1796) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.280893)
[S6] loaded HEAD from S3 (vec_in norm=2.280893)
[S6] cosine check vs S3: cos=0.9996
[S6] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.499623)
[S4] loaded HEAD from S16 (vec_in norm=1.499623)
[S4] cosine check vs S16: cos=0.9922
[S4] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S14
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.009682)
[S13] loaded HEAD from S14 (vec_in norm=2.009682)
[S13] cosine check vs S14: cos=0.9964
[S13] BUFFERED delta from S14 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1795) from S11
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.047632)
[S10] loaded HEAD from S11 (vec_in norm=2.047632)
[S10] cosine check vs S11: cos=0.9996
[S10] BUFFERED delta from S11 (total buffered=1)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.9922 head_norm=1.499623
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.025370e-02
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.9922 head_norm=1.522886 delta_norm=0.080254
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=36 metric=0.9852 head_norm=2.280893
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.763878e-02
[S3] stored merged vector for next round verification (round=36)
[S3] DEBUG after merge:  round=36 metric=0.9852 head_norm=2.272738 delta_norm=0.027639
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.701109 cos_to_last_merge=0.9980 (last merge round=32)
[S2] round=37 local utility u=0.329461 metrics={'f1_val': 0.8020081925417719, 'auprc': 0.8240872662752123, 'loss_val': 0.5701267567280367, 'psi': 0.810839822035148}-{'f1_val': 0.7161788435149609, 'auprc': 0.8413246247665692, 'loss_val': 0.7657852104007311, 'psi': 0.7662371560156043}
[S3] START round=37 head_norm_before_train=2.272738 cos_to_last_merge=1.0000 (last merge round=36)
[S3] round=37 local utility u=0.043061 metrics={'f1_val': 0.9940935351656541, 'auprc': 0.9974385302776156, 'loss_val': 0.029333128807570358, 'psi': 0.9954315332104388}-{'f1_val': 0.9851894697234876, 'auprc': 0.9969454349835714, 'loss_val': 0.06055059058254146, 'psi': 0.9898918558275211}
[S4] START round=37 head_norm_before_train=1.473726 cos_to_last_merge=0.9996 (last merge round=34)
[S4] round=37 local utility u=0.014119 metrics={'f1_val': 0.9428772979658651, 'auprc': 0.9561536944917493, 'loss_val': 0.28451352864718576, 'psi': 0.9481878565762187}-{'f1_val': 0.9421909372409631, 'auprc': 0.9496731481469315, 'loss_val': 0.28919265894316, 'psi': 0.9451838216033506}
[S4] not sending this round → trigger blocked (psi=0.948)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=37 metric=0.9429 head_norm=1.487955
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.658726e-02
[S4] stored merged vector for next round verification (round=37)
[S4] DEBUG after merge:  round=37 metric=0.9427 head_norm=1.490674 delta_norm=0.096587
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] START round=37 head_norm_before_train=1.694937 cos_to_last_merge=1.0000 (last merge round=36)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9923097168811805, 'loss_val': 0.06862270555412103, 'psi': 0.9948115749241103}-{'f1_val': 0.9961867794578795, 'auprc': 0.9935549555978088, 'loss_val': 0.06962332860742892, 'psi': 0.9951340499138512}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=2.272365 cos_to_last_merge=0.9999 (last merge round=34)
[S6] round=37 local utility u=0.116073 metrics={'f1_val': 0.7358649541350675, 'auprc': 0.8809821230997246, 'loss_val': 0.6984327892223812, 'psi': 0.7939118217209303}-{'f1_val': 0.6908398431782886, 'auprc': 0.8921319677430348, 'loss_val': 0.6938779065218591, 'psi': 0.7713566930041871}
[S7] START round=37 head_norm_before_train=1.525270 cos_to_last_merge=0.9999 (last merge round=35)
[S7] round=37 local utility u=0.179678 metrics={'f1_val': 0.5901867156432656, 'auprc': 0.8370845789583128, 'loss_val': 0.5430977515779075, 'psi': 0.6889458609692845}-{'f1_val': 0.591584101973571, 'auprc': 0.7959845947685199, 'loss_val': 0.787538584217607, 'psi': 0.6733442990915506}
[S8] START round=37 head_norm_before_train=1.549960 cos_to_last_merge=0.9938 (last merge round=31)
[S8] round=37 local utility u=0.001057 metrics={'f1_val': 0.9903754849676576, 'auprc': 0.9993807452328871, 'loss_val': 0.052887219750505775, 'psi': 0.9939775890737494}-{'f1_val': 0.9928159069878363, 'auprc': 0.9934874368087043, 'loss_val': 0.051964655938682686, 'psi': 0.9930845189161834}
[S9] START round=37 head_norm_before_train=2.217227 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9976563124698973, 'loss_val': 0.01823663633679761, 'psi': 0.9973242724952446}-{'f1_val': 0.9966891482978385, 'auprc': 0.9988254490380801, 'loss_val': 0.01805327692819993, 'psi': 0.9975436685939352}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=2.053614 cos_to_last_merge=0.9999 (last merge round=34)
[S10] round=37 local utility u=0.000299 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9966941987807418, 'loss_val': 0.03597352274737197, 'psi': 0.9954763125179467}-{'f1_val': 0.9946643883427498, 'auprc': 0.996745907079485, 'loss_val': 0.03672625777975558, 'psi': 0.9954969958374438}
[S10] not sending this round → trigger blocked (psi=0.995)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=37 metric=0.9947 head_norm=2.063748
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.361727e-02
[S10] stored merged vector for next round verification (round=37)
[S10] DEBUG after merge:  round=37 metric=0.9947 head_norm=2.055431 delta_norm=0.033617
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] START round=37 head_norm_before_train=2.047632 cos_to_last_merge=0.9999 (last merge round=33)
[S11] round=37 local utility u=0.000170 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983646697744255, 'loss_val': 0.02335211870656912, 'psi': 0.9972863502934984}-{'f1_val': 0.996567470639547, 'auprc': 0.9984436517412154, 'loss_val': 0.023928874364466377, 'psi': 0.9973179430802144}
[S13] START round=37 head_norm_before_train=1.963373 cos_to_last_merge=0.9998 (last merge round=34)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5897797455509143, 'auprc': 0.6839627413085333, 'loss_val': 0.8199024360913458, 'psi': 0.6274529438539619}-{'f1_val': 0.5998838502264823, 'auprc': 0.6659854988783943, 'loss_val': 0.7714278374588309, 'psi': 0.6263245096872471}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=37 metric=0.5898 head_norm=1.973211
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.289035e-02
[S13] stored merged vector for next round verification (round=37)
[S13] DEBUG after merge:  round=37 metric=0.5875 head_norm=1.989363 delta_norm=0.092890
[S13] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] START round=37 head_norm_before_train=2.009682 cos_to_last_merge=0.9995 (last merge round=33)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9627299639340425, 'auprc': 0.9990087224419243, 'loss_val': 0.05994806329007714, 'psi': 0.9772414673371952}-{'f1_val': 0.9970569010868009, 'auprc': 0.9991312104267901, 'loss_val': 0.03452030017321566, 'psi': 0.9978866248227966}
[S15] START round=37 head_norm_before_train=1.552564 cos_to_last_merge=0.9995 (last merge round=35)
[S15] round=37 local utility u=0.216820 metrics={'f1_val': 0.9456900769083229, 'auprc': 0.9959638186813162, 'loss_val': 0.0956419286347337, 'psi': 0.9657995736175202}-{'f1_val': 0.8934936190873561, 'auprc': 0.9929563747351079, 'loss_val': 0.2070811813916015, 'psi': 0.9332787213464568}
[S16] START round=37 head_norm_before_train=1.522886 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.002420 metrics={'f1_val': 0.9922353369773327, 'auprc': 0.9985497919189251, 'loss_val': 0.049091194880022594, 'psi': 0.9947611189539697}-{'f1_val': 0.9922353369773327, 'auprc': 0.9983923182756651, 'loss_val': 0.05345949426927443, 'psi': 0.9946981294966657}
[S17] START round=37 head_norm_before_train=1.989882 cos_to_last_merge=0.9995 (last merge round=33)
[S17] round=37 local utility u=0.110745 metrics={'f1_val': 0.5824561270803477, 'auprc': 0.8001516315670185, 'loss_val': 1.1686127212016737, 'psi': 0.669534328875016}-{'f1_val': 0.5721401371038632, 'auprc': 0.7570261819358883, 'loss_val': 1.1988297529144487, 'psi': 0.6460945550366732}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:50303
[S11] not sending this round → trigger blocked (psi=0.997)
[S3] not sending this round → trigger blocked (psi=0.995)
[S8] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:50314
[S16] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:50305
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:50315
[S6] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.005537)
[S14] loaded HEAD from S17 (vec_in norm=2.005537)
[S14] cosine check vs S17: cos=0.9991
[S14] BUFFERED delta from S17 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1805) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.599265)
[S7] loaded HEAD from S15 (vec_in norm=1.599265)
[S7] cosine check vs S15: cos=0.9976
[S7] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.711973)
[S5] loaded HEAD from S2 (vec_in norm=1.711973)
[S5] cosine check vs S2: cos=0.9985
[S5] BUFFERED delta from S2 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=2.280530)
[S3] loaded HEAD from S6 (vec_in norm=2.280530)
[S3] cosine check vs S6: cos=0.9998
[S3] BUFFERED delta from S6 (total buffered=1)
[S7] sending update (kind=head size=1804 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=37 metric=0.7359 head_norm=2.280530
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.637429e-02
[S6] stored merged vector for next round verification (round=37)
[S6] DEBUG after merge:  round=37 metric=0.7354 head_norm=2.280422 delta_norm=0.036374
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1804) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.536892)
[S15] loaded HEAD from S7 (vec_in norm=1.536892)
[S15] cosine check vs S7: cos=0.9976
[S15] BUFFERED delta from S7 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.5902 head_norm=1.536892
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.251645e-02
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.5919 head_norm=1.567142 delta_norm=0.062516
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.711973 cos_to_last_merge=0.9976 (last merge round=32)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6998653558548065, 'auprc': 0.8212740341420439, 'loss_val': 0.6213468412300945, 'psi': 0.7484288271697015}-{'f1_val': 0.8020081925417719, 'auprc': 0.8240872662752123, 'loss_val': 0.5701267567280367, 'psi': 0.810839822035148}
[S3] START round=38 head_norm_before_train=2.284424 cos_to_last_merge=1.0000 (last merge round=36)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9033766609085973, 'auprc': 0.9632851740133979, 'loss_val': 0.28858056743091237, 'psi': 0.9273400661505176}-{'f1_val': 0.9940935351656541, 'auprc': 0.9974385302776156, 'loss_val': 0.029333128807570358, 'psi': 0.9954315332104388}
[S4] START round=38 head_norm_before_train=1.490674 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9419707243424481, 'auprc': 0.9552922122177482, 'loss_val': 0.28402965548598136, 'psi': 0.9472993194925681}-{'f1_val': 0.9428772979658651, 'auprc': 0.9561536944917493, 'loss_val': 0.28451352864718576, 'psi': 0.9481878565762187}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.713622 cos_to_last_merge=0.9999 (last merge round=36)
[S5] round=38 local utility u=0.011950 metrics={'f1_val': 0.9959679333721386, 'auprc': 0.9974819746218392, 'loss_val': 0.057171056284867836, 'psi': 0.996573549872019}-{'f1_val': 0.9964794802860635, 'auprc': 0.9923097168811805, 'loss_val': 0.06862270555412103, 'psi': 0.9948115749241103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.9960 head_norm=1.734496
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.745552e-02
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.9960 head_norm=1.722313 delta_norm=0.057456
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] START round=38 head_norm_before_train=2.280422 cos_to_last_merge=1.0000 (last merge round=37)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.519722905797625, 'auprc': 0.9143550869968217, 'loss_val': 0.8014142274041086, 'psi': 0.6775757782773038}-{'f1_val': 0.7358649541350675, 'auprc': 0.8809821230997246, 'loss_val': 0.6984327892223812, 'psi': 0.7939118217209303}
[S7] START round=38 head_norm_before_train=1.567142 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5214515434317875, 'auprc': 0.7817630482117243, 'loss_val': 1.249898096290194, 'psi': 0.6255761453437623}-{'f1_val': 0.5901867156432656, 'auprc': 0.8370845789583128, 'loss_val': 0.5430977515779075, 'psi': 0.6889458609692845}
[S8] START round=38 head_norm_before_train=1.571563 cos_to_last_merge=0.9925 (last merge round=31)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9878661038880452, 'auprc': 0.9994742974405011, 'loss_val': 0.056294545203685736, 'psi': 0.9925093813090275}-{'f1_val': 0.9903754849676576, 'auprc': 0.9993807452328871, 'loss_val': 0.052887219750505775, 'psi': 0.9939775890737494}
[S9] START round=38 head_norm_before_train=2.225288 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9946818011756094, 'loss_val': 0.019283985203858496, 'psi': 0.9958882152291011}-{'f1_val': 0.9971029125121428, 'auprc': 0.9976563124698973, 'loss_val': 0.01823663633679761, 'psi': 0.9973242724952446}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=2.055431 cos_to_last_merge=1.0000 (last merge round=37)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9931968162138346, 'loss_val': 0.03532262581205833, 'psi': 0.994472598823772}-{'f1_val': 0.9946643883427498, 'auprc': 0.9966941987807418, 'loss_val': 0.03597352274737197, 'psi': 0.9954763125179467}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=2.057735 cos_to_last_merge=0.9998 (last merge round=33)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9969028898135537, 'loss_val': 0.023079248622211092, 'psi': 0.9964536407718687}-{'f1_val': 0.996567470639547, 'auprc': 0.9983646697744255, 'loss_val': 0.02335211870656912, 'psi': 0.9972863502934984}
[S13] START round=38 head_norm_before_train=1.989363 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.48941823707912246, 'auprc': 0.6860853201010211, 'loss_val': 0.8059784974332107, 'psi': 0.5680850702878819}-{'f1_val': 0.5897797455509143, 'auprc': 0.6839627413085333, 'loss_val': 0.8199024360913458, 'psi': 0.6274529438539619}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=2.021528 cos_to_last_merge=0.9993 (last merge round=33)
[S14] round=38 local utility u=0.113961 metrics={'f1_val': 0.9970340443882946, 'auprc': 0.9987806318855446, 'loss_val': 0.03716631051950526, 'psi': 0.9977326793871946}-{'f1_val': 0.9627299639340425, 'auprc': 0.9990087224419243, 'loss_val': 0.05994806329007714, 'psi': 0.9772414673371952}
[S15] START round=38 head_norm_before_train=1.599265 cos_to_last_merge=0.9983 (last merge round=35)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.9136481870306838, 'auprc': 0.9964572197346133, 'loss_val': 0.13158845696489407, 'psi': 0.9467718001122556}-{'f1_val': 0.9456900769083229, 'auprc': 0.9959638186813162, 'loss_val': 0.0956419286347337, 'psi': 0.9657995736175202}
[S16] START round=38 head_norm_before_train=1.539210 cos_to_last_merge=0.9999 (last merge round=36)
[S16] round=38 local utility u=0.000707 metrics={'f1_val': 0.9918242256299163, 'auprc': 0.9988588404768929, 'loss_val': 0.04613672505646599, 'psi': 0.9946380715687069}-{'f1_val': 0.9922353369773327, 'auprc': 0.9985497919189251, 'loss_val': 0.049091194880022594, 'psi': 0.9947611189539697}
[S17] START round=38 head_norm_before_train=2.005537 cos_to_last_merge=0.9991 (last merge round=33)
[S17] round=38 local utility u=0.123359 metrics={'f1_val': 0.5955939994402626, 'auprc': 0.8334026491879722, 'loss_val': 1.1004742078452845, 'psi': 0.6907174593393465}-{'f1_val': 0.5824561270803477, 'auprc': 0.8001516315670185, 'loss_val': 1.1686127212016737, 'psi': 0.669534328875016}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.691)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=38 metric=0.9970 head_norm=2.033538
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.955875e-02
[S14] stored merged vector for next round verification (round=38)
[S14] DEBUG after merge:  round=38 metric=0.9970 head_norm=2.018978 delta_norm=0.049559
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=38 metric=0.9034 head_norm=2.293086
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.771153e-02
[S3] stored merged vector for next round verification (round=38)
[S3] DEBUG after merge:  round=38 metric=0.9021 head_norm=2.286649 delta_norm=0.027712
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.9136 head_norm=1.641995
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.861873e-02
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.9136 head_norm=1.587841 delta_norm=0.088619
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.723310 cos_to_last_merge=0.9971 (last merge round=32)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6643241283282246, 'auprc': 0.7555821559174858, 'loss_val': 1.3121666095172253, 'psi': 0.700827339363929}-{'f1_val': 0.6998653558548065, 'auprc': 0.8212740341420439, 'loss_val': 0.6213468412300945, 'psi': 0.7484288271697015}
[S3] START round=39 head_norm_before_train=2.286649 cos_to_last_merge=1.0000 (last merge round=38)
[S3] round=39 local utility u=0.372598 metrics={'f1_val': 0.976787990604455, 'auprc': 0.9974118451323938, 'loss_val': 0.08623284344057278, 'psi': 0.9850375324156305}-{'f1_val': 0.9033766609085973, 'auprc': 0.9632851740133979, 'loss_val': 0.28858056743091237, 'psi': 0.9273400661505176}
[S4] START round=39 head_norm_before_train=1.507670 cos_to_last_merge=0.9999 (last merge round=37)
[S4] round=39 local utility u=0.026191 metrics={'f1_val': 0.9478419865072862, 'auprc': 0.9573515934919199, 'loss_val': 0.2730532522500273, 'psi': 0.9516458293011397}-{'f1_val': 0.9419707243424481, 'auprc': 0.9552922122177482, 'loss_val': 0.28402965548598136, 'psi': 0.9472993194925681}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S4] r=40 psi=0.952 u=0.0262 p_local=0.0153 f1=0.948 auprc=0.957 bytes=34159
[S5] START round=39 head_norm_before_train=1.722313 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.994619022498691, 'loss_val': 0.05539661640154116, 'psi': 0.9957352971711145}-{'f1_val': 0.9959679333721386, 'auprc': 0.9974819746218392, 'loss_val': 0.057171056284867836, 'psi': 0.996573549872019}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.996 u=0.0000 p_local=0.1490 f1=0.996 auprc=0.995 bytes=35995
[S6] START round=39 head_norm_before_train=2.286146 cos_to_last_merge=1.0000 (last merge round=37)
[S6] round=39 local utility u=0.770041 metrics={'f1_val': 0.7593282058308559, 'auprc': 0.8939329484880091, 'loss_val': 0.6376967066657353, 'psi': 0.8131701028937173}-{'f1_val': 0.519722905797625, 'auprc': 0.9143550869968217, 'loss_val': 0.8014142274041086, 'psi': 0.6775757782773038}
[S7] START round=39 head_norm_before_train=1.578383 cos_to_last_merge=0.9999 (last merge round=37)
[S7] round=39 local utility u=0.523362 metrics={'f1_val': 0.5865341595158855, 'auprc': 0.8062601780374694, 'loss_val': 0.6671617590232715, 'psi': 0.674424566924519}-{'f1_val': 0.5214515434317875, 'auprc': 0.7817630482117243, 'loss_val': 1.249898096290194, 'psi': 0.6255761453437623}
[S8] START round=39 head_norm_before_train=1.594108 cos_to_last_merge=0.9911 (last merge round=31)
[S8] round=39 local utility u=0.019921 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.9954283092426572, 'loss_val': 0.0439207189483258, 'psi': 0.9948516448785001}-{'f1_val': 0.9878661038880452, 'auprc': 0.9994742974405011, 'loss_val': 0.056294545203685736, 'psi': 0.9925093813090275}
[S9] START round=39 head_norm_before_train=2.233223 (no previous merge yet)
[S9] round=39 local utility u=0.008132 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9988221638752524, 'loss_val': 0.01788635512496145, 'psi': 0.9977888952736389}-{'f1_val': 0.9966924912647621, 'auprc': 0.9946818011756094, 'loss_val': 0.019283985203858496, 'psi': 0.9958882152291011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S9] r=40 psi=0.998 u=0.0081 p_local=0.0034 f1=0.997 auprc=0.999 bytes=37739
[S10] START round=39 head_norm_before_train=2.066297 cos_to_last_merge=1.0000 (last merge round=37)
[S10] round=39 local utility u=0.000886 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9950393812066693, 'loss_val': 0.035125875384028275, 'psi': 0.9948143854883176}-{'f1_val': 0.9953231205637304, 'auprc': 0.9931968162138346, 'loss_val': 0.03532262581205833, 'psi': 0.994472598823772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S10] r=40 psi=0.995 u=0.0009 p_local=0.0031 f1=0.995 auprc=0.995 bytes=44936
[S11] START round=39 head_norm_before_train=2.063664 cos_to_last_merge=0.9997 (last merge round=33)
[S11] round=39 local utility u=0.000607 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9968248706738339, 'loss_val': 0.024132962754078828, 'psi': 0.9966726971368083}-{'f1_val': 0.9961541414107454, 'auprc': 0.9969028898135537, 'loss_val': 0.023079248622211092, 'psi': 0.9964536407718687}
[S13] START round=39 head_norm_before_train=1.997668 cos_to_last_merge=0.9999 (last merge round=37)
[S13] round=39 local utility u=0.292364 metrics={'f1_val': 0.5875490253875891, 'auprc': 0.684037097788261, 'loss_val': 0.8038915401317425, 'psi': 0.6261442543478579}-{'f1_val': 0.48941823707912246, 'auprc': 0.6860853201010211, 'loss_val': 0.8059784974332107, 'psi': 0.5680850702878819}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S13] r=40 psi=0.626 u=0.2924 p_local=0.0957 f1=0.588 auprc=0.684 bytes=32320
[S14] START round=39 head_norm_before_train=2.018978 cos_to_last_merge=1.0000 (last merge round=38)
[S14] round=39 local utility u=0.003615 metrics={'f1_val': 0.9970842644973595, 'auprc': 0.9989955240615132, 'loss_val': 0.030881538223956215, 'psi': 0.997848768323021}-{'f1_val': 0.9970340443882946, 'auprc': 0.9987806318855446, 'loss_val': 0.03716631051950526, 'psi': 0.9977326793871946}
[S15] START round=39 head_norm_before_train=1.587841 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.8751297256672069, 'auprc': 0.994900280307645, 'loss_val': 0.26126735056594164, 'psi': 0.9230379475233822}-{'f1_val': 0.9136481870306838, 'auprc': 0.9964572197346133, 'loss_val': 0.13158845696489407, 'psi': 0.9467718001122556}
[S16] START round=39 head_norm_before_train=1.555221 cos_to_last_merge=0.9998 (last merge round=36)
[S16] round=39 local utility u=0.000841 metrics={'f1_val': 0.9925136343127123, 'auprc': 0.9968312685177011, 'loss_val': 0.04250789518834195, 'psi': 0.9942406879947078}-{'f1_val': 0.9918242256299163, 'auprc': 0.9988588404768929, 'loss_val': 0.04613672505646599, 'psi': 0.9946380715687069}
[S17] START round=39 head_norm_before_train=2.018758 cos_to_last_merge=0.9986 (last merge round=33)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.5534634404238994, 'auprc': 0.7848385441851671, 'loss_val': 1.344800256206184, 'psi': 0.6460134819284065}-{'f1_val': 0.5955939994402626, 'auprc': 0.8334026491879722, 'loss_val': 1.1004742078452845, 'psi': 0.6907174593393465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:50307
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:50303
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1795 to 1 peers)
[S17] r=40 psi=0.646 u=0.0000 p_local=0.0631 f1=0.553 auprc=0.785 bytes=32378
[S6] sending update (kind=head size=1800 to 1 peers)
[S14] r=40 psi=0.998 u=0.0036 p_local=0.0302 f1=0.997 auprc=0.999 bytes=41341
[S16] r=40 psi=0.994 u=0.0008 p_local=0.0644 f1=0.993 auprc=0.997 bytes=37758
[S11] r=40 psi=0.997 u=0.0006 p_local=0.0063 f1=0.997 auprc=0.997 bytes=46705
[S2] r=40 psi=0.701 u=0.0000 p_local=0.1357 f1=0.664 auprc=0.756 bytes=37768
[S8] r=40 psi=0.995 u=0.0199 p_local=0.0135 f1=0.994 auprc=0.995 bytes=41374
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:50315
[S15] r=40 psi=0.923 u=0.0000 p_local=0.1131 f1=0.875 auprc=0.995 bytes=32395
[S3] RECEIVED delta(kind=head bytes=1800) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=2.292752)
[S3] loaded HEAD from S6 (vec_in norm=2.292752)
[S3] cosine check vs S6: cos=0.9999
[S3] BUFFERED delta from S6 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1795) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.295478)
[S6] loaded HEAD from S3 (vec_in norm=2.295478)
[S6] cosine check vs S3: cos=0.9999
[S6] BUFFERED delta from S3 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=39 metric=0.9768 head_norm=2.295478
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.221624e-02
[S3] stored merged vector for next round verification (round=39)
[S3] DEBUG after merge:  round=39 metric=0.9769 head_norm=2.294083 delta_norm=0.012216
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] r=40 psi=0.985 u=0.3726 p_local=0.0985 f1=0.977 auprc=0.997 bytes=35972
[S7] sending update (kind=head size=1797 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=39 metric=0.7593 head_norm=2.292752
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.221623e-02
[S6] stored merged vector for next round verification (round=39)
[S6] DEBUG after merge:  round=39 metric=0.7604 head_norm=2.294083 delta_norm=0.012216
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] r=40 psi=0.813 u=0.7700 p_local=0.3207 f1=0.759 auprc=0.894 bytes=32354
[S15] RECEIVED delta(kind=head bytes=1797) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.584766)
[S15] loaded HEAD from S7 (vec_in norm=1.584766)
[S15] cosine check vs S7: cos=0.9993
[S15] BUFFERED delta from S7 (total buffered=1)
[S7] r=40 psi=0.674 u=0.5234 p_local=0.1906 f1=0.587 auprc=0.806 bytes=34178
[S2] START round=40 head_norm_before_train=1.732320 cos_to_last_merge=0.9967 (last merge round=32)
[S2] round=40 local utility u=0.654207 metrics={'f1_val': 0.7135727659714186, 'auprc': 0.8585376402430935, 'loss_val': 0.6081099399266906, 'psi': 0.7715587156800886}-{'f1_val': 0.6643241283282246, 'auprc': 0.7555821559174858, 'loss_val': 1.3121666095172253, 'psi': 0.700827339363929}
[S3] START round=40 head_norm_before_train=2.294083 cos_to_last_merge=1.0000 (last merge round=39)
[S3] round=40 local utility u=0.015151 metrics={'f1_val': 0.9791256750093423, 'auprc': 0.9974636918323154, 'loss_val': 0.07011190002253334, 'psi': 0.9864608817385315}-{'f1_val': 0.976787990604455, 'auprc': 0.9974118451323938, 'loss_val': 0.08623284344057278, 'psi': 0.9850375324156305}
[S4] START round=40 head_norm_before_train=1.522629 cos_to_last_merge=0.9998 (last merge round=37)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9400503480225411, 'auprc': 0.9533588101986574, 'loss_val': 0.2980752153054276, 'psi': 0.9453737328929877}-{'f1_val': 0.9478419865072862, 'auprc': 0.9573515934919199, 'loss_val': 0.2730532522500273, 'psi': 0.9516458293011397}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.749151 cos_to_last_merge=0.9998 (last merge round=38)
[S5] round=40 local utility u=0.004188 metrics={'f1_val': 0.9959679333721386, 'auprc': 0.996865232887409, 'loss_val': 0.05069084713628622, 'psi': 0.9963268531782468}-{'f1_val': 0.9964794802860635, 'auprc': 0.994619022498691, 'loss_val': 0.05539661640154116, 'psi': 0.9957352971711145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=40 head_norm_before_train=2.294083 cos_to_last_merge=1.0000 (last merge round=39)
[S6] round=40 local utility u=0.126120 metrics={'f1_val': 0.7707619011307159, 'auprc': 0.9274589087395496, 'loss_val': 0.5546372263548424, 'psi': 0.8334407041742493}-{'f1_val': 0.7593282058308559, 'auprc': 0.8939329484880091, 'loss_val': 0.6376967066657353, 'psi': 0.8131701028937173}
[S7] START round=40 head_norm_before_train=1.584766 cos_to_last_merge=0.9999 (last merge round=37)
[S7] round=40 local utility u=1.000000 metrics={'f1_val': 0.8721058746015575, 'auprc': 0.9900789935216582, 'loss_val': 0.38350770213331503, 'psi': 0.9192951221695977}-{'f1_val': 0.5865341595158855, 'auprc': 0.8062601780374694, 'loss_val': 0.6671617590232715, 'psi': 0.674424566924519}
[S8] START round=40 head_norm_before_train=1.614233 cos_to_last_merge=0.9897 (last merge round=31)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9680706206070446, 'auprc': 0.9992171581784757, 'loss_val': 0.09926098286891653, 'psi': 0.980529235635617}-{'f1_val': 0.9944672019690619, 'auprc': 0.9954283092426572, 'loss_val': 0.0439207189483258, 'psi': 0.9948516448785001}
[S9] START round=40 head_norm_before_train=2.242130 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9940569563199566, 'loss_val': 0.01837704234220874, 'psi': 0.99563827728684}-{'f1_val': 0.9971000495392299, 'auprc': 0.9988221638752524, 'loss_val': 0.01788635512496145, 'psi': 0.9977888952736389}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.077576 cos_to_last_merge=0.9999 (last merge round=37)
[S10] round=40 local utility u=0.000105 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9969060512520698, 'loss_val': 0.03525260243351031, 'psi': 0.9950346936456409}-{'f1_val': 0.9946643883427498, 'auprc': 0.9950393812066693, 'loss_val': 0.035125875384028275, 'psi': 0.9948143854883176}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=40 head_norm_before_train=2.071383 cos_to_last_merge=0.9996 (last merge round=33)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9967889342758736, 'loss_val': 0.023404634639647263, 'psi': 0.9964080585567967}-{'f1_val': 0.9965712481121245, 'auprc': 0.9968248706738339, 'loss_val': 0.024132962754078828, 'psi': 0.9966726971368083}
[S13] START round=40 head_norm_before_train=2.006073 cos_to_last_merge=0.9998 (last merge round=37)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.5830613337309934, 'auprc': 0.6438397593595788, 'loss_val': 0.8757747438654158, 'psi': 0.6073727039824276}-{'f1_val': 0.5875490253875891, 'auprc': 0.684037097788261, 'loss_val': 0.8038915401317425, 'psi': 0.6261442543478579}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=2.030001 cos_to_last_merge=1.0000 (last merge round=38)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9446126973713695, 'auprc': 0.9988081669466127, 'loss_val': 0.0693143177606805, 'psi': 0.9662908852014669}-{'f1_val': 0.9970842644973595, 'auprc': 0.9989955240615132, 'loss_val': 0.030881538223956215, 'psi': 0.997848768323021}
[S15] START round=40 head_norm_before_train=1.623621 cos_to_last_merge=0.9998 (last merge round=38)
[S15] round=40 local utility u=0.184996 metrics={'f1_val': 0.9141959226979693, 'auprc': 0.9971041554122919, 'loss_val': 0.13228317130819725, 'psi': 0.9473592157836984}-{'f1_val': 0.8751297256672069, 'auprc': 0.994900280307645, 'loss_val': 0.26126735056594164, 'psi': 0.9230379475233822}
[S16] START round=40 head_norm_before_train=1.570240 cos_to_last_merge=0.9996 (last merge round=36)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8847009565789004, 'auprc': 0.9903469008020945, 'loss_val': 0.3818387363103535, 'psi': 0.926959334268178}-{'f1_val': 0.9925136343127123, 'auprc': 0.9968312685177011, 'loss_val': 0.04250789518834195, 'psi': 0.9942406879947078}
[S17] START round=40 head_norm_before_train=2.029064 cos_to_last_merge=0.9982 (last merge round=33)
[S17] round=40 local utility u=0.486316 metrics={'f1_val': 0.6239505336928901, 'auprc': 0.8535297496159858, 'loss_val': 1.0011648952060188, 'psi': 0.7157822200621284}-{'f1_val': 0.5534634404238994, 'auprc': 0.7848385441851671, 'loss_val': 1.344800256206184, 'psi': 0.6460134819284065}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.833)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] not sending this round → trigger blocked (psi=0.986)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:50308
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S3] ⇄ pheromone p=0.082 → S6@127.0.0.1:50307
[S6] ⇄ pheromone p=0.282 → S3@127.0.0.1:50303
[S7] not sending this round → trigger blocked (psi=0.919)
[S7] RECEIVED delta(kind=head bytes=1804) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.658124)
[S7] loaded HEAD from S15 (vec_in norm=1.658124)
[S7] cosine check vs S15: cos=0.9983
[S7] BUFFERED delta from S15 (total buffered=1)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=40 metric=0.9142 head_norm=1.658124
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.708301e-02
[S15] stored merged vector for next round verification (round=40)
[S15] DEBUG after merge:  round=40 metric=0.9153 head_norm=1.620855 delta_norm=0.057083
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.127 → S7@127.0.0.1:50308
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=40 metric=0.8721 head_norm=1.595308
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.653491e-02
[S7] stored merged vector for next round verification (round=40)
[S7] DEBUG after merge:  round=40 metric=0.8667 head_norm=1.626037 delta_norm=0.056535
[S7] aggregate: ROLLBACK (f1_val pre=0.872 post=0.867 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.352 → S15@127.0.0.1:50315
[S2] START round=41 head_norm_before_train=1.740222 cos_to_last_merge=0.9965 (last merge round=32)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.7211744094542747, 'auprc': 0.7501422833313851, 'loss_val': 0.8342258488114125, 'psi': 0.7327615590051189}-{'f1_val': 0.7135727659714186, 'auprc': 0.8585376402430935, 'loss_val': 0.6081099399266906, 'psi': 0.7715587156800886}
[S3] START round=41 head_norm_before_train=2.303908 cos_to_last_merge=1.0000 (last merge round=39)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9390222394197688, 'auprc': 0.9959829888676373, 'loss_val': 0.1160578148216914, 'psi': 0.9618065391989161}-{'f1_val': 0.9791256750093423, 'auprc': 0.9974636918323154, 'loss_val': 0.07011190002253334, 'psi': 0.9864608817385315}
[S4] START round=41 head_norm_before_train=1.533592 cos_to_last_merge=0.9997 (last merge round=37)
[S4] round=41 local utility u=0.023951 metrics={'f1_val': 0.9423741079244563, 'auprc': 0.962062445022419, 'loss_val': 0.2902268467830432, 'psi': 0.9502494427636414}-{'f1_val': 0.9400503480225411, 'auprc': 0.9533588101986574, 'loss_val': 0.2980752153054276, 'psi': 0.9453737328929877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=41 head_norm_before_train=1.779884 cos_to_last_merge=0.9992 (last merge round=38)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9933630062302404, 'loss_val': 0.043626167612213405, 'psi': 0.9952328906637342}-{'f1_val': 0.9959679333721386, 'auprc': 0.996865232887409, 'loss_val': 0.05069084713628622, 'psi': 0.9963268531782468}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=2.302805 cos_to_last_merge=1.0000 (last merge round=39)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.5816938834845635, 'auprc': 0.8311169472155787, 'loss_val': 1.002721100663786, 'psi': 0.6814631089769696}-{'f1_val': 0.7707619011307159, 'auprc': 0.9274589087395496, 'loss_val': 0.5546372263548424, 'psi': 0.8334407041742493}
[S7] START round=41 head_norm_before_train=1.626037 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=41 local utility u=0.165452 metrics={'f1_val': 0.9134458244414143, 'auprc': 0.99428753701148, 'loss_val': 0.3132691341540033, 'psi': 0.9457825094694406}-{'f1_val': 0.8721058746015575, 'auprc': 0.9900789935216582, 'loss_val': 0.38350770213331503, 'psi': 0.9192951221695977}
[S8] START round=41 head_norm_before_train=1.630764 cos_to_last_merge=0.9887 (last merge round=31)
[S8] round=41 local utility u=0.082396 metrics={'f1_val': 0.9875097078386601, 'auprc': 0.9993705067881937, 'loss_val': 0.051562638304935016, 'psi': 0.9922540274184735}-{'f1_val': 0.9680706206070446, 'auprc': 0.9992171581784757, 'loss_val': 0.09926098286891653, 'psi': 0.980529235635617}
[S9] START round=41 head_norm_before_train=2.251059 (no previous merge yet)
[S9] round=41 local utility u=0.002773 metrics={'f1_val': 0.9956054446615002, 'auprc': 0.9987410150070527, 'loss_val': 0.0203613338433275, 'psi': 0.9968596727997212}-{'f1_val': 0.9966924912647621, 'auprc': 0.9940569563199566, 'loss_val': 0.01837704234220874, 'psi': 0.99563827728684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=41 head_norm_before_train=2.088924 cos_to_last_merge=0.9998 (last merge round=37)
[S10] round=41 local utility u=0.001205 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.994985875555912, 'loss_val': 0.032344844177634384, 'psi': 0.9947929832280147}-{'f1_val': 0.9937871219080217, 'auprc': 0.9969060512520698, 'loss_val': 0.03525260243351031, 'psi': 0.9950346936456409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=41 head_norm_before_train=2.080904 cos_to_last_merge=0.9995 (last merge round=33)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9949499293555814, 'auprc': 0.9968676408729925, 'loss_val': 0.032551244869452114, 'psi': 0.9957170139625459}-{'f1_val': 0.9961541414107454, 'auprc': 0.9967889342758736, 'loss_val': 0.023404634639647263, 'psi': 0.9964080585567967}
[S13] START round=41 head_norm_before_train=2.016324 cos_to_last_merge=0.9997 (last merge round=37)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.5529623196589155, 'auprc': 0.6861911700210798, 'loss_val': 0.8475507766623699, 'psi': 0.6062538598037812}-{'f1_val': 0.5830613337309934, 'auprc': 0.6438397593595788, 'loss_val': 0.8757747438654158, 'psi': 0.6073727039824276}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=2.037623 cos_to_last_merge=0.9999 (last merge round=38)
[S14] round=41 local utility u=0.177818 metrics={'f1_val': 0.9970842644973595, 'auprc': 0.9987347615332437, 'loss_val': 0.028286826907769177, 'psi': 0.9977444633117132}-{'f1_val': 0.9446126973713695, 'auprc': 0.9988081669466127, 'loss_val': 0.0693143177606805, 'psi': 0.9662908852014669}
[S15] START round=41 head_norm_before_train=1.620855 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=41 local utility u=0.225091 metrics={'f1_val': 0.9775794000968784, 'auprc': 0.9975264359637005, 'loss_val': 0.06366937967838726, 'psi': 0.9855582144436073}-{'f1_val': 0.9141959226979693, 'auprc': 0.9971041554122919, 'loss_val': 0.13228317130819725, 'psi': 0.9473592157836984}
[S16] START round=41 head_norm_before_train=1.583069 cos_to_last_merge=0.9993 (last merge round=36)
[S16] round=41 local utility u=0.505248 metrics={'f1_val': 0.9924622258652532, 'auprc': 0.9987752787750899, 'loss_val': 0.043195225444486764, 'psi': 0.994987447029188}-{'f1_val': 0.8847009565789004, 'auprc': 0.9903469008020945, 'loss_val': 0.3818387363103535, 'psi': 0.926959334268178}
[S17] START round=41 head_norm_before_train=2.037490 cos_to_last_merge=0.9979 (last merge round=33)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.569894100036502, 'auprc': 0.8234791445153684, 'loss_val': 1.3023649765276357, 'psi': 0.6713281178280486}-{'f1_val': 0.6239505336928901, 'auprc': 0.8535297496159858, 'loss_val': 1.0011648952060188, 'psi': 0.7157822200621284}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S8] sending update (kind=head size=1809 to 1 peers)
[S15] not sending this round → trigger blocked (psi=0.986)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:50315
[S7] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.636529)
[S15] loaded HEAD from S7 (vec_in norm=1.636529)
[S15] cosine check vs S7: cos=0.9997
[S15] BUFFERED delta from S7 (total buffered=1)
[S2] START round=42 head_norm_before_train=1.749129 cos_to_last_merge=0.9961 (last merge round=32)
[S2] round=42 local utility u=0.009291 metrics={'f1_val': 0.7224755743523114, 'auprc': 0.77827127018394, 'loss_val': 0.9078378440754701, 'psi': 0.7447938526849629}-{'f1_val': 0.7211744094542747, 'auprc': 0.7501422833313851, 'loss_val': 0.8342258488114125, 'psi': 0.7327615590051189}
[S3] START round=42 head_norm_before_train=2.312741 cos_to_last_merge=1.0000 (last merge round=39)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.960651231474942, 'auprc': 0.9763301045533349, 'loss_val': 0.18715296967602665, 'psi': 0.9669227807062992}-{'f1_val': 0.9390222394197688, 'auprc': 0.9959829888676373, 'loss_val': 0.1160578148216914, 'psi': 0.9618065391989161}
[S4] START round=42 head_norm_before_train=1.545220 cos_to_last_merge=0.9995 (last merge round=37)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9440084036985674, 'auprc': 0.9417005231457811, 'loss_val': 0.29500728607207055, 'psi': 0.9430852514774529}-{'f1_val': 0.9423741079244563, 'auprc': 0.962062445022419, 'loss_val': 0.2902268467830432, 'psi': 0.9502494427636414}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.804571 cos_to_last_merge=0.9985 (last merge round=38)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9927068771505783, 'loss_val': 0.04245334645350194, 'psi': 0.9949704390318694}-{'f1_val': 0.9964794802860635, 'auprc': 0.9933630062302404, 'loss_val': 0.043626167612213405, 'psi': 0.9952328906637342}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=2.311453 cos_to_last_merge=0.9999 (last merge round=39)
[S6] round=42 local utility u=1.000000 metrics={'f1_val': 0.8967552733699574, 'auprc': 0.9630397380166231, 'loss_val': 0.28534898676972753, 'psi': 0.9232690592286237}-{'f1_val': 0.5816938834845635, 'auprc': 0.8311169472155787, 'loss_val': 1.002721100663786, 'psi': 0.6814631089769696}
[S7] START round=42 head_norm_before_train=1.636529 cos_to_last_merge=0.9999 (last merge round=40)
[S7] round=42 local utility u=0.122909 metrics={'f1_val': 0.9471380450776755, 'auprc': 0.9939319730226212, 'loss_val': 0.2685377896760931, 'psi': 0.9658556162556537}-{'f1_val': 0.9134458244414143, 'auprc': 0.99428753701148, 'loss_val': 0.3132691341540033, 'psi': 0.9457825094694406}
[S8] START round=42 head_norm_before_train=1.644000 cos_to_last_merge=0.9879 (last merge round=31)
[S8] round=42 local utility u=0.021355 metrics={'f1_val': 0.9928249955793521, 'auprc': 0.9993347098317826, 'loss_val': 0.04063657830877835, 'psi': 0.9954288812803243}-{'f1_val': 0.9875097078386601, 'auprc': 0.9993705067881937, 'loss_val': 0.051562638304935016, 'psi': 0.9922540274184735}
[S9] START round=42 head_norm_before_train=2.259499 (no previous merge yet)
[S9] round=42 local utility u=0.006296 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9987813463981238, 'loss_val': 0.016857283466686475, 'psi': 0.9977725682827875}-{'f1_val': 0.9956054446615002, 'auprc': 0.9987410150070527, 'loss_val': 0.0203613338433275, 'psi': 0.9968596727997212}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=42 head_norm_before_train=2.099827 cos_to_last_merge=0.9997 (last merge round=37)
[S10] round=42 local utility u=0.000888 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9948028141214078, 'loss_val': 0.031335957983278054, 'psi': 0.9948514601067999}-{'f1_val': 0.9946643883427498, 'auprc': 0.994985875555912, 'loss_val': 0.032344844177634384, 'psi': 0.9947929832280147}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=42 head_norm_before_train=2.090138 cos_to_last_merge=0.9994 (last merge round=33)
[S11] round=42 local utility u=0.011056 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9984105521276913, 'loss_val': 0.02229306071159013, 'psi': 0.9970567056975237}-{'f1_val': 0.9949499293555814, 'auprc': 0.9968676408729925, 'loss_val': 0.032551244869452114, 'psi': 0.9957170139625459}
[S13] START round=42 head_norm_before_train=2.026279 cos_to_last_merge=0.9994 (last merge round=37)
[S13] round=42 local utility u=0.131877 metrics={'f1_val': 0.594994361055268, 'auprc': 0.6781827124135914, 'loss_val': 0.8119634974632873, 'psi': 0.6282697015985974}-{'f1_val': 0.5529623196589155, 'auprc': 0.6861911700210798, 'loss_val': 0.8475507766623699, 'psi': 0.6062538598037812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=42 head_norm_before_train=2.046443 cos_to_last_merge=0.9999 (last merge round=38)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9962462182668168, 'auprc': 0.9990069464200227, 'loss_val': 0.03542664030562454, 'psi': 0.9973505095280992}-{'f1_val': 0.9970842644973595, 'auprc': 0.9987347615332437, 'loss_val': 0.028286826907769177, 'psi': 0.9977444633117132}
[S15] START round=42 head_norm_before_train=1.652260 cos_to_last_merge=0.9999 (last merge round=40)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.9020263448005295, 'auprc': 0.9967885173329902, 'loss_val': 0.18147020983319717, 'psi': 0.9399312138135139}-{'f1_val': 0.9775794000968784, 'auprc': 0.9975264359637005, 'loss_val': 0.06366937967838726, 'psi': 0.9855582144436073}
[S16] START round=42 head_norm_before_train=1.596366 cos_to_last_merge=0.9990 (last merge round=36)
[S16] round=42 local utility u=0.001149 metrics={'f1_val': 0.9922426511262559, 'auprc': 0.9990051344147078, 'loss_val': 0.04026966178489265, 'psi': 0.9949476444416367}-{'f1_val': 0.9924622258652532, 'auprc': 0.9987752787750899, 'loss_val': 0.043195225444486764, 'psi': 0.994987447029188}
[S17] START round=42 head_norm_before_train=2.045972 cos_to_last_merge=0.9975 (last merge round=33)
[S17] round=42 local utility u=0.247149 metrics={'f1_val': 0.5975491811223332, 'auprc': 0.8784427506307355, 'loss_val': 1.1388887699565562, 'psi': 0.7099066089256942}-{'f1_val': 0.569894100036502, 'auprc': 0.8234791445153684, 'loss_val': 1.3023649765276357, 'psi': 0.6713281178280486}
[S16] not sending this round → trigger blocked (psi=0.995)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] not sending this round → trigger blocked (psi=0.966)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=42 metric=0.9020 head_norm=1.683616
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.756824e-02
[S15] stored merged vector for next round verification (round=42)
[S15] DEBUG after merge:  round=42 metric=0.9020 head_norm=1.659815 delta_norm=0.037568
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] RECEIVED delta(kind=head bytes=1794) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=2.321378)
[S3] loaded HEAD from S6 (vec_in norm=2.321378)
[S3] cosine check vs S6: cos=0.9998
[S3] BUFFERED delta from S6 (total buffered=1)
[S2] START round=43 head_norm_before_train=1.758568 cos_to_last_merge=0.9957 (last merge round=32)
[S2] round=43 local utility u=0.569784 metrics={'f1_val': 0.8248022719925736, 'auprc': 0.848706172176261, 'loss_val': 0.5935345854678499, 'psi': 0.8343638320660486}-{'f1_val': 0.7224755743523114, 'auprc': 0.77827127018394, 'loss_val': 0.9078378440754701, 'psi': 0.7447938526849629}
[S3] START round=43 head_norm_before_train=2.321806 cos_to_last_merge=1.0000 (last merge round=39)
[S3] round=43 local utility u=0.000376 metrics={'f1_val': 0.9435200068791221, 'auprc': 0.9897328119247789, 'loss_val': 0.12382185041175599, 'psi': 0.9620051288973848}-{'f1_val': 0.960651231474942, 'auprc': 0.9763301045533349, 'loss_val': 0.18715296967602665, 'psi': 0.9669227807062992}
[S4] START round=43 head_norm_before_train=1.552947 cos_to_last_merge=0.9993 (last merge round=37)
[S4] round=43 local utility u=0.015840 metrics={'f1_val': 0.944541364520322, 'auprc': 0.9522284672124299, 'loss_val': 0.29810797111414117, 'psi': 0.9476162055971651}-{'f1_val': 0.9440084036985674, 'auprc': 0.9417005231457811, 'loss_val': 0.29500728607207055, 'psi': 0.9430852514774529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=43 head_norm_before_train=1.822459 cos_to_last_merge=0.9978 (last merge round=38)
[S5] round=43 local utility u=0.007532 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9964470142781638, 'loss_val': 0.038609703794702334, 'psi': 0.9964664938829036}-{'f1_val': 0.9964794802860635, 'auprc': 0.9927068771505783, 'loss_val': 0.04245334645350194, 'psi': 0.9949704390318694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=43 head_norm_before_train=2.321378 cos_to_last_merge=0.9999 (last merge round=39)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.5980542624452405, 'auprc': 0.9084087270154568, 'loss_val': 0.9851728125895858, 'psi': 0.7221960482733271}-{'f1_val': 0.8967552733699574, 'auprc': 0.9630397380166231, 'loss_val': 0.28534898676972753, 'psi': 0.9232690592286237}
[S7] START round=43 head_norm_before_train=1.644104 cos_to_last_merge=0.9999 (last merge round=40)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.881287608456133, 'auprc': 0.9937565516270467, 'loss_val': 0.36864514985817354, 'psi': 0.9262751857244984}-{'f1_val': 0.9471380450776755, 'auprc': 0.9939319730226212, 'loss_val': 0.2685377896760931, 'psi': 0.9658556162556537}
[S8] START round=43 head_norm_before_train=1.655231 cos_to_last_merge=0.9872 (last merge round=31)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9248384091383779, 'auprc': 0.9963888957071712, 'loss_val': 0.15877683397418496, 'psi': 0.9534586037658952}-{'f1_val': 0.9928249955793521, 'auprc': 0.9993347098317826, 'loss_val': 0.04063657830877835, 'psi': 0.9954288812803243}
[S9] START round=43 head_norm_before_train=2.268402 (no previous merge yet)
[S9] round=43 local utility u=0.000457 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987871655870267, 'loss_val': 0.01597891872988699, 'psi': 0.9977766137420964}-{'f1_val': 0.9971000495392299, 'auprc': 0.9987813463981238, 'loss_val': 0.016857283466686475, 'psi': 0.9977725682827875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=43 head_norm_before_train=2.110198 cos_to_last_merge=0.9995 (last merge round=37)
[S10] round=43 local utility u=0.001282 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9967976180918348, 'loss_val': 0.032122462361225824, 'psi': 0.995386023554528}-{'f1_val': 0.9948838907637279, 'auprc': 0.9948028141214078, 'loss_val': 0.031335957983278054, 'psi': 0.9948514601067999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=43 head_norm_before_train=2.098898 cos_to_last_merge=0.9993 (last merge round=33)
[S11] round=43 local utility u=0.001207 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983929545483379, 'loss_val': 0.022307177496709782, 'psi': 0.9972976642030633}-{'f1_val': 0.9961541414107454, 'auprc': 0.9984105521276913, 'loss_val': 0.02229306071159013, 'psi': 0.9970567056975237}
[S13] START round=43 head_norm_before_train=2.038455 cos_to_last_merge=0.9991 (last merge round=37)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5979788559513711, 'auprc': 0.6726385876354061, 'loss_val': 0.8470518254065327, 'psi': 0.6278427486249851}-{'f1_val': 0.594994361055268, 'auprc': 0.6781827124135914, 'loss_val': 0.8119634974632873, 'psi': 0.6282697015985974}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.055568 cos_to_last_merge=0.9998 (last merge round=38)
[S14] round=43 local utility u=0.007836 metrics={'f1_val': 0.9974950262084489, 'auprc': 0.998763298486005, 'loss_val': 0.026515708997393955, 'psi': 0.9980023351194713}-{'f1_val': 0.9962462182668168, 'auprc': 0.9990069464200227, 'loss_val': 0.03542664030562454, 'psi': 0.9973505095280992}
[S15] START round=43 head_norm_before_train=1.659815 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.8897253266936573, 'auprc': 0.9931735855413295, 'loss_val': 0.2098825861687514, 'psi': 0.9311046302327262}-{'f1_val': 0.9020263448005295, 'auprc': 0.9967885173329902, 'loss_val': 0.18147020983319717, 'psi': 0.9399312138135139}
[S16] START round=43 head_norm_before_train=1.609366 cos_to_last_merge=0.9986 (last merge round=36)
[S16] round=43 local utility u=0.000318 metrics={'f1_val': 0.9922426511262559, 'auprc': 0.998689070963817, 'loss_val': 0.03868629209664077, 'psi': 0.9948212190612804}-{'f1_val': 0.9922426511262559, 'auprc': 0.9990051344147078, 'loss_val': 0.04026966178489265, 'psi': 0.9949476444416367}
[S17] START round=43 head_norm_before_train=2.054680 cos_to_last_merge=0.9972 (last merge round=33)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.5603888347091004, 'auprc': 0.7826948104719089, 'loss_val': 1.4078768522938174, 'psi': 0.6493112250142238}-{'f1_val': 0.5975491811223332, 'auprc': 0.8784427506307355, 'loss_val': 1.1388887699565562, 'psi': 0.7099066089256942}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S11] not sending this round → trigger blocked (psi=0.997)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:50307
[S2] not sending this round → trigger blocked (psi=0.834)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.326372)
[S6] loaded HEAD from S3 (vec_in norm=2.326372)
[S6] cosine check vs S3: cos=0.9997
[S6] BUFFERED delta from S3 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=43 metric=0.9435 head_norm=2.326372
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.342254e-02
[S3] stored merged vector for next round verification (round=43)
[S3] DEBUG after merge:  round=43 metric=0.9429 head_norm=2.323758 delta_norm=0.023423
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.768019 cos_to_last_merge=0.9953 (last merge round=32)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.7161652949149537, 'auprc': 0.856435641751705, 'loss_val': 0.7177695424905794, 'psi': 0.7722734336496542}-{'f1_val': 0.8248022719925736, 'auprc': 0.848706172176261, 'loss_val': 0.5935345854678499, 'psi': 0.8343638320660486}
[S3] START round=44 head_norm_before_train=2.323758 cos_to_last_merge=1.0000 (last merge round=43)
[S3] round=44 local utility u=0.041651 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9973914517227022, 'loss_val': 0.1673542081542242, 'psi': 0.975454346071819}-{'f1_val': 0.9435200068791221, 'auprc': 0.9897328119247789, 'loss_val': 0.12382185041175599, 'psi': 0.9620051288973848}
[S4] START round=44 head_norm_before_train=1.558576 cos_to_last_merge=0.9990 (last merge round=37)
[S4] round=44 local utility u=0.023197 metrics={'f1_val': 0.9501822570435554, 'auprc': 0.953953107612618, 'loss_val': 0.29073318758278, 'psi': 0.9516905972711804}-{'f1_val': 0.944541364520322, 'auprc': 0.9522284672124299, 'loss_val': 0.29810797111414117, 'psi': 0.9476162055971651}
[S4] not sending this round → trigger blocked (psi=0.952)
[S5] START round=44 head_norm_before_train=1.830866 cos_to_last_merge=0.9973 (last merge round=38)
[S5] round=44 local utility u=0.000319 metrics={'f1_val': 0.9962606338323629, 'auprc': 0.9972440324809115, 'loss_val': 0.03904962751483681, 'psi': 0.9966539932917824}-{'f1_val': 0.9964794802860635, 'auprc': 0.9964470142781638, 'loss_val': 0.038609703794702334, 'psi': 0.9964664938829036}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=44 head_norm_before_train=2.330534 cos_to_last_merge=0.9998 (last merge round=39)
[S6] round=44 local utility u=0.973430 metrics={'f1_val': 0.8070115316509969, 'auprc': 0.9484515675087755, 'loss_val': 0.4121847506453874, 'psi': 0.8635875459941084}-{'f1_val': 0.5980542624452405, 'auprc': 0.9084087270154568, 'loss_val': 0.9851728125895858, 'psi': 0.7221960482733271}
[S7] START round=44 head_norm_before_train=1.651368 cos_to_last_merge=0.9997 (last merge round=40)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.6994488751111906, 'auprc': 0.9648639924322293, 'loss_val': 0.6666497285554024, 'psi': 0.805614922039606}-{'f1_val': 0.881287608456133, 'auprc': 0.9937565516270467, 'loss_val': 0.36864514985817354, 'psi': 0.9262751857244984}
[S8] START round=44 head_norm_before_train=1.666932 cos_to_last_merge=0.9864 (last merge round=31)
[S8] round=44 local utility u=0.264817 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9993752028594544, 'loss_val': 0.03993734303707506, 'psi': 0.9948366618414876}-{'f1_val': 0.9248384091383779, 'auprc': 0.9963888957071712, 'loss_val': 0.15877683397418496, 'psi': 0.9534586037658952}
[S9] START round=44 head_norm_before_train=2.278300 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9925069029958717, 'auprc': 0.9987548583511319, 'loss_val': 0.02562178191126131, 'psi': 0.9950060851379757}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987871655870267, 'loss_val': 0.01597891872988699, 'psi': 0.9977766137420964}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.119354 cos_to_last_merge=0.9993 (last merge round=37)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9948509749477352, 'loss_val': 0.030138477761815, 'psi': 0.9948707244373308}-{'f1_val': 0.9944449605296568, 'auprc': 0.9967976180918348, 'loss_val': 0.032122462361225824, 'psi': 0.995386023554528}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=2.109076 cos_to_last_merge=0.9992 (last merge round=33)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9984999472844602, 'loss_val': 0.02156740888011413, 'psi': 0.9970924637602313}-{'f1_val': 0.996567470639547, 'auprc': 0.9983929545483379, 'loss_val': 0.022307177496709782, 'psi': 0.9972976642030633}
[S13] START round=44 head_norm_before_train=2.048921 cos_to_last_merge=0.9987 (last merge round=37)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5595920520761299, 'auprc': 0.6869947821689346, 'loss_val': 0.8418118504547146, 'psi': 0.6105531441132519}-{'f1_val': 0.5979788559513711, 'auprc': 0.6726385876354061, 'loss_val': 0.8470518254065327, 'psi': 0.6278427486249851}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=2.065553 cos_to_last_merge=0.9997 (last merge round=38)
[S14] round=44 local utility u=0.002428 metrics={'f1_val': 0.9977377496967396, 'auprc': 0.9990012488423105, 'loss_val': 0.0238300802365114, 'psi': 0.9982431493549679}-{'f1_val': 0.9974950262084489, 'auprc': 0.998763298486005, 'loss_val': 0.026515708997393955, 'psi': 0.9980023351194713}
[S15] START round=44 head_norm_before_train=1.688456 cos_to_last_merge=0.9999 (last merge round=42)
[S15] round=44 local utility u=0.028787 metrics={'f1_val': 0.8950759658271273, 'auprc': 0.9933449349658263, 'loss_val': 0.18492731280490435, 'psi': 0.9343835534826069}-{'f1_val': 0.8897253266936573, 'auprc': 0.9931735855413295, 'loss_val': 0.2098825861687514, 'psi': 0.9311046302327262}
[S16] START round=44 head_norm_before_train=1.620008 cos_to_last_merge=0.9983 (last merge round=36)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.8643036377440888, 'auprc': 0.9579886053391171, 'loss_val': 0.6062892295579703, 'psi': 0.9017776247821001}-{'f1_val': 0.9922426511262559, 'auprc': 0.998689070963817, 'loss_val': 0.03868629209664077, 'psi': 0.9948212190612804}
[S17] START round=44 head_norm_before_train=2.065185 cos_to_last_merge=0.9967 (last merge round=33)
[S17] round=44 local utility u=0.236793 metrics={'f1_val': 0.5736825992706375, 'auprc': 0.8918828824599009, 'loss_val': 1.341618223388234, 'psi': 0.7009627125463429}-{'f1_val': 0.5603888347091004, 'auprc': 0.7826948104719089, 'loss_val': 1.4078768522938174, 'psi': 0.6493112250142238}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:50308
[S3] not sending this round → trigger blocked (psi=0.975)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:50303
[S6] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1804) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.714917)
[S7] loaded HEAD from S15 (vec_in norm=1.714917)
[S7] cosine check vs S15: cos=0.9986
[S7] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1794) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=2.336045)
[S3] loaded HEAD from S6 (vec_in norm=2.336045)
[S3] cosine check vs S6: cos=0.9998
[S3] BUFFERED delta from S6 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=44 metric=0.8070 head_norm=2.336045
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.202446e-02
[S6] stored merged vector for next round verification (round=44)
[S6] DEBUG after merge:  round=44 metric=0.8073 head_norm=2.330994 delta_norm=0.032024
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=44 metric=0.6994 head_norm=1.659236
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.235232e-02
[S7] stored merged vector for next round verification (round=44)
[S7] DEBUG after merge:  round=44 metric=0.6883 head_norm=1.686494 delta_norm=0.052352
[S7] aggregate: ROLLBACK (f1_val pre=0.699 post=0.688 tol_abs=0.005 tol_rel=0.0)
[S2] START round=45 head_norm_before_train=1.777515 cos_to_last_merge=0.9949 (last merge round=32)
[S2] round=45 local utility u=0.317385 metrics={'f1_val': 0.7871974874870638, 'auprc': 0.8539700422321539, 'loss_val': 0.5017949456152172, 'psi': 0.8139065093850998}-{'f1_val': 0.7161652949149537, 'auprc': 0.856435641751705, 'loss_val': 0.7177695424905794, 'psi': 0.7722734336496542}
[S3] START round=45 head_norm_before_train=2.327471 cos_to_last_merge=1.0000 (last merge round=43)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9278199272646709, 'auprc': 0.9925502091682481, 'loss_val': 0.20774259257633046, 'psi': 0.9537120400261018}-{'f1_val': 0.9608296089712303, 'auprc': 0.9973914517227022, 'loss_val': 0.1673542081542242, 'psi': 0.975454346071819}
[S4] START round=45 head_norm_before_train=1.559382 cos_to_last_merge=0.9988 (last merge round=37)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9449069963461305, 'auprc': 0.9603156315262961, 'loss_val': 0.2860872407942596, 'psi': 0.9510704504181967}-{'f1_val': 0.9501822570435554, 'auprc': 0.953953107612618, 'loss_val': 0.29073318758278, 'psi': 0.9516905972711804}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.841984 cos_to_last_merge=0.9967 (last merge round=38)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9927916936341344, 'loss_val': 0.038342954019876946, 'psi': 0.9948282914392403}-{'f1_val': 0.9962606338323629, 'auprc': 0.9972440324809115, 'loss_val': 0.03904962751483681, 'psi': 0.9966539932917824}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=2.330994 cos_to_last_merge=1.0000 (last merge round=44)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.8004298062100679, 'auprc': 0.9277967700793789, 'loss_val': 0.478836679540204, 'psi': 0.8513765917577922}-{'f1_val': 0.8070115316509969, 'auprc': 0.9484515675087755, 'loss_val': 0.4121847506453874, 'psi': 0.8635875459941084}
[S7] START round=45 head_norm_before_train=1.686494 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5425020810906889, 'auprc': 0.7842995788032276, 'loss_val': 0.8953697439612672, 'psi': 0.6392210801757043}-{'f1_val': 0.6994488751111906, 'auprc': 0.9648639924322293, 'loss_val': 0.6666497285554024, 'psi': 0.805614922039606}
[S8] START round=45 head_norm_before_train=1.676768 cos_to_last_merge=0.9856 (last merge round=31)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9940931887774087, 'auprc': 0.9870252479218663, 'loss_val': 0.043720220092539404, 'psi': 0.9912660124351917}-{'f1_val': 0.9918109678295097, 'auprc': 0.9993752028594544, 'loss_val': 0.03993734303707506, 'psi': 0.9948366618414876}
[S9] START round=45 head_norm_before_train=2.282519 (no previous merge yet)
[S9] round=45 local utility u=0.008790 metrics={'f1_val': 0.9964710073874787, 'auprc': 0.99436349180182, 'loss_val': 0.018651764202730445, 'psi': 0.9956280011532153}-{'f1_val': 0.9925069029958717, 'auprc': 0.9987548583511319, 'loss_val': 0.02562178191126131, 'psi': 0.9950060851379757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=45 head_norm_before_train=2.127729 cos_to_last_merge=0.9992 (last merge round=37)
[S10] round=45 local utility u=0.001124 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9944665782518961, 'loss_val': 0.029372464713361447, 'psi': 0.9949805036389967}-{'f1_val': 0.9948838907637279, 'auprc': 0.9948509749477352, 'loss_val': 0.030138477761815, 'psi': 0.9948707244373308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=45 head_norm_before_train=2.117712 cos_to_last_merge=0.9991 (last merge round=33)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9965919014202035, 'auprc': 0.9952697227226466, 'loss_val': 0.1128487562054365, 'psi': 0.9960630299411808}-{'f1_val': 0.9961541414107454, 'auprc': 0.9984999472844602, 'loss_val': 0.02156740888011413, 'psi': 0.9970924637602313}
[S13] START round=45 head_norm_before_train=2.054539 cos_to_last_merge=0.9984 (last merge round=37)
[S13] round=45 local utility u=0.016240 metrics={'f1_val': 0.5752367758526565, 'auprc': 0.6918212733101083, 'loss_val': 0.917680417613051, 'psi': 0.6218705748356372}-{'f1_val': 0.5595920520761299, 'auprc': 0.6869947821689346, 'loss_val': 0.8418118504547146, 'psi': 0.6105531441132519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=45 head_norm_before_train=2.075787 cos_to_last_merge=0.9996 (last merge round=38)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9974515471354712, 'auprc': 0.9987298877646217, 'loss_val': 0.02472561329521518, 'psi': 0.9979628833871313}-{'f1_val': 0.9977377496967396, 'auprc': 0.9990012488423105, 'loss_val': 0.0238300802365114, 'psi': 0.9982431493549679}
[S15] START round=45 head_norm_before_train=1.714917 cos_to_last_merge=0.9997 (last merge round=42)
[S15] round=45 local utility u=0.030002 metrics={'f1_val': 0.903170176196454, 'auprc': 0.9961870403012669, 'loss_val': 0.18201489452411487, 'psi': 0.9403769218383791}-{'f1_val': 0.8950759658271273, 'auprc': 0.9933449349658263, 'loss_val': 0.18492731280490435, 'psi': 0.9343835534826069}
[S16] START round=45 head_norm_before_train=1.629266 cos_to_last_merge=0.9979 (last merge round=36)
[S16] round=45 local utility u=0.728276 metrics={'f1_val': 0.9923839220173097, 'auprc': 0.9985614842478732, 'loss_val': 0.03993753436045939, 'psi': 0.9948549469095351}-{'f1_val': 0.8643036377440888, 'auprc': 0.9579886053391171, 'loss_val': 0.6062892295579703, 'psi': 0.9017776247821001}
[S17] START round=45 head_norm_before_train=2.073894 cos_to_last_merge=0.9963 (last merge round=33)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.5681159889858918, 'auprc': 0.8156925476059363, 'loss_val': 1.3996394454790613, 'psi': 0.6671466124339096}-{'f1_val': 0.5736825992706375, 'auprc': 0.8918828824599009, 'loss_val': 1.341618223388234, 'psi': 0.7009627125463429}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.940)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.350 → S3@127.0.0.1:50303
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=45 metric=0.9278 head_norm=2.333131
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.405599e-02
[S3] stored merged vector for next round verification (round=45)
[S3] DEBUG after merge:  round=45 metric=0.9246 head_norm=2.334465 delta_norm=0.024056
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.034 → S6@127.0.0.1:50307
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=0.071 → S7@127.0.0.1:50308
[S7] ⇄ pheromone p=0.142 → S15@127.0.0.1:50315
[S2] START round=46 head_norm_before_train=1.787054 cos_to_last_merge=0.9945 (last merge round=32)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6917955684070051, 'auprc': 0.794540974264758, 'loss_val': 1.0692159602198814, 'psi': 0.7328937307501062}-{'f1_val': 0.7871974874870638, 'auprc': 0.8539700422321539, 'loss_val': 0.5017949456152172, 'psi': 0.8139065093850998}
[S3] START round=46 head_norm_before_train=2.334465 cos_to_last_merge=1.0000 (last merge round=45)
[S3] round=46 local utility u=0.146622 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9970302142791786, 'loss_val': 0.12723147498252763, 'psi': 0.9754332363749376}-{'f1_val': 0.9278199272646709, 'auprc': 0.9925502091682481, 'loss_val': 0.20774259257633046, 'psi': 0.9537120400261018}
[S4] START round=46 head_norm_before_train=1.559753 cos_to_last_merge=0.9985 (last merge round=37)
[S4] round=46 local utility u=0.022129 metrics={'f1_val': 0.9451977517863859, 'auprc': 0.9726283907308844, 'loss_val': 0.28051257464906537, 'psi': 0.9561700073641852}-{'f1_val': 0.9449069963461305, 'auprc': 0.9603156315262961, 'loss_val': 0.2860872407942596, 'psi': 0.9510704504181967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=46 head_norm_before_train=1.852436 cos_to_last_merge=0.9960 (last merge round=38)
[S5] round=46 local utility u=0.006639 metrics={'f1_val': 0.9958221255929219, 'auprc': 0.9970578615500127, 'loss_val': 0.03568027914848239, 'psi': 0.9963164199757583}-{'f1_val': 0.996186023309311, 'auprc': 0.9927916936341344, 'loss_val': 0.038342954019876946, 'psi': 0.9948282914392403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=46 head_norm_before_train=2.333932 cos_to_last_merge=1.0000 (last merge round=44)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7991398945396991, 'auprc': 0.9382603901339183, 'loss_val': 0.5796726666576898, 'psi': 0.8547880927773868}-{'f1_val': 0.8004298062100679, 'auprc': 0.9277967700793789, 'loss_val': 0.478836679540204, 'psi': 0.8513765917577922}
[S7] START round=46 head_norm_before_train=1.696111 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=46 local utility u=0.907611 metrics={'f1_val': 0.68134868673861, 'auprc': 0.9726395423773095, 'loss_val': 0.4782475027243623, 'psi': 0.7978650289940898}-{'f1_val': 0.5425020810906889, 'auprc': 0.7842995788032276, 'loss_val': 0.8953697439612672, 'psi': 0.6392210801757043}
[S8] START round=46 head_norm_before_train=1.686040 cos_to_last_merge=0.9846 (last merge round=31)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.975718120313847, 'auprc': 0.9992147115811035, 'loss_val': 0.07218411323504148, 'psi': 0.9851167568207495}-{'f1_val': 0.9940931887774087, 'auprc': 0.9870252479218663, 'loss_val': 0.043720220092539404, 'psi': 0.9912660124351917}
[S9] START round=46 head_norm_before_train=2.289526 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9893026945281196, 'auprc': 0.9988116393859588, 'loss_val': 0.033112598668530765, 'psi': 0.9931062724712553}-{'f1_val': 0.9964710073874787, 'auprc': 0.99436349180182, 'loss_val': 0.018651764202730445, 'psi': 0.9956280011532153}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.136111 cos_to_last_merge=0.9990 (last merge round=37)
[S10] round=46 local utility u=0.002262 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9958437287240165, 'loss_val': 0.028980659310828084, 'psi': 0.9955313638278448}-{'f1_val': 0.9953231205637304, 'auprc': 0.9944665782518961, 'loss_val': 0.029372464713361447, 'psi': 0.9949805036389967}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=46 head_norm_before_train=2.119775 cos_to_last_merge=0.9989 (last merge round=33)
[S11] round=46 local utility u=0.050064 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983171197257041, 'loss_val': 0.02171590165957968, 'psi': 0.9972673302740098}-{'f1_val': 0.9965919014202035, 'auprc': 0.9952697227226466, 'loss_val': 0.1128487562054365, 'psi': 0.9960630299411808}
[S13] START round=46 head_norm_before_train=2.059911 cos_to_last_merge=0.9982 (last merge round=37)
[S13] round=46 local utility u=0.049800 metrics={'f1_val': 0.5989606189699616, 'auprc': 0.6336569653521371, 'loss_val': 0.7859304375764534, 'psi': 0.6128391575228318}-{'f1_val': 0.5752367758526565, 'auprc': 0.6918212733101083, 'loss_val': 0.917680417613051, 'psi': 0.6218705748356372}
[S13] not sending this round → trigger blocked (psi=0.613)
[S14] START round=46 head_norm_before_train=2.086771 cos_to_last_merge=0.9994 (last merge round=38)
[S14] round=46 local utility u=0.001470 metrics={'f1_val': 0.9974950262084489, 'auprc': 0.9988835557011886, 'loss_val': 0.0225068345306247, 'psi': 0.9980504380055448}-{'f1_val': 0.9974515471354712, 'auprc': 0.9987298877646217, 'loss_val': 0.02472561329521518, 'psi': 0.9979628833871313}
[S15] START round=46 head_norm_before_train=1.740316 cos_to_last_merge=0.9993 (last merge round=42)
[S15] round=46 local utility u=0.355686 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9978366709464952, 'loss_val': 0.03456539668567017, 'psi': 0.9969341148878826}-{'f1_val': 0.903170176196454, 'auprc': 0.9961870403012669, 'loss_val': 0.18201489452411487, 'psi': 0.9403769218383791}
[S16] START round=46 head_norm_before_train=1.638165 cos_to_last_merge=0.9973 (last merge round=36)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9904887341772003, 'auprc': 0.9960032711547875, 'loss_val': 0.044526867480975056, 'psi': 0.9926945489682352}-{'f1_val': 0.9923839220173097, 'auprc': 0.9985614842478732, 'loss_val': 0.03993753436045939, 'psi': 0.9948549469095351}
[S17] START round=46 head_norm_before_train=2.079622 cos_to_last_merge=0.9960 (last merge round=33)
[S17] round=46 local utility u=0.128669 metrics={'f1_val': 0.5893269443716564, 'auprc': 0.7617686412162008, 'loss_val': 1.1077946512315586, 'psi': 0.6583036231094742}-{'f1_val': 0.5681159889858918, 'auprc': 0.8156925476059363, 'loss_val': 1.3996394454790613, 'psi': 0.6671466124339096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:50307
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:50315
[S15] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.341131)
[S6] loaded HEAD from S3 (vec_in norm=2.341131)
[S6] cosine check vs S3: cos=1.0000
[S6] BUFFERED delta from S3 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.764283)
[S7] loaded HEAD from S15 (vec_in norm=1.764283)
[S7] cosine check vs S15: cos=0.9985
[S7] BUFFERED delta from S15 (total buffered=1)
[S7] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.706517)
[S15] loaded HEAD from S7 (vec_in norm=1.706517)
[S15] cosine check vs S7: cos=0.9985
[S15] BUFFERED delta from S7 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=46 metric=0.6813 head_norm=1.706517
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.504426e-02
[S7] stored merged vector for next round verification (round=46)
[S7] DEBUG after merge:  round=46 metric=0.6743 head_norm=1.734767 delta_norm=0.055044
[S7] aggregate: ROLLBACK (f1_val pre=0.681 post=0.674 tol_abs=0.005 tol_rel=0.0)
[S2] START round=47 head_norm_before_train=1.797013 cos_to_last_merge=0.9940 (last merge round=32)
[S2] round=47 local utility u=0.512647 metrics={'f1_val': 0.7754539792064589, 'auprc': 0.8295782046256552, 'loss_val': 0.6509832683577422, 'psi': 0.7971036693741373}-{'f1_val': 0.6917955684070051, 'auprc': 0.794540974264758, 'loss_val': 1.0692159602198814, 'psi': 0.7328937307501062}
[S3] START round=47 head_norm_before_train=2.341131 cos_to_last_merge=1.0000 (last merge round=45)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.8897130133479405, 'auprc': 0.994752854717969, 'loss_val': 0.23298852256413952, 'psi': 0.9317289498959519}-{'f1_val': 0.9610352511054436, 'auprc': 0.9970302142791786, 'loss_val': 0.12723147498252763, 'psi': 0.9754332363749376}
[S4] START round=47 head_norm_before_train=1.564506 cos_to_last_merge=0.9980 (last merge round=37)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.93978435169253, 'auprc': 0.9685315911614272, 'loss_val': 0.3111351634825896, 'psi': 0.951283247480089}-{'f1_val': 0.9451977517863859, 'auprc': 0.9726283907308844, 'loss_val': 0.28051257464906537, 'psi': 0.9561700073641852}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.866971 cos_to_last_merge=0.9952 (last merge round=38)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.9961148264211057, 'auprc': 0.9931135970473901, 'loss_val': 0.03536550957821806, 'psi': 0.9949143346716194}-{'f1_val': 0.9958221255929219, 'auprc': 0.9970578615500127, 'loss_val': 0.03568027914848239, 'psi': 0.9963164199757583}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=2.338206 cos_to_last_merge=1.0000 (last merge round=44)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.6471232135689674, 'auprc': 0.9240595277998983, 'loss_val': 0.7680730140883422, 'psi': 0.7578977392613397}-{'f1_val': 0.7991398945396991, 'auprc': 0.9382603901339183, 'loss_val': 0.5796726666576898, 'psi': 0.8547880927773868}
[S7] START round=47 head_norm_before_train=1.734767 cos_to_last_merge=1.0000 (last merge round=46)
[S7] round=47 local utility u=0.464581 metrics={'f1_val': 0.8124264500610041, 'auprc': 0.9925861160942214, 'loss_val': 0.3953909858723323, 'psi': 0.884490316474291}-{'f1_val': 0.68134868673861, 'auprc': 0.9726395423773095, 'loss_val': 0.4782475027243623, 'psi': 0.7978650289940898}
[S8] START round=47 head_norm_before_train=1.696240 cos_to_last_merge=0.9837 (last merge round=31)
[S8] round=47 local utility u=0.040204 metrics={'f1_val': 0.9853820930993438, 'auprc': 0.9992947565066944, 'loss_val': 0.05000078938981043, 'psi': 0.9909471584622841}-{'f1_val': 0.975718120313847, 'auprc': 0.9992147115811035, 'loss_val': 0.07218411323504148, 'psi': 0.9851167568207495}
[S9] START round=47 head_norm_before_train=2.295985 (no previous merge yet)
[S9] round=47 local utility u=0.025751 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9951442454724598, 'loss_val': 0.01741059514285092, 'psi': 0.9963194456962696}-{'f1_val': 0.9893026945281196, 'auprc': 0.9988116393859588, 'loss_val': 0.033112598668530765, 'psi': 0.9931062724712553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=47 head_norm_before_train=2.144410 cos_to_last_merge=0.9988 (last merge round=37)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.996405339634393, 'loss_val': 0.02889064813519279, 'psi': 0.995492470311994}-{'f1_val': 0.9953231205637304, 'auprc': 0.9958437287240165, 'loss_val': 0.028980659310828084, 'psi': 0.9955313638278448}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=2.126353 cos_to_last_merge=0.9987 (last merge round=33)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9825419976898653, 'auprc': 0.9982003367192769, 'loss_val': 0.05051841212278967, 'psi': 0.98880533330163}-{'f1_val': 0.996567470639547, 'auprc': 0.9983171197257041, 'loss_val': 0.02171590165957968, 'psi': 0.9972673302740098}
[S13] START round=47 head_norm_before_train=2.066381 cos_to_last_merge=0.9979 (last merge round=37)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.5738759898910947, 'auprc': 0.6841663995951542, 'loss_val': 0.81335621624163, 'psi': 0.6179921537727184}-{'f1_val': 0.5989606189699616, 'auprc': 0.6336569653521371, 'loss_val': 0.7859304375764534, 'psi': 0.6128391575228318}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.096574 cos_to_last_merge=0.9992 (last merge round=38)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9325857698795212, 'auprc': 0.9989845413620522, 'loss_val': 0.09568678322312477, 'psi': 0.9591452784725336}-{'f1_val': 0.9974950262084489, 'auprc': 0.9988835557011886, 'loss_val': 0.0225068345306247, 'psi': 0.9980504380055448}
[S15] START round=47 head_norm_before_train=1.764283 cos_to_last_merge=0.9989 (last merge round=42)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.7927529163501815, 'auprc': 0.9931951991646536, 'loss_val': 0.33274687477605003, 'psi': 0.8729298294759704}-{'f1_val': 0.9963324108488076, 'auprc': 0.9978366709464952, 'loss_val': 0.03456539668567017, 'psi': 0.9969341148878826}
[S16] START round=47 head_norm_before_train=1.648265 cos_to_last_merge=0.9969 (last merge round=36)
[S16] round=47 local utility u=0.007981 metrics={'f1_val': 0.9927112531285135, 'auprc': 0.9939839547884433, 'loss_val': 0.0358426805959727, 'psi': 0.9932203337924854}-{'f1_val': 0.9904887341772003, 'auprc': 0.9960032711547875, 'loss_val': 0.044526867480975056, 'psi': 0.9926945489682352}
[S17] START round=47 head_norm_before_train=2.085783 cos_to_last_merge=0.9957 (last merge round=33)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5342850716745108, 'auprc': 0.726070644211785, 'loss_val': 1.5418834223997955, 'psi': 0.6109993006894205}-{'f1_val': 0.5893269443716564, 'auprc': 0.7617686412162008, 'loss_val': 1.1077946512315586, 'psi': 0.6583036231094742}
[S14]  timeout peer S13
[S17]  timeout peer S14
[S2]  timeout peer S5
[S16]  timeout peer S4
[S7]  timeout peer S8
[S11]  timeout peer S10
[S8]  timeout peer S16
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=47 metric=0.6471 head_norm=2.345089
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.794582e-03
[S6] stored merged vector for next round verification (round=47)
[S6] DEBUG after merge:  round=47 metric=0.6480 head_norm=2.343097 delta_norm=0.007795
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=47 metric=0.7928 head_norm=1.783913
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.532799e-02
[S15] stored merged vector for next round verification (round=47)
[S15] DEBUG after merge:  round=47 metric=0.7928 head_norm=1.744421 delta_norm=0.065328
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] not sending this round → trigger blocked (psi=0.884)
[S2] START round=48 head_norm_before_train=1.808252 cos_to_last_merge=0.9934 (last merge round=32)
[S2] round=48 local utility u=0.182295 metrics={'f1_val': 0.8071878048814694, 'auprc': 0.8480692630623641, 'loss_val': 0.5322688248526601, 'psi': 0.8235403881538272}-{'f1_val': 0.7754539792064589, 'auprc': 0.8295782046256552, 'loss_val': 0.6509832683577422, 'psi': 0.7971036693741373}
[S2] not sending this round → trigger blocked (psi=0.824)
[S3] START round=48 head_norm_before_train=2.346759 cos_to_last_merge=1.0000 (last merge round=45)
[S3] round=48 local utility u=0.279888 metrics={'f1_val': 0.9579281190840113, 'auprc': 0.9972918639612034, 'loss_val': 0.09012079622876606, 'psi': 0.9736736170348881}-{'f1_val': 0.8897130133479405, 'auprc': 0.994752854717969, 'loss_val': 0.23298852256413952, 'psi': 0.9317289498959519}
[S4] START round=48 head_norm_before_train=1.573282 cos_to_last_merge=0.9977 (last merge round=37)
[S4] round=48 local utility u=0.006153 metrics={'f1_val': 0.9410816218520578, 'auprc': 0.9649208961802807, 'loss_val': 0.2957803688722902, 'psi': 0.9506173315833469}-{'f1_val': 0.93978435169253, 'auprc': 0.9685315911614272, 'loss_val': 0.3111351634825896, 'psi': 0.951283247480089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=48 head_norm_before_train=1.880855 cos_to_last_merge=0.9944 (last merge round=38)
[S5] round=48 local utility u=0.001547 metrics={'f1_val': 0.9961148264211057, 'auprc': 0.993974062500699, 'loss_val': 0.034853699744889985, 'psi': 0.995258520852943}-{'f1_val': 0.9961148264211057, 'auprc': 0.9931135970473901, 'loss_val': 0.03536550957821806, 'psi': 0.9949143346716194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=48 head_norm_before_train=2.343097 cos_to_last_merge=1.0000 (last merge round=47)
[S6] round=48 local utility u=0.482029 metrics={'f1_val': 0.7718764708743882, 'auprc': 0.9298996818116985, 'loss_val': 0.5700555685985078, 'psi': 0.8350857552493123}-{'f1_val': 0.6471232135689674, 'auprc': 0.9240595277998983, 'loss_val': 0.7680730140883422, 'psi': 0.7578977392613397}
[S7] START round=48 head_norm_before_train=1.746189 cos_to_last_merge=1.0000 (last merge round=46)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6494618131074053, 'auprc': 0.9101653528744023, 'loss_val': 0.894222145230579, 'psi': 0.7537432290142041}-{'f1_val': 0.8124264500610041, 'auprc': 0.9925861160942214, 'loss_val': 0.3953909858723323, 'psi': 0.884490316474291}
[S8] START round=48 head_norm_before_train=1.707152 cos_to_last_merge=0.9829 (last merge round=31)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.979988307965686, 'auprc': 0.9867684416936822, 'loss_val': 0.08668442481921809, 'psi': 0.9827003614568846}-{'f1_val': 0.9853820930993438, 'auprc': 0.9992947565066944, 'loss_val': 0.05000078938981043, 'psi': 0.9909471584622841}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=2.303509 (no previous merge yet)
[S9] round=48 local utility u=0.000492 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9956951280866275, 'loss_val': 0.01807866325085231, 'psi': 0.9965397987419367}-{'f1_val': 0.9971029125121428, 'auprc': 0.9951442454724598, 'loss_val': 0.01741059514285092, 'psi': 0.9963194456962696}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=48 head_norm_before_train=2.151569 cos_to_last_merge=0.9986 (last merge round=37)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9951781791766887, 'loss_val': 0.02840217145055976, 'psi': 0.9952651440089137}-{'f1_val': 0.9948838907637279, 'auprc': 0.996405339634393, 'loss_val': 0.02889064813519279, 'psi': 0.995492470311994}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=2.134054 cos_to_last_merge=0.9986 (last merge round=33)
[S11] round=48 local utility u=0.054732 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982064093153015, 'loss_val': 0.025225214254986156, 'psi': 0.9972230461098488}-{'f1_val': 0.9825419976898653, 'auprc': 0.9982003367192769, 'loss_val': 0.05051841212278967, 'psi': 0.98880533330163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=48 head_norm_before_train=2.073096 cos_to_last_merge=0.9976 (last merge round=37)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.546460710074938, 'auprc': 0.689514875914277, 'loss_val': 0.9607771969007621, 'psi': 0.6036823764106736}-{'f1_val': 0.5738759898910947, 'auprc': 0.6841663995951542, 'loss_val': 0.81335621624163, 'psi': 0.6179921537727184}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.105485 cos_to_last_merge=0.9990 (last merge round=38)
[S14] round=48 local utility u=0.091395 metrics={'f1_val': 0.956410604757112, 'auprc': 0.9991023055609727, 'loss_val': 0.0561987362525832, 'psi': 0.9734872850786562}-{'f1_val': 0.9325857698795212, 'auprc': 0.9989845413620522, 'loss_val': 0.09568678322312477, 'psi': 0.9591452784725336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] sending update (kind=head size=1790 to 1 peers)
[S15] START round=48 head_norm_before_train=1.744421 cos_to_last_merge=1.0000 (last merge round=47)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.7465366751026862, 'auprc': 0.9922974694293072, 'loss_val': 0.4433261829588137, 'psi': 0.8448409928333346}-{'f1_val': 0.7927529163501815, 'auprc': 0.9931951991646536, 'loss_val': 0.33274687477605003, 'psi': 0.8729298294759704}
[S16] START round=48 head_norm_before_train=1.657383 cos_to_last_merge=0.9965 (last merge round=36)
[S16] round=48 local utility u=0.003612 metrics={'f1_val': 0.9929231374444487, 'auprc': 0.9961196463729907, 'loss_val': 0.03629712054172795, 'psi': 0.9942017410158654}-{'f1_val': 0.9927112531285135, 'auprc': 0.9939839547884433, 'loss_val': 0.0358426805959727, 'psi': 0.9932203337924854}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=48 head_norm_before_train=2.092292 cos_to_last_merge=0.9953 (last merge round=33)
[S17] round=48 local utility u=0.801449 metrics={'f1_val': 0.6301035451465754, 'auprc': 0.8754896788169553, 'loss_val': 0.962153426036169, 'psi': 0.7282579986147273}-{'f1_val': 0.5342850716745108, 'auprc': 0.726070644211785, 'loss_val': 1.5418834223997955, 'psi': 0.6109993006894205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:50303
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:50307
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.351757)
[S6] loaded HEAD from S3 (vec_in norm=2.351757)
[S6] cosine check vs S3: cos=1.0000
[S6] BUFFERED delta from S3 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=2.349610)
[S3] loaded HEAD from S6 (vec_in norm=2.349610)
[S3] cosine check vs S6: cos=1.0000
[S3] BUFFERED delta from S6 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=48 metric=0.9579 head_norm=2.351757
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.022568e-02
[S3] stored merged vector for next round verification (round=48)
[S3] DEBUG after merge:  round=48 metric=0.9582 head_norm=2.350662 delta_norm=0.010226
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=48 metric=0.7719 head_norm=2.349610
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.022568e-02
[S6] stored merged vector for next round verification (round=48)
[S6] DEBUG after merge:  round=48 metric=0.7719 head_norm=2.350662 delta_norm=0.010226
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.821029 cos_to_last_merge=0.9928 (last merge round=32)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.6965452785724124, 'auprc': 0.7262773290778313, 'loss_val': 1.0831585813548374, 'psi': 0.70843809877458}-{'f1_val': 0.8071878048814694, 'auprc': 0.8480692630623641, 'loss_val': 0.5322688248526601, 'psi': 0.8235403881538272}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.350662 cos_to_last_merge=1.0000 (last merge round=48)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9452777992024084, 'auprc': 0.9884396008785289, 'loss_val': 0.24289798782545027, 'psi': 0.9625425198728567}-{'f1_val': 0.9579281190840113, 'auprc': 0.9972918639612034, 'loss_val': 0.09012079622876606, 'psi': 0.9736736170348881}
[S4] START round=49 head_norm_before_train=1.583715 cos_to_last_merge=0.9973 (last merge round=37)
[S4] round=49 local utility u=0.009666 metrics={'f1_val': 0.9422326070590687, 'auprc': 0.9662420019561911, 'loss_val': 0.2873180903440417, 'psi': 0.9518363650179177}-{'f1_val': 0.9410816218520578, 'auprc': 0.9649208961802807, 'loss_val': 0.2957803688722902, 'psi': 0.9506173315833469}
[S4] not sending this round → trigger blocked (psi=0.952)
[S5] START round=49 head_norm_before_train=1.894249 cos_to_last_merge=0.9935 (last merge round=38)
[S5] round=49 local utility u=0.005423 metrics={'f1_val': 0.9958221255929219, 'auprc': 0.9976638911075364, 'loss_val': 0.033321597434659636, 'psi': 0.9965588317987677}-{'f1_val': 0.9961148264211057, 'auprc': 0.993974062500699, 'loss_val': 0.034853699744889985, 'psi': 0.995258520852943}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=49 head_norm_before_train=2.350662 cos_to_last_merge=1.0000 (last merge round=48)
[S6] round=49 local utility u=0.073908 metrics={'f1_val': 0.7948239063783271, 'auprc': 0.9346583540028954, 'loss_val': 0.5741994562596389, 'psi': 0.8507576854281544}-{'f1_val': 0.7718764708743882, 'auprc': 0.9298996818116985, 'loss_val': 0.5700555685985078, 'psi': 0.8350857552493123}
[S7] START round=49 head_norm_before_train=1.764506 cos_to_last_merge=0.9997 (last merge round=46)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.576115551404436, 'auprc': 0.9206347682112201, 'loss_val': 0.771798344839958, 'psi': 0.7139232381271496}-{'f1_val': 0.6494618131074053, 'auprc': 0.9101653528744023, 'loss_val': 0.894222145230579, 'psi': 0.7537432290142041}
[S8] START round=49 head_norm_before_train=1.716125 cos_to_last_merge=0.9823 (last merge round=31)
[S8] round=49 local utility u=0.021685 metrics={'f1_val': 0.9777620017838513, 'auprc': 0.9992238395721273, 'loss_val': 0.06732268389956661, 'psi': 0.9863467368991616}-{'f1_val': 0.979988307965686, 'auprc': 0.9867684416936822, 'loss_val': 0.08668442481921809, 'psi': 0.9827003614568846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=49 head_norm_before_train=2.308617 (no previous merge yet)
[S9] round=49 local utility u=0.004725 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988263305454461, 'loss_val': 0.018023241642319474, 'psi': 0.9977922797254641}-{'f1_val': 0.9971029125121428, 'auprc': 0.9956951280866275, 'loss_val': 0.01807866325085231, 'psi': 0.9965397987419367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=49 head_norm_before_train=2.158301 cos_to_last_merge=0.9985 (last merge round=37)
[S10] round=49 local utility u=0.000432 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9953908079350992, 'loss_val': 0.028175204304557253, 'psi': 0.9953501955122779}-{'f1_val': 0.9953231205637304, 'auprc': 0.9951781791766887, 'loss_val': 0.02840217145055976, 'psi': 0.9952651440089137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] sending update (kind=head size=1790 to 1 peers)
[S11] START round=49 head_norm_before_train=2.140845 cos_to_last_merge=0.9986 (last merge round=33)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9816076208615064, 'auprc': 0.9981762039114315, 'loss_val': 0.03887680205400991, 'psi': 0.9882350540814764}-{'f1_val': 0.996567470639547, 'auprc': 0.9982064093153015, 'loss_val': 0.025225214254986156, 'psi': 0.9972230461098488}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=2.080163 cos_to_last_merge=0.9973 (last merge round=37)
[S13] round=49 local utility u=0.205951 metrics={'f1_val': 0.5814215811335022, 'auprc': 0.6779841039091159, 'loss_val': 0.7240482139566586, 'psi': 0.6200465902437478}-{'f1_val': 0.546460710074938, 'auprc': 0.689514875914277, 'loss_val': 0.9607771969007621, 'psi': 0.6036823764106736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=49 head_norm_before_train=2.113278 cos_to_last_merge=0.9988 (last merge round=38)
[S14] round=49 local utility u=0.136602 metrics={'f1_val': 0.9968414129205869, 'auprc': 0.9988106045545206, 'loss_val': 0.024703548789932615, 'psi': 0.9976290895741604}-{'f1_val': 0.956410604757112, 'auprc': 0.9991023055609727, 'loss_val': 0.0561987362525832, 'psi': 0.9734872850786562}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=49 head_norm_before_train=1.760681 cos_to_last_merge=1.0000 (last merge round=47)
[S15] round=49 local utility u=0.970661 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9987300589777023, 'loss_val': 0.02478593781363641, 'psi': 0.997762375707941}-{'f1_val': 0.7465366751026862, 'auprc': 0.9922974694293072, 'loss_val': 0.4433261829588137, 'psi': 0.8448409928333346}
[S16] START round=49 head_norm_before_train=1.667238 cos_to_last_merge=0.9961 (last merge round=36)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.993348193726548, 'auprc': 0.9939213637785492, 'loss_val': 0.03337596089896206, 'psi': 0.9935774617473485}-{'f1_val': 0.9929231374444487, 'auprc': 0.9961196463729907, 'loss_val': 0.03629712054172795, 'psi': 0.9942017410158654}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=2.101326 cos_to_last_merge=0.9950 (last merge round=33)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.5609469569688477, 'auprc': 0.8307898055360621, 'loss_val': 1.5079385895251194, 'psi': 0.6688840963957334}-{'f1_val': 0.6301035451465754, 'auprc': 0.8754896788169553, 'loss_val': 0.962153426036169, 'psi': 0.7282579986147273}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.851)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.777872)
[S7] loaded HEAD from S15 (vec_in norm=1.777872)
[S7] cosine check vs S15: cos=0.9991
[S7] BUFFERED delta from S15 (total buffered=1)
[runner] rounds complete.
[runner] all agents stopped.
