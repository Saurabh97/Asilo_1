[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:45903
[S3] → join 127.0.0.1:45902
[S4] → join 127.0.0.1:45902
[S5] → join 127.0.0.1:45902
[S6] → join 127.0.0.1:45902
[S7] → join 127.0.0.1:45902
[S8] → join 127.0.0.1:45902
[S9] → join 127.0.0.1:45902
[S10] → join 127.0.0.1:45902
[S11] → join 127.0.0.1:45902
[S13] → join 127.0.0.1:45902
[S14] → join 127.0.0.1:45902
[S15] → join 127.0.0.1:45902
[S16] → join 127.0.0.1:45902
[S17] → join 127.0.0.1:45902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.195900 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.170843 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.163684 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.122864 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.197683 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.181553 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.207121 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.122772 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.156800 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.132489 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.126878 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.139806 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.152028 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.104598 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.150684 (no previous merge yet)
[S10]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S10
[S3] + discovered S11
[S3] + discovered S8
[S3] + discovered S17
[S3] + discovered S7
[S3] + discovered S14
[S3] + discovered S16
[S3] + discovered S13
[S3] + discovered S9
[S3] + discovered S4
[S3] + discovered S5
[S3] + discovered S6
[S3] + discovered S15
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S10
[S4] + discovered S11
[S4] + discovered S8
[S4] + discovered S17
[S4] + discovered S7
[S4] + discovered S14
[S4] + discovered S13
[S4] + discovered S16
[S4] + discovered S9
[S4] + discovered S5
[S4] + discovered S6
[S4] + discovered S15
[S5] + discovered S11
[S5] + discovered S6
[S5] + discovered S9
[S5] + discovered S13
[S5] + discovered S14
[S5] + discovered S7
[S5] + discovered S17
[S5] + discovered S8
[S5] + discovered S10
[S5] + discovered S15
[S5] + discovered S16
[S6] + discovered S4
[S6] + discovered S2
[S6] + discovered S5
[S6] + discovered S3
[S6] + discovered S17
[S7] + discovered S6
[S7] + discovered S4
[S7] + discovered S2
[S7] + discovered S5
[S7] + discovered S3
[S6] + discovered S11
[S6] + discovered S9
[S6] + discovered S13
[S6] + discovered S14
[S6] + discovered S8
[S6] + discovered S7
[S6] + discovered S10
[S6] + discovered S15
[S6] + discovered S16
[S7] + discovered S17
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S10
[S7] + discovered S15
[S7] + discovered S11
[S7] + discovered S9
[S7] + discovered S16
[S7] + discovered S13
[S8] + discovered S5
[S8] + discovered S4
[S8] + discovered S7
[S8] + discovered S2
[S8] + discovered S3
[S8] + discovered S6
[S9] + discovered S6
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S5
[S9] + discovered S2
[S9] + discovered S8
[S9] + discovered S4
[S8] + discovered S9
[S8] + discovered S15
[S8] + discovered S14
[S8] + discovered S13
[S8] + discovered S16
[S8] + discovered S11
[S8] + discovered S10
[S8] + discovered S17
[S9] + discovered S14
[S9] + discovered S17
[S9] + discovered S10
[S9] + discovered S16
[S9] + discovered S11
[S9] + discovered S13
[S10] + discovered S2
[S9] + discovered S15
[S10] + discovered S3
[S10] + discovered S7
[S10] + discovered S9
[S10] + discovered S4
[S10] + discovered S5
[S10] + discovered S8
[S10] + discovered S6
[S11] + discovered S10
[S11] + discovered S5
[S11] + discovered S9
[S11] + discovered S4
[S11] + discovered S3
[S11] + discovered S2
[S11] + discovered S6
[S11] + discovered S8
[S11] + discovered S7
[S10] + discovered S15
[S10] + discovered S11
[S10] + discovered S17
[S10] + discovered S16
[S10] + discovered S14
[S10] + discovered S13
[S13] + discovered S9
[S13] + discovered S8
[S13] + discovered S6
[S13] + discovered S2
[S13] + discovered S3
[S13] + discovered S5
[S13] + discovered S10
[S13] + discovered S7
[S13] + discovered S4
[S13] + discovered S11
[S11] + discovered S17
[S11] + discovered S13
[S11] + discovered S14
[S11] + discovered S16
[S11] + discovered S15
[S14] + discovered S3
[S13] + discovered S14
[S13] + discovered S15
[S13] + discovered S17
[S13] + discovered S16
[S14] + discovered S8
[S14] + discovered S11
[S14] + discovered S4
[S14] + discovered S9
[S14] + discovered S6
[S14] + discovered S2
[S14] + discovered S5
[S14] + discovered S10
[S14] + discovered S7
[S14] + discovered S13
[S15] + discovered S5
[S15] + discovered S2
[S15] + discovered S11
[S15] + discovered S14
[S14] + discovered S17
[S14] + discovered S16
[S14] + discovered S15
[S15] + discovered S3
[S15] + discovered S13
[S15] + discovered S10
[S15] + discovered S9
[S15] + discovered S4
[S15] + discovered S6
[S15] + discovered S8
[S15] + discovered S7
[S15] + discovered S17
[S16] + discovered S14
[S16] + discovered S3
[S16] + discovered S13
[S16] + discovered S11
[S15] + discovered S16
[S16] + discovered S10
[S16] + discovered S4
[S16] + discovered S9
[S16] + discovered S7
[S16] + discovered S8
[S16] + discovered S6
[S16] + discovered S5
[S16] + discovered S2
[S16] + discovered S15
[S17] + discovered S11
[S16] + discovered S17
[S17] + discovered S3
[S17] + discovered S15
[S17] + discovered S9
[S17] + discovered S16
[S17] + discovered S2
[S17] + discovered S13
[S17] + discovered S7
[S17] + discovered S10
[S17] + discovered S6
[S17] + discovered S8
[S17] + discovered S14
[S17] + discovered S5
[S17] + discovered S4
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=1.000 → S4@127.0.0.1:45904
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:45912
[S11] ⇄ pheromone p=1.000 → S16@127.0.0.1:45916
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:45916
[S16] ⇄ pheromone p=1.000 → S15@127.0.0.1:45915
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:45917
[S10] ⇄ pheromone p=1.000 → S8@127.0.0.1:45909
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:45916
[S13] ⇄ pheromone p=1.000 → S2@127.0.0.1:45902
[S15] ⇄ pheromone p=1.000 → S13@127.0.0.1:45913
[S8] ⇄ pheromone p=1.000 → S3@127.0.0.1:45903
[S2] ⇄ pheromone p=1.000 → S17@127.0.0.1:45917
[S3] ⇄ pheromone p=1.000 → S17@127.0.0.1:45917
[S4] ⇄ pheromone p=1.000 → S14@127.0.0.1:45914
[S17] ⇄ pheromone p=1.000 → S14@127.0.0.1:45914
[S2] START round=1 head_norm_before_train=1.200805 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7531493271032104, 'loss_val': 1.2748745705507254, 'psi': 0.3863260108744242}-{'f1_val': 0.1417771333885667, 'auprc': 0.8092688104800813, 'loss_val': 1.3350093743782134, 'psi': 0.40877380422517257}
[S3] START round=1 head_norm_before_train=1.176466 (no previous merge yet)
[S3] round=1 local utility u=0.220805 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8499951743498859, 'loss_val': 1.3285559833692433, 'psi': 0.42390210910841863}-{'f1_val': 0.13984006561410703, 'auprc': 0.7120837592518954, 'loss_val': 1.3564317682720726, 'psi': 0.36873754306922235}
[S4] START round=1 head_norm_before_train=1.174361 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7937939323889112, 'loss_val': 1.2514966346986682, 'psi': 0.40165355029267497}-{'f1_val': 0.4237327379054694, 'auprc': 0.7919967214890387, 'loss_val': 1.3263554860576583, 'psi': 0.5710383313388971}
[S5] START round=1 head_norm_before_train=1.134118 (no previous merge yet)
[S5] round=1 local utility u=0.030968 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.52963969676467, 'loss_val': 1.3057638790504424, 'psi': 0.2972130215630109}-{'f1_val': 0.14226190476190476, 'auprc': 0.5197446532836111, 'loss_val': 1.3380139284194457, 'psi': 0.2932550041705873}
[S6] START round=1 head_norm_before_train=1.207342 (no previous merge yet)
[S6] round=1 local utility u=0.236660 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7746707784668211, 'loss_val': 1.277791843483799, 'psi': 0.39472408061749764}-{'f1_val': 0.14142628205128205, 'auprc': 0.6377290332294382, 'loss_val': 1.3402867252699207, 'psi': 0.3399473825225445}
[S7] START round=1 head_norm_before_train=1.185548 (no previous merge yet)
[S7] round=1 local utility u=0.290214 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.4574278995352822, 'loss_val': 1.3284199068248133, 'psi': 0.26820525345156787}-{'f1_val': 0.14205682272909165, 'auprc': 0.2747921709172768, 'loss_val': 1.3609410636049375, 'psi': 0.1951509620043657}
[S8] START round=1 head_norm_before_train=1.217375 (no previous merge yet)
[S8] round=1 local utility u=0.477494 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7660934357620496, 'loss_val': 1.2840179386847652, 'psi': 0.3904109637405942}-{'f1_val': 0.13995598239295717, 'auprc': 0.4646864021093319, 'loss_val': 1.3347851389176986, 'psi': 0.2698481502795071}
[S9] START round=1 head_norm_before_train=1.126268 (no previous merge yet)
[S9] round=1 local utility u=0.966641 metrics={'f1_val': 0.38109043756074557, 'auprc': 0.9969529730871292, 'loss_val': 1.3165226933639593, 'psi': 0.627435451771299}-{'f1_val': 0.08895775941230487, 'auprc': 0.9496469771779423, 'loss_val': 1.355091099602898, 'psi': 0.4332334465185599}
[S10] START round=1 head_norm_before_train=1.170137 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6422173006307299, 'loss_val': 1.2759458586528567, 'psi': 0.34005990277732634}-{'f1_val': 0.4162385227504591, 'auprc': 0.6302295749774678, 'loss_val': 1.3401794695687463, 'psi': 0.5018349436412626}
[S11] START round=1 head_norm_before_train=1.136119 (no previous merge yet)
[S11] round=1 local utility u=0.081066 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8048155018227489, 'loss_val': 1.3223696920163281, 'psi': 0.4061744107529659}-{'f1_val': 0.14041368337311058, 'auprc': 0.7627233752698127, 'loss_val': 1.3582246245982337, 'psi': 0.38933756013179144}
[S13] START round=1 head_norm_before_train=1.144906 (no previous merge yet)
[S13] round=1 local utility u=0.099012 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5880158784871656, 'loss_val': 1.2698049067986454, 'psi': 0.31943780894109813}-{'f1_val': 0.1403857625770531, 'auprc': 0.5394201376367864, 'loss_val': 1.3220423053537957, 'psi': 0.2999995126009464}
[S14] START round=1 head_norm_before_train=1.145469 (no previous merge yet)
[S14] round=1 local utility u=0.314102 metrics={'f1_val': 0.14735963264454185, 'auprc': 0.6521713830958203, 'loss_val': 1.339557998716773, 'psi': 0.3492843328250532}-{'f1_val': 0.11105904404873478, 'auprc': 0.5226400239973826, 'loss_val': 1.3613652445539337, 'psi': 0.2756914360281939}
[S15] START round=1 head_norm_before_train=1.168066 (no previous merge yet)
[S15] round=1 local utility u=0.046752 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7747659625028768, 'loss_val': 1.2791183953403131, 'psi': 0.39374657581808575}-{'f1_val': 0.13973365136155833, 'auprc': 0.7590386809734636, 'loss_val': 1.3254397458229845, 'psi': 0.38745566320632047}
[S16] START round=1 head_norm_before_train=1.104914 (no previous merge yet)
[S16] round=1 local utility u=0.018564 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.769676593397292, 'loss_val': 1.301015450393706, 'psi': 0.3922531074784388}-{'f1_val': 0.14063745019920318, 'auprc': 0.766514180035892, 'loss_val': 1.328656029781568, 'psi': 0.3909881421338788}
[S17] START round=1 head_norm_before_train=1.148320 (no previous merge yet)
[S17] round=1 local utility u=0.148352 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5582919733603948, 'loss_val': 1.3133078069808903, 'psi': 0.30788616733458857}-{'f1_val': 0.14094896331738438, 'auprc': 0.4785132375138768, 'loss_val': 1.3706751728866793, 'psi': 0.27597467299598133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:45908
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:45902
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:45907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S6] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:45908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S5] → sending delta(kind=head bytes=1783) to S2@127.0.0.1:45902
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:45905
[S9] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1783 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1789 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1783) from S5
[S2] cosine check vs S5: cos=-0.0563
[S2] DROPPED delta from S5 (cos=-0.0563 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1789) from S6
[S7] cosine check vs S6: cos=-0.0362
[S7] DROPPED delta from S6 (cos=-0.0362 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1794) from S15
[S7] cosine check vs S15: cos=0.0877
[S5] RECEIVED delta(kind=head bytes=1798) from S14
[S5] cosine check vs S14: cos=-0.1587
[S5] DROPPED delta from S14 (cos=-0.1587 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1790) from S7
[S11] cosine check vs S7: cos=-0.0633
[S11] DROPPED delta from S7 (cos=-0.0633 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S3
[S11] cosine check vs S3: cos=-0.0323
[S11] DROPPED delta from S3 (cos=-0.0323 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1792) from S11
[S2] cosine check vs S11: cos=0.0974
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=0.0991
[S15] RECEIVED delta(kind=head bytes=1790) from S16
[S15] cosine check vs S16: cos=-0.0338
[S15] DROPPED delta from S16 (cos=-0.0338 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1792) from S13
[S6] cosine check vs S13: cos=-0.0493
[S6] DROPPED delta from S13 (cos=-0.0493 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1791) from S9
[S3] cosine check vs S9: cos=0.0290
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:45902
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S17
[S2] cosine check vs S17: cos=-0.0760
[S2] DROPPED delta from S17 (cos=-0.0760 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.232529
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.012964e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.883324 delta_norm=0.801296
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.199635
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.121620e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.886792 delta_norm=0.812162
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=1 metric=0.1398 head_norm=1.192371
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.916935e-01
[S3] stored merged vector for next round verification (round=1)
[S3] DEBUG after merge:  round=1 metric=0.1398 head_norm=0.756090 delta_norm=0.691694
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.883324 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6128940150884041, 'loss_val': 1.250559676267527, 'psi': 0.33022388606850167}-{'f1_val': 0.1417771333885667, 'auprc': 0.7531493271032104, 'loss_val': 1.2748745705507254, 'psi': 0.3863260108744242}
[S3] START round=2 head_norm_before_train=0.756090 cos_to_last_merge=1.0000 (last merge round=1)
[S3] round=2 local utility u=0.223444 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9981018641429971, 'loss_val': 1.3259889780786507, 'psi': 0.48314478502566305}-{'f1_val': 0.13984006561410703, 'auprc': 0.8499951743498859, 'loss_val': 1.3285559833692433, 'psi': 0.42390210910841863}
[S4] START round=2 head_norm_before_train=1.212928 (no previous merge yet)
[S4] round=2 local utility u=0.059952 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7936351240358956, 'loss_val': 1.13111683446474, 'psi': 0.4015900269514688}-{'f1_val': 0.14022662889518414, 'auprc': 0.7937939323889112, 'loss_val': 1.2514966346986682, 'psi': 0.40165355029267497}
[S5] START round=2 head_norm_before_train=1.152771 (no previous merge yet)
[S5] round=2 local utility u=0.310750 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7256424309653797, 'loss_val': 1.2722717303150137, 'psi': 0.37561411524329474}-{'f1_val': 0.14226190476190476, 'auprc': 0.52963969676467, 'loss_val': 1.3057638790504424, 'psi': 0.2972130215630109}
[S6] START round=2 head_norm_before_train=1.243995 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6343972363005979, 'loss_val': 1.1843925080397795, 'psi': 0.33861466375100835}-{'f1_val': 0.14142628205128205, 'auprc': 0.7746707784668211, 'loss_val': 1.277791843483799, 'psi': 0.39472408061749764}
[S7] START round=2 head_norm_before_train=0.886792 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.461916 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7611307287562693, 'loss_val': 1.3156965843050208, 'psi': 0.38968638513996273}-{'f1_val': 0.14205682272909165, 'auprc': 0.4574278995352822, 'loss_val': 1.3284199068248133, 'psi': 0.26820525345156787}
[S8] START round=2 head_norm_before_train=1.245530 (no previous merge yet)
[S8] round=2 local utility u=0.035290 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7661141274982282, 'loss_val': 1.213499829454075, 'psi': 0.3904192404350656}-{'f1_val': 0.13995598239295717, 'auprc': 0.7660934357620496, 'loss_val': 1.2840179386847652, 'psi': 0.3904109637405942}
[S9] START round=2 head_norm_before_train=1.136028 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9998069787589318, 'loss_val': 1.2729475144601905, 'psi': 0.48476156578757035}-{'f1_val': 0.38109043756074557, 'auprc': 0.9969529730871292, 'loss_val': 1.3165226933639593, 'psi': 0.627435451771299}
[S10] START round=2 head_norm_before_train=1.203098 (no previous merge yet)
[S10] round=2 local utility u=0.037394 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6393607391094173, 'loss_val': 1.1925879334065987, 'psi': 0.3389172781688013}-{'f1_val': 0.13862163754172394, 'auprc': 0.6422173006307299, 'loss_val': 1.2759458586528567, 'psi': 0.34005990277732634}
[S11] START round=2 head_norm_before_train=1.151324 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7785692540426137, 'loss_val': 1.2786744287542282, 'psi': 0.3956759116409118}-{'f1_val': 0.14041368337311058, 'auprc': 0.8048155018227489, 'loss_val': 1.3223696920163281, 'psi': 0.4061744107529659}
[S13] START round=2 head_norm_before_train=1.180061 (no previous merge yet)
[S13] round=2 local utility u=0.221592 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7166969193656755, 'loss_val': 1.2126638270566736, 'psi': 0.37091022529250206}-{'f1_val': 0.1403857625770531, 'auprc': 0.5880158784871656, 'loss_val': 1.2698049067986454, 'psi': 0.31943780894109813}
[S14] START round=2 head_norm_before_train=1.161169 (no previous merge yet)
[S14] round=2 local utility u=0.079173 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7108108413751357, 'loss_val': 1.3151187060230232, 'psi': 0.36853904827967654}-{'f1_val': 0.14735963264454185, 'auprc': 0.6521713830958203, 'loss_val': 1.339557998716773, 'psi': 0.3492843328250532}
[S15] START round=2 head_norm_before_train=1.205358 (no previous merge yet)
[S15] round=2 local utility u=0.043048 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770516753115453, 'loss_val': 1.1998785973627377, 'psi': 0.3946608609415531}-{'f1_val': 0.13973365136155833, 'auprc': 0.7747659625028768, 'loss_val': 1.2791183953403131, 'psi': 0.39374657581808575}
[S16] START round=2 head_norm_before_train=1.117446 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.744615002618305, 'loss_val': 1.2677543927784392, 'psi': 0.3822284711668439}-{'f1_val': 0.14063745019920318, 'auprc': 0.769676593397292, 'loss_val': 1.301015450393706, 'psi': 0.3922531074784388}
[S17] START round=2 head_norm_before_train=1.172096 (no previous merge yet)
[S17] round=2 local utility u=0.042501 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5558196895710916, 'loss_val': 1.2208894245027955, 'psi': 0.3068972538188673}-{'f1_val': 0.14094896331738438, 'auprc': 0.5582919733603948, 'loss_val': 1.3133078069808903, 'psi': 0.30788616733458857}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:45915
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:45910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:45917
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:45912
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:45917
[S3] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S10
[S11] cosine check vs S10: cos=-0.0204
[S11] DROPPED delta from S10 (cos=-0.0204 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S14
[S9] cosine check vs S14: cos=-0.0014
[S9] DROPPED delta from S14 (cos=-0.0014 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S4
[S17] cosine check vs S4: cos=-0.0265
[S17] DROPPED delta from S4 (cos=-0.0265 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S8
[S17] cosine check vs S8: cos=-0.0526
[S17] DROPPED delta from S8 (cos=-0.0526 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] cosine check vs S13: cos=-0.0094
[S16] DROPPED delta from S13 (cos=-0.0094 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S7
[S15] cosine check vs S7: cos=0.7254
[S14] RECEIVED delta(kind=head bytes=1793) from S5
[S14] cosine check vs S5: cos=-0.1558
[S14] DROPPED delta from S5 (cos=-0.1558 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S15
[S2] cosine check vs S15: cos=0.0672
[S11] RECEIVED delta(kind=head bytes=1792) from S3
[S11] cosine check vs S3: cos=-0.0281
[S11] DROPPED delta from S3 (cos=-0.0281 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:45905
[S17] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S17
[S5] cosine check vs S17: cos=-0.0600
[S5] DROPPED delta from S17 (cos=-0.0600 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=0.926949
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.580569e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.808343 delta_norm=0.758057
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=2 metric=0.1397 head_norm=1.263687
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.349368e-01
[S15] stored merged vector for next round verification (round=2)
[S15] DEBUG after merge:  round=2 metric=0.1397 head_norm=1.008999 delta_norm=0.434937
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.808343 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.137837 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6879958000162716, 'loss_val': 1.2001906638902786, 'psi': 0.36026460003964866}-{'f1_val': 0.1417771333885667, 'auprc': 0.6128940150884041, 'loss_val': 1.250559676267527, 'psi': 0.33022388606850167}
[S3] START round=3 head_norm_before_train=0.779512 cos_to_last_merge=0.9964 (last merge round=1)
[S3] round=3 local utility u=0.019650 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9983007180357519, 'loss_val': 1.2872862985280977, 'psi': 0.48322432658276504}-{'f1_val': 0.13984006561410703, 'auprc': 0.9981018641429971, 'loss_val': 1.3259889780786507, 'psi': 0.48314478502566305}
[S4] START round=3 head_norm_before_train=1.276836 (no previous merge yet)
[S4] round=3 local utility u=1.000000 metrics={'f1_val': 0.6853392693160191, 'auprc': 0.7874684066131165, 'loss_val': 0.8887144487212678, 'psi': 0.7261909242348581}-{'f1_val': 0.14022662889518414, 'auprc': 0.7936351240358956, 'loss_val': 1.13111683446474, 'psi': 0.4015900269514688}
[S5] START round=3 head_norm_before_train=1.174983 (no previous merge yet)
[S5] round=3 local utility u=0.021142 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7288616933154893, 'loss_val': 1.239644826106732, 'psi': 0.3769018201833386}-{'f1_val': 0.14226190476190476, 'auprc': 0.7256424309653797, 'loss_val': 1.2722717303150137, 'psi': 0.37561411524329474}
[S6] START round=3 head_norm_before_train=1.296084 (no previous merge yet)
[S6] round=3 local utility u=0.981750 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.6768296449338775, 'loss_val': 1.0007628662623984, 'psi': 0.5208449694998714}-{'f1_val': 0.14142628205128205, 'auprc': 0.6343972363005979, 'loss_val': 1.1843925080397795, 'psi': 0.33861466375100835}
[S7] START round=3 head_norm_before_train=0.904208 cos_to_last_merge=0.9974 (last merge round=1)
[S7] round=3 local utility u=0.057016 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7890686046773194, 'loss_val': 1.2854772979160505, 'psi': 0.40086153550838277}-{'f1_val': 0.14205682272909165, 'auprc': 0.7611307287562693, 'loss_val': 1.3156965843050208, 'psi': 0.38968638513996273}
[S8] START round=3 head_norm_before_train=1.278885 (no previous merge yet)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.7145237961103252, 'auprc': 0.7781574135859181, 'loss_val': 1.0321939712104484, 'psi': 0.7399772431005625}-{'f1_val': 0.13995598239295717, 'auprc': 0.7661141274982282, 'loss_val': 1.213499829454075, 'psi': 0.3904192404350656}
[S9] START round=3 head_norm_before_train=1.154344 (no previous merge yet)
[S9] round=3 local utility u=0.013565 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9901726000342861, 'loss_val': 1.2169139442033978, 'psi': 0.48090781429771207}-{'f1_val': 0.141397957139996, 'auprc': 0.9998069787589318, 'loss_val': 1.2729475144601905, 'psi': 0.48476156578757035}
[S10] START round=3 head_norm_before_train=1.252072 (no previous merge yet)
[S10] round=3 local utility u=0.910048 metrics={'f1_val': 0.41670936461107344, 'auprc': 0.6344701912290417, 'loss_val': 1.0263458620790211, 'psi': 0.5038136952582607}-{'f1_val': 0.13862163754172394, 'auprc': 0.6393607391094173, 'loss_val': 1.1925879334065987, 'psi': 0.3389172781688013}
[S11] START round=3 head_norm_before_train=1.173346 (no previous merge yet)
[S11] round=3 local utility u=0.011631 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7671667295107514, 'loss_val': 1.2212053364763353, 'psi': 0.39111490182816694}-{'f1_val': 0.14041368337311058, 'auprc': 0.7785692540426137, 'loss_val': 1.2786744287542282, 'psi': 0.3956759116409118}
[S13] START round=3 head_norm_before_train=1.224264 (no previous merge yet)
[S13] round=3 local utility u=0.899049 metrics={'f1_val': 0.41607788054795825, 'auprc': 0.7304041431740416, 'loss_val': 1.109840632872451, 'psi': 0.5418083855983915}-{'f1_val': 0.1403857625770531, 'auprc': 0.7166969193656755, 'loss_val': 1.2126638270566736, 'psi': 0.37091022529250206}
[S14] START round=3 head_norm_before_train=1.185335 (no previous merge yet)
[S14] round=3 local utility u=0.074791 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.750253339516536, 'loss_val': 1.2838650270526728, 'psi': 0.3843160475362367}-{'f1_val': 0.14035785288270378, 'auprc': 0.7108108413751357, 'loss_val': 1.3151187060230232, 'psi': 0.36853904827967654}
[S15] START round=3 head_norm_before_train=1.008999 cos_to_last_merge=1.0000 (last merge round=2)
[S15] round=3 local utility u=0.891491 metrics={'f1_val': 0.4157993423538048, 'auprc': 0.7768086928451452, 'loss_val': 1.0725617979043045, 'psi': 0.560203082550341}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770516753115453, 'loss_val': 1.1998785973627377, 'psi': 0.3946608609415531}
[S16] START round=3 head_norm_before_train=1.140832 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6833127238377852, 'loss_val': 1.2252064478419034, 'psi': 0.35770755965463596}-{'f1_val': 0.14063745019920318, 'auprc': 0.744615002618305, 'loss_val': 1.2677543927784392, 'psi': 0.3822284711668439}
[S17] START round=3 head_norm_before_train=1.222268 (no previous merge yet)
[S17] round=3 local utility u=0.867198 metrics={'f1_val': 0.3816960956473532, 'auprc': 0.5969347042413854, 'loss_val': 1.0543203684435607, 'psi': 0.46779153908496607}-{'f1_val': 0.14094896331738438, 'auprc': 0.5558196895710916, 'loss_val': 1.2208894245027955, 'psi': 0.3068972538188673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S5] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:45916
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:45904
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1788 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1792) from S9
[S16] cosine check vs S9: cos=-0.0160
[S16] DROPPED delta from S9 (cos=-0.0160 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1788) from S5
[S16] cosine check vs S5: cos=-0.0206
[S16] DROPPED delta from S5 (cos=-0.0206 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S13
[S2] cosine check vs S13: cos=0.0631
[S4] RECEIVED delta(kind=head bytes=1803) from S7
[S4] cosine check vs S7: cos=0.0404
[S13] RECEIVED delta(kind=head bytes=1792) from S15
[S13] cosine check vs S15: cos=0.0325
[S3] RECEIVED delta(kind=head bytes=1805) from S8
[S3] cosine check vs S8: cos=0.4550
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] cosine check vs S4: cos=0.0502
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] cosine check vs S14: cos=0.0284
[S8] RECEIVED delta(kind=head bytes=1789) from S10
[S8] cosine check vs S10: cos=0.0222
[S17] RECEIVED delta(kind=head bytes=1796) from S3
[S17] cosine check vs S3: cos=-0.0144
[S17] DROPPED delta from S3 (cos=-0.0144 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S11
[S16] cosine check vs S11: cos=0.0247
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] cosine check vs S6: cos=-0.0021
[S17] DROPPED delta from S6 (cos=-0.0021 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1793) from S2
[S17] cosine check vs S2: cos=-0.0093
[S17] DROPPED delta from S2 (cos=-0.0093 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S17
[S14] cosine check vs S17: cos=0.0081
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.7145 head_norm=1.325354
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.209585e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.5555 head_norm=0.941590 delta_norm=0.920958
[S8] aggregate: ROLLBACK (f1_val pre=0.715 post=0.555 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.4161 head_norm=1.264636
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.189727e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.4165 head_norm=0.845722 delta_norm=0.818973
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=0.858211
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.414120e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1418 head_norm=0.786272 delta_norm=0.741412
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=1.204009
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.442026e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.868526 delta_norm=0.844203
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=0.814957
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.995529e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.922440 delta_norm=0.599553
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.218356
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.448847e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.776168 delta_norm=0.744885
[S14] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.6853 head_norm=1.351322
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.040769e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.6812 head_norm=0.835008 delta_norm=0.804077
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=1.170364
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.291386e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.849837 delta_norm=0.829139
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.786272 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=1.000000 metrics={'f1_val': 0.41718992167751023, 'auprc': 0.7760272938093462, 'loss_val': 1.0689354858881843, 'psi': 0.5607248705302446}-{'f1_val': 0.1417771333885667, 'auprc': 0.6879958000162716, 'loss_val': 1.2001906638902786, 'psi': 0.36026460003964866}
[S3] START round=4 head_norm_before_train=0.922440 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8667458519412687, 'loss_val': 1.2547345230703473, 'psi': 0.43060238014497176}-{'f1_val': 0.13984006561410703, 'auprc': 0.9983007180357519, 'loss_val': 1.2872862985280977, 'psi': 0.48322432658276504}
[S4] START round=4 head_norm_before_train=0.835008 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.6690573109331884, 'auprc': 0.6649523035248447, 'loss_val': 0.7585653755225914, 'psi': 0.6674153079698509}-{'f1_val': 0.6853392693160191, 'auprc': 0.7874684066131165, 'loss_val': 0.8887144487212678, 'psi': 0.7261909242348581}
[S5] START round=4 head_norm_before_train=1.195665 (no previous merge yet)
[S5] round=4 local utility u=0.034270 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7366954385760298, 'loss_val': 1.194605231217433, 'psi': 0.38003531828755477}-{'f1_val': 0.14226190476190476, 'auprc': 0.7288616933154893, 'loss_val': 1.239644826106732, 'psi': 0.3769018201833386}
[S6] START round=4 head_norm_before_train=1.345401 (no previous merge yet)
[S6] round=4 local utility u=0.497949 metrics={'f1_val': 0.4858933760146966, 'auprc': 0.7903628103893294, 'loss_val': 0.7596936439877151, 'psi': 0.6076811497645498}-{'f1_val': 0.4168551858772006, 'auprc': 0.6768296449338775, 'loss_val': 1.0007628662623984, 'psi': 0.5208449694998714}
[S7] START round=4 head_norm_before_train=0.928162 cos_to_last_merge=0.9913 (last merge round=1)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7765305030734788, 'loss_val': 1.2646017221666712, 'psi': 0.3958462948668465}-{'f1_val': 0.14205682272909165, 'auprc': 0.7890686046773194, 'loss_val': 1.2854772979160505, 'psi': 0.40086153550838277}
[S8] START round=4 head_norm_before_train=0.941590 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.5664865506397493, 'auprc': 0.7942274500189054, 'loss_val': 0.8725352041376472, 'psi': 0.6575829103914117}-{'f1_val': 0.7145237961103252, 'auprc': 0.7781574135859181, 'loss_val': 1.0321939712104484, 'psi': 0.7399772431005625}
[S9] START round=4 head_norm_before_train=1.179250 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8967215903575382, 'loss_val': 1.146336181985611, 'psi': 0.4435274104270129}-{'f1_val': 0.141397957139996, 'auprc': 0.9901726000342861, 'loss_val': 1.2169139442033978, 'psi': 0.48090781429771207}
[S10] START round=4 head_norm_before_train=1.308796 (no previous merge yet)
[S10] round=4 local utility u=0.484289 metrics={'f1_val': 0.43199963318438844, 'auprc': 0.8397359230368764, 'loss_val': 0.765307172809523, 'psi': 0.5950941491253836}-{'f1_val': 0.41670936461107344, 'auprc': 0.6344701912290417, 'loss_val': 1.0263458620790211, 'psi': 0.5038136952582607}
[S11] START round=4 head_norm_before_train=0.868526 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7471238362298519, 'loss_val': 1.2291448442814257, 'psi': 0.38309774451580714}-{'f1_val': 0.14041368337311058, 'auprc': 0.7671667295107514, 'loss_val': 1.2212053364763353, 'psi': 0.39111490182816694}
[S13] START round=4 head_norm_before_train=0.845722 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.3736412577073086, 'auprc': 0.7697344691540698, 'loss_val': 0.9930963984464384, 'psi': 0.5320785422860131}-{'f1_val': 0.41607788054795825, 'auprc': 0.7304041431740416, 'loss_val': 1.109840632872451, 'psi': 0.5418083855983915}
[S14] START round=4 head_norm_before_train=0.776168 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6007363090884368, 'loss_val': 1.2908362904060882, 'psi': 0.324509235364997}-{'f1_val': 0.14035785288270378, 'auprc': 0.750253339516536, 'loss_val': 1.2838650270526728, 'psi': 0.3843160475362367}
[S15] START round=4 head_norm_before_train=1.082876 cos_to_last_merge=0.9959 (last merge round=2)
[S15] round=4 local utility u=0.774535 metrics={'f1_val': 0.6140231899987154, 'auprc': 0.7996595000362974, 'loss_val': 0.7813879817135045, 'psi': 0.6882777140137482}-{'f1_val': 0.4157993423538048, 'auprc': 0.7768086928451452, 'loss_val': 1.0725617979043045, 'psi': 0.560203082550341}
[S16] START round=4 head_norm_before_train=0.849837 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.4621494758972051, 'loss_val': 1.2243932984959265, 'psi': 0.26924226047840394}-{'f1_val': 0.14063745019920318, 'auprc': 0.6833127238377852, 'loss_val': 1.2252064478419034, 'psi': 0.35770755965463596}
[S17] START round=4 head_norm_before_train=1.271216 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.35812280455247997, 'auprc': 0.5756438327951592, 'loss_val': 0.8937275307420789, 'psi': 0.4451312158495516}-{'f1_val': 0.3816960956473532, 'auprc': 0.5969347042413854, 'loss_val': 1.0543203684435607, 'psi': 0.46779153908496607}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:45909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S5] → sending delta(kind=head bytes=1787) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:45917
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:45913
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1787 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S10
[S8] cosine check vs S10: cos=0.6635
[S17] RECEIVED delta(kind=head bytes=1799) from S2
[S17] cosine check vs S2: cos=0.0242
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=-0.0078
[S17] DROPPED delta from S6 (cos=-0.0078 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1787) from S5
[S16] cosine check vs S5: cos=0.0246
[S13] RECEIVED delta(kind=head bytes=1793) from S15
[S13] cosine check vs S15: cos=0.6255
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=4 metric=0.3736 head_norm=0.899357
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.631903e-01
[S13] stored merged vector for next round verification (round=4)
[S13] DEBUG after merge:  round=4 metric=0.3716 head_norm=0.933357 delta_norm=0.463190
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.5665 head_norm=1.011654
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.179080e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.7155 head_norm=1.092440 delta_norm=0.517908
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.3581 head_norm=1.329257
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.760966e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.3540 head_norm=0.793220 delta_norm=0.776097
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.874852
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.403799e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.757823 delta_norm=0.740380
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.834339 cos_to_last_merge=0.9878 (last merge round=3)
[S2] round=5 local utility u=0.876255 metrics={'f1_val': 0.7006329103623964, 'auprc': 0.7015030310396356, 'loss_val': 0.793511494828973, 'psi': 0.7009809586332921}-{'f1_val': 0.41718992167751023, 'auprc': 0.7760272938093462, 'loss_val': 1.0689354858881843, 'psi': 0.5607248705302446}
[S3] START round=5 head_norm_before_train=0.951992 cos_to_last_merge=0.9972 (last merge round=3)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8088101921002631, 'loss_val': 1.1915020907490679, 'psi': 0.40742811620856945}-{'f1_val': 0.13984006561410703, 'auprc': 0.8667458519412687, 'loss_val': 1.2547345230703473, 'psi': 0.43060238014497176}
[S4] START round=5 head_norm_before_train=0.933343 cos_to_last_merge=0.9894 (last merge round=3)
[S4] round=5 local utility u=0.154684 metrics={'f1_val': 0.6870559877348595, 'auprc': 0.6717922440047177, 'loss_val': 0.577710073891176, 'psi': 0.6809504902428027}-{'f1_val': 0.6690573109331884, 'auprc': 0.6649523035248447, 'loss_val': 0.7585653755225914, 'psi': 0.6674153079698509}
[S5] START round=5 head_norm_before_train=1.216367 (no previous merge yet)
[S5] round=5 local utility u=0.906973 metrics={'f1_val': 0.41654174186412063, 'auprc': 0.7684646726153154, 'loss_val': 1.1216463265173464, 'psi': 0.5573109141645985}-{'f1_val': 0.14226190476190476, 'auprc': 0.7366954385760298, 'loss_val': 1.194605231217433, 'psi': 0.38003531828755477}
[S6] START round=5 head_norm_before_train=1.409447 (no previous merge yet)
[S6] round=5 local utility u=1.000000 metrics={'f1_val': 0.7097608225167508, 'auprc': 0.9714817530118516, 'loss_val': 0.5605740754922903, 'psi': 0.8144491947147912}-{'f1_val': 0.4858933760146966, 'auprc': 0.7903628103893294, 'loss_val': 0.7596936439877151, 'psi': 0.6076811497645498}
[S7] START round=5 head_norm_before_train=0.951808 cos_to_last_merge=0.9851 (last merge round=1)
[S7] round=5 local utility u=0.011396 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7768871149684388, 'loss_val': 1.2428791391462932, 'psi': 0.3959889396248305}-{'f1_val': 0.14205682272909165, 'auprc': 0.7765305030734788, 'loss_val': 1.2646017221666712, 'psi': 0.3958462948668465}
[S8] START round=5 head_norm_before_train=1.092440 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.806979 metrics={'f1_val': 0.7141742661762565, 'auprc': 0.997852953319263, 'loss_val': 0.7555792033450351, 'psi': 0.8276457410334591}-{'f1_val': 0.5664865506397493, 'auprc': 0.7942274500189054, 'loss_val': 0.8725352041376472, 'psi': 0.6575829103914117}
[S9] START round=5 head_norm_before_train=1.211658 (no previous merge yet)
[S9] round=5 local utility u=0.008657 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8662361993899128, 'loss_val': 1.0375659018607906, 'psi': 0.43133325403996275}-{'f1_val': 0.141397957139996, 'auprc': 0.8967215903575382, 'loss_val': 1.146336181985611, 'psi': 0.4435274104270129}
[S10] START round=5 head_norm_before_train=1.378355 (no previous merge yet)
[S10] round=5 local utility u=0.950006 metrics={'f1_val': 0.6998960103573175, 'auprc': 0.8571659572921638, 'loss_val': 0.5249632700684371, 'psi': 0.7628039891312561}-{'f1_val': 0.43199963318438844, 'auprc': 0.8397359230368764, 'loss_val': 0.765307172809523, 'psi': 0.5950941491253836}
[S11] START round=5 head_norm_before_train=0.887942 cos_to_last_merge=0.9973 (last merge round=3)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6682824787007094, 'loss_val': 1.1640784457969835, 'psi': 0.35156120150415016}-{'f1_val': 0.14041368337311058, 'auprc': 0.7471238362298519, 'loss_val': 1.2291448442814257, 'psi': 0.38309774451580714}
[S13] START round=5 head_norm_before_train=0.933357 cos_to_last_merge=1.0000 (last merge round=4)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.37169029467602305, 'auprc': 0.7441900471084657, 'loss_val': 0.9260665334846111, 'psi': 0.5206901956490001}-{'f1_val': 0.3736412577073086, 'auprc': 0.7697344691540698, 'loss_val': 0.9930963984464384, 'psi': 0.5320785422860131}
[S14] START round=5 head_norm_before_train=0.813112 cos_to_last_merge=0.9964 (last merge round=3)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5009451532892899, 'loss_val': 1.275488395621653, 'psi': 0.28459277304533825}-{'f1_val': 0.14035785288270378, 'auprc': 0.6007363090884368, 'loss_val': 1.2908362904060882, 'psi': 0.324509235364997}
[S15] START round=5 head_norm_before_train=1.167287 cos_to_last_merge=0.9859 (last merge round=2)
[S15] round=5 local utility u=0.390927 metrics={'f1_val': 0.7015486852681293, 'auprc': 0.7994421825487408, 'loss_val': 0.5240341172118251, 'psi': 0.7407060841803739}-{'f1_val': 0.6140231899987154, 'auprc': 0.7996595000362974, 'loss_val': 0.7813879817135045, 'psi': 0.6882777140137482}
[S16] START round=5 head_norm_before_train=0.757823 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.434163 metrics={'f1_val': 0.17234205894468785, 'auprc': 0.6698102095105103, 'loss_val': 1.169276638297959, 'psi': 0.37132931917101686}-{'f1_val': 0.14063745019920318, 'auprc': 0.4621494758972051, 'loss_val': 1.2243932984959265, 'psi': 0.26924226047840394}
[S17] START round=5 head_norm_before_train=0.793220 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.122950 metrics={'f1_val': 0.37218163118259573, 'auprc': 0.6153518742019228, 'loss_val': 0.8513052343363231, 'psi': 0.4694497283903266}-{'f1_val': 0.35812280455247997, 'auprc': 0.5756438327951592, 'loss_val': 0.8937275307420789, 'psi': 0.4451312158495516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:45914
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:45913
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:45917
[S16] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] cosine check vs S5: cos=0.7899
[S15] RECEIVED delta(kind=head bytes=1795) from S16
[S15] cosine check vs S16: cos=-0.0792
[S15] DROPPED delta from S16 (cos=-0.0792 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S7
[S4] cosine check vs S7: cos=0.4613
[S13] RECEIVED delta(kind=head bytes=1793) from S15
[S13] cosine check vs S15: cos=0.8799
[S8] RECEIVED delta(kind=head bytes=1802) from S10
[S8] cosine check vs S10: cos=0.8908
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] cosine check vs S4: cos=0.3780
[S17] RECEIVED delta(kind=head bytes=1792) from S2
[S17] cosine check vs S2: cos=0.4797
[S17] RECEIVED delta(kind=head bytes=1804) from S6
[S17] cosine check vs S6: cos=-0.0362
[S17] DROPPED delta from S6 (cos=-0.0362 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S9
[S16] cosine check vs S9: cos=0.0566
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=0.3693
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S17
[S14] cosine check vs S17: cos=0.2603
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.855883
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.181518e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.666295 delta_norm=0.418152
[S14] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.371 → S11@127.0.0.1:45912
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.3717 head_norm=0.993934
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.070906e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.3717 head_norm=1.096642 delta_norm=0.307091
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.474 → S2@127.0.0.1:45902
[S11] ⇄ pheromone p=0.336 → S16@127.0.0.1:45916
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=0.982493
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.032149e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.1398 head_norm=0.884110 delta_norm=0.603215
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.371 → S17@127.0.0.1:45917
[S2] ⇄ pheromone p=0.681 → S17@127.0.0.1:45917
[S5] ⇄ pheromone p=0.552 → S16@127.0.0.1:45916
[S9] ⇄ pheromone p=0.410 → S16@127.0.0.1:45916
[S15] ⇄ pheromone p=0.652 → S13@127.0.0.1:45913
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1723 head_norm=0.783873
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.851411e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.2642 head_norm=0.747699 delta_norm=0.385141
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.416 → S15@127.0.0.1:45915
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.6871 head_norm=1.057628
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.264946e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.6844 head_norm=0.865091 delta_norm=0.526495
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.493 → S14@127.0.0.1:45914
[S10] ⇄ pheromone p=0.715 → S8@127.0.0.1:45909
[S6] ⇄ pheromone p=0.752 → S17@127.0.0.1:45917
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.7142 head_norm=1.151410
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.398844e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.7145 head_norm=1.269905 delta_norm=0.339884
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.660 → S3@127.0.0.1:45903
[S7] ⇄ pheromone p=0.408 → S4@127.0.0.1:45904
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.3722 head_norm=0.879940
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.574392e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.3587 head_norm=0.771129 delta_norm=0.457439
[S17] aggregate: ROLLBACK (f1_val pre=0.372 post=0.359 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.480 → S14@127.0.0.1:45914
[S2] START round=6 head_norm_before_train=0.912955 cos_to_last_merge=0.9573 (last merge round=3)
[S2] round=6 local utility u=0.175917 metrics={'f1_val': 0.7013830046335864, 'auprc': 0.7550360491505557, 'loss_val': 0.6067776228774645, 'psi': 0.7228442224403742}-{'f1_val': 0.7006329103623964, 'auprc': 0.7015030310396356, 'loss_val': 0.793511494828973, 'psi': 0.7009809586332921}
[S3] START round=6 head_norm_before_train=0.884110 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6042519785005293, 'loss_val': 1.1469604596201144, 'psi': 0.32560483076867597}-{'f1_val': 0.13984006561410703, 'auprc': 0.8088101921002631, 'loss_val': 1.1915020907490679, 'psi': 0.40742811620856945}
[S4] START round=6 head_norm_before_train=0.865091 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.6685419419233409, 'auprc': 0.6599727023520312, 'loss_val': 0.5512486252136045, 'psi': 0.665114246094817}-{'f1_val': 0.6870559877348595, 'auprc': 0.6717922440047177, 'loss_val': 0.577710073891176, 'psi': 0.6809504902428027}
[S5] START round=6 head_norm_before_train=1.237454 (no previous merge yet)
[S5] round=6 local utility u=0.073600 metrics={'f1_val': 0.4177505557824055, 'auprc': 0.7730056330470884, 'loss_val': 0.9953225473286273, 'psi': 0.5598525866882786}-{'f1_val': 0.41654174186412063, 'auprc': 0.7684646726153154, 'loss_val': 1.1216463265173464, 'psi': 0.5573109141645985}
[S6] START round=6 head_norm_before_train=1.464458 (no previous merge yet)
[S6] round=6 local utility u=0.082811 metrics={'f1_val': 0.7097424202341364, 'auprc': 0.9851877336470518, 'loss_val': 0.4359587026901106, 'psi': 0.8199205455993026}-{'f1_val': 0.7097608225167508, 'auprc': 0.9714817530118516, 'loss_val': 0.5605740754922903, 'psi': 0.8144491947147912}
[S7] START round=6 head_norm_before_train=0.965703 cos_to_last_merge=0.9803 (last merge round=1)
[S7] round=6 local utility u=0.018945 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776521774939265, 'loss_val': 1.2072845387262423, 'psi': 0.3962949646350256}-{'f1_val': 0.14205682272909165, 'auprc': 0.7768871149684388, 'loss_val': 1.2428791391462932, 'psi': 0.3959889396248305}
[S8] START round=6 head_norm_before_train=1.269905 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.6271775777694981, 'auprc': 0.9962036266483174, 'loss_val': 0.5776563814453822, 'psi': 0.7747879973210259}-{'f1_val': 0.7141742661762565, 'auprc': 0.997852953319263, 'loss_val': 0.7555792033450351, 'psi': 0.8276457410334591}
[S9] START round=6 head_norm_before_train=1.243794 (no previous merge yet)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.4256909385113269, 'auprc': 0.9698252092191912, 'loss_val': 0.8539269463280474, 'psi': 0.6433446467944726}-{'f1_val': 0.141397957139996, 'auprc': 0.8662361993899128, 'loss_val': 1.0375659018607906, 'psi': 0.43133325403996275}
[S10] START round=6 head_norm_before_train=1.459663 (no previous merge yet)
[S10] round=6 local utility u=0.143886 metrics={'f1_val': 0.6885607782318169, 'auprc': 0.9298311370967116, 'loss_val': 0.38717528993994055, 'psi': 0.7850689217777749}-{'f1_val': 0.6998960103573175, 'auprc': 0.8571659572921638, 'loss_val': 0.5249632700684371, 'psi': 0.7628039891312561}
[S11] START round=6 head_norm_before_train=0.915235 cos_to_last_merge=0.9903 (last merge round=3)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.4225625868721864, 'auprc': 0.7698051225723972, 'loss_val': 1.0680665302882513, 'psi': 0.5614596011522708}-{'f1_val': 0.14041368337311058, 'auprc': 0.6682824787007094, 'loss_val': 1.1640784457969835, 'psi': 0.35156120150415016}
[S13] START round=6 head_norm_before_train=1.096642 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.613089 metrics={'f1_val': 0.5687908695870423, 'auprc': 0.7014384720539725, 'loss_val': 0.7542365638993507, 'psi': 0.6218499105738143}-{'f1_val': 0.37169029467602305, 'auprc': 0.7441900471084657, 'loss_val': 0.9260665334846111, 'psi': 0.5206901956490001}
[S14] START round=6 head_norm_before_train=0.666295 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.172104 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6020935229864172, 'loss_val': 1.234725562383479, 'psi': 0.3250521209241891}-{'f1_val': 0.14035785288270378, 'auprc': 0.5009451532892899, 'loss_val': 1.275488395621653, 'psi': 0.28459277304533825}
[S15] START round=6 head_norm_before_train=1.267263 cos_to_last_merge=0.9706 (last merge round=2)
[S15] round=6 local utility u=0.059780 metrics={'f1_val': 0.6951088208595035, 'auprc': 0.8170313900919205, 'loss_val': 0.4186025000497912, 'psi': 0.7438778485524704}-{'f1_val': 0.7015486852681293, 'auprc': 0.7994421825487408, 'loss_val': 0.5240341172118251, 'psi': 0.7407060841803739}
[S16] START round=6 head_norm_before_train=0.747699 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.762274 metrics={'f1_val': 0.41428462841297564, 'auprc': 0.6744602454299968, 'loss_val': 1.1103348460426343, 'psi': 0.5183548752197841}-{'f1_val': 0.17234205894468785, 'auprc': 0.6698102095105103, 'loss_val': 1.169276638297959, 'psi': 0.37132931917101686}
[S17] START round=6 head_norm_before_train=0.771129 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.074565 metrics={'f1_val': 0.35520353954913725, 'auprc': 0.7122332070149955, 'loss_val': 0.8909511917332715, 'psi': 0.4980154065354805}-{'f1_val': 0.37218163118259573, 'auprc': 0.6153518742019228, 'loss_val': 0.8513052343363231, 'psi': 0.4694497283903266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:45913
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:45917
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:45917
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:45915
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1793) from S13
[S2] cosine check vs S13: cos=0.5223
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] cosine check vs S14: cos=0.3737
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] cosine check vs S5: cos=0.8170
[S16] RECEIVED delta(kind=head bytes=1793) from S11
[S16] cosine check vs S11: cos=0.1234
[S4] RECEIVED delta(kind=head bytes=1795) from S7
[S4] cosine check vs S7: cos=0.7506
[S8] RECEIVED delta(kind=head bytes=1803) from S10
[S8] cosine check vs S10: cos=0.9461
[S13] RECEIVED delta(kind=head bytes=1797) from S15
[S13] cosine check vs S15: cos=0.9472
[S16] RECEIVED delta(kind=head bytes=1796) from S9
[S16] cosine check vs S9: cos=0.4539
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=-0.0435
[S17] DROPPED delta from S6 (cos=-0.0435 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1806) from S2
[S17] cosine check vs S2: cos=0.7638
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] cosine check vs S16: cos=-0.0075
[S15] DROPPED delta from S16 (cos=-0.0075 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] cosine check vs S17: cos=0.3998
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.6272 head_norm=1.327355
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.580342e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.9036 head_norm=1.414798 delta_norm=0.258034
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.6685 head_norm=0.978173
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.458540e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.6737 head_norm=0.916375 delta_norm=0.345854
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.5688 head_norm=1.142646
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.279011e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.5469 head_norm=1.231616 delta_norm=0.227901
[S13] aggregate: ROLLBACK (f1_val pre=0.569 post=0.547 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.4226 head_norm=0.941385
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.691192e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.4222 head_norm=0.681579 delta_norm=0.469119
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.695011
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.293753e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.649301 delta_norm=0.429375
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4143 head_norm=0.773526
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.362850e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.4149 head_norm=0.685122 delta_norm=0.236285
[S16] aggregate: ACCEPT kept=['S5', 'S11', 'S9'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.7014 head_norm=1.004062
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.280539e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.7016 head_norm=0.937043 delta_norm=0.528054
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.3552 head_norm=0.853738
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.269458e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.3545 head_norm=0.872703 delta_norm=0.326946
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.937043 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.7015730791798309, 'auprc': 0.6760973000853139, 'loss_val': 0.5177023763921138, 'psi': 0.6913827675420241}-{'f1_val': 0.7013830046335864, 'auprc': 0.7550360491505557, 'loss_val': 0.6067776228774645, 'psi': 0.7228442224403742}
[S3] START round=7 head_norm_before_train=0.904075 cos_to_last_merge=0.9965 (last merge round=5)
[S3] round=7 local utility u=1.000000 metrics={'f1_val': 0.39645225981545407, 'auprc': 0.7957290680703372, 'loss_val': 0.9933503894493985, 'psi': 0.5561629831174073}-{'f1_val': 0.13984006561410703, 'auprc': 0.6042519785005293, 'loss_val': 1.1469604596201144, 'psi': 0.32560483076867597}
[S4] START round=7 head_norm_before_train=0.916375 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.6676556377070331, 'auprc': 0.6596229526219098, 'loss_val': 0.5657650823353187, 'psi': 0.6644425636729838}-{'f1_val': 0.6685419419233409, 'auprc': 0.6599727023520312, 'loss_val': 0.5512486252136045, 'psi': 0.665114246094817}
[S5] START round=7 head_norm_before_train=1.265818 (no previous merge yet)
[S5] round=7 local utility u=0.074686 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.779235107185859, 'loss_val': 0.8641396762925373, 'psi': 0.5622943542541908}-{'f1_val': 0.4177505557824055, 'auprc': 0.7730056330470884, 'loss_val': 0.9953225473286273, 'psi': 0.5598525866882786}
[S6] START round=7 head_norm_before_train=1.524949 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.6208045922472165, 'auprc': 0.8252916588957001, 'loss_val': 0.47403362769673135, 'psi': 0.70259941890661}-{'f1_val': 0.7097424202341364, 'auprc': 0.9851877336470518, 'loss_val': 0.4359587026901106, 'psi': 0.8199205455993026}
[S7] START round=7 head_norm_before_train=0.980763 cos_to_last_merge=0.9746 (last merge round=1)
[S7] round=7 local utility u=0.033189 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778013683372659, 'loss_val': 1.141353941034969, 'psi': 0.39635464097236134}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776521774939265, 'loss_val': 1.2072845387262423, 'psi': 0.3962949646350256}
[S8] START round=7 head_norm_before_train=1.414798 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=1.000000 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.9959099711053636, 'loss_val': 0.3966667632853738, 'psi': 0.9963476367061427}-{'f1_val': 0.6271775777694981, 'auprc': 0.9962036266483174, 'loss_val': 0.5776563814453822, 'psi': 0.7747879973210259}
[S9] START round=7 head_norm_before_train=1.277836 (no previous merge yet)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.43674684171837874, 'auprc': 0.8659979001236467, 'loss_val': 0.6420949465116869, 'psi': 0.608447265080486}-{'f1_val': 0.4256909385113269, 'auprc': 0.9698252092191912, 'loss_val': 0.8539269463280474, 'psi': 0.6433446467944726}
[S10] START round=7 head_norm_before_train=1.540974 (no previous merge yet)
[S10] round=7 local utility u=0.136293 metrics={'f1_val': 0.6889822726774932, 'auprc': 0.9781540189573783, 'loss_val': 0.26208630763512886, 'psi': 0.8046509711894473}-{'f1_val': 0.6885607782318169, 'auprc': 0.9298311370967116, 'loss_val': 0.38717528993994055, 'psi': 0.7850689217777749}
[S11] START round=7 head_norm_before_train=0.681579 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.299072 metrics={'f1_val': 0.42273739039721175, 'auprc': 0.9624388833463107, 'loss_val': 1.0488721571552635, 'psi': 0.6386179875768514}-{'f1_val': 0.4225625868721864, 'auprc': 0.7698051225723972, 'loss_val': 1.0680665302882513, 'psi': 0.5614596011522708}
[S13] START round=7 head_norm_before_train=1.231616 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.136747 metrics={'f1_val': 0.5909699070782876, 'auprc': 0.752657940566708, 'loss_val': 0.7674755102427613, 'psi': 0.6556451204736558}-{'f1_val': 0.5687908695870423, 'auprc': 0.7014384720539725, 'loss_val': 0.7542365638993507, 'psi': 0.6218499105738143}
[S14] START round=7 head_norm_before_train=0.649301 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.447968 metrics={'f1_val': 0.15381263616557733, 'auprc': 0.868294517878375, 'loss_val': 1.2181218861182062, 'psi': 0.43960538885069644}-{'f1_val': 0.14035785288270378, 'auprc': 0.6020935229864172, 'loss_val': 1.234725562383479, 'psi': 0.3250521209241891}
[S15] START round=7 head_norm_before_train=1.353511 cos_to_last_merge=0.9569 (last merge round=2)
[S15] round=7 local utility u=0.113922 metrics={'f1_val': 0.6915552736333745, 'auprc': 0.8882398832454279, 'loss_val': 0.38306324159951427, 'psi': 0.7702291174781959}-{'f1_val': 0.6951088208595035, 'auprc': 0.8170313900919205, 'loss_val': 0.4186025000497912, 'psi': 0.7438778485524704}
[S16] START round=7 head_norm_before_train=0.685122 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.4167359650135119, 'auprc': 0.6443669634442621, 'loss_val': 1.03952356939077, 'psi': 0.507788364385812}-{'f1_val': 0.41428462841297564, 'auprc': 0.6744602454299968, 'loss_val': 1.1103348460426343, 'psi': 0.5183548752197841}
[S17] START round=7 head_norm_before_train=0.872703 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.093022 metrics={'f1_val': 0.35362895134290206, 'auprc': 0.7872048303858679, 'loss_val': 0.9203741811675089, 'psi': 0.5270593029600884}-{'f1_val': 0.35520353954913725, 'auprc': 0.7122332070149955, 'loss_val': 0.8909511917332715, 'psi': 0.4980154065354805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:45902
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:45913
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:45909
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:45917
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:45916
[S8] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S15
[S13] cosine check vs S15: cos=0.9695
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=0.6568
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] cosine check vs S14: cos=0.6173
[S8] RECEIVED delta(kind=head bytes=1803) from S10
[S8] cosine check vs S10: cos=0.9681
[S17] RECEIVED delta(kind=head bytes=1796) from S3
[S17] cosine check vs S3: cos=-0.0269
[S17] DROPPED delta from S3 (cos=-0.0269 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] cosine check vs S13: cos=0.8055
[S16] RECEIVED delta(kind=head bytes=1799) from S11
[S16] cosine check vs S11: cos=0.2832
[S4] RECEIVED delta(kind=head bytes=1793) from S7
[S4] cosine check vs S7: cos=0.8611
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.7125
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=0.7731
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.6677 head_norm=1.013484
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.661959e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6677 head_norm=0.974234 delta_norm=0.266196
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.7016 head_norm=1.015197
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.760351e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.7016 head_norm=1.085948 delta_norm=0.376035
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4167 head_norm=0.709632
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.295968e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.3916 head_norm=0.672218 delta_norm=0.229597
[S16] aggregate: ROLLBACK (f1_val pre=0.417 post=0.392 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.3965 head_norm=0.939965
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.543556e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.4074 head_norm=1.102167 delta_norm=0.554356
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.4227 head_norm=0.714338
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.034996e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.3964 head_norm=0.622624 delta_norm=0.303500
[S11] aggregate: ROLLBACK (f1_val pre=0.423 post=0.396 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1538 head_norm=0.670273
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.013044e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.3161 head_norm=0.761997 delta_norm=0.301304
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.9966 head_norm=1.469908
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.057379e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.9966 head_norm=1.526073 delta_norm=0.205738
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.5910 head_norm=1.269152
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.825517e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.5966 head_norm=1.335068 delta_norm=0.182552
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.085948 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.142462 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.7404003607337061, 'loss_val': 0.4241096520501728, 'psi': 0.7169462231172036}-{'f1_val': 0.7015730791798309, 'auprc': 0.6760973000853139, 'loss_val': 0.5177023763921138, 'psi': 0.6913827675420241}
[S3] START round=8 head_norm_before_train=1.102167 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.028813 metrics={'f1_val': 0.4009668676591264, 'auprc': 0.8120992095692119, 'loss_val': 1.0119227925645375, 'psi': 0.5654198044231606}-{'f1_val': 0.39645225981545407, 'auprc': 0.7957290680703372, 'loss_val': 0.9933503894493985, 'psi': 0.5561629831174073}
[S4] START round=8 head_norm_before_train=0.974234 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.6666478280875271, 'auprc': 0.6599249644568846, 'loss_val': 0.5606527115011893, 'psi': 0.6639586826352701}-{'f1_val': 0.6676556377070331, 'auprc': 0.6596229526219098, 'loss_val': 0.5657650823353187, 'psi': 0.6644425636729838}
[S5] START round=8 head_norm_before_train=1.295056 (no previous merge yet)
[S5] round=8 local utility u=0.074347 metrics={'f1_val': 0.41823357465624633, 'auprc': 0.8011867298573615, 'loss_val': 0.7846986348667737, 'psi': 0.5714148367366925}-{'f1_val': 0.4176671856330787, 'auprc': 0.779235107185859, 'loss_val': 0.8641396762925373, 'psi': 0.5622943542541908}
[S6] START round=8 head_norm_before_train=1.575161 (no previous merge yet)
[S6] round=8 local utility u=0.497741 metrics={'f1_val': 0.7019794677410052, 'auprc': 0.9649824107273886, 'loss_val': 0.38467322780498625, 'psi': 0.8071806449355585}-{'f1_val': 0.6208045922472165, 'auprc': 0.8252916588957001, 'loss_val': 0.47403362769673135, 'psi': 0.70259941890661}
[S7] START round=8 head_norm_before_train=1.006396 cos_to_last_merge=0.9658 (last merge round=1)
[S7] round=8 local utility u=0.874530 metrics={'f1_val': 0.4172381946317165, 'auprc': 0.7775013891674106, 'loss_val': 1.0424819076041283, 'psi': 0.5613434724459943}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778013683372659, 'loss_val': 1.141353941034969, 'psi': 0.39635464097236134}
[S8] START round=8 head_norm_before_train=1.526073 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9956370843246407, 'loss_val': 0.4183426990643887, 'psi': 0.8266261343702437}-{'f1_val': 0.9966394137733288, 'auprc': 0.9959099711053636, 'loss_val': 0.3966667632853738, 'psi': 0.9963476367061427}
[S9] START round=8 head_norm_before_train=1.325591 (no previous merge yet)
[S9] round=8 local utility u=1.000000 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9994069329481237, 'loss_val': 0.4305803612320376, 'psi': 0.8207316826101865}-{'f1_val': 0.43674684171837874, 'auprc': 0.8659979001236467, 'loss_val': 0.6420949465116869, 'psi': 0.608447265080486}
[S10] START round=8 head_norm_before_train=1.606806 (no previous merge yet)
[S10] round=8 local utility u=0.067843 metrics={'f1_val': 0.7010620067420683, 'auprc': 0.9925792845215512, 'loss_val': 0.24215480806391082, 'psi': 0.8176689178538614}-{'f1_val': 0.6889822726774932, 'auprc': 0.9781540189573783, 'loss_val': 0.26208630763512886, 'psi': 0.8046509711894473}
[S11] START round=8 head_norm_before_train=0.622624 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.4223876636418746, 'auprc': 0.9463434764352864, 'loss_val': 1.020457020936807, 'psi': 0.6319699887592394}-{'f1_val': 0.42273739039721175, 'auprc': 0.9624388833463107, 'loss_val': 1.0488721571552635, 'psi': 0.6386179875768514}
[S13] START round=8 head_norm_before_train=1.335068 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.5771941855742729, 'auprc': 0.7294945903577402, 'loss_val': 0.7171317809314187, 'psi': 0.6381143474876598}-{'f1_val': 0.5909699070782876, 'auprc': 0.752657940566708, 'loss_val': 0.7674755102427613, 'psi': 0.6556451204736558}
[S14] START round=8 head_norm_before_train=0.761997 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.054130 metrics={'f1_val': 0.154764412973925, 'auprc': 0.8869737241457302, 'loss_val': 1.1716100491707981, 'psi': 0.4476481374426471}-{'f1_val': 0.15381263616557733, 'auprc': 0.868294517878375, 'loss_val': 1.2181218861182062, 'psi': 0.43960538885069644}
[S15] START round=8 head_norm_before_train=1.421519 cos_to_last_merge=0.9434 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.943
[S15] round=8 local utility u=0.228654 metrics={'f1_val': 0.69850438455171, 'auprc': 0.9861623493135424, 'loss_val': 0.26121664613890866, 'psi': 0.8135675704564429}-{'f1_val': 0.6915552736333745, 'auprc': 0.8882398832454279, 'loss_val': 0.38306324159951427, 'psi': 0.7702291174781959}
[S16] START round=8 head_norm_before_train=0.672218 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.3839348856388153, 'auprc': 0.49661484352117374, 'loss_val': 0.9797609439317626, 'psi': 0.42900686879175864}-{'f1_val': 0.4167359650135119, 'auprc': 0.6443669634442621, 'loss_val': 1.03952356939077, 'psi': 0.507788364385812}
[S17] START round=8 head_norm_before_train=0.945295 cos_to_last_merge=0.9791 (last merge round=6)
[S17] round=8 local utility u=0.084539 metrics={'f1_val': 0.3522228213268879, 'auprc': 0.8492261397741183, 'loss_val': 0.9289225685791707, 'psi': 0.5510241487057801}-{'f1_val': 0.35362895134290206, 'auprc': 0.7872048303858679, 'loss_val': 0.9203741811675089, 'psi': 0.5270593029600884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:45917
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:45912
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:45904
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:45913
[S15] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S15
[S13] cosine check vs S15: cos=0.9790
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] cosine check vs S14: cos=0.7449
[S8] RECEIVED delta(kind=head bytes=1806) from S10
[S8] cosine check vs S10: cos=0.9799
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=-0.0515
[S17] DROPPED delta from S6 (cos=-0.0515 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] cosine check vs S2: cos=0.6667
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] cosine check vs S3: cos=0.0174
[S16] RECEIVED delta(kind=head bytes=1795) from S9
[S16] cosine check vs S9: cos=0.3428
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.8101
[S4] RECEIVED delta(kind=head bytes=1802) from S7
[S4] cosine check vs S7: cos=0.9105
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=0.9362
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.4224 head_norm=0.662795
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.636224e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.1486 head_norm=0.674510 delta_norm=0.263622
[S11] aggregate: ROLLBACK (f1_val pre=0.422 post=0.149 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.5772 head_norm=1.373698
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.539955e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.6032 head_norm=1.415788 delta_norm=0.153996
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.6666 head_norm=1.060324
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.215050e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6669 head_norm=1.020956 delta_norm=0.221505
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.7140 head_norm=1.575805
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.665951e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.7140 head_norm=1.606990 delta_norm=0.166595
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.1548 head_norm=0.780784
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.022517e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.1796 head_norm=0.890172 delta_norm=0.202252
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.3839 head_norm=0.701624
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.000886e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.3838 head_norm=0.796277 delta_norm=0.300089
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3522 head_norm=1.028104
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.672359e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.5524 head_norm=0.790786 delta_norm=0.467236
[S17] aggregate: ACCEPT kept=['S2', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.158358 cos_to_last_merge=0.9913 (last merge round=7)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.6752882906223066, 'loss_val': 0.3407453036994807, 'psi': 0.6909013950726438}-{'f1_val': 0.7013101313728686, 'auprc': 0.7404003607337061, 'loss_val': 0.4241096520501728, 'psi': 0.7169462231172036}
[S3] START round=9 head_norm_before_train=1.124391 cos_to_last_merge=0.9956 (last merge round=7)
[S3] round=9 local utility u=0.118256 metrics={'f1_val': 0.4037966867087368, 'auprc': 0.8266922590258515, 'loss_val': 0.8361695886054392, 'psi': 0.5729549156355827}-{'f1_val': 0.4009668676591264, 'auprc': 0.8120992095692119, 'loss_val': 1.0119227925645375, 'psi': 0.5654198044231606}
[S4] START round=9 head_norm_before_train=1.020956 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.004155 metrics={'f1_val': 0.6669368356935497, 'auprc': 0.6604469304998041, 'loss_val': 0.5556434337626925, 'psi': 0.6643408736160514}-{'f1_val': 0.6666478280875271, 'auprc': 0.6599249644568846, 'loss_val': 0.5606527115011893, 'psi': 0.6639586826352701}
[S5] START round=9 head_norm_before_train=1.331238 (no previous merge yet)
[S5] round=9 local utility u=0.116807 metrics={'f1_val': 0.41770670426636225, 'auprc': 0.8650733639662006, 'loss_val': 0.7395839253654571, 'psi': 0.5966533681462975}-{'f1_val': 0.41823357465624633, 'auprc': 0.8011867298573615, 'loss_val': 0.7846986348667737, 'psi': 0.5714148367366925}
[S6] START round=9 head_norm_before_train=1.608926 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.5854702810487903, 'auprc': 0.7997467090100914, 'loss_val': 0.6664219656059914, 'psi': 0.6711808522333107}-{'f1_val': 0.7019794677410052, 'auprc': 0.9649824107273886, 'loss_val': 0.38467322780498625, 'psi': 0.8071806449355585}
[S7] START round=9 head_norm_before_train=1.028856 cos_to_last_merge=0.9568 (last merge round=1)
[S7] round=9 local utility u=0.051529 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.7775112392011524, 'loss_val': 0.9382364827907506, 'psi': 0.5612257519732298}-{'f1_val': 0.4172381946317165, 'auprc': 0.7775013891674106, 'loss_val': 1.0424819076041283, 'psi': 0.5613434724459943}
[S8] START round=9 head_norm_before_train=1.606990 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.934746 metrics={'f1_val': 0.9951394449122195, 'auprc': 0.9953912183722784, 'loss_val': 0.23523595920011953, 'psi': 0.9952401542962431}-{'f1_val': 0.7139521677339791, 'auprc': 0.9956370843246407, 'loss_val': 0.4183426990643887, 'psi': 0.8266261343702437}
[S9] START round=9 head_norm_before_train=1.377608 (no previous merge yet)
[S9] round=9 local utility u=0.039769 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9990316875224583, 'loss_val': 0.3499169988452636, 'psi': 0.8205815844399204}-{'f1_val': 0.7016148490515617, 'auprc': 0.9994069329481237, 'loss_val': 0.4305803612320376, 'psi': 0.8207316826101865}
[S10] START round=9 head_norm_before_train=1.654442 (no previous merge yet)
[S10] round=9 local utility u=0.821046 metrics={'f1_val': 0.9566359275311629, 'auprc': 0.9976667231209356, 'loss_val': 0.14876788310445743, 'psi': 0.973048245767072}-{'f1_val': 0.7010620067420683, 'auprc': 0.9925792845215512, 'loss_val': 0.24215480806391082, 'psi': 0.8176689178538614}
[S11] START round=9 head_norm_before_train=0.674510 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.039328 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9962242817254804, 'loss_val': 0.9364299599466496, 'psi': 0.6364210542459159}-{'f1_val': 0.4223876636418746, 'auprc': 0.9463434764352864, 'loss_val': 1.020457020936807, 'psi': 0.6319699887592394}
[S13] START round=9 head_norm_before_train=1.415788 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.237054 metrics={'f1_val': 0.6548156993533861, 'auprc': 0.6947451756748451, 'loss_val': 0.604504994281327, 'psi': 0.6707874898819697}-{'f1_val': 0.5771941855742729, 'auprc': 0.7294945903577402, 'loss_val': 0.7171317809314187, 'psi': 0.6381143474876598}
[S14] START round=9 head_norm_before_train=0.890172 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.594915 metrics={'f1_val': 0.4176991551959602, 'auprc': 0.7332457136262844, 'loss_val': 1.0982034835096304, 'psi': 0.5439177785680899}-{'f1_val': 0.154764412973925, 'auprc': 0.8869737241457302, 'loss_val': 1.1716100491707981, 'psi': 0.4476481374426471}
[S15] START round=9 head_norm_before_train=1.472852 cos_to_last_merge=0.9314 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.6905667628292425, 'auprc': 0.9871110612410803, 'loss_val': 0.2844162603829205, 'psi': 0.8091844821939775}-{'f1_val': 0.69850438455171, 'auprc': 0.9861623493135424, 'loss_val': 0.26121664613890866, 'psi': 0.8135675704564429}
[S16] START round=9 head_norm_before_train=0.796277 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.096624 metrics={'f1_val': 0.3836903868613092, 'auprc': 0.5274884492615662, 'loss_val': 0.8776664642274511, 'psi': 0.441209611821412}-{'f1_val': 0.3839348856388153, 'auprc': 0.49661484352117374, 'loss_val': 0.9797609439317626, 'psi': 0.42900686879175864}
[S17] START round=9 head_norm_before_train=0.790786 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.35273424507766726, 'auprc': 0.7585598858589666, 'loss_val': 0.9474846685003343, 'psi': 0.515064501390187}-{'f1_val': 0.3522228213268879, 'auprc': 0.8492261397741183, 'loss_val': 0.9289225685791707, 'psi': 0.5510241487057801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:45916
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:45904
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:45909
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=0.3349
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=0.8662
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] cosine check vs S14: cos=0.8703
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] cosine check vs S10: cos=0.9868
[S17] RECEIVED delta(kind=head bytes=1801) from S3
[S17] cosine check vs S3: cos=0.3204
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] cosine check vs S9: cos=0.5887
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] cosine check vs S11: cos=0.1734
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.7757
[S15] RECEIVED delta(kind=head bytes=1797) from S16
[S15] cosine check vs S16: cos=0.0329
[S4] RECEIVED delta(kind=head bytes=1802) from S7
[S4] cosine check vs S7: cos=0.9398
[S2] RECEIVED delta(kind=head bytes=1798) from S13
[S2] cosine check vs S13: cos=0.8685
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.7013 head_norm=1.239644
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.611194e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.7013 head_norm=1.303055 delta_norm=0.361119
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6669 head_norm=1.091342
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.869776e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6669 head_norm=1.056890 delta_norm=0.186978
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3837 head_norm=0.830294
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.151259e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3897 head_norm=0.716239 delta_norm=0.215126
[S16] aggregate: ACCEPT kept=['S9', 'S11', 'S5'] (k=3/3) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.4177 head_norm=0.911781
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.822170e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.2477 head_norm=0.819883 delta_norm=0.582217
[S14] aggregate: ROLLBACK (f1_val pre=0.418 post=0.248 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.3966 head_norm=0.718590
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.276546e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.4152 head_norm=0.788689 delta_norm=0.227655
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.9951 head_norm=1.653712
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.369977e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.9955 head_norm=1.665857 delta_norm=0.136998
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.4038 head_norm=1.162216
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.347547e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.6544 head_norm=1.361522 delta_norm=0.434755
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.6906 head_norm=1.523165
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.553044e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.6906 head_norm=0.879297 delta_norm=0.855304
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3527 head_norm=0.864443
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.029515e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3535 head_norm=0.827921 delta_norm=0.602952
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.303055 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.6691897083411693, 'loss_val': 0.3562273929353169, 'psi': 0.6884619621601888}-{'f1_val': 0.7013101313728686, 'auprc': 0.6752882906223066, 'loss_val': 0.3407453036994807, 'psi': 0.6909013950726438}
[S3] START round=10 head_norm_before_train=1.361522 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.763191 metrics={'f1_val': 0.6300048156146372, 'auprc': 0.8618646646944198, 'loss_val': 0.7725528808599961, 'psi': 0.7227487552465502}-{'f1_val': 0.4037966867087368, 'auprc': 0.8266922590258515, 'loss_val': 0.8361695886054392, 'psi': 0.5729549156355827}
[S4] START round=10 head_norm_before_train=1.056890 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.268988 metrics={'f1_val': 0.6666478280875271, 'auprc': 0.8400648023898036, 'loss_val': 0.5547866149578332, 'psi': 0.7360146178084377}-{'f1_val': 0.6669368356935497, 'auprc': 0.6604469304998041, 'loss_val': 0.5556434337626925, 'psi': 0.6643408736160514}
[S5] START round=10 head_norm_before_train=1.365180 (no previous merge yet)
[S5] round=10 local utility u=0.105385 metrics={'f1_val': 0.43709025581367167, 'auprc': 0.8642135173268821, 'loss_val': 0.6425361231009116, 'psi': 0.6079395604189559}-{'f1_val': 0.41770670426636225, 'auprc': 0.8650733639662006, 'loss_val': 0.7395839253654571, 'psi': 0.5966533681462975}
[S6] START round=10 head_norm_before_train=1.639444 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.5638922607344322, 'auprc': 0.8003006532447475, 'loss_val': 0.6507429548589482, 'psi': 0.6584556177385583}-{'f1_val': 0.5854702810487903, 'auprc': 0.7997467090100914, 'loss_val': 0.6664219656059914, 'psi': 0.6711808522333107}
[S7] START round=10 head_norm_before_train=1.054955 cos_to_last_merge=0.9462 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.946
[S7] round=10 local utility u=0.610114 metrics={'f1_val': 0.6038194065200856, 'auprc': 0.7866596347270793, 'loss_val': 0.8661575998946177, 'psi': 0.6769554978028831}-{'f1_val': 0.41703542715461484, 'auprc': 0.7775112392011524, 'loss_val': 0.9382364827907506, 'psi': 0.5612257519732298}
[S8] START round=10 head_norm_before_train=1.665857 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.7142385069361679, 'auprc': 0.9914209108124354, 'loss_val': 0.39256855956427966, 'psi': 0.8251114684866749}-{'f1_val': 0.9951394449122195, 'auprc': 0.9953912183722784, 'loss_val': 0.23523595920011953, 'psi': 0.9952401542962431}
[S9] START round=10 head_norm_before_train=1.424407 (no previous merge yet)
[S9] round=10 local utility u=0.023734 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9986499509802619, 'loss_val': 0.3008594696847302, 'psi': 0.820384378913268}-{'f1_val': 0.7016148490515617, 'auprc': 0.9990316875224583, 'loss_val': 0.3499169988452636, 'psi': 0.8205815844399204}
[S10] START round=10 head_norm_before_train=1.689062 (no previous merge yet)
[S10] round=10 local utility u=0.132784 metrics={'f1_val': 0.9955385173253508, 'auprc': 0.997654342223897, 'loss_val': 0.11657783335933694, 'psi': 0.9963848472847693}-{'f1_val': 0.9566359275311629, 'auprc': 0.9976667231209356, 'loss_val': 0.14876788310445743, 'psi': 0.973048245767072}
[S11] START round=10 head_norm_before_train=0.788689 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.332413 metrics={'f1_val': 0.49838005048502054, 'auprc': 0.997703659756826, 'loss_val': 0.8870079913463513, 'psi': 0.6981094941937427}-{'f1_val': 0.39655223592620625, 'auprc': 0.9962242817254804, 'loss_val': 0.9364299599466496, 'psi': 0.6364210542459159}
[S13] START round=10 head_norm_before_train=1.456022 cos_to_last_merge=0.9979 (last merge round=8)
[S13] round=10 local utility u=0.106377 metrics={'f1_val': 0.6749773300361337, 'auprc': 0.6946866108425639, 'loss_val': 0.5125448318824296, 'psi': 0.6828610423587058}-{'f1_val': 0.6548156993533861, 'auprc': 0.6947451756748451, 'loss_val': 0.604504994281327, 'psi': 0.6707874898819697}
[S14] START round=10 head_norm_before_train=0.819883 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=1.000000 metrics={'f1_val': 0.778259793384327, 'auprc': 0.8543519021213175, 'loss_val': 1.085460856671348, 'psi': 0.8086966368791232}-{'f1_val': 0.4176991551959602, 'auprc': 0.7332457136262844, 'loss_val': 1.0982034835096304, 'psi': 0.5439177785680899}
[S15] START round=10 head_norm_before_train=0.879297 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6989439592381045, 'auprc': 0.7995191511058377, 'loss_val': 0.46007471465038696, 'psi': 0.7391740359851977}-{'f1_val': 0.6905667628292425, 'auprc': 0.9871110612410803, 'loss_val': 0.2844162603829205, 'psi': 0.8091844821939775}
[S16] START round=10 head_norm_before_train=0.716239 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.385576 metrics={'f1_val': 0.38976815959253386, 'auprc': 0.7639524186653421, 'loss_val': 0.852372568545253, 'psi': 0.5394418632216572}-{'f1_val': 0.3836903868613092, 'auprc': 0.5274884492615662, 'loss_val': 0.8776664642274511, 'psi': 0.441209611821412}
[S17] START round=10 head_norm_before_train=0.827921 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.3297301189154566, 'auprc': 0.6043404924378997, 'loss_val': 1.1161975423767114, 'psi': 0.43957426832443386}-{'f1_val': 0.35273424507766726, 'auprc': 0.7585598858589666, 'loss_val': 0.9474846685003343, 'psi': 0.515064501390187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:45916
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] → sending delta(kind=head bytes=1807) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:45912
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:45902
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:45914
[S5] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1807 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] cosine check vs S4: cos=0.8258
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] cosine check vs S14: cos=0.7572
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] cosine check vs S10: cos=0.9911
[S17] RECEIVED delta(kind=head bytes=1794) from S3
[S17] cosine check vs S3: cos=0.7953
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.6675
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] cosine check vs S11: cos=0.3502
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.6501
[S15] RECEIVED delta(kind=head bytes=1807) from S16
[S15] cosine check vs S16: cos=0.5158
[S4] RECEIVED delta(kind=head bytes=1801) from S7
[S4] cosine check vs S7: cos=0.9559
[S2] RECEIVED delta(kind=head bytes=1798) from S13
[S2] cosine check vs S13: cos=0.9572
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.317 → S17@127.0.0.1:45917
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.7142 head_norm=1.706503
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.146821e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.7142 head_norm=1.708973 delta_norm=0.114682
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.468 → S3@127.0.0.1:45903
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.7013 head_norm=1.362681
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.201376e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.7013 head_norm=1.416013 delta_norm=0.220138
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.256 → S17@127.0.0.1:45917
[S7] ⇄ pheromone p=0.381 → S4@127.0.0.1:45904
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.4984 head_norm=0.833368
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.930996e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.3996 head_norm=0.788265 delta_norm=0.293100
[S11] aggregate: ROLLBACK (f1_val pre=0.498 post=0.400 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.295 → S16@127.0.0.1:45916
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3898 head_norm=0.756006
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.460166e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3933 head_norm=0.717067 delta_norm=0.146017
[S16] aggregate: ACCEPT kept=['S5', 'S11', 'S9'] (k=3/3) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.291 → S15@127.0.0.1:45915
[S10] ⇄ pheromone p=0.427 → S8@127.0.0.1:45909
[S5] ⇄ pheromone p=0.244 → S16@127.0.0.1:45916
[S13] ⇄ pheromone p=0.279 → S2@127.0.0.1:45902
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.7783 head_norm=0.848550
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.174349e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.6726 head_norm=0.940288 delta_norm=0.317435
[S14] aggregate: ROLLBACK (f1_val pre=0.778 post=0.673 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.484 → S11@127.0.0.1:45912
[S3] ⇄ pheromone p=0.399 → S17@127.0.0.1:45917
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6666 head_norm=1.117933
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.644665e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6665 head_norm=1.089865 delta_norm=0.164466
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.216 → S14@127.0.0.1:45914
[S9] ⇄ pheromone p=0.355 → S16@127.0.0.1:45916
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.6989 head_norm=0.952226
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.288401e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.6989 head_norm=0.745141 delta_norm=0.428840
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.260 → S13@127.0.0.1:45913
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3297 head_norm=0.886191
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.367127e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3373 head_norm=1.082996 delta_norm=0.436713
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.184 → S14@127.0.0.1:45914
[S2] START round=11 head_norm_before_train=1.416013 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.101782 metrics={'f1_val': 0.701308622683052, 'auprc': 0.741910986047685, 'loss_val': 0.37081803605902897, 'psi': 0.7175495680289052}-{'f1_val': 0.7013101313728686, 'auprc': 0.6691897083411693, 'loss_val': 0.3562273929353169, 'psi': 0.6884619621601888}
[S3] START round=11 head_norm_before_train=1.393508 cos_to_last_merge=0.9974 (last merge round=9)
[S3] round=11 local utility u=0.162474 metrics={'f1_val': 0.7005769689796157, 'auprc': 0.761849449808306, 'loss_val': 0.57099148110758, 'psi': 0.7250859613110918}-{'f1_val': 0.6300048156146372, 'auprc': 0.8618646646944198, 'loss_val': 0.7725528808599961, 'psi': 0.7227487552465502}
[S4] START round=11 head_norm_before_train=1.089865 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.003470 metrics={'f1_val': 0.6149990176281263, 'auprc': 0.94164842883773, 'loss_val': 0.5427043527253376, 'psi': 0.7456587821119678}-{'f1_val': 0.6666478280875271, 'auprc': 0.8400648023898036, 'loss_val': 0.5547866149578332, 'psi': 0.7360146178084377}
[S5] START round=11 head_norm_before_train=1.391552 (no previous merge yet)
[S5] round=11 local utility u=0.787304 metrics={'f1_val': 0.6912844793607864, 'auprc': 0.8620348387293857, 'loss_val': 0.5865582129881401, 'psi': 0.7595846231082262}-{'f1_val': 0.43709025581367167, 'auprc': 0.8642135173268821, 'loss_val': 0.6425361231009116, 'psi': 0.6079395604189559}
[S6] START round=11 head_norm_before_train=1.664824 (no previous merge yet)
[S6] round=11 local utility u=0.380887 metrics={'f1_val': 0.64255027377408, 'auprc': 0.8324713335854937, 'loss_val': 0.45742874958561863, 'psi': 0.7185186976986455}-{'f1_val': 0.5638922607344322, 'auprc': 0.8003006532447475, 'loss_val': 0.6507429548589482, 'psi': 0.6584556177385583}
[S7] START round=11 head_norm_before_train=1.086248 cos_to_last_merge=0.9311 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.931
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.41727946905461333, 'auprc': 0.7871430467694106, 'loss_val': 0.8090464041167621, 'psi': 0.5652249001405323}-{'f1_val': 0.6038194065200856, 'auprc': 0.7866596347270793, 'loss_val': 0.8661575998946177, 'psi': 0.6769554978028831}
[S8] START round=11 head_norm_before_train=1.708973 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.969884 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9970081667516771, 'loss_val': 0.1630670702746988, 'psi': 0.9966969322620759}-{'f1_val': 0.7142385069361679, 'auprc': 0.9914209108124354, 'loss_val': 0.39256855956427966, 'psi': 0.8251114684866749}
[S9] START round=11 head_norm_before_train=1.473064 (no previous merge yet)
[S9] round=11 local utility u=0.015167 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9985321860160093, 'loss_val': 0.270172578734172, 'psi': 0.820337272927567}-{'f1_val': 0.7015406642019387, 'auprc': 0.9986499509802619, 'loss_val': 0.3008594696847302, 'psi': 0.820384378913268}
[S10] START round=11 head_norm_before_train=1.719107 (no previous merge yet)
[S10] round=11 local utility u=0.013854 metrics={'f1_val': 0.9958006069973493, 'auprc': 0.9969614668798722, 'loss_val': 0.08836414213842948, 'psi': 0.9962649509503585}-{'f1_val': 0.9955385173253508, 'auprc': 0.997654342223897, 'loss_val': 0.11657783335933694, 'psi': 0.9963848472847693}
[S11] START round=11 head_norm_before_train=0.788265 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.610433 metrics={'f1_val': 0.6987550505237223, 'auprc': 0.9818446012635087, 'loss_val': 0.8208156248003816, 'psi': 0.8119908708196368}-{'f1_val': 0.49838005048502054, 'auprc': 0.997703659756826, 'loss_val': 0.8870079913463513, 'psi': 0.6981094941937427}
[S13] START round=11 head_norm_before_train=1.500069 cos_to_last_merge=0.9928 (last merge round=8)
[S13] round=11 local utility u=0.071999 metrics={'f1_val': 0.7026843494104639, 'auprc': 0.6754568454743056, 'loss_val': 0.47709912143312744, 'psi': 0.6917933478360005}-{'f1_val': 0.6749773300361337, 'auprc': 0.6946866108425639, 'loss_val': 0.5125448318824296, 'psi': 0.6828610423587058}
[S14] START round=11 head_norm_before_train=0.940288 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.168212 metrics={'f1_val': 0.7469186382101991, 'auprc': 0.9706768240451344, 'loss_val': 0.9099643726283673, 'psi': 0.8364219125441732}-{'f1_val': 0.778259793384327, 'auprc': 0.8543519021213175, 'loss_val': 1.085460856671348, 'psi': 0.8086966368791232}
[S15] START round=11 head_norm_before_train=0.745141 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.246895 metrics={'f1_val': 0.6981771491407601, 'auprc': 0.9675252302091888, 'loss_val': 0.4657011590082899, 'psi': 0.8059163815681316}-{'f1_val': 0.6989439592381045, 'auprc': 0.7995191511058377, 'loss_val': 0.46007471465038696, 'psi': 0.7391740359851977}
[S16] START round=11 head_norm_before_train=0.717067 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.145522 metrics={'f1_val': 0.43027728396066955, 'auprc': 0.770004646120232, 'loss_val': 0.8225403937103056, 'psi': 0.5661682288244945}-{'f1_val': 0.38976815959253386, 'auprc': 0.7639524186653421, 'loss_val': 0.852372568545253, 'psi': 0.5394418632216572}
[S17] START round=11 head_norm_before_train=1.082996 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.046382 metrics={'f1_val': 0.3391291871006004, 'auprc': 0.5884060200565534, 'loss_val': 1.032025085118203, 'psi': 0.4388399202829816}-{'f1_val': 0.3297301189154566, 'auprc': 0.6043404924378997, 'loss_val': 1.1161975423767114, 'psi': 0.43957426832443386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:45916
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:45909
[S5] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S10
[S8] cosine check vs S10: cos=0.9939
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=-0.0002
[S17] DROPPED delta from S6 (cos=-0.0002 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] cosine check vs S3: cos=0.9306
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.5873
[S16] RECEIVED delta(kind=head bytes=1805) from S9
[S16] cosine check vs S9: cos=0.6740
[S17] RECEIVED delta(kind=head bytes=1801) from S2
[S17] cosine check vs S2: cos=0.1328
[S14] RECEIVED delta(kind=head bytes=1796) from S4
[S14] cosine check vs S4: cos=0.9432
[S16] RECEIVED delta(kind=head bytes=1803) from S11
[S16] cosine check vs S11: cos=0.4455
[S15] RECEIVED delta(kind=head bytes=1803) from S16
[S15] cosine check vs S16: cos=0.7588
[S2] RECEIVED delta(kind=head bytes=1802) from S13
[S2] cosine check vs S13: cos=0.9787
[S13] RECEIVED delta(kind=head bytes=1797) from S15
[S13] cosine check vs S15: cos=0.7240
[S3] RECEIVED delta(kind=head bytes=1803) from S8
[S3] cosine check vs S8: cos=0.9359
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] cosine check vs S14: cos=0.7729
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] cosine check vs S17: cos=0.1973
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.7027 head_norm=1.539738
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.464920e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.7033 head_norm=1.119693 delta_norm=0.546492
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.7006 head_norm=1.436649
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.217378e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.7005 head_norm=1.563713 delta_norm=0.321738
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.6988 head_norm=0.832748
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.105275e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7019 head_norm=0.848986 delta_norm=0.310527
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7013 head_norm=1.469867
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.591736e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.7013 head_norm=1.496768 delta_norm=0.159174
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.7469 head_norm=0.970020
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.104868e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.5244 head_norm=0.855979 delta_norm=0.310487
[S14] aggregate: ROLLBACK (f1_val pre=0.747 post=0.524 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.4303 head_norm=0.758024
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.279615e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.5122 head_norm=0.727803 delta_norm=0.127961
[S16] aggregate: ACCEPT kept=['S5', 'S9', 'S11'] (k=3/3) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.6982 head_norm=0.856702
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.841540e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.6983 head_norm=0.757315 delta_norm=0.284154
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.9965 head_norm=1.741684
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.656881e-02
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.9961 head_norm=1.742585 delta_norm=0.096569
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3391 head_norm=1.115791
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.750517e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3477 head_norm=0.997699 delta_norm=0.375052
[S17] aggregate: ACCEPT kept=['S3', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.496768 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.6725380955987202, 'loss_val': 0.3708123144915235, 'psi': 0.6898013170632092}-{'f1_val': 0.701308622683052, 'auprc': 0.741910986047685, 'loss_val': 0.37081803605902897, 'psi': 0.7175495680289052}
[S3] START round=12 head_norm_before_train=1.563713 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.345870 metrics={'f1_val': 0.6924948654681071, 'auprc': 0.9979736047975195, 'loss_val': 0.5391303718704639, 'psi': 0.814686361199872}-{'f1_val': 0.7005769689796157, 'auprc': 0.761849449808306, 'loss_val': 0.57099148110758, 'psi': 0.7250859613110918}
[S4] START round=12 head_norm_before_train=1.157636 cos_to_last_merge=0.9936 (last merge round=10)
[S4] round=12 local utility u=0.019268 metrics={'f1_val': 0.6140359770840228, 'auprc': 0.9403766323436944, 'loss_val': 0.49457546551601245, 'psi': 0.7445722391878915}-{'f1_val': 0.6149990176281263, 'auprc': 0.94164842883773, 'loss_val': 0.5427043527253376, 'psi': 0.7456587821119678}
[S5] START round=12 head_norm_before_train=1.416730 (no previous merge yet)
[S5] round=12 local utility u=0.041094 metrics={'f1_val': 0.7010644289311239, 'auprc': 0.8528673612845599, 'loss_val': 0.5355473494235603, 'psi': 0.7617856018724982}-{'f1_val': 0.6912844793607864, 'auprc': 0.8620348387293857, 'loss_val': 0.5865582129881401, 'psi': 0.7595846231082262}
[S6] START round=12 head_norm_before_train=1.681803 (no previous merge yet)
[S6] round=12 local utility u=0.089684 metrics={'f1_val': 0.6600633024834174, 'auprc': 0.8527967766064426, 'loss_val': 0.4441148921034812, 'psi': 0.7371566921326275}-{'f1_val': 0.64255027377408, 'auprc': 0.8324713335854937, 'loss_val': 0.45742874958561863, 'psi': 0.7185186976986455}
[S7] START round=12 head_norm_before_train=1.123573 cos_to_last_merge=0.9124 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.912
[S7] round=12 local utility u=0.874563 metrics={'f1_val': 0.699609915103612, 'auprc': 0.8039986873132727, 'loss_val': 0.8044696140502275, 'psi': 0.7413654239874763}-{'f1_val': 0.41727946905461333, 'auprc': 0.7871430467694106, 'loss_val': 0.8090464041167621, 'psi': 0.5652249001405323}
[S8] START round=12 head_norm_before_train=1.742585 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.008862 metrics={'f1_val': 0.9952289782211529, 'auprc': 0.9982581517978237, 'loss_val': 0.14152984521773948, 'psi': 0.9964406476518213}-{'f1_val': 0.9964894426023416, 'auprc': 0.9970081667516771, 'loss_val': 0.1630670702746988, 'psi': 0.9966969322620759}
[S9] START round=12 head_norm_before_train=1.518947 (no previous merge yet)
[S9] round=12 local utility u=0.020990 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9986059274609687, 'loss_val': 0.22797119958472734, 'psi': 0.8203224273625905}-{'f1_val': 0.7015406642019387, 'auprc': 0.9985321860160093, 'loss_val': 0.270172578734172, 'psi': 0.820337272927567}
[S10] START round=12 head_norm_before_train=1.748825 (no previous merge yet)
[S10] round=12 local utility u=0.009108 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9966259815187009, 'loss_val': 0.06414704473122178, 'psi': 0.995631304526526}-{'f1_val': 0.9958006069973493, 'auprc': 0.9969614668798722, 'loss_val': 0.08836414213842948, 'psi': 0.9962649509503585}
[S11] START round=12 head_norm_before_train=0.848986 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.7020664967782734, 'auprc': 0.9425166301468365, 'loss_val': 0.779244085669056, 'psi': 0.7982465501256986}-{'f1_val': 0.6987550505237223, 'auprc': 0.9818446012635087, 'loss_val': 0.8208156248003816, 'psi': 0.8119908708196368}
[S13] START round=12 head_norm_before_train=1.119693 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.627752983119865, 'auprc': 0.6916574391057715, 'loss_val': 0.5871527620522489, 'psi': 0.6533147655142276}-{'f1_val': 0.7026843494104639, 'auprc': 0.6754568454743056, 'loss_val': 0.47709912143312744, 'psi': 0.6917933478360005}
[S14] START round=12 head_norm_before_train=0.855979 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.7013350841591286, 'auprc': 0.9859726387979721, 'loss_val': 0.8381809919570578, 'psi': 0.815190106014666}-{'f1_val': 0.7469186382101991, 'auprc': 0.9706768240451344, 'loss_val': 0.9099643726283673, 'psi': 0.8364219125441732}
[S15] START round=12 head_norm_before_train=0.757315 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.586887 metrics={'f1_val': 0.8742466288896242, 'auprc': 0.9750743685539889, 'loss_val': 0.3709914799152787, 'psi': 0.9145777247553701}-{'f1_val': 0.6981771491407601, 'auprc': 0.9675252302091888, 'loss_val': 0.4657011590082899, 'psi': 0.8059163815681316}
[S16] START round=12 head_norm_before_train=0.727803 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.3854012350195145, 'auprc': 0.7604461812100184, 'loss_val': 0.8186947929187768, 'psi': 0.5354192134957161}-{'f1_val': 0.43027728396066955, 'auprc': 0.770004646120232, 'loss_val': 0.8225403937103056, 'psi': 0.5661682288244945}
[S17] START round=12 head_norm_before_train=0.997699 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.071545 metrics={'f1_val': 0.34856777282483076, 'auprc': 0.6003620972386912, 'loss_val': 0.9814354298915349, 'psi': 0.4492855025903749}-{'f1_val': 0.3391291871006004, 'auprc': 0.5884060200565534, 'loss_val': 1.032025085118203, 'psi': 0.4388399202829816}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:45909
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:45917
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:45916
[S5] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S7
[S4] cosine check vs S7: cos=0.9307
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] cosine check vs S4: cos=0.8829
[S13] RECEIVED delta(kind=head bytes=1795) from S15
[S13] cosine check vs S15: cos=0.8141
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] cosine check vs S10: cos=0.9935
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=0.9773
[S17] RECEIVED delta(kind=head bytes=1795) from S3
[S17] cosine check vs S3: cos=0.8171
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.6935
[S16] RECEIVED delta(kind=head bytes=1791) from S5
[S16] cosine check vs S5: cos=0.5373
[S17] RECEIVED delta(kind=head bytes=1797) from S6
[S17] cosine check vs S6: cos=-0.0102
[S17] DROPPED delta from S6 (cos=-0.0102 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=0.6684
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.6278 head_norm=1.162556
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.386685e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.6307 head_norm=0.979174 delta_norm=0.338668
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.7013 head_norm=0.894873
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.309608e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.6894 head_norm=0.906766 delta_norm=0.130961
[S14] aggregate: ROLLBACK (f1_val pre=0.701 post=0.689 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6140 head_norm=1.240778
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.268642e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6139 head_norm=1.177351 delta_norm=0.226864
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.9952 head_norm=1.785679
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.020497e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.9952 head_norm=1.787308 delta_norm=0.102050
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.6925 head_norm=1.600004
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.025938e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.6998 head_norm=1.683237 delta_norm=0.202594
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.3854 head_norm=0.766535
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.857587e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.3865 head_norm=0.890586 delta_norm=0.285759
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3486 head_norm=1.052899
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.784391e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3615 head_norm=1.267044 delta_norm=0.478439
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.538799 cos_to_last_merge=0.9983 (last merge round=11)
[S2] round=13 local utility u=0.141381 metrics={'f1_val': 0.7061605397090955, 'auprc': 0.7527708310857124, 'loss_val': 0.3578518795597991, 'psi': 0.7248046562597423}-{'f1_val': 0.7013101313728686, 'auprc': 0.6725380955987202, 'loss_val': 0.3708123144915235, 'psi': 0.6898013170632092}
[S3] START round=13 head_norm_before_train=1.683237 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.071587 metrics={'f1_val': 0.6988251315540939, 'auprc': 0.9994105328537704, 'loss_val': 0.4382478099067467, 'psi': 0.8190592920739646}-{'f1_val': 0.6924948654681071, 'auprc': 0.9979736047975195, 'loss_val': 0.5391303718704639, 'psi': 0.814686361199872}
[S4] START round=13 head_norm_before_train=1.177351 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.6024063575083537, 'auprc': 0.6637626149103253, 'loss_val': 0.5053704875163797, 'psi': 0.6269488604691423}-{'f1_val': 0.6140359770840228, 'auprc': 0.9403766323436944, 'loss_val': 0.49457546551601245, 'psi': 0.7445722391878915}
[S5] START round=13 head_norm_before_train=1.443194 (no previous merge yet)
[S5] round=13 local utility u=0.046778 metrics={'f1_val': 0.7011046720655897, 'auprc': 0.8566937811631137, 'loss_val': 0.45371228514519196, 'psi': 0.7633403157045993}-{'f1_val': 0.7010644289311239, 'auprc': 0.8528673612845599, 'loss_val': 0.5355473494235603, 'psi': 0.7617856018724982}
[S6] START round=13 head_norm_before_train=1.709955 (no previous merge yet)
[S6] round=13 local utility u=0.792061 metrics={'f1_val': 0.8429275570153033, 'auprc': 0.9711101582300018, 'loss_val': 0.31211804222099854, 'psi': 0.8942005975011827}-{'f1_val': 0.6600633024834174, 'auprc': 0.8527967766064426, 'loss_val': 0.4441148921034812, 'psi': 0.7371566921326275}
[S7] START round=13 head_norm_before_train=1.155731 cos_to_last_merge=0.8938 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.894
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.41679099637737954, 'auprc': 0.8539956345402385, 'loss_val': 0.7411060518113187, 'psi': 0.5916728516425231}-{'f1_val': 0.699609915103612, 'auprc': 0.8039986873132727, 'loss_val': 0.8044696140502275, 'psi': 0.7413654239874763}
[S8] START round=13 head_norm_before_train=1.787308 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.009991 metrics={'f1_val': 0.9942851599023415, 'auprc': 0.9957773302518689, 'loss_val': 0.10844147290628625, 'psi': 0.9948820280421524}-{'f1_val': 0.9952289782211529, 'auprc': 0.9982581517978237, 'loss_val': 0.14152984521773948, 'psi': 0.9964406476518213}
[S9] START round=13 head_norm_before_train=1.558661 (no previous merge yet)
[S9] round=13 local utility u=0.020989 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9982400771772669, 'loss_val': 0.18489651883332997, 'psi': 0.8201760872491098}-{'f1_val': 0.7014667606303384, 'auprc': 0.9986059274609687, 'loss_val': 0.22797119958472734, 'psi': 0.8203224273625905}
[S10] START round=13 head_norm_before_train=1.794747 (no previous merge yet)
[S10] round=13 local utility u=0.004211 metrics={'f1_val': 0.9947060979488367, 'auprc': 0.9965358468767553, 'loss_val': 0.05388301223052205, 'psi': 0.9954379975200042}-{'f1_val': 0.9949681865317428, 'auprc': 0.9966259815187009, 'loss_val': 0.06414704473122178, 'psi': 0.995631304526526}
[S11] START round=13 head_norm_before_train=0.888455 cos_to_last_merge=0.9933 (last merge round=11)
[S11] round=13 local utility u=0.066476 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9289217470610116, 'loss_val': 0.603269751807972, 'psi': 0.7925847865765596}-{'f1_val': 0.7020664967782734, 'auprc': 0.9425166301468365, 'loss_val': 0.779244085669056, 'psi': 0.7982465501256986}
[S13] START round=13 head_norm_before_train=0.979174 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.100657 metrics={'f1_val': 0.65339590809043, 'auprc': 0.7076530508624632, 'loss_val': 0.5876840985955334, 'psi': 0.6750987651992433}-{'f1_val': 0.627752983119865, 'auprc': 0.6916574391057715, 'loss_val': 0.5871527620522489, 'psi': 0.6533147655142276}
[S14] START round=13 head_norm_before_train=0.906766 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.121692 metrics={'f1_val': 0.701819167019819, 'auprc': 0.9999108842435985, 'loss_val': 0.6395155218430942, 'psi': 0.8210558539093308}-{'f1_val': 0.7013350841591286, 'auprc': 0.9859726387979721, 'loss_val': 0.8381809919570578, 'psi': 0.815190106014666}
[S15] START round=13 head_norm_before_train=0.891862 cos_to_last_merge=0.9706 (last merge round=11)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.6980909962905224, 'auprc': 0.7799104860841715, 'loss_val': 0.4807740828529514, 'psi': 0.7308187922079821}-{'f1_val': 0.8742466288896242, 'auprc': 0.9750743685539889, 'loss_val': 0.3709914799152787, 'psi': 0.9145777247553701}
[S16] START round=13 head_norm_before_train=0.890586 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.406131 metrics={'f1_val': 0.5137803623194899, 'auprc': 0.7496185145526223, 'loss_val': 0.7442242679550127, 'psi': 0.6081156232127428}-{'f1_val': 0.3854012350195145, 'auprc': 0.7604461812100184, 'loss_val': 0.8186947929187768, 'psi': 0.5354192134957161}
[S17] START round=13 head_norm_before_train=1.267044 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.068826 metrics={'f1_val': 0.3513523920156526, 'auprc': 0.6391391764733549, 'loss_val': 0.9768222623254019, 'psi': 0.4664671057987335}-{'f1_val': 0.34856777282483076, 'auprc': 0.6003620972386912, 'loss_val': 0.9814354298915349, 'psi': 0.4492855025903749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:45912
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:45916
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:45916
[S6] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S3
[S17] cosine check vs S3: cos=0.9393
[S17] RECEIVED delta(kind=head bytes=1797) from S2
[S17] cosine check vs S2: cos=0.1860
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.6446
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] cosine check vs S9: cos=0.7325
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] cosine check vs S11: cos=0.2426
[S11] RECEIVED delta(kind=head bytes=1803) from S14
[S11] cosine check vs S14: cos=0.8393
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] cosine check vs S16: cos=0.7178
[S8] RECEIVED delta(kind=head bytes=1796) from S10
[S8] cosine check vs S10: cos=0.9939
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] cosine check vs S6: cos=0.0062
[S2] RECEIVED delta(kind=head bytes=1796) from S13
[S2] cosine check vs S13: cos=0.8819
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] cosine check vs S8: cos=0.9884
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] cosine check vs S17: cos=0.5680
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7017 head_norm=0.939105
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.675523e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7016 head_norm=0.904909 delta_norm=0.267552
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.9943 head_norm=1.831233
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.016789e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.9939 head_norm=1.832987 delta_norm=0.101679
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.7062 head_norm=1.582942
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.119313e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.7012 head_norm=1.277224 delta_norm=0.411931
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.7018 head_norm=0.948140
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.477850e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.7021 head_norm=1.002093 delta_norm=0.547785
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.6988 head_norm=1.722457
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.459333e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.7001 head_norm=1.771677 delta_norm=0.145933
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.5138 head_norm=0.933167
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.072131e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.6798 head_norm=0.832448 delta_norm=0.207213
[S16] aggregate: ACCEPT kept=['S5', 'S9', 'S11'] (k=3/3) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6981 head_norm=1.013580
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.675271e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6980 head_norm=0.902217 delta_norm=0.367527
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3514 head_norm=1.307497
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.881769e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3664 head_norm=1.040464 delta_norm=0.488177
[S17] aggregate: ACCEPT kept=['S3', 'S2', 'S6'] (k=3/3) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.277224 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.5441353616725625, 'auprc': 0.675192579661417, 'loss_val': 0.9082942354590522, 'psi': 0.5965582488681043}-{'f1_val': 0.7061605397090955, 'auprc': 0.7527708310857124, 'loss_val': 0.3578518795597991, 'psi': 0.7248046562597423}
[S3] START round=14 head_norm_before_train=1.771677 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.053829 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9984535943529198, 'loss_val': 0.33675367460051653, 'psi': 0.8195799891530852}-{'f1_val': 0.6988251315540939, 'auprc': 0.9994105328537704, 'loss_val': 0.4382478099067467, 'psi': 0.8190592920739646}
[S4] START round=14 head_norm_before_train=1.241078 cos_to_last_merge=0.9970 (last merge round=12)
[S4] round=14 local utility u=0.466537 metrics={'f1_val': 0.6138208521784195, 'auprc': 0.9448581374151442, 'loss_val': 0.4840702147734978, 'psi': 0.7462357662731094}-{'f1_val': 0.6024063575083537, 'auprc': 0.6637626149103253, 'loss_val': 0.5053704875163797, 'psi': 0.6269488604691423}
[S5] START round=14 head_norm_before_train=1.477380 (no previous merge yet)
[S5] round=14 local utility u=0.024251 metrics={'f1_val': 0.7011041183246911, 'auprc': 0.8646095116182283, 'loss_val': 0.4289545421014413, 'psi': 0.7665062756421059}-{'f1_val': 0.7011046720655897, 'auprc': 0.8566937811631137, 'loss_val': 0.45371228514519196, 'psi': 0.7633403157045993}
[S6] START round=14 head_norm_before_train=1.742651 (no previous merge yet)
[S6] round=14 local utility u=0.405581 metrics={'f1_val': 0.9616614853712895, 'auprc': 0.9718980217590153, 'loss_val': 0.21572224181948313, 'psi': 0.9657560999263798}-{'f1_val': 0.8429275570153033, 'auprc': 0.9711101582300018, 'loss_val': 0.31211804222099854, 'psi': 0.8942005975011827}
[S7] START round=14 head_norm_before_train=1.183130 cos_to_last_merge=0.8819 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.882
[S7] round=14 local utility u=0.918127 metrics={'f1_val': 0.7139737313795297, 'auprc': 0.8727717110649534, 'loss_val': 0.7442773299126697, 'psi': 0.7774929232536992}-{'f1_val': 0.41679099637737954, 'auprc': 0.8539956345402385, 'loss_val': 0.7411060518113187, 'psi': 0.5916728516425231}
[S8] START round=14 head_norm_before_train=1.832987 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.009236 metrics={'f1_val': 0.9948741547680577, 'auprc': 0.998034699756214, 'loss_val': 0.10027545323651559, 'psi': 0.9961383727633202}-{'f1_val': 0.9942851599023415, 'auprc': 0.9957773302518689, 'loss_val': 0.10844147290628625, 'psi': 0.9948820280421524}
[S9] START round=14 head_norm_before_train=1.595197 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981234654246093, 'loss_val': 0.2011401472815161, 'psi': 0.8199793346338549}-{'f1_val': 0.7014667606303384, 'auprc': 0.9982400771772669, 'loss_val': 0.18489651883332997, 'psi': 0.8201760872491098}
[S10] START round=14 head_norm_before_train=1.840365 (no previous merge yet)
[S10] round=14 local utility u=0.006342 metrics={'f1_val': 0.9953781662514098, 'auprc': 0.9956072148377986, 'loss_val': 0.042446343367086324, 'psi': 0.9954697856859653}-{'f1_val': 0.9947060979488367, 'auprc': 0.9965358468767553, 'loss_val': 0.05388301223052205, 'psi': 0.9954379975200042}
[S11] START round=14 head_norm_before_train=0.904909 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9176000888669645, 'loss_val': 0.5954188000441261, 'psi': 0.7882012255257779}-{'f1_val': 0.7016934795869249, 'auprc': 0.9289217470610116, 'loss_val': 0.603269751807972, 'psi': 0.7925847865765596}
[S13] START round=14 head_norm_before_train=1.047031 cos_to_last_merge=0.9952 (last merge round=12)
[S13] round=14 local utility u=0.179757 metrics={'f1_val': 0.6984391495037694, 'auprc': 0.7034335519945761, 'loss_val': 0.4857709731036851, 'psi': 0.700436910500092}-{'f1_val': 0.65339590809043, 'auprc': 0.7076530508624632, 'loss_val': 0.5876840985955334, 'psi': 0.6750987651992433}
[S14] START round=14 head_norm_before_train=1.002093 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.030166 metrics={'f1_val': 0.7020642042475782, 'auprc': 0.9997249414264788, 'loss_val': 0.5800960853952638, 'psi': 0.8211284991191385}-{'f1_val': 0.701819167019819, 'auprc': 0.9999108842435985, 'loss_val': 0.6395155218430942, 'psi': 0.8210558539093308}
[S15] START round=14 head_norm_before_train=0.902217 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.800418 metrics={'f1_val': 0.8290519562789478, 'auprc': 0.9938864441355593, 'loss_val': 0.3076325535778829, 'psi': 0.8949857514215924}-{'f1_val': 0.6980909962905224, 'auprc': 0.7799104860841715, 'loss_val': 0.4807740828529514, 'psi': 0.7308187922079821}
[S16] START round=14 head_norm_before_train=0.832448 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.424420 metrics={'f1_val': 0.6672756011060135, 'auprc': 0.7371889310150428, 'loss_val': 0.7790675990722452, 'psi': 0.6952409330696252}-{'f1_val': 0.5137803623194899, 'auprc': 0.7496185145526223, 'loss_val': 0.7442242679550127, 'psi': 0.6081156232127428}
[S17] START round=14 head_norm_before_train=1.040464 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.341817842939373, 'auprc': 0.6587106964474809, 'loss_val': 1.0118254065912546, 'psi': 0.46857498434261613}-{'f1_val': 0.3513523920156526, 'auprc': 0.6391391764733549, 'loss_val': 0.9768222623254019, 'psi': 0.4664671057987335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:45917
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:45903
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:45904
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:45913
[S7] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=0.2512
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.5672
[S15] RECEIVED delta(kind=head bytes=1805) from S16
[S15] cosine check vs S16: cos=0.8986
[S4] RECEIVED delta(kind=head bytes=1798) from S7
[S4] cosine check vs S7: cos=0.9488
[S14] RECEIVED delta(kind=head bytes=1804) from S4
[S14] cosine check vs S4: cos=0.5030
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=0.9918
[S17] RECEIVED delta(kind=head bytes=1793) from S3
[S17] cosine check vs S3: cos=0.8382
[S13] RECEIVED delta(kind=head bytes=1796) from S15
[S13] cosine check vs S15: cos=0.8468
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.7565
[S8] RECEIVED delta(kind=head bytes=1797) from S10
[S8] cosine check vs S10: cos=0.9955
[S2] RECEIVED delta(kind=head bytes=1796) from S13
[S2] cosine check vs S13: cos=0.9523
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.5441 head_norm=1.310440
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.099075e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.5272 head_norm=1.200767 delta_norm=0.209908
[S2] aggregate: ROLLBACK (f1_val pre=0.544 post=0.527 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7019 head_norm=0.946023
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.491365e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7019 head_norm=0.930462 delta_norm=0.349136
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.6673 head_norm=0.876540
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.225014e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.7716 head_norm=1.067230 delta_norm=0.622501
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.6138 head_norm=1.284378
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.030478e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.6138 head_norm=1.226980 delta_norm=0.203048
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.9949 head_norm=1.864638
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.929567e-02
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.9945 head_norm=1.870789 delta_norm=0.089296
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.7003 head_norm=1.806271
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.210271e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.7006 head_norm=1.831693 delta_norm=0.121027
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.8291 head_norm=0.995734
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.186657e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.8168 head_norm=0.912189 delta_norm=0.218666
[S15] aggregate: ROLLBACK (f1_val pre=0.829 post=0.817 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.6984 head_norm=1.120068
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.987776e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.7000 head_norm=1.016735 delta_norm=0.298778
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.7021 head_norm=1.039400
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.888322e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.7021 head_norm=1.009092 delta_norm=0.588832
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3418 head_norm=1.091297
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.160866e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3443 head_norm=1.114454 delta_norm=0.416087
[S17] aggregate: ACCEPT kept=['S6', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.200767 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.758644 metrics={'f1_val': 0.7068896789619946, 'auprc': 0.7040151190935546, 'loss_val': 0.45399876774022063, 'psi': 0.7057398550146186}-{'f1_val': 0.5441353616725625, 'auprc': 0.675192579661417, 'loss_val': 0.9082942354590522, 'psi': 0.5965582488681043}
[S3] START round=15 head_norm_before_train=1.831693 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.023639 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9999974667554088, 'loss_val': 0.2971120100099625, 'psi': 0.82049802771745}-{'f1_val': 0.700330919019862, 'auprc': 0.9984535943529198, 'loss_val': 0.33675367460051653, 'psi': 0.8195799891530852}
[S4] START round=15 head_norm_before_train=1.226980 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.612691206675973, 'auprc': 0.9498901534027175, 'loss_val': 0.4942284033014796, 'psi': 0.7475707853666709}-{'f1_val': 0.6138208521784195, 'auprc': 0.9448581374151442, 'loss_val': 0.4840702147734978, 'psi': 0.7462357662731094}
[S5] START round=15 head_norm_before_train=1.511507 (no previous merge yet)
[S5] round=15 local utility u=0.012082 metrics={'f1_val': 0.6996025077824314, 'auprc': 0.8606560096224883, 'loss_val': 0.38391993608890185, 'psi': 0.7640239085184541}-{'f1_val': 0.7011041183246911, 'auprc': 0.8646095116182283, 'loss_val': 0.4289545421014413, 'psi': 0.7665062756421059}
[S6] START round=15 head_norm_before_train=1.771067 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.821417842939949, 'auprc': 0.8848743489230642, 'loss_val': 0.4659068418896569, 'psi': 0.8468004453331951}-{'f1_val': 0.9616614853712895, 'auprc': 0.9718980217590153, 'loss_val': 0.21572224181948313, 'psi': 0.9657560999263798}
[S7] START round=15 head_norm_before_train=1.201579 cos_to_last_merge=0.8743 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.874
[S7] round=15 local utility u=0.053813 metrics={'f1_val': 0.67937252493088, 'auprc': 0.9611976932392989, 'loss_val': 0.6943223806783364, 'psi': 0.7921025922542475}-{'f1_val': 0.7139737313795297, 'auprc': 0.8727717110649534, 'loss_val': 0.7442773299126697, 'psi': 0.7774929232536992}
[S8] START round=15 head_norm_before_train=1.870789 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.008236 metrics={'f1_val': 0.9945058427751525, 'auprc': 0.9984934043254803, 'loss_val': 0.08296892963033825, 'psi': 0.9961008673952836}-{'f1_val': 0.9948741547680577, 'auprc': 0.998034699756214, 'loss_val': 0.10027545323651559, 'psi': 0.9961383727633202}
[S9] START round=15 head_norm_before_train=1.629069 (no previous merge yet)
[S9] round=15 local utility u=0.895213 metrics={'f1_val': 0.9882473538397808, 'auprc': 0.9981186771561605, 'loss_val': 0.13288463539480566, 'psi': 0.9921958831663327}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981234654246093, 'loss_val': 0.2011401472815161, 'psi': 0.8199793346338549}
[S10] START round=15 head_norm_before_train=1.881163 (no previous merge yet)
[S10] round=15 local utility u=0.000918 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9955846467047376, 'loss_val': 0.03808271889060932, 'psi': 0.9952147706009407}-{'f1_val': 0.9953781662514098, 'auprc': 0.9956072148377986, 'loss_val': 0.042446343367086324, 'psi': 0.9954697856859653}
[S11] START round=15 head_norm_before_train=0.930462 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.910614507007824, 'loss_val': 0.5796170994944373, 'psi': 0.7852227721416725}-{'f1_val': 0.7019353166316534, 'auprc': 0.9176000888669645, 'loss_val': 0.5954188000441261, 'psi': 0.7882012255257779}
[S13] START round=15 head_norm_before_train=1.016735 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5868690110515331, 'auprc': 0.7204174875925639, 'loss_val': 0.7000964276764037, 'psi': 0.6402884016679453}-{'f1_val': 0.6984391495037694, 'auprc': 0.7034335519945761, 'loss_val': 0.4857709731036851, 'psi': 0.700436910500092}
[S14] START round=15 head_norm_before_train=1.009092 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.076899 metrics={'f1_val': 0.7019943617210709, 'auprc': 0.9990509696441872, 'loss_val': 0.4238562487191583, 'psi': 0.8208170048903174}-{'f1_val': 0.7020642042475782, 'auprc': 0.9997249414264788, 'loss_val': 0.5800960853952638, 'psi': 0.8211284991191385}
[S15] START round=15 head_norm_before_train=0.912189 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.7773013840728444, 'auprc': 0.9665563313974845, 'loss_val': 0.37107421970209203, 'psi': 0.8530033630027005}-{'f1_val': 0.8290519562789478, 'auprc': 0.9938864441355593, 'loss_val': 0.3076325535778829, 'psi': 0.8949857514215924}
[S16] START round=15 head_norm_before_train=1.067230 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.628930588245908, 'auprc': 0.7581579650633498, 'loss_val': 0.7314167049525879, 'psi': 0.6806215389728847}-{'f1_val': 0.6672756011060135, 'auprc': 0.7371889310150428, 'loss_val': 0.7790675990722452, 'psi': 0.6952409330696252}
[S17] START round=15 head_norm_before_train=1.114454 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.592479 metrics={'f1_val': 0.517751530229813, 'auprc': 0.6795854127024644, 'loss_val': 0.9450927377601642, 'psi': 0.5824850832188736}-{'f1_val': 0.341817842939373, 'auprc': 0.6587106964474809, 'loss_val': 1.0118254065912546, 'psi': 0.46857498434261613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:45903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:45909
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:45912
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:45916
[S3] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] cosine check vs S14: cos=0.9200
[S3] RECEIVED delta(kind=head bytes=1793) from S8
[S3] cosine check vs S8: cos=0.9938
[S8] RECEIVED delta(kind=head bytes=1799) from S10
[S8] cosine check vs S10: cos=0.9965
[S17] RECEIVED delta(kind=head bytes=1799) from S3
[S17] cosine check vs S3: cos=0.8083
[S17] RECEIVED delta(kind=head bytes=1796) from S2
[S17] cosine check vs S2: cos=0.1796
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.9273
[S16] RECEIVED delta(kind=head bytes=1800) from S9
[S16] cosine check vs S9: cos=0.3311
[S4] RECEIVED delta(kind=head bytes=1803) from S7
[S4] cosine check vs S7: cos=0.9750
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] cosine check vs S17: cos=0.4651
[S13] ⇄ pheromone p=0.139 → S2@127.0.0.1:45902
[S15] ⇄ pheromone p=0.293 → S13@127.0.0.1:45913
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7016 head_norm=0.969054
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.063578e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7016 head_norm=0.990599 delta_norm=0.206358
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.155 → S16@127.0.0.1:45916
[S6] ⇄ pheromone p=0.311 → S17@127.0.0.1:45917
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.6127 head_norm=1.278025
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.428535e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.6144 head_norm=1.239756 delta_norm=0.142854
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.148 → S14@127.0.0.1:45914
[S10] ⇄ pheromone p=0.144 → S8@127.0.0.1:45909
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9945 head_norm=1.905264
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.037242e-02
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.9941 head_norm=1.907599 delta_norm=0.080372
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.238 → S3@127.0.0.1:45903
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.7008 head_norm=1.863034
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.073282e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.7008 head_norm=1.881208 delta_norm=0.107328
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.202 → S17@127.0.0.1:45917
[S7] ⇄ pheromone p=0.372 → S4@127.0.0.1:45904
[S2] ⇄ pheromone p=0.262 → S17@127.0.0.1:45917
[S5] ⇄ pheromone p=0.161 → S16@127.0.0.1:45916
[S9] ⇄ pheromone p=0.302 → S16@127.0.0.1:45916
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.7020 head_norm=1.052937
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.733948e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.7020 head_norm=0.946482 delta_norm=0.573395
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.208 → S11@127.0.0.1:45912
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.6289 head_norm=1.106052
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.935223e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.6313 head_norm=1.086910 delta_norm=0.293522
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.227 → S15@127.0.0.1:45915
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.5178 head_norm=1.157818
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.862008e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3529 head_norm=1.071903 delta_norm=0.386201
[S17] aggregate: ROLLBACK (f1_val pre=0.518 post=0.353 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.199 → S14@127.0.0.1:45914
[S2] START round=16 head_norm_before_train=1.231418 cos_to_last_merge=0.9992 (last merge round=14)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.596914898759807, 'auprc': 0.6372974513724329, 'loss_val': 0.751834963531968, 'psi': 0.6130679198048573}-{'f1_val': 0.7068896789619946, 'auprc': 0.7040151190935546, 'loss_val': 0.45399876774022063, 'psi': 0.7057398550146186}
[S3] START round=16 head_norm_before_train=1.881208 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.888395 metrics={'f1_val': 0.9975008906960017, 'auprc': 0.9979720696804931, 'loss_val': 0.29426061667881914, 'psi': 0.9976893622897982}-{'f1_val': 0.7008317350254774, 'auprc': 0.9999974667554088, 'loss_val': 0.2971120100099625, 'psi': 0.82049802771745}
[S4] START round=16 head_norm_before_train=1.239756 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.973023 metrics={'f1_val': 0.9342028494845621, 'auprc': 0.9517009800317247, 'loss_val': 0.4826843257099338, 'psi': 0.9412021017034271}-{'f1_val': 0.612691206675973, 'auprc': 0.9498901534027175, 'loss_val': 0.4942284033014796, 'psi': 0.7475707853666709}
[S5] START round=16 head_norm_before_train=1.544029 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.5343801635208477, 'auprc': 0.8308557368287874, 'loss_val': 0.6253297813963944, 'psi': 0.6529703928440236}-{'f1_val': 0.6996025077824314, 'auprc': 0.8606560096224883, 'loss_val': 0.38391993608890185, 'psi': 0.7640239085184541}
[S6] START round=16 head_norm_before_train=1.783417 (no previous merge yet)
[S6] round=16 local utility u=0.718711 metrics={'f1_val': 0.9636367014725875, 'auprc': 0.985072677179596, 'loss_val': 0.18239262626950398, 'psi': 0.972211091755391}-{'f1_val': 0.821417842939949, 'auprc': 0.8848743489230642, 'loss_val': 0.4659068418896569, 'psi': 0.8468004453331951}
[S7] START round=16 head_norm_before_train=1.217151 cos_to_last_merge=0.8711 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.871
[S7] round=16 local utility u=0.066050 metrics={'f1_val': 0.6984500663429607, 'auprc': 0.9656583911863192, 'loss_val': 0.6900700749415409, 'psi': 0.8053333962803041}-{'f1_val': 0.67937252493088, 'auprc': 0.9611976932392989, 'loss_val': 0.6943223806783364, 'psi': 0.7921025922542475}
[S8] START round=16 head_norm_before_train=1.907599 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000927 metrics={'f1_val': 0.99388965297913, 'auprc': 0.9988692229307077, 'loss_val': 0.07854530938552283, 'psi': 0.9958814809597611}-{'f1_val': 0.9945058427751525, 'auprc': 0.9984934043254803, 'loss_val': 0.08296892963033825, 'psi': 0.9961008673952836}
[S9] START round=16 head_norm_before_train=1.657232 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9800583557618099, 'auprc': 0.9984961923675104, 'loss_val': 0.12225775964155243, 'psi': 0.98743349040409}-{'f1_val': 0.9882473538397808, 'auprc': 0.9981186771561605, 'loss_val': 0.13288463539480566, 'psi': 0.9921958831663327}
[S10] START round=16 head_norm_before_train=1.913310 (no previous merge yet)
[S10] round=16 local utility u=0.001420 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9955968035915272, 'loss_val': 0.03527943265536433, 'psi': 0.9952196333556567}-{'f1_val': 0.9949681865317428, 'auprc': 0.9955846467047376, 'loss_val': 0.03808271889060932, 'psi': 0.9952147706009407}
[S11] START round=16 head_norm_before_train=0.990599 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.013754 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9082969333157938, 'loss_val': 0.5469989487882083, 'psi': 0.7844799633053096}-{'f1_val': 0.7016282822309048, 'auprc': 0.910614507007824, 'loss_val': 0.5796170994944373, 'psi': 0.7852227721416725}
[S13] START round=16 head_norm_before_train=1.065742 cos_to_last_merge=0.9977 (last merge round=14)
[S13] round=16 local utility u=0.010914 metrics={'f1_val': 0.6135316468564996, 'auprc': 0.6580256179463259, 'loss_val': 0.6510690911014259, 'psi': 0.6313292352924301}-{'f1_val': 0.5868690110515331, 'auprc': 0.7204174875925639, 'loss_val': 0.7000964276764037, 'psi': 0.6402884016679453}
[S14] START round=16 head_norm_before_train=0.946482 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.701751512821432, 'auprc': 0.9974270117195891, 'loss_val': 0.42376401389327123, 'psi': 0.8200217123806949}-{'f1_val': 0.7019943617210709, 'auprc': 0.9990509696441872, 'loss_val': 0.4238562487191583, 'psi': 0.8208170048903174}
[S15] START round=16 head_norm_before_train=1.001363 cos_to_last_merge=0.9901 (last merge round=14)
[S15] round=16 local utility u=0.182185 metrics={'f1_val': 0.8083212752946662, 'auprc': 0.9927635750080454, 'loss_val': 0.2714445889417462, 'psi': 0.882098195180018}-{'f1_val': 0.7773013840728444, 'auprc': 0.9665563313974845, 'loss_val': 0.37107421970209203, 'psi': 0.8530033630027005}
[S16] START round=16 head_norm_before_train=1.086910 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.072813 metrics={'f1_val': 0.6437086851100915, 'auprc': 0.7659385571643844, 'loss_val': 0.6978003837782456, 'psi': 0.6926006339318087}-{'f1_val': 0.628930588245908, 'auprc': 0.7581579650633498, 'loss_val': 0.7314167049525879, 'psi': 0.6806215389728847}
[S17] START round=16 head_norm_before_train=1.071903 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.574730 metrics={'f1_val': 0.6164795710163071, 'auprc': 0.7694927059896948, 'loss_val': 0.6577232145751783, 'psi': 0.6776848250056622}-{'f1_val': 0.517751530229813, 'auprc': 0.6795854127024644, 'loss_val': 0.9450927377601642, 'psi': 0.5824850832188736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:45914
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:45903
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:45902
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:45913
[S13] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S15
[S13] cosine check vs S15: cos=0.9309
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=0.9958
[S8] RECEIVED delta(kind=head bytes=1795) from S10
[S8] cosine check vs S10: cos=0.9973
[S17] RECEIVED delta(kind=head bytes=1795) from S3
[S17] cosine check vs S3: cos=0.8488
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] cosine check vs S6: cos=0.2437
[S16] RECEIVED delta(kind=head bytes=1802) from S11
[S16] cosine check vs S11: cos=0.0723
[S4] RECEIVED delta(kind=head bytes=1798) from S7
[S4] cosine check vs S7: cos=0.9821
[S14] RECEIVED delta(kind=head bytes=1803) from S4
[S14] cosine check vs S4: cos=0.5639
[S2] RECEIVED delta(kind=head bytes=1794) from S13
[S2] cosine check vs S13: cos=0.9322
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] cosine check vs S16: cos=0.7450
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=0.9091
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.7018 head_norm=0.993088
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.038609e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.7018 head_norm=0.955062 delta_norm=0.203861
[S14] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.5969 head_norm=1.273036
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.336486e-01
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.5841 head_norm=1.170687 delta_norm=0.233649
[S2] aggregate: ROLLBACK (f1_val pre=0.597 post=0.584 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9939 head_norm=1.941368
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.193828e-02
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9943 head_norm=1.940750 delta_norm=0.071938
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.8083 head_norm=1.118381
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.011293e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.8080 head_norm=1.049235 delta_norm=0.401129
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.9342 head_norm=1.292019
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.229074e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9338 head_norm=1.257856 delta_norm=0.122907
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6135 head_norm=1.108865
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.070967e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6178 head_norm=1.094207 delta_norm=0.207097
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.9975 head_norm=1.910349
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.957119e-02
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.7749 head_norm=1.923837 delta_norm=0.089571
[S3] aggregate: ROLLBACK (f1_val pre=0.998 post=0.775 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.6437 head_norm=1.128195
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.340542e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.6519 head_norm=0.788925 delta_norm=0.734054
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.6165 head_norm=1.127159
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.210176e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.6117 head_norm=1.156577 delta_norm=0.421018
[S17] aggregate: ACCEPT kept=['S3', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.170687 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.5886084898567984, 'auprc': 0.6310349041082968, 'loss_val': 0.7561503009108678, 'psi': 0.6055790555573977}-{'f1_val': 0.596914898759807, 'auprc': 0.6372974513724329, 'loss_val': 0.751834963531968, 'psi': 0.6130679198048573}
[S3] START round=17 head_norm_before_train=1.923837 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.8855760613763463, 'auprc': 0.999995851316297, 'loss_val': 0.21076194590572556, 'psi': 0.9313439773523265}-{'f1_val': 0.9975008906960017, 'auprc': 0.9979720696804931, 'loss_val': 0.29426061667881914, 'psi': 0.9976893622897982}
[S4] START round=17 head_norm_before_train=1.257856 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.063146 metrics={'f1_val': 0.9536970613248607, 'auprc': 0.9483097600757616, 'loss_val': 0.4631839506256041, 'psi': 0.951542140825221}-{'f1_val': 0.9342028494845621, 'auprc': 0.9517009800317247, 'loss_val': 0.4826843257099338, 'psi': 0.9412021017034271}
[S5] START round=17 head_norm_before_train=1.571282 (no previous merge yet)
[S5] round=17 local utility u=0.909566 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.9900783531228402, 'loss_val': 0.2827273304184288, 'psi': 0.8165455113386553}-{'f1_val': 0.5343801635208477, 'auprc': 0.8308557368287874, 'loss_val': 0.6253297813963944, 'psi': 0.6529703928440236}
[S6] START round=17 head_norm_before_train=1.795461 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.5980407109264543, 'auprc': 0.9218353845831126, 'loss_val': 0.8800302851817388, 'psi': 0.7275585803891176}-{'f1_val': 0.9636367014725875, 'auprc': 0.985072677179596, 'loss_val': 0.18239262626950398, 'psi': 0.972211091755391}
[S7] START round=17 head_norm_before_train=1.235032 cos_to_last_merge=0.8666 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.867
[S7] round=17 local utility u=0.042739 metrics={'f1_val': 0.7122380087186313, 'auprc': 0.9327790022430111, 'loss_val': 0.5886821816097554, 'psi': 0.8004544061283833}-{'f1_val': 0.6984500663429607, 'auprc': 0.9656583911863192, 'loss_val': 0.6900700749415409, 'psi': 0.8053333962803041}
[S8] START round=17 head_norm_before_train=1.940750 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9977551487959126, 'loss_val': 0.06963198920229204, 'psi': 0.9944066037364321}-{'f1_val': 0.99388965297913, 'auprc': 0.9988692229307077, 'loss_val': 0.07854530938552283, 'psi': 0.9958814809597611}
[S9] START round=17 head_norm_before_train=1.685570 (no previous merge yet)
[S9] round=17 local utility u=0.063544 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984894934871149, 'loss_val': 0.08975894236630395, 'psi': 0.9968918284133572}-{'f1_val': 0.9800583557618099, 'auprc': 0.9984961923675104, 'loss_val': 0.12225775964155243, 'psi': 0.98743349040409}
[S10] START round=17 head_norm_before_train=1.942798 (no previous merge yet)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.9947060979488367, 'auprc': 0.995657187816487, 'loss_val': 0.03570236440163773, 'psi': 0.9950865338958969}-{'f1_val': 0.9949681865317428, 'auprc': 0.9955968035915272, 'loss_val': 0.03527943265536433, 'psi': 0.9952196333556567}
[S11] START round=17 head_norm_before_train=1.024526 cos_to_last_merge=0.9977 (last merge round=15)
[S11] round=17 local utility u=0.036843 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9074188024562606, 'loss_val': 0.46922841892909717, 'psi': 0.7839836087346592}-{'f1_val': 0.7019353166316534, 'auprc': 0.9082969333157938, 'loss_val': 0.5469989487882083, 'psi': 0.7844799633053096}
[S13] START round=17 head_norm_before_train=1.094207 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.144399 metrics={'f1_val': 0.6235093394055002, 'auprc': 0.726780296444125, 'loss_val': 0.6284005183869608, 'psi': 0.6648177222209501}-{'f1_val': 0.6135316468564996, 'auprc': 0.6580256179463259, 'loss_val': 0.6510690911014259, 'psi': 0.6313292352924301}
[S14] START round=17 head_norm_before_train=0.955062 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.723674 metrics={'f1_val': 0.9299080134627149, 'auprc': 0.9980136949429669, 'loss_val': 0.34711579302832546, 'psi': 0.9571502860548157}-{'f1_val': 0.701751512821432, 'auprc': 0.9974270117195891, 'loss_val': 0.42376401389327123, 'psi': 0.8200217123806949}
[S15] START round=17 head_norm_before_train=1.049235 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.567774 metrics={'f1_val': 0.991395759649613, 'auprc': 0.9917683002734949, 'loss_val': 0.23135671203637379, 'psi': 0.9915447758991658}-{'f1_val': 0.8083212752946662, 'auprc': 0.9927635750080454, 'loss_val': 0.2714445889417462, 'psi': 0.882098195180018}
[S16] START round=17 head_norm_before_train=0.788925 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.6489875703618497, 'auprc': 0.7803933106893611, 'loss_val': 0.7867936622824092, 'psi': 0.7015498664928543}-{'f1_val': 0.6437086851100915, 'auprc': 0.7659385571643844, 'loss_val': 0.6978003837782456, 'psi': 0.6926006339318087}
[S17] START round=17 head_norm_before_train=1.156577 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.46468344841173825, 'auprc': 0.8390958443585186, 'loss_val': 0.6691113058373772, 'psi': 0.6144484067904503}-{'f1_val': 0.6164795710163071, 'auprc': 0.7694927059896948, 'loss_val': 0.6577232145751783, 'psi': 0.6776848250056622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:45912
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:45916
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:45904
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:45902
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S9
[S16] cosine check vs S9: cos=0.5337
[S16] RECEIVED delta(kind=head bytes=1802) from S11
[S16] cosine check vs S11: cos=0.6725
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.5273
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] cosine check vs S13: cos=0.9453
[S4] RECEIVED delta(kind=head bytes=1800) from S7
[S4] cosine check vs S7: cos=0.9862
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] cosine check vs S15: cos=0.9166
[S11] RECEIVED delta(kind=head bytes=1805) from S14
[S11] cosine check vs S14: cos=0.9292
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] cosine check vs S4: cos=0.7022
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.5886 head_norm=1.217485
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.985660e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.5995 head_norm=1.162463 delta_norm=0.198566
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7017 head_norm=1.059998
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.962472e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.7017 head_norm=1.015224 delta_norm=0.196247
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9537 head_norm=1.306987
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.094652e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.9552 head_norm=1.276206 delta_norm=0.109465
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.6235 head_norm=1.139837
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.338089e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6248 head_norm=1.120384 delta_norm=0.233809
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9299 head_norm=1.007368
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.674282e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9426 head_norm=1.069118 delta_norm=0.467428
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.6490 head_norm=0.829837
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.279250e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.6639 head_norm=0.828030 delta_norm=0.127925
[S16] aggregate: ACCEPT kept=['S9', 'S11', 'S5'] (k=3/3) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.162463 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.711106 metrics={'f1_val': 0.7167611475282539, 'auprc': 0.7480889710832248, 'loss_val': 0.45401652002741505, 'psi': 0.7292922769502423}-{'f1_val': 0.5886084898567984, 'auprc': 0.6310349041082968, 'loss_val': 0.7561503009108678, 'psi': 0.6055790555573977}
[S3] START round=18 head_norm_before_train=1.948192 cos_to_last_merge=0.9998 (last merge round=16)
[S3] round=18 local utility u=0.358848 metrics={'f1_val': 0.998823859603541, 'auprc': 0.9998320263849576, 'loss_val': 0.17206186300708987, 'psi': 0.9992271263161077}-{'f1_val': 0.8855760613763463, 'auprc': 0.999995851316297, 'loss_val': 0.21076194590572556, 'psi': 0.9313439773523265}
[S4] START round=18 head_norm_before_train=1.276206 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9403352926313115, 'auprc': 0.9519003852964204, 'loss_val': 0.45317780275215713, 'psi': 0.9449613296973551}-{'f1_val': 0.9536970613248607, 'auprc': 0.9483097600757616, 'loss_val': 0.4631839506256041, 'psi': 0.951542140825221}
[S5] START round=18 head_norm_before_train=1.588892 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9876386591074207, 'loss_val': 0.30033228109903803, 'psi': 0.8154209200464367}-{'f1_val': 0.7008569501491988, 'auprc': 0.9900783531228402, 'loss_val': 0.2827273304184288, 'psi': 0.8165455113386553}
[S6] START round=18 head_norm_before_train=1.804542 (no previous merge yet)
[S6] round=18 local utility u=0.927966 metrics={'f1_val': 0.8215415294246204, 'auprc': 0.961027171837213, 'loss_val': 0.48267927116067855, 'psi': 0.8773357863896575}-{'f1_val': 0.5980407109264543, 'auprc': 0.9218353845831126, 'loss_val': 0.8800302851817388, 'psi': 0.7275585803891176}
[S7] START round=18 head_norm_before_train=1.254255 cos_to_last_merge=0.8619 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.862
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5152975998813205, 'auprc': 0.8862613127800428, 'loss_val': 0.7476200883375854, 'psi': 0.6636830850408094}-{'f1_val': 0.7122380087186313, 'auprc': 0.9327790022430111, 'loss_val': 0.5886821816097554, 'psi': 0.8004544061283833}
[S8] START round=18 head_norm_before_train=1.970333 cos_to_last_merge=0.9996 (last merge round=16)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9933009232156067, 'auprc': 0.9984418094576414, 'loss_val': 0.0786311674706961, 'psi': 0.9953572777124206}-{'f1_val': 0.992174240363445, 'auprc': 0.9977551487959126, 'loss_val': 0.06963198920229204, 'psi': 0.9944066037364321}
[S9] START round=18 head_norm_before_train=1.712138 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9916350289240425, 'auprc': 0.998488148690003, 'loss_val': 0.07299043689185788, 'psi': 0.9943762768304267}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984894934871149, 'loss_val': 0.08975894236630395, 'psi': 0.9968918284133572}
[S10] START round=18 head_norm_before_train=1.968852 (no previous merge yet)
[S10] round=18 local utility u=0.002375 metrics={'f1_val': 0.9951206531446913, 'auprc': 0.995639003748635, 'loss_val': 0.03338465270968471, 'psi': 0.9953279933862689}-{'f1_val': 0.9947060979488367, 'auprc': 0.995657187816487, 'loss_val': 0.03570236440163773, 'psi': 0.9950865338958969}
[S11] START round=18 head_norm_before_train=1.015224 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.034013 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9310169891287408, 'loss_val': 0.47344773118518535, 'psi': 0.7935679856304884}-{'f1_val': 0.7016934795869249, 'auprc': 0.9074188024562606, 'loss_val': 0.46922841892909717, 'psi': 0.7839836087346592}
[S13] START round=18 head_norm_before_train=1.120384 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.127886 metrics={'f1_val': 0.6581585505741069, 'auprc': 0.7202281863264649, 'loss_val': 0.5608683656082047, 'psi': 0.68298640487505}-{'f1_val': 0.6235093394055002, 'auprc': 0.726780296444125, 'loss_val': 0.6284005183869608, 'psi': 0.6648177222209501}
[S14] START round=18 head_norm_before_train=1.069118 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.060646 metrics={'f1_val': 0.9423488607791358, 'auprc': 0.9976908358236605, 'loss_val': 0.2995011754314988, 'psi': 0.9644856507969457}-{'f1_val': 0.9299080134627149, 'auprc': 0.9980136949429669, 'loss_val': 0.34711579302832546, 'psi': 0.9571502860548157}
[S15] START round=18 head_norm_before_train=1.149185 cos_to_last_merge=0.9900 (last merge round=16)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.8274808904527053, 'auprc': 0.9918202459309119, 'loss_val': 0.25707326906872713, 'psi': 0.893216632643988}-{'f1_val': 0.991395759649613, 'auprc': 0.9917683002734949, 'loss_val': 0.23135671203637379, 'psi': 0.9915447758991658}
[S16] START round=18 head_norm_before_train=0.828030 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.287925 metrics={'f1_val': 0.725837891188215, 'auprc': 0.7901283518956317, 'loss_val': 0.7012504125012737, 'psi': 0.7515540754711816}-{'f1_val': 0.6489875703618497, 'auprc': 0.7803933106893611, 'loss_val': 0.7867936622824092, 'psi': 0.7015498664928543}
[S17] START round=18 head_norm_before_train=1.204422 cos_to_last_merge=0.9942 (last merge round=16)
[S17] round=18 local utility u=1.000000 metrics={'f1_val': 0.7495558278910329, 'auprc': 0.9458999821586764, 'loss_val': 0.5290295776110461, 'psi': 0.8280934895980904}-{'f1_val': 0.46468344841173825, 'auprc': 0.8390958443585186, 'loss_val': 0.6691113058373772, 'psi': 0.6144484067904503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:45917
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:45917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:45917
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:45912
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:45902
[S13] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1794) from S3
[S17] cosine check vs S3: cos=0.8044
[S8] RECEIVED delta(kind=head bytes=1799) from S10
[S8] cosine check vs S10: cos=0.9956
[S11] RECEIVED delta(kind=head bytes=1806) from S14
[S11] cosine check vs S14: cos=0.9208
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=0.4784
[S17] RECEIVED delta(kind=head bytes=1799) from S2
[S17] cosine check vs S2: cos=0.2116
[S16] RECEIVED delta(kind=head bytes=1802) from S11
[S16] cosine check vs S11: cos=0.6125
[S15] RECEIVED delta(kind=head bytes=1797) from S16
[S15] cosine check vs S16: cos=0.8698
[S2] RECEIVED delta(kind=head bytes=1797) from S13
[S2] cosine check vs S13: cos=0.9452
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=0.4245
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9933 head_norm=1.998361
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.395362e-02
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9937 head_norm=1.990835 delta_norm=0.093954
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9423 head_norm=1.115757
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.398367e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.7248 head_norm=1.002821 delta_norm=0.639837
[S14] aggregate: ROLLBACK (f1_val pre=0.942 post=0.725 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.7019 head_norm=1.047095
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.178020e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.7019 head_norm=1.059822 delta_norm=0.217802
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.7168 head_norm=1.205441
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.980437e-01
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.7093 head_norm=1.178035 delta_norm=0.198044
[S2] aggregate: ROLLBACK (f1_val pre=0.717 post=0.709 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.7258 head_norm=0.873201
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.297755e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.8130 head_norm=0.862981 delta_norm=0.429776
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.8275 head_norm=1.247341
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.254266e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.8275 head_norm=1.026288 delta_norm=0.325427
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.7496 head_norm=1.259034
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.064733e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.7653 head_norm=1.061286 delta_norm=0.306473
[S17] aggregate: ACCEPT kept=['S3', 'S6', 'S2'] (k=3/3) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.178035 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.6436404515911051, 'auprc': 0.7874971925497156, 'loss_val': 0.6046024036928626, 'psi': 0.7011831479745493}-{'f1_val': 0.7167611475282539, 'auprc': 0.7480889710832248, 'loss_val': 0.45401652002741505, 'psi': 0.7292922769502423}
[S3] START round=19 head_norm_before_train=1.970740 cos_to_last_merge=0.9992 (last merge round=16)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.8634374657325887, 'auprc': 0.9999769273052362, 'loss_val': 0.3561858447903384, 'psi': 0.9180532503616476}-{'f1_val': 0.998823859603541, 'auprc': 0.9998320263849576, 'loss_val': 0.17206186300708987, 'psi': 0.9992271263161077}
[S4] START round=19 head_norm_before_train=1.328139 cos_to_last_merge=0.9974 (last merge round=17)
[S4] round=19 local utility u=0.069002 metrics={'f1_val': 0.9556897231160653, 'auprc': 0.9467902539588174, 'loss_val': 0.39196931836058985, 'psi': 0.9521299354531662}-{'f1_val': 0.9403352926313115, 'auprc': 0.9519003852964204, 'loss_val': 0.45317780275215713, 'psi': 0.9449613296973551}
[S5] START round=19 head_norm_before_train=1.604236 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.5825908701554128, 'auprc': 0.8537816330013411, 'loss_val': 0.505811766786766, 'psi': 0.6910671752937841}-{'f1_val': 0.7006090940057808, 'auprc': 0.9876386591074207, 'loss_val': 0.30033228109903803, 'psi': 0.8154209200464367}
[S6] START round=19 head_norm_before_train=1.813044 (no previous merge yet)
[S6] round=19 local utility u=0.087195 metrics={'f1_val': 0.8250681523100958, 'auprc': 0.9639454157749874, 'loss_val': 0.33820330096790474, 'psi': 0.8806190576960524}-{'f1_val': 0.8215415294246204, 'auprc': 0.961027171837213, 'loss_val': 0.48267927116067855, 'psi': 0.8773357863896575}
[S7] START round=19 head_norm_before_train=1.267944 cos_to_last_merge=0.8578 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.858
[S7] round=19 local utility u=0.631394 metrics={'f1_val': 0.6839945144732524, 'auprc': 0.9100026906775966, 'loss_val': 0.5682377227460681, 'psi': 0.7743977849549901}-{'f1_val': 0.5152975998813205, 'auprc': 0.8862613127800428, 'loss_val': 0.7476200883375854, 'psi': 0.6636830850408094}
[S8] START round=19 head_norm_before_train=1.990835 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000232 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.995420266053494, 'loss_val': 0.06890156268661451, 'psi': 0.9941285083423215}-{'f1_val': 0.9933009232156067, 'auprc': 0.9984418094576414, 'loss_val': 0.0786311674706961, 'psi': 0.9953572777124206}
[S9] START round=19 head_norm_before_train=1.741315 (no previous merge yet)
[S9] round=19 local utility u=0.020143 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9984839749989058, 'loss_val': 0.056340381410615606, 'psi': 0.9967394253300712}-{'f1_val': 0.9916350289240425, 'auprc': 0.998488148690003, 'loss_val': 0.07299043689185788, 'psi': 0.9943762768304267}
[S10] START round=19 head_norm_before_train=1.987727 (no previous merge yet)
[S10] round=19 local utility u=0.001221 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9956388481580507, 'loss_val': 0.031198185745434818, 'psi': 0.995353520491393}-{'f1_val': 0.9951206531446913, 'auprc': 0.995639003748635, 'loss_val': 0.03338465270968471, 'psi': 0.9953279933862689}
[S11] START round=19 head_norm_before_train=1.059822 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.053818 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9571975991157936, 'loss_val': 0.4425115524927775, 'psi': 0.8038560089848603}-{'f1_val': 0.7019353166316534, 'auprc': 0.9310169891287408, 'loss_val': 0.47344773118518535, 'psi': 0.7935679856304884}
[S13] START round=19 head_norm_before_train=1.183591 cos_to_last_merge=0.9962 (last merge round=17)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6143426223799169, 'auprc': 0.7354852041695521, 'loss_val': 0.6703544069046803, 'psi': 0.662799655095771}-{'f1_val': 0.6581585505741069, 'auprc': 0.7202281863264649, 'loss_val': 0.5608683656082047, 'psi': 0.68298640487505}
[S14] START round=19 head_norm_before_train=1.002821 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9418904241010506, 'auprc': 0.9994393166626423, 'loss_val': 0.31129203552881163, 'psi': 0.9649099811256874}-{'f1_val': 0.9423488607791358, 'auprc': 0.9976908358236605, 'loss_val': 0.2995011754314988, 'psi': 0.9644856507969457}
[S15] START round=19 head_norm_before_train=1.026288 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.7904418184553499, 'auprc': 0.9937124843159566, 'loss_val': 0.3165963917833765, 'psi': 0.8717500847995926}-{'f1_val': 0.8274808904527053, 'auprc': 0.9918202459309119, 'loss_val': 0.25707326906872713, 'psi': 0.893216632643988}
[S16] START round=19 head_norm_before_train=0.862981 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.047122 metrics={'f1_val': 0.7523570547035666, 'auprc': 0.8025200226888723, 'loss_val': 0.8032955557713708, 'psi': 0.7724222418976889}-{'f1_val': 0.725837891188215, 'auprc': 0.7901283518956317, 'loss_val': 0.7012504125012737, 'psi': 0.7515540754711816}
[S17] START round=19 head_norm_before_train=1.061286 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.5828743641449601, 'auprc': 0.7787898162751805, 'loss_val': 0.6757423841234375, 'psi': 0.6612405449970482}-{'f1_val': 0.7495558278910329, 'auprc': 0.9458999821586764, 'loss_val': 0.5290295776110461, 'psi': 0.8280934895980904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:45909
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:45915
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:45917
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:45916
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:45916
[S9] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=0.5960
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] cosine check vs S10: cos=0.9976
[S17] RECEIVED delta(kind=head bytes=1797) from S6
[S17] cosine check vs S6: cos=0.5105
[S16] RECEIVED delta(kind=head bytes=1804) from S9
[S16] cosine check vs S9: cos=0.4614
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=0.9944
[S16] RECEIVED delta(kind=head bytes=1803) from S11
[S16] cosine check vs S11: cos=0.8695
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] cosine check vs S16: cos=0.7990
[S4] RECEIVED delta(kind=head bytes=1798) from S7
[S4] cosine check vs S7: cos=0.9761
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.8634 head_norm=1.990328
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.068258e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.8631 head_norm=1.999498 delta_norm=0.106826
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] r=20 psi=0.918 u=0.0000 p_local=0.2312 f1=0.863 auprc=1.000 bytes=25146
[S5] r=20 psi=0.691 u=0.0000 p_local=0.1823 f1=0.583 auprc=0.854 bytes=28713
[S2] r=20 psi=0.701 u=0.0000 p_local=0.2211 f1=0.644 auprc=0.787 bytes=16183
[S13] r=20 psi=0.663 u=0.0000 p_local=0.0969 f1=0.614 auprc=0.735 bytes=23362
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9419 head_norm=1.050789
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.676994e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9488 head_norm=1.090998 delta_norm=0.567699
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.965 u=0.0000 p_local=0.1876 f1=0.942 auprc=0.999 bytes=25195
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9557 head_norm=1.385987
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.547466e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9558 head_norm=1.325915 delta_norm=0.154747
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.952 u=0.0690 p_local=0.1820 f1=0.956 auprc=0.947 bytes=19795
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.7524 head_norm=0.895961
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.488250e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.7496 head_norm=0.955204 delta_norm=0.348825
[S16] aggregate: ACCEPT kept=['S9', 'S11'] (k=2/2) mode=median trim_p=0.1
[S16] r=20 psi=0.772 u=0.0471 p_local=0.1560 f1=0.752 auprc=0.803 bytes=19790
[S11] r=20 psi=0.804 u=0.0538 p_local=0.0859 f1=0.702 auprc=0.957 bytes=21586
[S6] r=20 psi=0.881 u=0.0872 p_local=0.3667 f1=0.825 auprc=0.964 bytes=23393
[S9] r=20 psi=0.997 u=0.0201 p_local=0.1357 f1=0.996 auprc=0.998 bytes=23386
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9933 head_norm=2.014300
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.022983e-02
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9933 head_norm=2.007357 delta_norm=0.070230
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.994 u=0.0002 p_local=0.0977 f1=0.993 auprc=0.995 bytes=23367
[S10] r=20 psi=0.995 u=0.0012 p_local=0.0596 f1=0.995 auprc=0.996 bytes=30583
[S7] r=20 psi=0.774 u=0.6314 p_local=0.2909 f1=0.684 auprc=0.910 bytes=26982
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.7904 head_norm=1.123326
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.377689e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.7779 head_norm=0.958236 delta_norm=0.337769
[S15] aggregate: ROLLBACK (f1_val pre=0.790 post=0.778 tol_abs=0.005 tol_rel=0.0)
[S15] r=20 psi=0.872 u=0.0000 p_local=0.2115 f1=0.790 auprc=0.994 bytes=23352
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.5829 head_norm=1.116922
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.887681e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.6490 head_norm=1.288786 delta_norm=0.788768
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] r=20 psi=0.661 u=0.0000 p_local=0.3002 f1=0.583 auprc=0.779 bytes=23389
[S2] START round=20 head_norm_before_train=1.230024 cos_to_last_merge=0.9979 (last merge round=18)
[S2] round=20 local utility u=0.347760 metrics={'f1_val': 0.7130487514227536, 'auprc': 0.8099474518699609, 'loss_val': 0.39288308898127533, 'psi': 0.7518082316016366}-{'f1_val': 0.6436404515911051, 'auprc': 0.7874971925497156, 'loss_val': 0.6046024036928626, 'psi': 0.7011831479745493}
[S3] START round=20 head_norm_before_train=1.999498 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.473721 metrics={'f1_val': 0.9930103503032308, 'auprc': 0.9986996570159247, 'loss_val': 0.1823489900965844, 'psi': 0.9952860729883084}-{'f1_val': 0.8634374657325887, 'auprc': 0.9999769273052362, 'loss_val': 0.3561858447903384, 'psi': 0.9180532503616476}
[S4] START round=20 head_norm_before_train=1.325915 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.014705 metrics={'f1_val': 0.9552857194776195, 'auprc': 0.9507878523147331, 'loss_val': 0.3721272638885803, 'psi': 0.9534865726124649}-{'f1_val': 0.9556897231160653, 'auprc': 0.9467902539588174, 'loss_val': 0.39196931836058985, 'psi': 0.9521299354531662}
[S5] START round=20 head_norm_before_train=1.617515 (no previous merge yet)
[S5] round=20 local utility u=0.659305 metrics={'f1_val': 0.7004803702628694, 'auprc': 0.9767512106291463, 'loss_val': 0.2634478148549653, 'psi': 0.8109887064093801}-{'f1_val': 0.5825908701554128, 'auprc': 0.8537816330013411, 'loss_val': 0.505811766786766, 'psi': 0.6910671752937841}
[S6] START round=20 head_norm_before_train=1.821739 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.8219155173061602, 'auprc': 0.9596577911431545, 'loss_val': 0.4005208453491889, 'psi': 0.8770124268409579}-{'f1_val': 0.8250681523100958, 'auprc': 0.9639454157749874, 'loss_val': 0.33820330096790474, 'psi': 0.8806190576960524}
[S7] START round=20 head_norm_before_train=1.281809 cos_to_last_merge=0.8540 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.854
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.6446789532444483, 'auprc': 0.8434550817986344, 'loss_val': 0.6255847861090748, 'psi': 0.7241894046661228}-{'f1_val': 0.6839945144732524, 'auprc': 0.9100026906775966, 'loss_val': 0.5682377227460681, 'psi': 0.7743977849549901}
[S8] START round=20 head_norm_before_train=2.007357 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.014425 metrics={'f1_val': 0.9935462653440466, 'auprc': 0.9982924233345578, 'loss_val': 0.0503411992909041, 'psi': 0.995444728540251}-{'f1_val': 0.9932673365348732, 'auprc': 0.995420266053494, 'loss_val': 0.06890156268661451, 'psi': 0.9941285083423215}
[S9] START round=20 head_norm_before_train=1.768809 (no previous merge yet)
[S9] round=20 local utility u=0.002331 metrics={'f1_val': 0.9947440946163844, 'auprc': 0.9984848548351264, 'loss_val': 0.046687389344636766, 'psi': 0.9962403987038813}-{'f1_val': 0.9955763922175147, 'auprc': 0.9984839749989058, 'loss_val': 0.056340381410615606, 'psi': 0.9967394253300712}
[S10] START round=20 head_norm_before_train=2.002854 (no previous merge yet)
[S10] round=20 local utility u=0.000119 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956575351159882, 'loss_val': 0.029845688257058547, 'psi': 0.995243925965441}-{'f1_val': 0.9951633020469546, 'auprc': 0.9956388481580507, 'loss_val': 0.031198185745434818, 'psi': 0.995353520491393}
[S11] START round=20 head_norm_before_train=1.091385 cos_to_last_merge=0.9984 (last merge round=18)
[S11] round=20 local utility u=0.099347 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9955474352867942, 'loss_val': 0.3603175587764317, 'psi': 0.8193410452682663}-{'f1_val': 0.7016282822309048, 'auprc': 0.9571975991157936, 'loss_val': 0.4425115524927775, 'psi': 0.8038560089848603}
[S13] START round=20 head_norm_before_train=1.239238 cos_to_last_merge=0.9893 (last merge round=17)
[S13] round=20 local utility u=0.044967 metrics={'f1_val': 0.629206566730246, 'auprc': 0.7326120691997471, 'loss_val': 0.660984691459177, 'psi': 0.6705687677180465}-{'f1_val': 0.6143426223799169, 'auprc': 0.7354852041695521, 'loss_val': 0.6703544069046803, 'psi': 0.662799655095771}
[S14] START round=20 head_norm_before_train=1.090998 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.005577 metrics={'f1_val': 0.9353176325876272, 'auprc': 0.9993454349714914, 'loss_val': 0.2604205212378531, 'psi': 0.9609287535411729}-{'f1_val': 0.9418904241010506, 'auprc': 0.9994393166626423, 'loss_val': 0.31129203552881163, 'psi': 0.9649099811256874}
[S15] START round=20 head_norm_before_train=0.958236 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.663778 metrics={'f1_val': 0.9912776168037007, 'auprc': 0.993867382053095, 'loss_val': 0.1945193654748308, 'psi': 0.9923135229034585}-{'f1_val': 0.7904418184553499, 'auprc': 0.9937124843159566, 'loss_val': 0.3165963917833765, 'psi': 0.8717500847995926}
[S16] START round=20 head_norm_before_train=0.955204 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.393966 metrics={'f1_val': 0.8530754709692737, 'auprc': 0.8196739704875056, 'loss_val': 0.6711351652256783, 'psi': 0.8397148707765665}-{'f1_val': 0.7523570547035666, 'auprc': 0.8025200226888723, 'loss_val': 0.8032955557713708, 'psi': 0.7724222418976889}
[S17] START round=20 head_norm_before_train=1.288786 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.090744 metrics={'f1_val': 0.6068299661725526, 'auprc': 0.8178533093570844, 'loss_val': 0.7551780473163119, 'psi': 0.6912393034463653}-{'f1_val': 0.5828743641449601, 'auprc': 0.7787898162751805, 'loss_val': 0.6757423841234375, 'psi': 0.6612405449970482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:45916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:45914
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:45915
[S16] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] cosine check vs S14: cos=0.9633
[S13] RECEIVED delta(kind=head bytes=1792) from S15
[S13] cosine check vs S15: cos=0.9126
[S8] RECEIVED delta(kind=head bytes=1796) from S10
[S8] cosine check vs S10: cos=0.9982
[S17] RECEIVED delta(kind=head bytes=1802) from S2
[S17] cosine check vs S2: cos=0.1388
[S17] RECEIVED delta(kind=head bytes=1795) from S3
[S17] cosine check vs S3: cos=0.3577
[S16] RECEIVED delta(kind=head bytes=1800) from S11
[S16] cosine check vs S11: cos=0.7589
[S14] RECEIVED delta(kind=head bytes=1806) from S4
[S14] cosine check vs S4: cos=0.9125
[S15] RECEIVED delta(kind=head bytes=1804) from S16
[S15] cosine check vs S16: cos=0.9141
[S2] RECEIVED delta(kind=head bytes=1799) from S13
[S2] cosine check vs S13: cos=0.9691
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] cosine check vs S9: cos=0.7383
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.1087
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=0.9974
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=0.3045
[S6] ⇄ pheromone p=0.293 → S17@127.0.0.1:45917
[S7] ⇄ pheromone p=0.233 → S4@127.0.0.1:45904
[S4] ⇄ pheromone p=0.149 → S14@127.0.0.1:45914
[S10] ⇄ pheromone p=0.048 → S8@127.0.0.1:45909
[S5] ⇄ pheromone p=0.278 → S16@127.0.0.1:45916
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.8531 head_norm=0.994456
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.900693e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.8439 head_norm=0.922476 delta_norm=0.190069
[S16] aggregate: ROLLBACK (f1_val pre=0.853 post=0.844 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.204 → S15@127.0.0.1:45915
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9353 head_norm=1.143517
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.976325e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9343 head_norm=1.018682 delta_norm=0.297633
[S14] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.151 → S11@127.0.0.1:45912
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.9913 head_norm=1.040256
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.120522e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.9911 head_norm=0.995274 delta_norm=0.212052
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.302 → S13@127.0.0.1:45913
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.7019 head_norm=1.134978
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.543787e-01
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.7019 head_norm=1.128748 delta_norm=0.154379
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.089 → S16@127.0.0.1:45916
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.9930 head_norm=2.013816
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.397829e-02
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.9959 head_norm=2.022260 delta_norm=0.073978
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.280 → S17@127.0.0.1:45917
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9935 head_norm=2.033363
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.136295e-02
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9932 head_norm=2.026792 delta_norm=0.061363
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.081 → S3@127.0.0.1:45903
[S9] ⇄ pheromone p=0.109 → S16@127.0.0.1:45916
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.7130 head_norm=1.299162
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.605513e-01
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.7098 head_norm=1.280556 delta_norm=0.160551
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.246 → S17@127.0.0.1:45917
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.6292 head_norm=1.281943
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.699027e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.6305 head_norm=1.135741 delta_norm=0.269903
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.087 → S2@127.0.0.1:45902
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.6068 head_norm=1.335307
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.176029e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.5803 head_norm=1.056509 delta_norm=0.717603
[S17] aggregate: ROLLBACK (f1_val pre=0.607 post=0.580 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.258 → S14@127.0.0.1:45914
[S2] START round=21 head_norm_before_train=1.280556 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.066117 metrics={'f1_val': 0.7295925902180808, 'auprc': 0.8222112827677602, 'loss_val': 0.39670262241153037, 'psi': 0.7666400672379525}-{'f1_val': 0.7130487514227536, 'auprc': 0.8099474518699609, 'loss_val': 0.39288308898127533, 'psi': 0.7518082316016366}
[S3] START round=21 head_norm_before_train=2.022260 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.8904830075789559, 'auprc': 0.9986648265292297, 'loss_val': 0.27378146653255325, 'psi': 0.9337557351590654}-{'f1_val': 0.9930103503032308, 'auprc': 0.9986996570159247, 'loss_val': 0.1823489900965844, 'psi': 0.9952860729883084}
[S4] START round=21 head_norm_before_train=1.373657 cos_to_last_merge=0.9984 (last merge round=19)
[S4] round=21 local utility u=0.019674 metrics={'f1_val': 0.9516693662338104, 'auprc': 0.9604336011558373, 'loss_val': 0.34001930726203244, 'psi': 0.9551750602026211}-{'f1_val': 0.9552857194776195, 'auprc': 0.9507878523147331, 'loss_val': 0.3721272638885803, 'psi': 0.9534865726124649}
[S5] START round=21 head_norm_before_train=1.631020 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.4229794901058022, 'auprc': 0.8350431504559276, 'loss_val': 1.0453126921696425, 'psi': 0.5878049542458523}-{'f1_val': 0.7004803702628694, 'auprc': 0.9767512106291463, 'loss_val': 0.2634478148549653, 'psi': 0.8109887064093801}
[S6] START round=21 head_norm_before_train=1.838835 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.8237157533809542, 'auprc': 0.9635240429165199, 'loss_val': 0.4555134173075433, 'psi': 0.8796390691951805}-{'f1_val': 0.8219155173061602, 'auprc': 0.9596577911431545, 'loss_val': 0.4005208453491889, 'psi': 0.8770124268409579}
[S7] START round=21 head_norm_before_train=1.299314 cos_to_last_merge=0.8500 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.850
[S7] round=21 local utility u=0.292408 metrics={'f1_val': 0.6846909657282441, 'auprc': 0.9099649432906615, 'loss_val': 0.480369510739005, 'psi': 0.774800556753211}-{'f1_val': 0.6446789532444483, 'auprc': 0.8434550817986344, 'loss_val': 0.6255847861090748, 'psi': 0.7241894046661228}
[S8] START round=21 head_norm_before_train=2.026792 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.002522 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9988348175415597, 'loss_val': 0.04912043930364805, 'psi': 0.995881291883632}-{'f1_val': 0.9935462653440466, 'auprc': 0.9982924233345578, 'loss_val': 0.0503411992909041, 'psi': 0.995444728540251}
[S9] START round=21 head_norm_before_train=1.795742 (no previous merge yet)
[S9] round=21 local utility u=0.006547 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9984845827179898, 'loss_val': 0.038585862802041404, 'psi': 0.9967396684177048}-{'f1_val': 0.9947440946163844, 'auprc': 0.9984848548351264, 'loss_val': 0.046687389344636766, 'psi': 0.9962403987038813}
[S10] START round=21 head_norm_before_train=2.022062 (no previous merge yet)
[S10] round=21 local utility u=0.000324 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956348154898489, 'loss_val': 0.029129068120826364, 'psi': 0.9952348381149853}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956575351159882, 'loss_val': 0.029845688257058547, 'psi': 0.995243925965441}
[S11] START round=21 head_norm_before_train=1.128748 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.012979 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9976608781400929, 'loss_val': 0.3406996722931674, 'psi': 0.8201864224095858}-{'f1_val': 0.7018701185892477, 'auprc': 0.9955474352867942, 'loss_val': 0.3603175587764317, 'psi': 0.8193410452682663}
[S13] START round=21 head_norm_before_train=1.135741 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5700295602244214, 'auprc': 0.7794670394213503, 'loss_val': 0.7299615645144211, 'psi': 0.653804551903193}-{'f1_val': 0.629206566730246, 'auprc': 0.7326120691997471, 'loss_val': 0.660984691459177, 'psi': 0.6705687677180465}
[S14] START round=21 head_norm_before_train=1.018682 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.029698 metrics={'f1_val': 0.9477523799228142, 'auprc': 0.9984932505729996, 'loss_val': 0.27307572185914925, 'psi': 0.9680487281828885}-{'f1_val': 0.9353176325876272, 'auprc': 0.9993454349714914, 'loss_val': 0.2604205212378531, 'psi': 0.9609287535411729}
[S15] START round=21 head_norm_before_train=0.995274 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.8009528513376426, 'auprc': 0.991596869521183, 'loss_val': 0.31501429231444955, 'psi': 0.8772104586110587}-{'f1_val': 0.9912776168037007, 'auprc': 0.993867382053095, 'loss_val': 0.1945193654748308, 'psi': 0.9923135229034585}
[S16] START round=21 head_norm_before_train=0.922476 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.7823118833074199, 'auprc': 0.8542688229628784, 'loss_val': 0.5943631345621324, 'psi': 0.8110946591696033}-{'f1_val': 0.8530754709692737, 'auprc': 0.8196739704875056, 'loss_val': 0.6711351652256783, 'psi': 0.8397148707765665}
[S17] START round=21 head_norm_before_train=1.056509 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.4377004576106321, 'auprc': 0.7114728288798969, 'loss_val': 0.7894668104271219, 'psi': 0.5472094061183381}-{'f1_val': 0.6068299661725526, 'auprc': 0.8178533093570844, 'loss_val': 0.7551780473163119, 'psi': 0.6912393034463653}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:45916
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:45903
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:45904
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:45916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1805) from S4
[S14] cosine check vs S4: cos=0.8526
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=0.9985
[S11] RECEIVED delta(kind=head bytes=1793) from S14
[S11] cosine check vs S14: cos=0.9534
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] cosine check vs S10: cos=0.9986
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] cosine check vs S2: cos=0.4155
[S16] RECEIVED delta(kind=head bytes=1800) from S11
[S16] cosine check vs S11: cos=0.6707
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.7438
[S4] RECEIVED delta(kind=head bytes=1802) from S7
[S4] cosine check vs S7: cos=0.9747
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.8905 head_norm=2.037183
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.707412e-02
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.9074 head_norm=2.043374 delta_norm=0.057074
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9478 head_norm=1.070438
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.798187e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9419 head_norm=1.202658 delta_norm=0.379819
[S14] aggregate: ROLLBACK (f1_val pre=0.948 post=0.942 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9517 head_norm=1.426695
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.640690e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9522 head_norm=1.361766 delta_norm=0.164069
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9939 head_norm=2.051134
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.415021e-02
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9939 head_norm=2.045401 delta_norm=0.054150
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.7019 head_norm=1.173752
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.786419e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.7019 head_norm=1.108987 delta_norm=0.178642
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.7823 head_norm=0.970191
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.460284e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8107 head_norm=1.048647 delta_norm=0.246028
[S16] aggregate: ACCEPT kept=['S11', 'S9'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.4377 head_norm=1.131192
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.732962e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.4060 head_norm=1.040473 delta_norm=0.673296
[S17] aggregate: ROLLBACK (f1_val pre=0.438 post=0.406 tol_abs=0.005 tol_rel=0.0)
[S2] START round=22 head_norm_before_train=1.338741 cos_to_last_merge=0.9983 (last merge round=20)
[S2] round=22 local utility u=0.152972 metrics={'f1_val': 0.7162479648371853, 'auprc': 0.9384519336695272, 'loss_val': 0.3594131208244245, 'psi': 0.8051295523701221}-{'f1_val': 0.7295925902180808, 'auprc': 0.8222112827677602, 'loss_val': 0.39670262241153037, 'psi': 0.7666400672379525}
[S3] START round=22 head_norm_before_train=2.043374 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.388861 metrics={'f1_val': 0.9964167372369186, 'auprc': 0.9999021655303517, 'loss_val': 0.1353732793303281, 'psi': 0.9978109085542919}-{'f1_val': 0.8904830075789559, 'auprc': 0.9986648265292297, 'loss_val': 0.27378146653255325, 'psi': 0.9337557351590654}
[S4] START round=22 head_norm_before_train=1.361766 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9490354024176914, 'auprc': 0.9571038010245835, 'loss_val': 0.339239474851103, 'psi': 0.9522627618604482}-{'f1_val': 0.9516693662338104, 'auprc': 0.9604336011558373, 'loss_val': 0.34001930726203244, 'psi': 0.9551750602026211}
[S5] START round=22 head_norm_before_train=1.642889 (no previous merge yet)
[S5] round=22 local utility u=1.000000 metrics={'f1_val': 0.847726901365117, 'auprc': 0.9939526423920102, 'loss_val': 0.20874224027001137, 'psi': 0.9062171977758743}-{'f1_val': 0.4229794901058022, 'auprc': 0.8350431504559276, 'loss_val': 1.0453126921696425, 'psi': 0.5878049542458523}
[S6] START round=22 head_norm_before_train=1.856708 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.8239909059331888, 'auprc': 0.9599716475886358, 'loss_val': 0.4631157863376457, 'psi': 0.8783832025953676}-{'f1_val': 0.8237157533809542, 'auprc': 0.9635240429165199, 'loss_val': 0.4555134173075433, 'psi': 0.8796390691951805}
[S7] START round=22 head_norm_before_train=1.314228 cos_to_last_merge=0.8460 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.846
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.3863251839702891, 'auprc': 0.7842692614119872, 'loss_val': 1.0187880125116795, 'psi': 0.5455028149469683}-{'f1_val': 0.6846909657282441, 'auprc': 0.9099649432906615, 'loss_val': 0.480369510739005, 'psi': 0.774800556753211}
[S8] START round=22 head_norm_before_train=2.045401 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.776919206940455, 'auprc': 0.9867957355780779, 'loss_val': 0.18623089205947063, 'psi': 0.8608698183955041}-{'f1_val': 0.9939122747783468, 'auprc': 0.9988348175415597, 'loss_val': 0.04912043930364805, 'psi': 0.995881291883632}
[S9] START round=22 head_norm_before_train=1.821672 (no previous merge yet)
[S9] round=22 local utility u=0.001286 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9960942496307817, 'loss_val': 0.03384519839436301, 'psi': 0.9962838112526452}-{'f1_val': 0.9955763922175147, 'auprc': 0.9984845827179898, 'loss_val': 0.038585862802041404, 'psi': 0.9967396684177048}
[S10] START round=22 head_norm_before_train=2.041088 (no previous merge yet)
[S10] round=22 local utility u=0.000421 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956903011963053, 'loss_val': 0.028454059489619064, 'psi': 0.9952570323975678}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956348154898489, 'loss_val': 0.029129068120826364, 'psi': 0.9952348381149853}
[S11] START round=22 head_norm_before_train=1.108987 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.008845 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9973047760657059, 'loss_val': 0.3223319160255246, 'psi': 0.8200831004052744}-{'f1_val': 0.7018701185892477, 'auprc': 0.9976608781400929, 'loss_val': 0.3406996722931674, 'psi': 0.8201864224095858}
[S13] START round=22 head_norm_before_train=1.170141 cos_to_last_merge=0.9993 (last merge round=20)
[S13] round=22 local utility u=0.321610 metrics={'f1_val': 0.6504113623115645, 'auprc': 0.7799843923942736, 'loss_val': 0.5705835492988046, 'psi': 0.7022405743446481}-{'f1_val': 0.5700295602244214, 'auprc': 0.7794670394213503, 'loss_val': 0.7299615645144211, 'psi': 0.653804551903193}
[S14] START round=22 head_norm_before_train=1.202658 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.052836 metrics={'f1_val': 0.956149735191273, 'auprc': 0.996790096411461, 'loss_val': 0.21267773835185472, 'psi': 0.9724058796793482}-{'f1_val': 0.9477523799228142, 'auprc': 0.9984932505729996, 'loss_val': 0.27307572185914925, 'psi': 0.9680487281828885}
[S15] START round=22 head_norm_before_train=1.080473 cos_to_last_merge=0.9965 (last merge round=20)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7658336931099052, 'auprc': 0.9916219822682668, 'loss_val': 0.37967449521786784, 'psi': 0.85614900877325}-{'f1_val': 0.8009528513376426, 'auprc': 0.991596869521183, 'loss_val': 0.31501429231444955, 'psi': 0.8772104586110587}
[S16] START round=22 head_norm_before_train=1.048647 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.236608 metrics={'f1_val': 0.8422856356911496, 'auprc': 0.8755058839656281, 'loss_val': 0.5446998716742781, 'psi': 0.855573735000941}-{'f1_val': 0.7823118833074199, 'auprc': 0.8542688229628784, 'loss_val': 0.5943631345621324, 'psi': 0.8110946591696033}
[S17] START round=22 head_norm_before_train=1.040473 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.42495512673300206, 'auprc': 0.6852206475098785, 'loss_val': 0.8346189435047149, 'psi': 0.5290613350437527}-{'f1_val': 0.4377004576106321, 'auprc': 0.7114728288798969, 'loss_val': 0.7894668104271219, 'psi': 0.5472094061183381}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:45902
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:45916
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:45917
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:45915
[S16] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] cosine check vs S11: cos=0.6514
[S17] RECEIVED delta(kind=head bytes=1802) from S2
[S17] cosine check vs S2: cos=0.8455
[S11] RECEIVED delta(kind=head bytes=1805) from S14
[S11] cosine check vs S14: cos=0.9564
[S16] RECEIVED delta(kind=head bytes=1800) from S9
[S16] cosine check vs S9: cos=0.8290
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.1304
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] cosine check vs S3: cos=0.4240
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] cosine check vs S16: cos=0.9306
[S2] RECEIVED delta(kind=head bytes=1803) from S13
[S2] cosine check vs S13: cos=0.9698
[S8] RECEIVED delta(kind=head bytes=1796) from S10
[S8] cosine check vs S10: cos=0.9990
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.7769 head_norm=2.066288
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.719605e-02
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.7897 head_norm=2.062245 delta_norm=0.047196
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.7162 head_norm=1.398327
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.846135e-01
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.7116 head_norm=1.296690 delta_norm=0.184614
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.7019 head_norm=1.152433
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.835930e-01
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.7019 head_norm=1.187779 delta_norm=0.183593
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.8423 head_norm=1.089692
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.055802e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.9069 head_norm=0.978435 delta_norm=0.205580
[S16] aggregate: ACCEPT kept=['S11', 'S9', 'S5'] (k=3/3) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.7658 head_norm=1.168776
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.139501e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.7677 head_norm=1.109486 delta_norm=0.213950
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.4250 head_norm=1.107151
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.748148e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.4666 head_norm=1.130751 delta_norm=0.374815
[S17] aggregate: ACCEPT kept=['S2', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.296690 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.044462 metrics={'f1_val': 0.7091242645923215, 'auprc': 0.9859743054512468, 'loss_val': 0.37031462131696136, 'psi': 0.8198642809358916}-{'f1_val': 0.7162479648371853, 'auprc': 0.9384519336695272, 'loss_val': 0.3594131208244245, 'psi': 0.8051295523701221}
[S3] START round=23 head_norm_before_train=2.060278 cos_to_last_merge=0.9999 (last merge round=21)
[S3] round=23 local utility u=0.027691 metrics={'f1_val': 0.9975573226023611, 'auprc': 0.9996448083009706, 'loss_val': 0.08606297110487415, 'psi': 0.9983923168818049}-{'f1_val': 0.9964167372369186, 'auprc': 0.9999021655303517, 'loss_val': 0.1353732793303281, 'psi': 0.9978109085542919}
[S4] START round=23 head_norm_before_train=1.409651 cos_to_last_merge=0.9984 (last merge round=21)
[S4] round=23 local utility u=0.039005 metrics={'f1_val': 0.9513001745126215, 'auprc': 0.9613227993953729, 'loss_val': 0.28747414902203877, 'psi': 0.9553092244657221}-{'f1_val': 0.9490354024176914, 'auprc': 0.9571038010245835, 'loss_val': 0.339239474851103, 'psi': 0.9522627618604482}
[S5] START round=23 head_norm_before_train=1.652435 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.6202317020128277, 'auprc': 0.8539213215011561, 'loss_val': 0.43789425976330865, 'psi': 0.7137075498081591}-{'f1_val': 0.847726901365117, 'auprc': 0.9939526423920102, 'loss_val': 0.20874224027001137, 'psi': 0.9062171977758743}
[S6] START round=23 head_norm_before_train=1.873370 (no previous merge yet)
[S6] round=23 local utility u=0.105919 metrics={'f1_val': 0.8310304196838332, 'auprc': 0.9638278353659349, 'loss_val': 0.3050829275134415, 'psi': 0.8841493859566738}-{'f1_val': 0.8239909059331888, 'auprc': 0.9599716475886358, 'loss_val': 0.4631157863376457, 'psi': 0.8783832025953676}
[S7] START round=23 head_norm_before_train=1.329422 cos_to_last_merge=0.8421 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.842
[S7] round=23 local utility u=1.000000 metrics={'f1_val': 0.6845168556306344, 'auprc': 0.9068368362073044, 'loss_val': 0.43316995383444784, 'psi': 0.7734448478613023}-{'f1_val': 0.3863251839702891, 'auprc': 0.7842692614119872, 'loss_val': 1.0187880125116795, 'psi': 0.5455028149469683}
[S8] START round=23 head_norm_before_train=2.062245 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.738739 metrics={'f1_val': 0.9936910743895857, 'auprc': 0.9990323587091033, 'loss_val': 0.04609342385919931, 'psi': 0.9958275881173928}-{'f1_val': 0.776919206940455, 'auprc': 0.9867957355780779, 'loss_val': 0.18623089205947063, 'psi': 0.8608698183955041}
[S9] START round=23 head_norm_before_train=1.845940 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9983759694612557, 'loss_val': 0.03361091804437449, 'psi': 0.9954454970903248}-{'f1_val': 0.9964101856672208, 'auprc': 0.9960942496307817, 'loss_val': 0.03384519839436301, 'psi': 0.9962838112526452}
[S10] START round=23 head_norm_before_train=2.059276 (no previous merge yet)
[S10] round=23 local utility u=0.000829 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9957658310602155, 'loss_val': 0.028194245606520833, 'psi': 0.995404313652259}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956903011963053, 'loss_val': 0.028454059489619064, 'psi': 0.9952570323975678}
[S11] START round=23 head_norm_before_train=1.187779 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.021479 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9972485716671877, 'loss_val': 0.2792049783348994, 'psi': 0.8200606186458672}-{'f1_val': 0.7019353166316534, 'auprc': 0.9973047760657059, 'loss_val': 0.3223319160255246, 'psi': 0.8200831004052744}
[S13] START round=23 head_norm_before_train=1.214766 cos_to_last_merge=0.9970 (last merge round=20)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5982328178567498, 'auprc': 0.7868531301282815, 'loss_val': 0.8594452699987704, 'psi': 0.6736809427653625}-{'f1_val': 0.6504113623115645, 'auprc': 0.7799843923942736, 'loss_val': 0.5705835492988046, 'psi': 0.7022405743446481}
[S14] START round=23 head_norm_before_train=1.249380 cos_to_last_merge=0.9982 (last merge round=21)
[S14] round=23 local utility u=0.158542 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9981888200312066, 'loss_val': 0.1498095117020188, 'psi': 0.9979672387928137}-{'f1_val': 0.956149735191273, 'auprc': 0.996790096411461, 'loss_val': 0.21267773835185472, 'psi': 0.9724058796793482}
[S15] START round=23 head_norm_before_train=1.109486 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.747406 metrics={'f1_val': 0.973605765680045, 'auprc': 0.9955778702662705, 'loss_val': 0.1433616705525413, 'psi': 0.9823946075145351}-{'f1_val': 0.7658336931099052, 'auprc': 0.9916219822682668, 'loss_val': 0.37967449521786784, 'psi': 0.85614900877325}
[S16] START round=23 head_norm_before_train=0.978435 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.187691 metrics={'f1_val': 0.8896877006594237, 'auprc': 0.8950504475608343, 'loss_val': 0.5123647995759546, 'psi': 0.8918327994199879}-{'f1_val': 0.8422856356911496, 'auprc': 0.8755058839656281, 'loss_val': 0.5446998716742781, 'psi': 0.855573735000941}
[S17] START round=23 head_norm_before_train=1.130751 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.512999 metrics={'f1_val': 0.5809266149730461, 'auprc': 0.700730065867447, 'loss_val': 0.7909786394238828, 'psi': 0.6288479953308064}-{'f1_val': 0.42495512673300206, 'auprc': 0.6852206475098785, 'loss_val': 0.8346189435047149, 'psi': 0.5290613350437527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:45911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:45908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:45905
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S2
[S13] cosine check vs S2: cos=0.9831
[S7] RECEIVED delta(kind=head bytes=1803) from S4
[S7] cosine check vs S4: cos=0.9745
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] cosine check vs S11: cos=0.9850
[S5] RECEIVED delta(kind=head bytes=1796) from S16
[S5] cosine check vs S16: cos=0.2878
[S10] RECEIVED delta(kind=head bytes=1798) from S8
[S10] cosine check vs S8: cos=0.9991
[S8] RECEIVED delta(kind=head bytes=1794) from S3
[S8] cosine check vs S3: cos=0.9981
[S17] RECEIVED delta(kind=head bytes=1801) from S14
[S17] cosine check vs S14: cos=0.4840
[S16] RECEIVED delta(kind=head bytes=1796) from S15
[S16] cosine check vs S15: cos=0.9666
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:45907
[S17] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S17
[S6] cosine check vs S17: cos=0.1384
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.8310 head_norm=1.888845
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.043969e+00
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.8355 head_norm=1.183446 delta_norm=1.043969
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.6202 head_norm=1.660142
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.405402e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.6494 head_norm=1.093513 delta_norm=0.840540
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.6845 head_norm=1.338852
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.695793e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.6840 head_norm=1.391431 delta_norm=0.169579
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.5982 head_norm=1.248350
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.335018e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.5945 head_norm=1.301083 delta_norm=0.133502
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9952 head_norm=2.073695
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.310851e-02
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9952 head_norm=2.077697 delta_norm=0.043109
[S10] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9978 head_norm=1.295281
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.137225e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9974 head_norm=1.258933 delta_norm=0.113722
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9937 head_norm=2.082584
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.492496e-02
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9937 head_norm=2.079422 delta_norm=0.064925
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.8897 head_norm=1.023955
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.633382e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.8880 head_norm=1.094959 delta_norm=0.163338
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.5809 head_norm=1.188738
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.325315e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.6358 head_norm=1.070200 delta_norm=0.632532
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.364882 cos_to_last_merge=0.9981 (last merge round=22)
[S2] round=24 local utility u=0.000693 metrics={'f1_val': 0.7089432655585265, 'auprc': 0.9865207352809976, 'loss_val': 0.36948163918553123, 'psi': 0.819974253447515}-{'f1_val': 0.7091242645923215, 'auprc': 0.9859743054512468, 'loss_val': 0.37031462131696136, 'psi': 0.8198642809358916}
[S3] START round=24 head_norm_before_train=2.078285 cos_to_last_merge=0.9996 (last merge round=21)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9600800976779673, 'auprc': 0.9986607855888379, 'loss_val': 0.12900883806707497, 'psi': 0.9755123728423155}-{'f1_val': 0.9975573226023611, 'auprc': 0.9996448083009706, 'loss_val': 0.08606297110487415, 'psi': 0.9983923168818049}
[S4] START round=24 head_norm_before_train=1.461900 cos_to_last_merge=0.9942 (last merge round=21)
[S4] round=24 local utility u=0.006763 metrics={'f1_val': 0.9543608729502719, 'auprc': 0.9540169837695638, 'loss_val': 0.2703954205474724, 'psi': 0.9542233172779887}-{'f1_val': 0.9513001745126215, 'auprc': 0.9613227993953729, 'loss_val': 0.28747414902203877, 'psi': 0.9553092244657221}
[S5] START round=24 head_norm_before_train=1.093513 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.393654 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9415147836496368, 'loss_val': 0.395625887645816, 'psi': 0.7969709490574592}-{'f1_val': 0.6202317020128277, 'auprc': 0.8539213215011561, 'loss_val': 0.43789425976330865, 'psi': 0.7137075498081591}
[S6] START round=24 head_norm_before_train=1.183446 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.062696 metrics={'f1_val': 0.8590304348363058, 'auprc': 0.9626084333602279, 'loss_val': 0.3440320673153485, 'psi': 0.9004616342458747}-{'f1_val': 0.8310304196838332, 'auprc': 0.9638278353659349, 'loss_val': 0.3050829275134415, 'psi': 0.8841493859566738}
[S7] START round=24 head_norm_before_train=1.391431 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5527457753164684, 'auprc': 0.7874739673336622, 'loss_val': 0.743145680083174, 'psi': 0.646637052123346}-{'f1_val': 0.6845168556306344, 'auprc': 0.9068368362073044, 'loss_val': 0.43316995383444784, 'psi': 0.7734448478613023}
[S8] START round=24 head_norm_before_train=2.079422 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.000153 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9992585116649171, 'loss_val': 0.039547380061592606, 'psi': 0.995226239415268}-{'f1_val': 0.9936910743895857, 'auprc': 0.9990323587091033, 'loss_val': 0.04609342385919931, 'psi': 0.9958275881173928}
[S9] START round=24 head_norm_before_train=1.866820 (no previous merge yet)
[S9] round=24 local utility u=0.007609 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9960902197760755, 'loss_val': 0.02904655021201066, 'psi': 0.9962821993107627}-{'f1_val': 0.9934918488430377, 'auprc': 0.9983759694612557, 'loss_val': 0.03361091804437449, 'psi': 0.9954454970903248}
[S10] START round=24 head_norm_before_train=2.077697 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9957027285052831, 'loss_val': 0.027694521387382338, 'psi': 0.995262003321159}-{'f1_val': 0.9951633020469546, 'auprc': 0.9957658310602155, 'loss_val': 0.028194245606520833, 'psi': 0.995404313652259}
[S11] START round=24 head_norm_before_train=1.232045 cos_to_last_merge=0.9982 (last merge round=22)
[S11] round=24 local utility u=0.784106 metrics={'f1_val': 0.9579542338102968, 'auprc': 0.994031970591174, 'loss_val': 0.2374561729189155, 'psi': 0.9723853285226477}-{'f1_val': 0.7019353166316534, 'auprc': 0.9972485716671877, 'loss_val': 0.2792049783348994, 'psi': 0.8200606186458672}
[S13] START round=24 head_norm_before_train=1.301083 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.123360 metrics={'f1_val': 0.6260748172467415, 'auprc': 0.7816612986672162, 'loss_val': 0.7642026023729909, 'psi': 0.6883094098149314}-{'f1_val': 0.5982328178567498, 'auprc': 0.7868531301282815, 'loss_val': 0.8594452699987704, 'psi': 0.6736809427653625}
[S14] START round=24 head_norm_before_train=1.258933 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.011158 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9976709268492604, 'loss_val': 0.12201453924137147, 'psi': 0.9973675465383594}-{'f1_val': 0.9978195179672185, 'auprc': 0.9981888200312066, 'loss_val': 0.1498095117020188, 'psi': 0.9979672387928137}
[S15] START round=24 head_norm_before_train=1.184375 cos_to_last_merge=0.9981 (last merge round=22)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7009180804352899, 'auprc': 0.9892397009805574, 'loss_val': 0.423629260804762, 'psi': 0.816246728653397}-{'f1_val': 0.973605765680045, 'auprc': 0.9955778702662705, 'loss_val': 0.1433616705525413, 'psi': 0.9823946075145351}
[S16] START round=24 head_norm_before_train=1.094959 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8300965996664371, 'auprc': 0.9579549279728528, 'loss_val': 0.4151120200688702, 'psi': 0.8812399309890033}-{'f1_val': 0.8896877006594237, 'auprc': 0.8950504475608343, 'loss_val': 0.5123647995759546, 'psi': 0.8918327994199879}
[S17] START round=24 head_norm_before_train=1.070200 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.147878 metrics={'f1_val': 0.5795732540757419, 'auprc': 0.7821519416659293, 'loss_val': 0.7313678136055823, 'psi': 0.6606047291118169}-{'f1_val': 0.5809266149730461, 'auprc': 0.700730065867447, 'loss_val': 0.7909786394238828, 'psi': 0.6288479953308064}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:45911
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:45908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] sending update (kind=head size=1790 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:45913
[S4] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S14
[S17] cosine check vs S14: cos=0.8773
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] cosine check vs S2: cos=0.9913
[S7] RECEIVED delta(kind=head bytes=1801) from S4
[S7] cosine check vs S4: cos=0.9896
[S14] RECEIVED delta(kind=head bytes=1794) from S11
[S14] cosine check vs S11: cos=0.9909
[S10] RECEIVED delta(kind=head bytes=1797) from S8
[S10] cosine check vs S8: cos=0.9981
[S15] RECEIVED delta(kind=head bytes=1799) from S13
[S15] cosine check vs S13: cos=0.9015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:45907
[S17] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S17
[S6] cosine check vs S17: cos=0.5136
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.5527 head_norm=1.397435
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.173532e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.5471 head_norm=1.446893 delta_norm=0.117353
[S7] aggregate: ROLLBACK (f1_val pre=0.553 post=0.547 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=24 metric=0.8590 head_norm=1.249846
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.900083e-01
[S6] stored merged vector for next round verification (round=24)
[S6] DEBUG after merge:  round=24 metric=0.9010 head_norm=1.037359 delta_norm=0.590008
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=24 metric=0.9950 head_norm=2.089083
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.458038e-02
[S10] stored merged vector for next round verification (round=24)
[S10] DEBUG after merge:  round=24 metric=0.9950 head_norm=2.092324 delta_norm=0.064580
[S10] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.7009 head_norm=1.256627
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.892659e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.7009 head_norm=1.261325 delta_norm=0.289266
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9972 head_norm=1.302433
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.799694e-02
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9972 head_norm=1.288862 delta_norm=0.087997
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.6261 head_norm=1.330459
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.017130e-01
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.6235 head_norm=1.373231 delta_norm=0.101713
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.5796 head_norm=1.134166
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.125530e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.6444 head_norm=1.180526 delta_norm=0.312553
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.422005 cos_to_last_merge=0.9946 (last merge round=22)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.7190815292065605, 'auprc': 0.7989132630195793, 'loss_val': 0.38765784039418205, 'psi': 0.7510142227317681}-{'f1_val': 0.7089432655585265, 'auprc': 0.9865207352809976, 'loss_val': 0.36948163918553123, 'psi': 0.819974253447515}
[S3] START round=25 head_norm_before_train=2.095591 cos_to_last_merge=0.9991 (last merge round=21)
[S3] round=25 local utility u=0.050058 metrics={'f1_val': 0.9719480567116058, 'auprc': 0.9974159344978414, 'loss_val': 0.09636521197311142, 'psi': 0.9821352078261}-{'f1_val': 0.9600800976779673, 'auprc': 0.9986607855888379, 'loss_val': 0.12900883806707497, 'psi': 0.9755123728423155}
[S4] START round=25 head_norm_before_train=1.503901 cos_to_last_merge=0.9899 (last merge round=21)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9420310797389347, 'auprc': 0.9389015074673048, 'loss_val': 0.28273855224465844, 'psi': 0.9407792508302828}-{'f1_val': 0.9543608729502719, 'auprc': 0.9540169837695638, 'loss_val': 0.2703954205474724, 'psi': 0.9542233172779887}
[S5] START round=25 head_norm_before_train=1.119044 cos_to_last_merge=0.9995 (last merge round=23)
[S5] round=25 local utility u=0.093368 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9834612506631883, 'loss_val': 0.3347331496299157, 'psi': 0.8137499566687438}-{'f1_val': 0.7006083926626743, 'auprc': 0.9415147836496368, 'loss_val': 0.395625887645816, 'psi': 0.7969709490574592}
[S6] START round=25 head_norm_before_train=1.037359 cos_to_last_merge=1.0000 (last merge round=24)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.6939132343247164, 'auprc': 0.7399220119743647, 'loss_val': 0.6934229549090644, 'psi': 0.7123167453845758}-{'f1_val': 0.8590304348363058, 'auprc': 0.9626084333602279, 'loss_val': 0.3440320673153485, 'psi': 0.9004616342458747}
[S7] START round=25 head_norm_before_train=1.446893 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.606188 metrics={'f1_val': 0.68385735218053, 'auprc': 0.8426354198370352, 'loss_val': 0.482922512235428, 'psi': 0.747368579243132}-{'f1_val': 0.5527457753164684, 'auprc': 0.7874739673336622, 'loss_val': 0.743145680083174, 'psi': 0.646637052123346}
[S8] START round=25 head_norm_before_train=2.097549 cos_to_last_merge=0.9999 (last merge round=23)
[S8] round=25 local utility u=0.005403 metrics={'f1_val': 0.9936910743895857, 'auprc': 0.9992991978399853, 'loss_val': 0.03578201216087349, 'psi': 0.9959343237697456}-{'f1_val': 0.9925380579155019, 'auprc': 0.9992585116649171, 'loss_val': 0.039547380061592606, 'psi': 0.995226239415268}
[S9] START round=25 head_norm_before_train=1.884266 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9918149940667227, 'auprc': 0.9984867464565098, 'loss_val': 0.03283120753627669, 'psi': 0.9944836950226374}-{'f1_val': 0.9964101856672208, 'auprc': 0.9960902197760755, 'loss_val': 0.02904655021201066, 'psi': 0.9962821993107627}
[S10] START round=25 head_norm_before_train=2.092324 cos_to_last_merge=1.0000 (last merge round=24)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.995709199980777, 'loss_val': 0.02764378861562492, 'psi': 0.9951328455239343}-{'f1_val': 0.9949681865317428, 'auprc': 0.9957027285052831, 'loss_val': 0.027694521387382338, 'psi': 0.995262003321159}
[S11] START round=25 head_norm_before_train=1.281204 cos_to_last_merge=0.9938 (last merge round=22)
[S11] round=25 local utility u=0.033160 metrics={'f1_val': 0.9584266227902574, 'auprc': 0.994853643599807, 'loss_val': 0.17643462404487756, 'psi': 0.9729974311140772}-{'f1_val': 0.9579542338102968, 'auprc': 0.994031970591174, 'loss_val': 0.2374561729189155, 'psi': 0.9723853285226477}
[S13] START round=25 head_norm_before_train=1.373231 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.245333 metrics={'f1_val': 0.6894562119745562, 'auprc': 0.7460040632744241, 'loss_val': 0.5468541537566299, 'psi': 0.7120753524945034}-{'f1_val': 0.6260748172467415, 'auprc': 0.7816612986672162, 'loss_val': 0.7642026023729909, 'psi': 0.6883094098149314}
[S14] START round=25 head_norm_before_train=1.288862 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.004984 metrics={'f1_val': 0.9973833833620065, 'auprc': 0.9971031957195293, 'loss_val': 0.11165111391507618, 'psi': 0.9972713083050155}-{'f1_val': 0.9971652929977585, 'auprc': 0.9976709268492604, 'loss_val': 0.12201453924137147, 'psi': 0.9973675465383594}
[S15] START round=25 head_norm_before_train=1.261325 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=1.000000 metrics={'f1_val': 0.9853111009650785, 'auprc': 0.9977823465662581, 'loss_val': 0.10617834682345043, 'psi': 0.9902995992055503}-{'f1_val': 0.7009180804352899, 'auprc': 0.9892397009805574, 'loss_val': 0.423629260804762, 'psi': 0.816246728653397}
[S16] START round=25 head_norm_before_train=1.141759 cos_to_last_merge=0.9985 (last merge round=23)
[S16] round=25 local utility u=0.061768 metrics={'f1_val': 0.8581309999100531, 'auprc': 0.9646596355011646, 'loss_val': 0.47989740059164504, 'psi': 0.9007424541464978}-{'f1_val': 0.8300965996664371, 'auprc': 0.9579549279728528, 'loss_val': 0.4151120200688702, 'psi': 0.8812399309890033}
[S17] START round=25 head_norm_before_train=1.180526 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.171185 metrics={'f1_val': 0.5932441576632334, 'auprc': 0.8603471786261965, 'loss_val': 0.7056086680570541, 'psi': 0.7000853660484185}-{'f1_val': 0.5795732540757419, 'auprc': 0.7821519416659293, 'loss_val': 0.7313678136055823, 'psi': 0.6606047291118169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:45915
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:45911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:45916
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:45905
[S16] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S16
[S5] cosine check vs S16: cos=0.6288
[S10] RECEIVED delta(kind=head bytes=1796) from S8
[S10] cosine check vs S8: cos=0.9990
[S8] RECEIVED delta(kind=head bytes=1800) from S3
[S8] cosine check vs S3: cos=0.9987
[S17] RECEIVED delta(kind=head bytes=1803) from S14
[S17] cosine check vs S14: cos=0.9609
[S16] RECEIVED delta(kind=head bytes=1791) from S15
[S16] cosine check vs S15: cos=0.9430
[S15] RECEIVED delta(kind=head bytes=1797) from S13
[S15] cosine check vs S13: cos=0.9708
[S14] RECEIVED delta(kind=head bytes=1804) from S11
[S14] cosine check vs S11: cos=0.9936
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:45907
[S17] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S17
[S6] cosine check vs S17: cos=0.7272
[S4] ⇄ pheromone p=0.056 → S7@127.0.0.1:45908
[S2] ⇄ pheromone p=0.108 → S13@127.0.0.1:45913
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.7006 head_norm=1.146316
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.020227e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.7006 head_norm=1.051113 delta_norm=0.502023
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9947 head_norm=2.104270
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.674617e-02
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9947 head_norm=2.108674 delta_norm=0.046746
[S10] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.6939 head_norm=1.159912
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.443514e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.7126 head_norm=1.114516 delta_norm=0.444351
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.9853 head_norm=1.315082
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.693129e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.9857 head_norm=1.347345 delta_norm=0.169313
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.395 → S16@127.0.0.1:45916
[S11] ⇄ pheromone p=0.166 → S14@127.0.0.1:45914
[S3] ⇄ pheromone p=0.145 → S8@127.0.0.1:45909
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9974 head_norm=1.326098
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.506160e-02
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9970 head_norm=1.325368 delta_norm=0.075062
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.080 → S17@127.0.0.1:45917
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.8581 head_norm=1.183086
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.206900e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.8563 head_norm=1.231203 delta_norm=0.220690
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.127 → S5@127.0.0.1:45905
[S13] ⇄ pheromone p=0.130 → S15@127.0.0.1:45915
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9937 head_norm=2.114102
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.365568e-02
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9937 head_norm=2.112980 delta_norm=0.053656
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.122 → S10@127.0.0.1:45911
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.5932 head_norm=1.238463
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.843920e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.6562 head_norm=1.269710 delta_norm=0.184392
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.208 → S6@127.0.0.1:45907
[S2] START round=26 head_norm_before_train=1.466590 cos_to_last_merge=0.9915 (last merge round=22)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.7396619895484955, 'auprc': 0.774889789597561, 'loss_val': 0.567120196153941, 'psi': 0.7537531095681217}-{'f1_val': 0.7190815292065605, 'auprc': 0.7989132630195793, 'loss_val': 0.38765784039418205, 'psi': 0.7510142227317681}
[S3] START round=26 head_norm_before_train=2.113219 cos_to_last_merge=0.9985 (last merge round=21)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.7947048074960034, 'auprc': 0.9973546735763592, 'loss_val': 0.4079337433694574, 'psi': 0.8757647539281457}-{'f1_val': 0.9719480567116058, 'auprc': 0.9974159344978414, 'loss_val': 0.09636521197311142, 'psi': 0.9821352078261}
[S4] START round=26 head_norm_before_train=1.534088 cos_to_last_merge=0.9865 (last merge round=21)
[S4] round=26 local utility u=0.014803 metrics={'f1_val': 0.9478537766080691, 'auprc': 0.9352675090415031, 'loss_val': 0.27716615113391085, 'psi': 0.9428192695814428}-{'f1_val': 0.9420310797389347, 'auprc': 0.9389015074673048, 'loss_val': 0.28273855224465844, 'psi': 0.9407792508302828}
[S5] START round=26 head_norm_before_train=1.051113 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.5790769451354295, 'auprc': 0.8536563217706139, 'loss_val': 0.6370687962511621, 'psi': 0.6889086957895032}-{'f1_val': 0.7006090940057808, 'auprc': 0.9834612506631883, 'loss_val': 0.3347331496299157, 'psi': 0.8137499566687438}
[S6] START round=26 head_norm_before_train=1.114516 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.063561 metrics={'f1_val': 0.7094448874527716, 'auprc': 0.7524927037606803, 'loss_val': 0.6972030107320134, 'psi': 0.726664013975935}-{'f1_val': 0.6939132343247164, 'auprc': 0.7399220119743647, 'loss_val': 0.6934229549090644, 'psi': 0.7123167453845758}
[S7] START round=26 head_norm_before_train=1.453848 cos_to_last_merge=0.9999 (last merge round=24)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.659810890211946, 'auprc': 0.8281785498442434, 'loss_val': 0.5143951681026977, 'psi': 0.7271579540648649}-{'f1_val': 0.68385735218053, 'auprc': 0.8426354198370352, 'loss_val': 0.482922512235428, 'psi': 0.747368579243132}
[S8] START round=26 head_norm_before_train=2.112980 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9981087314558679, 'loss_val': 0.03848335875381893, 'psi': 0.9958107969337652}-{'f1_val': 0.9936910743895857, 'auprc': 0.9992991978399853, 'loss_val': 0.03578201216087349, 'psi': 0.9959343237697456}
[S9] START round=26 head_norm_before_train=1.898587 (no previous merge yet)
[S9] round=26 local utility u=0.014290 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.9965441619340956, 'loss_val': 0.026166294114101363, 'psi': 0.99648095750041}-{'f1_val': 0.9918149940667227, 'auprc': 0.9984867464565098, 'loss_val': 0.03283120753627669, 'psi': 0.9944836950226374}
[S10] START round=26 head_norm_before_train=2.108674 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.000118 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9956707325893521, 'loss_val': 0.02729148219052828, 'psi': 0.9951174585673643}-{'f1_val': 0.9947486092193725, 'auprc': 0.995709199980777, 'loss_val': 0.02764378861562492, 'psi': 0.9951328455239343}
[S11] START round=26 head_norm_before_train=1.328884 cos_to_last_merge=0.9884 (last merge round=22)
[S11] round=26 local utility u=0.057313 metrics={'f1_val': 0.9727473851450108, 'auprc': 0.9947036917597023, 'loss_val': 0.14728272547908955, 'psi': 0.9815299077908874}-{'f1_val': 0.9584266227902574, 'auprc': 0.994853643599807, 'loss_val': 0.17643462404487756, 'psi': 0.9729974311140772}
[S13] START round=26 head_norm_before_train=1.399489 cos_to_last_merge=0.9998 (last merge round=24)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6775587955284887, 'auprc': 0.8116070985594166, 'loss_val': 0.7832050780375855, 'psi': 0.7311781167408599}-{'f1_val': 0.6894562119745562, 'auprc': 0.7460040632744241, 'loss_val': 0.5468541537566299, 'psi': 0.7120753524945034}
[S14] START round=26 head_norm_before_train=1.325368 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.007439 metrics={'f1_val': 0.9965574496053289, 'auprc': 0.9990613429025699, 'loss_val': 0.09769131220444141, 'psi': 0.9975590069242253}-{'f1_val': 0.9973833833620065, 'auprc': 0.9971031957195293, 'loss_val': 0.11165111391507618, 'psi': 0.9972713083050155}
[S15] START round=26 head_norm_before_train=1.347345 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.700833884979711, 'auprc': 0.6839385388422882, 'loss_val': 0.5603575236868501, 'psi': 0.6940757465247418}-{'f1_val': 0.9853111009650785, 'auprc': 0.9977823465662581, 'loss_val': 0.10617834682345043, 'psi': 0.9902995992055503}
[S16] START round=26 head_norm_before_train=1.231203 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.249882 metrics={'f1_val': 0.9117358486515911, 'auprc': 0.9769120893089276, 'loss_val': 0.33852021221359313, 'psi': 0.9378063449145257}-{'f1_val': 0.8581309999100531, 'auprc': 0.9646596355011646, 'loss_val': 0.47989740059164504, 'psi': 0.9007424541464978}
[S17] START round=26 head_norm_before_train=1.269710 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.196457 metrics={'f1_val': 0.6729091649619464, 'auprc': 0.8309389972597448, 'loss_val': 0.7024603547172575, 'psi': 0.7361210978810657}-{'f1_val': 0.5932441576632334, 'auprc': 0.8603471786261965, 'loss_val': 0.7056086680570541, 'psi': 0.7000853660484185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:45914
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:45915
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:45908
[S4] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S10
[S8] cosine check vs S10: cos=0.9990
[S17] RECEIVED delta(kind=head bytes=1797) from S6
[S17] cosine check vs S6: cos=0.8419
[S7] RECEIVED delta(kind=head bytes=1806) from S4
[S7] cosine check vs S4: cos=0.9936
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] cosine check vs S16: cos=0.9613
[S17] RECEIVED delta(kind=head bytes=1806) from S14
[S17] cosine check vs S14: cos=0.9790
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] cosine check vs S11: cos=0.9956
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:45907
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S17
[S6] cosine check vs S17: cos=0.8419
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9943 head_norm=2.127535
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.796012e-02
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9943 head_norm=2.121794 delta_norm=0.047960
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.6598 head_norm=1.461571
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.753700e-02
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.6567 head_norm=1.506837 delta_norm=0.097537
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.7008 head_norm=1.378694
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.918700e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.7008 head_norm=1.311332 delta_norm=0.191870
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9966 head_norm=1.352519
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.446899e-02
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9966 head_norm=1.361255 delta_norm=0.064469
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.7094 head_norm=1.224136
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.607587e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.7164 head_norm=1.221229 delta_norm=0.360759
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.6729 head_norm=1.320828
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.695319e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.6732 head_norm=1.258495 delta_norm=0.169532
[S17] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.503703 cos_to_last_merge=0.9888 (last merge round=22)
[S2] round=27 local utility u=0.064699 metrics={'f1_val': 0.71114352573705, 'auprc': 0.8168943091702981, 'loss_val': 0.39262519065394724, 'psi': 0.7534438391103493}-{'f1_val': 0.7396619895484955, 'auprc': 0.774889789597561, 'loss_val': 0.567120196153941, 'psi': 0.7537531095681217}
[S3] START round=27 head_norm_before_train=2.131731 cos_to_last_merge=0.9979 (last merge round=21)
[S3] round=27 local utility u=0.768068 metrics={'f1_val': 0.9958003563996742, 'auprc': 0.9962957930348637, 'loss_val': 0.07519439330130666, 'psi': 0.99599853105375}-{'f1_val': 0.7947048074960034, 'auprc': 0.9973546735763592, 'loss_val': 0.4079337433694574, 'psi': 0.8757647539281457}
[S4] START round=27 head_norm_before_train=1.556904 cos_to_last_merge=0.9840 (last merge round=21)
[S4] round=27 local utility u=0.055470 metrics={'f1_val': 0.954364436125783, 'auprc': 0.9540718695879686, 'loss_val': 0.26170359677039634, 'psi': 0.9542474095106572}-{'f1_val': 0.9478537766080691, 'auprc': 0.9352675090415031, 'loss_val': 0.27716615113391085, 'psi': 0.9428192695814428}
[S5] START round=27 head_norm_before_train=1.077456 cos_to_last_merge=0.9986 (last merge round=25)
[S5] round=27 local utility u=0.696671 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9899722280680752, 'loss_val': 0.3818667847247909, 'psi': 0.8163543476306985}-{'f1_val': 0.5790769451354295, 'auprc': 0.8536563217706139, 'loss_val': 0.6370687962511621, 'psi': 0.6889086957895032}
[S6] START round=27 head_norm_before_train=1.221229 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.504360 metrics={'f1_val': 0.768733170063771, 'auprc': 0.9295559052885167, 'loss_val': 0.575402482111874, 'psi': 0.8330622641536692}-{'f1_val': 0.7094448874527716, 'auprc': 0.7524927037606803, 'loss_val': 0.6972030107320134, 'psi': 0.726664013975935}
[S7] START round=27 head_norm_before_train=1.506837 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.039080 metrics={'f1_val': 0.6656057768298809, 'auprc': 0.8328900775959893, 'loss_val': 0.48513902833533235, 'psi': 0.7325194971363242}-{'f1_val': 0.659810890211946, 'auprc': 0.8281785498442434, 'loss_val': 0.5143951681026977, 'psi': 0.7271579540648649}
[S8] START round=27 head_norm_before_train=2.121794 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9919528555747477, 'auprc': 0.9993791194962776, 'loss_val': 0.0377487053388091, 'psi': 0.9949233611433596}-{'f1_val': 0.9942788405856967, 'auprc': 0.9981087314558679, 'loss_val': 0.03848335875381893, 'psi': 0.9958107969337652}
[S9] START round=27 head_norm_before_train=1.913570 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9984869269694807, 'loss_val': 0.028268012890492855, 'psi': 0.9957583983862005}-{'f1_val': 0.9964388212112862, 'auprc': 0.9965441619340956, 'loss_val': 0.026166294114101363, 'psi': 0.99648095750041}
[S10] START round=27 head_norm_before_train=2.117125 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=27 local utility u=0.000834 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956192144755671, 'loss_val': 0.026786463288990446, 'psi': 0.9952285977092725}-{'f1_val': 0.9947486092193725, 'auprc': 0.9956707325893521, 'loss_val': 0.02729148219052828, 'psi': 0.9951174585673643}
[S11] START round=27 head_norm_before_train=1.372967 cos_to_last_merge=0.9829 (last merge round=22)
[S11] round=27 local utility u=0.061836 metrics={'f1_val': 0.9902260811008444, 'auprc': 0.9943080424534068, 'loss_val': 0.12729663268303862, 'psi': 0.9918588656418693}-{'f1_val': 0.9727473851450108, 'auprc': 0.9947036917597023, 'loss_val': 0.14728272547908955, 'psi': 0.9815299077908874}
[S13] START round=27 head_norm_before_train=1.418315 cos_to_last_merge=0.9993 (last merge round=24)
[S13] round=27 local utility u=0.244269 metrics={'f1_val': 0.7463578299220714, 'auprc': 0.8119613147253456, 'loss_val': 0.7085244039382027, 'psi': 0.7725992238433812}-{'f1_val': 0.6775587955284887, 'auprc': 0.8116070985594166, 'loss_val': 0.7832050780375855, 'psi': 0.7311781167408599}
[S14] START round=27 head_norm_before_train=1.361255 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9462889004777876, 'auprc': 0.9967937611659361, 'loss_val': 0.1161293455732442, 'psi': 0.9664908447530469}-{'f1_val': 0.9965574496053289, 'auprc': 0.9990613429025699, 'loss_val': 0.09769131220444141, 'psi': 0.9975590069242253}
[S15] START round=27 head_norm_before_train=1.311332 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=1.000000 metrics={'f1_val': 0.9965259456095847, 'auprc': 0.996906309592701, 'loss_val': 0.060743768502039004, 'psi': 0.9966780912028312}-{'f1_val': 0.700833884979711, 'auprc': 0.6839385388422882, 'loss_val': 0.5603575236868501, 'psi': 0.6940757465247418}
[S16] START round=27 head_norm_before_train=1.269651 cos_to_last_merge=0.9993 (last merge round=25)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.8927713866554816, 'auprc': 0.9821932921749106, 'loss_val': 0.3864525436282337, 'psi': 0.9285401488632532}-{'f1_val': 0.9117358486515911, 'auprc': 0.9769120893089276, 'loss_val': 0.33852021221359313, 'psi': 0.9378063449145257}
[S17] START round=27 head_norm_before_train=1.258495 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.123202 metrics={'f1_val': 0.6858257813776947, 'auprc': 0.8902343482620745, 'loss_val': 0.7114429760536168, 'psi': 0.7675892081314466}-{'f1_val': 0.6729091649619464, 'auprc': 0.8309389972597448, 'loss_val': 0.7024603547172575, 'psi': 0.7361210978810657}
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S16
[S13]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S15
[S17]  timeout peer S16
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S14
[S15]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:45916
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:45909
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:45908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:45914
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1805) from S4
[S7] cosine check vs S4: cos=0.9972
[S4] RECEIVED delta(kind=head bytes=1802) from S7
[S4] cosine check vs S7: cos=0.9972
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=0.9970
[S8] RECEIVED delta(kind=head bytes=1797) from S10
[S8] cosine check vs S10: cos=0.9995
[S8] RECEIVED delta(kind=head bytes=1801) from S3
[S8] cosine check vs S3: cos=0.9980
[S17] RECEIVED delta(kind=head bytes=1806) from S6
[S17] cosine check vs S6: cos=0.9509
[S13] RECEIVED delta(kind=head bytes=1797) from S2
[S13] cosine check vs S2: cos=0.9900
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.8670
[S15] RECEIVED delta(kind=head bytes=1796) from S13
[S15] cosine check vs S13: cos=0.9667
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] cosine check vs S15: cos=0.9860
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6656 head_norm=1.516504
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.522266e-02
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6644 head_norm=1.546171 delta_norm=0.065223
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9544 head_norm=1.577978
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.522266e-02
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9544 head_norm=1.546171 delta_norm=0.065223
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:45907
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.7464 head_norm=1.440873
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.152243e-01
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.7379 head_norm=1.484575 delta_norm=0.115224
[S13] aggregate: ROLLBACK (f1_val pre=0.746 post=0.738 tol_abs=0.005 tol_rel=0.0)
[S17] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S17
[S6] cosine check vs S17: cos=0.9509
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9920 head_norm=2.134822
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.836588e-02
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9920 head_norm=2.136092 delta_norm=0.028366
[S8] aggregate: ACCEPT kept=['S10', 'S3'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.9965 head_norm=1.337583
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.864230e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.9963 head_norm=1.377632 delta_norm=0.186423
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9463 head_norm=1.387485
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.584369e-02
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9448 head_norm=1.398183 delta_norm=0.055844
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] CommDone barrier timeout: have=2 need=3 — continuing
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.8928 head_norm=1.308272
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.659693e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.8877 head_norm=1.232456 delta_norm=0.165969
[S16] aggregate: ROLLBACK (f1_val pre=0.893 post=0.888 tol_abs=0.005 tol_rel=0.0)
[S17] CommDone barrier timeout: have=2 need=3 — continuing
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.6858 head_norm=1.320028
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.065700e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.6858 head_norm=1.301458 delta_norm=0.206570
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.535696 cos_to_last_merge=0.9865 (last merge round=22)
[S2] round=28 local utility u=0.139051 metrics={'f1_val': 0.7146242409973683, 'auprc': 0.9050112674833508, 'loss_val': 0.39975827846349654, 'psi': 0.7907790515917613}-{'f1_val': 0.71114352573705, 'auprc': 0.8168943091702981, 'loss_val': 0.39262519065394724, 'psi': 0.7534438391103493}
[S3] START round=28 head_norm_before_train=2.149720 cos_to_last_merge=0.9972 (last merge round=21)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.960110729356964, 'auprc': 0.9962117853211214, 'loss_val': 0.11656750761823553, 'psi': 0.9745511517426269}-{'f1_val': 0.9958003563996742, 'auprc': 0.9962957930348637, 'loss_val': 0.07519439330130666, 'psi': 0.99599853105375}
[S4] START round=28 head_norm_before_train=1.546171 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9482982980916936, 'auprc': 0.942989430937626, 'loss_val': 0.2762128911287731, 'psi': 0.9461747512300666}-{'f1_val': 0.954364436125783, 'auprc': 0.9540718695879686, 'loss_val': 0.26170359677039634, 'psi': 0.9542474095106572}
[S5] START round=28 head_norm_before_train=1.108558 cos_to_last_merge=0.9942 (last merge round=25)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.5505998101029542, 'auprc': 0.8536675526176528, 'loss_val': 0.5808280548319605, 'psi': 0.6718269071088336}-{'f1_val': 0.7006090940057808, 'auprc': 0.9899722280680752, 'loss_val': 0.3818667847247909, 'psi': 0.8163543476306985}
[S6] START round=28 head_norm_before_train=1.315467 cos_to_last_merge=0.9848 (last merge round=26)
[S6] round=28 local utility u=0.101679 metrics={'f1_val': 0.7956348785243097, 'auprc': 0.9314091144009877, 'loss_val': 0.5390143379035901, 'psi': 0.8499445728749809}-{'f1_val': 0.768733170063771, 'auprc': 0.9295559052885167, 'loss_val': 0.575402482111874, 'psi': 0.8330622641536692}
[S7] START round=28 head_norm_before_train=1.546171 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.138073 metrics={'f1_val': 0.6848050928944005, 'auprc': 0.8611990573158645, 'loss_val': 0.4091162486287937, 'psi': 0.7553626786629861}-{'f1_val': 0.6656057768298809, 'auprc': 0.8328900775959893, 'loss_val': 0.48513902833533235, 'psi': 0.7325194971363242}
[S8] START round=28 head_norm_before_train=2.136092 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9858253762799277, 'loss_val': 0.6001258698509385, 'psi': 0.8228736137506686}-{'f1_val': 0.9919528555747477, 'auprc': 0.9993791194962776, 'loss_val': 0.0377487053388091, 'psi': 0.9949233611433596}
[S9] START round=28 head_norm_before_train=1.928065 (no previous merge yet)
[S9] round=28 local utility u=0.008223 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9988591927843695, 'loss_val': 0.025427016799385246, 'psi': 0.9971560983000601}-{'f1_val': 0.9939393793306803, 'auprc': 0.9984869269694807, 'loss_val': 0.028268012890492855, 'psi': 0.9957583983862005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=28 head_norm_before_train=2.129498 cos_to_last_merge=0.9999 (last merge round=25)
[S10] round=28 local utility u=0.000139 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9955827693133, 'loss_val': 0.02639853079435707, 'psi': 0.9952140196443657}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956192144755671, 'loss_val': 0.026786463288990446, 'psi': 0.9952285977092725}
[S11] START round=28 head_norm_before_train=1.411012 cos_to_last_merge=0.9781 (last merge round=22)
[S11] round=28 local utility u=0.015220 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.992842535748287, 'loss_val': 0.13038526757390945, 'psi': 0.9950652170074685}-{'f1_val': 0.9902260811008444, 'auprc': 0.9943080424534068, 'loss_val': 0.12729663268303862, 'psi': 0.9918588656418693}
[S13] START round=28 head_norm_before_train=1.484575 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6753197153903603, 'auprc': 0.74798430672487, 'loss_val': 0.7273070989828533, 'psi': 0.7043855519241642}-{'f1_val': 0.7463578299220714, 'auprc': 0.8119613147253456, 'loss_val': 0.7085244039382027, 'psi': 0.7725992238433812}
[S14] START round=28 head_norm_before_train=1.398183 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.173026 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9972151500073491, 'loss_val': 0.07951578245965275, 'psi': 0.9974767308328518}-{'f1_val': 0.9462889004777876, 'auprc': 0.9967937611659361, 'loss_val': 0.1161293455732442, 'psi': 0.9664908447530469}
[S15] START round=28 head_norm_before_train=1.377632 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.8095596244949437, 'auprc': 0.9933474625902506, 'loss_val': 0.3483965299150275, 'psi': 0.8830747597330664}-{'f1_val': 0.9965259456095847, 'auprc': 0.996906309592701, 'loss_val': 0.060743768502039004, 'psi': 0.9966780912028312}
[S16] START round=28 head_norm_before_train=1.232456 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.053687 metrics={'f1_val': 0.9057969043231879, 'auprc': 0.9845786813406463, 'loss_val': 0.36438731900938287, 'psi': 0.9373096151301712}-{'f1_val': 0.8927713866554816, 'auprc': 0.9821932921749106, 'loss_val': 0.3864525436282337, 'psi': 0.9285401488632532}
[S17] START round=28 head_norm_before_train=1.301458 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5497096112828345, 'auprc': 0.7211092636530074, 'loss_val': 0.9089102398066655, 'psi': 0.6182694722309037}-{'f1_val': 0.6858257813776947, 'auprc': 0.8902343482620745, 'loss_val': 0.7114429760536168, 'psi': 0.7675892081314466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:45904
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:45909
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:45913
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1796 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S7
[S4] cosine check vs S7: cos=0.9998
[S14] RECEIVED delta(kind=head bytes=1803) from S11
[S14] cosine check vs S11: cos=0.9979
[S8] RECEIVED delta(kind=head bytes=1796) from S10
[S8] cosine check vs S10: cos=0.9991
[S13] RECEIVED delta(kind=head bytes=1804) from S2
[S13] cosine check vs S2: cos=0.9961
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=0.9607
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.7956 head_norm=1.436411
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.982487e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.8064 head_norm=1.346819 delta_norm=0.298249
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.6753 head_norm=1.509660
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.338732e-02
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.6729 head_norm=1.536209 delta_norm=0.073387
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.7142 head_norm=2.145872
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.454448e-02
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.7142 head_norm=2.142394 delta_norm=0.044544
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:45917
[S14] sending update (kind=head size=1805 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1805) from S14
[S17] cosine check vs S14: cos=0.9073
[S16]  timeout peer S5
[S16]  timeout peer S9
[S16]  timeout peer S11
[S14]  timeout peer S4
[S14]  timeout peer S17
[S11]  timeout peer S14
[S4]  timeout peer S7
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S6
[S3]  timeout peer S8
[S15]  timeout peer S16
[S13]  timeout peer S15
[S8]  timeout peer S10
[S2]  timeout peer S13
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:45915
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9977 head_norm=1.422747
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.750238e-02
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9977 head_norm=1.432158 delta_norm=0.047502
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.5497 head_norm=1.360534
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.234609e-01
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.5488 head_norm=1.353568 delta_norm=0.123461
[S17] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1795) from S16
[S15] cosine check vs S16: cos=0.9589
[S2] START round=29 head_norm_before_train=1.565750 cos_to_last_merge=0.9844 (last merge round=22)
[S2] round=29 local utility u=0.129853 metrics={'f1_val': 0.7143254667216357, 'auprc': 0.9894665270588983, 'loss_val': 0.39162499911642035, 'psi': 0.8243818908565407}-{'f1_val': 0.7146242409973683, 'auprc': 0.9050112674833508, 'loss_val': 0.39975827846349654, 'psi': 0.7907790515917613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=29 head_norm_before_train=2.163968 cos_to_last_merge=0.9966 (last merge round=21)
[S3] round=29 local utility u=0.075057 metrics={'f1_val': 0.9814223321203568, 'auprc': 0.9970707021902329, 'loss_val': 0.09690058276535159, 'psi': 0.9876816801483073}-{'f1_val': 0.960110729356964, 'auprc': 0.9962117853211214, 'loss_val': 0.11656750761823553, 'psi': 0.9745511517426269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=29 head_norm_before_train=1.564651 cos_to_last_merge=0.9999 (last merge round=27)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9468014900621942, 'auprc': 0.9434470813710426, 'loss_val': 0.27500739180522915, 'psi': 0.9454597265857335}-{'f1_val': 0.9482982980916936, 'auprc': 0.942989430937626, 'loss_val': 0.2762128911287731, 'psi': 0.9461747512300666}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9468 head_norm=1.581630
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.634436e-02
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9468 head_norm=1.569294 delta_norm=0.026344
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] START round=29 head_norm_before_train=1.146180 cos_to_last_merge=0.9872 (last merge round=25)
[S5] round=29 local utility u=0.402530 metrics={'f1_val': 0.653292200235571, 'auprc': 0.8630116792490077, 'loss_val': 0.419953959875664, 'psi': 0.7371799918409456}-{'f1_val': 0.5505998101029542, 'auprc': 0.8536675526176528, 'loss_val': 0.5808280548319605, 'psi': 0.6718269071088336}
[S6] START round=29 head_norm_before_train=1.346819 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.7825262141889633, 'auprc': 0.9447838415461848, 'loss_val': 0.5092598058980694, 'psi': 0.8474292651318519}-{'f1_val': 0.7956348785243097, 'auprc': 0.9314091144009877, 'loss_val': 0.5390143379035901, 'psi': 0.8499445728749809}
[S7] START round=29 head_norm_before_train=1.557306 cos_to_last_merge=0.9999 (last merge round=27)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5636567428294557, 'auprc': 0.7839276961643492, 'loss_val': 0.7074156560182735, 'psi': 0.651765124163413}-{'f1_val': 0.6848050928944005, 'auprc': 0.8611990573158645, 'loss_val': 0.4091162486287937, 'psi': 0.7553626786629861}
[S8] START round=29 head_norm_before_train=2.142394 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=1.000000 metrics={'f1_val': 0.9871538275294434, 'auprc': 0.996113327505019, 'loss_val': 0.057318988392974175, 'psi': 0.9907376275196736}-{'f1_val': 0.7142391053978291, 'auprc': 0.9858253762799277, 'loss_val': 0.6001258698509385, 'psi': 0.8228736137506686}
[S9] START round=29 head_norm_before_train=1.942874 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9963715800987538, 'loss_val': 0.023686215096344526, 'psi': 0.9965449391278364}-{'f1_val': 0.9960207019771873, 'auprc': 0.9988591927843695, 'loss_val': 0.025427016799385246, 'psi': 0.9971560983000601}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=29 head_norm_before_train=2.139838 cos_to_last_merge=0.9998 (last merge round=25)
[S10] round=29 local utility u=0.000077 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9955370601970361, 'loss_val': 0.026107412442303607, 'psi': 0.9951957359978602}-{'f1_val': 0.9949681865317428, 'auprc': 0.9955827693133, 'loss_val': 0.02639853079435707, 'psi': 0.9952140196443657}
[S11] START round=29 head_norm_before_train=1.443071 cos_to_last_merge=0.9743 (last merge round=22)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9575446555354004, 'auprc': 0.9954659841359572, 'loss_val': 0.10439465081556493, 'psi': 0.9727131869756231}-{'f1_val': 0.9965470045135896, 'auprc': 0.992842535748287, 'loss_val': 0.13038526757390945, 'psi': 0.9950652170074685}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=29 head_norm_before_train=1.536209 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.128137 metrics={'f1_val': 0.7213442296791336, 'auprc': 0.805312694420237, 'loss_val': 0.9191658324248257, 'psi': 0.754931615575575}-{'f1_val': 0.6753197153903603, 'auprc': 0.74798430672487, 'loss_val': 0.7273070989828533, 'psi': 0.7043855519241642}
[S14] START round=29 head_norm_before_train=1.432158 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.985359895093606, 'auprc': 0.9978568736727139, 'loss_val': 0.08964117331383896, 'psi': 0.9903586865252492}-{'f1_val': 0.9976511180498535, 'auprc': 0.9972151500073491, 'loss_val': 0.07951578245965275, 'psi': 0.9974767308328518}
[S15] START round=29 head_norm_before_train=1.404847 cos_to_last_merge=0.9998 (last merge round=27)
[S15] round=29 local utility u=0.436764 metrics={'f1_val': 0.9185382388758088, 'auprc': 0.9962522829071309, 'loss_val': 0.13745401265881502, 'psi': 0.9496238564883377}-{'f1_val': 0.8095596244949437, 'auprc': 0.9933474625902506, 'loss_val': 0.3483965299150275, 'psi': 0.8830747597330664}
[S16] START round=29 head_norm_before_train=1.269127 cos_to_last_merge=0.9995 (last merge round=27)
[S16] round=29 local utility u=0.343293 metrics={'f1_val': 0.9867840167455141, 'auprc': 0.9813123906148349, 'loss_val': 0.15392485233835548, 'psi': 0.9845953662932424}-{'f1_val': 0.9057969043231879, 'auprc': 0.9845786813406463, 'loss_val': 0.36438731900938287, 'psi': 0.9373096151301712}
[S17] START round=29 head_norm_before_train=1.353568 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=0.598690 metrics={'f1_val': 0.6155991184636285, 'auprc': 0.9314617824468377, 'loss_val': 0.7379240504112983, 'psi': 0.7419441840569122}-{'f1_val': 0.5497096112828345, 'auprc': 0.7211092636530074, 'loss_val': 0.9089102398066655, 'psi': 0.6182694722309037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:45902
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:45916
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:45915
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:45909
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S15
[S13] cosine check vs S15: cos=0.9847
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=0.9966
[S8] RECEIVED delta(kind=head bytes=1799) from S10
[S8] cosine check vs S10: cos=0.9996
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.8811
[S14] RECEIVED delta(kind=head bytes=1793) from S17
[S14] cosine check vs S17: cos=0.9220
[S15] RECEIVED delta(kind=head bytes=1802) from S16
[S15] cosine check vs S16: cos=0.9539
[S2] RECEIVED delta(kind=head bytes=1799) from S13
[S2] cosine check vs S13: cos=0.9982
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.9185 head_norm=1.434324
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.145101e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.9207 head_norm=1.345485 delta_norm=0.214510
[S15] aggregate: ACCEPT kept=['S16', 'S16'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9872 head_norm=2.149881
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.074662e-02
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9872 head_norm=2.148683 delta_norm=0.030747
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.7213 head_norm=1.552098
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.430568e-01
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.7226 head_norm=1.487508 delta_norm=0.143057
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9868 head_norm=1.304361
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.090695e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9868 head_norm=1.209118 delta_norm=0.309069
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.594250 cos_to_last_merge=0.9824 (last merge round=22)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.646875203195072, 'auprc': 0.7276421715774175, 'loss_val': 1.1288247748342992, 'psi': 0.6791819905480102}-{'f1_val': 0.7143254667216357, 'auprc': 0.9894665270588983, 'loss_val': 0.39162499911642035, 'psi': 0.8243818908565407}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=30 metric=0.6469 head_norm=1.617419
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.263994e-02
[S2] stored merged vector for next round verification (round=30)
[S2] DEBUG after merge:  round=30 metric=0.6469 head_norm=1.583856 delta_norm=0.062640
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] START round=30 head_norm_before_train=2.175869 cos_to_last_merge=0.9960 (last merge round=21)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.7939719524655702, 'auprc': 0.9981068480997467, 'loss_val': 0.4105262331632851, 'psi': 0.8756259107192408}-{'f1_val': 0.9814223321203568, 'auprc': 0.9970707021902329, 'loss_val': 0.09690058276535159, 'psi': 0.9876816801483073}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.7940 head_norm=2.185091
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.600674e-02
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.8008 head_norm=2.165430 delta_norm=0.096007
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] START round=30 head_norm_before_train=1.569294 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9405565371000103, 'auprc': 0.9448748414665349, 'loss_val': 0.3022670072533404, 'psi': 0.94228385884662}-{'f1_val': 0.9468014900621942, 'auprc': 0.9434470813710426, 'loss_val': 0.27500739180522915, 'psi': 0.9454597265857335}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=1.188959 cos_to_last_merge=0.9798 (last merge round=25)
[S5] round=30 local utility u=0.073606 metrics={'f1_val': 0.6751478813491337, 'auprc': 0.8604076109869988, 'loss_val': 0.3960645672161797, 'psi': 0.7492517732042798}-{'f1_val': 0.653292200235571, 'auprc': 0.8630116792490077, 'loss_val': 0.419953959875664, 'psi': 0.7371799918409456}
[S6] START round=30 head_norm_before_train=1.432930 cos_to_last_merge=0.9955 (last merge round=28)
[S6] round=30 local utility u=0.155075 metrics={'f1_val': 0.8250761733730921, 'auprc': 0.9232863014942811, 'loss_val': 0.3899167091427304, 'psi': 0.8643602246215678}-{'f1_val': 0.7825262141889633, 'auprc': 0.9447838415461848, 'loss_val': 0.5092598058980694, 'psi': 0.8474292651318519}
[S7] START round=30 head_norm_before_train=1.565489 cos_to_last_merge=0.9996 (last merge round=27)
[S7] round=30 local utility u=0.654067 metrics={'f1_val': 0.6842427303946933, 'auprc': 0.8684392942214649, 'loss_val': 0.37633305190881267, 'psi': 0.7579213559254019}-{'f1_val': 0.5636567428294557, 'auprc': 0.7839276961643492, 'loss_val': 0.7074156560182735, 'psi': 0.651765124163413}
[S8] START round=30 head_norm_before_train=2.148683 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.037556 metrics={'f1_val': 0.9944248929832828, 'auprc': 0.9994505490555827, 'loss_val': 0.035844263196551394, 'psi': 0.9964351554122027}-{'f1_val': 0.9871538275294434, 'auprc': 0.996113327505019, 'loss_val': 0.057318988392974175, 'psi': 0.9907376275196736}
[S9] START round=30 head_norm_before_train=1.956752 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9896951746952075, 'auprc': 0.9983960771003284, 'loss_val': 0.03643550687338062, 'psi': 0.9931755356572558}-{'f1_val': 0.9966605118138915, 'auprc': 0.9963715800987538, 'loss_val': 0.023686215096344526, 'psi': 0.9965449391278364}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=2.147925 cos_to_last_merge=0.9997 (last merge round=25)
[S10] round=30 local utility u=0.000130 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9955649901448413, 'loss_val': 0.025930940870878112, 'psi': 0.9952069079769823}-{'f1_val': 0.9949681865317428, 'auprc': 0.9955370601970361, 'loss_val': 0.026107412442303607, 'psi': 0.9951957359978602}
[S11] START round=30 head_norm_before_train=1.474733 cos_to_last_merge=0.9704 (last merge round=22)
[S11] round=30 local utility u=0.103381 metrics={'f1_val': 0.9880923386741293, 'auprc': 0.9949524377944474, 'loss_val': 0.07937766656484053, 'psi': 0.9908363783222565}-{'f1_val': 0.9575446555354004, 'auprc': 0.9954659841359572, 'loss_val': 0.10439465081556493, 'psi': 0.9727131869756231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=30 head_norm_before_train=1.487508 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.634071241187073, 'auprc': 0.7702720447103442, 'loss_val': 0.7964386397531519, 'psi': 0.6885515625963815}-{'f1_val': 0.7213442296791336, 'auprc': 0.805312694420237, 'loss_val': 0.9191658324248257, 'psi': 0.754931615575575}
[S14] START round=30 head_norm_before_train=1.452604 cos_to_last_merge=0.9998 (last merge round=28)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9771007095526447, 'auprc': 0.9966433371587305, 'loss_val': 0.08443594694291494, 'psi': 0.984917760595079}-{'f1_val': 0.985359895093606, 'auprc': 0.9978568736727139, 'loss_val': 0.08964117331383896, 'psi': 0.9903586865252492}
[S15] START round=30 head_norm_before_train=1.345485 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.039652 metrics={'f1_val': 0.9293098933332826, 'auprc': 0.9930416822588519, 'loss_val': 0.11314841937949903, 'psi': 0.9548026089035103}-{'f1_val': 0.9185382388758088, 'auprc': 0.9962522829071309, 'loss_val': 0.13745401265881502, 'psi': 0.9496238564883377}
[S16] START round=30 head_norm_before_train=1.209118 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.925439697038231, 'auprc': 0.9867918624634967, 'loss_val': 0.27087522013457666, 'psi': 0.9499805632083373}-{'f1_val': 0.9867840167455141, 'auprc': 0.9813123906148349, 'loss_val': 0.15392485233835548, 'psi': 0.9845953662932424}
[S17] START round=30 head_norm_before_train=1.405700 cos_to_last_merge=0.9989 (last merge round=28)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.559386932936592, 'auprc': 0.7120175354163855, 'loss_val': 0.9661131568610188, 'psi': 0.6204391739285093}-{'f1_val': 0.6155991184636285, 'auprc': 0.9314617824468377, 'loss_val': 0.7379240504112983, 'psi': 0.7419441840569122}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9771 head_norm=1.474381
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.860759e-01
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9608 head_norm=1.411757 delta_norm=0.286076
[S14] aggregate: ROLLBACK (f1_val pre=0.977 post=0.961 tol_abs=0.005 tol_rel=0.0)
[S2] START round=31 head_norm_before_train=1.583856 cos_to_last_merge=1.0000 (last merge round=30)
[S2] round=31 local utility u=0.960097 metrics={'f1_val': 0.7755284931945554, 'auprc': 0.8591527044245197, 'loss_val': 0.3750821847874983, 'psi': 0.8089781776865411}-{'f1_val': 0.646875203195072, 'auprc': 0.7276421715774175, 'loss_val': 1.1288247748342992, 'psi': 0.6791819905480102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=31 head_norm_before_train=2.165430 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.792584 metrics={'f1_val': 0.997586072096991, 'auprc': 0.9972639460838416, 'loss_val': 0.0445142235110846, 'psi': 0.9974572216917312}-{'f1_val': 0.7939719524655702, 'auprc': 0.9981068480997467, 'loss_val': 0.4105262331632851, 'psi': 0.8756259107192408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=31 head_norm_before_train=1.587051 cos_to_last_merge=0.9999 (last merge round=29)
[S4] round=31 local utility u=0.044354 metrics={'f1_val': 0.9471902678444503, 'auprc': 0.9525730117724135, 'loss_val': 0.2764551260329172, 'psi': 0.9493433654156356}-{'f1_val': 0.9405565371000103, 'auprc': 0.9448748414665349, 'loss_val': 0.3022670072533404, 'psi': 0.94228385884662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=31 head_norm_before_train=1.228216 cos_to_last_merge=0.9740 (last merge round=25)
[S5] round=31 local utility u=0.335618 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9888667961694044, 'loss_val': 0.26296996393314415, 'psi': 0.8159117540653664}-{'f1_val': 0.6751478813491337, 'auprc': 0.8604076109869988, 'loss_val': 0.3960645672161797, 'psi': 0.7492517732042798}
[S6] START round=31 head_norm_before_train=1.507826 cos_to_last_merge=0.9874 (last merge round=28)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.7604206327701613, 'auprc': 0.9258550229698693, 'loss_val': 0.599168930158625, 'psi': 0.8265943888500444}-{'f1_val': 0.8250761733730921, 'auprc': 0.9232863014942811, 'loss_val': 0.3899167091427304, 'psi': 0.8643602246215678}
[S7] START round=31 head_norm_before_train=1.574585 cos_to_last_merge=0.9993 (last merge round=27)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.4860814840386812, 'auprc': 0.7817420788986975, 'loss_val': 0.8508829413493136, 'psi': 0.6043457219826878}-{'f1_val': 0.6842427303946933, 'auprc': 0.8684392942214649, 'loss_val': 0.37633305190881267, 'psi': 0.7579213559254019}
[S8] START round=31 head_norm_before_train=2.155120 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9926035371309061, 'auprc': 0.9993493028792152, 'loss_val': 0.036560257650059935, 'psi': 0.9953018434302298}-{'f1_val': 0.9944248929832828, 'auprc': 0.9994505490555827, 'loss_val': 0.035844263196551394, 'psi': 0.9964351554122027}
[S9] START round=31 head_norm_before_train=1.965574 (no previous merge yet)
[S9] round=31 local utility u=0.024194 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9958980895282792, 'loss_val': 0.02234596426444194, 'psi': 0.9963555428996466}-{'f1_val': 0.9896951746952075, 'auprc': 0.9983960771003284, 'loss_val': 0.03643550687338062, 'psi': 0.9931755356572558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=31 head_norm_before_train=2.152370 cos_to_last_merge=0.9993 (last merge round=25)
[S10] round=31 local utility u=0.000101 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9955668783470681, 'loss_val': 0.025735045036536765, 'psi': 0.995207663257873}-{'f1_val': 0.9949681865317428, 'auprc': 0.9955649901448413, 'loss_val': 0.025930940870878112, 'psi': 0.9952069079769823}
[S11] START round=31 head_norm_before_train=1.504248 cos_to_last_merge=0.9667 (last merge round=22)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9765902464941734, 'auprc': 0.9938931830916117, 'loss_val': 0.13937787219115833, 'psi': 0.9835114211331487}-{'f1_val': 0.9880923386741293, 'auprc': 0.9949524377944474, 'loss_val': 0.07937766656484053, 'psi': 0.9908363783222565}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=1.502820 cos_to_last_merge=0.9999 (last merge round=29)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6322681059986781, 'auprc': 0.7485875202529083, 'loss_val': 0.849987115910403, 'psi': 0.6787958717003701}-{'f1_val': 0.634071241187073, 'auprc': 0.7702720447103442, 'loss_val': 0.7964386397531519, 'psi': 0.6885515625963815}
[S14] START round=31 head_norm_before_train=1.411757 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.064462 metrics={'f1_val': 0.9961605687915402, 'auprc': 0.9989308721586437, 'loss_val': 0.07673277344181668, 'psi': 0.9972686901383816}-{'f1_val': 0.9771007095526447, 'auprc': 0.9966433371587305, 'loss_val': 0.08443594694291494, 'psi': 0.984917760595079}
[S15] START round=31 head_norm_before_train=1.378730 cos_to_last_merge=0.9998 (last merge round=29)
[S15] round=31 local utility u=0.241862 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9974027894693536, 'loss_val': 0.047127728575773006, 'psi': 0.9970091168202537}-{'f1_val': 0.9293098933332826, 'auprc': 0.9930416822588519, 'loss_val': 0.11314841937949903, 'psi': 0.9548026089035103}
[S16] START round=31 head_norm_before_train=1.244211 cos_to_last_merge=0.9996 (last merge round=29)
[S16] round=31 local utility u=0.000261 metrics={'f1_val': 0.9243976410387091, 'auprc': 0.9864016893066851, 'loss_val': 0.26293080470935415, 'psi': 0.9491992603458995}-{'f1_val': 0.925439697038231, 'auprc': 0.9867918624634967, 'loss_val': 0.27087522013457666, 'psi': 0.9499805632083373}
[S17] START round=31 head_norm_before_train=1.454962 cos_to_last_merge=0.9963 (last merge round=28)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.5521535048721877, 'auprc': 0.6523903017006463, 'loss_val': 1.0700119819474427, 'psi': 0.5922482236035711}-{'f1_val': 0.559386932936592, 'auprc': 0.7120175354163855, 'loss_val': 0.9661131568610188, 'psi': 0.6204391739285093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.599385 cos_to_last_merge=1.0000 (last merge round=30)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.7087372627579885, 'auprc': 0.9878450938390921, 'loss_val': 0.4196815147342319, 'psi': 0.82038039519043}-{'f1_val': 0.7755284931945554, 'auprc': 0.8591527044245197, 'loss_val': 0.3750821847874983, 'psi': 0.8089781776865411}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=2.173909 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9033159494253372, 'auprc': 0.9933208915564304, 'loss_val': 0.21178877861684148, 'psi': 0.9393179262777744}-{'f1_val': 0.997586072096991, 'auprc': 0.9972639460838416, 'loss_val': 0.0445142235110846, 'psi': 0.9974572216917312}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.606347 cos_to_last_merge=0.9997 (last merge round=29)
[S4] round=32 local utility u=0.019113 metrics={'f1_val': 0.9492854836064848, 'auprc': 0.9612551083145588, 'loss_val': 0.2768468254141971, 'psi': 0.9540733334897145}-{'f1_val': 0.9471902678444503, 'auprc': 0.9525730117724135, 'loss_val': 0.2764551260329172, 'psi': 0.9493433654156356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=32 head_norm_before_train=1.263679 cos_to_last_merge=0.9678 (last merge round=25)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.6302870361230909, 'auprc': 0.8805340373195011, 'loss_val': 0.4242717577134062, 'psi': 0.7303858366016549}-{'f1_val': 0.7006083926626743, 'auprc': 0.9888667961694044, 'loss_val': 0.26296996393314415, 'psi': 0.8159117540653664}
[S6] START round=32 head_norm_before_train=1.556394 cos_to_last_merge=0.9820 (last merge round=28)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.733238935151698, 'auprc': 0.9302705249673938, 'loss_val': 0.6273557924440999, 'psi': 0.8120515710779763}-{'f1_val': 0.7604206327701613, 'auprc': 0.9258550229698693, 'loss_val': 0.599168930158625, 'psi': 0.8265943888500444}
[S7] START round=32 head_norm_before_train=1.581164 cos_to_last_merge=0.9990 (last merge round=27)
[S7] round=32 local utility u=0.767160 metrics={'f1_val': 0.6498825852825928, 'auprc': 0.8307676007162104, 'loss_val': 0.4464460965264468, 'psi': 0.7222365914560398}-{'f1_val': 0.4860814840386812, 'auprc': 0.7817420788986975, 'loss_val': 0.8508829413493136, 'psi': 0.6043457219826878}
[S8] START round=32 head_norm_before_train=2.166550 cos_to_last_merge=0.9999 (last merge round=29)
[S8] round=32 local utility u=0.010054 metrics={'f1_val': 0.994792642153961, 'auprc': 0.9994867802977, 'loss_val': 0.02999935321586836, 'psi': 0.9966702974114566}-{'f1_val': 0.9926035371309061, 'auprc': 0.9993493028792152, 'loss_val': 0.036560257650059935, 'psi': 0.9953018434302298}
[S9] START round=32 head_norm_before_train=1.971966 (no previous merge yet)
[S9] round=32 local utility u=0.000419 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9960581923120712, 'loss_val': 0.021988723818979053, 'psi': 0.9964195840131633}-{'f1_val': 0.9966605118138915, 'auprc': 0.9958980895282792, 'loss_val': 0.02234596426444194, 'psi': 0.9963555428996466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=32 head_norm_before_train=2.162144 cos_to_last_merge=0.9991 (last merge round=25)
[S10] round=32 local utility u=0.000186 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9955730757037631, 'loss_val': 0.02538114882711824, 'psi': 0.9952101422005509}-{'f1_val': 0.9949681865317428, 'auprc': 0.9955668783470681, 'loss_val': 0.025735045036536765, 'psi': 0.995207663257873}
[S11] START round=32 head_norm_before_train=1.528626 cos_to_last_merge=0.9634 (last merge round=22)
[S11] round=32 local utility u=0.050832 metrics={'f1_val': 0.9809273496420604, 'auprc': 0.9949698856487056, 'loss_val': 0.0669659885915167, 'psi': 0.9865443640447185}-{'f1_val': 0.9765902464941734, 'auprc': 0.9938931830916117, 'loss_val': 0.13937787219115833, 'psi': 0.9835114211331487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=32 head_norm_before_train=1.516868 cos_to_last_merge=0.9998 (last merge round=29)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6218786829486531, 'auprc': 0.7624517287571126, 'loss_val': 0.9489366586639666, 'psi': 0.6781079012720369}-{'f1_val': 0.6322681059986781, 'auprc': 0.7485875202529083, 'loss_val': 0.849987115910403, 'psi': 0.6787958717003701}
[S14] START round=32 head_norm_before_train=1.434212 cos_to_last_merge=0.9999 (last merge round=30)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9940522555841613, 'auprc': 0.9989969735987327, 'loss_val': 0.0725853481497339, 'psi': 0.9960301427899899}-{'f1_val': 0.9961605687915402, 'auprc': 0.9989308721586437, 'loss_val': 0.07673277344181668, 'psi': 0.9972686901383816}
[S15] START round=32 head_norm_before_train=1.412393 cos_to_last_merge=0.9992 (last merge round=29)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.741347858866656, 'auprc': 0.942177828924174, 'loss_val': 0.4697349989528915, 'psi': 0.8216798468896632}-{'f1_val': 0.9967466683875206, 'auprc': 0.9974027894693536, 'loss_val': 0.047127728575773006, 'psi': 0.9970091168202537}
[S16] START round=32 head_norm_before_train=1.279321 cos_to_last_merge=0.9985 (last merge round=29)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.8795869740498348, 'auprc': 0.9868404070980021, 'loss_val': 0.4033309871608215, 'psi': 0.9224883472691017}-{'f1_val': 0.9243976410387091, 'auprc': 0.9864016893066851, 'loss_val': 0.26293080470935415, 'psi': 0.9491992603458995}
[S17] START round=32 head_norm_before_train=1.489152 cos_to_last_merge=0.9942 (last merge round=28)
[S17] round=32 local utility u=0.360241 metrics={'f1_val': 0.5973395052412322, 'auprc': 0.7689513816767448, 'loss_val': 0.9703283194055343, 'psi': 0.6659842558154373}-{'f1_val': 0.5521535048721877, 'auprc': 0.6523903017006463, 'loss_val': 1.0700119819474427, 'psi': 0.5922482236035711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=33 head_norm_before_train=1.614015 cos_to_last_merge=0.9999 (last merge round=30)
[S2] round=33 local utility u=0.013629 metrics={'f1_val': 0.7093864084820859, 'auprc': 0.9935439113135828, 'loss_val': 0.4134156866688516, 'psi': 0.8230494096146846}-{'f1_val': 0.7087372627579885, 'auprc': 0.9878450938390921, 'loss_val': 0.4196815147342319, 'psi': 0.82038039519043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=33 head_norm_before_train=2.181731 cos_to_last_merge=0.9999 (last merge round=30)
[S3] round=33 local utility u=0.288491 metrics={'f1_val': 0.9781590718139012, 'auprc': 0.9996655522471416, 'loss_val': 0.10289977102677865, 'psi': 0.9867616639871972}-{'f1_val': 0.9033159494253372, 'auprc': 0.9933208915564304, 'loss_val': 0.21178877861684148, 'psi': 0.9393179262777744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=33 head_norm_before_train=1.625971 cos_to_last_merge=0.9992 (last merge round=29)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9448330915113362, 'auprc': 0.9585146224190918, 'loss_val': 0.27806222873935726, 'psi': 0.9503057038744385}-{'f1_val': 0.9492854836064848, 'auprc': 0.9612551083145588, 'loss_val': 0.2768468254141971, 'psi': 0.9540733334897145}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.292780 cos_to_last_merge=0.9631 (last merge round=25)
[S5] round=33 local utility u=0.448826 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9859000378084777, 'loss_val': 0.2646455240573346, 'psi': 0.8147250507209957}-{'f1_val': 0.6302870361230909, 'auprc': 0.8805340373195011, 'loss_val': 0.4242717577134062, 'psi': 0.7303858366016549}
[S6] START round=33 head_norm_before_train=1.589995 cos_to_last_merge=0.9783 (last merge round=28)
[S6] round=33 local utility u=0.573846 metrics={'f1_val': 0.85907653737991, 'auprc': 0.9696391145879661, 'loss_val': 0.3527948758069241, 'psi': 0.9033015682631325}-{'f1_val': 0.733238935151698, 'auprc': 0.9302705249673938, 'loss_val': 0.6273557924440999, 'psi': 0.8120515710779763}
[S7] START round=33 head_norm_before_train=1.586774 cos_to_last_merge=0.9986 (last merge round=27)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.600881927353611, 'auprc': 0.7938193019338038, 'loss_val': 0.6333889260216552, 'psi': 0.6780568771856881}-{'f1_val': 0.6498825852825928, 'auprc': 0.8307676007162104, 'loss_val': 0.4464460965264468, 'psi': 0.7222365914560398}
[S8] START round=33 head_norm_before_train=2.180919 cos_to_last_merge=0.9998 (last merge round=29)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9915895183459548, 'auprc': 0.9995589727547729, 'loss_val': 0.03404531973791342, 'psi': 0.9947773001094821}-{'f1_val': 0.994792642153961, 'auprc': 0.9994867802977, 'loss_val': 0.02999935321586836, 'psi': 0.9966702974114566}
[S9] START round=33 head_norm_before_train=1.979143 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9912134460920485, 'auprc': 0.9984901513091244, 'loss_val': 0.030702559671920652, 'psi': 0.9941241281788789}-{'f1_val': 0.9966605118138915, 'auprc': 0.9960581923120712, 'loss_val': 0.021988723818979053, 'psi': 0.9964195840131633}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=2.173774 cos_to_last_merge=0.9990 (last merge round=25)
[S10] round=33 local utility u=0.000137 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.995580456526978, 'loss_val': 0.025128786668564877, 'psi': 0.995213094529837}-{'f1_val': 0.9949681865317428, 'auprc': 0.9955730757037631, 'loss_val': 0.02538114882711824, 'psi': 0.9952101422005509}
[S11] START round=33 head_norm_before_train=1.549149 cos_to_last_merge=0.9609 (last merge round=22)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9575446555354004, 'auprc': 0.9959364640785215, 'loss_val': 0.09731810218780847, 'psi': 0.9729013789526488}-{'f1_val': 0.9809273496420604, 'auprc': 0.9949698856487056, 'loss_val': 0.0669659885915167, 'psi': 0.9865443640447185}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.531906 cos_to_last_merge=0.9996 (last merge round=29)
[S13] round=33 local utility u=0.403883 metrics={'f1_val': 0.7115314040211451, 'auprc': 0.8163642063439686, 'loss_val': 0.840824518936669, 'psi': 0.7534645249502745}-{'f1_val': 0.6218786829486531, 'auprc': 0.7624517287571126, 'loss_val': 0.9489366586639666, 'psi': 0.6781079012720369}
[S14] START round=33 head_norm_before_train=1.456763 cos_to_last_merge=0.9995 (last merge round=30)
[S14] round=33 local utility u=0.004498 metrics={'f1_val': 0.9946680870156496, 'auprc': 0.9988936615303448, 'loss_val': 0.0669737897738999, 'psi': 0.9963583168215276}-{'f1_val': 0.9940522555841613, 'auprc': 0.9989969735987327, 'loss_val': 0.0725853481497339, 'psi': 0.9960301427899899}
[S15] START round=33 head_norm_before_train=1.448155 cos_to_last_merge=0.9984 (last merge round=29)
[S15] round=33 local utility u=0.575708 metrics={'f1_val': 0.8734806082577358, 'auprc': 0.9950337348987014, 'loss_val': 0.2696832527414002, 'psi': 0.922101858914122}-{'f1_val': 0.741347858866656, 'auprc': 0.942177828924174, 'loss_val': 0.4697349989528915, 'psi': 0.8216798468896632}
[S16] START round=33 head_norm_before_train=1.313526 cos_to_last_merge=0.9970 (last merge round=29)
[S16] round=33 local utility u=0.475921 metrics={'f1_val': 0.9913593826744562, 'auprc': 0.9809501567223785, 'loss_val': 0.10445235035676663, 'psi': 0.9871956922936251}-{'f1_val': 0.8795869740498348, 'auprc': 0.9868404070980021, 'loss_val': 0.4033309871608215, 'psi': 0.9224883472691017}
[S17] START round=33 head_norm_before_train=1.511612 cos_to_last_merge=0.9930 (last merge round=28)
[S17] round=33 local utility u=0.771264 metrics={'f1_val': 0.7611364045040717, 'auprc': 0.8539675698516656, 'loss_val': 0.6656299866590772, 'psi': 0.7982688706431093}-{'f1_val': 0.5973395052412322, 'auprc': 0.7689513816767448, 'loss_val': 0.9703283194055343, 'psi': 0.6659842558154373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S2] START round=34 head_norm_before_train=1.630235 cos_to_last_merge=0.9997 (last merge round=30)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7092769260983278, 'auprc': 0.9938185408386506, 'loss_val': 0.41737645344817526, 'psi': 0.823093571994457}-{'f1_val': 0.7093864084820859, 'auprc': 0.9935439113135828, 'loss_val': 0.4134156866688516, 'psi': 0.8230494096146846}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=2.187476 cos_to_last_merge=0.9999 (last merge round=30)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9572484045356574, 'auprc': 0.9997433703458353, 'loss_val': 0.12772295128285072, 'psi': 0.9742463908597285}-{'f1_val': 0.9781590718139012, 'auprc': 0.9996655522471416, 'loss_val': 0.10289977102677865, 'psi': 0.9867616639871972}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.640409 cos_to_last_merge=0.9989 (last merge round=29)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9415350417050826, 'auprc': 0.9286957412032115, 'loss_val': 0.2884295943091843, 'psi': 0.9363993215043341}-{'f1_val': 0.9448330915113362, 'auprc': 0.9585146224190918, 'loss_val': 0.27806222873935726, 'psi': 0.9503057038744385}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.319903 cos_to_last_merge=0.9593 (last merge round=25)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.6526029454078159, 'auprc': 0.8545927226284522, 'loss_val': 0.4771084312224853, 'psi': 0.7333988562960705}-{'f1_val': 0.7006083926626743, 'auprc': 0.9859000378084777, 'loss_val': 0.2646455240573346, 'psi': 0.8147250507209957}
[S6] START round=34 head_norm_before_train=1.617089 cos_to_last_merge=0.9754 (last merge round=28)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.7383012992093126, 'auprc': 0.84878167077772, 'loss_val': 0.6808703581719938, 'psi': 0.7824934478366756}-{'f1_val': 0.85907653737991, 'auprc': 0.9696391145879661, 'loss_val': 0.3527948758069241, 'psi': 0.9033015682631325}
[S7] START round=34 head_norm_before_train=1.595579 cos_to_last_merge=0.9978 (last merge round=27)
[S7] round=34 local utility u=0.228718 metrics={'f1_val': 0.6411298535908561, 'auprc': 0.8202908896725194, 'loss_val': 0.49685521536323957, 'psi': 0.7127942680235214}-{'f1_val': 0.600881927353611, 'auprc': 0.7938193019338038, 'loss_val': 0.6333889260216552, 'psi': 0.6780568771856881}
[S8] START round=34 head_norm_before_train=2.192937 cos_to_last_merge=0.9996 (last merge round=29)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9831512712398986, 'auprc': 0.9950885577896224, 'loss_val': 0.06760193484628493, 'psi': 0.9879261858597881}-{'f1_val': 0.9915895183459548, 'auprc': 0.9995589727547729, 'loss_val': 0.03404531973791342, 'psi': 0.9947773001094821}
[S9] START round=34 head_norm_before_train=1.988152 (no previous merge yet)
[S9] round=34 local utility u=0.018782 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9968784248332694, 'loss_val': 0.020985239234658355, 'psi': 0.9967476770216426}-{'f1_val': 0.9912134460920485, 'auprc': 0.9984901513091244, 'loss_val': 0.030702559671920652, 'psi': 0.9941241281788789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=34 head_norm_before_train=2.180454 cos_to_last_merge=0.9987 (last merge round=25)
[S10] round=34 local utility u=0.000111 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9955685045237199, 'loss_val': 0.024871416228112887, 'psi': 0.9952083137285337}-{'f1_val': 0.9949681865317428, 'auprc': 0.995580456526978, 'loss_val': 0.025128786668564877, 'psi': 0.995213094529837}
[S11] START round=34 head_norm_before_train=1.565906 cos_to_last_merge=0.9587 (last merge round=22)
[S11] round=34 local utility u=0.137659 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9946115545456424, 'loss_val': 0.05058932533610868, 'psi': 0.9956277222995735}-{'f1_val': 0.9575446555354004, 'auprc': 0.9959364640785215, 'loss_val': 0.09731810218780847, 'psi': 0.9729013789526488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=34 head_norm_before_train=1.547385 cos_to_last_merge=0.9992 (last merge round=29)
[S13] round=34 local utility u=0.173801 metrics={'f1_val': 0.747044804582549, 'auprc': 0.8173572772158385, 'loss_val': 0.7092812168593228, 'psi': 0.7751697936358648}-{'f1_val': 0.7115314040211451, 'auprc': 0.8163642063439686, 'loss_val': 0.840824518936669, 'psi': 0.7534645249502745}
[S14] START round=34 head_norm_before_train=1.478250 cos_to_last_merge=0.9989 (last merge round=30)
[S14] round=34 local utility u=0.005224 metrics={'f1_val': 0.9956980770517889, 'auprc': 0.9984571387427451, 'loss_val': 0.06139592370746853, 'psi': 0.9968017017281714}-{'f1_val': 0.9946680870156496, 'auprc': 0.9988936615303448, 'loss_val': 0.0669737897738999, 'psi': 0.9963583168215276}
[S15] START round=34 head_norm_before_train=1.484244 cos_to_last_merge=0.9972 (last merge round=29)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.8710600316692182, 'auprc': 0.9933911815236137, 'loss_val': 0.2714202726965244, 'psi': 0.9199924916109764}-{'f1_val': 0.8734806082577358, 'auprc': 0.9950337348987014, 'loss_val': 0.2696832527414002, 'psi': 0.922101858914122}
[S16] START round=34 head_norm_before_train=1.343621 cos_to_last_merge=0.9953 (last merge round=29)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.990505801192455, 'auprc': 0.9778060071985987, 'loss_val': 0.10718481062494926, 'psi': 0.9854258835949126}-{'f1_val': 0.9913593826744562, 'auprc': 0.9809501567223785, 'loss_val': 0.10445235035676663, 'psi': 0.9871956922936251}
[S17] START round=34 head_norm_before_train=1.533201 cos_to_last_merge=0.9917 (last merge round=28)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.557464396862114, 'auprc': 0.7246483025299022, 'loss_val': 1.0946955546073622, 'psi': 0.6243379591292293}-{'f1_val': 0.7611364045040717, 'auprc': 0.8539675698516656, 'loss_val': 0.6656299866590772, 'psi': 0.7982688706431093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.649942 cos_to_last_merge=0.9995 (last merge round=30)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7194279483056333, 'auprc': 0.8118744891490571, 'loss_val': 0.611673680053398, 'psi': 0.7564065646430028}-{'f1_val': 0.7092769260983278, 'auprc': 0.9938185408386506, 'loss_val': 0.41737645344817526, 'psi': 0.823093571994457}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=2.195380 cos_to_last_merge=0.9998 (last merge round=30)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.79825927337037, 'auprc': 0.998894462940334, 'loss_val': 0.41659617703170326, 'psi': 0.8785133491983556}-{'f1_val': 0.9572484045356574, 'auprc': 0.9997433703458353, 'loss_val': 0.12772295128285072, 'psi': 0.9742463908597285}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.652851 cos_to_last_merge=0.9986 (last merge round=29)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9415350417050826, 'auprc': 0.9284281871690236, 'loss_val': 0.2891324003993019, 'psi': 0.936292299890659}-{'f1_val': 0.9415350417050826, 'auprc': 0.9286957412032115, 'loss_val': 0.2884295943091843, 'psi': 0.9363993215043341}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.342813 cos_to_last_merge=0.9559 (last merge round=25)
[S5] round=35 local utility u=1.000000 metrics={'f1_val': 0.9236222201095906, 'auprc': 0.9948698610859497, 'loss_val': 0.1624501991794018, 'psi': 0.9521212765001342}-{'f1_val': 0.6526029454078159, 'auprc': 0.8545927226284522, 'loss_val': 0.4771084312224853, 'psi': 0.7333988562960705}
[S6] START round=35 head_norm_before_train=1.638007 cos_to_last_merge=0.9729 (last merge round=28)
[S6] round=35 local utility u=1.000000 metrics={'f1_val': 0.9349650559843254, 'auprc': 0.9727073538104923, 'loss_val': 0.22013896746314748, 'psi': 0.9500619751147922}-{'f1_val': 0.7383012992093126, 'auprc': 0.84878167077772, 'loss_val': 0.6808703581719938, 'psi': 0.7824934478366756}
[S7] START round=35 head_norm_before_train=1.604997 cos_to_last_merge=0.9972 (last merge round=27)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.6138854115230321, 'auprc': 0.7967915877064073, 'loss_val': 0.6463471509217272, 'psi': 0.6870478819963822}-{'f1_val': 0.6411298535908561, 'auprc': 0.8202908896725194, 'loss_val': 0.49685521536323957, 'psi': 0.7127942680235214}
[S8] START round=35 head_norm_before_train=2.204760 cos_to_last_merge=0.9994 (last merge round=29)
[S8] round=35 local utility u=0.043695 metrics={'f1_val': 0.9931893602624928, 'auprc': 0.9950031495372667, 'loss_val': 0.04018451035935079, 'psi': 0.9939148759724024}-{'f1_val': 0.9831512712398986, 'auprc': 0.9950885577896224, 'loss_val': 0.06760193484628493, 'psi': 0.9879261858597881}
[S9] START round=35 head_norm_before_train=1.998787 (no previous merge yet)
[S9] round=35 local utility u=0.002940 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9985884256923959, 'loss_val': 0.020214784353907188, 'psi': 0.9974295774566051}-{'f1_val': 0.9966605118138915, 'auprc': 0.9968784248332694, 'loss_val': 0.020985239234658355, 'psi': 0.9967476770216426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=35 head_norm_before_train=2.188486 cos_to_last_merge=0.9984 (last merge round=25)
[S10] round=35 local utility u=0.000070 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.995580372421824, 'loss_val': 0.024767684344960336, 'psi': 0.9952130608877753}-{'f1_val': 0.9949681865317428, 'auprc': 0.9955685045237199, 'loss_val': 0.024871416228112887, 'psi': 0.9952083137285337}
[S11] START round=35 head_norm_before_train=1.583147 cos_to_last_merge=0.9566 (last merge round=22)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.8177486825719849, 'auprc': 0.9932587115975513, 'loss_val': 0.28081545319809076, 'psi': 0.8879526941822115}-{'f1_val': 0.996305167468861, 'auprc': 0.9946115545456424, 'loss_val': 0.05058932533610868, 'psi': 0.9956277222995735}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.557997 cos_to_last_merge=0.9990 (last merge round=29)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.607220194168374, 'auprc': 0.6697133479384723, 'loss_val': 1.1956261658524505, 'psi': 0.6322174556764133}-{'f1_val': 0.747044804582549, 'auprc': 0.8173572772158385, 'loss_val': 0.7092812168593228, 'psi': 0.7751697936358648}
[S14] START round=35 head_norm_before_train=1.499126 cos_to_last_merge=0.9982 (last merge round=30)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9891994500538548, 'auprc': 0.9988502481271271, 'loss_val': 0.0634809233206192, 'psi': 0.9930597692831638}-{'f1_val': 0.9956980770517889, 'auprc': 0.9984571387427451, 'loss_val': 0.06139592370746853, 'psi': 0.9968017017281714}
[S15] START round=35 head_norm_before_train=1.516083 cos_to_last_merge=0.9960 (last merge round=29)
[S15] round=35 local utility u=0.414465 metrics={'f1_val': 0.9731611146872898, 'auprc': 0.996287673598572, 'loss_val': 0.06378589140743493, 'psi': 0.9824117382518027}-{'f1_val': 0.8710600316692182, 'auprc': 0.9933911815236137, 'loss_val': 0.2714202726965244, 'psi': 0.9199924916109764}
[S16] START round=35 head_norm_before_train=1.372959 cos_to_last_merge=0.9936 (last merge round=29)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8808480797018035, 'auprc': 0.9871263997369424, 'loss_val': 0.42445500118817653, 'psi': 0.9233594077158591}-{'f1_val': 0.990505801192455, 'auprc': 0.9778060071985987, 'loss_val': 0.10718481062494926, 'psi': 0.9854258835949126}
[S17] START round=35 head_norm_before_train=1.558185 cos_to_last_merge=0.9901 (last merge round=28)
[S17] round=35 local utility u=0.382652 metrics={'f1_val': 0.597938605178329, 'auprc': 0.8549020296768551, 'loss_val': 0.9629986514787238, 'psi': 0.7007239749777394}-{'f1_val': 0.557464396862114, 'auprc': 0.7246483025299022, 'loss_val': 1.0946955546073622, 'psi': 0.6243379591292293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] sending update (kind=head size=1808 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.668456 cos_to_last_merge=0.9992 (last merge round=30)
[S2] round=36 local utility u=0.269690 metrics={'f1_val': 0.7090954436831476, 'auprc': 0.9439906632497999, 'loss_val': 0.4066479156571813, 'psi': 0.8030535315098085}-{'f1_val': 0.7194279483056333, 'auprc': 0.8118744891490571, 'loss_val': 0.611673680053398, 'psi': 0.7564065646430028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=36 head_norm_before_train=2.204209 cos_to_last_merge=0.9997 (last merge round=30)
[S3] round=36 local utility u=0.718143 metrics={'f1_val': 0.9801643632836228, 'auprc': 0.9996797756265252, 'loss_val': 0.07409693581738576, 'psi': 0.9879705282207837}-{'f1_val': 0.79825927337037, 'auprc': 0.998894462940334, 'loss_val': 0.41659617703170326, 'psi': 0.8785133491983556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=36 head_norm_before_train=1.663477 cos_to_last_merge=0.9983 (last merge round=29)
[S4] round=36 local utility u=0.035895 metrics={'f1_val': 0.9426929874635602, 'auprc': 0.9470475283184456, 'loss_val': 0.28014748889426605, 'psi': 0.9444348038055144}-{'f1_val': 0.9415350417050826, 'auprc': 0.9284281871690236, 'loss_val': 0.2891324003993019, 'psi': 0.936292299890659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=36 head_norm_before_train=1.359395 cos_to_last_merge=0.9532 (last merge round=25)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.8539096163982143, 'loss_val': 0.40470074827665714, 'psi': 0.7619560372867412}-{'f1_val': 0.9236222201095906, 'auprc': 0.9948698610859497, 'loss_val': 0.1624501991794018, 'psi': 0.9521212765001342}
[S6] START round=36 head_norm_before_train=1.653306 cos_to_last_merge=0.9710 (last merge round=28)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.8232130837360795, 'auprc': 0.9577930041620786, 'loss_val': 0.5110528099133386, 'psi': 0.8770450519064791}-{'f1_val': 0.9349650559843254, 'auprc': 0.9727073538104923, 'loss_val': 0.22013896746314748, 'psi': 0.9500619751147922}
[S7] START round=36 head_norm_before_train=1.614096 cos_to_last_merge=0.9967 (last merge round=27)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.5669814279589134, 'auprc': 0.7871900137219476, 'loss_val': 0.7822856187740485, 'psi': 0.6550648622641271}-{'f1_val': 0.6138854115230321, 'auprc': 0.7967915877064073, 'loss_val': 0.6463471509217272, 'psi': 0.6870478819963822}
[S8] START round=36 head_norm_before_train=2.207333 cos_to_last_merge=0.9993 (last merge round=29)
[S8] round=36 local utility u=0.014495 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9995523280567187, 'loss_val': 0.029179543258162275, 'psi': 0.9961682960896955}-{'f1_val': 0.9931893602624928, 'auprc': 0.9950031495372667, 'loss_val': 0.04018451035935079, 'psi': 0.9939148759724024}
[S9] START round=36 head_norm_before_train=2.009010 (no previous merge yet)
[S9] round=36 local utility u=0.000506 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9987874233206975, 'loss_val': 0.019800318007211954, 'psi': 0.9975091765079257}-{'f1_val': 0.9966570119660778, 'auprc': 0.9985884256923959, 'loss_val': 0.020214784353907188, 'psi': 0.9974295774566051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=36 head_norm_before_train=2.196822 cos_to_last_merge=0.9981 (last merge round=25)
[S10] round=36 local utility u=0.000110 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9955764372588147, 'loss_val': 0.02453539592146774, 'psi': 0.9952114868225717}-{'f1_val': 0.9949681865317428, 'auprc': 0.995580372421824, 'loss_val': 0.024767684344960336, 'psi': 0.9952130608877753}
[S11] START round=36 head_norm_before_train=1.599382 cos_to_last_merge=0.9549 (last merge round=22)
[S11] round=36 local utility u=0.656455 metrics={'f1_val': 0.996305167468861, 'auprc': 0.995390122561211, 'loss_val': 0.045638409321221, 'psi': 0.995939149505801}-{'f1_val': 0.8177486825719849, 'auprc': 0.9932587115975513, 'loss_val': 0.28081545319809076, 'psi': 0.8879526941822115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=36 head_norm_before_train=1.571029 cos_to_last_merge=0.9986 (last merge round=29)
[S13] round=36 local utility u=0.679005 metrics={'f1_val': 0.6824202733002454, 'auprc': 0.8125010468314133, 'loss_val': 0.7171800248013275, 'psi': 0.7344525827127126}-{'f1_val': 0.607220194168374, 'auprc': 0.6697133479384723, 'loss_val': 1.1956261658524505, 'psi': 0.6322174556764133}
[S14] START round=36 head_norm_before_train=1.518215 cos_to_last_merge=0.9975 (last merge round=30)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.965431624902148, 'auprc': 0.9988573693079157, 'loss_val': 0.06703338611722191, 'psi': 0.9788019226644551}-{'f1_val': 0.9891994500538548, 'auprc': 0.9988502481271271, 'loss_val': 0.0634809233206192, 'psi': 0.9930597692831638}
[S15] START round=36 head_norm_before_train=1.545228 cos_to_last_merge=0.9947 (last merge round=29)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.8748859653746222, 'auprc': 0.9941184061242188, 'loss_val': 0.2758151113660439, 'psi': 0.9225789416744608}-{'f1_val': 0.9731611146872898, 'auprc': 0.996287673598572, 'loss_val': 0.06378589140743493, 'psi': 0.9824117382518027}
[S16] START round=36 head_norm_before_train=1.399228 cos_to_last_merge=0.9918 (last merge round=29)
[S16] round=36 local utility u=0.129885 metrics={'f1_val': 0.9110259284120628, 'auprc': 0.9870541515768128, 'loss_val': 0.3455349247390275, 'psi': 0.9414372176779627}-{'f1_val': 0.8808480797018035, 'auprc': 0.9871263997369424, 'loss_val': 0.42445500118817653, 'psi': 0.9233594077158591}
[S17] START round=36 head_norm_before_train=1.580377 cos_to_last_merge=0.9886 (last merge round=28)
[S17] round=36 local utility u=0.699099 metrics={'f1_val': 0.7981214345154524, 'auprc': 0.8206782756833175, 'loss_val': 0.6632269542192636, 'psi': 0.8071441709825984}-{'f1_val': 0.597938605178329, 'auprc': 0.8549020296768551, 'loss_val': 0.9629986514787238, 'psi': 0.7007239749777394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.685991 cos_to_last_merge=0.9989 (last merge round=30)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.7420025603601378, 'auprc': 0.8470211063577587, 'loss_val': 0.4615577264364974, 'psi': 0.7840099787591861}-{'f1_val': 0.7090954436831476, 'auprc': 0.9439906632497999, 'loss_val': 0.4066479156571813, 'psi': 0.8030535315098085}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=2.215304 cos_to_last_merge=0.9996 (last merge round=30)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.8740322068744244, 'auprc': 0.985746639806637, 'loss_val': 0.23556927384883652, 'psi': 0.9187179800473095}-{'f1_val': 0.9801643632836228, 'auprc': 0.9996797756265252, 'loss_val': 0.07409693581738576, 'psi': 0.9879705282207837}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.671099 cos_to_last_merge=0.9981 (last merge round=29)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9406565059535333, 'auprc': 0.9240458293259822, 'loss_val': 0.2972867086842273, 'psi': 0.9340122353025129}-{'f1_val': 0.9426929874635602, 'auprc': 0.9470475283184456, 'loss_val': 0.28014748889426605, 'psi': 0.9444348038055144}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.376959 cos_to_last_merge=0.9500 (last merge round=25)
[S5] round=37 local utility u=0.006281 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.8539187201982457, 'loss_val': 0.39216678077643247, 'psi': 0.7619596788067537}-{'f1_val': 0.7006536512124258, 'auprc': 0.8539096163982143, 'loss_val': 0.40470074827665714, 'psi': 0.7619560372867412}
[S6] START round=37 head_norm_before_train=1.667067 cos_to_last_merge=0.9692 (last merge round=28)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6701562869452846, 'auprc': 0.7505369700452884, 'loss_val': 0.8822901460533854, 'psi': 0.7023085601852861}-{'f1_val': 0.8232130837360795, 'auprc': 0.9577930041620786, 'loss_val': 0.5110528099133386, 'psi': 0.8770450519064791}
[S7] START round=37 head_norm_before_train=1.622036 cos_to_last_merge=0.9963 (last merge round=27)
[S7] round=37 local utility u=0.450604 metrics={'f1_val': 0.6486023960178454, 'auprc': 0.8240247562394494, 'loss_val': 0.48130823081460966, 'psi': 0.718771340106487}-{'f1_val': 0.5669814279589134, 'auprc': 0.7871900137219476, 'loss_val': 0.7822856187740485, 'psi': 0.6550648622641271}
[S8] START round=37 head_norm_before_train=2.215688 cos_to_last_merge=0.9991 (last merge round=29)
[S8] round=37 local utility u=0.002232 metrics={'f1_val': 0.9944248929832828, 'auprc': 0.9996209342294391, 'loss_val': 0.02799782212781649, 'psi': 0.9965033094817453}-{'f1_val': 0.9939122747783468, 'auprc': 0.9995523280567187, 'loss_val': 0.029179543258162275, 'psi': 0.9961682960896955}
[S9] START round=37 head_norm_before_train=2.020359 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9985052737294658, 'loss_val': 0.02080211769609667, 'psi': 0.9968981405102976}-{'f1_val': 0.9966570119660778, 'auprc': 0.9987874233206975, 'loss_val': 0.019800318007211954, 'psi': 0.9975091765079257}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=2.202080 cos_to_last_merge=0.9976 (last merge round=25)
[S10] round=37 local utility u=0.000094 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9955989399392812, 'loss_val': 0.024415561211402606, 'psi': 0.9952204878947581}-{'f1_val': 0.9949681865317428, 'auprc': 0.9955764372588147, 'loss_val': 0.02453539592146774, 'psi': 0.9952114868225717}
[S11] START round=37 head_norm_before_train=1.615798 cos_to_last_merge=0.9533 (last merge round=22)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9574810798704112, 'auprc': 0.9971270693858089, 'loss_val': 0.10863896113025538, 'psi': 0.9733394756765703}-{'f1_val': 0.996305167468861, 'auprc': 0.995390122561211, 'loss_val': 0.045638409321221, 'psi': 0.995939149505801}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.577875 cos_to_last_merge=0.9983 (last merge round=29)
[S13] round=37 local utility u=0.023147 metrics={'f1_val': 0.6872932622422823, 'auprc': 0.8160252812121138, 'loss_val': 0.7106960907489097, 'psi': 0.7387860698302149}-{'f1_val': 0.6824202733002454, 'auprc': 0.8125010468314133, 'loss_val': 0.7171800248013275, 'psi': 0.7344525827127126}
[S14] START round=37 head_norm_before_train=1.535681 cos_to_last_merge=0.9968 (last merge round=30)
[S14] round=37 local utility u=0.092527 metrics={'f1_val': 0.9940315978965816, 'auprc': 0.9988300457366164, 'loss_val': 0.053496595596690344, 'psi': 0.9959509770325955}-{'f1_val': 0.965431624902148, 'auprc': 0.9988573693079157, 'loss_val': 0.06703338611722191, 'psi': 0.9788019226644551}
[S15] START round=37 head_norm_before_train=1.572223 cos_to_last_merge=0.9935 (last merge round=29)
[S15] round=37 local utility u=0.208305 metrics={'f1_val': 0.9228120573364997, 'auprc': 0.9961203196810735, 'loss_val': 0.1527666319953993, 'psi': 0.9521353622743293}-{'f1_val': 0.8748859653746222, 'auprc': 0.9941184061242188, 'loss_val': 0.2758151113660439, 'psi': 0.9225789416744608}
[S16] START round=37 head_norm_before_train=1.422229 cos_to_last_merge=0.9902 (last merge round=29)
[S16] round=37 local utility u=0.148277 metrics={'f1_val': 0.9373364763826728, 'auprc': 0.9875477485633244, 'loss_val': 0.20832513999580898, 'psi': 0.9574209852549335}-{'f1_val': 0.9110259284120628, 'auprc': 0.9870541515768128, 'loss_val': 0.3455349247390275, 'psi': 0.9414372176779627}
[S17] START round=37 head_norm_before_train=1.598382 cos_to_last_merge=0.9874 (last merge round=28)
[S17] round=37 local utility u=0.358008 metrics={'f1_val': 0.8343932488300652, 'auprc': 0.9321296389304832, 'loss_val': 0.49919613898492277, 'psi': 0.8734878048702324}-{'f1_val': 0.7981214345154524, 'auprc': 0.8206782756833175, 'loss_val': 0.6632269542192636, 'psi': 0.8071441709825984}
[S8]  timeout peer S3
[S14]  timeout peer S11
[S13]  timeout peer S2
[S16]  timeout peer S15
[S7]  timeout peer S4
[S15]  timeout peer S13
[S10]  timeout peer S8
[S5]  timeout peer S16
[S17]  timeout peer S14
[S6]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] START round=38 head_norm_before_train=1.699786 cos_to_last_merge=0.9986 (last merge round=30)
[S2] round=38 local utility u=0.153286 metrics={'f1_val': 0.7106550778996885, 'auprc': 0.990125044999533, 'loss_val': 0.39621272108981365, 'psi': 0.8224430647396264}-{'f1_val': 0.7420025603601378, 'auprc': 0.8470211063577587, 'loss_val': 0.4615577264364974, 'psi': 0.7840099787591861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=38 head_norm_before_train=2.224576 cos_to_last_merge=0.9995 (last merge round=30)
[S3] round=38 local utility u=0.445074 metrics={'f1_val': 0.9865015805273158, 'auprc': 0.9997517223765745, 'loss_val': 0.06225351259317961, 'psi': 0.9918016372670193}-{'f1_val': 0.8740322068744244, 'auprc': 0.985746639806637, 'loss_val': 0.23556927384883652, 'psi': 0.9187179800473095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=38 head_norm_before_train=1.681820 cos_to_last_merge=0.9977 (last merge round=29)
[S4] round=38 local utility u=0.052936 metrics={'f1_val': 0.9467063892308115, 'auprc': 0.9455373074637493, 'loss_val': 0.2921883714427167, 'psi': 0.9462387565239866}-{'f1_val': 0.9406565059535333, 'auprc': 0.9240458293259822, 'loss_val': 0.2972867086842273, 'psi': 0.9340122353025129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=38 head_norm_before_train=1.389281 cos_to_last_merge=0.9476 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.948
[S5] round=38 local utility u=0.256472 metrics={'f1_val': 0.7007406076076139, 'auprc': 0.9854680258331621, 'loss_val': 0.27439187652926755, 'psi': 0.8146315748978332}-{'f1_val': 0.7006536512124258, 'auprc': 0.8539187201982457, 'loss_val': 0.39216678077643247, 'psi': 0.7619596788067537}
[S5] not sending this round → trigger blocked (psi=0.815)
[S6] START round=38 head_norm_before_train=1.679178 cos_to_last_merge=0.9674 (last merge round=28)
[S6] round=38 local utility u=0.534171 metrics={'f1_val': 0.7440396527230675, 'auprc': 0.9007779315380631, 'loss_val': 0.7079702366743533, 'psi': 0.8067349642490658}-{'f1_val': 0.6701562869452846, 'auprc': 0.7505369700452884, 'loss_val': 0.8822901460533854, 'psi': 0.7023085601852861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=38 head_norm_before_train=1.628218 cos_to_last_merge=0.9959 (last merge round=27)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6455305884982451, 'auprc': 0.8104917669538344, 'loss_val': 0.506789049520545, 'psi': 0.7115150598804808}-{'f1_val': 0.6486023960178454, 'auprc': 0.8240247562394494, 'loss_val': 0.48130823081460966, 'psi': 0.718771340106487}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=2.226252 cos_to_last_merge=0.9989 (last merge round=29)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.990363285929422, 'auprc': 0.9995992988989685, 'loss_val': 0.03424818984273242, 'psi': 0.9940576911172406}-{'f1_val': 0.9944248929832828, 'auprc': 0.9996209342294391, 'loss_val': 0.02799782212781649, 'psi': 0.9965033094817453}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=2.028656 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9890975148541, 'auprc': 0.9987335038433428, 'loss_val': 0.035491327412289005, 'psi': 0.9929519104497971}-{'f1_val': 0.9958267183641853, 'auprc': 0.9985052737294658, 'loss_val': 0.02080211769609667, 'psi': 0.9968981405102976}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=2.211302 cos_to_last_merge=0.9974 (last merge round=25)
[S10] round=38 local utility u=0.000041 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956195281526087, 'loss_val': 0.02439460663896769, 'psi': 0.9952287231800891}-{'f1_val': 0.9949681865317428, 'auprc': 0.9955989399392812, 'loss_val': 0.024415561211402606, 'psi': 0.9952204878947581}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=38 head_norm_before_train=1.630461 cos_to_last_merge=0.9518 (last merge round=22)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9572392428256826, 'auprc': 0.9970086427790986, 'loss_val': 0.1072508433473003, 'psi': 0.973147002807049}-{'f1_val': 0.9574810798704112, 'auprc': 0.9971270693858089, 'loss_val': 0.10863896113025538, 'psi': 0.9733394756765703}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.583618 cos_to_last_merge=0.9981 (last merge round=29)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6170447217864403, 'auprc': 0.7544490629825535, 'loss_val': 1.0167462584472635, 'psi': 0.6720064582648856}-{'f1_val': 0.6872932622422823, 'auprc': 0.8160252812121138, 'loss_val': 0.7106960907489097, 'psi': 0.7387860698302149}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.550410 cos_to_last_merge=0.9961 (last merge round=30)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9840699165965805, 'auprc': 0.9988261320525754, 'loss_val': 0.054466163784811825, 'psi': 0.9899724027789785}-{'f1_val': 0.9940315978965816, 'auprc': 0.9988300457366164, 'loss_val': 0.053496595596690344, 'psi': 0.9959509770325955}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.596401 cos_to_last_merge=0.9924 (last merge round=29)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.8979836562863579, 'auprc': 0.9959516475662394, 'loss_val': 0.21423922274713225, 'psi': 0.9371708527983105}-{'f1_val': 0.9228120573364997, 'auprc': 0.9961203196810735, 'loss_val': 0.1527666319953993, 'psi': 0.9521353622743293}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.441153 cos_to_last_merge=0.9889 (last merge round=29)
[S16] round=38 local utility u=0.226739 metrics={'f1_val': 0.9913593826744562, 'auprc': 0.9840994015746515, 'loss_val': 0.06863876577981207, 'psi': 0.9884553902345343}-{'f1_val': 0.9373364763826728, 'auprc': 0.9875477485633244, 'loss_val': 0.20832513999580898, 'psi': 0.9574209852549335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=38 head_norm_before_train=1.616967 cos_to_last_merge=0.9861 (last merge round=28)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.5235313460487521, 'auprc': 0.7030586002182826, 'loss_val': 1.2515351955660958, 'psi': 0.5953422477165642}-{'f1_val': 0.8343932488300652, 'auprc': 0.9321296389304832, 'loss_val': 0.49919613898492277, 'psi': 0.8734878048702324}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.717528 cos_to_last_merge=0.9982 (last merge round=30)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.7104733441144288, 'auprc': 0.9889406912734381, 'loss_val': 0.42635759874992457, 'psi': 0.8218602829780325}-{'f1_val': 0.7106550778996885, 'auprc': 0.990125044999533, 'loss_val': 0.39621272108981365, 'psi': 0.8224430647396264}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.822 u=0.0000 p_local=0.0959 f1=0.710 auprc=0.989 bytes=37788
[S3] START round=39 head_norm_before_train=2.232368 cos_to_last_merge=0.9993 (last merge round=30)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9627708845729153, 'auprc': 0.999651800597274, 'loss_val': 0.0832710024818469, 'psi': 0.9775232509826588}-{'f1_val': 0.9865015805273158, 'auprc': 0.9997517223765745, 'loss_val': 0.06225351259317961, 'psi': 0.9918016372670193}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.978 u=0.0000 p_local=0.2050 f1=0.963 auprc=1.000 bytes=43130
[S4] START round=39 head_norm_before_train=1.693475 cos_to_last_merge=0.9973 (last merge round=29)
[S4] round=39 local utility u=0.053357 metrics={'f1_val': 0.9457709850236592, 'auprc': 0.978967273827845, 'loss_val': 0.2801517363532937, 'psi': 0.9590495005453334}-{'f1_val': 0.9467063892308115, 'auprc': 0.9455373074637493, 'loss_val': 0.2921883714427167, 'psi': 0.9462387565239866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S4] r=40 psi=0.959 u=0.0534 p_local=0.0285 f1=0.946 auprc=0.979 bytes=39629
[S5] START round=39 head_norm_before_train=1.398990 cos_to_last_merge=0.9458 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.946
[S5] round=39 local utility u=0.262925 metrics={'f1_val': 0.8057335433614672, 'auprc': 0.9560340107307236, 'loss_val': 0.2901973692147429, 'psi': 0.8658537303091698}-{'f1_val': 0.7007406076076139, 'auprc': 0.9854680258331621, 'loss_val': 0.27439187652926755, 'psi': 0.8146315748978332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S5] r=40 psi=0.866 u=0.2629 p_local=0.2434 f1=0.806 auprc=0.956 bytes=50331
[S6] START round=39 head_norm_before_train=1.691097 cos_to_last_merge=0.9657 (last merge round=28)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.7367903133187851, 'auprc': 0.9210598742665599, 'loss_val': 0.7684273284448989, 'psi': 0.810498137697895}-{'f1_val': 0.7440396527230675, 'auprc': 0.9007779315380631, 'loss_val': 0.7079702366743533, 'psi': 0.8067349642490658}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.810 u=0.0000 p_local=0.2163 f1=0.737 auprc=0.921 bytes=39598
[S7] START round=39 head_norm_before_train=1.638590 cos_to_last_merge=0.9950 (last merge round=27)
[S7] round=39 local utility u=0.031735 metrics={'f1_val': 0.6550172023049794, 'auprc': 0.8066304448867209, 'loss_val': 0.4886545530226606, 'psi': 0.715662499337676}-{'f1_val': 0.6455305884982451, 'auprc': 0.8104917669538344, 'loss_val': 0.506789049520545, 'psi': 0.7115150598804808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S7] r=40 psi=0.716 u=0.0317 p_local=0.1470 f1=0.655 auprc=0.807 bytes=45001
[S8] START round=39 head_norm_before_train=2.236373 cos_to_last_merge=0.9987 (last merge round=29)
[S8] round=39 local utility u=0.011370 metrics={'f1_val': 0.9931116891849937, 'auprc': 0.9997746455028432, 'loss_val': 0.02852527108166345, 'psi': 0.9957768717121336}-{'f1_val': 0.990363285929422, 'auprc': 0.9995992988989685, 'loss_val': 0.03424818984273242, 'psi': 0.9940576911172406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S8] r=40 psi=0.996 u=0.0114 p_local=0.0359 f1=0.993 auprc=1.000 bytes=44953
[S9] START round=39 head_norm_before_train=2.037151 (no previous merge yet)
[S9] round=39 local utility u=0.030956 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9986684685770095, 'loss_val': 0.018934378172151625, 'psi': 0.9974808764095069}-{'f1_val': 0.9890975148541, 'auprc': 0.9987335038433428, 'loss_val': 0.035491327412289005, 'psi': 0.9929519104497971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S9] r=40 psi=0.997 u=0.0310 p_local=0.0105 f1=0.997 auprc=0.999 bytes=44968
[S10] START round=39 head_norm_before_train=2.221635 cos_to_last_merge=0.9972 (last merge round=25)
[S10] round=39 local utility u=0.000068 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956167042080624, 'loss_val': 0.024250879121058274, 'psi': 0.9952275936022706}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956195281526087, 'loss_val': 0.02439460663896769, 'psi': 0.9952287231800891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S10] r=40 psi=0.995 u=0.0001 p_local=0.0008 f1=0.995 auprc=0.996 bytes=61156
[S11] START round=39 head_norm_before_train=1.644407 cos_to_last_merge=0.9504 (last merge round=22)
[S11] round=39 local utility u=0.145175 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9946138550099948, 'loss_val': 0.04320636195362434, 'psi': 0.9955380268504451}-{'f1_val': 0.9572392428256826, 'auprc': 0.9970086427790986, 'loss_val': 0.1072508433473003, 'psi': 0.973147002807049}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S11] r=40 psi=0.996 u=0.1452 p_local=0.1192 f1=0.996 auprc=0.995 bytes=46778
[S13] START round=39 head_norm_before_train=1.590745 cos_to_last_merge=0.9978 (last merge round=29)
[S13] round=39 local utility u=0.130434 metrics={'f1_val': 0.6672493883952844, 'auprc': 0.7326707842638577, 'loss_val': 0.991770859040902, 'psi': 0.6934179467427137}-{'f1_val': 0.6170447217864403, 'auprc': 0.7544490629825535, 'loss_val': 1.0167462584472635, 'psi': 0.6720064582648856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S13] r=40 psi=0.693 u=0.1304 p_local=0.1430 f1=0.667 auprc=0.733 bytes=43147
[S14] START round=39 head_norm_before_train=1.564309 cos_to_last_merge=0.9954 (last merge round=30)
[S14] round=39 local utility u=0.048509 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9988356633697304, 'loss_val': 0.037375555773879354, 'psi': 0.997966022336641}-{'f1_val': 0.9840699165965805, 'auprc': 0.9988261320525754, 'loss_val': 0.054466163784811825, 'psi': 0.9899724027789785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S14] r=40 psi=0.998 u=0.0485 p_local=0.0309 f1=0.997 auprc=0.999 bytes=48601
[S15] START round=39 head_norm_before_train=1.618471 cos_to_last_merge=0.9914 (last merge round=29)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.893878272739659, 'auprc': 0.9940895205222366, 'loss_val': 0.2273536436302371, 'psi': 0.93396277185269}-{'f1_val': 0.8979836562863579, 'auprc': 0.9959516475662394, 'loss_val': 0.21423922274713225, 'psi': 0.9371708527983105}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.934 u=0.0000 p_local=0.1405 f1=0.894 auprc=0.994 bytes=41311
[S16] START round=39 head_norm_before_train=1.460831 cos_to_last_merge=0.9874 (last merge round=29)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9810813713556347, 'auprc': 0.9774134346974385, 'loss_val': 0.12605381851579656, 'psi': 0.9796141966923562}-{'f1_val': 0.9913593826744562, 'auprc': 0.9840994015746515, 'loss_val': 0.06863876577981207, 'psi': 0.9884553902345343}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.980 u=0.0000 p_local=0.1102 f1=0.981 auprc=0.977 bytes=41398
[S17] START round=39 head_norm_before_train=1.635702 cos_to_last_merge=0.9847 (last merge round=28)
[S17] round=39 local utility u=1.000000 metrics={'f1_val': 0.9187826217185804, 'auprc': 0.9922351730966619, 'loss_val': 0.26698343062387087, 'psi': 0.948163642269813}-{'f1_val': 0.5235313460487521, 'auprc': 0.7030586002182826, 'loss_val': 1.2515351955660958, 'psi': 0.5953422477165642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S17] r=40 psi=0.948 u=1.0000 p_local=0.4302 f1=0.919 auprc=0.992 bytes=46780
[S2] START round=40 head_norm_before_train=1.736826 cos_to_last_merge=0.9979 (last merge round=30)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.7098509592732637, 'auprc': 0.9761434112080051, 'loss_val': 0.45295344808314364, 'psi': 0.8163679400471603}-{'f1_val': 0.7104733441144288, 'auprc': 0.9889406912734381, 'loss_val': 0.42635759874992457, 'psi': 0.8218602829780325}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.242150 cos_to_last_merge=0.9992 (last merge round=30)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9598249048656969, 'auprc': 0.9996054097392042, 'loss_val': 0.11180724635081214, 'psi': 0.9757371068150998}-{'f1_val': 0.9627708845729153, 'auprc': 0.999651800597274, 'loss_val': 0.0832710024818469, 'psi': 0.9775232509826588}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.702220 cos_to_last_merge=0.9969 (last merge round=29)
[S4] round=40 local utility u=0.010731 metrics={'f1_val': 0.9510730589857624, 'auprc': 0.9760680152727339, 'loss_val': 0.2818041475245339, 'psi': 0.961071041500551}-{'f1_val': 0.9457709850236592, 'auprc': 0.978967273827845, 'loss_val': 0.2801517363532937, 'psi': 0.9590495005453334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=40 head_norm_before_train=1.407983 cos_to_last_merge=0.9442 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.944
[S5] round=40 local utility u=0.666069 metrics={'f1_val': 0.9874756741080561, 'auprc': 0.9978321362916402, 'loss_val': 0.17390637040355508, 'psi': 0.9916182589814898}-{'f1_val': 0.8057335433614672, 'auprc': 0.9560340107307236, 'loss_val': 0.2901973692147429, 'psi': 0.8658537303091698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=40 head_norm_before_train=1.709525 cos_to_last_merge=0.9636 (last merge round=28)
[S6] round=40 local utility u=0.435861 metrics={'f1_val': 0.8199256387651915, 'auprc': 0.9649280542499177, 'loss_val': 0.5271221444770441, 'psi': 0.877926604959082}-{'f1_val': 0.7367903133187851, 'auprc': 0.9210598742665599, 'loss_val': 0.7684273284448989, 'psi': 0.810498137697895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=40 head_norm_before_train=1.646739 cos_to_last_merge=0.9940 (last merge round=27)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6033079277007898, 'auprc': 0.78867063280275, 'loss_val': 0.6374054348309742, 'psi': 0.6774530097415739}-{'f1_val': 0.6550172023049794, 'auprc': 0.8066304448867209, 'loss_val': 0.4886545530226606, 'psi': 0.715662499337676}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=2.240595 cos_to_last_merge=0.9985 (last merge round=29)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9912267239616498, 'auprc': 0.9995846858458237, 'loss_val': 0.03473643891938671, 'psi': 0.9945699087153194}-{'f1_val': 0.9931116891849937, 'auprc': 0.9997746455028432, 'loss_val': 0.02852527108166345, 'psi': 0.9957768717121336}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=2.045295 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9984940237146702, 'loss_val': 0.0189873631927768, 'psi': 0.9971602269241118}-{'f1_val': 0.9966891482978385, 'auprc': 0.9986684685770095, 'loss_val': 0.018934378172151625, 'psi': 0.9974808764095069}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.232312 cos_to_last_merge=0.9970 (last merge round=25)
[S10] round=40 local utility u=0.000148 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956468908163725, 'loss_val': 0.024045426970547762, 'psi': 0.9952396682455946}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956167042080624, 'loss_val': 0.024250879121058274, 'psi': 0.9952275936022706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=40 head_norm_before_train=1.655737 cos_to_last_merge=0.9492 (last merge round=22)
[S11] ⚠️ Model drifted since last merge! cos=0.949
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9789697769591135, 'auprc': 0.9943025586706274, 'loss_val': 0.09989865116087025, 'psi': 0.9851028896437191}-{'f1_val': 0.9961541414107454, 'auprc': 0.9946138550099948, 'loss_val': 0.04320636195362434, 'psi': 0.9955380268504451}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.604927 cos_to_last_merge=0.9972 (last merge round=29)
[S13] round=40 local utility u=0.139250 metrics={'f1_val': 0.6705993161843435, 'auprc': 0.7637863437090171, 'loss_val': 0.826716842910738, 'psi': 0.7078741271942129}-{'f1_val': 0.6672493883952844, 'auprc': 0.7326707842638577, 'loss_val': 0.991770859040902, 'psi': 0.6934179467427137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=40 head_norm_before_train=1.578107 cos_to_last_merge=0.9947 (last merge round=30)
[S14] round=40 local utility u=0.000474 metrics={'f1_val': 0.9971687801929319, 'auprc': 0.9987974731022743, 'loss_val': 0.03500861737664641, 'psi': 0.9978202573566688}-{'f1_val': 0.9973862616479148, 'auprc': 0.9988356633697304, 'loss_val': 0.037375555773879354, 'psi': 0.997966022336641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=40 head_norm_before_train=1.637562 cos_to_last_merge=0.9905 (last merge round=29)
[S15] round=40 local utility u=0.414136 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.997227992360803, 'loss_val': 0.02570672240248256, 'psi': 0.9969391979768335}-{'f1_val': 0.893878272739659, 'auprc': 0.9940895205222366, 'loss_val': 0.2273536436302371, 'psi': 0.93396277185269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=40 head_norm_before_train=1.480663 cos_to_last_merge=0.9859 (last merge round=29)
[S16] round=40 local utility u=0.063729 metrics={'f1_val': 0.9906535232766942, 'auprc': 0.9800330681362415, 'loss_val': 0.0638877791620879, 'psi': 0.9864053412205132}-{'f1_val': 0.9810813713556347, 'auprc': 0.9774134346974385, 'loss_val': 0.12605381851579656, 'psi': 0.9796141966923562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=40 head_norm_before_train=1.651016 cos_to_last_merge=0.9836 (last merge round=28)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6104636199096307, 'auprc': 0.8356020768835877, 'loss_val': 1.0594441000985142, 'psi': 0.7005190026992135}-{'f1_val': 0.9187826217185804, 'auprc': 0.9922351730966619, 'loss_val': 0.26698343062387087, 'psi': 0.948163642269813}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.752725 cos_to_last_merge=0.9975 (last merge round=30)
[S2] round=41 local utility u=0.016738 metrics={'f1_val': 0.7099234788438289, 'auprc': 0.984834439442694, 'loss_val': 0.44598562733942193, 'psi': 0.8198878630833749}-{'f1_val': 0.7098509592732637, 'auprc': 0.9761434112080051, 'loss_val': 0.45295344808314364, 'psi': 0.8163679400471603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=41 head_norm_before_train=2.254147 cos_to_last_merge=0.9989 (last merge round=30)
[S3] round=41 local utility u=0.042927 metrics={'f1_val': 0.9656310509622777, 'auprc': 0.999811579978042, 'loss_val': 0.06140887569860982, 'psi': 0.9793032625685835}-{'f1_val': 0.9598249048656969, 'auprc': 0.9996054097392042, 'loss_val': 0.11180724635081214, 'psi': 0.9757371068150998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=41 head_norm_before_train=1.710553 cos_to_last_merge=0.9965 (last merge round=29)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.949350404795848, 'auprc': 0.9603885046959832, 'loss_val': 0.29398368914680956, 'psi': 0.953765644755902}-{'f1_val': 0.9510730589857624, 'auprc': 0.9760680152727339, 'loss_val': 0.2818041475245339, 'psi': 0.961071041500551}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.416252 cos_to_last_merge=0.9429 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.943
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.43728526697303427, 'auprc': 0.8534858646086142, 'loss_val': 0.9038689019083842, 'psi': 0.6037655060272662}-{'f1_val': 0.9874756741080561, 'auprc': 0.9978321362916402, 'loss_val': 0.17390637040355508, 'psi': 0.9916182589814898}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.727275 cos_to_last_merge=0.9617 (last merge round=28)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.5975217744200662, 'auprc': 0.9492758027589117, 'loss_val': 0.9248669054636494, 'psi': 0.7382233857556044}-{'f1_val': 0.8199256387651915, 'auprc': 0.9649280542499177, 'loss_val': 0.5271221444770441, 'psi': 0.877926604959082}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.654463 cos_to_last_merge=0.9936 (last merge round=27)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.6011982292031798, 'auprc': 0.789034007379158, 'loss_val': 0.6543795296462607, 'psi': 0.676332540473571}-{'f1_val': 0.6033079277007898, 'auprc': 0.78867063280275, 'loss_val': 0.6374054348309742, 'psi': 0.6774530097415739}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=2.247559 cos_to_last_merge=0.9983 (last merge round=29)
[S8] round=41 local utility u=0.010314 metrics={'f1_val': 0.9933329447925694, 'auprc': 0.9996913581066955, 'loss_val': 0.027065422100880143, 'psi': 0.9958763101182198}-{'f1_val': 0.9912267239616498, 'auprc': 0.9995846858458237, 'loss_val': 0.03473643891938671, 'psi': 0.9945699087153194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=41 head_norm_before_train=2.054058 (no previous merge yet)
[S9] round=41 local utility u=0.002744 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984575418948676, 'loss_val': 0.018382118241748336, 'psi': 0.9976447642652327}-{'f1_val': 0.9962710290637395, 'auprc': 0.9984940237146702, 'loss_val': 0.0189873631927768, 'psi': 0.9971602269241118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=41 head_norm_before_train=2.236829 cos_to_last_merge=0.9965 (last merge round=25)
[S10] round=41 local utility u=0.000210 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9957123538378633, 'loss_val': 0.023822129540547774, 'psi': 0.9952658534541909}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956468908163725, 'loss_val': 0.024045426970547762, 'psi': 0.9952396682455946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=41 head_norm_before_train=1.667787 cos_to_last_merge=0.9480 (last merge round=22)
[S11] ⚠️ Model drifted since last merge! cos=0.948
[S11] round=41 local utility u=0.085588 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9950657139963273, 'loss_val': 0.03502399706898249, 'psi': 0.9958093860798475}-{'f1_val': 0.9789697769591135, 'auprc': 0.9943025586706274, 'loss_val': 0.09989865116087025, 'psi': 0.9851028896437191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=41 head_norm_before_train=1.622272 cos_to_last_merge=0.9965 (last merge round=29)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6458422220195129, 'auprc': 0.6889729456609743, 'loss_val': 1.0806331424267792, 'psi': 0.6630945114760974}-{'f1_val': 0.6705993161843435, 'auprc': 0.7637863437090171, 'loss_val': 0.826716842910738, 'psi': 0.7078741271942129}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.592049 cos_to_last_merge=0.9940 (last merge round=30)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9975545343417789, 'auprc': 0.9988167523495735, 'loss_val': 0.041336041252329564, 'psi': 0.9980594215448968}-{'f1_val': 0.9971687801929319, 'auprc': 0.9987974731022743, 'loss_val': 0.03500861737664641, 'psi': 0.9978202573566688}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.655564 cos_to_last_merge=0.9897 (last merge round=29)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.9600086939994606, 'auprc': 0.9955379776772832, 'loss_val': 0.08103933920522882, 'psi': 0.9742204074705897}-{'f1_val': 0.9967466683875206, 'auprc': 0.997227992360803, 'loss_val': 0.02570672240248256, 'psi': 0.9969391979768335}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.499621 cos_to_last_merge=0.9844 (last merge round=29)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9789778818223658, 'auprc': 0.985031112738125, 'loss_val': 0.09415317369295276, 'psi': 0.9813991741886695}-{'f1_val': 0.9906535232766942, 'auprc': 0.9800330681362415, 'loss_val': 0.0638877791620879, 'psi': 0.9864053412205132}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.664441 cos_to_last_merge=0.9824 (last merge round=28)
[S17] round=41 local utility u=1.000000 metrics={'f1_val': 0.9058851907225371, 'auprc': 0.8970823908980549, 'loss_val': 0.3922137276387511, 'psi': 0.9023640707927443}-{'f1_val': 0.6104636199096307, 'auprc': 0.8356020768835877, 'loss_val': 1.0594441000985142, 'psi': 0.7005190026992135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=42 head_norm_before_train=1.763710 cos_to_last_merge=0.9972 (last merge round=30)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.6566729622244653, 'auprc': 0.7812304077854347, 'loss_val': 1.233835774630052, 'psi': 0.7064959404488531}-{'f1_val': 0.7099234788438289, 'auprc': 0.984834439442694, 'loss_val': 0.44598562733942193, 'psi': 0.8198878630833749}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=2.265444 cos_to_last_merge=0.9986 (last merge round=30)
[S3] round=42 local utility u=0.035748 metrics={'f1_val': 0.9784683674088674, 'auprc': 0.9995148990677986, 'loss_val': 0.06604636646757768, 'psi': 0.9868869800724398}-{'f1_val': 0.9656310509622777, 'auprc': 0.999811579978042, 'loss_val': 0.06140887569860982, 'psi': 0.9793032625685835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=42 head_norm_before_train=1.717537 cos_to_last_merge=0.9962 (last merge round=29)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9501409781576389, 'auprc': 0.9536162274440952, 'loss_val': 0.29289013601048164, 'psi': 0.9515310778722215}-{'f1_val': 0.949350404795848, 'auprc': 0.9603885046959832, 'loss_val': 0.29398368914680956, 'psi': 0.953765644755902}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.424347 cos_to_last_merge=0.9421 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.942
[S5] round=42 local utility u=1.000000 metrics={'f1_val': 0.9452636813969948, 'auprc': 0.9927222478090694, 'loss_val': 0.1440501883882149, 'psi': 0.9642471079618247}-{'f1_val': 0.43728526697303427, 'auprc': 0.8534858646086142, 'loss_val': 0.9038689019083842, 'psi': 0.6037655060272662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=42 head_norm_before_train=1.742315 cos_to_last_merge=0.9594 (last merge round=28)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.6229891996968603, 'auprc': 0.7638841590029262, 'loss_val': 0.9808705264154643, 'psi': 0.6793471834192866}-{'f1_val': 0.5975217744200662, 'auprc': 0.9492758027589117, 'loss_val': 0.9248669054636494, 'psi': 0.7382233857556044}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.661995 cos_to_last_merge=0.9930 (last merge round=27)
[S7] round=42 local utility u=0.178597 metrics={'f1_val': 0.6418996973818832, 'auprc': 0.798382136006579, 'loss_val': 0.5694382148769196, 'psi': 0.7044926728317615}-{'f1_val': 0.6011982292031798, 'auprc': 0.789034007379158, 'loss_val': 0.6543795296462607, 'psi': 0.676332540473571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=42 head_norm_before_train=2.256413 cos_to_last_merge=0.9981 (last merge round=29)
[S8] round=42 local utility u=0.000876 metrics={'f1_val': 0.9933329447925694, 'auprc': 0.9996291092252998, 'loss_val': 0.02512705862761555, 'psi': 0.9958514105656615}-{'f1_val': 0.9933329447925694, 'auprc': 0.9996913581066955, 'loss_val': 0.027065422100880143, 'psi': 0.9958763101182198}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=42 head_norm_before_train=2.063318 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984960772991374, 'loss_val': 0.01861519836493893, 'psi': 0.9968944619381662}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984575418948676, 'loss_val': 0.018382118241748336, 'psi': 0.9976447642652327}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.240718 cos_to_last_merge=0.9959 (last merge round=25)
[S10] round=42 local utility u=0.000124 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.995745894329541, 'loss_val': 0.02367459855053435, 'psi': 0.9952792696508621}-{'f1_val': 0.9949681865317428, 'auprc': 0.9957123538378633, 'loss_val': 0.023822129540547774, 'psi': 0.9952658534541909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=42 head_norm_before_train=1.680222 cos_to_last_merge=0.9469 (last merge round=22)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9919905653104087, 'auprc': 0.99493762547127, 'loss_val': 0.041438060990648506, 'psi': 0.9931693893747532}-{'f1_val': 0.996305167468861, 'auprc': 0.9950657139963273, 'loss_val': 0.03502399706898249, 'psi': 0.9958093860798475}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.635849 cos_to_last_merge=0.9960 (last merge round=29)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6239099232735067, 'auprc': 0.6506827524572859, 'loss_val': 1.2294467370312052, 'psi': 0.6346190549470184}-{'f1_val': 0.6458422220195129, 'auprc': 0.6889729456609743, 'loss_val': 1.0806331424267792, 'psi': 0.6630945114760974}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.604820 cos_to_last_merge=0.9935 (last merge round=30)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9987276795531124, 'loss_val': 0.044757879988979975, 'psi': 0.9980369966991958}-{'f1_val': 0.9975545343417789, 'auprc': 0.9988167523495735, 'loss_val': 0.041336041252329564, 'psi': 0.9980594215448968}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.672830 cos_to_last_merge=0.9888 (last merge round=29)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.903170176196454, 'auprc': 0.9940707130583762, 'loss_val': 0.19961661559574295, 'psi': 0.9395303909412229}-{'f1_val': 0.9600086939994606, 'auprc': 0.9955379776772832, 'loss_val': 0.08103933920522882, 'psi': 0.9742204074705897}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.516195 cos_to_last_merge=0.9831 (last merge round=29)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9366930117539796, 'auprc': 0.9873044100000793, 'loss_val': 0.23367369036776012, 'psi': 0.9569375710524195}-{'f1_val': 0.9789778818223658, 'auprc': 0.985031112738125, 'loss_val': 0.09415317369295276, 'psi': 0.9813991741886695}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.676820 cos_to_last_merge=0.9815 (last merge round=28)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.5169444234804967, 'auprc': 0.6837800863125312, 'loss_val': 1.378416667325606, 'psi': 0.5836786886133105}-{'f1_val': 0.9058851907225371, 'auprc': 0.8970823908980549, 'loss_val': 0.3922137276387511, 'psi': 0.9023640707927443}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.774916 cos_to_last_merge=0.9969 (last merge round=30)
[S2] round=43 local utility u=0.889389 metrics={'f1_val': 0.7165927592663566, 'auprc': 0.9933660645678919, 'loss_val': 0.45098369470065935, 'psi': 0.8273020813869707}-{'f1_val': 0.6566729622244653, 'auprc': 0.7812304077854347, 'loss_val': 1.233835774630052, 'psi': 0.7064959404488531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=43 head_norm_before_train=2.277482 cos_to_last_merge=0.9983 (last merge round=30)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.7842802720353892, 'auprc': 0.9986535084072578, 'loss_val': 0.4272654922720245, 'psi': 0.8700295665841367}-{'f1_val': 0.9784683674088674, 'auprc': 0.9995148990677986, 'loss_val': 0.06604636646757768, 'psi': 0.9868869800724398}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.724628 cos_to_last_merge=0.9959 (last merge round=29)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9473388460262228, 'auprc': 0.9478813242825158, 'loss_val': 0.29697258652624564, 'psi': 0.94755583732874}-{'f1_val': 0.9501409781576389, 'auprc': 0.9536162274440952, 'loss_val': 0.29289013601048164, 'psi': 0.9515310778722215}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.430425 cos_to_last_merge=0.9415 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.942
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.6941436550349898, 'auprc': 0.857640210180363, 'loss_val': 0.40152997281931635, 'psi': 0.759542277093139}-{'f1_val': 0.9452636813969948, 'auprc': 0.9927222478090694, 'loss_val': 0.1440501883882149, 'psi': 0.9642471079618247}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.756055 cos_to_last_merge=0.9577 (last merge round=28)
[S6] round=43 local utility u=0.313619 metrics={'f1_val': 0.6188229411810398, 'auprc': 0.9471214023638005, 'loss_val': 0.878347137062293, 'psi': 0.7501423256541441}-{'f1_val': 0.6229891996968603, 'auprc': 0.7638841590029262, 'loss_val': 0.9808705264154643, 'psi': 0.6793471834192866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=43 head_norm_before_train=1.667787 cos_to_last_merge=0.9924 (last merge round=27)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.6128347389593716, 'auprc': 0.789046738371211, 'loss_val': 0.6411173715988301, 'psi': 0.6833195387241073}-{'f1_val': 0.6418996973818832, 'auprc': 0.798382136006579, 'loss_val': 0.5694382148769196, 'psi': 0.7044926728317615}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=2.267970 cos_to_last_merge=0.9979 (last merge round=29)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9925279616884268, 'auprc': 0.998170544399574, 'loss_val': 0.046001729379927976, 'psi': 0.9947849947728857}-{'f1_val': 0.9933329447925694, 'auprc': 0.9996291092252998, 'loss_val': 0.02512705862761555, 'psi': 0.9958514105656615}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=2.071228 (no previous merge yet)
[S9] round=43 local utility u=0.003084 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998836349453523, 'loss_val': 0.018470192747398483, 'psi': 0.997530846869744}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984960772991374, 'loss_val': 0.01861519836493893, 'psi': 0.9968944619381662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=43 head_norm_before_train=2.244536 cos_to_last_merge=0.9952 (last merge round=25)
[S10] round=43 local utility u=0.000305 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9958884213574756, 'loss_val': 0.023491618404547467, 'psi': 0.9953362804620359}-{'f1_val': 0.9949681865317428, 'auprc': 0.995745894329541, 'loss_val': 0.02367459855053435, 'psi': 0.9952792696508621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=43 head_norm_before_train=1.691447 cos_to_last_merge=0.9459 (last merge round=22)
[S11] ⚠️ Model drifted since last merge! cos=0.946
[S11] round=43 local utility u=0.016798 metrics={'f1_val': 0.996305167468861, 'auprc': 0.994935830195451, 'loss_val': 0.03372498978904831, 'psi': 0.9957574325594969}-{'f1_val': 0.9919905653104087, 'auprc': 0.99493762547127, 'loss_val': 0.041438060990648506, 'psi': 0.9931693893747532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=43 head_norm_before_train=1.646615 cos_to_last_merge=0.9956 (last merge round=29)
[S13] round=43 local utility u=0.176807 metrics={'f1_val': 0.6385786558571309, 'auprc': 0.6996405166224994, 'loss_val': 1.1107191825411618, 'psi': 0.6630034001632783}-{'f1_val': 0.6239099232735067, 'auprc': 0.6506827524572859, 'loss_val': 1.2294467370312052, 'psi': 0.6346190549470184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=43 head_norm_before_train=1.614611 cos_to_last_merge=0.9928 (last merge round=30)
[S14] round=43 local utility u=0.003960 metrics={'f1_val': 0.9969485114736489, 'auprc': 0.9988794632606903, 'loss_val': 0.033525502036670596, 'psi': 0.9977208921884655}-{'f1_val': 0.9975765414632514, 'auprc': 0.9987276795531124, 'loss_val': 0.044757879988979975, 'psi': 0.9980369966991958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=43 head_norm_before_train=1.689248 cos_to_last_merge=0.9880 (last merge round=29)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.8962320072727894, 'auprc': 0.9941031102587388, 'loss_val': 0.2242736935334341, 'psi': 0.9353804484671692}-{'f1_val': 0.903170176196454, 'auprc': 0.9940707130583762, 'loss_val': 0.19961661559574295, 'psi': 0.9395303909412229}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.531475 cos_to_last_merge=0.9819 (last merge round=29)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9266822217996489, 'auprc': 0.9875395476236412, 'loss_val': 0.3060013277084037, 'psi': 0.9510251521292458}-{'f1_val': 0.9366930117539796, 'auprc': 0.9873044100000793, 'loss_val': 0.23367369036776012, 'psi': 0.9569375710524195}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.691920 cos_to_last_merge=0.9803 (last merge round=28)
[S17] round=43 local utility u=1.000000 metrics={'f1_val': 0.8514288767449615, 'auprc': 0.9961411080229869, 'loss_val': 0.3456695183783433, 'psi': 0.9093137692561717}-{'f1_val': 0.5169444234804967, 'auprc': 0.6837800863125312, 'loss_val': 1.378416667325606, 'psi': 0.5836786886133105}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=44 head_norm_before_train=1.784864 cos_to_last_merge=0.9966 (last merge round=30)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.7175606403100885, 'auprc': 0.9797511278479729, 'loss_val': 0.4795515992792433, 'psi': 0.8224368353252423}-{'f1_val': 0.7165927592663566, 'auprc': 0.9933660645678919, 'loss_val': 0.45098369470065935, 'psi': 0.8273020813869707}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.288069 cos_to_last_merge=0.9980 (last merge round=30)
[S3] round=44 local utility u=0.061475 metrics={'f1_val': 0.8067833233153358, 'auprc': 0.9983919057813713, 'loss_val': 0.4385489162721648, 'psi': 0.8834267563017499}-{'f1_val': 0.7842802720353892, 'auprc': 0.9986535084072578, 'loss_val': 0.4272654922720245, 'psi': 0.8700295665841367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=44 head_norm_before_train=1.734621 cos_to_last_merge=0.9955 (last merge round=29)
[S4] round=44 local utility u=0.045477 metrics={'f1_val': 0.9512085994860303, 'auprc': 0.9698650510005288, 'loss_val': 0.295188773975001, 'psi': 0.9586711800918297}-{'f1_val': 0.9473388460262228, 'auprc': 0.9478813242825158, 'loss_val': 0.29697258652624564, 'psi': 0.94755583732874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S4] sending update (kind=head size=1808 to 1 peers)
[S5] START round=44 head_norm_before_train=1.438380 cos_to_last_merge=0.9403 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.6435654637035813, 'auprc': 0.8662375612741479, 'loss_val': 0.4395685447856595, 'psi': 0.7326343027318079}-{'f1_val': 0.6941436550349898, 'auprc': 0.857640210180363, 'loss_val': 0.40152997281931635, 'psi': 0.759542277093139}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.770044 cos_to_last_merge=0.9561 (last merge round=28)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.64348234067275, 'auprc': 0.7881140329807788, 'loss_val': 0.9406668322834228, 'psi': 0.7013350175959615}-{'f1_val': 0.6188229411810398, 'auprc': 0.9471214023638005, 'loss_val': 0.878347137062293, 'psi': 0.7501423256541441}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.672655 cos_to_last_merge=0.9920 (last merge round=27)
[S7] round=44 local utility u=0.199482 metrics={'f1_val': 0.6511905029838847, 'auprc': 0.7996356640251148, 'loss_val': 0.5040551090288866, 'psi': 0.7105685674003768}-{'f1_val': 0.6128347389593716, 'auprc': 0.789046738371211, 'loss_val': 0.6411173715988301, 'psi': 0.6833195387241073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=44 head_norm_before_train=2.278077 cos_to_last_merge=0.9977 (last merge round=29)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9857354242324556, 'auprc': 0.9991389643653624, 'loss_val': 0.044343947099977604, 'psi': 0.9910968402856184}-{'f1_val': 0.9925279616884268, 'auprc': 0.998170544399574, 'loss_val': 0.046001729379927976, 'psi': 0.9947849947728857}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=2.076147 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9985918046268889, 'loss_val': 0.02008101456889812, 'psi': 0.9969327528692669}-{'f1_val': 0.9966605118138915, 'auprc': 0.998836349453523, 'loss_val': 0.018470192747398483, 'psi': 0.997530846869744}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.248103 cos_to_last_merge=0.9944 (last merge round=25)
[S10] round=44 local utility u=0.000191 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.995957350119932, 'loss_val': 0.023316036650840487, 'psi': 0.9953638519670185}-{'f1_val': 0.9949681865317428, 'auprc': 0.9958884213574756, 'loss_val': 0.023491618404547467, 'psi': 0.9953362804620359}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=44 head_norm_before_train=1.702086 cos_to_last_merge=0.9450 (last merge round=22)
[S11] ⚠️ Model drifted since last merge! cos=0.945
[S11] round=44 local utility u=0.003182 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9964896344580711, 'loss_val': 0.03202290527515969, 'psi': 0.996378954264545}-{'f1_val': 0.996305167468861, 'auprc': 0.994935830195451, 'loss_val': 0.03372498978904831, 'psi': 0.9957574325594969}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=44 head_norm_before_train=1.653713 cos_to_last_merge=0.9953 (last merge round=29)
[S13] round=44 local utility u=0.040142 metrics={'f1_val': 0.6408583147476462, 'auprc': 0.721045244893186, 'loss_val': 1.108327506253971, 'psi': 0.6729330868058621}-{'f1_val': 0.6385786558571309, 'auprc': 0.6996405166224994, 'loss_val': 1.1107191825411618, 'psi': 0.6630034001632783}
[S13] not sending this round → trigger blocked (psi=0.673)
[S14] START round=44 head_norm_before_train=1.625466 cos_to_last_merge=0.9921 (last merge round=30)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9944421243330179, 'auprc': 0.9985337951790914, 'loss_val': 0.0386167206450146, 'psi': 0.9960787926714474}-{'f1_val': 0.9969485114736489, 'auprc': 0.9988794632606903, 'loss_val': 0.033525502036670596, 'psi': 0.9977208921884655}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.704861 cos_to_last_merge=0.9872 (last merge round=29)
[S15] round=44 local utility u=0.049909 metrics={'f1_val': 0.9082574443353278, 'auprc': 0.9942998737796378, 'loss_val': 0.1971987815189092, 'psi': 0.9426744161130518}-{'f1_val': 0.8962320072727894, 'auprc': 0.9941031102587388, 'loss_val': 0.2242736935334341, 'psi': 0.9353804484671692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=44 head_norm_before_train=1.546506 cos_to_last_merge=0.9806 (last merge round=29)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.8973751818077434, 'auprc': 0.9876190552842026, 'loss_val': 0.4375407413403161, 'psi': 0.9334727311983271}-{'f1_val': 0.9266822217996489, 'auprc': 0.9875395476236412, 'loss_val': 0.3060013277084037, 'psi': 0.9510251521292458}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.704231 cos_to_last_merge=0.9793 (last merge round=28)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.5497940681403651, 'auprc': 0.7318044231440163, 'loss_val': 1.3736989265507278, 'psi': 0.6225982101418256}-{'f1_val': 0.8514288767449615, 'auprc': 0.9961411080229869, 'loss_val': 0.3456695183783433, 'psi': 0.9093137692561717}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.795200 cos_to_last_merge=0.9963 (last merge round=30)
[S2] round=45 local utility u=0.065127 metrics={'f1_val': 0.7226933280509578, 'auprc': 0.9925730692863498, 'loss_val': 0.41855903829186963, 'psi': 0.8306452245451146}-{'f1_val': 0.7175606403100885, 'auprc': 0.9797511278479729, 'loss_val': 0.4795515992792433, 'psi': 0.8224368353252423}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=45 head_norm_before_train=2.299011 cos_to_last_merge=0.9977 (last merge round=30)
[S3] round=45 local utility u=0.154100 metrics={'f1_val': 0.8378711401898643, 'auprc': 0.9986311742885136, 'loss_val': 0.31759334635246544, 'psi': 0.9021751538293239}-{'f1_val': 0.8067833233153358, 'auprc': 0.9983919057813713, 'loss_val': 0.4385489162721648, 'psi': 0.8834267563017499}
[S3] not sending this round → trigger blocked (psi=0.902)
[S4] START round=45 head_norm_before_train=1.745215 cos_to_last_merge=0.9951 (last merge round=29)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9499807333882995, 'auprc': 0.9691975883676731, 'loss_val': 0.2973969671434472, 'psi': 0.9576674753800489}-{'f1_val': 0.9512085994860303, 'auprc': 0.9698650510005288, 'loss_val': 0.295188773975001, 'psi': 0.9586711800918297}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.451310 cos_to_last_merge=0.9386 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.939
[S5] round=45 local utility u=1.000000 metrics={'f1_val': 0.9862541036617611, 'auprc': 0.9971282286837684, 'loss_val': 0.12288901915614728, 'psi': 0.9906037536705641}-{'f1_val': 0.6435654637035813, 'auprc': 0.8662375612741479, 'loss_val': 0.4395685447856595, 'psi': 0.7326343027318079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=45 head_norm_before_train=1.789839 cos_to_last_merge=0.9544 (last merge round=28)
[S6] round=45 local utility u=0.847774 metrics={'f1_val': 0.7817567615467043, 'auprc': 0.952345371079201, 'loss_val': 0.5674600692021364, 'psi': 0.849992205359703}-{'f1_val': 0.64348234067275, 'auprc': 0.7881140329807788, 'loss_val': 0.9406668322834228, 'psi': 0.7013350175959615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=45 head_norm_before_train=1.677691 cos_to_last_merge=0.9914 (last merge round=27)
[S7] round=45 local utility u=0.062501 metrics={'f1_val': 0.6597698741559409, 'auprc': 0.8077703609817494, 'loss_val': 0.45493430613278296, 'psi': 0.7189700688862644}-{'f1_val': 0.6511905029838847, 'auprc': 0.7996356640251148, 'loss_val': 0.5040551090288866, 'psi': 0.7105685674003768}
[S7] not sending this round → trigger blocked (psi=0.719)
[S8] START round=45 head_norm_before_train=2.286343 cos_to_last_merge=0.9976 (last merge round=29)
[S8] round=45 local utility u=0.035720 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9995788072870717, 'loss_val': 0.024410821426464228, 'psi': 0.9962915311289077}-{'f1_val': 0.9857354242324556, 'auprc': 0.9991389643653624, 'loss_val': 0.044343947099977604, 'psi': 0.9910968402856184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=45 head_norm_before_train=2.082763 (no previous merge yet)
[S9] round=45 local utility u=0.002754 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9988759559951513, 'loss_val': 0.018091086171659394, 'psi': 0.9973129998363042}-{'f1_val': 0.9958267183641853, 'auprc': 0.9985918046268889, 'loss_val': 0.02008101456889812, 'psi': 0.9969327528692669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=45 head_norm_before_train=2.253505 cos_to_last_merge=0.9938 (last merge round=25)
[S10] round=45 local utility u=0.000027 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9959466451147617, 'loss_val': 0.023229054994385143, 'psi': 0.9953595699649505}-{'f1_val': 0.9949681865317428, 'auprc': 0.995957350119932, 'loss_val': 0.023316036650840487, 'psi': 0.9953638519670185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=45 head_norm_before_train=1.710516 cos_to_last_merge=0.9442 (last merge round=22)
[S11] ⚠️ Model drifted since last merge! cos=0.944
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9903852553649821, 'auprc': 0.9951177419871101, 'loss_val': 0.05923636689555095, 'psi': 0.9922782500138333}-{'f1_val': 0.996305167468861, 'auprc': 0.9964896344580711, 'loss_val': 0.03202290527515969, 'psi': 0.996378954264545}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.660935 cos_to_last_merge=0.9950 (last merge round=29)
[S13] round=45 local utility u=0.049414 metrics={'f1_val': 0.6506679794929577, 'auprc': 0.7193154251250982, 'loss_val': 1.0631681966381816, 'psi': 0.6781269577458139}-{'f1_val': 0.6408583147476462, 'auprc': 0.721045244893186, 'loss_val': 1.108327506253971, 'psi': 0.6729330868058621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=45 head_norm_before_train=1.636789 cos_to_last_merge=0.9916 (last merge round=30)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.994470429891246, 'auprc': 0.9985345884025086, 'loss_val': 0.05038575138984038, 'psi': 0.9960960932957511}-{'f1_val': 0.9944421243330179, 'auprc': 0.9985337951790914, 'loss_val': 0.0386167206450146, 'psi': 0.9960787926714474}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.719677 cos_to_last_merge=0.9864 (last merge round=29)
[S15] round=45 local utility u=0.344667 metrics={'f1_val': 0.9942536406128715, 'auprc': 0.9962811693271281, 'loss_val': 0.029785965742925507, 'psi': 0.9950646520985741}-{'f1_val': 0.9082574443353278, 'auprc': 0.9942998737796378, 'loss_val': 0.1971987815189092, 'psi': 0.9426744161130518}
[S15] not sending this round → trigger blocked (psi=0.995)
[S16] START round=45 head_norm_before_train=1.560357 cos_to_last_merge=0.9795 (last merge round=29)
[S16] round=45 local utility u=0.463214 metrics={'f1_val': 0.9900453465832476, 'auprc': 0.9859686010249742, 'loss_val': 0.062182473973029985, 'psi': 0.9884146483599383}-{'f1_val': 0.8973751818077434, 'auprc': 0.9876190552842026, 'loss_val': 0.4375407413403161, 'psi': 0.9334727311983271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=45 head_norm_before_train=1.716109 cos_to_last_merge=0.9784 (last merge round=28)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.5741689849918161, 'auprc': 0.7740944709399756, 'loss_val': 1.7471134956099992, 'psi': 0.6541391793710799}-{'f1_val': 0.5497940681403651, 'auprc': 0.7318044231440163, 'loss_val': 1.3736989265507278, 'psi': 0.6225982101418256}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=1.805429 cos_to_last_merge=0.9959 (last merge round=30)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.7103365702365914, 'auprc': 0.9812154907966362, 'loss_val': 0.4995383771661588, 'psi': 0.8186881384606093}-{'f1_val': 0.7226933280509578, 'auprc': 0.9925730692863498, 'loss_val': 0.41855903829186963, 'psi': 0.8306452245451146}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.309438 cos_to_last_merge=0.9974 (last merge round=30)
[S3] round=46 local utility u=0.626077 metrics={'f1_val': 0.9972870390780529, 'auprc': 0.9998729870638314, 'loss_val': 0.025659817955328963, 'psi': 0.9983214182723643}-{'f1_val': 0.8378711401898643, 'auprc': 0.9986311742885136, 'loss_val': 0.31759334635246544, 'psi': 0.9021751538293239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=46 head_norm_before_train=1.747790 cos_to_last_merge=0.9946 (last merge round=29)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9479499037886425, 'auprc': 0.9478433171612, 'loss_val': 0.30402633362322246, 'psi': 0.9479072691376654}-{'f1_val': 0.9499807333882995, 'auprc': 0.9691975883676731, 'loss_val': 0.2973969671434472, 'psi': 0.9576674753800489}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.464344 cos_to_last_merge=0.9366 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.700868080518019, 'auprc': 0.89999476845041, 'loss_val': 0.3667353993256395, 'psi': 0.7805187556909754}-{'f1_val': 0.9862541036617611, 'auprc': 0.9971282286837684, 'loss_val': 0.12288901915614728, 'psi': 0.9906037536705641}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.801712 cos_to_last_merge=0.9530 (last merge round=28)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7643717655604528, 'auprc': 0.9312994622362392, 'loss_val': 0.6240454920743669, 'psi': 0.8311428442307673}-{'f1_val': 0.7817567615467043, 'auprc': 0.952345371079201, 'loss_val': 0.5674600692021364, 'psi': 0.849992205359703}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.685160 cos_to_last_merge=0.9906 (last merge round=27)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.6558286676334242, 'auprc': 0.8033855743315846, 'loss_val': 0.5018531574091779, 'psi': 0.7148514303126884}-{'f1_val': 0.6597698741559409, 'auprc': 0.8077703609817494, 'loss_val': 0.45493430613278296, 'psi': 0.7189700688862644}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=2.290878 cos_to_last_merge=0.9973 (last merge round=29)
[S8] round=46 local utility u=0.000537 metrics={'f1_val': 0.994057704452729, 'auprc': 0.9996757350668158, 'loss_val': 0.023373587769730517, 'psi': 0.9963049166983637}-{'f1_val': 0.9941000136901317, 'auprc': 0.9995788072870717, 'loss_val': 0.024410821426464228, 'psi': 0.9962915311289077}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=46 head_norm_before_train=2.091457 (no previous merge yet)
[S9] round=46 local utility u=0.001951 metrics={'f1_val': 0.9966857875385419, 'auprc': 0.9992655023707223, 'loss_val': 0.017847235739160538, 'psi': 0.9977176734714142}-{'f1_val': 0.9962710290637395, 'auprc': 0.9988759559951513, 'loss_val': 0.018091086171659394, 'psi': 0.9973129998363042}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=46 head_norm_before_train=2.262056 cos_to_last_merge=0.9935 (last merge round=25)
[S10] round=46 local utility u=0.000071 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.996003622216264, 'loss_val': 0.023258273869497827, 'psi': 0.9953823608055513}-{'f1_val': 0.9949681865317428, 'auprc': 0.9959466451147617, 'loss_val': 0.023229054994385143, 'psi': 0.9953595699649505}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=46 head_norm_before_train=1.715462 cos_to_last_merge=0.9432 (last merge round=22)
[S11] ⚠️ Model drifted since last merge! cos=0.943
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.8102416328960691, 'auprc': 0.9941555057437454, 'loss_val': 0.3446266654613992, 'psi': 0.8838071820351396}-{'f1_val': 0.9903852553649821, 'auprc': 0.9951177419871101, 'loss_val': 0.05923636689555095, 'psi': 0.9922782500138333}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.671147 cos_to_last_merge=0.9945 (last merge round=29)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6220962937066622, 'auprc': 0.6453743068252318, 'loss_val': 1.3044408116695638, 'psi': 0.6314074989540901}-{'f1_val': 0.6506679794929577, 'auprc': 0.7193154251250982, 'loss_val': 1.0631681966381816, 'psi': 0.6781269577458139}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.644951 cos_to_last_merge=0.9911 (last merge round=30)
[S14] round=46 local utility u=0.018451 metrics={'f1_val': 0.9975795452795295, 'auprc': 0.9989281300040074, 'loss_val': 0.03331823994036675, 'psi': 0.9981189791693206}-{'f1_val': 0.994470429891246, 'auprc': 0.9985345884025086, 'loss_val': 0.05038575138984038, 'psi': 0.9960960932957511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=46 head_norm_before_train=1.733654 cos_to_last_merge=0.9857 (last merge round=29)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.7748560717717212, 'auprc': 0.9923652776732652, 'loss_val': 0.5291915609417885, 'psi': 0.8618597541323388}-{'f1_val': 0.9942536406128715, 'auprc': 0.9962811693271281, 'loss_val': 0.029785965742925507, 'psi': 0.9950646520985741}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.574097 cos_to_last_merge=0.9783 (last merge round=29)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9893686320791972, 'auprc': 0.9861886999342475, 'loss_val': 0.0661938745207089, 'psi': 0.9880966592212174}-{'f1_val': 0.9900453465832476, 'auprc': 0.9859686010249742, 'loss_val': 0.062182473973029985, 'psi': 0.9884146483599383}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.728982 cos_to_last_merge=0.9773 (last merge round=28)
[S17] round=46 local utility u=0.749652 metrics={'f1_val': 0.674849720734219, 'auprc': 0.8381897937731214, 'loss_val': 1.0441794846588988, 'psi': 0.7401857499497799}-{'f1_val': 0.5741689849918161, 'auprc': 0.7740944709399756, 'loss_val': 1.7471134956099992, 'psi': 0.6541391793710799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=47 head_norm_before_train=1.811135 cos_to_last_merge=0.9957 (last merge round=30)
[S2] round=47 local utility u=0.026492 metrics={'f1_val': 0.7113380242646656, 'auprc': 0.9782392239307321, 'loss_val': 0.44363514390279146, 'psi': 0.8180985041310922}-{'f1_val': 0.7103365702365914, 'auprc': 0.9812154907966362, 'loss_val': 0.4995383771661588, 'psi': 0.8186881384606093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=47 head_norm_before_train=2.320092 cos_to_last_merge=0.9971 (last merge round=30)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9659183042438488, 'auprc': 0.9999134013771249, 'loss_val': 0.05385636970603151, 'psi': 0.9795163430971593}-{'f1_val': 0.9972870390780529, 'auprc': 0.9998729870638314, 'loss_val': 0.025659817955328963, 'psi': 0.9983214182723643}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.758777 cos_to_last_merge=0.9940 (last merge round=29)
[S4] round=47 local utility u=0.040816 metrics={'f1_val': 0.9512630285267842, 'auprc': 0.9670566563306009, 'loss_val': 0.29991243749245694, 'psi': 0.957580479648311}-{'f1_val': 0.9479499037886425, 'auprc': 0.9478433171612, 'loss_val': 0.30402633362322246, 'psi': 0.9479072691376654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=47 head_norm_before_train=1.474804 cos_to_last_merge=0.9350 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=47 local utility u=1.000000 metrics={'f1_val': 0.952994784528889, 'auprc': 0.9959669189192184, 'loss_val': 0.14359850432552596, 'psi': 0.9701836382850206}-{'f1_val': 0.700868080518019, 'auprc': 0.89999476845041, 'loss_val': 0.3667353993256395, 'psi': 0.7805187556909754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=47 head_norm_before_train=1.812830 cos_to_last_merge=0.9517 (last merge round=28)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.6579916742924906, 'auprc': 0.8839906218709029, 'loss_val': 0.8695116778980981, 'psi': 0.7483912533238556}-{'f1_val': 0.7643717655604528, 'auprc': 0.9312994622362392, 'loss_val': 0.6240454920743669, 'psi': 0.8311428442307673}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.692555 cos_to_last_merge=0.9899 (last merge round=27)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6435915338302945, 'auprc': 0.7999041353458001, 'loss_val': 0.5531071911297175, 'psi': 0.7061165744364968}-{'f1_val': 0.6558286676334242, 'auprc': 0.8033855743315846, 'loss_val': 0.5018531574091779, 'psi': 0.7148514303126884}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.297149 cos_to_last_merge=0.9971 (last merge round=29)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.991875857183659, 'auprc': 0.9995357483834952, 'loss_val': 0.03416028122826915, 'psi': 0.9949398136635934}-{'f1_val': 0.994057704452729, 'auprc': 0.9996757350668158, 'loss_val': 0.023373587769730517, 'psi': 0.9963049166983637}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=2.100598 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9990129142724649, 'loss_val': 0.017779980779102623, 'psi': 0.9971011967274972}-{'f1_val': 0.9966857875385419, 'auprc': 0.9992655023707223, 'loss_val': 0.017847235739160538, 'psi': 0.9977176734714142}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.271458 cos_to_last_merge=0.9933 (last merge round=25)
[S10] round=47 local utility u=0.000079 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9960552735351398, 'loss_val': 0.023255955271819957, 'psi': 0.9954030213331015}-{'f1_val': 0.9949681865317428, 'auprc': 0.996003622216264, 'loss_val': 0.023258273869497827, 'psi': 0.9953823608055513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=47 head_norm_before_train=1.720015 cos_to_last_merge=0.9424 (last merge round=22)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=47 local utility u=0.710806 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9954217231566862, 'loss_val': 0.042165930748288345, 'psi': 0.99584889421066}-{'f1_val': 0.8102416328960691, 'auprc': 0.9941555057437454, 'loss_val': 0.3446266654613992, 'psi': 0.8838071820351396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=47 head_norm_before_train=1.680595 cos_to_last_merge=0.9941 (last merge round=29)
[S13] round=47 local utility u=0.588672 metrics={'f1_val': 0.7093754528954632, 'auprc': 0.7503305681436958, 'loss_val': 0.9656410912199406, 'psi': 0.7257574989947563}-{'f1_val': 0.6220962937066622, 'auprc': 0.6453743068252318, 'loss_val': 1.3044408116695638, 'psi': 0.6314074989540901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=47 head_norm_before_train=1.654066 cos_to_last_merge=0.9905 (last merge round=30)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9875994828282899, 'auprc': 0.9988927802816008, 'loss_val': 0.054280865881766574, 'psi': 0.9921168018096143}-{'f1_val': 0.9975795452795295, 'auprc': 0.9989281300040074, 'loss_val': 0.03331823994036675, 'psi': 0.9981189791693206}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.746794 cos_to_last_merge=0.9850 (last merge round=29)
[S15] round=47 local utility u=0.927174 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.997576714716605, 'loss_val': 0.021820489972298775, 'psi': 0.9970786869191544}-{'f1_val': 0.7748560717717212, 'auprc': 0.9923652776732652, 'loss_val': 0.5291915609417885, 'psi': 0.8618597541323388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=47 head_norm_before_train=1.586738 cos_to_last_merge=0.9772 (last merge round=29)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9348342983901362, 'auprc': 0.9868246978199979, 'loss_val': 0.27630531984723083, 'psi': 0.9556304581620809}-{'f1_val': 0.9893686320791972, 'auprc': 0.9861886999342475, 'loss_val': 0.0661938745207089, 'psi': 0.9880966592212174}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.743145 cos_to_last_merge=0.9762 (last merge round=28)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6405133139961623, 'auprc': 0.7793013190357502, 'loss_val': 1.211060912147136, 'psi': 0.6960285160119974}-{'f1_val': 0.674849720734219, 'auprc': 0.8381897937731214, 'loss_val': 1.0441794846588988, 'psi': 0.7401857499497799}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.816362 cos_to_last_merge=0.9954 (last merge round=30)
[S2] round=48 local utility u=0.340610 metrics={'f1_val': 0.8063737781024948, 'auprc': 0.9832185508770083, 'loss_val': 0.3475686453945935, 'psi': 0.8771116872123002}-{'f1_val': 0.7113380242646656, 'auprc': 0.9782392239307321, 'loss_val': 0.44363514390279146, 'psi': 0.8180985041310922}
[S2] not sending this round → trigger blocked (psi=0.877)
[S3] START round=48 head_norm_before_train=2.330411 cos_to_last_merge=0.9967 (last merge round=30)
[S3] round=48 local utility u=0.090344 metrics={'f1_val': 0.9915740515963684, 'auprc': 0.9999529392998321, 'loss_val': 0.0272224002570206, 'psi': 0.9949256066777539}-{'f1_val': 0.9659183042438488, 'auprc': 0.9999134013771249, 'loss_val': 0.05385636970603151, 'psi': 0.9795163430971593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=48 head_norm_before_train=1.766112 cos_to_last_merge=0.9933 (last merge round=29)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9500336438256104, 'auprc': 0.9459219921630666, 'loss_val': 0.31131857714280775, 'psi': 0.948388983160593}-{'f1_val': 0.9512630285267842, 'auprc': 0.9670566563306009, 'loss_val': 0.29991243749245694, 'psi': 0.957580479648311}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.482887 cos_to_last_merge=0.9338 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=48 local utility u=0.111301 metrics={'f1_val': 0.9853839451861917, 'auprc': 0.9940789370245532, 'loss_val': 0.10966657714801402, 'psi': 0.9888619419215363}-{'f1_val': 0.952994784528889, 'auprc': 0.9959669189192184, 'loss_val': 0.14359850432552596, 'psi': 0.9701836382850206}
[S5] not sending this round → trigger blocked (psi=0.989)
[S6] START round=48 head_norm_before_train=1.820408 cos_to_last_merge=0.9509 (last merge round=28)
[S6] round=48 local utility u=0.562892 metrics={'f1_val': 0.7657890428084325, 'auprc': 0.9518698906230064, 'loss_val': 0.5941492551107195, 'psi': 0.8402213819342621}-{'f1_val': 0.6579916742924906, 'auprc': 0.8839906218709029, 'loss_val': 0.8695116778980981, 'psi': 0.7483912533238556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=48 head_norm_before_train=1.698763 cos_to_last_merge=0.9893 (last merge round=27)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6286000715207121, 'auprc': 0.8001726290354155, 'loss_val': 0.5325578407458511, 'psi': 0.6972290945265934}-{'f1_val': 0.6435915338302945, 'auprc': 0.7999041353458001, 'loss_val': 0.5531071911297175, 'psi': 0.7061165744364968}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.300369 cos_to_last_merge=0.9969 (last merge round=29)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9929986936706093, 'auprc': 0.9988341938474004, 'loss_val': 0.05132170636677111, 'psi': 0.9953328937413257}-{'f1_val': 0.991875857183659, 'auprc': 0.9995357483834952, 'loss_val': 0.03416028122826915, 'psi': 0.9949398136635934}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=2.107659 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9948313401205634, 'loss_val': 0.01881630157421, 'psi': 0.995682592915792}-{'f1_val': 0.9958267183641853, 'auprc': 0.9990129142724649, 'loss_val': 0.017779980779102623, 'psi': 0.9971011967274972}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.280988 cos_to_last_merge=0.9932 (last merge round=25)
[S10] round=48 local utility u=0.000227 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9961309546769872, 'loss_val': 0.023029232351762137, 'psi': 0.9954332937898406}-{'f1_val': 0.9949681865317428, 'auprc': 0.9960552735351398, 'loss_val': 0.023255955271819957, 'psi': 0.9954030213331015}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=48 head_norm_before_train=1.726201 cos_to_last_merge=0.9417 (last merge round=22)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=48 local utility u=0.008113 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9964915668382923, 'loss_val': 0.030178640959425154, 'psi': 0.9963797272166335}-{'f1_val': 0.9961336749133093, 'auprc': 0.9954217231566862, 'loss_val': 0.042165930748288345, 'psi': 0.99584889421066}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=48 head_norm_before_train=1.687388 cos_to_last_merge=0.9937 (last merge round=29)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6985575529693613, 'auprc': 0.759383594708055, 'loss_val': 1.0116574757429262, 'psi': 0.7228879696648388}-{'f1_val': 0.7093754528954632, 'auprc': 0.7503305681436958, 'loss_val': 0.9656410912199406, 'psi': 0.7257574989947563}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.664171 cos_to_last_merge=0.9899 (last merge round=30)
[S14] round=48 local utility u=0.017476 metrics={'f1_val': 0.9920902250998942, 'auprc': 0.9985137612248249, 'loss_val': 0.04513545946854015, 'psi': 0.9946596395498666}-{'f1_val': 0.9875994828282899, 'auprc': 0.9988927802816008, 'loss_val': 0.054280865881766574, 'psi': 0.9921168018096143}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=48 head_norm_before_train=1.758823 cos_to_last_merge=0.9844 (last merge round=29)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.8909062766880147, 'auprc': 0.994094954318702, 'loss_val': 0.2677472707326083, 'psi': 0.9321817477402896}-{'f1_val': 0.9967466683875206, 'auprc': 0.997576714716605, 'loss_val': 0.021820489972298775, 'psi': 0.9970786869191544}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.599209 cos_to_last_merge=0.9761 (last merge round=29)
[S16] round=48 local utility u=0.239789 metrics={'f1_val': 0.9826422368767805, 'auprc': 0.985936249184419, 'loss_val': 0.08090918919615568, 'psi': 0.9839598417998359}-{'f1_val': 0.9348342983901362, 'auprc': 0.9868246978199979, 'loss_val': 0.27630531984723083, 'psi': 0.9556304581620809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=48 head_norm_before_train=1.753843 cos_to_last_merge=0.9753 (last merge round=28)
[S17] round=48 local utility u=1.000000 metrics={'f1_val': 0.9149625634161198, 'auprc': 0.9936820909980983, 'loss_val': 0.2867884997239112, 'psi': 0.9464503744489112}-{'f1_val': 0.6405133139961623, 'auprc': 0.7793013190357502, 'loss_val': 1.211060912147136, 'psi': 0.6960285160119974}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=49 head_norm_before_train=1.824064 cos_to_last_merge=0.9951 (last merge round=30)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.6260720497555139, 'auprc': 0.786184423245172, 'loss_val': 1.1206259989379068, 'psi': 0.6901169991513771}-{'f1_val': 0.8063737781024948, 'auprc': 0.9832185508770083, 'loss_val': 0.3475686453945935, 'psi': 0.8771116872123002}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.338759 cos_to_last_merge=0.9964 (last merge round=30)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9747179186294904, 'auprc': 0.9999613321579723, 'loss_val': 0.0458262122273763, 'psi': 0.9848152840408833}-{'f1_val': 0.9915740515963684, 'auprc': 0.9999529392998321, 'loss_val': 0.0272224002570206, 'psi': 0.9949256066777539}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.769655 cos_to_last_merge=0.9929 (last merge round=29)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9475398198074055, 'auprc': 0.9403493809353545, 'loss_val': 0.3097747919452722, 'psi': 0.9446636442585852}-{'f1_val': 0.9500336438256104, 'auprc': 0.9459219921630666, 'loss_val': 0.31131857714280775, 'psi': 0.948388983160593}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.489738 cos_to_last_merge=0.9328 (last merge round=25)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9767216467845853, 'auprc': 0.9949886126300013, 'loss_val': 0.13509818904411994, 'psi': 0.9840284331227516}-{'f1_val': 0.9853839451861917, 'auprc': 0.9940789370245532, 'loss_val': 0.10966657714801402, 'psi': 0.9888619419215363}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.835718 cos_to_last_merge=0.9494 (last merge round=28)
[S6] ⚠️ Model drifted since last merge! cos=0.949
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.722129479179765, 'auprc': 0.8624983764122648, 'loss_val': 0.8260392509005605, 'psi': 0.7782770380727649}-{'f1_val': 0.7657890428084325, 'auprc': 0.9518698906230064, 'loss_val': 0.5941492551107195, 'psi': 0.8402213819342621}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.705100 cos_to_last_merge=0.9887 (last merge round=27)
[S7] round=49 local utility u=0.136494 metrics={'f1_val': 0.6540900863169974, 'auprc': 0.8115721611386133, 'loss_val': 0.4467078611609903, 'psi': 0.7170829162456438}-{'f1_val': 0.6286000715207121, 'auprc': 0.8001726290354155, 'loss_val': 0.5325578407458511, 'psi': 0.6972290945265934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=49 head_norm_before_train=2.308009 cos_to_last_merge=0.9967 (last merge round=29)
[S8] round=49 local utility u=0.020349 metrics={'f1_val': 0.9944248929832828, 'auprc': 0.9997799749118725, 'loss_val': 0.02201741072964949, 'psi': 0.9965669257547187}-{'f1_val': 0.9929986936706093, 'auprc': 0.9988341938474004, 'loss_val': 0.05132170636677111, 'psi': 0.9953328937413257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=49 head_norm_before_train=2.113769 (no previous merge yet)
[S9] round=49 local utility u=0.009395 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9998405788259839, 'loss_val': 0.017515592202741535, 'psi': 0.9979325386187284}-{'f1_val': 0.9962500947792776, 'auprc': 0.9948313401205634, 'loss_val': 0.01881630157421, 'psi': 0.995682592915792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=49 head_norm_before_train=2.284812 cos_to_last_merge=0.9925 (last merge round=25)
[S10] round=49 local utility u=0.000203 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9962144572102084, 'loss_val': 0.022873749830160828, 'psi': 0.995466694803129}-{'f1_val': 0.9949681865317428, 'auprc': 0.9961309546769872, 'loss_val': 0.023029232351762137, 'psi': 0.9954332937898406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=49 head_norm_before_train=1.733703 cos_to_last_merge=0.9411 (last merge round=22)
[S11] ⚠️ Model drifted since last merge! cos=0.941
[S11] round=49 local utility u=0.001182 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9971092755471864, 'loss_val': 0.029667278159054022, 'psi': 0.9966268107001912}-{'f1_val': 0.996305167468861, 'auprc': 0.9964915668382923, 'loss_val': 0.030178640959425154, 'psi': 0.9963797272166335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=49 head_norm_before_train=1.694413 cos_to_last_merge=0.9934 (last merge round=29)
[S13] round=49 local utility u=0.418172 metrics={'f1_val': 0.745800791106039, 'auprc': 0.8330394811386269, 'loss_val': 0.6797406408531182, 'psi': 0.7806962671190742}-{'f1_val': 0.6985575529693613, 'auprc': 0.759383594708055, 'loss_val': 1.0116574757429262, 'psi': 0.7228879696648388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=49 head_norm_before_train=1.674972 cos_to_last_merge=0.9894 (last merge round=30)
[S14] round=49 local utility u=0.021614 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9985252552598602, 'loss_val': 0.03618654259347024, 'psi': 0.9980886082598808}-{'f1_val': 0.9920902250998942, 'auprc': 0.9985137612248249, 'loss_val': 0.04513545946854015, 'psi': 0.9946596395498666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=49 head_norm_before_train=1.770759 cos_to_last_merge=0.9838 (last merge round=29)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.7785431671504978, 'auprc': 0.9929886575168074, 'loss_val': 0.5316041374214115, 'psi': 0.8643213632970217}-{'f1_val': 0.8909062766880147, 'auprc': 0.994094954318702, 'loss_val': 0.2677472707326083, 'psi': 0.9321817477402896}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.610734 cos_to_last_merge=0.9751 (last merge round=29)
[S16] round=49 local utility u=0.031050 metrics={'f1_val': 0.9900157356421694, 'auprc': 0.9830553959245278, 'loss_val': 0.05440757234160524, 'psi': 0.9872315997551129}-{'f1_val': 0.9826422368767805, 'auprc': 0.985936249184419, 'loss_val': 0.08090918919615568, 'psi': 0.9839598417998359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=49 head_norm_before_train=1.762886 cos_to_last_merge=0.9746 (last merge round=28)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.5206212820379528, 'auprc': 0.629305086777499, 'loss_val': 1.5690710247735513, 'psi': 0.5640948039337712}-{'f1_val': 0.9149625634161198, 'auprc': 0.9936820909980983, 'loss_val': 0.2867884997239112, 'psi': 0.9464503744489112}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
