[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:36603
[S3] → join 127.0.0.1:36602
[S4] → join 127.0.0.1:36602
[S5] → join 127.0.0.1:36602
[S6] → join 127.0.0.1:36602
[S7] → join 127.0.0.1:36602
[S8] → join 127.0.0.1:36602
[S9] → join 127.0.0.1:36602
[S10] → join 127.0.0.1:36602
[S11] → join 127.0.0.1:36602
[S13] → join 127.0.0.1:36602
[S14] → join 127.0.0.1:36602
[S15] → join 127.0.0.1:36602
[S16] → join 127.0.0.1:36602
[S17] → join 127.0.0.1:36602
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.168664 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.131210 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.129336 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.131190 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.094100 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.150112 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.199752 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.166115 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.141827 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.168439 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.142086 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.186530 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.162379 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.160318 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.168685 (no previous merge yet)
[S6]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S4] + discovered S3
[S3] + discovered S7
[S3] + discovered S11
[S3] + discovered S4
[S3] + discovered S9
[S3] + discovered S8
[S3] + discovered S14
[S3] + discovered S15
[S3] + discovered S17
[S3] + discovered S6
[S3] + discovered S16
[S3] + discovered S13
[S3] + discovered S10
[S4] + discovered S2
[S3] + discovered S5
[S4] + discovered S7
[S4] + discovered S5
[S4] + discovered S17
[S4] + discovered S8
[S4] + discovered S14
[S5] + discovered S2
[S4] + discovered S11
[S4] + discovered S16
[S4] + discovered S13
[S4] + discovered S10
[S5] + discovered S4
[S4] + discovered S15
[S4] + discovered S6
[S5] + discovered S3
[S4] + discovered S9
[S5] + discovered S9
[S5] + discovered S6
[S5] + discovered S16
[S5] + discovered S15
[S5] + discovered S11
[S5] + discovered S17
[S5] + discovered S14
[S5] + discovered S7
[S5] + discovered S8
[S6] + discovered S2
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S3
[S5] + discovered S13
[S5] + discovered S10
[S6] + discovered S8
[S6] + discovered S13
[S6] + discovered S7
[S7] + discovered S3
[S7] + discovered S6
[S7] + discovered S2
[S6] + discovered S11
[S7] + discovered S5
[S6] + discovered S17
[S7] + discovered S4
[S6] + discovered S16
[S6] + discovered S14
[S6] + discovered S15
[S6] + discovered S10
[S6] + discovered S9
[S7] + discovered S16
[S7] + discovered S15
[S7] + discovered S13
[S7] + discovered S8
[S8] + discovered S7
[S7] + discovered S14
[S8] + discovered S3
[S7] + discovered S10
[S8] + discovered S4
[S7] + discovered S17
[S7] + discovered S11
[S8] + discovered S6
[S8] + discovered S5
[S8] + discovered S2
[S7] + discovered S9
[S9] + discovered S6
[S8] + discovered S14
[S8] + discovered S15
[S8] + discovered S10
[S8] + discovered S11
[S9] + discovered S5
[S9] + discovered S4
[S8] + discovered S16
[S9] + discovered S7
[S9] + discovered S3
[S8] + discovered S13
[S9] + discovered S8
[S9] + discovered S2
[S8] + discovered S17
[S8] + discovered S9
[S9] + discovered S13
[S9] + discovered S17
[S9] + discovered S11
[S10] + discovered S8
[S10] + discovered S5
[S10] + discovered S2
[S10] + discovered S9
[S10] + discovered S4
[S9] + discovered S16
[S10] + discovered S7
[S10] + discovered S3
[S9] + discovered S10
[S9] + discovered S15
[S10] + discovered S6
[S9] + discovered S14
[S10] + discovered S14
[S10] + discovered S13
[S10] + discovered S17
[S11] + discovered S6
[S11] + discovered S9
[S11] + discovered S7
[S11] + discovered S8
[S10] + discovered S11
[S11] + discovered S2
[S11] + discovered S5
[S11] + discovered S10
[S10] + discovered S15
[S10] + discovered S16
[S11] + discovered S3
[S11] + discovered S4
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S10
[S13] + discovered S11
[S13] + discovered S2
[S13] + discovered S9
[S11] + discovered S17
[S11] + discovered S16
[S11] + discovered S14
[S11] + discovered S15
[S13] + discovered S8
[S11] + discovered S13
[S13] + discovered S5
[S13] + discovered S6
[S13] + discovered S3
[S13] + discovered S17
[S14] + discovered S9
[S14] + discovered S7
[S14] + discovered S4
[S14] + discovered S8
[S13] + discovered S14
[S14] + discovered S6
[S14] + discovered S10
[S14] + discovered S13
[S13] + discovered S15
[S13] + discovered S16
[S14] + discovered S11
[S14] + discovered S2
[S14] + discovered S3
[S14] + discovered S5
[S14] + discovered S16
[S15] + discovered S3
[S15] + discovered S4
[S15] + discovered S7
[S15] + discovered S13
[S15] + discovered S6
[S15] + discovered S14
[S15] + discovered S5
[S15] + discovered S2
[S15] + discovered S8
[S15] + discovered S9
[S14] + discovered S15
[S15] + discovered S10
[S15] + discovered S11
[S14] + discovered S17
[S16] + discovered S9
[S16] + discovered S2
[S16] + discovered S13
[S16] + discovered S4
[S16] + discovered S14
[S16] + discovered S5
[S16] + discovered S15
[S16] + discovered S3
[S16] + discovered S10
[S16] + discovered S6
[S16] + discovered S8
[S15] + discovered S17
[S16] + discovered S7
[S15] + discovered S16
[S16] + discovered S11
[S17] + discovered S2
[S17] + discovered S7
[S17] + discovered S9
[S16] + discovered S17
[S17] + discovered S13
[S17] + discovered S16
[S17] + discovered S4
[S17] + discovered S15
[S17] + discovered S5
[S17] + discovered S8
[S17] + discovered S6
[S17] + discovered S3
[S17] + discovered S14
[S17] + discovered S11
[S17] + discovered S10
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=1.000 → S6@127.0.0.1:36607
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:36608
[S8] ⇄ pheromone p=1.000 → S9@127.0.0.1:36610
[S9] ⇄ pheromone p=1.000 → S5@127.0.0.1:36605
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:36607
[S7] ⇄ pheromone p=1.000 → S6@127.0.0.1:36607
[S4] ⇄ pheromone p=1.000 → S16@127.0.0.1:36616
[S2] ⇄ pheromone p=1.000 → S4@127.0.0.1:36604
[S5] ⇄ pheromone p=1.000 → S7@127.0.0.1:36608
[S15] ⇄ pheromone p=1.000 → S4@127.0.0.1:36604
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:36608
[S11] ⇄ pheromone p=1.000 → S2@127.0.0.1:36602
[S6] ⇄ pheromone p=1.000 → S4@127.0.0.1:36604
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:36608
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:36613
[S2] START round=1 head_norm_before_train=1.173019 (no previous merge yet)
[S2] round=1 local utility u=1.000000 metrics={'f1_val': 0.4158821818019893, 'auprc': 0.5745660505734437, 'loss_val': 1.3174227766724436, 'psi': 0.4793557293105711}-{'f1_val': 0.08791994281629735, 'auprc': 0.5712165753509786, 'loss_val': 1.3672486076293329, 'psi': 0.28123859583016986}
[S3] START round=1 head_norm_before_train=1.134224 (no previous merge yet)
[S3] round=1 local utility u=0.498777 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9214047767923551, 'loss_val': 1.3257875992796795, 'psi': 0.45246595008540624}-{'f1_val': 0.10474797479747974, 'auprc': 0.6667493617006511, 'loss_val': 1.348822228439017, 'psi': 0.3295485295587483}
[S4] START round=1 head_norm_before_train=1.134176 (no previous merge yet)
[S4] round=1 local utility u=0.048436 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.6037102816494895, 'loss_val': 1.3339255124125002, 'psi': 0.3256200899969063}-{'f1_val': 0.1548722586479765, 'auprc': 0.5526309316702473, 'loss_val': 1.365432770070208, 'psi': 0.3139757278568849}
[S5] START round=1 head_norm_before_train=1.133227 (no previous merge yet)
[S5] round=1 local utility u=0.097139 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5264117274708987, 'loss_val': 1.3341205058850114, 'psi': 0.29592183384550236}-{'f1_val': 0.14226190476190476, 'auprc': 0.474626476131788, 'loss_val': 1.373043696476153, 'psi': 0.27520773330985804}
[S6] START round=1 head_norm_before_train=1.100291 (no previous merge yet)
[S6] round=1 local utility u=0.462415 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8474213871607931, 'loss_val': 1.3382773197582436, 'psi': 0.42382432409508647}-{'f1_val': 0.05550037248572138, 'auprc': 0.7249973442762239, 'loss_val': 1.380280536572753, 'psi': 0.32329916120192237}
[S7] START round=1 head_norm_before_train=1.154793 (no previous merge yet)
[S7] round=1 local utility u=0.357779 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.4782509591739887, 'loss_val': 1.3313524916792763, 'psi': 0.2765344773070505}-{'f1_val': 0.14205682272909165, 'auprc': 0.250173304189607, 'loss_val': 1.3626768582529583, 'psi': 0.1853034153132978}
[S8] START round=1 head_norm_before_train=1.209533 (no previous merge yet)
[S8] round=1 local utility u=0.023017 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6549598222422176, 'loss_val': 1.3172434723363606, 'psi': 0.34595751833266136}-{'f1_val': 0.13995598239295717, 'auprc': 0.6525090590760951, 'loss_val': 1.3559245740595633, 'psi': 0.3449772130662124}
[S9] START round=1 head_norm_before_train=1.175495 (no previous merge yet)
[S9] round=1 local utility u=0.037438 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9733870066062971, 'loss_val': 1.2847342564480948, 'psi': 0.4741935769265165}-{'f1_val': 0.141397957139996, 'auprc': 0.9615187534052593, 'loss_val': 1.3240053084562942, 'psi': 0.46944627564610136}
[S10] START round=1 head_norm_before_train=1.154165 (no previous merge yet)
[S10] round=1 local utility u=0.004062 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7604188961766243, 'loss_val': 1.3189270031919835, 'psi': 0.3873405409956841}-{'f1_val': 0.13862163754172394, 'auprc': 0.7694844705755496, 'loss_val': 1.3542474140275418, 'psi': 0.3909667707552542}
[S11] START round=1 head_norm_before_train=1.168118 (no previous merge yet)
[S11] round=1 local utility u=0.447958 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7000843436404068, 'loss_val': 1.331599839522009, 'psi': 0.36428194748002907}-{'f1_val': 0.10359570269677702, 'auprc': 0.48565562580304455, 'loss_val': 1.3633226371564884, 'psi': 0.25641967193928406}
[S13] START round=1 head_norm_before_train=1.146483 (no previous merge yet)
[S13] round=1 local utility u=0.814444 metrics={'f1_val': 0.37327452350452234, 'auprc': 0.7243465529024175, 'loss_val': 1.3281046427769847, 'psi': 0.5137033352636804}-{'f1_val': 0.10392028033289531, 'auprc': 0.731738882977795, 'loss_val': 1.3630444466768672, 'psi': 0.35504772139085516}
[S14] START round=1 head_norm_before_train=1.193910 (no previous merge yet)
[S14] round=1 local utility u=0.095488 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.485161124916378, 'loss_val': 1.3274173449620632, 'psi': 0.27827916169617345}-{'f1_val': 0.14035785288270378, 'auprc': 0.4279073440514142, 'loss_val': 1.346631712756943, 'psi': 0.2553776493501879}
[S15] START round=1 head_norm_before_train=1.166802 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7675528146654966, 'loss_val': 1.3370430390684431, 'psi': 0.3908613166831337}-{'f1_val': 0.216650489933786, 'auprc': 0.7484345245956407, 'loss_val': 1.3710048669095016, 'psi': 0.42936410379852785}
[S16] START round=1 head_norm_before_train=1.168362 (no previous merge yet)
[S16] round=1 local utility u=0.185326 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9916731589689616, 'loss_val': 1.316267397835671, 'psi': 0.4810517337071065}-{'f1_val': 0.14063745019920318, 'auprc': 0.878277885497129, 'loss_val': 1.3467345022343356, 'psi': 0.43569362431837355}
[S17] START round=1 head_norm_before_train=1.180792 (no previous merge yet)
[S17] round=1 local utility u=0.019365 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.522685361647263, 'loss_val': 1.3361212530747781, 'psi': 0.2936435226493358}-{'f1_val': 0.14094896331738438, 'auprc': 0.5182519660187116, 'loss_val': 1.3615514466600982, 'psi': 0.29187016439791524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:36612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S6] → sending delta(kind=head bytes=1787) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:36614
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S11] → sending delta(kind=head bytes=1785) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:36614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:36615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S10] → sending delta(kind=head bytes=1787) to S3@127.0.0.1:36603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:36612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:36614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:36615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:36607
[S2] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1788 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1787 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1785 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1787 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1787) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.174475)
[S3] loaded HEAD from S10 (vec_in norm=1.174475)
[S3] cosine check vs S10: cos=0.0905
[S3] BUFFERED delta from S10 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1787) from S6
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.117466)
[S2] loaded HEAD from S6 (vec_in norm=1.117466)
[S2] cosine check vs S6: cos=0.0208
[S2] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1788) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.148012)
[S7] loaded HEAD from S4 (vec_in norm=1.148012)
[S7] cosine check vs S4: cos=-0.0419
[S7] DROPPED delta from S4 (cos=-0.0419 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1791) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.207619)
[S11] loaded HEAD from S14 (vec_in norm=1.207619)
[S11] cosine check vs S14: cos=-0.0016
[S11] DROPPED delta from S14 (cos=-0.0016 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1790) from S8
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.229936)
[S11] loaded HEAD from S8 (vec_in norm=1.229936)
[S11] cosine check vs S8: cos=-0.0735
[S11] DROPPED delta from S8 (cos=-0.0735 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1785) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.179136)
[S5] loaded HEAD from S11 (vec_in norm=1.179136)
[S5] cosine check vs S11: cos=-0.0431
[S5] DROPPED delta from S11 (cos=-0.0431 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1791) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.169482)
[S15] loaded HEAD from S7 (vec_in norm=1.169482)
[S15] cosine check vs S7: cos=0.0298
[S15] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1793) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.161223)
[S14] loaded HEAD from S13 (vec_in norm=1.161223)
[S14] cosine check vs S13: cos=0.0023
[S14] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1790) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.185471)
[S15] loaded HEAD from S16 (vec_in norm=1.185471)
[S15] cosine check vs S16: cos=0.0145
[S15] BUFFERED delta from S16 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1794) from S5
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.149324)
[S14] loaded HEAD from S5 (vec_in norm=1.149324)
[S14] cosine check vs S5: cos=-0.0829
[S14] DROPPED delta from S5 (cos=-0.0829 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1791) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.146307)
[S6] loaded HEAD from S3 (vec_in norm=1.146307)
[S6] cosine check vs S3: cos=-0.0782
[S6] DROPPED delta from S3 (cos=-0.0782 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1790) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.195964)
[S14] loaded HEAD from S9 (vec_in norm=1.195964)
[S14] cosine check vs S9: cos=-0.0023
[S14] DROPPED delta from S9 (cos=-0.0023 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1791) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.188480)
[S4] loaded HEAD from S2 (vec_in norm=1.188480)
[S4] cosine check vs S2: cos=0.0190
[S4] BUFFERED delta from S2 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:36610
[S17] sending update (kind=head size=1791 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1791) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.202313)
[S9] loaded HEAD from S17 (vec_in norm=1.202313)
[S9] cosine check vs S17: cos=0.0309
[S9] BUFFERED delta from S17 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.1404 head_norm=1.207619
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.367128e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.3895 head_norm=0.838631 delta_norm=0.836713
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.4159 head_norm=1.188480
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.071346e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.4193 head_norm=0.824100 delta_norm=0.807135
[S2] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=1 metric=0.1398 head_norm=1.146307
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.825674e-01
[S3] stored merged vector for next round verification (round=1)
[S3] DEBUG after merge:  round=1 metric=0.3465 head_norm=0.856910 delta_norm=0.782567
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.195964
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.347362e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.860906 delta_norm=0.834736
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1402 head_norm=1.148012
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.183051e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.3666 head_norm=0.834017 delta_norm=0.818305
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.181578
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.229276e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.743932 delta_norm=0.722928
[S15] aggregate: ACCEPT kept=['S7', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.824100 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.20665611090886782, 'auprc': 0.697178704556134, 'loss_val': 1.3170028048415856, 'psi': 0.40286514836777426}-{'f1_val': 0.4158821818019893, 'auprc': 0.5745660505734437, 'loss_val': 1.3174227766724436, 'psi': 0.4793557293105711}
[S3] START round=2 head_norm_before_train=0.856910 cos_to_last_merge=1.0000 (last merge round=1)
[S3] round=2 local utility u=0.108999 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9950724419917115, 'loss_val': 1.3287924758006249, 'psi': 0.48193301616514883}-{'f1_val': 0.13984006561410703, 'auprc': 0.9214047767923551, 'loss_val': 1.3257875992796795, 'psi': 0.45246595008540624}
[S4] START round=2 head_norm_before_train=0.834017 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.090353 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.6630097681098933, 'loss_val': 1.3311175586494355, 'psi': 0.3493398845810678}-{'f1_val': 0.14022662889518414, 'auprc': 0.6037102816494895, 'loss_val': 1.3339255124125002, 'psi': 0.3256200899969063}
[S5] START round=2 head_norm_before_train=1.149324 (no previous merge yet)
[S5] round=2 local utility u=0.052028 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5460407117008595, 'loss_val': 1.2889506660162697, 'psi': 0.3037734275374867}-{'f1_val': 0.14226190476190476, 'auprc': 0.5264117274708987, 'loss_val': 1.3341205058850114, 'psi': 0.29592183384550236}
[S6] START round=2 head_norm_before_train=1.117466 (no previous merge yet)
[S6] round=2 local utility u=0.032487 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8523669683380174, 'loss_val': 1.2881406090027383, 'psi': 0.4258025565659762}-{'f1_val': 0.14142628205128205, 'auprc': 0.8474213871607931, 'loss_val': 1.3382773197582436, 'psi': 0.42382432409508647}
[S7] START round=2 head_norm_before_train=1.169482 (no previous merge yet)
[S7] round=2 local utility u=0.327117 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.685626726585747, 'loss_val': 1.2992467172077604, 'psi': 0.3594847842717538}-{'f1_val': 0.14205682272909165, 'auprc': 0.4782509591739887, 'loss_val': 1.3313524916792763, 'psi': 0.2765344773070505}
[S8] START round=2 head_norm_before_train=1.229936 (no previous merge yet)
[S8] round=2 local utility u=0.048802 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6720390002543846, 'loss_val': 1.2708762380737069, 'psi': 0.35278918953752814}-{'f1_val': 0.13995598239295717, 'auprc': 0.6549598222422176, 'loss_val': 1.3172434723363606, 'psi': 0.34595751833266136}
[S9] START round=2 head_norm_before_train=0.860906 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.029097 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9988902581560406, 'loss_val': 1.3030506288964236, 'psi': 0.48439487754641386}-{'f1_val': 0.141397957139996, 'auprc': 0.9733870066062971, 'loss_val': 1.2847342564480948, 'psi': 0.4741935769265165}
[S10] START round=2 head_norm_before_train=1.174475 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6198398203507877, 'loss_val': 1.2663162073570131, 'psi': 0.3311089106653494}-{'f1_val': 0.13862163754172394, 'auprc': 0.7604188961766243, 'loss_val': 1.3189270031919835, 'psi': 0.3873405409956841}
[S11] START round=2 head_norm_before_train=1.179136 (no previous merge yet)
[S11] round=2 local utility u=0.122822 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7703683549996196, 'loss_val': 1.2968070043562068, 'psi': 0.39239555202371423}-{'f1_val': 0.14041368337311058, 'auprc': 0.7000843436404068, 'loss_val': 1.331599839522009, 'psi': 0.36428194748002907}
[S13] START round=2 head_norm_before_train=1.161223 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7223826707249958, 'loss_val': 1.2920584281870817, 'psi': 0.3731845258362302}-{'f1_val': 0.37327452350452234, 'auprc': 0.7243465529024175, 'loss_val': 1.3281046427769847, 'psi': 0.5137033352636804}
[S14] START round=2 head_norm_before_train=0.838631 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.467409 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8026231221696019, 'loss_val': 1.344984941412969, 'psi': 0.405263960597463}-{'f1_val': 0.14035785288270378, 'auprc': 0.485161124916378, 'loss_val': 1.3274173449620632, 'psi': 0.27827916169617345}
[S15] START round=2 head_norm_before_train=0.743932 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.001865 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7669641120578167, 'loss_val': 1.3315466688943922, 'psi': 0.3906258356400617}-{'f1_val': 0.13973365136155833, 'auprc': 0.7675528146654966, 'loss_val': 1.3370430390684431, 'psi': 0.3908613166831337}
[S16] START round=2 head_norm_before_train=1.185471 (no previous merge yet)
[S16] round=2 local utility u=0.015909 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.99058074471604, 'loss_val': 1.281172303534474, 'psi': 0.48061476800593794}-{'f1_val': 0.14063745019920318, 'auprc': 0.9916731589689616, 'loss_val': 1.316267397835671, 'psi': 0.4810517337071065}
[S17] START round=2 head_norm_before_train=1.202313 (no previous merge yet)
[S17] round=2 local utility u=0.046661 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.542774850610772, 'loss_val': 1.3030685357252771, 'psi': 0.3016793182347395}-{'f1_val': 0.14094896331738438, 'auprc': 0.522685361647263, 'loss_val': 1.3361212530747781, 'psi': 0.2936435226493358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S8] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:36603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:36603
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:36617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:36617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:36613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:36614
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:36602
[S5] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1788 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.143220)
[S3] loaded HEAD from S6 (vec_in norm=1.143220)
[S3] cosine check vs S6: cos=-0.1462
[S3] DROPPED delta from S6 (cos=-0.1462 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1789) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.256949)
[S7] loaded HEAD from S8 (vec_in norm=1.256949)
[S7] cosine check vs S8: cos=0.0315
[S7] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1788) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.201880)
[S13] loaded HEAD from S11 (vec_in norm=1.201880)
[S13] cosine check vs S11: cos=-0.0629
[S13] DROPPED delta from S11 (cos=-0.0629 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1792) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.174659)
[S3] loaded HEAD from S5 (vec_in norm=1.174659)
[S3] cosine check vs S5: cos=-0.0616
[S3] DROPPED delta from S5 (cos=-0.0616 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1791) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.191948)
[S16] loaded HEAD from S7 (vec_in norm=1.191948)
[S16] cosine check vs S7: cos=0.0810
[S16] BUFFERED delta from S7 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.880371)
[S17] loaded HEAD from S3 (vec_in norm=0.880371)
[S17] cosine check vs S3: cos=-0.0273
[S17] DROPPED delta from S3 (cos=-0.0273 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.211006)
[S14] loaded HEAD from S16 (vec_in norm=1.211006)
[S14] cosine check vs S16: cos=0.0757
[S14] BUFFERED delta from S16 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1794) from S15
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.764560)
[S2] loaded HEAD from S15 (vec_in norm=0.764560)
[S2] cosine check vs S15: cos=0.0719
[S2] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1797) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.880642)
[S2] loaded HEAD from S9 (vec_in norm=0.880642)
[S2] cosine check vs S9: cos=-0.1182
[S2] DROPPED delta from S9 (cos=-0.1182 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.854724)
[S4] loaded HEAD from S14 (vec_in norm=0.854724)
[S4] cosine check vs S14: cos=-0.0754
[S4] DROPPED delta from S14 (cos=-0.0754 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S4
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.854166)
[S17] loaded HEAD from S4 (vec_in norm=0.854166)
[S17] cosine check vs S4: cos=-0.0930
[S17] DROPPED delta from S4 (cos=-0.0930 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:36614
[S17] sending update (kind=head size=1793 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1793) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.234657)
[S14] loaded HEAD from S17 (vec_in norm=1.234657)
[S14] cosine check vs S17: cos=-0.0937
[S14] DROPPED delta from S17 (cos=-0.0937 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.2067 head_norm=0.842905
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.482537e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.2532 head_norm=0.589015 delta_norm=0.548254
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=2 metric=0.1404 head_norm=0.854724
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.142090e-01
[S14] stored merged vector for next round verification (round=2)
[S14] DEBUG after merge:  round=2 metric=0.1042 head_norm=0.767105 delta_norm=0.714209
[S14] aggregate: ROLLBACK (f1_val pre=0.140 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=1.211006
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.144521e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.883349 delta_norm=0.814452
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=2 metric=0.1421 head_norm=1.191948
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.523987e-01
[S7] stored merged vector for next round verification (round=2)
[S7] DEBUG after merge:  round=2 metric=0.1421 head_norm=0.879629 delta_norm=0.852399
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.589015 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7733381757002785, 'loss_val': 1.299070940632914, 'psi': 0.39440155031325147}-{'f1_val': 0.20665611090886782, 'auprc': 0.697178704556134, 'loss_val': 1.3170028048415856, 'psi': 0.40286514836777426}
[S3] START round=3 head_norm_before_train=0.880371 cos_to_last_merge=0.9970 (last merge round=1)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9542534463363843, 'loss_val': 1.2970824074981495, 'psi': 0.465605417903018}-{'f1_val': 0.13984006561410703, 'auprc': 0.9950724419917115, 'loss_val': 1.3287924758006249, 'psi': 0.48193301616514883}
[S4] START round=3 head_norm_before_train=0.854166 cos_to_last_merge=0.9967 (last merge round=1)
[S4] round=3 local utility u=0.196957 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7809669933399883, 'loss_val': 1.2910761575357024, 'psi': 0.3965227746731058}-{'f1_val': 0.14022662889518414, 'auprc': 0.6630097681098933, 'loss_val': 1.3311175586494355, 'psi': 0.3493398845810678}
[S5] START round=3 head_norm_before_train=1.174659 (no previous merge yet)
[S5] round=3 local utility u=0.311054 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7361188128056968, 'loss_val': 1.2370764336120033, 'psi': 0.3798046679794216}-{'f1_val': 0.14226190476190476, 'auprc': 0.5460407117008595, 'loss_val': 1.2889506660162697, 'psi': 0.3037734275374867}
[S6] START round=3 head_norm_before_train=1.143220 (no previous merge yet)
[S6] round=3 local utility u=0.009053 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8407041996749407, 'loss_val': 1.2350458555224593, 'psi': 0.4211374491007455}-{'f1_val': 0.14142628205128205, 'auprc': 0.8523669683380174, 'loss_val': 1.2881406090027383, 'psi': 0.4258025565659762}
[S7] START round=3 head_norm_before_train=0.879629 cos_to_last_merge=1.0000 (last merge round=2)
[S7] round=3 local utility u=0.077865 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7372667567464308, 'loss_val': 1.2984365733983034, 'psi': 0.3801407963360273}-{'f1_val': 0.14205682272909165, 'auprc': 0.685626726585747, 'loss_val': 1.2992467172077604, 'psi': 0.3594847842717538}
[S8] START round=3 head_norm_before_train=1.256949 (no previous merge yet)
[S8] round=3 local utility u=0.127463 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7372504179037398, 'loss_val': 1.211583633361395, 'psi': 0.37887375659727024}-{'f1_val': 0.13995598239295717, 'auprc': 0.6720390002543846, 'loss_val': 1.2708762380737069, 'psi': 0.35278918953752814}
[S9] START round=3 head_norm_before_train=0.880642 cos_to_last_merge=0.9967 (last merge round=1)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8897269601197111, 'loss_val': 1.2461065692252444, 'psi': 0.44072955833188204}-{'f1_val': 0.141397957139996, 'auprc': 0.9988902581560406, 'loss_val': 1.3030506288964236, 'psi': 0.48439487754641386}
[S10] START round=3 head_norm_before_train=1.204866 (no previous merge yet)
[S10] round=3 local utility u=0.010518 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6038925884117542, 'loss_val': 1.1974390629414204, 'psi': 0.32473001788973604}-{'f1_val': 0.13862163754172394, 'auprc': 0.6198398203507877, 'loss_val': 1.2663162073570131, 'psi': 0.3311089106653494}
[S11] START round=3 head_norm_before_train=1.201880 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7514928030192233, 'loss_val': 1.2576427613022685, 'psi': 0.3848453312315557}-{'f1_val': 0.14041368337311058, 'auprc': 0.7703683549996196, 'loss_val': 1.2968070043562068, 'psi': 0.39239555202371423}
[S13] START round=3 head_norm_before_train=1.183073 (no previous merge yet)
[S13] round=3 local utility u=0.015012 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7199621785583763, 'loss_val': 1.254773055543348, 'psi': 0.3722163289695824}-{'f1_val': 0.1403857625770531, 'auprc': 0.7223826707249958, 'loss_val': 1.2920584281870817, 'psi': 0.3731845258362302}
[S14] START round=3 head_norm_before_train=0.767105 cos_to_last_merge=1.0000 (last merge round=2)
[S14] round=3 local utility u=0.214947 metrics={'f1_val': 0.3940609007643586, 'auprc': 0.439001689172724, 'loss_val': 1.3464447732439941, 'psi': 0.4120372161277048}-{'f1_val': 0.14035785288270378, 'auprc': 0.8026231221696019, 'loss_val': 1.344984941412969, 'psi': 0.405263960597463}
[S15] START round=3 head_norm_before_train=0.764560 cos_to_last_merge=0.9961 (last merge round=1)
[S15] round=3 local utility u=0.020723 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7691509835886778, 'loss_val': 1.2966620101525197, 'psi': 0.39150058425240614}-{'f1_val': 0.13973365136155833, 'auprc': 0.7669641120578167, 'loss_val': 1.3315466688943922, 'psi': 0.3906258356400617}
[S16] START round=3 head_norm_before_train=0.883349 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9845272061052075, 'loss_val': 1.2792410298375465, 'psi': 0.4781933525616049}-{'f1_val': 0.14063745019920318, 'auprc': 0.99058074471604, 'loss_val': 1.281172303534474, 'psi': 0.48061476800593794}
[S17] START round=3 head_norm_before_train=1.234657 (no previous merge yet)
[S17] round=3 local utility u=0.233271 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6818823168163373, 'loss_val': 1.2538496533786059, 'psi': 0.3573223047169655}-{'f1_val': 0.14094896331738438, 'auprc': 0.542774850610772, 'loss_val': 1.3030685357252771, 'psi': 0.3016793182347395}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:36616
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:36608
[S13] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1791) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.794511)
[S4] loaded HEAD from S15 (vec_in norm=0.794511)
[S4] cosine check vs S15: cos=0.0697
[S4] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1792) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.883379)
[S16] loaded HEAD from S4 (vec_in norm=0.883379)
[S16] cosine check vs S4: cos=0.0181
[S16] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1789) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.210281)
[S7] loaded HEAD from S13 (vec_in norm=1.210281)
[S7] cosine check vs S13: cos=-0.0778
[S7] DROPPED delta from S13 (cos=-0.0778 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S5
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.202604)
[S7] loaded HEAD from S5 (vec_in norm=1.202604)
[S7] cosine check vs S5: cos=-0.0522
[S7] DROPPED delta from S5 (cos=-0.0522 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.291285)
[S9] loaded HEAD from S8 (vec_in norm=1.291285)
[S9] cosine check vs S8: cos=-0.0606
[S9] DROPPED delta from S8 (cos=-0.0606 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.175509)
[S4] loaded HEAD from S6 (vec_in norm=1.175509)
[S4] cosine check vs S6: cos=-0.0122
[S4] DROPPED delta from S6 (cos=-0.0122 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.781191)
[S7] loaded HEAD from S14 (vec_in norm=0.781191)
[S7] cosine check vs S14: cos=0.0273
[S7] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1791) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.900397)
[S6] loaded HEAD from S7 (vec_in norm=0.900397)
[S6] cosine check vs S7: cos=0.1116
[S6] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1795) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.241281)
[S6] loaded HEAD from S10 (vec_in norm=1.241281)
[S6] cosine check vs S10: cos=-0.1460
[S6] DROPPED delta from S10 (cos=-0.1460 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.268123)
[S13] loaded HEAD from S17 (vec_in norm=1.268123)
[S13] cosine check vs S17: cos=-0.0594
[S13] DROPPED delta from S17 (cos=-0.0594 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=1.175509
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.993549e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.779212 delta_norm=0.699355
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1402 head_norm=0.883379
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.730847e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.4147 head_norm=0.614310 delta_norm=0.573085
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=0.900397
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.879263e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.604012 delta_norm=0.587926
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=0.908742
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.279066e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.639389 delta_norm=0.627907
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.608648 cos_to_last_merge=0.9919 (last merge round=2)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6161330319856385, 'loss_val': 1.235549321466947, 'psi': 0.33151949282739546}-{'f1_val': 0.1417771333885667, 'auprc': 0.7733381757002785, 'loss_val': 1.299070940632914, 'psi': 0.39440155031325147}
[S3] START round=4 head_norm_before_train=0.913679 cos_to_last_merge=0.9891 (last merge round=1)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9062631083849634, 'loss_val': 1.25817067855166, 'psi': 0.4464092827224496}-{'f1_val': 0.13984006561410703, 'auprc': 0.9542534463363843, 'loss_val': 1.2970824074981495, 'psi': 0.465605417903018}
[S4] START round=4 head_norm_before_train=0.614310 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.011836 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7844952228080746, 'loss_val': 1.2779893304778354, 'psi': 0.39793406646034035}-{'f1_val': 0.14022662889518414, 'auprc': 0.7809669933399883, 'loss_val': 1.2910761575357024, 'psi': 0.3965227746731058}
[S5] START round=4 head_norm_before_train=1.202604 (no previous merge yet)
[S5] round=4 local utility u=0.048359 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.752173628420299, 'loss_val': 1.1885225391253553, 'psi': 0.38622659422526245}-{'f1_val': 0.14226190476190476, 'auprc': 0.7361188128056968, 'loss_val': 1.2370764336120033, 'psi': 0.3798046679794216}
[S6] START round=4 head_norm_before_train=0.779212 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.656083694060603, 'loss_val': 1.232136093563578, 'psi': 0.3472892468550104}-{'f1_val': 0.14142628205128205, 'auprc': 0.8407041996749407, 'loss_val': 1.2350458555224593, 'psi': 0.4211374491007455}
[S7] START round=4 head_norm_before_train=0.604012 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.049436 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7711133856573686, 'loss_val': 1.3011045879997607, 'psi': 0.3936794479004025}-{'f1_val': 0.14205682272909165, 'auprc': 0.7372667567464308, 'loss_val': 1.2984365733983034, 'psi': 0.3801407963360273}
[S8] START round=4 head_norm_before_train=1.291285 (no previous merge yet)
[S8] round=4 local utility u=1.000000 metrics={'f1_val': 0.5544568075042816, 'auprc': 0.766131282083556, 'loss_val': 1.132436794449893, 'psi': 0.6391265973359914}-{'f1_val': 0.13995598239295717, 'auprc': 0.7372504179037398, 'loss_val': 1.211583633361395, 'psi': 0.37887375659727024}
[S9] START round=4 head_norm_before_train=0.910596 cos_to_last_merge=0.9871 (last merge round=1)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8657308453051565, 'loss_val': 1.1790051716753456, 'psi': 0.4311311124060602}-{'f1_val': 0.141397957139996, 'auprc': 0.8897269601197111, 'loss_val': 1.2461065692252444, 'psi': 0.44072955833188204}
[S10] START round=4 head_norm_before_train=1.241281 (no previous merge yet)
[S10] round=4 local utility u=0.042594 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.606679695488835, 'loss_val': 1.1206118355631591, 'psi': 0.3258448607205684}-{'f1_val': 0.13862163754172394, 'auprc': 0.6038925884117542, 'loss_val': 1.1974390629414204, 'psi': 0.32473001788973604}
[S11] START round=4 head_norm_before_train=1.232904 (no previous merge yet)
[S11] round=4 local utility u=0.021614 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7545919327595338, 'loss_val': 1.2237122282870883, 'psi': 0.3860849831276799}-{'f1_val': 0.14041368337311058, 'auprc': 0.7514928030192233, 'loss_val': 1.2576427613022685, 'psi': 0.3848453312315557}
[S13] START round=4 head_norm_before_train=1.210281 (no previous merge yet)
[S13] round=4 local utility u=0.016395 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7180339315851929, 'loss_val': 1.2161987243761894, 'psi': 0.371445030180309}-{'f1_val': 0.1403857625770531, 'auprc': 0.7199621785583763, 'loss_val': 1.254773055543348, 'psi': 0.3722163289695824}
[S14] START round=4 head_norm_before_train=0.781191 cos_to_last_merge=0.9964 (last merge round=2)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6549682631423477, 'loss_val': 1.3281563796919933, 'psi': 0.34620201698656133}-{'f1_val': 0.3940609007643586, 'auprc': 0.439001689172724, 'loss_val': 1.3464447732439941, 'psi': 0.4120372161277048}
[S15] START round=4 head_norm_before_train=0.794511 cos_to_last_merge=0.9864 (last merge round=1)
[S15] round=4 local utility u=0.025031 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7744649054547889, 'loss_val': 1.262541742697584, 'psi': 0.39362615299885056}-{'f1_val': 0.13973365136155833, 'auprc': 0.7691509835886778, 'loss_val': 1.2966620101525197, 'psi': 0.39150058425240614}
[S16] START round=4 head_norm_before_train=0.639389 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8000298557233806, 'loss_val': 1.2711165305169345, 'psi': 0.4043944124088742}-{'f1_val': 0.14063745019920318, 'auprc': 0.9845272061052075, 'loss_val': 1.2792410298375465, 'psi': 0.4781933525616049}
[S17] START round=4 head_norm_before_train=1.268123 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5746972083333924, 'loss_val': 1.1693760051911886, 'psi': 0.3144482613237876}-{'f1_val': 0.14094896331738438, 'auprc': 0.6818823168163373, 'loss_val': 1.2538496533786059, 'psi': 0.3573223047169655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:36602
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:36607
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:36608
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:36607
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:36604
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.245094)
[S7] loaded HEAD from S13 (vec_in norm=1.245094)
[S7] cosine check vs S13: cos=0.2260
[S7] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S5
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.232068)
[S7] loaded HEAD from S5 (vec_in norm=1.232068)
[S7] cosine check vs S5: cos=-0.0437
[S7] DROPPED delta from S5 (cos=-0.0437 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.261326)
[S2] loaded HEAD from S11 (vec_in norm=1.261326)
[S2] cosine check vs S11: cos=-0.0558
[S2] DROPPED delta from S11 (cos=-0.0558 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1796) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.826820)
[S4] loaded HEAD from S15 (vec_in norm=0.826820)
[S4] cosine check vs S15: cos=0.6647
[S4] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.325924)
[S9] loaded HEAD from S8 (vec_in norm=1.325924)
[S9] cosine check vs S8: cos=-0.0549
[S9] DROPPED delta from S8 (cos=-0.0549 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.276853)
[S6] loaded HEAD from S10 (vec_in norm=1.276853)
[S6] cosine check vs S10: cos=-0.1765
[S6] DROPPED delta from S10 (cos=-0.1765 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.620617)
[S6] loaded HEAD from S7 (vec_in norm=0.620617)
[S6] cosine check vs S7: cos=0.5071
[S6] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1804) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.647898)
[S16] loaded HEAD from S4 (vec_in norm=0.647898)
[S16] cosine check vs S4: cos=0.7998
[S16] BUFFERED delta from S4 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=4 metric=0.1414 head_norm=0.814602
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.660757e-01
[S6] stored merged vector for next round verification (round=4)
[S6] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.624788 delta_norm=0.366076
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=0.620617
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.297111e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1421 head_norm=0.755762 delta_norm=0.629711
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.1402 head_norm=0.647898
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.127359e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.4124 head_norm=0.673719 delta_norm=0.312736
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.663979
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.076775e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.622246 delta_norm=0.207677
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.643060 cos_to_last_merge=0.9693 (last merge round=2)
[S2] round=5 local utility u=0.019611 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6128853889884173, 'loss_val': 1.1865850631294987, 'psi': 0.33022043562850695}-{'f1_val': 0.1417771333885667, 'auprc': 0.6161330319856385, 'loss_val': 1.235549321466947, 'psi': 0.33151949282739546}
[S3] START round=5 head_norm_before_train=0.954077 cos_to_last_merge=0.9783 (last merge round=1)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8764794443542894, 'loss_val': 1.217537517282428, 'psi': 0.43449581711018004}-{'f1_val': 0.13984006561410703, 'auprc': 0.9062631083849634, 'loss_val': 1.25817067855166, 'psi': 0.4464092827224496}
[S4] START round=5 head_norm_before_train=0.673719 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.037954 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7946724130760268, 'loss_val': 1.232612655690065, 'psi': 0.40200494256752123}-{'f1_val': 0.14022662889518414, 'auprc': 0.7844952228080746, 'loss_val': 1.2779893304778354, 'psi': 0.39793406646034035}
[S5] START round=5 head_norm_before_train=1.232068 (no previous merge yet)
[S5] round=5 local utility u=0.892206 metrics={'f1_val': 0.4161372689328349, 'auprc': 0.7758177833408789, 'loss_val': 1.1182945710331358, 'psi': 0.5600094746960526}-{'f1_val': 0.14226190476190476, 'auprc': 0.752173628420299, 'loss_val': 1.1885225391253553, 'psi': 0.38622659422526245}
[S6] START round=5 head_norm_before_train=0.624788 cos_to_last_merge=1.0000 (last merge round=4)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6515884790162041, 'loss_val': 1.2285214434577734, 'psi': 0.34549116083725084}-{'f1_val': 0.14142628205128205, 'auprc': 0.656083694060603, 'loss_val': 1.232136093563578, 'psi': 0.3472892468550104}
[S7] START round=5 head_norm_before_train=0.755762 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.754291929942831, 'loss_val': 1.320811346296317, 'psi': 0.3869508656145874}-{'f1_val': 0.14205682272909165, 'auprc': 0.7711133856573686, 'loss_val': 1.3011045879997607, 'psi': 0.3936794479004025}
[S8] START round=5 head_norm_before_train=1.325924 (no previous merge yet)
[S8] round=5 local utility u=0.537234 metrics={'f1_val': 0.7153199448606985, 'auprc': 0.7673058077125587, 'loss_val': 1.026670228033991, 'psi': 0.7361142900014426}-{'f1_val': 0.5544568075042816, 'auprc': 0.766131282083556, 'loss_val': 1.132436794449893, 'psi': 0.6391265973359914}
[S9] START round=5 head_norm_before_train=0.945689 cos_to_last_merge=0.9749 (last merge round=1)
[S9] round=5 local utility u=0.056639 metrics={'f1_val': 0.141397957139996, 'auprc': 0.864746726554529, 'loss_val': 1.062775740744723, 'psi': 0.4307374649058092}-{'f1_val': 0.141397957139996, 'auprc': 0.8657308453051565, 'loss_val': 1.1790051716753456, 'psi': 0.4311311124060602}
[S10] START round=5 head_norm_before_train=1.276853 (no previous merge yet)
[S10] round=5 local utility u=0.967955 metrics={'f1_val': 0.41686877877211803, 'auprc': 0.6532602901489015, 'loss_val': 0.9939259073462151, 'psi': 0.5114253833228315}-{'f1_val': 0.13862163754172394, 'auprc': 0.606679695488835, 'loss_val': 1.1206118355631591, 'psi': 0.3258448607205684}
[S11] START round=5 head_norm_before_train=1.261326 (no previous merge yet)
[S11] round=5 local utility u=0.084430 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7903555244536226, 'loss_val': 1.1621436886983472, 'psi': 0.40039041980531537}-{'f1_val': 0.14041368337311058, 'auprc': 0.7545919327595338, 'loss_val': 1.2237122282870883, 'psi': 0.3860849831276799}
[S13] START round=5 head_norm_before_train=1.245094 (no previous merge yet)
[S13] round=5 local utility u=0.028313 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7197983875437026, 'loss_val': 1.1648652982555836, 'psi': 0.3721508125637129}-{'f1_val': 0.1403857625770531, 'auprc': 0.7180339315851929, 'loss_val': 1.2161987243761894, 'psi': 0.371445030180309}
[S14] START round=5 head_norm_before_train=0.800825 cos_to_last_merge=0.9880 (last merge round=2)
[S14] round=5 local utility u=0.310214 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8529832884046804, 'loss_val': 1.301772845134654, 'psi': 0.42540802709149445}-{'f1_val': 0.14035785288270378, 'auprc': 0.6549682631423477, 'loss_val': 1.3281563796919933, 'psi': 0.34620201698656133}
[S15] START round=5 head_norm_before_train=0.826820 cos_to_last_merge=0.9747 (last merge round=1)
[S15] round=5 local utility u=0.021737 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.77651553048315, 'loss_val': 1.2252197208975966, 'psi': 0.394446403010195}-{'f1_val': 0.13973365136155833, 'auprc': 0.7744649054547889, 'loss_val': 1.262541742697584, 'psi': 0.39362615299885056}
[S16] START round=5 head_norm_before_train=0.622246 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6181612448609218, 'loss_val': 1.2239463624793618, 'psi': 0.33164696806389066}-{'f1_val': 0.14063745019920318, 'auprc': 0.8000298557233806, 'loss_val': 1.2711165305169345, 'psi': 0.4043944124088742}
[S17] START round=5 head_norm_before_train=1.306290 (no previous merge yet)
[S17] round=5 local utility u=0.850577 metrics={'f1_val': 0.38284681408869453, 'auprc': 0.6065791155208705, 'loss_val': 1.015254570957214, 'psi': 0.4723397346615649}-{'f1_val': 0.14094896331738438, 'auprc': 0.5746972083333924, 'loss_val': 1.1693760051911886, 'psi': 0.3144482613237876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:36608
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:36610
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:36605
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.361051)
[S9] loaded HEAD from S8 (vec_in norm=1.361051)
[S9] cosine check vs S8: cos=-0.0501
[S9] DROPPED delta from S8 (cos=-0.0501 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.703829)
[S16] loaded HEAD from S4 (vec_in norm=0.703829)
[S16] cosine check vs S4: cos=0.8410
[S16] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.679572)
[S4] loaded HEAD from S2 (vec_in norm=0.679572)
[S4] cosine check vs S2: cos=0.6773
[S4] BUFFERED delta from S2 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1795) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.281963)
[S2] loaded HEAD from S11 (vec_in norm=1.281963)
[S2] cosine check vs S11: cos=-0.0541
[S2] DROPPED delta from S11 (cos=-0.0541 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.983360)
[S5] loaded HEAD from S9 (vec_in norm=0.983360)
[S5] cosine check vs S9: cos=-0.0252
[S5] DROPPED delta from S9 (cos=-0.0252 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.828728)
[S7] loaded HEAD from S14 (vec_in norm=0.828728)
[S7] cosine check vs S14: cos=0.6171
[S7] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1792) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.301224)
[S6] loaded HEAD from S10 (vec_in norm=1.301224)
[S6] cosine check vs S10: cos=-0.1565
[S6] DROPPED delta from S10 (cos=-0.1565 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1804) from S5
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.252780)
[S7] loaded HEAD from S5 (vec_in norm=1.252780)
[S7] cosine check vs S5: cos=-0.0096
[S7] DROPPED delta from S5 (cos=-0.0096 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1790) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.274202)
[S7] loaded HEAD from S13 (vec_in norm=1.274202)
[S7] cosine check vs S13: cos=0.8934
[S7] BUFFERED delta from S13 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1798) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.861287)
[S4] loaded HEAD from S15 (vec_in norm=0.861287)
[S4] cosine check vs S15: cos=0.9011
[S4] BUFFERED delta from S15 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.345034)
[S13] loaded HEAD from S17 (vec_in norm=1.345034)
[S13] cosine check vs S17: cos=-0.0509
[S13] DROPPED delta from S17 (cos=-0.0509 < 0.0)
[S6] ⇄ pheromone p=0.370 → S4@127.0.0.1:36604
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.763315
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.853437e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.814861 delta_norm=0.185344
[S7] aggregate: ACCEPT kept=['S14', 'S13'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.408 → S6@127.0.0.1:36607
[S3] ⇄ pheromone p=0.380 → S6@127.0.0.1:36607
[S11] ⇄ pheromone p=0.397 → S2@127.0.0.1:36602
[S10] ⇄ pheromone p=0.530 → S6@127.0.0.1:36607
[S15] ⇄ pheromone p=0.339 → S4@127.0.0.1:36604
[S2] ⇄ pheromone p=0.414 → S4@127.0.0.1:36604
[S5] ⇄ pheromone p=0.567 → S7@127.0.0.1:36608
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.1402 head_norm=0.703829
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.545288e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.1510 head_norm=0.677478 delta_norm=0.154529
[S4] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.376 → S16@127.0.0.1:36616
[S13] ⇄ pheromone p=0.405 → S7@127.0.0.1:36608
[S9] ⇄ pheromone p=0.345 → S5@127.0.0.1:36605
[S8] ⇄ pheromone p=0.618 → S9@127.0.0.1:36610
[S14] ⇄ pheromone p=0.473 → S7@127.0.0.1:36608
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.651184
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.926939e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.650059 delta_norm=0.192694
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.344 → S7@127.0.0.1:36608
[S17] ⇄ pheromone p=0.534 → S13@127.0.0.1:36613
[S2] START round=6 head_norm_before_train=0.679572 cos_to_last_merge=0.9440 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.944
[S2] round=6 local utility u=1.000000 metrics={'f1_val': 0.4158821818019893, 'auprc': 0.767194080220445, 'loss_val': 1.1227220935259636, 'psi': 0.5564069411693716}-{'f1_val': 0.1417771333885667, 'auprc': 0.6128853889884173, 'loss_val': 1.1865850631294987, 'psi': 0.33022043562850695}
[S3] START round=6 head_norm_before_train=0.996865 cos_to_last_merge=0.9666 (last merge round=1)
[S3] round=6 local utility u=0.100779 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9101255648672535, 'loss_val': 1.1169188231473657, 'psi': 0.44795426531536564}-{'f1_val': 0.13984006561410703, 'auprc': 0.8764794443542894, 'loss_val': 1.217537517282428, 'psi': 0.43449581711018004}
[S4] START round=6 head_norm_before_train=0.677478 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.027312 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7942307892584752, 'loss_val': 1.1766628017662801, 'psi': 0.4018282930405006}-{'f1_val': 0.14022662889518414, 'auprc': 0.7946724130760268, 'loss_val': 1.232612655690065, 'psi': 0.40200494256752123}
[S5] START round=6 head_norm_before_train=1.252780 (no previous merge yet)
[S5] round=6 local utility u=0.046373 metrics={'f1_val': 0.41754956401939425, 'auprc': 0.7774788475401126, 'loss_val': 1.0390047722079023, 'psi': 0.5615212774276817}-{'f1_val': 0.4161372689328349, 'auprc': 0.7758177833408789, 'loss_val': 1.1182945710331358, 'psi': 0.5600094746960526}
[S6] START round=6 head_norm_before_train=0.658142 cos_to_last_merge=0.9947 (last merge round=4)
[S6] round=6 local utility u=0.035275 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6508733816718045, 'loss_val': 1.1558269104523937, 'psi': 0.34520512189949104}-{'f1_val': 0.14142628205128205, 'auprc': 0.6515884790162041, 'loss_val': 1.2285214434577734, 'psi': 0.34549116083725084}
[S7] START round=6 head_norm_before_train=0.814861 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5876178157508118, 'loss_val': 1.3094417665429305, 'psi': 0.32028121993777975}-{'f1_val': 0.14205682272909165, 'auprc': 0.754291929942831, 'loss_val': 1.320811346296317, 'psi': 0.3869508656145874}
[S8] START round=6 head_norm_before_train=1.361051 (no previous merge yet)
[S8] round=6 local utility u=0.109511 metrics={'f1_val': 0.7150337453891538, 'auprc': 0.7767294123039219, 'loss_val': 0.8342020106392648, 'psi': 0.7397120121550611}-{'f1_val': 0.7153199448606985, 'auprc': 0.7673058077125587, 'loss_val': 1.026670228033991, 'psi': 0.7361142900014426}
[S9] START round=6 head_norm_before_train=0.983360 cos_to_last_merge=0.9617 (last merge round=1)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.7002705913112235, 'auprc': 0.9942039077237302, 'loss_val': 0.8629251413345121, 'psi': 0.8178439178762262}-{'f1_val': 0.141397957139996, 'auprc': 0.864746726554529, 'loss_val': 1.062775740744723, 'psi': 0.4307374649058092}
[S10] START round=6 head_norm_before_train=1.301224 (no previous merge yet)
[S10] round=6 local utility u=0.427763 metrics={'f1_val': 0.436571474908696, 'auprc': 0.8404770439621077, 'loss_val': 0.8182656312742355, 'psi': 0.5981337025300607}-{'f1_val': 0.41686877877211803, 'auprc': 0.6532602901489015, 'loss_val': 0.9939259073462151, 'psi': 0.5114253833228315}
[S11] START round=6 head_norm_before_train=1.281963 (no previous merge yet)
[S11] round=6 local utility u=0.678765 metrics={'f1_val': 0.34792952572342994, 'auprc': 0.7939651711148984, 'loss_val': 1.060538285834424, 'psi': 0.5263437838800173}-{'f1_val': 0.14041368337311058, 'auprc': 0.7903555244536226, 'loss_val': 1.1621436886983472, 'psi': 0.40039041980531537}
[S13] START round=6 head_norm_before_train=1.274202 (no previous merge yet)
[S13] round=6 local utility u=1.000000 metrics={'f1_val': 0.6758495050647856, 'auprc': 0.716025824182853, 'loss_val': 1.0718689495713747, 'psi': 0.6919200327120125}-{'f1_val': 0.1403857625770531, 'auprc': 0.7197983875437026, 'loss_val': 1.1648652982555836, 'psi': 0.3721508125637129}
[S14] START round=6 head_norm_before_train=0.828728 cos_to_last_merge=0.9748 (last merge round=2)
[S14] round=6 local utility u=0.032143 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8597805245026732, 'loss_val': 1.257877899242427, 'psi': 0.42812692153069154}-{'f1_val': 0.14035785288270378, 'auprc': 0.8529832884046804, 'loss_val': 1.301772845134654, 'psi': 0.42540802709149445}
[S15] START round=6 head_norm_before_train=0.861287 cos_to_last_merge=0.9625 (last merge round=1)
[S15] round=6 local utility u=0.177812 metrics={'f1_val': 0.18778245292896342, 'auprc': 0.7767023917147882, 'loss_val': 1.1584495561724766, 'psi': 0.4233504284432933}-{'f1_val': 0.13973365136155833, 'auprc': 0.77651553048315, 'loss_val': 1.2252197208975966, 'psi': 0.394446403010195}
[S16] START round=6 head_norm_before_train=0.650059 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.663908 metrics={'f1_val': 0.3885115275785111, 'auprc': 0.5348535245113037, 'loss_val': 1.1334518291809654, 'psi': 0.44704832635162817}-{'f1_val': 0.14063745019920318, 'auprc': 0.6181612448609218, 'loss_val': 1.2239463624793618, 'psi': 0.33164696806389066}
[S17] START round=6 head_norm_before_train=1.345034 (no previous merge yet)
[S17] round=6 local utility u=0.333742 metrics={'f1_val': 0.3654020146460324, 'auprc': 0.8345762040378799, 'loss_val': 0.927092059219018, 'psi': 0.5530716904027715}-{'f1_val': 0.38284681408869453, 'auprc': 0.6065791155208705, 'loss_val': 1.015254570957214, 'psi': 0.4723397346615649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:36608
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:36604
[S6] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.709647)
[S4] loaded HEAD from S2 (vec_in norm=0.709647)
[S4] cosine check vs S2: cos=0.7595
[S4] BUFFERED delta from S2 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1794) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.304201)
[S7] loaded HEAD from S13 (vec_in norm=1.304201)
[S7] cosine check vs S13: cos=0.9050
[S7] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.865617)
[S7] loaded HEAD from S14 (vec_in norm=0.865617)
[S7] cosine check vs S14: cos=0.6998
[S7] BUFFERED delta from S14 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1797) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.023426)
[S5] loaded HEAD from S9 (vec_in norm=1.023426)
[S5] cosine check vs S9: cos=-0.0270
[S5] DROPPED delta from S9 (cos=-0.0270 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.707959)
[S16] loaded HEAD from S4 (vec_in norm=0.707959)
[S16] cosine check vs S4: cos=0.9283
[S16] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.036296)
[S6] loaded HEAD from S3 (vec_in norm=1.036296)
[S6] cosine check vs S3: cos=-0.1122
[S6] DROPPED delta from S3 (cos=-0.1122 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.688866)
[S7] loaded HEAD from S16 (vec_in norm=0.688866)
[S7] cosine check vs S16: cos=0.2263
[S7] BUFFERED delta from S16 (total buffered=3)
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.334093)
[S6] loaded HEAD from S10 (vec_in norm=1.334093)
[S6] cosine check vs S10: cos=-0.1588
[S6] DROPPED delta from S10 (cos=-0.1588 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.312155)
[S2] loaded HEAD from S11 (vec_in norm=1.312155)
[S2] cosine check vs S11: cos=-0.0552
[S2] DROPPED delta from S11 (cos=-0.0552 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S5
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.272930)
[S7] loaded HEAD from S5 (vec_in norm=1.272930)
[S7] cosine check vs S5: cos=-0.0131
[S7] DROPPED delta from S5 (cos=-0.0131 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.898474)
[S4] loaded HEAD from S15 (vec_in norm=0.898474)
[S4] cosine check vs S15: cos=0.9017
[S4] BUFFERED delta from S15 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.685455)
[S4] loaded HEAD from S6 (vec_in norm=0.685455)
[S4] cosine check vs S6: cos=0.3563
[S4] BUFFERED delta from S6 (total buffered=3)
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.404005)
[S9] loaded HEAD from S8 (vec_in norm=1.404005)
[S9] cosine check vs S8: cos=-0.0459
[S9] DROPPED delta from S8 (cos=-0.0459 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.390650)
[S13] loaded HEAD from S17 (vec_in norm=1.390650)
[S13] cosine check vs S17: cos=-0.0464
[S13] DROPPED delta from S17 (cos=-0.0464 < 0.0)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.817677
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.084223e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.725039 delta_norm=0.208422
[S7] aggregate: ACCEPT kept=['S13', 'S14', 'S16'] (k=3/3) mode=median trim_p=0.1
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.1402 head_norm=0.707959
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.757775e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.1402 head_norm=0.634313 delta_norm=0.175777
[S4] aggregate: ACCEPT kept=['S2', 'S15', 'S6'] (k=3/3) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.3885 head_norm=0.688866
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.325418e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.4139 head_norm=0.685787 delta_norm=0.132542
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.709647 cos_to_last_merge=0.9248 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.925
[S2] round=7 local utility u=0.047488 metrics={'f1_val': 0.4168984104266471, 'auprc': 0.7685025394848564, 'loss_val': 1.0377683857924473, 'psi': 0.5575400620499309}-{'f1_val': 0.4158821818019893, 'auprc': 0.767194080220445, 'loss_val': 1.1227220935259636, 'psi': 0.5564069411693716}
[S3] START round=7 head_norm_before_train=1.036296 cos_to_last_merge=0.9545 (last merge round=1)
[S3] round=7 local utility u=0.895893 metrics={'f1_val': 0.396483704974271, 'auprc': 0.9490342871996432, 'loss_val': 0.9817215014588913, 'psi': 0.6175039378644198}-{'f1_val': 0.13984006561410703, 'auprc': 0.9101255648672535, 'loss_val': 1.1169188231473657, 'psi': 0.44795426531536564}
[S4] START round=7 head_norm_before_train=0.634313 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.874820 metrics={'f1_val': 0.4158291457286432, 'auprc': 0.7938257682214876, 'loss_val': 1.0794229607239336, 'psi': 0.567027794725781}-{'f1_val': 0.14022662889518414, 'auprc': 0.7942307892584752, 'loss_val': 1.1766628017662801, 'psi': 0.4018282930405006}
[S5] START round=7 head_norm_before_train=1.272930 (no previous merge yet)
[S5] round=7 local utility u=0.052506 metrics={'f1_val': 0.41782980503278466, 'auprc': 0.7775377216610484, 'loss_val': 0.9358517810048227, 'psi': 0.5617129716840902}-{'f1_val': 0.41754956401939425, 'auprc': 0.7774788475401126, 'loss_val': 1.0390047722079023, 'psi': 0.5615212774276817}
[S6] START round=7 head_norm_before_train=0.685455 cos_to_last_merge=0.9858 (last merge round=4)
[S6] round=7 local utility u=0.887772 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.6510911702338685, 'loss_val': 1.0335103112050241, 'psi': 0.5105495796198678}-{'f1_val': 0.14142628205128205, 'auprc': 0.6508733816718045, 'loss_val': 1.1558269104523937, 'psi': 0.34520512189949104}
[S7] START round=7 head_norm_before_train=0.725039 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.005529 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5871044287960867, 'loss_val': 1.2968441809784121, 'psi': 0.3200758651558897}-{'f1_val': 0.14205682272909165, 'auprc': 0.5876178157508118, 'loss_val': 1.3094417665429305, 'psi': 0.32028121993777975}
[S8] START round=7 head_norm_before_train=1.404005 (no previous merge yet)
[S8] round=7 local utility u=0.109946 metrics={'f1_val': 0.7142030389295135, 'auprc': 0.7853534430344276, 'loss_val': 0.6351979914138844, 'psi': 0.7426632005714792}-{'f1_val': 0.7150337453891538, 'auprc': 0.7767294123039219, 'loss_val': 0.8342020106392648, 'psi': 0.7397120121550611}
[S9] START round=7 head_norm_before_train=1.023426 cos_to_last_merge=0.9471 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.947
[S9] round=7 local utility u=0.090507 metrics={'f1_val': 0.7010169755020486, 'auprc': 0.9992232037286022, 'loss_val': 0.701446911094737, 'psi': 0.82029946679267}-{'f1_val': 0.7002705913112235, 'auprc': 0.9942039077237302, 'loss_val': 0.8629251413345121, 'psi': 0.8178439178762262}
[S10] START round=7 head_norm_before_train=1.334093 (no previous merge yet)
[S10] round=7 local utility u=1.000000 metrics={'f1_val': 0.69689708112308, 'auprc': 0.9749553831768966, 'loss_val': 0.6830467443870264, 'psi': 0.8081204019446067}-{'f1_val': 0.436571474908696, 'auprc': 0.8404770439621077, 'loss_val': 0.8182656312742355, 'psi': 0.5981337025300607}
[S11] START round=7 head_norm_before_train=1.312155 (no previous merge yet)
[S11] round=7 local utility u=0.284132 metrics={'f1_val': 0.4151419553975044, 'auprc': 0.8014959805206616, 'loss_val': 0.9181413245780148, 'psi': 0.5696835654467673}-{'f1_val': 0.34792952572342994, 'auprc': 0.7939651711148984, 'loss_val': 1.060538285834424, 'psi': 0.5263437838800173}
[S13] START round=7 head_norm_before_train=1.304201 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.416200286011302, 'auprc': 0.7401781898893071, 'loss_val': 0.9142744283380457, 'psi': 0.5457914475625041}-{'f1_val': 0.6758495050647856, 'auprc': 0.716025824182853, 'loss_val': 1.0718689495713747, 'psi': 0.6919200327120125}
[S14] START round=7 head_norm_before_train=0.865617 cos_to_last_merge=0.9589 (last merge round=2)
[S14] round=7 local utility u=0.082635 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8891389165348809, 'loss_val': 1.1806830890597428, 'psi': 0.4398702783435746}-{'f1_val': 0.14035785288270378, 'auprc': 0.8597805245026732, 'loss_val': 1.257877899242427, 'psi': 0.42812692153069154}
[S15] START round=7 head_norm_before_train=0.898474 cos_to_last_merge=0.9510 (last merge round=1)
[S15] round=7 local utility u=0.744774 metrics={'f1_val': 0.416567672447929, 'auprc': 0.7801350431849509, 'loss_val': 1.0519108618916997, 'psi': 0.5619946207427378}-{'f1_val': 0.18778245292896342, 'auprc': 0.7767023917147882, 'loss_val': 1.1584495561724766, 'psi': 0.4233504284432933}
[S16] START round=7 head_norm_before_train=0.685787 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.050025 metrics={'f1_val': 0.41727255530994717, 'auprc': 0.4886104570678673, 'loss_val': 1.0672378966590825, 'psi': 0.4458077160131152}-{'f1_val': 0.3885115275785111, 'auprc': 0.5348535245113037, 'loss_val': 1.1334518291809654, 'psi': 0.44704832635162817}
[S17] START round=7 head_norm_before_train=1.390650 (no previous merge yet)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.3525844685111543, 'auprc': 0.7331843329761106, 'loss_val': 0.8902548607842979, 'psi': 0.5048244142971369}-{'f1_val': 0.3654020146460324, 'auprc': 0.8345762040378799, 'loss_val': 0.927092059219018, 'psi': 0.5530716904027715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:36605
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:36607
[S14] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.905325)
[S7] loaded HEAD from S14 (vec_in norm=0.905325)
[S7] cosine check vs S14: cos=0.8085
[S7] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.729713)
[S7] loaded HEAD from S16 (vec_in norm=0.729713)
[S7] cosine check vs S16: cos=0.3911
[S7] BUFFERED delta from S16 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1802) from S5
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.301916)
[S7] loaded HEAD from S5 (vec_in norm=1.301916)
[S7] cosine check vs S5: cos=-0.0271
[S7] DROPPED delta from S5 (cos=-0.0271 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.074281)
[S5] loaded HEAD from S9 (vec_in norm=1.074281)
[S5] cosine check vs S9: cos=-0.0295
[S5] DROPPED delta from S9 (cos=-0.0295 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.674944)
[S16] loaded HEAD from S4 (vec_in norm=0.674944)
[S16] cosine check vs S4: cos=0.9378
[S16] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.443945)
[S9] loaded HEAD from S8 (vec_in norm=1.443945)
[S9] cosine check vs S8: cos=-0.0384
[S9] DROPPED delta from S8 (cos=-0.0384 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.716512)
[S4] loaded HEAD from S6 (vec_in norm=0.716512)
[S4] cosine check vs S6: cos=0.4998
[S4] BUFFERED delta from S6 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.346107)
[S2] loaded HEAD from S11 (vec_in norm=1.346107)
[S2] cosine check vs S11: cos=-0.0593
[S2] DROPPED delta from S11 (cos=-0.0593 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1805) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.081773)
[S6] loaded HEAD from S3 (vec_in norm=1.081773)
[S6] cosine check vs S3: cos=-0.1232
[S6] DROPPED delta from S3 (cos=-0.1232 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1804) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.734253)
[S6] loaded HEAD from S7 (vec_in norm=0.734253)
[S6] cosine check vs S7: cos=0.3534
[S6] BUFFERED delta from S7 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.744442)
[S4] loaded HEAD from S2 (vec_in norm=0.744442)
[S4] cosine check vs S2: cos=0.8258
[S4] BUFFERED delta from S2 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1804) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.373058)
[S6] loaded HEAD from S10 (vec_in norm=1.373058)
[S6] cosine check vs S10: cos=-0.1645
[S6] DROPPED delta from S10 (cos=-0.1645 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1793) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.940433)
[S4] loaded HEAD from S15 (vec_in norm=0.940433)
[S4] cosine check vs S15: cos=0.8401
[S4] BUFFERED delta from S15 (total buffered=3)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4173 head_norm=0.729713
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.267170e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4173 head_norm=0.691345 delta_norm=0.126717
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.4169 head_norm=0.716512
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.125245e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.4169 head_norm=0.596726 delta_norm=0.412524
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.734253
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.432064e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=0.657761 delta_norm=0.243206
[S7] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.4158 head_norm=0.674944
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.174992e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.4157 head_norm=0.639662 delta_norm=0.117499
[S4] aggregate: ACCEPT kept=['S6', 'S2', 'S15'] (k=3/3) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.744442 cos_to_last_merge=0.9068 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.907
[S2] round=8 local utility u=0.044962 metrics={'f1_val': 0.41622585620987596, 'auprc': 0.7632128071812134, 'loss_val': 0.9279404419569316, 'psi': 0.5550206365984109}-{'f1_val': 0.4168984104266471, 'auprc': 0.7685025394848564, 'loss_val': 1.0377683857924473, 'psi': 0.5575400620499309}
[S3] START round=8 head_norm_before_train=1.081773 cos_to_last_merge=0.9389 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.939
[S3] round=8 local utility u=0.180001 metrics={'f1_val': 0.39645225981545407, 'auprc': 0.9984188650656824, 'loss_val': 0.7696842635198086, 'psi': 0.6372389019155454}-{'f1_val': 0.396483704974271, 'auprc': 0.9490342871996432, 'loss_val': 0.9817215014588913, 'psi': 0.6175039378644198}
[S4] START round=8 head_norm_before_train=0.639662 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.032249 metrics={'f1_val': 0.4085657460098174, 'auprc': 0.787908185384698, 'loss_val': 0.9535922915458966, 'psi': 0.5603027217597696}-{'f1_val': 0.4158291457286432, 'auprc': 0.7938257682214876, 'loss_val': 1.0794229607239336, 'psi': 0.567027794725781}
[S5] START round=8 head_norm_before_train=1.301916 (no previous merge yet)
[S5] round=8 local utility u=0.098421 metrics={'f1_val': 0.4175465518408786, 'auprc': 0.8018442826557427, 'loss_val': 0.8102308809255014, 'psi': 0.5712656441668242}-{'f1_val': 0.41782980503278466, 'auprc': 0.7775377216610484, 'loss_val': 0.9358517810048227, 'psi': 0.5617129716840902}
[S6] START round=8 head_norm_before_train=0.596726 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.180555 metrics={'f1_val': 0.4164535851642239, 'auprc': 0.7707952350659123, 'loss_val': 1.0291029888270011, 'psi': 0.5581902451248992}-{'f1_val': 0.4168551858772006, 'auprc': 0.6510911702338685, 'loss_val': 1.0335103112050241, 'psi': 0.5105495796198678}
[S7] START round=8 head_norm_before_train=0.657761 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.003466 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5874761767226054, 'loss_val': 1.2910279295042562, 'psi': 0.32022456432649715}-{'f1_val': 0.14205682272909165, 'auprc': 0.5871044287960867, 'loss_val': 1.2968441809784121, 'psi': 0.3200758651558897}
[S8] START round=8 head_norm_before_train=1.443945 (no previous merge yet)
[S8] round=8 local utility u=0.394843 metrics={'f1_val': 0.714460606093301, 'auprc': 0.9923223729567429, 'loss_val': 0.46796503781765003, 'psi': 0.8256053128386778}-{'f1_val': 0.7142030389295135, 'auprc': 0.7853534430344276, 'loss_val': 0.6351979914138844, 'psi': 0.7426632005714792}
[S9] START round=8 head_norm_before_train=1.074281 cos_to_last_merge=0.9291 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.929
[S9] round=8 local utility u=0.078757 metrics={'f1_val': 0.701513881536201, 'auprc': 0.9995852640597079, 'loss_val': 0.5479997704583451, 'psi': 0.8207424345456038}-{'f1_val': 0.7010169755020486, 'auprc': 0.9992232037286022, 'loss_val': 0.701446911094737, 'psi': 0.82029946679267}
[S10] START round=8 head_norm_before_train=1.373058 (no previous merge yet)
[S10] round=8 local utility u=0.110480 metrics={'f1_val': 0.7014651792803464, 'auprc': 0.9965742065786337, 'loss_val': 0.5543524454854449, 'psi': 0.8195087901996613}-{'f1_val': 0.69689708112308, 'auprc': 0.9749553831768966, 'loss_val': 0.6830467443870264, 'psi': 0.8081204019446067}
[S11] START round=8 head_norm_before_train=1.346107 (no previous merge yet)
[S11] round=8 local utility u=0.298705 metrics={'f1_val': 0.3906981293830902, 'auprc': 0.9991133366077343, 'loss_val': 0.7669210086017149, 'psi': 0.6340642122729478}-{'f1_val': 0.4151419553975044, 'auprc': 0.8014959805206616, 'loss_val': 0.9181413245780148, 'psi': 0.5696835654467673}
[S13] START round=8 head_norm_before_train=1.336173 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.3717170204609708, 'auprc': 0.649340331096535, 'loss_val': 0.853932185007603, 'psi': 0.48276634471519647}-{'f1_val': 0.416200286011302, 'auprc': 0.7401781898893071, 'loss_val': 0.9142744283380457, 'psi': 0.5457914475625041}
[S14] START round=8 head_norm_before_train=0.905325 cos_to_last_merge=0.9436 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.944
[S14] round=8 local utility u=0.962477 metrics={'f1_val': 0.39616188510169137, 'auprc': 0.9766934077659125, 'loss_val': 1.0532173571580656, 'psi': 0.6283744941673799}-{'f1_val': 0.14035785288270378, 'auprc': 0.8891389165348809, 'loss_val': 1.1806830890597428, 'psi': 0.4398702783435746}
[S15] START round=8 head_norm_before_train=0.940433 cos_to_last_merge=0.9382 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.938
[S15] round=8 local utility u=0.122060 metrics={'f1_val': 0.41691903018686227, 'auprc': 0.7911767050383757, 'loss_val': 0.8430244888253545, 'psi': 0.5666221001274676}-{'f1_val': 0.416567672447929, 'auprc': 0.7801350431849509, 'loss_val': 1.0519108618916997, 'psi': 0.5619946207427378}
[S16] START round=8 head_norm_before_train=0.691345 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.3840381117724868, 'auprc': 0.5135734617637737, 'loss_val': 1.0378845612390422, 'psi': 0.43585225176900155}-{'f1_val': 0.41727255530994717, 'auprc': 0.4886104570678673, 'loss_val': 1.0672378966590825, 'psi': 0.4458077160131152}
[S17] START round=8 head_norm_before_train=1.436225 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.3418934445169422, 'auprc': 0.7726253608492781, 'loss_val': 0.9500405768162348, 'psi': 0.5141862110498766}-{'f1_val': 0.3525844685111543, 'auprc': 0.7331843329761106, 'loss_val': 0.8902548607842979, 'psi': 0.5048244142971369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:36607
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:36608
[S15] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.631557)
[S4] loaded HEAD from S6 (vec_in norm=0.631557)
[S4] cosine check vs S6: cos=0.5841
[S4] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1804) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.690704)
[S16] loaded HEAD from S4 (vec_in norm=0.690704)
[S16] cosine check vs S4: cos=0.9440
[S16] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.666990)
[S6] loaded HEAD from S7 (vec_in norm=0.666990)
[S6] cosine check vs S7: cos=0.7916
[S6] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.140949)
[S6] loaded HEAD from S3 (vec_in norm=1.140949)
[S6] cosine check vs S3: cos=-0.0447
[S6] DROPPED delta from S3 (cos=-0.0447 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.384218)
[S2] loaded HEAD from S11 (vec_in norm=1.384218)
[S2] cosine check vs S11: cos=-0.0664
[S2] DROPPED delta from S11 (cos=-0.0664 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1790) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.997273)
[S4] loaded HEAD from S15 (vec_in norm=0.997273)
[S4] cosine check vs S15: cos=0.7858
[S4] BUFFERED delta from S15 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1796) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.785481)
[S4] loaded HEAD from S2 (vec_in norm=0.785481)
[S4] cosine check vs S2: cos=0.8426
[S4] BUFFERED delta from S2 (total buffered=3)
[S9] RECEIVED delta(kind=head bytes=1797) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.482767)
[S9] loaded HEAD from S8 (vec_in norm=1.482767)
[S9] cosine check vs S8: cos=-0.0271
[S9] DROPPED delta from S8 (cos=-0.0271 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.955707)
[S7] loaded HEAD from S14 (vec_in norm=0.955707)
[S7] cosine check vs S14: cos=0.8644
[S7] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.415297)
[S6] loaded HEAD from S10 (vec_in norm=1.415297)
[S6] cosine check vs S10: cos=-0.0943
[S6] DROPPED delta from S10 (cos=-0.0943 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.131866)
[S5] loaded HEAD from S9 (vec_in norm=1.131866)
[S5] cosine check vs S9: cos=-0.0291
[S5] DROPPED delta from S9 (cos=-0.0291 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S5
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.336530)
[S7] loaded HEAD from S5 (vec_in norm=1.336530)
[S7] cosine check vs S5: cos=-0.0367
[S7] DROPPED delta from S5 (cos=-0.0367 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.4165 head_norm=0.631557
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.102401e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.4163 head_norm=0.614548 delta_norm=0.210240
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.4086 head_norm=0.690704
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.030217e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.3901 head_norm=0.648952 delta_norm=0.103022
[S4] aggregate: ROLLBACK (f1_val pre=0.409 post=0.390 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.1421 head_norm=0.666990
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.531182e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.1421 head_norm=0.784255 delta_norm=0.253118
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.3840 head_norm=0.734656
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.211598e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.3840 head_norm=0.702649 delta_norm=0.121160
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.785481 cos_to_last_merge=0.8885 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.889
[S2] round=9 local utility u=0.392462 metrics={'f1_val': 0.5352685993843658, 'auprc': 0.7625294941985298, 'loss_val': 0.8552230558759248, 'psi': 0.6261729573100314}-{'f1_val': 0.41622585620987596, 'auprc': 0.7632128071812134, 'loss_val': 0.9279404419569316, 'psi': 0.5550206365984109}
[S3] START round=9 head_norm_before_train=1.140949 cos_to_last_merge=0.9206 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=9 local utility u=0.026792 metrics={'f1_val': 0.392601475058182, 'auprc': 0.9977041704573875, 'loss_val': 0.6908515883232066, 'psi': 0.6346425532178641}-{'f1_val': 0.39645225981545407, 'auprc': 0.9984188650656824, 'loss_val': 0.7696842635198086, 'psi': 0.6372389019155454}
[S4] START round=9 head_norm_before_train=0.648952 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.36997701355739443, 'auprc': 0.6638063855342585, 'loss_val': 0.8479508616225527, 'psi': 0.48750876234814006}-{'f1_val': 0.4085657460098174, 'auprc': 0.787908185384698, 'loss_val': 0.9535922915458966, 'psi': 0.5603027217597696}
[S5] START round=9 head_norm_before_train=1.336530 (no previous merge yet)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.4175465518408786, 'auprc': 0.6794748531788872, 'loss_val': 0.7917652444302303, 'psi': 0.5223178723760821}-{'f1_val': 0.4175465518408786, 'auprc': 0.8018442826557427, 'loss_val': 0.8102308809255014, 'psi': 0.5712656441668242}
[S6] START round=9 head_norm_before_train=0.614548 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.041499 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.7922360874677699, 'loss_val': 1.0128368806414656, 'psi': 0.5670075465134283}-{'f1_val': 0.4164535851642239, 'auprc': 0.7707952350659123, 'loss_val': 1.0291029888270011, 'psi': 0.5581902451248992}
[S7] START round=9 head_norm_before_train=0.784255 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.004192 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.587391859375492, 'loss_val': 1.2823909157634532, 'psi': 0.3201908373876518}-{'f1_val': 0.14205682272909165, 'auprc': 0.5874761767226054, 'loss_val': 1.2910279295042562, 'psi': 0.32022456432649715}
[S8] START round=9 head_norm_before_train=1.482767 (no previous merge yet)
[S8] round=9 local utility u=0.064427 metrics={'f1_val': 0.7065244844615004, 'auprc': 0.9992605019023343, 'loss_val': 0.3123081705781677, 'psi': 0.823618891437834}-{'f1_val': 0.714460606093301, 'auprc': 0.9923223729567429, 'loss_val': 0.46796503781765003, 'psi': 0.8256053128386778}
[S9] START round=9 head_norm_before_train=1.131866 cos_to_last_merge=0.9106 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.911
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.7011888050472792, 'auprc': 0.8681852024708794, 'loss_val': 0.47797249348938015, 'psi': 0.7679873640167193}-{'f1_val': 0.701513881536201, 'auprc': 0.9995852640597079, 'loss_val': 0.5479997704583451, 'psi': 0.8207424345456038}
[S10] START round=9 head_norm_before_train=1.415297 (no previous merge yet)
[S10] round=9 local utility u=0.057849 metrics={'f1_val': 0.7008219242649836, 'auprc': 0.9981931441902758, 'loss_val': 0.4396523062879711, 'psi': 0.8197704122351004}-{'f1_val': 0.7014651792803464, 'auprc': 0.9965742065786337, 'loss_val': 0.5543524454854449, 'psi': 0.8195087901996613}
[S11] START round=9 head_norm_before_train=1.384218 (no previous merge yet)
[S11] round=9 local utility u=0.682309 metrics={'f1_val': 0.5886756942894851, 'auprc': 0.9959468449524018, 'loss_val': 0.5806681807251357, 'psi': 0.7515841545546518}-{'f1_val': 0.3906981293830902, 'auprc': 0.9991133366077343, 'loss_val': 0.7669210086017149, 'psi': 0.6340642122729478}
[S13] START round=9 head_norm_before_train=1.362860 (no previous merge yet)
[S13] round=9 local utility u=1.000000 metrics={'f1_val': 0.6646765087525675, 'auprc': 0.8120763333293897, 'loss_val': 0.6822477406438676, 'psi': 0.7236364385832963}-{'f1_val': 0.3717170204609708, 'auprc': 0.649340331096535, 'loss_val': 0.853932185007603, 'psi': 0.48276634471519647}
[S14] START round=9 head_norm_before_train=0.955707 cos_to_last_merge=0.9273 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.927
[S14] round=9 local utility u=0.204227 metrics={'f1_val': 0.4106747887613806, 'auprc': 0.9984674956826229, 'loss_val': 0.7971629096254019, 'psi': 0.6457918715298775}-{'f1_val': 0.39616188510169137, 'auprc': 0.9766934077659125, 'loss_val': 1.0532173571580656, 'psi': 0.6283744941673799}
[S15] START round=9 head_norm_before_train=0.997273 cos_to_last_merge=0.9217 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.922
[S15] round=9 local utility u=1.000000 metrics={'f1_val': 0.6717408669306146, 'auprc': 0.9693451656398769, 'loss_val': 0.6586484557207873, 'psi': 0.7907825864143196}-{'f1_val': 0.41691903018686227, 'auprc': 0.7911767050383757, 'loss_val': 0.8430244888253545, 'psi': 0.5666221001274676}
[S16] START round=9 head_norm_before_train=0.702649 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.3491386578175804, 'auprc': 0.5426613039428878, 'loss_val': 1.0144522348185119, 'psi': 0.4265477162677034}-{'f1_val': 0.3840381117724868, 'auprc': 0.5135734617637737, 'loss_val': 1.0378845612390422, 'psi': 0.43585225176900155}
[S17] START round=9 head_norm_before_train=1.467908 (no previous merge yet)
[S17] round=9 local utility u=0.015350 metrics={'f1_val': 0.34609329349675244, 'auprc': 0.7734311421302873, 'loss_val': 0.9469560491018394, 'psi': 0.5170284329501664}-{'f1_val': 0.3418934445169422, 'auprc': 0.7726253608492781, 'loss_val': 0.9500405768162348, 'psi': 0.5141862110498766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:36610
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:36607
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[S11] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.520391)
[S9] loaded HEAD from S8 (vec_in norm=1.520391)
[S9] cosine check vs S8: cos=-0.0150
[S9] DROPPED delta from S8 (cos=-0.0150 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1793) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.401053)
[S7] loaded HEAD from S13 (vec_in norm=1.401053)
[S7] cosine check vs S13: cos=0.4990
[S7] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1793) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.058700)
[S4] loaded HEAD from S15 (vec_in norm=1.058700)
[S4] cosine check vs S15: cos=0.7770
[S4] BUFFERED delta from S15 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.429256)
[S2] loaded HEAD from S11 (vec_in norm=1.429256)
[S2] cosine check vs S11: cos=-0.0753
[S2] DROPPED delta from S11 (cos=-0.0753 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.458728)
[S6] loaded HEAD from S10 (vec_in norm=1.458728)
[S6] cosine check vs S10: cos=-0.0658
[S6] DROPPED delta from S10 (cos=-0.0658 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.013071)
[S7] loaded HEAD from S14 (vec_in norm=1.013071)
[S7] cosine check vs S14: cos=0.9625
[S7] BUFFERED delta from S14 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.198923)
[S6] loaded HEAD from S3 (vec_in norm=1.198923)
[S6] cosine check vs S3: cos=-0.0186
[S6] DROPPED delta from S3 (cos=-0.0186 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.794170)
[S6] loaded HEAD from S7 (vec_in norm=0.794170)
[S6] cosine check vs S7: cos=0.8676
[S6] BUFFERED delta from S7 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.647307)
[S4] loaded HEAD from S6 (vec_in norm=0.647307)
[S4] cosine check vs S6: cos=0.6685
[S4] BUFFERED delta from S6 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.835852)
[S4] loaded HEAD from S2 (vec_in norm=0.835852)
[S4] cosine check vs S2: cos=0.8222
[S4] BUFFERED delta from S2 (total buffered=3)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.492729)
[S13] loaded HEAD from S17 (vec_in norm=1.492729)
[S13] cosine check vs S17: cos=-0.0283
[S13] DROPPED delta from S17 (cos=-0.0283 < 0.0)
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.3700 head_norm=0.707571
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.829883e-02
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.3700 head_norm=0.673197 delta_norm=0.098299
[S4] aggregate: ACCEPT kept=['S15', 'S6', 'S2'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.1421 head_norm=0.794170
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.910963e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.1421 head_norm=0.865750 delta_norm=0.291096
[S7] aggregate: ACCEPT kept=['S13', 'S14'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.4169 head_norm=0.647307
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.985579e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.4169 head_norm=0.696729 delta_norm=0.198558
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.835852 cos_to_last_merge=0.8681 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.868
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.5186688580481593, 'auprc': 0.7314966265475928, 'loss_val': 0.7311035064736192, 'psi': 0.6037999654479327}-{'f1_val': 0.5352685993843658, 'auprc': 0.7625294941985298, 'loss_val': 0.8552230558759248, 'psi': 0.6261729573100314}
[S3] START round=10 head_norm_before_train=1.198923 cos_to_last_merge=0.9028 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.903
[S3] round=10 local utility u=0.991695 metrics={'f1_val': 0.6942767364097118, 'auprc': 0.9953218756489035, 'loss_val': 0.5103672036397846, 'psi': 0.8146947921053884}-{'f1_val': 0.392601475058182, 'auprc': 0.9977041704573875, 'loss_val': 0.6908515883232066, 'psi': 0.6346425532178641}
[S4] START round=10 head_norm_before_train=0.673197 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.158529 metrics={'f1_val': 0.40376163768005824, 'auprc': 0.6753320548307481, 'loss_val': 0.7681773891290183, 'psi': 0.5123898045403342}-{'f1_val': 0.36997701355739443, 'auprc': 0.6638063855342585, 'loss_val': 0.8479508616225527, 'psi': 0.48750876234814006}
[S5] START round=10 head_norm_before_train=1.370049 (no previous merge yet)
[S5] round=10 local utility u=0.498637 metrics={'f1_val': 0.40101207479651624, 'auprc': 0.9908139896151894, 'loss_val': 0.6293008472786079, 'psi': 0.6369328407239856}-{'f1_val': 0.4175465518408786, 'auprc': 0.6794748531788872, 'loss_val': 0.7917652444302303, 'psi': 0.5223178723760821}
[S6] START round=10 head_norm_before_train=0.696729 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.155783 metrics={'f1_val': 0.41689493363097396, 'auprc': 0.8709557143326988, 'loss_val': 0.9376675402384359, 'psi': 0.5985192459116639}-{'f1_val': 0.4168551858772006, 'auprc': 0.7922360874677699, 'loss_val': 1.0128368806414656, 'psi': 0.5670075465134283}
[S7] START round=10 head_norm_before_train=0.865750 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.004028 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5842773388188385, 'loss_val': 1.2649920993021315, 'psi': 0.3189450291649904}-{'f1_val': 0.14205682272909165, 'auprc': 0.587391859375492, 'loss_val': 1.2823909157634532, 'psi': 0.3201908373876518}
[S8] START round=10 head_norm_before_train=1.520391 (no previous merge yet)
[S8] round=10 local utility u=0.029578 metrics={'f1_val': 0.7142385069361679, 'auprc': 0.9948794537401606, 'loss_val': 0.28629352239846373, 'psi': 0.826494885657765}-{'f1_val': 0.7065244844615004, 'auprc': 0.9992605019023343, 'loss_val': 0.3123081705781677, 'psi': 0.823618891437834}
[S9] START round=10 head_norm_before_train=1.190251 cos_to_last_merge=0.8938 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.894
[S9] round=10 local utility u=0.272832 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9989594896928469, 'loss_val': 0.3256873934959885, 'psi': 0.8204025965086443}-{'f1_val': 0.7011888050472792, 'auprc': 0.8681852024708794, 'loss_val': 0.47797249348938015, 'psi': 0.7679873640167193}
[S10] START round=10 head_norm_before_train=1.458728 (no previous merge yet)
[S10] round=10 local utility u=0.037804 metrics={'f1_val': 0.7000680725537874, 'auprc': 0.9976952096695896, 'loss_val': 0.3580266998437843, 'psi': 0.8191189274001083}-{'f1_val': 0.7008219242649836, 'auprc': 0.9981931441902758, 'loss_val': 0.4396523062879711, 'psi': 0.8197704122351004}
[S11] START round=10 head_norm_before_train=1.429256 (no previous merge yet)
[S11] round=10 local utility u=0.419465 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9979316823447731, 'loss_val': 0.4276437786235236, 'psi': 0.8203731385054485}-{'f1_val': 0.5886756942894851, 'auprc': 0.9959468449524018, 'loss_val': 0.5806681807251357, 'psi': 0.7515841545546518}
[S13] START round=10 head_norm_before_train=1.401053 (no previous merge yet)
[S13] round=10 local utility u=0.104619 metrics={'f1_val': 0.7124439724149412, 'auprc': 0.7349310693741609, 'loss_val': 0.5281783965731371, 'psi': 0.7214388111986291}-{'f1_val': 0.6646765087525675, 'auprc': 0.8120763333293897, 'loss_val': 0.6822477406438676, 'psi': 0.7236364385832963}
[S14] START round=10 head_norm_before_train=1.013071 cos_to_last_merge=0.9089 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.909
[S14] round=10 local utility u=0.925908 metrics={'f1_val': 0.6933947276524293, 'auprc': 0.9911590379357766, 'loss_val': 0.6197412786115637, 'psi': 0.8125004517657682}-{'f1_val': 0.4106747887613806, 'auprc': 0.9984674956826229, 'loss_val': 0.7971629096254019, 'psi': 0.6457918715298775}
[S15] START round=10 head_norm_before_train=1.058700 cos_to_last_merge=0.9039 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.904
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6269016567460203, 'auprc': 0.6624449399434218, 'loss_val': 0.6148400574707635, 'psi': 0.6411189700249809}-{'f1_val': 0.6717408669306146, 'auprc': 0.9693451656398769, 'loss_val': 0.6586484557207873, 'psi': 0.7907825864143196}
[S16] START round=10 head_norm_before_train=0.746173 cos_to_last_merge=0.9930 (last merge round=8)
[S16] round=10 local utility u=0.291420 metrics={'f1_val': 0.42817705306509657, 'auprc': 0.5445868944847232, 'loss_val': 0.9116197095118695, 'psi': 0.4747409896329472}-{'f1_val': 0.3491386578175804, 'auprc': 0.5426613039428878, 'loss_val': 1.0144522348185119, 'psi': 0.4265477162677034}
[S17] START round=10 head_norm_before_train=1.492729 (no previous merge yet)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.34406454798993624, 'auprc': 0.6756595246343534, 'loss_val': 0.975777887818533, 'psi': 0.4767025386477031}-{'f1_val': 0.34609329349675244, 'auprc': 0.7734311421302873, 'loss_val': 0.9469560491018394, 'psi': 0.5170284329501664}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:36607
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S5
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.400796)
[S7] loaded HEAD from S5 (vec_in norm=1.400796)
[S7] cosine check vs S5: cos=-0.0375
[S7] DROPPED delta from S5 (cos=-0.0375 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.735682)
[S16] loaded HEAD from S4 (vec_in norm=0.735682)
[S16] cosine check vs S4: cos=0.9334
[S16] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1804) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.476910)
[S2] loaded HEAD from S11 (vec_in norm=1.476910)
[S2] cosine check vs S11: cos=-0.0837
[S2] DROPPED delta from S11 (cos=-0.0837 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.551759)
[S9] loaded HEAD from S8 (vec_in norm=1.551759)
[S9] cosine check vs S8: cos=-0.0059
[S9] DROPPED delta from S8 (cos=-0.0059 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.075774)
[S7] loaded HEAD from S14 (vec_in norm=1.075774)
[S7] cosine check vs S14: cos=0.8896
[S7] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.252698)
[S6] loaded HEAD from S3 (vec_in norm=1.252698)
[S6] cosine check vs S3: cos=-0.0132
[S6] DROPPED delta from S3 (cos=-0.0132 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.877004)
[S6] loaded HEAD from S7 (vec_in norm=0.877004)
[S6] cosine check vs S7: cos=0.9027
[S6] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1794) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.801615)
[S7] loaded HEAD from S16 (vec_in norm=0.801615)
[S7] cosine check vs S16: cos=0.3277
[S7] BUFFERED delta from S16 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1800) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.732044)
[S4] loaded HEAD from S6 (vec_in norm=0.732044)
[S4] cosine check vs S6: cos=0.6394
[S4] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.444270)
[S7] loaded HEAD from S13 (vec_in norm=1.444270)
[S7] cosine check vs S13: cos=0.7451
[S7] BUFFERED delta from S13 (total buffered=3)
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.240103)
[S5] loaded HEAD from S9 (vec_in norm=1.240103)
[S5] cosine check vs S9: cos=-0.0241
[S5] DROPPED delta from S9 (cos=-0.0241 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.499572)
[S6] loaded HEAD from S10 (vec_in norm=1.499572)
[S6] cosine check vs S10: cos=-0.0530
[S6] DROPPED delta from S10 (cos=-0.0530 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.291 → S4@127.0.0.1:36604
[S5] ⇄ pheromone p=0.307 → S7@127.0.0.1:36608
[S10] ⇄ pheromone p=0.342 → S6@127.0.0.1:36607
[S8] ⇄ pheromone p=0.290 → S9@127.0.0.1:36610
[S11] ⇄ pheromone p=0.446 → S2@127.0.0.1:36602
[S9] ⇄ pheromone p=0.269 → S5@127.0.0.1:36605
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.4282 head_norm=0.801615
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.440092e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.4326 head_norm=0.755757 delta_norm=0.144009
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.231 → S7@127.0.0.1:36608
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.4169 head_norm=0.732044
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.910307e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.4168 head_norm=0.784869 delta_norm=0.191031
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.276 → S4@127.0.0.1:36604
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.4038 head_norm=0.735682
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.116285e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.4028 head_norm=0.664414 delta_norm=0.311628
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.251 → S16@127.0.0.1:36616
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.1421 head_norm=0.877004
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.124262e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.1421 head_norm=0.829040 delta_norm=0.112426
[S7] aggregate: ACCEPT kept=['S14', 'S16', 'S13'] (k=3/3) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.136 → S6@127.0.0.1:36607
[S3] ⇄ pheromone p=0.450 → S6@127.0.0.1:36607
[S13] ⇄ pheromone p=0.395 → S7@127.0.0.1:36608
[S14] ⇄ pheromone p=0.507 → S7@127.0.0.1:36608
[S17] ⇄ pheromone p=0.205 → S13@127.0.0.1:36613
[S15] ⇄ pheromone p=0.377 → S4@127.0.0.1:36604
[S2] START round=11 head_norm_before_train=0.886303 cos_to_last_merge=0.8488 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.849
[S2] round=11 local utility u=0.473748 metrics={'f1_val': 0.6397557255800601, 'auprc': 0.7840054580748205, 'loss_val': 0.6676559566778367, 'psi': 0.6974556185779643}-{'f1_val': 0.5186688580481593, 'auprc': 0.7314966265475928, 'loss_val': 0.7311035064736192, 'psi': 0.6037999654479327}
[S3] START round=11 head_norm_before_train=1.252698 cos_to_last_merge=0.8864 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.886
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.6603232146393048, 'auprc': 0.9925275379262963, 'loss_val': 0.473267977482816, 'psi': 0.7932049439541013}-{'f1_val': 0.6942767364097118, 'auprc': 0.9953218756489035, 'loss_val': 0.5103672036397846, 'psi': 0.8146947921053884}
[S4] START round=11 head_norm_before_train=0.664414 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.144394 metrics={'f1_val': 0.44836632925478037, 'auprc': 0.6637527578646155, 'loss_val': 0.7122788673962, 'psi': 0.5345209006987144}-{'f1_val': 0.40376163768005824, 'auprc': 0.6753320548307481, 'loss_val': 0.7681773891290183, 'psi': 0.5123898045403342}
[S5] START round=11 head_norm_before_train=1.400796 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.4330433278988193, 'auprc': 0.8606101423553475, 'loss_val': 0.636870312695365, 'psi': 0.6040700536814305}-{'f1_val': 0.40101207479651624, 'auprc': 0.9908139896151894, 'loss_val': 0.6293008472786079, 'psi': 0.6369328407239856}
[S6] START round=11 head_norm_before_train=0.784869 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.171389 metrics={'f1_val': 0.4168135083356663, 'auprc': 0.9621989294345559, 'loss_val': 0.86813119799777, 'psi': 0.6349676767752221}-{'f1_val': 0.41689493363097396, 'auprc': 0.8709557143326988, 'loss_val': 0.9376675402384359, 'psi': 0.5985192459116639}
[S7] START round=11 head_norm_before_train=0.829040 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.069052 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6184496506256574, 'loss_val': 1.2294047186915182, 'psi': 0.332613953887718}-{'f1_val': 0.14205682272909165, 'auprc': 0.5842773388188385, 'loss_val': 1.2649920993021315, 'psi': 0.3189450291649904}
[S8] START round=11 head_norm_before_train=1.551759 (no previous merge yet)
[S8] round=11 local utility u=0.507588 metrics={'f1_val': 0.8650001445222356, 'auprc': 0.9991990556130739, 'loss_val': 0.18864704804236176, 'psi': 0.9186797089585709}-{'f1_val': 0.7142385069361679, 'auprc': 0.9948794537401606, 'loss_val': 0.28629352239846373, 'psi': 0.826494885657765}
[S9] START round=11 head_norm_before_train=1.240103 cos_to_last_merge=0.8786 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.879
[S9] round=11 local utility u=0.023703 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9986269636225067, 'loss_val': 0.2768395583533457, 'psi': 0.8202250755735407}-{'f1_val': 0.7013646677191758, 'auprc': 0.9989594896928469, 'loss_val': 0.3256873934959885, 'psi': 0.8204025965086443}
[S10] START round=11 head_norm_before_train=1.499572 (no previous merge yet)
[S10] round=11 local utility u=0.015265 metrics={'f1_val': 0.7000134762741985, 'auprc': 0.9943024521018832, 'loss_val': 0.31699142842135447, 'psi': 0.8177290666052723}-{'f1_val': 0.7000680725537874, 'auprc': 0.9976952096695896, 'loss_val': 0.3580266998437843, 'psi': 0.8191189274001083}
[S11] START round=11 head_norm_before_train=1.476910 (no previous merge yet)
[S11] round=11 local utility u=0.815386 metrics={'f1_val': 0.9545198724546704, 'auprc': 0.9978949143512417, 'loss_val': 0.31187682660761473, 'psi': 0.9718698892132989}-{'f1_val': 0.7020007759458987, 'auprc': 0.9979316823447731, 'loss_val': 0.4276437786235236, 'psi': 0.8203731385054485}
[S13] START round=11 head_norm_before_train=1.444270 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.6500008322264259, 'auprc': 0.7374935115653981, 'loss_val': 0.5397158045699497, 'psi': 0.6849979039620148}-{'f1_val': 0.7124439724149412, 'auprc': 0.7349310693741609, 'loss_val': 0.5281783965731371, 'psi': 0.7214388111986291}
[S14] START round=11 head_norm_before_train=1.075774 cos_to_last_merge=0.8904 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.890
[S14] round=11 local utility u=0.117408 metrics={'f1_val': 0.7015765734306869, 'auprc': 0.9988144774070159, 'loss_val': 0.456982744930694, 'psi': 0.8204717350212185}-{'f1_val': 0.6933947276524293, 'auprc': 0.9911590379357766, 'loss_val': 0.6197412786115637, 'psi': 0.8125004517657682}
[S15] START round=11 head_norm_before_train=1.120893 cos_to_last_merge=0.8862 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.886
[S15] round=11 local utility u=0.764753 metrics={'f1_val': 0.6900471685208741, 'auprc': 0.974873214068773, 'loss_val': 0.4014929293416984, 'psi': 0.8039775867400337}-{'f1_val': 0.6269016567460203, 'auprc': 0.6624449399434218, 'loss_val': 0.6148400574707635, 'psi': 0.6411189700249809}
[S16] START round=11 head_norm_before_train=0.755757 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.244657 metrics={'f1_val': 0.41462284551985584, 'auprc': 0.7224489024931752, 'loss_val': 0.8745667810661959, 'psi': 0.5377532683091836}-{'f1_val': 0.42817705306509657, 'auprc': 0.5445868944847232, 'loss_val': 0.9116197095118695, 'psi': 0.4747409896329472}
[S17] START round=11 head_norm_before_train=1.514933 (no previous merge yet)
[S17] round=11 local utility u=0.145984 metrics={'f1_val': 0.3781245004480385, 'auprc': 0.69304394527014, 'loss_val': 0.9403223548017862, 'psi': 0.5040922783768791}-{'f1_val': 0.34406454798993624, 'auprc': 0.6756595246343534, 'loss_val': 0.975777887818533, 'psi': 0.4767025386477031}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:36602
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:36616
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:36607
[S14] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1793) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.176919)
[S4] loaded HEAD from S15 (vec_in norm=1.176919)
[S4] cosine check vs S15: cos=0.6555
[S4] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.289693)
[S5] loaded HEAD from S9 (vec_in norm=1.289693)
[S5] cosine check vs S9: cos=-0.0227
[S5] DROPPED delta from S9 (cos=-0.0227 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.583563)
[S9] loaded HEAD from S8 (vec_in norm=1.583563)
[S9] cosine check vs S8: cos=0.0013
[S9] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1795) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.535396)
[S6] loaded HEAD from S10 (vec_in norm=1.535396)
[S6] cosine check vs S10: cos=-0.0335
[S6] DROPPED delta from S10 (cos=-0.0335 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.844301)
[S6] loaded HEAD from S7 (vec_in norm=0.844301)
[S6] cosine check vs S7: cos=0.9653
[S6] BUFFERED delta from S7 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1804) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.523326)
[S2] loaded HEAD from S11 (vec_in norm=1.523326)
[S2] cosine check vs S11: cos=-0.0909
[S2] DROPPED delta from S11 (cos=-0.0909 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.810694)
[S7] loaded HEAD from S16 (vec_in norm=0.810694)
[S7] cosine check vs S16: cos=0.4784
[S7] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1793) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.135187)
[S7] loaded HEAD from S14 (vec_in norm=1.135187)
[S7] cosine check vs S14: cos=0.8855
[S7] BUFFERED delta from S14 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.817662)
[S4] loaded HEAD from S6 (vec_in norm=0.817662)
[S4] cosine check vs S6: cos=0.8131
[S4] BUFFERED delta from S6 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1794) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.937999)
[S4] loaded HEAD from S2 (vec_in norm=0.937999)
[S4] cosine check vs S2: cos=0.6165
[S4] BUFFERED delta from S2 (total buffered=3)
[S16] RECEIVED delta(kind=head bytes=1802) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.727343)
[S16] loaded HEAD from S4 (vec_in norm=0.727343)
[S16] cosine check vs S4: cos=0.8809
[S16] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.531206)
[S13] loaded HEAD from S17 (vec_in norm=1.531206)
[S13] cosine check vs S17: cos=-0.0189
[S13] DROPPED delta from S17 (cos=-0.0189 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.4146 head_norm=0.810694
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.919946e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.4008 head_norm=0.745831 delta_norm=0.191995
[S16] aggregate: ROLLBACK (f1_val pre=0.415 post=0.401 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.4484 head_norm=0.727343
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.503058e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.4171 head_norm=0.712256 delta_norm=0.150306
[S4] aggregate: ROLLBACK (f1_val pre=0.448 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.4168 head_norm=0.817662
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.102906e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.6196 head_norm=0.823738 delta_norm=0.110291
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.1421 head_norm=0.844301
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.089636e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.1421 head_norm=0.794800 delta_norm=0.208964
[S7] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7013 head_norm=1.289693
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.020482e+00
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7013 head_norm=1.021815 delta_norm=1.020482
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=0.937999 cos_to_last_merge=0.8311 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.831
[S2] round=12 local utility u=0.116998 metrics={'f1_val': 0.6997658022741111, 'auprc': 0.7093447282353958, 'loss_val': 0.5697383871823414, 'psi': 0.703597372658625}-{'f1_val': 0.6397557255800601, 'auprc': 0.7840054580748205, 'loss_val': 0.6676559566778367, 'psi': 0.6974556185779643}
[S3] START round=12 head_norm_before_train=1.305281 cos_to_last_merge=0.8723 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.872
[S3] round=12 local utility u=0.185215 metrics={'f1_val': 0.7010863553524592, 'auprc': 0.9956988893460575, 'loss_val': 0.35693113937880905, 'psi': 0.8189313689498986}-{'f1_val': 0.6603232146393048, 'auprc': 0.9925275379262963, 'loss_val': 0.473267977482816, 'psi': 0.7932049439541013}
[S4] START round=12 head_norm_before_train=0.712256 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.952947 metrics={'f1_val': 0.6765089815445506, 'auprc': 0.816058109751568, 'loss_val': 0.6321561187743426, 'psi': 0.7323286328273576}-{'f1_val': 0.44836632925478037, 'auprc': 0.6637527578646155, 'loss_val': 0.7122788673962, 'psi': 0.5345209006987144}
[S5] START round=12 head_norm_before_train=1.427246 (no previous merge yet)
[S5] round=12 local utility u=0.832856 metrics={'f1_val': 0.7010644289311239, 'auprc': 0.8529481258862356, 'loss_val': 0.5562986806848147, 'psi': 0.7618179077131686}-{'f1_val': 0.4330433278988193, 'auprc': 0.8606101423553475, 'loss_val': 0.636870312695365, 'psi': 0.6040700536814305}
[S6] START round=12 head_norm_before_train=0.823738 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.900205 metrics={'f1_val': 0.6988859326408279, 'auprc': 0.964157512851601, 'loss_val': 0.7660320598877236, 'psi': 0.8049945647251371}-{'f1_val': 0.4168135083356663, 'auprc': 0.9621989294345559, 'loss_val': 0.86813119799777, 'psi': 0.6349676767752221}
[S7] START round=12 head_norm_before_train=0.794800 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.035080 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6234112547615418, 'loss_val': 1.1741292438483248, 'psi': 0.3345985955420717}-{'f1_val': 0.14205682272909165, 'auprc': 0.6184496506256574, 'loss_val': 1.2294047186915182, 'psi': 0.332613953887718}
[S8] START round=12 head_norm_before_train=1.583563 (no previous merge yet)
[S8] round=12 local utility u=0.407112 metrics={'f1_val': 0.9952289782211529, 'auprc': 0.9989858467161953, 'loss_val': 0.1551557848949314, 'psi': 0.9967317256191699}-{'f1_val': 0.8650001445222356, 'auprc': 0.9991990556130739, 'loss_val': 0.18864704804236176, 'psi': 0.9186797089585709}
[S9] START round=12 head_norm_before_train=1.021815 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9985019922062472, 'loss_val': 0.3801253370539718, 'psi': 0.820175087007037}-{'f1_val': 0.7012904835408967, 'auprc': 0.9986269636225067, 'loss_val': 0.2768395583533457, 'psi': 0.8202250755735407}
[S10] START round=12 head_norm_before_train=1.535396 (no previous merge yet)
[S10] round=12 local utility u=0.876943 metrics={'f1_val': 0.9729862360883675, 'auprc': 0.998128373506952, 'loss_val': 0.21241876564638573, 'psi': 0.9830430910558013}-{'f1_val': 0.7000134762741985, 'auprc': 0.9943024521018832, 'loss_val': 0.31699142842135447, 'psi': 0.8177290666052723}
[S11] START round=12 head_norm_before_train=1.523326 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.9317389520114754, 'auprc': 0.997810332146814, 'loss_val': 0.2692125279825154, 'psi': 0.9581675040656108}-{'f1_val': 0.9545198724546704, 'auprc': 0.9978949143512417, 'loss_val': 0.31187682660761473, 'psi': 0.9718698892132989}
[S13] START round=12 head_norm_before_train=1.479773 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6329791715346531, 'auprc': 0.7054292294773561, 'loss_val': 0.5014108470401409, 'psi': 0.6619591947117343}-{'f1_val': 0.6500008322264259, 'auprc': 0.7374935115653981, 'loss_val': 0.5397158045699497, 'psi': 0.6849979039620148}
[S14] START round=12 head_norm_before_train=1.135187 cos_to_last_merge=0.8741 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.874
[S14] round=12 local utility u=0.938523 metrics={'f1_val': 0.9972280903116715, 'auprc': 0.9991775751368732, 'loss_val': 0.35493569060703006, 'psi': 0.9980078842417521}-{'f1_val': 0.7015765734306869, 'auprc': 0.9988144774070159, 'loss_val': 0.456982744930694, 'psi': 0.8204717350212185}
[S15] START round=12 head_norm_before_train=1.176919 cos_to_last_merge=0.8708 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.871
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.6966608737233494, 'auprc': 0.8185793947649804, 'loss_val': 0.42589184337456315, 'psi': 0.7454282821400018}-{'f1_val': 0.6900471685208741, 'auprc': 0.974873214068773, 'loss_val': 0.4014929293416984, 'psi': 0.8039775867400337}
[S16] START round=12 head_norm_before_train=0.745831 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.101988 metrics={'f1_val': 0.41533460920312276, 'auprc': 0.7723148709010876, 'loss_val': 0.8244602013739887, 'psi': 0.5581267138823087}-{'f1_val': 0.41462284551985584, 'auprc': 0.7224489024931752, 'loss_val': 0.8745667810661959, 'psi': 0.5377532683091836}
[S17] START round=12 head_norm_before_train=1.531206 (no previous merge yet)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.3478458989229495, 'auprc': 0.6930429955288301, 'loss_val': 0.9563337820274228, 'psi': 0.48592473756530175}-{'f1_val': 0.3781245004480385, 'auprc': 0.69304394527014, 'loss_val': 0.9403223548017862, 'psi': 0.5040922783768791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:36607
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:36604
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:36608
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S5
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.455585)
[S7] loaded HEAD from S5 (vec_in norm=1.455585)
[S7] cosine check vs S5: cos=-0.0376
[S7] DROPPED delta from S5 (cos=-0.0376 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.802262)
[S7] loaded HEAD from S16 (vec_in norm=0.802262)
[S7] cosine check vs S16: cos=0.7535
[S7] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.182797)
[S7] loaded HEAD from S14 (vec_in norm=1.182797)
[S7] cosine check vs S14: cos=0.9019
[S7] BUFFERED delta from S14 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.350304)
[S6] loaded HEAD from S3 (vec_in norm=1.350304)
[S6] cosine check vs S3: cos=0.0080
[S6] BUFFERED delta from S3 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1793) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.810936)
[S6] loaded HEAD from S7 (vec_in norm=0.810936)
[S6] cosine check vs S7: cos=0.9574
[S6] BUFFERED delta from S7 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1795) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.573854)
[S6] loaded HEAD from S10 (vec_in norm=1.573854)
[S6] cosine check vs S10: cos=-0.0318
[S6] DROPPED delta from S10 (cos=-0.0318 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1794) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.993248)
[S4] loaded HEAD from S2 (vec_in norm=0.993248)
[S4] cosine check vs S2: cos=0.6909
[S4] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.861371)
[S4] loaded HEAD from S6 (vec_in norm=0.861371)
[S4] cosine check vs S6: cos=0.7275
[S4] BUFFERED delta from S6 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1803) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.615227)
[S9] loaded HEAD from S8 (vec_in norm=1.615227)
[S9] cosine check vs S8: cos=0.7463
[S9] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.781931)
[S16] loaded HEAD from S4 (vec_in norm=0.781931)
[S16] cosine check vs S4: cos=0.9702
[S16] BUFFERED delta from S4 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7013 head_norm=1.068265
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.419135e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7013 head_norm=1.257539 delta_norm=0.541914
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.4153 head_norm=0.802262
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.722708e-02
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4124 head_norm=0.786172 delta_norm=0.097227
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.1421 head_norm=0.810936
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.696704e-02
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.1421 head_norm=0.828873 delta_norm=0.096967
[S7] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6765 head_norm=0.781931
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.720306e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6775 head_norm=0.736806 delta_norm=0.172031
[S4] aggregate: ACCEPT kept=['S2', 'S6'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.6989 head_norm=0.861371
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.157753e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.7102 head_norm=0.715473 delta_norm=0.415775
[S6] aggregate: ACCEPT kept=['S3', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=0.993248 cos_to_last_merge=0.8154 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.815
[S2] round=13 local utility u=0.179772 metrics={'f1_val': 0.7036724610994368, 'auprc': 0.7946011671480285, 'loss_val': 0.48940328523367616, 'psi': 0.7400439435188735}-{'f1_val': 0.6997658022741111, 'auprc': 0.7093447282353958, 'loss_val': 0.5697383871823414, 'psi': 0.703597372658625}
[S3] START round=13 head_norm_before_train=1.350304 cos_to_last_merge=0.8616 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.862
[S3] round=13 local utility u=0.020988 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9971498577058294, 'loss_val': 0.31732754925854206, 'psi': 0.8193136653235116}-{'f1_val': 0.7010863553524592, 'auprc': 0.9956988893460575, 'loss_val': 0.35693113937880905, 'psi': 0.8189313689498986}
[S4] START round=13 head_norm_before_train=0.736806 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.035104 metrics={'f1_val': 0.6744841157435858, 'auprc': 0.8265605612788615, 'loss_val': 0.5813067165819881, 'psi': 0.735314693957696}-{'f1_val': 0.6765089815445506, 'auprc': 0.816058109751568, 'loss_val': 0.6321561187743426, 'psi': 0.7323286328273576}
[S5] START round=13 head_norm_before_train=1.455585 (no previous merge yet)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.7011053602517017, 'auprc': 0.7423803296229435, 'loss_val': 0.4751418798392819, 'psi': 0.7176153480001983}-{'f1_val': 0.7010644289311239, 'auprc': 0.8529481258862356, 'loss_val': 0.5562986806848147, 'psi': 0.7618179077131686}
[S6] START round=13 head_norm_before_train=0.715473 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.6957613500700938, 'auprc': 0.962903393359662, 'loss_val': 0.7834754848712352, 'psi': 0.8026181673859211}-{'f1_val': 0.6988859326408279, 'auprc': 0.964157512851601, 'loss_val': 0.7660320598877236, 'psi': 0.8049945647251371}
[S7] START round=13 head_norm_before_train=0.828873 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=1.000000 metrics={'f1_val': 0.416467909967687, 'auprc': 0.7374745394066683, 'loss_val': 1.0844506453693235, 'psi': 0.5448705617432795}-{'f1_val': 0.14205682272909165, 'auprc': 0.6234112547615418, 'loss_val': 1.1741292438483248, 'psi': 0.3345985955420717}
[S8] START round=13 head_norm_before_train=1.615227 (no previous merge yet)
[S8] round=13 local utility u=0.014235 metrics={'f1_val': 0.9947267123181514, 'auprc': 0.9990808476099955, 'loss_val': 0.12395621526174956, 'psi': 0.996468366434889}-{'f1_val': 0.9952289782211529, 'auprc': 0.9989858467161953, 'loss_val': 0.1551557848949314, 'psi': 0.9967317256191699}
[S9] START round=13 head_norm_before_train=1.257539 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9974127546555391, 'loss_val': 0.4613483967776615, 'psi': 0.8196950503262268}-{'f1_val': 0.7012904835408967, 'auprc': 0.9985019922062472, 'loss_val': 0.3801253370539718, 'psi': 0.820175087007037}
[S10] START round=13 head_norm_before_train=1.573854 (no previous merge yet)
[S10] round=13 local utility u=0.062800 metrics={'f1_val': 0.9940233795219484, 'auprc': 0.9979405612160311, 'loss_val': 0.21247811972918923, 'psi': 0.9955902521995814}-{'f1_val': 0.9729862360883675, 'auprc': 0.998128373506952, 'loss_val': 0.21241876564638573, 'psi': 0.9830430910558013}
[S11] START round=13 head_norm_before_train=1.566505 (no previous merge yet)
[S11] round=13 local utility u=0.128810 metrics={'f1_val': 0.9604773857292719, 'auprc': 0.9977402317991335, 'loss_val': 0.18381332656664212, 'psi': 0.9753825241572165}-{'f1_val': 0.9317389520114754, 'auprc': 0.997810332146814, 'loss_val': 0.2692125279825154, 'psi': 0.9581675040656108}
[S13] START round=13 head_norm_before_train=1.508358 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6147476401945717, 'auprc': 0.6868654635882837, 'loss_val': 0.5655522330249344, 'psi': 0.6435947695520565}-{'f1_val': 0.6329791715346531, 'auprc': 0.7054292294773561, 'loss_val': 0.5014108470401409, 'psi': 0.6619591947117343}
[S14] START round=13 head_norm_before_train=1.182797 cos_to_last_merge=0.8622 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.862
[S14] round=13 local utility u=0.048864 metrics={'f1_val': 0.9976226870742808, 'auprc': 0.9988173295489922, 'loss_val': 0.25849483965500225, 'psi': 0.9981005440641654}-{'f1_val': 0.9972280903116715, 'auprc': 0.9991775751368732, 'loss_val': 0.35493569060703006, 'psi': 0.9980078842417521}
[S15] START round=13 head_norm_before_train=1.230731 cos_to_last_merge=0.8556 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.856
[S15] round=13 local utility u=0.301327 metrics={'f1_val': 0.6938780114590247, 'auprc': 0.9846349583867458, 'loss_val': 0.30470684432503087, 'psi': 0.8101807902301132}-{'f1_val': 0.6966608737233494, 'auprc': 0.8185793947649804, 'loss_val': 0.42589184337456315, 'psi': 0.7454282821400018}
[S16] START round=13 head_norm_before_train=0.786172 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.074422 metrics={'f1_val': 0.43572078383592244, 'auprc': 0.7835435846678134, 'loss_val': 0.8316193275752066, 'psi': 0.5748499041686789}-{'f1_val': 0.41533460920312276, 'auprc': 0.7723148709010876, 'loss_val': 0.8244602013739887, 'psi': 0.5581267138823087}
[S17] START round=13 head_norm_before_train=1.545842 (no previous merge yet)
[S17] round=13 local utility u=0.114864 metrics={'f1_val': 0.3591411861523875, 'auprc': 0.7507494939488449, 'loss_val': 0.9674974685509783, 'psi': 0.5157845092709705}-{'f1_val': 0.3478458989229495, 'auprc': 0.6930429955288301, 'loss_val': 0.9563337820274228, 'psi': 0.48592473756530175}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:36607
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:36604
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:36616
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1805) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.606205)
[S2] loaded HEAD from S11 (vec_in norm=1.606205)
[S2] cosine check vs S11: cos=-0.0954
[S2] DROPPED delta from S11 (cos=-0.0954 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.845187)
[S6] loaded HEAD from S7 (vec_in norm=0.845187)
[S6] cosine check vs S7: cos=0.8462
[S6] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.606487)
[S6] loaded HEAD from S10 (vec_in norm=1.606487)
[S6] cosine check vs S10: cos=0.2162
[S6] BUFFERED delta from S10 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.228304)
[S7] loaded HEAD from S14 (vec_in norm=1.228304)
[S7] cosine check vs S14: cos=0.9059
[S7] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1792) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.836784)
[S7] loaded HEAD from S16 (vec_in norm=0.836784)
[S7] cosine check vs S16: cos=0.8011
[S7] BUFFERED delta from S16 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.647708)
[S9] loaded HEAD from S8 (vec_in norm=1.647708)
[S9] cosine check vs S8: cos=0.9386
[S9] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.388447)
[S6] loaded HEAD from S3 (vec_in norm=1.388447)
[S6] cosine check vs S3: cos=0.4436
[S6] BUFFERED delta from S3 (total buffered=3)
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.052082)
[S4] loaded HEAD from S2 (vec_in norm=1.052082)
[S4] cosine check vs S2: cos=0.7583
[S4] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1791) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.277371)
[S4] loaded HEAD from S15 (vec_in norm=1.277371)
[S4] cosine check vs S15: cos=0.6314
[S4] BUFFERED delta from S15 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1802) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.804668)
[S16] loaded HEAD from S4 (vec_in norm=0.804668)
[S16] cosine check vs S4: cos=0.9574
[S16] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.561170)
[S13] loaded HEAD from S17 (vec_in norm=1.561170)
[S13] cosine check vs S17: cos=-0.0203
[S13] DROPPED delta from S17 (cos=-0.0203 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7012 head_norm=1.288975
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.120358e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7012 head_norm=1.445971 delta_norm=0.312036
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.6958 head_norm=0.750377
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.321616e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.3728 head_norm=0.777131 delta_norm=0.432162
[S6] aggregate: ROLLBACK (f1_val pre=0.696 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.4165 head_norm=0.845187
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.017503e-02
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.4165 head_norm=0.870125 delta_norm=0.060175
[S7] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.4357 head_norm=0.836784
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.207779e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.4359 head_norm=0.811949 delta_norm=0.120778
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6745 head_norm=0.804668
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.751370e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6777 head_norm=0.849208 delta_norm=0.275137
[S4] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.052082 cos_to_last_merge=0.8011 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.801
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.6864342195361355, 'auprc': 0.6672235143726521, 'loss_val': 0.4450401698722578, 'psi': 0.6787499374707422}-{'f1_val': 0.7036724610994368, 'auprc': 0.7946011671480285, 'loss_val': 0.48940328523367616, 'psi': 0.7400439435188735}
[S3] START round=14 head_norm_before_train=1.388447 cos_to_last_merge=0.8538 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.854
[S3] round=14 local utility u=0.011448 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9971463025999411, 'loss_val': 0.2939699080824632, 'psi': 0.8192670968391773}-{'f1_val': 0.7007562037352997, 'auprc': 0.9971498577058294, 'loss_val': 0.31732754925854206, 'psi': 0.8193136653235116}
[S4] START round=14 head_norm_before_train=0.849208 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.147157 metrics={'f1_val': 0.6898745393354253, 'auprc': 0.8726002255104532, 'loss_val': 0.5174535455825289, 'psi': 0.7629648138054365}-{'f1_val': 0.6744841157435858, 'auprc': 0.8265605612788615, 'loss_val': 0.5813067165819881, 'psi': 0.735314693957696}
[S5] START round=14 head_norm_before_train=1.486168 (no previous merge yet)
[S5] round=14 local utility u=0.221319 metrics={'f1_val': 0.7011053602517017, 'auprc': 0.8596904096327597, 'loss_val': 0.384433386123406, 'psi': 0.7645393800041249}-{'f1_val': 0.7011053602517017, 'auprc': 0.7423803296229435, 'loss_val': 0.4751418798392819, 'psi': 0.7176153480001983}
[S6] START round=14 head_norm_before_train=0.777131 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.6970930090916138, 'auprc': 0.9633951603649387, 'loss_val': 0.8717325915144493, 'psi': 0.8036138696009438}-{'f1_val': 0.6957613500700938, 'auprc': 0.962903393359662, 'loss_val': 0.7834754848712352, 'psi': 0.8026181673859211}
[S7] START round=14 head_norm_before_train=0.870125 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.009950 metrics={'f1_val': 0.4172381946317165, 'auprc': 0.7148836695925053, 'loss_val': 1.0014004294980068, 'psi': 0.536296384616032}-{'f1_val': 0.416467909967687, 'auprc': 0.7374745394066683, 'loss_val': 1.0844506453693235, 'psi': 0.5448705617432795}
[S8] START round=14 head_norm_before_train=1.647708 (no previous merge yet)
[S8] round=14 local utility u=0.002859 metrics={'f1_val': 0.9937924949465919, 'auprc': 0.9985947006858058, 'loss_val': 0.11117371075709556, 'psi': 0.9957133772422775}-{'f1_val': 0.9947267123181514, 'auprc': 0.9990808476099955, 'loss_val': 0.12395621526174956, 'psi': 0.996468366434889}
[S9] START round=14 head_norm_before_train=1.445971 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.996063443316718, 'loss_val': 0.46873546443901043, 'psi': 0.8191553257906984}-{'f1_val': 0.7012165807733519, 'auprc': 0.9974127546555391, 'loss_val': 0.4613483967776615, 'psi': 0.8196950503262268}
[S10] START round=14 head_norm_before_train=1.606487 (no previous merge yet)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.6575537958463299, 'auprc': 0.903650028211864, 'loss_val': 0.44001539559667363, 'psi': 0.7559922887925435}-{'f1_val': 0.9940233795219484, 'auprc': 0.9979405612160311, 'loss_val': 0.21247811972918923, 'psi': 0.9955902521995814}
[S11] START round=14 head_norm_before_train=1.606205 (no previous merge yet)
[S11] round=14 local utility u=0.023583 metrics={'f1_val': 0.9676814695779581, 'auprc': 0.9974467214681835, 'loss_val': 0.17899064353331917, 'psi': 0.9795875703340482}-{'f1_val': 0.9604773857292719, 'auprc': 0.9977402317991335, 'loss_val': 0.18381332656664212, 'psi': 0.9753825241572165}
[S13] START round=14 head_norm_before_train=1.529580 (no previous merge yet)
[S13] round=14 local utility u=0.052947 metrics={'f1_val': 0.6504364142035152, 'auprc': 0.6524513100384763, 'loss_val': 0.5705490036751072, 'psi': 0.6512423725374996}-{'f1_val': 0.6147476401945717, 'auprc': 0.6868654635882837, 'loss_val': 0.5655522330249344, 'psi': 0.6435947695520565}
[S14] START round=14 head_norm_before_train=1.228304 cos_to_last_merge=0.8527 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.853
[S14] round=14 local utility u=0.039160 metrics={'f1_val': 0.9983704379879279, 'auprc': 0.999139943317383, 'loss_val': 0.18563008793807403, 'psi': 0.99867824011971}-{'f1_val': 0.9976226870742808, 'auprc': 0.9988173295489922, 'loss_val': 0.25849483965500225, 'psi': 0.9981005440641654}
[S15] START round=14 head_norm_before_train=1.277371 cos_to_last_merge=0.8429 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.843
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6929658006420611, 'auprc': 0.9770566133115186, 'loss_val': 0.33716391202530005, 'psi': 0.8066021257098441}-{'f1_val': 0.6938780114590247, 'auprc': 0.9846349583867458, 'loss_val': 0.30470684432503087, 'psi': 0.8101807902301132}
[S16] START round=14 head_norm_before_train=0.811949 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.294738 metrics={'f1_val': 0.516407351042526, 'auprc': 0.8131154332799013, 'loss_val': 0.8149787711352794, 'psi': 0.6350905839374761}-{'f1_val': 0.43572078383592244, 'auprc': 0.7835435846678134, 'loss_val': 0.8316193275752066, 'psi': 0.5748499041686789}
[S17] START round=14 head_norm_before_train=1.561170 (no previous merge yet)
[S17] round=14 local utility u=0.002214 metrics={'f1_val': 0.3742959003105094, 'auprc': 0.7209919791448666, 'loss_val': 0.9647252632247781, 'psi': 0.5129743318442522}-{'f1_val': 0.3591411861523875, 'auprc': 0.7507494939488449, 'loss_val': 0.9674974685509783, 'psi': 0.5157845092709705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:36608
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:36602
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:36607
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:36610
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.861112)
[S7] loaded HEAD from S16 (vec_in norm=0.861112)
[S7] cosine check vs S16: cos=0.8142
[S7] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.279065)
[S7] loaded HEAD from S14 (vec_in norm=1.279065)
[S7] cosine check vs S14: cos=0.9046
[S7] BUFFERED delta from S14 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1794) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.546662)
[S7] loaded HEAD from S13 (vec_in norm=1.546662)
[S7] cosine check vs S13: cos=0.4072
[S7] BUFFERED delta from S13 (total buffered=3)
[S7] RECEIVED delta(kind=head bytes=1803) from S5
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.512003)
[S7] loaded HEAD from S5 (vec_in norm=1.512003)
[S7] cosine check vs S5: cos=-0.0368
[S7] DROPPED delta from S5 (cos=-0.0368 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.678375)
[S9] loaded HEAD from S8 (vec_in norm=1.678375)
[S9] cosine check vs S8: cos=0.9751
[S9] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1793) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.893278)
[S6] loaded HEAD from S7 (vec_in norm=0.893278)
[S6] cosine check vs S7: cos=0.5505
[S6] BUFFERED delta from S7 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1806) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.645752)
[S2] loaded HEAD from S11 (vec_in norm=1.645752)
[S2] cosine check vs S11: cos=-0.0956
[S2] DROPPED delta from S11 (cos=-0.0956 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.914716)
[S16] loaded HEAD from S4 (vec_in norm=0.914716)
[S16] cosine check vs S4: cos=0.9572
[S16] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.420877)
[S6] loaded HEAD from S3 (vec_in norm=1.420877)
[S6] cosine check vs S3: cos=0.7568
[S6] BUFFERED delta from S3 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.577840)
[S13] loaded HEAD from S17 (vec_in norm=1.577840)
[S13] cosine check vs S17: cos=-0.0211
[S13] DROPPED delta from S17 (cos=-0.0211 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7012 head_norm=1.470410
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.037300e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7012 head_norm=1.564615 delta_norm=0.203730
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.6971 head_norm=0.799110
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.446496e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.6992 head_norm=0.804375 delta_norm=0.144650
[S6] aggregate: ACCEPT kept=['S7', 'S3'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.5164 head_norm=0.861112
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.326194e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.5162 head_norm=0.878363 delta_norm=0.132619
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.4172 head_norm=0.893278
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.520692e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.4172 head_norm=0.890633 delta_norm=0.152069
[S7] aggregate: ACCEPT kept=['S16', 'S14', 'S13'] (k=3/3) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.104252 cos_to_last_merge=0.7894 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.789
[S2] round=15 local utility u=0.089192 metrics={'f1_val': 0.699768428218017, 'auprc': 0.6676654065392942, 'loss_val': 0.3479879785163177, 'psi': 0.6869272195465279}-{'f1_val': 0.6864342195361355, 'auprc': 0.6672235143726521, 'loss_val': 0.4450401698722578, 'psi': 0.6787499374707422}
[S3] START round=15 head_norm_before_train=1.420877 cos_to_last_merge=0.8477 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.848
[S3] round=15 local utility u=0.010273 metrics={'f1_val': 0.7009355793019081, 'auprc': 0.9970857296781117, 'loss_val': 0.27477071042413737, 'psi': 0.8193956394523896}-{'f1_val': 0.7006809596653347, 'auprc': 0.9971463025999411, 'loss_val': 0.2939699080824632, 'psi': 0.8192670968391773}
[S4] START round=15 head_norm_before_train=0.914716 cos_to_last_merge=0.9970 (last merge round=13)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.6682515290499095, 'auprc': 0.6609974975485613, 'loss_val': 0.474631838718884, 'psi': 0.6653499164493701}-{'f1_val': 0.6898745393354253, 'auprc': 0.8726002255104532, 'loss_val': 0.5174535455825289, 'psi': 0.7629648138054365}
[S5] START round=15 head_norm_before_train=1.512003 (no previous merge yet)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.7895326718572921, 'loss_val': 0.37273781401869044, 'psi': 0.7363272388324361}-{'f1_val': 0.7011053602517017, 'auprc': 0.8596904096327597, 'loss_val': 0.384433386123406, 'psi': 0.7645393800041249}
[S6] START round=15 head_norm_before_train=0.804375 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.063859 metrics={'f1_val': 0.7072428994429236, 'auprc': 0.9555680730786873, 'loss_val': 0.7814318525678565, 'psi': 0.8065729688972292}-{'f1_val': 0.6970930090916138, 'auprc': 0.9633951603649387, 'loss_val': 0.8717325915144493, 'psi': 0.8036138696009438}
[S7] START round=15 head_norm_before_train=0.890633 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.126932 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.777006663564769, 'loss_val': 0.932688759940051, 'psi': 0.5610239217186765}-{'f1_val': 0.4172381946317165, 'auprc': 0.7148836695925053, 'loss_val': 1.0014004294980068, 'psi': 0.536296384616032}
[S8] START round=15 head_norm_before_train=1.678375 (no previous merge yet)
[S8] round=15 local utility u=0.014535 metrics={'f1_val': 0.9934042750107773, 'auprc': 0.9989462273239464, 'loss_val': 0.08082907147579693, 'psi': 0.995621055936045}-{'f1_val': 0.9937924949465919, 'auprc': 0.9985947006858058, 'loss_val': 0.11117371075709556, 'psi': 0.9957133772422775}
[S9] START round=15 head_norm_before_train=1.564615 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.038866 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9966286329544223, 'loss_val': 0.39269928035583757, 'psi': 0.8193814016457801}-{'f1_val': 0.7012165807733519, 'auprc': 0.996063443316718, 'loss_val': 0.46873546443901043, 'psi': 0.8191553257906984}
[S10] START round=15 head_norm_before_train=1.629977 (no previous merge yet)
[S10] round=15 local utility u=1.000000 metrics={'f1_val': 0.9951986427081019, 'auprc': 0.9976339669606532, 'loss_val': 0.14623210720432264, 'psi': 0.9961727724091224}-{'f1_val': 0.6575537958463299, 'auprc': 0.903650028211864, 'loss_val': 0.44001539559667363, 'psi': 0.7559922887925435}
[S11] START round=15 head_norm_before_train=1.645752 (no previous merge yet)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.9583614716616902, 'auprc': 0.997859127622802, 'loss_val': 0.16930262331408916, 'psi': 0.9741605340461349}-{'f1_val': 0.9676814695779581, 'auprc': 0.9974467214681835, 'loss_val': 0.17899064353331917, 'psi': 0.9795875703340482}
[S13] START round=15 head_norm_before_train=1.546662 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5881398111937282, 'auprc': 0.6903659918500002, 'loss_val': 0.6883883958225369, 'psi': 0.629030283456237}-{'f1_val': 0.6504364142035152, 'auprc': 0.6524513100384763, 'loss_val': 0.5705490036751072, 'psi': 0.6512423725374996}
[S14] START round=15 head_norm_before_train=1.279065 cos_to_last_merge=0.8434 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.843
[S14] round=15 local utility u=0.010671 metrics={'f1_val': 0.9965070306527815, 'auprc': 0.9970676482439911, 'loss_val': 0.1468901360872047, 'psi': 0.9967312776892653}-{'f1_val': 0.9983704379879279, 'auprc': 0.999139943317383, 'loss_val': 0.18563008793807403, 'psi': 0.99867824011971}
[S15] START round=15 head_norm_before_train=1.324411 cos_to_last_merge=0.8296 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.830
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.696117086089852, 'auprc': 0.9674065921010727, 'loss_val': 0.3426226008473007, 'psi': 0.8046328884943403}-{'f1_val': 0.6929658006420611, 'auprc': 0.9770566133115186, 'loss_val': 0.33716391202530005, 'psi': 0.8066021257098441}
[S16] START round=15 head_norm_before_train=0.878363 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.443348 metrics={'f1_val': 0.5985754078326541, 'auprc': 0.8863764329777069, 'loss_val': 0.6410739001767981, 'psi': 0.7136958178906752}-{'f1_val': 0.516407351042526, 'auprc': 0.8131154332799013, 'loss_val': 0.8149787711352794, 'psi': 0.6350905839374761}
[S17] START round=15 head_norm_before_train=1.577840 (no previous merge yet)
[S17] round=15 local utility u=0.055383 metrics={'f1_val': 0.38221591984016023, 'auprc': 0.7227130294197768, 'loss_val': 0.9066427125171582, 'psi': 0.5184147636720069}-{'f1_val': 0.3742959003105094, 'auprc': 0.7209919791448666, 'loss_val': 0.9647252632247781, 'psi': 0.5129743318442522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:36605
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:36607
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:36607
[S14] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.832340)
[S4] loaded HEAD from S6 (vec_in norm=0.832340)
[S4] cosine check vs S6: cos=0.3685
[S4] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.704930)
[S9] loaded HEAD from S8 (vec_in norm=1.704930)
[S9] cosine check vs S8: cos=0.9849
[S9] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.589147)
[S5] loaded HEAD from S9 (vec_in norm=1.589147)
[S5] cosine check vs S9: cos=-0.0306
[S5] DROPPED delta from S9 (cos=-0.0306 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.451170)
[S6] loaded HEAD from S3 (vec_in norm=1.451170)
[S6] cosine check vs S3: cos=0.7757
[S6] BUFFERED delta from S3 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.922271)
[S6] loaded HEAD from S7 (vec_in norm=0.922271)
[S6] cosine check vs S7: cos=0.5877
[S6] BUFFERED delta from S7 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1803) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.645812)
[S6] loaded HEAD from S10 (vec_in norm=1.645812)
[S6] cosine check vs S10: cos=0.5072
[S6] BUFFERED delta from S10 (total buffered=3)
[S4] RECEIVED delta(kind=head bytes=1802) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.152264)
[S4] loaded HEAD from S2 (vec_in norm=1.152264)
[S4] cosine check vs S2: cos=0.7814
[S4] BUFFERED delta from S2 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.331442)
[S7] loaded HEAD from S14 (vec_in norm=1.331442)
[S7] cosine check vs S14: cos=0.8945
[S7] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1788) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.925940)
[S7] loaded HEAD from S16 (vec_in norm=0.925940)
[S7] cosine check vs S16: cos=0.7280
[S7] BUFFERED delta from S16 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.595108)
[S13] loaded HEAD from S17 (vec_in norm=1.595108)
[S13] cosine check vs S17: cos=-0.0228
[S13] DROPPED delta from S17 (cos=-0.0228 < 0.0)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.6683 head_norm=0.978761
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.930532e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.6685 head_norm=0.822542 delta_norm=0.293053
[S4] aggregate: ACCEPT kept=['S6', 'S2'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.220 → S16@127.0.0.1:36616
[S13] ⇄ pheromone p=0.138 → S7@127.0.0.1:36608
[S5] ⇄ pheromone p=0.221 → S7@127.0.0.1:36608
[S11] ⇄ pheromone p=0.233 → S2@127.0.0.1:36602
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.7072 head_norm=0.832340
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.772223e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.6958 head_norm=0.903485 delta_norm=0.277222
[S6] aggregate: ROLLBACK (f1_val pre=0.707 post=0.696 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.209 → S4@127.0.0.1:36604
[S2] ⇄ pheromone p=0.187 → S4@127.0.0.1:36604
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7012 head_norm=1.589147
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.541018e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7012 head_norm=1.640835 delta_norm=0.154102
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.098 → S5@127.0.0.1:36605
[S10] ⇄ pheromone p=0.411 → S6@127.0.0.1:36607
[S8] ⇄ pheromone p=0.183 → S9@127.0.0.1:36610
[S14] ⇄ pheromone p=0.287 → S7@127.0.0.1:36608
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.4170 head_norm=0.922271
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.119355e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.4170 head_norm=0.934128 delta_norm=0.111936
[S7] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.209 → S6@127.0.0.1:36607
[S16] ⇄ pheromone p=0.251 → S7@127.0.0.1:36608
[S3] ⇄ pheromone p=0.173 → S6@127.0.0.1:36607
[S15] ⇄ pheromone p=0.225 → S4@127.0.0.1:36604
[S17] ⇄ pheromone p=0.105 → S13@127.0.0.1:36613
[S2] START round=16 head_norm_before_train=1.152264 cos_to_last_merge=0.7795 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.780
[S2] round=16 local utility u=0.100640 metrics={'f1_val': 0.7013403290888537, 'auprc': 0.7412870104753515, 'loss_val': 0.3770034641843225, 'psi': 0.7173190016434527}-{'f1_val': 0.699768428218017, 'auprc': 0.6676654065392942, 'loss_val': 0.3479879785163177, 'psi': 0.6869272195465279}
[S3] START round=16 head_norm_before_train=1.451170 cos_to_last_merge=0.8422 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.842
[S3] round=16 local utility u=0.014424 metrics={'f1_val': 0.7009355793019081, 'auprc': 0.9986572598064383, 'loss_val': 0.25063700848292586, 'psi': 0.8200242515037202}-{'f1_val': 0.7009355793019081, 'auprc': 0.9970857296781117, 'loss_val': 0.27477071042413737, 'psi': 0.8193956394523896}
[S4] START round=16 head_norm_before_train=0.822542 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.283328 metrics={'f1_val': 0.6697793393639166, 'auprc': 0.854161317302708, 'loss_val': 0.4966339126285466, 'psi': 0.7435321305394331}-{'f1_val': 0.6682515290499095, 'auprc': 0.6609974975485613, 'loss_val': 0.474631838718884, 'psi': 0.6653499164493701}
[S5] START round=16 head_norm_before_train=1.536144 (no previous merge yet)
[S5] round=16 local utility u=0.327403 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.9902388289683883, 'loss_val': 0.3200512601481764, 'psi': 0.8166097016768745}-{'f1_val': 0.7008569501491988, 'auprc': 0.7895326718572921, 'loss_val': 0.37273781401869044, 'psi': 0.7363272388324361}
[S6] START round=16 head_norm_before_train=0.903485 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.010219 metrics={'f1_val': 0.7086184894012433, 'auprc': 0.9598630415861105, 'loss_val': 0.7821319920967107, 'psi': 0.8091163102751902}-{'f1_val': 0.7072428994429236, 'auprc': 0.9555680730786873, 'loss_val': 0.7814318525678565, 'psi': 0.8065729688972292}
[S7] START round=16 head_norm_before_train=0.934128 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.7528821800589323, 'loss_val': 0.893120217952683, 'psi': 0.551252351682637}-{'f1_val': 0.41703542715461484, 'auprc': 0.777006663564769, 'loss_val': 0.932688759940051, 'psi': 0.5610239217186765}
[S8] START round=16 head_norm_before_train=1.704930 (no previous merge yet)
[S8] round=16 local utility u=0.002617 metrics={'f1_val': 0.9937993908304248, 'auprc': 0.9982257261303134, 'loss_val': 0.07580413124847812, 'psi': 0.9955699249503802}-{'f1_val': 0.9934042750107773, 'auprc': 0.9989462273239464, 'loss_val': 0.08082907147579693, 'psi': 0.995621055936045}
[S9] START round=16 head_norm_before_train=1.640835 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.032505 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9963693372603709, 'loss_val': 0.3269117609908449, 'psi': 0.8192776833681595}-{'f1_val': 0.7012165807733519, 'auprc': 0.9966286329544223, 'loss_val': 0.39269928035583757, 'psi': 0.8193814016457801}
[S10] START round=16 head_norm_before_train=1.645812 (no previous merge yet)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9391060718480718, 'auprc': 0.9935989587434866, 'loss_val': 0.23086650850005733, 'psi': 0.9609032266062378}-{'f1_val': 0.9951986427081019, 'auprc': 0.9976339669606532, 'loss_val': 0.14623210720432264, 'psi': 0.9961727724091224}
[S11] START round=16 head_norm_before_train=1.685243 (no previous merge yet)
[S11] round=16 local utility u=0.119647 metrics={'f1_val': 0.9907949648649134, 'auprc': 0.9983692637225561, 'loss_val': 0.12613944870314672, 'psi': 0.9938246844079704}-{'f1_val': 0.9583614716616902, 'auprc': 0.997859127622802, 'loss_val': 0.16930262331408916, 'psi': 0.9741605340461349}
[S13] START round=16 head_norm_before_train=1.556870 (no previous merge yet)
[S13] round=16 local utility u=0.067393 metrics={'f1_val': 0.6094481427551688, 'auprc': 0.6762649401196457, 'loss_val': 0.6391488535667328, 'psi': 0.6361748617009595}-{'f1_val': 0.5881398111937282, 'auprc': 0.6903659918500002, 'loss_val': 0.6883883958225369, 'psi': 0.629030283456237}
[S14] START round=16 head_norm_before_train=1.331442 cos_to_last_merge=0.8342 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.834
[S14] round=16 local utility u=0.020034 metrics={'f1_val': 0.9976543488671686, 'auprc': 0.9985326161677148, 'loss_val': 0.11810050613694435, 'psi': 0.9980056557873871}-{'f1_val': 0.9965070306527815, 'auprc': 0.9970676482439911, 'loss_val': 0.1468901360872047, 'psi': 0.9967312776892653}
[S15] START round=16 head_norm_before_train=1.360483 cos_to_last_merge=0.8188 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.819
[S15] round=16 local utility u=0.772642 metrics={'f1_val': 0.9191843042653088, 'auprc': 0.981717656364515, 'loss_val': 0.1786742188418337, 'psi': 0.9441976451049914}-{'f1_val': 0.696117086089852, 'auprc': 0.9674065921010727, 'loss_val': 0.3426226008473007, 'psi': 0.8046328884943403}
[S16] START round=16 head_norm_before_train=0.925940 cos_to_last_merge=0.9982 (last merge round=14)
[S16] round=16 local utility u=0.743044 metrics={'f1_val': 0.8216466550000465, 'auprc': 0.9159933162834468, 'loss_val': 0.5822632143866873, 'psi': 0.8593853195134067}-{'f1_val': 0.5985754078326541, 'auprc': 0.8863764329777069, 'loss_val': 0.6410739001767981, 'psi': 0.7136958178906752}
[S17] START round=16 head_norm_before_train=1.595108 (no previous merge yet)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.35504639336932986, 'auprc': 0.7027386341572466, 'loss_val': 0.8989980104584983, 'psi': 0.49412328968449654}-{'f1_val': 0.38221591984016023, 'auprc': 0.7227130294197768, 'loss_val': 0.9066427125171582, 'psi': 0.5184147636720069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:36607
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.981895)
[S7] loaded HEAD from S16 (vec_in norm=0.981895)
[S7] cosine check vs S16: cos=0.7518
[S7] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.569781)
[S7] loaded HEAD from S13 (vec_in norm=1.569781)
[S7] cosine check vs S13: cos=0.4511
[S7] BUFFERED delta from S13 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1801) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.481210)
[S6] loaded HEAD from S3 (vec_in norm=1.481210)
[S6] cosine check vs S3: cos=0.8431
[S6] BUFFERED delta from S3 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1805) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.716945)
[S2] loaded HEAD from S11 (vec_in norm=1.716945)
[S2] cosine check vs S11: cos=-0.0960
[S2] DROPPED delta from S11 (cos=-0.0960 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.373533)
[S7] loaded HEAD from S14 (vec_in norm=1.373533)
[S7] cosine check vs S14: cos=0.8971
[S7] BUFFERED delta from S14 (total buffered=3)
[S4] RECEIVED delta(kind=head bytes=1793) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.926364)
[S4] loaded HEAD from S6 (vec_in norm=0.926364)
[S4] cosine check vs S6: cos=0.4074
[S4] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.392290)
[S4] loaded HEAD from S15 (vec_in norm=1.392290)
[S4] cosine check vs S15: cos=0.6531
[S4] BUFFERED delta from S15 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1802) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.196536)
[S4] loaded HEAD from S2 (vec_in norm=1.196536)
[S4] cosine check vs S2: cos=0.8320
[S4] BUFFERED delta from S2 (total buffered=3)
[S16] RECEIVED delta(kind=head bytes=1799) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.877578)
[S16] loaded HEAD from S4 (vec_in norm=0.877578)
[S16] cosine check vs S4: cos=0.9472
[S16] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1804) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.732143)
[S9] loaded HEAD from S8 (vec_in norm=1.732143)
[S9] cosine check vs S8: cos=0.9890
[S9] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1805) from S5
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.560625)
[S7] loaded HEAD from S5 (vec_in norm=1.560625)
[S7] cosine check vs S5: cos=-0.0479
[S7] DROPPED delta from S5 (cos=-0.0479 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.666978)
[S5] loaded HEAD from S9 (vec_in norm=1.666978)
[S5] cosine check vs S9: cos=-0.0351
[S5] DROPPED delta from S9 (cos=-0.0351 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.4168 head_norm=0.967160
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.481053e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.4168 head_norm=0.956854 delta_norm=0.148105
[S7] aggregate: ACCEPT kept=['S16', 'S13', 'S14'] (k=3/3) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.7086 head_norm=0.926364
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.296764e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.7077 head_norm=1.158208 delta_norm=0.429676
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.8216 head_norm=0.981895
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.595305e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.8272 head_norm=0.917431 delta_norm=0.159531
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.6698 head_norm=0.877578
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.632792e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.6692 head_norm=0.833945 delta_norm=0.163279
[S4] aggregate: ACCEPT kept=['S6', 'S15', 'S2'] (k=3/3) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.7012 head_norm=1.666978
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.299872e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.7012 head_norm=1.694895 delta_norm=0.129987
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.196536 cos_to_last_merge=0.7709 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.771
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.7012985964239116, 'auprc': 0.6789947968042063, 'loss_val': 0.3561814962252652, 'psi': 0.6923770765760295}-{'f1_val': 0.7013403290888537, 'auprc': 0.7412870104753515, 'loss_val': 0.3770034641843225, 'psi': 0.7173190016434527}
[S3] START round=17 head_norm_before_train=1.481210 cos_to_last_merge=0.8369 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.837
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.8884409306923654, 'loss_val': 0.29748517859600626, 'psi': 0.7757399737770696}-{'f1_val': 0.7009355793019081, 'auprc': 0.9986572598064383, 'loss_val': 0.25063700848292586, 'psi': 0.8200242515037202}
[S4] START round=17 head_norm_before_train=0.833945 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.6681710188781318, 'auprc': 0.8493888457998697, 'loss_val': 0.5211429976566455, 'psi': 0.740658149646827}-{'f1_val': 0.6697793393639166, 'auprc': 0.854161317302708, 'loss_val': 0.4966339126285466, 'psi': 0.7435321305394331}
[S5] START round=17 head_norm_before_train=1.560625 (no previous merge yet)
[S5] round=17 local utility u=0.015146 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.9922374913479808, 'loss_val': 0.2957552834271037, 'psi': 0.8174091666287115}-{'f1_val': 0.7008569501491988, 'auprc': 0.9902388289683883, 'loss_val': 0.3200512601481764, 'psi': 0.8166097016768745}
[S6] START round=17 head_norm_before_train=1.158208 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.026898 metrics={'f1_val': 0.6999730601137526, 'auprc': 0.964111500171664, 'loss_val': 0.6892084335430695, 'psi': 0.8056284361369173}-{'f1_val': 0.7086184894012433, 'auprc': 0.9598630415861105, 'loss_val': 0.7821319920967107, 'psi': 0.8091163102751902}
[S7] START round=17 head_norm_before_train=0.956854 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.096258 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.8081913680679406, 'loss_val': 0.8670158382838381, 'psi': 0.5734244054886508}-{'f1_val': 0.41683246609844005, 'auprc': 0.7528821800589323, 'loss_val': 0.893120217952683, 'psi': 0.551252351682637}
[S8] START round=17 head_norm_before_train=1.732143 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9887021880404929, 'auprc': 0.995169610135723, 'loss_val': 0.07744055364779312, 'psi': 0.9912891568785849}-{'f1_val': 0.9937993908304248, 'auprc': 0.9982257261303134, 'loss_val': 0.07580413124847812, 'psi': 0.9955699249503802}
[S9] START round=17 head_norm_before_train=1.694895 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.072980 metrics={'f1_val': 0.7198919080677115, 'auprc': 0.9948728624995143, 'loss_val': 0.2885139850900762, 'psi': 0.8298842898404326}-{'f1_val': 0.7012165807733519, 'auprc': 0.9963693372603709, 'loss_val': 0.3269117609908449, 'psi': 0.8192776833681595}
[S10] START round=17 head_norm_before_train=1.657047 (no previous merge yet)
[S10] round=17 local utility u=0.214144 metrics={'f1_val': 0.9934616467179553, 'auprc': 0.9958733239713267, 'loss_val': 0.13553526192953302, 'psi': 0.9944263176193038}-{'f1_val': 0.9391060718480718, 'auprc': 0.9935989587434866, 'loss_val': 0.23086650850005733, 'psi': 0.9609032266062378}
[S11] START round=17 head_norm_before_train=1.716945 (no previous merge yet)
[S11] round=17 local utility u=0.039004 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979518828766428, 'loss_val': 0.07993985003511903, 'psi': 0.9969638536319737}-{'f1_val': 0.9907949648649134, 'auprc': 0.9983692637225561, 'loss_val': 0.12613944870314672, 'psi': 0.9938246844079704}
[S13] START round=17 head_norm_before_train=1.569781 (no previous merge yet)
[S13] round=17 local utility u=0.131303 metrics={'f1_val': 0.6327744813117591, 'auprc': 0.6807989338027096, 'loss_val': 0.5301028942965222, 'psi': 0.6519842623081393}-{'f1_val': 0.6094481427551688, 'auprc': 0.6762649401196457, 'loss_val': 0.6391488535667328, 'psi': 0.6361748617009595}
[S14] START round=17 head_norm_before_train=1.373533 cos_to_last_merge=0.8271 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.827
[S14] round=17 local utility u=0.010398 metrics={'f1_val': 0.997016066296184, 'auprc': 0.9970588695135797, 'loss_val': 0.08905427242322207, 'psi': 0.9970331875831422}-{'f1_val': 0.9976543488671686, 'auprc': 0.9985326161677148, 'loss_val': 0.11810050613694435, 'psi': 0.9980056557873871}
[S15] START round=17 head_norm_before_train=1.392290 cos_to_last_merge=0.8092 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.809
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6962912861892172, 'auprc': 0.8135733247254242, 'loss_val': 0.3934526986090536, 'psi': 0.7432041016037001}-{'f1_val': 0.9191843042653088, 'auprc': 0.981717656364515, 'loss_val': 0.1786742188418337, 'psi': 0.9441976451049914}
[S16] START round=17 head_norm_before_train=0.917431 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.8300420025221235, 'auprc': 0.8673598398997453, 'loss_val': 0.7416753832493564, 'psi': 0.8449691374731723}-{'f1_val': 0.8216466550000465, 'auprc': 0.9159933162834468, 'loss_val': 0.5822632143866873, 'psi': 0.8593853195134067}
[S17] START round=17 head_norm_before_train=1.613957 (no previous merge yet)
[S17] round=17 local utility u=0.373647 metrics={'f1_val': 0.4259874448281902, 'auprc': 0.7454449073058536, 'loss_val': 0.7054694228470418, 'psi': 0.5537704298192556}-{'f1_val': 0.35504639336932986, 'auprc': 0.7027386341572466, 'loss_val': 0.8989980104584983, 'psi': 0.49412328968449654}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:36605
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:36608
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:36608
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.582456)
[S7] loaded HEAD from S13 (vec_in norm=1.582456)
[S7] cosine check vs S13: cos=0.5663
[S7] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.412713)
[S7] loaded HEAD from S14 (vec_in norm=1.412713)
[S7] cosine check vs S14: cos=0.8852
[S7] BUFFERED delta from S14 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.724314)
[S5] loaded HEAD from S9 (vec_in norm=1.724314)
[S5] cosine check vs S9: cos=-0.0400
[S5] DROPPED delta from S9 (cos=-0.0400 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S5
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.584610)
[S7] loaded HEAD from S5 (vec_in norm=1.584610)
[S7] cosine check vs S5: cos=-0.0504
[S7] DROPPED delta from S5 (cos=-0.0504 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.666184)
[S6] loaded HEAD from S10 (vec_in norm=1.666184)
[S6] cosine check vs S10: cos=0.6167
[S6] BUFFERED delta from S10 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1804) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.745755)
[S2] loaded HEAD from S11 (vec_in norm=1.745755)
[S2] cosine check vs S11: cos=-0.0960
[S2] DROPPED delta from S11 (cos=-0.0960 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.988218)
[S6] loaded HEAD from S7 (vec_in norm=0.988218)
[S6] cosine check vs S7: cos=0.2031
[S6] BUFFERED delta from S7 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1802) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.175319)
[S4] loaded HEAD from S6 (vec_in norm=1.175319)
[S4] cosine check vs S6: cos=0.3308
[S4] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.633476)
[S13] loaded HEAD from S17 (vec_in norm=1.633476)
[S13] cosine check vs S17: cos=-0.0261
[S13] DROPPED delta from S17 (cos=-0.0261 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.6682 head_norm=0.887034
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.079583e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.6187 head_norm=0.845274 delta_norm=0.607958
[S4] aggregate: ROLLBACK (f1_val pre=0.668 post=0.619 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.7000 head_norm=1.175319
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.598849e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.7014 head_norm=0.966042 delta_norm=0.459885
[S6] aggregate: ACCEPT kept=['S10', 'S7'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.4169 head_norm=0.988218
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.212382e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.4169 head_norm=1.078856 delta_norm=0.321238
[S7] aggregate: ACCEPT kept=['S13', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.234224 cos_to_last_merge=0.7637 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.764
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7005900905344093, 'auprc': 0.6776083838149982, 'loss_val': 0.35142455373657683, 'psi': 0.6913974078466449}-{'f1_val': 0.7012985964239116, 'auprc': 0.6789947968042063, 'loss_val': 0.3561814962252652, 'psi': 0.6923770765760295}
[S3] START round=18 head_norm_before_train=1.513186 cos_to_last_merge=0.8320 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.832
[S3] round=18 local utility u=0.221448 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9970627607151156, 'loss_val': 0.1809042474057004, 'psi': 0.8192336800852471}-{'f1_val': 0.7006060025002057, 'auprc': 0.8884409306923654, 'loss_val': 0.29748517859600626, 'psi': 0.7757399737770696}
[S4] START round=18 head_norm_before_train=0.845274 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.6249666580873274, 'auprc': 0.9266690665180537, 'loss_val': 0.6506016142455477, 'psi': 0.7456476214596179}-{'f1_val': 0.6681710188781318, 'auprc': 0.8493888457998697, 'loss_val': 0.5211429976566455, 'psi': 0.740658149646827}
[S5] START round=18 head_norm_before_train=1.584610 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.6384217072439855, 'auprc': 0.7910615262561465, 'loss_val': 0.47161651123926684, 'psi': 0.6994776348488498}-{'f1_val': 0.7008569501491988, 'auprc': 0.9922374913479808, 'loss_val': 0.2957552834271037, 'psi': 0.8174091666287115}
[S6] START round=18 head_norm_before_train=0.966042 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.7066292190312996, 'auprc': 0.8651419299195859, 'loss_val': 0.7039643467078406, 'psi': 0.7700343033866142}-{'f1_val': 0.6999730601137526, 'auprc': 0.964111500171664, 'loss_val': 0.6892084335430695, 'psi': 0.8056284361369173}
[S7] START round=18 head_norm_before_train=1.078856 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.050795 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.8415643803162265, 'loss_val': 0.864326694463143, 'psi': 0.5866518229931046}-{'f1_val': 0.4169130971024577, 'auprc': 0.8081913680679406, 'loss_val': 0.8670158382838381, 'psi': 0.5734244054886508}
[S8] START round=18 head_norm_before_train=1.760600 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9879591837696123, 'auprc': 0.9895159552175197, 'loss_val': 0.08854755495142347, 'psi': 0.9885818923487752}-{'f1_val': 0.9887021880404929, 'auprc': 0.995169610135723, 'loss_val': 0.07744055364779312, 'psi': 0.9912891568785849}
[S9] START round=18 head_norm_before_train=1.724314 cos_to_last_merge=0.9980 (last merge round=16)
[S9] round=18 local utility u=0.868520 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.99501936978518, 'loss_val': 0.18495475882041315, 'psi': 0.993246940042108}-{'f1_val': 0.7198919080677115, 'auprc': 0.9948728624995143, 'loss_val': 0.2885139850900762, 'psi': 0.8298842898404326}
[S10] START round=18 head_norm_before_train=1.666184 (no previous merge yet)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9927256722954716, 'auprc': 0.9962151697885451, 'loss_val': 0.15713876833465548, 'psi': 0.994121471292701}-{'f1_val': 0.9934616467179553, 'auprc': 0.9958733239713267, 'loss_val': 0.13553526192953302, 'psi': 0.9944263176193038}
[S11] START round=18 head_norm_before_train=1.745755 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.9457722809513339, 'auprc': 0.9959137408612253, 'loss_val': 0.2442881787486157, 'psi': 0.9658288649152905}-{'f1_val': 0.996305167468861, 'auprc': 0.9979518828766428, 'loss_val': 0.07993985003511903, 'psi': 0.9969638536319737}
[S13] START round=18 head_norm_before_train=1.582456 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.580177457150749, 'auprc': 0.6912978507350613, 'loss_val': 0.7543094214110891, 'psi': 0.624625614584474}-{'f1_val': 0.6327744813117591, 'auprc': 0.6807989338027096, 'loss_val': 0.5301028942965222, 'psi': 0.6519842623081393}
[S14] START round=18 head_norm_before_train=1.412713 cos_to_last_merge=0.8209 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.821
[S14] round=18 local utility u=0.008612 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.998921909585449, 'loss_val': 0.0802215683709372, 'psi': 0.9980586104640722}-{'f1_val': 0.997016066296184, 'auprc': 0.9970588695135797, 'loss_val': 0.08905427242322207, 'psi': 0.9970331875831422}
[S15] START round=18 head_norm_before_train=1.420616 cos_to_last_merge=0.8008 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.801
[S15] round=18 local utility u=1.000000 metrics={'f1_val': 0.9391261425219235, 'auprc': 0.977916291803944, 'loss_val': 0.1589080549629996, 'psi': 0.9546422022347317}-{'f1_val': 0.6962912861892172, 'auprc': 0.8135733247254242, 'loss_val': 0.3934526986090536, 'psi': 0.7432041016037001}
[S16] START round=18 head_norm_before_train=0.971567 cos_to_last_merge=0.9982 (last merge round=16)
[S16] round=18 local utility u=0.533726 metrics={'f1_val': 0.9059954261320613, 'auprc': 0.9835467963102444, 'loss_val': 0.4785044832605296, 'psi': 0.9370159742033346}-{'f1_val': 0.8300420025221235, 'auprc': 0.8673598398997453, 'loss_val': 0.7416753832493564, 'psi': 0.8449691374731723}
[S17] START round=18 head_norm_before_train=1.633476 (no previous merge yet)
[S17] round=18 local utility u=0.138063 metrics={'f1_val': 0.41611762164721605, 'auprc': 0.839634171575296, 'loss_val': 0.6526919653702203, 'psi': 0.5855242416184481}-{'f1_val': 0.4259874448281902, 'auprc': 0.7454449073058536, 'loss_val': 0.7054694228470418, 'psi': 0.5537704298192556}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:36605
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:36608
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1791) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.021606)
[S7] loaded HEAD from S16 (vec_in norm=1.021606)
[S7] cosine check vs S16: cos=0.5172
[S7] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1793) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.449529)
[S4] loaded HEAD from S15 (vec_in norm=1.449529)
[S4] cosine check vs S15: cos=0.4897
[S4] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.759909)
[S5] loaded HEAD from S9 (vec_in norm=1.759909)
[S5] cosine check vs S9: cos=-0.0485
[S5] DROPPED delta from S9 (cos=-0.0485 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.445393)
[S7] loaded HEAD from S14 (vec_in norm=1.445393)
[S7] cosine check vs S14: cos=0.8736
[S7] BUFFERED delta from S14 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1796) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.543718)
[S6] loaded HEAD from S3 (vec_in norm=1.543718)
[S6] cosine check vs S3: cos=0.8091
[S6] BUFFERED delta from S3 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.102665)
[S6] loaded HEAD from S7 (vec_in norm=1.102665)
[S6] cosine check vs S7: cos=0.3933
[S6] BUFFERED delta from S7 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.653600)
[S13] loaded HEAD from S17 (vec_in norm=1.653600)
[S13] cosine check vs S17: cos=-0.0263
[S13] DROPPED delta from S17 (cos=-0.0263 < 0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.7066 head_norm=0.990161
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.436112e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.6940 head_norm=0.944697 delta_norm=0.243611
[S6] aggregate: ROLLBACK (f1_val pre=0.707 post=0.694 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.6250 head_norm=0.882395
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.377844e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.9500 head_norm=1.016420 delta_norm=0.637784
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.4167 head_norm=1.102665
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.767426e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.4167 head_norm=1.031552 delta_norm=0.276743
[S7] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.266130 cos_to_last_merge=0.7583 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.758
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.6781425211980134, 'auprc': 0.6710289283014256, 'loss_val': 0.4178048651738099, 'psi': 0.6752970840393784}-{'f1_val': 0.7005900905344093, 'auprc': 0.6776083838149982, 'loss_val': 0.35142455373657683, 'psi': 0.6913974078466449}
[S3] START round=19 head_norm_before_train=1.543718 cos_to_last_merge=0.8273 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.827
[S3] round=19 local utility u=0.496189 metrics={'f1_val': 0.8625684155651169, 'auprc': 0.9969902986409623, 'loss_val': 0.15963317397910243, 'psi': 0.916337168795455}-{'f1_val': 0.7006809596653347, 'auprc': 0.9970627607151156, 'loss_val': 0.1809042474057004, 'psi': 0.8192336800852471}
[S4] START round=19 head_norm_before_train=1.016420 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=1.000000 metrics={'f1_val': 0.952752249580298, 'auprc': 0.9246112109031381, 'loss_val': 0.5057446226580461, 'psi': 0.941495834109434}-{'f1_val': 0.6249666580873274, 'auprc': 0.9266690665180537, 'loss_val': 0.6506016142455477, 'psi': 0.7456476214596179}
[S5] START round=19 head_norm_before_train=1.608290 (no previous merge yet)
[S5] round=19 local utility u=0.400320 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8802364482647453, 'loss_val': 0.31162185984058394, 'psi': 0.7724596149035028}-{'f1_val': 0.6384217072439855, 'auprc': 0.7910615262561465, 'loss_val': 0.47161651123926684, 'psi': 0.6994776348488498}
[S6] START round=19 head_norm_before_train=0.944697 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.154547 metrics={'f1_val': 0.6973751226504383, 'auprc': 0.940550267173952, 'loss_val': 0.5655708810984252, 'psi': 0.7946451804598438}-{'f1_val': 0.7066292190312996, 'auprc': 0.8651419299195859, 'loss_val': 0.7039643467078406, 'psi': 0.7700343033866142}
[S7] START round=19 head_norm_before_train=1.031552 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.7806321339570186, 'loss_val': 0.8220063908349708, 'psi': 0.5623523332418715}-{'f1_val': 0.41671011811102343, 'auprc': 0.8415643803162265, 'loss_val': 0.864326694463143, 'psi': 0.5866518229931046}
[S8] START round=19 head_norm_before_train=1.782830 (no previous merge yet)
[S8] round=19 local utility u=0.020822 metrics={'f1_val': 0.9880008512871435, 'auprc': 0.9990284767119764, 'loss_val': 0.0756907849098526, 'psi': 0.9924119014570767}-{'f1_val': 0.9879591837696123, 'auprc': 0.9895159552175197, 'loss_val': 0.08854755495142347, 'psi': 0.9885818923487752}
[S9] START round=19 head_norm_before_train=1.759909 cos_to_last_merge=0.9930 (last merge round=16)
[S9] round=19 local utility u=0.022574 metrics={'f1_val': 0.9903801002864661, 'auprc': 0.9949585672827039, 'loss_val': 0.12951252032408664, 'psi': 0.9922114870849612}-{'f1_val': 0.9920653202133933, 'auprc': 0.99501936978518, 'loss_val': 0.18495475882041315, 'psi': 0.993246940042108}
[S10] START round=19 head_norm_before_train=1.676970 (no previous merge yet)
[S10] round=19 local utility u=0.024600 metrics={'f1_val': 0.9943624847472301, 'auprc': 0.9969960624905594, 'loss_val': 0.12010268992462991, 'psi': 0.9954159158445618}-{'f1_val': 0.9927256722954716, 'auprc': 0.9962151697885451, 'loss_val': 0.15713876833465548, 'psi': 0.994121471292701}
[S11] START round=19 head_norm_before_train=1.769191 (no previous merge yet)
[S11] round=19 local utility u=0.162503 metrics={'f1_val': 0.975535585767808, 'auprc': 0.9965787965304047, 'loss_val': 0.09985639830264054, 'psi': 0.9839528700728466}-{'f1_val': 0.9457722809513339, 'auprc': 0.9959137408612253, 'loss_val': 0.2442881787486157, 'psi': 0.9658288649152905}
[S13] START round=19 head_norm_before_train=1.595962 (no previous merge yet)
[S13] round=19 local utility u=0.155954 metrics={'f1_val': 0.6151475034730092, 'auprc': 0.6825712608372673, 'loss_val': 0.6260424704036536, 'psi': 0.6421170064187125}-{'f1_val': 0.580177457150749, 'auprc': 0.6912978507350613, 'loss_val': 0.7543094214110891, 'psi': 0.624625614584474}
[S14] START round=19 head_norm_before_train=1.445393 cos_to_last_merge=0.8159 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.816
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9955714288004093, 'auprc': 0.9969778700933243, 'loss_val': 0.07348068051479534, 'psi': 0.9961340053175752}-{'f1_val': 0.9974830777164877, 'auprc': 0.998921909585449, 'loss_val': 0.0802215683709372, 'psi': 0.9980586104640722}
[S15] START round=19 head_norm_before_train=1.449529 cos_to_last_merge=0.7930 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.793
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.696245620814758, 'auprc': 0.9693317624815253, 'loss_val': 0.35986113963170147, 'psi': 0.805480077481465}-{'f1_val': 0.9391261425219235, 'auprc': 0.977916291803944, 'loss_val': 0.1589080549629996, 'psi': 0.9546422022347317}
[S16] START round=19 head_norm_before_train=1.021606 cos_to_last_merge=0.9944 (last merge round=16)
[S16] round=19 local utility u=0.391140 metrics={'f1_val': 0.9882933233793703, 'auprc': 0.9948307635845404, 'loss_val': 0.22386356117839337, 'psi': 0.9909082994614383}-{'f1_val': 0.9059954261320613, 'auprc': 0.9835467963102444, 'loss_val': 0.4785044832605296, 'psi': 0.9370159742033346}
[S17] START round=19 head_norm_before_train=1.653600 (no previous merge yet)
[S17] round=19 local utility u=0.075099 metrics={'f1_val': 0.42096154502705563, 'auprc': 0.8600762600247898, 'loss_val': 0.5928843956241407, 'psi': 0.5966074310261493}-{'f1_val': 0.41611762164721605, 'auprc': 0.839634171575296, 'loss_val': 0.6526919653702203, 'psi': 0.5855242416184481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:36610
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:36602
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:36608
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:36605
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:36607
[S3] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.799367)
[S5] loaded HEAD from S9 (vec_in norm=1.799367)
[S5] cosine check vs S9: cos=-0.0534
[S5] DROPPED delta from S9 (cos=-0.0534 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.786606)
[S2] loaded HEAD from S11 (vec_in norm=1.786606)
[S2] cosine check vs S11: cos=-0.0947
[S2] DROPPED delta from S11 (cos=-0.0947 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1793) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.973818)
[S4] loaded HEAD from S6 (vec_in norm=0.973818)
[S4] cosine check vs S6: cos=0.5180
[S4] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S5
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.627761)
[S7] loaded HEAD from S5 (vec_in norm=1.627761)
[S7] cosine check vs S5: cos=-0.0596
[S7] DROPPED delta from S5 (cos=-0.0596 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.576990)
[S6] loaded HEAD from S3 (vec_in norm=1.576990)
[S6] cosine check vs S3: cos=0.8208
[S6] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1794) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.062985)
[S16] loaded HEAD from S4 (vec_in norm=1.062985)
[S16] cosine check vs S4: cos=0.8145
[S16] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1797) from S8
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.801721)
[S9] loaded HEAD from S8 (vec_in norm=1.801721)
[S9] cosine check vs S8: cos=0.9730
[S9] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.607716)
[S7] loaded HEAD from S13 (vec_in norm=1.607716)
[S7] cosine check vs S13: cos=0.5663
[S7] BUFFERED delta from S13 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1805) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.689147)
[S6] loaded HEAD from S10 (vec_in norm=1.689147)
[S6] cosine check vs S10: cos=0.6065
[S6] BUFFERED delta from S10 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.073614)
[S7] loaded HEAD from S16 (vec_in norm=1.073614)
[S7] cosine check vs S16: cos=0.6577
[S7] BUFFERED delta from S16 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.676186)
[S13] loaded HEAD from S17 (vec_in norm=1.676186)
[S13] cosine check vs S17: cos=-0.0268
[S13] DROPPED delta from S17 (cos=-0.0268 < 0.0)
[S2] r=20 psi=0.675 u=0.0000 p_local=0.0869 f1=0.678 auprc=0.671 bytes=19772
[S14] r=20 psi=0.996 u=0.0000 p_local=0.1221 f1=0.996 auprc=0.997 bytes=30561
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.4168 head_norm=1.057821
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.488378e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.4168 head_norm=0.988281 delta_norm=0.348838
[S7] aggregate: ACCEPT kept=['S13', 'S16'] (k=2/2) mode=median trim_p=0.1
[S7] r=20 psi=0.562 u=0.0000 p_local=0.1060 f1=0.417 auprc=0.781 bytes=26940
[S5] r=20 psi=0.772 u=0.4003 p_local=0.2062 f1=0.701 auprc=0.880 bytes=25196
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9528 head_norm=1.062985
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.014783e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9503 head_norm=0.887496 delta_norm=0.501478
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.941 u=1.0000 p_local=0.3190 f1=0.953 auprc=0.925 bytes=26963
[S11] r=20 psi=0.984 u=0.1625 p_local=0.1453 f1=0.976 auprc=0.997 bytes=26975
[S3] r=20 psi=0.916 u=0.4962 p_local=0.2070 f1=0.863 auprc=0.997 bytes=25190
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9904 head_norm=1.799367
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.090641e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9899 head_norm=1.788366 delta_norm=0.209064
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.992 u=0.0226 p_local=0.1962 f1=0.990 auprc=0.995 bytes=23370
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.9883 head_norm=1.073614
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.254044e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.9874 head_norm=1.017548 delta_norm=0.325404
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] r=20 psi=0.991 u=0.3911 p_local=0.3427 f1=0.988 auprc=0.995 bytes=23328
[S8] r=20 psi=0.992 u=0.0208 p_local=0.0795 f1=0.988 auprc=0.999 bytes=30564
[S10] r=20 psi=0.995 u=0.0246 p_local=0.2007 f1=0.994 auprc=0.997 bytes=26956
[S13] r=20 psi=0.642 u=0.1560 p_local=0.1114 f1=0.615 auprc=0.683 bytes=19736
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.6974 head_norm=0.973818
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.341118e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.6976 head_norm=1.147827 delta_norm=0.434112
[S6] aggregate: ACCEPT kept=['S3', 'S10'] (k=2/2) mode=median trim_p=0.1
[S6] r=20 psi=0.795 u=0.1545 p_local=0.1212 f1=0.697 auprc=0.941 bytes=25144
[S15] r=20 psi=0.805 u=0.0000 p_local=0.3312 f1=0.696 auprc=0.969 bytes=21521
[S17] r=20 psi=0.597 u=0.0751 p_local=0.1280 f1=0.421 auprc=0.860 bytes=23389
[S2] START round=20 head_norm_before_train=1.293134 cos_to_last_merge=0.7543 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.754
[S2] round=20 local utility u=0.186233 metrics={'f1_val': 0.6983445818660042, 'auprc': 0.7494656784979505, 'loss_val': 0.4018621371021735, 'psi': 0.7187930205187827}-{'f1_val': 0.6781425211980134, 'auprc': 0.6710289283014256, 'loss_val': 0.4178048651738099, 'psi': 0.6752970840393784}
[S3] START round=20 head_norm_before_train=1.576990 cos_to_last_merge=0.8222 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.822
[S3] round=20 local utility u=0.430360 metrics={'f1_val': 0.997206669757163, 'auprc': 0.9970480754508947, 'loss_val': 0.10691655298071681, 'psi': 0.9971432320346557}-{'f1_val': 0.8625684155651169, 'auprc': 0.9969902986409623, 'loss_val': 0.15963317397910243, 'psi': 0.916337168795455}
[S4] START round=20 head_norm_before_train=0.887496 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9476906469488141, 'auprc': 0.9368746939011596, 'loss_val': 0.5688612506241396, 'psi': 0.9433642657297523}-{'f1_val': 0.952752249580298, 'auprc': 0.9246112109031381, 'loss_val': 0.5057446226580461, 'psi': 0.941495834109434}
[S5] START round=20 head_norm_before_train=1.627761 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.6870024098149, 'auprc': 0.8590634312852238, 'loss_val': 0.330429016698629, 'psi': 0.7558268184030295}-{'f1_val': 0.7006083926626743, 'auprc': 0.8802364482647453, 'loss_val': 0.31162185984058394, 'psi': 0.7724596149035028}
[S6] START round=20 head_norm_before_train=1.147827 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.69114931097199, 'auprc': 0.766997259621887, 'loss_val': 0.6684891355277869, 'psi': 0.7214884904319487}-{'f1_val': 0.6973751226504383, 'auprc': 0.940550267173952, 'loss_val': 0.5655708810984252, 'psi': 0.7946451804598438}
[S7] START round=20 head_norm_before_train=0.988281 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.005446 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7944773754859611, 'loss_val': 0.8531335047579813, 'psi': 0.5679388084558591}-{'f1_val': 0.41683246609844005, 'auprc': 0.7806321339570186, 'loss_val': 0.8220063908349708, 'psi': 0.5623523332418715}
[S8] START round=20 head_norm_before_train=1.801721 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.8215530190866117, 'auprc': 0.9871923082481955, 'loss_val': 0.147467782890696, 'psi': 0.8878087347512452}-{'f1_val': 0.9880008512871435, 'auprc': 0.9990284767119764, 'loss_val': 0.0756907849098526, 'psi': 0.9924119014570767}
[S9] START round=20 head_norm_before_train=1.788366 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.010360 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9934453507271591, 'loss_val': 0.134467426619498, 'psi': 0.9946276398128351}-{'f1_val': 0.9903801002864661, 'auprc': 0.9949585672827039, 'loss_val': 0.12951252032408664, 'psi': 0.9922114870849612}
[S10] START round=20 head_norm_before_train=1.689147 (no previous merge yet)
[S10] round=20 local utility u=0.007702 metrics={'f1_val': 0.9945816172019107, 'auprc': 0.9973790288226417, 'loss_val': 0.10716189712991067, 'psi': 0.9957005818502032}-{'f1_val': 0.9943624847472301, 'auprc': 0.9969960624905594, 'loss_val': 0.12010268992462991, 'psi': 0.9954159158445618}
[S11] START round=20 head_norm_before_train=1.786606 (no previous merge yet)
[S11] round=20 local utility u=0.042834 metrics={'f1_val': 0.9858170520482055, 'auprc': 0.9978594112331333, 'loss_val': 0.07971968482170515, 'psi': 0.9906339957221766}-{'f1_val': 0.975535585767808, 'auprc': 0.9965787965304047, 'loss_val': 0.09985639830264054, 'psi': 0.9839528700728466}
[S13] START round=20 head_norm_before_train=1.607716 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.596426461493527, 'auprc': 0.6881992482329524, 'loss_val': 0.695942385200959, 'psi': 0.6331355761892972}-{'f1_val': 0.6151475034730092, 'auprc': 0.6825712608372673, 'loss_val': 0.6260424704036536, 'psi': 0.6421170064187125}
[S14] START round=20 head_norm_before_train=1.479610 cos_to_last_merge=0.8109 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.811
[S14] round=20 local utility u=0.013954 metrics={'f1_val': 0.9970616270651818, 'auprc': 0.9989878952746766, 'loss_val': 0.06054427101689886, 'psi': 0.9978321343489797}-{'f1_val': 0.9955714288004093, 'auprc': 0.9969778700933243, 'loss_val': 0.07348068051479534, 'psi': 0.9961340053175752}
[S15] START round=20 head_norm_before_train=1.478432 cos_to_last_merge=0.7856 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.786
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.7010794862296188, 'auprc': 0.9298413438264808, 'loss_val': 0.3564767994563417, 'psi': 0.7925842292683636}-{'f1_val': 0.696245620814758, 'auprc': 0.9693317624815253, 'loss_val': 0.35986113963170147, 'psi': 0.805480077481465}
[S16] START round=20 head_norm_before_train=1.017548 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.9670251912707803, 'auprc': 0.9947175932628587, 'loss_val': 0.2644748016149078, 'psi': 0.9781021520676118}-{'f1_val': 0.9882933233793703, 'auprc': 0.9948307635845404, 'loss_val': 0.22386356117839337, 'psi': 0.9909082994614383}
[S17] START round=20 head_norm_before_train=1.676186 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.42203920910748255, 'auprc': 0.8559859162079315, 'loss_val': 0.6351991282640936, 'psi': 0.5956178919476621}-{'f1_val': 0.42096154502705563, 'auprc': 0.8600762600247898, 'loss_val': 0.5928843956241407, 'psi': 0.5966074310261493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:36605
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:36604
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:36602
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:36607
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[S2] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.512522)
[S7] loaded HEAD from S14 (vec_in norm=1.512522)
[S7] cosine check vs S14: cos=0.7455
[S7] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.822245)
[S5] loaded HEAD from S9 (vec_in norm=1.822245)
[S5] cosine check vs S9: cos=-0.0514
[S5] DROPPED delta from S9 (cos=-0.0514 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.607454)
[S6] loaded HEAD from S3 (vec_in norm=1.607454)
[S6] cosine check vs S3: cos=0.8832
[S6] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1803) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.318142)
[S4] loaded HEAD from S2 (vec_in norm=1.318142)
[S4] cosine check vs S2: cos=0.3162
[S4] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.011362)
[S6] loaded HEAD from S7 (vec_in norm=1.011362)
[S6] cosine check vs S7: cos=0.2601
[S6] BUFFERED delta from S7 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1805) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.707010)
[S6] loaded HEAD from S10 (vec_in norm=1.707010)
[S6] cosine check vs S10: cos=0.7998
[S6] BUFFERED delta from S10 (total buffered=3)
[S2] RECEIVED delta(kind=head bytes=1803) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.805641)
[S2] loaded HEAD from S11 (vec_in norm=1.805641)
[S2] cosine check vs S11: cos=-0.0943
[S2] DROPPED delta from S11 (cos=-0.0943 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.165 → S7@127.0.0.1:36608
[S15] ⇄ pheromone p=0.265 → S4@127.0.0.1:36604
[S13] ⇄ pheromone p=0.089 → S7@127.0.0.1:36608
[S8] ⇄ pheromone p=0.064 → S9@127.0.0.1:36610
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9477 head_norm=0.928267
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.755129e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.7522 head_norm=0.918298 delta_norm=0.675513
[S4] aggregate: ROLLBACK (f1_val pre=0.948 post=0.752 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.255 → S16@127.0.0.1:36616
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.6911 head_norm=1.166226
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.939308e-02
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.6892 head_norm=1.136096 delta_norm=0.089393
[S6] aggregate: ACCEPT kept=['S3', 'S7', 'S10'] (k=3/3) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.097 → S4@127.0.0.1:36604
[S16] ⇄ pheromone p=0.274 → S7@127.0.0.1:36608
[S3] ⇄ pheromone p=0.252 → S6@127.0.0.1:36607
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.4169 head_norm=1.011362
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.074180e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.3747 head_norm=1.182292 delta_norm=0.507418
[S7] aggregate: ROLLBACK (f1_val pre=0.417 post=0.375 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.086 → S6@127.0.0.1:36607
[S11] ⇄ pheromone p=0.125 → S2@127.0.0.1:36602
[S14] ⇄ pheromone p=0.100 → S7@127.0.0.1:36608
[S2] ⇄ pheromone p=0.107 → S4@127.0.0.1:36604
[S10] ⇄ pheromone p=0.162 → S6@127.0.0.1:36607
[S9] ⇄ pheromone p=0.159 → S5@127.0.0.1:36605
[S17] ⇄ pheromone p=0.102 → S13@127.0.0.1:36613
[S2] START round=21 head_norm_before_train=1.318142 cos_to_last_merge=0.7510 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.751
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.6825765921711486, 'auprc': 0.6579061767355526, 'loss_val': 0.47865951834088394, 'psi': 0.6727084259969103}-{'f1_val': 0.6983445818660042, 'auprc': 0.7494656784979505, 'loss_val': 0.4018621371021735, 'psi': 0.7187930205187827}
[S3] START round=21 head_norm_before_train=1.607454 cos_to_last_merge=0.8172 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.817
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.9733111151174647, 'auprc': 0.9970744046810964, 'loss_val': 0.1050550849757985, 'psi': 0.9828164309429174}-{'f1_val': 0.997206669757163, 'auprc': 0.9970480754508947, 'loss_val': 0.10691655298071681, 'psi': 0.9971432320346557}
[S4] START round=21 head_norm_before_train=0.918298 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.028945 metrics={'f1_val': 0.9444364196252811, 'auprc': 0.9392442044709599, 'loss_val': 0.4985550141045417, 'psi': 0.9423595335635526}-{'f1_val': 0.9476906469488141, 'auprc': 0.9368746939011596, 'loss_val': 0.5688612506241396, 'psi': 0.9433642657297523}
[S5] START round=21 head_norm_before_train=1.645993 (no previous merge yet)
[S5] round=21 local utility u=0.242892 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9709397026134549, 'loss_val': 0.2619095495170502, 'psi': 0.8087409166429865}-{'f1_val': 0.6870024098149, 'auprc': 0.8590634312852238, 'loss_val': 0.330429016698629, 'psi': 0.7558268184030295}
[S6] START round=21 head_norm_before_train=1.136096 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.313063 metrics={'f1_val': 0.7036066738014497, 'auprc': 0.923081332491419, 'loss_val': 0.5853601818936087, 'psi': 0.7913965372774374}-{'f1_val': 0.69114931097199, 'auprc': 0.766997259621887, 'loss_val': 0.6684891355277869, 'psi': 0.7214884904319487}
[S7] START round=21 head_norm_before_train=1.182292 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.329760 metrics={'f1_val': 0.5119256562593595, 'auprc': 0.7943721088984064, 'loss_val': 0.763372484718764, 'psi': 0.6249042373149782}-{'f1_val': 0.4169130971024577, 'auprc': 0.7944773754859611, 'loss_val': 0.8531335047579813, 'psi': 0.5679388084558591}
[S8] START round=21 head_norm_before_train=1.819000 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.7138880036303916, 'auprc': 0.9875627808436617, 'loss_val': 0.24927046455892854, 'psi': 0.8233579145156996}-{'f1_val': 0.8215530190866117, 'auprc': 0.9871923082481955, 'loss_val': 0.147467782890696, 'psi': 0.8878087347512452}
[S9] START round=21 head_norm_before_train=1.822245 cos_to_last_merge=0.9991 (last merge round=19)
[S9] round=21 local utility u=0.015727 metrics={'f1_val': 0.9925154678702236, 'auprc': 0.9964218514493091, 'loss_val': 0.09454056142844247, 'psi': 0.9940780213018579}-{'f1_val': 0.9954158325366191, 'auprc': 0.9934453507271591, 'loss_val': 0.134467426619498, 'psi': 0.9946276398128351}
[S10] START round=21 head_norm_before_train=1.707010 (no previous merge yet)
[S10] round=21 local utility u=0.001573 metrics={'f1_val': 0.9956783869468456, 'auprc': 0.9965194819363459, 'loss_val': 0.10801697837276432, 'psi': 0.9960148249426457}-{'f1_val': 0.9945816172019107, 'auprc': 0.9973790288226417, 'loss_val': 0.10716189712991067, 'psi': 0.9957005818502032}
[S11] START round=21 head_norm_before_train=1.805641 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9647461965031208, 'auprc': 0.9980845200130258, 'loss_val': 0.1021697908921697, 'psi': 0.9780815259070827}-{'f1_val': 0.9858170520482055, 'auprc': 0.9978594112331333, 'loss_val': 0.07971968482170515, 'psi': 0.9906339957221766}
[S13] START round=21 head_norm_before_train=1.620012 (no previous merge yet)
[S13] round=21 local utility u=0.067356 metrics={'f1_val': 0.6152165901812308, 'auprc': 0.6827980482267164, 'loss_val': 0.6577679991645763, 'psi': 0.642249173399425}-{'f1_val': 0.596426461493527, 'auprc': 0.6881992482329524, 'loss_val': 0.695942385200959, 'psi': 0.6331355761892972}
[S14] START round=21 head_norm_before_train=1.512522 cos_to_last_merge=0.8063 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.806
[S14] round=21 local utility u=0.000704 metrics={'f1_val': 0.9968194121056999, 'auprc': 0.9969766681057253, 'loss_val': 0.051649935201132195, 'psi': 0.99688231450571}-{'f1_val': 0.9970616270651818, 'auprc': 0.9989878952746766, 'loss_val': 0.06054427101689886, 'psi': 0.9978321343489797}
[S15] START round=21 head_norm_before_train=1.506242 cos_to_last_merge=0.7785 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.778
[S15] round=21 local utility u=1.000000 metrics={'f1_val': 0.9900567136047578, 'auprc': 0.9715660702068314, 'loss_val': 0.09881003495418124, 'psi': 0.9826604562455872}-{'f1_val': 0.7010794862296188, 'auprc': 0.9298413438264808, 'loss_val': 0.3564767994563417, 'psi': 0.7925842292683636}
[S16] START round=21 head_norm_before_train=1.067186 cos_to_last_merge=0.9989 (last merge round=19)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.9355135265556643, 'auprc': 0.9944189631071347, 'loss_val': 0.27243661757312015, 'psi': 0.9590757011762525}-{'f1_val': 0.9670251912707803, 'auprc': 0.9947175932628587, 'loss_val': 0.2644748016149078, 'psi': 0.9781021520676118}
[S17] START round=21 head_norm_before_train=1.696725 (no previous merge yet)
[S17] round=21 local utility u=0.076881 metrics={'f1_val': 0.4343989673539397, 'auprc': 0.8669282419516544, 'loss_val': 0.58842266523287, 'psi': 0.6074106771930255}-{'f1_val': 0.42203920910748255, 'auprc': 0.8559859162079315, 'loss_val': 0.6351991282640936, 'psi': 0.5956178919476621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:36607
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1793) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.154617)
[S4] loaded HEAD from S6 (vec_in norm=1.154617)
[S4] cosine check vs S6: cos=0.3591
[S4] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1793) from S4
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.971016)
[S16] loaded HEAD from S4 (vec_in norm=0.971016)
[S16] cosine check vs S4: cos=0.8637
[S16] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.634599)
[S7] loaded HEAD from S13 (vec_in norm=1.634599)
[S7] cosine check vs S13: cos=0.5584
[S7] BUFFERED delta from S13 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.732298)
[S6] loaded HEAD from S10 (vec_in norm=1.732298)
[S6] cosine check vs S10: cos=0.8054
[S6] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.203715)
[S6] loaded HEAD from S7 (vec_in norm=1.203715)
[S6] cosine check vs S7: cos=0.2324
[S6] BUFFERED delta from S7 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1796) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.532080)
[S4] loaded HEAD from S15 (vec_in norm=1.532080)
[S4] cosine check vs S15: cos=0.5778
[S4] BUFFERED delta from S15 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1799) from S5
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.661380)
[S7] loaded HEAD from S5 (vec_in norm=1.661380)
[S7] cosine check vs S5: cos=-0.0700
[S7] DROPPED delta from S5 (cos=-0.0700 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.545186)
[S7] loaded HEAD from S14 (vec_in norm=1.545186)
[S7] cosine check vs S14: cos=0.9556
[S7] BUFFERED delta from S14 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1794) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.855834)
[S5] loaded HEAD from S9 (vec_in norm=1.855834)
[S5] cosine check vs S9: cos=-0.0567
[S5] DROPPED delta from S9 (cos=-0.0567 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1805 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1805) from S17
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.714458)
[S13] loaded HEAD from S17 (vec_in norm=1.714458)
[S13] cosine check vs S17: cos=-0.0295
[S13] DROPPED delta from S17 (cos=-0.0295 < 0.0)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9444 head_norm=0.971016
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.204525e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9471 head_norm=0.898790 delta_norm=0.420453
[S4] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.5119 head_norm=1.203715
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.828008e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.6088 head_norm=1.232069 delta_norm=0.282801
[S7] aggregate: ACCEPT kept=['S13', 'S14'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.7036 head_norm=1.154617
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.470622e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.6963 head_norm=1.042761 delta_norm=0.347062
[S6] aggregate: ROLLBACK (f1_val pre=0.704 post=0.696 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.9355 head_norm=1.118758
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.819419e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.9336 head_norm=1.008838 delta_norm=0.281942
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.337737 cos_to_last_merge=0.7484 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.748
[S2] round=22 local utility u=0.263142 metrics={'f1_val': 0.7107016062977752, 'auprc': 0.7878587935869371, 'loss_val': 0.5109825570916173, 'psi': 0.74156448121344}-{'f1_val': 0.6825765921711486, 'auprc': 0.6579061767355526, 'loss_val': 0.47865951834088394, 'psi': 0.6727084259969103}
[S3] START round=22 head_norm_before_train=1.634691 cos_to_last_merge=0.8125 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.813
[S3] round=22 local utility u=0.010770 metrics={'f1_val': 0.9742014211050578, 'auprc': 0.9972400913693489, 'loss_val': 0.08935463457795303, 'psi': 0.9834168892107742}-{'f1_val': 0.9733111151174647, 'auprc': 0.9970744046810964, 'loss_val': 0.1050550849757985, 'psi': 0.9828164309429174}
[S4] START round=22 head_norm_before_train=0.898790 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.034552 metrics={'f1_val': 0.9531023847913029, 'auprc': 0.9380653447254783, 'loss_val': 0.47790940691001615, 'psi': 0.947087568764973}-{'f1_val': 0.9444364196252811, 'auprc': 0.9392442044709599, 'loss_val': 0.4985550141045417, 'psi': 0.9423595335635526}
[S5] START round=22 head_norm_before_train=1.661380 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.6226833726676259, 'auprc': 0.8704368689920235, 'loss_val': 0.3760818678778556, 'psi': 0.7217847711973849}-{'f1_val': 0.7006083926626743, 'auprc': 0.9709397026134549, 'loss_val': 0.2619095495170502, 'psi': 0.8087409166429865}
[S6] START round=22 head_norm_before_train=1.042761 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.056362 metrics={'f1_val': 0.6962536535422804, 'auprc': 0.9677167313938115, 'loss_val': 0.5624248004480343, 'psi': 0.8048388846828929}-{'f1_val': 0.7036066738014497, 'auprc': 0.923081332491419, 'loss_val': 0.5853601818936087, 'psi': 0.7913965372774374}
[S7] START round=22 head_norm_before_train=1.232069 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.40194940374931953, 'auprc': 0.7735861828396724, 'loss_val': 0.8491625404625421, 'psi': 0.5506041153854606}-{'f1_val': 0.5119256562593595, 'auprc': 0.7943721088984064, 'loss_val': 0.763372484718764, 'psi': 0.6249042373149782}
[S8] START round=22 head_norm_before_train=1.830687 (no previous merge yet)
[S8] round=22 local utility u=0.830494 metrics={'f1_val': 0.964160711559758, 'auprc': 0.9992310823824966, 'loss_val': 0.12492454325784569, 'psi': 0.9781888598888535}-{'f1_val': 0.7138880036303916, 'auprc': 0.9875627808436617, 'loss_val': 0.24927046455892854, 'psi': 0.8233579145156996}
[S9] START round=22 head_norm_before_train=1.855834 cos_to_last_merge=0.9970 (last merge round=19)
[S9] round=22 local utility u=0.021696 metrics={'f1_val': 0.9962748907591257, 'auprc': 0.9947236931819456, 'loss_val': 0.06861054700624722, 'psi': 0.9956544117282538}-{'f1_val': 0.9925154678702236, 'auprc': 0.9964218514493091, 'loss_val': 0.09454056142844247, 'psi': 0.9940780213018579}
[S10] START round=22 head_norm_before_train=1.732298 (no previous merge yet)
[S10] round=22 local utility u=0.008456 metrics={'f1_val': 0.9956783869468456, 'auprc': 0.996524802531562, 'loss_val': 0.09112113842545724, 'psi': 0.9960169531807321}-{'f1_val': 0.9956783869468456, 'auprc': 0.9965194819363459, 'loss_val': 0.10801697837276432, 'psi': 0.9960148249426457}
[S11] START round=22 head_norm_before_train=1.825974 (no previous merge yet)
[S11] round=22 local utility u=0.122456 metrics={'f1_val': 0.996305167468861, 'auprc': 0.998114362165079, 'loss_val': 0.04670097330853894, 'psi': 0.9970288453473481}-{'f1_val': 0.9647461965031208, 'auprc': 0.9980845200130258, 'loss_val': 0.1021697908921697, 'psi': 0.9780815259070827}
[S13] START round=22 head_norm_before_train=1.634599 (no previous merge yet)
[S13] round=22 local utility u=0.001748 metrics={'f1_val': 0.6177725883814625, 'auprc': 0.6814025458179704, 'loss_val': 0.6654221127543384, 'psi': 0.6432245713560657}-{'f1_val': 0.6152165901812308, 'auprc': 0.6827980482267164, 'loss_val': 0.6577679991645763, 'psi': 0.642249173399425}
[S14] START round=22 head_norm_before_train=1.545186 cos_to_last_merge=0.8019 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.802
[S14] round=22 local utility u=0.003220 metrics={'f1_val': 0.9965773233830622, 'auprc': 0.9986704248987636, 'loss_val': 0.04883899616402455, 'psi': 0.9974145639893428}-{'f1_val': 0.9968194121056999, 'auprc': 0.9969766681057253, 'loss_val': 0.051649935201132195, 'psi': 0.99688231450571}
[S15] START round=22 head_norm_before_train=1.532080 cos_to_last_merge=0.7720 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.772
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.6991188021212373, 'auprc': 0.8539807075096724, 'loss_val': 0.38907436352311137, 'psi': 0.7610635642766114}-{'f1_val': 0.9900567136047578, 'auprc': 0.9715660702068314, 'loss_val': 0.09881003495418124, 'psi': 0.9826604562455872}
[S16] START round=22 head_norm_before_train=1.008838 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.195974 metrics={'f1_val': 0.9913727199340356, 'auprc': 0.9946168689789902, 'loss_val': 0.21623653304020637, 'psi': 0.9926703795520174}-{'f1_val': 0.9355135265556643, 'auprc': 0.9944189631071347, 'loss_val': 0.27243661757312015, 'psi': 0.9590757011762525}
[S17] START round=22 head_norm_before_train=1.714458 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.43551863745446384, 'auprc': 0.8648696435801546, 'loss_val': 0.6316860326671725, 'psi': 0.6072590399047402}-{'f1_val': 0.4343989673539397, 'auprc': 0.8669282419516544, 'loss_val': 0.58842266523287, 'psi': 0.6074106771930255}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:36615
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S2] → sending delta(kind=head bytes=1809) to S11@127.0.0.1:36612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:36609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:36617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:36603
[S9] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1809 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S9
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.885227)
[S8] loaded HEAD from S9 (vec_in norm=1.885227)
[S8] cosine check vs S9: cos=0.9763
[S8] BUFFERED delta from S9 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1794) from S13
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.649115)
[S17] loaded HEAD from S13 (vec_in norm=1.649115)
[S17] cosine check vs S13: cos=-0.0285
[S17] DROPPED delta from S13 (cos=-0.0285 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1809) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.352961)
[S11] loaded HEAD from S2 (vec_in norm=1.352961)
[S11] cosine check vs S2: cos=-0.0949
[S11] DROPPED delta from S2 (cos=-0.0949 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1793) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.060940)
[S3] loaded HEAD from S6 (vec_in norm=1.060940)
[S3] cosine check vs S6: cos=0.7035
[S3] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1793) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.053521)
[S4] loaded HEAD from S16 (vec_in norm=1.053521)
[S4] cosine check vs S16: cos=0.9422
[S4] BUFFERED delta from S16 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1794) from S4
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.949086)
[S15] loaded HEAD from S4 (vec_in norm=0.949086)
[S15] cosine check vs S4: cos=0.7753
[S15] BUFFERED delta from S4 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.9742 head_norm=1.663864
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.938129e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.9624 head_norm=1.262697 delta_norm=0.593813
[S3] aggregate: ROLLBACK (f1_val pre=0.974 post=0.962 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9642 head_norm=1.843706
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.038939e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9636 head_norm=1.853400 delta_norm=0.203894
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.6991 head_norm=1.554198
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.072189e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.6966 head_norm=1.183587 delta_norm=0.507219
[S15] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9531 head_norm=0.949086
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.778310e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9539 head_norm=0.986768 delta_norm=0.177831
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.352961 cos_to_last_merge=0.7465 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.747
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7056036622050806, 'auprc': 0.7573615547194477, 'loss_val': 0.4424099331577406, 'psi': 0.7263068192108275}-{'f1_val': 0.7107016062977752, 'auprc': 0.7878587935869371, 'loss_val': 0.5109825570916173, 'psi': 0.74156448121344}
[S3] START round=23 head_norm_before_train=1.262697 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9665517705990319, 'auprc': 0.9970566183314746, 'loss_val': 0.1583205565028277, 'psi': 0.9787537096920089}-{'f1_val': 0.9742014211050578, 'auprc': 0.9972400913693489, 'loss_val': 0.08935463457795303, 'psi': 0.9834168892107742}
[S4] START round=23 head_norm_before_train=0.986768 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.056631 metrics={'f1_val': 0.953038192222735, 'auprc': 0.9538332254709789, 'loss_val': 0.41156563610953045, 'psi': 0.9533562055220326}-{'f1_val': 0.9531023847913029, 'auprc': 0.9380653447254783, 'loss_val': 0.47790940691001615, 'psi': 0.947087568764973}
[S5] START round=23 head_norm_before_train=1.673097 (no previous merge yet)
[S5] round=23 local utility u=0.035192 metrics={'f1_val': 0.6362479678975572, 'auprc': 0.8640239456879348, 'loss_val': 0.3678470723678653, 'psi': 0.7273583590137083}-{'f1_val': 0.6226833726676259, 'auprc': 0.8704368689920235, 'loss_val': 0.3760818678778556, 'psi': 0.7217847711973849}
[S6] START round=23 head_norm_before_train=1.060940 cos_to_last_merge=0.9987 (last merge round=21)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.6937452727180279, 'auprc': 0.9533256623799337, 'loss_val': 0.5301229887353387, 'psi': 0.7975774285827901}-{'f1_val': 0.6962536535422804, 'auprc': 0.9677167313938115, 'loss_val': 0.5624248004480343, 'psi': 0.8048388846828929}
[S7] START round=23 head_norm_before_train=1.249520 cos_to_last_merge=0.9995 (last merge round=21)
[S7] round=23 local utility u=0.647529 metrics={'f1_val': 0.5945487400575546, 'auprc': 0.784411340044961, 'loss_val': 0.7421763087854909, 'psi': 0.6704937800525173}-{'f1_val': 0.40194940374931953, 'auprc': 0.7735861828396724, 'loss_val': 0.8491625404625421, 'psi': 0.5506041153854606}
[S8] START round=23 head_norm_before_train=1.853400 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.125779 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9972844118603637, 'loss_val': 0.045695223963259146, 'psi': 0.9952270341125322}-{'f1_val': 0.964160711559758, 'auprc': 0.9992310823824966, 'loss_val': 0.12492454325784569, 'psi': 0.9781888598888535}
[S9] START round=23 head_norm_before_train=1.885227 cos_to_last_merge=0.9945 (last merge round=19)
[S9] round=23 local utility u=0.005706 metrics={'f1_val': 0.9949999422209534, 'auprc': 0.9971153341183258, 'loss_val': 0.05672307195797443, 'psi': 0.9958460989799024}-{'f1_val': 0.9962748907591257, 'auprc': 0.9947236931819456, 'loss_val': 0.06861054700624722, 'psi': 0.9956544117282538}
[S10] START round=23 head_norm_before_train=1.760188 (no previous merge yet)
[S10] round=23 local utility u=0.008255 metrics={'f1_val': 0.9952143411512907, 'auprc': 0.9965182421752208, 'loss_val': 0.07180783224510989, 'psi': 0.9957359015608628}-{'f1_val': 0.9956783869468456, 'auprc': 0.996524802531562, 'loss_val': 0.09112113842545724, 'psi': 0.9960169531807321}
[S11] START round=23 head_norm_before_train=1.848141 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9507757316831549, 'auprc': 0.9977843289557816, 'loss_val': 0.20868024525692386, 'psi': 0.9695791705922056}-{'f1_val': 0.996305167468861, 'auprc': 0.998114362165079, 'loss_val': 0.04670097330853894, 'psi': 0.9970288453473481}
[S13] START round=23 head_norm_before_train=1.649115 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5694061797724821, 'auprc': 0.6957069242052901, 'loss_val': 0.8751708324073517, 'psi': 0.6199264775456053}-{'f1_val': 0.6177725883814625, 'auprc': 0.6814025458179704, 'loss_val': 0.6654221127543384, 'psi': 0.6432245713560657}
[S14] START round=23 head_norm_before_train=1.573368 cos_to_last_merge=0.7981 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.798
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9924227226230103, 'auprc': 0.9969718796839033, 'loss_val': 0.052955865397296575, 'psi': 0.9942423854473675}-{'f1_val': 0.9965773233830622, 'auprc': 0.9986704248987636, 'loss_val': 0.04883899616402455, 'psi': 0.9974145639893428}
[S15] START round=23 head_norm_before_train=1.183587 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=1.000000 metrics={'f1_val': 0.9856393783531143, 'auprc': 0.9802667652685917, 'loss_val': 0.14857041504777038, 'psi': 0.9834903331193052}-{'f1_val': 0.6991188021212373, 'auprc': 0.8539807075096724, 'loss_val': 0.38907436352311137, 'psi': 0.7610635642766114}
[S16] START round=23 head_norm_before_train=1.053521 cos_to_last_merge=0.9989 (last merge round=21)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.9219548897931742, 'auprc': 0.994547706079342, 'loss_val': 0.37941313750932687, 'psi': 0.9509920163076413}-{'f1_val': 0.9913727199340356, 'auprc': 0.9946168689789902, 'loss_val': 0.21623653304020637, 'psi': 0.9926703795520174}
[S17] START round=23 head_norm_before_train=1.734265 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.42029967666013335, 'auprc': 0.7217354414010804, 'loss_val': 0.7333795562623905, 'psi': 0.5408739825565121}-{'f1_val': 0.43551863745446384, 'auprc': 0.8648696435801546, 'loss_val': 0.6316860326671725, 'psi': 0.6072590399047402}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] sending update (kind=head size=1790 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:36615
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:36609
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1794) from S4
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.033251)
[S15] loaded HEAD from S4 (vec_in norm=1.033251)
[S15] cosine check vs S4: cos=0.8885
[S15] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.267060)
[S16] loaded HEAD from S7 (vec_in norm=1.267060)
[S16] cosine check vs S7: cos=0.3919
[S16] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.685180)
[S9] loaded HEAD from S5 (vec_in norm=1.685180)
[S9] cosine check vs S5: cos=-0.0644
[S9] DROPPED delta from S5 (cos=-0.0644 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S9
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.910027)
[S8] loaded HEAD from S9 (vec_in norm=1.910027)
[S8] cosine check vs S9: cos=0.9918
[S8] BUFFERED delta from S9 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.9856 head_norm=1.211002
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.786958e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.9863 head_norm=1.090594 delta_norm=0.278696
[S15] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9939 head_norm=1.868604
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.223756e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9939 head_norm=1.885462 delta_norm=0.122376
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9220 head_norm=1.101408
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.566429e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9284 head_norm=0.988984 delta_norm=0.656643
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.369284 cos_to_last_merge=0.7449 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.745
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.5100626602028521, 'auprc': 0.6069450185721875, 'loss_val': 0.946948862030148, 'psi': 0.5488156035505862}-{'f1_val': 0.7056036622050806, 'auprc': 0.7573615547194477, 'loss_val': 0.4424099331577406, 'psi': 0.7263068192108275}
[S3] START round=24 head_norm_before_train=1.287617 cos_to_last_merge=0.9995 (last merge round=22)
[S3] round=24 local utility u=0.117265 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9976712938767764, 'loss_val': 0.11301256043244183, 'psi': 0.9977374153776691}-{'f1_val': 0.9665517705990319, 'auprc': 0.9970566183314746, 'loss_val': 0.1583205565028277, 'psi': 0.9787537096920089}
[S4] START round=24 head_norm_before_train=1.033251 cos_to_last_merge=0.9990 (last merge round=22)
[S4] round=24 local utility u=0.028017 metrics={'f1_val': 0.9518710667114492, 'auprc': 0.9585228373713537, 'loss_val': 0.36259675812482867, 'psi': 0.954531774975411}-{'f1_val': 0.953038192222735, 'auprc': 0.9538332254709789, 'loss_val': 0.41156563610953045, 'psi': 0.9533562055220326}
[S5] START round=24 head_norm_before_train=1.685180 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.5933457277600612, 'auprc': 0.8346877420525025, 'loss_val': 0.5707751395627976, 'psi': 0.6898825334770378}-{'f1_val': 0.6362479678975572, 'auprc': 0.8640239456879348, 'loss_val': 0.3678470723678653, 'psi': 0.7273583590137083}
[S6] START round=24 head_norm_before_train=1.080058 cos_to_last_merge=0.9959 (last merge round=21)
[S6] round=24 local utility u=0.046358 metrics={'f1_val': 0.6945646193771687, 'auprc': 0.9621276578564624, 'loss_val': 0.4687289086025668, 'psi': 0.8015898347688862}-{'f1_val': 0.6937452727180279, 'auprc': 0.9533256623799337, 'loss_val': 0.5301229887353387, 'psi': 0.7975774285827901}
[S7] START round=24 head_norm_before_train=1.267060 cos_to_last_merge=0.9981 (last merge round=21)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.4108003129066844, 'auprc': 0.7777754383243801, 'loss_val': 0.8536371071388384, 'psi': 0.5575903630737626}-{'f1_val': 0.5945487400575546, 'auprc': 0.784411340044961, 'loss_val': 0.7421763087854909, 'psi': 0.6704937800525173}
[S8] START round=24 head_norm_before_train=1.885462 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9990079614406844, 'loss_val': 0.04623217175683219, 'psi': 0.9946897652739796}-{'f1_val': 0.9938554489473111, 'auprc': 0.9972844118603637, 'loss_val': 0.045695223963259146, 'psi': 0.9952270341125322}
[S9] START round=24 head_norm_before_train=1.910027 cos_to_last_merge=0.9923 (last merge round=19)
[S9] round=24 local utility u=0.007398 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.997523533483573, 'loss_val': 0.04831347618387982, 'psi': 0.9965254959192225}-{'f1_val': 0.9949999422209534, 'auprc': 0.9971153341183258, 'loss_val': 0.05672307195797443, 'psi': 0.9958460989799024}
[S10] START round=24 head_norm_before_train=1.783919 (no previous merge yet)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9941183616473943, 'auprc': 0.9964035949152117, 'loss_val': 0.06654904529310744, 'psi': 0.9950324549545212}-{'f1_val': 0.9952143411512907, 'auprc': 0.9965182421752208, 'loss_val': 0.07180783224510989, 'psi': 0.9957359015608628}
[S11] START round=24 head_norm_before_train=1.870059 (no previous merge yet)
[S11] round=24 local utility u=0.220419 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9968501940762695, 'loss_val': 0.03821616044220068, 'psi': 0.9965231781118244}-{'f1_val': 0.9507757316831549, 'auprc': 0.9977843289557816, 'loss_val': 0.20868024525692386, 'psi': 0.9695791705922056}
[S13] START round=24 head_norm_before_train=1.661463 (no previous merge yet)
[S13] round=24 local utility u=0.259213 metrics={'f1_val': 0.6148908378493962, 'auprc': 0.6829088221058907, 'loss_val': 0.591259090076617, 'psi': 0.642098031551994}-{'f1_val': 0.5694061797724821, 'auprc': 0.6957069242052901, 'loss_val': 0.8751708324073517, 'psi': 0.6199264775456053}
[S14] START round=24 head_norm_before_train=1.599286 cos_to_last_merge=0.7949 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.795
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9516186403928472, 'auprc': 0.9990373379219815, 'loss_val': 0.07335312431388373, 'psi': 0.9705861194045009}-{'f1_val': 0.9924227226230103, 'auprc': 0.9969718796839033, 'loss_val': 0.052955865397296575, 'psi': 0.9942423854473675}
[S15] START round=24 head_norm_before_train=1.090594 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.69670970730451, 'auprc': 0.8415446722753859, 'loss_val': 0.43435092426807226, 'psi': 0.7546436932928604}-{'f1_val': 0.9856393783531143, 'auprc': 0.9802667652685917, 'loss_val': 0.14857041504777038, 'psi': 0.9834903331193052}
[S16] START round=24 head_norm_before_train=0.988984 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.9246479828962293, 'auprc': 0.9949002592659444, 'loss_val': 0.40073538107226364, 'psi': 0.9527488934441154}-{'f1_val': 0.9219548897931742, 'auprc': 0.994547706079342, 'loss_val': 0.37941313750932687, 'psi': 0.9509920163076413}
[S17] START round=24 head_norm_before_train=1.756324 (no previous merge yet)
[S17] round=24 local utility u=0.751308 metrics={'f1_val': 0.6105323408042892, 'auprc': 0.8390911613492442, 'loss_val': 0.7242271678698534, 'psi': 0.7019558690222711}-{'f1_val': 0.42029967666013335, 'auprc': 0.7217354414010804, 'loss_val': 0.7333795562623905, 'psi': 0.5408739825565121}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:36615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:36609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:36603
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1791) from S4
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.075735)
[S15] loaded HEAD from S4 (vec_in norm=1.075735)
[S15] cosine check vs S4: cos=0.9594
[S15] BUFFERED delta from S4 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S9
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.932696)
[S8] loaded HEAD from S9 (vec_in norm=1.932696)
[S8] cosine check vs S9: cos=0.9968
[S8] BUFFERED delta from S9 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1794) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.100505)
[S3] loaded HEAD from S6 (vec_in norm=1.100505)
[S3] cosine check vs S6: cos=0.8649
[S3] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:36617
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S13
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.669369)
[S17] loaded HEAD from S13 (vec_in norm=1.669369)
[S17] cosine check vs S13: cos=-0.0292
[S17] DROPPED delta from S13 (cos=-0.0292 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.9978 head_norm=1.323739
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.329583e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.9974 head_norm=1.170827 delta_norm=0.332958
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S15
[S7]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S16
[S4]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.6967 head_norm=1.126422
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.588833e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.6970 head_norm=1.089850 delta_norm=0.158883
[S15] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9918 head_norm=1.898980
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.809345e-02
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9918 head_norm=1.914320 delta_norm=0.078093
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.386607 cos_to_last_merge=0.7432 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.743
[S2] round=25 local utility u=1.000000 metrics={'f1_val': 0.708663145751129, 'auprc': 0.7743900120529578, 'loss_val': 0.4985909749042336, 'psi': 0.7349538922718606}-{'f1_val': 0.5100626602028521, 'auprc': 0.6069450185721875, 'loss_val': 0.946948862030148, 'psi': 0.5488156035505862}
[S3] START round=25 head_norm_before_train=1.170827 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.960531351117436, 'auprc': 0.9971581783027208, 'loss_val': 0.20003920335116593, 'psi': 0.97518208199155}-{'f1_val': 0.9977814963782642, 'auprc': 0.9976712938767764, 'loss_val': 0.11301256043244183, 'psi': 0.9977374153776691}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=1.075735 cos_to_last_merge=0.9967 (last merge round=22)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.948703402936917, 'auprc': 0.9525395392891796, 'loss_val': 0.34220012709346714, 'psi': 0.9502378574778221}-{'f1_val': 0.9518710667114492, 'auprc': 0.9585228373713537, 'loss_val': 0.36259675812482867, 'psi': 0.954531774975411}
[S5] START round=25 head_norm_before_train=1.697227 (no previous merge yet)
[S5] round=25 local utility u=0.848404 metrics={'f1_val': 0.8830643418292822, 'auprc': 0.8543792858222611, 'loss_val': 0.6713532994990775, 'psi': 0.8715903194264738}-{'f1_val': 0.5933457277600612, 'auprc': 0.8346877420525025, 'loss_val': 0.5707751395627976, 'psi': 0.6898825334770378}
[S6] START round=25 head_norm_before_train=1.100505 cos_to_last_merge=0.9922 (last merge round=21)
[S6] round=25 local utility u=0.773511 metrics={'f1_val': 0.9543433470058065, 'auprc': 0.9593475650859571, 'loss_val': 0.4720393123520863, 'psi': 0.9563450342378668}-{'f1_val': 0.6945646193771687, 'auprc': 0.9621276578564624, 'loss_val': 0.4687289086025668, 'psi': 0.8015898347688862}
[S7] START round=25 head_norm_before_train=1.284126 cos_to_last_merge=0.9965 (last merge round=21)
[S7] round=25 local utility u=1.000000 metrics={'f1_val': 0.6821194501288832, 'auprc': 0.954014379323409, 'loss_val': 0.5629727761874385, 'psi': 0.7908774218066935}-{'f1_val': 0.4108003129066844, 'auprc': 0.7777754383243801, 'loss_val': 0.8536371071388384, 'psi': 0.5575903630737626}
[S8] START round=25 head_norm_before_train=1.914320 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9889241575992487, 'auprc': 0.9989240704061952, 'loss_val': 0.060224574782796476, 'psi': 0.9929241227220272}-{'f1_val': 0.9918109678295097, 'auprc': 0.9990079614406844, 'loss_val': 0.04623217175683219, 'psi': 0.9946897652739796}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=25 head_norm_before_train=1.932696 cos_to_last_merge=0.9904 (last merge round=19)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.991254331540241, 'auprc': 0.9972102906889726, 'loss_val': 0.04978558551488307, 'psi': 0.9936367151997336}-{'f1_val': 0.9958601375429889, 'auprc': 0.997523533483573, 'loss_val': 0.04831347618387982, 'psi': 0.9965254959192225}
[S10] START round=25 head_norm_before_train=1.804895 (no previous merge yet)
[S10] round=25 local utility u=0.002171 metrics={'f1_val': 0.9937452946631335, 'auprc': 0.9963427711443233, 'loss_val': 0.0597854827823842, 'psi': 0.9947842852556095}-{'f1_val': 0.9941183616473943, 'auprc': 0.9964035949152117, 'loss_val': 0.06654904529310744, 'psi': 0.9950324549545212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=25 head_norm_before_train=1.887485 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9967249443764837, 'loss_val': 0.04022528503122959, 'psi': 0.99647307823191}-{'f1_val': 0.996305167468861, 'auprc': 0.9968501940762695, 'loss_val': 0.03821616044220068, 'psi': 0.9965231781118244}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=25 head_norm_before_train=1.669369 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6013342990483143, 'auprc': 0.6638179231307173, 'loss_val': 0.875714895324528, 'psi': 0.6263277486812755}-{'f1_val': 0.6148908378493962, 'auprc': 0.6829088221058907, 'loss_val': 0.591259090076617, 'psi': 0.642098031551994}
[S14] START round=25 head_norm_before_train=1.623205 cos_to_last_merge=0.7919 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.792
[S14] round=25 local utility u=0.154189 metrics={'f1_val': 0.9968189060544872, 'auprc': 0.9990416455073969, 'loss_val': 0.036189455179930094, 'psi': 0.9977080018356511}-{'f1_val': 0.9516186403928472, 'auprc': 0.9990373379219815, 'loss_val': 0.07335312431388373, 'psi': 0.9705861194045009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=25 head_norm_before_train=1.089850 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.798441 metrics={'f1_val': 0.868348335312483, 'auprc': 0.9708292434733456, 'loss_val': 0.255154251865555, 'psi': 0.9093406985768281}-{'f1_val': 0.69670970730451, 'auprc': 0.8415446722753859, 'loss_val': 0.43435092426807226, 'psi': 0.7546436932928604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=25 head_norm_before_train=1.037830 cos_to_last_merge=0.9981 (last merge round=23)
[S16] round=25 local utility u=0.284364 metrics={'f1_val': 0.9861848995551332, 'auprc': 0.9952945109715807, 'loss_val': 0.20241139706413988, 'psi': 0.9898287441217122}-{'f1_val': 0.9246479828962293, 'auprc': 0.9949002592659444, 'loss_val': 0.40073538107226364, 'psi': 0.9527488934441154}
[S17] START round=25 head_norm_before_train=1.781916 (no previous merge yet)
[S17] round=25 local utility u=0.125444 metrics={'f1_val': 0.6560032167022278, 'auprc': 0.8443156764433775, 'loss_val': 0.761838757761157, 'psi': 0.7313282005986876}-{'f1_val': 0.6105323408042892, 'auprc': 0.8390911613492442, 'loss_val': 0.7242271678698534, 'psi': 0.7019558690222711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:36610
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:36612
[S13] ⇄ pheromone p=0.076 → S17@127.0.0.1:36617
[S9] ⇄ pheromone p=0.058 → S8@127.0.0.1:36609
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.089399)
[S4] loaded HEAD from S16 (vec_in norm=1.089399)
[S4] cosine check vs S16: cos=0.8140
[S4] BUFFERED delta from S16 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.707181)
[S9] loaded HEAD from S5 (vec_in norm=1.707181)
[S9] cosine check vs S5: cos=-0.0684
[S9] DROPPED delta from S5 (cos=-0.0684 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S2
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.400402)
[S11] loaded HEAD from S2 (vec_in norm=1.400402)
[S11] cosine check vs S2: cos=-0.0958
[S11] DROPPED delta from S2 (cos=-0.0958 < 0.0)
[S16] ⇄ pheromone p=0.167 → S4@127.0.0.1:36604
[S5] ⇄ pheromone p=0.248 → S9@127.0.0.1:36610
[S2] ⇄ pheromone p=0.262 → S11@127.0.0.1:36612
[S6] RoundReady barrier timeout: have=1 need=2 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:36603
[S7] RoundReady barrier timeout: have=1 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:36616
[S4] RoundReady barrier timeout: have=1 need=2 — continuing
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.123504)
[S3] loaded HEAD from S6 (vec_in norm=1.123504)
[S3] cosine check vs S6: cos=0.9446
[S3] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.299440)
[S16] loaded HEAD from S7 (vec_in norm=1.299440)
[S16] cosine check vs S7: cos=0.8203
[S16] BUFFERED delta from S7 (total buffered=1)
[S6]  timeout peer S3
[S6]  timeout peer S7
[S6]  timeout peer S10
[S4]  timeout peer S2
[S4]  timeout peer S6
[S4]  timeout peer S15
[S16]  timeout peer S4
[S13]  timeout peer S17
[S9]  timeout peer S8
[S7]  timeout peer S5
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S5]  timeout peer S9
[S2]  timeout peer S11
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=25 metric=0.9487 head_norm=1.112812
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.360109e-01
[S4] stored merged vector for next round verification (round=25)
[S4] DEBUG after merge:  round=25 metric=0.9499 head_norm=1.048650 delta_norm=0.336011
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=26 head_norm_before_train=1.400402 cos_to_last_merge=0.7419 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.742
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.6972513635353503, 'auprc': 0.7793065719848349, 'loss_val': 0.4860771888416536, 'psi': 0.7300734469151442}-{'f1_val': 0.708663145751129, 'auprc': 0.7743900120529578, 'loss_val': 0.4985909749042336, 'psi': 0.7349538922718606}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=1.222555 cos_to_last_merge=0.9984 (last merge round=24)
[S3] round=26 local utility u=0.157801 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9984514539875241, 'loss_val': 0.11181857838678068, 'psi': 0.9980494794219682}-{'f1_val': 0.960531351117436, 'auprc': 0.9971581783027208, 'loss_val': 0.20003920335116593, 'psi': 0.97518208199155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.9978 head_norm=1.284773
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.381407e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.9978 head_norm=1.183106 delta_norm=0.238141
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] START round=26 head_norm_before_train=1.048650 cos_to_last_merge=1.0000 (last merge round=25)
[S4] round=26 local utility u=0.035880 metrics={'f1_val': 0.9516932941097674, 'auprc': 0.9626182774940903, 'loss_val': 0.31861622997283595, 'psi': 0.9560632874634967}-{'f1_val': 0.948703402936917, 'auprc': 0.9525395392891796, 'loss_val': 0.34220012709346714, 'psi': 0.9502378574778221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=26 head_norm_before_train=1.707181 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.7007406076076139, 'auprc': 0.9875712711825745, 'loss_val': 0.19363221250506052, 'psi': 0.8154728730375982}-{'f1_val': 0.8830643418292822, 'auprc': 0.8543792858222611, 'loss_val': 0.6713532994990775, 'psi': 0.8715903194264738}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=26 head_norm_before_train=1.123504 cos_to_last_merge=0.9873 (last merge round=21)
[S6] round=26 local utility u=0.079059 metrics={'f1_val': 0.9635209423056419, 'auprc': 0.9645387601911912, 'loss_val': 0.38456113148684323, 'psi': 0.9639280694598615}-{'f1_val': 0.9543433470058065, 'auprc': 0.9593475650859571, 'loss_val': 0.4720393123520863, 'psi': 0.9563450342378668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=26 head_norm_before_train=1.299440 cos_to_last_merge=0.9949 (last merge round=21)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.6818628999073861, 'auprc': 0.8842127991849484, 'loss_val': 0.5313656075788028, 'psi': 0.7628028596184111}-{'f1_val': 0.6821194501288832, 'auprc': 0.954014379323409, 'loss_val': 0.5629727761874385, 'psi': 0.7908774218066935}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=1.927337 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=26 local utility u=0.023005 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.998367596018449, 'loss_val': 0.04075320678657819, 'psi': 0.9955222406760775}-{'f1_val': 0.9889241575992487, 'auprc': 0.9989240704061952, 'loss_val': 0.060224574782796476, 'psi': 0.9929241227220272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=26 head_norm_before_train=1.952698 cos_to_last_merge=0.9887 (last merge round=19)
[S9] round=26 local utility u=0.000749 metrics={'f1_val': 0.991254331540241, 'auprc': 0.9968091279833222, 'loss_val': 0.04708470493122312, 'psi': 0.9934762501174734}-{'f1_val': 0.991254331540241, 'auprc': 0.9972102906889726, 'loss_val': 0.04978558551488307, 'psi': 0.9936367151997336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=26 head_norm_before_train=1.822896 (no previous merge yet)
[S10] round=26 local utility u=0.002611 metrics={'f1_val': 0.9941591713273794, 'auprc': 0.9961130422141757, 'loss_val': 0.056357202136085256, 'psi': 0.9949407196820979}-{'f1_val': 0.9937452946631335, 'auprc': 0.9963427711443233, 'loss_val': 0.0597854827823842, 'psi': 0.9947842852556095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=26 head_norm_before_train=1.905373 (no previous merge yet)
[S11] round=26 local utility u=0.004719 metrics={'f1_val': 0.996305167468861, 'auprc': 0.997778518276496, 'loss_val': 0.03394796659530975, 'psi': 0.9968945077919149}-{'f1_val': 0.996305167468861, 'auprc': 0.9967249443764837, 'loss_val': 0.04022528503122959, 'psi': 0.99647307823191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=26 head_norm_before_train=1.674843 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5508750206702794, 'auprc': 0.6960099017296845, 'loss_val': 1.0378732761406313, 'psi': 0.6089289730940415}-{'f1_val': 0.6013342990483143, 'auprc': 0.6638179231307173, 'loss_val': 0.875714895324528, 'psi': 0.6263277486812755}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=1.644436 cos_to_last_merge=0.7892 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.789
[S14] round=26 local utility u=0.004673 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9990461357230404, 'loss_val': 0.03052963708164198, 'psi': 0.9980770845935938}-{'f1_val': 0.9968189060544872, 'auprc': 0.9990416455073969, 'loss_val': 0.036189455179930094, 'psi': 0.9977080018356511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=26 head_norm_before_train=1.138548 cos_to_last_merge=0.9986 (last merge round=24)
[S15] round=26 local utility u=0.338610 metrics={'f1_val': 0.9677844620893234, 'auprc': 0.9700541762660403, 'loss_val': 0.17222644491025466, 'psi': 0.9686923477600101}-{'f1_val': 0.868348335312483, 'auprc': 0.9708292434733456, 'loss_val': 0.255154251865555, 'psi': 0.9093406985768281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=26 head_norm_before_train=1.089399 cos_to_last_merge=0.9931 (last merge round=23)
[S16] round=26 local utility u=0.021702 metrics={'f1_val': 0.9865554033369526, 'auprc': 0.9961292744618495, 'loss_val': 0.163735284538447, 'psi': 0.9903849517869114}-{'f1_val': 0.9861848995551332, 'auprc': 0.9952945109715807, 'loss_val': 0.20241139706413988, 'psi': 0.9898287441217122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.9866 head_norm=1.139460
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.905334e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.9887 head_norm=1.157990 delta_norm=0.390533
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] START round=26 head_norm_before_train=1.805803 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.46140900667735574, 'auprc': 0.6861573685060092, 'loss_val': 1.0061751095897031, 'psi': 0.5513083514088171}-{'f1_val': 0.6560032167022278, 'auprc': 0.8443156764433775, 'loss_val': 0.761838757761157, 'psi': 0.7313282005986876}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=27 head_norm_before_train=1.416431 cos_to_last_merge=0.7404 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.740
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.7094463335647727, 'auprc': 0.7735081700544555, 'loss_val': 0.5479836398340846, 'psi': 0.7350710681606458}-{'f1_val': 0.6972513635353503, 'auprc': 0.7793065719848349, 'loss_val': 0.4860771888416536, 'psi': 0.7300734469151442}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=27 head_norm_before_train=1.183106 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9872370148112495, 'auprc': 0.99804517756708, 'loss_val': 0.14908662916330362, 'psi': 0.9915602799135818}-{'f1_val': 0.9977814963782642, 'auprc': 0.9984514539875241, 'loss_val': 0.11181857838678068, 'psi': 0.9980494794219682}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=1.083794 cos_to_last_merge=0.9992 (last merge round=25)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9420436944542714, 'auprc': 0.9751735857499095, 'loss_val': 0.3062788770157756, 'psi': 0.9552956509725266}-{'f1_val': 0.9516932941097674, 'auprc': 0.9626182774940903, 'loss_val': 0.31861622997283595, 'psi': 0.9560632874634967}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=27 head_norm_before_train=1.712878 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.41734336430956875, 'auprc': 0.771481833174618, 'loss_val': 1.2154439603610323, 'psi': 0.5589987518555886}-{'f1_val': 0.7007406076076139, 'auprc': 0.9875712711825745, 'loss_val': 0.19363221250506052, 'psi': 0.8154728730375982}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=27 head_norm_before_train=1.152399 cos_to_last_merge=0.9810 (last merge round=21)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.7938576455705008, 'auprc': 0.8840351361998422, 'loss_val': 0.512501803070201, 'psi': 0.8299286418222374}-{'f1_val': 0.9635209423056419, 'auprc': 0.9645387601911912, 'loss_val': 0.38456113148684323, 'psi': 0.9639280694598615}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=27 head_norm_before_train=1.313199 cos_to_last_merge=0.9932 (last merge round=21)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.5333755024038644, 'auprc': 0.7799116489716995, 'loss_val': 0.7868577364628431, 'psi': 0.6319899610309985}-{'f1_val': 0.6818628999073861, 'auprc': 0.8842127991849484, 'loss_val': 0.5313656075788028, 'psi': 0.7628028596184111}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=27 head_norm_before_train=1.941021 cos_to_last_merge=0.9999 (last merge round=24)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9918008107316822, 'auprc': 0.9986896163667563, 'loss_val': 0.04091958743345068, 'psi': 0.9945563329857119}-{'f1_val': 0.9936253371144965, 'auprc': 0.998367596018449, 'loss_val': 0.04075320678657819, 'psi': 0.9955222406760775}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=27 head_norm_before_train=1.966913 cos_to_last_merge=0.9877 (last merge round=19)
[S9] round=27 local utility u=0.014650 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.992557917955774, 'loss_val': 0.03766068833635062, 'psi': 0.9950386619411669}-{'f1_val': 0.991254331540241, 'auprc': 0.9968091279833222, 'loss_val': 0.04708470493122312, 'psi': 0.9934762501174734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=27 head_norm_before_train=1.841185 (no previous merge yet)
[S10] round=27 local utility u=0.002674 metrics={'f1_val': 0.9943868042020945, 'auprc': 0.9964888494000281, 'loss_val': 0.05350340082964174, 'psi': 0.9952276222812679}-{'f1_val': 0.9941591713273794, 'auprc': 0.9961130422141757, 'loss_val': 0.056357202136085256, 'psi': 0.9949407196820979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=27 head_norm_before_train=1.923292 (no previous merge yet)
[S11] round=27 local utility u=0.001406 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980466742033622, 'loss_val': 0.03194080169378173, 'psi': 0.9970017701626614}-{'f1_val': 0.996305167468861, 'auprc': 0.997778518276496, 'loss_val': 0.03394796659530975, 'psi': 0.9968945077919149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=27 head_norm_before_train=1.677172 (no previous merge yet)
[S13] round=27 local utility u=0.435371 metrics={'f1_val': 0.6327779810902967, 'auprc': 0.6546607198887404, 'loss_val': 0.5345014088145587, 'psi': 0.6415310766096742}-{'f1_val': 0.5508750206702794, 'auprc': 0.6960099017296845, 'loss_val': 1.0378732761406313, 'psi': 0.6089289730940415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=27 head_norm_before_train=1.663934 cos_to_last_merge=0.7867 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.787
[S14] round=27 local utility u=0.001255 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9990410525783389, 'loss_val': 0.029325571334020584, 'psi': 0.9982070918612477}-{'f1_val': 0.9974310505072961, 'auprc': 0.9990461357230404, 'loss_val': 0.03052963708164198, 'psi': 0.9980770845935938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=27 head_norm_before_train=1.205441 cos_to_last_merge=0.9942 (last merge round=24)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.7215923370944738, 'auprc': 0.9778700467749519, 'loss_val': 0.33193852645299826, 'psi': 0.8241034209666651}-{'f1_val': 0.9677844620893234, 'auprc': 0.9700541762660403, 'loss_val': 0.17222644491025466, 'psi': 0.9686923477600101}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=27 head_norm_before_train=1.157990 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.9398514722329184, 'auprc': 0.9981462087548958, 'loss_val': 0.2758101692562517, 'psi': 0.9631693668417094}-{'f1_val': 0.9865554033369526, 'auprc': 0.9961292744618495, 'loss_val': 0.163735284538447, 'psi': 0.9903849517869114}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=27 head_norm_before_train=1.829603 (no previous merge yet)
[S17] round=27 local utility u=1.000000 metrics={'f1_val': 0.6534210698870195, 'auprc': 0.8699578202944789, 'loss_val': 0.6015389104172728, 'psi': 0.7400357700500033}-{'f1_val': 0.46140900667735574, 'auprc': 0.6861573685060092, 'loss_val': 1.0061751095897031, 'psi': 0.5513083514088171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=28 head_norm_before_train=1.433624 cos_to_last_merge=0.7387 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.739
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.6905339565681456, 'auprc': 0.7349037251239795, 'loss_val': 0.6068643185892242, 'psi': 0.7082818639904792}-{'f1_val': 0.7094463335647727, 'auprc': 0.7735081700544555, 'loss_val': 0.5479836398340846, 'psi': 0.7350710681606458}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=28 head_norm_before_train=1.238222 cos_to_last_merge=0.9984 (last merge round=26)
[S3] round=28 local utility u=0.011713 metrics={'f1_val': 0.9859851590918147, 'auprc': 0.9981196956019338, 'loss_val': 0.11837237596319759, 'psi': 0.9908389736958624}-{'f1_val': 0.9872370148112495, 'auprc': 0.99804517756708, 'loss_val': 0.14908662916330362, 'psi': 0.9915602799135818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=28 head_norm_before_train=1.116586 cos_to_last_merge=0.9968 (last merge round=25)
[S4] round=28 local utility u=0.020150 metrics={'f1_val': 0.9520508185044226, 'auprc': 0.9594426596617244, 'loss_val': 0.2788280408087696, 'psi': 0.9550075549673434}-{'f1_val': 0.9420436944542714, 'auprc': 0.9751735857499095, 'loss_val': 0.3062788770157756, 'psi': 0.9552956509725266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=28 head_norm_before_train=1.717091 (no previous merge yet)
[S5] round=28 local utility u=1.000000 metrics={'f1_val': 0.700741239511709, 'auprc': 0.9888575212272113, 'loss_val': 0.18913009229298064, 'psi': 0.81598775219791}-{'f1_val': 0.41734336430956875, 'auprc': 0.771481833174618, 'loss_val': 1.2154439603610323, 'psi': 0.5589987518555886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=28 head_norm_before_train=1.185280 cos_to_last_merge=0.9742 (last merge round=21)
[S6] round=28 local utility u=0.726390 metrics={'f1_val': 0.9616201587419119, 'auprc': 0.9633596257048956, 'loss_val': 0.3042698542029483, 'psi': 0.9623159455271054}-{'f1_val': 0.7938576455705008, 'auprc': 0.8840351361998422, 'loss_val': 0.512501803070201, 'psi': 0.8299286418222374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=28 head_norm_before_train=1.324289 cos_to_last_merge=0.9918 (last merge round=21)
[S7] round=28 local utility u=0.239432 metrics={'f1_val': 0.5898987994382645, 'auprc': 0.7882616281581125, 'loss_val': 0.6721826306773955, 'psi': 0.6692439309262037}-{'f1_val': 0.5333755024038644, 'auprc': 0.7799116489716995, 'loss_val': 0.7868577364628431, 'psi': 0.6319899610309985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=28 head_norm_before_train=1.954476 cos_to_last_merge=0.9997 (last merge round=24)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9988928129553699, 'loss_val': 0.0439398899822409, 'psi': 0.994426068107984}-{'f1_val': 0.9918008107316822, 'auprc': 0.9986896163667563, 'loss_val': 0.04091958743345068, 'psi': 0.9945563329857119}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=28 head_norm_before_train=1.978087 cos_to_last_merge=0.9868 (last merge round=19)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9870000396042449, 'auprc': 0.983620014359647, 'loss_val': 0.06424376811451353, 'psi': 0.9856480295064056}-{'f1_val': 0.9966924912647621, 'auprc': 0.992557917955774, 'loss_val': 0.03766068833635062, 'psi': 0.9950386619411669}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.862072 (no previous merge yet)
[S10] round=28 local utility u=0.001587 metrics={'f1_val': 0.9941677348444804, 'auprc': 0.9964813149483456, 'loss_val': 0.048992670862585845, 'psi': 0.9950931668860264}-{'f1_val': 0.9943868042020945, 'auprc': 0.9964888494000281, 'loss_val': 0.05350340082964174, 'psi': 0.9952276222812679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=28 head_norm_before_train=1.939240 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9566100030197534, 'auprc': 0.9980008003763388, 'loss_val': 0.1297179706625885, 'psi': 0.9731663219623875}-{'f1_val': 0.996305167468861, 'auprc': 0.9980466742033622, 'loss_val': 0.03194080169378173, 'psi': 0.9970017701626614}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=28 head_norm_before_train=1.680743 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5821278859339456, 'auprc': 0.6819727265355158, 'loss_val': 0.5790984840552726, 'psi': 0.6220658221745736}-{'f1_val': 0.6327779810902967, 'auprc': 0.6546607198887404, 'loss_val': 0.5345014088145587, 'psi': 0.6415310766096742}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=1.682888 cos_to_last_merge=0.7845 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.784
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9990444181039216, 'loss_val': 0.028517261549821534, 'psi': 0.9980627289426041}-{'f1_val': 0.9976511180498535, 'auprc': 0.9990410525783389, 'loss_val': 0.029325571334020584, 'psi': 0.9982070918612477}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=1.273638 cos_to_last_merge=0.9879 (last merge round=24)
[S15] round=28 local utility u=0.324648 metrics={'f1_val': 0.823918103256712, 'auprc': 0.9650258789949604, 'loss_val': 0.25806540269639516, 'psi': 0.8803612135520114}-{'f1_val': 0.7215923370944738, 'auprc': 0.9778700467749519, 'loss_val': 0.33193852645299826, 'psi': 0.8241034209666651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=28 head_norm_before_train=1.202038 cos_to_last_merge=0.9986 (last merge round=26)
[S16] round=28 local utility u=0.011377 metrics={'f1_val': 0.9398514722329184, 'auprc': 0.9968640386902389, 'loss_val': 0.24920910687280456, 'psi': 0.9626564988158466}-{'f1_val': 0.9398514722329184, 'auprc': 0.9981462087548958, 'loss_val': 0.2758101692562517, 'psi': 0.9631693668417094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=28 head_norm_before_train=1.847853 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5788201080646049, 'auprc': 0.7194828756240096, 'loss_val': 0.9126435946824658, 'psi': 0.6350852150883668}-{'f1_val': 0.6534210698870195, 'auprc': 0.8699578202944789, 'loss_val': 0.6015389104172728, 'psi': 0.7400357700500033}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.450030 cos_to_last_merge=0.7370 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.737
[S2] round=29 local utility u=0.136957 metrics={'f1_val': 0.7100979880488866, 'auprc': 0.7891747657813386, 'loss_val': 0.6131481792152991, 'psi': 0.7417286991418675}-{'f1_val': 0.6905339565681456, 'auprc': 0.7349037251239795, 'loss_val': 0.6068643185892242, 'psi': 0.7082818639904792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=29 head_norm_before_train=1.295346 cos_to_last_merge=0.9943 (last merge round=26)
[S3] round=29 local utility u=0.032291 metrics={'f1_val': 0.992354802177543, 'auprc': 0.9984544244252109, 'loss_val': 0.09301252860104751, 'psi': 0.9947946510766101}-{'f1_val': 0.9859851590918147, 'auprc': 0.9981196956019338, 'loss_val': 0.11837237596319759, 'psi': 0.9908389736958624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=29 head_norm_before_train=1.141841 cos_to_last_merge=0.9942 (last merge round=25)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9493069174548332, 'auprc': 0.9399449095381174, 'loss_val': 0.2775291980305814, 'psi': 0.9455621142881468}-{'f1_val': 0.9520508185044226, 'auprc': 0.9594426596617244, 'loss_val': 0.2788280408087696, 'psi': 0.9550075549673434}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.717720 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7006542225197299, 'auprc': 0.8869638307272798, 'loss_val': 0.3413720877772931, 'psi': 0.7751780658027498}-{'f1_val': 0.700741239511709, 'auprc': 0.9888575212272113, 'loss_val': 0.18913009229298064, 'psi': 0.81598775219791}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=1.208964 cos_to_last_merge=0.9691 (last merge round=21)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.7345070716949114, 'auprc': 0.9145544963622706, 'loss_val': 0.51450094231598, 'psi': 0.8065260415618551}-{'f1_val': 0.9616201587419119, 'auprc': 0.9633596257048956, 'loss_val': 0.3042698542029483, 'psi': 0.9623159455271054}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=29 head_norm_before_train=1.337044 cos_to_last_merge=0.9902 (last merge round=21)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5744430943169772, 'auprc': 0.7828677030866105, 'loss_val': 0.7117579461589743, 'psi': 0.6578129378248305}-{'f1_val': 0.5898987994382645, 'auprc': 0.7882616281581125, 'loss_val': 0.6721826306773955, 'psi': 0.6692439309262037}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=29 head_norm_before_train=1.969039 cos_to_last_merge=0.9996 (last merge round=24)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9895052440864175, 'auprc': 0.9874580504969608, 'loss_val': 0.06140107231263693, 'psi': 0.9886863666506349}-{'f1_val': 0.9914482382097267, 'auprc': 0.9988928129553699, 'loss_val': 0.0439398899822409, 'psi': 0.994426068107984}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=1.987867 cos_to_last_merge=0.9861 (last merge round=19)
[S9] round=29 local utility u=0.057413 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9946067322664393, 'loss_val': 0.03553779771402964, 'psi': 0.995358775432369}-{'f1_val': 0.9870000396042449, 'auprc': 0.983620014359647, 'loss_val': 0.06424376811451353, 'psi': 0.9856480295064056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=29 head_norm_before_train=1.883373 (no previous merge yet)
[S10] round=29 local utility u=0.000058 metrics={'f1_val': 0.9941183616473943, 'auprc': 0.9963553804383171, 'loss_val': 0.04820269499731145, 'psi': 0.9950131691637634}-{'f1_val': 0.9941677348444804, 'auprc': 0.9964813149483456, 'loss_val': 0.048992670862585845, 'psi': 0.9950931668860264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=29 head_norm_before_train=1.955009 (no previous merge yet)
[S11] round=29 local utility u=0.169192 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979280636052626, 'loss_val': 0.0292860401906534, 'psi': 0.9969543259234217}-{'f1_val': 0.9566100030197534, 'auprc': 0.9980008003763388, 'loss_val': 0.1297179706625885, 'psi': 0.9731663219623875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=29 head_norm_before_train=1.683182 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5264817352632627, 'auprc': 0.6960535959836529, 'loss_val': 0.9499535232753743, 'psi': 0.5943104795514188}-{'f1_val': 0.5821278859339456, 'auprc': 0.6819727265355158, 'loss_val': 0.5790984840552726, 'psi': 0.6220658221745736}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=29 head_norm_before_train=1.699975 cos_to_last_merge=0.7826 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.783
[S14] round=29 local utility u=0.002160 metrics={'f1_val': 0.9978965638266506, 'auprc': 0.9990460914388786, 'loss_val': 0.027132476630347818, 'psi': 0.9983563748715418}-{'f1_val': 0.9974082695017256, 'auprc': 0.9990444181039216, 'loss_val': 0.028517261549821534, 'psi': 0.9980627289426041}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=29 head_norm_before_train=1.333207 cos_to_last_merge=0.9817 (last merge round=24)
[S15] round=29 local utility u=0.582461 metrics={'f1_val': 0.9869387033638674, 'auprc': 0.9758457507986223, 'loss_val': 0.10372605517773982, 'psi': 0.9825015223377693}-{'f1_val': 0.823918103256712, 'auprc': 0.9650258789949604, 'loss_val': 0.25806540269639516, 'psi': 0.8803612135520114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=29 head_norm_before_train=1.251971 cos_to_last_merge=0.9950 (last merge round=26)
[S16] round=29 local utility u=0.224485 metrics={'f1_val': 0.9909231660592226, 'auprc': 0.9976811900576583, 'loss_val': 0.10912005228161417, 'psi': 0.9936263756585968}-{'f1_val': 0.9398514722329184, 'auprc': 0.9968640386902389, 'loss_val': 0.24920910687280456, 'psi': 0.9626564988158466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=29 head_norm_before_train=1.863705 (no previous merge yet)
[S17] round=29 local utility u=0.104963 metrics={'f1_val': 0.6092358823088463, 'auprc': 0.7091428233498247, 'loss_val': 0.8541920657037991, 'psi': 0.6491986587252376}-{'f1_val': 0.5788201080646049, 'auprc': 0.7194828756240096, 'loss_val': 0.9126435946824658, 'psi': 0.6350852150883668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=30 head_norm_before_train=1.462818 cos_to_last_merge=0.7356 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.736
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.6988969338000193, 'auprc': 0.7905297638439993, 'loss_val': 0.574192869359308, 'psi': 0.7355500658176113}-{'f1_val': 0.7100979880488866, 'auprc': 0.7891747657813386, 'loss_val': 0.6131481792152991, 'psi': 0.7417286991418675}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.343937 cos_to_last_merge=0.9898 (last merge round=26)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9092861609484798, 'auprc': 0.9980360527074125, 'loss_val': 0.20304598082819858, 'psi': 0.9447861176520529}-{'f1_val': 0.992354802177543, 'auprc': 0.9984544244252109, 'loss_val': 0.09301252860104751, 'psi': 0.9947946510766101}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=1.168397 cos_to_last_merge=0.9912 (last merge round=25)
[S4] round=30 local utility u=0.011541 metrics={'f1_val': 0.949343094016846, 'auprc': 0.9452714488161211, 'loss_val': 0.2706433574278378, 'psi': 0.9477144359365561}-{'f1_val': 0.9493069174548332, 'auprc': 0.9399449095381174, 'loss_val': 0.2775291980305814, 'psi': 0.9455621142881468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=30 head_norm_before_train=1.720662 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.6493784674020614, 'auprc': 0.8539987501102795, 'loss_val': 0.48401758508241793, 'psi': 0.7312265804853486}-{'f1_val': 0.7006542225197299, 'auprc': 0.8869638307272798, 'loss_val': 0.3413720877772931, 'psi': 0.7751780658027498}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.228996 cos_to_last_merge=0.9649 (last merge round=21)
[S6] round=30 local utility u=0.408478 metrics={'f1_val': 0.8247064152437658, 'auprc': 0.9626679847638518, 'loss_val': 0.38308228289418456, 'psi': 0.8798910430518002}-{'f1_val': 0.7345070716949114, 'auprc': 0.9145544963622706, 'loss_val': 0.51450094231598, 'psi': 0.8065260415618551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=30 head_norm_before_train=1.349564 cos_to_last_merge=0.9885 (last merge round=21)
[S7] round=30 local utility u=0.269407 metrics={'f1_val': 0.6350979656641911, 'auprc': 0.8001285745797496, 'loss_val': 0.5886567663532167, 'psi': 0.7011102092304144}-{'f1_val': 0.5744430943169772, 'auprc': 0.7828677030866105, 'loss_val': 0.7117579461589743, 'psi': 0.6578129378248305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=30 head_norm_before_train=1.981316 cos_to_last_merge=0.9994 (last merge round=24)
[S8] round=30 local utility u=0.031461 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9986813539070423, 'loss_val': 0.04380704483278852, 'psi': 0.9943414844886529}-{'f1_val': 0.9895052440864175, 'auprc': 0.9874580504969608, 'loss_val': 0.06140107231263693, 'psi': 0.9886863666506349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=30 head_norm_before_train=1.997964 cos_to_last_merge=0.9854 (last merge round=19)
[S9] round=30 local utility u=0.002385 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9956482607363648, 'loss_val': 0.03389188783307756, 'psi': 0.9957753868203392}-{'f1_val': 0.9958601375429889, 'auprc': 0.9946067322664393, 'loss_val': 0.03553779771402964, 'psi': 0.995358775432369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=30 head_norm_before_train=1.903827 (no previous merge yet)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9944754122691798, 'auprc': 0.9935195358301756, 'loss_val': 0.06433248192062395, 'psi': 0.9940930616935781}-{'f1_val': 0.9941183616473943, 'auprc': 0.9963553804383171, 'loss_val': 0.04820269499731145, 'psi': 0.9950131691637634}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=30 head_norm_before_train=1.971693 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.960899916380897, 'auprc': 0.9979658886890262, 'loss_val': 0.10919929291261181, 'psi': 0.9757263053041487}-{'f1_val': 0.996305167468861, 'auprc': 0.9979280636052626, 'loss_val': 0.0292860401906534, 'psi': 0.9969543259234217}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=1.685025 (no previous merge yet)
[S13] round=30 local utility u=0.107840 metrics={'f1_val': 0.5950797684395317, 'auprc': 0.5822541625079013, 'loss_val': 0.8044643800081532, 'psi': 0.5899495260668796}-{'f1_val': 0.5264817352632627, 'auprc': 0.6960535959836529, 'loss_val': 0.9499535232753743, 'psi': 0.5943104795514188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=30 head_norm_before_train=1.716771 cos_to_last_merge=0.7808 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.781
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9967785811702936, 'auprc': 0.9990442808070946, 'loss_val': 0.028421997236083258, 'psi': 0.997684861025014}-{'f1_val': 0.9978965638266506, 'auprc': 0.9990460914388786, 'loss_val': 0.027132476630347818, 'psi': 0.9983563748715418}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=1.382068 cos_to_last_merge=0.9769 (last merge round=24)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6977610587219888, 'auprc': 0.9098453756688722, 'loss_val': 0.43698052304757035, 'psi': 0.7825947855007422}-{'f1_val': 0.9869387033638674, 'auprc': 0.9758457507986223, 'loss_val': 0.10372605517773982, 'psi': 0.9825015223377693}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.296050 cos_to_last_merge=0.9908 (last merge round=26)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9146531159649194, 'auprc': 0.9910440453452696, 'loss_val': 0.21615973081490467, 'psi': 0.9452094877170595}-{'f1_val': 0.9909231660592226, 'auprc': 0.9976811900576583, 'loss_val': 0.10912005228161417, 'psi': 0.9936263756585968}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=1.878400 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.5550053718312514, 'auprc': 0.678942378239444, 'loss_val': 1.0493095517993363, 'psi': 0.6045801743945285}-{'f1_val': 0.6092358823088463, 'auprc': 0.7091428233498247, 'loss_val': 0.8541920657037991, 'psi': 0.6491986587252376}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=31 head_norm_before_train=1.473277 cos_to_last_merge=0.7344 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.734
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.6326353418233363, 'auprc': 0.7173548349220554, 'loss_val': 0.7546715820306301, 'psi': 0.6665231390628239}-{'f1_val': 0.6988969338000193, 'auprc': 0.7905297638439993, 'loss_val': 0.574192869359308, 'psi': 0.7355500658176113}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=1.384723 cos_to_last_merge=0.9856 (last merge round=26)
[S3] round=31 local utility u=0.333810 metrics={'f1_val': 0.9973670153333725, 'auprc': 0.9985255437396546, 'loss_val': 0.0653793439367231, 'psi': 0.9978304266958853}-{'f1_val': 0.9092861609484798, 'auprc': 0.9980360527074125, 'loss_val': 0.20304598082819858, 'psi': 0.9447861176520529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=31 head_norm_before_train=1.195489 cos_to_last_merge=0.9884 (last merge round=25)
[S4] round=31 local utility u=0.036127 metrics={'f1_val': 0.9505642777481902, 'auprc': 0.9636720439695965, 'loss_val': 0.2609173547277229, 'psi': 0.9558073842367527}-{'f1_val': 0.949343094016846, 'auprc': 0.9452714488161211, 'loss_val': 0.2706433574278378, 'psi': 0.9477144359365561}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=31 head_norm_before_train=1.724763 (no previous merge yet)
[S5] round=31 local utility u=1.000000 metrics={'f1_val': 0.9963907060010702, 'auprc': 0.9981312699130158, 'loss_val': 0.12054183449304769, 'psi': 0.9970869315658484}-{'f1_val': 0.6493784674020614, 'auprc': 0.8539987501102795, 'loss_val': 0.48401758508241793, 'psi': 0.7312265804853486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=31 head_norm_before_train=1.245025 cos_to_last_merge=0.9616 (last merge round=21)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.8243900450951792, 'auprc': 0.962788019482843, 'loss_val': 0.4023525944781154, 'psi': 0.8797492348502447}-{'f1_val': 0.8247064152437658, 'auprc': 0.9626679847638518, 'loss_val': 0.38308228289418456, 'psi': 0.8798910430518002}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=1.362440 cos_to_last_merge=0.9865 (last merge round=21)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.5264296934583499, 'auprc': 0.7804497576742127, 'loss_val': 0.8754540948757268, 'psi': 0.628037719144695}-{'f1_val': 0.6350979656641911, 'auprc': 0.8001285745797496, 'loss_val': 0.5886567663532167, 'psi': 0.7011102092304144}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=1.993503 cos_to_last_merge=0.9993 (last merge round=24)
[S8] round=31 local utility u=0.003615 metrics={'f1_val': 0.9915794263117453, 'auprc': 0.9986361769236494, 'loss_val': 0.03722927532049078, 'psi': 0.9944021265565071}-{'f1_val': 0.9914482382097267, 'auprc': 0.9986813539070423, 'loss_val': 0.04380704483278852, 'psi': 0.9943414844886529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=31 head_norm_before_train=2.007403 cos_to_last_merge=0.9847 (last merge round=19)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.992904783397339, 'auprc': 0.9978811432982022, 'loss_val': 0.03812362331093465, 'psi': 0.9948953273576844}-{'f1_val': 0.9958601375429889, 'auprc': 0.9956482607363648, 'loss_val': 0.03389188783307756, 'psi': 0.9957753868203392}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.921108 (no previous merge yet)
[S10] round=31 local utility u=0.012997 metrics={'f1_val': 0.9945816172019107, 'auprc': 0.9963429451614859, 'loss_val': 0.04744632939552952, 'psi': 0.9952861483857407}-{'f1_val': 0.9944754122691798, 'auprc': 0.9935195358301756, 'loss_val': 0.06433248192062395, 'psi': 0.9940930616935781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=31 head_norm_before_train=1.985590 (no previous merge yet)
[S11] round=31 local utility u=0.141643 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9982737499067709, 'loss_val': 0.03691132296244663, 'psi': 0.9968568822384952}-{'f1_val': 0.960899916380897, 'auprc': 0.9979658886890262, 'loss_val': 0.10919929291261181, 'psi': 0.9757263053041487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=31 head_norm_before_train=1.688266 (no previous merge yet)
[S13] round=31 local utility u=0.012710 metrics={'f1_val': 0.5523330883079682, 'auprc': 0.6934818079954829, 'loss_val': 0.8562463188397611, 'psi': 0.608792576182974}-{'f1_val': 0.5950797684395317, 'auprc': 0.5822541625079013, 'loss_val': 0.8044643800081532, 'psi': 0.5899495260668796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=31 head_norm_before_train=1.733565 cos_to_last_merge=0.7789 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.779
[S14] round=31 local utility u=0.002086 metrics={'f1_val': 0.9972568221074685, 'auprc': 0.9988987774597226, 'loss_val': 0.02668239106870327, 'psi': 0.9979136042483701}-{'f1_val': 0.9967785811702936, 'auprc': 0.9990442808070946, 'loss_val': 0.028421997236083258, 'psi': 0.997684861025014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=31 head_norm_before_train=1.418091 cos_to_last_merge=0.9735 (last merge round=24)
[S15] round=31 local utility u=0.920769 metrics={'f1_val': 0.9232476493419252, 'auprc': 0.9743906202650571, 'loss_val': 0.1419984317185025, 'psi': 0.9437048377111779}-{'f1_val': 0.6977610587219888, 'auprc': 0.9098453756688722, 'loss_val': 0.43698052304757035, 'psi': 0.7825947855007422}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=31 head_norm_before_train=1.335020 cos_to_last_merge=0.9869 (last merge round=26)
[S16] round=31 local utility u=0.308090 metrics={'f1_val': 0.9915843765742902, 'auprc': 0.9961505410421791, 'loss_val': 0.07688655267719403, 'psi': 0.9934108423614458}-{'f1_val': 0.9146531159649194, 'auprc': 0.9910440453452696, 'loss_val': 0.21615973081490467, 'psi': 0.9452094877170595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=31 head_norm_before_train=1.893355 (no previous merge yet)
[S17] round=31 local utility u=0.288622 metrics={'f1_val': 0.6093000289872916, 'auprc': 0.7160682745789027, 'loss_val': 0.9092113756555582, 'psi': 0.652007327223936}-{'f1_val': 0.5550053718312514, 'auprc': 0.678942378239444, 'loss_val': 1.0493095517993363, 'psi': 0.6045801743945285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=32 head_norm_before_train=1.482399 cos_to_last_merge=0.7333 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.733
[S2] round=32 local utility u=0.398638 metrics={'f1_val': 0.7071838706632385, 'auprc': 0.7893689522683234, 'loss_val': 0.6207287661777923, 'psi': 0.7400579033052724}-{'f1_val': 0.6326353418233363, 'auprc': 0.7173548349220554, 'loss_val': 0.7546715820306301, 'psi': 0.6665231390628239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=32 head_norm_before_train=1.420880 cos_to_last_merge=0.9820 (last merge round=26)
[S3] round=32 local utility u=0.006427 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9984444954864691, 'loss_val': 0.05476899453368833, 'psi': 0.9980466960215462}-{'f1_val': 0.9973670153333725, 'auprc': 0.9985255437396546, 'loss_val': 0.0653793439367231, 'psi': 0.9978304266958853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=32 head_norm_before_train=1.218717 cos_to_last_merge=0.9855 (last merge round=25)
[S4] round=32 local utility u=0.002827 metrics={'f1_val': 0.9497431240689067, 'auprc': 0.9664381558829543, 'loss_val': 0.2586340182871361, 'psi': 0.9564211367945258}-{'f1_val': 0.9505642777481902, 'auprc': 0.9636720439695965, 'loss_val': 0.2609173547277229, 'psi': 0.9558073842367527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] START round=32 head_norm_before_train=1.729028 (no previous merge yet)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.4367298402331732, 'auprc': 0.8536590810319536, 'loss_val': 0.7494691024642125, 'psi': 0.6035015365526855}-{'f1_val': 0.9963907060010702, 'auprc': 0.9981312699130158, 'loss_val': 0.12054183449304769, 'psi': 0.9970869315658484}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.259055 cos_to_last_merge=0.9587 (last merge round=21)
[S6] round=32 local utility u=0.017566 metrics={'f1_val': 0.8247982728039981, 'auprc': 0.9622434755566104, 'loss_val': 0.36803678000824247, 'psi': 0.8797763539050429}-{'f1_val': 0.8243900450951792, 'auprc': 0.962788019482843, 'loss_val': 0.4023525944781154, 'psi': 0.8797492348502447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=32 head_norm_before_train=1.373450 cos_to_last_merge=0.9850 (last merge round=21)
[S7] round=32 local utility u=0.615356 metrics={'f1_val': 0.6634465492680197, 'auprc': 0.8023023723672479, 'loss_val': 0.5324006240165786, 'psi': 0.718988878507711}-{'f1_val': 0.5264296934583499, 'auprc': 0.7804497576742127, 'loss_val': 0.8754540948757268, 'psi': 0.628037719144695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=32 head_norm_before_train=2.005028 cos_to_last_merge=0.9991 (last merge round=24)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9914375510364866, 'auprc': 0.9985073223421594, 'loss_val': 0.03795581435015889, 'psi': 0.9942654595587557}-{'f1_val': 0.9915794263117453, 'auprc': 0.9986361769236494, 'loss_val': 0.03722927532049078, 'psi': 0.9944021265565071}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=2.017480 cos_to_last_merge=0.9840 (last merge round=19)
[S9] round=32 local utility u=0.003955 metrics={'f1_val': 0.9933536184876286, 'auprc': 0.9984773380141159, 'loss_val': 0.03469500603082632, 'psi': 0.9954031062982235}-{'f1_val': 0.992904783397339, 'auprc': 0.9978811432982022, 'loss_val': 0.03812362331093465, 'psi': 0.9948953273576844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=32 head_norm_before_train=1.934366 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9941183616473943, 'auprc': 0.9955809171212933, 'loss_val': 0.04468174661664353, 'psi': 0.9947033838369539}-{'f1_val': 0.9945816172019107, 'auprc': 0.9963429451614859, 'loss_val': 0.04744632939552952, 'psi': 0.9952861483857407}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.997184 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9849502336126008, 'auprc': 0.9981818442111138, 'loss_val': 0.055727514260737604, 'psi': 0.990242877852006}-{'f1_val': 0.9959123037929781, 'auprc': 0.9982737499067709, 'loss_val': 0.03691132296244663, 'psi': 0.9968568822384952}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=1.692469 (no previous merge yet)
[S13] round=32 local utility u=0.034712 metrics={'f1_val': 0.5642251994960625, 'auprc': 0.7014649514142952, 'loss_val': 0.8821244173425234, 'psi': 0.6191211002633557}-{'f1_val': 0.5523330883079682, 'auprc': 0.6934818079954829, 'loss_val': 0.8562463188397611, 'psi': 0.608792576182974}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=32 head_norm_before_train=1.750103 cos_to_last_merge=0.7772 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.777
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9964034173396682, 'auprc': 0.9990282110926288, 'loss_val': 0.02631878657621065, 'psi': 0.9974533348408525}-{'f1_val': 0.9972568221074685, 'auprc': 0.9988987774597226, 'loss_val': 0.02668239106870327, 'psi': 0.9979136042483701}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.452606 cos_to_last_merge=0.9698 (last merge round=24)
[S15] round=32 local utility u=0.213417 metrics={'f1_val': 0.9807159630704636, 'auprc': 0.9848654095883959, 'loss_val': 0.09139821941567604, 'psi': 0.9823757416776364}-{'f1_val': 0.9232476493419252, 'auprc': 0.9743906202650571, 'loss_val': 0.1419984317185025, 'psi': 0.9437048377111779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=32 head_norm_before_train=1.369652 cos_to_last_merge=0.9832 (last merge round=26)
[S16] round=32 local utility u=0.004824 metrics={'f1_val': 0.9915774718201167, 'auprc': 0.9968554502381429, 'loss_val': 0.06931260647902505, 'psi': 0.9936886631873272}-{'f1_val': 0.9915843765742902, 'auprc': 0.9961505410421791, 'loss_val': 0.07688655267719403, 'psi': 0.9934108423614458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=32 head_norm_before_train=1.908780 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.5875647411345807, 'auprc': 0.7058459609410821, 'loss_val': 0.9766883518790427, 'psi': 0.6348772290571812}-{'f1_val': 0.6093000289872916, 'auprc': 0.7160682745789027, 'loss_val': 0.9092113756555582, 'psi': 0.652007327223936}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.492509 cos_to_last_merge=0.7323 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.732
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.6073740780228083, 'auprc': 0.6771940719367711, 'loss_val': 0.9971771935733438, 'psi': 0.6353020755883934}-{'f1_val': 0.7071838706632385, 'auprc': 0.7893689522683234, 'loss_val': 0.6207287661777923, 'psi': 0.7400579033052724}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.453925 cos_to_last_merge=0.9789 (last merge round=26)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.960531351117436, 'auprc': 0.9977506575415365, 'loss_val': 0.13220022373086954, 'psi': 0.9754190736870763}-{'f1_val': 0.9977814963782642, 'auprc': 0.9984444954864691, 'loss_val': 0.05476899453368833, 'psi': 0.9980466960215462}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.238727 cos_to_last_merge=0.9829 (last merge round=25)
[S4] round=33 local utility u=0.008870 metrics={'f1_val': 0.9515259901692433, 'auprc': 0.9676749970982489, 'loss_val': 0.25530084270467157, 'psi': 0.9579855929408456}-{'f1_val': 0.9497431240689067, 'auprc': 0.9664381558829543, 'loss_val': 0.2586340182871361, 'psi': 0.9564211367945258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=33 head_norm_before_train=1.731313 (no previous merge yet)
[S5] round=33 local utility u=1.000000 metrics={'f1_val': 0.9963462754604109, 'auprc': 0.9960537501487284, 'loss_val': 0.13095667321937143, 'psi': 0.9962292653357379}-{'f1_val': 0.4367298402331732, 'auprc': 0.8536590810319536, 'loss_val': 0.7494691024642125, 'psi': 0.6035015365526855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=33 head_norm_before_train=1.272966 cos_to_last_merge=0.9558 (last merge round=21)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.6535134159394527, 'auprc': 0.9468816572529506, 'loss_val': 0.539342723287199, 'psi': 0.7708607124648519}-{'f1_val': 0.8247982728039981, 'auprc': 0.9622434755566104, 'loss_val': 0.36803678000824247, 'psi': 0.8797763539050429}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.382477 cos_to_last_merge=0.9838 (last merge round=21)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.6324866606212272, 'auprc': 0.7969443580433859, 'loss_val': 0.5793596296592496, 'psi': 0.6982697395900908}-{'f1_val': 0.6634465492680197, 'auprc': 0.8023023723672479, 'loss_val': 0.5324006240165786, 'psi': 0.718988878507711}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=2.011471 cos_to_last_merge=0.9990 (last merge round=24)
[S8] round=33 local utility u=0.005507 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9985008180798176, 'loss_val': 0.035914986109136245, 'psi': 0.9951620365970212}-{'f1_val': 0.9914375510364866, 'auprc': 0.9985073223421594, 'loss_val': 0.03795581435015889, 'psi': 0.9942654595587557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=33 head_norm_before_train=2.027518 cos_to_last_merge=0.9832 (last merge round=19)
[S9] round=33 local utility u=0.009426 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9950246775043832, 'loss_val': 0.02798056503393303, 'psi': 0.996271618509039}-{'f1_val': 0.9933536184876286, 'auprc': 0.9984773380141159, 'loss_val': 0.03469500603082632, 'psi': 0.9954031062982235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=33 head_norm_before_train=1.948457 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9937452946631335, 'auprc': 0.9955749303305604, 'loss_val': 0.043876442594916056, 'psi': 0.9944771489301043}-{'f1_val': 0.9941183616473943, 'auprc': 0.9955809171212933, 'loss_val': 0.04468174661664353, 'psi': 0.9947033838369539}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=2.008957 (no previous merge yet)
[S11] round=33 local utility u=0.041150 metrics={'f1_val': 0.9948616012284011, 'auprc': 0.998001253753592, 'loss_val': 0.032353195407872584, 'psi': 0.9961174622384774}-{'f1_val': 0.9849502336126008, 'auprc': 0.9981818442111138, 'loss_val': 0.055727514260737604, 'psi': 0.990242877852006}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=33 head_norm_before_train=1.699743 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5729895455093759, 'auprc': 0.6197374858839304, 'loss_val': 0.8661901458027568, 'psi': 0.5916887216591977}-{'f1_val': 0.5642251994960625, 'auprc': 0.7014649514142952, 'loss_val': 0.8821244173425234, 'psi': 0.6191211002633557}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.765628 cos_to_last_merge=0.7755 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.776
[S14] round=33 local utility u=0.004914 metrics={'f1_val': 0.9974515471354712, 'auprc': 0.9990259990849375, 'loss_val': 0.022773558635895516, 'psi': 0.9980813279152577}-{'f1_val': 0.9964034173396682, 'auprc': 0.9990282110926288, 'loss_val': 0.02631878657621065, 'psi': 0.9974533348408525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=33 head_norm_before_train=1.483555 cos_to_last_merge=0.9664 (last merge round=24)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.8004324920618936, 'auprc': 0.9689844476781775, 'loss_val': 0.3209378962831209, 'psi': 0.8678532743084071}-{'f1_val': 0.9807159630704636, 'auprc': 0.9848654095883959, 'loss_val': 0.09139821941567604, 'psi': 0.9823757416776364}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.400339 cos_to_last_merge=0.9800 (last merge round=26)
[S16] round=33 local utility u=0.003645 metrics={'f1_val': 0.9915293093038144, 'auprc': 0.9973406818635214, 'loss_val': 0.06318858526236781, 'psi': 0.9938538583276972}-{'f1_val': 0.9915774718201167, 'auprc': 0.9968554502381429, 'loss_val': 0.06931260647902505, 'psi': 0.9936886631873272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=33 head_norm_before_train=1.922626 (no previous merge yet)
[S17] round=33 local utility u=0.005523 metrics={'f1_val': 0.5924051052883372, 'auprc': 0.70734101546206, 'loss_val': 0.9991698627071879, 'psi': 0.6383794693578264}-{'f1_val': 0.5875647411345807, 'auprc': 0.7058459609410821, 'loss_val': 0.9766883518790427, 'psi': 0.6348772290571812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=34 head_norm_before_train=1.500209 cos_to_last_merge=0.7313 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.731
[S2] round=34 local utility u=0.624774 metrics={'f1_val': 0.7133898687040909, 'auprc': 0.7863093414712632, 'loss_val': 0.7110697002349402, 'psi': 0.7425576578109598}-{'f1_val': 0.6073740780228083, 'auprc': 0.6771940719367711, 'loss_val': 0.9971771935733438, 'psi': 0.6353020755883934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=34 head_norm_before_train=1.482828 cos_to_last_merge=0.9761 (last merge round=26)
[S3] round=34 local utility u=0.001852 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9972697537595051, 'loss_val': 0.1300776803295638, 'psi': 0.9755290521670682}-{'f1_val': 0.960531351117436, 'auprc': 0.9977506575415365, 'loss_val': 0.13220022373086954, 'psi': 0.9754190736870763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=34 head_norm_before_train=1.255888 cos_to_last_merge=0.9810 (last merge round=25)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9473902935170971, 'auprc': 0.9708980100286476, 'loss_val': 0.25947420260831905, 'psi': 0.9567933801217173}-{'f1_val': 0.9515259901692433, 'auprc': 0.9676749970982489, 'loss_val': 0.25530084270467157, 'psi': 0.9579855929408456}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.733700 (no previous merge yet)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.7006542225197299, 'auprc': 0.8545960829122725, 'loss_val': 0.3692207455670175, 'psi': 0.762230966676747}-{'f1_val': 0.9963462754604109, 'auprc': 0.9960537501487284, 'loss_val': 0.13095667321937143, 'psi': 0.9962292653357379}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.285870 cos_to_last_merge=0.9533 (last merge round=21)
[S6] round=34 local utility u=1.000000 metrics={'f1_val': 0.9624240712324913, 'auprc': 0.9633099106282883, 'loss_val': 0.2406639156508037, 'psi': 0.9627784069908101}-{'f1_val': 0.6535134159394527, 'auprc': 0.9468816572529506, 'loss_val': 0.539342723287199, 'psi': 0.7708607124648519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=34 head_norm_before_train=1.391462 cos_to_last_merge=0.9826 (last merge round=21)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.41082515927934693, 'auprc': 0.7785261009393738, 'loss_val': 1.0474286989873676, 'psi': 0.5579055359433577}-{'f1_val': 0.6324866606212272, 'auprc': 0.7969443580433859, 'loss_val': 0.5793596296592496, 'psi': 0.6982697395900908}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=2.020183 cos_to_last_merge=0.9989 (last merge round=24)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9921596426793389, 'auprc': 0.9888526675188523, 'loss_val': 0.04757018700105329, 'psi': 0.9908368526151443}-{'f1_val': 0.9929361822751569, 'auprc': 0.9985008180798176, 'loss_val': 0.035914986109136245, 'psi': 0.9951620365970212}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=2.036030 cos_to_last_merge=0.9825 (last merge round=19)
[S9] round=34 local utility u=0.002825 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9984628854986454, 'loss_val': 0.02750484215690561, 'psi': 0.9971328231789897}-{'f1_val': 0.9971029125121428, 'auprc': 0.9950246775043832, 'loss_val': 0.02798056503393303, 'psi': 0.996271618509039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=34 head_norm_before_train=1.963495 (no previous merge yet)
[S10] round=34 local utility u=0.003363 metrics={'f1_val': 0.9941183616473943, 'auprc': 0.9961903981495853, 'loss_val': 0.04123433667660393, 'psi': 0.9949471762482707}-{'f1_val': 0.9937452946631335, 'auprc': 0.9955749303305604, 'loss_val': 0.043876442594916056, 'psi': 0.9944771489301043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=34 head_norm_before_train=2.020722 (no previous merge yet)
[S11] round=34 local utility u=0.005744 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9967847671099543, 'loss_val': 0.02587740544440121, 'psi': 0.9964970073252983}-{'f1_val': 0.9948616012284011, 'auprc': 0.998001253753592, 'loss_val': 0.032353195407872584, 'psi': 0.9961174622384774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=34 head_norm_before_train=1.708406 (no previous merge yet)
[S13] round=34 local utility u=0.187661 metrics={'f1_val': 0.5943477776900634, 'auprc': 0.6364057748248173, 'loss_val': 0.6690224957951836, 'psi': 0.611170976543965}-{'f1_val': 0.5729895455093759, 'auprc': 0.6197374858839304, 'loss_val': 0.8661901458027568, 'psi': 0.5916887216591977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=34 head_norm_before_train=1.778677 cos_to_last_merge=0.7740 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.774
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9970441294227608, 'auprc': 0.9989970009541133, 'loss_val': 0.025562967573365944, 'psi': 0.9978252780353017}-{'f1_val': 0.9974515471354712, 'auprc': 0.9990259990849375, 'loss_val': 0.022773558635895516, 'psi': 0.9980813279152577}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.513707 cos_to_last_merge=0.9633 (last merge round=24)
[S15] round=34 local utility u=0.024543 metrics={'f1_val': 0.8077652927850897, 'auprc': 0.9701716460251087, 'loss_val': 0.3194106845686567, 'psi': 0.8727278340810973}-{'f1_val': 0.8004324920618936, 'auprc': 0.9689844476781775, 'loss_val': 0.3209378962831209, 'psi': 0.8678532743084071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=34 head_norm_before_train=1.427869 cos_to_last_merge=0.9772 (last merge round=26)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.9900473402710469, 'auprc': 0.9978980249500226, 'loss_val': 0.06584789362648685, 'psi': 0.9931876141426372}-{'f1_val': 0.9915293093038144, 'auprc': 0.9973406818635214, 'loss_val': 0.06318858526236781, 'psi': 0.9938538583276972}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.939147 (no previous merge yet)
[S17] round=34 local utility u=0.326912 metrics={'f1_val': 0.6284480255248757, 'auprc': 0.8320739109459048, 'loss_val': 0.9358010876796261, 'psi': 0.7098983796932873}-{'f1_val': 0.5924051052883372, 'auprc': 0.70734101546206, 'loss_val': 0.9991698627071879, 'psi': 0.6383794693578264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=35 head_norm_before_train=1.508492 cos_to_last_merge=0.7305 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.730
[S2] round=35 local utility u=0.052391 metrics={'f1_val': 0.7046418967430652, 'auprc': 0.7856992478551608, 'loss_val': 0.5519703142231942, 'psi': 0.7370648371879034}-{'f1_val': 0.7133898687040909, 'auprc': 0.7863093414712632, 'loss_val': 0.7110697002349402, 'psi': 0.7425576578109598}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=35 head_norm_before_train=1.509043 cos_to_last_merge=0.9737 (last merge round=26)
[S3] round=35 local utility u=0.155688 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9985672711539383, 'loss_val': 0.040599997033321296, 'psi': 0.9978487270566276}-{'f1_val': 0.9610352511054436, 'auprc': 0.9972697537595051, 'loss_val': 0.1300776803295638, 'psi': 0.9755290521670682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=35 head_norm_before_train=1.274895 cos_to_last_merge=0.9788 (last merge round=25)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9421665774710104, 'auprc': 0.9324753111674254, 'loss_val': 0.2736397730328773, 'psi': 0.9382900709495764}-{'f1_val': 0.9473902935170971, 'auprc': 0.9708980100286476, 'loss_val': 0.25947420260831905, 'psi': 0.9567933801217173}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.735675 (no previous merge yet)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.7007406076076139, 'auprc': 0.8543918618713018, 'loss_val': 0.3938348755150711, 'psi': 0.7622011093130892}-{'f1_val': 0.7006542225197299, 'auprc': 0.8545960829122725, 'loss_val': 0.3692207455670175, 'psi': 0.762230966676747}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.297860 cos_to_last_merge=0.9512 (last merge round=21)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.751659308687597, 'auprc': 0.9477865990185526, 'loss_val': 0.5214614670200249, 'psi': 0.8301102248199792}-{'f1_val': 0.9624240712324913, 'auprc': 0.9633099106282883, 'loss_val': 0.2406639156508037, 'psi': 0.9627784069908101}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.399919 cos_to_last_merge=0.9814 (last merge round=21)
[S7] round=35 local utility u=1.000000 metrics={'f1_val': 0.6817452087452573, 'auprc': 0.8275721306714613, 'loss_val': 0.44697191782802237, 'psi': 0.740075977515739}-{'f1_val': 0.41082515927934693, 'auprc': 0.7785261009393738, 'loss_val': 1.0474286989873676, 'psi': 0.5579055359433577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=35 head_norm_before_train=2.031561 cos_to_last_merge=0.9987 (last merge round=24)
[S8] round=35 local utility u=0.018453 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9986929270613462, 'loss_val': 0.03809333645023935, 'psi': 0.9945637515222443}-{'f1_val': 0.9921596426793389, 'auprc': 0.9888526675188523, 'loss_val': 0.04757018700105329, 'psi': 0.9908368526151443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=35 head_norm_before_train=2.043808 cos_to_last_merge=0.9820 (last merge round=19)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9970142775161962, 'loss_val': 0.026337364569858624, 'psi': 0.9968020180948134}-{'f1_val': 0.9962461149658858, 'auprc': 0.9984628854986454, 'loss_val': 0.02750484215690561, 'psi': 0.9971328231789897}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.976400 (no previous merge yet)
[S10] round=35 local utility u=0.002783 metrics={'f1_val': 0.9941677348444804, 'auprc': 0.9967611876634797, 'loss_val': 0.03767637548381633, 'psi': 0.9952051159720801}-{'f1_val': 0.9941183616473943, 'auprc': 0.9961903981495853, 'loss_val': 0.04123433667660393, 'psi': 0.9949471762482707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=35 head_norm_before_train=2.032175 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9956720869712891, 'auprc': 0.9981479388213567, 'loss_val': 0.03331911428961615, 'psi': 0.9966624277113161}-{'f1_val': 0.996305167468861, 'auprc': 0.9967847671099543, 'loss_val': 0.02587740544440121, 'psi': 0.9964970073252983}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.714730 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5722389612211617, 'auprc': 0.7015873385775037, 'loss_val': 0.9000344285844516, 'psi': 0.6239783121636985}-{'f1_val': 0.5943477776900634, 'auprc': 0.6364057748248173, 'loss_val': 0.6690224957951836, 'psi': 0.611170976543965}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.790041 cos_to_last_merge=0.7729 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.773
[S14] round=35 local utility u=0.001879 metrics={'f1_val': 0.9974314937735356, 'auprc': 0.998660164966297, 'loss_val': 0.023119596726301258, 'psi': 0.99792296225064}-{'f1_val': 0.9970441294227608, 'auprc': 0.9989970009541133, 'loss_val': 0.025562967573365944, 'psi': 0.9978252780353017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=35 head_norm_before_train=1.541060 cos_to_last_merge=0.9606 (last merge round=24)
[S15] round=35 local utility u=0.700570 metrics={'f1_val': 0.9920269663788994, 'auprc': 0.9843451424700643, 'loss_val': 0.06636047656106374, 'psi': 0.9889542368153654}-{'f1_val': 0.8077652927850897, 'auprc': 0.9701716460251087, 'loss_val': 0.3194106845686567, 'psi': 0.8727278340810973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=35 head_norm_before_train=1.450965 cos_to_last_merge=0.9750 (last merge round=26)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9289642275088086, 'auprc': 0.991907450823786, 'loss_val': 0.344995920490881, 'psi': 0.9541415168347995}-{'f1_val': 0.9900473402710469, 'auprc': 0.9978980249500226, 'loss_val': 0.06584789362648685, 'psi': 0.9931876141426372}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=1.957216 (no previous merge yet)
[S17] round=35 local utility u=0.032027 metrics={'f1_val': 0.6134839671221923, 'auprc': 0.8858130258862408, 'loss_val': 0.9431808127176345, 'psi': 0.7224155906278117}-{'f1_val': 0.6284480255248757, 'auprc': 0.8320739109459048, 'loss_val': 0.9358010876796261, 'psi': 0.7098983796932873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=36 head_norm_before_train=1.515116 cos_to_last_merge=0.7296 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.730
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.6465708481586075, 'auprc': 0.75711406578713, 'loss_val': 0.7396581639831001, 'psi': 0.6907881352100165}-{'f1_val': 0.7046418967430652, 'auprc': 0.7856992478551608, 'loss_val': 0.5519703142231942, 'psi': 0.7370648371879034}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.533249 cos_to_last_merge=0.9716 (last merge round=26)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9803648687939185, 'auprc': 0.996683488231218, 'loss_val': 0.062330726508213447, 'psi': 0.9868923165688384}-{'f1_val': 0.9973696976584205, 'auprc': 0.9985672711539383, 'loss_val': 0.040599997033321296, 'psi': 0.9978487270566276}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.292962 cos_to_last_merge=0.9769 (last merge round=25)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9420280181992139, 'auprc': 0.930659705712553, 'loss_val': 0.27527133059374126, 'psi': 0.9374806932045496}-{'f1_val': 0.9421665774710104, 'auprc': 0.9324753111674254, 'loss_val': 0.2736397730328773, 'psi': 0.9382900709495764}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.736910 (no previous merge yet)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.6332207432368728, 'auprc': 0.8544481476094098, 'loss_val': 0.4162753489904341, 'psi': 0.7217117049858877}-{'f1_val': 0.7007406076076139, 'auprc': 0.8543918618713018, 'loss_val': 0.3938348755150711, 'psi': 0.7622011093130892}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.311839 cos_to_last_merge=0.9487 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.949
[S6] round=36 local utility u=0.320807 metrics={'f1_val': 0.8239632441659592, 'auprc': 0.9616276339632105, 'loss_val': 0.355194299798931, 'psi': 0.8790290000848597}-{'f1_val': 0.751659308687597, 'auprc': 0.9477865990185526, 'loss_val': 0.5214614670200249, 'psi': 0.8301102248199792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=36 head_norm_before_train=1.406350 cos_to_last_merge=0.9805 (last merge round=21)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.5494161486004501, 'auprc': 0.7856954262481788, 'loss_val': 0.7723113242292791, 'psi': 0.6439278596595416}-{'f1_val': 0.6817452087452573, 'auprc': 0.8275721306714613, 'loss_val': 0.44697191782802237, 'psi': 0.740075977515739}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=2.041983 cos_to_last_merge=0.9986 (last merge round=24)
[S8] round=36 local utility u=0.001692 metrics={'f1_val': 0.9918008107316822, 'auprc': 0.998580084284008, 'loss_val': 0.03431000990032972, 'psi': 0.9945125201526126}-{'f1_val': 0.9918109678295097, 'auprc': 0.9986929270613462, 'loss_val': 0.03809333645023935, 'psi': 0.9945637515222443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=36 head_norm_before_train=2.052647 cos_to_last_merge=0.9814 (last merge round=19)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984554344812351, 'loss_val': 0.027680316456376922, 'psi': 0.9968782048110053}-{'f1_val': 0.9966605118138915, 'auprc': 0.9970142775161962, 'loss_val': 0.026337364569858624, 'psi': 0.9968020180948134}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.988010 (no previous merge yet)
[S10] round=36 local utility u=0.000592 metrics={'f1_val': 0.9943868042020945, 'auprc': 0.9963921385522335, 'loss_val': 0.03670012256014022, 'psi': 0.9951889379421501}-{'f1_val': 0.9941677348444804, 'auprc': 0.9967611876634797, 'loss_val': 0.03767637548381633, 'psi': 0.9952051159720801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=36 head_norm_before_train=2.040768 (no previous merge yet)
[S11] round=36 local utility u=0.003282 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9981045237240744, 'loss_val': 0.027944291824301692, 'psi': 0.9967769122107781}-{'f1_val': 0.9956720869712891, 'auprc': 0.9981479388213567, 'loss_val': 0.03331911428961615, 'psi': 0.9966624277113161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=36 head_norm_before_train=1.719731 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5755582634736758, 'auprc': 0.7045064733178099, 'loss_val': 1.029091487624204, 'psi': 0.6271375474113294}-{'f1_val': 0.5722389612211617, 'auprc': 0.7015873385775037, 'loss_val': 0.9000344285844516, 'psi': 0.6239783121636985}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.798086 cos_to_last_merge=0.7721 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.772
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9960107669058352, 'auprc': 0.9969662620621669, 'loss_val': 0.02663563969174967, 'psi': 0.9963929649683679}-{'f1_val': 0.9974314937735356, 'auprc': 0.998660164966297, 'loss_val': 0.023119596726301258, 'psi': 0.99792296225064}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.566488 cos_to_last_merge=0.9586 (last merge round=24)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.6997981206538426, 'auprc': 0.9112529409300388, 'loss_val': 0.4878916770422519, 'psi': 0.7843800487643211}-{'f1_val': 0.9920269663788994, 'auprc': 0.9843451424700643, 'loss_val': 0.06636047656106374, 'psi': 0.9889542368153654}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.471521 cos_to_last_merge=0.9731 (last merge round=26)
[S16] round=36 local utility u=0.336019 metrics={'f1_val': 0.9904533055026786, 'auprc': 0.9975013412175628, 'loss_val': 0.058673771463192456, 'psi': 0.9932725197886323}-{'f1_val': 0.9289642275088086, 'auprc': 0.991907450823786, 'loss_val': 0.344995920490881, 'psi': 0.9541415168347995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=36 head_norm_before_train=1.973193 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6195881617682102, 'auprc': 0.8767326597282584, 'loss_val': 0.9944259845478505, 'psi': 0.7224459609522296}-{'f1_val': 0.6134839671221923, 'auprc': 0.8858130258862408, 'loss_val': 0.9431808127176345, 'psi': 0.7224155906278117}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.522004 cos_to_last_merge=0.7289 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.729
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.6327310003770849, 'auprc': 0.7388792768804955, 'loss_val': 0.976863339373579, 'psi': 0.6751903109784492}-{'f1_val': 0.6465708481586075, 'auprc': 0.75711406578713, 'loss_val': 0.7396581639831001, 'psi': 0.6907881352100165}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.552410 cos_to_last_merge=0.9699 (last merge round=26)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.93632295966523, 'auprc': 0.9968099262887837, 'loss_val': 0.15843406437407773, 'psi': 0.9605177463146515}-{'f1_val': 0.9803648687939185, 'auprc': 0.996683488231218, 'loss_val': 0.062330726508213447, 'psi': 0.9868923165688384}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.307213 cos_to_last_merge=0.9755 (last merge round=25)
[S4] round=37 local utility u=0.016199 metrics={'f1_val': 0.9418802509223356, 'auprc': 0.94179686429909, 'loss_val': 0.27539757996441583, 'psi': 0.9418468962730374}-{'f1_val': 0.9420280181992139, 'auprc': 0.930659705712553, 'loss_val': 0.27527133059374126, 'psi': 0.9374806932045496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] START round=37 head_norm_before_train=1.738747 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.5812306761027761, 'auprc': 0.85858962445948, 'loss_val': 0.43460410440222036, 'psi': 0.6921742554454576}-{'f1_val': 0.6332207432368728, 'auprc': 0.8544481476094098, 'loss_val': 0.4162753489904341, 'psi': 0.7217117049858877}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.325062 cos_to_last_merge=0.9461 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6177214358576393, 'auprc': 0.9421682973125489, 'loss_val': 0.6392681624417489, 'psi': 0.7475001804396031}-{'f1_val': 0.8239632441659592, 'auprc': 0.9616276339632105, 'loss_val': 0.355194299798931, 'psi': 0.8790290000848597}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.411815 cos_to_last_merge=0.9796 (last merge round=21)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5233583230969918, 'auprc': 0.780196930338017, 'loss_val': 0.88374923806153, 'psi': 0.6260937659934018}-{'f1_val': 0.5494161486004501, 'auprc': 0.7856954262481788, 'loss_val': 0.7723113242292791, 'psi': 0.6439278596595416}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=2.052774 cos_to_last_merge=0.9984 (last merge round=24)
[S8] round=37 local utility u=0.002285 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9984505548664904, 'loss_val': 0.03397326971364248, 'psi': 0.9949229896198813}-{'f1_val': 0.9918008107316822, 'auprc': 0.998580084284008, 'loss_val': 0.03431000990032972, 'psi': 0.9945125201526126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=37 head_norm_before_train=2.061038 cos_to_last_merge=0.9808 (last merge round=19)
[S9] round=37 local utility u=0.000680 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9983141359362457, 'loss_val': 0.02609662292096874, 'psi': 0.9968417369002915}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984554344812351, 'loss_val': 0.027680316456376922, 'psi': 0.9968782048110053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=37 head_norm_before_train=1.996007 (no previous merge yet)
[S10] round=37 local utility u=0.000026 metrics={'f1_val': 0.9945565338490774, 'auprc': 0.9961808717898836, 'loss_val': 0.0370323770475365, 'psi': 0.9952062690253998}-{'f1_val': 0.9943868042020945, 'auprc': 0.9963921385522335, 'loss_val': 0.03670012256014022, 'psi': 0.9951889379421501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=37 head_norm_before_train=2.051634 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9981247241702677, 'loss_val': 0.03816437816255791, 'psi': 0.996797271943894}-{'f1_val': 0.9958918378685807, 'auprc': 0.9981045237240744, 'loss_val': 0.027944291824301692, 'psi': 0.9967769122107781}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.723607 (no previous merge yet)
[S13] round=37 local utility u=0.245222 metrics={'f1_val': 0.598141263252244, 'auprc': 0.7183361348168246, 'loss_val': 0.7156341935136807, 'psi': 0.6462192118780763}-{'f1_val': 0.5755582634736758, 'auprc': 0.7045064733178099, 'loss_val': 1.029091487624204, 'psi': 0.6271375474113294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=37 head_norm_before_train=1.807279 cos_to_last_merge=0.7712 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.771
[S14] round=37 local utility u=0.006021 metrics={'f1_val': 0.9968189060544872, 'auprc': 0.9990275574047423, 'loss_val': 0.025627015094911193, 'psi': 0.9977023665945892}-{'f1_val': 0.9960107669058352, 'auprc': 0.9969662620621669, 'loss_val': 0.02663563969174967, 'psi': 0.9963929649683679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=37 head_norm_before_train=1.589154 cos_to_last_merge=0.9569 (last merge round=24)
[S15] round=37 local utility u=1.000000 metrics={'f1_val': 0.9891828260520701, 'auprc': 0.9743916174221157, 'loss_val': 0.07484321343914925, 'psi': 0.9832663426000883}-{'f1_val': 0.6997981206538426, 'auprc': 0.9112529409300388, 'loss_val': 0.4878916770422519, 'psi': 0.7843800487643211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=37 head_norm_before_train=1.490152 cos_to_last_merge=0.9714 (last merge round=26)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9323381826899565, 'auprc': 0.9932201631701667, 'loss_val': 0.33001120104449294, 'psi': 0.9566909748820406}-{'f1_val': 0.9904533055026786, 'auprc': 0.9975013412175628, 'loss_val': 0.058673771463192456, 'psi': 0.9932725197886323}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.987099 (no previous merge yet)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.5756739286476207, 'auprc': 0.705513311250162, 'loss_val': 1.1921631330348281, 'psi': 0.6276096816886372}-{'f1_val': 0.6195881617682102, 'auprc': 0.8767326597282584, 'loss_val': 0.9944259845478505, 'psi': 0.7224459609522296}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.532371 cos_to_last_merge=0.7279 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.728
[S2] round=38 local utility u=0.467642 metrics={'f1_val': 0.7041561609660585, 'auprc': 0.7863993001380343, 'loss_val': 0.6126909672931914, 'psi': 0.7370534166348488}-{'f1_val': 0.6327310003770849, 'auprc': 0.7388792768804955, 'loss_val': 0.976863339373579, 'psi': 0.6751903109784492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=38 head_norm_before_train=1.569582 cos_to_last_merge=0.9682 (last merge round=26)
[S3] round=38 local utility u=0.239690 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9983329765992202, 'loss_val': 0.04990388568927712, 'psi': 0.9977550092347404}-{'f1_val': 0.93632295966523, 'auprc': 0.9968099262887837, 'loss_val': 0.15843406437407773, 'psi': 0.9605177463146515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=38 head_norm_before_train=1.317899 cos_to_last_merge=0.9746 (last merge round=25)
[S4] round=38 local utility u=0.081922 metrics={'f1_val': 0.9498252383254939, 'auprc': 0.9742350305853186, 'loss_val': 0.25653869574628485, 'psi': 0.9595891552294238}-{'f1_val': 0.9418802509223356, 'auprc': 0.94179686429909, 'loss_val': 0.27539757996441583, 'psi': 0.9418468962730374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=38 head_norm_before_train=1.747020 (no previous merge yet)
[S5] round=38 local utility u=0.404363 metrics={'f1_val': 0.7005797538498719, 'auprc': 0.866579043546405, 'loss_val': 0.36594121896068327, 'psi': 0.7669794697284852}-{'f1_val': 0.5812306761027761, 'auprc': 0.85858962445948, 'loss_val': 0.43460410440222036, 'psi': 0.6921742554454576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=38 head_norm_before_train=1.339347 cos_to_last_merge=0.9433 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.943
[S6] round=38 local utility u=1.000000 metrics={'f1_val': 0.964285442865171, 'auprc': 0.9640941834658515, 'loss_val': 0.2168758128603444, 'psi': 0.9642089391054431}-{'f1_val': 0.6177214358576393, 'auprc': 0.9421682973125489, 'loss_val': 0.6392681624417489, 'psi': 0.7475001804396031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=38 head_norm_before_train=1.417916 cos_to_last_merge=0.9786 (last merge round=21)
[S7] round=38 local utility u=0.944343 metrics={'f1_val': 0.6953687314020692, 'auprc': 0.8899537002081015, 'loss_val': 0.3563950386455284, 'psi': 0.7732027189244821}-{'f1_val': 0.5233583230969918, 'auprc': 0.780196930338017, 'loss_val': 0.88374923806153, 'psi': 0.6260937659934018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=38 head_norm_before_train=2.059946 cos_to_last_merge=0.9981 (last merge round=24)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9693121163741527, 'auprc': 0.998875605489036, 'loss_val': 0.09710049851864115, 'psi': 0.981137512020106}-{'f1_val': 0.9925712794554754, 'auprc': 0.9984505548664904, 'loss_val': 0.03397326971364248, 'psi': 0.9949229896198813}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=2.069820 cos_to_last_merge=0.9801 (last merge round=19)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9897262816474692, 'auprc': 0.9984392914262682, 'loss_val': 0.038747877337490265, 'psi': 0.9932114855589889}-{'f1_val': 0.9958601375429889, 'auprc': 0.9983141359362457, 'loss_val': 0.02609662292096874, 'psi': 0.9968417369002915}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=2.005029 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9939643640207476, 'auprc': 0.9939709910505653, 'loss_val': 0.042925580350084154, 'psi': 0.9939670148326747}-{'f1_val': 0.9945565338490774, 'auprc': 0.9961808717898836, 'loss_val': 0.0370323770475365, 'psi': 0.9952062690253998}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=2.062616 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9573168200365925, 'auprc': 0.9981082658212562, 'loss_val': 0.13391102389209078, 'psi': 0.9736333983504579}-{'f1_val': 0.9959123037929781, 'auprc': 0.9981247241702677, 'loss_val': 0.03816437816255791, 'psi': 0.996797271943894}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.729705 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5731529951325998, 'auprc': 0.7215605446759532, 'loss_val': 0.8356523417074894, 'psi': 0.6325160149499411}-{'f1_val': 0.598141263252244, 'auprc': 0.7183361348168246, 'loss_val': 0.7156341935136807, 'psi': 0.6462192118780763}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.814835 cos_to_last_merge=0.7705 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.770
[S14] round=38 local utility u=0.002762 metrics={'f1_val': 0.9976971966821454, 'auprc': 0.9990415828271185, 'loss_val': 0.02541471052847318, 'psi': 0.9982349511401347}-{'f1_val': 0.9968189060544872, 'auprc': 0.9990275574047423, 'loss_val': 0.025627015094911193, 'psi': 0.9977023665945892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=38 head_norm_before_train=1.610946 cos_to_last_merge=0.9552 (last merge round=24)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.8037165405332576, 'auprc': 0.9633258112054517, 'loss_val': 0.3585118675566666, 'psi': 0.8675602488021352}-{'f1_val': 0.9891828260520701, 'auprc': 0.9743916174221157, 'loss_val': 0.07484321343914925, 'psi': 0.9832663426000883}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.506033 cos_to_last_merge=0.9700 (last merge round=26)
[S16] round=38 local utility u=0.315383 metrics={'f1_val': 0.9911498303647908, 'auprc': 0.9925241919557773, 'loss_val': 0.0500272133239295, 'psi': 0.9916995750011854}-{'f1_val': 0.9323381826899565, 'auprc': 0.9932201631701667, 'loss_val': 0.33001120104449294, 'psi': 0.9566909748820406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=38 head_norm_before_train=2.002963 (no previous merge yet)
[S17] round=38 local utility u=0.067387 metrics={'f1_val': 0.5863279455431496, 'auprc': 0.7410086256068245, 'loss_val': 1.2277987473767287, 'psi': 0.6482002175686196}-{'f1_val': 0.5756739286476207, 'auprc': 0.705513311250162, 'loss_val': 1.1921631330348281, 'psi': 0.6276096816886372}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=39 head_norm_before_train=1.544489 cos_to_last_merge=0.7268 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.727
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6883876328893647, 'auprc': 0.7744983141516106, 'loss_val': 0.6717847330231934, 'psi': 0.7228319053942631}-{'f1_val': 0.7041561609660585, 'auprc': 0.7863993001380343, 'loss_val': 0.6126909672931914, 'psi': 0.7370534166348488}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.723 u=0.0000 p_local=0.1512 f1=0.688 auprc=0.774 bytes=34193
[S3] START round=39 head_norm_before_train=1.586643 cos_to_last_merge=0.9666 (last merge round=26)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9614594427737211, 'auprc': 0.996613287888984, 'loss_val': 0.09808765690921763, 'psi': 0.9755209808198262}-{'f1_val': 0.9973696976584205, 'auprc': 0.9983329765992202, 'loss_val': 0.04990388568927712, 'psi': 0.9977550092347404}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.976 u=0.0000 p_local=0.0698 f1=0.961 auprc=0.997 bytes=44972
[S4] START round=39 head_norm_before_train=1.326520 cos_to_last_merge=0.9741 (last merge round=25)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9515631105762397, 'auprc': 0.9609126924910245, 'loss_val': 0.26148744439503036, 'psi': 0.9553029433421536}-{'f1_val': 0.9498252383254939, 'auprc': 0.9742350305853186, 'loss_val': 0.25653869574628485, 'psi': 0.9595891552294238}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.955 u=0.0000 p_local=0.0225 f1=0.952 auprc=0.961 bytes=48504
[S5] START round=39 head_norm_before_train=1.756733 (no previous merge yet)
[S5] round=39 local utility u=0.217181 metrics={'f1_val': 0.7005797538498719, 'auprc': 0.9806097489989426, 'loss_val': 0.2736712909117077, 'psi': 0.8125917519095003}-{'f1_val': 0.7005797538498719, 'auprc': 0.866579043546405, 'loss_val': 0.36594121896068327, 'psi': 0.7669794697284852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S5] r=40 psi=0.813 u=0.2172 p_local=0.2222 f1=0.701 auprc=0.981 bytes=39582
[S6] START round=39 head_norm_before_train=1.352083 cos_to_last_merge=0.9406 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.941
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.7833757939009366, 'auprc': 0.9528042104574027, 'loss_val': 0.4526816820894004, 'psi': 0.851147160523523}-{'f1_val': 0.964285442865171, 'auprc': 0.9640941834658515, 'loss_val': 0.2168758128603444, 'psi': 0.9642089391054431}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.851 u=0.0000 p_local=0.2933 f1=0.783 auprc=0.953 bytes=44890
[S7] START round=39 head_norm_before_train=1.423249 cos_to_last_merge=0.9778 (last merge round=21)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.46266817012568395, 'auprc': 0.7799500491632371, 'loss_val': 0.9192899024835476, 'psi': 0.5895809217407053}-{'f1_val': 0.6953687314020692, 'auprc': 0.8899537002081015, 'loss_val': 0.3563950386455284, 'psi': 0.7732027189244821}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.590 u=0.0000 p_local=0.2850 f1=0.463 auprc=0.780 bytes=43150
[S8] START round=39 head_norm_before_train=2.068357 cos_to_last_merge=0.9979 (last merge round=24)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.8982720982814727, 'auprc': 0.9991301078549955, 'loss_val': 0.1937045611588533, 'psi': 0.9386153021108818}-{'f1_val': 0.9693121163741527, 'auprc': 0.998875605489036, 'loss_val': 0.09710049851864115, 'psi': 0.981137512020106}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.939 u=0.0000 p_local=0.0089 f1=0.898 auprc=0.999 bytes=46755
[S9] START round=39 head_norm_before_train=2.078288 cos_to_last_merge=0.9794 (last merge round=19)
[S9] round=39 local utility u=0.023650 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9944830223771515, 'loss_val': 0.02383828058219723, 'psi': 0.9960549564581462}-{'f1_val': 0.9897262816474692, 'auprc': 0.9984392914262682, 'loss_val': 0.038747877337490265, 'psi': 0.9932114855589889}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S9] r=40 psi=0.996 u=0.0237 p_local=0.0097 f1=0.997 auprc=0.994 bytes=48533
[S10] START round=39 head_norm_before_train=2.014826 (no previous merge yet)
[S10] round=39 local utility u=0.005427 metrics={'f1_val': 0.9941183616473943, 'auprc': 0.9956369555721652, 'loss_val': 0.037993390616644404, 'psi': 0.9947257992173026}-{'f1_val': 0.9939643640207476, 'auprc': 0.9939709910505653, 'loss_val': 0.042925580350084154, 'psi': 0.9939670148326747}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S10] r=40 psi=0.995 u=0.0054 p_local=0.0046 f1=0.994 auprc=0.996 bytes=53972
[S11] START round=39 head_norm_before_train=2.071083 (no previous merge yet)
[S11] round=39 local utility u=0.165416 metrics={'f1_val': 0.9946901021354234, 'auprc': 0.9980552305233767, 'loss_val': 0.027159891589793168, 'psi': 0.9960361534906048}-{'f1_val': 0.9573168200365925, 'auprc': 0.9981082658212562, 'loss_val': 0.13391102389209078, 'psi': 0.9736333983504579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S11] r=40 psi=0.996 u=0.1654 p_local=0.0483 f1=0.995 auprc=0.998 bytes=46756
[S13] START round=39 head_norm_before_train=1.737049 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6010410669650169, 'auprc': 0.5788160643027414, 'loss_val': 1.0108409631135375, 'psi': 0.5921510659001067}-{'f1_val': 0.5731529951325998, 'auprc': 0.7215605446759532, 'loss_val': 0.8356523417074894, 'psi': 0.6325160149499411}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.592 u=0.0000 p_local=0.0578 f1=0.601 auprc=0.579 bytes=35932
[S14] START round=39 head_norm_before_train=1.823019 cos_to_last_merge=0.7695 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.770
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9970019790909475, 'auprc': 0.9990448610010353, 'loss_val': 0.02732755669405691, 'psi': 0.9978191318549825}-{'f1_val': 0.9976971966821454, 'auprc': 0.9990415828271185, 'loss_val': 0.02541471052847318, 'psi': 0.9982349511401347}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.998 u=0.0000 p_local=0.0046 f1=0.997 auprc=0.999 bytes=52151
[S15] START round=39 head_norm_before_train=1.628370 cos_to_last_merge=0.9534 (last merge round=24)
[S15] round=39 local utility u=0.761663 metrics={'f1_val': 0.9930045029863646, 'auprc': 0.9901065943538736, 'loss_val': 0.05125620788278621, 'psi': 0.9918453395333682}-{'f1_val': 0.8037165405332576, 'auprc': 0.9633258112054517, 'loss_val': 0.3585118675566666, 'psi': 0.8675602488021352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S15] r=40 psi=0.992 u=0.7617 p_local=0.4211 f1=0.993 auprc=0.990 bytes=43071
[S16] START round=39 head_norm_before_train=1.519516 cos_to_last_merge=0.9687 (last merge round=26)
[S16] round=39 local utility u=0.002790 metrics={'f1_val': 0.9913691805556047, 'auprc': 0.9929023127855721, 'loss_val': 0.046896731527003105, 'psi': 0.9919824334475916}-{'f1_val': 0.9911498303647908, 'auprc': 0.9925241919557773, 'loss_val': 0.0500272133239295, 'psi': 0.9916995750011854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S16] r=40 psi=0.992 u=0.0028 p_local=0.1087 f1=0.991 auprc=0.993 bytes=43143
[S17] START round=39 head_norm_before_train=2.020497 (no previous merge yet)
[S17] round=39 local utility u=0.445700 metrics={'f1_val': 0.6233475718611172, 'auprc': 0.9238336091467045, 'loss_val': 1.1069908906122294, 'psi': 0.7435419867753521}-{'f1_val': 0.5863279455431496, 'auprc': 0.7410086256068245, 'loss_val': 1.2277987473767287, 'psi': 0.6482002175686196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S17] r=40 psi=0.744 u=0.4457 p_local=0.1581 f1=0.623 auprc=0.924 bytes=43193
[S2] START round=40 head_norm_before_train=1.556163 cos_to_last_merge=0.7254 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.725
[S2] round=40 local utility u=0.049308 metrics={'f1_val': 0.7117723498862858, 'auprc': 0.7855161109656691, 'loss_val': 0.7465310206763165, 'psi': 0.7412698543180392}-{'f1_val': 0.6883876328893647, 'auprc': 0.7744983141516106, 'loss_val': 0.6717847330231934, 'psi': 0.7228319053942631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=40 head_norm_before_train=1.604146 cos_to_last_merge=0.9650 (last merge round=26)
[S3] round=40 local utility u=0.143189 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9969223370346526, 'loss_val': 0.030569469057211952, 'psi': 0.9974378326408195}-{'f1_val': 0.9614594427737211, 'auprc': 0.996613287888984, 'loss_val': 0.09808765690921763, 'psi': 0.9755209808198262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=40 head_norm_before_train=1.334242 cos_to_last_merge=0.9734 (last merge round=25)
[S4] round=40 local utility u=0.013497 metrics={'f1_val': 0.9501773087927516, 'auprc': 0.9713532400749717, 'loss_val': 0.25750081578390405, 'psi': 0.9586476813056397}-{'f1_val': 0.9515631105762397, 'auprc': 0.9609126924910245, 'loss_val': 0.26148744439503036, 'psi': 0.9553029433421536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=40 head_norm_before_train=1.763704 (no previous merge yet)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.7005797538498719, 'auprc': 0.9617094504403251, 'loss_val': 0.3143755918435729, 'psi': 0.8050316324860531}-{'f1_val': 0.7005797538498719, 'auprc': 0.9806097489989426, 'loss_val': 0.2736712909117077, 'psi': 0.8125917519095003}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.364066 cos_to_last_merge=0.9381 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.938
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.7646051649453768, 'auprc': 0.933131559919254, 'loss_val': 0.6141964846139989, 'psi': 0.8320157229349276}-{'f1_val': 0.7833757939009366, 'auprc': 0.9528042104574027, 'loss_val': 0.4526816820894004, 'psi': 0.851147160523523}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.429460 cos_to_last_merge=0.9770 (last merge round=21)
[S7] round=40 local utility u=1.000000 metrics={'f1_val': 0.9050845570477702, 'auprc': 0.9710233017425797, 'loss_val': 0.3261663402503664, 'psi': 0.931460054925694}-{'f1_val': 0.46266817012568395, 'auprc': 0.7799500491632371, 'loss_val': 0.9192899024835476, 'psi': 0.5895809217407053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=40 head_norm_before_train=2.075761 cos_to_last_merge=0.9978 (last merge round=24)
[S8] round=40 local utility u=0.348678 metrics={'f1_val': 0.9931569338135257, 'auprc': 0.9896893763257213, 'loss_val': 0.03733536973952971, 'psi': 0.9917699108184039}-{'f1_val': 0.8982720982814727, 'auprc': 0.9991301078549955, 'loss_val': 0.1937045611588533, 'psi': 0.9386153021108818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=40 head_norm_before_train=2.085134 cos_to_last_merge=0.9788 (last merge round=19)
[S9] round=40 local utility u=0.000209 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9955840141483155, 'loss_val': 0.024068832724727127, 'psi': 0.996229912747661}-{'f1_val': 0.9971029125121428, 'auprc': 0.9944830223771515, 'loss_val': 0.02383828058219723, 'psi': 0.9960549564581462}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=40 head_norm_before_train=2.025365 (no previous merge yet)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9939643640207476, 'auprc': 0.9953211795506386, 'loss_val': 0.03941291341076604, 'psi': 0.994507090232704}-{'f1_val': 0.9941183616473943, 'auprc': 0.9956369555721652, 'loss_val': 0.037993390616644404, 'psi': 0.9947257992173026}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=2.077613 (no previous merge yet)
[S11] round=40 local utility u=0.003783 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9967180268108238, 'loss_val': 0.022792213089118336, 'psi': 0.996222313445478}-{'f1_val': 0.9946901021354234, 'auprc': 0.9980552305233767, 'loss_val': 0.027159891589793168, 'psi': 0.9960361534906048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=40 head_norm_before_train=1.743132 (no previous merge yet)
[S13] round=40 local utility u=0.018980 metrics={'f1_val': 0.546758189840542, 'auprc': 0.7275650532438642, 'loss_val': 1.093430266144876, 'psi': 0.6190809352018709}-{'f1_val': 0.6010410669650169, 'auprc': 0.5788160643027414, 'loss_val': 1.0108409631135375, 'psi': 0.5921510659001067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=40 head_norm_before_train=1.832489 cos_to_last_merge=0.7684 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.768
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9969914598555882, 'auprc': 0.9990355674047431, 'loss_val': 0.02732547526647327, 'psi': 0.9978091028752503}-{'f1_val': 0.9970019790909475, 'auprc': 0.9990448610010353, 'loss_val': 0.02732755669405691, 'psi': 0.9978191318549825}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.644484 cos_to_last_merge=0.9518 (last merge round=24)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6977610587219888, 'auprc': 0.8946519959820343, 'loss_val': 0.5712956103889952, 'psi': 0.776517433626007}-{'f1_val': 0.9930045029863646, 'auprc': 0.9901065943538736, 'loss_val': 0.05125620788278621, 'psi': 0.9918453395333682}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.532861 cos_to_last_merge=0.9674 (last merge round=26)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.956417093057139, 'auprc': 0.9919803626836161, 'loss_val': 0.13582812553282955, 'psi': 0.9706424009077299}-{'f1_val': 0.9913691805556047, 'auprc': 0.9929023127855721, 'loss_val': 0.046896731527003105, 'psi': 0.9919824334475916}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=2.036011 (no previous merge yet)
[S17] round=40 local utility u=0.034611 metrics={'f1_val': 0.6320552712701032, 'auprc': 0.9257188734276065, 'loss_val': 1.095670349300723, 'psi': 0.7495207121331046}-{'f1_val': 0.6233475718611172, 'auprc': 0.9238336091467045, 'loss_val': 1.1069908906122294, 'psi': 0.7435419867753521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=41 head_norm_before_train=1.567395 cos_to_last_merge=0.7241 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.724
[S2] round=41 local utility u=0.040029 metrics={'f1_val': 0.7125118756822812, 'auprc': 0.8001406258949346, 'loss_val': 0.7147832778461547, 'psi': 0.7475633757673426}-{'f1_val': 0.7117723498862858, 'auprc': 0.7855161109656691, 'loss_val': 0.7465310206763165, 'psi': 0.7412698543180392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=41 head_norm_before_train=1.623012 cos_to_last_merge=0.9633 (last merge round=26)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9968928619524421, 'loss_val': 0.0316483937564347, 'psi': 0.9971789633760291}-{'f1_val': 0.9977814963782642, 'auprc': 0.9969223370346526, 'loss_val': 0.030569469057211952, 'psi': 0.9974378326408195}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.342710 cos_to_last_merge=0.9723 (last merge round=25)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9425846970033345, 'auprc': 0.9395074006035635, 'loss_val': 0.28001921931521895, 'psi': 0.9413537784434262}-{'f1_val': 0.9501773087927516, 'auprc': 0.9713532400749717, 'loss_val': 0.25750081578390405, 'psi': 0.9586476813056397}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.770413 (no previous merge yet)
[S5] round=41 local utility u=0.055842 metrics={'f1_val': 0.7005797538498719, 'auprc': 0.9751187553188402, 'loss_val': 0.24291943726184767, 'psi': 0.8103953544374592}-{'f1_val': 0.7005797538498719, 'auprc': 0.9617094504403251, 'loss_val': 0.3143755918435729, 'psi': 0.8050316324860531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=41 head_norm_before_train=1.376192 cos_to_last_merge=0.9357 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=41 local utility u=0.853523 metrics={'f1_val': 0.964285442865171, 'auprc': 0.963087149171359, 'loss_val': 0.1950982543003468, 'psi': 0.9638061253876462}-{'f1_val': 0.7646051649453768, 'auprc': 0.933131559919254, 'loss_val': 0.6141964846139989, 'psi': 0.8320157229349276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=41 head_norm_before_train=1.435863 cos_to_last_merge=0.9763 (last merge round=21)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.49468937742122776, 'auprc': 0.7804083130461226, 'loss_val': 0.8944195170389359, 'psi': 0.6089769516711856}-{'f1_val': 0.9050845570477702, 'auprc': 0.9710233017425797, 'loss_val': 0.3261663402503664, 'psi': 0.931460054925694}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=2.083627 cos_to_last_merge=0.9976 (last merge round=24)
[S8] round=41 local utility u=0.014431 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9986359020807379, 'loss_val': 0.0315449233712682, 'psi': 0.9949717424266868}-{'f1_val': 0.9931569338135257, 'auprc': 0.9896893763257213, 'loss_val': 0.03733536973952971, 'psi': 0.9917699108184039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=41 head_norm_before_train=2.091903 cos_to_last_merge=0.9784 (last merge round=19)
[S9] round=41 local utility u=0.001389 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984598227638013, 'loss_val': 0.024915158319205648, 'psi': 0.9968799601240318}-{'f1_val': 0.9966605118138915, 'auprc': 0.9955840141483155, 'loss_val': 0.024068832724727127, 'psi': 0.996229912747661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=41 head_norm_before_train=2.036301 (no previous merge yet)
[S10] round=41 local utility u=0.003227 metrics={'f1_val': 0.994337411336045, 'auprc': 0.99565960127514, 'loss_val': 0.036211866208796135, 'psi': 0.994866287311683}-{'f1_val': 0.9939643640207476, 'auprc': 0.9953211795506386, 'loss_val': 0.03941291341076604, 'psi': 0.994507090232704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=41 head_norm_before_train=2.086073 (no previous merge yet)
[S11] round=41 local utility u=0.002050 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9966492456649044, 'loss_val': 0.022416491786312342, 'psi': 0.9965879009741155}-{'f1_val': 0.9958918378685807, 'auprc': 0.9967180268108238, 'loss_val': 0.022792213089118336, 'psi': 0.996222313445478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=41 head_norm_before_train=1.744715 (no previous merge yet)
[S13] round=41 local utility u=0.250874 metrics={'f1_val': 0.5701442083469543, 'auprc': 0.7433304297979354, 'loss_val': 0.7792938610345725, 'psi': 0.6394186969273468}-{'f1_val': 0.546758189840542, 'auprc': 0.7275650532438642, 'loss_val': 1.093430266144876, 'psi': 0.6190809352018709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=41 head_norm_before_train=1.842511 cos_to_last_merge=0.7675 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.767
[S14] round=41 local utility u=0.006068 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9990097300636221, 'loss_val': 0.02009312099555392, 'psi': 0.9982969476381043}-{'f1_val': 0.9969914598555882, 'auprc': 0.9990355674047431, 'loss_val': 0.02732547526647327, 'psi': 0.9978091028752503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=41 head_norm_before_train=1.658989 cos_to_last_merge=0.9504 (last merge round=24)
[S15] round=41 local utility u=1.000000 metrics={'f1_val': 0.9919078499691885, 'auprc': 0.982382818647524, 'loss_val': 0.05466274169288303, 'psi': 0.9880978374405227}-{'f1_val': 0.6977610587219888, 'auprc': 0.8946519959820343, 'loss_val': 0.5712956103889952, 'psi': 0.776517433626007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=41 head_norm_before_train=1.546483 cos_to_last_merge=0.9662 (last merge round=26)
[S16] round=41 local utility u=0.028330 metrics={'f1_val': 0.9612699147802825, 'auprc': 0.9968696827538863, 'loss_val': 0.12295231956920201, 'psi': 0.975509821969724}-{'f1_val': 0.956417093057139, 'auprc': 0.9919803626836161, 'loss_val': 0.13582812553282955, 'psi': 0.9706424009077299}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=41 head_norm_before_train=2.049338 (no previous merge yet)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6304620157333993, 'auprc': 0.8661983423437813, 'loss_val': 1.1805867743092728, 'psi': 0.724756546377552}-{'f1_val': 0.6320552712701032, 'auprc': 0.9257188734276065, 'loss_val': 1.095670349300723, 'psi': 0.7495207121331046}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.580843 cos_to_last_merge=0.7227 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.723
[S2] round=42 local utility u=0.006622 metrics={'f1_val': 0.705896022860474, 'auprc': 0.798816452329836, 'loss_val': 0.6578719821810085, 'psi': 0.7430641946482188}-{'f1_val': 0.7125118756822812, 'auprc': 0.8001406258949346, 'loss_val': 0.7147832778461547, 'psi': 0.7475633757673426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=42 head_norm_before_train=1.639535 cos_to_last_merge=0.9615 (last merge round=26)
[S3] round=42 local utility u=0.003147 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9977896884451479, 'loss_val': 0.028043904326039995, 'psi': 0.9975376939731115}-{'f1_val': 0.9973696976584205, 'auprc': 0.9968928619524421, 'loss_val': 0.0316483937564347, 'psi': 0.9971789633760291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=42 head_norm_before_train=1.350006 cos_to_last_merge=0.9720 (last merge round=25)
[S4] round=42 local utility u=0.056145 metrics={'f1_val': 0.9510907728331157, 'auprc': 0.9553673357042458, 'loss_val': 0.26634643881074443, 'psi': 0.9528013979815677}-{'f1_val': 0.9425846970033345, 'auprc': 0.9395074006035635, 'loss_val': 0.28001921931521895, 'psi': 0.9413537784434262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=42 head_norm_before_train=1.777877 (no previous merge yet)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.5776352361456047, 'auprc': 0.8536795768596406, 'loss_val': 0.6675395473662845, 'psi': 0.688052972431219}-{'f1_val': 0.7005797538498719, 'auprc': 0.9751187553188402, 'loss_val': 0.24291943726184767, 'psi': 0.8103953544374592}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.387586 cos_to_last_merge=0.9335 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.934
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7033663074477512, 'auprc': 0.951607539658686, 'loss_val': 0.5807221868156458, 'psi': 0.8026628003321251}-{'f1_val': 0.964285442865171, 'auprc': 0.963087149171359, 'loss_val': 0.1950982543003468, 'psi': 0.9638061253876462}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.441809 cos_to_last_merge=0.9753 (last merge round=21)
[S7] round=42 local utility u=0.528244 metrics={'f1_val': 0.6157232587970568, 'auprc': 0.7959000016664675, 'loss_val': 0.6106094741620681, 'psi': 0.6877939559448211}-{'f1_val': 0.49468937742122776, 'auprc': 0.7804083130461226, 'loss_val': 0.8944195170389359, 'psi': 0.6089769516711856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=42 head_norm_before_train=2.093775 cos_to_last_merge=0.9975 (last merge round=24)
[S8] round=42 local utility u=0.005701 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.9979896522515019, 'loss_val': 0.029834459925423194, 'psi': 0.9958761820820379}-{'f1_val': 0.9925289693239863, 'auprc': 0.9986359020807379, 'loss_val': 0.0315449233712682, 'psi': 0.9949717424266868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=42 head_norm_before_train=2.099026 cos_to_last_merge=0.9778 (last merge round=19)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9984494847868886, 'loss_val': 0.02633238380220569, 'psi': 0.9956250989085804}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984598227638013, 'loss_val': 0.024915158319205648, 'psi': 0.9968799601240318}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.047059 (no previous merge yet)
[S10] round=42 local utility u=0.000344 metrics={'f1_val': 0.9941434254657042, 'auprc': 0.9960586623137009, 'loss_val': 0.035557109444360496, 'psi': 0.994909520204903}-{'f1_val': 0.994337411336045, 'auprc': 0.99565960127514, 'loss_val': 0.036211866208796135, 'psi': 0.994866287311683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=42 head_norm_before_train=2.094034 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9832354696409165, 'auprc': 0.9982827555836453, 'loss_val': 0.05106916596467687, 'psi': 0.989254384018008}-{'f1_val': 0.9965470045135896, 'auprc': 0.9966492456649044, 'loss_val': 0.022416491786312342, 'psi': 0.9965879009741155}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.742430 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.5646017872594872, 'auprc': 0.726474674210979, 'loss_val': 0.709965178554622, 'psi': 0.6293509420400839}-{'f1_val': 0.5701442083469543, 'auprc': 0.7433304297979354, 'loss_val': 0.7792938610345725, 'psi': 0.6394186969273468}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.851502 cos_to_last_merge=0.7667 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.767
[S14] round=42 local utility u=0.000682 metrics={'f1_val': 0.998105581732476, 'auprc': 0.9990153307392166, 'loss_val': 0.02044792179104948, 'psi': 0.9984694813351722}-{'f1_val': 0.9978217593544257, 'auprc': 0.9990097300636221, 'loss_val': 0.02009312099555392, 'psi': 0.9982969476381043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=42 head_norm_before_train=1.672179 cos_to_last_merge=0.9494 (last merge round=24)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.6977610587219888, 'auprc': 0.7156795778757318, 'loss_val': 0.6379177467875214, 'psi': 0.7049284663834859}-{'f1_val': 0.9919078499691885, 'auprc': 0.982382818647524, 'loss_val': 0.05466274169288303, 'psi': 0.9880978374405227}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.559993 cos_to_last_merge=0.9650 (last merge round=26)
[S16] round=42 local utility u=0.040905 metrics={'f1_val': 0.9712021668262694, 'auprc': 0.9972111326191083, 'loss_val': 0.10176053868427269, 'psi': 0.981605753143405}-{'f1_val': 0.9612699147802825, 'auprc': 0.9968696827538863, 'loss_val': 0.12295231956920201, 'psi': 0.975509821969724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=42 head_norm_before_train=2.062582 (no previous merge yet)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.49304381197575065, 'auprc': 0.6519441683097376, 'loss_val': 1.6877145028994156, 'psi': 0.5566039545093454}-{'f1_val': 0.6304620157333993, 'auprc': 0.8661983423437813, 'loss_val': 1.1805867743092728, 'psi': 0.724756546377552}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.593284 cos_to_last_merge=0.7214 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.721
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7122163351325537, 'auprc': 0.7801886697854055, 'loss_val': 0.7881575368736013, 'psi': 0.7394052689936943}-{'f1_val': 0.705896022860474, 'auprc': 0.798816452329836, 'loss_val': 0.6578719821810085, 'psi': 0.7430641946482188}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.655899 cos_to_last_merge=0.9599 (last merge round=26)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9614594427737211, 'auprc': 0.9966520463554566, 'loss_val': 0.10215861140691834, 'psi': 0.9755364842064154}-{'f1_val': 0.9973696976584205, 'auprc': 0.9977896884451479, 'loss_val': 0.028043904326039995, 'psi': 0.9975376939731115}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.357245 cos_to_last_merge=0.9721 (last merge round=25)
[S4] round=43 local utility u=0.029952 metrics={'f1_val': 0.9504755146768761, 'auprc': 0.9736063728247197, 'loss_val': 0.25746828065962446, 'psi': 0.9597278579360136}-{'f1_val': 0.9510907728331157, 'auprc': 0.9553673357042458, 'loss_val': 0.26634643881074443, 'psi': 0.9528013979815677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=43 head_norm_before_train=1.787167 (no previous merge yet)
[S5] round=43 local utility u=0.786103 metrics={'f1_val': 0.7007406076076139, 'auprc': 0.9868125491329789, 'loss_val': 0.23336557264643756, 'psi': 0.8151693842177599}-{'f1_val': 0.5776352361456047, 'auprc': 0.8536795768596406, 'loss_val': 0.6675395473662845, 'psi': 0.688052972431219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=43 head_norm_before_train=1.402611 cos_to_last_merge=0.9308 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.931
[S6] round=43 local utility u=0.992487 metrics={'f1_val': 0.9635949653906095, 'auprc': 0.9655013357977288, 'loss_val': 0.19880165983396825, 'psi': 0.9643575135534572}-{'f1_val': 0.7033663074477512, 'auprc': 0.951607539658686, 'loss_val': 0.5807221868156458, 'psi': 0.8026628003321251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S6] sending update (kind=head size=1789 to 1 peers)
[S7] START round=43 head_norm_before_train=1.449787 cos_to_last_merge=0.9739 (last merge round=21)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5310635500592236, 'auprc': 0.7826881448146257, 'loss_val': 0.9219459728429926, 'psi': 0.6317133879613844}-{'f1_val': 0.6157232587970568, 'auprc': 0.7959000016664675, 'loss_val': 0.6106094741620681, 'psi': 0.6877939559448211}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=2.103602 cos_to_last_merge=0.9973 (last merge round=24)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9921596426793389, 'auprc': 0.9889388621165152, 'loss_val': 0.04196581367491237, 'psi': 0.9908713304542094}-{'f1_val': 0.9944672019690619, 'auprc': 0.9979896522515019, 'loss_val': 0.029834459925423194, 'psi': 0.9958761820820379}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=2.106529 cos_to_last_merge=0.9772 (last merge round=19)
[S9] round=43 local utility u=0.004123 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9931807965368694, 'loss_val': 0.022444843582791047, 'psi': 0.9955340661220334}-{'f1_val': 0.9937421749897083, 'auprc': 0.9984494847868886, 'loss_val': 0.02633238380220569, 'psi': 0.9956250989085804}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=43 head_norm_before_train=2.052998 (no previous merge yet)
[S10] round=43 local utility u=0.000002 metrics={'f1_val': 0.9941183616473943, 'auprc': 0.9964762153802618, 'loss_val': 0.03665506500910112, 'psi': 0.9950615031405412}-{'f1_val': 0.9941434254657042, 'auprc': 0.9960586623137009, 'loss_val': 0.035557109444360496, 'psi': 0.994909520204903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=43 head_norm_before_train=2.102256 (no previous merge yet)
[S11] round=43 local utility u=0.048112 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9979614212376907, 'loss_val': 0.033896767905214634, 'psi': 0.997127317362351}-{'f1_val': 0.9832354696409165, 'auprc': 0.9982827555836453, 'loss_val': 0.05106916596467687, 'psi': 0.989254384018008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=43 head_norm_before_train=1.744185 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5690245056531565, 'auprc': 0.656608409738295, 'loss_val': 1.0480693072737708, 'psi': 0.6040580672872119}-{'f1_val': 0.5646017872594872, 'auprc': 0.726474674210979, 'loss_val': 0.709965178554622, 'psi': 0.6293509420400839}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.862275 cos_to_last_merge=0.7658 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.766
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9951539120677446, 'auprc': 0.9990409645812693, 'loss_val': 0.030045382344622652, 'psi': 0.9967087330731546}-{'f1_val': 0.998105581732476, 'auprc': 0.9990153307392166, 'loss_val': 0.02044792179104948, 'psi': 0.9984694813351722}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.682499 cos_to_last_merge=0.9486 (last merge round=24)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=43 local utility u=0.502377 metrics={'f1_val': 0.7000400194091229, 'auprc': 0.9854851115095564, 'loss_val': 0.45625320798046193, 'psi': 0.8142180562492962}-{'f1_val': 0.6977610587219888, 'auprc': 0.7156795778757318, 'loss_val': 0.6379177467875214, 'psi': 0.7049284663834859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=43 head_norm_before_train=1.573185 cos_to_last_merge=0.9639 (last merge round=26)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.8581608869612836, 'auprc': 0.9909267178466878, 'loss_val': 0.7316200461344586, 'psi': 0.9112672193154453}-{'f1_val': 0.9712021668262694, 'auprc': 0.9972111326191083, 'loss_val': 0.10176053868427269, 'psi': 0.981605753143405}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=2.075312 (no previous merge yet)
[S17] round=43 local utility u=0.500602 metrics={'f1_val': 0.5841509691416907, 'auprc': 0.7155513165556353, 'loss_val': 1.4239740023162168, 'psi': 0.6367111081072685}-{'f1_val': 0.49304381197575065, 'auprc': 0.6519441683097376, 'loss_val': 1.6877145028994156, 'psi': 0.5566039545093454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=44 head_norm_before_train=1.602631 cos_to_last_merge=0.7204 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.720
[S2] round=44 local utility u=0.034949 metrics={'f1_val': 0.6968090916569917, 'auprc': 0.7967148157244655, 'loss_val': 0.6753952076930841, 'psi': 0.7367713812839811}-{'f1_val': 0.7122163351325537, 'auprc': 0.7801886697854055, 'loss_val': 0.7881575368736013, 'psi': 0.7394052689936943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=44 head_norm_before_train=1.671896 cos_to_last_merge=0.9583 (last merge round=26)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9591338226773183, 'auprc': 0.9962933852271685, 'loss_val': 0.14710632110503205, 'psi': 0.9739976476972584}-{'f1_val': 0.9614594427737211, 'auprc': 0.9966520463554566, 'loss_val': 0.10215861140691834, 'psi': 0.9755364842064154}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.362484 cos_to_last_merge=0.9718 (last merge round=25)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9408129586928875, 'auprc': 0.9400140873777476, 'loss_val': 0.277526603582258, 'psi': 0.9404934101668315}-{'f1_val': 0.9504755146768761, 'auprc': 0.9736063728247197, 'loss_val': 0.25746828065962446, 'psi': 0.9597278579360136}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.793384 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.8539173432349734, 'loss_val': 0.4819999895692863, 'psi': 0.7619591280214448}-{'f1_val': 0.7007406076076139, 'auprc': 0.9868125491329789, 'loss_val': 0.23336557264643756, 'psi': 0.8151693842177599}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.414665 cos_to_last_merge=0.9287 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.929
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.83628308722754, 'auprc': 0.9632663473146592, 'loss_val': 0.32036737836574714, 'psi': 0.8870763912623876}-{'f1_val': 0.9635949653906095, 'auprc': 0.9655013357977288, 'loss_val': 0.19880165983396825, 'psi': 0.9643575135534572}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.459318 cos_to_last_merge=0.9723 (last merge round=21)
[S7] round=44 local utility u=0.725711 metrics={'f1_val': 0.6721156573480958, 'auprc': 0.8267255020319153, 'loss_val': 0.4489479600798828, 'psi': 0.7339595952216236}-{'f1_val': 0.5310635500592236, 'auprc': 0.7826881448146257, 'loss_val': 0.9219459728429926, 'psi': 0.6317133879613844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=44 head_norm_before_train=2.109755 cos_to_last_merge=0.9971 (last merge round=24)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.819283723089029, 'auprc': 0.999352744402993, 'loss_val': 0.32691669681138846, 'psi': 0.8913113316146146}-{'f1_val': 0.9921596426793389, 'auprc': 0.9889388621165152, 'loss_val': 0.04196581367491237, 'psi': 0.9908713304542094}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=2.113608 cos_to_last_merge=0.9766 (last merge round=19)
[S9] round=44 local utility u=0.003362 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9952538206892361, 'loss_val': 0.02194026268475339, 'psi': 0.9963632757829801}-{'f1_val': 0.9971029125121428, 'auprc': 0.9931807965368694, 'loss_val': 0.022444843582791047, 'psi': 0.9955340661220334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=44 head_norm_before_train=2.060254 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9944754122691798, 'auprc': 0.9937804930865937, 'loss_val': 0.04158528274178434, 'psi': 0.9941974445961453}-{'f1_val': 0.9941183616473943, 'auprc': 0.9964762153802618, 'loss_val': 0.03665506500910112, 'psi': 0.9950615031405412}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=2.110571 (no previous merge yet)
[S11] round=44 local utility u=0.002837 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9981837631425439, 'loss_val': 0.026386733828946286, 'psi': 0.9969659901034648}-{'f1_val': 0.9965712481121245, 'auprc': 0.9979614212376907, 'loss_val': 0.033896767905214634, 'psi': 0.997127317362351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=44 head_norm_before_train=1.748993 (no previous merge yet)
[S13] round=44 local utility u=0.201154 metrics={'f1_val': 0.5685318026614925, 'auprc': 0.736843130026483, 'loss_val': 0.8835091523506791, 'psi': 0.6358563336074887}-{'f1_val': 0.5690245056531565, 'auprc': 0.656608409738295, 'loss_val': 1.0480693072737708, 'psi': 0.6040580672872119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=44 head_norm_before_train=1.871505 cos_to_last_merge=0.7650 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.765
[S14] round=44 local utility u=0.014934 metrics={'f1_val': 0.9982854591839057, 'auprc': 0.9990499689769597, 'loss_val': 0.01899282429193791, 'psi': 0.9985912631011273}-{'f1_val': 0.9951539120677446, 'auprc': 0.9990409645812693, 'loss_val': 0.030045382344622652, 'psi': 0.9967087330731546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=44 head_norm_before_train=1.689990 cos_to_last_merge=0.9480 (last merge round=24)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=44 local utility u=1.000000 metrics={'f1_val': 0.9884631647994085, 'auprc': 0.9777747255842877, 'loss_val': 0.0682109861212296, 'psi': 0.9841877891133602}-{'f1_val': 0.7000400194091229, 'auprc': 0.9854851115095564, 'loss_val': 0.45625320798046193, 'psi': 0.8142180562492962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=44 head_norm_before_train=1.583647 cos_to_last_merge=0.9629 (last merge round=26)
[S16] round=44 local utility u=0.754071 metrics={'f1_val': 0.991361520093188, 'auprc': 0.9976011721690259, 'loss_val': 0.04270450895594806, 'psi': 0.9938573809235232}-{'f1_val': 0.8581608869612836, 'auprc': 0.9909267178466878, 'loss_val': 0.7316200461344586, 'psi': 0.9112672193154453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=44 head_norm_before_train=2.084118 (no previous merge yet)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.563968322325965, 'auprc': 0.7270075997474154, 'loss_val': 1.5015512095975252, 'psi': 0.6291840332945452}-{'f1_val': 0.5841509691416907, 'auprc': 0.7155513165556353, 'loss_val': 1.4239740023162168, 'psi': 0.6367111081072685}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.612088 cos_to_last_merge=0.7194 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.719
[S2] round=45 local utility u=0.012821 metrics={'f1_val': 0.706508040663873, 'auprc': 0.7865680207207548, 'loss_val': 0.6775062386937917, 'psi': 0.7385320326866257}-{'f1_val': 0.6968090916569917, 'auprc': 0.7967148157244655, 'loss_val': 0.6753952076930841, 'psi': 0.7367713812839811}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=45 head_norm_before_train=1.687715 cos_to_last_merge=0.9569 (last merge round=26)
[S3] round=45 local utility u=0.178991 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.998537481321274, 'loss_val': 0.02527225191650246, 'psi': 0.9978368111235618}-{'f1_val': 0.9591338226773183, 'auprc': 0.9962933852271685, 'loss_val': 0.14710632110503205, 'psi': 0.9739976476972584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=45 head_norm_before_train=1.369067 cos_to_last_merge=0.9708 (last merge round=25)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.940113470060939, 'auprc': 0.9350270893646169, 'loss_val': 0.28623834946374543, 'psi': 0.9380789177824103}-{'f1_val': 0.9408129586928875, 'auprc': 0.9400140873777476, 'loss_val': 0.277526603582258, 'psi': 0.9404934101668315}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.799767 (no previous merge yet)
[S5] round=45 local utility u=0.350230 metrics={'f1_val': 0.7007406076076139, 'auprc': 0.9881878467683435, 'loss_val': 0.1848732688045172, 'psi': 0.8157195032719058}-{'f1_val': 0.7006536512124258, 'auprc': 0.8539173432349734, 'loss_val': 0.4819999895692863, 'psi': 0.7619591280214448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=45 head_norm_before_train=1.423963 cos_to_last_merge=0.9269 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.927
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.7889627278463197, 'auprc': 0.9585684953913564, 'loss_val': 0.4801991743845986, 'psi': 0.8568050348643343}-{'f1_val': 0.83628308722754, 'auprc': 0.9632663473146592, 'loss_val': 0.32036737836574714, 'psi': 0.8870763912623876}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.467270 cos_to_last_merge=0.9709 (last merge round=21)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.46414818106429095, 'auprc': 0.7803501557024377, 'loss_val': 0.9717098845185522, 'psi': 0.5906289709195497}-{'f1_val': 0.6721156573480958, 'auprc': 0.8267255020319153, 'loss_val': 0.4489479600798828, 'psi': 0.7339595952216236}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=2.113637 cos_to_last_merge=0.9970 (last merge round=24)
[S8] round=45 local utility u=0.645964 metrics={'f1_val': 0.9920165236861632, 'auprc': 0.9898322292727507, 'loss_val': 0.042823149615441876, 'psi': 0.9911428059207982}-{'f1_val': 0.819283723089029, 'auprc': 0.999352744402993, 'loss_val': 0.32691669681138846, 'psi': 0.8913113316146146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=45 head_norm_before_train=2.119627 cos_to_last_merge=0.9762 (last merge round=19)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.998407721529089, 'loss_val': 0.02228888016549799, 'psi': 0.9966125881336071}-{'f1_val': 0.9971029125121428, 'auprc': 0.9952538206892361, 'loss_val': 0.02194026268475339, 'psi': 0.9963632757829801}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.068698 (no previous merge yet)
[S10] round=45 local utility u=0.009611 metrics={'f1_val': 0.9947757294679969, 'auprc': 0.9966346274731125, 'loss_val': 0.0327272506207942, 'psi': 0.9955192886700431}-{'f1_val': 0.9944754122691798, 'auprc': 0.9937804930865937, 'loss_val': 0.04158528274178434, 'psi': 0.9941974445961453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=45 head_norm_before_train=2.118542 (no previous merge yet)
[S11] round=45 local utility u=0.000132 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9967320176241166, 'loss_val': 0.021644294190644616, 'psi': 0.9963730119976322}-{'f1_val': 0.9961541414107454, 'auprc': 0.9981837631425439, 'loss_val': 0.026386733828946286, 'psi': 0.9969659901034648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=45 head_norm_before_train=1.752536 (no previous merge yet)
[S13] round=45 local utility u=0.232422 metrics={'f1_val': 0.6048713022155855, 'auprc': 0.726071420038949, 'loss_val': 0.6043874454685101, 'psi': 0.6533513493449309}-{'f1_val': 0.5685318026614925, 'auprc': 0.736843130026483, 'loss_val': 0.8835091523506791, 'psi': 0.6358563336074887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=45 head_norm_before_train=1.877167 cos_to_last_merge=0.7642 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.764
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.997476613247938, 'auprc': 0.9990448575270484, 'loss_val': 0.020952330043526653, 'psi': 0.9981039109595822}-{'f1_val': 0.9982854591839057, 'auprc': 0.9990499689769597, 'loss_val': 0.01899282429193791, 'psi': 0.9985912631011273}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.696292 cos_to_last_merge=0.9475 (last merge round=24)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.6942385983318304, 'auprc': 0.7195320925175015, 'loss_val': 0.6778912455140462, 'psi': 0.7043559960060989}-{'f1_val': 0.9884631647994085, 'auprc': 0.9777747255842877, 'loss_val': 0.0682109861212296, 'psi': 0.9841877891133602}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.591900 cos_to_last_merge=0.9621 (last merge round=26)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9915786080030298, 'auprc': 0.9947580639643236, 'loss_val': 0.04456917477216809, 'psi': 0.9928503903875474}-{'f1_val': 0.991361520093188, 'auprc': 0.9976011721690259, 'loss_val': 0.04270450895594806, 'psi': 0.9938573809235232}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=2.091733 (no previous merge yet)
[S17] round=45 local utility u=0.546497 metrics={'f1_val': 0.621354013048407, 'auprc': 0.8889885292272679, 'loss_val': 1.2388139289359406, 'psi': 0.7284078195199514}-{'f1_val': 0.563968322325965, 'auprc': 0.7270075997474154, 'loss_val': 1.5015512095975252, 'psi': 0.6291840332945452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=46 head_norm_before_train=1.623477 cos_to_last_merge=0.7183 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.718
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6697218158868248, 'auprc': 0.777853489081113, 'loss_val': 0.7958621154513948, 'psi': 0.7129744851645401}-{'f1_val': 0.706508040663873, 'auprc': 0.7865680207207548, 'loss_val': 0.6775062386937917, 'psi': 0.7385320326866257}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.702626 cos_to_last_merge=0.9556 (last merge round=26)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9968693311941588, 'loss_val': 0.026323232137718415, 'psi': 0.9974166303046221}-{'f1_val': 0.9973696976584205, 'auprc': 0.998537481321274, 'loss_val': 0.02527225191650246, 'psi': 0.9978368111235618}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.374278 cos_to_last_merge=0.9701 (last merge round=25)
[S4] round=46 local utility u=0.061418 metrics={'f1_val': 0.9452335459528115, 'auprc': 0.9608257952574484, 'loss_val': 0.27151867293204085, 'psi': 0.9514704456746662}-{'f1_val': 0.940113470060939, 'auprc': 0.9350270893646169, 'loss_val': 0.28623834946374543, 'psi': 0.9380789177824103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=46 head_norm_before_train=1.800917 (no previous merge yet)
[S5] round=46 local utility u=0.932722 metrics={'f1_val': 0.9962736082987201, 'auprc': 0.9928655566076001, 'loss_val': 0.10666042396741059, 'psi': 0.994910387622272}-{'f1_val': 0.7007406076076139, 'auprc': 0.9881878467683435, 'loss_val': 0.1848732688045172, 'psi': 0.8157195032719058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=46 head_norm_before_train=1.436915 cos_to_last_merge=0.9249 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.925
[S6] round=46 local utility u=0.252792 metrics={'f1_val': 0.8422568720947176, 'auprc': 0.9621254051056534, 'loss_val': 0.3050513544226186, 'psi': 0.8902042852990919}-{'f1_val': 0.7889627278463197, 'auprc': 0.9585684953913564, 'loss_val': 0.4801991743845986, 'psi': 0.8568050348643343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S6] sending update (kind=head size=1789 to 1 peers)
[S7] START round=46 head_norm_before_train=1.474546 cos_to_last_merge=0.9699 (last merge round=21)
[S7] round=46 local utility u=0.781318 metrics={'f1_val': 0.6371825367389714, 'auprc': 0.802045549650352, 'loss_val': 0.5123661905296714, 'psi': 0.7031277419035236}-{'f1_val': 0.46414818106429095, 'auprc': 0.7803501557024377, 'loss_val': 0.9717098845185522, 'psi': 0.5906289709195497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=46 head_norm_before_train=2.118622 cos_to_last_merge=0.9969 (last merge round=24)
[S8] round=46 local utility u=0.017625 metrics={'f1_val': 0.9919528555747477, 'auprc': 0.9989506178881786, 'loss_val': 0.034546840446070974, 'psi': 0.99475196050012}-{'f1_val': 0.9920165236861632, 'auprc': 0.9898322292727507, 'loss_val': 0.042823149615441876, 'psi': 0.9911428059207982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=46 head_norm_before_train=2.125554 cos_to_last_merge=0.9758 (last merge round=19)
[S9] round=46 local utility u=0.004031 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984603211242803, 'loss_val': 0.02185253907306306, 'psi': 0.997380435538047}-{'f1_val': 0.9954158325366191, 'auprc': 0.998407721529089, 'loss_val': 0.02228888016549799, 'psi': 0.9966125881336071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=46 head_norm_before_train=2.076205 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9540827439185022, 'auprc': 0.9928945900141206, 'loss_val': 0.11193363183536287, 'psi': 0.9696074823567495}-{'f1_val': 0.9947757294679969, 'auprc': 0.9966346274731125, 'loss_val': 0.0327272506207942, 'psi': 0.9955192886700431}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=2.127146 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9946901021354234, 'auprc': 0.9966395171243385, 'loss_val': 0.027729158973285532, 'psi': 0.9954698681309895}-{'f1_val': 0.9961336749133093, 'auprc': 0.9967320176241166, 'loss_val': 0.021644294190644616, 'psi': 0.9963730119976322}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.756986 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.5575523250071271, 'auprc': 0.7220150020316193, 'loss_val': 1.114198884608825, 'psi': 0.6233373958169239}-{'f1_val': 0.6048713022155855, 'auprc': 0.726071420038949, 'loss_val': 0.6043874454685101, 'psi': 0.6533513493449309}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.877614 cos_to_last_merge=0.7638 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.764
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9953068805778554, 'auprc': 0.9986669257964733, 'loss_val': 0.034774400723954026, 'psi': 0.9966508986653025}-{'f1_val': 0.997476613247938, 'auprc': 0.9990448575270484, 'loss_val': 0.020952330043526653, 'psi': 0.9981039109595822}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.703603 cos_to_last_merge=0.9468 (last merge round=24)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=46 local utility u=1.000000 metrics={'f1_val': 0.9899908357407298, 'auprc': 0.9802365098098315, 'loss_val': 0.06078629183010433, 'psi': 0.9860891053683705}-{'f1_val': 0.6942385983318304, 'auprc': 0.7195320925175015, 'loss_val': 0.6778912455140462, 'psi': 0.7043559960060989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=46 head_norm_before_train=1.601367 cos_to_last_merge=0.9613 (last merge round=26)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9317084584860622, 'auprc': 0.9923347237346076, 'loss_val': 0.354937831435234, 'psi': 0.9559589645854805}-{'f1_val': 0.9915786080030298, 'auprc': 0.9947580639643236, 'loss_val': 0.04456917477216809, 'psi': 0.9928503903875474}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=2.096931 (no previous merge yet)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.5994032611800514, 'auprc': 0.9113179791666235, 'loss_val': 1.3655613686255992, 'psi': 0.7241691483746803}-{'f1_val': 0.621354013048407, 'auprc': 0.8889885292272679, 'loss_val': 1.2388139289359406, 'psi': 0.7284078195199514}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.634073 cos_to_last_merge=0.7172 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.717
[S2] round=47 local utility u=0.119312 metrics={'f1_val': 0.7125122750915855, 'auprc': 0.7793578686379424, 'loss_val': 0.8184941837135087, 'psi': 0.7392505125101283}-{'f1_val': 0.6697218158868248, 'auprc': 0.777853489081113, 'loss_val': 0.7958621154513948, 'psi': 0.7129744851645401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=47 head_norm_before_train=1.716293 cos_to_last_merge=0.9544 (last merge round=26)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9794915777741575, 'auprc': 0.9969946068451734, 'loss_val': 0.053788132270484075, 'psi': 0.9864927894025639}-{'f1_val': 0.9977814963782642, 'auprc': 0.9968693311941588, 'loss_val': 0.026323232137718415, 'psi': 0.9974166303046221}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.380280 cos_to_last_merge=0.9698 (last merge round=25)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9407983036881885, 'auprc': 0.9485950438405094, 'loss_val': 0.280802323791811, 'psi': 0.9439169997491168}-{'f1_val': 0.9452335459528115, 'auprc': 0.9608257952574484, 'loss_val': 0.27151867293204085, 'psi': 0.9514704456746662}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.805133 (no previous merge yet)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.5234541918765111, 'auprc': 0.8507357113764422, 'loss_val': 0.7571078662562196, 'psi': 0.6543667996764836}-{'f1_val': 0.9962736082987201, 'auprc': 0.9928655566076001, 'loss_val': 0.10666042396741059, 'psi': 0.994910387622272}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.450388 cos_to_last_merge=0.9232 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.923
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.8124820478218049, 'auprc': 0.9564750543887133, 'loss_val': 0.4545292482792119, 'psi': 0.8700792504485683}-{'f1_val': 0.8422568720947176, 'auprc': 0.9621254051056534, 'loss_val': 0.3050513544226186, 'psi': 0.8902042852990919}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.480369 cos_to_last_merge=0.9691 (last merge round=21)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6206662179012842, 'auprc': 0.7977733094853785, 'loss_val': 0.5448354737809034, 'psi': 0.6915090545349218}-{'f1_val': 0.6371825367389714, 'auprc': 0.802045549650352, 'loss_val': 0.5123661905296714, 'psi': 0.7031277419035236}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.122462 cos_to_last_merge=0.9968 (last merge round=24)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9733196850875003, 'auprc': 0.9957943220192343, 'loss_val': 0.07877392388418428, 'psi': 0.982309539860194}-{'f1_val': 0.9919528555747477, 'auprc': 0.9989506178881786, 'loss_val': 0.034546840446070974, 'psi': 0.99475196050012}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=2.130971 cos_to_last_merge=0.9754 (last merge round=19)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9952054146895505, 'loss_val': 0.021609043437875976, 'psi': 0.9960784729641551}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984603211242803, 'loss_val': 0.02185253907306306, 'psi': 0.997380435538047}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.083472 (no previous merge yet)
[S10] round=47 local utility u=0.166849 metrics={'f1_val': 0.9957210358491089, 'auprc': 0.9957216402605755, 'loss_val': 0.036547212183291884, 'psi': 0.9957212776136956}-{'f1_val': 0.9540827439185022, 'auprc': 0.9928945900141206, 'loss_val': 0.11193363183536287, 'psi': 0.9696074823567495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=47 head_norm_before_train=2.135890 (no previous merge yet)
[S11] round=47 local utility u=0.006893 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.996730804064242, 'loss_val': 0.022878189961596313, 'psi': 0.9963725265736824}-{'f1_val': 0.9946901021354234, 'auprc': 0.9966395171243385, 'loss_val': 0.027729158973285532, 'psi': 0.9954698681309895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=47 head_norm_before_train=1.762143 (no previous merge yet)
[S13] round=47 local utility u=0.123927 metrics={'f1_val': 0.566479388443627, 'auprc': 0.7804634307296925, 'loss_val': 1.0952528473663816, 'psi': 0.6520730053580532}-{'f1_val': 0.5575523250071271, 'auprc': 0.7220150020316193, 'loss_val': 1.114198884608825, 'psi': 0.6233373958169239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=47 head_norm_before_train=1.880643 cos_to_last_merge=0.7632 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.763
[S14] round=47 local utility u=0.016704 metrics={'f1_val': 0.9983073289132482, 'auprc': 0.999047452604246, 'loss_val': 0.020511157297056853, 'psi': 0.9986033783896473}-{'f1_val': 0.9953068805778554, 'auprc': 0.9986669257964733, 'loss_val': 0.034774400723954026, 'psi': 0.9966508986653025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=47 head_norm_before_train=1.708416 cos_to_last_merge=0.9470 (last merge round=24)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.9024720164755358, 'auprc': 0.9899272272126095, 'loss_val': 0.1514338290395305, 'psi': 0.9374541007703652}-{'f1_val': 0.9899908357407298, 'auprc': 0.9802365098098315, 'loss_val': 0.06078629183010433, 'psi': 0.9860891053683705}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.611488 cos_to_last_merge=0.9604 (last merge round=26)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.8353265342102411, 'auprc': 0.9181646868972644, 'loss_val': 1.0280690103154733, 'psi': 0.8684617952850504}-{'f1_val': 0.9317084584860622, 'auprc': 0.9923347237346076, 'loss_val': 0.354937831435234, 'psi': 0.9559589645854805}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=2.101988 (no previous merge yet)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5872814842191403, 'auprc': 0.9080039774819674, 'loss_val': 1.4108070288080428, 'psi': 0.7155704815242712}-{'f1_val': 0.5994032611800514, 'auprc': 0.9113179791666235, 'loss_val': 1.3655613686255992, 'psi': 0.7241691483746803}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.643826 cos_to_last_merge=0.7162 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.716
[S2] round=48 local utility u=0.058864 metrics={'f1_val': 0.7126720328924921, 'auprc': 0.8015141613596808, 'loss_val': 0.7681941726054364, 'psi': 0.7482088842793676}-{'f1_val': 0.7125122750915855, 'auprc': 0.7793578686379424, 'loss_val': 0.8184941837135087, 'psi': 0.7392505125101283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=48 head_norm_before_train=1.727996 cos_to_last_merge=0.9534 (last merge round=26)
[S3] round=48 local utility u=0.068460 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9967921199046021, 'loss_val': 0.02352864434088596, 'psi': 0.9971386665568931}-{'f1_val': 0.9794915777741575, 'auprc': 0.9969946068451734, 'loss_val': 0.053788132270484075, 'psi': 0.9864927894025639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=48 head_norm_before_train=1.385019 cos_to_last_merge=0.9696 (last merge round=25)
[S4] round=48 local utility u=0.068521 metrics={'f1_val': 0.9453955850119519, 'auprc': 0.9813876646707512, 'loss_val': 0.26972231206121233, 'psi': 0.9597924168754717}-{'f1_val': 0.9407983036881885, 'auprc': 0.9485950438405094, 'loss_val': 0.280802323791811, 'psi': 0.9439169997491168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] sending update (kind=head size=1807 to 1 peers)
[S5] START round=48 head_norm_before_train=1.805671 (no previous merge yet)
[S5] round=48 local utility u=0.992094 metrics={'f1_val': 0.7019308194147154, 'auprc': 0.9834769188591981, 'loss_val': 0.2420041203783905, 'psi': 0.8145492591925084}-{'f1_val': 0.5234541918765111, 'auprc': 0.8507357113764422, 'loss_val': 0.7571078662562196, 'psi': 0.6543667996764836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=48 head_norm_before_train=1.463745 cos_to_last_merge=0.9214 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.921
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.6136305497891497, 'auprc': 0.8809144548126345, 'loss_val': 0.8016821524190708, 'psi': 0.7205441117985436}-{'f1_val': 0.8124820478218049, 'auprc': 0.9564750543887133, 'loss_val': 0.4545292482792119, 'psi': 0.8700792504485683}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.487534 cos_to_last_merge=0.9681 (last merge round=21)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.59791072431389, 'auprc': 0.7938975435444402, 'loss_val': 0.6405170032273707, 'psi': 0.67630545200611}-{'f1_val': 0.6206662179012842, 'auprc': 0.7977733094853785, 'loss_val': 0.5448354737809034, 'psi': 0.6915090545349218}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.125949 cos_to_last_merge=0.9967 (last merge round=24)
[S8] round=48 local utility u=0.086376 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9984066876650094, 'loss_val': 0.03155888894016024, 'psi': 0.9951243844310979}-{'f1_val': 0.9733196850875003, 'auprc': 0.9957943220192343, 'loss_val': 0.07877392388418428, 'psi': 0.982309539860194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=48 head_norm_before_train=2.136779 cos_to_last_merge=0.9749 (last merge round=19)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.99844278579098, 'loss_val': 0.024589984404699304, 'psi': 0.9966236070695289}-{'f1_val': 0.9966605118138915, 'auprc': 0.9952054146895505, 'loss_val': 0.021609043437875976, 'psi': 0.9960784729641551}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.091356 (no previous merge yet)
[S10] round=48 local utility u=0.003912 metrics={'f1_val': 0.9957210358491089, 'auprc': 0.9960171036106905, 'loss_val': 0.02961053008178198, 'psi': 0.9958394629537415}-{'f1_val': 0.9957210358491089, 'auprc': 0.9957216402605755, 'loss_val': 0.036547212183291884, 'psi': 0.9957212776136956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=48 head_norm_before_train=2.144282 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9966495511053602, 'loss_val': 0.04166802158993143, 'psi': 0.9964452712123653}-{'f1_val': 0.9961336749133093, 'auprc': 0.996730804064242, 'loss_val': 0.022878189961596313, 'psi': 0.9963725265736824}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.765938 (no previous merge yet)
[S13] round=48 local utility u=0.169664 metrics={'f1_val': 0.6298175138355167, 'auprc': 0.6352971897080655, 'loss_val': 0.7004546286780835, 'psi': 0.6320093841845362}-{'f1_val': 0.566479388443627, 'auprc': 0.7804634307296925, 'loss_val': 1.0952528473663816, 'psi': 0.6520730053580532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=48 head_norm_before_train=1.884536 cos_to_last_merge=0.7627 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.763
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9976971966821454, 'auprc': 0.9988579194764747, 'loss_val': 0.021445088620876192, 'psi': 0.9981614857998771}-{'f1_val': 0.9983073289132482, 'auprc': 0.999047452604246, 'loss_val': 0.020511157297056853, 'psi': 0.9986033783896473}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.714548 cos_to_last_merge=0.9471 (last merge round=24)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.7961645624082561, 'auprc': 0.9897658116006948, 'loss_val': 0.3728459832185173, 'psi': 0.8736050620852316}-{'f1_val': 0.9024720164755358, 'auprc': 0.9899272272126095, 'loss_val': 0.1514338290395305, 'psi': 0.9374541007703652}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.619509 cos_to_last_merge=0.9597 (last merge round=26)
[S16] round=48 local utility u=0.746598 metrics={'f1_val': 0.9312966161522533, 'auprc': 0.9969164362714394, 'loss_val': 0.34694802230388083, 'psi': 0.9575445441999277}-{'f1_val': 0.8353265342102411, 'auprc': 0.9181646868972644, 'loss_val': 1.0280690103154733, 'psi': 0.8684617952850504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=48 head_norm_before_train=2.107500 (no previous merge yet)
[S17] round=48 local utility u=1.000000 metrics={'f1_val': 0.7628722187874117, 'auprc': 0.9982820597496186, 'loss_val': 0.627363792782509, 'psi': 0.8570361551722945}-{'f1_val': 0.5872814842191403, 'auprc': 0.9080039774819674, 'loss_val': 1.4108070288080428, 'psi': 0.7155704815242712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=49 head_norm_before_train=1.653462 cos_to_last_merge=0.7152 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.715
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.7131486299979353, 'auprc': 0.8006745104644518, 'loss_val': 0.8341893150073613, 'psi': 0.7481589821845419}-{'f1_val': 0.7126720328924921, 'auprc': 0.8015141613596808, 'loss_val': 0.7681941726054364, 'psi': 0.7482088842793676}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.740239 cos_to_last_merge=0.9523 (last merge round=26)
[S3] round=49 local utility u=0.002074 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9968518233447095, 'loss_val': 0.02203059609557444, 'psi': 0.9974096271648423}-{'f1_val': 0.9973696976584205, 'auprc': 0.9967921199046021, 'loss_val': 0.02352864434088596, 'psi': 0.9971386665568931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=49 head_norm_before_train=1.390644 cos_to_last_merge=0.9692 (last merge round=25)
[S4] round=49 local utility u=0.001004 metrics={'f1_val': 0.9523081012709864, 'auprc': 0.9677147747729717, 'loss_val': 0.26817169431268617, 'psi': 0.9584707706717805}-{'f1_val': 0.9453955850119519, 'auprc': 0.9813876646707512, 'loss_val': 0.26972231206121233, 'psi': 0.9597924168754717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=49 head_norm_before_train=1.805775 (no previous merge yet)
[S5] round=49 local utility u=0.789321 metrics={'f1_val': 0.9405318565205019, 'auprc': 0.9920720649856654, 'loss_val': 0.1207529339790462, 'psi': 0.9611479399065672}-{'f1_val': 0.7019308194147154, 'auprc': 0.9834769188591981, 'loss_val': 0.2420041203783905, 'psi': 0.8145492591925084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=49 head_norm_before_train=1.475170 cos_to_last_merge=0.9195 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.919
[S6] round=49 local utility u=0.876658 metrics={'f1_val': 0.8089403180823265, 'auprc': 0.9593210963049366, 'loss_val': 0.4554439391709559, 'psi': 0.8690926293713706}-{'f1_val': 0.6136305497891497, 'auprc': 0.8809144548126345, 'loss_val': 0.8016821524190708, 'psi': 0.7205441117985436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=49 head_norm_before_train=1.494586 cos_to_last_merge=0.9670 (last merge round=21)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.539034531922971, 'auprc': 0.785365238130528, 'loss_val': 0.8498099843035801, 'psi': 0.6375668144059938}-{'f1_val': 0.59791072431389, 'auprc': 0.7938975435444402, 'loss_val': 0.6405170032273707, 'psi': 0.67630545200611}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=2.132248 cos_to_last_merge=0.9965 (last merge round=24)
[S8] round=49 local utility u=0.005882 metrics={'f1_val': 0.9941380936044745, 'auprc': 0.9986488845167341, 'loss_val': 0.027733114354643082, 'psi': 0.9959424099693783}-{'f1_val': 0.9929361822751569, 'auprc': 0.9984066876650094, 'loss_val': 0.03155888894016024, 'psi': 0.9951243844310979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=49 head_norm_before_train=2.142082 cos_to_last_merge=0.9746 (last merge round=19)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.99842439525841, 'loss_val': 0.02540249144269193, 'psi': 0.9958658181270379}-{'f1_val': 0.9954108212552283, 'auprc': 0.99844278579098, 'loss_val': 0.024589984404699304, 'psi': 0.9966236070695289}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.096026 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9948008231115103, 'auprc': 0.9960753332117511, 'loss_val': 0.028825886373129928, 'psi': 0.9953106271516066}-{'f1_val': 0.9957210358491089, 'auprc': 0.9960171036106905, 'loss_val': 0.02961053008178198, 'psi': 0.9958394629537415}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.152574 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9657129603138231, 'auprc': 0.9979367608590874, 'loss_val': 0.08902250382259148, 'psi': 0.9786024805319289}-{'f1_val': 0.9963090846170353, 'auprc': 0.9966495511053602, 'loss_val': 0.04166802158993143, 'psi': 0.9964452712123653}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.770437 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5767892547119138, 'auprc': 0.6059896078521223, 'loss_val': 1.027624580134568, 'psi': 0.5884693959679972}-{'f1_val': 0.6298175138355167, 'auprc': 0.6352971897080655, 'loss_val': 0.7004546286780835, 'psi': 0.6320093841845362}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.890920 cos_to_last_merge=0.7620 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.762
[S14] round=49 local utility u=0.000713 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9990178216874758, 'loss_val': 0.020239459942501595, 'psi': 0.9981994343645639}-{'f1_val': 0.9976971966821454, 'auprc': 0.9988579194764747, 'loss_val': 0.021445088620876192, 'psi': 0.9981614857998771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=49 head_norm_before_train=1.723174 cos_to_last_merge=0.9467 (last merge round=24)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.7842253043153945, 'auprc': 0.9904083712545151, 'loss_val': 0.40277501933183946, 'psi': 0.8666985310910427}-{'f1_val': 0.7961645624082561, 'auprc': 0.9897658116006948, 'loss_val': 0.3728459832185173, 'psi': 0.8736050620852316}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.627244 cos_to_last_merge=0.9590 (last merge round=26)
[S16] round=49 local utility u=0.131167 metrics={'f1_val': 0.9444407999613693, 'auprc': 0.99470236281504, 'loss_val': 0.15683657770019935, 'psi': 0.9645454251028376}-{'f1_val': 0.9312966161522533, 'auprc': 0.9969164362714394, 'loss_val': 0.34694802230388083, 'psi': 0.9575445441999277}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=49 head_norm_before_train=2.111464 (no previous merge yet)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.5652739895372312, 'auprc': 0.7267814187124764, 'loss_val': 1.5249311438402076, 'psi': 0.6298769612073293}-{'f1_val': 0.7628722187874117, 'auprc': 0.9982820597496186, 'loss_val': 0.627363792782509, 'psi': 0.8570361551722945}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
