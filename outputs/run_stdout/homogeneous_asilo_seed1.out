[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:36603
[S3] → join 127.0.0.1:36602
[S4] → join 127.0.0.1:36602
[S5] → join 127.0.0.1:36602
[S6] → join 127.0.0.1:36602
[S7] → join 127.0.0.1:36602
[S8] → join 127.0.0.1:36602
[S9] → join 127.0.0.1:36602
[S10] → join 127.0.0.1:36602
[S11] → join 127.0.0.1:36602
[S13] → join 127.0.0.1:36602
[S14] → join 127.0.0.1:36602
[S15] → join 127.0.0.1:36602
[S16] → join 127.0.0.1:36602
[S17] → join 127.0.0.1:36602
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.167627 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.221725 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.169750 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.186673 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.191190 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.159581 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.238387 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.173564 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.170865 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.198346 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.172358 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.116953 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.153703 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.189580 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.134170 (no previous merge yet)
[S9]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3] + discovered S11
[S3] + discovered S17
[S3] + discovered S6
[S3] + discovered S16
[S3] + discovered S5
[S3] + discovered S14
[S3] + discovered S13
[S3] + discovered S9
[S3] + discovered S15
[S3] + discovered S10
[S3] + discovered S4
[S3] + discovered S7
[S4] + discovered S2
[S3] + discovered S8
[S4] + discovered S3
[S4] + discovered S6
[S4] + discovered S16
[S4] + discovered S9
[S4] + discovered S7
[S4] + discovered S17
[S4] + discovered S13
[S5] + discovered S2
[S4] + discovered S11
[S4] + discovered S14
[S4] + discovered S10
[S4] + discovered S15
[S5] + discovered S4
[S4] + discovered S5
[S5] + discovered S3
[S4] + discovered S8
[S5] + discovered S13
[S5] + discovered S6
[S6] + discovered S3
[S5] + discovered S7
[S5] + discovered S15
[S6] + discovered S5
[S5] + discovered S17
[S5] + discovered S10
[S6] + discovered S2
[S5] + discovered S8
[S5] + discovered S9
[S5] + discovered S16
[S5] + discovered S11
[S6] + discovered S4
[S5] + discovered S14
[S7] + discovered S6
[S6] + discovered S9
[S6] + discovered S16
[S7] + discovered S4
[S7] + discovered S5
[S6] + discovered S7
[S6] + discovered S17
[S6] + discovered S15
[S6] + discovered S13
[S6] + discovered S14
[S7] + discovered S2
[S7] + discovered S3
[S6] + discovered S8
[S6] + discovered S10
[S6] + discovered S11
[S8] + discovered S7
[S8] + discovered S6
[S7] + discovered S8
[S8] + discovered S2
[S7] + discovered S15
[S8] + discovered S5
[S8] + discovered S4
[S8] + discovered S3
[S7] + discovered S14
[S7] + discovered S16
[S7] + discovered S11
[S7] + discovered S17
[S7] + discovered S10
[S7] + discovered S9
[S7] + discovered S13
[S8] + discovered S16
[S9] + discovered S6
[S9] + discovered S4
[S8] + discovered S14
[S8] + discovered S9
[S8] + discovered S15
[S9] + discovered S2
[S9] + discovered S7
[S8] + discovered S13
[S8] + discovered S11
[S8] + discovered S17
[S9] + discovered S5
[S9] + discovered S3
[S8] + discovered S10
[S9] + discovered S8
[S10] + discovered S3
[S10] + discovered S2
[S10] + discovered S5
[S9] + discovered S16
[S10] + discovered S4
[S9] + discovered S11
[S10] + discovered S7
[S10] + discovered S9
[S9] + discovered S10
[S10] + discovered S6
[S10] + discovered S8
[S9] + discovered S14
[S9] + discovered S15
[S9] + discovered S13
[S9] + discovered S17
[S11] + discovered S3
[S10] + discovered S17
[S10] + discovered S11
[S10] + discovered S14
[S10] + discovered S13
[S10] + discovered S15
[S11] + discovered S8
[S11] + discovered S4
[S11] + discovered S10
[S11] + discovered S6
[S11] + discovered S7
[S10] + discovered S16
[S11] + discovered S5
[S11] + discovered S2
[S11] + discovered S9
[S13] + discovered S8
[S13] + discovered S6
[S11] + discovered S17
[S11] + discovered S14
[S11] + discovered S13
[S13] + discovered S3
[S11] + discovered S15
[S13] + discovered S11
[S11] + discovered S16
[S13] + discovered S10
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S5
[S13] + discovered S2
[S13] + discovered S9
[S14] + discovered S3
[S14] + discovered S9
[S14] + discovered S13
[S14] + discovered S10
[S14] + discovered S11
[S13] + discovered S14
[S14] + discovered S5
[S14] + discovered S6
[S13] + discovered S17
[S13] + discovered S16
[S13] + discovered S15
[S14] + discovered S7
[S14] + discovered S4
[S14] + discovered S8
[S14] + discovered S2
[S15] + discovered S10
[S15] + discovered S14
[S15] + discovered S9
[S15] + discovered S3
[S15] + discovered S7
[S15] + discovered S6
[S15] + discovered S5
[S15] + discovered S11
[S14] + discovered S17
[S15] + discovered S4
[S15] + discovered S2
[S15] + discovered S8
[S14] + discovered S15
[S14] + discovered S16
[S15] + discovered S13
[S16] + discovered S10
[S16] + discovered S11
[S16] + discovered S13
[S16] + discovered S7
[S16] + discovered S3
[S16] + discovered S2
[S16] + discovered S4
[S16] + discovered S15
[S15] + discovered S16
[S16] + discovered S8
[S16] + discovered S14
[S16] + discovered S9
[S16] + discovered S5
[S15] + discovered S17
[S16] + discovered S6
[S17] + discovered S13
[S17] + discovered S10
[S17] + discovered S16
[S17] + discovered S4
[S17] + discovered S2
[S17] + discovered S5
[S17] + discovered S9
[S17] + discovered S8
[S17] + discovered S6
[S17] + discovered S7
[S17] + discovered S3
[S16] + discovered S17
[S17] + discovered S14
[S17] + discovered S15
[S17] + discovered S11
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=1.000 → S16@127.0.0.1:36616
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:36608
[S9] ⇄ pheromone p=1.000 → S5@127.0.0.1:36605
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:36608
[S8] ⇄ pheromone p=1.000 → S9@127.0.0.1:36610
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:36608
[S2] ⇄ pheromone p=1.000 → S4@127.0.0.1:36604
[S11] ⇄ pheromone p=1.000 → S2@127.0.0.1:36602
[S5] ⇄ pheromone p=1.000 → S7@127.0.0.1:36608
[S15] ⇄ pheromone p=1.000 → S4@127.0.0.1:36604
[S6] ⇄ pheromone p=1.000 → S4@127.0.0.1:36604
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:36607
[S10] ⇄ pheromone p=1.000 → S6@127.0.0.1:36607
[S7] ⇄ pheromone p=1.000 → S6@127.0.0.1:36607
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:36613
[S2] START round=1 head_norm_before_train=1.174839 (no previous merge yet)
[S2] round=1 local utility u=0.336370 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.5541599853542167, 'loss_val': 1.3204534496027307, 'psi': 0.30673027417482673}-{'f1_val': 0.10722637979420019, 'auprc': 0.4133041346607265, 'loss_val': 1.3633223709203992, 'psi': 0.22965748174081074}
[S3] START round=1 head_norm_before_train=1.227261 (no previous merge yet)
[S3] round=1 local utility u=0.912727 metrics={'f1_val': 0.40075722217588916, 'auprc': 0.7863363748004907, 'loss_val': 1.3372148786362157, 'psi': 0.5549888832257298}-{'f1_val': 0.10474797479747974, 'auprc': 0.7810519673674723, 'loss_val': 1.3707608783826255, 'psi': 0.37526957182547677}
[S4] START round=1 head_norm_before_train=1.174805 (no previous merge yet)
[S4] round=1 local utility u=0.934922 metrics={'f1_val': 0.4031868740932959, 'auprc': 0.7668372739351315, 'loss_val': 1.305466547053771, 'psi': 0.5486470340300301}-{'f1_val': 0.10637591321673677, 'auprc': 0.7492398454817653, 'loss_val': 1.3416519882677753, 'psi': 0.36352148612274815}
[S5] START round=1 head_norm_before_train=1.187652 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.16172419429131812, 'auprc': 0.7297012197988023, 'loss_val': 1.3455781118173256, 'psi': 0.3889150044943118}-{'f1_val': 0.36274324937914604, 'auprc': 0.7281569232554559, 'loss_val': 1.3767928400561205, 'psi': 0.5089087189296699}
[S6] START round=1 head_norm_before_train=1.189194 (no previous merge yet)
[S6] round=1 local utility u=0.305671 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6586624812317232, 'loss_val': 1.3215256123609525, 'psi': 0.3483207617234585}-{'f1_val': 0.14142628205128205, 'auprc': 0.4676937196927788, 'loss_val': 1.359962226397128, 'psi': 0.27193325710788074}
[S7] START round=1 head_norm_before_train=1.163037 (no previous merge yet)
[S7] round=1 local utility u=0.033373 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.663779595493553, 'loss_val': 1.3391448855679893, 'psi': 0.35074593183487623}-{'f1_val': 0.14205682272909165, 'auprc': 0.6496688359767366, 'loss_val': 1.3635589718831187, 'psi': 0.34510162802814964}
[S8] START round=1 head_norm_before_train=1.245518 (no previous merge yet)
[S8] round=1 local utility u=0.582638 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7465862670873595, 'loss_val': 1.3056225370468513, 'psi': 0.3826080962707181}-{'f1_val': 0.13995598239295717, 'auprc': 0.3701331363148118, 'loss_val': 1.3415396616449686, 'psi': 0.23202684396169904}
[S9] START round=1 head_norm_before_train=1.187142 (no previous merge yet)
[S9] round=1 local utility u=0.390767 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8544937440418526, 'loss_val': 1.290369328793939, 'psi': 0.42663627190073866}-{'f1_val': 0.141397957139996, 'auprc': 0.6087259787303265, 'loss_val': 1.3345999828080548, 'psi': 0.3283291657761282}
[S10] START round=1 head_norm_before_train=1.178618 (no previous merge yet)
[S10] round=1 local utility u=0.852881 metrics={'f1_val': 0.38841098161462606, 'auprc': 0.5842037536048058, 'loss_val': 1.3472050780401765, 'psi': 0.46672809041069796}-{'f1_val': 0.1105757037788486, 'auprc': 0.5818789248423452, 'loss_val': 1.3789814317620748, 'psi': 0.29909699220424724}
[S11] START round=1 head_norm_before_train=1.206224 (no previous merge yet)
[S11] round=1 local utility u=0.182745 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.604636017101206, 'loss_val': 1.3366197813159375, 'psi': 0.3261026168643487}-{'f1_val': 0.14041368337311058, 'auprc': 0.4937359520159357, 'loss_val': 1.3694097677848966, 'psi': 0.2817425908302406}
[S13] START round=1 head_norm_before_train=1.174421 (no previous merge yet)
[S13] round=1 local utility u=0.019116 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7661123680196543, 'loss_val': 1.307859007417752, 'psi': 0.3906764047540936}-{'f1_val': 0.1403857625770531, 'auprc': 0.7639398819834788, 'loss_val': 1.3395743641417601, 'psi': 0.3898074103396234}
[S14] START round=1 head_norm_before_train=1.116644 (no previous merge yet)
[S14] round=1 local utility u=1.000000 metrics={'f1_val': 0.4225977646421104, 'auprc': 0.9221441718668733, 'loss_val': 1.3469404295295067, 'psi': 0.6224163275320156}-{'f1_val': 0.1038107752956636, 'auprc': 0.6295999148816841, 'loss_val': 1.3747638634219732, 'psi': 0.3141264311300718}
[S15] START round=1 head_norm_before_train=1.158008 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7661419621325503, 'loss_val': 1.3230532383924598, 'psi': 0.39029697566995514}-{'f1_val': 0.2984550419895, 'auprc': 0.7165386292020793, 'loss_val': 1.3508584351986592, 'psi': 0.46568847687453174}
[S16] START round=1 head_norm_before_train=1.189929 (no previous merge yet)
[S16] round=1 local utility u=0.603450 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7848321077971389, 'loss_val': 1.3193093904484081, 'psi': 0.39831531323837743}-{'f1_val': 0.14063745019920318, 'auprc': 0.3902885761599401, 'loss_val': 1.3425790965262965, 'psi': 0.24049790058349796}
[S17] START round=1 head_norm_before_train=1.138705 (no previous merge yet)
[S17] round=1 local utility u=0.201631 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8190043705798912, 'loss_val': 1.3217803780560307, 'psi': 0.4121711262223871}-{'f1_val': 0.14094896331738438, 'auprc': 0.6939520412403218, 'loss_val': 1.3498849235087607, 'psi': 0.3621501944865594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:36613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S10] → sending delta(kind=head bytes=1786) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S13] → sending delta(kind=head bytes=1786) to S14@127.0.0.1:36614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:36614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:36616
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S4] → sending delta(kind=head bytes=1785) to S3@127.0.0.1:36603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S10@127.0.0.1:36611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:36614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:36604
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S14] → sending delta(kind=head bytes=1788) to S15@127.0.0.1:36615
[S14] sending update (kind=head size=1788 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1786 to 1 peers)
[S10] sending update (kind=head size=1786 to 1 peers)
[S11] sending update (kind=head size=1788 to 1 peers)
[S4] sending update (kind=head size=1785 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S3
[S6] cosine check vs S3: cos=0.0396
[S3] RECEIVED delta(kind=head bytes=1785) from S4
[S3] cosine check vs S4: cos=-0.0295
[S3] DROPPED delta from S4 (cos=-0.0295 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1788) from S11
[S13] cosine check vs S11: cos=-0.0487
[S13] DROPPED delta from S11 (cos=-0.0487 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1786) from S10
[S2] cosine check vs S10: cos=0.0229
[S10] RECEIVED delta(kind=head bytes=1788) from S16
[S10] cosine check vs S16: cos=-0.0002
[S10] DROPPED delta from S16 (cos=-0.0002 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1790) from S6
[S14] cosine check vs S6: cos=-0.0752
[S14] DROPPED delta from S6 (cos=-0.0752 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S8
[S14] cosine check vs S8: cos=-0.1608
[S14] DROPPED delta from S8 (cos=-0.1608 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1786) from S13
[S14] cosine check vs S13: cos=0.0591
[S6] RECEIVED delta(kind=head bytes=1792) from S9
[S6] cosine check vs S9: cos=-0.0843
[S6] DROPPED delta from S9 (cos=-0.0843 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1790) from S7
[S16] cosine check vs S7: cos=-0.0254
[S16] DROPPED delta from S7 (cos=-0.0254 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1788) from S14
[S15] cosine check vs S14: cos=0.0156
[S4] RECEIVED delta(kind=head bytes=1797) from S2
[S4] cosine check vs S2: cos=0.0614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S17] → sending delta(kind=head bytes=1785) to S5@127.0.0.1:36605
[S17] sending update (kind=head size=1785 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1785) from S17
[S5] cosine check vs S17: cos=0.0820
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1617 head_norm=1.196921
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.970539e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.865267 delta_norm=0.797054
[S5] aggregate: ROLLBACK (f1_val pre=0.162 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.200063
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.466623e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.3944 head_norm=0.880831 delta_norm=0.846662
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.191066
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.354475e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.854804 delta_norm=0.835447
[S2] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.4032 head_norm=1.191135
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.159757e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1064 head_norm=0.867700 delta_norm=0.815976
[S4] aggregate: ROLLBACK (f1_val pre=0.403 post=0.106 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.4226 head_norm=1.126974
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.941470e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.1038 head_norm=0.842472 delta_norm=0.794147
[S14] aggregate: ROLLBACK (f1_val pre=0.423 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.173827
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.072491e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.819951 delta_norm=0.807249
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.854804 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.032142 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.5728998330214519, 'loss_val': 1.3123896846794392, 'psi': 0.3142262132417208}-{'f1_val': 0.1417771333885667, 'auprc': 0.5541599853542167, 'loss_val': 1.3204534496027307, 'psi': 0.30673027417482673}
[S3] START round=2 head_norm_before_train=1.243080 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9507425873826545, 'loss_val': 1.2941229693411704, 'psi': 0.464201074321526}-{'f1_val': 0.40075722217588916, 'auprc': 0.7863363748004907, 'loss_val': 1.3372148786362157, 'psi': 0.5549888832257298}
[S4] START round=2 head_norm_before_train=0.867700 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.3946243683651032, 'auprc': 0.7733209645550745, 'loss_val': 1.3293755561615994, 'psi': 0.5461030068410917}-{'f1_val': 0.4031868740932959, 'auprc': 0.7668372739351315, 'loss_val': 1.305466547053771, 'psi': 0.5486470340300301}
[S5] START round=2 head_norm_before_train=0.865267 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7294884080905518, 'loss_val': 1.334880324814018, 'psi': 0.3771525060933636}-{'f1_val': 0.16172419429131812, 'auprc': 0.7297012197988023, 'loss_val': 1.3455781118173256, 'psi': 0.3889150044943118}
[S6] START round=2 head_norm_before_train=0.880831 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6459567204764539, 'loss_val': 1.3258107832535355, 'psi': 0.3432384574213508}-{'f1_val': 0.14142628205128205, 'auprc': 0.6586624812317232, 'loss_val': 1.3215256123609525, 'psi': 0.3483207617234585}
[S7] START round=2 head_norm_before_train=1.173423 (no previous merge yet)
[S7] round=2 local utility u=0.025788 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6721769249774014, 'loss_val': 1.3127611186805153, 'psi': 0.3541048636284156}-{'f1_val': 0.14205682272909165, 'auprc': 0.663779595493553, 'loss_val': 1.3391448855679893, 'psi': 0.35074593183487623}
[S8] START round=2 head_norm_before_train=1.263791 (no previous merge yet)
[S8] round=2 local utility u=0.032264 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7550547095849871, 'loss_val': 1.2664991904453846, 'psi': 0.3859954732697692}-{'f1_val': 0.13995598239295717, 'auprc': 0.7465862670873595, 'loss_val': 1.3056225370468513, 'psi': 0.3826080962707181}
[S9] START round=2 head_norm_before_train=1.212772 (no previous merge yet)
[S9] round=2 local utility u=0.048175 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659134073375638, 'loss_val': 1.228278027905854, 'psi': 0.4312041372190232}-{'f1_val': 0.141397957139996, 'auprc': 0.8544937440418526, 'loss_val': 1.290369328793939, 'psi': 0.42663627190073866}
[S10] START round=2 head_norm_before_train=1.199453 (no previous merge yet)
[S10] round=2 local utility u=0.107041 metrics={'f1_val': 0.4163186508304395, 'auprc': 0.5868058607364091, 'loss_val': 1.3083750343268479, 'psi': 0.4845135347928273}-{'f1_val': 0.38841098161462606, 'auprc': 0.5842037536048058, 'loss_val': 1.3472050780401765, 'psi': 0.46672809041069796}
[S11] START round=2 head_norm_before_train=1.223323 (no previous merge yet)
[S11] round=2 local utility u=0.147886 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6900850487961051, 'loss_val': 1.2971952092189483, 'psi': 0.3602822295423084}-{'f1_val': 0.14041368337311058, 'auprc': 0.604636017101206, 'loss_val': 1.3366197813159375, 'psi': 0.3261026168643487}
[S13] START round=2 head_norm_before_train=1.187765 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7444750047464338, 'loss_val': 1.2724580980196676, 'psi': 0.38202145944480537}-{'f1_val': 0.1403857625770531, 'auprc': 0.7661123680196543, 'loss_val': 1.307859007417752, 'psi': 0.3906764047540936}
[S14] START round=2 head_norm_before_train=0.842472 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8722042404111414, 'loss_val': 1.335661622393578, 'psi': 0.4330964078940788}-{'f1_val': 0.4225977646421104, 'auprc': 0.9221441718668733, 'loss_val': 1.3469404295295067, 'psi': 0.6224163275320156}
[S15] START round=2 head_norm_before_train=0.819951 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.005119 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7704457249174408, 'loss_val': 1.3257259005129183, 'psi': 0.3920184807839113}-{'f1_val': 0.13973365136155833, 'auprc': 0.7661419621325503, 'loss_val': 1.3230532383924598, 'psi': 0.39029697566995514}
[S16] START round=2 head_norm_before_train=1.200342 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.761723018881041, 'loss_val': 1.295296785158206, 'psi': 0.3890716776719383}-{'f1_val': 0.14063745019920318, 'auprc': 0.7848321077971389, 'loss_val': 1.3193093904484081, 'psi': 0.39831531323837743}
[S17] START round=2 head_norm_before_train=1.155571 (no previous merge yet)
[S17] round=2 local utility u=0.032363 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8281772233088595, 'loss_val': 1.284573926442692, 'psi': 0.41584026731397444}-{'f1_val': 0.14094896331738438, 'auprc': 0.8190043705798912, 'loss_val': 1.3217803780560307, 'psi': 0.4121711262223871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:36611
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:36607
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S8] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:36602
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:36612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:36611
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1788 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1791) from S10
[S4] cosine check vs S10: cos=-0.0283
[S4] DROPPED delta from S10 (cos=-0.0283 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S15
[S11] cosine check vs S15: cos=0.0195
[S16] RECEIVED delta(kind=head bytes=1788) from S8
[S16] cosine check vs S8: cos=0.0326
[S2] RECEIVED delta(kind=head bytes=1789) from S11
[S2] cosine check vs S11: cos=0.0863
[S10] RECEIVED delta(kind=head bytes=1793) from S7
[S10] cosine check vs S7: cos=0.0843
[S10] RECEIVED delta(kind=head bytes=1792) from S9
[S10] cosine check vs S9: cos=0.1109
[S6] RECEIVED delta(kind=head bytes=1793) from S2
[S6] cosine check vs S2: cos=0.0803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:36615
[S17] sending update (kind=head size=1792 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1792) from S17
[S15] cosine check vs S17: cos=-0.0759
[S15] DROPPED delta from S17 (cos=-0.0759 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=2 metric=0.1414 head_norm=0.896688
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.011189e-01
[S6] stored merged vector for next round verification (round=2)
[S6] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.651449 delta_norm=0.601119
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=0.876019
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.312073e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.793143 delta_norm=0.731207
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.4163 head_norm=1.230109
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.040889e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.3776 head_norm=0.801615 delta_norm=0.704089
[S10] aggregate: ROLLBACK (f1_val pre=0.416 post=0.378 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1404 head_norm=1.249028
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.456886e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.759309 delta_norm=0.745689
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=1.215976
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.707131e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.899537 delta_norm=0.870713
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.793143 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.5431802530488555, 'loss_val': 1.29470839059932, 'psi': 0.30233838125268225}-{'f1_val': 0.1417771333885667, 'auprc': 0.5728998330214519, 'loss_val': 1.3123896846794392, 'psi': 0.3142262132417208}
[S3] START round=3 head_norm_before_train=1.268563 (no previous merge yet)
[S3] round=3 local utility u=0.100211 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9992320984568719, 'loss_val': 1.2391693958289467, 'psi': 0.48359687875121304}-{'f1_val': 0.13984006561410703, 'auprc': 0.9507425873826545, 'loss_val': 1.2941229693411704, 'psi': 0.464201074321526}
[S4] START round=3 head_norm_before_train=0.886033 cos_to_last_merge=0.9967 (last merge round=1)
[S4] round=3 local utility u=0.066573 metrics={'f1_val': 0.40121095540407437, 'auprc': 0.7865580222904979, 'loss_val': 1.275459878483008, 'psi': 0.5553497821586437}-{'f1_val': 0.3946243683651032, 'auprc': 0.7733209645550745, 'loss_val': 1.3293755561615994, 'psi': 0.5461030068410917}
[S5] START round=3 head_norm_before_train=0.881335 cos_to_last_merge=0.9970 (last merge round=1)
[S5] round=3 local utility u=0.018956 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7299917864318091, 'loss_val': 1.298478261891583, 'psi': 0.3773538574298665}-{'f1_val': 0.14226190476190476, 'auprc': 0.7294884080905518, 'loss_val': 1.334880324814018, 'psi': 0.3771525060933636}
[S6] START round=3 head_norm_before_train=0.651449 cos_to_last_merge=1.0000 (last merge round=2)
[S6] round=3 local utility u=0.012018 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6545254847926723, 'loss_val': 1.3274818959501555, 'psi': 0.3466659631478381}-{'f1_val': 0.14142628205128205, 'auprc': 0.6459567204764539, 'loss_val': 1.3258107832535355, 'psi': 0.3432384574213508}
[S7] START round=3 head_norm_before_train=1.189971 (no previous merge yet)
[S7] round=3 local utility u=0.055826 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.69856095846368, 'loss_val': 1.2802616257561628, 'psi': 0.36465847702292703}-{'f1_val': 0.14205682272909165, 'auprc': 0.6721769249774014, 'loss_val': 1.3127611186805153, 'psi': 0.3541048636284156}
[S8] START round=3 head_norm_before_train=1.286864 (no previous merge yet)
[S8] round=3 local utility u=0.037738 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7660889423012439, 'loss_val': 1.2241251280021967, 'psi': 0.39040916635627193}-{'f1_val': 0.13995598239295717, 'auprc': 0.7550547095849871, 'loss_val': 1.2664991904453846, 'psi': 0.3859954732697692}
[S9] START round=3 head_norm_before_train=1.248571 (no previous merge yet)
[S9] round=3 local utility u=0.041092 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8661112640053231, 'loss_val': 1.146687029934282, 'psi': 0.43128327988612686}-{'f1_val': 0.141397957139996, 'auprc': 0.8659134073375638, 'loss_val': 1.228278027905854, 'psi': 0.4312041372190232}
[S10] START round=3 head_norm_before_train=0.801615 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.41642217334168796, 'auprc': 0.5729494903840142, 'loss_val': 1.3109267721787485, 'psi': 0.47903310015861844}-{'f1_val': 0.4163186508304395, 'auprc': 0.5868058607364091, 'loss_val': 1.3083750343268479, 'psi': 0.4845135347928273}
[S11] START round=3 head_norm_before_train=0.759309 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.102103 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7581550922475497, 'loss_val': 1.297198860764439, 'psi': 0.38751024692288627}-{'f1_val': 0.14041368337311058, 'auprc': 0.6900850487961051, 'loss_val': 1.2971952092189483, 'psi': 0.3602822295423084}
[S13] START round=3 head_norm_before_train=1.210975 (no previous merge yet)
[S13] round=3 local utility u=0.000328 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7298308926247518, 'loss_val': 1.227869885832342, 'psi': 0.3761638145961326}-{'f1_val': 0.1403857625770531, 'auprc': 0.7444750047464338, 'loss_val': 1.2724580980196676, 'psi': 0.38202145944480537}
[S14] START round=3 head_norm_before_train=0.858667 cos_to_last_merge=0.9965 (last merge round=1)
[S14] round=3 local utility u=0.001207 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8616660481809788, 'loss_val': 1.3016324095326404, 'psi': 0.4288811310020138}-{'f1_val': 0.14035785288270378, 'auprc': 0.8722042404111414, 'loss_val': 1.335661622393578, 'psi': 0.4330964078940788}
[S15] START round=3 head_norm_before_train=0.839722 cos_to_last_merge=0.9966 (last merge round=1)
[S15] round=3 local utility u=0.019892 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7739743964598681, 'loss_val': 1.2965271705740937, 'psi': 0.3934299494008823}-{'f1_val': 0.13973365136155833, 'auprc': 0.7704457249174408, 'loss_val': 1.3257259005129183, 'psi': 0.3920184807839113}
[S16] START round=3 head_norm_before_train=0.899537 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7342020130121936, 'loss_val': 1.3101465398423278, 'psi': 0.3780632753243993}-{'f1_val': 0.14063745019920318, 'auprc': 0.761723018881041, 'loss_val': 1.295296785158206, 'psi': 0.3890716776719383}
[S17] START round=3 head_norm_before_train=1.181984 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.631641542360974, 'loss_val': 1.2231321488415972, 'psi': 0.33722599493482025}-{'f1_val': 0.14094896331738438, 'auprc': 0.8281772233088595, 'loss_val': 1.284573926442692, 'psi': 0.41584026731397444}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:36610
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:36607
[S13] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1792) from S8
[S9] cosine check vs S8: cos=-0.0614
[S9] DROPPED delta from S8 (cos=-0.0614 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S3
[S6] cosine check vs S3: cos=0.5330
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=-0.0262
[S5] DROPPED delta from S9 (cos=-0.0262 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S4
[S16] cosine check vs S4: cos=-0.0411
[S16] DROPPED delta from S4 (cos=-0.0411 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S5
[S7] cosine check vs S5: cos=0.0256
[S7] RECEIVED delta(kind=head bytes=1796) from S14
[S7] cosine check vs S14: cos=0.0157
[S6] RECEIVED delta(kind=head bytes=1796) from S7
[S6] cosine check vs S7: cos=-0.1022
[S6] DROPPED delta from S7 (cos=-0.1022 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1793) from S13
[S7] cosine check vs S13: cos=0.0409
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.6673
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] cosine check vs S6: cos=0.2453
[S4] RECEIVED delta(kind=head bytes=1799) from S15
[S4] cosine check vs S15: cos=-0.0488
[S4] DROPPED delta from S15 (cos=-0.0488 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=0.812887
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.268566e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1418 head_norm=0.731344 delta_norm=0.326857
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=0.666543
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.506393e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1040 head_norm=0.874896 delta_norm=0.550639
[S6] aggregate: ROLLBACK (f1_val pre=0.141 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.4012 head_norm=0.916187
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.960116e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.4838 head_norm=0.629136 delta_norm=0.496012
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=1.215412
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.120724e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.733734 delta_norm=0.712072
[S7] aggregate: ACCEPT kept=['S5', 'S14', 'S13'] (k=3/3) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.731344 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.310175 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7422642545836691, 'loss_val': 1.271611095679552, 'psi': 0.3819719818666077}-{'f1_val': 0.1417771333885667, 'auprc': 0.5431802530488555, 'loss_val': 1.29470839059932, 'psi': 0.30233838125268225}
[S3] START round=4 head_norm_before_train=1.301159 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9151268079005651, 'loss_val': 1.1858014127214547, 'psi': 0.44995476252869027}-{'f1_val': 0.13984006561410703, 'auprc': 0.9992320984568719, 'loss_val': 1.2391693958289467, 'psi': 0.48359687875121304}
[S4] START round=4 head_norm_before_train=0.629136 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7826151225461341, 'loss_val': 1.281991398198179, 'psi': 0.39718202635556416}-{'f1_val': 0.40121095540407437, 'auprc': 0.7865580222904979, 'loss_val': 1.275459878483008, 'psi': 0.5553497821586437}
[S5] START round=4 head_norm_before_train=0.907411 cos_to_last_merge=0.9886 (last merge round=1)
[S5] round=4 local utility u=0.016082 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.727466908700555, 'loss_val': 1.2587401464043837, 'psi': 0.37634390633736486}-{'f1_val': 0.14226190476190476, 'auprc': 0.7299917864318091, 'loss_val': 1.298478261891583, 'psi': 0.3773538574298665}
[S6] START round=4 head_norm_before_train=0.874896 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.089211 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7061096312718016, 'loss_val': 1.3038120660013008, 'psi': 0.3672996217394899}-{'f1_val': 0.14142628205128205, 'auprc': 0.6545254847926723, 'loss_val': 1.3274818959501555, 'psi': 0.3466659631478381}
[S7] START round=4 head_norm_before_train=0.733734 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.048862 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7315900652374157, 'loss_val': 1.281624018675633, 'psi': 0.37787011973242124}-{'f1_val': 0.14205682272909165, 'auprc': 0.69856095846368, 'loss_val': 1.2802616257561628, 'psi': 0.36465847702292703}
[S8] START round=4 head_norm_before_train=1.310527 (no previous merge yet)
[S8] round=4 local utility u=0.032256 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7675035933164531, 'loss_val': 1.1638562169047737, 'psi': 0.39097502676235557}-{'f1_val': 0.13995598239295717, 'auprc': 0.7660889423012439, 'loss_val': 1.2241251280021967, 'psi': 0.39040916635627193}
[S9] START round=4 head_norm_before_train=1.289243 (no previous merge yet)
[S9] round=4 local utility u=0.112571 metrics={'f1_val': 0.15709967505669065, 'auprc': 0.8665533120971568, 'loss_val': 1.017080814269645, 'psi': 0.44088112987287714}-{'f1_val': 0.141397957139996, 'auprc': 0.8661112640053231, 'loss_val': 1.146687029934282, 'psi': 0.43128327988612686}
[S10] START round=4 head_norm_before_train=0.833547 cos_to_last_merge=0.9969 (last merge round=2)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.26785454529703945, 'auprc': 0.5788908787777918, 'loss_val': 1.2532016616063981, 'psi': 0.39226907868934036}-{'f1_val': 0.41642217334168796, 'auprc': 0.5729494903840142, 'loss_val': 1.3109267721787485, 'psi': 0.47903310015861844}
[S11] START round=4 head_norm_before_train=0.789059 cos_to_last_merge=0.9969 (last merge round=2)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7037176661890087, 'loss_val': 1.2420850919415103, 'psi': 0.3657352764994698}-{'f1_val': 0.14041368337311058, 'auprc': 0.7581550922475497, 'loss_val': 1.297198860764439, 'psi': 0.38751024692288627}
[S13] START round=4 head_norm_before_train=1.241314 (no previous merge yet)
[S13] round=4 local utility u=0.020341 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7233744072268873, 'loss_val': 1.1678193047564507, 'psi': 0.37358122043698677}-{'f1_val': 0.1403857625770531, 'auprc': 0.7298308926247518, 'loss_val': 1.227869885832342, 'psi': 0.3761638145961326}
[S14] START round=4 head_norm_before_train=0.886461 cos_to_last_merge=0.9871 (last merge round=1)
[S14] round=4 local utility u=0.011742 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8559814075946234, 'loss_val': 1.2610943251869817, 'psi': 0.4266072747674716}-{'f1_val': 0.14035785288270378, 'auprc': 0.8616660481809788, 'loss_val': 1.3016324095326404, 'psi': 0.4288811310020138}
[S15] START round=4 head_norm_before_train=0.865345 cos_to_last_merge=0.9886 (last merge round=1)
[S15] round=4 local utility u=0.026792 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7764650175575277, 'loss_val': 1.2504151744762484, 'psi': 0.3944261978399461}-{'f1_val': 0.13973365136155833, 'auprc': 0.7739743964598681, 'loss_val': 1.2965271705740937, 'psi': 0.3934299494008823}
[S16] START round=4 head_norm_before_train=0.918227 cos_to_last_merge=0.9975 (last merge round=2)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5463183654577859, 'loss_val': 1.2547173008836565, 'psi': 0.30290981630263625}-{'f1_val': 0.14063745019920318, 'auprc': 0.7342020130121936, 'loss_val': 1.3101465398423278, 'psi': 0.3780632753243993}
[S17] START round=4 head_norm_before_train=1.217436 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5934632350824447, 'loss_val': 1.1165301303685657, 'psi': 0.32195467202340855}-{'f1_val': 0.14094896331738438, 'auprc': 0.631641542360974, 'loss_val': 1.2231321488415972, 'psi': 0.33722599493482025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:36607
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] cosine check vs S2: cos=0.2221
[S6] RECEIVED delta(kind=head bytes=1795) from S7
[S6] cosine check vs S7: cos=-0.0684
[S6] DROPPED delta from S7 (cos=-0.0684 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S13
[S7] cosine check vs S13: cos=0.4838
[S7] RECEIVED delta(kind=head bytes=1796) from S14
[S7] cosine check vs S14: cos=0.4823
[S7] RECEIVED delta(kind=head bytes=1799) from S5
[S7] cosine check vs S5: cos=0.0906
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=-0.0269
[S5] DROPPED delta from S9 (cos=-0.0269 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S8
[S9] cosine check vs S8: cos=-0.0633
[S9] DROPPED delta from S8 (cos=-0.0633 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S15
[S4] cosine check vs S15: cos=-0.0853
[S4] DROPPED delta from S15 (cos=-0.0853 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1791) from S6
[S4] cosine check vs S6: cos=0.4463
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.1402 head_norm=0.657509
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.308714e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.2156 head_norm=0.542741 delta_norm=0.330871
[S4] aggregate: ACCEPT kept=['S2', 'S6'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=0.764103
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.768524e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1421 head_norm=0.686719 delta_norm=0.376852
[S7] aggregate: ACCEPT kept=['S13', 'S14', 'S5'] (k=3/3) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.750237 cos_to_last_merge=0.9954 (last merge round=3)
[S2] round=5 local utility u=0.055450 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7663647527903173, 'loss_val': 1.2330125851639078, 'psi': 0.391612181149267}-{'f1_val': 0.1417771333885667, 'auprc': 0.7422642545836691, 'loss_val': 1.271611095679552, 'psi': 0.3819719818666077}
[S3] START round=5 head_norm_before_train=1.335116 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8467052326696314, 'loss_val': 1.0892308197151084, 'psi': 0.4225861324363168}-{'f1_val': 0.13984006561410703, 'auprc': 0.9151268079005651, 'loss_val': 1.1858014127214547, 'psi': 0.44995476252869027}
[S4] START round=5 head_norm_before_train=0.542741 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.768678946219797, 'loss_val': 1.2597590723612535, 'psi': 0.3916075558250293}-{'f1_val': 0.14022662889518414, 'auprc': 0.7826151225461341, 'loss_val': 1.281991398198179, 'psi': 0.39718202635556416}
[S5] START round=5 head_norm_before_train=0.940239 cos_to_last_merge=0.9767 (last merge round=1)
[S5] round=5 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5656888437087596, 'loss_val': 1.2280762447711928, 'psi': 0.31163268034064673}-{'f1_val': 0.14226190476190476, 'auprc': 0.727466908700555, 'loss_val': 1.2587401464043837, 'psi': 0.37634390633736486}
[S6] START round=5 head_norm_before_train=0.888084 cos_to_last_merge=0.9967 (last merge round=3)
[S6] round=5 local utility u=0.051837 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7292094353489698, 'loss_val': 1.2694367357868688, 'psi': 0.3765395433703571}-{'f1_val': 0.14142628205128205, 'auprc': 0.7061096312718016, 'loss_val': 1.3038120660013008, 'psi': 0.3672996217394899}
[S7] START round=5 head_norm_before_train=0.686719 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.025086 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.746337572414161, 'loss_val': 1.275695041013676, 'psi': 0.3837691226031194}-{'f1_val': 0.14205682272909165, 'auprc': 0.7315900652374157, 'loss_val': 1.281624018675633, 'psi': 0.37787011973242124}
[S8] START round=5 head_norm_before_train=1.339805 (no previous merge yet)
[S8] round=5 local utility u=1.000000 metrics={'f1_val': 0.49176532751726787, 'auprc': 0.7768497536573409, 'loss_val': 1.07637409974415, 'psi': 0.6057990979732971}-{'f1_val': 0.13995598239295717, 'auprc': 0.7675035933164531, 'loss_val': 1.1638562169047737, 'psi': 0.39097502676235557}
[S9] START round=5 head_norm_before_train=1.329036 (no previous merge yet)
[S9] round=5 local utility u=1.000000 metrics={'f1_val': 0.4165724968026165, 'auprc': 0.9703034831741102, 'loss_val': 0.8022859062612736, 'psi': 0.638064891351214}-{'f1_val': 0.15709967505669065, 'auprc': 0.8665533120971568, 'loss_val': 1.017080814269645, 'psi': 0.44088112987287714}
[S10] START round=5 head_norm_before_train=0.873365 cos_to_last_merge=0.9886 (last merge round=2)
[S10] round=5 local utility u=0.510028 metrics={'f1_val': 0.3869481455573798, 'auprc': 0.6413753991678153, 'loss_val': 1.13516101095163, 'psi': 0.488719047001554}-{'f1_val': 0.26785454529703945, 'auprc': 0.5788908787777918, 'loss_val': 1.2532016616063981, 'psi': 0.39226907868934036}
[S11] START round=5 head_norm_before_train=0.826441 cos_to_last_merge=0.9882 (last merge round=2)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6062326322718707, 'loss_val': 1.175091449896336, 'psi': 0.32674126293261463}-{'f1_val': 0.14041368337311058, 'auprc': 0.7037176661890087, 'loss_val': 1.2420850919415103, 'psi': 0.3657352764994698}
[S13] START round=5 head_norm_before_train=1.278228 (no previous merge yet)
[S13] round=5 local utility u=0.859635 metrics={'f1_val': 0.4158809972763461, 'auprc': 0.7133631576449702, 'loss_val': 1.0714871585587549, 'psi': 0.5348738614237958}-{'f1_val': 0.1403857625770531, 'auprc': 0.7233744072268873, 'loss_val': 1.1678193047564507, 'psi': 0.37358122043698677}
[S14] START round=5 head_norm_before_train=0.922171 cos_to_last_merge=0.9750 (last merge round=1)
[S14] round=5 local utility u=0.006764 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8432794905767591, 'loss_val': 1.2094604829483542, 'psi': 0.4215265079603259}-{'f1_val': 0.14035785288270378, 'auprc': 0.8559814075946234, 'loss_val': 1.2610943251869817, 'psi': 0.4266072747674716}
[S15] START round=5 head_norm_before_train=0.902420 cos_to_last_merge=0.9762 (last merge round=1)
[S15] round=5 local utility u=0.027220 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770489067535931, 'loss_val': 1.1977258912559332, 'psi': 0.39465975351837224}-{'f1_val': 0.13973365136155833, 'auprc': 0.7764650175575277, 'loss_val': 1.2504151744762484, 'psi': 0.3944261978399461}
[S16] START round=5 head_norm_before_train=0.949183 cos_to_last_merge=0.9896 (last merge round=2)
[S16] round=5 local utility u=0.004447 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5322001149570371, 'loss_val': 1.2034679496671787, 'psi': 0.2972625161023368}-{'f1_val': 0.14063745019920318, 'auprc': 0.5463183654577859, 'loss_val': 1.2547173008836565, 'psi': 0.30290981630263625}
[S17] START round=5 head_norm_before_train=1.259215 (no previous merge yet)
[S17] round=5 local utility u=0.913153 metrics={'f1_val': 0.3873279624034911, 'auprc': 0.6593919416163644, 'loss_val': 0.9662850673986748, 'psi': 0.4961535540886404}-{'f1_val': 0.14094896331738438, 'auprc': 0.5934632350824447, 'loss_val': 1.1165301303685657, 'psi': 0.32195467202340855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:36605
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:36604
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:36608
[S16] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] cosine check vs S9: cos=-0.0292
[S5] DROPPED delta from S9 (cos=-0.0292 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] cosine check vs S2: cos=0.5108
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] cosine check vs S16: cos=-0.0935
[S7] DROPPED delta from S16 (cos=-0.0935 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1793) from S14
[S7] cosine check vs S14: cos=0.7715
[S4] RECEIVED delta(kind=head bytes=1792) from S15
[S4] cosine check vs S15: cos=0.0049
[S4] RECEIVED delta(kind=head bytes=1796) from S6
[S4] cosine check vs S6: cos=0.6636
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] cosine check vs S10: cos=0.1507
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] cosine check vs S7: cos=-0.0600
[S6] DROPPED delta from S7 (cos=-0.0600 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] cosine check vs S13: cos=0.7533
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] cosine check vs S8: cos=-0.0661
[S9] DROPPED delta from S8 (cos=-0.0661 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S17
[S13] cosine check vs S17: cos=0.0598
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.1402 head_norm=0.568481
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.514716e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.1737 head_norm=0.505075 delta_norm=0.251472
[S4] aggregate: ACCEPT kept=['S2', 'S15', 'S6'] (k=3/3) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.413 → S16@127.0.0.1:36616
[S5] ⇄ pheromone p=0.333 → S7@127.0.0.1:36608
[S3] ⇄ pheromone p=0.415 → S6@127.0.0.1:36607
[S11] ⇄ pheromone p=0.371 → S2@127.0.0.1:36602
[S16] ⇄ pheromone p=0.378 → S7@127.0.0.1:36608
[S9] ⇄ pheromone p=0.588 → S5@127.0.0.1:36605
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.906973
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.960519e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.693790 delta_norm=0.596052
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.379 → S4@127.0.0.1:36604
[S2] ⇄ pheromone p=0.419 → S4@127.0.0.1:36604
[S15] ⇄ pheromone p=0.340 → S4@127.0.0.1:36604
[S10] ⇄ pheromone p=0.511 → S6@127.0.0.1:36607
[S14] ⇄ pheromone p=0.413 → S7@127.0.0.1:36608
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.4159 head_norm=1.309514
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.959610e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.4163 head_norm=0.951228 delta_norm=0.895961
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.504 → S7@127.0.0.1:36608
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.711603
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.967656e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.837646 delta_norm=0.296766
[S7] aggregate: ACCEPT kept=['S14', 'S13'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.353 → S6@127.0.0.1:36607
[S8] ⇄ pheromone p=0.589 → S9@127.0.0.1:36610
[S17] ⇄ pheromone p=0.530 → S13@127.0.0.1:36613
[S2] START round=6 head_norm_before_train=0.773192 cos_to_last_merge=0.9838 (last merge round=3)
[S2] round=6 local utility u=0.031363 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7720025764352855, 'loss_val': 1.187200460401233, 'psi': 0.3938673106072543}-{'f1_val': 0.1417771333885667, 'auprc': 0.7663647527903173, 'loss_val': 1.2330125851639078, 'psi': 0.391612181149267}
[S3] START round=6 head_norm_before_train=1.368258 (no previous merge yet)
[S3] round=6 local utility u=1.000000 metrics={'f1_val': 0.7094409584223037, 'auprc': 0.8736124014374362, 'loss_val': 0.9625449301503237, 'psi': 0.7751095356283568}-{'f1_val': 0.13984006561410703, 'auprc': 0.8467052326696314, 'loss_val': 1.0892308197151084, 'psi': 0.4225861324363168}
[S4] START round=6 head_norm_before_train=0.505075 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.001989 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7597563220294838, 'loss_val': 1.2290127031833016, 'psi': 0.38803850614890406}-{'f1_val': 0.14022662889518414, 'auprc': 0.768678946219797, 'loss_val': 1.2597590723612535, 'psi': 0.3916075558250293}
[S5] START round=6 head_norm_before_train=0.969750 cos_to_last_merge=0.9657 (last merge round=1)
[S5] round=6 local utility u=1.000000 metrics={'f1_val': 0.4128733651669432, 'auprc': 0.7563601808535994, 'loss_val': 1.1764213196891808, 'psi': 0.5502680914416056}-{'f1_val': 0.14226190476190476, 'auprc': 0.5656888437087596, 'loss_val': 1.2280762447711928, 'psi': 0.31163268034064673}
[S6] START round=6 head_norm_before_train=0.693790 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.211652 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8711565980382419, 'loss_val': 1.2719751018548824, 'psi': 0.43331840844606595}-{'f1_val': 0.14142628205128205, 'auprc': 0.7292094353489698, 'loss_val': 1.2694367357868688, 'psi': 0.3765395433703571}
[S7] START round=6 head_norm_before_train=0.837646 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.076458 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7952700488332266, 'loss_val': 1.2695763294501157, 'psi': 0.40334211317074564}-{'f1_val': 0.14205682272909165, 'auprc': 0.746337572414161, 'loss_val': 1.275695041013676, 'psi': 0.3837691226031194}
[S8] START round=6 head_norm_before_train=1.367952 (no previous merge yet)
[S8] round=6 local utility u=0.748807 metrics={'f1_val': 0.7146818984909413, 'auprc': 0.7769411092379508, 'loss_val': 0.9165337110185661, 'psi': 0.7395855827897451}-{'f1_val': 0.49176532751726787, 'auprc': 0.7768497536573409, 'loss_val': 1.07637409974415, 'psi': 0.6057990979732971}
[S9] START round=6 head_norm_before_train=1.376548 (no previous merge yet)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.7018648842933433, 'auprc': 0.9967940382248879, 'loss_val': 0.5549164367500132, 'psi': 0.8198365458659611}-{'f1_val': 0.4165724968026165, 'auprc': 0.9703034831741102, 'loss_val': 0.8022859062612736, 'psi': 0.638064891351214}
[S10] START round=6 head_norm_before_train=0.922304 cos_to_last_merge=0.9768 (last merge round=2)
[S10] round=6 local utility u=0.212968 metrics={'f1_val': 0.4166398915438061, 'auprc': 0.6537578652093866, 'loss_val': 0.9245221859595161, 'psi': 0.5114870810100383}-{'f1_val': 0.3869481455573798, 'auprc': 0.6413753991678153, 'loss_val': 1.13516101095163, 'psi': 0.488719047001554}
[S11] START round=6 head_norm_before_train=0.868500 cos_to_last_merge=0.9768 (last merge round=2)
[S11] round=6 local utility u=0.948332 metrics={'f1_val': 0.4159058381616681, 'auprc': 0.6480007589940204, 'loss_val': 1.0566848176698762, 'psi': 0.508743806494609}-{'f1_val': 0.14041368337311058, 'auprc': 0.6062326322718707, 'loss_val': 1.175091449896336, 'psi': 0.32674126293261463}
[S13] START round=6 head_norm_before_train=0.951228 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.375198440155037, 'auprc': 0.5562975600029818, 'loss_val': 1.0745067449138859, 'psi': 0.4476380880942149}-{'f1_val': 0.4158809972763461, 'auprc': 0.7133631576449702, 'loss_val': 1.0714871585587549, 'psi': 0.5348738614237958}
[S14] START round=6 head_norm_before_train=0.956662 cos_to_last_merge=0.9641 (last merge round=1)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7866767690202763, 'loss_val': 1.1126837977458122, 'psi': 0.3988854193377328}-{'f1_val': 0.14035785288270378, 'auprc': 0.8432794905767591, 'loss_val': 1.2094604829483542, 'psi': 0.4215265079603259}
[S15] START round=6 head_norm_before_train=0.943264 cos_to_last_merge=0.9622 (last merge round=1)
[S15] round=6 local utility u=0.720179 metrics={'f1_val': 0.3583983753979587, 'auprc': 0.79265772439394, 'loss_val': 1.1161835127124364, 'psi': 0.5321021149963512}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770489067535931, 'loss_val': 1.1977258912559332, 'psi': 0.39465975351837224}
[S16] START round=6 head_norm_before_train=0.987001 cos_to_last_merge=0.9771 (last merge round=2)
[S16] round=6 local utility u=0.862925 metrics={'f1_val': 0.41590293864437167, 'auprc': 0.5247579181981878, 'loss_val': 1.1068835374752752, 'psi': 0.4594449304658982}-{'f1_val': 0.14063745019920318, 'auprc': 0.5322001149570371, 'loss_val': 1.2034679496671787, 'psi': 0.2972625161023368}
[S17] START round=6 head_norm_before_train=1.303969 (no previous merge yet)
[S17] round=6 local utility u=0.259895 metrics={'f1_val': 0.3605094642065254, 'auprc': 0.8615217945979476, 'loss_val': 0.8919736929932457, 'psi': 0.5609143963630943}-{'f1_val': 0.3873279624034911, 'auprc': 0.6593919416163644, 'loss_val': 0.9662850673986748, 'psi': 0.4961535540886404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S4] → sending delta(kind=head bytes=1808) to S16@127.0.0.1:36616
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:36605
[S4] sending update (kind=head size=1808 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1794) from S15
[S4] cosine check vs S15: cos=0.3151
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] cosine check vs S7: cos=0.0548
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] cosine check vs S2: cos=0.6958
[S16] RECEIVED delta(kind=head bytes=1808) from S4
[S16] cosine check vs S4: cos=-0.0303
[S16] DROPPED delta from S4 (cos=-0.0303 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] cosine check vs S3: cos=0.6118
[S2] RECEIVED delta(kind=head bytes=1792) from S11
[S2] cosine check vs S11: cos=0.8387
[S6] RECEIVED delta(kind=head bytes=1794) from S10
[S6] cosine check vs S10: cos=0.7462
[S9] RECEIVED delta(kind=head bytes=1804) from S8
[S9] cosine check vs S8: cos=-0.0701
[S9] DROPPED delta from S8 (cos=-0.0701 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=-0.0932
[S7] DROPPED delta from S16 (cos=-0.0932 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S9
[S5] cosine check vs S9: cos=-0.0313
[S5] DROPPED delta from S9 (cos=-0.0313 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S5
[S7] cosine check vs S5: cos=0.0259
[S4] RECEIVED delta(kind=head bytes=1794) from S6
[S4] cosine check vs S6: cos=0.5310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] cosine check vs S17: cos=0.7001
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.3752 head_norm=0.983951
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.837185e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.3719 head_norm=1.080110 delta_norm=0.483719
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.1418 head_norm=0.790547
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.479201e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.1418 head_norm=0.815041 delta_norm=0.247920
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.854130
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.429315e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.659630 delta_norm=0.642931
[S7] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.1402 head_norm=0.533571
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.731810e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.3727 head_norm=0.512475 delta_norm=0.173181
[S4] aggregate: ACCEPT kept=['S15', 'S2', 'S6'] (k=3/3) mode=median trim_p=0.1
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1414 head_norm=0.711260
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.318781e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.630227 delta_norm=0.231878
[S6] aggregate: ACCEPT kept=['S7', 'S3', 'S10'] (k=3/3) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.815041 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.009060 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7695250987820168, 'loss_val': 1.1616487329413507, 'psi': 0.39287631954594676}-{'f1_val': 0.1417771333885667, 'auprc': 0.7720025764352855, 'loss_val': 1.187200460401233, 'psi': 0.3938673106072543}
[S3] START round=7 head_norm_before_train=1.400386 (no previous merge yet)
[S3] round=7 local utility u=0.179155 metrics={'f1_val': 0.6975118591767913, 'auprc': 0.9472907489737561, 'loss_val': 0.7536947775347898, 'psi': 0.7974234150955772}-{'f1_val': 0.7094409584223037, 'auprc': 0.8736124014374362, 'loss_val': 0.9625449301503237, 'psi': 0.7751095356283568}
[S4] START round=7 head_norm_before_train=0.512475 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=1.000000 metrics={'f1_val': 0.6850267669667144, 'auprc': 0.7616826691349363, 'loss_val': 1.176814726689599, 'psi': 0.7156891278340032}-{'f1_val': 0.14022662889518414, 'auprc': 0.7597563220294838, 'loss_val': 1.2290127031833016, 'psi': 0.38803850614890406}
[S5] START round=7 head_norm_before_train=0.983568 cos_to_last_merge=0.9595 (last merge round=1)
[S5] round=7 local utility u=0.079834 metrics={'f1_val': 0.41835570512555065, 'auprc': 0.7698036796801278, 'loss_val': 1.0899774579426653, 'psi': 0.5589348949473815}-{'f1_val': 0.4128733651669432, 'auprc': 0.7563601808535994, 'loss_val': 1.1764213196891808, 'psi': 0.5502680914416056}
[S6] START round=7 head_norm_before_train=0.630227 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8640606490162251, 'loss_val': 1.2667582987599493, 'psi': 0.4304800288372593}-{'f1_val': 0.14142628205128205, 'auprc': 0.8711565980382419, 'loss_val': 1.2719751018548824, 'psi': 0.43331840844606595}
[S7] START round=7 head_norm_before_train=0.659630 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6004134363176374, 'loss_val': 1.2870332285748578, 'psi': 0.32539946816451}-{'f1_val': 0.14205682272909165, 'auprc': 0.7952700488332266, 'loss_val': 1.2695763294501157, 'psi': 0.40334211317074564}
[S8] START round=7 head_norm_before_train=1.399754 (no previous merge yet)
[S8] round=7 local utility u=0.095635 metrics={'f1_val': 0.714881305139466, 'auprc': 0.7899923704947245, 'loss_val': 0.7656138846167911, 'psi': 0.7449257312815694}-{'f1_val': 0.7146818984909413, 'auprc': 0.7769411092379508, 'loss_val': 0.9165337110185661, 'psi': 0.7395855827897451}
[S9] START round=7 head_norm_before_train=1.427832 (no previous merge yet)
[S9] round=7 local utility u=0.087355 metrics={'f1_val': 0.7017906989076834, 'auprc': 0.9988469978308878, 'loss_val': 0.3859200982328221, 'psi': 0.8206132184769652}-{'f1_val': 0.7018648842933433, 'auprc': 0.9967940382248879, 'loss_val': 0.5549164367500132, 'psi': 0.8198365458659611}
[S10] START round=7 head_norm_before_train=0.979274 cos_to_last_merge=0.9617 (last merge round=2)
[S10] round=7 local utility u=0.337109 metrics={'f1_val': 0.4168455130671376, 'auprc': 0.8255647790924039, 'loss_val': 0.7669591003729392, 'psi': 0.5803332194772441}-{'f1_val': 0.4166398915438061, 'auprc': 0.6537578652093866, 'loss_val': 0.9245221859595161, 'psi': 0.5114870810100383}
[S11] START round=7 head_norm_before_train=0.909148 cos_to_last_merge=0.9642 (last merge round=2)
[S11] round=7 local utility u=0.554331 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9959512216490722, 'loss_val': 0.8755498897486482, 'psi': 0.6362916213051286}-{'f1_val': 0.4159058381616681, 'auprc': 0.6480007589940204, 'loss_val': 1.0566848176698762, 'psi': 0.508743806494609}
[S13] START round=7 head_norm_before_train=1.080110 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.079356 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.512559064329576, 'loss_val': 1.029411367062419, 'psi': 0.45462594549130747}-{'f1_val': 0.375198440155037, 'auprc': 0.5562975600029818, 'loss_val': 1.0745067449138859, 'psi': 0.4476380880942149}
[S14] START round=7 head_norm_before_train=0.992832 cos_to_last_merge=0.9541 (last merge round=1)
[S14] round=7 local utility u=0.368965 metrics={'f1_val': 0.15387968613775066, 'auprc': 0.9562329445595164, 'loss_val': 0.9645523921387669, 'psi': 0.4748209895064569}-{'f1_val': 0.14035785288270378, 'auprc': 0.7866767690202763, 'loss_val': 1.1126837977458122, 'psi': 0.3988854193377328}
[S15] START round=7 head_norm_before_train=0.983334 cos_to_last_merge=0.9487 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=7 local utility u=0.261099 metrics={'f1_val': 0.416567672447929, 'auprc': 0.7999872647408703, 'loss_val': 0.9649908067129848, 'psi': 0.5699355093651055}-{'f1_val': 0.3583983753979587, 'auprc': 0.79265772439394, 'loss_val': 1.1161835127124364, 'psi': 0.5321021149963512}
[S16] START round=7 head_norm_before_train=1.018330 cos_to_last_merge=0.9646 (last merge round=2)
[S16] round=7 local utility u=0.108670 metrics={'f1_val': 0.4338021269113706, 'auprc': 0.5265847712724608, 'loss_val': 1.0024201029689885, 'psi': 0.4709151846558067}-{'f1_val': 0.41590293864437167, 'auprc': 0.5247579181981878, 'loss_val': 1.1068835374752752, 'psi': 0.4594449304658982}
[S17] START round=7 head_norm_before_train=1.353914 (no previous merge yet)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.3530289445322021, 'auprc': 0.7990567504304799, 'loss_val': 0.8850399934623755, 'psi': 0.5314400668915132}-{'f1_val': 0.3605094642065254, 'auprc': 0.8615217945979476, 'loss_val': 0.8919736929932457, 'psi': 0.5609143963630943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:36616
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:36608
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[S16] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1807 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] cosine check vs S13: cos=0.6696
[S2] RECEIVED delta(kind=head bytes=1793) from S11
[S2] cosine check vs S11: cos=0.9434
[S7] RECEIVED delta(kind=head bytes=1798) from S5
[S7] cosine check vs S5: cos=0.7417
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] cosine check vs S14: cos=0.4995
[S5] RECEIVED delta(kind=head bytes=1797) from S9
[S5] cosine check vs S9: cos=-0.0326
[S5] DROPPED delta from S9 (cos=-0.0326 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1794) from S2
[S4] cosine check vs S2: cos=0.7516
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] cosine check vs S10: cos=0.7356
[S7] RECEIVED delta(kind=head bytes=1793) from S16
[S7] cosine check vs S16: cos=-0.0275
[S7] DROPPED delta from S16 (cos=-0.0275 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S3
[S6] cosine check vs S3: cos=0.6103
[S4] RECEIVED delta(kind=head bytes=1793) from S15
[S4] cosine check vs S15: cos=0.4309
[S16] RECEIVED delta(kind=head bytes=1807) from S4
[S16] cosine check vs S4: cos=-0.0174
[S16] DROPPED delta from S4 (cos=-0.0174 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] cosine check vs S8: cos=-0.0750
[S9] DROPPED delta from S8 (cos=-0.0750 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.668711
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.991121e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=0.710842 delta_norm=0.199112
[S7] aggregate: ACCEPT kept=['S13', 'S5', 'S14'] (k=3/3) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.1414 head_norm=0.646967
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.095092e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.1414 head_norm=0.757687 delta_norm=0.209509
[S6] aggregate: ACCEPT kept=['S10', 'S3'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.6850 head_norm=0.544998
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.787136e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.4013 head_norm=0.607643 delta_norm=0.278714
[S4] aggregate: ROLLBACK (f1_val pre=0.685 post=0.401 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.1418 head_norm=0.833931
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.626878e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.1418 head_norm=0.883366 delta_norm=0.162688
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.883366 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.528750 metrics={'f1_val': 0.3609250418038781, 'auprc': 0.6746081136919172, 'loss_val': 1.1342858742804327, 'psi': 0.4863982705590938}-{'f1_val': 0.1417771333885667, 'auprc': 0.7695250987820168, 'loss_val': 1.1616487329413507, 'psi': 0.39287631954594676}
[S3] START round=8 head_norm_before_train=1.436515 (no previous merge yet)
[S3] round=8 local utility u=0.131912 metrics={'f1_val': 0.7003403500227726, 'auprc': 0.9993653222792845, 'loss_val': 0.6630656623271939, 'psi': 0.8199503389253774}-{'f1_val': 0.6975118591767913, 'auprc': 0.9472907489737561, 'loss_val': 0.7536947775347898, 'psi': 0.7974234150955772}
[S4] START round=8 head_norm_before_train=0.607643 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.6664314815587207, 'auprc': 0.5974269918391513, 'loss_val': 1.1111801375623889, 'psi': 0.6388296856708929}-{'f1_val': 0.6850267669667144, 'auprc': 0.7616826691349363, 'loss_val': 1.176814726689599, 'psi': 0.7156891278340032}
[S5] START round=8 head_norm_before_train=1.010079 cos_to_last_merge=0.9491 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.949
[S5] round=8 local utility u=0.086165 metrics={'f1_val': 0.41904074041212663, 'auprc': 0.7777514292909502, 'loss_val': 0.9456001209724232, 'psi': 0.5625250159636561}-{'f1_val': 0.41835570512555065, 'auprc': 0.7698036796801278, 'loss_val': 1.0899774579426653, 'psi': 0.5589348949473815}
[S6] START round=8 head_norm_before_train=0.757687 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7245227762283528, 'loss_val': 1.2270616240454641, 'psi': 0.3746648797221103}-{'f1_val': 0.14142628205128205, 'auprc': 0.8640606490162251, 'loss_val': 1.2667582987599493, 'psi': 0.4304800288372593}
[S7] START round=8 head_norm_before_train=0.710842 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.294214 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7933475065790376, 'loss_val': 1.2774072480125012, 'psi': 0.40257309626907006}-{'f1_val': 0.14205682272909165, 'auprc': 0.6004134363176374, 'loss_val': 1.2870332285748578, 'psi': 0.32539946816451}
[S8] START round=8 head_norm_before_train=1.436101 (no previous merge yet)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.3731380036306732, 'auprc': 0.9982531647880271, 'loss_val': 0.6784414840947651, 'psi': 0.6231840680936147}-{'f1_val': 0.714881305139466, 'auprc': 0.7899923704947245, 'loss_val': 0.7656138846167911, 'psi': 0.7449257312815694}
[S9] START round=8 head_norm_before_train=1.484360 (no previous merge yet)
[S9] round=8 local utility u=0.034675 metrics={'f1_val': 0.7017167946673312, 'auprc': 0.9984815893619439, 'loss_val': 0.3150302989832328, 'psi': 0.8204227125451762}-{'f1_val': 0.7017906989076834, 'auprc': 0.9988469978308878, 'loss_val': 0.3859200982328221, 'psi': 0.8206132184769652}
[S10] START round=8 head_norm_before_train=1.036393 cos_to_last_merge=0.9438 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.944
[S10] round=8 local utility u=0.696773 metrics={'f1_val': 0.6538173874186108, 'auprc': 0.7875537205346523, 'loss_val': 0.6812102353486822, 'psi': 0.7073119206650275}-{'f1_val': 0.4168455130671376, 'auprc': 0.8255647790924039, 'loss_val': 0.7669591003729392, 'psi': 0.5803332194772441}
[S11] START round=8 head_norm_before_train=0.958209 cos_to_last_merge=0.9476 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.948
[S11] round=8 local utility u=0.096289 metrics={'f1_val': 0.396484976660716, 'auprc': 0.9987746924526968, 'loss_val': 0.6912401096464145, 'psi': 0.6374008629775083}-{'f1_val': 0.39651855440916606, 'auprc': 0.9959512216490722, 'loss_val': 0.8755498897486482, 'psi': 0.6362916213051286}
[S13] START round=8 head_norm_before_train=1.105568 cos_to_last_merge=0.9964 (last merge round=6)
[S13] round=8 local utility u=0.316402 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.6731972927058094, 'loss_val': 0.87734233237823, 'psi': 0.518763278273742}-{'f1_val': 0.4160038662657951, 'auprc': 0.512559064329576, 'loss_val': 1.029411367062419, 'psi': 0.45462594549130747}
[S14] START round=8 head_norm_before_train=1.037921 cos_to_last_merge=0.9427 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=8 local utility u=1.000000 metrics={'f1_val': 0.7281566793089971, 'auprc': 0.9721380093342145, 'loss_val': 0.8685962055326352, 'psi': 0.8257492113190841}-{'f1_val': 0.15387968613775066, 'auprc': 0.9562329445595164, 'loss_val': 0.9645523921387669, 'psi': 0.4748209895064569}
[S15] START round=8 head_norm_before_train=1.028340 cos_to_last_merge=0.9334 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=8 local utility u=0.008604 metrics={'f1_val': 0.3849678301699503, 'auprc': 0.7992212667407899, 'loss_val': 0.7558848211181335, 'psi': 0.5506692047982862}-{'f1_val': 0.416567672447929, 'auprc': 0.7999872647408703, 'loss_val': 0.9649908067129848, 'psi': 0.5699355093651055}
[S16] START round=8 head_norm_before_train=1.057141 cos_to_last_merge=0.9491 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.949
[S16] round=8 local utility u=0.051168 metrics={'f1_val': 0.3551855234366865, 'auprc': 0.7102259780000498, 'loss_val': 0.9793071552358754, 'psi': 0.4972017052620319}-{'f1_val': 0.4338021269113706, 'auprc': 0.5265847712724608, 'loss_val': 1.0024201029689885, 'psi': 0.4709151846558067}
[S17] START round=8 head_norm_before_train=1.401866 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.3536207091334382, 'auprc': 0.7800656947663169, 'loss_val': 0.8712349153936764, 'psi': 0.5241987033865897}-{'f1_val': 0.3530289445322021, 'auprc': 0.7990567504304799, 'loss_val': 0.8850399934623755, 'psi': 0.5314400668915132}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:36605
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:36607
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[S2] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S3
[S6] cosine check vs S3: cos=0.7450
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.4495
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=0.9672
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=-0.0104
[S7] DROPPED delta from S16 (cos=-0.0104 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1796) from S15
[S4] cosine check vs S15: cos=0.6962
[S6] RECEIVED delta(kind=head bytes=1794) from S10
[S6] cosine check vs S10: cos=0.6656
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] cosine check vs S9: cos=-0.0337
[S5] DROPPED delta from S9 (cos=-0.0337 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1793) from S2
[S4] cosine check vs S2: cos=0.8148
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=0.1177
[S7] RECEIVED delta(kind=head bytes=1794) from S5
[S7] cosine check vs S5: cos=0.7527
[S7] RECEIVED delta(kind=head bytes=1792) from S13
[S7] cosine check vs S13: cos=0.8326
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.1414 head_norm=0.778754
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.005707e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.1414 head_norm=0.669500 delta_norm=0.200571
[S6] aggregate: ACCEPT kept=['S3', 'S10', 'S7'] (k=3/3) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.6664 head_norm=0.640058
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.948027e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6669 head_norm=0.717922 delta_norm=0.194803
[S4] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.1421 head_norm=0.716261
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.149404e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.1421 head_norm=0.763947 delta_norm=0.114940
[S7] aggregate: ACCEPT kept=['S14', 'S5', 'S13'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.3609 head_norm=0.907341
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.344314e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.3859 head_norm=0.953756 delta_norm=0.134431
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.953756 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.358704 metrics={'f1_val': 0.4169384018324798, 'auprc': 0.77555523396921, 'loss_val': 1.0558002520252785, 'psi': 0.560385134687172}-{'f1_val': 0.3609250418038781, 'auprc': 0.6746081136919172, 'loss_val': 1.1342858742804327, 'psi': 0.4863982705590938}
[S3] START round=9 head_norm_before_train=1.476363 (no previous merge yet)
[S3] round=9 local utility u=0.092865 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9990402490004882, 'loss_val': 0.47930840613396036, 'psi': 0.8201151406154816}-{'f1_val': 0.7003403500227726, 'auprc': 0.9993653222792845, 'loss_val': 0.6630656623271939, 'psi': 0.8199503389253774}
[S4] START round=9 head_norm_before_train=0.717922 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.4462224129422619, 'auprc': 0.6493888520251119, 'loss_val': 1.0041468349867828, 'psi': 0.5274889885754019}-{'f1_val': 0.6664314815587207, 'auprc': 0.5974269918391513, 'loss_val': 1.1111801375623889, 'psi': 0.6388296856708929}
[S5] START round=9 head_norm_before_train=1.043031 cos_to_last_merge=0.9358 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.936
[S5] round=9 local utility u=0.554822 metrics={'f1_val': 0.5746489312943253, 'auprc': 0.7926329636029898, 'loss_val': 0.8142507725177581, 'psi': 0.6618425442177911}-{'f1_val': 0.41904074041212663, 'auprc': 0.7777514292909502, 'loss_val': 0.9456001209724232, 'psi': 0.5625250159636561}
[S6] START round=9 head_norm_before_train=0.669500 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6929798129795914, 'loss_val': 1.1782447211881624, 'psi': 0.3620476944226058}-{'f1_val': 0.14142628205128205, 'auprc': 0.7245227762283528, 'loss_val': 1.2270616240454641, 'psi': 0.3746648797221103}
[S7] START round=9 head_norm_before_train=0.763947 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.014775 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7949996846941263, 'loss_val': 1.2528145376692543, 'psi': 0.40323396751510554}-{'f1_val': 0.14205682272909165, 'auprc': 0.7933475065790376, 'loss_val': 1.2774072480125012, 'psi': 0.40257309626907006}
[S8] START round=9 head_norm_before_train=1.478256 (no previous merge yet)
[S8] round=9 local utility u=1.000000 metrics={'f1_val': 0.7147473519913303, 'auprc': 0.994910794069325, 'loss_val': 0.6695193957006452, 'psi': 0.8268127288225282}-{'f1_val': 0.3731380036306732, 'auprc': 0.9982531647880271, 'loss_val': 0.6784414840947651, 'psi': 0.6231840680936147}
[S9] START round=9 head_norm_before_train=1.536180 (no previous merge yet)
[S9] round=9 local utility u=0.018920 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9985411062024697, 'loss_val': 0.27631215008423954, 'psi': 0.8203408410021511}-{'f1_val': 0.7017167946673312, 'auprc': 0.9984815893619439, 'loss_val': 0.3150302989832328, 'psi': 0.8204227125451762}
[S10] START round=9 head_norm_before_train=1.079376 cos_to_last_merge=0.9280 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.928
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.5358874901016062, 'auprc': 0.9593223079204573, 'loss_val': 0.5950326675400464, 'psi': 0.7052614172291466}-{'f1_val': 0.6538173874186108, 'auprc': 0.7875537205346523, 'loss_val': 0.6812102353486822, 'psi': 0.7073119206650275}
[S11] START round=9 head_norm_before_train=1.015961 cos_to_last_merge=0.9279 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.928
[S11] round=9 local utility u=0.761922 metrics={'f1_val': 0.6301238300436529, 'auprc': 0.9970315739114353, 'loss_val': 0.5639991174793955, 'psi': 0.7768869275907659}-{'f1_val': 0.396484976660716, 'auprc': 0.9987746924526968, 'loss_val': 0.6912401096464145, 'psi': 0.6374008629775083}
[S13] START round=9 head_norm_before_train=1.139152 cos_to_last_merge=0.9865 (last merge round=6)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.3733632476825528, 'auprc': 0.6237305364731203, 'loss_val': 0.8499644723514099, 'psi': 0.4735101631987798}-{'f1_val': 0.41580726865236384, 'auprc': 0.6731972927058094, 'loss_val': 0.87734233237823, 'psi': 0.518763278273742}
[S14] START round=9 head_norm_before_train=1.090150 cos_to_last_merge=0.9304 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.930
[S14] round=9 local utility u=0.947788 metrics={'f1_val': 0.9977794563615565, 'auprc': 0.9989604453854257, 'loss_val': 0.6712251317811043, 'psi': 0.9982518519711041}-{'f1_val': 0.7281566793089971, 'auprc': 0.9721380093342145, 'loss_val': 0.8685962055326352, 'psi': 0.8257492113190841}
[S15] START round=9 head_norm_before_train=1.081152 cos_to_last_merge=0.9160 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.916
[S15] round=9 local utility u=1.000000 metrics={'f1_val': 0.6969187301947782, 'auprc': 0.7993598073182272, 'loss_val': 0.6097972737859398, 'psi': 0.7378951610441579}-{'f1_val': 0.3849678301699503, 'auprc': 0.7992212667407899, 'loss_val': 0.7558848211181335, 'psi': 0.5506692047982862}
[S16] START round=9 head_norm_before_train=1.099401 cos_to_last_merge=0.9322 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.932
[S16] round=9 local utility u=0.097288 metrics={'f1_val': 0.3809867429999779, 'auprc': 0.7226735920128513, 'loss_val': 0.9768803257025634, 'psi': 0.5176614826051272}-{'f1_val': 0.3551855234366865, 'auprc': 0.7102259780000498, 'loss_val': 0.9793071552358754, 'psi': 0.4972017052620319}
[S17] START round=9 head_norm_before_train=1.441289 (no previous merge yet)
[S17] round=9 local utility u=0.041369 metrics={'f1_val': 0.35332495072624465, 'auprc': 0.8177737538444637, 'loss_val': 0.8998471397862432, 'psi': 0.5391044719735323}-{'f1_val': 0.3536207091334382, 'auprc': 0.7800656947663169, 'loss_val': 0.8712349153936764, 'psi': 0.5241987033865897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:36608
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:36602
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:36608
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:36605
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=0.9756
[S4] RECEIVED delta(kind=head bytes=1788) from S2
[S4] cosine check vs S2: cos=0.8151
[S4] RECEIVED delta(kind=head bytes=1799) from S15
[S4] cosine check vs S15: cos=0.7727
[S7] RECEIVED delta(kind=head bytes=1796) from S14
[S7] cosine check vs S14: cos=0.4347
[S5] RECEIVED delta(kind=head bytes=1802) from S9
[S5] cosine check vs S9: cos=-0.0353
[S5] DROPPED delta from S9 (cos=-0.0353 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=-0.0017
[S7] DROPPED delta from S16 (cos=-0.0017 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1792) from S3
[S6] cosine check vs S3: cos=0.6936
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] cosine check vs S8: cos=-0.0832
[S9] DROPPED delta from S8 (cos=-0.0832 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S7
[S6] cosine check vs S7: cos=0.3118
[S7] RECEIVED delta(kind=head bytes=1792) from S5
[S7] cosine check vs S5: cos=0.7190
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] cosine check vs S17: cos=0.8631
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.3734 head_norm=1.169989
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.746444e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.3724 head_norm=1.274843 delta_norm=0.374644
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.4462 head_norm=0.752353
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.543926e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.5370 head_norm=0.808719 delta_norm=0.154393
[S4] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.1414 head_norm=0.697682
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.839592e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.1414 head_norm=0.730194 delta_norm=0.283959
[S6] aggregate: ACCEPT kept=['S3', 'S7'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.1421 head_norm=0.774282
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.242216e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.1421 head_norm=0.737942 delta_norm=0.224222
[S7] aggregate: ACCEPT kept=['S14', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.4169 head_norm=0.976824
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.234636e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.4171 head_norm=1.019862 delta_norm=0.123464
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.019862 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.514139 metrics={'f1_val': 0.5743146179593521, 'auprc': 0.775791494500577, 'loss_val': 0.9724883302915586, 'psi': 0.6549053685758421}-{'f1_val': 0.4169384018324798, 'auprc': 0.77555523396921, 'loss_val': 1.0558002520252785, 'psi': 0.560385134687172}
[S3] START round=10 head_norm_before_train=1.522435 (no previous merge yet)
[S3] round=10 local utility u=0.025878 metrics={'f1_val': 0.7008362290767893, 'auprc': 0.9989797075228161, 'loss_val': 0.4273979308605066, 'psi': 0.8200936204552001}-{'f1_val': 0.7008317350254774, 'auprc': 0.9990402490004882, 'loss_val': 0.47930840613396036, 'psi': 0.8201151406154816}
[S4] START round=10 head_norm_before_train=0.808719 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.021259 metrics={'f1_val': 0.4354012470533826, 'auprc': 0.6552691617312745, 'loss_val': 0.9143422202182585, 'psi': 0.5233484129245394}-{'f1_val': 0.4462224129422619, 'auprc': 0.6493888520251119, 'loss_val': 1.0041468349867828, 'psi': 0.5274889885754019}
[S5] START round=10 head_norm_before_train=1.082133 cos_to_last_merge=0.9202 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.920
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.5237258217828147, 'auprc': 0.7930550614713889, 'loss_val': 0.711389994604651, 'psi': 0.6314575176582444}-{'f1_val': 0.5746489312943253, 'auprc': 0.7926329636029898, 'loss_val': 0.8142507725177581, 'psi': 0.6618425442177911}
[S6] START round=10 head_norm_before_train=0.730194 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.990284 metrics={'f1_val': 0.4164535851642239, 'auprc': 0.764044426837832, 'loss_val': 1.061034979127335, 'psi': 0.5554899218336672}-{'f1_val': 0.14142628205128205, 'auprc': 0.6929798129795914, 'loss_val': 1.1782447211881624, 'psi': 0.3620476944226058}
[S7] START round=10 head_norm_before_train=0.737942 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.022478 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7952016509017562, 'loss_val': 1.2084649528917426, 'psi': 0.40331475399815747}-{'f1_val': 0.14205682272909165, 'auprc': 0.7949996846941263, 'loss_val': 1.2528145376692543, 'psi': 0.40323396751510554}
[S8] START round=10 head_norm_before_train=1.512161 (no previous merge yet)
[S8] round=10 local utility u=0.068154 metrics={'f1_val': 0.7067530997858333, 'auprc': 0.9949944254814628, 'loss_val': 0.48549730555567566, 'psi': 0.8220496300640852}-{'f1_val': 0.7147473519913303, 'auprc': 0.994910794069325, 'loss_val': 0.6695193957006452, 'psi': 0.8268127288225282}
[S9] START round=10 head_norm_before_train=1.584101 (no previous merge yet)
[S9] round=10 local utility u=0.018288 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982108095736784, 'loss_val': 0.23680064270937826, 'psi': 0.8200142722934824}-{'f1_val': 0.7015406642019387, 'auprc': 0.9985411062024697, 'loss_val': 0.27631215008423954, 'psi': 0.8203408410021511}
[S10] START round=10 head_norm_before_train=1.112760 cos_to_last_merge=0.9140 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.914
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.4369985379185211, 'auprc': 0.8646815035204866, 'loss_val': 0.5861174900718545, 'psi': 0.6080717241593073}-{'f1_val': 0.5358874901016062, 'auprc': 0.9593223079204573, 'loss_val': 0.5950326675400464, 'psi': 0.7052614172291466}
[S11] START round=10 head_norm_before_train=1.075425 cos_to_last_merge=0.9093 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.909
[S11] round=10 local utility u=0.243128 metrics={'f1_val': 0.7016501368687256, 'auprc': 0.9954687234581491, 'loss_val': 0.5022132528133993, 'psi': 0.819177571504495}-{'f1_val': 0.6301238300436529, 'auprc': 0.9970315739114353, 'loss_val': 0.5639991174793955, 'psi': 0.7768869275907659}
[S13] START round=10 head_norm_before_train=1.274843 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.484674 metrics={'f1_val': 0.5033567314453612, 'auprc': 0.6743589844557907, 'loss_val': 0.8124636574701419, 'psi': 0.571757632649533}-{'f1_val': 0.3733632476825528, 'auprc': 0.6237305364731203, 'loss_val': 0.8499644723514099, 'psi': 0.4735101631987798}
[S14] START round=10 head_norm_before_train=1.147313 cos_to_last_merge=0.9181 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.918
[S14] round=10 local utility u=0.065038 metrics={'f1_val': 0.9976172360255884, 'auprc': 0.9946212467245569, 'loss_val': 0.5271587481494737, 'psi': 0.9964188403051758}-{'f1_val': 0.9977794563615565, 'auprc': 0.9989604453854257, 'loss_val': 0.6712251317811043, 'psi': 0.9982518519711041}
[S15] START round=10 head_norm_before_train=1.137655 cos_to_last_merge=0.8982 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.898
[S15] round=10 local utility u=0.131389 metrics={'f1_val': 0.6842128042240088, 'auprc': 0.8619136937537033, 'loss_val': 0.45844495128925083, 'psi': 0.7552931600358865}-{'f1_val': 0.6969187301947782, 'auprc': 0.7993598073182272, 'loss_val': 0.6097972737859398, 'psi': 0.7378951610441579}
[S16] START round=10 head_norm_before_train=1.139750 cos_to_last_merge=0.9165 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.917
[S16] round=10 local utility u=0.000765 metrics={'f1_val': 0.36051233323526954, 'auprc': 0.7367024422624151, 'loss_val': 0.8945897111972989, 'psi': 0.5109883768461277}-{'f1_val': 0.3809867429999779, 'auprc': 0.7226735920128513, 'loss_val': 0.9768803257025634, 'psi': 0.5176614826051272}
[S17] START round=10 head_norm_before_train=1.470473 (no previous merge yet)
[S17] round=10 local utility u=0.042642 metrics={'f1_val': 0.3552705151571911, 'auprc': 0.8432146617507547, 'loss_val': 0.902558945258928, 'psi': 0.5504481737946165}-{'f1_val': 0.35332495072624465, 'auprc': 0.8177737538444637, 'loss_val': 0.8998471397862432, 'psi': 0.5391044719735323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:36604
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:36607
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:36602
[S4] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S7
[S6] cosine check vs S7: cos=0.3999
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=0.9815
[S4] RECEIVED delta(kind=head bytes=1795) from S15
[S4] cosine check vs S15: cos=0.8006
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] cosine check vs S13: cos=0.6852
[S5] RECEIVED delta(kind=head bytes=1795) from S9
[S5] cosine check vs S9: cos=-0.0356
[S5] DROPPED delta from S9 (cos=-0.0356 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] cosine check vs S2: cos=0.8123
[S7] RECEIVED delta(kind=head bytes=1791) from S16
[S7] cosine check vs S16: cos=-0.0230
[S7] DROPPED delta from S16 (cos=-0.0230 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S6
[S4] cosine check vs S6: cos=0.0982
[S9] RECEIVED delta(kind=head bytes=1804) from S8
[S9] cosine check vs S8: cos=-0.0851
[S9] DROPPED delta from S8 (cos=-0.0851 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.5987
[S6] RECEIVED delta(kind=head bytes=1795) from S3
[S6] cosine check vs S3: cos=0.8470
[S16] RECEIVED delta(kind=head bytes=1796) from S4
[S16] cosine check vs S4: cos=0.0166
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=0.9578
[S5] ⇄ pheromone p=0.299 → S7@127.0.0.1:36608
[S10] ⇄ pheromone p=0.308 → S6@127.0.0.1:36607
[S11] ⇄ pheromone p=0.439 → S2@127.0.0.1:36602
[S15] ⇄ pheromone p=0.385 → S4@127.0.0.1:36604
[S14] ⇄ pheromone p=0.466 → S7@127.0.0.1:36608
[S9] ⇄ pheromone p=0.295 → S5@127.0.0.1:36605
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.4165 head_norm=0.758950
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.617742e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.4171 head_norm=0.802913 delta_norm=0.161774
[S6] aggregate: ACCEPT kept=['S7', 'S3'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.340 → S4@127.0.0.1:36604
[S3] ⇄ pheromone p=0.273 → S6@127.0.0.1:36607
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.4354 head_norm=0.846681
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.601032e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.4353 head_norm=0.761002 delta_norm=0.160103
[S4] aggregate: ACCEPT kept=['S15', 'S2', 'S6'] (k=3/3) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.242 → S16@127.0.0.1:36616
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.1421 head_norm=0.755279
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.370319e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.1421 head_norm=0.814586 delta_norm=0.237032
[S7] aggregate: ACCEPT kept=['S13', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.166 → S6@127.0.0.1:36607
[S8] ⇄ pheromone p=0.438 → S9@127.0.0.1:36610
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.5743 head_norm=1.046435
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.117886e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.6029 head_norm=1.081168 delta_norm=0.111789
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.369 → S4@127.0.0.1:36604
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.5034 head_norm=1.297403
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.226007e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.5971 head_norm=1.376780 delta_norm=0.222601
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.311 → S7@127.0.0.1:36608
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3605 head_norm=1.172678
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.174745e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3788 head_norm=0.728870 delta_norm=0.717474
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.228 → S7@127.0.0.1:36608
[S17] ⇄ pheromone p=0.210 → S13@127.0.0.1:36613
[S2] START round=11 head_norm_before_train=1.081168 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.328600 metrics={'f1_val': 0.663675649923774, 'auprc': 0.7781265541517784, 'loss_val': 0.8584595351238261, 'psi': 0.7094560116149757}-{'f1_val': 0.5743146179593521, 'auprc': 0.775791494500577, 'loss_val': 0.9724883302915586, 'psi': 0.6549053685758421}
[S3] START round=11 head_norm_before_train=1.567716 (no previous merge yet)
[S3] round=11 local utility u=0.023894 metrics={'f1_val': 0.7008362290767893, 'auprc': 0.9956801527509022, 'loss_val': 0.36971179200023996, 'psi': 0.8187737985464345}-{'f1_val': 0.7008362290767893, 'auprc': 0.9989797075228161, 'loss_val': 0.4273979308605066, 'psi': 0.8200936204552001}
[S4] START round=11 head_norm_before_train=0.761002 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.075371 metrics={'f1_val': 0.4359876615368605, 'auprc': 0.6807903559198918, 'loss_val': 0.8436822711169408, 'psi': 0.533908739290073}-{'f1_val': 0.4354012470533826, 'auprc': 0.6552691617312745, 'loss_val': 0.9143422202182585, 'psi': 0.5233484129245394}
[S5] START round=11 head_norm_before_train=1.121175 cos_to_last_merge=0.9048 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.905
[S5] round=11 local utility u=0.352214 metrics={'f1_val': 0.5895258416311048, 'auprc': 0.8721443176654764, 'loss_val': 0.6390302395732527, 'psi': 0.7025732320448534}-{'f1_val': 0.5237258217828147, 'auprc': 0.7930550614713889, 'loss_val': 0.711389994604651, 'psi': 0.6314575176582444}
[S6] START round=11 head_norm_before_train=0.802913 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.671308 metrics={'f1_val': 0.6012592405196426, 'auprc': 0.7933993443609462, 'loss_val': 0.9153177260459721, 'psi': 0.678115282056164}-{'f1_val': 0.4164535851642239, 'auprc': 0.764044426837832, 'loss_val': 1.061034979127335, 'psi': 0.5554899218336672}
[S7] START round=11 head_norm_before_train=0.814586 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.045429 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7947058276208319, 'loss_val': 1.1161193975983081, 'psi': 0.40311642468578773}-{'f1_val': 0.14205682272909165, 'auprc': 0.7952016509017562, 'loss_val': 1.2084649528917426, 'psi': 0.40331475399815747}
[S8] START round=11 head_norm_before_train=1.545025 (no previous merge yet)
[S8] round=11 local utility u=0.039078 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9958704930848344, 'loss_val': 0.4523885515186077, 'psi': 0.8266419642242898}-{'f1_val': 0.7067530997858333, 'auprc': 0.9949944254814628, 'loss_val': 0.48549730555567566, 'psi': 0.8220496300640852}
[S9] START round=11 head_norm_before_train=1.624520 (no previous merge yet)
[S9] round=11 local utility u=0.004556 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981667010692327, 'loss_val': 0.22755615177750751, 'psi': 0.8199966288917042}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982108095736784, 'loss_val': 0.23680064270937826, 'psi': 0.8200142722934824}
[S10] START round=11 head_norm_before_train=1.145333 cos_to_last_merge=0.9011 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.901
[S10] round=11 local utility u=0.799842 metrics={'f1_val': 0.6478229462794514, 'auprc': 0.9399351950401942, 'loss_val': 0.47714001901673797, 'psi': 0.7646678457837485}-{'f1_val': 0.4369985379185211, 'auprc': 0.8646815035204866, 'loss_val': 0.5861174900718545, 'psi': 0.6080717241593073}
[S11] START round=11 head_norm_before_train=1.125973 cos_to_last_merge=0.8942 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.894
[S11] round=11 local utility u=0.055033 metrics={'f1_val': 0.7018246587012323, 'auprc': 0.9971885893691145, 'loss_val': 0.3983537328275251, 'psi': 0.8199702309683852}-{'f1_val': 0.7016501368687256, 'auprc': 0.9954687234581491, 'loss_val': 0.5022132528133993, 'psi': 0.819177571504495}
[S13] START round=11 head_norm_before_train=1.376780 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.642441 metrics={'f1_val': 0.7132262943575028, 'auprc': 0.6573603482742221, 'loss_val': 0.7358040829986487, 'psi': 0.6908799159241905}-{'f1_val': 0.5033567314453612, 'auprc': 0.6743589844557907, 'loss_val': 0.8124636574701419, 'psi': 0.571757632649533}
[S14] START round=11 head_norm_before_train=1.201577 cos_to_last_merge=0.9071 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.907
[S14] round=11 local utility u=0.054577 metrics={'f1_val': 0.9983867311350005, 'auprc': 0.9956793500838048, 'loss_val': 0.4257967895382339, 'psi': 0.9973037787145222}-{'f1_val': 0.9976172360255884, 'auprc': 0.9946212467245569, 'loss_val': 0.5271587481494737, 'psi': 0.9964188403051758}
[S15] START round=11 head_norm_before_train=1.192244 cos_to_last_merge=0.8815 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.882
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.6967944413659724, 'auprc': 0.7990975929147193, 'loss_val': 0.6070585615690002, 'psi': 0.7377157019854711}-{'f1_val': 0.6842128042240088, 'auprc': 0.8619136937537033, 'loss_val': 0.45844495128925083, 'psi': 0.7552931600358865}
[S16] START round=11 head_norm_before_train=0.728870 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.4373279038776157, 'auprc': 0.552993961676617, 'loss_val': 0.9121363658706784, 'psi': 0.48359432699721616}-{'f1_val': 0.36051233323526954, 'auprc': 0.7367024422624151, 'loss_val': 0.8945897111972989, 'psi': 0.5109883768461277}
[S17] START round=11 head_norm_before_train=1.485561 (no previous merge yet)
[S17] round=11 local utility u=0.056170 metrics={'f1_val': 0.35894903104380427, 'auprc': 0.8678267852138538, 'loss_val': 0.8861264767041447, 'psi': 0.5625001327118241}-{'f1_val': 0.3552705151571911, 'auprc': 0.8432146617507547, 'loss_val': 0.902558945258928, 'psi': 0.5504481737946165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:36616
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:36602
[S11] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1793) from S5
[S7] cosine check vs S5: cos=0.5194
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.6866
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=0.7120
[S5] RECEIVED delta(kind=head bytes=1804) from S9
[S5] cosine check vs S9: cos=-0.0358
[S5] DROPPED delta from S9 (cos=-0.0358 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S10
[S6] cosine check vs S10: cos=0.2376
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] cosine check vs S3: cos=0.8821
[S6] RECEIVED delta(kind=head bytes=1796) from S7
[S6] cosine check vs S7: cos=0.4057
[S4] RECEIVED delta(kind=head bytes=1796) from S2
[S4] cosine check vs S2: cos=0.8076
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] cosine check vs S8: cos=-0.0857
[S9] DROPPED delta from S8 (cos=-0.0857 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S4
[S16] cosine check vs S4: cos=0.5509
[S2] RECEIVED delta(kind=head bytes=1790) from S11
[S2] cosine check vs S11: cos=0.9849
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] cosine check vs S6: cos=0.2326
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S17
[S13] cosine check vs S17: cos=0.9808
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.1421 head_norm=0.836074
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.417070e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.1421 head_norm=0.850916 delta_norm=0.241707
[S7] aggregate: ACCEPT kept=['S5', 'S14', 'S13'] (k=3/3) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.4360 head_norm=0.806264
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.578991e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.4897 head_norm=0.712554 delta_norm=0.257899
[S4] aggregate: ACCEPT kept=['S2', 'S6'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.7132 head_norm=1.399196
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.502464e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.7132 head_norm=1.441778 delta_norm=0.150246
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.6637 head_norm=1.114234
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.030640e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.6817 head_norm=1.137964 delta_norm=0.103064
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.6013 head_norm=0.836712
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.311349e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.6188 head_norm=0.729030 delta_norm=0.231135
[S6] aggregate: ACCEPT kept=['S10', 'S3', 'S7'] (k=3/3) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.4373 head_norm=0.774027
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.747047e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.4370 head_norm=0.695835 delta_norm=0.374705
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.137964 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.205992 metrics={'f1_val': 0.7125458020418063, 'auprc': 0.777098435472978, 'loss_val': 0.7366115721130342, 'psi': 0.738366855414275}-{'f1_val': 0.663675649923774, 'auprc': 0.7781265541517784, 'loss_val': 0.8584595351238261, 'psi': 0.7094560116149757}
[S3] START round=12 head_norm_before_train=1.612698 (no previous merge yet)
[S3] round=12 local utility u=0.024888 metrics={'f1_val': 0.7010863553524592, 'auprc': 0.9968511287791271, 'loss_val': 0.32494849172714213, 'psi': 0.8193922647231264}-{'f1_val': 0.7008362290767893, 'auprc': 0.9956801527509022, 'loss_val': 0.36971179200023996, 'psi': 0.8187737985464345}
[S4] START round=12 head_norm_before_train=0.712554 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.038549 metrics={'f1_val': 0.442079589285924, 'auprc': 0.678262298853466, 'loss_val': 0.7955519106960396, 'psi': 0.5365526731129409}-{'f1_val': 0.4359876615368605, 'auprc': 0.6807903559198918, 'loss_val': 0.8436822711169408, 'psi': 0.533908739290073}
[S5] START round=12 head_norm_before_train=1.150472 cos_to_last_merge=0.8936 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.894
[S5] round=12 local utility u=0.274264 metrics={'f1_val': 0.7146937595824697, 'auprc': 0.7934372423864549, 'loss_val': 0.6053891448684219, 'psi': 0.7461911527040639}-{'f1_val': 0.5895258416311048, 'auprc': 0.8721443176654764, 'loss_val': 0.6390302395732527, 'psi': 0.7025732320448534}
[S6] START round=12 head_norm_before_train=0.729030 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.418387 metrics={'f1_val': 0.7101519744047462, 'auprc': 0.8111983429104295, 'loss_val': 0.785297053130204, 'psi': 0.7505705218070196}-{'f1_val': 0.6012592405196426, 'auprc': 0.7933993443609462, 'loss_val': 0.9153177260459721, 'psi': 0.678115282056164}
[S7] START round=12 head_norm_before_train=0.850916 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.876834 metrics={'f1_val': 0.4171579869317734, 'auprc': 0.7921343395051992, 'loss_val': 1.0053440927768609, 'psi': 0.5671485279611437}-{'f1_val': 0.14205682272909165, 'auprc': 0.7947058276208319, 'loss_val': 1.1161193975983081, 'psi': 0.40311642468578773}
[S8] START round=12 head_norm_before_train=1.573915 (no previous merge yet)
[S8] round=12 local utility u=0.087392 metrics={'f1_val': 0.7298032160173363, 'auprc': 0.9935943745536007, 'loss_val': 0.3666576990447487, 'psi': 0.835319679431842}-{'f1_val': 0.7138229449839267, 'auprc': 0.9958704930848344, 'loss_val': 0.4523885515186077, 'psi': 0.8266419642242898}
[S9] START round=12 head_norm_before_train=1.658265 (no previous merge yet)
[S9] round=12 local utility u=0.027712 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.998474169709366, 'loss_val': 0.17305473454805237, 'psi': 0.8201196163477575}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981667010692327, 'loss_val': 0.22755615177750751, 'psi': 0.8199966288917042}
[S10] START round=12 head_norm_before_train=1.183514 cos_to_last_merge=0.8879 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.888
[S10] round=12 local utility u=0.238573 metrics={'f1_val': 0.6882540305088808, 'auprc': 0.9831600003218998, 'loss_val': 0.37225415724328764, 'psi': 0.8062164184340884}-{'f1_val': 0.6478229462794514, 'auprc': 0.9399351950401942, 'loss_val': 0.47714001901673797, 'psi': 0.7646678457837485}
[S11] START round=12 head_norm_before_train=1.170322 cos_to_last_merge=0.8817 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.882
[S11] round=12 local utility u=0.020967 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.996736500553884, 'loss_val': 0.3561211220500727, 'psi': 0.8198950657890929}-{'f1_val': 0.7018246587012323, 'auprc': 0.9971885893691145, 'loss_val': 0.3983537328275251, 'psi': 0.8199702309683852}
[S13] START round=12 head_norm_before_train=1.441778 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.712500904615195, 'auprc': 0.6563895386961386, 'loss_val': 0.7565549846576856, 'psi': 0.6900563582475725}-{'f1_val': 0.7132262943575028, 'auprc': 0.6573603482742221, 'loss_val': 0.7358040829986487, 'psi': 0.6908799159241905}
[S14] START round=12 head_norm_before_train=1.256228 cos_to_last_merge=0.8970 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.897
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.9293683664796621, 'auprc': 0.993254422925858, 'loss_val': 0.32800777622000304, 'psi': 0.9549227890581404}-{'f1_val': 0.9983867311350005, 'auprc': 0.9956793500838048, 'loss_val': 0.4257967895382339, 'psi': 0.9973037787145222}
[S15] START round=12 head_norm_before_train=1.241356 cos_to_last_merge=0.8671 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.867
[S15] round=12 local utility u=0.105013 metrics={'f1_val': 0.6970736780543771, 'auprc': 0.804175098368061, 'loss_val': 0.4139414922545392, 'psi': 0.7399142461798507}-{'f1_val': 0.6967944413659724, 'auprc': 0.7990975929147193, 'loss_val': 0.6070585615690002, 'psi': 0.7377157019854711}
[S16] START round=12 head_norm_before_train=0.695835 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.530702 metrics={'f1_val': 0.5814963985234036, 'auprc': 0.6199912635704545, 'loss_val': 0.9167351657237157, 'psi': 0.596894344542224}-{'f1_val': 0.4373279038776157, 'auprc': 0.552993961676617, 'loss_val': 0.9121363658706784, 'psi': 0.48359432699721616}
[S17] START round=12 head_norm_before_train=1.498280 (no previous merge yet)
[S17] round=12 local utility u=0.014596 metrics={'f1_val': 0.37012862309035627, 'auprc': 0.8411018181232459, 'loss_val': 0.8438380695859709, 'psi': 0.5585179011035122}-{'f1_val': 0.35894903104380427, 'auprc': 0.8678267852138538, 'loss_val': 0.8861264767041447, 'psi': 0.5625001327118241}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:36610
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:36604
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S9
[S5] cosine check vs S9: cos=-0.0360
[S5] DROPPED delta from S9 (cos=-0.0360 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S10
[S6] cosine check vs S10: cos=0.4519
[S7] RECEIVED delta(kind=head bytes=1803) from S16
[S7] cosine check vs S16: cos=0.1786
[S2] RECEIVED delta(kind=head bytes=1790) from S11
[S2] cosine check vs S11: cos=0.9868
[S4] RECEIVED delta(kind=head bytes=1800) from S6
[S4] cosine check vs S6: cos=0.4522
[S7] RECEIVED delta(kind=head bytes=1798) from S5
[S7] cosine check vs S5: cos=0.6996
[S6] RECEIVED delta(kind=head bytes=1792) from S3
[S6] cosine check vs S3: cos=0.7760
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=0.8327
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] cosine check vs S7: cos=0.4717
[S4] RECEIVED delta(kind=head bytes=1798) from S15
[S4] cosine check vs S15: cos=0.5888
[S9] RECEIVED delta(kind=head bytes=1803) from S8
[S9] cosine check vs S8: cos=-0.0859
[S9] DROPPED delta from S8 (cos=-0.0859 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S4
[S16] cosine check vs S4: cos=0.7820
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.9889
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.7125 head_norm=1.460812
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.142160e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.7123 head_norm=1.483927 delta_norm=0.114216
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7125 head_norm=1.176826
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.836080e-02
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7122 head_norm=1.189517 delta_norm=0.098361
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.5815 head_norm=0.738777
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.485684e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.2197 head_norm=0.709720 delta_norm=0.248568
[S16] aggregate: ROLLBACK (f1_val pre=0.581 post=0.220 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.4172 head_norm=0.873950
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.308178e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.1421 head_norm=0.724638 delta_norm=0.330818
[S7] aggregate: ROLLBACK (f1_val pre=0.417 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.7102 head_norm=0.776409
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.359535e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.7102 head_norm=0.733292 delta_norm=0.135953
[S6] aggregate: ACCEPT kept=['S10', 'S3', 'S7'] (k=3/3) mode=median trim_p=0.1
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.4421 head_norm=0.764975
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.421025e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.4953 head_norm=0.750486 delta_norm=0.142103
[S4] aggregate: ACCEPT kept=['S6', 'S2', 'S15'] (k=3/3) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.189517 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.064860 metrics={'f1_val': 0.698947294683328, 'auprc': 0.7976574896030632, 'loss_val': 0.5869772017968969, 'psi': 0.738431372651222}-{'f1_val': 0.7125458020418063, 'auprc': 0.777098435472978, 'loss_val': 0.7366115721130342, 'psi': 0.738366855414275}
[S3] START round=13 head_norm_before_train=1.653526 (no previous merge yet)
[S3] round=13 local utility u=0.017898 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9969410150543829, 'loss_val': 0.28789508054769436, 'psi': 0.8192754470370396}-{'f1_val': 0.7010863553524592, 'auprc': 0.9968511287791271, 'loss_val': 0.32494849172714213, 'psi': 0.8193922647231264}
[S4] START round=13 head_norm_before_train=0.750486 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=1.000000 metrics={'f1_val': 0.6744595575615246, 'auprc': 0.8727670179187462, 'loss_val': 0.7618440018386896, 'psi': 0.7537825417044133}-{'f1_val': 0.442079589285924, 'auprc': 0.678262298853466, 'loss_val': 0.7955519106960396, 'psi': 0.5365526731129409}
[S5] START round=13 head_norm_before_train=1.171100 cos_to_last_merge=0.8850 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.885
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.700819376599179, 'auprc': 0.7367174447969173, 'loss_val': 0.7624416556167725, 'psi': 0.7151786038782744}-{'f1_val': 0.7146937595824697, 'auprc': 0.7934372423864549, 'loss_val': 0.6053891448684219, 'psi': 0.7461911527040639}
[S6] START round=13 head_norm_before_train=0.733292 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.006976 metrics={'f1_val': 0.7077119513704995, 'auprc': 0.7918335438197306, 'loss_val': 0.698611216398061, 'psi': 0.7413605883501919}-{'f1_val': 0.7101519744047462, 'auprc': 0.8111983429104295, 'loss_val': 0.785297053130204, 'psi': 0.7505705218070196}
[S7] START round=13 head_norm_before_train=0.724638 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.719645 metrics={'f1_val': 0.6548855052770299, 'auprc': 0.7937530194675078, 'loss_val': 0.9972746917893984, 'psi': 0.710432510953221}-{'f1_val': 0.4171579869317734, 'auprc': 0.7921343395051992, 'loss_val': 1.0053440927768609, 'psi': 0.5671485279611437}
[S8] START round=13 head_norm_before_train=1.605588 (no previous merge yet)
[S8] round=13 local utility u=0.856457 metrics={'f1_val': 0.9930731297669921, 'auprc': 0.9976124969140213, 'loss_val': 0.24541781966885753, 'psi': 0.9948888766258037}-{'f1_val': 0.7298032160173363, 'auprc': 0.9935943745536007, 'loss_val': 0.3666576990447487, 'psi': 0.835319679431842}
[S9] START round=13 head_norm_before_train=1.687116 (no previous merge yet)
[S9] round=13 local utility u=0.839948 metrics={'f1_val': 0.9852543644376418, 'auprc': 0.9970104071002694, 'loss_val': 0.1929941749937492, 'psi': 0.9899567815026928}-{'f1_val': 0.7012165807733519, 'auprc': 0.998474169709366, 'loss_val': 0.17305473454805237, 'psi': 0.8201196163477575}
[S10] START round=13 head_norm_before_train=1.231223 cos_to_last_merge=0.8721 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.872
[S10] round=13 local utility u=0.040774 metrics={'f1_val': 0.6889642176740225, 'auprc': 0.9899276114872239, 'loss_val': 0.31527036001345043, 'psi': 0.8093495751993031}-{'f1_val': 0.6882540305088808, 'auprc': 0.9831600003218998, 'loss_val': 0.37225415724328764, 'psi': 0.8062164184340884}
[S11] START round=13 head_norm_before_train=1.210096 cos_to_last_merge=0.8704 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.870
[S11] round=13 local utility u=0.026501 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9980652486698185, 'loss_val': 0.3067133870311136, 'psi': 0.8203872894469195}-{'f1_val': 0.7020007759458987, 'auprc': 0.996736500553884, 'loss_val': 0.3561211220500727, 'psi': 0.8198950657890929}
[S13] START round=13 head_norm_before_train=1.483927 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.066268 metrics={'f1_val': 0.7132924984109341, 'auprc': 0.6660470184575504, 'loss_val': 0.6577415310417962, 'psi': 0.6943943064295807}-{'f1_val': 0.712500904615195, 'auprc': 0.6563895386961386, 'loss_val': 0.7565549846576856, 'psi': 0.6900563582475725}
[S14] START round=13 head_norm_before_train=1.312653 cos_to_last_merge=0.8876 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.888
[S14] round=13 local utility u=0.046710 metrics={'f1_val': 0.929973426320259, 'auprc': 0.9970658892297148, 'loss_val': 0.24965255923649415, 'psi': 0.9568104114840413}-{'f1_val': 0.9293683664796621, 'auprc': 0.993254422925858, 'loss_val': 0.32800777622000304, 'psi': 0.9549227890581404}
[S15] START round=13 head_norm_before_train=1.281977 cos_to_last_merge=0.8554 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.855
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.6987799900756136, 'auprc': 0.7995444797433144, 'loss_val': 0.4180142704118413, 'psi': 0.739085785942694}-{'f1_val': 0.6970736780543771, 'auprc': 0.804175098368061, 'loss_val': 0.4139414922545392, 'psi': 0.7399142461798507}
[S16] START round=13 head_norm_before_train=0.709720 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.5015776464090586, 'auprc': 0.6897467249019416, 'loss_val': 0.9264091015789416, 'psi': 0.5768452778062118}-{'f1_val': 0.5814963985234036, 'auprc': 0.6199912635704545, 'loss_val': 0.9167351657237157, 'psi': 0.596894344542224}
[S17] START round=13 head_norm_before_train=1.515320 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.36591695501730104, 'auprc': 0.8119700054560284, 'loss_val': 0.782505642218771, 'psi': 0.544338175192792}-{'f1_val': 0.37012862309035627, 'auprc': 0.8411018181232459, 'loss_val': 0.8438380695859709, 'psi': 0.5585179011035122}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:36604
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:36607
[S13] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] cosine check vs S8: cos=-0.0854
[S9] DROPPED delta from S8 (cos=-0.0854 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S10
[S6] cosine check vs S10: cos=0.5555
[S16] RECEIVED delta(kind=head bytes=1798) from S4
[S16] cosine check vs S4: cos=0.9086
[S4] RECEIVED delta(kind=head bytes=1794) from S2
[S4] cosine check vs S2: cos=0.8115
[S6] RECEIVED delta(kind=head bytes=1796) from S7
[S6] cosine check vs S7: cos=0.4877
[S7] RECEIVED delta(kind=head bytes=1802) from S13
[S7] cosine check vs S13: cos=0.7040
[S4] RECEIVED delta(kind=head bytes=1804) from S6
[S4] cosine check vs S6: cos=0.4193
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.3834
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] cosine check vs S9: cos=-0.0341
[S5] DROPPED delta from S9 (cos=-0.0341 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S3
[S6] cosine check vs S3: cos=0.7007
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] cosine check vs S11: cos=0.9895
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6745 head_norm=0.802061
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.882656e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6774 head_norm=0.753909 delta_norm=0.188266
[S4] aggregate: ACCEPT kept=['S2', 'S6'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.6549 head_norm=0.751110
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.255720e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.7147 head_norm=0.837032 delta_norm=0.325572
[S7] aggregate: ACCEPT kept=['S13', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.6989 head_norm=1.231282
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.027717e-02
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.6988 head_norm=1.237077 delta_norm=0.090277
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.7077 head_norm=0.786442
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.232215e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.7077 head_norm=0.731789 delta_norm=0.123221
[S6] aggregate: ACCEPT kept=['S10', 'S7', 'S3'] (k=3/3) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.5016 head_norm=0.749370
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.678524e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.2068 head_norm=0.757796 delta_norm=0.167852
[S16] aggregate: ROLLBACK (f1_val pre=0.502 post=0.207 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.237077 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.037980 metrics={'f1_val': 0.7131509658623219, 'auprc': 0.78169858313368, 'loss_val': 0.548363099763758, 'psi': 0.7405700127708652}-{'f1_val': 0.698947294683328, 'auprc': 0.7976574896030632, 'loss_val': 0.5869772017968969, 'psi': 0.738431372651222}
[S3] START round=14 head_norm_before_train=1.687594 (no previous merge yet)
[S3] round=14 local utility u=0.014287 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9969401213484856, 'loss_val': 0.258865806390387, 'psi': 0.819229770780574}-{'f1_val': 0.7008317350254774, 'auprc': 0.9969410150543829, 'loss_val': 0.28789508054769436, 'psi': 0.8192754470370396}
[S4] START round=14 head_norm_before_train=0.753909 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.079762 metrics={'f1_val': 0.6834601082322196, 'auprc': 0.8742468133840287, 'loss_val': 0.6607634030989826, 'psi': 0.7597747902929433}-{'f1_val': 0.6744595575615246, 'auprc': 0.8727670179187462, 'loss_val': 0.7618440018386896, 'psi': 0.7537825417044133}
[S5] START round=14 head_norm_before_train=1.191202 cos_to_last_merge=0.8773 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.877
[S5] round=14 local utility u=0.216338 metrics={'f1_val': 0.7146935597656502, 'auprc': 0.7919327330079265, 'loss_val': 0.5786570327165925, 'psi': 0.7455892290625608}-{'f1_val': 0.700819376599179, 'auprc': 0.7367174447969173, 'loss_val': 0.7624416556167725, 'psi': 0.7151786038782744}
[S6] START round=14 head_norm_before_train=0.731789 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.028898 metrics={'f1_val': 0.7073521613480201, 'auprc': 0.7903723269286527, 'loss_val': 0.6342725695871997, 'psi': 0.7405602275802732}-{'f1_val': 0.7077119513704995, 'auprc': 0.7918335438197306, 'loss_val': 0.698611216398061, 'psi': 0.7413605883501919}
[S7] START round=14 head_norm_before_train=0.837032 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.188009 metrics={'f1_val': 0.6975879702041932, 'auprc': 0.7914857082343042, 'loss_val': 0.8706688770810698, 'psi': 0.7351470654162375}-{'f1_val': 0.6548855052770299, 'auprc': 0.7937530194675078, 'loss_val': 0.9972746917893984, 'psi': 0.710432510953221}
[S8] START round=14 head_norm_before_train=1.637485 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.96395123456899, 'auprc': 0.9975165303394076, 'loss_val': 0.2307127900413938, 'psi': 0.977377352877157}-{'f1_val': 0.9930731297669921, 'auprc': 0.9976124969140213, 'loss_val': 0.24541781966885753, 'psi': 0.9948888766258037}
[S9] START round=14 head_norm_before_train=1.712038 (no previous merge yet)
[S9] round=14 local utility u=0.060410 metrics={'f1_val': 0.9912134460920485, 'auprc': 0.9984695496583676, 'loss_val': 0.11230596170632562, 'psi': 0.9941158875185763}-{'f1_val': 0.9852543644376418, 'auprc': 0.9970104071002694, 'loss_val': 0.1929941749937492, 'psi': 0.9899567815026928}
[S10] START round=14 head_norm_before_train=1.278139 cos_to_last_merge=0.8568 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.857
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.5290551756767135, 'auprc': 0.9108876098974976, 'loss_val': 0.5177072194291642, 'psi': 0.6817881493650271}-{'f1_val': 0.6889642176740225, 'auprc': 0.9899276114872239, 'loss_val': 0.31527036001345043, 'psi': 0.8093495751993031}
[S11] START round=14 head_norm_before_train=1.249385 cos_to_last_merge=0.8606 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.861
[S11] round=14 local utility u=0.022580 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9981683088701694, 'loss_val': 0.26041198915356456, 'psi': 0.8202834113002226}-{'f1_val': 0.7019353166316534, 'auprc': 0.9980652486698185, 'loss_val': 0.3067133870311136, 'psi': 0.8203872894469195}
[S13] START round=14 head_norm_before_train=1.504726 cos_to_last_merge=0.9987 (last merge round=12)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6351220397290143, 'auprc': 0.6662320047813473, 'loss_val': 0.6887020049760065, 'psi': 0.6475660257499475}-{'f1_val': 0.7132924984109341, 'auprc': 0.6660470184575504, 'loss_val': 0.6577415310417962, 'psi': 0.6943943064295807}
[S14] START round=14 head_norm_before_train=1.366538 cos_to_last_merge=0.8798 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.880
[S14] round=14 local utility u=0.215178 metrics={'f1_val': 0.9951979292177893, 'auprc': 0.9956319168860499, 'loss_val': 0.20634265688512662, 'psi': 0.9953715242850936}-{'f1_val': 0.929973426320259, 'auprc': 0.9970658892297148, 'loss_val': 0.24965255923649415, 'psi': 0.9568104114840413}
[S15] START round=14 head_norm_before_train=1.316401 cos_to_last_merge=0.8453 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.845
[S15] round=14 local utility u=0.152929 metrics={'f1_val': 0.7161744190839978, 'auprc': 0.8407563593450202, 'loss_val': 0.34015839340571835, 'psi': 0.7660071951884068}-{'f1_val': 0.6987799900756136, 'auprc': 0.7995444797433144, 'loss_val': 0.4180142704118413, 'psi': 0.739085785942694}
[S16] START round=14 head_norm_before_train=0.757796 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.357528 metrics={'f1_val': 0.5928260502794059, 'auprc': 0.7312070976721612, 'loss_val': 0.8832248966214269, 'psi': 0.648178469236508}-{'f1_val': 0.5015776464090586, 'auprc': 0.6897467249019416, 'loss_val': 0.9264091015789416, 'psi': 0.5768452778062118}
[S17] START round=14 head_norm_before_train=1.534857 (no previous merge yet)
[S17] round=14 local utility u=0.049298 metrics={'f1_val': 0.3726754693244558, 'auprc': 0.8240710458531688, 'loss_val': 0.7607640594357076, 'psi': 0.5532336999359411}-{'f1_val': 0.36591695501730104, 'auprc': 0.8119700054560284, 'loss_val': 0.782505642218771, 'psi': 0.544338175192792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:36604
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:36616
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:36605
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S7
[S6] cosine check vs S7: cos=0.4858
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=0.3700
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.5897
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] cosine check vs S9: cos=-0.0323
[S5] DROPPED delta from S9 (cos=-0.0323 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] cosine check vs S3: cos=0.6660
[S2] RECEIVED delta(kind=head bytes=1792) from S11
[S2] cosine check vs S11: cos=0.9918
[S7] RECEIVED delta(kind=head bytes=1796) from S5
[S7] cosine check vs S5: cos=0.6010
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] cosine check vs S6: cos=0.5221
[S4] RECEIVED delta(kind=head bytes=1795) from S15
[S4] cosine check vs S15: cos=0.5386
[S16] RECEIVED delta(kind=head bytes=1796) from S4
[S16] cosine check vs S4: cos=0.9136
[S4] RECEIVED delta(kind=head bytes=1792) from S2
[S4] cosine check vs S2: cos=0.8375
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=0.9864
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.6351 head_norm=1.527266
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.271880e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.6577 head_norm=1.533103 delta_norm=0.127188
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.7074 head_norm=0.784868
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.848031e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.7076 head_norm=0.835224 delta_norm=0.284803
[S6] aggregate: ACCEPT kept=['S7', 'S3'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.5928 head_norm=0.797084
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.666703e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.3074 head_norm=0.784260 delta_norm=0.166670
[S16] aggregate: ROLLBACK (f1_val pre=0.593 post=0.307 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.6976 head_norm=0.876259
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.001665e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.6815 head_norm=0.736364 delta_norm=0.300166
[S7] aggregate: ROLLBACK (f1_val pre=0.698 post=0.682 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7132 head_norm=1.284275
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.220012e-02
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.7130 head_norm=1.281888 delta_norm=0.082200
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.6835 head_norm=0.806439
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.603165e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.6830 head_norm=0.791562 delta_norm=0.160316
[S4] aggregate: ACCEPT kept=['S6', 'S15', 'S2'] (k=3/3) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.281888 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.054161 metrics={'f1_val': 0.7002291620262046, 'auprc': 0.7997532248158598, 'loss_val': 0.41667462674228256, 'psi': 0.7400387871420666}-{'f1_val': 0.7131509658623219, 'auprc': 0.78169858313368, 'loss_val': 0.548363099763758, 'psi': 0.7405700127708652}
[S3] START round=15 head_norm_before_train=1.719518 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.7009355793019081, 'auprc': 0.9979402465139341, 'loss_val': 0.2631556138334208, 'psi': 0.8197374461867185}-{'f1_val': 0.7007562037352997, 'auprc': 0.9969401213484856, 'loss_val': 0.258865806390387, 'psi': 0.819229770780574}
[S4] START round=15 head_norm_before_train=0.791562 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.123850 metrics={'f1_val': 0.6899902093731836, 'auprc': 0.9086313743936663, 'loss_val': 0.5553969373187124, 'psi': 0.7774466753813767}-{'f1_val': 0.6834601082322196, 'auprc': 0.8742468133840287, 'loss_val': 0.6607634030989826, 'psi': 0.7597747902929433}
[S5] START round=15 head_norm_before_train=1.209438 cos_to_last_merge=0.8713 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.871
[S5] round=15 local utility u=0.004106 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.7920972221688913, 'loss_val': 0.486191805897809, 'psi': 0.7371803819737148}-{'f1_val': 0.7146935597656502, 'auprc': 0.7919327330079265, 'loss_val': 0.5786570327165925, 'psi': 0.7455892290625608}
[S6] START round=15 head_norm_before_train=0.835224 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.045588 metrics={'f1_val': 0.690177328748283, 'auprc': 0.8281187109712009, 'loss_val': 0.5532862841557626, 'psi': 0.7453538816374501}-{'f1_val': 0.7073521613480201, 'auprc': 0.7903723269286527, 'loss_val': 0.6342725695871997, 'psi': 0.7405602275802732}
[S7] START round=15 head_norm_before_train=0.736364 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.040761 metrics={'f1_val': 0.6960778970611736, 'auprc': 0.7919190962493838, 'loss_val': 0.7813872430920542, 'psi': 0.7344143767364577}-{'f1_val': 0.6975879702041932, 'auprc': 0.7914857082343042, 'loss_val': 0.8706688770810698, 'psi': 0.7351470654162375}
[S8] START round=15 head_norm_before_train=1.677750 (no previous merge yet)
[S8] round=15 local utility u=0.151633 metrics={'f1_val': 0.996503822188793, 'auprc': 0.9991388945335727, 'loss_val': 0.12763023549961564, 'psi': 0.9975578511267048}-{'f1_val': 0.96395123456899, 'auprc': 0.9975165303394076, 'loss_val': 0.2307127900413938, 'psi': 0.977377352877157}
[S9] START round=15 head_norm_before_train=1.735013 (no previous merge yet)
[S9] round=15 local utility u=0.008888 metrics={'f1_val': 0.9912134460920485, 'auprc': 0.9984674674000275, 'loss_val': 0.09452341135427013, 'psi': 0.9941150546152402}-{'f1_val': 0.9912134460920485, 'auprc': 0.9984695496583676, 'loss_val': 0.11230596170632562, 'psi': 0.9941158875185763}
[S10] START round=15 head_norm_before_train=1.317233 cos_to_last_merge=0.8443 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.844
[S10] round=15 local utility u=0.720689 metrics={'f1_val': 0.7569163790127094, 'auprc': 0.9362573853230727, 'loss_val': 0.5196061325700361, 'psi': 0.8286527815368547}-{'f1_val': 0.5290551756767135, 'auprc': 0.9108876098974976, 'loss_val': 0.5177072194291642, 'psi': 0.6817881493650271}
[S11] START round=15 head_norm_before_train=1.284766 cos_to_last_merge=0.8537 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.854
[S11] round=15 local utility u=0.776395 metrics={'f1_val': 0.9544541079242251, 'auprc': 0.9981438691493573, 'loss_val': 0.22411228314193327, 'psi': 0.971930012414278}-{'f1_val': 0.7016934795869249, 'auprc': 0.9981683088701694, 'loss_val': 0.26041198915356456, 'psi': 0.8202834113002226}
[S13] START round=15 head_norm_before_train=1.533103 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.614399352660403, 'auprc': 0.6660293597701004, 'loss_val': 0.7072261722063851, 'psi': 0.635051355504282}-{'f1_val': 0.6351220397290143, 'auprc': 0.6662320047813473, 'loss_val': 0.6887020049760065, 'psi': 0.6475660257499475}
[S14] START round=15 head_norm_before_train=1.411259 cos_to_last_merge=0.8736 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.874
[S14] round=15 local utility u=0.037861 metrics={'f1_val': 0.9979077116553055, 'auprc': 0.9967296477563519, 'loss_val': 0.1501722989481668, 'psi': 0.997436486095724}-{'f1_val': 0.9951979292177893, 'auprc': 0.9956319168860499, 'loss_val': 0.20634265688512662, 'psi': 0.9953715242850936}
[S15] START round=15 head_norm_before_train=1.349011 cos_to_last_merge=0.8353 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.835
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.7002952719526283, 'auprc': 0.8350872257288768, 'loss_val': 0.36466661408043616, 'psi': 0.7542120534631278}-{'f1_val': 0.7161744190839978, 'auprc': 0.8407563593450202, 'loss_val': 0.34015839340571835, 'psi': 0.7660071951884068}
[S16] START round=15 head_norm_before_train=0.784260 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.5488169388340784, 'auprc': 0.7657068696477762, 'loss_val': 0.8375268231310913, 'psi': 0.6355729111595576}-{'f1_val': 0.5928260502794059, 'auprc': 0.7312070976721612, 'loss_val': 0.8832248966214269, 'psi': 0.648178469236508}
[S17] START round=15 head_norm_before_train=1.549394 (no previous merge yet)
[S17] round=15 local utility u=0.302091 metrics={'f1_val': 0.39739437558616464, 'auprc': 0.9351804129611889, 'loss_val': 0.6382236991623087, 'psi': 0.6125087905361744}-{'f1_val': 0.3726754693244558, 'auprc': 0.8240710458531688, 'loss_val': 0.7607640594357076, 'psi': 0.5532336999359411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:36604
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S14] → sending delta(kind=head bytes=1808) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:36602
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1808 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=-0.0307
[S5] DROPPED delta from S9 (cos=-0.0307 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=0.9933
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] cosine check vs S6: cos=0.4437
[S9] RECEIVED delta(kind=head bytes=1802) from S8
[S9] cosine check vs S8: cos=-0.0833
[S9] DROPPED delta from S8 (cos=-0.0833 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1789) from S4
[S16] cosine check vs S4: cos=0.9488
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=0.5184
[S7] RECEIVED delta(kind=head bytes=1796) from S5
[S7] cosine check vs S5: cos=0.5521
[S7] RECEIVED delta(kind=head bytes=1808) from S14
[S7] cosine check vs S14: cos=0.6761
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] cosine check vs S10: cos=0.3531
[S4] RECEIVED delta(kind=head bytes=1794) from S2
[S4] cosine check vs S2: cos=0.8188
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S17
[S13] cosine check vs S17: cos=0.9927
[S3] ⇄ pheromone p=0.099 → S6@127.0.0.1:36607
[S15] ⇄ pheromone p=0.161 → S4@127.0.0.1:36604
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6144 head_norm=1.552613
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.412423e-02
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6228 head_norm=1.555805 delta_norm=0.094124
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.163 → S7@127.0.0.1:36608
[S5] ⇄ pheromone p=0.190 → S7@127.0.0.1:36608
[S10] ⇄ pheromone p=0.340 → S6@127.0.0.1:36607
[S11] ⇄ pheromone p=0.313 → S2@127.0.0.1:36602
[S8] ⇄ pheromone p=0.296 → S9@127.0.0.1:36610
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.6961 head_norm=0.781669
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.335805e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.7000 head_norm=0.839095 delta_norm=0.233580
[S7] aggregate: ACCEPT kept=['S5', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.278 → S6@127.0.0.1:36607
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.6900 head_norm=0.843457
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.774269e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.6914 head_norm=0.810107 delta_norm=0.177427
[S4] aggregate: ACCEPT kept=['S6', 'S2'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.255 → S16@127.0.0.1:36616
[S14] ⇄ pheromone p=0.205 → S7@127.0.0.1:36608
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7002 head_norm=1.326871
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.667647e-02
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.7001 head_norm=1.319404 delta_norm=0.076676
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.194 → S4@127.0.0.1:36604
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.6902 head_norm=0.890459
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.099206e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.6905 head_norm=0.748857 delta_norm=0.409921
[S6] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.224 → S4@127.0.0.1:36604
[S9] ⇄ pheromone p=0.219 → S5@127.0.0.1:36605
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.5488 head_norm=0.823346
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.337054e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.5551 head_norm=0.822667 delta_norm=0.133705
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.186 → S7@127.0.0.1:36608
[S17] ⇄ pheromone p=0.143 → S13@127.0.0.1:36613
[S2] START round=16 head_norm_before_train=1.319404 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.015342 metrics={'f1_val': 0.7007582966005393, 'auprc': 0.7977991278553722, 'loss_val': 0.38330240839644997, 'psi': 0.7395746291024725}-{'f1_val': 0.7002291620262046, 'auprc': 0.7997532248158598, 'loss_val': 0.41667462674228256, 'psi': 0.7400387871420666}
[S3] START round=16 head_norm_before_train=1.749299 (no previous merge yet)
[S3] round=16 local utility u=0.021514 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9984525617789213, 'loss_val': 0.21968714380136367, 'psi': 0.8197446262116919}-{'f1_val': 0.7009355793019081, 'auprc': 0.9979402465139341, 'loss_val': 0.2631556138334208, 'psi': 0.8197374461867185}
[S4] START round=16 head_norm_before_train=0.810107 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.094551 metrics={'f1_val': 0.6909530898353999, 'auprc': 0.9607156160003348, 'loss_val': 0.5283240242464686, 'psi': 0.7988581003013739}-{'f1_val': 0.6899902093731836, 'auprc': 0.9086313743936663, 'loss_val': 0.5553969373187124, 'psi': 0.7774466753813767}
[S5] START round=16 head_norm_before_train=1.227044 cos_to_last_merge=0.8661 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.866
[S5] round=16 local utility u=0.020952 metrics={'f1_val': 0.7025165861432486, 'auprc': 0.7917900547811916, 'loss_val': 0.45505061932770147, 'psi': 0.7382259735984258}-{'f1_val': 0.7005691551769304, 'auprc': 0.7920972221688913, 'loss_val': 0.486191805897809, 'psi': 0.7371803819737148}
[S6] START round=16 head_norm_before_train=0.748857 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.237031 metrics={'f1_val': 0.6960909406669673, 'auprc': 0.9630940027411056, 'loss_val': 0.5196317390202356, 'psi': 0.8028921654966226}-{'f1_val': 0.690177328748283, 'auprc': 0.8281187109712009, 'loss_val': 0.5532862841557626, 'psi': 0.7453538816374501}
[S7] START round=16 head_norm_before_train=0.839095 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.6352024416269263, 'auprc': 0.7883015711052497, 'loss_val': 0.777955723641504, 'psi': 0.6964420934182557}-{'f1_val': 0.6960778970611736, 'auprc': 0.7919190962493838, 'loss_val': 0.7813872430920542, 'psi': 0.7344143767364577}
[S8] START round=16 head_norm_before_train=1.717194 (no previous merge yet)
[S8] round=16 local utility u=0.015643 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9991957680532391, 'loss_val': 0.09560981653377276, 'psi': 0.9974901521826705}-{'f1_val': 0.996503822188793, 'auprc': 0.9991388945335727, 'loss_val': 0.12763023549961564, 'psi': 0.9975578511267048}
[S9] START round=16 head_norm_before_train=1.758473 (no previous merge yet)
[S9] round=16 local utility u=0.024080 metrics={'f1_val': 0.9958312226609984, 'auprc': 0.9984615594900494, 'loss_val': 0.07405295796907362, 'psi': 0.9968833573926188}-{'f1_val': 0.9912134460920485, 'auprc': 0.9984674674000275, 'loss_val': 0.09452341135427013, 'psi': 0.9941150546152402}
[S10] START round=16 head_norm_before_train=1.350795 cos_to_last_merge=0.8340 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.834
[S10] round=16 local utility u=0.280838 metrics={'f1_val': 0.833848607691241, 'auprc': 0.9481314606300333, 'loss_val': 0.45514557619226426, 'psi': 0.879561748866758}-{'f1_val': 0.7569163790127094, 'auprc': 0.9362573853230727, 'loss_val': 0.5196061325700361, 'psi': 0.8286527815368547}
[S11] START round=16 head_norm_before_train=1.316369 cos_to_last_merge=0.8483 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.848
[S11] round=16 local utility u=0.026775 metrics={'f1_val': 0.9585016148608851, 'auprc': 0.9981204503089052, 'loss_val': 0.19477629500097976, 'psi': 0.9743491490400932}-{'f1_val': 0.9544541079242251, 'auprc': 0.9981438691493573, 'loss_val': 0.22411228314193327, 'psi': 0.971930012414278}
[S13] START round=16 head_norm_before_train=1.555805 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.143989 metrics={'f1_val': 0.6541909276291471, 'auprc': 0.6655866827088275, 'loss_val': 0.6566699432466265, 'psi': 0.6587492296610192}-{'f1_val': 0.614399352660403, 'auprc': 0.6660293597701004, 'loss_val': 0.7072261722063851, 'psi': 0.635051355504282}
[S14] START round=16 head_norm_before_train=1.455962 cos_to_last_merge=0.8682 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.868
[S14] round=16 local utility u=0.016242 metrics={'f1_val': 0.9968429160880343, 'auprc': 0.9970635268856143, 'loss_val': 0.1123013632015968, 'psi': 0.9969311604070663}-{'f1_val': 0.9979077116553055, 'auprc': 0.9967296477563519, 'loss_val': 0.1501722989481668, 'psi': 0.997436486095724}
[S15] START round=16 head_norm_before_train=1.389230 cos_to_last_merge=0.8242 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.824
[S15] round=16 local utility u=0.762097 metrics={'f1_val': 0.8919279009038483, 'auprc': 0.9239391841679713, 'loss_val': 0.2568249660876768, 'psi': 0.9047324142094975}-{'f1_val': 0.7002952719526283, 'auprc': 0.8350872257288768, 'loss_val': 0.36466661408043616, 'psi': 0.7542120534631278}
[S16] START round=16 head_norm_before_train=0.822667 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.438439 metrics={'f1_val': 0.6098544023755849, 'auprc': 0.9255507759047613, 'loss_val': 0.8064059357886049, 'psi': 0.7361329517872555}-{'f1_val': 0.5488169388340784, 'auprc': 0.7657068696477762, 'loss_val': 0.8375268231310913, 'psi': 0.6355729111595576}
[S17] START round=16 head_norm_before_train=1.564664 (no previous merge yet)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.39379048117519566, 'auprc': 0.918163707009118, 'loss_val': 0.6129862876375498, 'psi': 0.6035397715087646}-{'f1_val': 0.39739437558616464, 'auprc': 0.9351804129611889, 'loss_val': 0.6382236991623087, 'psi': 0.6125087905361744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:36616
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:36602
[S4] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=0.9941
[S9] RECEIVED delta(kind=head bytes=1804) from S8
[S9] cosine check vs S8: cos=-0.0826
[S9] DROPPED delta from S8 (cos=-0.0826 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S4
[S16] cosine check vs S4: cos=0.9457
[S4] RECEIVED delta(kind=head bytes=1792) from S2
[S4] cosine check vs S2: cos=0.8341
[S4] RECEIVED delta(kind=head bytes=1798) from S15
[S4] cosine check vs S15: cos=0.5340
[S4] RECEIVED delta(kind=head bytes=1800) from S6
[S4] cosine check vs S6: cos=0.5848
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=-0.0294
[S5] DROPPED delta from S9 (cos=-0.0294 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S5
[S7] cosine check vs S5: cos=0.6109
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.7422
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] cosine check vs S16: cos=0.5055
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] cosine check vs S3: cos=0.5565
[S7] RECEIVED delta(kind=head bytes=1803) from S13
[S7] cosine check vs S13: cos=0.4698
[S6] RECEIVED delta(kind=head bytes=1792) from S10
[S6] cosine check vs S10: cos=0.6728
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.6352 head_norm=0.880418
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.774407e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.6419 head_norm=0.815828 delta_norm=0.177441
[S7] aggregate: ACCEPT kept=['S5', 'S14', 'S16', 'S13'] (k=4/4) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.6961 head_norm=0.804033
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.460528e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.6967 head_norm=0.944084 delta_norm=0.346053
[S6] aggregate: ACCEPT kept=['S3', 'S10'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.6910 head_norm=0.861436
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.730816e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9741 head_norm=0.841367 delta_norm=0.173082
[S4] aggregate: ACCEPT kept=['S2', 'S15', 'S6'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.7008 head_norm=1.362589
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.418818e-02
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.7006 head_norm=1.352895 delta_norm=0.074188
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.6099 head_norm=0.864220
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.422359e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.6078 head_norm=0.851025 delta_norm=0.142236
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.352895 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.7141424785346644, 'auprc': 0.777287626408335, 'loss_val': 0.5700316407322843, 'psi': 0.7394005376841326}-{'f1_val': 0.7007582966005393, 'auprc': 0.7977991278553722, 'loss_val': 0.38330240839644997, 'psi': 0.7395746291024725}
[S3] START round=17 head_norm_before_train=1.775113 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9968451924794157, 'loss_val': 0.23390776921610631, 'psi': 0.8191016784918896}-{'f1_val': 0.7006060025002057, 'auprc': 0.9984525617789213, 'loss_val': 0.21968714380136367, 'psi': 0.8197446262116919}
[S4] START round=17 head_norm_before_train=0.841367 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.817726 metrics={'f1_val': 0.959373198153502, 'auprc': 0.9569913558002686, 'loss_val': 0.49222049562101533, 'psi': 0.9584204612122087}-{'f1_val': 0.6909530898353999, 'auprc': 0.9607156160003348, 'loss_val': 0.5283240242464686, 'psi': 0.7988581003013739}
[S5] START round=17 head_norm_before_train=1.244004 cos_to_last_merge=0.8606 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.861
[S5] round=17 local utility u=0.325705 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9945925787331092, 'loss_val': 0.40036314936125494, 'psi': 0.818178524599402}-{'f1_val': 0.7025165861432486, 'auprc': 0.7917900547811916, 'loss_val': 0.45505061932770147, 'psi': 0.7382259735984258}
[S6] START round=17 head_norm_before_train=0.944084 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.6727681642365395, 'auprc': 0.9463179142506635, 'loss_val': 0.4582396052571296, 'psi': 0.7821880642421891}-{'f1_val': 0.6960909406669673, 'auprc': 0.9630940027411056, 'loss_val': 0.5196317390202356, 'psi': 0.8028921654966226}
[S7] START round=17 head_norm_before_train=0.815828 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.094837 metrics={'f1_val': 0.657487087276247, 'auprc': 0.7779847334748082, 'loss_val': 0.6910387825871798, 'psi': 0.7056861457556716}-{'f1_val': 0.6352024416269263, 'auprc': 0.7883015711052497, 'loss_val': 0.777955723641504, 'psi': 0.6964420934182557}
[S8] START round=17 head_norm_before_train=1.749217 (no previous merge yet)
[S8] round=17 local utility u=0.011868 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9991927312450317, 'loss_val': 0.07358587734814724, 'psi': 0.9976610170866724}-{'f1_val': 0.9963530749356245, 'auprc': 0.9991957680532391, 'loss_val': 0.09560981653377276, 'psi': 0.9974901521826705}
[S9] START round=17 head_norm_before_train=1.780428 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9984623540010378, 'loss_val': 0.062004256033393136, 'psi': 0.9956302465942402}-{'f1_val': 0.9958312226609984, 'auprc': 0.9984615594900494, 'loss_val': 0.07405295796907362, 'psi': 0.9968833573926188}
[S10] START round=17 head_norm_before_train=1.384281 cos_to_last_merge=0.8245 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.825
[S10] round=17 local utility u=0.710519 metrics={'f1_val': 0.994371642699025, 'auprc': 0.9971123519728169, 'loss_val': 0.14418796662889935, 'psi': 0.9954679264085418}-{'f1_val': 0.833848607691241, 'auprc': 0.9481314606300333, 'loss_val': 0.45514557619226426, 'psi': 0.879561748866758}
[S11] START round=17 head_norm_before_train=1.347223 cos_to_last_merge=0.8443 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.844
[S11] round=17 local utility u=0.131396 metrics={'f1_val': 0.9977899766664319, 'auprc': 0.9981222255733702, 'loss_val': 0.1677195276584817, 'psi': 0.9979228762292072}-{'f1_val': 0.9585016148608851, 'auprc': 0.9981204503089052, 'loss_val': 0.19477629500097976, 'psi': 0.9743491490400932}
[S13] START round=17 head_norm_before_train=1.575966 cos_to_last_merge=0.9994 (last merge round=15)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5574889765397275, 'auprc': 0.6668565208862572, 'loss_val': 0.7258080928161679, 'psi': 0.6012359942783394}-{'f1_val': 0.6541909276291471, 'auprc': 0.6655866827088275, 'loss_val': 0.6566699432466265, 'psi': 0.6587492296610192}
[S14] START round=17 head_norm_before_train=1.499757 cos_to_last_merge=0.8634 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.863
[S14] round=17 local utility u=0.017278 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9970587375711893, 'loss_val': 0.08504690901379283, 'psi': 0.9976609149376836}-{'f1_val': 0.9968429160880343, 'auprc': 0.9970635268856143, 'loss_val': 0.1123013632015968, 'psi': 0.9969311604070663}
[S15] START round=17 head_norm_before_train=1.429867 cos_to_last_merge=0.8140 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.814
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6990857470449244, 'auprc': 0.843358318582885, 'loss_val': 0.3537260158261183, 'psi': 0.7567947756601087}-{'f1_val': 0.8919279009038483, 'auprc': 0.9239391841679713, 'loss_val': 0.2568249660876768, 'psi': 0.9047324142094975}
[S16] START round=17 head_norm_before_train=0.851025 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.123538 metrics={'f1_val': 0.6211017015047944, 'auprc': 0.9712837213748862, 'loss_val': 0.7640119817148963, 'psi': 0.761174509452831}-{'f1_val': 0.6098544023755849, 'auprc': 0.9255507759047613, 'loss_val': 0.8064059357886049, 'psi': 0.7361329517872555}
[S17] START round=17 head_norm_before_train=1.587457 (no previous merge yet)
[S17] round=17 local utility u=0.069056 metrics={'f1_val': 0.3973831614180041, 'auprc': 0.9495943322358302, 'loss_val': 0.5907224999948717, 'psi': 0.6182676297451346}-{'f1_val': 0.39379048117519566, 'auprc': 0.918163707009118, 'loss_val': 0.6129862876375498, 'psi': 0.6035397715087646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:36608
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:36608
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:36610
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:36602
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S16
[S7] cosine check vs S16: cos=0.5474
[S2] RECEIVED delta(kind=head bytes=1795) from S11
[S2] cosine check vs S11: cos=0.9946
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] cosine check vs S8: cos=-0.0818
[S9] DROPPED delta from S8 (cos=-0.0818 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S4
[S16] cosine check vs S4: cos=0.9610
[S7] RECEIVED delta(kind=head bytes=1801) from S5
[S7] cosine check vs S5: cos=0.6740
[S6] RECEIVED delta(kind=head bytes=1800) from S10
[S6] cosine check vs S10: cos=0.6838
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.6333
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] cosine check vs S7: cos=0.3204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S17
[S13] cosine check vs S17: cos=0.9910
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.7141 head_norm=1.393357
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.260877e-02
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.7141 head_norm=1.384110 delta_norm=0.072609
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.5575 head_norm=1.598956
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.076252e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.5590 head_norm=1.602076 delta_norm=0.107625
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.6728 head_norm=0.991298
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.521676e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.6732 head_norm=0.860679 delta_norm=0.352168
[S6] aggregate: ACCEPT kept=['S10', 'S7'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.6575 head_norm=0.859040
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.065455e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.6643 head_norm=0.795153 delta_norm=0.206545
[S7] aggregate: ACCEPT kept=['S16', 'S5', 'S14'] (k=3/3) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.6211 head_norm=0.896904
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.252051e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.6101 head_norm=0.888058 delta_norm=0.125205
[S16] aggregate: ROLLBACK (f1_val pre=0.621 post=0.610 tol_abs=0.005 tol_rel=0.0)
[S2] START round=18 head_norm_before_train=1.384110 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.082242 metrics={'f1_val': 0.7009489536441844, 'auprc': 0.7834793113988955, 'loss_val': 0.3449615921807083, 'psi': 0.7339610967460688}-{'f1_val': 0.7141424785346644, 'auprc': 0.777287626408335, 'loss_val': 0.5700316407322843, 'psi': 0.7394005376841326}
[S3] START round=18 head_norm_before_train=1.801469 (no previous merge yet)
[S3] round=18 local utility u=0.670362 metrics={'f1_val': 0.9126089663688433, 'auprc': 0.9969545683468077, 'loss_val': 0.16553027496498118, 'psi': 0.9463472071600291}-{'f1_val': 0.7006060025002057, 'auprc': 0.9968451924794157, 'loss_val': 0.23390776921610631, 'psi': 0.8191016784918896}
[S4] START round=18 head_norm_before_train=0.896777 cos_to_last_merge=0.9967 (last merge round=16)
[S4] round=18 local utility u=0.004677 metrics={'f1_val': 0.9508177215998384, 'auprc': 0.9589934240233559, 'loss_val': 0.43753973422870757, 'psi': 0.9540880025692453}-{'f1_val': 0.959373198153502, 'auprc': 0.9569913558002686, 'loss_val': 0.49222049562101533, 'psi': 0.9584204612122087}
[S5] START round=18 head_norm_before_train=1.262083 cos_to_last_merge=0.8544 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.854
[S5] round=18 local utility u=0.018237 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9947153806776338, 'loss_val': 0.36425694959466604, 'psi': 0.8182276453772117}-{'f1_val': 0.7005691551769304, 'auprc': 0.9945925787331092, 'loss_val': 0.40036314936125494, 'psi': 0.818178524599402}
[S6] START round=18 head_norm_before_train=0.860679 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.7034580609094463, 'auprc': 0.7745330917784781, 'loss_val': 0.574198739000262, 'psi': 0.731888073257059}-{'f1_val': 0.6727681642365395, 'auprc': 0.9463179142506635, 'loss_val': 0.4582396052571296, 'psi': 0.7821880642421891}
[S7] START round=18 head_norm_before_train=0.795153 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.6274083068732549, 'auprc': 0.6504409752532169, 'loss_val': 0.7421774813539854, 'psi': 0.6366213742252397}-{'f1_val': 0.657487087276247, 'auprc': 0.7779847334748082, 'loss_val': 0.6910387825871798, 'psi': 0.7056861457556716}
[S8] START round=18 head_norm_before_train=1.778956 (no previous merge yet)
[S8] round=18 local utility u=0.002772 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9992660263442963, 'loss_val': 0.06826149300070927, 'psi': 0.9976903351263782}-{'f1_val': 0.9966398743144329, 'auprc': 0.9991927312450317, 'loss_val': 0.07358587734814724, 'psi': 0.9976610170866724}
[S9] START round=18 head_norm_before_train=1.804417 (no previous merge yet)
[S9] round=18 local utility u=0.011438 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984609566596865, 'loss_val': 0.05163108502535668, 'psi': 0.9968804136823859}-{'f1_val': 0.9937421749897083, 'auprc': 0.9984623540010378, 'loss_val': 0.062004256033393136, 'psi': 0.9956302465942402}
[S10] START round=18 head_norm_before_train=1.417322 cos_to_last_merge=0.8165 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.816
[S10] round=18 local utility u=0.008528 metrics={'f1_val': 0.9940781910149686, 'auprc': 0.9934573126618302, 'loss_val': 0.11440705379126206, 'psi': 0.9938298396737133}-{'f1_val': 0.994371642699025, 'auprc': 0.9971123519728169, 'loss_val': 0.14418796662889935, 'psi': 0.9954679264085418}
[S11] START round=18 head_norm_before_train=1.378631 cos_to_last_merge=0.8409 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.841
[S11] round=18 local utility u=0.013978 metrics={'f1_val': 0.9971131773242197, 'auprc': 0.9980775068567327, 'loss_val': 0.13556953194832444, 'psi': 0.9974989091372248}-{'f1_val': 0.9977899766664319, 'auprc': 0.9981222255733702, 'loss_val': 0.1677195276584817, 'psi': 0.9979228762292072}
[S13] START round=18 head_norm_before_train=1.602076 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.557262986644017, 'auprc': 0.6675793619208357, 'loss_val': 0.7374794687408063, 'psi': 0.6013895367547445}-{'f1_val': 0.5574889765397275, 'auprc': 0.6668565208862572, 'loss_val': 0.7258080928161679, 'psi': 0.6012359942783394}
[S14] START round=18 head_norm_before_train=1.539287 cos_to_last_merge=0.8590 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.859
[S14] round=18 local utility u=0.005549 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9970579356924784, 'loss_val': 0.07015839521444123, 'psi': 0.997281804581369}-{'f1_val': 0.9980623665153463, 'auprc': 0.9970587375711893, 'loss_val': 0.08504690901379283, 'psi': 0.9976609149376836}
[S15] START round=18 head_norm_before_train=1.462895 cos_to_last_merge=0.8062 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.806
[S15] round=18 local utility u=0.385169 metrics={'f1_val': 0.7299277415852866, 'auprc': 0.9868739352771622, 'loss_val': 0.1989859017473325, 'psi': 0.8327062190620369}-{'f1_val': 0.6990857470449244, 'auprc': 0.843358318582885, 'loss_val': 0.3537260158261183, 'psi': 0.7567947756601087}
[S16] START round=18 head_norm_before_train=0.888058 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.6074471923417368, 'auprc': 0.9790927828493727, 'loss_val': 0.7367323366651034, 'psi': 0.7561054285447912}-{'f1_val': 0.6211017015047944, 'auprc': 0.9712837213748862, 'loss_val': 0.7640119817148963, 'psi': 0.761174509452831}
[S17] START round=18 head_norm_before_train=1.612389 (no previous merge yet)
[S17] round=18 local utility u=0.536915 metrics={'f1_val': 0.5578855152755626, 'auprc': 0.9523831890479162, 'loss_val': 0.48827274770619544, 'psi': 0.715684584784504}-{'f1_val': 0.3973831614180041, 'auprc': 0.9495943322358302, 'loss_val': 0.5907224999948717, 'psi': 0.6182676297451346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:36604
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:36607
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:36602
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S4
[S16] cosine check vs S4: cos=0.9677
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] cosine check vs S8: cos=-0.0813
[S9] DROPPED delta from S8 (cos=-0.0813 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=-0.0273
[S5] DROPPED delta from S9 (cos=-0.0273 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1804) from S14
[S7] cosine check vs S14: cos=0.6724
[S7] RECEIVED delta(kind=head bytes=1795) from S5
[S7] cosine check vs S5: cos=0.5862
[S4] RECEIVED delta(kind=head bytes=1796) from S15
[S4] cosine check vs S15: cos=0.6579
[S6] RECEIVED delta(kind=head bytes=1797) from S3
[S6] cosine check vs S3: cos=0.4869
[S2] RECEIVED delta(kind=head bytes=1793) from S11
[S2] cosine check vs S11: cos=0.9953
[S6] RECEIVED delta(kind=head bytes=1797) from S10
[S6] cosine check vs S10: cos=0.8141
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=0.8077
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=0.9945
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.5573 head_norm=1.625775
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.559219e-02
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.5585 head_norm=1.630225 delta_norm=0.085592
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.7035 head_norm=0.899574
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.280603e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.7033 head_norm=1.018393 delta_norm=0.328060
[S6] aggregate: ACCEPT kept=['S3', 'S10'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.6274 head_norm=0.835147
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.412951e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.6234 head_norm=0.902637 delta_norm=0.241295
[S7] aggregate: ACCEPT kept=['S14', 'S5'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.6074 head_norm=0.937418
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.200692e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.6059 head_norm=0.936123 delta_norm=0.120069
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.9508 head_norm=0.950122
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.938684e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.9507 head_norm=1.047675 delta_norm=0.293868
[S4] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.7009 head_norm=1.421274
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.879700e-02
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.7008 head_norm=1.413231 delta_norm=0.068797
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.413231 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.703988638438759, 'auprc': 0.7917149984731605, 'loss_val': 0.392865254616821, 'psi': 0.7390791824525196}-{'f1_val': 0.7009489536441844, 'auprc': 0.7834793113988955, 'loss_val': 0.3449615921807083, 'psi': 0.7339610967460688}
[S3] START round=19 head_norm_before_train=1.827049 (no previous merge yet)
[S3] round=19 local utility u=0.197812 metrics={'f1_val': 0.9741656626640106, 'auprc': 0.9970204923892658, 'loss_val': 0.13944437128375656, 'psi': 0.9833075945541127}-{'f1_val': 0.9126089663688433, 'auprc': 0.9969545683468077, 'loss_val': 0.16553027496498118, 'psi': 0.9463472071600291}
[S4] START round=19 head_norm_before_train=1.047675 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.048215 metrics={'f1_val': 0.9560152824290397, 'auprc': 0.9599275826473394, 'loss_val': 0.3750966605627711, 'psi': 0.9575802025163596}-{'f1_val': 0.9508177215998384, 'auprc': 0.9589934240233559, 'loss_val': 0.43753973422870757, 'psi': 0.9540880025692453}
[S5] START round=19 head_norm_before_train=1.285309 cos_to_last_merge=0.8463 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.846
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7144667326210086, 'auprc': 0.7906661121392045, 'loss_val': 0.5606809464693959, 'psi': 0.7449464844282869}-{'f1_val': 0.7005691551769304, 'auprc': 0.9947153806776338, 'loss_val': 0.36425694959466604, 'psi': 0.8182276453772117}
[S6] START round=19 head_norm_before_train=1.018393 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.305697 metrics={'f1_val': 0.6803046503808077, 'auprc': 0.9634003094429322, 'loss_val': 0.39048582945695337, 'psi': 0.7935429140056575}-{'f1_val': 0.7034580609094463, 'auprc': 0.7745330917784781, 'loss_val': 0.574198739000262, 'psi': 0.731888073257059}
[S7] START round=19 head_norm_before_train=0.902637 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.3973046594055103, 'auprc': 0.6134468168373113, 'loss_val': 1.0296447309340664, 'psi': 0.48376152237823067}-{'f1_val': 0.6274083068732549, 'auprc': 0.6504409752532169, 'loss_val': 0.7421774813539854, 'psi': 0.6366213742252397}
[S8] START round=19 head_norm_before_train=1.806115 (no previous merge yet)
[S8] round=19 local utility u=0.009101 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9992752870175383, 'loss_val': 0.050088267088556716, 'psi': 0.997694039395675}-{'f1_val': 0.9966398743144329, 'auprc': 0.9992660263442963, 'loss_val': 0.06826149300070927, 'psi': 0.9976903351263782}
[S9] START round=19 head_norm_before_train=1.826468 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9984689625939853, 'loss_val': 0.04889994350209924, 'psi': 0.9946267771656301}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984609566596865, 'loss_val': 0.05163108502535668, 'psi': 0.9968804136823859}
[S10] START round=19 head_norm_before_train=1.445760 cos_to_last_merge=0.8095 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.809
[S10] round=19 local utility u=0.003876 metrics={'f1_val': 0.9936984912981479, 'auprc': 0.9932663146530841, 'loss_val': 0.10380394238386023, 'psi': 0.9935256206401224}-{'f1_val': 0.9940781910149686, 'auprc': 0.9934573126618302, 'loss_val': 0.11440705379126206, 'psi': 0.9938298396737133}
[S11] START round=19 head_norm_before_train=1.408506 cos_to_last_merge=0.8383 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.838
[S11] round=19 local utility u=0.010049 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9981461493831966, 'loss_val': 0.11476301629617136, 'psi': 0.9974349576000554}-{'f1_val': 0.9971131773242197, 'auprc': 0.9980775068567327, 'loss_val': 0.13556953194832444, 'psi': 0.9974989091372248}
[S13] START round=19 head_norm_before_train=1.630225 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.115517 metrics={'f1_val': 0.5927042637797622, 'auprc': 0.663055480541851, 'loss_val': 0.7055206053637423, 'psi': 0.6208447504845978}-{'f1_val': 0.557262986644017, 'auprc': 0.6675793619208357, 'loss_val': 0.7374794687408063, 'psi': 0.6013895367547445}
[S14] START round=19 head_norm_before_train=1.573707 cos_to_last_merge=0.8556 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.856
[S14] round=19 local utility u=0.002806 metrics={'f1_val': 0.9972630104447024, 'auprc': 0.9969686105964258, 'loss_val': 0.06327047032692276, 'psi': 0.9971452505053918}-{'f1_val': 0.9974310505072961, 'auprc': 0.9970579356924784, 'loss_val': 0.07015839521444123, 'psi': 0.997281804581369}
[S15] START round=19 head_norm_before_train=1.490665 cos_to_last_merge=0.8001 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.800
[S15] round=19 local utility u=0.377984 metrics={'f1_val': 0.8771089526482255, 'auprc': 0.9531950183605741, 'loss_val': 0.2250694173291044, 'psi': 0.907543378933165}-{'f1_val': 0.7299277415852866, 'auprc': 0.9868739352771622, 'loss_val': 0.1989859017473325, 'psi': 0.8327062190620369}
[S16] START round=19 head_norm_before_train=0.936123 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=1.000000 metrics={'f1_val': 0.908986556534993, 'auprc': 0.984761550318241, 'loss_val': 0.5322662312342051, 'psi': 0.9392965540482923}-{'f1_val': 0.6074471923417368, 'auprc': 0.9790927828493727, 'loss_val': 0.7367323366651034, 'psi': 0.7561054285447912}
[S17] START round=19 head_norm_before_train=1.639138 (no previous merge yet)
[S17] round=19 local utility u=0.103556 metrics={'f1_val': 0.6143773046771559, 'auprc': 0.9488453441103768, 'loss_val': 0.6094979397457683, 'psi': 0.7481645204504442}-{'f1_val': 0.5578855152755626, 'auprc': 0.9523831890479162, 'loss_val': 0.48827274770619544, 'psi': 0.715684584784504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:36608
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:36610
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:36602
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] cosine check vs S3: cos=0.6969
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.7459
[S16] RECEIVED delta(kind=head bytes=1794) from S4
[S16] cosine check vs S4: cos=0.9434
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] cosine check vs S8: cos=-0.0806
[S9] DROPPED delta from S8 (cos=-0.0806 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=0.7475
[S7] RECEIVED delta(kind=head bytes=1792) from S16
[S7] cosine check vs S16: cos=0.5440
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=0.9959
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] cosine check vs S6: cos=0.2500
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=0.4084
[S4] RECEIVED delta(kind=head bytes=1797) from S15
[S4] cosine check vs S15: cos=0.7739
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S17
[S13] cosine check vs S17: cos=0.9958
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.7040 head_norm=1.446346
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.551737e-02
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.7018 head_norm=1.442231 delta_norm=0.065517
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.739 u=0.0000 p_local=0.0942 f1=0.704 auprc=0.792 bytes=28726
[S9] r=20 psi=0.995 u=0.0000 p_local=0.0939 f1=0.992 auprc=0.998 bytes=30564
[S5] r=20 psi=0.745 u=0.0000 p_local=0.1247 f1=0.714 auprc=0.791 bytes=23359
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.3973 head_norm=0.938256
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.482962e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.3962 head_norm=0.871743 delta_norm=0.248296
[S7] aggregate: ACCEPT kept=['S14', 'S16', 'S13'] (k=3/3) mode=median trim_p=0.1
[S7] r=20 psi=0.484 u=0.0000 p_local=0.1262 f1=0.397 auprc=0.613 bytes=26951
[S11] r=20 psi=0.997 u=0.0100 p_local=0.1519 f1=0.997 auprc=0.998 bytes=30502
[S10] r=20 psi=0.994 u=0.0039 p_local=0.2613 f1=0.994 auprc=0.993 bytes=25139
[S3] r=20 psi=0.983 u=0.1978 p_local=0.1894 f1=0.974 auprc=0.997 bytes=25150
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.9090 head_norm=0.987598
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.830074e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.9473 head_norm=1.026377 delta_norm=0.183007
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] r=20 psi=0.939 u=1.0000 p_local=0.3370 f1=0.909 auprc=0.985 bytes=21564
[S15] r=20 psi=0.908 u=0.3780 p_local=0.2813 f1=0.877 auprc=0.953 bytes=25149
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.5927 head_norm=1.657225
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.567465e-02
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.5942 head_norm=1.657264 delta_norm=0.075675
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.621 u=0.1155 p_local=0.1046 f1=0.593 auprc=0.663 bytes=19766
[S8] r=20 psi=0.998 u=0.0091 p_local=0.1264 f1=0.997 auprc=0.999 bytes=30580
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.6803 head_norm=1.054013
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.721179e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.6795 head_norm=1.134473 delta_norm=0.172118
[S6] aggregate: ACCEPT kept=['S3', 'S10'] (k=2/2) mode=median trim_p=0.1
[S6] r=20 psi=0.794 u=0.3057 p_local=0.1771 f1=0.680 auprc=0.963 bytes=23358
[S14] r=20 psi=0.997 u=0.0028 p_local=0.0893 f1=0.997 auprc=0.997 bytes=28786
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9560 head_norm=1.094775
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.641087e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9537 head_norm=0.959091 delta_norm=0.364109
[S4] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S4] r=20 psi=0.958 u=0.0482 p_local=0.2292 f1=0.956 auprc=0.960 bytes=25171
[S17] r=20 psi=0.748 u=0.1036 p_local=0.1741 f1=0.614 auprc=0.949 bytes=23382
[S2] START round=20 head_norm_before_train=1.442231 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7005925029290768, 'auprc': 0.7164659956278996, 'loss_val': 0.36078527341561284, 'psi': 0.7069419000086059}-{'f1_val': 0.703988638438759, 'auprc': 0.7917149984731605, 'loss_val': 0.392865254616821, 'psi': 0.7390791824525196}
[S3] START round=20 head_norm_before_train=1.850460 (no previous merge yet)
[S3] round=20 local utility u=0.066193 metrics={'f1_val': 0.9910903729470883, 'auprc': 0.9970742056702914, 'loss_val': 0.10876751777520559, 'psi': 0.9934839060363695}-{'f1_val': 0.9741656626640106, 'auprc': 0.9970204923892658, 'loss_val': 0.13944437128375656, 'psi': 0.9833075945541127}
[S4] START round=20 head_norm_before_train=0.959091 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9507186612164317, 'auprc': 0.9448222933444452, 'loss_val': 0.407721743389534, 'psi': 0.9483601140676371}-{'f1_val': 0.9560152824290397, 'auprc': 0.9599275826473394, 'loss_val': 0.3750966605627711, 'psi': 0.9575802025163596}
[S5] START round=20 head_norm_before_train=1.311612 cos_to_last_merge=0.8387 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.839
[S5] round=20 local utility u=0.386600 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9962841625059173, 'loss_val': 0.32094972704653524, 'psi': 0.8188551581085253}-{'f1_val': 0.7144667326210086, 'auprc': 0.7906661121392045, 'loss_val': 0.5606809464693959, 'psi': 0.7449464844282869}
[S6] START round=20 head_norm_before_train=1.134473 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.5770317628914408, 'auprc': 0.7720505218569101, 'loss_val': 0.6992588335381577, 'psi': 0.6550392664776286}-{'f1_val': 0.6803046503808077, 'auprc': 0.9634003094429322, 'loss_val': 0.39048582945695337, 'psi': 0.7935429140056575}
[S7] START round=20 head_norm_before_train=0.871743 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=1.000000 metrics={'f1_val': 0.6993987747369312, 'auprc': 0.9863594468720434, 'loss_val': 0.4808024470841856, 'psi': 0.814183043590976}-{'f1_val': 0.3973046594055103, 'auprc': 0.6134468168373113, 'loss_val': 1.0296447309340664, 'psi': 0.48376152237823067}
[S8] START round=20 head_norm_before_train=1.832083 (no previous merge yet)
[S8] round=20 local utility u=0.002948 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9992666956488323, 'loss_val': 0.04416742035299832, 'psi': 0.9976906028481927}-{'f1_val': 0.9966398743144329, 'auprc': 0.9992752870175383, 'loss_val': 0.050088267088556716, 'psi': 0.997694039395675}
[S9] START round=20 head_norm_before_train=1.848103 (no previous merge yet)
[S9] round=20 local utility u=0.004383 metrics={'f1_val': 0.9926544572506684, 'auprc': 0.9984702890762668, 'loss_val': 0.04367220985940029, 'psi': 0.9949807899809078}-{'f1_val': 0.9920653202133933, 'auprc': 0.9984689625939853, 'loss_val': 0.04889994350209924, 'psi': 0.9946267771656301}
[S10] START round=20 head_norm_before_train=1.466732 cos_to_last_merge=0.8045 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.805
[S10] round=20 local utility u=0.006496 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9969256392417809, 'loss_val': 0.09600494382147748, 'psi': 0.9944109348648369}-{'f1_val': 0.9936984912981479, 'auprc': 0.9932663146530841, 'loss_val': 0.10380394238386023, 'psi': 0.9935256206401224}
[S11] START round=20 head_norm_before_train=1.441086 cos_to_last_merge=0.8352 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.835
[S11] round=20 local utility u=0.006372 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980248539051257, 'loss_val': 0.09917162677285525, 'psi': 0.9971381442702041}-{'f1_val': 0.996960829744628, 'auprc': 0.9981461493831966, 'loss_val': 0.11476301629617136, 'psi': 0.9974349576000554}
[S13] START round=20 head_norm_before_train=1.657264 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5475662603173362, 'auprc': 0.6706498472071252, 'loss_val': 0.7842704755724778, 'psi': 0.5967996950732518}-{'f1_val': 0.5927042637797622, 'auprc': 0.663055480541851, 'loss_val': 0.7055206053637423, 'psi': 0.6208447504845978}
[S14] START round=20 head_norm_before_train=1.603165 cos_to_last_merge=0.8527 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.853
[S14] round=20 local utility u=0.001639 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9970559830533817, 'loss_val': 0.057341752300406675, 'psi': 0.9968888577928144}-{'f1_val': 0.9972630104447024, 'auprc': 0.9969686105964258, 'loss_val': 0.06327047032692276, 'psi': 0.9971452505053918}
[S15] START round=20 head_norm_before_train=1.517875 cos_to_last_merge=0.7940 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.794
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.8355638697400622, 'auprc': 0.9292269444793844, 'loss_val': 0.2364141849081317, 'psi': 0.8730290996357911}-{'f1_val': 0.8771089526482255, 'auprc': 0.9531950183605741, 'loss_val': 0.2250694173291044, 'psi': 0.907543378933165}
[S16] START round=20 head_norm_before_train=1.026377 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.226521 metrics={'f1_val': 0.9682329149342043, 'auprc': 0.9859240714976478, 'loss_val': 0.43818936438627293, 'psi': 0.9753093775595818}-{'f1_val': 0.908986556534993, 'auprc': 0.984761550318241, 'loss_val': 0.5322662312342051, 'psi': 0.9392965540482923}
[S17] START round=20 head_norm_before_train=1.660754 (no previous merge yet)
[S17] round=20 local utility u=0.354969 metrics={'f1_val': 0.7063661147721063, 'auprc': 0.9586599683201719, 'loss_val': 0.4809375710251699, 'psi': 0.8072836561913326}-{'f1_val': 0.6143773046771559, 'auprc': 0.9488453441103768, 'loss_val': 0.6094979397457683, 'psi': 0.7481645204504442}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:36610
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:36608
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:36608
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] cosine check vs S8: cos=-0.0797
[S9] DROPPED delta from S8 (cos=-0.0797 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S3
[S6] cosine check vs S3: cos=0.7612
[S7] RECEIVED delta(kind=head bytes=1799) from S5
[S7] cosine check vs S5: cos=0.4929
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=0.2343
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=0.9966
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.7563
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] cosine check vs S9: cos=-0.0251
[S5] DROPPED delta from S9 (cos=-0.0251 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S10
[S6] cosine check vs S10: cos=0.7046
[S7] RECEIVED delta(kind=head bytes=1794) from S16
[S7] cosine check vs S16: cos=0.6699
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] cosine check vs S17: cos=0.9964
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.5770 head_norm=1.163516
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.725650e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.6239 head_norm=0.974328 delta_norm=0.272565
[S6] aggregate: ACCEPT kept=['S3', 'S7', 'S10'] (k=3/3) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.142 → S4@127.0.0.1:36604
[S4] ⇄ pheromone p=0.183 → S16@127.0.0.1:36616
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.7006 head_norm=1.470821
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.114216e-02
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.7006 head_norm=1.471989 delta_norm=0.061142
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.075 → S4@127.0.0.1:36604
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.5476 head_norm=1.684175
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.151613e-02
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.5452 head_norm=1.686087 delta_norm=0.071516
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.084 → S7@127.0.0.1:36608
[S3] ⇄ pheromone p=0.165 → S6@127.0.0.1:36607
[S10] ⇄ pheromone p=0.210 → S6@127.0.0.1:36607
[S9] ⇄ pheromone p=0.076 → S5@127.0.0.1:36605
[S16] ⇄ pheromone p=0.315 → S7@127.0.0.1:36608
[S11] ⇄ pheromone p=0.123 → S2@127.0.0.1:36602
[S8] ⇄ pheromone p=0.102 → S9@127.0.0.1:36610
[S14] ⇄ pheromone p=0.072 → S7@127.0.0.1:36608
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.6994 head_norm=0.900491
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.476494e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.6994 head_norm=0.881400 delta_norm=0.147649
[S7] aggregate: ACCEPT kept=['S5', 'S14', 'S16'] (k=3/3) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.301 → S6@127.0.0.1:36607
[S5] ⇄ pheromone p=0.177 → S7@127.0.0.1:36608
[S15] ⇄ pheromone p=0.225 → S4@127.0.0.1:36604
[S17] ⇄ pheromone p=0.210 → S13@127.0.0.1:36613
[S2] START round=21 head_norm_before_train=1.471989 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.6996906525731519, 'auprc': 0.6848886280111486, 'loss_val': 0.36296968957031084, 'psi': 0.6937698427483505}-{'f1_val': 0.7005925029290768, 'auprc': 0.7164659956278996, 'loss_val': 0.36078527341561284, 'psi': 0.7069419000086059}
[S3] START round=21 head_norm_before_train=1.870710 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9983032126508291, 'loss_val': 0.1201180871880568, 'psi': 0.9759187375400333}-{'f1_val': 0.9910903729470883, 'auprc': 0.9970742056702914, 'loss_val': 0.10876751777520559, 'psi': 0.9934839060363695}
[S4] START round=21 head_norm_before_train=0.996748 cos_to_last_merge=0.9987 (last merge round=19)
[S4] round=21 local utility u=0.127651 metrics={'f1_val': 0.9674913988081468, 'auprc': 0.9635197232548506, 'loss_val': 0.30914858354473573, 'psi': 0.9659027285868284}-{'f1_val': 0.9507186612164317, 'auprc': 0.9448222933444452, 'loss_val': 0.407721743389534, 'psi': 0.9483601140676371}
[S5] START round=21 head_norm_before_train=1.330523 cos_to_last_merge=0.8322 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8413923574069575, 'loss_val': 0.32419355764910074, 'psi': 0.7569219785603876}-{'f1_val': 0.7005691551769304, 'auprc': 0.9962841625059173, 'loss_val': 0.32094972704653524, 'psi': 0.8188551581085253}
[S6] START round=21 head_norm_before_train=0.974328 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=1.000000 metrics={'f1_val': 0.8085494459453312, 'auprc': 0.9610003409864556, 'loss_val': 0.37396662037880213, 'psi': 0.8695298039617809}-{'f1_val': 0.5770317628914408, 'auprc': 0.7720505218569101, 'loss_val': 0.6992588335381577, 'psi': 0.6550392664776286}
[S7] START round=21 head_norm_before_train=0.881400 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.4064533540298504, 'auprc': 0.6218165995859603, 'loss_val': 1.0395599155369797, 'psi': 0.4925986522522944}-{'f1_val': 0.6993987747369312, 'auprc': 0.9863594468720434, 'loss_val': 0.4808024470841856, 'psi': 0.814183043590976}
[S8] START round=21 head_norm_before_train=1.855834 (no previous merge yet)
[S8] round=21 local utility u=0.002911 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9992283946925123, 'loss_val': 0.03823115748493324, 'psi': 0.9976752824656646}-{'f1_val': 0.9966398743144329, 'auprc': 0.9992666956488323, 'loss_val': 0.04416742035299832, 'psi': 0.9976906028481927}
[S9] START round=21 head_norm_before_train=1.869499 (no previous merge yet)
[S9] round=21 local utility u=0.010416 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.994977486467816, 'loss_val': 0.03639796996920014, 'psi': 0.9959873016754612}-{'f1_val': 0.9926544572506684, 'auprc': 0.9984702890762668, 'loss_val': 0.04367220985940029, 'psi': 0.9949807899809078}
[S10] START round=21 head_norm_before_train=1.483422 cos_to_last_merge=0.8012 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.801
[S10] round=21 local utility u=0.004749 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9961156547397744, 'loss_val': 0.08801653965464788, 'psi': 0.9944808720968044}-{'f1_val': 0.9927344652802075, 'auprc': 0.9969256392417809, 'loss_val': 0.09600494382147748, 'psi': 0.9944109348648369}
[S11] START round=21 head_norm_before_train=1.475692 cos_to_last_merge=0.8322 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.832
[S11] round=21 local utility u=0.007495 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980362454121541, 'loss_val': 0.08421619169784317, 'psi': 0.9971427008730154}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980248539051257, 'loss_val': 0.09917162677285525, 'psi': 0.9971381442702041}
[S13] START round=21 head_norm_before_train=1.686087 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.049467 metrics={'f1_val': 0.5569094183474288, 'auprc': 0.6749211022178851, 'loss_val': 0.754208219510376, 'psi': 0.6041140918956114}-{'f1_val': 0.5475662603173362, 'auprc': 0.6706498472071252, 'loss_val': 0.7842704755724778, 'psi': 0.5967996950732518}
[S14] START round=21 head_norm_before_train=1.633380 cos_to_last_merge=0.8497 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.850
[S14] round=21 local utility u=0.006011 metrics={'f1_val': 0.9975994502496334, 'auprc': 0.9970583261239313, 'loss_val': 0.05025883699559939, 'psi': 0.9973830005993525}-{'f1_val': 0.9967774409524363, 'auprc': 0.9970559830533817, 'loss_val': 0.057341752300406675, 'psi': 0.9968888577928144}
[S15] START round=21 head_norm_before_train=1.546496 cos_to_last_merge=0.7876 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.788
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7588243761102247, 'auprc': 0.8685962381934763, 'loss_val': 0.32178907205004537, 'psi': 0.8027331209435253}-{'f1_val': 0.8355638697400622, 'auprc': 0.9292269444793844, 'loss_val': 0.2364141849081317, 'psi': 0.8730290996357911}
[S16] START round=21 head_norm_before_train=1.079902 cos_to_last_merge=0.9955 (last merge round=19)
[S16] round=21 local utility u=0.112375 metrics={'f1_val': 0.9856516925390142, 'auprc': 0.9869784271162471, 'loss_val': 0.32111453059975553, 'psi': 0.9861823863699073}-{'f1_val': 0.9682329149342043, 'auprc': 0.9859240714976478, 'loss_val': 0.43818936438627293, 'psi': 0.9753093775595818}
[S17] START round=21 head_norm_before_train=1.691023 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.6876915442578426, 'auprc': 0.9360516401453469, 'loss_val': 0.5058224412898475, 'psi': 0.7870355826128443}-{'f1_val': 0.7063661147721063, 'auprc': 0.9586599683201719, 'loss_val': 0.4809375710251699, 'psi': 0.8072836561913326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:36616
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:36602
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:36608
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S13
[S7] cosine check vs S13: cos=0.3299
[S7] RECEIVED delta(kind=head bytes=1804) from S14
[S7] cosine check vs S14: cos=0.7412
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] cosine check vs S9: cos=-0.0256
[S5] DROPPED delta from S9 (cos=-0.0256 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S4
[S16] cosine check vs S4: cos=0.9272
[S2] RECEIVED delta(kind=head bytes=1794) from S11
[S2] cosine check vs S11: cos=0.9972
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] cosine check vs S8: cos=-0.0786
[S9] DROPPED delta from S8 (cos=-0.0786 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=0.7039
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=0.7491
[S4] RECEIVED delta(kind=head bytes=1798) from S6
[S4] cosine check vs S6: cos=0.4972
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.4065 head_norm=0.902478
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.406518e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.4018 head_norm=0.913815 delta_norm=0.140652
[S7] aggregate: ACCEPT kept=['S13', 'S14', 'S16'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.6997 head_norm=1.499486
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.669770e-02
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.6991 head_norm=1.502654 delta_norm=0.056698
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9675 head_norm=1.043251
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.130867e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9680 head_norm=0.884864 delta_norm=0.513087
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.9857 head_norm=1.138833
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.133859e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.9866 head_norm=1.071038 delta_norm=0.213386
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.8085 head_norm=1.002054
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.347875e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.7561 head_norm=1.160459 delta_norm=0.534788
[S6] aggregate: ROLLBACK (f1_val pre=0.809 post=0.756 tol_abs=0.005 tol_rel=0.0)
[S2] START round=22 head_norm_before_train=1.502654 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.108187 metrics={'f1_val': 0.7017054257570643, 'auprc': 0.7658612118385817, 'loss_val': 0.40160295805765744, 'psi': 0.7273677401896712}-{'f1_val': 0.6996906525731519, 'auprc': 0.6848886280111486, 'loss_val': 0.36296968957031084, 'psi': 0.6937698427483505}
[S3] START round=22 head_norm_before_train=1.890570 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9260817664652188, 'auprc': 0.9968756154623365, 'loss_val': 0.1596186672558065, 'psi': 0.9543993060640659}-{'f1_val': 0.960995754132836, 'auprc': 0.9983032126508291, 'loss_val': 0.1201180871880568, 'psi': 0.9759187375400333}
[S4] START round=22 head_norm_before_train=0.884864 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9659138684716929, 'auprc': 0.9668698229280522, 'loss_val': 0.3812823699936782, 'psi': 0.9662962502542366}-{'f1_val': 0.9674913988081468, 'auprc': 0.9635197232548506, 'loss_val': 0.30914858354473573, 'psi': 0.9659027285868284}
[S5] START round=22 head_norm_before_train=1.353931 cos_to_last_merge=0.8227 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.823
[S5] round=22 local utility u=0.249735 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9966421686018626, 'loss_val': 0.28874987740655345, 'psi': 0.8188496579010933}-{'f1_val': 0.7006083926626743, 'auprc': 0.8413923574069575, 'loss_val': 0.32419355764910074, 'psi': 0.7569219785603876}
[S6] START round=22 head_norm_before_train=1.160459 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.7240037235482486, 'auprc': 0.8094976142216241, 'loss_val': 0.4490180628231279, 'psi': 0.7582012798175988}-{'f1_val': 0.8085494459453312, 'auprc': 0.9610003409864556, 'loss_val': 0.37396662037880213, 'psi': 0.8695298039617809}
[S7] START round=22 head_norm_before_train=0.913815 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=1.000000 metrics={'f1_val': 0.6816703226180917, 'auprc': 0.8760544109101016, 'loss_val': 0.5346911039626749, 'psi': 0.7594239579348956}-{'f1_val': 0.4064533540298504, 'auprc': 0.6218165995859603, 'loss_val': 1.0395599155369797, 'psi': 0.4925986522522944}
[S8] START round=22 head_norm_before_train=1.880184 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.995160954146866, 'auprc': 0.999265103638246, 'loss_val': 0.0386464432585357, 'psi': 0.996802613943418}-{'f1_val': 0.9966398743144329, 'auprc': 0.9992283946925123, 'loss_val': 0.03823115748493324, 'psi': 0.9976752824656646}
[S9] START round=22 head_norm_before_train=1.890470 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9888785659900814, 'auprc': 0.998482320457947, 'loss_val': 0.05025875647669407, 'psi': 0.9927200677772277}-{'f1_val': 0.9966605118138915, 'auprc': 0.994977486467816, 'loss_val': 0.03639796996920014, 'psi': 0.9959873016754612}
[S10] START round=22 head_norm_before_train=1.503733 cos_to_last_merge=0.7977 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.798
[S10] round=22 local utility u=0.001122 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9945098039571388, 'loss_val': 0.08095468345409808, 'psi': 0.9938385317837501}-{'f1_val': 0.993391017001491, 'auprc': 0.9961156547397744, 'loss_val': 0.08801653965464788, 'psi': 0.9944808720968044}
[S11] START round=22 head_norm_before_train=1.507949 cos_to_last_merge=0.8294 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.829
[S11] round=22 local utility u=0.003760 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979407692797089, 'loss_val': 0.0764106689801395, 'psi': 0.9971045104200373}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980362454121541, 'loss_val': 0.08421619169784317, 'psi': 0.9971427008730154}
[S13] START round=22 head_norm_before_train=1.711631 cos_to_last_merge=0.9995 (last merge round=20)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5499975868627852, 'auprc': 0.6879105421349313, 'loss_val': 0.8036021190253113, 'psi': 0.6051627689716437}-{'f1_val': 0.5569094183474288, 'auprc': 0.6749211022178851, 'loss_val': 0.754208219510376, 'psi': 0.6041140918956114}
[S14] START round=22 head_norm_before_train=1.660692 cos_to_last_merge=0.8470 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.847
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9585049807169124, 'auprc': 0.9969698012112447, 'loss_val': 0.07458219476785455, 'psi': 0.9738909089146452}-{'f1_val': 0.9975994502496334, 'auprc': 0.9970583261239313, 'loss_val': 0.05025883699559939, 'psi': 0.9973830005993525}
[S15] START round=22 head_norm_before_train=1.574508 cos_to_last_merge=0.7819 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.782
[S15] round=22 local utility u=0.675458 metrics={'f1_val': 0.899266702477924, 'auprc': 0.9819979551774499, 'loss_val': 0.1537318840058406, 'psi': 0.9323592035577343}-{'f1_val': 0.7588243761102247, 'auprc': 0.8685962381934763, 'loss_val': 0.32178907205004537, 'psi': 0.8027331209435253}
[S16] START round=22 head_norm_before_train=1.071038 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.9263126838956335, 'auprc': 0.9845010029879513, 'loss_val': 0.46771923084795236, 'psi': 0.9495880115325607}-{'f1_val': 0.9856516925390142, 'auprc': 0.9869784271162471, 'loss_val': 0.32111453059975553, 'psi': 0.9861823863699073}
[S17] START round=22 head_norm_before_train=1.720935 (no previous merge yet)
[S17] round=22 local utility u=0.134082 metrics={'f1_val': 0.7123305399225891, 'auprc': 0.9766783697792611, 'loss_val': 0.5073733228413807, 'psi': 0.8180696718652579}-{'f1_val': 0.6876915442578426, 'auprc': 0.9360516401453469, 'loss_val': 0.5058224412898475, 'psi': 0.7870355826128443}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:36604
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:36607
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:36604
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[S15] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] cosine check vs S2: cos=0.4784
[S6] RECEIVED delta(kind=head bytes=1797) from S10
[S6] cosine check vs S10: cos=0.9443
[S6] RECEIVED delta(kind=head bytes=1793) from S7
[S6] cosine check vs S7: cos=0.2746
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=0.9978
[S7] RECEIVED delta(kind=head bytes=1795) from S5
[S7] cosine check vs S5: cos=0.3926
[S4] RECEIVED delta(kind=head bytes=1797) from S15
[S4] cosine check vs S15: cos=0.5668
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1805 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1805) from S17
[S13] cosine check vs S17: cos=0.9938
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9659 head_norm=0.936227
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.042757e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9665 head_norm=1.010825 delta_norm=0.504276
[S4] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.5500 head_norm=1.737796
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.760214e-02
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.5463 head_norm=1.741281 delta_norm=0.097602
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.7240 head_norm=1.189093
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.723068e-01
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.9142 head_norm=1.042222 delta_norm=0.272307
[S6] aggregate: ACCEPT kept=['S10', 'S7'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.6817 head_norm=0.933208
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.650200e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.6817 head_norm=0.974075 delta_norm=0.665020
[S7] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.7017 head_norm=1.528605
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.088500e-02
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.7011 head_norm=1.531644 delta_norm=0.050885
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.531644 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.046442 metrics={'f1_val': 0.7113250443919954, 'auprc': 0.7894965812399953, 'loss_val': 0.43734192644439596, 'psi': 0.7425936591311955}-{'f1_val': 0.7017054257570643, 'auprc': 0.7658612118385817, 'loss_val': 0.40160295805765744, 'psi': 0.7273677401896712}
[S3] START round=23 head_norm_before_train=1.907652 (no previous merge yet)
[S3] round=23 local utility u=0.259746 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9970712912082254, 'loss_val': 0.06878568917770131, 'psi': 0.9972847940552247}-{'f1_val': 0.9260817664652188, 'auprc': 0.9968756154623365, 'loss_val': 0.1596186672558065, 'psi': 0.9543993060640659}
[S4] START round=23 head_norm_before_train=1.010825 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9526086685777035, 'auprc': 0.9718155628707044, 'loss_val': 0.3239252663010084, 'psi': 0.9602914262949038}-{'f1_val': 0.9659138684716929, 'auprc': 0.9668698229280522, 'loss_val': 0.3812823699936782, 'psi': 0.9662962502542366}
[S5] START round=23 head_norm_before_train=1.382487 cos_to_last_merge=0.8176 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.818
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.714400588689728, 'auprc': 0.7916395515133103, 'loss_val': 0.47327805154213914, 'psi': 0.745296173819161}-{'f1_val': 0.7003213174339138, 'auprc': 0.9966421686018626, 'loss_val': 0.28874987740655345, 'psi': 0.8188496579010933}
[S6] START round=23 head_norm_before_train=1.042222 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.6689192703221498, 'auprc': 0.7843187231399459, 'loss_val': 0.5253528042389832, 'psi': 0.7150790514492682}-{'f1_val': 0.7240037235482486, 'auprc': 0.8094976142216241, 'loss_val': 0.4490180628231279, 'psi': 0.7582012798175988}
[S7] START round=23 head_norm_before_train=0.974075 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.6813219408312211, 'auprc': 0.8642135840147334, 'loss_val': 0.5730783060149437, 'psi': 0.754478598104626}-{'f1_val': 0.6816703226180917, 'auprc': 0.8760544109101016, 'loss_val': 0.5346911039626749, 'psi': 0.7594239579348956}
[S8] START round=23 head_norm_before_train=1.897903 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9929679663698754, 'auprc': 0.9992819864022171, 'loss_val': 0.04856913401130452, 'psi': 0.9954935743828122}-{'f1_val': 0.995160954146866, 'auprc': 0.999265103638246, 'loss_val': 0.0386464432585357, 'psi': 0.996802613943418}
[S9] START round=23 head_norm_before_train=1.909466 (no previous merge yet)
[S9] round=23 local utility u=0.029522 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9968593656386692, 'loss_val': 0.030551864185334857, 'psi': 0.9964914152349992}-{'f1_val': 0.9888785659900814, 'auprc': 0.998482320457947, 'loss_val': 0.05025875647669407, 'psi': 0.9927200677772277}
[S10] START round=23 head_norm_before_train=1.531380 cos_to_last_merge=0.7936 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.794
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9926466889065186, 'loss_val': 0.08485533876879639, 'psi': 0.9936725145896603}-{'f1_val': 0.993391017001491, 'auprc': 0.9945098039571388, 'loss_val': 0.08095468345409808, 'psi': 0.9938385317837501}
[S11] START round=23 head_norm_before_train=1.536362 cos_to_last_merge=0.8263 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.826
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9972110891685257, 'loss_val': 0.0939177449351001, 'psi': 0.9964195383885588}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979407692797089, 'loss_val': 0.0764106689801395, 'psi': 0.9971045104200373}
[S13] START round=23 head_norm_before_train=1.741281 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.248745 metrics={'f1_val': 0.6092233906205614, 'auprc': 0.6776238299839503, 'loss_val': 0.6306069495052836, 'psi': 0.636583566365917}-{'f1_val': 0.5499975868627852, 'auprc': 0.6879105421349313, 'loss_val': 0.8036021190253113, 'psi': 0.6051627689716437}
[S14] START round=23 head_norm_before_train=1.682710 cos_to_last_merge=0.8452 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.845
[S14] round=23 local utility u=0.134218 metrics={'f1_val': 0.997842298753406, 'auprc': 0.9970090037742155, 'loss_val': 0.04228830847405992, 'psi': 0.9975089807617299}-{'f1_val': 0.9585049807169124, 'auprc': 0.9969698012112447, 'loss_val': 0.07458219476785455, 'psi': 0.9738909089146452}
[S15] START round=23 head_norm_before_train=1.602208 cos_to_last_merge=0.7767 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.777
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7061713924019446, 'auprc': 0.7857717716294018, 'loss_val': 0.6974725023575489, 'psi': 0.7380115440929276}-{'f1_val': 0.899266702477924, 'auprc': 0.9819979551774499, 'loss_val': 0.1537318840058406, 'psi': 0.9323592035577343}
[S16] START round=23 head_norm_before_train=1.125595 cos_to_last_merge=0.9974 (last merge round=21)
[S16] round=23 local utility u=0.119577 metrics={'f1_val': 0.9378976497629811, 'auprc': 0.992738862780094, 'loss_val': 0.322788263569877, 'psi': 0.9598341349698263}-{'f1_val': 0.9263126838956335, 'auprc': 0.9845010029879513, 'loss_val': 0.46771923084795236, 'psi': 0.9495880115325607}
[S17] START round=23 head_norm_before_train=1.750210 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.688132854429018, 'auprc': 0.8871079533289354, 'loss_val': 0.587988806771526, 'psi': 0.767722893988985}-{'f1_val': 0.7123305399225891, 'auprc': 0.9766783697792611, 'loss_val': 0.5073733228413807, 'psi': 0.8180696718652579}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:36617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:36609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:36612
[S9] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] cosine check vs S16: cos=0.9603
[S11] RECEIVED delta(kind=head bytes=1797) from S2
[S11] cosine check vs S2: cos=0.9983
[S17] RECEIVED delta(kind=head bytes=1804) from S13
[S17] cosine check vs S13: cos=0.9966
[S8] RECEIVED delta(kind=head bytes=1799) from S9
[S8] cosine check vs S9: cos=-0.0772
[S8] DROPPED delta from S9 (cos=-0.0772 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9959 head_norm=1.564075
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.591130e-02
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9959 head_norm=1.559194 delta_norm=0.045911
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9526 head_norm=1.064932
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.688834e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9537 head_norm=1.112912 delta_norm=0.168883
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.6881 head_norm=1.774449
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.351537e-02
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.6892 head_norm=1.766685 delta_norm=0.073515
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.555654 cos_to_last_merge=0.9997 (last merge round=22)
[S2] round=24 local utility u=0.013586 metrics={'f1_val': 0.7105410942267558, 'auprc': 0.7899604824894834, 'loss_val': 0.4068582353358855, 'psi': 0.7423088495318468}-{'f1_val': 0.7113250443919954, 'auprc': 0.7894965812399953, 'loss_val': 0.43734192644439596, 'psi': 0.7425936591311955}
[S3] START round=24 head_norm_before_train=1.926616 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9983544933476455, 'loss_val': 0.11122347448335654, 'psi': 0.9759629480023244}-{'f1_val': 0.9974271292865575, 'auprc': 0.9970712912082254, 'loss_val': 0.06878568917770131, 'psi': 0.9972847940552247}
[S4] START round=24 head_norm_before_train=1.112912 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.628534644798387, 'auprc': 0.8973699789212312, 'loss_val': 0.5247680357463097, 'psi': 0.7360687784475247}-{'f1_val': 0.9526086685777035, 'auprc': 0.9718155628707044, 'loss_val': 0.3239252663010084, 'psi': 0.9602914262949038}
[S5] START round=24 head_norm_before_train=1.405837 cos_to_last_merge=0.8146 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.815
[S5] round=24 local utility u=0.364013 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9962053147904663, 'loss_val': 0.27446849502828075, 'psi': 0.8186744850110019}-{'f1_val': 0.714400588689728, 'auprc': 0.7916395515133103, 'loss_val': 0.47327805154213914, 'psi': 0.745296173819161}
[S6] START round=24 head_norm_before_train=1.075441 cos_to_last_merge=0.9985 (last merge round=22)
[S6] round=24 local utility u=1.000000 metrics={'f1_val': 0.9406412862128064, 'auprc': 0.9472067814354257, 'loss_val': 0.3917532162026605, 'psi': 0.9432674843018541}-{'f1_val': 0.6689192703221498, 'auprc': 0.7843187231399459, 'loss_val': 0.5253528042389832, 'psi': 0.7150790514492682}
[S7] START round=24 head_norm_before_train=0.995347 cos_to_last_merge=0.9993 (last merge round=22)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.399293568968732, 'auprc': 0.5951640234724075, 'loss_val': 1.0999634051769194, 'psi': 0.4776417507702022}-{'f1_val': 0.6813219408312211, 'auprc': 0.8642135840147334, 'loss_val': 0.5730783060149437, 'psi': 0.754478598104626}
[S8] START round=24 head_norm_before_train=1.914511 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9992558146367233, 'loss_val': 0.18761317513862652, 'psi': 0.8282457890933868}-{'f1_val': 0.9929679663698754, 'auprc': 0.9992819864022171, 'loss_val': 0.04856913401130452, 'psi': 0.9954935743828122}
[S9] START round=24 head_norm_before_train=1.928868 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9966055697965797, 'loss_val': 0.028668032877496134, 'psi': 0.9962397012101609}-{'f1_val': 0.9962461149658858, 'auprc': 0.9968593656386692, 'loss_val': 0.030551864185334857, 'psi': 0.9964914152349992}
[S10] START round=24 head_norm_before_train=1.555711 cos_to_last_merge=0.7902 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.790
[S10] round=24 local utility u=0.010895 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9927078663977393, 'loss_val': 0.0642857522599752, 'psi': 0.9938006106381323}-{'f1_val': 0.9943563983784213, 'auprc': 0.9926466889065186, 'loss_val': 0.08485533876879639, 'psi': 0.9936725145896603}
[S11] START round=24 head_norm_before_train=1.559194 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.016032 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9975630913378752, 'loss_val': 0.06436170779419771, 'psi': 0.9967054414831357}-{'f1_val': 0.9958918378685807, 'auprc': 0.9972110891685257, 'loss_val': 0.0939177449351001, 'psi': 0.9964195383885588}
[S13] START round=24 head_norm_before_train=1.761957 cos_to_last_merge=0.9998 (last merge round=22)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5166244224755903, 'auprc': 0.6905744933534467, 'loss_val': 0.8875260419621038, 'psi': 0.5862044508267328}-{'f1_val': 0.6092233906205614, 'auprc': 0.6776238299839503, 'loss_val': 0.6306069495052836, 'psi': 0.636583566365917}
[S14] START round=24 head_norm_before_train=1.705125 cos_to_last_merge=0.8431 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.843
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9516237748817455, 'auprc': 0.9986446339298041, 'loss_val': 0.08290095924723712, 'psi': 0.970432118500969}-{'f1_val': 0.997842298753406, 'auprc': 0.9970090037742155, 'loss_val': 0.04228830847405992, 'psi': 0.9975089807617299}
[S15] START round=24 head_norm_before_train=1.624879 cos_to_last_merge=0.7724 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.772
[S15] round=24 local utility u=1.000000 metrics={'f1_val': 0.9553319479981375, 'auprc': 0.9720432169100879, 'loss_val': 0.12447747558056192, 'psi': 0.9620164555629176}-{'f1_val': 0.7061713924019446, 'auprc': 0.7857717716294018, 'loss_val': 0.6974725023575489, 'psi': 0.7380115440929276}
[S16] START round=24 head_norm_before_train=1.183262 cos_to_last_merge=0.9913 (last merge round=21)
[S16] round=24 local utility u=0.210134 metrics={'f1_val': 0.9870352594150668, 'auprc': 0.9911797018227665, 'loss_val': 0.19266891062724062, 'psi': 0.9886930363781465}-{'f1_val': 0.9378976497629811, 'auprc': 0.992738862780094, 'loss_val': 0.322788263569877, 'psi': 0.9598341349698263}
[S17] START round=24 head_norm_before_train=1.766685 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.66888364583228, 'auprc': 0.8532421186202858, 'loss_val': 0.8206483323544137, 'psi': 0.7426270349474824}-{'f1_val': 0.688132854429018, 'auprc': 0.8871079533289354, 'loss_val': 0.587988806771526, 'psi': 0.767722893988985}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:36612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:36608
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S2
[S11] cosine check vs S2: cos=0.9987
[S7] RECEIVED delta(kind=head bytes=1791) from S6
[S7] cosine check vs S6: cos=0.3442
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:36610
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=-0.0246
[S9] DROPPED delta from S5 (cos=-0.0246 < 0.0)
[S16] sending update (kind=head size=1794 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1794) from S16
[S4] cosine check vs S16: cos=0.9841
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.6285 head_norm=1.156942
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.141391e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.6329 head_norm=1.192996 delta_norm=0.114139
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9961 head_norm=1.586268
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.123209e-02
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9961 head_norm=1.581179 delta_norm=0.041232
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.3993 head_norm=1.016693
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.107406e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.4011 head_norm=0.873047 delta_norm=0.610741
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.577151 cos_to_last_merge=0.9991 (last merge round=22)
[S2] round=25 local utility u=0.314505 metrics={'f1_val': 0.8254259090823013, 'auprc': 0.7712963092996415, 'loss_val': 0.4111651455944967, 'psi': 0.8037740691692374}-{'f1_val': 0.7105410942267558, 'auprc': 0.7899604824894834, 'loss_val': 0.4068582353358855, 'psi': 0.7423088495318468}
[S3] START round=25 head_norm_before_train=1.950267 (no previous merge yet)
[S3] round=25 local utility u=0.139307 metrics={'f1_val': 0.9971149325810758, 'auprc': 0.9976431588635976, 'loss_val': 0.04695357961915398, 'psi': 0.9973262230940845}-{'f1_val': 0.9610352511054436, 'auprc': 0.9983544933476455, 'loss_val': 0.11122347448335654, 'psi': 0.9759629480023244}
[S4] START round=25 head_norm_before_train=1.192996 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=1.000000 metrics={'f1_val': 0.9477558280241795, 'auprc': 0.9818342262924171, 'loss_val': 0.2755271791330385, 'psi': 0.9613871873314745}-{'f1_val': 0.628534644798387, 'auprc': 0.8973699789212312, 'loss_val': 0.5247680357463097, 'psi': 0.7360687784475247}
[S5] START round=25 head_norm_before_train=1.423662 cos_to_last_merge=0.8114 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.811
[S5] round=25 local utility u=0.002504 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9960413892731106, 'loss_val': 0.2689681901734256, 'psi': 0.8186089148040596}-{'f1_val': 0.700320598491359, 'auprc': 0.9962053147904663, 'loss_val': 0.27446849502828075, 'psi': 0.8186744850110019}
[S6] START round=25 head_norm_before_train=1.112100 cos_to_last_merge=0.9946 (last merge round=22)
[S6] round=25 local utility u=0.040387 metrics={'f1_val': 0.9396929989705932, 'auprc': 0.954026248724588, 'loss_val': 0.32574830350044914, 'psi': 0.9454262988721911}-{'f1_val': 0.9406412862128064, 'auprc': 0.9472067814354257, 'loss_val': 0.3917532162026605, 'psi': 0.9432674843018541}
[S7] START round=25 head_norm_before_train=0.873047 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=1.000000 metrics={'f1_val': 0.6538301531752414, 'auprc': 0.7846848199770242, 'loss_val': 0.6373195796920192, 'psi': 0.7061720198959545}-{'f1_val': 0.399293568968732, 'auprc': 0.5951640234724075, 'loss_val': 1.0999634051769194, 'psi': 0.4776417507702022}
[S8] START round=25 head_norm_before_train=1.927538 (no previous merge yet)
[S8] round=25 local utility u=0.906616 metrics={'f1_val': 0.9927466462064712, 'auprc': 0.9994373882500232, 'loss_val': 0.045971551657205116, 'psi': 0.995422943023892}-{'f1_val': 0.7142391053978291, 'auprc': 0.9992558146367233, 'loss_val': 0.18761317513862652, 'psi': 0.8282457890933868}
[S9] START round=25 head_norm_before_train=1.946911 (no previous merge yet)
[S9] round=25 local utility u=0.002944 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9967622297888394, 'loss_val': 0.027239076303776952, 'psi': 0.9967011990038707}-{'f1_val': 0.9959957888192151, 'auprc': 0.9966055697965797, 'loss_val': 0.028668032877496134, 'psi': 0.9962397012101609}
[S10] START round=25 head_norm_before_train=1.578683 cos_to_last_merge=0.7870 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.787
[S10] round=25 local utility u=0.002808 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9947385787078691, 'loss_val': 0.057932444407690555, 'psi': 0.9939300416840422}-{'f1_val': 0.9945291067983943, 'auprc': 0.9927078663977393, 'loss_val': 0.0642857522599752, 'psi': 0.9938006106381323}
[S11] START round=25 head_norm_before_train=1.581179 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.007166 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980719045390083, 'loss_val': 0.054037060069518895, 'psi': 0.997156964523757}-{'f1_val': 0.9961336749133093, 'auprc': 0.9975630913378752, 'loss_val': 0.06436170779419771, 'psi': 0.9967054414831357}
[S13] START round=25 head_norm_before_train=1.779785 cos_to_last_merge=0.9992 (last merge round=22)
[S13] round=25 local utility u=0.030342 metrics={'f1_val': 0.5235151470721038, 'auprc': 0.6919140070590128, 'loss_val': 0.8722050333426896, 'psi': 0.5908746910668674}-{'f1_val': 0.5166244224755903, 'auprc': 0.6905744933534467, 'loss_val': 0.8875260419621038, 'psi': 0.5862044508267328}
[S14] START round=25 head_norm_before_train=1.721045 cos_to_last_merge=0.8419 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.842
[S14] round=25 local utility u=0.150441 metrics={'f1_val': 0.9957680459173418, 'auprc': 0.9969750326791704, 'loss_val': 0.04187599281790357, 'psi': 0.9962508406220733}-{'f1_val': 0.9516237748817455, 'auprc': 0.9986446339298041, 'loss_val': 0.08290095924723712, 'psi': 0.970432118500969}
[S15] START round=25 head_norm_before_train=1.642804 cos_to_last_merge=0.7692 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.769
[S15] round=25 local utility u=0.120693 metrics={'f1_val': 0.9885012192037028, 'auprc': 0.975799884495184, 'loss_val': 0.09337682916419984, 'psi': 0.9834206853202953}-{'f1_val': 0.9553319479981375, 'auprc': 0.9720432169100879, 'loss_val': 0.12447747558056192, 'psi': 0.9620164555629176}
[S16] START round=25 head_norm_before_train=1.238556 cos_to_last_merge=0.9843 (last merge round=21)
[S16] round=25 local utility u=0.026979 metrics={'f1_val': 0.9896045718861612, 'auprc': 0.9907314495284096, 'loss_val': 0.15278154470743302, 'psi': 0.9900553229430606}-{'f1_val': 0.9870352594150668, 'auprc': 0.9911797018227665, 'loss_val': 0.19266891062724062, 'psi': 0.9886930363781465}
[S17] START round=25 head_norm_before_train=1.786338 cos_to_last_merge=0.9998 (last merge round=23)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.6506077538776676, 'auprc': 0.8678003976287396, 'loss_val': 0.9565053237446086, 'psi': 0.7374848113780963}-{'f1_val': 0.66888364583228, 'auprc': 0.8532421186202858, 'loss_val': 0.8206483323544137, 'psi': 0.7426270349474824}
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S16
[S4]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S15
[S7]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:36612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:36617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:36615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:36609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S9
[S8] cosine check vs S9: cos=-0.0763
[S8] DROPPED delta from S9 (cos=-0.0763 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1793) from S4
[S15] cosine check vs S4: cos=0.7525
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=-0.0241
[S9] DROPPED delta from S5 (cos=-0.0241 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] cosine check vs S7: cos=0.5626
[S11] RECEIVED delta(kind=head bytes=1802) from S2
[S11] cosine check vs S2: cos=0.9990
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] cosine check vs S6: cos=0.8318
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] cosine check vs S16: cos=0.9918
[S17] RECEIVED delta(kind=head bytes=1806) from S13
[S17] cosine check vs S13: cos=0.9965
[S5] ⇄ pheromone p=0.142 → S9@127.0.0.1:36610
[S9] ⇄ pheromone p=0.030 → S8@127.0.0.1:36609
[S13] ⇄ pheromone p=0.069 → S17@127.0.0.1:36617
[S2] ⇄ pheromone p=0.107 → S11@127.0.0.1:36612
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.9896 head_norm=1.289211
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.397551e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.9887 head_norm=0.970353 delta_norm=0.539755
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.167 → S4@127.0.0.1:36604
[S4] CommDone barrier timeout: have=1 need=2 — continuing
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=25 metric=0.9478 head_norm=1.228102
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.607517e-02
[S4] stored merged vector for next round verification (round=25)
[S4] DEBUG after merge:  round=25 metric=0.9486 head_norm=1.256081 delta_norm=0.086075
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.271 → S15@127.0.0.1:36615
[S6] CommDone barrier timeout: have=1 need=2 — continuing
[S6] ⇄ pheromone p=0.296 → S7@127.0.0.1:36608
[S7] CommDone barrier timeout: have=1 need=3 — continuing
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.6538 head_norm=0.896536
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.204473e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.6561 head_norm=0.979773 delta_norm=0.320447
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.401 → S16@127.0.0.1:36616
[S2] START round=26 head_norm_before_train=1.595097 cos_to_last_merge=0.9982 (last merge round=22)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.7887353754198756, 'auprc': 0.8143730731920124, 'loss_val': 0.4629724738614265, 'psi': 0.7989904545287303}-{'f1_val': 0.8254259090823013, 'auprc': 0.7712963092996415, 'loss_val': 0.4111651455944967, 'psi': 0.8037740691692374}
[S3] START round=26 head_norm_before_train=1.974859 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.961289870742017, 'auprc': 0.9985765539648281, 'loss_val': 0.10469588552976945, 'psi': 0.9762045440311415}-{'f1_val': 0.9971149325810758, 'auprc': 0.9976431588635976, 'loss_val': 0.04695357961915398, 'psi': 0.9973262230940845}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=1.256081 cos_to_last_merge=1.0000 (last merge round=25)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9453592700625749, 'auprc': 0.9687976324979641, 'loss_val': 0.2716116637534493, 'psi': 0.9547346150367306}-{'f1_val': 0.9477558280241795, 'auprc': 0.9818342262924171, 'loss_val': 0.2755271791330385, 'psi': 0.9613871873314745}
[S5] START round=26 head_norm_before_train=1.438599 cos_to_last_merge=0.8066 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.807
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.7006425251128169, 'auprc': 0.9109755676173266, 'loss_val': 0.2838211272119997, 'psi': 0.7847757421146208}-{'f1_val': 0.700320598491359, 'auprc': 0.9960413892731106, 'loss_val': 0.2689681901734256, 'psi': 0.8186089148040596}
[S6] START round=26 head_norm_before_train=1.149567 cos_to_last_merge=0.9891 (last merge round=22)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.47871445669201973, 'auprc': 0.7415706080784901, 'loss_val': 0.641071980803685, 'psi': 0.5838569172466079}-{'f1_val': 0.9396929989705932, 'auprc': 0.954026248724588, 'loss_val': 0.32574830350044914, 'psi': 0.9454262988721911}
[S7] START round=26 head_norm_before_train=0.979773 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.6023653494542717, 'auprc': 0.6936892577663929, 'loss_val': 0.7656783723842566, 'psi': 0.6388949127791201}-{'f1_val': 0.6538301531752414, 'auprc': 0.7846848199770242, 'loss_val': 0.6373195796920192, 'psi': 0.7061720198959545}
[S8] START round=26 head_norm_before_train=1.937453 (no previous merge yet)
[S8] round=26 local utility u=0.014257 metrics={'f1_val': 0.9954476991582405, 'auprc': 0.9991385916559501, 'loss_val': 0.0327684250755492, 'psi': 0.9969240561573243}-{'f1_val': 0.9927466462064712, 'auprc': 0.9994373882500232, 'loss_val': 0.045971551657205116, 'psi': 0.995422943023892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=26 head_norm_before_train=1.959847 (no previous merge yet)
[S9] round=26 local utility u=0.000847 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9969098345434182, 'loss_val': 0.02598815478638786, 'psi': 0.9967602409057021}-{'f1_val': 0.9966605118138915, 'auprc': 0.9967622297888394, 'loss_val': 0.027239076303776952, 'psi': 0.9967011990038707}
[S10] START round=26 head_norm_before_train=1.600956 cos_to_last_merge=0.7840 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.784
[S10] round=26 local utility u=0.002058 metrics={'f1_val': 0.9938290824763921, 'auprc': 0.9935874840775839, 'loss_val': 0.05299151266384166, 'psi': 0.9937324431168688}-{'f1_val': 0.993391017001491, 'auprc': 0.9947385787078691, 'loss_val': 0.057932444407690555, 'psi': 0.9939300416840422}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=26 head_norm_before_train=1.605956 cos_to_last_merge=0.9999 (last merge round=24)
[S11] round=26 local utility u=0.001724 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980440124952333, 'loss_val': 0.04905380851008654, 'psi': 0.9970007054794099}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980719045390083, 'loss_val': 0.054037060069518895, 'psi': 0.997156964523757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.9963 head_norm=1.629145
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.799233e-02
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.9963 head_norm=1.611496 delta_norm=0.047992
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] START round=26 head_norm_before_train=1.798784 cos_to_last_merge=0.9984 (last merge round=22)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5233910226690561, 'auprc': 0.672191165477434, 'loss_val': 0.9312297896217366, 'psi': 0.5829110797924073}-{'f1_val': 0.5235151470721038, 'auprc': 0.6919140070590128, 'loss_val': 0.8722050333426896, 'psi': 0.5908746910668674}
[S14] START round=26 head_norm_before_train=1.735903 cos_to_last_merge=0.8409 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.841
[S14] round=26 local utility u=0.000870 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9987449320732047, 'loss_val': 0.05282336938805084, 'psi': 0.9976964777238809}-{'f1_val': 0.9957680459173418, 'auprc': 0.9969750326791704, 'loss_val': 0.04187599281790357, 'psi': 0.9962508406220733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=26 head_norm_before_train=1.663088 cos_to_last_merge=0.7660 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.766
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.6979023246253193, 'auprc': 0.898563256833031, 'loss_val': 0.4527600866024901, 'psi': 0.778166697508404}-{'f1_val': 0.9885012192037028, 'auprc': 0.975799884495184, 'loss_val': 0.09337682916419984, 'psi': 0.9834206853202953}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.6979 head_norm=1.678148
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.539734e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.6981 head_norm=1.362102 delta_norm=0.553973
[S15] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] START round=26 head_norm_before_train=0.970353 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8753819896813786, 'auprc': 0.9720398684783262, 'loss_val': 0.5900700483673265, 'psi': 0.9140451412001577}-{'f1_val': 0.9896045718861612, 'auprc': 0.9907314495284096, 'loss_val': 0.15278154470743302, 'psi': 0.9900553229430606}
[S17] START round=26 head_norm_before_train=1.805150 cos_to_last_merge=0.9994 (last merge round=23)
[S17] round=26 local utility u=0.022464 metrics={'f1_val': 0.6512068601414182, 'auprc': 0.8737220283598693, 'loss_val': 0.9329370574091408, 'psi': 0.7402129274287986}-{'f1_val': 0.6506077538776676, 'auprc': 0.8678003976287396, 'loss_val': 0.9565053237446086, 'psi': 0.7374848113780963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.6512 head_norm=1.823278
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.457801e-02
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.6527 head_norm=1.809097 delta_norm=0.084578
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:36609
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1792 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S9
[S8] cosine check vs S9: cos=-0.0757
[S8] DROPPED delta from S9 (cos=-0.0757 < 0.0)
[S7]  timeout peer S5
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S6
[S4]  timeout peer S15
[S9]  timeout peer S8
[S6]  timeout peer S3
[S6]  timeout peer S7
[S6]  timeout peer S10
[S13]  timeout peer S17
[S5]  timeout peer S9
[S2]  timeout peer S11
[S16]  timeout peer S4
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=27 head_norm_before_train=1.608442 cos_to_last_merge=0.9974 (last merge round=22)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.7161247789438009, 'auprc': 0.7989934853024825, 'loss_val': 0.5229467803629546, 'psi': 0.7492722614872735}-{'f1_val': 0.7887353754198756, 'auprc': 0.8143730731920124, 'loss_val': 0.4629724738614265, 'psi': 0.7989904545287303}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=27 head_norm_before_train=1.991120 (no previous merge yet)
[S3] round=27 local utility u=0.008142 metrics={'f1_val': 0.9614594427737211, 'auprc': 0.9981763492672417, 'loss_val': 0.08822923982198387, 'psi': 0.9761462053711294}-{'f1_val': 0.961289870742017, 'auprc': 0.9985765539648281, 'loss_val': 0.10469588552976945, 'psi': 0.9762045440311415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=27 head_norm_before_train=1.279744 cos_to_last_merge=0.9998 (last merge round=25)
[S4] round=27 local utility u=0.037837 metrics={'f1_val': 0.9528117384285982, 'auprc': 0.9748108030733891, 'loss_val': 0.25869160438602007, 'psi': 0.9616113642865145}-{'f1_val': 0.9453592700625749, 'auprc': 0.9687976324979641, 'loss_val': 0.2716116637534493, 'psi': 0.9547346150367306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=27 head_norm_before_train=1.454080 cos_to_last_merge=0.8038 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.804
[S5] round=27 local utility u=0.144364 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9959101244330963, 'loss_val': 0.24796433062991338, 'psi': 0.8185564088680539}-{'f1_val': 0.7006425251128169, 'auprc': 0.9109755676173266, 'loss_val': 0.2838211272119997, 'psi': 0.7847757421146208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=27 head_norm_before_train=1.184197 cos_to_last_merge=0.9831 (last merge round=22)
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.9388292077611105, 'auprc': 0.9577019901111601, 'loss_val': 0.2771309088000338, 'psi': 0.9463783207011303}-{'f1_val': 0.47871445669201973, 'auprc': 0.7415706080784901, 'loss_val': 0.641071980803685, 'psi': 0.5838569172466079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=27 head_norm_before_train=1.003243 cos_to_last_merge=0.9986 (last merge round=25)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.4937243232380374, 'auprc': 0.655543394860037, 'loss_val': 0.869662075141687, 'psi': 0.5584519518868372}-{'f1_val': 0.6023653494542717, 'auprc': 0.6936892577663929, 'loss_val': 0.7656783723842566, 'psi': 0.6388949127791201}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=27 head_norm_before_train=1.947348 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9950793871653353, 'auprc': 0.9991945865789505, 'loss_val': 0.030829942998761156, 'psi': 0.9967254669307813}-{'f1_val': 0.9954476991582405, 'auprc': 0.9991385916559501, 'loss_val': 0.0327684250755492, 'psi': 0.9969240561573243}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=27 head_norm_before_train=1.974400 (no previous merge yet)
[S9] round=27 local utility u=0.001296 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9986920815869695, 'loss_val': 0.024754354622308086, 'psi': 0.9970743059263169}-{'f1_val': 0.9966605118138915, 'auprc': 0.9969098345434182, 'loss_val': 0.02598815478638786, 'psi': 0.9967602409057021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] sending update (kind=head size=1789 to 1 peers)
[S10] START round=27 head_norm_before_train=1.624259 cos_to_last_merge=0.7811 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.781
[S10] round=27 local utility u=0.001311 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9927609759558467, 'loss_val': 0.0494580911858596, 'psi': 0.9935585856805069}-{'f1_val': 0.9938290824763921, 'auprc': 0.9935874840775839, 'loss_val': 0.05299151266384166, 'psi': 0.9937324431168688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=27 head_norm_before_train=1.611496 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9953437213899076, 'auprc': 0.9979409598586262, 'loss_val': 0.04996009179122141, 'psi': 0.996382616777395}-{'f1_val': 0.996305167468861, 'auprc': 0.9980440124952333, 'loss_val': 0.04905380851008654, 'psi': 0.9970007054794099}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=27 head_norm_before_train=1.818544 cos_to_last_merge=0.9974 (last merge round=22)
[S13] round=27 local utility u=0.290454 metrics={'f1_val': 0.5905969794655868, 'auprc': 0.6778788247253332, 'loss_val': 0.7706195969590306, 'psi': 0.6255097175694854}-{'f1_val': 0.5233910226690561, 'auprc': 0.672191165477434, 'loss_val': 0.9312297896217366, 'psi': 0.5829110797924073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=27 head_norm_before_train=1.752590 cos_to_last_merge=0.8395 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.840
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9962542202403722, 'loss_val': 0.08073533830865112, 'psi': 0.9967021160246956}-{'f1_val': 0.9969975081576651, 'auprc': 0.9987449320732047, 'loss_val': 0.05282336938805084, 'psi': 0.9976964777238809}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=27 head_norm_before_train=1.362102 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.405828 metrics={'f1_val': 0.7945861230558685, 'auprc': 0.9227896026476048, 'loss_val': 0.2938853349010858, 'psi': 0.845867514892563}-{'f1_val': 0.6979023246253193, 'auprc': 0.898563256833031, 'loss_val': 0.4527600866024901, 'psi': 0.778166697508404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=27 head_norm_before_train=1.018583 cos_to_last_merge=0.9987 (last merge round=25)
[S16] round=27 local utility u=0.304287 metrics={'f1_val': 0.9329653469193714, 'auprc': 0.9900422127476489, 'loss_val': 0.38100226320515457, 'psi': 0.9557960932506824}-{'f1_val': 0.8753819896813786, 'auprc': 0.9720398684783262, 'loss_val': 0.5900700483673265, 'psi': 0.9140451412001577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=27 head_norm_before_train=1.809097 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.016109 metrics={'f1_val': 0.6505503369021399, 'auprc': 0.8436805414806887, 'loss_val': 0.8066551030061271, 'psi': 0.7278024187335594}-{'f1_val': 0.6512068601414182, 'auprc': 0.8737220283598693, 'loss_val': 0.9329370574091408, 'psi': 0.7402129274287986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=28 head_norm_before_train=1.623793 cos_to_last_merge=0.9963 (last merge round=22)
[S2] round=28 local utility u=0.139908 metrics={'f1_val': 0.7085524664539332, 'auprc': 0.8608908460848123, 'loss_val': 0.38338917797366745, 'psi': 0.7694878183062849}-{'f1_val': 0.7161247789438009, 'auprc': 0.7989934853024825, 'loss_val': 0.5229467803629546, 'psi': 0.7492722614872735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=28 head_norm_before_train=2.000711 (no previous merge yet)
[S3] round=28 local utility u=0.104186 metrics={'f1_val': 0.9893971724872102, 'auprc': 0.9979995643415992, 'loss_val': 0.046953684422158075, 'psi': 0.9928381292289657}-{'f1_val': 0.9614594427737211, 'auprc': 0.9981763492672417, 'loss_val': 0.08822923982198387, 'psi': 0.9761462053711294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=28 head_norm_before_train=1.303627 cos_to_last_merge=0.9992 (last merge round=25)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9410017329840556, 'auprc': 0.9512079306413468, 'loss_val': 0.27308808277980895, 'psi': 0.9450842120469721}-{'f1_val': 0.9528117384285982, 'auprc': 0.9748108030733891, 'loss_val': 0.25869160438602007, 'psi': 0.9616113642865145}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=1.467515 cos_to_last_merge=0.8009 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.801
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7017768770769965, 'auprc': 0.9105323161124251, 'loss_val': 0.2834254872127972, 'psi': 0.7852790526911679}-{'f1_val': 0.700320598491359, 'auprc': 0.9959101244330963, 'loss_val': 0.24796433062991338, 'psi': 0.8185564088680539}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=1.209696 cos_to_last_merge=0.9783 (last merge round=22)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.7172636686211455, 'auprc': 0.7816618727320044, 'loss_val': 0.5553746335381816, 'psi': 0.743022950265489}-{'f1_val': 0.9388292077611105, 'auprc': 0.9577019901111601, 'loss_val': 0.2771309088000338, 'psi': 0.9463783207011303}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.037551 cos_to_last_merge=0.9934 (last merge round=25)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.42021005396877265, 'auprc': 0.6266906885031539, 'loss_val': 0.995473864209426, 'psi': 0.5028023077825252}-{'f1_val': 0.4937243232380374, 'auprc': 0.655543394860037, 'loss_val': 0.869662075141687, 'psi': 0.5584519518868372}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=1.960375 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.990940652883087, 'auprc': 0.999150488625352, 'loss_val': 0.04140175009098551, 'psi': 0.9942245871799931}-{'f1_val': 0.9950793871653353, 'auprc': 0.9991945865789505, 'loss_val': 0.030829942998761156, 'psi': 0.9967254669307813}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=28 head_norm_before_train=1.989481 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9922349858325491, 'auprc': 0.998481310999237, 'loss_val': 0.03171724894010681, 'psi': 0.9947335158992243}-{'f1_val': 0.9959957888192151, 'auprc': 0.9986920815869695, 'loss_val': 0.024754354622308086, 'psi': 0.9970743059263169}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.648550 cos_to_last_merge=0.7782 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.778
[S10] round=28 local utility u=0.001462 metrics={'f1_val': 0.9936100131187782, 'auprc': 0.9937870422409646, 'loss_val': 0.046729545800028964, 'psi': 0.9936808247676527}-{'f1_val': 0.9940903254969471, 'auprc': 0.9927609759558467, 'loss_val': 0.0494580911858596, 'psi': 0.9935585856805069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=28 head_norm_before_train=1.634026 cos_to_last_merge=0.9999 (last merge round=26)
[S11] round=28 local utility u=0.005241 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9976205171497204, 'loss_val': 0.04428530031169484, 'psi': 0.9968313073412047}-{'f1_val': 0.9953437213899076, 'auprc': 0.9979409598586262, 'loss_val': 0.04996009179122141, 'psi': 0.996382616777395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=28 head_norm_before_train=1.835450 cos_to_last_merge=0.9964 (last merge round=22)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5252712347850343, 'auprc': 0.6941615378584047, 'loss_val': 0.9488618354040157, 'psi': 0.5928273560143824}-{'f1_val': 0.5905969794655868, 'auprc': 0.6778788247253332, 'loss_val': 0.7706195969590306, 'psi': 0.6255097175694854}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=1.766042 cos_to_last_merge=0.8386 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.839
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9616586406026197, 'auprc': 0.9970416098382802, 'loss_val': 0.12062308032347212, 'psi': 0.975811828296884}-{'f1_val': 0.9970007132142444, 'auprc': 0.9962542202403722, 'loss_val': 0.08073533830865112, 'psi': 0.9967021160246956}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=1.379318 cos_to_last_merge=0.9999 (last merge round=26)
[S15] round=28 local utility u=0.470323 metrics={'f1_val': 0.897860076982201, 'auprc': 0.9890818990140917, 'loss_val': 0.1717590232789374, 'psi': 0.9343488057949573}-{'f1_val': 0.7945861230558685, 'auprc': 0.9227896026476048, 'loss_val': 0.2938853349010858, 'psi': 0.845867514892563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=28 head_norm_before_train=1.069030 cos_to_last_merge=0.9953 (last merge round=25)
[S16] round=28 local utility u=0.288390 metrics={'f1_val': 0.9909329230723636, 'auprc': 0.9921984831682059, 'loss_val': 0.1584956654341619, 'psi': 0.9914391471107005}-{'f1_val': 0.9329653469193714, 'auprc': 0.9900422127476489, 'loss_val': 0.38100226320515457, 'psi': 0.9557960932506824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=28 head_norm_before_train=1.824516 cos_to_last_merge=0.9999 (last merge round=26)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6503919652931951, 'auprc': 0.8606895290355367, 'loss_val': 1.0298712186976966, 'psi': 0.7345109907901317}-{'f1_val': 0.6505503369021399, 'auprc': 0.8436805414806887, 'loss_val': 0.8066551030061271, 'psi': 0.7278024187335594}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.639690 cos_to_last_merge=0.9949 (last merge round=22)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.6016076508788994, 'auprc': 0.7100101475816456, 'loss_val': 0.7842253288515839, 'psi': 0.6449686495599979}-{'f1_val': 0.7085524664539332, 'auprc': 0.8608908460848123, 'loss_val': 0.38338917797366745, 'psi': 0.7694878183062849}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=2.010008 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9781772032841529, 'auprc': 0.9972614110221398, 'loss_val': 0.057604611709990865, 'psi': 0.9858108863793478}-{'f1_val': 0.9893971724872102, 'auprc': 0.9979995643415992, 'loss_val': 0.046953684422158075, 'psi': 0.9928381292289657}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=1.327170 cos_to_last_merge=0.9982 (last merge round=25)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9389141920202311, 'auprc': 0.9507447003871887, 'loss_val': 0.2834469453489153, 'psi': 0.9436463953670141}-{'f1_val': 0.9410017329840556, 'auprc': 0.9512079306413468, 'loss_val': 0.27308808277980895, 'psi': 0.9450842120469721}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.481672 cos_to_last_merge=0.7994 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.799
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7141740326016373, 'auprc': 0.7924267696277323, 'loss_val': 0.5615699934713272, 'psi': 0.7454751274120752}-{'f1_val': 0.7017768770769965, 'auprc': 0.9105323161124251, 'loss_val': 0.2834254872127972, 'psi': 0.7852790526911679}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=1.231089 cos_to_last_merge=0.9737 (last merge round=22)
[S6] round=29 local utility u=0.316683 metrics={'f1_val': 0.7533153450197112, 'auprc': 0.9037531460035886, 'loss_val': 0.504592347659606, 'psi': 0.8134904654132622}-{'f1_val': 0.7172636686211455, 'auprc': 0.7816618727320044, 'loss_val': 0.5553746335381816, 'psi': 0.743022950265489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=29 head_norm_before_train=1.068594 cos_to_last_merge=0.9874 (last merge round=25)
[S7] round=29 local utility u=0.623655 metrics={'f1_val': 0.5644987933261809, 'auprc': 0.6769743034198616, 'loss_val': 0.7647474295378085, 'psi': 0.6094889973636533}-{'f1_val': 0.42021005396877265, 'auprc': 0.6266906885031539, 'loss_val': 0.995473864209426, 'psi': 0.5028023077825252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] sending update (kind=head size=1791 to 1 peers)
[S8] START round=29 head_norm_before_train=1.972443 (no previous merge yet)
[S8] round=29 local utility u=0.014738 metrics={'f1_val': 0.9940645577230776, 'auprc': 0.9992309354107078, 'loss_val': 0.030910981546470068, 'psi': 0.9961311087981297}-{'f1_val': 0.990940652883087, 'auprc': 0.999150488625352, 'loss_val': 0.04140175009098551, 'psi': 0.9942245871799931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=29 head_norm_before_train=2.004427 (no previous merge yet)
[S9] round=29 local utility u=0.014856 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9971118296805408, 'loss_val': 0.0229472746476422, 'psi': 0.9966908432725489}-{'f1_val': 0.9922349858325491, 'auprc': 0.998481310999237, 'loss_val': 0.03171724894010681, 'psi': 0.9947335158992243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=29 head_norm_before_train=1.672106 cos_to_last_merge=0.7756 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.776
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9941370213715576, 'auprc': 0.992266788470127, 'loss_val': 0.046501021572847634, 'psi': 0.9933889282109853}-{'f1_val': 0.9936100131187782, 'auprc': 0.9937870422409646, 'loss_val': 0.046729545800028964, 'psi': 0.9936808247676527}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=29 head_norm_before_train=1.653150 cos_to_last_merge=0.9996 (last merge round=26)
[S11] round=29 local utility u=0.001582 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9973901140877882, 'loss_val': 0.0404296722711533, 'psi': 0.9967391461164319}-{'f1_val': 0.996305167468861, 'auprc': 0.9976205171497204, 'loss_val': 0.04428530031169484, 'psi': 0.9968313073412047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=29 head_norm_before_train=1.850421 cos_to_last_merge=0.9953 (last merge round=22)
[S13] round=29 local utility u=0.050973 metrics={'f1_val': 0.5365996820639616, 'auprc': 0.6945569942492118, 'loss_val': 0.9160722394063061, 'psi': 0.5997826069380616}-{'f1_val': 0.5252712347850343, 'auprc': 0.6941615378584047, 'loss_val': 0.9488618354040157, 'psi': 0.5928273560143824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=29 head_norm_before_train=1.780532 cos_to_last_merge=0.8372 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.837
[S14] round=29 local utility u=0.150267 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9969583764918809, 'loss_val': 0.03201008704943573, 'psi': 0.9969955242704778}-{'f1_val': 0.9616586406026197, 'auprc': 0.9970416098382802, 'loss_val': 0.12062308032347212, 'psi': 0.975811828296884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=29 head_norm_before_train=1.406137 cos_to_last_merge=0.9994 (last merge round=26)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.8830407942335017, 'auprc': 0.9761515241559886, 'loss_val': 0.2214962105348427, 'psi': 0.9202850862024965}-{'f1_val': 0.897860076982201, 'auprc': 0.9890818990140917, 'loss_val': 0.1717590232789374, 'psi': 0.9343488057949573}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=1.121764 cos_to_last_merge=0.9906 (last merge round=25)
[S16] round=29 local utility u=0.013538 metrics={'f1_val': 0.9917645587782769, 'auprc': 0.9902079045768447, 'loss_val': 0.13043722759913712, 'psi': 0.991141897097704}-{'f1_val': 0.9909329230723636, 'auprc': 0.9921984831682059, 'loss_val': 0.1584956654341619, 'psi': 0.9914391471107005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=29 head_norm_before_train=1.840346 cos_to_last_merge=0.9997 (last merge round=26)
[S17] round=29 local utility u=0.063611 metrics={'f1_val': 0.6613233138825045, 'auprc': 0.8453031133393603, 'loss_val': 0.9220787218938655, 'psi': 0.7349152336652468}-{'f1_val': 0.6503919652931951, 'auprc': 0.8606895290355367, 'loss_val': 1.0298712186976966, 'psi': 0.7345109907901317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=30 head_norm_before_train=1.657239 cos_to_last_merge=0.9932 (last merge round=22)
[S2] round=30 local utility u=0.601056 metrics={'f1_val': 0.7157303112483033, 'auprc': 0.8020296211571971, 'loss_val': 0.542908489892372, 'psi': 0.7502500352118608}-{'f1_val': 0.6016076508788994, 'auprc': 0.7100101475816456, 'loss_val': 0.7842253288515839, 'psi': 0.6449686495599979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=30 head_norm_before_train=2.023908 (no previous merge yet)
[S3] round=30 local utility u=0.035252 metrics={'f1_val': 0.9872687231472141, 'auprc': 0.9981181823040802, 'loss_val': 0.044220090295934905, 'psi': 0.9916085068099606}-{'f1_val': 0.9781772032841529, 'auprc': 0.9972614110221398, 'loss_val': 0.057604611709990865, 'psi': 0.9858108863793478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=30 head_norm_before_train=1.349670 cos_to_last_merge=0.9970 (last merge round=25)
[S4] round=30 local utility u=0.089666 metrics={'f1_val': 0.9480797668531279, 'auprc': 0.9821695370459798, 'loss_val': 0.2533823532725302, 'psi': 0.9617156749302687}-{'f1_val': 0.9389141920202311, 'auprc': 0.9507447003871887, 'loss_val': 0.2834469453489153, 'psi': 0.9436463953670141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=30 head_norm_before_train=1.497457 cos_to_last_merge=0.7979 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.798
[S5] round=30 local utility u=0.440907 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9971880143938782, 'loss_val': 0.21091825789207932, 'psi': 0.8190675648523666}-{'f1_val': 0.7141740326016373, 'auprc': 0.7924267696277323, 'loss_val': 0.5615699934713272, 'psi': 0.7454751274120752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=30 head_norm_before_train=1.251648 cos_to_last_merge=0.9697 (last merge round=22)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.4873012195216162, 'auprc': 0.735596670505939, 'loss_val': 0.7469320970274852, 'psi': 0.5866193999153453}-{'f1_val': 0.7533153450197112, 'auprc': 0.9037531460035886, 'loss_val': 0.504592347659606, 'psi': 0.8134904654132622}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.092227 cos_to_last_merge=0.9829 (last merge round=25)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5249236973722944, 'auprc': 0.7761457744704796, 'loss_val': 0.8349422994302423, 'psi': 0.6254125282115686}-{'f1_val': 0.5644987933261809, 'auprc': 0.6769743034198616, 'loss_val': 0.7647474295378085, 'psi': 0.6094889973636533}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=30 head_norm_before_train=1.981731 (no previous merge yet)
[S8] round=30 local utility u=0.002941 metrics={'f1_val': 0.9948349509112366, 'auprc': 0.9992371972124149, 'loss_val': 0.029669589228471554, 'psi': 0.996595849431708}-{'f1_val': 0.9940645577230776, 'auprc': 0.9992309354107078, 'loss_val': 0.030910981546470068, 'psi': 0.9961311087981297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=30 head_norm_before_train=2.016625 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9955808965143278, 'auprc': 0.9984715326718878, 'loss_val': 0.022849197277575835, 'psi': 0.9967371509773518}-{'f1_val': 0.9964101856672208, 'auprc': 0.9971118296805408, 'loss_val': 0.0229472746476422, 'psi': 0.9966908432725489}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.694879 cos_to_last_merge=0.7732 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.773
[S10] round=30 local utility u=0.002201 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9939553662061215, 'loss_val': 0.04268912890393285, 'psi': 0.9936167566833431}-{'f1_val': 0.9941370213715576, 'auprc': 0.992266788470127, 'loss_val': 0.046501021572847634, 'psi': 0.9933889282109853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=30 head_norm_before_train=1.670704 cos_to_last_merge=0.9993 (last merge round=26)
[S11] round=30 local utility u=0.001318 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9971363280662715, 'loss_val': 0.038483309523654904, 'psi': 0.9967827339346623}-{'f1_val': 0.996305167468861, 'auprc': 0.9973901140877882, 'loss_val': 0.0404296722711533, 'psi': 0.9967391461164319}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=30 head_norm_before_train=1.864239 cos_to_last_merge=0.9943 (last merge round=22)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5218513413051458, 'auprc': 0.6759266683581098, 'loss_val': 1.0217534632682366, 'psi': 0.5834814721263314}-{'f1_val': 0.5365996820639616, 'auprc': 0.6945569942492118, 'loss_val': 0.9160722394063061, 'psi': 0.5997826069380616}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.793833 cos_to_last_merge=0.8358 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.836
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9376062278431333, 'auprc': 0.9987156866856275, 'loss_val': 0.11427576392045846, 'psi': 0.962050011380131}-{'f1_val': 0.9970202894562089, 'auprc': 0.9969583764918809, 'loss_val': 0.03201008704943573, 'psi': 0.9969955242704778}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=1.439181 cos_to_last_merge=0.9986 (last merge round=26)
[S15] round=30 local utility u=0.367791 metrics={'f1_val': 0.9876598239741741, 'auprc': 0.9740887021442637, 'loss_val': 0.1074397121181117, 'psi': 0.9822313752422099}-{'f1_val': 0.8830407942335017, 'auprc': 0.9761515241559886, 'loss_val': 0.2214962105348427, 'psi': 0.9202850862024965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=30 head_norm_before_train=1.171245 cos_to_last_merge=0.9855 (last merge round=25)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9900184525883411, 'auprc': 0.9878789227602851, 'loss_val': 0.12007948108248, 'psi': 0.9891626406571187}-{'f1_val': 0.9917645587782769, 'auprc': 0.9902079045768447, 'loss_val': 0.13043722759913712, 'psi': 0.991141897097704}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=1.853858 cos_to_last_merge=0.9994 (last merge round=26)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6494664738443587, 'auprc': 0.859607004102358, 'loss_val': 1.0926203265635197, 'psi': 0.7335226859475584}-{'f1_val': 0.6613233138825045, 'auprc': 0.8453031133393603, 'loss_val': 0.9220787218938655, 'psi': 0.7349152336652468}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=31 head_norm_before_train=1.671643 cos_to_last_merge=0.9917 (last merge round=22)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.7213920261021578, 'auprc': 0.7856485985271418, 'loss_val': 0.7325641378597596, 'psi': 0.7470946550721513}-{'f1_val': 0.7157303112483033, 'auprc': 0.8020296211571971, 'loss_val': 0.542908489892372, 'psi': 0.7502500352118608}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=2.040168 (no previous merge yet)
[S3] round=31 local utility u=0.034910 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9982059981777296, 'loss_val': 0.03808403707271392, 'psi': 0.9979857557509791}-{'f1_val': 0.9872687231472141, 'auprc': 0.9981181823040802, 'loss_val': 0.044220090295934905, 'psi': 0.9916085068099606}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=31 head_norm_before_train=1.369377 cos_to_last_merge=0.9959 (last merge round=25)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9415746534243841, 'auprc': 0.9722867489077146, 'loss_val': 0.263833880407466, 'psi': 0.9538594916177163}-{'f1_val': 0.9480797668531279, 'auprc': 0.9821695370459798, 'loss_val': 0.2533823532725302, 'psi': 0.9617156749302687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=1.510054 cos_to_last_merge=0.7949 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.795
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7096417941020522, 'auprc': 0.8125154648037859, 'loss_val': 0.3440096773102563, 'psi': 0.7507912623827457}-{'f1_val': 0.700320598491359, 'auprc': 0.9971880143938782, 'loss_val': 0.21091825789207932, 'psi': 0.8190675648523666}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=1.272566 cos_to_last_merge=0.9661 (last merge round=22)
[S6] round=31 local utility u=1.000000 metrics={'f1_val': 0.826268744479573, 'auprc': 0.9630576541739813, 'loss_val': 0.2980610942477652, 'psi': 0.8809843083573363}-{'f1_val': 0.4873012195216162, 'auprc': 0.735596670505939, 'loss_val': 0.7469320970274852, 'psi': 0.5866193999153453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=31 head_norm_before_train=1.115922 cos_to_last_merge=0.9781 (last merge round=25)
[S7] round=31 local utility u=0.397539 metrics={'f1_val': 0.6076924410609736, 'auprc': 0.8199077549012334, 'loss_val': 0.6677622220641343, 'psi': 0.6925785665970776}-{'f1_val': 0.5249236973722944, 'auprc': 0.7761457744704796, 'loss_val': 0.8349422994302423, 'psi': 0.6254125282115686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=31 head_norm_before_train=1.990570 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9875742096454381, 'auprc': 0.9992552610027912, 'loss_val': 0.04563701831415177, 'psi': 0.9922466301883792}-{'f1_val': 0.9948349509112366, 'auprc': 0.9992371972124149, 'loss_val': 0.029669589228471554, 'psi': 0.996595849431708}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=2.028455 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9905410059937811, 'auprc': 0.9985022412012169, 'loss_val': 0.03525419260903463, 'psi': 0.9937255000767555}-{'f1_val': 0.9955808965143278, 'auprc': 0.9984715326718878, 'loss_val': 0.022849197277575835, 'psi': 0.9967371509773518}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.712574 cos_to_last_merge=0.7716 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.772
[S10] round=31 local utility u=0.002237 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9948779039890302, 'loss_val': 0.04179363501771479, 'psi': 0.99406694072312}-{'f1_val': 0.993391017001491, 'auprc': 0.9939553662061215, 'loss_val': 0.04268912890393285, 'psi': 0.9936167566833431}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=31 head_norm_before_train=1.682547 cos_to_last_merge=0.9989 (last merge round=26)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9971341515292136, 'loss_val': 0.03782608453952173, 'psi': 0.996636761093002}-{'f1_val': 0.9965470045135896, 'auprc': 0.9971363280662715, 'loss_val': 0.038483309523654904, 'psi': 0.9967827339346623}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=1.879769 cos_to_last_merge=0.9933 (last merge round=22)
[S13] round=31 local utility u=0.308782 metrics={'f1_val': 0.5790971939453826, 'auprc': 0.6796158596089944, 'loss_val': 0.7587320541017535, 'psi': 0.6193046602108274}-{'f1_val': 0.5218513413051458, 'auprc': 0.6759266683581098, 'loss_val': 1.0217534632682366, 'psi': 0.5834814721263314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=31 head_norm_before_train=1.806095 cos_to_last_merge=0.8346 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.835
[S14] round=31 local utility u=0.037869 metrics={'f1_val': 0.9468148236334418, 'auprc': 0.9969552554817602, 'loss_val': 0.0885082950131817, 'psi': 0.9668709963727691}-{'f1_val': 0.9376062278431333, 'auprc': 0.9987156866856275, 'loss_val': 0.11427576392045846, 'psi': 0.962050011380131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=31 head_norm_before_train=1.477325 cos_to_last_merge=0.9972 (last merge round=26)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.8197230012646988, 'auprc': 0.9384874769053659, 'loss_val': 0.28328043420768517, 'psi': 0.8672287915209655}-{'f1_val': 0.9876598239741741, 'auprc': 0.9740887021442637, 'loss_val': 0.1074397121181117, 'psi': 0.9822313752422099}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=1.216520 cos_to_last_merge=0.9804 (last merge round=25)
[S16] round=31 local utility u=0.021086 metrics={'f1_val': 0.9915011048905453, 'auprc': 0.9921253536863548, 'loss_val': 0.09954312793935802, 'psi': 0.9917508044088692}-{'f1_val': 0.9900184525883411, 'auprc': 0.9878789227602851, 'loss_val': 0.12007948108248, 'psi': 0.9891626406571187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=31 head_norm_before_train=1.866004 cos_to_last_merge=0.9991 (last merge round=26)
[S17] round=31 local utility u=0.150967 metrics={'f1_val': 0.6566566455309786, 'auprc': 0.8667875131103937, 'loss_val': 0.8553696328291526, 'psi': 0.7407089925627446}-{'f1_val': 0.6494664738443587, 'auprc': 0.859607004102358, 'loss_val': 1.0926203265635197, 'psi': 0.7335226859475584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=32 head_norm_before_train=1.687946 cos_to_last_merge=0.9899 (last merge round=22)
[S2] round=32 local utility u=0.293511 metrics={'f1_val': 0.762283392238496, 'auprc': 0.828227753672899, 'loss_val': 0.5186283445113213, 'psi': 0.7886611368122571}-{'f1_val': 0.7213920261021578, 'auprc': 0.7856485985271418, 'loss_val': 0.7325641378597596, 'psi': 0.7470946550721513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=32 head_norm_before_train=2.056741 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9964167372369186, 'auprc': 0.9982707797989911, 'loss_val': 0.06076202330908265, 'psi': 0.9971583542617476}-{'f1_val': 0.9978389274664787, 'auprc': 0.9982059981777296, 'loss_val': 0.03808403707271392, 'psi': 0.9979857557509791}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.388264 cos_to_last_merge=0.9949 (last merge round=25)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9418304616975895, 'auprc': 0.9722581673871027, 'loss_val': 0.2654335082849708, 'psi': 0.9540015439733949}-{'f1_val': 0.9415746534243841, 'auprc': 0.9722867489077146, 'loss_val': 0.263833880407466, 'psi': 0.9538594916177163}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.522066 cos_to_last_merge=0.7917 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.792
[S5] round=32 local utility u=0.647963 metrics={'f1_val': 0.804741883051319, 'auprc': 0.997050257496771, 'loss_val': 0.17228867597810393, 'psi': 0.8816652328294998}-{'f1_val': 0.7096417941020522, 'auprc': 0.8125154648037859, 'loss_val': 0.3440096773102563, 'psi': 0.7507912623827457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=32 head_norm_before_train=1.290282 cos_to_last_merge=0.9629 (last merge round=22)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.7726891519849378, 'auprc': 0.8136205211639829, 'loss_val': 0.49436487018258574, 'psi': 0.7890616996565558}-{'f1_val': 0.826268744479573, 'auprc': 0.9630576541739813, 'loss_val': 0.2980610942477652, 'psi': 0.8809843083573363}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.137245 cos_to_last_merge=0.9740 (last merge round=25)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.3985632472928828, 'auprc': 0.7810581677165009, 'loss_val': 1.1816412565739352, 'psi': 0.5515612154623301}-{'f1_val': 0.6076924410609736, 'auprc': 0.8199077549012334, 'loss_val': 0.6677622220641343, 'psi': 0.6925785665970776}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.998368 (no previous merge yet)
[S8] round=32 local utility u=0.030079 metrics={'f1_val': 0.9949006242050206, 'auprc': 0.9992502426429846, 'loss_val': 0.02942299563741096, 'psi': 0.9966404715802062}-{'f1_val': 0.9875742096454381, 'auprc': 0.9992552610027912, 'loss_val': 0.04563701831415177, 'psi': 0.9922466301883792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=32 head_norm_before_train=2.039100 (no previous merge yet)
[S9] round=32 local utility u=0.021448 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.996518406131826, 'loss_val': 0.021622385387098778, 'psi': 0.9964534738530629}-{'f1_val': 0.9905410059937811, 'auprc': 0.9985022412012169, 'loss_val': 0.03525419260903463, 'psi': 0.9937255000767555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=32 head_norm_before_train=1.727775 cos_to_last_merge=0.7707 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.771
[S10] round=32 local utility u=0.002841 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9926912796053861, 'loss_val': 0.03901456969230623, 'psi': 0.9941385926878133}-{'f1_val': 0.9935262985458464, 'auprc': 0.9948779039890302, 'loss_val': 0.04179363501771479, 'psi': 0.99406694072312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=32 head_norm_before_train=1.695625 cos_to_last_merge=0.9985 (last merge round=26)
[S11] round=32 local utility u=0.002215 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9970846517926729, 'loss_val': 0.03469855670775446, 'psi': 0.9967620634252229}-{'f1_val': 0.996305167468861, 'auprc': 0.9971341515292136, 'loss_val': 0.03782608453952173, 'psi': 0.996636761093002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=32 head_norm_before_train=1.891856 cos_to_last_merge=0.9924 (last merge round=22)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.4852555857034483, 'auprc': 0.6980859431784252, 'loss_val': 1.0945531962051844, 'psi': 0.570387728693439}-{'f1_val': 0.5790971939453826, 'auprc': 0.6796158596089944, 'loss_val': 0.7587320541017535, 'psi': 0.6193046602108274}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.816397 cos_to_last_merge=0.8336 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.834
[S14] round=32 local utility u=0.173050 metrics={'f1_val': 0.9947161599987275, 'auprc': 0.9986845185328742, 'loss_val': 0.03500448747250713, 'psi': 0.9963035034123862}-{'f1_val': 0.9468148236334418, 'auprc': 0.9969552554817602, 'loss_val': 0.0885082950131817, 'psi': 0.9668709963727691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=32 head_norm_before_train=1.515135 cos_to_last_merge=0.9955 (last merge round=26)
[S15] round=32 local utility u=0.242780 metrics={'f1_val': 0.8702699688368887, 'auprc': 0.9871175489286241, 'loss_val': 0.24689291613476821, 'psi': 0.917009000873583}-{'f1_val': 0.8197230012646988, 'auprc': 0.9384874769053659, 'loss_val': 0.28328043420768517, 'psi': 0.8672287915209655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=32 head_norm_before_train=1.256124 cos_to_last_merge=0.9761 (last merge round=25)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9321420032361987, 'auprc': 0.9908805286102167, 'loss_val': 0.3322156460829223, 'psi': 0.9556374133858059}-{'f1_val': 0.9915011048905453, 'auprc': 0.9921253536863548, 'loss_val': 0.09954312793935802, 'psi': 0.9917508044088692}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.876229 cos_to_last_merge=0.9989 (last merge round=26)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6551712861926474, 'auprc': 0.8894511438714323, 'loss_val': 1.0063970898771486, 'psi': 0.7488832292641614}-{'f1_val': 0.6566566455309786, 'auprc': 0.8667875131103937, 'loss_val': 0.8553696328291526, 'psi': 0.7407089925627446}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.703784 cos_to_last_merge=0.9882 (last merge round=22)
[S2] round=33 local utility u=0.176666 metrics={'f1_val': 0.7971250294371348, 'auprc': 0.8465668414302691, 'loss_val': 0.4293627795036128, 'psi': 0.8169017542343885}-{'f1_val': 0.762283392238496, 'auprc': 0.828227753672899, 'loss_val': 0.5186283445113213, 'psi': 0.7886611368122571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=33 head_norm_before_train=2.070603 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9742739675488219, 'auprc': 0.9982971490976571, 'loss_val': 0.062240072061693706, 'psi': 0.983883240168356}-{'f1_val': 0.9964167372369186, 'auprc': 0.9982707797989911, 'loss_val': 0.06076202330908265, 'psi': 0.9971583542617476}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.407717 cos_to_last_merge=0.9938 (last merge round=25)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9444736471205234, 'auprc': 0.9640902145755756, 'loss_val': 0.26456299297707225, 'psi': 0.9523202741025443}-{'f1_val': 0.9418304616975895, 'auprc': 0.9722581673871027, 'loss_val': 0.2654335082849708, 'psi': 0.9540015439733949}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.535764 cos_to_last_merge=0.7895 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.789
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.7527691345712815, 'auprc': 0.8902528952111769, 'loss_val': 0.31280538949389447, 'psi': 0.8077626388272396}-{'f1_val': 0.804741883051319, 'auprc': 0.997050257496771, 'loss_val': 0.17228867597810393, 'psi': 0.8816652328294998}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.305413 cos_to_last_merge=0.9598 (last merge round=22)
[S6] round=33 local utility u=0.778150 metrics={'f1_val': 0.9181410472644277, 'auprc': 0.9634077965918969, 'loss_val': 0.26013785110646126, 'psi': 0.9362477469954154}-{'f1_val': 0.7726891519849378, 'auprc': 0.8136205211639829, 'loss_val': 0.49436487018258574, 'psi': 0.7890616996565558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=33 head_norm_before_train=1.153589 cos_to_last_merge=0.9708 (last merge round=25)
[S7] round=33 local utility u=1.000000 metrics={'f1_val': 0.6938202493527728, 'auprc': 0.984790585402503, 'loss_val': 0.33337647241485524, 'psi': 0.8102083837726648}-{'f1_val': 0.3985632472928828, 'auprc': 0.7810581677165009, 'loss_val': 1.1816412565739352, 'psi': 0.5515612154623301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=33 head_norm_before_train=2.008858 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.993985219541562, 'auprc': 0.9993834373293996, 'loss_val': 0.029572393120257397, 'psi': 0.9961445066566971}-{'f1_val': 0.9949006242050206, 'auprc': 0.9992502426429846, 'loss_val': 0.02942299563741096, 'psi': 0.9966404715802062}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=2.048769 (no previous merge yet)
[S9] round=33 local utility u=0.003123 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9984668509603931, 'loss_val': 0.021221760369693532, 'psi': 0.9972328517844897}-{'f1_val': 0.9964101856672208, 'auprc': 0.996518406131826, 'loss_val': 0.021622385387098778, 'psi': 0.9964534738530629}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=33 head_norm_before_train=1.741325 cos_to_last_merge=0.7699 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.770
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9946703416649624, 'loss_val': 0.03906949336848408, 'psi': 0.9939839157934928}-{'f1_val': 0.9951034680760983, 'auprc': 0.9926912796053861, 'loss_val': 0.03901456969230623, 'psi': 0.9941385926878133}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.711701 cos_to_last_merge=0.9980 (last merge round=26)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.996431352846877, 'loss_val': 0.034008750246388476, 'psi': 0.9963556416200674}-{'f1_val': 0.9965470045135896, 'auprc': 0.9970846517926729, 'loss_val': 0.03469855670775446, 'psi': 0.9967620634252229}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.900999 cos_to_last_merge=0.9917 (last merge round=22)
[S13] round=33 local utility u=0.322438 metrics={'f1_val': 0.5621747922320061, 'auprc': 0.6856643492439048, 'loss_val': 0.8739279118004792, 'psi': 0.6115706150367656}-{'f1_val': 0.4852555857034483, 'auprc': 0.6980859431784252, 'loss_val': 1.0945531962051844, 'psi': 0.570387728693439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=33 head_norm_before_train=1.828722 cos_to_last_merge=0.8324 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.832
[S14] round=33 local utility u=0.001921 metrics={'f1_val': 0.9959874237039671, 'auprc': 0.9969645409952099, 'loss_val': 0.03362990572090664, 'psi': 0.9963782706204642}-{'f1_val': 0.9947161599987275, 'auprc': 0.9986845185328742, 'loss_val': 0.03500448747250713, 'psi': 0.9963035034123862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=33 head_norm_before_train=1.550296 cos_to_last_merge=0.9937 (last merge round=26)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.7753508815159754, 'auprc': 0.9026239735564139, 'loss_val': 0.365317800887132, 'psi': 0.8262601183321509}-{'f1_val': 0.8702699688368887, 'auprc': 0.9871175489286241, 'loss_val': 0.24689291613476821, 'psi': 0.917009000873583}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.290492 cos_to_last_merge=0.9724 (last merge round=25)
[S16] round=33 local utility u=0.292036 metrics={'f1_val': 0.9902333169744587, 'auprc': 0.9873442565473318, 'loss_val': 0.08608219980306601, 'psi': 0.989077692803608}-{'f1_val': 0.9321420032361987, 'auprc': 0.9908805286102167, 'loss_val': 0.3322156460829223, 'psi': 0.9556374133858059}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=33 head_norm_before_train=1.891479 cos_to_last_merge=0.9984 (last merge round=26)
[S17] round=33 local utility u=0.350055 metrics={'f1_val': 0.6954885563242377, 'auprc': 0.8948911255281141, 'loss_val': 0.5645101950776222, 'psi': 0.7752495840057883}-{'f1_val': 0.6551712861926474, 'auprc': 0.8894511438714323, 'loss_val': 1.0063970898771486, 'psi': 0.7488832292641614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=34 head_norm_before_train=1.717684 cos_to_last_merge=0.9867 (last merge round=22)
[S2] round=34 local utility u=0.109620 metrics={'f1_val': 0.8287778780207619, 'auprc': 0.8527164712865011, 'loss_val': 0.4184895411311338, 'psi': 0.8383533153270575}-{'f1_val': 0.7971250294371348, 'auprc': 0.8465668414302691, 'loss_val': 0.4293627795036128, 'psi': 0.8169017542343885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=34 head_norm_before_train=2.086648 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9983211314708126, 'loss_val': 0.10682407297401621, 'psi': 0.9759735038279973}-{'f1_val': 0.9742739675488219, 'auprc': 0.9982971490976571, 'loss_val': 0.062240072061693706, 'psi': 0.983883240168356}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.423608 cos_to_last_merge=0.9931 (last merge round=25)
[S4] round=34 local utility u=0.017381 metrics={'f1_val': 0.9500022263356152, 'auprc': 0.9613546233846249, 'loss_val': 0.2547654667674013, 'psi': 0.954543185155219}-{'f1_val': 0.9444736471205234, 'auprc': 0.9640902145755756, 'loss_val': 0.26456299297707225, 'psi': 0.9523202741025443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] sending update (kind=head size=1807 to 1 peers)
[S5] START round=34 head_norm_before_train=1.546105 cos_to_last_merge=0.7884 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.7154818779588469, 'auprc': 0.8080196611709636, 'loss_val': 0.4044986411733237, 'psi': 0.7524969912436936}-{'f1_val': 0.7527691345712815, 'auprc': 0.8902528952111769, 'loss_val': 0.31280538949389447, 'psi': 0.8077626388272396}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.319854 cos_to_last_merge=0.9568 (last merge round=22)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.8160416107756066, 'auprc': 0.9518668398591714, 'loss_val': 0.3923383600855997, 'psi': 0.8703717024090325}-{'f1_val': 0.9181410472644277, 'auprc': 0.9634077965918969, 'loss_val': 0.26013785110646126, 'psi': 0.9362477469954154}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.166432 cos_to_last_merge=0.9682 (last merge round=25)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.40543371831878217, 'auprc': 0.7799710288394309, 'loss_val': 1.1438213508464652, 'psi': 0.5552486425270416}-{'f1_val': 0.6938202493527728, 'auprc': 0.984790585402503, 'loss_val': 0.33337647241485524, 'psi': 0.8102083837726648}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=2.017260 (no previous merge yet)
[S8] round=34 local utility u=0.001321 metrics={'f1_val': 0.9943444494641033, 'auprc': 0.9993472731305593, 'loss_val': 0.028977676396097257, 'psi': 0.9963455789306856}-{'f1_val': 0.993985219541562, 'auprc': 0.9993834373293996, 'loss_val': 0.029572393120257397, 'psi': 0.9961445066566971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=34 head_norm_before_train=2.058903 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9951604951085576, 'auprc': 0.9984728363770345, 'loss_val': 0.023511135079143954, 'psi': 0.9964854316159484}-{'f1_val': 0.9964101856672208, 'auprc': 0.9984668509603931, 'loss_val': 0.021221760369693532, 'psi': 0.9972328517844897}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.756809 cos_to_last_merge=0.7685 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.768
[S10] round=34 local utility u=0.000856 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9927573260763491, 'loss_val': 0.037130429532947276, 'psi': 0.9937699067483338}-{'f1_val': 0.9935262985458464, 'auprc': 0.9946703416649624, 'loss_val': 0.03906949336848408, 'psi': 0.9939839157934928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] sending update (kind=head size=1807 to 1 peers)
[S11] START round=34 head_norm_before_train=1.727912 cos_to_last_merge=0.9974 (last merge round=26)
[S11] round=34 local utility u=0.000753 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9962501648701046, 'loss_val': 0.03195994145468581, 'psi': 0.9962831664293584}-{'f1_val': 0.996305167468861, 'auprc': 0.996431352846877, 'loss_val': 0.034008750246388476, 'psi': 0.9963556416200674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=34 head_norm_before_train=1.909359 cos_to_last_merge=0.9910 (last merge round=22)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5544805151517576, 'auprc': 0.661621747879674, 'loss_val': 0.9391805564144655, 'psi': 0.5973370082429241}-{'f1_val': 0.5621747922320061, 'auprc': 0.6856643492439048, 'loss_val': 0.8739279118004792, 'psi': 0.6115706150367656}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.841893 cos_to_last_merge=0.8317 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.832
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9926410076904618, 'auprc': 0.9969711478164747, 'loss_val': 0.039306602961386904, 'psi': 0.994373063740867}-{'f1_val': 0.9959874237039671, 'auprc': 0.9969645409952099, 'loss_val': 0.03362990572090664, 'psi': 0.9963782706204642}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.581595 cos_to_last_merge=0.9920 (last merge round=26)
[S15] round=34 local utility u=0.595314 metrics={'f1_val': 0.8980258950472406, 'auprc': 0.9913826803919252, 'loss_val': 0.17701563726433442, 'psi': 0.9353686091851146}-{'f1_val': 0.7753508815159754, 'auprc': 0.9026239735564139, 'loss_val': 0.365317800887132, 'psi': 0.8262601183321509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=34 head_norm_before_train=1.320389 cos_to_last_merge=0.9691 (last merge round=25)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.9849999139269763, 'auprc': 0.991274159554072, 'loss_val': 0.09923034794047177, 'psi': 0.9875096121778146}-{'f1_val': 0.9902333169744587, 'auprc': 0.9873442565473318, 'loss_val': 0.08608219980306601, 'psi': 0.989077692803608}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.902022 cos_to_last_merge=0.9981 (last merge round=26)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.652470073835089, 'auprc': 0.8620986449993864, 'loss_val': 1.1302090704362449, 'psi': 0.7363215023008081}-{'f1_val': 0.6954885563242377, 'auprc': 0.8948911255281141, 'loss_val': 0.5645101950776222, 'psi': 0.7752495840057883}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.731289 cos_to_last_merge=0.9851 (last merge round=22)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7210802063850564, 'auprc': 0.7984255489395465, 'loss_val': 0.6584033535065165, 'psi': 0.7520183434068525}-{'f1_val': 0.8287778780207619, 'auprc': 0.8527164712865011, 'loss_val': 0.4184895411311338, 'psi': 0.8383533153270575}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=2.103742 (no previous merge yet)
[S3] round=35 local utility u=0.119283 metrics={'f1_val': 0.9950498616312501, 'auprc': 0.9984223952912616, 'loss_val': 0.07241063266753883, 'psi': 0.9963988750952548}-{'f1_val': 0.9610750853994537, 'auprc': 0.9983211314708126, 'loss_val': 0.10682407297401621, 'psi': 0.9759735038279973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=35 head_norm_before_train=1.432639 cos_to_last_merge=0.9923 (last merge round=25)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9414212640064504, 'auprc': 0.9736239547222896, 'loss_val': 0.2661247283790366, 'psi': 0.9543023402927862}-{'f1_val': 0.9500022263356152, 'auprc': 0.9613546233846249, 'loss_val': 0.2547654667674013, 'psi': 0.954543185155219}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.553977 cos_to_last_merge=0.7878 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=35 local utility u=0.333444 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9971690991694069, 'loss_val': 0.21409124962406872, 'psi': 0.8190599987625782}-{'f1_val': 0.7154818779588469, 'auprc': 0.8080196611709636, 'loss_val': 0.4044986411733237, 'psi': 0.7524969912436936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=35 head_norm_before_train=1.336085 cos_to_last_merge=0.9540 (last merge round=22)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.7062984968226076, 'auprc': 0.9092151673263043, 'loss_val': 0.36850697977439806, 'psi': 0.7874651650240863}-{'f1_val': 0.8160416107756066, 'auprc': 0.9518668398591714, 'loss_val': 0.3923383600855997, 'psi': 0.8703717024090325}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.171785 cos_to_last_merge=0.9674 (last merge round=25)
[S7] round=35 local utility u=0.543040 metrics={'f1_val': 0.53035755583936, 'auprc': 0.7903506762214366, 'loss_val': 0.8384223735440407, 'psi': 0.6343548039921907}-{'f1_val': 0.40543371831878217, 'auprc': 0.7799710288394309, 'loss_val': 1.1438213508464652, 'psi': 0.5552486425270416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=35 head_norm_before_train=2.023004 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9918002683518325, 'auprc': 0.9992417038922834, 'loss_val': 0.03496187854790869, 'psi': 0.9947768425680129}-{'f1_val': 0.9943444494641033, 'auprc': 0.9993472731305593, 'loss_val': 0.028977676396097257, 'psi': 0.9963455789306856}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=2.069409 (no previous merge yet)
[S9] round=35 local utility u=0.002310 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9985037341557774, 'loss_val': 0.021479360424965867, 'psi': 0.9967473289928197}-{'f1_val': 0.9951604951085576, 'auprc': 0.9984728363770345, 'loss_val': 0.023511135079143954, 'psi': 0.9964854316159484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=35 head_norm_before_train=1.772284 cos_to_last_merge=0.7671 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.767
[S10] round=35 local utility u=0.000896 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9926894999877813, 'loss_val': 0.03645097485299542, 'psi': 0.9938744330007624}-{'f1_val': 0.9944449605296568, 'auprc': 0.9927573260763491, 'loss_val': 0.037130429532947276, 'psi': 0.9937699067483338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=35 head_norm_before_train=1.742661 cos_to_last_merge=0.9968 (last merge round=26)
[S11] round=35 local utility u=0.000513 metrics={'f1_val': 0.996305167468861, 'auprc': 0.996365202575128, 'loss_val': 0.03127839859385717, 'psi': 0.9963291815113677}-{'f1_val': 0.996305167468861, 'auprc': 0.9962501648701046, 'loss_val': 0.03195994145468581, 'psi': 0.9962831664293584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=35 head_norm_before_train=1.915940 cos_to_last_merge=0.9903 (last merge round=22)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5313145240819449, 'auprc': 0.6983081228198079, 'loss_val': 1.0353438692256347, 'psi': 0.5981119635770902}-{'f1_val': 0.5544805151517576, 'auprc': 0.661621747879674, 'loss_val': 0.9391805564144655, 'psi': 0.5973370082429241}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.855544 cos_to_last_merge=0.8307 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.831
[S14] round=35 local utility u=0.015881 metrics={'f1_val': 0.9959874237039671, 'auprc': 0.99869306448672, 'loss_val': 0.03278897478365949, 'psi': 0.9970696800170683}-{'f1_val': 0.9926410076904618, 'auprc': 0.9969711478164747, 'loss_val': 0.039306602961386904, 'psi': 0.994373063740867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=35 head_norm_before_train=1.608304 cos_to_last_merge=0.9905 (last merge round=26)
[S15] round=35 local utility u=0.335503 metrics={'f1_val': 0.9914211687415749, 'auprc': 0.9924669582641741, 'loss_val': 0.06963335961403967, 'psi': 0.9918394845506147}-{'f1_val': 0.8980258950472406, 'auprc': 0.9913826803919252, 'loss_val': 0.17701563726433442, 'psi': 0.9353686091851146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=35 head_norm_before_train=1.345266 cos_to_last_merge=0.9665 (last merge round=25)
[S16] round=35 local utility u=0.031802 metrics={'f1_val': 0.9911069169203253, 'auprc': 0.9918997111750524, 'loss_val': 0.07414506039503622, 'psi': 0.9914240346222161}-{'f1_val': 0.9849999139269763, 'auprc': 0.991274159554072, 'loss_val': 0.09923034794047177, 'psi': 0.9875096121778146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=35 head_norm_before_train=1.908720 cos_to_last_merge=0.9977 (last merge round=26)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6480646585837913, 'auprc': 0.864959568861485, 'loss_val': 1.1822663850039703, 'psi': 0.7348226226948688}-{'f1_val': 0.652470073835089, 'auprc': 0.8620986449993864, 'loss_val': 1.1302090704362449, 'psi': 0.7363215023008081}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.744386 cos_to_last_merge=0.9835 (last merge round=22)
[S2] round=36 local utility u=0.109986 metrics={'f1_val': 0.7205300197411686, 'auprc': 0.8442123762930938, 'loss_val': 0.572489990258309, 'psi': 0.7700029623619387}-{'f1_val': 0.7210802063850564, 'auprc': 0.7984255489395465, 'loss_val': 0.6584033535065165, 'psi': 0.7520183434068525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=36 head_norm_before_train=2.117253 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9982483265823372, 'loss_val': 0.13874792976947373, 'psi': 0.9759684849736263}-{'f1_val': 0.9950498616312501, 'auprc': 0.9984223952912616, 'loss_val': 0.07241063266753883, 'psi': 0.9963988750952548}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.442433 cos_to_last_merge=0.9912 (last merge round=25)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9406813385659013, 'auprc': 0.9754976349227883, 'loss_val': 0.2735742079359751, 'psi': 0.9546078571086561}-{'f1_val': 0.9414212640064504, 'auprc': 0.9736239547222896, 'loss_val': 0.2661247283790366, 'psi': 0.9543023402927862}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.562313 cos_to_last_merge=0.7892 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.789
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.7142403540694661, 'auprc': 0.79395662674189, 'loss_val': 0.586531322415062, 'psi': 0.7461268631384357}-{'f1_val': 0.700320598491359, 'auprc': 0.9971690991694069, 'loss_val': 0.21409124962406872, 'psi': 0.8190599987625782}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.353634 cos_to_last_merge=0.9514 (last merge round=22)
[S6] round=36 local utility u=0.350304 metrics={'f1_val': 0.8224172438355489, 'auprc': 0.9273881922452392, 'loss_val': 0.41912953811590364, 'psi': 0.864405623199425}-{'f1_val': 0.7062984968226076, 'auprc': 0.9092151673263043, 'loss_val': 0.36850697977439806, 'psi': 0.7874651650240863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=36 head_norm_before_train=1.175748 cos_to_last_merge=0.9667 (last merge round=25)
[S7] round=36 local utility u=0.477701 metrics={'f1_val': 0.6288699093613819, 'auprc': 0.8222585969392846, 'loss_val': 0.5698182429376036, 'psi': 0.706225384392543}-{'f1_val': 0.53035755583936, 'auprc': 0.7903506762214366, 'loss_val': 0.8384223735440407, 'psi': 0.6343548039921907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=36 head_norm_before_train=2.029151 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9878177834215355, 'auprc': 0.9893403959515092, 'loss_val': 0.058904131533855354, 'psi': 0.988426828433525}-{'f1_val': 0.9918002683518325, 'auprc': 0.9992417038922834, 'loss_val': 0.03496187854790869, 'psi': 0.9947768425680129}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=2.075777 (no previous merge yet)
[S9] round=36 local utility u=0.001065 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9986687049040146, 'loss_val': 0.021346031677406403, 'psi': 0.9969635129801171}-{'f1_val': 0.9955763922175147, 'auprc': 0.9985037341557774, 'loss_val': 0.021479360424965867, 'psi': 0.9967473289928197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=36 head_norm_before_train=1.787111 cos_to_last_merge=0.7659 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.766
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9947220017031884, 'loss_val': 0.038195995393921586, 'psi': 0.9940045798087831}-{'f1_val': 0.9946643883427498, 'auprc': 0.9926894999877813, 'loss_val': 0.03645097485299542, 'psi': 0.9938744330007624}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.752759 cos_to_last_merge=0.9963 (last merge round=26)
[S11] round=36 local utility u=0.000588 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9966835818119731, 'loss_val': 0.031057351095753534, 'psi': 0.9964565332061058}-{'f1_val': 0.996305167468861, 'auprc': 0.996365202575128, 'loss_val': 0.03127839859385717, 'psi': 0.9963291815113677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=36 head_norm_before_train=1.923104 cos_to_last_merge=0.9898 (last merge round=22)
[S13] round=36 local utility u=0.113530 metrics={'f1_val': 0.5548699574365817, 'auprc': 0.6946977487356931, 'loss_val': 0.9387857636401413, 'psi': 0.6108010739562263}-{'f1_val': 0.5313145240819449, 'auprc': 0.6983081228198079, 'loss_val': 1.0353438692256347, 'psi': 0.5981119635770902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=36 head_norm_before_train=1.867249 cos_to_last_merge=0.8298 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.830
[S14] round=36 local utility u=0.002049 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9969747833199353, 'loss_val': 0.028276302964200948, 'psi': 0.9968563778994359}-{'f1_val': 0.9959874237039671, 'auprc': 0.99869306448672, 'loss_val': 0.03278897478365949, 'psi': 0.9970696800170683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] sending update (kind=head size=1807 to 1 peers)
[S15] START round=36 head_norm_before_train=1.633989 cos_to_last_merge=0.9892 (last merge round=26)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.8978425069668011, 'auprc': 0.9847881699487975, 'loss_val': 0.18172580753924736, 'psi': 0.9326207721595997}-{'f1_val': 0.9914211687415749, 'auprc': 0.9924669582641741, 'loss_val': 0.06963335961403967, 'psi': 0.9918394845506147}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.370043 cos_to_last_merge=0.9638 (last merge round=25)
[S16] round=36 local utility u=0.000678 metrics={'f1_val': 0.9910985726540806, 'auprc': 0.99028268651156, 'loss_val': 0.06788765323701496, 'psi': 0.9907722181970724}-{'f1_val': 0.9911069169203253, 'auprc': 0.9918997111750524, 'loss_val': 0.07414506039503622, 'psi': 0.9914240346222161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=36 head_norm_before_train=1.916565 cos_to_last_merge=0.9973 (last merge round=26)
[S17] round=36 local utility u=0.135634 metrics={'f1_val': 0.6589910868890985, 'auprc': 0.8509413968907747, 'loss_val': 0.9345022473532687, 'psi': 0.7357712108897689}-{'f1_val': 0.6480646585837913, 'auprc': 0.864959568861485, 'loss_val': 1.1822663850039703, 'psi': 0.7348226226948688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=37 head_norm_before_train=1.754623 cos_to_last_merge=0.9823 (last merge round=22)
[S2] round=37 local utility u=0.432054 metrics={'f1_val': 0.8240168838576897, 'auprc': 0.8584821305850913, 'loss_val': 0.3721115368872376, 'psi': 0.8378029825486504}-{'f1_val': 0.7205300197411686, 'auprc': 0.8442123762930938, 'loss_val': 0.572489990258309, 'psi': 0.7700029623619387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=37 head_norm_before_train=2.129887 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9582793398046867, 'auprc': 0.998906957807022, 'loss_val': 0.1427285968230109, 'psi': 0.9745303870056208}-{'f1_val': 0.9611152572344858, 'auprc': 0.9982483265823372, 'loss_val': 0.13874792976947373, 'psi': 0.9759684849736263}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.453694 cos_to_last_merge=0.9902 (last merge round=25)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9168441693127918, 'auprc': 0.9708595688857802, 'loss_val': 0.3554308858847744, 'psi': 0.9384503291419871}-{'f1_val': 0.9406813385659013, 'auprc': 0.9754976349227883, 'loss_val': 0.2735742079359751, 'psi': 0.9546078571086561}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.568670 cos_to_last_merge=0.7896 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=37 local utility u=0.746743 metrics={'f1_val': 0.8063651500276947, 'auprc': 0.9928321195325298, 'loss_val': 0.24242063644329903, 'psi': 0.8809519378296288}-{'f1_val': 0.7142403540694661, 'auprc': 0.79395662674189, 'loss_val': 0.586531322415062, 'psi': 0.7461268631384357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=37 head_norm_before_train=1.369616 cos_to_last_merge=0.9491 (last merge round=22)
[S6] ⚠️ Model drifted since last merge! cos=0.949
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6048520830577149, 'auprc': 0.9102256834840562, 'loss_val': 0.7094403819858117, 'psi': 0.7270015232282514}-{'f1_val': 0.8224172438355489, 'auprc': 0.9273881922452392, 'loss_val': 0.41912953811590364, 'psi': 0.864405623199425}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.180664 cos_to_last_merge=0.9658 (last merge round=25)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.38136273914988267, 'auprc': 0.7796242895890834, 'loss_val': 1.2525182811471207, 'psi': 0.540667359325563}-{'f1_val': 0.6288699093613819, 'auprc': 0.8222585969392846, 'loss_val': 0.5698182429376036, 'psi': 0.706225384392543}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=2.037471 (no previous merge yet)
[S8] round=37 local utility u=0.026243 metrics={'f1_val': 0.9886451496573567, 'auprc': 0.9991875222578499, 'loss_val': 0.040923607027144496, 'psi': 0.992862098697554}-{'f1_val': 0.9878177834215355, 'auprc': 0.9893403959515092, 'loss_val': 0.058904131533855354, 'psi': 0.988426828433525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=37 head_norm_before_train=2.082719 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9987840510479618, 'loss_val': 0.023332947475641276, 'psi': 0.9960096804428586}-{'f1_val': 0.9958267183641853, 'auprc': 0.9986687049040146, 'loss_val': 0.021346031677406403, 'psi': 0.9969635129801171}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.801570 cos_to_last_merge=0.7648 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.765
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9939496455455336, 'loss_val': 0.03647177892271631, 'psi': 0.9936956373457213}-{'f1_val': 0.9935262985458464, 'auprc': 0.9947220017031884, 'loss_val': 0.038195995393921586, 'psi': 0.9940045798087831}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.762410 cos_to_last_merge=0.9958 (last merge round=26)
[S11] round=37 local utility u=0.001698 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.996587552066364, 'loss_val': 0.02882354566953038, 'psi': 0.9965632235346993}-{'f1_val': 0.996305167468861, 'auprc': 0.9966835818119731, 'loss_val': 0.031057351095753534, 'psi': 0.9964565332061058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=37 head_norm_before_train=1.930913 cos_to_last_merge=0.9892 (last merge round=22)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5652868075341488, 'auprc': 0.666277087900056, 'loss_val': 0.9523598757942858, 'psi': 0.6056829196805118}-{'f1_val': 0.5548699574365817, 'auprc': 0.6946977487356931, 'loss_val': 0.9387857636401413, 'psi': 0.6108010739562263}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.875455 cos_to_last_merge=0.8292 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.829
[S14] round=37 local utility u=0.001695 metrics={'f1_val': 0.9972630104447024, 'auprc': 0.9970794597521229, 'loss_val': 0.02811420127051018, 'psi': 0.9971895901676706}-{'f1_val': 0.9967774409524363, 'auprc': 0.9969747833199353, 'loss_val': 0.028276302964200948, 'psi': 0.9968563778994359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=37 head_norm_before_train=1.656997 cos_to_last_merge=0.9880 (last merge round=26)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7753262235426694, 'auprc': 0.95137481193485, 'loss_val': 0.36271719565861954, 'psi': 0.8457456588995417}-{'f1_val': 0.8978425069668011, 'auprc': 0.9847881699487975, 'loss_val': 0.18172580753924736, 'psi': 0.9326207721595997}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.394339 cos_to_last_merge=0.9611 (last merge round=25)
[S16] round=37 local utility u=0.008223 metrics={'f1_val': 0.9917880435184186, 'auprc': 0.9930336798625926, 'loss_val': 0.06383184684543523, 'psi': 0.9922862980560883}-{'f1_val': 0.9910985726540806, 'auprc': 0.99028268651156, 'loss_val': 0.06788765323701496, 'psi': 0.9907722181970724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=37 head_norm_before_train=1.923591 cos_to_last_merge=0.9970 (last merge round=26)
[S17] round=37 local utility u=0.122052 metrics={'f1_val': 0.674882245828416, 'auprc': 0.8910337397148002, 'loss_val': 0.9060225006297453, 'psi': 0.7613428433829696}-{'f1_val': 0.6589910868890985, 'auprc': 0.8509413968907747, 'loss_val': 0.9345022473532687, 'psi': 0.7357712108897689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=38 head_norm_before_train=1.764413 cos_to_last_merge=0.9812 (last merge round=22)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6950621463670981, 'auprc': 0.7856405585777412, 'loss_val': 0.9210825463185769, 'psi': 0.7312935112513553}-{'f1_val': 0.8240168838576897, 'auprc': 0.8584821305850913, 'loss_val': 0.3721115368872376, 'psi': 0.8378029825486504}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=2.143541 (no previous merge yet)
[S3] round=38 local utility u=0.172699 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.998608183622554, 'loss_val': 0.031320316179885684, 'psi': 0.9978995510209562}-{'f1_val': 0.9582793398046867, 'auprc': 0.998906957807022, 'loss_val': 0.1427285968230109, 'psi': 0.9745303870056208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=38 head_norm_before_train=1.457596 cos_to_last_merge=0.9896 (last merge round=25)
[S4] round=38 local utility u=0.128045 metrics={'f1_val': 0.9404437587399981, 'auprc': 0.9804552518724718, 'loss_val': 0.26972500371995, 'psi': 0.9564483559929876}-{'f1_val': 0.9168441693127918, 'auprc': 0.9708595688857802, 'loss_val': 0.3554308858847744, 'psi': 0.9384503291419871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=38 head_norm_before_train=1.573225 cos_to_last_merge=0.7897 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.7143055407944305, 'auprc': 0.8117196275178266, 'loss_val': 0.44638855583466086, 'psi': 0.753271175483789}-{'f1_val': 0.8063651500276947, 'auprc': 0.9928321195325298, 'loss_val': 0.24242063644329903, 'psi': 0.8809519378296288}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.383307 cos_to_last_merge=0.9470 (last merge round=22)
[S6] ⚠️ Model drifted since last merge! cos=0.947
[S6] round=38 local utility u=0.556673 metrics={'f1_val': 0.7511389590254104, 'auprc': 0.930920618311919, 'loss_val': 0.5358995345373236, 'psi': 0.8230516227400138}-{'f1_val': 0.6048520830577149, 'auprc': 0.9102256834840562, 'loss_val': 0.7094403819858117, 'psi': 0.7270015232282514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=38 head_norm_before_train=1.184412 cos_to_last_merge=0.9650 (last merge round=25)
[S7] round=38 local utility u=1.000000 metrics={'f1_val': 0.6237616207360848, 'auprc': 0.8125922367004894, 'loss_val': 0.6000440193625026, 'psi': 0.6992938671218467}-{'f1_val': 0.38136273914988267, 'auprc': 0.7796242895890834, 'loss_val': 1.2525182811471207, 'psi': 0.540667359325563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=38 head_norm_before_train=2.042361 (no previous merge yet)
[S8] round=38 local utility u=0.015702 metrics={'f1_val': 0.9925263999649303, 'auprc': 0.9992382098275431, 'loss_val': 0.03295818167384481, 'psi': 0.9952111239099755}-{'f1_val': 0.9886451496573567, 'auprc': 0.9991875222578499, 'loss_val': 0.040923607027144496, 'psi': 0.992862098697554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=38 head_norm_before_train=2.090965 (no previous merge yet)
[S9] round=38 local utility u=0.006658 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9987399129521759, 'loss_val': 0.019884099882904314, 'psi': 0.9969919961993816}-{'f1_val': 0.9941601000394567, 'auprc': 0.9987840510479618, 'loss_val': 0.023332947475641276, 'psi': 0.9960096804428586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=38 head_norm_before_train=1.814888 cos_to_last_merge=0.7637 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.764
[S10] round=38 local utility u=0.000157 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9931750116258542, 'loss_val': 0.03539978352909174, 'psi': 0.9935422777951547}-{'f1_val': 0.9935262985458464, 'auprc': 0.9939496455455336, 'loss_val': 0.03647177892271631, 'psi': 0.9936956373457213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=38 head_norm_before_train=1.772046 cos_to_last_merge=0.9953 (last merge round=26)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9967856170633422, 'loss_val': 0.029329594336307264, 'psi': 0.9964973473066534}-{'f1_val': 0.9965470045135896, 'auprc': 0.996587552066364, 'loss_val': 0.02882354566953038, 'psi': 0.9965632235346993}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.937508 cos_to_last_merge=0.9886 (last merge round=22)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5269598235661785, 'auprc': 0.7067119465323085, 'loss_val': 1.0428785893339538, 'psi': 0.5988606727526304}-{'f1_val': 0.5652868075341488, 'auprc': 0.666277087900056, 'loss_val': 0.9523598757942858, 'psi': 0.6056829196805118}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.882866 cos_to_last_merge=0.8290 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.829
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9974336367705932, 'auprc': 0.9971013140055488, 'loss_val': 0.029689754656193296, 'psi': 0.9973007076645755}-{'f1_val': 0.9972630104447024, 'auprc': 0.9970794597521229, 'loss_val': 0.02811420127051018, 'psi': 0.9971895901676706}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.676481 cos_to_last_merge=0.9870 (last merge round=26)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.6991327268672578, 'auprc': 0.9087774151603247, 'loss_val': 0.5009120630749565, 'psi': 0.7829906021844846}-{'f1_val': 0.7753262235426694, 'auprc': 0.95137481193485, 'loss_val': 0.36271719565861954, 'psi': 0.8457456588995417}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.417300 cos_to_last_merge=0.9587 (last merge round=25)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9408531834132521, 'auprc': 0.989343393066612, 'loss_val': 0.22536458519877872, 'psi': 0.960249267274596}-{'f1_val': 0.9917880435184186, 'auprc': 0.9930336798625926, 'loss_val': 0.06383184684543523, 'psi': 0.9922862980560883}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.932058 cos_to_last_merge=0.9965 (last merge round=26)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6625961233305065, 'auprc': 0.819364036296353, 'loss_val': 1.1820286528898507, 'psi': 0.7253032885168451}-{'f1_val': 0.674882245828416, 'auprc': 0.8910337397148002, 'loss_val': 0.9060225006297453, 'psi': 0.7613428433829696}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.776408 cos_to_last_merge=0.9799 (last merge round=22)
[S2] round=39 local utility u=0.562280 metrics={'f1_val': 0.7083733248531882, 'auprc': 0.974248364312361, 'loss_val': 0.4422128818453788, 'psi': 0.8147233406368573}-{'f1_val': 0.6950621463670981, 'auprc': 0.7856405585777412, 'loss_val': 0.9210825463185769, 'psi': 0.7312935112513553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S2] r=40 psi=0.815 u=0.5623 p_local=0.2310 f1=0.708 auprc=0.974 bytes=50316
[S3] START round=39 head_norm_before_train=2.155279 (no previous merge yet)
[S3] round=39 local utility u=0.004904 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9986941926914037, 'loss_val': 0.024067107116457077, 'psi': 0.9981636976371373}-{'f1_val': 0.9974271292865575, 'auprc': 0.998608183622554, 'loss_val': 0.031320316179885684, 'psi': 0.9978995510209562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S3] r=40 psi=0.998 u=0.0049 p_local=0.0475 f1=0.998 auprc=0.999 bytes=43127
[S4] START round=39 head_norm_before_train=1.463196 cos_to_last_merge=0.9891 (last merge round=25)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9409491206424667, 'auprc': 0.9769271010814358, 'loss_val': 0.2725300628862662, 'psi': 0.9553403128180544}-{'f1_val': 0.9404437587399981, 'auprc': 0.9804552518724718, 'loss_val': 0.26972500371995, 'psi': 0.9564483559929876}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.955 u=0.0000 p_local=0.0365 f1=0.941 auprc=0.977 bytes=35967
[S5] START round=39 head_norm_before_train=1.579682 cos_to_last_merge=0.7894 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.789
[S5] round=39 local utility u=0.133040 metrics={'f1_val': 0.7143049231465757, 'auprc': 0.8765458426132412, 'loss_val': 0.3747830755609731, 'psi': 0.7792012909332419}-{'f1_val': 0.7143055407944305, 'auprc': 0.8117196275178266, 'loss_val': 0.44638855583466086, 'psi': 0.753271175483789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S5] r=40 psi=0.779 u=0.1330 p_local=0.1968 f1=0.714 auprc=0.877 bytes=41345
[S6] START round=39 head_norm_before_train=1.393645 cos_to_last_merge=0.9451 (last merge round=22)
[S6] ⚠️ Model drifted since last merge! cos=0.945
[S6] round=39 local utility u=0.000914 metrics={'f1_val': 0.7933612422111115, 'auprc': 0.814669851655755, 'loss_val': 0.4386526775958591, 'psi': 0.8018846859889689}-{'f1_val': 0.7511389590254104, 'auprc': 0.930920618311919, 'loss_val': 0.5358995345373236, 'psi': 0.8230516227400138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S6] r=40 psi=0.802 u=0.0009 p_local=0.2331 f1=0.793 auprc=0.815 bytes=41318
[S7] START round=39 head_norm_before_train=1.191585 cos_to_last_merge=0.9634 (last merge round=25)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5001650851034125, 'auprc': 0.7826612405430149, 'loss_val': 0.8807807404772939, 'psi': 0.6131635472792535}-{'f1_val': 0.6237616207360848, 'auprc': 0.8125922367004894, 'loss_val': 0.6000440193625026, 'psi': 0.6992938671218467}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.613 u=0.0000 p_local=0.3502 f1=0.500 auprc=0.783 bytes=43116
[S8] START round=39 head_norm_before_train=2.048222 (no previous merge yet)
[S8] round=39 local utility u=0.007745 metrics={'f1_val': 0.9942884390087473, 'auprc': 0.9992951869995136, 'loss_val': 0.028210573435365465, 'psi': 0.9962911382050539}-{'f1_val': 0.9925263999649303, 'auprc': 0.9992382098275431, 'loss_val': 0.03295818167384481, 'psi': 0.9952111239099755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S8] r=40 psi=0.996 u=0.0077 p_local=0.0188 f1=0.994 auprc=0.999 bytes=50390
[S9] START round=39 head_norm_before_train=2.100350 (no previous merge yet)
[S9] round=39 local utility u=0.002426 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984631789992463, 'loss_val': 0.01920553476965563, 'psi': 0.9973815786880333}-{'f1_val': 0.9958267183641853, 'auprc': 0.9987399129521759, 'loss_val': 0.019884099882904314, 'psi': 0.9969919961993816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S9] r=40 psi=0.997 u=0.0024 p_local=0.0046 f1=0.997 auprc=0.998 bytes=53907
[S10] START round=39 head_norm_before_train=1.824855 cos_to_last_merge=0.7632 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.763
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9944061145289902, 'loss_val': 0.03701040095404974, 'psi': 0.9937468710441391}-{'f1_val': 0.9937871219080217, 'auprc': 0.9931750116258542, 'loss_val': 0.03539978352909174, 'psi': 0.9935422777951547}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.994 u=0.0000 p_local=0.0036 f1=0.993 auprc=0.994 bytes=50355
[S11] START round=39 head_norm_before_train=1.782590 cos_to_last_merge=0.9948 (last merge round=26)
[S11] round=39 local utility u=0.000566 metrics={'f1_val': 0.9963263815449162, 'auprc': 0.9967651852660513, 'loss_val': 0.02826266741259792, 'psi': 0.9965019030333703}-{'f1_val': 0.996305167468861, 'auprc': 0.9967856170633422, 'loss_val': 0.029329594336307264, 'psi': 0.9964973473066534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S11] r=40 psi=0.997 u=0.0006 p_local=0.0027 f1=0.996 auprc=0.997 bytes=57482
[S13] START round=39 head_norm_before_train=1.944840 cos_to_last_merge=0.9882 (last merge round=22)
[S13] round=39 local utility u=0.068414 metrics={'f1_val': 0.5469588676809731, 'auprc': 0.6970460914796262, 'loss_val': 0.9970482119028211, 'psi': 0.6069937572004342}-{'f1_val': 0.5269598235661785, 'auprc': 0.7067119465323085, 'loss_val': 1.0428785893339538, 'psi': 0.5988606727526304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S13] r=40 psi=0.607 u=0.0684 p_local=0.0607 f1=0.547 auprc=0.697 bytes=35988
[S14] START round=39 head_norm_before_train=1.891345 cos_to_last_merge=0.8284 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.828
[S14] round=39 local utility u=0.000265 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9971010579060956, 'loss_val': 0.026679719634343967, 'psi': 0.9970525968361637}-{'f1_val': 0.9974336367705932, 'auprc': 0.9971013140055488, 'loss_val': 0.029689754656193296, 'psi': 0.9973007076645755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S14] r=40 psi=0.997 u=0.0003 p_local=0.0168 f1=0.997 auprc=0.997 bytes=52222
[S15] START round=39 head_norm_before_train=1.694486 cos_to_last_merge=0.9859 (last merge round=26)
[S15] round=39 local utility u=1.000000 metrics={'f1_val': 0.9751306139552913, 'auprc': 0.9851995275973993, 'loss_val': 0.07887557481473398, 'psi': 0.9791581794121345}-{'f1_val': 0.6991327268672578, 'auprc': 0.9087774151603247, 'loss_val': 0.5009120630749565, 'psi': 0.7829906021844846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S15] r=40 psi=0.979 u=1.0000 p_local=0.3146 f1=0.975 auprc=0.985 bytes=43129
[S16] START round=39 head_norm_before_train=1.436150 cos_to_last_merge=0.9565 (last merge round=25)
[S16] round=39 local utility u=0.212721 metrics={'f1_val': 0.9883392258765044, 'auprc': 0.982899996863209, 'loss_val': 0.06550909986899615, 'psi': 0.9861635342711862}-{'f1_val': 0.9408531834132521, 'auprc': 0.989343393066612, 'loss_val': 0.22536458519877872, 'psi': 0.960249267274596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S16] r=40 psi=0.986 u=0.2127 p_local=0.0790 f1=0.988 auprc=0.983 bytes=46740
[S17] START round=39 head_norm_before_train=1.941831 cos_to_last_merge=0.9959 (last merge round=26)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6533978298626991, 'auprc': 0.7972405775637037, 'loss_val': 1.1733500482446781, 'psi': 0.710934928943101}-{'f1_val': 0.6625961233305065, 'auprc': 0.819364036296353, 'loss_val': 1.1820286528898507, 'psi': 0.7253032885168451}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.711 u=0.0000 p_local=0.0584 f1=0.653 auprc=0.797 bytes=39578
[S2] START round=40 head_norm_before_train=1.786765 cos_to_last_merge=0.9788 (last merge round=22)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.719822189233516, 'auprc': 0.8075331464084361, 'loss_val': 0.5576368342152508, 'psi': 0.7549065721034841}-{'f1_val': 0.7083733248531882, 'auprc': 0.974248364312361, 'loss_val': 0.4422128818453788, 'psi': 0.8147233406368573}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.165159 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9982167029799696, 'loss_val': 0.13256572804724945, 'psi': 0.975907831855254}-{'f1_val': 0.9978100342676263, 'auprc': 0.9986941926914037, 'loss_val': 0.024067107116457077, 'psi': 0.9981636976371373}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.471565 cos_to_last_merge=0.9884 (last merge round=25)
[S4] round=40 local utility u=0.010892 metrics={'f1_val': 0.9423543733855793, 'auprc': 0.9778514291024865, 'loss_val': 0.26195119810325823, 'psi': 0.9565531956723421}-{'f1_val': 0.9409491206424667, 'auprc': 0.9769271010814358, 'loss_val': 0.2725300628862662, 'psi': 0.9553403128180544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=40 head_norm_before_train=1.590798 cos_to_last_merge=0.7883 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=40 local utility u=1.000000 metrics={'f1_val': 0.9964804002465358, 'auprc': 0.9969886386173915, 'loss_val': 0.09847955403677054, 'psi': 0.9966836955948781}-{'f1_val': 0.7143049231465757, 'auprc': 0.8765458426132412, 'loss_val': 0.3747830755609731, 'psi': 0.7792012909332419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=40 head_norm_before_train=1.404156 cos_to_last_merge=0.9435 (last merge round=22)
[S6] ⚠️ Model drifted since last merge! cos=0.943
[S6] round=40 local utility u=0.248642 metrics={'f1_val': 0.8103586435770672, 'auprc': 0.9428248493402153, 'loss_val': 0.42781899984584676, 'psi': 0.8633451258823264}-{'f1_val': 0.7933612422111115, 'auprc': 0.814669851655755, 'loss_val': 0.4386526775958591, 'psi': 0.8018846859889689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=40 head_norm_before_train=1.199618 cos_to_last_merge=0.9615 (last merge round=25)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.47769616977469836, 'auprc': 0.7787145018388262, 'loss_val': 0.9578578190914904, 'psi': 0.5981035026003495}-{'f1_val': 0.5001650851034125, 'auprc': 0.7826612405430149, 'loss_val': 0.8807807404772939, 'psi': 0.6131635472792535}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=2.055891 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9868628313097598, 'auprc': 0.9992492969583814, 'loss_val': 0.04433011483320672, 'psi': 0.9918174175692085}-{'f1_val': 0.9942884390087473, 'auprc': 0.9992951869995136, 'loss_val': 0.028210573435365465, 'psi': 0.9962911382050539}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=2.107839 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9987821460612907, 'loss_val': 0.02424452100534532, 'psi': 0.9957581634183412}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984631789992463, 'loss_val': 0.01920553476965563, 'psi': 0.9973815786880333}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.835777 cos_to_last_merge=0.7625 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.762
[S10] round=40 local utility u=0.000224 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9945492314556446, 'loss_val': 0.03699261010140696, 'psi': 0.9938041178148007}-{'f1_val': 0.9933073753875716, 'auprc': 0.9944061145289902, 'loss_val': 0.03701040095404974, 'psi': 0.9937468710441391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=40 head_norm_before_train=1.792420 cos_to_last_merge=0.9943 (last merge round=26)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9968361888045181, 'loss_val': 0.0284869716183451, 'psi': 0.9965175760031237}-{'f1_val': 0.9963263815449162, 'auprc': 0.9967651852660513, 'loss_val': 0.02826266741259792, 'psi': 0.9965019030333703}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.952329 cos_to_last_merge=0.9875 (last merge round=22)
[S13] round=40 local utility u=0.061824 metrics={'f1_val': 0.5604031066085751, 'auprc': 0.6796225973596703, 'loss_val': 0.9017949695470752, 'psi': 0.6080909029090131}-{'f1_val': 0.5469588676809731, 'auprc': 0.6970460914796262, 'loss_val': 0.9970482119028211, 'psi': 0.6069937572004342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=40 head_norm_before_train=1.901114 cos_to_last_merge=0.8274 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.827
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9573569719410893, 'auprc': 0.9971066458940501, 'loss_val': 0.06067010573104713, 'psi': 0.9732568415222735}-{'f1_val': 0.9970202894562089, 'auprc': 0.9971010579060956, 'loss_val': 0.026679719634343967, 'psi': 0.9970525968361637}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.711880 cos_to_last_merge=0.9847 (last merge round=26)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.8864874259360292, 'auprc': 0.9901305112700953, 'loss_val': 0.23444151595508325, 'psi': 0.9279446600696557}-{'f1_val': 0.9751306139552913, 'auprc': 0.9851995275973993, 'loss_val': 0.07887557481473398, 'psi': 0.9791581794121345}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.452837 cos_to_last_merge=0.9547 (last merge round=25)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.9251129318257967, 'auprc': 0.9896698740957539, 'loss_val': 0.37868490541347183, 'psi': 0.9509357087337795}-{'f1_val': 0.9883392258765044, 'auprc': 0.982899996863209, 'loss_val': 0.06550909986899615, 'psi': 0.9861635342711862}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.950322 cos_to_last_merge=0.9954 (last merge round=26)
[S17] round=40 local utility u=0.183151 metrics={'f1_val': 0.6637766142042532, 'auprc': 0.8698985656032537, 'loss_val': 1.0872954267342159, 'psi': 0.7462253947638533}-{'f1_val': 0.6533978298626991, 'auprc': 0.7972405775637037, 'loss_val': 1.1733500482446781, 'psi': 0.710934928943101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=41 head_norm_before_train=1.798428 cos_to_last_merge=0.9775 (last merge round=22)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.7211001877200303, 'auprc': 0.7970970258056047, 'loss_val': 0.7458080492138637, 'psi': 0.7514989229542601}-{'f1_val': 0.719822189233516, 'auprc': 0.8075331464084361, 'loss_val': 0.5576368342152508, 'psi': 0.7549065721034841}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.174324 (no previous merge yet)
[S3] round=41 local utility u=0.165497 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9984095631955632, 'loss_val': 0.020328678697809698, 'psi': 0.9978027667458598}-{'f1_val': 0.9610352511054436, 'auprc': 0.9982167029799696, 'loss_val': 0.13256572804724945, 'psi': 0.975907831855254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=41 head_norm_before_train=1.480428 cos_to_last_merge=0.9878 (last merge round=25)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9402820857399273, 'auprc': 0.9710576985190598, 'loss_val': 0.26893319091029394, 'psi': 0.9525923308515802}-{'f1_val': 0.9423543733855793, 'auprc': 0.9778514291024865, 'loss_val': 0.26195119810325823, 'psi': 0.9565531956723421}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.600177 cos_to_last_merge=0.7867 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=41 local utility u=0.003550 metrics={'f1_val': 0.9963332086366786, 'auprc': 0.9970695184884155, 'loss_val': 0.09073915907454548, 'psi': 0.9966277325773734}-{'f1_val': 0.9964804002465358, 'auprc': 0.9969886386173915, 'loss_val': 0.09847955403677054, 'psi': 0.9966836955948781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=41 head_norm_before_train=1.410686 cos_to_last_merge=0.9418 (last merge round=22)
[S6] ⚠️ Model drifted since last merge! cos=0.942
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.7314006937105685, 'auprc': 0.792568274472607, 'loss_val': 0.6257720013781265, 'psi': 0.7558677260153839}-{'f1_val': 0.8103586435770672, 'auprc': 0.9428248493402153, 'loss_val': 0.42781899984584676, 'psi': 0.8633451258823264}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.205705 cos_to_last_merge=0.9600 (last merge round=25)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.4162071813975062, 'auprc': 0.7773230447879218, 'loss_val': 1.080489715253356, 'psi': 0.5606535267536724}-{'f1_val': 0.47769616977469836, 'auprc': 0.7787145018388262, 'loss_val': 0.9578578190914904, 'psi': 0.5981035026003495}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=2.063383 (no previous merge yet)
[S8] round=41 local utility u=0.026685 metrics={'f1_val': 0.9932547113812498, 'auprc': 0.999407412735609, 'loss_val': 0.029785754838344173, 'psi': 0.9957157919229934}-{'f1_val': 0.9868628313097598, 'auprc': 0.9992492969583814, 'loss_val': 0.04433011483320672, 'psi': 0.9918174175692085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=41 head_norm_before_train=2.110853 (no previous merge yet)
[S9] round=41 local utility u=0.010634 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9985904668276542, 'loss_val': 0.01991230561636519, 'psi': 0.9974324938193966}-{'f1_val': 0.9937421749897083, 'auprc': 0.9987821460612907, 'loss_val': 0.02424452100534532, 'psi': 0.9957581634183412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=41 head_norm_before_train=1.847102 cos_to_last_merge=0.7617 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.762
[S10] round=41 local utility u=0.000354 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9936250601186519, 'loss_val': 0.03482633323048761, 'psi': 0.9935658031749686}-{'f1_val': 0.9933073753875716, 'auprc': 0.9945492314556446, 'loss_val': 0.03699261010140696, 'psi': 0.9938041178148007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=41 head_norm_before_train=1.801203 cos_to_last_merge=0.9939 (last merge round=26)
[S11] round=41 local utility u=0.000868 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9961852557098609, 'loss_val': 0.02624952437443836, 'psi': 0.9964023049920981}-{'f1_val': 0.996305167468861, 'auprc': 0.9968361888045181, 'loss_val': 0.0284869716183451, 'psi': 0.9965175760031237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] sending update (kind=head size=1791 to 1 peers)
[S13] START round=41 head_norm_before_train=1.958667 cos_to_last_merge=0.9869 (last merge round=22)
[S13] round=41 local utility u=0.127396 metrics={'f1_val': 0.5841915924931484, 'auprc': 0.7064151580936812, 'loss_val': 0.8701121750157887, 'psi': 0.6330810187333615}-{'f1_val': 0.5604031066085751, 'auprc': 0.6796225973596703, 'loss_val': 0.9017949695470752, 'psi': 0.6080909029090131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=41 head_norm_before_train=1.910561 cos_to_last_merge=0.8262 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.826
[S14] round=41 local utility u=0.089286 metrics={'f1_val': 0.9843128931005477, 'auprc': 0.9971034004510002, 'loss_val': 0.04382454509854731, 'psi': 0.9894290960407288}-{'f1_val': 0.9573569719410893, 'auprc': 0.9971066458940501, 'loss_val': 0.06067010573104713, 'psi': 0.9732568415222735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=41 head_norm_before_train=1.726427 cos_to_last_merge=0.9839 (last merge round=26)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6979363109643824, 'auprc': 0.7573387209565685, 'loss_val': 0.6166554838335894, 'psi': 0.7216972749612568}-{'f1_val': 0.8864874259360292, 'auprc': 0.9901305112700953, 'loss_val': 0.23444151595508325, 'psi': 0.9279446600696557}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.468133 cos_to_last_merge=0.9531 (last merge round=25)
[S16] round=41 local utility u=0.112023 metrics={'f1_val': 0.9393208330050393, 'auprc': 0.9873959038347557, 'loss_val': 0.23306526521845622, 'psi': 0.9585508613369259}-{'f1_val': 0.9251129318257967, 'auprc': 0.9896698740957539, 'loss_val': 0.37868490541347183, 'psi': 0.9509357087337795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=41 head_norm_before_train=1.961919 cos_to_last_merge=0.9950 (last merge round=26)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6476174011541663, 'auprc': 0.8703107466432665, 'loss_val': 1.0152222201381076, 'psi': 0.7366947393498064}-{'f1_val': 0.6637766142042532, 'auprc': 0.8698985656032537, 'loss_val': 1.0872954267342159, 'psi': 0.7462253947638533}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.807546 cos_to_last_merge=0.9766 (last merge round=22)
[S2] round=42 local utility u=0.031861 metrics={'f1_val': 0.7210802063850564, 'auprc': 0.7986985868737768, 'loss_val': 0.6867717695147847, 'psi': 0.7521275585805446}-{'f1_val': 0.7211001877200303, 'auprc': 0.7970970258056047, 'loss_val': 0.7458080492138637, 'psi': 0.7514989229542601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=42 head_norm_before_train=2.184682 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9945116724085847, 'auprc': 0.9986668152876323, 'loss_val': 0.032545579321348606, 'psi': 0.9961737295602038}-{'f1_val': 0.9973982357793907, 'auprc': 0.9984095631955632, 'loss_val': 0.020328678697809698, 'psi': 0.9978027667458598}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.488896 cos_to_last_merge=0.9871 (last merge round=25)
[S4] round=42 local utility u=0.028869 metrics={'f1_val': 0.9492052007972822, 'auprc': 0.9680118898488975, 'loss_val': 0.25559741383452367, 'psi': 0.9567278764179283}-{'f1_val': 0.9402820857399273, 'auprc': 0.9710576985190598, 'loss_val': 0.26893319091029394, 'psi': 0.9525923308515802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=42 head_norm_before_train=1.606722 cos_to_last_merge=0.7854 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.7315480043292901, 'auprc': 0.9910039313916932, 'loss_val': 0.21895440740193495, 'psi': 0.8353303751542513}-{'f1_val': 0.9963332086366786, 'auprc': 0.9970695184884155, 'loss_val': 0.09073915907454548, 'psi': 0.9966277325773734}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.418169 cos_to_last_merge=0.9399 (last merge round=22)
[S6] ⚠️ Model drifted since last merge! cos=0.940
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.6166077976626417, 'auprc': 0.7881430422109597, 'loss_val': 0.8260211347798223, 'psi': 0.6852218954819689}-{'f1_val': 0.7314006937105685, 'auprc': 0.792568274472607, 'loss_val': 0.6257720013781265, 'psi': 0.7558677260153839}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.211064 cos_to_last_merge=0.9591 (last merge round=25)
[S7] round=42 local utility u=1.000000 metrics={'f1_val': 0.6741468823175332, 'auprc': 0.8482801151761883, 'loss_val': 0.42142270467960585, 'psi': 0.7438001754609952}-{'f1_val': 0.4162071813975062, 'auprc': 0.7773230447879218, 'loss_val': 1.080489715253356, 'psi': 0.5606535267536724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=42 head_norm_before_train=2.069705 (no previous merge yet)
[S8] round=42 local utility u=0.004523 metrics={'f1_val': 0.9943444494641033, 'auprc': 0.9993418265725301, 'loss_val': 0.027081478957237372, 'psi': 0.996343400307474}-{'f1_val': 0.9932547113812498, 'auprc': 0.999407412735609, 'loss_val': 0.029785754838344173, 'psi': 0.9957157919229934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=42 head_norm_before_train=2.114661 (no previous merge yet)
[S9] round=42 local utility u=0.000654 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998781825922509, 'loss_val': 0.019177603719030822, 'psi': 0.9975090374573384}-{'f1_val': 0.9966605118138915, 'auprc': 0.9985904668276542, 'loss_val': 0.01991230561636519, 'psi': 0.9974324938193966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=42 head_norm_before_train=1.858462 cos_to_last_merge=0.7608 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.761
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9939390619519779, 'loss_val': 0.035055623654889796, 'psi': 0.9936102349816858}-{'f1_val': 0.9935262985458464, 'auprc': 0.9936250601186519, 'loss_val': 0.03482633323048761, 'psi': 0.9935658031749686}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.809565 cos_to_last_merge=0.9934 (last merge round=26)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9963708265062403, 'loss_val': 0.027013905046542212, 'psi': 0.9963314310838127}-{'f1_val': 0.9965470045135896, 'auprc': 0.9961852557098609, 'loss_val': 0.02624952437443836, 'psi': 0.9964023049920981}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.966517 cos_to_last_merge=0.9862 (last merge round=22)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.5071943133328946, 'auprc': 0.7257232642832392, 'loss_val': 1.2709273609548748, 'psi': 0.5946058937130324}-{'f1_val': 0.5841915924931484, 'auprc': 0.7064151580936812, 'loss_val': 0.8701121750157887, 'psi': 0.6330810187333615}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.920735 cos_to_last_merge=0.8255 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.825
[S14] round=42 local utility u=0.047767 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9971022696391242, 'loss_val': 0.02453070930810451, 'psi': 0.997053081529375}-{'f1_val': 0.9843128931005477, 'auprc': 0.9971034004510002, 'loss_val': 0.04382454509854731, 'psi': 0.9894290960407288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=42 head_norm_before_train=1.741389 cos_to_last_merge=0.9829 (last merge round=26)
[S15] round=42 local utility u=0.858535 metrics={'f1_val': 0.8241014808104759, 'auprc': 0.9790039184520105, 'loss_val': 0.32157211995445384, 'psi': 0.8860624558670898}-{'f1_val': 0.6979363109643824, 'auprc': 0.7573387209565685, 'loss_val': 0.6166554838335894, 'psi': 0.7216972749612568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=42 head_norm_before_train=1.482007 cos_to_last_merge=0.9517 (last merge round=25)
[S16] round=42 local utility u=0.240099 metrics={'f1_val': 0.9902575183498594, 'auprc': 0.9874075948266414, 'loss_val': 0.05852185356278097, 'psi': 0.9891175489405722}-{'f1_val': 0.9393208330050393, 'auprc': 0.9873959038347557, 'loss_val': 0.23306526521845622, 'psi': 0.9585508613369259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=42 head_norm_before_train=1.970871 cos_to_last_merge=0.9945 (last merge round=26)
[S17] round=42 local utility u=0.070076 metrics={'f1_val': 0.6428538295075371, 'auprc': 0.8741791450915269, 'loss_val': 0.8580943824128787, 'psi': 0.735383955741133}-{'f1_val': 0.6476174011541663, 'auprc': 0.8703107466432665, 'loss_val': 1.0152222201381076, 'psi': 0.7366947393498064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=43 head_norm_before_train=1.813646 cos_to_last_merge=0.9761 (last merge round=22)
[S2] round=43 local utility u=0.200484 metrics={'f1_val': 0.7155791213909859, 'auprc': 0.862365327410337, 'loss_val': 0.44379670204340993, 'psi': 0.7742936037987264}-{'f1_val': 0.7210802063850564, 'auprc': 0.7986985868737768, 'loss_val': 0.6867717695147847, 'psi': 0.7521275585805446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=43 head_norm_before_train=2.193471 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9665090377412817, 'auprc': 0.9985117559862418, 'loss_val': 0.0948950370887336, 'psi': 0.9793101250392657}-{'f1_val': 0.9945116724085847, 'auprc': 0.9986668152876323, 'loss_val': 0.032545579321348606, 'psi': 0.9961737295602038}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.495826 cos_to_last_merge=0.9864 (last merge round=25)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9416461526292657, 'auprc': 0.972448874029987, 'loss_val': 0.26728912287469403, 'psi': 0.9539672411895541}-{'f1_val': 0.9492052007972822, 'auprc': 0.9680118898488975, 'loss_val': 0.25559741383452367, 'psi': 0.9567278764179283}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.613419 cos_to_last_merge=0.7847 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=43 local utility u=0.871638 metrics={'f1_val': 0.9964804002465358, 'auprc': 0.9969633231318624, 'loss_val': 0.08315009740702008, 'psi': 0.9966735694006665}-{'f1_val': 0.7315480043292901, 'auprc': 0.9910039313916932, 'loss_val': 0.21895440740193495, 'psi': 0.8353303751542513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=43 head_norm_before_train=1.426579 cos_to_last_merge=0.9380 (last merge round=22)
[S6] ⚠️ Model drifted since last merge! cos=0.938
[S6] round=43 local utility u=1.000000 metrics={'f1_val': 0.8356862597241768, 'auprc': 0.968078818605302, 'loss_val': 0.30669053565023424, 'psi': 0.8886432832766269}-{'f1_val': 0.6166077976626417, 'auprc': 0.7881430422109597, 'loss_val': 0.8260211347798223, 'psi': 0.6852218954819689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=43 head_norm_before_train=1.218428 cos_to_last_merge=0.9579 (last merge round=25)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.6086511561765026, 'auprc': 0.7890700020825241, 'loss_val': 0.6703873499088164, 'psi': 0.6808186945389112}-{'f1_val': 0.6741468823175332, 'auprc': 0.8482801151761883, 'loss_val': 0.42142270467960585, 'psi': 0.7438001754609952}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=2.075151 (no previous merge yet)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9936117456418484, 'auprc': 0.9993965071248088, 'loss_val': 0.027400357174801927, 'psi': 0.9959256502350327}-{'f1_val': 0.9943444494641033, 'auprc': 0.9993418265725301, 'loss_val': 0.027081478957237372, 'psi': 0.996343400307474}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=2.121297 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9908021981609972, 'auprc': 0.9987921241342023, 'loss_val': 0.029925582536784994, 'psi': 0.9939981685502792}-{'f1_val': 0.9966605118138915, 'auprc': 0.998781825922509, 'loss_val': 0.019177603719030822, 'psi': 0.9975090374573384}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.869576 cos_to_last_merge=0.7600 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.760
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9947650385979493, 'loss_val': 0.037172686852227736, 'psi': 0.9938904406717226}-{'f1_val': 0.993391017001491, 'auprc': 0.9939390619519779, 'loss_val': 0.035055623654889796, 'psi': 0.9936102349816858}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.817257 cos_to_last_merge=0.9930 (last merge round=26)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9965636011024065, 'loss_val': 0.02767722303833145, 'psi': 0.9964085409222792}-{'f1_val': 0.996305167468861, 'auprc': 0.9963708265062403, 'loss_val': 0.027013905046542212, 'psi': 0.9963314310838127}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.972415 cos_to_last_merge=0.9857 (last merge round=22)
[S13] round=43 local utility u=0.273537 metrics={'f1_val': 0.5771654825867492, 'auprc': 0.6823370007344381, 'loss_val': 1.0135224674524894, 'psi': 0.6192340898458247}-{'f1_val': 0.5071943133328946, 'auprc': 0.7257232642832392, 'loss_val': 1.2709273609548748, 'psi': 0.5946058937130324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=43 head_norm_before_train=1.929419 cos_to_last_merge=0.8245 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.824
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9970233560109115, 'auprc': 0.9949758778752278, 'loss_val': 0.026306911548297163, 'psi': 0.9962043647566381}-{'f1_val': 0.9970202894562089, 'auprc': 0.9971022696391242, 'loss_val': 0.02453070930810451, 'psi': 0.997053081529375}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.753273 cos_to_last_merge=0.9821 (last merge round=26)
[S15] round=43 local utility u=0.051132 metrics={'f1_val': 0.8323514463051491, 'auprc': 0.9896707562256734, 'loss_val': 0.30080869076676975, 'psi': 0.8952791702733589}-{'f1_val': 0.8241014808104759, 'auprc': 0.9790039184520105, 'loss_val': 0.32157211995445384, 'psi': 0.8860624558670898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=43 head_norm_before_train=1.496314 cos_to_last_merge=0.9502 (last merge round=25)
[S16] round=43 local utility u=0.013365 metrics={'f1_val': 0.9913173870435368, 'auprc': 0.9928309437040093, 'loss_val': 0.05442078366284508, 'psi': 0.9919228097077257}-{'f1_val': 0.9902575183498594, 'auprc': 0.9874075948266414, 'loss_val': 0.05852185356278097, 'psi': 0.9891175489405722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=43 head_norm_before_train=1.980532 cos_to_last_merge=0.9940 (last merge round=26)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6448689334344556, 'auprc': 0.8768863632382151, 'loss_val': 1.0897486697145031, 'psi': 0.7376759053559594}-{'f1_val': 0.6428538295075371, 'auprc': 0.8741791450915269, 'loss_val': 0.8580943824128787, 'psi': 0.735383955741133}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.818031 cos_to_last_merge=0.9757 (last merge round=22)
[S2] round=44 local utility u=0.113899 metrics={'f1_val': 0.7107465123346921, 'auprc': 0.9693743795987422, 'loss_val': 0.5080298609462789, 'psi': 0.8141976592403122}-{'f1_val': 0.7155791213909859, 'auprc': 0.862365327410337, 'loss_val': 0.44379670204340993, 'psi': 0.7742936037987264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=44 head_norm_before_train=2.201324 (no previous merge yet)
[S3] round=44 local utility u=0.099411 metrics={'f1_val': 0.993502203286029, 'auprc': 0.9983416884370437, 'loss_val': 0.05752184935856917, 'psi': 0.9954379973464349}-{'f1_val': 0.9665090377412817, 'auprc': 0.9985117559862418, 'loss_val': 0.0948950370887336, 'psi': 0.9793101250392657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=44 head_norm_before_train=1.501790 cos_to_last_merge=0.9858 (last merge round=25)
[S4] round=44 local utility u=0.031755 metrics={'f1_val': 0.9497335878573389, 'auprc': 0.9737822097986772, 'loss_val': 0.2563039866478116, 'psi': 0.9593530366338742}-{'f1_val': 0.9416461526292657, 'auprc': 0.972448874029987, 'loss_val': 0.26728912287469403, 'psi': 0.9539672411895541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=44 head_norm_before_train=1.621286 cos_to_last_merge=0.7843 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.784
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.7143712450552575, 'auprc': 0.798967544531208, 'loss_val': 0.44286532675024864, 'psi': 0.7482097648456377}-{'f1_val': 0.9964804002465358, 'auprc': 0.9969633231318624, 'loss_val': 0.08315009740702008, 'psi': 0.9966735694006665}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.437519 cos_to_last_merge=0.9359 (last merge round=22)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.8220049287210509, 'auprc': 0.8160579477515711, 'loss_val': 0.47505397051341564, 'psi': 0.819626136333259}-{'f1_val': 0.8356862597241768, 'auprc': 0.968078818605302, 'loss_val': 0.30669053565023424, 'psi': 0.8886432832766269}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.227428 cos_to_last_merge=0.9563 (last merge round=25)
[S7] round=44 local utility u=0.429468 metrics={'f1_val': 0.6783695772370323, 'auprc': 0.8468992708569133, 'loss_val': 0.4032491926050788, 'psi': 0.7457814546849848}-{'f1_val': 0.6086511561765026, 'auprc': 0.7890700020825241, 'loss_val': 0.6703873499088164, 'psi': 0.6808186945389112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=44 head_norm_before_train=2.083261 (no previous merge yet)
[S8] round=44 local utility u=0.003002 metrics={'f1_val': 0.9945328110990921, 'auprc': 0.9993188184154422, 'loss_val': 0.02668981421602926, 'psi': 0.9964472140256321}-{'f1_val': 0.9936117456418484, 'auprc': 0.9993965071248088, 'loss_val': 0.027400357174801927, 'psi': 0.9959256502350327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=44 head_norm_before_train=2.127347 (no previous merge yet)
[S9] round=44 local utility u=0.015174 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9946615456055726, 'loss_val': 0.019873600657087726, 'psi': 0.9956146751097956}-{'f1_val': 0.9908021981609972, 'auprc': 0.9987921241342023, 'loss_val': 0.029925582536784994, 'psi': 0.9939981685502792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=44 head_norm_before_train=1.880407 cos_to_last_merge=0.7592 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.759
[S10] round=44 local utility u=0.000238 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9940458372035288, 'loss_val': 0.03504071773741796, 'psi': 0.9936529450823061}-{'f1_val': 0.9933073753875716, 'auprc': 0.9947650385979493, 'loss_val': 0.037172686852227736, 'psi': 0.9938904406717226}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=44 head_norm_before_train=1.824671 cos_to_last_merge=0.9927 (last merge round=26)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9968508035492087, 'loss_val': 0.026746572759950488, 'psi': 0.9962877036954704}-{'f1_val': 0.996305167468861, 'auprc': 0.9965636011024065, 'loss_val': 0.02767722303833145, 'psi': 0.9964085409222792}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.975685 cos_to_last_merge=0.9853 (last merge round=22)
[S13] round=44 local utility u=0.113413 metrics={'f1_val': 0.5812798308592118, 'auprc': 0.6958230077899145, 'loss_val': 0.8518403471009879, 'psi': 0.6270971016314928}-{'f1_val': 0.5771654825867492, 'auprc': 0.6823370007344381, 'loss_val': 1.0135224674524894, 'psi': 0.6192340898458247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=44 head_norm_before_train=1.939217 cos_to_last_merge=0.8236 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.824
[S14] round=44 local utility u=0.001613 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9954152963520915, 'loss_val': 0.025719934726562897, 'psi': 0.99651225559826}-{'f1_val': 0.9970233560109115, 'auprc': 0.9949758778752278, 'loss_val': 0.026306911548297163, 'psi': 0.9962043647566381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=44 head_norm_before_train=1.764156 cos_to_last_merge=0.9813 (last merge round=26)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7707622770548006, 'auprc': 0.9094088382653931, 'loss_val': 0.4563244663441222, 'psi': 0.8262209015390376}-{'f1_val': 0.8323514463051491, 'auprc': 0.9896707562256734, 'loss_val': 0.30080869076676975, 'psi': 0.8952791702733589}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.509919 cos_to_last_merge=0.9489 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.949
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9871791480474214, 'auprc': 0.9892572452509664, 'loss_val': 0.07204438243442181, 'psi': 0.9880103869288392}-{'f1_val': 0.9913173870435368, 'auprc': 0.9928309437040093, 'loss_val': 0.05442078366284508, 'psi': 0.9919228097077257}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.992457 cos_to_last_merge=0.9934 (last merge round=26)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6550830735674309, 'auprc': 0.8573012684467741, 'loss_val': 1.107245337780429, 'psi': 0.7359703515191682}-{'f1_val': 0.6448689334344556, 'auprc': 0.8768863632382151, 'loss_val': 1.0897486697145031, 'psi': 0.7376759053559594}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.823489 cos_to_last_merge=0.9752 (last merge round=22)
[S2] round=45 local utility u=0.062857 metrics={'f1_val': 0.8228893708039529, 'auprc': 0.7695915430387936, 'loss_val': 0.45582359413992063, 'psi': 0.8015702396978892}-{'f1_val': 0.7107465123346921, 'auprc': 0.9693743795987422, 'loss_val': 0.5080298609462789, 'psi': 0.8141976592403122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=45 head_norm_before_train=2.209723 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.8876432871216112, 'auprc': 0.9985439134343773, 'loss_val': 0.17786143779697255, 'psi': 0.9320035376467176}-{'f1_val': 0.993502203286029, 'auprc': 0.9983416884370437, 'loss_val': 0.05752184935856917, 'psi': 0.9954379973464349}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.508330 cos_to_last_merge=0.9852 (last merge round=25)
[S4] round=45 local utility u=0.004809 metrics={'f1_val': 0.9500485880729157, 'auprc': 0.9764496775372342, 'loss_val': 0.25657760613936176, 'psi': 0.9606090238586431}-{'f1_val': 0.9497335878573389, 'auprc': 0.9737822097986772, 'loss_val': 0.2563039866478116, 'psi': 0.9593530366338742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=45 head_norm_before_train=1.628651 cos_to_last_merge=0.7837 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.784
[S5] round=45 local utility u=1.000000 metrics={'f1_val': 0.9873301872611668, 'auprc': 0.9972060058607378, 'loss_val': 0.10303564273239384, 'psi': 0.9912805147009952}-{'f1_val': 0.7143712450552575, 'auprc': 0.798967544531208, 'loss_val': 0.44286532675024864, 'psi': 0.7482097648456377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=45 head_norm_before_train=1.449144 cos_to_last_merge=0.9340 (last merge round=22)
[S6] ⚠️ Model drifted since last merge! cos=0.934
[S6] round=45 local utility u=0.203232 metrics={'f1_val': 0.8224591835301552, 'auprc': 0.9429002103270371, 'loss_val': 0.45184221792681895, 'psi': 0.8706355942489079}-{'f1_val': 0.8220049287210509, 'auprc': 0.8160579477515711, 'loss_val': 0.47505397051341564, 'psi': 0.819626136333259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=45 head_norm_before_train=1.235853 cos_to_last_merge=0.9551 (last merge round=25)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5631512971391652, 'auprc': 0.7825290039503281, 'loss_val': 0.7120610863831127, 'psi': 0.6509023798636304}-{'f1_val': 0.6783695772370323, 'auprc': 0.8468992708569133, 'loss_val': 0.4032491926050788, 'psi': 0.7457814546849848}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=2.091325 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9945328110990921, 'auprc': 0.9992474821385694, 'loss_val': 0.026841339298400563, 'psi': 0.9964186795148829}-{'f1_val': 0.9945328110990921, 'auprc': 0.9993188184154422, 'loss_val': 0.02668981421602926, 'psi': 0.9964472140256321}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=2.134830 (no previous merge yet)
[S9] round=45 local utility u=0.007581 metrics={'f1_val': 0.9962748907591257, 'auprc': 0.9991621961837427, 'loss_val': 0.01836227495014436, 'psi': 0.9974298129289725}-{'f1_val': 0.9962500947792776, 'auprc': 0.9946615456055726, 'loss_val': 0.019873600657087726, 'psi': 0.9956146751097956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=45 head_norm_before_train=1.887018 cos_to_last_merge=0.7590 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.759
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9935334510164715, 'loss_val': 0.034334400225158275, 'psi': 0.9934479906074831}-{'f1_val': 0.993391017001491, 'auprc': 0.9940458372035288, 'loss_val': 0.03504071773741796, 'psi': 0.9936529450823061}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.829444 cos_to_last_merge=0.9923 (last merge round=26)
[S11] round=45 local utility u=0.001640 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.997006841966892, 'loss_val': 0.025385695515584623, 'psi': 0.996495221633204}-{'f1_val': 0.9959123037929781, 'auprc': 0.9968508035492087, 'loss_val': 0.026746572759950488, 'psi': 0.9962877036954704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=45 head_norm_before_train=1.978998 cos_to_last_merge=0.9850 (last merge round=22)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.533199841294943, 'auprc': 0.7189352348060469, 'loss_val': 1.1596656602896394, 'psi': 0.6074939986993846}-{'f1_val': 0.5812798308592118, 'auprc': 0.6958230077899145, 'loss_val': 0.8518403471009879, 'psi': 0.6270971016314928}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.948729 cos_to_last_merge=0.8229 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.823
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9962409110286163, 'loss_val': 0.027829801620918103, 'psi': 0.9966967923399932}-{'f1_val': 0.9972435617623723, 'auprc': 0.9954152963520915, 'loss_val': 0.025719934726562897, 'psi': 0.99651225559826}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.775517 cos_to_last_merge=0.9805 (last merge round=26)
[S15] round=45 local utility u=0.603369 metrics={'f1_val': 0.8960232807792028, 'auprc': 0.9742734284567605, 'loss_val': 0.1957463123252409, 'psi': 0.9273233398502259}-{'f1_val': 0.7707622770548006, 'auprc': 0.9094088382653931, 'loss_val': 0.4563244663441222, 'psi': 0.8262209015390376}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[S16] START round=45 head_norm_before_train=1.522513 cos_to_last_merge=0.9477 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=45 local utility u=0.015307 metrics={'f1_val': 0.9904563423906121, 'auprc': 0.9895075720654418, 'loss_val': 0.06184486780528727, 'psi': 0.9900768342605439}-{'f1_val': 0.9871791480474214, 'auprc': 0.9892572452509664, 'loss_val': 0.07204438243442181, 'psi': 0.9880103869288392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=45 head_norm_before_train=2.005625 cos_to_last_merge=0.9929 (last merge round=26)
[S17] round=45 local utility u=0.180952 metrics={'f1_val': 0.6595281945326875, 'auprc': 0.8979584965590647, 'loss_val': 0.8939842468047335, 'psi': 0.7549003153432384}-{'f1_val': 0.6550830735674309, 'auprc': 0.8573012684467741, 'loss_val': 1.107245337780429, 'psi': 0.7359703515191682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=46 head_norm_before_train=1.828710 cos_to_last_merge=0.9747 (last merge round=22)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.7070688717758012, 'auprc': 0.983437273608087, 'loss_val': 0.46469519823154576, 'psi': 0.8176162325087155}-{'f1_val': 0.8228893708039529, 'auprc': 0.7695915430387936, 'loss_val': 0.45582359413992063, 'psi': 0.8015702396978892}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.218653 (no previous merge yet)
[S3] round=46 local utility u=0.244900 metrics={'f1_val': 0.9577925061708572, 'auprc': 0.998572568702019, 'loss_val': 0.10904253501698383, 'psi': 0.974104531183322}-{'f1_val': 0.8876432871216112, 'auprc': 0.9985439134343773, 'loss_val': 0.17786143779697255, 'psi': 0.9320035376467176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] sending update (kind=head size=1791 to 1 peers)
[S4] START round=46 head_norm_before_train=1.512790 cos_to_last_merge=0.9844 (last merge round=25)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9422464025681662, 'auprc': 0.9797290358945444, 'loss_val': 0.26725906201064353, 'psi': 0.9572394558987174}-{'f1_val': 0.9500485880729157, 'auprc': 0.9764496775372342, 'loss_val': 0.25657760613936176, 'psi': 0.9606090238586431}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.634774 cos_to_last_merge=0.7833 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.783
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.9864074834931685, 'auprc': 0.9910119950354113, 'loss_val': 0.11415069300131074, 'psi': 0.9882492881100656}-{'f1_val': 0.9873301872611668, 'auprc': 0.9972060058607378, 'loss_val': 0.10303564273239384, 'psi': 0.9912805147009952}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.459722 cos_to_last_merge=0.9323 (last merge round=22)
[S6] ⚠️ Model drifted since last merge! cos=0.932
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7084373482626962, 'auprc': 0.8905619387351758, 'loss_val': 0.6995630214316652, 'psi': 0.781287184451688}-{'f1_val': 0.8224591835301552, 'auprc': 0.9429002103270371, 'loss_val': 0.45184221792681895, 'psi': 0.8706355942489079}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.242509 cos_to_last_merge=0.9541 (last merge round=25)
[S7] round=46 local utility u=0.517449 metrics={'f1_val': 0.6663970214208598, 'auprc': 0.8288790634181495, 'loss_val': 0.43568664466216583, 'psi': 0.7313898382197757}-{'f1_val': 0.5631512971391652, 'auprc': 0.7825290039503281, 'loss_val': 0.7120610863831127, 'psi': 0.6509023798636304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=46 head_norm_before_train=2.099283 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9943444494641033, 'auprc': 0.9993512391516001, 'loss_val': 0.026211227984751628, 'psi': 0.9963471653391021}-{'f1_val': 0.9945328110990921, 'auprc': 0.9992474821385694, 'loss_val': 0.026841339298400563, 'psi': 0.9964186795148829}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=2.139883 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9895530216146718, 'auprc': 0.9991649756104581, 'loss_val': 0.03952863215928019, 'psi': 0.9933978032129863}-{'f1_val': 0.9962748907591257, 'auprc': 0.9991621961837427, 'loss_val': 0.01836227495014436, 'psi': 0.9974298129289725}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.895182 cos_to_last_merge=0.7585 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.758
[S10] round=46 local utility u=0.000140 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9938938852478827, 'loss_val': 0.03513620933979471, 'psi': 0.9935921643000476}-{'f1_val': 0.993391017001491, 'auprc': 0.9935334510164715, 'loss_val': 0.034334400225158275, 'psi': 0.9934479906074831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=46 head_norm_before_train=1.837774 cos_to_last_merge=0.9918 (last merge round=26)
[S11] round=46 local utility u=0.001655 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9968753068449907, 'loss_val': 0.024160649520282136, 'psi': 0.9966906051217246}-{'f1_val': 0.9961541414107454, 'auprc': 0.997006841966892, 'loss_val': 0.025385695515584623, 'psi': 0.996495221633204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=46 head_norm_before_train=1.984151 cos_to_last_merge=0.9846 (last merge round=22)
[S13] round=46 local utility u=0.047261 metrics={'f1_val': 0.5516587179922072, 'auprc': 0.7191975524836148, 'loss_val': 1.1766843898490678, 'psi': 0.6186742517887702}-{'f1_val': 0.533199841294943, 'auprc': 0.7189352348060469, 'loss_val': 1.1596656602896394, 'psi': 0.6074939986993846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=46 head_norm_before_train=1.956846 cos_to_last_merge=0.8223 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.822
[S14] round=46 local utility u=0.000176 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9963747691676337, 'loss_val': 0.026557471390659105, 'psi': 0.9966182121713367}-{'f1_val': 0.9970007132142444, 'auprc': 0.9962409110286163, 'loss_val': 0.027829801620918103, 'psi': 0.9966967923399932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=46 head_norm_before_train=1.787036 cos_to_last_merge=0.9799 (last merge round=26)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.8105337082072422, 'auprc': 0.9462573316645351, 'loss_val': 0.37376045523791773, 'psi': 0.8648231575901594}-{'f1_val': 0.8960232807792028, 'auprc': 0.9742734284567605, 'loss_val': 0.1957463123252409, 'psi': 0.9273233398502259}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.535633 cos_to_last_merge=0.9463 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.946
[S16] round=46 local utility u=0.018109 metrics={'f1_val': 0.9917185143369844, 'auprc': 0.9954503136224984, 'loss_val': 0.05102881614033861, 'psi': 0.99321123405119}-{'f1_val': 0.9904563423906121, 'auprc': 0.9895075720654418, 'loss_val': 0.06184486780528727, 'psi': 0.9900768342605439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=46 head_norm_before_train=2.020720 cos_to_last_merge=0.9921 (last merge round=26)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6322322656886007, 'auprc': 0.8734530753232529, 'loss_val': 1.1735928245408926, 'psi': 0.7287205895424615}-{'f1_val': 0.6595281945326875, 'auprc': 0.8979584965590647, 'loss_val': 0.8939842468047335, 'psi': 0.7549003153432384}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.833872 cos_to_last_merge=0.9742 (last merge round=22)
[S2] round=47 local utility u=0.130224 metrics={'f1_val': 0.7382714619980139, 'auprc': 0.9817343737754913, 'loss_val': 0.38635453931149544, 'psi': 0.8356566267090049}-{'f1_val': 0.7070688717758012, 'auprc': 0.983437273608087, 'loss_val': 0.46469519823154576, 'psi': 0.8176162325087155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=47 head_norm_before_train=2.227310 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9580353631527218, 'auprc': 0.9984482852529266, 'loss_val': 0.1646559995317488, 'psi': 0.9742005319928037}-{'f1_val': 0.9577925061708572, 'auprc': 0.998572568702019, 'loss_val': 0.10904253501698383, 'psi': 0.974104531183322}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.518785 cos_to_last_merge=0.9832 (last merge round=25)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9397065612364892, 'auprc': 0.9479127049944949, 'loss_val': 0.2872672084630359, 'psi': 0.9429890187396914}-{'f1_val': 0.9422464025681662, 'auprc': 0.9797290358945444, 'loss_val': 0.26725906201064353, 'psi': 0.9572394558987174}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.641126 cos_to_last_merge=0.7826 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.783
[S5] round=47 local utility u=0.041477 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9916314875851759, 'loss_val': 0.09172655662159371, 'psi': 0.9943642090196569}-{'f1_val': 0.9864074834931685, 'auprc': 0.9910119950354113, 'loss_val': 0.11415069300131074, 'psi': 0.9882492881100656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=47 head_norm_before_train=1.470171 cos_to_last_merge=0.9310 (last merge round=22)
[S6] ⚠️ Model drifted since last merge! cos=0.931
[S6] round=47 local utility u=0.415171 metrics={'f1_val': 0.8016541118225566, 'auprc': 0.9293250441918625, 'loss_val': 0.5448113529826075, 'psi': 0.852722484770279}-{'f1_val': 0.7084373482626962, 'auprc': 0.8905619387351758, 'loss_val': 0.6995630214316652, 'psi': 0.781287184451688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=47 head_norm_before_train=1.252916 cos_to_last_merge=0.9523 (last merge round=25)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5893122310520845, 'auprc': 0.7874875049750073, 'loss_val': 0.7021650552421389, 'psi': 0.6685823406212537}-{'f1_val': 0.6663970214208598, 'auprc': 0.8288790634181495, 'loss_val': 0.43568664466216583, 'psi': 0.7313898382197757}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.106260 (no previous merge yet)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9893617146242781, 'auprc': 0.9992511055396742, 'loss_val': 0.03697960107030673, 'psi': 0.9933174709904367}-{'f1_val': 0.9943444494641033, 'auprc': 0.9993512391516001, 'loss_val': 0.026211227984751628, 'psi': 0.9963471653391021}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=2.146673 (no previous merge yet)
[S9] round=47 local utility u=0.033125 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988971118355479, 'loss_val': 0.017773751434214505, 'psi': 0.9978205922415049}-{'f1_val': 0.9895530216146718, 'auprc': 0.9991649756104581, 'loss_val': 0.03952863215928019, 'psi': 0.9933978032129863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=47 head_norm_before_train=1.904079 cos_to_last_merge=0.7578 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.758
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9938990420465713, 'loss_val': 0.0352013677158107, 'psi': 0.993594227019523}-{'f1_val': 0.993391017001491, 'auprc': 0.9938938852478827, 'loss_val': 0.03513620933979471, 'psi': 0.9935921643000476}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.847737 cos_to_last_merge=0.9912 (last merge round=26)
[S11] round=47 local utility u=0.000015 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9966783599478034, 'loss_val': 0.023539668163655846, 'psi': 0.9966118263628496}-{'f1_val': 0.996567470639547, 'auprc': 0.9968753068449907, 'loss_val': 0.024160649520282136, 'psi': 0.9966906051217246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=47 head_norm_before_train=1.989057 cos_to_last_merge=0.9840 (last merge round=22)
[S13] round=47 local utility u=0.102575 metrics={'f1_val': 0.5679154193904667, 'auprc': 0.6952734795170648, 'loss_val': 0.9973024705474037, 'psi': 0.618858643441106}-{'f1_val': 0.5516587179922072, 'auprc': 0.7191975524836148, 'loss_val': 1.1766843898490678, 'psi': 0.6186742517887702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=47 head_norm_before_train=1.965346 cos_to_last_merge=0.8216 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.822
[S14] round=47 local utility u=0.003555 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9971027992422372, 'loss_val': 0.024078189959472942, 'psi': 0.9971540408990089}-{'f1_val': 0.9967805075071389, 'auprc': 0.9963747691676337, 'loss_val': 0.026557471390659105, 'psi': 0.9966182121713367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=47 head_norm_before_train=1.797202 cos_to_last_merge=0.9792 (last merge round=26)
[S15] round=47 local utility u=0.792953 metrics={'f1_val': 0.9957565275399207, 'auprc': 0.989641079079075, 'loss_val': 0.029342502065084593, 'psi': 0.9933103481555824}-{'f1_val': 0.8105337082072422, 'auprc': 0.9462573316645351, 'loss_val': 0.37376045523791773, 'psi': 0.8648231575901594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=47 head_norm_before_train=1.547776 cos_to_last_merge=0.9450 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.945
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9389155679624623, 'auprc': 0.9882612903564968, 'loss_val': 0.31095631450357525, 'psi': 0.9586538569200761}-{'f1_val': 0.9917185143369844, 'auprc': 0.9954503136224984, 'loss_val': 0.05102881614033861, 'psi': 0.99321123405119}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=2.034089 cos_to_last_merge=0.9915 (last merge round=26)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6336102572901297, 'auprc': 0.8376842023783936, 'loss_val': 1.1848309637228247, 'psi': 0.7152398353254352}-{'f1_val': 0.6322322656886007, 'auprc': 0.8734530753232529, 'loss_val': 1.1735928245408926, 'psi': 0.7287205895424615}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.840597 cos_to_last_merge=0.9735 (last merge round=22)
[S2] round=48 local utility u=0.082767 metrics={'f1_val': 0.8173565722758407, 'auprc': 0.8767302461648844, 'loss_val': 0.38031855059797176, 'psi': 0.8411060418314582}-{'f1_val': 0.7382714619980139, 'auprc': 0.9817343737754913, 'loss_val': 0.38635453931149544, 'psi': 0.8356566267090049}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=48 head_norm_before_train=2.235145 (no previous merge yet)
[S3] round=48 local utility u=0.179028 metrics={'f1_val': 0.9970861769288293, 'auprc': 0.9989878242269137, 'loss_val': 0.0425239564271271, 'psi': 0.997846835848063}-{'f1_val': 0.9580353631527218, 'auprc': 0.9984482852529266, 'loss_val': 0.1646559995317488, 'psi': 0.9742005319928037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=48 head_norm_before_train=1.529532 cos_to_last_merge=0.9820 (last merge round=25)
[S4] round=48 local utility u=0.073592 metrics={'f1_val': 0.9423317908875195, 'auprc': 0.9847235341079805, 'loss_val': 0.2662678030507306, 'psi': 0.959288488175704}-{'f1_val': 0.9397065612364892, 'auprc': 0.9479127049944949, 'loss_val': 0.2872672084630359, 'psi': 0.9429890187396914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=48 head_norm_before_train=1.644964 cos_to_last_merge=0.7823 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.782
[S5] round=48 local utility u=0.018122 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9943382495048907, 'loss_val': 0.06360331067370988, 'psi': 0.9954469137875429}-{'f1_val': 0.996186023309311, 'auprc': 0.9916314875851759, 'loss_val': 0.09172655662159371, 'psi': 0.9943642090196569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] START round=48 head_norm_before_train=1.487107 cos_to_last_merge=0.9301 (last merge round=22)
[S6] ⚠️ Model drifted since last merge! cos=0.930
[S6] round=48 local utility u=0.541135 metrics={'f1_val': 0.9248930321043409, 'auprc': 0.9413414725934652, 'loss_val': 0.2380245520581997, 'psi': 0.9314724082999906}-{'f1_val': 0.8016541118225566, 'auprc': 0.9293250441918625, 'loss_val': 0.5448113529826075, 'psi': 0.852722484770279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=48 head_norm_before_train=1.260194 cos_to_last_merge=0.9510 (last merge round=25)
[S7] round=48 local utility u=0.358053 metrics={'f1_val': 0.6551039181122227, 'auprc': 0.8201691132083755, 'loss_val': 0.47885367012554614, 'psi': 0.7211299961506838}-{'f1_val': 0.5893122310520845, 'auprc': 0.7874875049750073, 'loss_val': 0.7021650552421389, 'psi': 0.6685823406212537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=48 head_norm_before_train=2.111000 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9890031703058726, 'auprc': 0.9992504729541742, 'loss_val': 0.03707553187343679, 'psi': 0.9931020913651932}-{'f1_val': 0.9893617146242781, 'auprc': 0.9992511055396742, 'loss_val': 0.03697960107030673, 'psi': 0.9933174709904367}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=2.153324 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988522816217176, 'loss_val': 0.017716335575805698, 'psi': 0.9978026601559727}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988971118355479, 'loss_val': 0.017773751434214505, 'psi': 0.9978205922415049}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.913120 cos_to_last_merge=0.7572 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.757
[S10] round=48 local utility u=0.000107 metrics={'f1_val': 0.993391017001491, 'auprc': 0.993847249099747, 'loss_val': 0.034831307388467105, 'psi': 0.9935735098407934}-{'f1_val': 0.993391017001491, 'auprc': 0.9938990420465713, 'loss_val': 0.0352013677158107, 'psi': 0.993594227019523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=48 head_norm_before_train=1.858363 cos_to_last_merge=0.9905 (last merge round=26)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9969912972128219, 'loss_val': 0.025103605483174914, 'psi': 0.9963439011609156}-{'f1_val': 0.996567470639547, 'auprc': 0.9966783599478034, 'loss_val': 0.023539668163655846, 'psi': 0.9966118263628496}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.993095 cos_to_last_merge=0.9835 (last merge round=22)
[S13] round=48 local utility u=0.040133 metrics={'f1_val': 0.5730879982947784, 'auprc': 0.7096520043507523, 'loss_val': 0.9912065709922501, 'psi': 0.627713600717168}-{'f1_val': 0.5679154193904667, 'auprc': 0.6952734795170648, 'loss_val': 0.9973024705474037, 'psi': 0.618858643441106}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=48 head_norm_before_train=1.973059 cos_to_last_merge=0.8211 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.821
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9591989392924253, 'auprc': 0.9971051664500334, 'loss_val': 0.05951520028805582, 'psi': 0.9743614301554686}-{'f1_val': 0.9971882020035234, 'auprc': 0.9971027992422372, 'loss_val': 0.024078189959472942, 'psi': 0.9971540408990089}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.805553 cos_to_last_merge=0.9787 (last merge round=26)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.779313995767309, 'auprc': 0.9515955835252654, 'loss_val': 0.4201617220520754, 'psi': 0.8482266308704915}-{'f1_val': 0.9957565275399207, 'auprc': 0.989641079079075, 'loss_val': 0.029342502065084593, 'psi': 0.9933103481555824}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.557857 cos_to_last_merge=0.9441 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.944
[S16] round=48 local utility u=0.265609 metrics={'f1_val': 0.9870539340565324, 'auprc': 0.984684963362727, 'loss_val': 0.05783940491699544, 'psi': 0.9861063457790102}-{'f1_val': 0.9389155679624623, 'auprc': 0.9882612903564968, 'loss_val': 0.31095631450357525, 'psi': 0.9586538569200761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=48 head_norm_before_train=2.045851 cos_to_last_merge=0.9909 (last merge round=26)
[S17] round=48 local utility u=0.157446 metrics={'f1_val': 0.6469240289126924, 'auprc': 0.8580301876177883, 'loss_val': 1.010859436622745, 'psi': 0.7313664923947307}-{'f1_val': 0.6336102572901297, 'auprc': 0.8376842023783936, 'loss_val': 1.1848309637228247, 'psi': 0.7152398353254352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=49 head_norm_before_train=1.848408 cos_to_last_merge=0.9730 (last merge round=22)
[S2] round=49 local utility u=0.024434 metrics={'f1_val': 0.7911956069041498, 'auprc': 0.947319325332913, 'loss_val': 0.38625162536843166, 'psi': 0.853645094275655}-{'f1_val': 0.8173565722758407, 'auprc': 0.8767302461648844, 'loss_val': 0.38031855059797176, 'psi': 0.8411060418314582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=49 head_norm_before_train=2.243169 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9964219183221354, 'auprc': 0.9983965753664895, 'loss_val': 0.03816265586542761, 'psi': 0.9972117811398771}-{'f1_val': 0.9970861769288293, 'auprc': 0.9989878242269137, 'loss_val': 0.0425239564271271, 'psi': 0.997846835848063}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.538699 cos_to_last_merge=0.9809 (last merge round=25)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.940578757814814, 'auprc': 0.9752787133409777, 'loss_val': 0.2827718786570421, 'psi': 0.9544587400252795}-{'f1_val': 0.9423317908875195, 'auprc': 0.9847235341079805, 'loss_val': 0.2662678030507306, 'psi': 0.959288488175704}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.653958 cos_to_last_merge=0.7810 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.781
[S5] round=49 local utility u=0.011226 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9974794417771491, 'loss_val': 0.05145441677586672, 'psi': 0.9967913313041539}-{'f1_val': 0.996186023309311, 'auprc': 0.9943382495048907, 'loss_val': 0.06360331067370988, 'psi': 0.9954469137875429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=49 head_norm_before_train=1.499490 cos_to_last_merge=0.9292 (last merge round=22)
[S6] ⚠️ Model drifted since last merge! cos=0.929
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.8196197471140553, 'auprc': 0.9460322136740039, 'loss_val': 0.38811936424075505, 'psi': 0.8701847337380347}-{'f1_val': 0.9248930321043409, 'auprc': 0.9413414725934652, 'loss_val': 0.2380245520581997, 'psi': 0.9314724082999906}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.269548 cos_to_last_merge=0.9492 (last merge round=25)
[S7] ⚠️ Model drifted since last merge! cos=0.949
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.647031853275525, 'auprc': 0.8063571433904616, 'loss_val': 0.516708851112571, 'psi': 0.7107619693214997}-{'f1_val': 0.6551039181122227, 'auprc': 0.8201691132083755, 'loss_val': 0.47885367012554614, 'psi': 0.7211299961506838}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=2.114494 (no previous merge yet)
[S8] round=49 local utility u=0.004929 metrics={'f1_val': 0.9900677324786353, 'auprc': 0.9992484414032161, 'loss_val': 0.03359895334167758, 'psi': 0.9937400160484677}-{'f1_val': 0.9890031703058726, 'auprc': 0.9992504729541742, 'loss_val': 0.03707553187343679, 'psi': 0.9931020913651932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=49 head_norm_before_train=2.160913 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9933536184876286, 'auprc': 0.999174513066954, 'loss_val': 0.024820012652883736, 'psi': 0.9956819763193587}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988522816217176, 'loss_val': 0.017716335575805698, 'psi': 0.9978026601559727}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.919949 cos_to_last_merge=0.7568 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.757
[S10] round=49 local utility u=0.000038 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9938376572484557, 'loss_val': 0.034725672957498795, 'psi': 0.9935696731002769}-{'f1_val': 0.993391017001491, 'auprc': 0.993847249099747, 'loss_val': 0.034831307388467105, 'psi': 0.9935735098407934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=49 head_norm_before_train=1.866066 cos_to_last_merge=0.9901 (last merge round=26)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9958811444547766, 'loss_val': 0.06583994834635516, 'psi': 0.9958998400576975}-{'f1_val': 0.9959123037929781, 'auprc': 0.9969912972128219, 'loss_val': 0.025103605483174914, 'psi': 0.9963439011609156}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.998630 cos_to_last_merge=0.9830 (last merge round=22)
[S13] round=49 local utility u=0.004441 metrics={'f1_val': 0.5706917477901672, 'auprc': 0.7177562600357146, 'loss_val': 0.9922605567830594, 'psi': 0.629517552688386}-{'f1_val': 0.5730879982947784, 'auprc': 0.7096520043507523, 'loss_val': 0.9912065709922501, 'psi': 0.627713600717168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=49 head_norm_before_train=1.979910 cos_to_last_merge=0.8204 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.820
[S14] round=49 local utility u=0.000136 metrics={'f1_val': 0.9592331134893162, 'auprc': 0.9971061682528521, 'loss_val': 0.059450881685345645, 'psi': 0.9743823353947305}-{'f1_val': 0.9591989392924253, 'auprc': 0.9971051664500334, 'loss_val': 0.05951520028805582, 'psi': 0.9743614301554686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=49 head_norm_before_train=1.813935 cos_to_last_merge=0.9783 (last merge round=26)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.752929512464371, 'auprc': 0.9179586617772737, 'loss_val': 0.49599925126069516, 'psi': 0.8189411721895321}-{'f1_val': 0.779313995767309, 'auprc': 0.9515955835252654, 'loss_val': 0.4201617220520754, 'psi': 0.8482266308704915}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.567789 cos_to_last_merge=0.9432 (last merge round=25)
[S16] ⚠️ Model drifted since last merge! cos=0.943
[S16] round=49 local utility u=0.031122 metrics={'f1_val': 0.9915011048905453, 'auprc': 0.9934923496634386, 'loss_val': 0.04870052867486804, 'psi': 0.9922976027997026}-{'f1_val': 0.9870539340565324, 'auprc': 0.984684963362727, 'loss_val': 0.05783940491699544, 'psi': 0.9861063457790102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=49 head_norm_before_train=2.055568 cos_to_last_merge=0.9904 (last merge round=26)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.630690514907316, 'auprc': 0.9006175968576999, 'loss_val': 1.1361710297355199, 'psi': 0.7386613476874696}-{'f1_val': 0.6469240289126924, 'auprc': 0.8580301876177883, 'loss_val': 1.010859436622745, 'psi': 0.7313664923947307}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
