[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:39803
[S3] → join 127.0.0.1:39802
[S4] → join 127.0.0.1:39802
[S5] → join 127.0.0.1:39802
[S6] → join 127.0.0.1:39802
[S7] → join 127.0.0.1:39802
[S8] → join 127.0.0.1:39802
[S9] → join 127.0.0.1:39802
[S10] → join 127.0.0.1:39802
[S11] → join 127.0.0.1:39802
[S13] → join 127.0.0.1:39802
[S14] → join 127.0.0.1:39802
[S15] → join 127.0.0.1:39802
[S16] → join 127.0.0.1:39802
[S17] → join 127.0.0.1:39802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.217690 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.158206 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.102701 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.135504 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.178873 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.181996 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.176582 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.176608 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.149180 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.203205 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.144027 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.158453 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.141605 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.154288 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.178554 (no previous merge yet)
[S17]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3] + discovered S10
[S3] + discovered S9
[S3] + discovered S17
[S3] + discovered S8
[S3] + discovered S16
[S3] + discovered S5
[S3] + discovered S14
[S3] + discovered S6
[S3] + discovered S7
[S3] + discovered S11
[S3] + discovered S15
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S4
[S3] + discovered S13
[S5] + discovered S4
[S5] + discovered S2
[S4] + discovered S10
[S5] + discovered S3
[S4] + discovered S9
[S4] + discovered S13
[S4] + discovered S16
[S4] + discovered S17
[S4] + discovered S8
[S4] + discovered S14
[S4] + discovered S5
[S4] + discovered S7
[S4] + discovered S6
[S4] + discovered S11
[S4] + discovered S15
[S5] + discovered S11
[S5] + discovered S7
[S5] + discovered S14
[S5] + discovered S16
[S5] + discovered S9
[S5] + discovered S13
[S5] + discovered S10
[S5] + discovered S15
[S5] + discovered S6
[S5] + discovered S8
[S5] + discovered S17
[S6] + discovered S5
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S2
[S7] + discovered S3
[S7] + discovered S6
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S5
[S6] + discovered S10
[S6] + discovered S8
[S6] + discovered S9
[S6] + discovered S13
[S6] + discovered S11
[S6] + discovered S14
[S6] + discovered S17
[S6] + discovered S15
[S6] + discovered S16
[S6] + discovered S7
[S7] + discovered S15
[S7] + discovered S11
[S7] + discovered S9
[S7] + discovered S8
[S7] + discovered S16
[S7] + discovered S13
[S7] + discovered S17
[S7] + discovered S14
[S7] + discovered S10
[S8] + discovered S5
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S6
[S8] + discovered S3
[S8] + discovered S2
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S5
[S9] + discovered S6
[S9] + discovered S8
[S9] + discovered S4
[S8] + discovered S14
[S8] + discovered S13
[S8] + discovered S9
[S8] + discovered S16
[S8] + discovered S17
[S8] + discovered S11
[S8] + discovered S10
[S8] + discovered S15
[S9] + discovered S2
[S9] + discovered S15
[S9] + discovered S10
[S9] + discovered S11
[S9] + discovered S17
[S9] + discovered S16
[S9] + discovered S13
[S9] + discovered S14
[S10] + discovered S8
[S10] + discovered S6
[S10] + discovered S7
[S10] + discovered S5
[S10] + discovered S2
[S10] + discovered S9
[S10] + discovered S4
[S10] + discovered S3
[S11] + discovered S3
[S11] + discovered S9
[S11] + discovered S5
[S11] + discovered S7
[S11] + discovered S8
[S11] + discovered S2
[S11] + discovered S4
[S11] + discovered S6
[S11] + discovered S10
[S10] + discovered S17
[S10] + discovered S15
[S10] + discovered S14
[S10] + discovered S13
[S10] + discovered S16
[S10] + discovered S11
[S11] + discovered S16
[S11] + discovered S13
[S11] + discovered S15
[S11] + discovered S14
[S11] + discovered S17
[S13] + discovered S8
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S5
[S13] + discovered S3
[S13] + discovered S10
[S13] + discovered S6
[S13] + discovered S11
[S13] + discovered S2
[S13] + discovered S9
[S13] + discovered S16
[S13] + discovered S17
[S13] + discovered S15
[S14] + discovered S9
[S14] + discovered S2
[S14] + discovered S6
[S14] + discovered S10
[S14] + discovered S3
[S14] + discovered S7
[S14] + discovered S11
[S14] + discovered S5
[S14] + discovered S13
[S13] + discovered S14
[S14] + discovered S4
[S14] + discovered S8
[S15] + discovered S9
[S15] + discovered S4
[S15] + discovered S5
[S15] + discovered S11
[S15] + discovered S3
[S15] + discovered S6
[S15] + discovered S2
[S15] + discovered S13
[S15] + discovered S7
[S15] + discovered S10
[S15] + discovered S8
[S15] + discovered S14
[S14] + discovered S16
[S14] + discovered S15
[S14] + discovered S17
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S10
[S16] + discovered S15
[S16] + discovered S3
[S16] + discovered S8
[S16] + discovered S14
[S16] + discovered S7
[S16] + discovered S13
[S16] + discovered S2
[S16] + discovered S11
[S16] + discovered S5
[S16] + discovered S9
[S16] + discovered S4
[S16] + discovered S6
[S16] + discovered S17
[S17] + discovered S4
[S17] + discovered S11
[S17] + discovered S16
[S17] + discovered S13
[S17] + discovered S14
[S17] + discovered S8
[S17] + discovered S3
[S17] + discovered S15
[S17] + discovered S10
[S17] + discovered S9
[S17] + discovered S5
[S17] + discovered S6
[S17] + discovered S2
[S17] + discovered S7
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:39808
[S6] ⇄ pheromone p=1.000 → S7@127.0.0.1:39808
[S11] ⇄ pheromone p=1.000 → S2@127.0.0.1:39802
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:39803
[S8] ⇄ pheromone p=1.000 → S5@127.0.0.1:39805
[S3] ⇄ pheromone p=1.000 → S14@127.0.0.1:39814
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:39811
[S9] ⇄ pheromone p=1.000 → S7@127.0.0.1:39808
[S2] ⇄ pheromone p=1.000 → S6@127.0.0.1:39807
[S10] ⇄ pheromone p=1.000 → S5@127.0.0.1:39805
[S16] ⇄ pheromone p=1.000 → S14@127.0.0.1:39814
[S7] ⇄ pheromone p=1.000 → S13@127.0.0.1:39813
[S4] ⇄ pheromone p=1.000 → S14@127.0.0.1:39814
[S15] ⇄ pheromone p=1.000 → S14@127.0.0.1:39814
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:39809
[S2] START round=1 head_norm_before_train=1.230058 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7016687587572948, 'loss_val': 1.2377094861555102, 'psi': 0.365733783536058}-{'f1_val': 0.1417771333885667, 'auprc': 0.7954958636337403, 'loss_val': 1.3179088473383518, 'psi': 0.40326462548663616}
[S3] START round=1 head_norm_before_train=1.167075 (no previous merge yet)
[S3] round=1 local utility u=0.078856 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6556514979515564, 'loss_val': 1.314501786942385, 'psi': 0.34616463854908675}-{'f1_val': 0.13984006561410703, 'auprc': 0.6116065905153336, 'loss_val': 1.3400794209369313, 'psi': 0.3285466755745977}
[S4] START round=1 head_norm_before_train=1.120947 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7838259518236687, 'loss_val': 1.2454976473702886, 'psi': 0.39766635806657796}-{'f1_val': 0.3989061545697125, 'auprc': 0.7801276056266813, 'loss_val': 1.3313485131476879, 'psi': 0.5513947349925}
[S5] START round=1 head_norm_before_train=1.141756 (no previous merge yet)
[S5] round=1 local utility u=0.877463 metrics={'f1_val': 0.3717891491527678, 'auprc': 0.7397404971537777, 'loss_val': 1.3210252570607952, 'psi': 0.5189696883531718}-{'f1_val': 0.15905379657822827, 'auprc': 0.5931785464892004, 'loss_val': 1.3598541814418394, 'psi': 0.3327036965426171}
[S6] START round=1 head_norm_before_train=1.197072 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8684734147288711, 'loss_val': 1.2775639997695702, 'psi': 0.43224513512231766}-{'f1_val': 0.4168551858772006, 'auprc': 0.9140960216365032, 'loss_val': 1.3454893305017188, 'psi': 0.6157515201809216}
[S7] START round=1 head_norm_before_train=1.177903 (no previous merge yet)
[S7] round=1 local utility u=0.320675 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7408556877828398, 'loss_val': 1.3166051232137423, 'psi': 0.3815763687505909}-{'f1_val': 0.14205682272909165, 'auprc': 0.5352891746959508, 'loss_val': 1.3412561877094862, 'psi': 0.2993497635158353}
[S8] START round=1 head_norm_before_train=1.185637 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7382922676629604, 'loss_val': 1.262707577124528, 'psi': 0.3792904965009585}-{'f1_val': 0.4159692462911617, 'auprc': 0.7320230938291651, 'loss_val': 1.320314219164218, 'psi': 0.5423907853063631}
[S9] START round=1 head_norm_before_train=1.181432 (no previous merge yet)
[S9] round=1 local utility u=0.114653 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8657343863553596, 'loss_val': 1.3020814087123396, 'psi': 0.43113252882614145}-{'f1_val': 0.141397957139996, 'auprc': 0.8028382381949885, 'loss_val': 1.3426998018919967, 'psi': 0.405974069561993}
[S10] START round=1 head_norm_before_train=1.167541 (no previous merge yet)
[S10] round=1 local utility u=0.091381 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6618176146643021, 'loss_val': 1.2783197643006743, 'psi': 0.34790002839075523}-{'f1_val': 0.13862163754172394, 'auprc': 0.6202291284169965, 'loss_val': 1.3363163138615703, 'psi': 0.33126463389183297}
[S11] START round=1 head_norm_before_train=1.205337 (no previous merge yet)
[S11] round=1 local utility u=0.101401 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7312150664006776, 'loss_val': 1.3220062235223247, 'psi': 0.3767342365841374}-{'f1_val': 0.14041368337311058, 'auprc': 0.6739622422014917, 'loss_val': 1.3530502868372767, 'psi': 0.353833106904463}
[S13] START round=1 head_norm_before_train=1.150371 (no previous merge yet)
[S13] round=1 local utility u=0.234709 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6328943296212618, 'loss_val': 1.2886914386823294, 'psi': 0.33738918939473656}-{'f1_val': 0.1403857625770531, 'auprc': 0.48879476241638076, 'loss_val': 1.325811305126364, 'psi': 0.27974936251278415}
[S14] START round=1 head_norm_before_train=1.164483 (no previous merge yet)
[S14] round=1 local utility u=0.055549 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.494713905873729, 'loss_val': 1.343085276802388, 'psi': 0.28210027407911387}-{'f1_val': 0.14035785288270378, 'auprc': 0.46590893622968077, 'loss_val': 1.367768840381522, 'psi': 0.2705782862214946}
[S15] START round=1 head_norm_before_train=1.158188 (no previous merge yet)
[S15] round=1 local utility u=0.021628 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7814698144025007, 'loss_val': 1.2809763409990194, 'psi': 0.3964281165779353}-{'f1_val': 0.13973365136155833, 'auprc': 0.7838568843091309, 'loss_val': 1.3313936688464816, 'psi': 0.39738294454058737}
[S16] START round=1 head_norm_before_train=1.157813 (no previous merge yet)
[S16] round=1 local utility u=0.139141 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8604637051358398, 'loss_val': 1.3249127548323831, 'psi': 0.4285679521738579}-{'f1_val': 0.2969502459144644, 'auprc': 0.46520857076901645, 'loss_val': 1.3553071235229883, 'psi': 0.36425357585628526}
[S17] START round=1 head_norm_before_train=1.190302 (no previous merge yet)
[S17] round=1 local utility u=0.195468 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7229938923363283, 'loss_val': 1.2988555456456727, 'psi': 0.37376693492496194}-{'f1_val': 0.09754189944134078, 'auprc': 0.6988752070748343, 'loss_val': 1.3569921420276736, 'psi': 0.3380752224947382}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:39816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:39817
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:39809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S3] → sending delta(kind=head bytes=1787) to S10@127.0.0.1:39811
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:39812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:39816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:39810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:39815
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1789 to 1 peers)
[S3] sending update (kind=head size=1787 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1787) from S3
[S10] cosine check vs S3: cos=0.0623
[S10] RECEIVED delta(kind=head bytes=1792) from S16
[S10] cosine check vs S16: cos=-0.0157
[S10] DROPPED delta from S16 (cos=-0.0157 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1790) from S14
[S15] cosine check vs S14: cos=-0.0673
[S15] DROPPED delta from S14 (cos=-0.0673 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1789) from S7
[S17] cosine check vs S7: cos=-0.0538
[S17] DROPPED delta from S7 (cos=-0.0538 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1793) from S15
[S8] cosine check vs S15: cos=0.0800
[S9] RECEIVED delta(kind=head bytes=1789) from S13
[S9] cosine check vs S13: cos=0.0435
[S7] RECEIVED delta(kind=head bytes=1789) from S5
[S7] cosine check vs S5: cos=-0.0805
[S7] DROPPED delta from S5 (cos=-0.0805 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1789) from S9
[S11] cosine check vs S9: cos=-0.0396
[S11] DROPPED delta from S9 (cos=-0.0396 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S11
[S16] cosine check vs S11: cos=0.0137
[S16] RECEIVED delta(kind=head bytes=1790) from S10
[S16] cosine check vs S10: cos=-0.0157
[S16] DROPPED delta from S10 (cos=-0.0157 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:39804
[S17] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S17
[S4] cosine check vs S17: cos=0.0605
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.222216
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.204522e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.888929 delta_norm=0.820452
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1402 head_norm=1.165619
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.180757e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1402 head_norm=0.869090 delta_norm=0.818076
[S4] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.171117
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.394461e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1114 head_norm=0.850995 delta_norm=0.839446
[S16] aggregate: ROLLBACK (f1_val pre=0.141 post=0.111 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.197416
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.213091e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.857847 delta_norm=0.821309
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.210359
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.200758e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.872876 delta_norm=0.820076
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.271312 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6242274513264774, 'loss_val': 1.1380671148686934, 'psi': 0.334757260563731}-{'f1_val': 0.1417771333885667, 'auprc': 0.7016687587572948, 'loss_val': 1.2377094861555102, 'psi': 0.365733783536058}
[S3] START round=2 head_norm_before_train=1.184865 (no previous merge yet)
[S3] round=2 local utility u=0.256614 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8174251896707625, 'loss_val': 1.2865943658658714, 'psi': 0.4108741152367692}-{'f1_val': 0.13984006561410703, 'auprc': 0.6556514979515564, 'loss_val': 1.314501786942385, 'psi': 0.34616463854908675}
[S4] START round=2 head_norm_before_train=0.869090 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.044239 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7933641350215743, 'loss_val': 1.1856338042353618, 'psi': 0.4014816313457402}-{'f1_val': 0.14022662889518414, 'auprc': 0.7838259518236687, 'loss_val': 1.2454976473702886, 'psi': 0.39766635806657796}
[S5] START round=2 head_norm_before_train=1.153996 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7365139377342995, 'loss_val': 1.2806373576783276, 'psi': 0.37996271795086267}-{'f1_val': 0.3717891491527678, 'auprc': 0.7397404971537777, 'loss_val': 1.3210252570607952, 'psi': 0.5189696883531718}
[S6] START round=2 head_norm_before_train=1.237222 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.837500557020902, 'loss_val': 1.1951237444920064, 'psi': 0.41985599203913004}-{'f1_val': 0.14142628205128205, 'auprc': 0.8684734147288711, 'loss_val': 1.2775639997695702, 'psi': 0.43224513512231766}
[S7] START round=2 head_norm_before_train=1.184383 (no previous merge yet)
[S7] round=2 local utility u=0.052057 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7679953806891449, 'loss_val': 1.2939110721946716, 'psi': 0.39243224591311293}-{'f1_val': 0.14205682272909165, 'auprc': 0.7408556877828398, 'loss_val': 1.3166051232137423, 'psi': 0.3815763687505909}
[S8] START round=2 head_norm_before_train=0.888929 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6738217631837597, 'loss_val': 1.233946081477376, 'psi': 0.35350229470927824}-{'f1_val': 0.13995598239295717, 'auprc': 0.7382922676629604, 'loss_val': 1.262707577124528, 'psi': 0.3792904965009585}
[S9] START round=2 head_norm_before_train=0.857847 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.208538 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9998950262825566, 'loss_val': 1.287487074132447, 'psi': 0.48479678479702026}-{'f1_val': 0.141397957139996, 'auprc': 0.8657343863553596, 'loss_val': 1.3020814087123396, 'psi': 0.43113252882614145}
[S10] START round=2 head_norm_before_train=0.872876 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6395037031007269, 'loss_val': 1.236685110737242, 'psi': 0.33897446376532514}-{'f1_val': 0.13862163754172394, 'auprc': 0.6618176146643021, 'loss_val': 1.2783197643006743, 'psi': 0.34790002839075523}
[S11] START round=2 head_norm_before_train=1.219103 (no previous merge yet)
[S11] round=2 local utility u=0.039982 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7440467710559115, 'loss_val': 1.2805368524275695, 'psi': 0.381866918446231}-{'f1_val': 0.14041368337311058, 'auprc': 0.7312150664006776, 'loss_val': 1.3220062235223247, 'psi': 0.3767342365841374}
[S13] START round=2 head_norm_before_train=1.177750 (no previous merge yet)
[S13] round=2 local utility u=0.044390 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6473715141940526, 'loss_val': 1.2433436382651997, 'psi': 0.3431800632238529}-{'f1_val': 0.1403857625770531, 'auprc': 0.6328943296212618, 'loss_val': 1.2886914386823294, 'psi': 0.33738918939473656}
[S14] START round=2 head_norm_before_train=1.179034 (no previous merge yet)
[S14] round=2 local utility u=0.051037 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5200175797658311, 'loss_val': 1.316923229462723, 'psi': 0.2922217436359547}-{'f1_val': 0.14035785288270378, 'auprc': 0.494713905873729, 'loss_val': 1.343085276802388, 'psi': 0.28210027407911387}
[S15] START round=2 head_norm_before_train=1.197021 (no previous merge yet)
[S15] round=2 local utility u=0.035122 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7807466451872701, 'loss_val': 1.2085636303669423, 'psi': 0.3961388488918431}-{'f1_val': 0.13973365136155833, 'auprc': 0.7814698144025007, 'loss_val': 1.2809763409990194, 'psi': 0.3964281165779353}
[S16] START round=2 head_norm_before_train=0.850995 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7122498994802231, 'loss_val': 1.332030886088751, 'psi': 0.3692824299116112}-{'f1_val': 0.14063745019920318, 'auprc': 0.8604637051358398, 'loss_val': 1.3249127548323831, 'psi': 0.4285679521738579}
[S17] START round=2 head_norm_before_train=1.220846 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.581962408012327, 'loss_val': 1.2143331555932901, 'psi': 0.31735434119536143}-{'f1_val': 0.14094896331738438, 'auprc': 0.7229938923363283, 'loss_val': 1.2988555456456727, 'psi': 0.37376693492496194}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:39812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:39813
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:39816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:39816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:39816
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:39807
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S14
[S13] cosine check vs S14: cos=-0.1341
[S13] DROPPED delta from S14 (cos=-0.1341 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S13
[S11] cosine check vs S13: cos=0.1379
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] cosine check vs S9: cos=0.0055
[S16] RECEIVED delta(kind=head bytes=1806) from S4
[S16] cosine check vs S4: cos=-0.0033
[S16] DROPPED delta from S4 (cos=-0.0033 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1790) from S7
[S6] cosine check vs S7: cos=0.0493
[S6] RECEIVED delta(kind=head bytes=1793) from S11
[S6] cosine check vs S11: cos=0.0307
[S17] RECEIVED delta(kind=head bytes=1797) from S15
[S17] cosine check vs S15: cos=0.1104
[S16] RECEIVED delta(kind=head bytes=1795) from S3
[S16] cosine check vs S3: cos=0.0572
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=2 metric=0.1414 head_norm=1.289716
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.535825e-01
[S6] stored merged vector for next round verification (round=2)
[S6] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.794025 delta_norm=0.753583
[S6] aggregate: ACCEPT kept=['S7', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1404 head_norm=1.243936
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.094035e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.929860 delta_norm=0.809404
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1409 head_norm=1.272131
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.431318e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.1409 head_norm=0.941952 delta_norm=0.843132
[S17] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=0.864764
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.514555e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.579704 delta_norm=0.551455
[S16] aggregate: ACCEPT kept=['S9', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.320427 (no previous merge yet)
[S2] round=3 local utility u=1.000000 metrics={'f1_val': 0.4168098174180254, 'auprc': 0.7768239829817448, 'loss_val': 0.9723536519841931, 'psi': 0.5608154836435132}-{'f1_val': 0.1417771333885667, 'auprc': 0.6242274513264774, 'loss_val': 1.1380671148686934, 'psi': 0.334757260563731}
[S3] START round=3 head_norm_before_train=1.208481 (no previous merge yet)
[S3] round=3 local utility u=0.016122 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8138826889949341, 'loss_val': 1.243723762366556, 'psi': 0.4094571149664379}-{'f1_val': 0.13984006561410703, 'auprc': 0.8174251896707625, 'loss_val': 1.2865943658658714, 'psi': 0.4108741152367692}
[S4] START round=3 head_norm_before_train=0.921041 cos_to_last_merge=0.9916 (last merge round=1)
[S4] round=3 local utility u=0.895241 metrics={'f1_val': 0.40973687587245883, 'auprc': 0.7860290965846792, 'loss_val': 0.9902071856294277, 'psi': 0.5602537641573471}-{'f1_val': 0.14022662889518414, 'auprc': 0.7933641350215743, 'loss_val': 1.1856338042353618, 'psi': 0.4014816313457402}
[S5] START round=3 head_norm_before_train=1.174121 (no previous merge yet)
[S5] round=3 local utility u=0.031213 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7426118290750869, 'loss_val': 1.2365049846781573, 'psi': 0.38240187448717766}-{'f1_val': 0.14226190476190476, 'auprc': 0.7365139377342995, 'loss_val': 1.2806373576783276, 'psi': 0.37996271795086267}
[S6] START round=3 head_norm_before_train=0.794025 cos_to_last_merge=1.0000 (last merge round=2)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6288588533842864, 'loss_val': 1.12784455879719, 'psi': 0.33639931058448375}-{'f1_val': 0.14142628205128205, 'auprc': 0.837500557020902, 'loss_val': 1.1951237444920064, 'psi': 0.41985599203913004}
[S7] START round=3 head_norm_before_train=1.194242 (no previous merge yet)
[S7] round=3 local utility u=0.015333 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7697606681776377, 'loss_val': 1.2685404185756992, 'psi': 0.39313836090851006}-{'f1_val': 0.14205682272909165, 'auprc': 0.7679953806891449, 'loss_val': 1.2939110721946716, 'psi': 0.39243224591311293}
[S8] START round=3 head_norm_before_train=0.937806 cos_to_last_merge=0.9937 (last merge round=1)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.4156929677121941, 'auprc': 0.766141863654967, 'loss_val': 1.1276559662495358, 'psi': 0.5558725260893033}-{'f1_val': 0.13995598239295717, 'auprc': 0.6738217631837597, 'loss_val': 1.233946081477376, 'psi': 0.35350229470927824}
[S9] START round=3 head_norm_before_train=0.878524 cos_to_last_merge=0.9971 (last merge round=1)
[S9] round=3 local utility u=0.016691 metrics={'f1_val': 0.141397957139996, 'auprc': 0.996802975751535, 'loss_val': 1.2448285945804725, 'psi': 0.48355996458461165}-{'f1_val': 0.141397957139996, 'auprc': 0.9998950262825566, 'loss_val': 1.287487074132447, 'psi': 0.48479678479702026}
[S10] START round=3 head_norm_before_train=0.929180 cos_to_last_merge=0.9934 (last merge round=1)
[S10] round=3 local utility u=0.118274 metrics={'f1_val': 0.17140126640398928, 'auprc': 0.6167192002582452, 'loss_val': 1.1284607686361932, 'psi': 0.34952843994569166}-{'f1_val': 0.13862163754172394, 'auprc': 0.6395037031007269, 'loss_val': 1.236685110737242, 'psi': 0.33897446376532514}
[S11] START round=3 head_norm_before_train=0.929860 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.026100 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7531851849598445, 'loss_val': 1.2557528156719606, 'psi': 0.3855222840078042}-{'f1_val': 0.14041368337311058, 'auprc': 0.7440467710559115, 'loss_val': 1.2805368524275695, 'psi': 0.381866918446231}
[S13] START round=3 head_norm_before_train=1.221544 (no previous merge yet)
[S13] round=3 local utility u=0.507847 metrics={'f1_val': 0.2877089118046925, 'auprc': 0.659841755535031, 'loss_val': 1.1489994552479221, 'psi': 0.43656204929682785}-{'f1_val': 0.1403857625770531, 'auprc': 0.6473715141940526, 'loss_val': 1.2433436382651997, 'psi': 0.3431800632238529}
[S14] START round=3 head_norm_before_train=1.202662 (no previous merge yet)
[S14] round=3 local utility u=0.016413 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5216712026937705, 'loss_val': 1.2890574849622538, 'psi': 0.2928831928071305}-{'f1_val': 0.14035785288270378, 'auprc': 0.5200175797658311, 'loss_val': 1.316923229462723, 'psi': 0.2922217436359547}
[S15] START round=3 head_norm_before_train=1.256173 (no previous merge yet)
[S15] round=3 local utility u=0.934108 metrics={'f1_val': 0.41599167481162613, 'auprc': 0.8001674019547427, 'loss_val': 1.0561576263393775, 'psi': 0.5696619656688728}-{'f1_val': 0.13973365136155833, 'auprc': 0.7807466451872701, 'loss_val': 1.2085636303669423, 'psi': 0.3961388488918431}
[S16] START round=3 head_norm_before_train=0.579704 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6553527771177656, 'loss_val': 1.3257572547070307, 'psi': 0.34652358096662816}-{'f1_val': 0.14063745019920318, 'auprc': 0.7122498994802231, 'loss_val': 1.332030886088751, 'psi': 0.3692824299116112}
[S17] START round=3 head_norm_before_train=0.941952 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=0.773924 metrics={'f1_val': 0.38943421975970915, 'auprc': 0.5663480826114328, 'loss_val': 1.1105534124914844, 'psi': 0.4601997649003986}-{'f1_val': 0.14094896331738438, 'auprc': 0.581962408012327, 'loss_val': 1.2143331555932901, 'psi': 0.31735434119536143}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39808
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] cosine check vs S10: cos=0.1359
[S5] RECEIVED delta(kind=head bytes=1798) from S8
[S5] cosine check vs S8: cos=-0.1205
[S5] DROPPED delta from S8 (cos=-0.1205 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S7
[S13] cosine check vs S7: cos=-0.0026
[S13] DROPPED delta from S7 (cos=-0.0026 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S2
[S6] cosine check vs S2: cos=0.0782
[S2] RECEIVED delta(kind=head bytes=1789) from S11
[S2] cosine check vs S11: cos=-0.0256
[S2] DROPPED delta from S11 (cos=-0.0256 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1806) from S13
[S10] cosine check vs S13: cos=0.0739
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=0.0511
[S7] RECEIVED delta(kind=head bytes=1804) from S9
[S7] cosine check vs S9: cos=-0.0380
[S7] DROPPED delta from S9 (cos=-0.0380 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] cosine check vs S15: cos=-0.0550
[S14] DROPPED delta from S15 (cos=-0.0550 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S3
[S14] cosine check vs S3: cos=-0.0072
[S14] DROPPED delta from S3 (cos=-0.0072 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1793) from S5
[S3] cosine check vs S5: cos=0.1333
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.0711
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] cosine check vs S17: cos=0.4840
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=0.858349
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.778127e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.834657 delta_norm=0.777813
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.232520
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.688267e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.808123 delta_norm=0.768827
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=1.241024
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.027123e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.917862 delta_norm=0.802712
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.4157 head_norm=0.981069
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.007585e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.3372 head_norm=0.849197 delta_norm=0.500758
[S8] aggregate: ROLLBACK (f1_val pre=0.416 post=0.337 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.1714 head_norm=0.995438
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.788227e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.1386 head_norm=0.836816 delta_norm=0.778823
[S10] aggregate: ROLLBACK (f1_val pre=0.171 post=0.139 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=1.197287
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.246431e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.828908 delta_norm=0.724643
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=1.211070
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.326841e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.894167 delta_norm=0.832684
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.366209 (no previous merge yet)
[S2] round=4 local utility u=0.950651 metrics={'f1_val': 0.7009905803111669, 'auprc': 0.7750973589817849, 'loss_val': 0.7709555051365773, 'psi': 0.730633291779414}-{'f1_val': 0.4168098174180254, 'auprc': 0.7768239829817448, 'loss_val': 0.9723536519841931, 'psi': 0.5608154836435132}
[S3] START round=4 head_norm_before_train=0.917862 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.016763 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8218370362248257, 'loss_val': 1.2340603862728425, 'psi': 0.4126388538583945}-{'f1_val': 0.13984006561410703, 'auprc': 0.8138826889949341, 'loss_val': 1.243723762366556, 'psi': 0.4094571149664379}
[S4] START round=4 head_norm_before_train=0.984484 cos_to_last_merge=0.9723 (last merge round=1)
[S4] round=4 local utility u=0.724450 metrics={'f1_val': 0.6708373847506528, 'auprc': 0.6633892646220745, 'loss_val': 0.7399904778917271, 'psi': 0.6678581366992214}-{'f1_val': 0.40973687587245883, 'auprc': 0.7860290965846792, 'loss_val': 0.9902071856294277, 'psi': 0.5602537641573471}
[S5] START round=4 head_norm_before_train=0.828908 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.001545 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7396468932215321, 'loss_val': 1.2245202764741314, 'psi': 0.3812159001457557}-{'f1_val': 0.14226190476190476, 'auprc': 0.7426118290750869, 'loss_val': 1.2365049846781573, 'psi': 0.38240187448717766}
[S6] START round=4 head_norm_before_train=0.834657 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=1.000000 metrics={'f1_val': 0.40530928811977895, 'auprc': 0.7763073346614661, 'loss_val': 0.9551681286781551, 'psi': 0.5537085067364538}-{'f1_val': 0.14142628205128205, 'auprc': 0.6288588533842864, 'loss_val': 1.12784455879719, 'psi': 0.33639931058448375}
[S7] START round=4 head_norm_before_train=0.894167 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7746472131705863, 'loss_val': 1.2838162840861245, 'psi': 0.3950929789056895}-{'f1_val': 0.14205682272909165, 'auprc': 0.7697606681776377, 'loss_val': 1.2685404185756992, 'psi': 0.39313836090851006}
[S8] START round=4 head_norm_before_train=0.849197 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.070642 metrics={'f1_val': 0.41601573936882824, 'auprc': 0.7704233218999355, 'loss_val': 1.001152012343017, 'psi': 0.5577787723812712}-{'f1_val': 0.4156929677121941, 'auprc': 0.766141863654967, 'loss_val': 1.1276559662495358, 'psi': 0.5558725260893033}
[S9] START round=4 head_norm_before_train=0.906364 cos_to_last_merge=0.9898 (last merge round=1)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9768353354724376, 'loss_val': 1.1950420801756758, 'psi': 0.4755729084729727}-{'f1_val': 0.141397957139996, 'auprc': 0.996802975751535, 'loss_val': 1.2448285945804725, 'psi': 0.48355996458461165}
[S10] START round=4 head_norm_before_train=0.836816 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=1.000000 metrics={'f1_val': 0.43190392383972354, 'auprc': 0.744896271335231, 'loss_val': 0.9757685954433066, 'psi': 0.5571008628379265}-{'f1_val': 0.17140126640398928, 'auprc': 0.6167192002582452, 'loss_val': 1.1284607686361932, 'psi': 0.34952843994569166}
[S11] START round=4 head_norm_before_train=0.956325 cos_to_last_merge=0.9978 (last merge round=2)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.612014825105427, 'loss_val': 1.1871364048079174, 'psi': 0.32905414006603717}-{'f1_val': 0.14041368337311058, 'auprc': 0.7531851849598445, 'loss_val': 1.2557528156719606, 'psi': 0.3855222840078042}
[S13] START round=4 head_norm_before_train=1.273874 (no previous merge yet)
[S13] round=4 local utility u=1.000000 metrics={'f1_val': 0.6309955623778468, 'auprc': 0.6859120035337893, 'loss_val': 0.8810324353460084, 'psi': 0.6529621388402238}-{'f1_val': 0.2877089118046925, 'auprc': 0.659841755535031, 'loss_val': 1.1489994552479221, 'psi': 0.43656204929682785}
[S14] START round=4 head_norm_before_train=0.808123 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.002718 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5274448773172735, 'loss_val': 1.3009416514724366, 'psi': 0.29519266265653166}-{'f1_val': 0.14035785288270378, 'auprc': 0.5216712026937705, 'loss_val': 1.2890574849622538, 'psi': 0.2928831928071305}
[S15] START round=4 head_norm_before_train=1.321185 (no previous merge yet)
[S15] round=4 local utility u=0.156536 metrics={'f1_val': 0.41664447518582326, 'auprc': 0.8001387477690507, 'loss_val': 0.7469166672945996, 'psi': 0.5700421842191142}-{'f1_val': 0.41599167481162613, 'auprc': 0.8001674019547427, 'loss_val': 1.0561576263393775, 'psi': 0.5696619656688728}
[S16] START round=4 head_norm_before_train=0.598628 cos_to_last_merge=0.9934 (last merge round=2)
[S16] round=4 local utility u=0.045884 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6737883931541568, 'loss_val': 1.2892953278506838, 'psi': 0.3538978273811847}-{'f1_val': 0.14063745019920318, 'auprc': 0.6553527771177656, 'loss_val': 1.3257572547070307, 'psi': 0.34652358096662816}
[S17] START round=4 head_norm_before_train=0.990602 cos_to_last_merge=0.9937 (last merge round=2)
[S17] round=4 local utility u=0.398241 metrics={'f1_val': 0.3895995289663724, 'auprc': 0.7619880692893146, 'loss_val': 0.9019841294104942, 'psi': 0.5385549450955494}-{'f1_val': 0.38943421975970915, 'auprc': 0.5663480826114328, 'loss_val': 1.1105534124914844, 'psi': 0.4601997649003986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39808
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39808
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1795) from S13
[S10] cosine check vs S13: cos=0.7655
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] cosine check vs S2: cos=0.8103
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=0.0093
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] cosine check vs S4: cos=0.6288
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] cosine check vs S15: cos=-0.0156
[S14] DROPPED delta from S15 (cos=-0.0156 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S3
[S14] cosine check vs S3: cos=0.0775
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=0.2399
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] cosine check vs S14: cos=0.5563
[S3] RECEIVED delta(kind=head bytes=1791) from S5
[S3] cosine check vs S5: cos=0.8420
[S5] RECEIVED delta(kind=head bytes=1795) from S8
[S5] cosine check vs S8: cos=0.0381
[S5] RECEIVED delta(kind=head bytes=1794) from S10
[S5] cosine check vs S10: cos=0.5338
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] cosine check vs S17: cos=0.8065
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=0.913942
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.867690e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1421 head_norm=0.677413 delta_norm=0.386769
[S7] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.1398 head_norm=0.950643
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.580946e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.1398 head_norm=0.868165 delta_norm=0.258095
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=4 metric=0.4053 head_norm=0.884882
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.389156e-01
[S6] stored merged vector for next round verification (round=4)
[S6] DEBUG after merge:  round=4 metric=0.4084 head_norm=1.102156 delta_norm=0.438916
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=4 metric=0.1404 head_norm=0.835016
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.272337e-01
[S14] stored merged vector for next round verification (round=4)
[S14] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.573046 delta_norm=0.427234
[S14] aggregate: ACCEPT kept=['S16', 'S4', 'S3'] (k=3/3) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=4 metric=0.4319 head_norm=0.901037
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.369399e-01
[S10] stored merged vector for next round verification (round=4)
[S10] DEBUG after merge:  round=4 metric=0.4167 head_norm=1.057178 delta_norm=0.436940
[S10] aggregate: ROLLBACK (f1_val pre=0.432 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=0.858443
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.223245e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1423 head_norm=0.632127 delta_norm=0.422325
[S5] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.4160 head_norm=0.903722
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.148009e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.4161 head_norm=0.934455 delta_norm=0.314801
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.425402 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.6919382232440807, 'auprc': 0.7769767588559431, 'loss_val': 0.742601710029547, 'psi': 0.7259536374888257}-{'f1_val': 0.7009905803111669, 'auprc': 0.7750973589817849, 'loss_val': 0.7709555051365773, 'psi': 0.730633291779414}
[S3] START round=5 head_norm_before_train=0.868165 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.796142264714259, 'loss_val': 1.1876279912339478, 'psi': 0.4023609452541679}-{'f1_val': 0.13984006561410703, 'auprc': 0.8218370362248257, 'loss_val': 1.2340603862728425, 'psi': 0.4126388538583945}
[S4] START round=5 head_norm_before_train=1.064613 cos_to_last_merge=0.9460 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=5 local utility u=0.049372 metrics={'f1_val': 0.6603269765167079, 'auprc': 0.6599056529495907, 'loss_val': 0.5677341867127729, 'psi': 0.660158447089861}-{'f1_val': 0.6708373847506528, 'auprc': 0.6633892646220745, 'loss_val': 0.7399904778917271, 'psi': 0.6678581366992214}
[S5] START round=5 head_norm_before_train=0.632127 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.017572 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7463461816723975, 'loss_val': 1.2094734610719335, 'psi': 0.38389561552610185}-{'f1_val': 0.14226190476190476, 'auprc': 0.7396468932215321, 'loss_val': 1.2245202764741314, 'psi': 0.3812159001457557}
[S6] START round=5 head_norm_before_train=1.102156 cos_to_last_merge=1.0000 (last merge round=4)
[S6] round=5 local utility u=0.698095 metrics={'f1_val': 0.6114029454003231, 'auprc': 0.7776967838747777, 'loss_val': 0.7997084785488656, 'psi': 0.6779204807901049}-{'f1_val': 0.40530928811977895, 'auprc': 0.7763073346614661, 'loss_val': 0.9551681286781551, 'psi': 0.5537085067364538}
[S7] START round=5 head_norm_before_train=0.677413 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.003708 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7735442625107737, 'loss_val': 1.2730923877874796, 'psi': 0.3946517986417645}-{'f1_val': 0.14205682272909165, 'auprc': 0.7746472131705863, 'loss_val': 1.2838162840861245, 'psi': 0.3950929789056895}
[S8] START round=5 head_norm_before_train=0.934455 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.066976 metrics={'f1_val': 0.3724647907675709, 'auprc': 0.8659408570498218, 'loss_val': 0.8924460404683354, 'psi': 0.5698552172804713}-{'f1_val': 0.41601573936882824, 'auprc': 0.7704233218999355, 'loss_val': 1.001152012343017, 'psi': 0.5577787723812712}
[S9] START round=5 head_norm_before_train=0.941870 cos_to_last_merge=0.9793 (last merge round=1)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8660857504128672, 'loss_val': 1.1249892849794974, 'psi': 0.4312730744491445}-{'f1_val': 0.141397957139996, 'auprc': 0.9768353354724376, 'loss_val': 1.1950420801756758, 'psi': 0.4755729084729727}
[S10] START round=5 head_norm_before_train=1.057178 cos_to_last_merge=1.0000 (last merge round=4)
[S10] round=5 local utility u=1.000000 metrics={'f1_val': 0.6833726261620694, 'auprc': 0.9659062635350263, 'loss_val': 0.7919998323041326, 'psi': 0.7963860811112522}-{'f1_val': 0.43190392383972354, 'auprc': 0.744896271335231, 'loss_val': 0.9757685954433066, 'psi': 0.5571008628379265}
[S11] START round=5 head_norm_before_train=0.986650 cos_to_last_merge=0.9920 (last merge round=2)
[S11] round=5 local utility u=0.061025 metrics={'f1_val': 0.1475626356837629, 'auprc': 0.601354695638066, 'loss_val': 1.075999992664775, 'psi': 0.32907945966548413}-{'f1_val': 0.14041368337311058, 'auprc': 0.612014825105427, 'loss_val': 1.1871364048079174, 'psi': 0.32905414006603717}
[S13] START round=5 head_norm_before_train=1.343583 (no previous merge yet)
[S13] round=5 local utility u=0.159757 metrics={'f1_val': 0.6281561979209951, 'auprc': 0.7147010784901565, 'loss_val': 0.630849141441687, 'psi': 0.6627741501486597}-{'f1_val': 0.6309955623778468, 'auprc': 0.6859120035337893, 'loss_val': 0.8810324353460084, 'psi': 0.6529621388402238}
[S14] START round=5 head_norm_before_train=0.573046 cos_to_last_merge=1.0000 (last merge round=4)
[S14] round=5 local utility u=0.032587 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5470458254086392, 'loss_val': 1.2945704231199906, 'psi': 0.30303304189307795}-{'f1_val': 0.14035785288270378, 'auprc': 0.5274448773172735, 'loss_val': 1.3009416514724366, 'psi': 0.29519266265653166}
[S15] START round=5 head_norm_before_train=1.401550 (no previous merge yet)
[S15] round=5 local utility u=0.691068 metrics={'f1_val': 0.6995939535542339, 'auprc': 0.6760269585431988, 'loss_val': 0.6901429367735799, 'psi': 0.6901671555498199}-{'f1_val': 0.41664447518582326, 'auprc': 0.8001387477690507, 'loss_val': 0.7469166672945996, 'psi': 0.5700421842191142}
[S16] START round=5 head_norm_before_train=0.630713 cos_to_last_merge=0.9765 (last merge round=2)
[S16] round=5 local utility u=0.033408 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6814113558526637, 'loss_val': 1.2453483104061727, 'psi': 0.35694701246058735}-{'f1_val': 0.14063745019920318, 'auprc': 0.6737883931541568, 'loss_val': 1.2892953278506838, 'psi': 0.3538978273811847}
[S17] START round=5 head_norm_before_train=1.062025 cos_to_last_merge=0.9723 (last merge round=2)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.35243618488830136, 'auprc': 0.8131158839203183, 'loss_val': 0.8898719644067066, 'psi': 0.5367080645011082}-{'f1_val': 0.3895995289663724, 'auprc': 0.7619880692893146, 'loss_val': 0.9019841294104942, 'psi': 0.5385549450955494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:39813
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S10] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39811
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:39805
[S8] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1788 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=0.4237
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.5677
[S5] RECEIVED delta(kind=head bytes=1792) from S8
[S5] cosine check vs S8: cos=0.3791
[S5] RECEIVED delta(kind=head bytes=1788) from S10
[S5] cosine check vs S10: cos=0.5595
[S13] RECEIVED delta(kind=head bytes=1797) from S7
[S13] cosine check vs S7: cos=-0.1096
[S13] DROPPED delta from S7 (cos=-0.1096 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=0.9210
[S14] RECEIVED delta(kind=head bytes=1795) from S16
[S14] cosine check vs S16: cos=0.3279
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] cosine check vs S15: cos=-0.0384
[S14] DROPPED delta from S15 (cos=-0.0384 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S4
[S14] cosine check vs S4: cos=0.6570
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=0.8239
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] cosine check vs S11: cos=-0.0337
[S2] DROPPED delta from S11 (cos=-0.0337 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=0.899427
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.577399e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.1398 head_norm=0.747379 delta_norm=0.257740
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.365 → S14@127.0.0.1:39814
[S9] ⇄ pheromone p=0.361 → S7@127.0.0.1:39808
[S2] ⇄ pheromone p=0.608 → S6@127.0.0.1:39807
[S6] ⇄ pheromone p=0.627 → S7@127.0.0.1:39808
[S4] ⇄ pheromone p=0.573 → S14@127.0.0.1:39814
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.6834 head_norm=1.129496
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.878381e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.6825 head_norm=1.245520 delta_norm=0.287838
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.710 → S5@127.0.0.1:39805
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.703280
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.002372e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.616825 delta_norm=0.300237
[S7] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.362 → S13@127.0.0.1:39813
[S13] ⇄ pheromone p=0.608 → S10@127.0.0.1:39811
[S16] ⇄ pheromone p=0.353 → S14@127.0.0.1:39814
[S8] ⇄ pheromone p=0.480 → S5@127.0.0.1:39805
[S11] ⇄ pheromone p=0.356 → S2@127.0.0.1:39802
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.603602
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.322730e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.592847 delta_norm=0.232273
[S14] aggregate: ACCEPT kept=['S16', 'S4'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.347 → S7@127.0.0.1:39808
[S15] ⇄ pheromone p=0.616 → S14@127.0.0.1:39814
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.664110
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.802954e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.642902 delta_norm=0.280295
[S5] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.407 → S3@127.0.0.1:39803
[S17] ⇄ pheromone p=0.506 → S8@127.0.0.1:39809
[S2] START round=6 head_norm_before_train=1.492424 (no previous merge yet)
[S2] round=6 local utility u=0.151055 metrics={'f1_val': 0.6995579520519839, 'auprc': 0.7774418283405172, 'loss_val': 0.48760433208473375, 'psi': 0.7307115025673973}-{'f1_val': 0.6919382232440807, 'auprc': 0.7769767588559431, 'loss_val': 0.742601710029547, 'psi': 0.7259536374888257}
[S3] START round=6 head_norm_before_train=0.747379 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.896002 metrics={'f1_val': 0.4221200147157008, 'auprc': 0.7961469144401176, 'loss_val': 1.0893184014825763, 'psi': 0.5717307746054676}-{'f1_val': 0.13984006561410703, 'auprc': 0.796142264714259, 'loss_val': 1.1876279912339478, 'psi': 0.4023609452541679}
[S4] START round=6 head_norm_before_train=1.165911 cos_to_last_merge=0.9154 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.915
[S4] round=6 local utility u=0.055530 metrics={'f1_val': 0.6655680093845718, 'auprc': 0.6590453643738045, 'loss_val': 0.4855394693157632, 'psi': 0.662958951380265}-{'f1_val': 0.6603269765167079, 'auprc': 0.6599056529495907, 'loss_val': 0.5677341867127729, 'psi': 0.660158447089861}
[S5] START round=6 head_norm_before_train=0.642902 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.6076932747575556, 'loss_val': 1.1650616095579671, 'psi': 0.32843445276016514}-{'f1_val': 0.14226190476190476, 'auprc': 0.7463461816723975, 'loss_val': 1.2094734610719335, 'psi': 0.38389561552610185}
[S6] START round=6 head_norm_before_train=1.140101 cos_to_last_merge=0.9918 (last merge round=4)
[S6] round=6 local utility u=0.416161 metrics={'f1_val': 0.7097914796873478, 'auprc': 0.8056285659230517, 'loss_val': 0.6415125341042259, 'psi': 0.7481263141816293}-{'f1_val': 0.6114029454003231, 'auprc': 0.7776967838747777, 'loss_val': 0.7997084785488656, 'psi': 0.6779204807901049}
[S7] START round=6 head_norm_before_train=0.616825 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.004671 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7706340702600523, 'loss_val': 1.2550206985884789, 'psi': 0.3934877217414759}-{'f1_val': 0.14205682272909165, 'auprc': 0.7735442625107737, 'loss_val': 1.2730923877874796, 'psi': 0.3946517986417645}
[S8] START round=6 head_norm_before_train=0.992157 cos_to_last_merge=0.9894 (last merge round=4)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7137299172989209, 'auprc': 0.9900487957083681, 'loss_val': 0.6174766049044088, 'psi': 0.8242574686626998}-{'f1_val': 0.3724647907675709, 'auprc': 0.8659408570498218, 'loss_val': 0.8924460404683354, 'psi': 0.5698552172804713}
[S9] START round=6 head_norm_before_train=0.978086 cos_to_last_merge=0.9679 (last merge round=1)
[S9] round=6 local utility u=0.234767 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9725810467998826, 'loss_val': 0.9749417082203686, 'psi': 0.47387119300395064}-{'f1_val': 0.141397957139996, 'auprc': 0.8660857504128672, 'loss_val': 1.1249892849794974, 'psi': 0.4312730744491445}
[S10] START round=6 head_norm_before_train=1.245520 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.185062 metrics={'f1_val': 0.7003378746167876, 'auprc': 0.9937214443179401, 'loss_val': 0.6071120297120361, 'psi': 0.8176913024972486}-{'f1_val': 0.6833726261620694, 'auprc': 0.9659062635350263, 'loss_val': 0.7919998323041326, 'psi': 0.7963860811112522}
[S11] START round=6 head_norm_before_train=1.019626 cos_to_last_merge=0.9831 (last merge round=2)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.762619965949008, 'loss_val': 0.9174309476806763, 'psi': 0.542979327935327}-{'f1_val': 0.1475626356837629, 'auprc': 0.601354695638066, 'loss_val': 1.075999992664775, 'psi': 0.32907945966548413}
[S13] START round=6 head_norm_before_train=1.411587 (no previous merge yet)
[S13] round=6 local utility u=0.242143 metrics={'f1_val': 0.6800781629379176, 'auprc': 0.7180328129305169, 'loss_val': 0.46808969916274445, 'psi': 0.6952600229349573}-{'f1_val': 0.6281561979209951, 'auprc': 0.7147010784901565, 'loss_val': 0.630849141441687, 'psi': 0.6627741501486597}
[S14] START round=6 head_norm_before_train=0.592847 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5347449018126857, 'loss_val': 1.2834015306732958, 'psi': 0.2981126724546966}-{'f1_val': 0.14035785288270378, 'auprc': 0.5470458254086392, 'loss_val': 1.2945704231199906, 'psi': 0.30303304189307795}
[S15] START round=6 head_norm_before_train=1.491546 (no previous merge yet)
[S15] round=6 local utility u=0.368876 metrics={'f1_val': 0.6946491654295753, 'auprc': 0.8237889938259217, 'loss_val': 0.3660082430531375, 'psi': 0.746305096788114}-{'f1_val': 0.6995939535542339, 'auprc': 0.6760269585431988, 'loss_val': 0.6901429367735799, 'psi': 0.6901671555498199}
[S16] START round=6 head_norm_before_train=0.670393 cos_to_last_merge=0.9542 (last merge round=2)
[S16] round=6 local utility u=0.410373 metrics={'f1_val': 0.3810311407802856, 'auprc': 0.4499330129887239, 'loss_val': 1.1725304144056554, 'psi': 0.4085918896636609}-{'f1_val': 0.14063745019920318, 'auprc': 0.6814113558526637, 'loss_val': 1.2453483104061727, 'psi': 0.35694701246058735}
[S17] START round=6 head_norm_before_train=1.133076 cos_to_last_merge=0.9463 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.946
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.2296425590859424, 'auprc': 0.7428665123441022, 'loss_val': 1.304096405942317, 'psi': 0.43493214038920636}-{'f1_val': 0.35243618488830136, 'auprc': 0.8131158839203183, 'loss_val': 0.8898719644067066, 'psi': 0.5367080645011082}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S8] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:39814
[S3] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1789 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1792) from S15
[S14] cosine check vs S15: cos=-0.0130
[S14] DROPPED delta from S15 (cos=-0.0130 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] cosine check vs S4: cos=0.7858
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] cosine check vs S16: cos=0.4201
[S14] RECEIVED delta(kind=head bytes=1799) from S3
[S14] cosine check vs S3: cos=0.3951
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] cosine check vs S2: cos=0.9066
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] cosine check vs S11: cos=-0.0407
[S2] DROPPED delta from S11 (cos=-0.0407 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1804) from S9
[S7] cosine check vs S9: cos=-0.0581
[S7] DROPPED delta from S9 (cos=-0.0581 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] cosine check vs S6: cos=0.7062
[S5] RECEIVED delta(kind=head bytes=1789) from S8
[S5] cosine check vs S8: cos=0.5456
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=0.6448
[S13] RECEIVED delta(kind=head bytes=1799) from S7
[S13] cosine check vs S7: cos=-0.1000
[S13] DROPPED delta from S7 (cos=-0.1000 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=0.9541
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.1423 head_norm=0.666670
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.020305e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.1575 head_norm=0.719625 delta_norm=0.202030
[S5] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.615407
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.158415e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.558243 delta_norm=0.215841
[S14] aggregate: ACCEPT kept=['S4', 'S16', 'S3'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.640690
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.350615e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.854377 delta_norm=0.435062
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.7098 head_norm=1.194987
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.472732e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.6285 head_norm=1.345912 delta_norm=0.347273
[S6] aggregate: ROLLBACK (f1_val pre=0.710 post=0.629 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.7003 head_norm=1.316066
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.270220e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.7002 head_norm=1.382492 delta_norm=0.227022
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.560822 (no previous merge yet)
[S2] round=7 local utility u=0.033082 metrics={'f1_val': 0.6986861405815773, 'auprc': 0.7583970635991717, 'loss_val': 0.3590745236987237, 'psi': 0.722570509788615}-{'f1_val': 0.6995579520519839, 'auprc': 0.7774418283405172, 'loss_val': 0.48760433208473375, 'psi': 0.7307115025673973}
[S3] START round=7 head_norm_before_train=0.784104 cos_to_last_merge=0.9951 (last merge round=5)
[S3] round=7 local utility u=0.011633 metrics={'f1_val': 0.400550043463925, 'auprc': 0.7962506203013584, 'loss_val': 0.9369443291663928, 'psi': 0.5588302741988984}-{'f1_val': 0.4221200147157008, 'auprc': 0.7961469144401176, 'loss_val': 1.0893184014825763, 'psi': 0.5717307746054676}
[S4] START round=7 head_norm_before_train=1.266605 cos_to_last_merge=0.8897 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.890
[S4] round=7 local utility u=0.004071 metrics={'f1_val': 0.6613824841542063, 'auprc': 0.6586387691297613, 'loss_val': 0.45106478660059884, 'psi': 0.6602849981444283}-{'f1_val': 0.6655680093845718, 'auprc': 0.6590453643738045, 'loss_val': 0.4855394693157632, 'psi': 0.662958951380265}
[S5] START round=7 head_norm_before_train=0.719625 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=1.000000 metrics={'f1_val': 0.4182341712921096, 'auprc': 0.7710155336575392, 'loss_val': 1.1154527670463132, 'psi': 0.5593467162382815}-{'f1_val': 0.14226190476190476, 'auprc': 0.6076932747575556, 'loss_val': 1.1650616095579671, 'psi': 0.32843445276016514}
[S6] START round=7 head_norm_before_train=1.345912 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.015219 metrics={'f1_val': 0.7018211433713419, 'auprc': 0.8071670607453886, 'loss_val': 0.5678689857772456, 'psi': 0.7439595103209606}-{'f1_val': 0.7097914796873478, 'auprc': 0.8056285659230517, 'loss_val': 0.6415125341042259, 'psi': 0.7481263141816293}
[S7] START round=7 head_norm_before_train=0.854377 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.026025 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7713657271229077, 'loss_val': 1.205164737115664, 'psi': 0.3937803844866181}-{'f1_val': 0.14205682272909165, 'auprc': 0.7706340702600523, 'loss_val': 1.2550206985884789, 'psi': 0.3934877217414759}
[S8] START round=7 head_norm_before_train=1.067617 cos_to_last_merge=0.9698 (last merge round=4)
[S8] round=7 local utility u=0.022859 metrics={'f1_val': 0.7003811776962134, 'auprc': 0.9840657876788675, 'loss_val': 0.4737165437394898, 'psi': 0.813855021689275}-{'f1_val': 0.7137299172989209, 'auprc': 0.9900487957083681, 'loss_val': 0.6174766049044088, 'psi': 0.8242574686626998}
[S9] START round=7 head_norm_before_train=1.014644 cos_to_last_merge=0.9562 (last merge round=1)
[S9] round=7 local utility u=0.793320 metrics={'f1_val': 0.3669081986077978, 'auprc': 0.9965161617803285, 'loss_val': 0.813168253907515, 'psi': 0.6187513838768102}-{'f1_val': 0.141397957139996, 'auprc': 0.9725810467998826, 'loss_val': 0.9749417082203686, 'psi': 0.47387119300395064}
[S10] START round=7 head_norm_before_train=1.382492 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.121666 metrics={'f1_val': 0.7004580249296894, 'auprc': 0.9976777481795238, 'loss_val': 0.37636909572760224, 'psi': 0.8193459142296232}-{'f1_val': 0.7003378746167876, 'auprc': 0.9937214443179401, 'loss_val': 0.6071120297120361, 'psi': 0.8176913024972486}
[S11] START round=7 head_norm_before_train=1.060701 cos_to_last_merge=0.9708 (last merge round=2)
[S11] round=7 local utility u=0.383797 metrics={'f1_val': 0.3936438436166054, 'auprc': 0.9769978166433736, 'loss_val': 0.7755196737928648, 'psi': 0.6269854328273127}-{'f1_val': 0.39655223592620625, 'auprc': 0.762619965949008, 'loss_val': 0.9174309476806763, 'psi': 0.542979327935327}
[S13] START round=7 head_norm_before_train=1.481086 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.6283943430920677, 'auprc': 0.6899160685775914, 'loss_val': 0.5748537841362041, 'psi': 0.6530030332862771}-{'f1_val': 0.6800781629379176, 'auprc': 0.7180328129305169, 'loss_val': 0.46808969916274445, 'psi': 0.6952600229349573}
[S14] START round=7 head_norm_before_train=0.558243 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.133031 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6088053549924373, 'loss_val': 1.2395217244884724, 'psi': 0.32773685372659717}-{'f1_val': 0.14035785288270378, 'auprc': 0.5347449018126857, 'loss_val': 1.2834015306732958, 'psi': 0.2981126724546966}
[S15] START round=7 head_norm_before_train=1.568103 (no previous merge yet)
[S15] round=7 local utility u=0.243736 metrics={'f1_val': 0.6894309446222013, 'auprc': 0.967155020692197, 'loss_val': 0.27732464049512184, 'psi': 0.8005205750501996}-{'f1_val': 0.6946491654295753, 'auprc': 0.8237889938259217, 'loss_val': 0.3660082430531375, 'psi': 0.746305096788114}
[S16] START round=7 head_norm_before_train=0.712038 cos_to_last_merge=0.9341 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.934
[S16] round=7 local utility u=0.429898 metrics={'f1_val': 0.4173869385094645, 'auprc': 0.6290667536151581, 'loss_val': 1.0682711166110708, 'psi': 0.5020588645517419}-{'f1_val': 0.3810311407802856, 'auprc': 0.4499330129887239, 'loss_val': 1.1725304144056554, 'psi': 0.4085918896636609}
[S17] START round=7 head_norm_before_train=1.184629 cos_to_last_merge=0.9261 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.926
[S17] round=7 local utility u=0.810753 metrics={'f1_val': 0.3718551368030884, 'auprc': 0.830295086063142, 'loss_val': 0.798152575782769, 'psi': 0.5552311165071098}-{'f1_val': 0.2296425590859424, 'auprc': 0.7428665123441022, 'loss_val': 1.304096405942317, 'psi': 0.43493214038920636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S14] → sending delta(kind=head bytes=1810) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:39805
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1810 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S7
[S13] cosine check vs S7: cos=-0.1028
[S13] DROPPED delta from S7 (cos=-0.1028 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=-0.0004
[S14] DROPPED delta from S15 (cos=-0.0004 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=0.6624
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] cosine check vs S2: cos=0.9639
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=0.5330
[S7] RECEIVED delta(kind=head bytes=1810) from S14
[S7] cosine check vs S14: cos=0.2075
[S14] RECEIVED delta(kind=head bytes=1792) from S3
[S14] cosine check vs S3: cos=0.6398
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=0.6004
[S7] RECEIVED delta(kind=head bytes=1800) from S9
[S7] cosine check vs S9: cos=-0.0426
[S7] DROPPED delta from S9 (cos=-0.0426 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S6
[S7] cosine check vs S6: cos=0.9237
[S2] RECEIVED delta(kind=head bytes=1794) from S11
[S2] cosine check vs S11: cos=-0.0487
[S2] DROPPED delta from S11 (cos=-0.0487 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1805) from S8
[S5] cosine check vs S8: cos=0.5817
[S5] RECEIVED delta(kind=head bytes=1805) from S10
[S5] cosine check vs S10: cos=0.6960
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=0.8263
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4182 head_norm=0.742334
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.605234e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.4190 head_norm=0.804829 delta_norm=0.160523
[S5] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.7018 head_norm=1.394166
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.328340e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.6802 head_norm=1.496113 delta_norm=0.232834
[S6] aggregate: ROLLBACK (f1_val pre=0.702 post=0.680 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.870272
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.829899e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=0.803891 delta_norm=0.182990
[S7] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.7004 head_norm=1.147494
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.518454e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.7006 head_norm=1.134249 delta_norm=0.351845
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1404 head_norm=0.580252
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.363537e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1404 head_norm=0.582246 delta_norm=0.136354
[S14] aggregate: ACCEPT kept=['S4', 'S16', 'S3'] (k=3/3) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.4006 head_norm=0.837140
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.555458e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.4005 head_norm=0.706766 delta_norm=0.355546
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.625248 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.6995078406626564, 'auprc': 0.6832904565904181, 'loss_val': 0.3211310457713076, 'psi': 0.6930208870337611}-{'f1_val': 0.6986861405815773, 'auprc': 0.7583970635991717, 'loss_val': 0.3590745236987237, 'psi': 0.722570509788615}
[S3] START round=8 head_norm_before_train=0.706766 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.249090 metrics={'f1_val': 0.4006740549686527, 'auprc': 0.9393503989641774, 'loss_val': 0.8688075873707038, 'psi': 0.6161445925668626}-{'f1_val': 0.400550043463925, 'auprc': 0.7962506203013584, 'loss_val': 0.9369443291663928, 'psi': 0.5588302741988984}
[S4] START round=8 head_norm_before_train=1.343680 cos_to_last_merge=0.8706 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.871
[S4] round=8 local utility u=0.224849 metrics={'f1_val': 0.6583500869331511, 'auprc': 0.8152883535886468, 'loss_val': 0.45312049931450105, 'psi': 0.7211253935953494}-{'f1_val': 0.6613824841542063, 'auprc': 0.6586387691297613, 'loss_val': 0.45106478660059884, 'psi': 0.6602849981444283}
[S5] START round=8 head_norm_before_train=0.804829 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.040249 metrics={'f1_val': 0.41803072775632044, 'auprc': 0.77308226708526, 'loss_val': 1.0399335900040692, 'psi': 0.5600513434878962}-{'f1_val': 0.4182341712921096, 'auprc': 0.7710155336575392, 'loss_val': 1.1154527670463132, 'psi': 0.5593467162382815}
[S6] START round=8 head_norm_before_train=1.496113 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.058428 metrics={'f1_val': 0.7043290444346724, 'auprc': 0.8189470979472533, 'loss_val': 0.5014013912944817, 'psi': 0.7501762658397048}-{'f1_val': 0.7018211433713419, 'auprc': 0.8071670607453886, 'loss_val': 0.5678689857772456, 'psi': 0.7439595103209606}
[S7] START round=8 head_norm_before_train=0.803891 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.853149 metrics={'f1_val': 0.4170778520170104, 'auprc': 0.776010411100081, 'loss_val': 1.1629278921666433, 'psi': 0.5606508756502386}-{'f1_val': 0.14205682272909165, 'auprc': 0.7713657271229077, 'loss_val': 1.205164737115664, 'psi': 0.3937803844866181}
[S8] START round=8 head_norm_before_train=1.134249 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.7939403110428395, 'loss_val': 0.5228112344763151, 'psi': 0.7459863532014044}-{'f1_val': 0.7003811776962134, 'auprc': 0.9840657876788675, 'loss_val': 0.4737165437394898, 'psi': 0.813855021689275}
[S9] START round=8 head_norm_before_train=1.060108 cos_to_last_merge=0.9419 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.942
[S9] round=8 local utility u=1.000000 metrics={'f1_val': 0.7012654965268851, 'auprc': 0.9995523307890859, 'loss_val': 0.67989049177044, 'psi': 0.8205802302317654}-{'f1_val': 0.3669081986077978, 'auprc': 0.9965161617803285, 'loss_val': 0.813168253907515, 'psi': 0.6187513838768102}
[S10] START round=8 head_norm_before_train=1.448662 cos_to_last_merge=0.9947 (last merge round=6)
[S10] round=8 local utility u=0.068868 metrics={'f1_val': 0.7000537794092287, 'auprc': 0.9979024669984489, 'loss_val': 0.23688165267058253, 'psi': 0.8191932544449168}-{'f1_val': 0.7004580249296894, 'auprc': 0.9976777481795238, 'loss_val': 0.37636909572760224, 'psi': 0.8193459142296232}
[S11] START round=8 head_norm_before_train=1.110557 cos_to_last_merge=0.9556 (last merge round=2)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.9406562753079905, 'loss_val': 0.7245453415130995, 'psi': 0.6162177618046594}-{'f1_val': 0.3936438436166054, 'auprc': 0.9769978166433736, 'loss_val': 0.7755196737928648, 'psi': 0.6269854328273127}
[S13] START round=8 head_norm_before_train=1.536103 (no previous merge yet)
[S13] round=8 local utility u=0.039712 metrics={'f1_val': 0.6338323771351086, 'auprc': 0.6962999687873739, 'loss_val': 0.5472102586734934, 'psi': 0.6588194137960147}-{'f1_val': 0.6283943430920677, 'auprc': 0.6899160685775914, 'loss_val': 0.5748537841362041, 'psi': 0.6530030332862771}
[S14] START round=8 head_norm_before_train=0.582246 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.915937 metrics={'f1_val': 0.39205023068383804, 'auprc': 0.6959881548650092, 'loss_val': 1.1793494202915191, 'psi': 0.5136254003563065}-{'f1_val': 0.14035785288270378, 'auprc': 0.6088053549924373, 'loss_val': 1.2395217244884724, 'psi': 0.32773685372659717}
[S15] START round=8 head_norm_before_train=1.623825 (no previous merge yet)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.70143717593532, 'auprc': 0.7995736023601323, 'loss_val': 0.4952330268655202, 'psi': 0.7406917465052449}-{'f1_val': 0.6894309446222013, 'auprc': 0.967155020692197, 'loss_val': 0.27732464049512184, 'psi': 0.8005205750501996}
[S16] START round=8 head_norm_before_train=0.748769 cos_to_last_merge=0.9190 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.919
[S16] round=8 local utility u=0.070178 metrics={'f1_val': 0.41727255530994717, 'auprc': 0.6446038058979217, 'loss_val': 0.9738401339238871, 'psi': 0.508205055545137}-{'f1_val': 0.4173869385094645, 'auprc': 0.6290667536151581, 'loss_val': 1.0682711166110708, 'psi': 0.5020588645517419}
[S17] START round=8 head_norm_before_train=1.226331 cos_to_last_merge=0.9116 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.912
[S17] round=8 local utility u=0.444432 metrics={'f1_val': 0.44625224285108456, 'auprc': 0.9313329243130305, 'loss_val': 0.6587844719440067, 'psi': 0.640284515435863}-{'f1_val': 0.3718551368030884, 'auprc': 0.830295086063142, 'loss_val': 0.798152575782769, 'psi': 0.5552311165071098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39814
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:39803
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S9
[S7] cosine check vs S9: cos=-0.0258
[S7] DROPPED delta from S9 (cos=-0.0258 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.7423
[S13] RECEIVED delta(kind=head bytes=1796) from S7
[S13] cosine check vs S7: cos=-0.0766
[S13] DROPPED delta from S7 (cos=-0.0766 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S13
[S10] cosine check vs S13: cos=0.9504
[S14] RECEIVED delta(kind=head bytes=1791) from S16
[S14] cosine check vs S16: cos=0.5697
[S14] RECEIVED delta(kind=head bytes=1797) from S3
[S14] cosine check vs S3: cos=0.7291
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=0.7923
[S14] RECEIVED delta(kind=head bytes=1796) from S4
[S14] cosine check vs S4: cos=0.5700
[S7] RECEIVED delta(kind=head bytes=1794) from S6
[S7] cosine check vs S6: cos=0.9122
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=0.3072
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.9373
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.7140 head_norm=1.191212
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.201300e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.7140 head_norm=1.207499 delta_norm=0.220130
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.4171 head_norm=0.816439
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.472453e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.4171 head_norm=0.816867 delta_norm=0.147245
[S7] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.4007 head_norm=0.761734
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.589280e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.4007 head_norm=0.754375 delta_norm=0.258928
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.7001 head_norm=1.511232
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.446532e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.6999 head_norm=1.522509 delta_norm=0.244653
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4180 head_norm=0.831873
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.266305e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.7146 head_norm=1.100262 delta_norm=0.526630
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.3921 head_norm=0.607600
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.272610e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3964 head_norm=0.598408 delta_norm=0.127261
[S14] aggregate: ACCEPT kept=['S16', 'S3', 'S4'] (k=3/3) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.678619 (no previous merge yet)
[S2] round=9 local utility u=0.130634 metrics={'f1_val': 0.7109491237699851, 'auprc': 0.7918516472305555, 'loss_val': 0.45419431984264225, 'psi': 0.7433101331542132}-{'f1_val': 0.6995078406626564, 'auprc': 0.6832904565904181, 'loss_val': 0.3211310457713076, 'psi': 0.6930208870337611}
[S3] START round=9 head_norm_before_train=0.754375 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.401708470248874, 'auprc': 0.8957328389187492, 'loss_val': 0.8703547125434321, 'psi': 0.5993182177168241}-{'f1_val': 0.4006740549686527, 'auprc': 0.9393503989641774, 'loss_val': 0.8688075873707038, 'psi': 0.6161445925668626}
[S4] START round=9 head_norm_before_train=1.398905 cos_to_last_merge=0.8576 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.858
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6088123695389236, 'auprc': 0.8443228757179971, 'loss_val': 0.45106740976393156, 'psi': 0.703016572010553}-{'f1_val': 0.6583500869331511, 'auprc': 0.8152883535886468, 'loss_val': 0.45312049931450105, 'psi': 0.7211253935953494}
[S5] START round=9 head_norm_before_train=1.100262 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.943512 metrics={'f1_val': 0.7144671410848138, 'auprc': 0.7739348304799492, 'loss_val': 0.9340860278685057, 'psi': 0.738254216842868}-{'f1_val': 0.41803072775632044, 'auprc': 0.77308226708526, 'loss_val': 1.0399335900040692, 'psi': 0.5600513434878962}
[S6] START round=9 head_norm_before_train=1.529041 cos_to_last_merge=0.9987 (last merge round=7)
[S6] round=9 local utility u=0.301233 metrics={'f1_val': 0.7044035521645402, 'auprc': 0.9681003339850822, 'loss_val': 0.34684150914836565, 'psi': 0.809882264892757}-{'f1_val': 0.7043290444346724, 'auprc': 0.8189470979472533, 'loss_val': 0.5014013912944817, 'psi': 0.7501762658397048}
[S7] START round=9 head_norm_before_train=0.816867 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.4170778520170104, 'auprc': 0.7234128886905249, 'loss_val': 1.092272707548051, 'psi': 0.5396118666864163}-{'f1_val': 0.4170778520170104, 'auprc': 0.776010411100081, 'loss_val': 1.1629278921666433, 'psi': 0.5606508756502386}
[S8] START round=9 head_norm_before_train=1.207499 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.368114 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.987570475887607, 'loss_val': 0.3674731858453204, 'psi': 0.8234384191393115}-{'f1_val': 0.7140170479737811, 'auprc': 0.7939403110428395, 'loss_val': 0.5228112344763151, 'psi': 0.7459863532014044}
[S9] START round=9 head_norm_before_train=1.114578 cos_to_last_merge=0.9253 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.925
[S9] round=9 local utility u=0.094710 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.9993777525602363, 'loss_val': 0.49098943075630297, 'psi': 0.8206145811930674}-{'f1_val': 0.7012654965268851, 'auprc': 0.9995523307890859, 'loss_val': 0.67989049177044, 'psi': 0.8205802302317654}
[S10] START round=9 head_norm_before_train=1.522509 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.781663 metrics={'f1_val': 0.9553356954776621, 'auprc': 0.9979882255909467, 'loss_val': 0.20550462674458397, 'psi': 0.9723967075229759}-{'f1_val': 0.7000537794092287, 'auprc': 0.9979024669984489, 'loss_val': 0.23688165267058253, 'psi': 0.8191932544449168}
[S11] START round=9 head_norm_before_train=1.156993 cos_to_last_merge=0.9407 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.941
[S11] round=9 local utility u=0.267127 metrics={'f1_val': 0.4529810958874081, 'auprc': 0.98615670002583, 'loss_val': 0.6451264229221689, 'psi': 0.6662513375427769}-{'f1_val': 0.39992541946910537, 'auprc': 0.9406562753079905, 'loss_val': 0.7245453415130995, 'psi': 0.6162177618046594}
[S13] START round=9 head_norm_before_train=1.572245 (no previous merge yet)
[S13] round=9 local utility u=0.051004 metrics={'f1_val': 0.6496530197159007, 'auprc': 0.6828904469496619, 'loss_val': 0.49989687373868896, 'psi': 0.6629479906094052}-{'f1_val': 0.6338323771351086, 'auprc': 0.6962999687873739, 'loss_val': 0.5472102586734934, 'psi': 0.6588194137960147}
[S14] START round=9 head_norm_before_train=0.598408 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.39610838874675514, 'auprc': 0.6418980897864538, 'loss_val': 1.0532591680486363, 'psi': 0.4944242691626346}-{'f1_val': 0.39205023068383804, 'auprc': 0.6959881548650092, 'loss_val': 1.1793494202915191, 'psi': 0.5136254003563065}
[S15] START round=9 head_norm_before_train=1.671462 (no previous merge yet)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.701349946339206, 'auprc': 0.7995625956863261, 'loss_val': 0.6751950717312978, 'psi': 0.740635006078054}-{'f1_val': 0.70143717593532, 'auprc': 0.7995736023601323, 'loss_val': 0.4952330268655202, 'psi': 0.7406917465052449}
[S16] START round=9 head_norm_before_train=0.790205 cos_to_last_merge=0.9015 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.901
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.39120309705936157, 'auprc': 0.6693455232799156, 'loss_val': 0.943746535186901, 'psi': 0.5024600675475832}-{'f1_val': 0.41727255530994717, 'auprc': 0.6446038058979217, 'loss_val': 0.9738401339238871, 'psi': 0.508205055545137}
[S17] START round=9 head_norm_before_train=1.262551 cos_to_last_merge=0.9016 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.902
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.39207116496155825, 'auprc': 0.9194612902018771, 'loss_val': 0.6426808086350868, 'psi': 0.6030272150576859}-{'f1_val': 0.44625224285108456, 'auprc': 0.9313329243130305, 'loss_val': 0.6587844719440067, 'psi': 0.640284515435863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:39803
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39805
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39808
[S6] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] cosine check vs S6: cos=0.9220
[S7] RECEIVED delta(kind=head bytes=1804) from S9
[S7] cosine check vs S9: cos=-0.0156
[S7] DROPPED delta from S9 (cos=-0.0156 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S11
[S2] cosine check vs S11: cos=-0.0495
[S2] DROPPED delta from S11 (cos=-0.0495 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] cosine check vs S8: cos=0.1806
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=0.9424
[S10] RECEIVED delta(kind=head bytes=1795) from S13
[S10] cosine check vs S13: cos=0.9781
[S3] RECEIVED delta(kind=head bytes=1790) from S5
[S3] cosine check vs S5: cos=0.8147
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=0.9752
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4171 head_norm=0.837955
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.247375e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4171 head_norm=1.176332 delta_norm=0.424738
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.4017 head_norm=0.808710
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.303399e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.4017 head_norm=0.921810 delta_norm=0.330340
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.7044 head_norm=1.557611
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.011865e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.7037 head_norm=1.631595 delta_norm=0.201187
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.9553 head_norm=1.565969
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.657364e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.6998 head_norm=1.570620 delta_norm=0.165736
[S10] aggregate: ROLLBACK (f1_val pre=0.955 post=0.700 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.7145 head_norm=1.124145
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.686408e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.7144 head_norm=1.014860 delta_norm=0.268641
[S5] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.725979 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.699901552821862, 'auprc': 0.7484082065289678, 'loss_val': 0.37397332285761553, 'psi': 0.7193042143047043}-{'f1_val': 0.7109491237699851, 'auprc': 0.7918516472305555, 'loss_val': 0.45419431984264225, 'psi': 0.7433101331542132}
[S3] START round=10 head_norm_before_train=0.921810 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.177625 metrics={'f1_val': 0.401708470248874, 'auprc': 0.9994884882027566, 'loss_val': 0.8263715173646906, 'psi': 0.640820477430427}-{'f1_val': 0.401708470248874, 'auprc': 0.8957328389187492, 'loss_val': 0.8703547125434321, 'psi': 0.5993182177168241}
[S4] START round=10 head_norm_before_train=1.439851 cos_to_last_merge=0.8499 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.850
[S4] round=10 local utility u=0.027464 metrics={'f1_val': 0.6189752771374494, 'auprc': 0.8382444219445795, 'loss_val': 0.43888217371047433, 'psi': 0.7066829350603014}-{'f1_val': 0.6088123695389236, 'auprc': 0.8443228757179971, 'loss_val': 0.45106740976393156, 'psi': 0.703016572010553}
[S5] START round=10 head_norm_before_train=1.014860 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.6537057546897315, 'auprc': 0.7712324167901923, 'loss_val': 0.8619482982877894, 'psi': 0.7007164195299158}-{'f1_val': 0.7144671410848138, 'auprc': 0.7739348304799492, 'loss_val': 0.9340860278685057, 'psi': 0.738254216842868}
[S6] START round=10 head_norm_before_train=1.631595 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.7047735220044483, 'auprc': 0.8170344275833858, 'loss_val': 0.4588975622308525, 'psi': 0.7496778842360233}-{'f1_val': 0.7044035521645402, 'auprc': 0.9681003339850822, 'loss_val': 0.34684150914836565, 'psi': 0.809882264892757}
[S7] START round=10 head_norm_before_train=1.176332 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.125852 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.7637967025788042, 'loss_val': 0.9614657050145811, 'psi': 0.5557399373242906}-{'f1_val': 0.4170778520170104, 'auprc': 0.7234128886905249, 'loss_val': 1.092272707548051, 'psi': 0.5396118666864163}
[S8] START round=10 head_norm_before_train=1.264417 cos_to_last_merge=0.9970 (last merge round=8)
[S8] round=10 local utility u=0.784738 metrics={'f1_val': 0.9592632094193644, 'auprc': 0.9852559321247298, 'loss_val': 0.26252961865855295, 'psi': 0.9696602985015106}-{'f1_val': 0.7140170479737811, 'auprc': 0.987570475887607, 'loss_val': 0.3674731858453204, 'psi': 0.8234384191393115}
[S9] START round=10 head_norm_before_train=1.176584 cos_to_last_merge=0.9081 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.908
[S9] round=10 local utility u=0.074601 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9993777525602363, 'loss_val': 0.34133999496215806, 'psi': 0.8205699016556001}-{'f1_val': 0.7014391336149548, 'auprc': 0.9993777525602363, 'loss_val': 0.49098943075630297, 'psi': 0.8206145811930674}
[S10] START round=10 head_norm_before_train=1.570620 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.9585016899087708, 'auprc': 0.9944072652253724, 'loss_val': 0.24877979679485274, 'psi': 0.9728639200354114}-{'f1_val': 0.9553356954776621, 'auprc': 0.9979882255909467, 'loss_val': 0.20550462674458397, 'psi': 0.9723967075229759}
[S11] START round=10 head_norm_before_train=1.199976 cos_to_last_merge=0.9280 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.928
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.40062503679542427, 'auprc': 0.9989300796413133, 'loss_val': 0.6797423296535963, 'psi': 0.6399470539337799}-{'f1_val': 0.4529810958874081, 'auprc': 0.98615670002583, 'loss_val': 0.6451264229221689, 'psi': 0.6662513375427769}
[S13] START round=10 head_norm_before_train=1.592600 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.6283306682076681, 'auprc': 0.6895179975561665, 'loss_val': 0.610151707116195, 'psi': 0.6528055999470674}-{'f1_val': 0.6496530197159007, 'auprc': 0.6828904469496619, 'loss_val': 0.49989687373868896, 'psi': 0.6629479906094052}
[S14] START round=10 head_norm_before_train=0.631734 cos_to_last_merge=0.9899 (last merge round=8)
[S14] round=10 local utility u=0.294607 metrics={'f1_val': 0.3946055515381143, 'auprc': 0.8061307179406894, 'loss_val': 0.947726605609143, 'psi': 0.5592156180991443}-{'f1_val': 0.39610838874675514, 'auprc': 0.6418980897864538, 'loss_val': 1.0532591680486363, 'psi': 0.4944242691626346}
[S15] START round=10 head_norm_before_train=1.715159 (no previous merge yet)
[S15] round=10 local utility u=0.482682 metrics={'f1_val': 0.771418009693589, 'auprc': 0.852711446387317, 'loss_val': 0.28968519665815345, 'psi': 0.8039353843710801}-{'f1_val': 0.701349946339206, 'auprc': 0.7995625956863261, 'loss_val': 0.6751950717312978, 'psi': 0.740635006078054}
[S16] START round=10 head_norm_before_train=0.832433 cos_to_last_merge=0.8827 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.883
[S16] round=10 local utility u=0.262105 metrics={'f1_val': 0.43572900579363805, 'auprc': 0.7291359738251227, 'loss_val': 0.8660624217168833, 'psi': 0.553091793006232}-{'f1_val': 0.39120309705936157, 'auprc': 0.6693455232799156, 'loss_val': 0.943746535186901, 'psi': 0.5024600675475832}
[S17] START round=10 head_norm_before_train=1.288630 cos_to_last_merge=0.8955 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.895
[S17] round=10 local utility u=0.099604 metrics={'f1_val': 0.4184205965046826, 'auprc': 0.9158712240881022, 'loss_val': 0.5907999611106077, 'psi': 0.6174008475380505}-{'f1_val': 0.39207116496155825, 'auprc': 0.9194612902018771, 'loss_val': 0.6426808086350868, 'psi': 0.6030272150576859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39805
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S3] → sending delta(kind=head bytes=1787) to S14@127.0.0.1:39814
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39808
[S3] sending update (kind=head size=1787 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S9
[S7] cosine check vs S9: cos=-0.0283
[S7] DROPPED delta from S9 (cos=-0.0283 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] cosine check vs S8: cos=0.3845
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.1577
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=0.5100
[S13] RECEIVED delta(kind=head bytes=1795) from S7
[S13] cosine check vs S7: cos=-0.0839
[S13] DROPPED delta from S7 (cos=-0.0839 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1787) from S3
[S14] cosine check vs S3: cos=0.6218
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] cosine check vs S16: cos=0.5441
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] cosine check vs S15: cos=0.0798
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=0.9521
[S2] ⇄ pheromone p=0.236 → S6@127.0.0.1:39807
[S10] ⇄ pheromone p=0.394 → S5@127.0.0.1:39805
[S6] ⇄ pheromone p=0.297 → S7@127.0.0.1:39808
[S11] ⇄ pheromone p=0.280 → S2@127.0.0.1:39802
[S13] ⇄ pheromone p=0.232 → S10@127.0.0.1:39811
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.6537 head_norm=1.040272
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.648173e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.4952 head_norm=0.984835 delta_norm=0.664817
[S5] aggregate: ROLLBACK (f1_val pre=0.654 post=0.495 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.392 → S3@127.0.0.1:39803
[S9] ⇄ pheromone p=0.377 → S7@127.0.0.1:39808
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.9593 head_norm=1.319697
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.037242e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.7244 head_norm=1.299977 delta_norm=0.203724
[S8] aggregate: ROLLBACK (f1_val pre=0.959 post=0.724 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.458 → S5@127.0.0.1:39805
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4170 head_norm=1.196588
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.397326e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4170 head_norm=0.733092 delta_norm=0.639733
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.256 → S13@127.0.0.1:39813
[S15] ⇄ pheromone p=0.354 → S14@127.0.0.1:39814
[S16] ⇄ pheromone p=0.255 → S14@127.0.0.1:39814
[S14] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.3946 head_norm=0.679368
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.423193e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.3934 head_norm=0.644324 delta_norm=0.242319
[S14] aggregate: ACCEPT kept=['S4', 'S3', 'S16', 'S15'] (k=4/4) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.303 → S7@127.0.0.1:39808
[S3] ⇄ pheromone p=0.262 → S14@127.0.0.1:39814
[S4] ⇄ pheromone p=0.227 → S14@127.0.0.1:39814
[S17] ⇄ pheromone p=0.326 → S8@127.0.0.1:39809
[S2] START round=11 head_norm_before_train=1.760061 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.7123309785916375, 'auprc': 0.7824140769725856, 'loss_val': 0.6544942094455328, 'psi': 0.7403642179440169}-{'f1_val': 0.699901552821862, 'auprc': 0.7484082065289678, 'loss_val': 0.37397332285761553, 'psi': 0.7193042143047043}
[S3] START round=11 head_norm_before_train=0.971144 cos_to_last_merge=0.9940 (last merge round=9)
[S3] round=11 local utility u=0.977493 metrics={'f1_val': 0.6899361217114872, 'auprc': 0.9968146957324718, 'loss_val': 0.5927301062123708, 'psi': 0.812687551319881}-{'f1_val': 0.401708470248874, 'auprc': 0.9994884882027566, 'loss_val': 0.8263715173646906, 'psi': 0.640820477430427}
[S4] START round=11 head_norm_before_train=1.468321 cos_to_last_merge=0.8457 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.846
[S4] round=11 local utility u=0.191654 metrics={'f1_val': 0.6309006218011372, 'auprc': 0.942531062867777, 'loss_val': 0.43998690455826595, 'psi': 0.7555527982277931}-{'f1_val': 0.6189752771374494, 'auprc': 0.8382444219445795, 'loss_val': 0.43888217371047433, 'psi': 0.7066829350603014}
[S5] START round=11 head_norm_before_train=0.984835 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.4048518105849582, 'auprc': 0.6954610564329837, 'loss_val': 0.7765339019046278, 'psi': 0.5210955089241684}-{'f1_val': 0.6537057546897315, 'auprc': 0.7712324167901923, 'loss_val': 0.8619482982877894, 'psi': 0.7007164195299158}
[S6] START round=11 head_norm_before_train=1.657579 cos_to_last_merge=0.9995 (last merge round=9)
[S6] round=11 local utility u=0.286423 metrics={'f1_val': 0.7099592237669515, 'auprc': 0.9608118886988047, 'loss_val': 0.3484975890059619, 'psi': 0.8103002897396929}-{'f1_val': 0.7047735220044483, 'auprc': 0.8170344275833858, 'loss_val': 0.4588975622308525, 'psi': 0.7496778842360233}
[S7] START round=11 head_norm_before_train=0.733092 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.6312736531982509, 'loss_val': 0.9934536612530733, 'psi': 0.502657319540775}-{'f1_val': 0.41703542715461484, 'auprc': 0.7637967025788042, 'loss_val': 0.9614657050145811, 'psi': 0.5557399373242906}
[S8] START round=11 head_norm_before_train=1.299977 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.113892 metrics={'f1_val': 0.9935224726182723, 'auprc': 0.9876159727435181, 'loss_val': 0.24738068814229508, 'psi': 0.9911598726683706}-{'f1_val': 0.9592632094193644, 'auprc': 0.9852559321247298, 'loss_val': 0.26252961865855295, 'psi': 0.9696602985015106}
[S9] START round=11 head_norm_before_train=1.238092 cos_to_last_merge=0.8919 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.892
[S9] round=11 local utility u=0.046542 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9992923354335121, 'loss_val': 0.2475544014469533, 'psi': 0.820491224297943}-{'f1_val': 0.7013646677191758, 'auprc': 0.9993777525602363, 'loss_val': 0.34133999496215806, 'psi': 0.8205699016556001}
[S10] START round=11 head_norm_before_train=1.600241 cos_to_last_merge=0.9991 (last merge round=9)
[S10] round=11 local utility u=0.158932 metrics={'f1_val': 0.9945137777399781, 'auprc': 0.99774301891962, 'loss_val': 0.15699563649638834, 'psi': 0.9958054742118349}-{'f1_val': 0.9585016899087708, 'auprc': 0.9944072652253724, 'loss_val': 0.24877979679485274, 'psi': 0.9728639200354114}
[S11] START round=11 head_norm_before_train=1.232868 cos_to_last_merge=0.9163 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.916
[S11] round=11 local utility u=0.655424 metrics={'f1_val': 0.6000357362263986, 'auprc': 0.9988125238493406, 'loss_val': 0.5650051573457759, 'psi': 0.7595464512755754}-{'f1_val': 0.40062503679542427, 'auprc': 0.9989300796413133, 'loss_val': 0.6797423296535963, 'psi': 0.6399470539337799}
[S13] START round=11 head_norm_before_train=1.621690 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.6266866428771032, 'auprc': 0.6972202047202263, 'loss_val': 0.6380797432458261, 'psi': 0.6549000676143524}-{'f1_val': 0.6283306682076681, 'auprc': 0.6895179975561665, 'loss_val': 0.610151707116195, 'psi': 0.6528055999470674}
[S14] START round=11 head_norm_before_train=0.644324 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.125420 metrics={'f1_val': 0.3935884911291916, 'auprc': 0.8590411987554312, 'loss_val': 0.8495151340018233, 'psi': 0.5797695741796874}-{'f1_val': 0.3946055515381143, 'auprc': 0.8061307179406894, 'loss_val': 0.947726605609143, 'psi': 0.5592156180991443}
[S15] START round=11 head_norm_before_train=1.753051 (no previous merge yet)
[S15] round=11 local utility u=0.962379 metrics={'f1_val': 0.9930920229052463, 'auprc': 0.9956232318708036, 'loss_val': 0.12370694249769525, 'psi': 0.9941045064914692}-{'f1_val': 0.771418009693589, 'auprc': 0.852711446387317, 'loss_val': 0.28968519665815345, 'psi': 0.8039353843710801}
[S16] START round=11 head_norm_before_train=0.884336 cos_to_last_merge=0.8615 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.861
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.3718301567086748, 'auprc': 0.7359196603949023, 'loss_val': 0.8286744221450218, 'psi': 0.5174659581831659}-{'f1_val': 0.43572900579363805, 'auprc': 0.7291359738251227, 'loss_val': 0.8660624217168833, 'psi': 0.553091793006232}
[S17] START round=11 head_norm_before_train=1.311978 cos_to_last_merge=0.8893 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.889
[S17] round=11 local utility u=1.000000 metrics={'f1_val': 0.7869431186243228, 'auprc': 0.9331655192936954, 'loss_val': 0.5120711166698518, 'psi': 0.8454320788920718}-{'f1_val': 0.4184205965046826, 'auprc': 0.9158712240881022, 'loss_val': 0.5907999611106077, 'psi': 0.6174008475380505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39805
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:39802
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.5142
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] cosine check vs S6: cos=0.8073
[S7] RECEIVED delta(kind=head bytes=1804) from S9
[S7] cosine check vs S9: cos=0.0425
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] cosine check vs S8: cos=0.8569
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] cosine check vs S10: cos=0.4013
[S14] RECEIVED delta(kind=head bytes=1794) from S3
[S14] cosine check vs S3: cos=0.7511
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] cosine check vs S15: cos=0.3029
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] cosine check vs S4: cos=0.4944
[S2] RECEIVED delta(kind=head bytes=1794) from S11
[S2] cosine check vs S11: cos=-0.0479
[S2] DROPPED delta from S11 (cos=-0.0479 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9762
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4169 head_norm=0.764140
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.838111e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4169 head_norm=0.654468 delta_norm=0.283811
[S7] aggregate: ACCEPT kept=['S14', 'S6', 'S9'] (k=3/3) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.4049 head_norm=1.011263
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.362256e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.4392 head_norm=0.985386 delta_norm=0.236226
[S5] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.3936 head_norm=0.690392
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.608777e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.3936 head_norm=0.746782 delta_norm=0.260878
[S14] aggregate: ACCEPT kept=['S3', 'S15', 'S4'] (k=3/3) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.9935 head_norm=1.344788
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.464210e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.9935 head_norm=1.334211 delta_norm=0.146421
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.780775 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.6996741554113749, 'auprc': 0.6691023921086718, 'loss_val': 0.37905080323601226, 'psi': 0.6874454500902937}-{'f1_val': 0.7123309785916375, 'auprc': 0.7824140769725856, 'loss_val': 0.6544942094455328, 'psi': 0.7403642179440169}
[S3] START round=12 head_norm_before_train=1.029509 cos_to_last_merge=0.9809 (last merge round=9)
[S3] round=12 local utility u=0.103916 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9917590726659211, 'loss_val': 0.4346511812015588, 'psi': 0.8171573513075483}-{'f1_val': 0.6899361217114872, 'auprc': 0.9968146957324718, 'loss_val': 0.5927301062123708, 'psi': 0.812687551319881}
[S4] START round=12 head_norm_before_train=1.497427 cos_to_last_merge=0.8413 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.841
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.606664371305291, 'auprc': 0.9443208954933692, 'loss_val': 0.4716745961496314, 'psi': 0.7417269809805223}-{'f1_val': 0.6309006218011372, 'auprc': 0.942531062867777, 'loss_val': 0.43998690455826595, 'psi': 0.7555527982277931}
[S5] START round=12 head_norm_before_train=0.985386 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=1.000000 metrics={'f1_val': 0.7144008589453258, 'auprc': 0.7757511477895279, 'loss_val': 0.7249133050409867, 'psi': 0.7389409744830067}-{'f1_val': 0.4048518105849582, 'auprc': 0.6954610564329837, 'loss_val': 0.7765339019046278, 'psi': 0.5210955089241684}
[S6] START round=12 head_norm_before_train=1.685149 cos_to_last_merge=0.9982 (last merge round=9)
[S6] round=12 local utility u=0.747129 metrics={'f1_val': 0.943788361968193, 'auprc': 0.9674805338158738, 'loss_val': 0.2772196231499497, 'psi': 0.9532652307072653}-{'f1_val': 0.7099592237669515, 'auprc': 0.9608118886988047, 'loss_val': 0.3484975890059619, 'psi': 0.8103002897396929}
[S7] START round=12 head_norm_before_train=0.654468 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.188774 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.760571664091984, 'loss_val': 1.0033158845625558, 'psi': 0.5543281452958577}-{'f1_val': 0.4169130971024577, 'auprc': 0.6312736531982509, 'loss_val': 0.9934536612530733, 'psi': 0.502657319540775}
[S8] START round=12 head_norm_before_train=1.334211 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.004879 metrics={'f1_val': 0.9925364588750162, 'auprc': 0.9873391283777186, 'loss_val': 0.23087653786990683, 'psi': 0.9904575266760971}-{'f1_val': 0.9935224726182723, 'auprc': 0.9876159727435181, 'loss_val': 0.24738068814229508, 'psi': 0.9911598726683706}
[S9] START round=12 head_norm_before_train=1.297486 cos_to_last_merge=0.8761 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.876
[S9] round=12 local utility u=0.020892 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9996233401361765, 'loss_val': 0.20631980768706343, 'psi': 0.8205792845184817}-{'f1_val': 0.7012904835408967, 'auprc': 0.9992923354335121, 'loss_val': 0.2475544014469533, 'psi': 0.820491224297943}
[S10] START round=12 head_norm_before_train=1.638577 cos_to_last_merge=0.9963 (last merge round=9)
[S10] round=12 local utility u=0.000059 metrics={'f1_val': 0.9931968828184566, 'auprc': 0.9958724589009686, 'loss_val': 0.1433654874459823, 'psi': 0.9942671132514614}-{'f1_val': 0.9945137777399781, 'auprc': 0.99774301891962, 'loss_val': 0.15699563649638834, 'psi': 0.9958054742118349}
[S11] START round=12 head_norm_before_train=1.263736 cos_to_last_merge=0.9073 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.907
[S11] round=12 local utility u=0.359416 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9986912629740146, 'loss_val': 0.45760042334955564, 'psi': 0.8206769707571451}-{'f1_val': 0.6000357362263986, 'auprc': 0.9988125238493406, 'loss_val': 0.5650051573457759, 'psi': 0.7595464512755754}
[S13] START round=12 head_norm_before_train=1.641808 (no previous merge yet)
[S13] round=12 local utility u=0.041548 metrics={'f1_val': 0.6358907567044535, 'auprc': 0.6849662520168006, 'loss_val': 0.5734471921549683, 'psi': 0.6555209548293923}-{'f1_val': 0.6266866428771032, 'auprc': 0.6972202047202263, 'loss_val': 0.6380797432458261, 'psi': 0.6549000676143524}
[S14] START round=12 head_norm_before_train=0.746782 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.170232 metrics={'f1_val': 0.40292584601788684, 'auprc': 0.9475752425136335, 'loss_val': 0.830677550816367, 'psi': 0.6207856046161855}-{'f1_val': 0.3935884911291916, 'auprc': 0.8590411987554312, 'loss_val': 0.8495151340018233, 'psi': 0.5797695741796874}
[S15] START round=12 head_norm_before_train=1.790128 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.7865039315566967, 'auprc': 0.9447357705757248, 'loss_val': 0.2516464290181156, 'psi': 0.8497966671643079}-{'f1_val': 0.9930920229052463, 'auprc': 0.9956232318708036, 'loss_val': 0.12370694249769525, 'psi': 0.9941045064914692}
[S16] START round=12 head_norm_before_train=0.939323 cos_to_last_merge=0.8435 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.844
[S16] round=12 local utility u=0.215073 metrics={'f1_val': 0.4297014729439749, 'auprc': 0.7424560746568272, 'loss_val': 0.7653647977433381, 'psi': 0.5548033136291158}-{'f1_val': 0.3718301567086748, 'auprc': 0.7359196603949023, 'loss_val': 0.8286744221450218, 'psi': 0.5174659581831659}
[S17] START round=12 head_norm_before_train=1.339649 cos_to_last_merge=0.8833 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.883
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.7114853442969851, 'auprc': 0.9332803420088988, 'loss_val': 0.4776551723628139, 'psi': 0.8002033433817506}-{'f1_val': 0.7869431186243228, 'auprc': 0.9331655192936954, 'loss_val': 0.5120711166698518, 'psi': 0.8454320788920718}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39805
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:39814
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:39813
[S9] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] cosine check vs S5: cos=0.7911
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] cosine check vs S11: cos=-0.0472
[S2] DROPPED delta from S11 (cos=-0.0472 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] cosine check vs S6: cos=0.7104
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] cosine check vs S8: cos=0.7326
[S13] RECEIVED delta(kind=head bytes=1801) from S7
[S13] cosine check vs S7: cos=0.1959
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=0.9738
[S7] RECEIVED delta(kind=head bytes=1803) from S9
[S7] cosine check vs S9: cos=0.3407
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.5427
[S14] RECEIVED delta(kind=head bytes=1794) from S16
[S14] cosine check vs S16: cos=0.3740
[S14] RECEIVED delta(kind=head bytes=1798) from S3
[S14] cosine check vs S3: cos=0.7711
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.5936
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.4168 head_norm=0.687839
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.985596e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.4168 head_norm=0.668512 delta_norm=0.198560
[S7] aggregate: ACCEPT kept=['S6', 'S9', 'S14'] (k=3/3) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.6359 head_norm=1.668017
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.375473e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.5974 head_norm=0.962401 delta_norm=0.837547
[S13] aggregate: ROLLBACK (f1_val pre=0.636 post=0.597 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.9932 head_norm=1.678057
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.914568e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.9935 head_norm=1.662054 delta_norm=0.191457
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.7008 head_norm=1.088928
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.412351e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.7008 head_norm=0.993451 delta_norm=0.341235
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7144 head_norm=1.010450
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.365707e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7144 head_norm=1.016710 delta_norm=0.136571
[S5] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.4029 head_norm=0.784762
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.146732e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.4070 head_norm=0.757374 delta_norm=0.314673
[S14] aggregate: ACCEPT kept=['S16', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.802492 (no previous merge yet)
[S2] round=13 local utility u=0.130658 metrics={'f1_val': 0.7032967476030137, 'auprc': 0.7727014688852343, 'loss_val': 0.45026802773524366, 'psi': 0.7310586361159019}-{'f1_val': 0.6996741554113749, 'auprc': 0.6691023921086718, 'loss_val': 0.37905080323601226, 'psi': 0.6874454500902937}
[S3] START round=13 head_norm_before_train=0.993451 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.6437773404531858, 'auprc': 0.9996224172061787, 'loss_val': 0.5539621725541781, 'psi': 0.7861153711543829}-{'f1_val': 0.7007562037352997, 'auprc': 0.9917590726659211, 'loss_val': 0.4346511812015588, 'psi': 0.8171573513075483}
[S4] START round=13 head_norm_before_train=1.528836 cos_to_last_merge=0.8371 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.837
[S4] round=13 local utility u=0.007316 metrics={'f1_val': 0.6061532281648133, 'auprc': 0.9478533162036792, 'loss_val': 0.4645728759920015, 'psi': 0.7428332633803596}-{'f1_val': 0.606664371305291, 'auprc': 0.9443208954933692, 'loss_val': 0.4716745961496314, 'psi': 0.7417269809805223}
[S5] START round=13 head_norm_before_train=1.016710 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.6614348182620204, 'loss_val': 0.6385473207642227, 'psi': 0.6850640426113224}-{'f1_val': 0.7144008589453258, 'auprc': 0.7757511477895279, 'loss_val': 0.7249133050409867, 'psi': 0.7389409744830067}
[S6] START round=13 head_norm_before_train=1.716069 cos_to_last_merge=0.9961 (last merge round=9)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.6433449992381477, 'auprc': 0.8159300716045235, 'loss_val': 0.4394294414600804, 'psi': 0.712379028184698}-{'f1_val': 0.943788361968193, 'auprc': 0.9674805338158738, 'loss_val': 0.2772196231499497, 'psi': 0.9532652307072653}
[S7] START round=13 head_norm_before_train=0.668512 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.6681272486608111, 'loss_val': 1.0070307500052045, 'psi': 0.5172769703309386}-{'f1_val': 0.41683246609844005, 'auprc': 0.760571664091984, 'loss_val': 1.0033158845625558, 'psi': 0.5543281452958577}
[S8] START round=13 head_norm_before_train=1.382827 cos_to_last_merge=0.9984 (last merge round=11)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.7148485081847971, 'auprc': 0.9836627879235684, 'loss_val': 0.2278347722590336, 'psi': 0.8223742200803057}-{'f1_val': 0.9925364588750162, 'auprc': 0.9873391283777186, 'loss_val': 0.23087653786990683, 'psi': 0.9904575266760971}
[S9] START round=13 head_norm_before_train=1.353146 cos_to_last_merge=0.8616 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.862
[S9] round=13 local utility u=0.854875 metrics={'f1_val': 0.9774282609880908, 'auprc': 0.9993281970715947, 'loss_val': 0.15295395588079966, 'psi': 0.9861882354214924}-{'f1_val': 0.7012165807733519, 'auprc': 0.9996233401361765, 'loss_val': 0.20631980768706343, 'psi': 0.8205792845184817}
[S10] START round=13 head_norm_before_train=1.662054 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.9870680961003259, 'auprc': 0.9953619792887587, 'loss_val': 0.14562847048714228, 'psi': 0.9903856493756991}-{'f1_val': 0.9931968828184566, 'auprc': 0.9958724589009686, 'loss_val': 0.1433654874459823, 'psi': 0.9942671132514614}
[S11] START round=13 head_norm_before_train=1.301447 cos_to_last_merge=0.8972 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.897
[S11] round=13 local utility u=0.044286 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9987374518729363, 'loss_val': 0.36877403543455184, 'psi': 0.8206561707281665}-{'f1_val': 0.7020007759458987, 'auprc': 0.9986912629740146, 'loss_val': 0.45760042334955564, 'psi': 0.8206769707571451}
[S13] START round=13 head_norm_before_train=0.962401 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.5889166847794265, 'auprc': 0.708128796052949, 'loss_val': 0.6830957636295245, 'psi': 0.6366015292888355}-{'f1_val': 0.6358907567044535, 'auprc': 0.6849662520168006, 'loss_val': 0.5734471921549683, 'psi': 0.6555209548293923}
[S14] START round=13 head_norm_before_train=0.757374 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.066589 metrics={'f1_val': 0.4079569309189057, 'auprc': 0.9575189701176694, 'loss_val': 0.7575173066687931, 'psi': 0.6277817465984112}-{'f1_val': 0.40292584601788684, 'auprc': 0.9475752425136335, 'loss_val': 0.830677550816367, 'psi': 0.6207856046161855}
[S15] START round=13 head_norm_before_train=1.826265 (no previous merge yet)
[S15] round=13 local utility u=0.747020 metrics={'f1_val': 0.985705911875004, 'auprc': 0.9925119678824614, 'loss_val': 0.09614680358127527, 'psi': 0.9884283342779869}-{'f1_val': 0.7865039315566967, 'auprc': 0.9447357705757248, 'loss_val': 0.2516464290181156, 'psi': 0.8497966671643079}
[S16] START round=13 head_norm_before_train=0.988857 cos_to_last_merge=0.8300 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.830
[S16] round=13 local utility u=0.030297 metrics={'f1_val': 0.43343226784392574, 'auprc': 0.7440324953844748, 'loss_val': 0.7318854324663674, 'psi': 0.5576723588601453}-{'f1_val': 0.4297014729439749, 'auprc': 0.7424560746568272, 'loss_val': 0.7653647977433381, 'psi': 0.5548033136291158}
[S17] START round=13 head_norm_before_train=1.371540 cos_to_last_merge=0.8773 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.877
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.6452745801690793, 'auprc': 0.7935222083061433, 'loss_val': 0.569695126241904, 'psi': 0.7045736314239048}-{'f1_val': 0.7114853442969851, 'auprc': 0.9332803420088988, 'loss_val': 0.4776551723628139, 'psi': 0.8002033433817506}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39808
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[S4] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=-0.0501
[S2] DROPPED delta from S11 (cos=-0.0501 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1804) from S9
[S7] cosine check vs S9: cos=0.5039
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] cosine check vs S4: cos=0.3354
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] cosine check vs S2: cos=0.9753
[S7] RECEIVED delta(kind=head bytes=1793) from S14
[S7] cosine check vs S14: cos=0.6494
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=0.3231
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=0.6378
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.4167 head_norm=0.699004
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.429302e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.4167 head_norm=0.738409 delta_norm=0.342930
[S7] aggregate: ACCEPT kept=['S9', 'S14'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.4080 head_norm=0.796046
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.019213e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.4018 head_norm=0.754608 delta_norm=0.301921
[S14] aggregate: ROLLBACK (f1_val pre=0.408 post=0.402 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.6433 head_norm=1.748737
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.015628e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.6433 head_norm=1.774336 delta_norm=0.201563
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.822008 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.7124941844904575, 'auprc': 0.7765351380571971, 'loss_val': 0.7912304625839632, 'psi': 0.7381105659171534}-{'f1_val': 0.7032967476030137, 'auprc': 0.7727014688852343, 'loss_val': 0.45026802773524366, 'psi': 0.7310586361159019}
[S3] START round=14 head_norm_before_train=1.042973 cos_to_last_merge=0.9976 (last merge round=12)
[S3] round=14 local utility u=0.248981 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9989308622627544, 'loss_val': 0.39625150554659, 'psi': 0.8200713859203882}-{'f1_val': 0.6437773404531858, 'auprc': 0.9996224172061787, 'loss_val': 0.5539621725541781, 'psi': 0.7861153711543829}
[S4] START round=14 head_norm_before_train=1.556075 cos_to_last_merge=0.8341 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.834
[S4] round=14 local utility u=0.026770 metrics={'f1_val': 0.6147798423120471, 'auprc': 0.9474452209732087, 'loss_val': 0.46156841867446957, 'psi': 0.7478459937765117}-{'f1_val': 0.6061532281648133, 'auprc': 0.9478533162036792, 'loss_val': 0.4645728759920015, 'psi': 0.7428332633803596}
[S5] START round=14 head_norm_before_train=1.038416 cos_to_last_merge=0.9989 (last merge round=12)
[S5] round=14 local utility u=0.113262 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.7104134592395264, 'loss_val': 0.5574735150152567, 'psi': 0.7045068768019689}-{'f1_val': 0.7008168588441903, 'auprc': 0.6614348182620204, 'loss_val': 0.6385473207642227, 'psi': 0.6850640426113224}
[S6] START round=14 head_norm_before_train=1.774336 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=1.000000 metrics={'f1_val': 0.9625923386854474, 'auprc': 0.9637377585395499, 'loss_val': 0.23561803669240797, 'psi': 0.9630505066270885}-{'f1_val': 0.6433449992381477, 'auprc': 0.8159300716045235, 'loss_val': 0.4394294414600804, 'psi': 0.712379028184698}
[S7] START round=14 head_norm_before_train=0.738409 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.5607840814200632, 'loss_val': 1.064875224111369, 'psi': 0.4744614908294999}-{'f1_val': 0.41671011811102343, 'auprc': 0.6681272486608111, 'loss_val': 1.0070307500052045, 'psi': 0.5172769703309386}
[S8] START round=14 head_norm_before_train=1.441864 cos_to_last_merge=0.9935 (last merge round=11)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.713665972483988, 'auprc': 0.9827431269078362, 'loss_val': 0.30852392067712686, 'psi': 0.8212968342535273}-{'f1_val': 0.7148485081847971, 'auprc': 0.9836627879235684, 'loss_val': 0.2278347722590336, 'psi': 0.8223742200803057}
[S9] START round=14 head_norm_before_train=1.402289 cos_to_last_merge=0.8495 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.849
[S9] round=14 local utility u=0.038676 metrics={'f1_val': 0.9861123006036613, 'auprc': 0.9996054469717024, 'loss_val': 0.12853764462949324, 'psi': 0.9915095591508778}-{'f1_val': 0.9774282609880908, 'auprc': 0.9993281970715947, 'loss_val': 0.15295395588079966, 'psi': 0.9861882354214924}
[S10] START round=14 head_norm_before_train=1.708595 cos_to_last_merge=0.9987 (last merge round=12)
[S10] round=14 local utility u=0.054878 metrics={'f1_val': 0.9940177825893683, 'auprc': 0.9969961120814592, 'loss_val': 0.08247369930272791, 'psi': 0.9952091143862047}-{'f1_val': 0.9870680961003259, 'auprc': 0.9953619792887587, 'loss_val': 0.14562847048714228, 'psi': 0.9903856493756991}
[S11] START round=14 head_norm_before_train=1.347931 cos_to_last_merge=0.8863 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.886
[S11] round=14 local utility u=0.036515 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9985569811480286, 'loss_val': 0.29520277014229784, 'psi': 0.8205839824382035}-{'f1_val': 0.7019353166316534, 'auprc': 0.9987374518729363, 'loss_val': 0.36877403543455184, 'psi': 0.8206561707281665}
[S13] START round=14 head_norm_before_train=1.027201 cos_to_last_merge=0.9973 (last merge round=12)
[S13] round=14 local utility u=0.064882 metrics={'f1_val': 0.6138772010379006, 'auprc': 0.7033036730803637, 'loss_val': 0.6886194260300097, 'psi': 0.6496477898548858}-{'f1_val': 0.5889166847794265, 'auprc': 0.708128796052949, 'loss_val': 0.6830957636295245, 'psi': 0.6366015292888355}
[S14] START round=14 head_norm_before_train=0.754608 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.432312 metrics={'f1_val': 0.5185591339476103, 'auprc': 0.9950380503758272, 'loss_val': 0.6690631960867561, 'psi': 0.7091507005188971}-{'f1_val': 0.4079569309189057, 'auprc': 0.9575189701176694, 'loss_val': 0.7575173066687931, 'psi': 0.6277817465984112}
[S15] START round=14 head_norm_before_train=1.858208 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.9825491149423293, 'auprc': 0.9914528630308649, 'loss_val': 0.07998404334536235, 'psi': 0.9861106141777436}-{'f1_val': 0.985705911875004, 'auprc': 0.9925119678824614, 'loss_val': 0.09614680358127527, 'psi': 0.9884283342779869}
[S16] START round=14 head_norm_before_train=1.034410 cos_to_last_merge=0.8198 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.820
[S16] round=14 local utility u=0.024317 metrics={'f1_val': 0.4389460038940798, 'auprc': 0.7526700395855113, 'loss_val': 0.7422460404124795, 'psi': 0.5644356181706524}-{'f1_val': 0.43343226784392574, 'auprc': 0.7440324953844748, 'loss_val': 0.7318854324663674, 'psi': 0.5576723588601453}
[S17] START round=14 head_norm_before_train=1.420091 cos_to_last_merge=0.8704 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.870
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.5826133809596591, 'auprc': 0.8132414684118093, 'loss_val': 0.7402052048649219, 'psi': 0.6748646159405192}-{'f1_val': 0.6452745801690793, 'auprc': 0.7935222083061433, 'loss_val': 0.569695126241904, 'psi': 0.7045736314239048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39803
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39814
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S14
[S7] cosine check vs S14: cos=0.6245
[S10] RECEIVED delta(kind=head bytes=1795) from S13
[S10] cosine check vs S13: cos=0.9418
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] cosine check vs S4: cos=0.4955
[S14] RECEIVED delta(kind=head bytes=1802) from S3
[S14] cosine check vs S3: cos=0.7135
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=0.9226
[S7] RECEIVED delta(kind=head bytes=1802) from S9
[S7] cosine check vs S9: cos=0.7647
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] cosine check vs S10: cos=0.6646
[S14] RECEIVED delta(kind=head bytes=1790) from S16
[S14] cosine check vs S16: cos=0.6139
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=-0.0564
[S2] DROPPED delta from S11 (cos=-0.0564 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] cosine check vs S6: cos=0.3112
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.4169 head_norm=0.759804
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.266849e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.4169 head_norm=0.734470 delta_norm=0.126685
[S7] aggregate: ACCEPT kept=['S14', 'S9', 'S6'] (k=3/3) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.5186 head_norm=0.793850
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.739215e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.5202 head_norm=0.788363 delta_norm=0.173921
[S14] aggregate: ACCEPT kept=['S4', 'S3', 'S16'] (k=3/3) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.9940 head_norm=1.765123
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.022139e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.9946 head_norm=1.422106 delta_norm=0.402214
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.7008 head_norm=1.095650
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.130968e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.7008 head_norm=1.059138 delta_norm=0.213097
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7006 head_norm=1.064856
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.616685e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7006 head_norm=1.298839 delta_norm=0.661668
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.840688 (no previous merge yet)
[S2] round=15 local utility u=0.117804 metrics={'f1_val': 0.7093252957240361, 'auprc': 0.773740590192156, 'loss_val': 0.5282263355307543, 'psi': 0.735091413511284}-{'f1_val': 0.7124941844904575, 'auprc': 0.7765351380571971, 'loss_val': 0.7912304625839632, 'psi': 0.7381105659171534}
[S3] START round=15 head_norm_before_train=1.059138 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.000990 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9989185085704346, 'loss_val': 0.3937805728016851, 'psi': 0.8200211256693537}-{'f1_val': 0.7008317350254774, 'auprc': 0.9989308622627544, 'loss_val': 0.39625150554659, 'psi': 0.8200713859203882}
[S4] START round=15 head_norm_before_train=1.579594 cos_to_last_merge=0.8321 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.832
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.6150521012266678, 'auprc': 0.9484852602768117, 'loss_val': 0.4692323029974303, 'psi': 0.7484253648467254}-{'f1_val': 0.6147798423120471, 'auprc': 0.9474452209732087, 'loss_val': 0.46156841867446957, 'psi': 0.7478459937765117}
[S5] START round=15 head_norm_before_train=1.298839 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.6613858632899386, 'loss_val': 0.5376992099301298, 'psi': 0.6848958384221338}-{'f1_val': 0.7005691551769304, 'auprc': 0.7104134592395264, 'loss_val': 0.5574735150152567, 'psi': 0.7045068768019689}
[S6] START round=15 head_norm_before_train=1.795198 cos_to_last_merge=0.9998 (last merge round=13)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.7039201115070792, 'auprc': 0.939292609319357, 'loss_val': 0.32794717654685307, 'psi': 0.7980691106319904}-{'f1_val': 0.9625923386854474, 'auprc': 0.9637377585395499, 'loss_val': 0.23561803669240797, 'psi': 0.9630505066270885}
[S7] START round=15 head_norm_before_train=0.734470 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.090075 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.5972284656275462, 'loss_val': 0.992839649471696, 'psi': 0.4889174571176325}-{'f1_val': 0.4169130971024577, 'auprc': 0.5607840814200632, 'loss_val': 1.064875224111369, 'psi': 0.4744614908294999}
[S8] START round=15 head_norm_before_train=1.500431 cos_to_last_merge=0.9872 (last merge round=11)
[S8] round=15 local utility u=0.946559 metrics={'f1_val': 0.9904055349873329, 'auprc': 0.9922324009821613, 'loss_val': 0.10431096963453168, 'psi': 0.9911362813852642}-{'f1_val': 0.713665972483988, 'auprc': 0.9827431269078362, 'loss_val': 0.30852392067712686, 'psi': 0.8212968342535273}
[S9] START round=15 head_norm_before_train=1.448764 cos_to_last_merge=0.8393 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.839
[S9] round=15 local utility u=0.050772 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9982715932109765, 'loss_val': 0.08628120483641334, 'psi': 0.9973049443727254}-{'f1_val': 0.9861123006036613, 'auprc': 0.9996054469717024, 'loss_val': 0.12853764462949324, 'psi': 0.9915095591508778}
[S10] START round=15 head_norm_before_train=1.422106 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.9274776006503429, 'auprc': 0.9954078918634661, 'loss_val': 0.15293247985100625, 'psi': 0.9546497171355922}-{'f1_val': 0.9940177825893683, 'auprc': 0.9969961120814592, 'loss_val': 0.08247369930272791, 'psi': 0.9952091143862047}
[S11] START round=15 head_norm_before_train=1.400624 cos_to_last_merge=0.8747 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.875
[S11] round=15 local utility u=0.024049 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.998618790762291, 'loss_val': 0.24728934821343931, 'psi': 0.8206087062839085}-{'f1_val': 0.7019353166316534, 'auprc': 0.9985569811480286, 'loss_val': 0.29520277014229784, 'psi': 0.8205839824382035}
[S13] START round=15 head_norm_before_train=1.119226 cos_to_last_merge=0.9889 (last merge round=12)
[S13] round=15 local utility u=0.190077 metrics={'f1_val': 0.6472950806245139, 'auprc': 0.7175588941165587, 'loss_val': 0.5517391349597547, 'psi': 0.6754006060213318}-{'f1_val': 0.6138772010379006, 'auprc': 0.7033036730803637, 'loss_val': 0.6886194260300097, 'psi': 0.6496477898548858}
[S14] START round=15 head_norm_before_train=0.788363 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.470680 metrics={'f1_val': 0.6962685432785738, 'auprc': 0.9654663014265801, 'loss_val': 0.7052447799427335, 'psi': 0.8039476465377764}-{'f1_val': 0.5185591339476103, 'auprc': 0.9950380503758272, 'loss_val': 0.6690631960867561, 'psi': 0.7091507005188971}
[S15] START round=15 head_norm_before_train=1.893770 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.9010189726704102, 'auprc': 0.9897011148029671, 'loss_val': 0.1464066538266637, 'psi': 0.936491829523433}-{'f1_val': 0.9825491149423293, 'auprc': 0.9914528630308649, 'loss_val': 0.07998404334536235, 'psi': 0.9861106141777436}
[S16] START round=15 head_norm_before_train=1.078604 cos_to_last_merge=0.8114 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.811
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.4416748331743482, 'auprc': 0.7565681975217757, 'loss_val': 0.7818314441759268, 'psi': 0.5676321789133192}-{'f1_val': 0.4389460038940798, 'auprc': 0.7526700395855113, 'loss_val': 0.7422460404124795, 'psi': 0.5644356181706524}
[S17] START round=15 head_norm_before_train=1.472394 cos_to_last_merge=0.8650 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.865
[S17] round=15 local utility u=0.352137 metrics={'f1_val': 0.606423559472109, 'auprc': 0.9466324602348843, 'loss_val': 0.5789651893847214, 'psi': 0.7425071197772192}-{'f1_val': 0.5826133809596591, 'auprc': 0.8132414684118093, 'loss_val': 0.7402052048649219, 'psi': 0.6748646159405192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:39808
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39805
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39802
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:39813
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1805) from S9
[S7] cosine check vs S9: cos=0.6995
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=0.9706
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] cosine check vs S8: cos=0.2080
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] cosine check vs S7: cos=0.5975
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=0.9877
[S14] RECEIVED delta(kind=head bytes=1802) from S3
[S14] cosine check vs S3: cos=0.7900
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=-0.0614
[S2] DROPPED delta from S11 (cos=-0.0614 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9456
[S14] sending update (kind=head size=1793 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1793) from S14
[S7] cosine check vs S14: cos=0.6600
[S4] ⇄ pheromone p=0.095 → S14@127.0.0.1:39814
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7006 head_norm=1.329271
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.090665e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7006 head_norm=1.119974 delta_norm=0.909066
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.249 → S3@127.0.0.1:39803
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.9275 head_norm=1.486764
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.209973e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.9539 head_norm=1.325548 delta_norm=0.220997
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.151 → S5@127.0.0.1:39805
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6473 head_norm=1.183794
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.754750e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6387 head_norm=0.875547 delta_norm=0.475475
[S13] aggregate: ROLLBACK (f1_val pre=0.647 post=0.639 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.129 → S10@127.0.0.1:39811
[S3] ⇄ pheromone p=0.216 → S14@127.0.0.1:39814
[S11] ⇄ pheromone p=0.199 → S2@127.0.0.1:39802
[S9] ⇄ pheromone p=0.255 → S7@127.0.0.1:39808
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9904 head_norm=1.547426
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.538846e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.9904 head_norm=1.516495 delta_norm=0.253885
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.349 → S5@127.0.0.1:39805
[S2] ⇄ pheromone p=0.118 → S6@127.0.0.1:39807
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.4167 head_norm=0.764167
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.549517e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.4167 head_norm=0.819498 delta_norm=0.254952
[S7] aggregate: ACCEPT kept=['S9', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.121 → S13@127.0.0.1:39813
[S15] ⇄ pheromone p=0.290 → S14@127.0.0.1:39814
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.7039 head_norm=1.811648
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.454367e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.7040 head_norm=1.828946 delta_norm=0.145437
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.357 → S7@127.0.0.1:39808
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.6963 head_norm=0.824268
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.404781e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.5831 head_norm=0.914994 delta_norm=0.340478
[S14] aggregate: ROLLBACK (f1_val pre=0.696 post=0.583 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.299 → S7@127.0.0.1:39808
[S16] ⇄ pheromone p=0.113 → S14@127.0.0.1:39814
[S17] ⇄ pheromone p=0.259 → S8@127.0.0.1:39809
[S2] START round=16 head_norm_before_train=1.857504 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.6155516587980542, 'auprc': 0.7243289198703846, 'loss_val': 0.718006860032108, 'psi': 0.6590625632269864}-{'f1_val': 0.7093252957240361, 'auprc': 0.773740590192156, 'loss_val': 0.5282263355307543, 'psi': 0.735091413511284}
[S3] START round=16 head_norm_before_train=1.107637 cos_to_last_merge=0.9981 (last merge round=14)
[S3] round=16 local utility u=0.026333 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.998772125545522, 'loss_val': 0.3402245683674123, 'psi': 0.8199174260174096}-{'f1_val': 0.7007562037352997, 'auprc': 0.9989185085704346, 'loss_val': 0.3937805728016851, 'psi': 0.8200211256693537}
[S4] START round=16 head_norm_before_train=1.603096 cos_to_last_merge=0.8299 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.830
[S4] round=16 local utility u=0.020319 metrics={'f1_val': 0.6139579476905189, 'auprc': 0.9535182930070989, 'loss_val': 0.4371286873304881, 'psi': 0.7497820858171509}-{'f1_val': 0.6150521012266678, 'auprc': 0.9484852602768117, 'loss_val': 0.4692323029974303, 'psi': 0.7484253648467254}
[S5] START round=16 head_norm_before_train=1.119974 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.159014 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7637760717123714, 'loss_val': 0.5270776812570919, 'psi': 0.7258754642825531}-{'f1_val': 0.7005691551769304, 'auprc': 0.6613858632899386, 'loss_val': 0.5376992099301298, 'psi': 0.6848958384221338}
[S6] START round=16 head_norm_before_train=1.828946 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6213019719423292, 'auprc': 0.7940180990769728, 'loss_val': 0.6297409266422493, 'psi': 0.6903884227961867}-{'f1_val': 0.7039201115070792, 'auprc': 0.939292609319357, 'loss_val': 0.32794717654685307, 'psi': 0.7980691106319904}
[S7] START round=16 head_norm_before_train=0.819498 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.049077 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.6351149021253378, 'loss_val': 1.0083456244202207, 'psi': 0.5040720317167492}-{'f1_val': 0.41671011811102343, 'auprc': 0.5972284656275462, 'loss_val': 0.992839649471696, 'psi': 0.4889174571176325}
[S8] START round=16 head_norm_before_train=1.516495 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9929205408612032, 'auprc': 0.985551689398952, 'loss_val': 0.11016942620662408, 'psi': 0.9899730002763028}-{'f1_val': 0.9904055349873329, 'auprc': 0.9922324009821613, 'loss_val': 0.10431096963453168, 'psi': 0.9911362813852642}
[S9] START round=16 head_norm_before_train=1.491874 cos_to_last_merge=0.8309 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.831
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9875711251504857, 'auprc': 0.998809862662247, 'loss_val': 0.07814774666069982, 'psi': 0.9920666201551903}-{'f1_val': 0.9966605118138915, 'auprc': 0.9982715932109765, 'loss_val': 0.08628120483641334, 'psi': 0.9973049443727254}
[S10] START round=16 head_norm_before_train=1.325548 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.217913 metrics={'f1_val': 0.9932214201180478, 'auprc': 0.9969104079582698, 'loss_val': 0.11607725653151951, 'psi': 0.9946970152541366}-{'f1_val': 0.9274776006503429, 'auprc': 0.9954078918634661, 'loss_val': 0.15293247985100625, 'psi': 0.9546497171355922}
[S11] START round=16 head_norm_before_train=1.446340 cos_to_last_merge=0.8642 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.864
[S11] round=16 local utility u=0.781718 metrics={'f1_val': 0.9585116872433386, 'auprc': 0.9983111664468783, 'loss_val': 0.22238790826372143, 'psi': 0.9744314789247546}-{'f1_val': 0.7019353166316534, 'auprc': 0.998618790762291, 'loss_val': 0.24728934821343931, 'psi': 0.8206087062839085}
[S13] START round=16 head_norm_before_train=0.875547 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6225127840739462, 'auprc': 0.638226454714184, 'loss_val': 0.7108019724750132, 'psi': 0.6287982523300413}-{'f1_val': 0.6472950806245139, 'auprc': 0.7175588941165587, 'loss_val': 0.5517391349597547, 'psi': 0.6754006060213318}
[S14] START round=16 head_norm_before_train=0.914994 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.6398261476392569, 'auprc': 0.9650102708705598, 'loss_val': 0.6449230837240502, 'psi': 0.7698997969317781}-{'f1_val': 0.6962685432785738, 'auprc': 0.9654663014265801, 'loss_val': 0.7052447799427335, 'psi': 0.8039476465377764}
[S15] START round=16 head_norm_before_train=1.925381 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.7771333862736125, 'auprc': 0.8989450881258911, 'loss_val': 0.4052452354229232, 'psi': 0.8258580670145239}-{'f1_val': 0.9010189726704102, 'auprc': 0.9897011148029671, 'loss_val': 0.1464066538266637, 'psi': 0.936491829523433}
[S16] START round=16 head_norm_before_train=1.120788 cos_to_last_merge=0.8046 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.805
[S16] round=16 local utility u=1.000000 metrics={'f1_val': 0.8221418592794726, 'auprc': 0.8444449895881844, 'loss_val': 0.6109423269132933, 'psi': 0.8310631114029573}-{'f1_val': 0.4416748331743482, 'auprc': 0.7565681975217757, 'loss_val': 0.7818314441759268, 'psi': 0.5676321789133192}
[S17] START round=16 head_norm_before_train=1.527712 cos_to_last_merge=0.8619 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.862
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.5787197938621822, 'auprc': 0.8403266244059076, 'loss_val': 0.8052101832492781, 'psi': 0.6833625260796723}-{'f1_val': 0.606423559472109, 'auprc': 0.9466324602348843, 'loss_val': 0.5789651893847214, 'psi': 0.7425071197772192}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39805
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:39803
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:39813
[S3] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S7
[S13] cosine check vs S7: cos=0.8145
[S14] RECEIVED delta(kind=head bytes=1802) from S3
[S14] cosine check vs S3: cos=0.9516
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=0.5100
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] cosine check vs S4: cos=0.3747
[S14] RECEIVED delta(kind=head bytes=1792) from S16
[S14] cosine check vs S16: cos=0.4558
[S3] RECEIVED delta(kind=head bytes=1792) from S5
[S3] cosine check vs S5: cos=0.9102
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=-0.0652
[S2] DROPPED delta from S11 (cos=-0.0652 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6225 head_norm=0.941639
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.757697e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6206 head_norm=0.850209 delta_norm=0.275770
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.6398 head_norm=0.949712
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.495685e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.6398 head_norm=0.896283 delta_norm=0.149569
[S14] aggregate: ACCEPT kept=['S3', 'S4', 'S16'] (k=3/3) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7006 head_norm=1.156650
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.436332e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7003 head_norm=1.115434 delta_norm=0.643633
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.7007 head_norm=1.158120
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.452538e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.7007 head_norm=1.131102 delta_norm=0.245254
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.872218 (no previous merge yet)
[S2] round=17 local utility u=0.212806 metrics={'f1_val': 0.6808017822075372, 'auprc': 0.744975397910892, 'loss_val': 0.7458360075206512, 'psi': 0.706471228488879}-{'f1_val': 0.6155516587980542, 'auprc': 0.7243289198703846, 'loss_val': 0.718006860032108, 'psi': 0.6590625632269864}
[S3] START round=17 head_norm_before_train=1.131102 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9985513504462911, 'loss_val': 0.3423232914726642, 'psi': 0.8197841416786398}-{'f1_val': 0.7006809596653347, 'auprc': 0.998772125545522, 'loss_val': 0.3402245683674123, 'psi': 0.8199174260174096}
[S4] START round=17 head_norm_before_train=1.613823 cos_to_last_merge=0.8297 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.830
[S4] round=17 local utility u=0.143995 metrics={'f1_val': 0.6474794871607719, 'auprc': 0.961148969294428, 'loss_val': 0.3731596435945415, 'psi': 0.7729472800142343}-{'f1_val': 0.6139579476905189, 'auprc': 0.9535182930070989, 'loss_val': 0.4371286873304881, 'psi': 0.7497820858171509}
[S5] START round=17 head_norm_before_train=1.115434 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.389708 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9973748513212948, 'loss_val': 0.44673545935152253, 'psi': 0.8191427309888661}-{'f1_val': 0.7006083926626743, 'auprc': 0.7637760717123714, 'loss_val': 0.5270776812570919, 'psi': 0.7258754642825531}
[S6] START round=17 head_norm_before_train=1.838371 cos_to_last_merge=0.9999 (last merge round=15)
[S6] round=17 local utility u=0.575774 metrics={'f1_val': 0.7815363574131882, 'auprc': 0.8153201862515558, 'loss_val': 0.5035050810012854, 'psi': 0.7950498889485351}-{'f1_val': 0.6213019719423292, 'auprc': 0.7940180990769728, 'loss_val': 0.6297409266422493, 'psi': 0.6903884227961867}
[S7] START round=17 head_norm_before_train=0.843282 cos_to_last_merge=0.9926 (last merge round=15)
[S7] round=17 local utility u=0.173772 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7151226010528133, 'loss_val': 0.9008256513434302, 'psi': 0.5360751112877393}-{'f1_val': 0.41671011811102343, 'auprc': 0.6351149021253378, 'loss_val': 1.0083456244202207, 'psi': 0.5040720317167492}
[S8] START round=17 head_norm_before_train=1.554043 cos_to_last_merge=0.9996 (last merge round=15)
[S8] round=17 local utility u=0.004241 metrics={'f1_val': 0.9929126860801906, 'auprc': 0.9850765106167512, 'loss_val': 0.10021467822046494, 'psi': 0.9897782158948147}-{'f1_val': 0.9929205408612032, 'auprc': 0.985551689398952, 'loss_val': 0.11016942620662408, 'psi': 0.9899730002763028}
[S9] START round=17 head_norm_before_train=1.530656 cos_to_last_merge=0.8243 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.824
[S9] round=17 local utility u=0.036825 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9965639513331156, 'loss_val': 0.052297240966312046, 'psi': 0.9966218876215811}-{'f1_val': 0.9875711251504857, 'auprc': 0.998809862662247, 'loss_val': 0.07814774666069982, 'psi': 0.9920666201551903}
[S10] START round=17 head_norm_before_train=1.406796 cos_to_last_merge=0.9972 (last merge round=15)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.9389032244857155, 'auprc': 0.9950940828206505, 'loss_val': 0.11502716660161924, 'psi': 0.9613795678196895}-{'f1_val': 0.9932214201180478, 'auprc': 0.9969104079582698, 'loss_val': 0.11607725653151951, 'psi': 0.9946970152541366}
[S11] START round=17 head_norm_before_train=1.486326 cos_to_last_merge=0.8568 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.857
[S11] round=17 local utility u=0.021181 metrics={'f1_val': 0.9597482787263583, 'auprc': 0.9981023077621699, 'loss_val': 0.18681916164638002, 'psi': 0.9750898903406828}-{'f1_val': 0.9585116872433386, 'auprc': 0.9983111664468783, 'loss_val': 0.22238790826372143, 'psi': 0.9744314789247546}
[S13] START round=17 head_norm_before_train=0.850209 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.119880 metrics={'f1_val': 0.6445930111960557, 'auprc': 0.6652539241966401, 'loss_val': 0.6846055294412494, 'psi': 0.6528573763962895}-{'f1_val': 0.6225127840739462, 'auprc': 0.638226454714184, 'loss_val': 0.7108019724750132, 'psi': 0.6287982523300413}
[S14] START round=17 head_norm_before_train=0.896283 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.132039 metrics={'f1_val': 0.6498020318401143, 'auprc': 0.9956106967678258, 'loss_val': 0.5325023603502345, 'psi': 0.7881254978111989}-{'f1_val': 0.6398261476392569, 'auprc': 0.9650102708705598, 'loss_val': 0.6449230837240502, 'psi': 0.7698997969317781}
[S15] START round=17 head_norm_before_train=1.948790 (no previous merge yet)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.7010704228661029, 'auprc': 0.797268392709736, 'loss_val': 0.7142423849004028, 'psi': 0.7395496108035562}-{'f1_val': 0.7771333862736125, 'auprc': 0.8989450881258911, 'loss_val': 0.4052452354229232, 'psi': 0.8258580670145239}
[S16] START round=17 head_norm_before_train=1.161195 cos_to_last_merge=0.7987 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.799
[S16] round=17 local utility u=0.218932 metrics={'f1_val': 0.8425561118469995, 'auprc': 0.9106587466026248, 'loss_val': 0.4942045524730527, 'psi': 0.8697971657492496}-{'f1_val': 0.8221418592794726, 'auprc': 0.8444449895881844, 'loss_val': 0.6109423269132933, 'psi': 0.8310631114029573}
[S17] START round=17 head_norm_before_train=1.571232 cos_to_last_merge=0.8596 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.860
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.5845084858188535, 'auprc': 0.8477864459283331, 'loss_val': 0.8875675919982621, 'psi': 0.6898196698626453}-{'f1_val': 0.5787197938621822, 'auprc': 0.8403266244059076, 'loss_val': 0.8052101832492781, 'psi': 0.6833625260796723}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39808
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:39805
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:39813
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:39808
[S6] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=-0.0684
[S2] DROPPED delta from S11 (cos=-0.0684 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1793) from S6
[S7] cosine check vs S6: cos=0.2467
[S7] RECEIVED delta(kind=head bytes=1804) from S9
[S7] cosine check vs S9: cos=0.7804
[S13] RECEIVED delta(kind=head bytes=1800) from S7
[S13] cosine check vs S7: cos=0.8828
[S7] RECEIVED delta(kind=head bytes=1796) from S14
[S7] cosine check vs S14: cos=0.6624
[S5] RECEIVED delta(kind=head bytes=1804) from S8
[S5] cosine check vs S8: cos=0.3727
[S10] RECEIVED delta(kind=head bytes=1794) from S13
[S10] cosine check vs S13: cos=0.8657
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=0.4513
[S3] RECEIVED delta(kind=head bytes=1794) from S5
[S3] cosine check vs S5: cos=0.8996
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=0.5241
[S6] RECEIVED delta(kind=head bytes=1793) from S2
[S6] cosine check vs S2: cos=0.9941
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9389 head_norm=1.485021
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.045818e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9442 head_norm=1.185543 delta_norm=0.404582
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.7006 head_norm=1.176919
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.607878e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.7006 head_norm=1.132330 delta_norm=0.260788
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.6498 head_norm=0.941294
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.803343e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9314 head_norm=0.887395 delta_norm=0.380334
[S14] aggregate: ACCEPT kept=['S4', 'S16'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.7815 head_norm=1.849388
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.022686e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.7840 head_norm=1.862813 delta_norm=0.102269
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.4167 head_norm=0.880232
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.723172e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.4167 head_norm=0.842326 delta_norm=0.172317
[S7] aggregate: ACCEPT kept=['S6', 'S9', 'S14'] (k=3/3) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.7003 head_norm=1.146832
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.895338e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7003 head_norm=1.142242 delta_norm=0.789534
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.6446 head_norm=0.965975
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.272541e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6325 head_norm=0.895720 delta_norm=0.227254
[S13] aggregate: ROLLBACK (f1_val pre=0.645 post=0.633 tol_abs=0.005 tol_rel=0.0)
[S2] START round=18 head_norm_before_train=1.881709 (no previous merge yet)
[S2] round=18 local utility u=0.016237 metrics={'f1_val': 0.6997325028600143, 'auprc': 0.7389196078948868, 'loss_val': 0.8087789328968874, 'psi': 0.7154073448739633}-{'f1_val': 0.6808017822075372, 'auprc': 0.744975397910892, 'loss_val': 0.7458360075206512, 'psi': 0.706471228488879}
[S3] START round=18 head_norm_before_train=1.132330 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.005832 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9989898655241567, 'loss_val': 0.3324250236922057, 'psi': 0.8200045220088635}-{'f1_val': 0.7006060025002057, 'auprc': 0.9985513504462911, 'loss_val': 0.3423232914726642, 'psi': 0.8197841416786398}
[S4] START round=18 head_norm_before_train=1.634076 cos_to_last_merge=0.8279 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.828
[S4] round=18 local utility u=0.779880 metrics={'f1_val': 0.9410519802086094, 'auprc': 0.9325569161612562, 'loss_val': 0.48905810740661376, 'psi': 0.937653954589668}-{'f1_val': 0.6474794871607719, 'auprc': 0.961148969294428, 'loss_val': 0.3731596435945415, 'psi': 0.7729472800142343}
[S5] START round=18 head_norm_before_train=1.142242 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9648345859775503, 'loss_val': 0.44735865809763875, 'psi': 0.8061261934858355}-{'f1_val': 0.7003213174339138, 'auprc': 0.9973748513212948, 'loss_val': 0.44673545935152253, 'psi': 0.8191427309888661}
[S6] START round=18 head_norm_before_train=1.862813 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.893971 metrics={'f1_val': 0.9618845112935436, 'auprc': 0.9560800539746914, 'loss_val': 0.21993152331979002, 'psi': 0.9595627283660026}-{'f1_val': 0.7815363574131882, 'auprc': 0.8153201862515558, 'loss_val': 0.5035050810012854, 'psi': 0.7950498889485351}
[S7] START round=18 head_norm_before_train=0.842326 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.059761 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7573218071158621, 'loss_val': 0.9079011842783992, 'psi': 0.5529547937129589}-{'f1_val': 0.41671011811102343, 'auprc': 0.7151226010528133, 'loss_val': 0.9008256513434302, 'psi': 0.5360751112877393}
[S8] START round=18 head_norm_before_train=1.594031 cos_to_last_merge=0.9983 (last merge round=15)
[S8] round=18 local utility u=0.016219 metrics={'f1_val': 0.9927488253329352, 'auprc': 0.9869335061058444, 'loss_val': 0.0723642822544984, 'psi': 0.9904226976420989}-{'f1_val': 0.9929126860801906, 'auprc': 0.9850765106167512, 'loss_val': 0.10021467822046494, 'psi': 0.9897782158948147}
[S9] START round=18 head_norm_before_train=1.566170 cos_to_last_merge=0.8191 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.819
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9988544394023825, 'loss_val': 0.04618337209245068, 'psi': 0.9959054033593613}-{'f1_val': 0.9966605118138915, 'auprc': 0.9965639513331156, 'loss_val': 0.052297240966312046, 'psi': 0.9966218876215811}
[S10] START round=18 head_norm_before_train=1.185543 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.164880 metrics={'f1_val': 0.9923018933750675, 'auprc': 0.9968168274135644, 'loss_val': 0.11082643723606832, 'psi': 0.9941078669904663}-{'f1_val': 0.9389032244857155, 'auprc': 0.9950940828206505, 'loss_val': 0.11502716660161924, 'psi': 0.9613795678196895}
[S11] START round=18 head_norm_before_train=1.515942 cos_to_last_merge=0.8520 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.852
[S11] round=18 local utility u=0.005523 metrics={'f1_val': 0.9577957292568001, 'auprc': 0.9984724274563601, 'loss_val': 0.1651675564712251, 'psi': 0.9740664085366242}-{'f1_val': 0.9597482787263583, 'auprc': 0.9981023077621699, 'loss_val': 0.18681916164638002, 'psi': 0.9750898903406828}
[S13] START round=18 head_norm_before_train=0.895720 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.6459587760210921, 'auprc': 0.6346440039178115, 'loss_val': 0.7042526663638591, 'psi': 0.6414328671797799}-{'f1_val': 0.6445930111960557, 'auprc': 0.6652539241966401, 'loss_val': 0.6846055294412494, 'psi': 0.6528573763962895}
[S14] START round=18 head_norm_before_train=0.887395 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=1.000000 metrics={'f1_val': 0.9911490853710234, 'auprc': 0.9973266114678501, 'loss_val': 0.5267342466538439, 'psi': 0.9936200958097541}-{'f1_val': 0.6498020318401143, 'auprc': 0.9956106967678258, 'loss_val': 0.5325023603502345, 'psi': 0.7881254978111989}
[S15] START round=18 head_norm_before_train=1.970018 (no previous merge yet)
[S15] round=18 local utility u=0.794629 metrics={'f1_val': 0.8175589450317481, 'auprc': 0.9578952956837095, 'loss_val': 0.3057967916361844, 'psi': 0.8736934852925327}-{'f1_val': 0.7010704228661029, 'auprc': 0.797268392709736, 'loss_val': 0.7142423849004028, 'psi': 0.7395496108035562}
[S16] START round=18 head_norm_before_train=1.198715 cos_to_last_merge=0.7935 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.794
[S16] round=18 local utility u=0.080935 metrics={'f1_val': 0.8450559455184642, 'auprc': 0.9580667721931952, 'loss_val': 0.4895575912610073, 'psi': 0.8902602761883567}-{'f1_val': 0.8425561118469995, 'auprc': 0.9106587466026248, 'loss_val': 0.4942045524730527, 'psi': 0.8697971657492496}
[S17] START round=18 head_norm_before_train=1.604378 cos_to_last_merge=0.8577 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.858
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.5991630397825518, 'auprc': 0.8220851134523676, 'loss_val': 0.9373742646374159, 'psi': 0.6883318692504781}-{'f1_val': 0.5845084858188535, 'auprc': 0.8477864459283331, 'loss_val': 0.8875675919982621, 'psi': 0.6898196698626453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39808
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=-0.0708
[S2] DROPPED delta from S11 (cos=-0.0708 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=0.3431
[S7] RECEIVED delta(kind=head bytes=1796) from S14
[S7] cosine check vs S14: cos=0.6033
[S5] RECEIVED delta(kind=head bytes=1790) from S10
[S5] cosine check vs S10: cos=0.4541
[S5] RECEIVED delta(kind=head bytes=1794) from S8
[S5] cosine check vs S8: cos=0.8751
[S13] RECEIVED delta(kind=head bytes=1796) from S7
[S13] cosine check vs S7: cos=0.9234
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.2166
[S14] RECEIVED delta(kind=head bytes=1790) from S16
[S14] cosine check vs S16: cos=0.5912
[S14] RECEIVED delta(kind=head bytes=1795) from S4
[S14] cosine check vs S4: cos=0.6689
[S14] RECEIVED delta(kind=head bytes=1796) from S3
[S14] cosine check vs S3: cos=0.6697
[S6] RECEIVED delta(kind=head bytes=1796) from S2
[S6] cosine check vs S2: cos=0.9977
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7003 head_norm=1.177355
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.439748e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7006 head_norm=1.098780 delta_norm=0.143975
[S5] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.6460 head_norm=1.014718
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.974794e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.6511 head_norm=0.925269 delta_norm=0.197479
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9911 head_norm=0.937708
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.370356e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9923 head_norm=0.883921 delta_norm=0.237036
[S14] aggregate: ACCEPT kept=['S15', 'S16', 'S4', 'S3'] (k=4/4) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.9619 head_norm=1.872915
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.438421e-02
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.9619 head_norm=1.879648 delta_norm=0.064384
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.4167 head_norm=0.872118
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.372682e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.4167 head_norm=0.847407 delta_norm=0.437268
[S7] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.888553 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.6386900306984635, 'auprc': 0.7382732903791784, 'loss_val': 1.249459987447359, 'psi': 0.6785233345707495}-{'f1_val': 0.6997325028600143, 'auprc': 0.7389196078948868, 'loss_val': 0.8087789328968874, 'psi': 0.7154073448739633}
[S3] START round=19 head_norm_before_train=1.176785 cos_to_last_merge=0.9986 (last merge round=17)
[S3] round=19 local utility u=0.023989 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.998867507522462, 'loss_val': 0.2836294352880594, 'psi': 0.8199106045091082}-{'f1_val': 0.7006809596653347, 'auprc': 0.9989898655241567, 'loss_val': 0.3324250236922057, 'psi': 0.8200045220088635}
[S4] START round=19 head_norm_before_train=1.651033 cos_to_last_merge=0.8267 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.827
[S4] round=19 local utility u=0.119342 metrics={'f1_val': 0.9492623943779863, 'auprc': 0.9547653381206092, 'loss_val': 0.3662626465500726, 'psi': 0.9514635718750355}-{'f1_val': 0.9410519802086094, 'auprc': 0.9325569161612562, 'loss_val': 0.48905810740661376, 'psi': 0.937653954589668}
[S5] START round=19 head_norm_before_train=1.098780 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.6747090096515065, 'auprc': 0.7797221351911444, 'loss_val': 0.5740551028549482, 'psi': 0.7167142598673617}-{'f1_val': 0.700320598491359, 'auprc': 0.9648345859775503, 'loss_val': 0.44735865809763875, 'psi': 0.8061261934858355}
[S6] START round=19 head_norm_before_train=1.879648 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.8262885162463185, 'auprc': 0.9650660379242993, 'loss_val': 0.4278746667175139, 'psi': 0.8817995249175108}-{'f1_val': 0.9618845112935436, 'auprc': 0.9560800539746914, 'loss_val': 0.21993152331979002, 'psi': 0.9595627283660026}
[S7] START round=19 head_norm_before_train=0.847407 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.046649 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7560998102572437, 'loss_val': 0.810937114692729, 'psi': 0.5524659949695115}-{'f1_val': 0.41671011811102343, 'auprc': 0.7573218071158621, 'loss_val': 0.9079011842783992, 'psi': 0.5529547937129589}
[S8] START round=19 head_norm_before_train=1.643909 cos_to_last_merge=0.9960 (last merge round=15)
[S8] round=19 local utility u=0.013643 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9931415697210848, 'loss_val': 0.06025464916818828, 'psi': 0.992561172106501}-{'f1_val': 0.9927488253329352, 'auprc': 0.9869335061058444, 'loss_val': 0.0723642822544984, 'psi': 0.9904226976420989}
[S9] START round=19 head_norm_before_train=1.597915 cos_to_last_merge=0.8150 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.815
[S9] round=19 local utility u=0.012709 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9983580818456987, 'loss_val': 0.03825652422837595, 'psi': 0.9976049802455652}-{'f1_val': 0.9939393793306803, 'auprc': 0.9988544394023825, 'loss_val': 0.04618337209245068, 'psi': 0.9959054033593613}
[S10] START round=19 head_norm_before_train=1.270654 cos_to_last_merge=0.9983 (last merge round=17)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9852190134088148, 'auprc': 0.996162557256471, 'loss_val': 0.09336575877083401, 'psi': 0.9895964309478773}-{'f1_val': 0.9923018933750675, 'auprc': 0.9968168274135644, 'loss_val': 0.11082643723606832, 'psi': 0.9941078669904663}
[S11] START round=19 head_norm_before_train=1.542806 cos_to_last_merge=0.8492 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.849
[S11] round=19 local utility u=0.134037 metrics={'f1_val': 0.9973550136825626, 'auprc': 0.9981568978385587, 'loss_val': 0.1335017734734698, 'psi': 0.997675767344961}-{'f1_val': 0.9577957292568001, 'auprc': 0.9984724274563601, 'loss_val': 0.1651675564712251, 'psi': 0.9740664085366242}
[S13] START round=19 head_norm_before_train=0.925269 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6361094731616265, 'auprc': 0.6538494066380387, 'loss_val': 0.714530227385962, 'psi': 0.6432054465521914}-{'f1_val': 0.6459587760210921, 'auprc': 0.6346440039178115, 'loss_val': 0.7042526663638591, 'psi': 0.6414328671797799}
[S14] START round=19 head_norm_before_train=0.883921 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.066042 metrics={'f1_val': 0.9978645182087221, 'auprc': 0.9970840324488215, 'loss_val': 0.4342156376022998, 'psi': 0.9975523239047619}-{'f1_val': 0.9911490853710234, 'auprc': 0.9973266114678501, 'loss_val': 0.5267342466538439, 'psi': 0.9936200958097541}
[S15] START round=19 head_norm_before_train=1.988601 (no previous merge yet)
[S15] round=19 local utility u=0.647007 metrics={'f1_val': 0.975299871508247, 'auprc': 0.9938929223845212, 'loss_val': 0.06622084394717624, 'psi': 0.9827370918587568}-{'f1_val': 0.8175589450317481, 'auprc': 0.9578952956837095, 'loss_val': 0.3057967916361844, 'psi': 0.8736934852925327}
[S16] START round=19 head_norm_before_train=1.234702 cos_to_last_merge=0.7891 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.789
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8374283947165354, 'auprc': 0.9319884917122145, 'loss_val': 0.3747679848039872, 'psi': 0.8752524335148071}-{'f1_val': 0.8450559455184642, 'auprc': 0.9580667721931952, 'loss_val': 0.4895575912610073, 'psi': 0.8902602761883567}
[S17] START round=19 head_norm_before_train=1.634929 cos_to_last_merge=0.8561 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.856
[S17] round=19 local utility u=0.224601 metrics={'f1_val': 0.6024845393254897, 'auprc': 0.9299979661157338, 'loss_val': 0.8318388523073649, 'psi': 0.7334899100415874}-{'f1_val': 0.5991630397825518, 'auprc': 0.8220851134523676, 'loss_val': 0.9373742646374159, 'psi': 0.6883318692504781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:39814
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:39813
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S9
[S7] cosine check vs S9: cos=0.4266
[S7] RECEIVED delta(kind=head bytes=1793) from S14
[S7] cosine check vs S14: cos=0.5602
[S5] RECEIVED delta(kind=head bytes=1805) from S8
[S5] cosine check vs S8: cos=0.8297
[S13] RECEIVED delta(kind=head bytes=1793) from S7
[S13] cosine check vs S7: cos=0.7826
[S14] RECEIVED delta(kind=head bytes=1794) from S3
[S14] cosine check vs S3: cos=0.7812
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=0.4059
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=0.5761
[S2] RECEIVED delta(kind=head bytes=1804) from S11
[S2] cosine check vs S11: cos=-0.0739
[S2] DROPPED delta from S11 (cos=-0.0739 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] cosine check vs S17: cos=0.9603
[S2] r=20 psi=0.679 u=0.0000 p_local=0.0780 f1=0.639 auprc=0.738 bytes=16180
[S6] r=20 psi=0.882 u=0.0000 p_local=0.3631 f1=0.826 auprc=0.965 bytes=19790
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.6361 head_norm=1.016340
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.192248e-01
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.6383 head_norm=0.895635 delta_norm=0.319225
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.643 u=0.0000 p_local=0.0681 f1=0.636 auprc=0.654 bytes=21563
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.6747 head_norm=1.132424
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.919080e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.6671 head_norm=1.353983 delta_norm=0.491908
[S5] aggregate: ROLLBACK (f1_val pre=0.675 post=0.667 tol_abs=0.005 tol_rel=0.0)
[S5] r=20 psi=0.717 u=0.0000 p_local=0.1681 f1=0.675 auprc=0.780 bytes=19746
[S10] r=20 psi=0.990 u=0.0000 p_local=0.1105 f1=0.985 auprc=0.996 bytes=23360
[S16] r=20 psi=0.875 u=0.0000 p_local=0.1898 f1=0.837 auprc=0.932 bytes=23331
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.4167 head_norm=0.880446
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.396171e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.4167 head_norm=0.854054 delta_norm=0.439617
[S7] aggregate: ACCEPT kept=['S9', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] r=20 psi=0.552 u=0.0466 p_local=0.0958 f1=0.417 auprc=0.756 bytes=25145
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9979 head_norm=0.936211
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.624033e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9979 head_norm=0.965968 delta_norm=0.262403
[S14] aggregate: ACCEPT kept=['S3', 'S15', 'S4'] (k=3/3) mode=median trim_p=0.1
[S14] r=20 psi=0.998 u=0.0660 p_local=0.3126 f1=0.998 auprc=0.997 bytes=28751
[S9] r=20 psi=0.998 u=0.0127 p_local=0.1118 f1=0.997 auprc=0.998 bytes=27030
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9922 head_norm=1.693547
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.369700e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9922 head_norm=1.660614 delta_norm=0.236970
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.993 u=0.0136 p_local=0.1488 f1=0.992 auprc=0.993 bytes=23374
[S4] r=20 psi=0.951 u=0.1193 p_local=0.2082 f1=0.949 auprc=0.955 bytes=26992
[S11] r=20 psi=0.998 u=0.1340 p_local=0.1918 f1=0.997 auprc=0.998 bytes=28746
[S15] r=20 psi=0.983 u=0.6470 p_local=0.3754 f1=0.975 auprc=0.994 bytes=21574
[S3] r=20 psi=0.820 u=0.0240 p_local=0.0971 f1=0.701 auprc=0.999 bytes=26936
[S17] r=20 psi=0.733 u=0.2246 p_local=0.1510 f1=0.602 auprc=0.930 bytes=16190
[S2] START round=20 head_norm_before_train=1.897809 (no previous merge yet)
[S2] round=20 local utility u=0.360331 metrics={'f1_val': 0.7132753803544408, 'auprc': 0.7361911748742915, 'loss_val': 0.9700637049511074, 'psi': 0.7224416981623811}-{'f1_val': 0.6386900306984635, 'auprc': 0.7382732903791784, 'loss_val': 1.249459987447359, 'psi': 0.6785233345707495}
[S3] START round=20 head_norm_before_train=1.220809 cos_to_last_merge=0.9953 (last merge round=17)
[S3] round=20 local utility u=0.814991 metrics={'f1_val': 0.9619616648309319, 'auprc': 0.9988759184058358, 'loss_val': 0.2218070474772163, 'psi': 0.9767273662608935}-{'f1_val': 0.7006060025002057, 'auprc': 0.998867507522462, 'loss_val': 0.2836294352880594, 'psi': 0.8199106045091082}
[S4] START round=20 head_norm_before_train=1.662102 cos_to_last_merge=0.8261 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.826
[S4] round=20 local utility u=0.076072 metrics={'f1_val': 0.9607760639233931, 'auprc': 0.9569469513476169, 'loss_val': 0.2897458265717875, 'psi': 0.9592444188930827}-{'f1_val': 0.9492623943779863, 'auprc': 0.9547653381206092, 'loss_val': 0.3662626465500726, 'psi': 0.9514635718750355}
[S5] START round=20 head_norm_before_train=1.353983 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.504620 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9966517408632093, 'loss_val': 0.3692771577512318, 'psi': 0.818853486805632}-{'f1_val': 0.6747090096515065, 'auprc': 0.7797221351911444, 'loss_val': 0.5740551028549482, 'psi': 0.7167142598673617}
[S6] START round=20 head_norm_before_train=1.900074 cos_to_last_merge=0.9997 (last merge round=18)
[S6] round=20 local utility u=0.545188 metrics={'f1_val': 0.965890585531127, 'auprc': 0.959859431220227, 'loss_val': 0.1594916858372286, 'psi': 0.9634781238067671}-{'f1_val': 0.8262885162463185, 'auprc': 0.9650660379242993, 'loss_val': 0.4278746667175139, 'psi': 0.8817995249175108}
[S7] START round=20 head_norm_before_train=0.854054 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.685843 metrics={'f1_val': 0.6578236155129276, 'auprc': 0.7658657233826133, 'loss_val': 0.915228843228521, 'psi': 0.7010404586608019}-{'f1_val': 0.41671011811102343, 'auprc': 0.7560998102572437, 'loss_val': 0.810937114692729, 'psi': 0.5524659949695115}
[S8] START round=20 head_norm_before_train=1.660614 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9923652907733383, 'auprc': 0.9857582313413958, 'loss_val': 0.06772708328037855, 'psi': 0.9897224670005613}-{'f1_val': 0.992174240363445, 'auprc': 0.9931415697210848, 'loss_val': 0.06025464916818828, 'psi': 0.992561172106501}
[S9] START round=20 head_norm_before_train=1.625576 cos_to_last_merge=0.8119 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.812
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9947734239942433, 'auprc': 0.9988378243586321, 'loss_val': 0.03633890010166013, 'psi': 0.9963991841399988}-{'f1_val': 0.9971029125121428, 'auprc': 0.9983580818456987, 'loss_val': 0.03825652422837595, 'psi': 0.9976049802455652}
[S10] START round=20 head_norm_before_train=1.355981 cos_to_last_merge=0.9944 (last merge round=17)
[S10] round=20 local utility u=0.027715 metrics={'f1_val': 0.9911320303647527, 'auprc': 0.9961248049504057, 'loss_val': 0.07330005792487242, 'psi': 0.9931291401990139}-{'f1_val': 0.9852190134088148, 'auprc': 0.996162557256471, 'loss_val': 0.09336575877083401, 'psi': 0.9895964309478773}
[S11] START round=20 head_norm_before_train=1.569680 cos_to_last_merge=0.8473 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.847
[S11] round=20 local utility u=0.012644 metrics={'f1_val': 0.9969406902828911, 'auprc': 0.9980285273223056, 'loss_val': 0.10534217275896436, 'psi': 0.9973758250986569}-{'f1_val': 0.9973550136825626, 'auprc': 0.9981568978385587, 'loss_val': 0.1335017734734698, 'psi': 0.997675767344961}
[S13] START round=20 head_norm_before_train=0.895635 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.228934 metrics={'f1_val': 0.6788620670891827, 'auprc': 0.7120610888008602, 'loss_val': 0.6878126654270247, 'psi': 0.6921416757738537}-{'f1_val': 0.6361094731616265, 'auprc': 0.6538494066380387, 'loss_val': 0.714530227385962, 'psi': 0.6432054465521914}
[S14] START round=20 head_norm_before_train=0.965968 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9832974486768536, 'auprc': 0.9923700343311607, 'loss_val': 0.4633112866396335, 'psi': 0.9869264829385764}-{'f1_val': 0.9978645182087221, 'auprc': 0.9970840324488215, 'loss_val': 0.4342156376022998, 'psi': 0.9975523239047619}
[S15] START round=20 head_norm_before_train=2.009593 (no previous merge yet)
[S15] round=20 local utility u=0.078663 metrics={'f1_val': 0.9962053994161175, 'auprc': 0.9960720772034591, 'loss_val': 0.04086628684493403, 'psi': 0.9961520705310541}-{'f1_val': 0.975299871508247, 'auprc': 0.9938929223845212, 'loss_val': 0.06622084394717624, 'psi': 0.9827370918587568}
[S16] START round=20 head_norm_before_train=1.270155 cos_to_last_merge=0.7854 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.785
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8315046488707256, 'auprc': 0.9761187921016429, 'loss_val': 0.6049555547211577, 'psi': 0.8893503061630925}-{'f1_val': 0.8374283947165354, 'auprc': 0.9319884917122145, 'loss_val': 0.3747679848039872, 'psi': 0.8752524335148071}
[S17] START round=20 head_norm_before_train=1.661170 cos_to_last_merge=0.8543 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.854
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.5936680549948173, 'auprc': 0.896436572197802, 'loss_val': 0.900505135976184, 'psi': 0.7147754618760112}-{'f1_val': 0.6024845393254897, 'auprc': 0.9299979661157338, 'loss_val': 0.8318388523073649, 'psi': 0.7334899100415874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:39812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39808
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:39814
[S7] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1806) from S3
[S14] cosine check vs S3: cos=0.8317
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=0.5734
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=0.5504
[S11] RECEIVED delta(kind=head bytes=1798) from S2
[S11] cosine check vs S2: cos=-0.0765
[S11] DROPPED delta from S2 (cos=-0.0765 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S7
[S13] cosine check vs S7: cos=0.9501
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.2283
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] cosine check vs S6: cos=0.3611
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] cosine check vs S13: cos=0.8106
[S3] RECEIVED delta(kind=head bytes=1792) from S5
[S3] cosine check vs S5: cos=0.7086
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=-0.0765
[S2] DROPPED delta from S11 (cos=-0.0765 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9833 head_norm=1.007931
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.474768e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9778 head_norm=1.036430 delta_norm=0.147477
[S14] aggregate: ROLLBACK (f1_val pre=0.983 post=0.978 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.250 → S15@127.0.0.1:39815
[S8] ⇄ pheromone p=0.119 → S17@127.0.0.1:39817
[S15] ⇄ pheromone p=0.316 → S17@127.0.0.1:39817
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.9620 head_norm=1.262684
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.066675e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.9982 head_norm=1.220298 delta_norm=0.506667
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.241 → S5@127.0.0.1:39805
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.6789 head_norm=0.960576
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.507918e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.7164 head_norm=0.907595 delta_norm=0.150792
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.100 → S7@127.0.0.1:39808
[S6] ⇄ pheromone p=0.399 → S2@127.0.0.1:39802
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.6578 head_norm=0.877627
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.033017e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.4167 head_norm=1.194473 delta_norm=0.903302
[S7] aggregate: ROLLBACK (f1_val pre=0.658 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.214 → S6@127.0.0.1:39807
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9911 head_norm=1.425840
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.287489e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9932 head_norm=1.137558 delta_norm=0.428749
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.094 → S13@127.0.0.1:39813
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.7003 head_norm=1.377427
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.708730e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.7003 head_norm=1.098519 delta_norm=0.870873
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.235 → S8@127.0.0.1:39809
[S2] ⇄ pheromone p=0.134 → S11@127.0.0.1:39812
[S17] ⇄ pheromone p=0.121 → S15@127.0.0.1:39815
[S2] START round=21 head_norm_before_train=1.906664 (no previous merge yet)
[S2] round=21 local utility u=0.011547 metrics={'f1_val': 0.7134685063742445, 'auprc': 0.7324059966798994, 'loss_val': 0.9367720920341636, 'psi': 0.7210435024965065}-{'f1_val': 0.7132753803544408, 'auprc': 0.7361911748742915, 'loss_val': 0.9700637049511074, 'psi': 0.7224416981623811}
[S3] START round=21 head_norm_before_train=1.220298 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.9629642435515284, 'auprc': 0.9996253337367124, 'loss_val': 0.2602853806842813, 'psi': 0.977628679625602}-{'f1_val': 0.9619616648309319, 'auprc': 0.9988759184058358, 'loss_val': 0.2218070474772163, 'psi': 0.9767273662608935}
[S4] START round=21 head_norm_before_train=1.685323 cos_to_last_merge=0.8244 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.824
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9501606784390562, 'auprc': 0.9464893749485053, 'loss_val': 0.3322141466853, 'psi': 0.9486921570428358}-{'f1_val': 0.9607760639233931, 'auprc': 0.9569469513476169, 'loss_val': 0.2897458265717875, 'psi': 0.9592444188930827}
[S5] START round=21 head_norm_before_train=1.098519 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.5758967377788755, 'auprc': 0.7729087706398151, 'loss_val': 0.7894072854886742, 'psi': 0.6547015509232514}-{'f1_val': 0.7003213174339138, 'auprc': 0.9966517408632093, 'loss_val': 0.3692771577512318, 'psi': 0.818853486805632}
[S6] START round=21 head_norm_before_train=1.927488 cos_to_last_merge=0.9987 (last merge round=18)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.5857924861389232, 'auprc': 0.8492744393138608, 'loss_val': 0.5762258591392261, 'psi': 0.6911852674088983}-{'f1_val': 0.965890585531127, 'auprc': 0.959859431220227, 'loss_val': 0.1594916858372286, 'psi': 0.9634781238067671}
[S7] START round=21 head_norm_before_train=1.194473 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.039077 metrics={'f1_val': 0.6482837103411506, 'auprc': 0.7750706146402261, 'loss_val': 0.8074498877059301, 'psi': 0.6989984720607808}-{'f1_val': 0.6578236155129276, 'auprc': 0.7658657233826133, 'loss_val': 0.915228843228521, 'psi': 0.7010404586608019}
[S8] START round=21 head_norm_before_train=1.700877 cos_to_last_merge=0.9996 (last merge round=19)
[S8] round=21 local utility u=0.004642 metrics={'f1_val': 0.9923652907733383, 'auprc': 0.9855320747348417, 'loss_val': 0.0577642623593619, 'psi': 0.9896320043579396}-{'f1_val': 0.9923652907733383, 'auprc': 0.9857582313413958, 'loss_val': 0.06772708328037855, 'psi': 0.9897224670005613}
[S9] START round=21 head_norm_before_train=1.648791 cos_to_last_merge=0.8095 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.810
[S9] round=21 local utility u=0.006072 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9988300039931131, 'loss_val': 0.031655107109472655, 'psi': 0.9971444227835575}-{'f1_val': 0.9947734239942433, 'auprc': 0.9988378243586321, 'loss_val': 0.03633890010166013, 'psi': 0.9963991841399988}
[S10] START round=21 head_norm_before_train=1.137558 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.994060293859904, 'auprc': 0.9965475946374766, 'loss_val': 0.10058555104422419, 'psi': 0.995055214170933}-{'f1_val': 0.9911320303647527, 'auprc': 0.9961248049504057, 'loss_val': 0.07330005792487242, 'psi': 0.9931291401990139}
[S11] START round=21 head_norm_before_train=1.595514 cos_to_last_merge=0.8460 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.846
[S11] round=21 local utility u=0.011727 metrics={'f1_val': 0.9969406902828911, 'auprc': 0.9983728842575068, 'loss_val': 0.08292088263082703, 'psi': 0.9975135678727374}-{'f1_val': 0.9969406902828911, 'auprc': 0.9980285273223056, 'loss_val': 0.10534217275896436, 'psi': 0.9973758250986569}
[S13] START round=21 head_norm_before_train=0.907595 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6373616307523156, 'auprc': 0.6278245326660808, 'loss_val': 0.7494630305768241, 'psi': 0.6335467915178217}-{'f1_val': 0.6788620670891827, 'auprc': 0.7120610888008602, 'loss_val': 0.6878126654270247, 'psi': 0.6921416757738537}
[S14] START round=21 head_norm_before_train=1.036430 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.090932 metrics={'f1_val': 0.9950164976407472, 'auprc': 0.9992170606546038, 'loss_val': 0.3723019508799317, 'psi': 0.9966967228462899}-{'f1_val': 0.9832974486768536, 'auprc': 0.9923700343311607, 'loss_val': 0.4633112866396335, 'psi': 0.9869264829385764}
[S15] START round=21 head_norm_before_train=2.026962 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7655710414543088, 'auprc': 0.851837376689921, 'loss_val': 0.5635028035449337, 'psi': 0.8000775755485536}-{'f1_val': 0.9962053994161175, 'auprc': 0.9960720772034591, 'loss_val': 0.04086628684493403, 'psi': 0.9961520705310541}
[S16] START round=21 head_norm_before_train=1.305993 cos_to_last_merge=0.7820 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.782
[S16] round=21 local utility u=0.653988 metrics={'f1_val': 0.9695426588813005, 'auprc': 0.9897541669717962, 'loss_val': 0.16611293761240659, 'psi': 0.9776272621174988}-{'f1_val': 0.8315046488707256, 'auprc': 0.9761187921016429, 'loss_val': 0.6049555547211577, 'psi': 0.8893503061630925}
[S17] START round=21 head_norm_before_train=1.687364 cos_to_last_merge=0.8526 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.853
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.5887425387529425, 'auprc': 0.8267733279496055, 'loss_val': 1.0495843712725534, 'psi': 0.6839548544316076}-{'f1_val': 0.5936680549948173, 'auprc': 0.896436572197802, 'loss_val': 0.900505135976184, 'psi': 0.7147754618760112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:39817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:39802
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39807
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39815
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.6029
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] cosine check vs S7: cos=0.9347
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] cosine check vs S2: cos=0.9943
[S2] RECEIVED delta(kind=head bytes=1801) from S11
[S2] cosine check vs S11: cos=-0.0800
[S2] DROPPED delta from S11 (cos=-0.0800 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9809
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.7656 head_norm=2.037736
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.164027e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.7519 head_norm=1.410432 delta_norm=0.816403
[S15] aggregate: ROLLBACK (f1_val pre=0.766 post=0.752 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.5858 head_norm=1.950986
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.460385e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.5898 head_norm=1.739636 delta_norm=0.246039
[S6] aggregate: ACCEPT kept=['S7', 'S2'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.5887 head_norm=1.711221
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.696900e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.5890 head_norm=1.719536 delta_norm=0.169690
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.913128 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.6799751486064326, 'auprc': 0.7314823895690843, 'loss_val': 1.060731957836523, 'psi': 0.7005780449914933}-{'f1_val': 0.7134685063742445, 'auprc': 0.7324059966798994, 'loss_val': 0.9367720920341636, 'psi': 0.7210435024965065}
[S3] START round=22 head_norm_before_train=1.258590 cos_to_last_merge=0.9991 (last merge round=20)
[S3] round=22 local utility u=0.026516 metrics={'f1_val': 0.9629642435515284, 'auprc': 0.9995823116977531, 'loss_val': 0.20712374902827108, 'psi': 0.9776114708100183}-{'f1_val': 0.9629642435515284, 'auprc': 0.9996253337367124, 'loss_val': 0.2602853806842813, 'psi': 0.977628679625602}
[S4] START round=22 head_norm_before_train=1.711298 cos_to_last_merge=0.8221 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.822
[S4] round=22 local utility u=0.045729 metrics={'f1_val': 0.9509879937147745, 'auprc': 0.9601046536352212, 'loss_val': 0.28656671812428697, 'psi': 0.9546346576829532}-{'f1_val': 0.9501606784390562, 'auprc': 0.9464893749485053, 'loss_val': 0.3322141466853, 'psi': 0.9486921570428358}
[S5] START round=22 head_norm_before_train=1.128691 cos_to_last_merge=0.9993 (last merge round=20)
[S5] round=22 local utility u=0.923805 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9975222520248788, 'loss_val': 0.3621847011567022, 'psi': 0.8192016912702997}-{'f1_val': 0.5758967377788755, 'auprc': 0.7729087706398151, 'loss_val': 0.7894072854886742, 'psi': 0.6547015509232514}
[S6] START round=22 head_norm_before_train=1.739636 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.994332 metrics={'f1_val': 0.8244744837870306, 'auprc': 0.9663705035611011, 'loss_val': 0.3709427637412945, 'psi': 0.8812328916966587}-{'f1_val': 0.5857924861389232, 'auprc': 0.8492744393138608, 'loss_val': 0.5762258591392261, 'psi': 0.6911852674088983}
[S7] START round=22 head_norm_before_train=1.217658 cos_to_last_merge=0.9990 (last merge round=20)
[S7] round=22 local utility u=0.146642 metrics={'f1_val': 0.6699321367666492, 'auprc': 0.7797161926201196, 'loss_val': 0.6579923154186045, 'psi': 0.7138457591080374}-{'f1_val': 0.6482837103411506, 'auprc': 0.7750706146402261, 'loss_val': 0.8074498877059301, 'psi': 0.6989984720607808}
[S8] START round=22 head_norm_before_train=1.744396 cos_to_last_merge=0.9985 (last merge round=19)
[S8] round=22 local utility u=0.021372 metrics={'f1_val': 0.9918008107316822, 'auprc': 0.9984364351094372, 'loss_val': 0.050346349096087685, 'psi': 0.9944550604827842}-{'f1_val': 0.9923652907733383, 'auprc': 0.9855320747348417, 'loss_val': 0.0577642623593619, 'psi': 0.9896320043579396}
[S9] START round=22 head_norm_before_train=1.669641 cos_to_last_merge=0.8076 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.808
[S9] round=22 local utility u=0.000389 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9964683903397467, 'loss_val': 0.030285849048180234, 'psi': 0.9968491036431844}-{'f1_val': 0.9960207019771873, 'auprc': 0.9988300039931131, 'loss_val': 0.031655107109472655, 'psi': 0.9971444227835575}
[S10] START round=22 head_norm_before_train=1.218757 cos_to_last_merge=0.9986 (last merge round=20)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9911320303647527, 'auprc': 0.9953260757540191, 'loss_val': 0.0869920950007649, 'psi': 0.9928096485204593}-{'f1_val': 0.994060293859904, 'auprc': 0.9965475946374766, 'loss_val': 0.10058555104422419, 'psi': 0.995055214170933}
[S11] START round=22 head_norm_before_train=1.625607 cos_to_last_merge=0.8445 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.844
[S11] round=22 local utility u=0.008914 metrics={'f1_val': 0.9969406902828911, 'auprc': 0.9983038812453647, 'loss_val': 0.06488513239627271, 'psi': 0.9974859666678806}-{'f1_val': 0.9969406902828911, 'auprc': 0.9983728842575068, 'loss_val': 0.08292088263082703, 'psi': 0.9975135678727374}
[S13] START round=22 head_norm_before_train=0.968768 cos_to_last_merge=0.9959 (last merge round=20)
[S13] round=22 local utility u=0.211339 metrics={'f1_val': 0.667887604788778, 'auprc': 0.6767976644370457, 'loss_val': 0.6568594870065882, 'psi': 0.671451628648085}-{'f1_val': 0.6373616307523156, 'auprc': 0.6278245326660808, 'loss_val': 0.7494630305768241, 'psi': 0.6335467915178217}
[S14] START round=22 head_norm_before_train=1.076705 cos_to_last_merge=0.9981 (last merge round=20)
[S14] round=22 local utility u=0.022788 metrics={'f1_val': 0.993305053346471, 'auprc': 0.9959280794558539, 'loss_val': 0.3065909402026837, 'psi': 0.9943542637902242}-{'f1_val': 0.9950164976407472, 'auprc': 0.9992170606546038, 'loss_val': 0.3723019508799317, 'psi': 0.9966967228462899}
[S15] START round=22 head_norm_before_train=1.410432 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.7991126494791833, 'loss_val': 0.6035982108277054, 'psi': 0.7401952460934474}-{'f1_val': 0.7655710414543088, 'auprc': 0.851837376689921, 'loss_val': 0.5635028035449337, 'psi': 0.8000775755485536}
[S16] START round=22 head_norm_before_train=1.340472 cos_to_last_merge=0.7787 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.779
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.90706925550989, 'auprc': 0.9949365019618848, 'loss_val': 0.34573286769071376, 'psi': 0.9422161540906879}-{'f1_val': 0.9695426588813005, 'auprc': 0.9897541669717962, 'loss_val': 0.16611293761240659, 'psi': 0.9776272621174988}
[S17] START round=22 head_norm_before_train=1.719536 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.838534 metrics={'f1_val': 0.709038029542487, 'auprc': 0.9985685107778469, 'loss_val': 0.6096740041873046, 'psi': 0.8248502220366309}-{'f1_val': 0.5887425387529425, 'auprc': 0.8267733279496055, 'loss_val': 1.0495843712725534, 'psi': 0.6839548544316076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39802
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39817
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S14
[S15] cosine check vs S14: cos=0.8053
[S7] RECEIVED delta(kind=head bytes=1791) from S13
[S7] cosine check vs S13: cos=0.6506
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=-0.0825
[S2] DROPPED delta from S11 (cos=-0.0825 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] cosine check vs S6: cos=0.9485
[S6] RECEIVED delta(kind=head bytes=1803) from S7
[S6] cosine check vs S7: cos=0.9485
[S5] RECEIVED delta(kind=head bytes=1801) from S3
[S5] cosine check vs S3: cos=0.9318
[S8] RECEIVED delta(kind=head bytes=1795) from S5
[S8] cosine check vs S5: cos=0.5876
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.9930
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39815
[S17] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S17
[S15] cosine check vs S17: cos=0.6233
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.7009 head_norm=1.443065
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.730602e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.7011 head_norm=1.285778 delta_norm=0.473060
[S15] aggregate: ACCEPT kept=['S14', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9918 head_norm=1.782449
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.230919e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9918 head_norm=1.315498 delta_norm=0.723092
[S8] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7003 head_norm=1.153112
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.377542e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7003 head_norm=1.205737 delta_norm=0.237754
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.6699 head_norm=1.241458
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.080520e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.6734 head_norm=1.214757 delta_norm=0.108052
[S7] aggregate: ACCEPT kept=['S13', 'S6'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.8245 head_norm=1.767536
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.545330e-01
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.8245 head_norm=1.485600 delta_norm=0.354533
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.7090 head_norm=1.736559
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.064174e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.7097 head_norm=1.756433 delta_norm=0.106417
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.922052 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.6064332972665943, 'auprc': 0.7190905906182312, 'loss_val': 1.4709632408161328, 'psi': 0.6514962146072492}-{'f1_val': 0.6799751486064326, 'auprc': 0.7314823895690843, 'loss_val': 1.060731957836523, 'psi': 0.7005780449914933}
[S3] START round=23 head_norm_before_train=1.300381 cos_to_last_merge=0.9965 (last merge round=20)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9603443196130923, 'auprc': 0.9993168705891373, 'loss_val': 0.19694769219760813, 'psi': 0.9759333400035104}-{'f1_val': 0.9629642435515284, 'auprc': 0.9995823116977531, 'loss_val': 0.20712374902827108, 'psi': 0.9776114708100183}
[S4] START round=23 head_norm_before_train=1.734062 cos_to_last_merge=0.8200 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.820
[S4] round=23 local utility u=0.037776 metrics={'f1_val': 0.9526866275297853, 'auprc': 0.9753899329338063, 'loss_val': 0.267061532888283, 'psi': 0.9617679496913936}-{'f1_val': 0.9509879937147745, 'auprc': 0.9601046536352212, 'loss_val': 0.28656671812428697, 'psi': 0.9546346576829532}
[S5] START round=23 head_norm_before_train=1.205737 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.7109188383522543, 'auprc': 0.7925945020361935, 'loss_val': 0.4706755505169777, 'psi': 0.74358910382583}-{'f1_val': 0.7003213174339138, 'auprc': 0.9975222520248788, 'loss_val': 0.3621847011567022, 'psi': 0.8192016912702997}
[S6] START round=23 head_norm_before_train=1.485600 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.465125 metrics={'f1_val': 0.9577620529357824, 'auprc': 0.9697311330656031, 'loss_val': 0.25049942653001295, 'psi': 0.9625496849877107}-{'f1_val': 0.8244744837870306, 'auprc': 0.9663705035611011, 'loss_val': 0.3709427637412945, 'psi': 0.8812328916966587}
[S7] START round=23 head_norm_before_train=1.214757 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.6576633177245688, 'auprc': 0.7831262834034614, 'loss_val': 0.7181228809755139, 'psi': 0.7078485039961258}-{'f1_val': 0.6699321367666492, 'auprc': 0.7797161926201196, 'loss_val': 0.6579923154186045, 'psi': 0.7138457591080374}
[S8] START round=23 head_norm_before_train=1.315498 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9605465657338295, 'auprc': 0.9972363017707744, 'loss_val': 0.1661479941352263, 'psi': 0.9752224601486075}-{'f1_val': 0.9918008107316822, 'auprc': 0.9984364351094372, 'loss_val': 0.050346349096087685, 'psi': 0.9944550604827842}
[S9] START round=23 head_norm_before_train=1.687552 cos_to_last_merge=0.8060 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.806
[S9] round=23 local utility u=0.000683 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9962624850478718, 'loss_val': 0.02830126192490496, 'psi': 0.9967667415264344}-{'f1_val': 0.9971029125121428, 'auprc': 0.9964683903397467, 'loss_val': 0.030285849048180234, 'psi': 0.9968491036431844}
[S10] START round=23 head_norm_before_train=1.305676 cos_to_last_merge=0.9949 (last merge round=20)
[S10] round=23 local utility u=0.008889 metrics={'f1_val': 0.9919208541469341, 'auprc': 0.994686324969982, 'loss_val': 0.07202774105794785, 'psi': 0.9930270424761534}-{'f1_val': 0.9911320303647527, 'auprc': 0.9953260757540191, 'loss_val': 0.0869920950007649, 'psi': 0.9928096485204593}
[S11] START round=23 head_norm_before_train=1.655908 cos_to_last_merge=0.8420 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.842
[S11] round=23 local utility u=0.005896 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9984133943955326, 'loss_val': 0.050938294390807645, 'psi': 0.9972814766555922}-{'f1_val': 0.9969406902828911, 'auprc': 0.9983038812453647, 'loss_val': 0.06488513239627271, 'psi': 0.9974859666678806}
[S13] START round=23 head_norm_before_train=1.048191 cos_to_last_merge=0.9842 (last merge round=20)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6439735312517886, 'auprc': 0.6484920522589942, 'loss_val': 0.7347098925260952, 'psi': 0.6457809396546708}-{'f1_val': 0.667887604788778, 'auprc': 0.6767976644370457, 'loss_val': 0.6568594870065882, 'psi': 0.671451628648085}
[S14] START round=23 head_norm_before_train=1.115919 cos_to_last_merge=0.9939 (last merge round=20)
[S14] round=23 local utility u=0.042971 metrics={'f1_val': 0.9960030643669354, 'auprc': 0.9991855369143908, 'loss_val': 0.2466101748189603, 'psi': 0.9972760533859176}-{'f1_val': 0.993305053346471, 'auprc': 0.9959280794558539, 'loss_val': 0.3065909402026837, 'psi': 0.9943542637902242}
[S15] START round=23 head_norm_before_train=1.285778 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=1.000000 metrics={'f1_val': 0.9812357826246292, 'auprc': 0.9969185752560196, 'loss_val': 0.1585872426363349, 'psi': 0.9875088996771852}-{'f1_val': 0.7009169771696235, 'auprc': 0.7991126494791833, 'loss_val': 0.6035982108277054, 'psi': 0.7401952460934474}
[S16] START round=23 head_norm_before_train=1.372409 cos_to_last_merge=0.7756 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.776
[S16] round=23 local utility u=0.331756 metrics={'f1_val': 0.9804505222048088, 'auprc': 0.9940162157928432, 'loss_val': 0.11974751300041543, 'psi': 0.9858767996400226}-{'f1_val': 0.90706925550989, 'auprc': 0.9949365019618848, 'loss_val': 0.34573286769071376, 'psi': 0.9422161540906879}
[S17] START round=23 head_norm_before_train=1.756433 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.5750964609573133, 'auprc': 0.8063988182860746, 'loss_val': 0.9999055446399852, 'psi': 0.6676174038888179}-{'f1_val': 0.709038029542487, 'auprc': 0.9985685107778469, 'loss_val': 0.6096740041873046, 'psi': 0.8248502220366309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S16] sending update (kind=head size=1787 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:39802
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1795) from S11
[S2] cosine check vs S11: cos=-0.0847
[S2] DROPPED delta from S11 (cos=-0.0847 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.8665
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] cosine check vs S6: cos=0.9693
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] cosine check vs S14: cos=0.8665
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=0.9140
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.6577 head_norm=1.232942
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.201044e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.6614 head_norm=1.363247 delta_norm=0.220104
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.6440 head_norm=1.108342
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.904389e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.6446 head_norm=1.217729 delta_norm=0.290439
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.9812 head_norm=1.324188
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.305820e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.9798 head_norm=1.198867 delta_norm=0.330582
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9960 head_norm=1.157436
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.305820e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9958 head_norm=1.198867 delta_norm=0.330582
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.934981 (no previous merge yet)
[S2] round=24 local utility u=0.532879 metrics={'f1_val': 0.7072006999948159, 'auprc': 0.7269045986906472, 'loss_val': 1.0332516933030909, 'psi': 0.7150822594731485}-{'f1_val': 0.6064332972665943, 'auprc': 0.7190905906182312, 'loss_val': 1.4709632408161328, 'psi': 0.6514962146072492}
[S3] START round=24 head_norm_before_train=1.340743 cos_to_last_merge=0.9928 (last merge round=20)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.7382792862430871, 'auprc': 0.9500333071279659, 'loss_val': 0.5125494990345176, 'psi': 0.8229808945970387}-{'f1_val': 0.9603443196130923, 'auprc': 0.9993168705891373, 'loss_val': 0.19694769219760813, 'psi': 0.9759333400035104}
[S4] START round=24 head_norm_before_train=1.750872 cos_to_last_merge=0.8186 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.819
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9374522050826803, 'auprc': 0.9343561563449205, 'loss_val': 0.25006854797803313, 'psi': 0.9362137855875765}-{'f1_val': 0.9526866275297853, 'auprc': 0.9753899329338063, 'loss_val': 0.267061532888283, 'psi': 0.9617679496913936}
[S5] START round=24 head_norm_before_train=1.231768 cos_to_last_merge=0.9996 (last merge round=22)
[S5] round=24 local utility u=0.019615 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.785628404211808, 'loss_val': 0.3486851649873667, 'psi': 0.7346163972823279}-{'f1_val': 0.7109188383522543, 'auprc': 0.7925945020361935, 'loss_val': 0.4706755505169777, 'psi': 0.74358910382583}
[S6] START round=24 head_norm_before_train=1.514473 cos_to_last_merge=0.9995 (last merge round=22)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.831257144267193, 'auprc': 0.9656783993409442, 'loss_val': 0.3122741077636613, 'psi': 0.8850256462966934}-{'f1_val': 0.9577620529357824, 'auprc': 0.9697311330656031, 'loss_val': 0.25049942653001295, 'psi': 0.9625496849877107}
[S7] START round=24 head_norm_before_train=1.363247 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5105236408286941, 'auprc': 0.7822292254077119, 'loss_val': 0.7675690974814235, 'psi': 0.6192058746603012}-{'f1_val': 0.6576633177245688, 'auprc': 0.7831262834034614, 'loss_val': 0.7181228809755139, 'psi': 0.7078485039961258}
[S8] START round=24 head_norm_before_train=1.366973 cos_to_last_merge=0.9993 (last merge round=22)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.7878049829101932, 'loss_val': 0.55941983057979, 'psi': 0.743532221948346}-{'f1_val': 0.9605465657338295, 'auprc': 0.9972363017707744, 'loss_val': 0.1661479941352263, 'psi': 0.9752224601486075}
[S9] START round=24 head_norm_before_train=1.706484 cos_to_last_merge=0.8045 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.805
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.9988140915893297, 'loss_val': 0.03619087638746629, 'psi': 0.9938567598443278}-{'f1_val': 0.9971029125121428, 'auprc': 0.9962624850478718, 'loss_val': 0.02830126192490496, 'psi': 0.9967667415264344}
[S10] START round=24 head_norm_before_train=1.380585 cos_to_last_merge=0.9907 (last merge round=20)
[S10] round=24 local utility u=0.010614 metrics={'f1_val': 0.9930019176970697, 'auprc': 0.9957914166136372, 'loss_val': 0.060601040402180124, 'psi': 0.9941177172636967}-{'f1_val': 0.9919208541469341, 'auprc': 0.994686324969982, 'loss_val': 0.07202774105794785, 'psi': 0.9930270424761534}
[S11] START round=24 head_norm_before_train=1.685070 cos_to_last_merge=0.8394 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.839
[S11] round=24 local utility u=0.003766 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9985312117771312, 'loss_val': 0.04376002278334213, 'psi': 0.9973286036082316}-{'f1_val': 0.9965268648289654, 'auprc': 0.9984133943955326, 'loss_val': 0.050938294390807645, 'psi': 0.9972814766555922}
[S13] START round=24 head_norm_before_train=1.217729 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6525133277677351, 'auprc': 0.6332623320430822, 'loss_val': 0.7976994018767438, 'psi': 0.6448129294778739}-{'f1_val': 0.6439735312517886, 'auprc': 0.6484920522589942, 'loss_val': 0.7347098925260952, 'psi': 0.6457809396546708}
[S14] START round=24 head_norm_before_train=1.198867 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9950384471612538, 'auprc': 0.9975103634364352, 'loss_val': 0.3071510098015117, 'psi': 0.9960272136713263}-{'f1_val': 0.9960030643669354, 'auprc': 0.9991855369143908, 'loss_val': 0.2466101748189603, 'psi': 0.9972760533859176}
[S15] START round=24 head_norm_before_train=1.198867 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.8401237509065135, 'auprc': 0.9928951417117654, 'loss_val': 0.23138523122045485, 'psi': 0.9012323072286142}-{'f1_val': 0.9812357826246292, 'auprc': 0.9969185752560196, 'loss_val': 0.1585872426363349, 'psi': 0.9875088996771852}
[S16] START round=24 head_norm_before_train=1.402998 cos_to_last_merge=0.7726 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.773
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.851921196575156, 'auprc': 0.980754223732264, 'loss_val': 0.5918382761620301, 'psi': 0.9034544074379991}-{'f1_val': 0.9804505222048088, 'auprc': 0.9940162157928432, 'loss_val': 0.11974751300041543, 'psi': 0.9858767996400226}
[S17] START round=24 head_norm_before_train=1.767124 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=24 local utility u=0.221116 metrics={'f1_val': 0.5934657672238917, 'auprc': 0.894572394752986, 'loss_val': 0.9324097408838495, 'psi': 0.7139084182355293}-{'f1_val': 0.5750964609573133, 'auprc': 0.8063988182860746, 'loss_val': 0.9999055446399852, 'psi': 0.6676174038888179}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:39807
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39802
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39809
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:39813
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=0.9793
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] cosine check vs S11: cos=-0.0863
[S2] DROPPED delta from S11 (cos=-0.0863 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1804) from S2
[S6] cosine check vs S2: cos=0.9710
[S8] RECEIVED delta(kind=head bytes=1799) from S5
[S8] cosine check vs S5: cos=0.8864
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39815
[S17] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S17
[S15] cosine check vs S17: cos=0.7484
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.8401 head_norm=1.273164
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.899815e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.7884 head_norm=1.428694 delta_norm=0.589981
[S15] aggregate: ROLLBACK (f1_val pre=0.840 post=0.788 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.7140 head_norm=1.411829
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.268161e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.7140 head_norm=1.294362 delta_norm=0.326816
[S8] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=24 metric=0.8313 head_norm=1.550962
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.867793e-01
[S6] stored merged vector for next round verification (round=24)
[S6] DEBUG after merge:  round=24 metric=0.8384 head_norm=1.734545 delta_norm=0.286779
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.6525 head_norm=1.249041
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.657777e-01
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.6514 head_norm=1.336228 delta_norm=0.165778
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.943270 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.7048191568340203, 'auprc': 0.7264010820137095, 'loss_val': 1.0327132962389178, 'psi': 0.7134519269058959}-{'f1_val': 0.7072006999948159, 'auprc': 0.7269045986906472, 'loss_val': 1.0332516933030909, 'psi': 0.7150822594731485}
[S3] START round=25 head_norm_before_train=1.378362 cos_to_last_merge=0.9888 (last merge round=20)
[S3] round=25 local utility u=0.969977 metrics={'f1_val': 0.9762473026554315, 'auprc': 0.9995791325409664, 'loss_val': 0.149041349993285, 'psi': 0.9855800346096454}-{'f1_val': 0.7382792862430871, 'auprc': 0.9500333071279659, 'loss_val': 0.5125494990345176, 'psi': 0.8229808945970387}
[S4] START round=25 head_norm_before_train=1.761485 cos_to_last_merge=0.8181 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.818
[S4] round=25 local utility u=0.010126 metrics={'f1_val': 0.9401031767846821, 'auprc': 0.9344054436730579, 'loss_val': 0.245870481740897, 'psi': 0.9378240835400324}-{'f1_val': 0.9374522050826803, 'auprc': 0.9343561563449205, 'loss_val': 0.25006854797803313, 'psi': 0.9362137855875765}
[S5] START round=25 head_norm_before_train=1.253436 cos_to_last_merge=0.9990 (last merge round=22)
[S5] round=25 local utility u=0.348796 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9979440048344537, 'loss_val': 0.28631796162171474, 'psi': 0.8193703923941298}-{'f1_val': 0.7006083926626743, 'auprc': 0.785628404211808, 'loss_val': 0.3486851649873667, 'psi': 0.7346163972823279}
[S6] START round=25 head_norm_before_train=1.734545 cos_to_last_merge=1.0000 (last merge round=24)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.6484965460368247, 'auprc': 0.8321936347443477, 'loss_val': 0.5822160585814825, 'psi': 0.721975381519834}-{'f1_val': 0.831257144267193, 'auprc': 0.9656783993409442, 'loss_val': 0.3122741077636613, 'psi': 0.8850256462966934}
[S7] START round=25 head_norm_before_train=1.377562 cos_to_last_merge=0.9997 (last merge round=23)
[S7] round=25 local utility u=0.293933 metrics={'f1_val': 0.5981224471736764, 'auprc': 0.7852780852340381, 'loss_val': 0.7144423746173213, 'psi': 0.672984702397821}-{'f1_val': 0.5105236408286941, 'auprc': 0.7822292254077119, 'loss_val': 0.7675690974814235, 'psi': 0.6192058746603012}
[S8] START round=25 head_norm_before_train=1.294362 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=1.000000 metrics={'f1_val': 0.9918532151771823, 'auprc': 0.9943613972764718, 'loss_val': 0.1244720606314882, 'psi': 0.9928564880168982}-{'f1_val': 0.7140170479737811, 'auprc': 0.7878049829101932, 'loss_val': 0.55941983057979, 'psi': 0.743532221948346}
[S9] START round=25 head_norm_before_train=1.723773 cos_to_last_merge=0.8033 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.803
[S9] round=25 local utility u=0.013278 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9988464284529718, 'loss_val': 0.030056047672347586, 'psi': 0.995902198979597}-{'f1_val': 0.9905518720143266, 'auprc': 0.9988140915893297, 'loss_val': 0.03619087638746629, 'psi': 0.9938567598443278}
[S10] START round=25 head_norm_before_train=1.437315 cos_to_last_merge=0.9873 (last merge round=20)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9776163839187445, 'auprc': 0.9933566763551758, 'loss_val': 0.07220803479387529, 'psi': 0.9839125008933169}-{'f1_val': 0.9930019176970697, 'auprc': 0.9957914166136372, 'loss_val': 0.060601040402180124, 'psi': 0.9941177172636967}
[S11] START round=25 head_norm_before_train=1.713636 cos_to_last_merge=0.8376 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.838
[S11] round=25 local utility u=0.003741 metrics={'f1_val': 0.9967685762538004, 'auprc': 0.9988241876307717, 'loss_val': 0.03860664718510959, 'psi': 0.9975908208045889}-{'f1_val': 0.9965268648289654, 'auprc': 0.9985312117771312, 'loss_val': 0.04376002278334213, 'psi': 0.9973286036082316}
[S13] START round=25 head_norm_before_train=1.336228 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.469635 metrics={'f1_val': 0.7501373105335267, 'auprc': 0.708408923513614, 'loss_val': 0.6696135322025852, 'psi': 0.7334459557255616}-{'f1_val': 0.6525133277677351, 'auprc': 0.6332623320430822, 'loss_val': 0.7976994018767438, 'psi': 0.6448129294778739}
[S14] START round=25 head_norm_before_train=1.229244 cos_to_last_merge=0.9994 (last merge round=23)
[S14] round=25 local utility u=0.047600 metrics={'f1_val': 0.9963186723594546, 'auprc': 0.9974668229730173, 'loss_val': 0.21950254278008724, 'psi': 0.9967779326048796}-{'f1_val': 0.9950384471612538, 'auprc': 0.9975103634364352, 'loss_val': 0.3071510098015117, 'psi': 0.9960272136713263}
[S15] START round=25 head_norm_before_train=1.428694 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.414228 metrics={'f1_val': 0.9684067470011247, 'auprc': 0.994713544225174, 'loss_val': 0.178082190135376, 'psi': 0.9789294658907444}-{'f1_val': 0.8401237509065135, 'auprc': 0.9928951417117654, 'loss_val': 0.23138523122045485, 'psi': 0.9012323072286142}
[S16] START round=25 head_norm_before_train=1.431617 cos_to_last_merge=0.7700 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.770
[S16] round=25 local utility u=0.618286 metrics={'f1_val': 0.9727990908959849, 'auprc': 0.9929600289359444, 'loss_val': 0.11715156285791092, 'psi': 0.9808634661119687}-{'f1_val': 0.851921196575156, 'auprc': 0.980754223732264, 'loss_val': 0.5918382761620301, 'psi': 0.9034544074379991}
[S17] START round=25 head_norm_before_train=1.776948 cos_to_last_merge=0.9998 (last merge round=22)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.6059810727929253, 'auprc': 0.8259193523938475, 'loss_val': 1.033866275642132, 'psi': 0.6939563846332942}-{'f1_val': 0.5934657672238917, 'auprc': 0.894572394752986, 'loss_val': 0.9324097408838495, 'psi': 0.7139084182355293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.8523
[S8] RECEIVED delta(kind=head bytes=1801) from S5
[S8] cosine check vs S5: cos=0.9587
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] cosine check vs S14: cos=0.9118
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=0.9695
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=0.9118
[S2] RECEIVED delta(kind=head bytes=1801) from S11
[S2] cosine check vs S11: cos=-0.0876
[S2] DROPPED delta from S11 (cos=-0.0876 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S3
[S5] cosine check vs S3: cos=0.9756
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] cosine check vs S13: cos=0.4623
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.034 → S13@127.0.0.1:39813
[S2] ⇄ pheromone p=0.130 → S6@127.0.0.1:39807
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.6485 head_norm=1.767172
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.701946e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.6746 head_norm=1.566902 delta_norm=0.270195
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.292 → S7@127.0.0.1:39808
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.7003 head_norm=1.278893
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.623780e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.7003 head_norm=1.336386 delta_norm=0.162378
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.245 → S8@127.0.0.1:39809
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9963 head_norm=1.259061
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.210931e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9956 head_norm=1.363188 delta_norm=0.321093
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.107 → S15@127.0.0.1:39815
[S3] ⇄ pheromone p=0.276 → S5@127.0.0.1:39805
[S13] ⇄ pheromone p=0.148 → S7@127.0.0.1:39808
[S11] ⇄ pheromone p=0.055 → S2@127.0.0.1:39802
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.9684 head_norm=1.528898
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.210931e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.9622 head_norm=1.363188 delta_norm=0.321093
[S15] aggregate: ROLLBACK (f1_val pre=0.968 post=0.962 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.314 → S14@127.0.0.1:39814
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9919 head_norm=1.331245
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.892411e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9916 head_norm=1.291541 delta_norm=0.189241
[S8] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.242 → S17@127.0.0.1:39817
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.5981 head_norm=1.390495
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.116580e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.5880 head_norm=1.173339 delta_norm=0.711658
[S7] aggregate: ROLLBACK (f1_val pre=0.598 post=0.588 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.147 → S6@127.0.0.1:39807
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.6060 head_norm=1.788082
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.775179e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.6058 head_norm=1.502232 delta_norm=0.477518
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.161 → S15@127.0.0.1:39815
[S2] START round=26 head_norm_before_train=1.954434 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.7029147269842801, 'auprc': 0.7242228244551812, 'loss_val': 1.0725097523264768, 'psi': 0.7114379659726405}-{'f1_val': 0.7048191568340203, 'auprc': 0.7264010820137095, 'loss_val': 1.0327132962389178, 'psi': 0.7134519269058959}
[S3] START round=26 head_norm_before_train=1.410328 cos_to_last_merge=0.9851 (last merge round=20)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.775619216887295, 'auprc': 0.9693062151407801, 'loss_val': 0.4342118119326544, 'psi': 0.8530940161886891}-{'f1_val': 0.9762473026554315, 'auprc': 0.9995791325409664, 'loss_val': 0.149041349993285, 'psi': 0.9855800346096454}
[S4] START round=26 head_norm_before_train=1.774456 cos_to_last_merge=0.8173 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.817
[S4] round=26 local utility u=0.086681 metrics={'f1_val': 0.9506400386583065, 'auprc': 0.9795455123521573, 'loss_val': 0.2711497158750324, 'psi': 0.9622022281358468}-{'f1_val': 0.9401031767846821, 'auprc': 0.9344054436730579, 'loss_val': 0.245870481740897, 'psi': 0.9378240835400324}
[S5] START round=26 head_norm_before_train=1.336386 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.685774624332019, 'auprc': 0.7845548258569185, 'loss_val': 0.4028894193552912, 'psi': 0.7252867049419788}-{'f1_val': 0.7003213174339138, 'auprc': 0.9979440048344537, 'loss_val': 0.28631796162171474, 'psi': 0.8193703923941298}
[S6] START round=26 head_norm_before_train=1.566902 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.765915 metrics={'f1_val': 0.8140803478085283, 'auprc': 0.9582681550797808, 'loss_val': 0.4221120256842208, 'psi': 0.8717554707170293}-{'f1_val': 0.6484965460368247, 'auprc': 0.8321936347443477, 'loss_val': 0.5822160585814825, 'psi': 0.721975381519834}
[S7] START round=26 head_norm_before_train=1.173339 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.4638021845503144, 'auprc': 0.7762582864548703, 'loss_val': 0.8190567813796017, 'psi': 0.5887846253121367}-{'f1_val': 0.5981224471736764, 'auprc': 0.7852780852340381, 'loss_val': 0.7144423746173213, 'psi': 0.672984702397821}
[S8] START round=26 head_norm_before_train=1.291541 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9923652907733383, 'auprc': 0.991253580121643, 'loss_val': 0.12618013857731103, 'psi': 0.9919206065126602}-{'f1_val': 0.9918532151771823, 'auprc': 0.9943613972764718, 'loss_val': 0.1244720606314882, 'psi': 0.9928564880168982}
[S9] START round=26 head_norm_before_train=1.737677 cos_to_last_merge=0.8021 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.802
[S9] round=26 local utility u=0.009401 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.99727621436555, 'loss_val': 0.02552386758048079, 'psi': 0.9971722332535057}-{'f1_val': 0.9939393793306803, 'auprc': 0.9988464284529718, 'loss_val': 0.030056047672347586, 'psi': 0.995902198979597}
[S10] START round=26 head_norm_before_train=1.481456 cos_to_last_merge=0.9845 (last merge round=20)
[S10] round=26 local utility u=0.058280 metrics={'f1_val': 0.9925631363956225, 'auprc': 0.9953504709926198, 'loss_val': 0.05131054038306472, 'psi': 0.9936780702344215}-{'f1_val': 0.9776163839187445, 'auprc': 0.9933566763551758, 'loss_val': 0.07220803479387529, 'psi': 0.9839125008933169}
[S11] START round=26 head_norm_before_train=1.740191 cos_to_last_merge=0.8362 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.836
[S11] round=26 local utility u=0.002503 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9988753237623914, 'loss_val': 0.03230287003157549, 'psi': 0.9974662484023358}-{'f1_val': 0.9967685762538004, 'auprc': 0.9988241876307717, 'loss_val': 0.03860664718510959, 'psi': 0.9975908208045889}
[S13] START round=26 head_norm_before_train=1.353841 cos_to_last_merge=0.9999 (last merge round=24)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6334502685601486, 'auprc': 0.6678437713053813, 'loss_val': 0.9648433680995979, 'psi': 0.6472076696582416}-{'f1_val': 0.7501373105335267, 'auprc': 0.708408923513614, 'loss_val': 0.6696135322025852, 'psi': 0.7334459557255616}
[S14] START round=26 head_norm_before_train=1.363188 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.009415 metrics={'f1_val': 0.9974331919232962, 'auprc': 0.9967297707814327, 'loss_val': 0.20514921900011654, 'psi': 0.9971518234665507}-{'f1_val': 0.9963186723594546, 'auprc': 0.9974668229730173, 'loss_val': 0.21950254278008724, 'psi': 0.9967779326048796}
[S15] START round=26 head_norm_before_train=1.363188 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.131292 metrics={'f1_val': 0.9957757960160583, 'auprc': 0.9931352412047151, 'loss_val': 0.07497744293287084, 'psi': 0.994719574091521}-{'f1_val': 0.9684067470011247, 'auprc': 0.994713544225174, 'loss_val': 0.178082190135376, 'psi': 0.9789294658907444}
[S16] START round=26 head_norm_before_train=1.458082 cos_to_last_merge=0.7677 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.768
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8912435417704407, 'auprc': 0.9903443591545381, 'loss_val': 0.4236125777870765, 'psi': 0.9308838687240797}-{'f1_val': 0.9727990908959849, 'auprc': 0.9929600289359444, 'loss_val': 0.11715156285791092, 'psi': 0.9808634661119687}
[S17] START round=26 head_norm_before_train=1.502232 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.184047 metrics={'f1_val': 0.6004511462463891, 'auprc': 0.9011224515426876, 'loss_val': 0.8582017509689819, 'psi': 0.7207196683649084}-{'f1_val': 0.6059810727929253, 'auprc': 0.8259193523938475, 'loss_val': 1.033866275642132, 'psi': 0.6939563846332942}
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S9
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S8
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S16
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:39813
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39802
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=0.9923
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] cosine check vs S11: cos=-0.0882
[S2] DROPPED delta from S11 (cos=-0.0882 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S15
[S17] cosine check vs S15: cos=0.8995
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.9959
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] cosine check vs S6: cos=0.7965
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:39815
[S17] sending update (kind=head size=1794 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1794) from S17
[S15] cosine check vs S17: cos=0.8995
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.6335 head_norm=1.366120
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.175462e-01
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.6327 head_norm=1.439817 delta_norm=0.117546
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.9958 head_norm=1.458960
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.850342e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.9937 head_norm=1.431941 delta_norm=0.185034
[S15] aggregate: ACCEPT kept=['S14', 'S17'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.6005 head_norm=1.530514
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.368412e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.5999 head_norm=1.456728 delta_norm=0.336841
[S17] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] CommDone barrier timeout: have=2 need=3 — continuing
[S7] CommDone barrier timeout: have=2 need=3 — continuing
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.4638 head_norm=1.188104
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.841382e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.4883 head_norm=1.320686 delta_norm=0.484138
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.968447 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6591801474071065, 'auprc': 0.7221044221113714, 'loss_val': 1.3122766763978817, 'psi': 0.6843498572888125}-{'f1_val': 0.7029147269842801, 'auprc': 0.7242228244551812, 'loss_val': 1.0725097523264768, 'psi': 0.7114379659726405}
[S3] START round=27 head_norm_before_train=1.437876 cos_to_last_merge=0.9819 (last merge round=20)
[S3] round=27 local utility u=0.896267 metrics={'f1_val': 0.9983835929041498, 'auprc': 0.9995340255999847, 'loss_val': 0.06894837023313159, 'psi': 0.9988437659824838}-{'f1_val': 0.775619216887295, 'auprc': 0.9693062151407801, 'loss_val': 0.4342118119326544, 'psi': 0.8530940161886891}
[S4] START round=27 head_norm_before_train=1.783094 cos_to_last_merge=0.8170 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.817
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9496606695024934, 'auprc': 0.9692067135097496, 'loss_val': 0.2618694812416005, 'psi': 0.957479087105396}-{'f1_val': 0.9506400386583065, 'auprc': 0.9795455123521573, 'loss_val': 0.2711497158750324, 'psi': 0.9622022281358468}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=27 head_norm_before_train=1.358348 cos_to_last_merge=0.9998 (last merge round=25)
[S5] round=27 local utility u=0.432239 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9962573394498656, 'loss_val': 0.26079466769200155, 'psi': 0.8186952948747617}-{'f1_val': 0.685774624332019, 'auprc': 0.7845548258569185, 'loss_val': 0.4028894193552912, 'psi': 0.7252867049419788}
[S6] START round=27 head_norm_before_train=1.595497 cos_to_last_merge=0.9996 (last merge round=25)
[S6] round=27 local utility u=0.110229 metrics={'f1_val': 0.8299320824173306, 'auprc': 0.9612430473197465, 'loss_val': 0.3056895505162665, 'psi': 0.8824564683782969}-{'f1_val': 0.8140803478085283, 'auprc': 0.9582681550797808, 'loss_val': 0.4221120256842208, 'psi': 0.8717554707170293}
[S7] START round=27 head_norm_before_train=1.320686 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.478986 metrics={'f1_val': 0.6046509297565144, 'auprc': 0.7815987361643304, 'loss_val': 0.722197708581649, 'psi': 0.6754300523196408}-{'f1_val': 0.4638021845503144, 'auprc': 0.7762582864548703, 'loss_val': 0.8190567813796017, 'psi': 0.5887846253121367}
[S8] START round=27 head_norm_before_train=1.345452 cos_to_last_merge=0.9984 (last merge round=25)
[S8] round=27 local utility u=0.026436 metrics={'f1_val': 0.992392260479464, 'auprc': 0.9964727610777343, 'loss_val': 0.08912793752258433, 'psi': 0.9940244607187722}-{'f1_val': 0.9923652907733383, 'auprc': 0.991253580121643, 'loss_val': 0.12618013857731103, 'psi': 0.9919206065126602}
[S9] START round=27 head_norm_before_train=1.752022 cos_to_last_merge=0.8011 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.801
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9989153623393974, 'loss_val': 0.024456779903545136, 'psi': 0.9971785661220713}-{'f1_val': 0.9971029125121428, 'auprc': 0.99727621436555, 'loss_val': 0.02552386758048079, 'psi': 0.9971722332535057}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=27 head_norm_before_train=1.519043 cos_to_last_merge=0.9821 (last merge round=20)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9906931001306816, 'auprc': 0.9943956836491799, 'loss_val': 0.052690240463375254, 'psi': 0.9921741335380809}-{'f1_val': 0.9925631363956225, 'auprc': 0.9953504709926198, 'loss_val': 0.05131054038306472, 'psi': 0.9936780702344215}
[S11] START round=27 head_norm_before_train=1.766386 cos_to_last_merge=0.8351 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.835
[S11] round=27 local utility u=0.000983 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9986986088071723, 'loss_val': 0.029807030483561252, 'psi': 0.9973955624202482}-{'f1_val': 0.9965268648289654, 'auprc': 0.9988753237623914, 'loss_val': 0.03230287003157549, 'psi': 0.9974662484023358}
[S13] START round=27 head_norm_before_train=1.439817 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.535369 metrics={'f1_val': 0.6891896321999864, 'auprc': 0.7513115596135598, 'loss_val': 0.4789446058630062, 'psi': 0.7140384031654158}-{'f1_val': 0.6334502685601486, 'auprc': 0.6678437713053813, 'loss_val': 0.9648433680995979, 'psi': 0.6472076696582416}
[S14] START round=27 head_norm_before_train=1.392826 cos_to_last_merge=0.9992 (last merge round=25)
[S14] round=27 local utility u=0.016560 metrics={'f1_val': 0.9968028443251822, 'auprc': 0.997251880615686, 'loss_val': 0.16981384254680648, 'psi': 0.9969824588413837}-{'f1_val': 0.9974331919232962, 'auprc': 0.9967297707814327, 'loss_val': 0.20514921900011654, 'psi': 0.9971518234665507}
[S15] START round=27 head_norm_before_train=1.431941 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6982901427811046, 'auprc': 0.7175301452665105, 'loss_val': 0.6174586935970412, 'psi': 0.7059861437752669}-{'f1_val': 0.9957757960160583, 'auprc': 0.9931352412047151, 'loss_val': 0.07497744293287084, 'psi': 0.994719574091521}
[S16] START round=27 head_norm_before_train=1.481575 cos_to_last_merge=0.7656 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.766
[S16] round=27 local utility u=0.332566 metrics={'f1_val': 0.9545315437674969, 'auprc': 0.9917257443759149, 'loss_val': 0.14235185496113237, 'psi': 0.969409224010864}-{'f1_val': 0.8912435417704407, 'auprc': 0.9903443591545381, 'loss_val': 0.4236125777870765, 'psi': 0.9308838687240797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] sending update (kind=head size=1790 to 1 peers)
[S17] START round=27 head_norm_before_train=1.456728 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.372097 metrics={'f1_val': 0.6526776259051543, 'auprc': 0.9566234316147083, 'loss_val': 0.5938704656358536, 'psi': 0.7742559481889759}-{'f1_val': 0.6004511462463891, 'auprc': 0.9011224515426876, 'loss_val': 0.8582017509689819, 'psi': 0.7207196683649084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39802
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39805
[S11] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39808
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=-0.0889
[S2] DROPPED delta from S11 (cos=-0.0889 < 0.0)
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:39803
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] cosine check vs S6: cos=0.9591
[S5] RECEIVED delta(kind=head bytes=1801) from S8
[S5] cosine check vs S8: cos=0.9717
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=0.9975
[S5] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] cosine check vs S5: cos=0.9886
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39815
[S17] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S17
[S15] cosine check vs S17: cos=0.9860
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.7003 head_norm=1.375944
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.677342e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.7003 head_norm=1.388209 delta_norm=0.167734
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.6983 head_norm=1.518308
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.267466e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.6983 head_norm=1.505959 delta_norm=0.126747
[S15] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5]  timeout peer S8
[S5]  timeout peer S10
[S8]  timeout peer S17
[S10]  timeout peer S13
[S13]  timeout peer S7
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S16
[S7]  timeout peer S9
[S7]  timeout peer S14
[S3]  timeout peer S5
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39815
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] cosine check vs S14: cos=0.9823
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=0.9591
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6047 head_norm=1.334529
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.578662e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6143 head_norm=1.467796 delta_norm=0.257866
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.981976 (no previous merge yet)
[S2] round=28 local utility u=0.027338 metrics={'f1_val': 0.6640464967296174, 'auprc': 0.7202036193452516, 'loss_val': 1.281096986334403, 'psi': 0.6865093457758711}-{'f1_val': 0.6591801474071065, 'auprc': 0.7221044221113714, 'loss_val': 1.3122766763978817, 'psi': 0.6843498572888125}
[S3] START round=28 head_norm_before_train=1.464704 cos_to_last_merge=0.9786 (last merge round=20)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.789829435990158, 'auprc': 0.9503970467983713, 'loss_val': 0.4872391106285061, 'psi': 0.8540564803134433}-{'f1_val': 0.9983835929041498, 'auprc': 0.9995340255999847, 'loss_val': 0.06894837023313159, 'psi': 0.9988437659824838}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.7898 head_norm=1.485742
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.271092e-01
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.7842 head_norm=1.426243 delta_norm=0.127109
[S3] aggregate: ROLLBACK (f1_val pre=0.790 post=0.784 tol_abs=0.005 tol_rel=0.0)
[S4] START round=28 head_norm_before_train=1.789198 cos_to_last_merge=0.8169 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.817
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9412464626158291, 'auprc': 0.9514211916471609, 'loss_val': 0.22467035138782165, 'psi': 0.9453163542283618}-{'f1_val': 0.9496606695024934, 'auprc': 0.9692067135097496, 'loss_val': 0.2618694812416005, 'psi': 0.957479087105396}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=1.388209 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.700833837670131, 'auprc': 0.892434456664887, 'loss_val': 0.3169742940836297, 'psi': 0.7774740852680333}-{'f1_val': 0.700320598491359, 'auprc': 0.9962573394498656, 'loss_val': 0.26079466769200155, 'psi': 0.8186952948747617}
[S6] START round=28 head_norm_before_train=1.631218 cos_to_last_merge=0.9984 (last merge round=25)
[S6] round=28 local utility u=0.239802 metrics={'f1_val': 0.8971392145385243, 'auprc': 0.9671673138782532, 'loss_val': 0.24710171817416013, 'psi': 0.9251504542744159}-{'f1_val': 0.8299320824173306, 'auprc': 0.9612430473197465, 'loss_val': 0.3056895505162665, 'psi': 0.8824564683782969}
[S7] START round=28 head_norm_before_train=1.467796 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.025723 metrics={'f1_val': 0.6092061808788983, 'auprc': 0.7737368012154338, 'loss_val': 0.6744967864353306, 'psi': 0.6750184290135126}-{'f1_val': 0.6046509297565144, 'auprc': 0.7815987361643304, 'loss_val': 0.722197708581649, 'psi': 0.6754300523196408}
[S8] START round=28 head_norm_before_train=1.420315 cos_to_last_merge=0.9929 (last merge round=25)
[S8] round=28 local utility u=0.014853 metrics={'f1_val': 0.9931148882341876, 'auprc': 0.9973342227324367, 'loss_val': 0.06634112498527253, 'psi': 0.9948026220334872}-{'f1_val': 0.992392260479464, 'auprc': 0.9964727610777343, 'loss_val': 0.08912793752258433, 'psi': 0.9940244607187722}
[S9] START round=28 head_norm_before_train=1.767247 cos_to_last_merge=0.8001 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.800
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9988217027693582, 'loss_val': 0.026625339258605142, 'psi': 0.9961426746254335}-{'f1_val': 0.9960207019771873, 'auprc': 0.9989153623393974, 'loss_val': 0.024456779903545136, 'psi': 0.9971785661220713}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.550777 cos_to_last_merge=0.9800 (last merge round=20)
[S10] round=28 local utility u=0.010108 metrics={'f1_val': 0.9927824898839768, 'auprc': 0.9947883997371955, 'loss_val': 0.04618898826805445, 'psi': 0.9935848538252643}-{'f1_val': 0.9906931001306816, 'auprc': 0.9943956836491799, 'loss_val': 0.052690240463375254, 'psi': 0.9921741335380809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.9928 head_norm=1.576697
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.673750e-02
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.9928 head_norm=1.511716 delta_norm=0.086737
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] START round=28 head_norm_before_train=1.789420 cos_to_last_merge=0.8342 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.834
[S11] round=28 local utility u=0.001180 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9988045841819251, 'loss_val': 0.027765871296386736, 'psi': 0.9974379525701492}-{'f1_val': 0.9965268648289654, 'auprc': 0.9986986088071723, 'loss_val': 0.029807030483561252, 'psi': 0.9973955624202482}
[S13] START round=28 head_norm_before_train=1.449015 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6154668461651732, 'auprc': 0.636457642322398, 'loss_val': 1.1099709424662934, 'psi': 0.6238631646280631}-{'f1_val': 0.6891896321999864, 'auprc': 0.7513115596135598, 'loss_val': 0.4789446058630062, 'psi': 0.7140384031654158}
[S14] START round=28 head_norm_before_train=1.422133 cos_to_last_merge=0.9973 (last merge round=25)
[S14] round=28 local utility u=0.020487 metrics={'f1_val': 0.9974331919232962, 'auprc': 0.9971575614319723, 'loss_val': 0.13233813737375835, 'psi': 0.9973229397267667}-{'f1_val': 0.9968028443251822, 'auprc': 0.997251880615686, 'loss_val': 0.16981384254680648, 'psi': 0.9969824588413837}
[S15] START round=28 head_norm_before_train=1.505959 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.507697 metrics={'f1_val': 0.7663830804517395, 'auprc': 0.8678724267126776, 'loss_val': 0.46164847897606637, 'psi': 0.8069788189561147}-{'f1_val': 0.6982901427811046, 'auprc': 0.7175301452665105, 'loss_val': 0.6174586935970412, 'psi': 0.7059861437752669}
[S16] START round=28 head_norm_before_train=1.502436 cos_to_last_merge=0.7639 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.764
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.940252335043723, 'auprc': 0.993215213621686, 'loss_val': 0.1478749444609138, 'psi': 0.9614374864749081}-{'f1_val': 0.9545315437674969, 'auprc': 0.9917257443759149, 'loss_val': 0.14235185496113237, 'psi': 0.969409224010864}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=1.504225 cos_to_last_merge=0.9990 (last merge round=26)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6156429842547912, 'auprc': 0.8531614383814612, 'loss_val': 0.8938296108049281, 'psi': 0.7106503659054593}-{'f1_val': 0.6526776259051543, 'auprc': 0.9566234316147083, 'loss_val': 0.5938704656358536, 'psi': 0.7742559481889759}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39802
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39805
[S14] not sending this round → trigger blocked (psi=0.997)
[S11] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39808
[S8] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:39817
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=-0.0908
[S2] DROPPED delta from S11 (cos=-0.0908 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] cosine check vs S8: cos=0.9859
[S6] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S15
[S17] cosine check vs S15: cos=0.9912
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] cosine check vs S2: cos=0.9685
[S7] RECEIVED delta(kind=head bytes=1794) from S6
[S7] cosine check vs S6: cos=0.9895
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.8971 head_norm=1.662039
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.194494e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.9264 head_norm=1.637152 delta_norm=0.119449
[S6] aggregate: ACCEPT kept=['S7', 'S2'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.7664 head_norm=1.564870
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.590725e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.7702 head_norm=1.486720 delta_norm=0.159073
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.675)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.6092 head_norm=1.482633
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.447311e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.6148 head_norm=1.568228 delta_norm=0.144731
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.6156 head_norm=1.541861
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.035018e-01
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.6160 head_norm=1.549956 delta_norm=0.103502
[S17] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.993621 (no previous merge yet)
[S2] round=29 local utility u=0.178995 metrics={'f1_val': 0.7047799236173324, 'auprc': 0.7218472720576707, 'loss_val': 1.1724390023365994, 'psi': 0.7116068629934678}-{'f1_val': 0.6640464967296174, 'auprc': 0.7202036193452516, 'loss_val': 1.281096986334403, 'psi': 0.6865093457758711}
[S3] START round=29 head_norm_before_train=1.426243 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.876841 metrics={'f1_val': 0.9906027115349977, 'auprc': 0.9994181069694803, 'loss_val': 0.08526024854947876, 'psi': 0.9941288697087907}-{'f1_val': 0.789829435990158, 'auprc': 0.9503970467983713, 'loss_val': 0.4872391106285061, 'psi': 0.8540564803134433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=29 head_norm_before_train=1.794660 cos_to_last_merge=0.8172 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.817
[S4] round=29 local utility u=0.025262 metrics={'f1_val': 0.9470766852199373, 'auprc': 0.9684946519887699, 'loss_val': 0.26034830825774036, 'psi': 0.9556438719274704}-{'f1_val': 0.9412464626158291, 'auprc': 0.9514211916471609, 'loss_val': 0.22467035138782165, 'psi': 0.9453163542283618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=29 head_norm_before_train=1.404801 cos_to_last_merge=0.9999 (last merge round=27)
[S5] round=29 local utility u=0.117055 metrics={'f1_val': 0.7003259489103422, 'auprc': 0.9616978989750988, 'loss_val': 0.2876064333818742, 'psi': 0.8048747289362448}-{'f1_val': 0.700833837670131, 'auprc': 0.892434456664887, 'loss_val': 0.3169742940836297, 'psi': 0.7774740852680333}
[S6] START round=29 head_norm_before_train=1.637152 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.5997790970643533, 'auprc': 0.7934482934745168, 'loss_val': 0.680618926454447, 'psi': 0.6772467756284186}-{'f1_val': 0.8971392145385243, 'auprc': 0.9671673138782532, 'loss_val': 0.24710171817416013, 'psi': 0.9251504542744159}
[S7] START round=29 head_norm_before_train=1.568228 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.45566569694509673, 'auprc': 0.7201550973026168, 'loss_val': 0.857977201684848, 'psi': 0.5614614570881048}-{'f1_val': 0.6092061808788983, 'auprc': 0.7737368012154338, 'loss_val': 0.6744967864353306, 'psi': 0.6750184290135126}
[S8] START round=29 head_norm_before_train=1.492960 cos_to_last_merge=0.9855 (last merge round=25)
[S8] round=29 local utility u=0.004294 metrics={'f1_val': 0.992392260479464, 'auprc': 0.9982339854059343, 'loss_val': 0.05611762039068086, 'psi': 0.9947289504500522}-{'f1_val': 0.9931148882341876, 'auprc': 0.9973342227324367, 'loss_val': 0.06634112498527253, 'psi': 0.9948026220334872}
[S9] START round=29 head_norm_before_train=1.782776 cos_to_last_merge=0.7991 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.799
[S9] round=29 local utility u=0.006723 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9962775634826102, 'loss_val': 0.022024867062003187, 'psi': 0.9967727729003297}-{'f1_val': 0.994356655862817, 'auprc': 0.9988217027693582, 'loss_val': 0.026625339258605142, 'psi': 0.9961426746254335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=29 head_norm_before_train=1.511716 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.001849 metrics={'f1_val': 0.9932214201180478, 'auprc': 0.9958866730213198, 'loss_val': 0.048418998553972546, 'psi': 0.9942875212793567}-{'f1_val': 0.9927824898839768, 'auprc': 0.9947883997371955, 'loss_val': 0.04618898826805445, 'psi': 0.9935848538252643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=29 head_norm_before_train=1.807517 cos_to_last_merge=0.8330 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.833
[S11] round=29 local utility u=0.000453 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9985708353370285, 'loss_val': 0.0261583471304565, 'psi': 0.9973444530321907}-{'f1_val': 0.9965268648289654, 'auprc': 0.9988045841819251, 'loss_val': 0.027765871296386736, 'psi': 0.9974379525701492}
[S13] START round=29 head_norm_before_train=1.454094 cos_to_last_merge=0.9999 (last merge round=26)
[S13] round=29 local utility u=0.517442 metrics={'f1_val': 0.6909613217776371, 'auprc': 0.6892612268346079, 'loss_val': 0.6864639125100886, 'psi': 0.6902812838004255}-{'f1_val': 0.6154668461651732, 'auprc': 0.636457642322398, 'loss_val': 1.1099709424662934, 'psi': 0.6238631646280631}
[S14] START round=29 head_norm_before_train=1.452062 cos_to_last_merge=0.9952 (last merge round=25)
[S14] round=29 local utility u=0.010009 metrics={'f1_val': 0.9974331919232962, 'auprc': 0.9971051758005223, 'loss_val': 0.11216295062568182, 'psi': 0.9973019854741866}-{'f1_val': 0.9974331919232962, 'auprc': 0.9971575614319723, 'loss_val': 0.13233813737375835, 'psi': 0.9973229397267667}
[S15] START round=29 head_norm_before_train=1.486720 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=1.000000 metrics={'f1_val': 0.9849741258760507, 'auprc': 0.9962999689528638, 'loss_val': 0.0984230464385619, 'psi': 0.989504463106776}-{'f1_val': 0.7663830804517395, 'auprc': 0.8678724267126776, 'loss_val': 0.46164847897606637, 'psi': 0.8069788189561147}
[S16] START round=29 head_norm_before_train=1.521848 cos_to_last_merge=0.7624 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.762
[S16] round=29 local utility u=0.196703 metrics={'f1_val': 0.9913128954493902, 'auprc': 0.9944920188374591, 'loss_val': 0.0646618683155857, 'psi': 0.9925845448046178}-{'f1_val': 0.940252335043723, 'auprc': 0.993215213621686, 'loss_val': 0.1478749444609138, 'psi': 0.9614374864749081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S17] START round=29 head_norm_before_train=1.549956 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=0.038153 metrics={'f1_val': 0.6302643388408555, 'auprc': 0.8669733240620421, 'loss_val': 0.9466879467947117, 'psi': 0.7249479329293301}-{'f1_val': 0.6156429842547912, 'auprc': 0.8531614383814612, 'loss_val': 0.8938296108049281, 'psi': 0.7106503659054593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39803
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:39812
[S8] sending update (kind=head size=1791 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:39817
[S14] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=0.9861
[S5] RECEIVED delta(kind=head bytes=1791) from S8
[S5] cosine check vs S8: cos=0.9797
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] cosine check vs S14: cos=0.9888
[S10] RECEIVED delta(kind=head bytes=1792) from S13
[S10] cosine check vs S13: cos=0.9984
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.7003 head_norm=1.418271
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.461527e-01
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.7003 head_norm=1.462649 delta_norm=0.146153
[S5] aggregate: ACCEPT kept=['S8', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S2
[S11] cosine check vs S2: cos=-0.0918
[S11] DROPPED delta from S2 (cos=-0.0918 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S15
[S17] cosine check vs S15: cos=0.9875
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39809
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.9115
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.9850 head_norm=1.538109
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.171809e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.9850 head_norm=1.502811 delta_norm=0.117181
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.6303 head_norm=1.587546
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.261973e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.6303 head_norm=1.557920 delta_norm=0.126197
[S17] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=2.010637 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.6619580233125649, 'auprc': 0.7159886157711677, 'loss_val': 1.33993606129663, 'psi': 0.6835702602960061}-{'f1_val': 0.7047799236173324, 'auprc': 0.7218472720576707, 'loss_val': 1.1724390023365994, 'psi': 0.7116068629934678}
[S3] START round=30 head_norm_before_train=1.442769 cos_to_last_merge=0.9999 (last merge round=28)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.8405024027438859, 'auprc': 0.9760771227890195, 'loss_val': 0.3256092109332826, 'psi': 0.8947322907619393}-{'f1_val': 0.9906027115349977, 'auprc': 0.9994181069694803, 'loss_val': 0.08526024854947876, 'psi': 0.9941288697087907}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.8405 head_norm=1.463392
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.299133e-01
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.8304 head_norm=1.435140 delta_norm=0.129913
[S3] aggregate: ROLLBACK (f1_val pre=0.841 post=0.830 tol_abs=0.005 tol_rel=0.0)
[S4] START round=30 head_norm_before_train=1.799204 cos_to_last_merge=0.8176 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.818
[S4] round=30 local utility u=0.020355 metrics={'f1_val': 0.9474222075440574, 'auprc': 0.962574361318694, 'loss_val': 0.20394981733940334, 'psi': 0.953483069053912}-{'f1_val': 0.9470766852199373, 'auprc': 0.9684946519887699, 'loss_val': 0.26034830825774036, 'psi': 0.9556438719274704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=30 head_norm_before_train=1.462649 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.7043759358930143, 'auprc': 0.7955412639143802, 'loss_val': 0.3734781133506087, 'psi': 0.7408420671015606}-{'f1_val': 0.7003259489103422, 'auprc': 0.9616978989750988, 'loss_val': 0.2876064333818742, 'psi': 0.8048747289362448}
[S6] START round=30 head_norm_before_train=1.663479 cos_to_last_merge=0.9998 (last merge round=28)
[S6] round=30 local utility u=1.000000 metrics={'f1_val': 0.969037576959682, 'auprc': 0.98298737355517, 'loss_val': 0.1298966002806338, 'psi': 0.9746174955978771}-{'f1_val': 0.5997790970643533, 'auprc': 0.7934482934745168, 'loss_val': 0.680618926454447, 'psi': 0.6772467756284186}
[S7] START round=30 head_norm_before_train=1.580928 cos_to_last_merge=0.9998 (last merge round=28)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.44063484868225744, 'auprc': 0.7516502220468398, 'loss_val': 0.8874841467467557, 'psi': 0.5650409980280904}-{'f1_val': 0.45566569694509673, 'auprc': 0.7201550973026168, 'loss_val': 0.857977201684848, 'psi': 0.5614614570881048}
[S8] START round=30 head_norm_before_train=1.547127 cos_to_last_merge=0.9795 (last merge round=25)
[S8] round=30 local utility u=0.001359 metrics={'f1_val': 0.9918008107316822, 'auprc': 0.9981980210641127, 'loss_val': 0.049742816665064346, 'psi': 0.9943596948646545}-{'f1_val': 0.992392260479464, 'auprc': 0.9982339854059343, 'loss_val': 0.05611762039068086, 'psi': 0.9947289504500522}
[S9] START round=30 head_norm_before_train=1.796997 cos_to_last_merge=0.7981 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.798
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9987936882387156, 'loss_val': 0.023641345133158433, 'psi': 0.9966167791294553}-{'f1_val': 0.9971029125121428, 'auprc': 0.9962775634826102, 'loss_val': 0.022024867062003187, 'psi': 0.9967727729003297}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.538105 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9869856762643607, 'auprc': 0.9944379763457012, 'loss_val': 0.056076214466858176, 'psi': 0.9899665962968969}-{'f1_val': 0.9932214201180478, 'auprc': 0.9958866730213198, 'loss_val': 0.048418998553972546, 'psi': 0.9942875212793567}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.9870 head_norm=1.564343
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.065146e-02
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.9870 head_norm=1.512631 delta_norm=0.070651
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] START round=30 head_norm_before_train=1.823868 cos_to_last_merge=0.8323 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.832
[S11] round=30 local utility u=0.002424 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988354629177285, 'loss_val': 0.02472850718914346, 'psi': 0.9977127391428378}-{'f1_val': 0.9965268648289654, 'auprc': 0.9985708353370285, 'loss_val': 0.0261583471304565, 'psi': 0.9973444530321907}
[S13] START round=30 head_norm_before_train=1.462503 cos_to_last_merge=0.9996 (last merge round=26)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6334366059683825, 'auprc': 0.7742368563386743, 'loss_val': 0.8238740424812095, 'psi': 0.6897567061164992}-{'f1_val': 0.6909613217776371, 'auprc': 0.6892612268346079, 'loss_val': 0.6864639125100886, 'psi': 0.6902812838004255}
[S14] START round=30 head_norm_before_train=1.475996 cos_to_last_merge=0.9933 (last merge round=25)
[S14] round=30 local utility u=0.005291 metrics={'f1_val': 0.9970229111636145, 'auprc': 0.9969613418035508, 'loss_val': 0.09868849245649684, 'psi': 0.9969982834195891}-{'f1_val': 0.9974331919232962, 'auprc': 0.9971051758005223, 'loss_val': 0.11216295062568182, 'psi': 0.9973019854741866}
[S15] START round=30 head_norm_before_train=1.502811 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6997573805490664, 'auprc': 0.6642447335914913, 'loss_val': 0.6553307618427328, 'psi': 0.6855523217660364}-{'f1_val': 0.9849741258760507, 'auprc': 0.9962999689528638, 'loss_val': 0.0984230464385619, 'psi': 0.989504463106776}
[S16] START round=30 head_norm_before_train=1.541823 cos_to_last_merge=0.7608 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.761
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8410993746320695, 'auprc': 0.9931516280317387, 'loss_val': 0.7363423455177538, 'psi': 0.9019202759919371}-{'f1_val': 0.9913128954493902, 'auprc': 0.9944920188374591, 'loss_val': 0.0646618683155857, 'psi': 0.9925845448046178}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=1.557920 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.060673 metrics={'f1_val': 0.6229131162895468, 'auprc': 0.9235233012900418, 'loss_val': 0.9508837008106437, 'psi': 0.7431571902897448}-{'f1_val': 0.6302643388408555, 'auprc': 0.8669733240620421, 'loss_val': 0.9466879467947117, 'psi': 0.7249479329293301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:39815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.143 → S3@127.0.0.1:39803
[S8] sending update (kind=head size=1793 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39808
[S13] ⇄ pheromone p=0.186 → S10@127.0.0.1:39811
[S15] RECEIVED delta(kind=head bytes=1806) from S14
[S15] cosine check vs S14: cos=0.9938
[S5] RECEIVED delta(kind=head bytes=1793) from S8
[S5] cosine check vs S8: cos=0.9912
[S14] ⇄ pheromone p=0.043 → S15@127.0.0.1:39815
[S6] sending update (kind=head size=1795 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9918 head_norm=1.592829
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.328482e-01
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9918 head_norm=1.554965 delta_norm=0.332848
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.085 → S5@127.0.0.1:39805
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] cosine check vs S6: cos=0.9956
[S2] ⇄ pheromone p=0.075 → S11@127.0.0.1:39812
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.6998 head_norm=1.549079
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.861224e-02
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.6998 head_norm=1.519957 delta_norm=0.088612
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.339 → S17@127.0.0.1:39817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39809
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.400 → S7@127.0.0.1:39808
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.9729
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.4406 head_norm=1.590873
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.313654e-02
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.4406 head_norm=1.641098 delta_norm=0.093137
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.101 → S6@127.0.0.1:39807
[S17] ⇄ pheromone p=0.124 → S15@127.0.0.1:39815
[S2] START round=31 head_norm_before_train=2.027672 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.6296732424849807, 'auprc': 0.7143802012409393, 'loss_val': 1.6215237667902538, 'psi': 0.6635560259873641}-{'f1_val': 0.6619580233125649, 'auprc': 0.7159886157711677, 'loss_val': 1.33993606129663, 'psi': 0.6835702602960061}
[S3] START round=31 head_norm_before_train=1.435140 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.181406 metrics={'f1_val': 0.8770471600537184, 'auprc': 0.995665581258095, 'loss_val': 0.24083046507550032, 'psi': 0.924494528535469}-{'f1_val': 0.8405024027438859, 'auprc': 0.9760771227890195, 'loss_val': 0.3256092109332826, 'psi': 0.8947322907619393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=31 head_norm_before_train=1.813062 cos_to_last_merge=0.8164 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.816
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.939943847693455, 'auprc': 0.9651739219600641, 'loss_val': 0.20504344593506107, 'psi': 0.9500358774000986}-{'f1_val': 0.9474222075440574, 'auprc': 0.962574361318694, 'loss_val': 0.20394981733940334, 'psi': 0.953483069053912}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=1.472406 cos_to_last_merge=0.9999 (last merge round=29)
[S5] round=31 local utility u=0.378466 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9982440959540703, 'loss_val': 0.20032764746915535, 'psi': 0.8194904288419764}-{'f1_val': 0.7043759358930143, 'auprc': 0.7955412639143802, 'loss_val': 0.3734781133506087, 'psi': 0.7408420671015606}
[S6] START round=31 head_norm_before_train=1.694957 cos_to_last_merge=0.9990 (last merge round=28)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.6175878365464117, 'auprc': 0.8916353510342684, 'loss_val': 0.6501179753943831, 'psi': 0.7272068423415543}-{'f1_val': 0.969037576959682, 'auprc': 0.98298737355517, 'loss_val': 0.1298966002806338, 'psi': 0.9746174955978771}
[S7] START round=31 head_norm_before_train=1.641098 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.338366 metrics={'f1_val': 0.5245736642199469, 'auprc': 0.7791337291920556, 'loss_val': 0.7968347843591906, 'psi': 0.6263976902087904}-{'f1_val': 0.44063484868225744, 'auprc': 0.7516502220468398, 'loss_val': 0.8874841467467557, 'psi': 0.5650409980280904}
[S8] START round=31 head_norm_before_train=1.554965 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9923652907733383, 'auprc': 0.9963868534945579, 'loss_val': 0.04979811499361813, 'psi': 0.9939739158618262}-{'f1_val': 0.9918008107316822, 'auprc': 0.9981980210641127, 'loss_val': 0.049742816665064346, 'psi': 0.9943596948646545}
[S9] START round=31 head_norm_before_train=1.807026 cos_to_last_merge=0.7974 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.797
[S9] round=31 local utility u=0.004191 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9968609791508389, 'loss_val': 0.021086234969465014, 'psi': 0.9970061391676213}-{'f1_val': 0.9951655063899485, 'auprc': 0.9987936882387156, 'loss_val': 0.023641345133158433, 'psi': 0.9966167791294553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=31 head_norm_before_train=1.512631 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.020293 metrics={'f1_val': 0.992384337331391, 'auprc': 0.9951827932476334, 'loss_val': 0.05011714707014169, 'psi': 0.993503719697888}-{'f1_val': 0.9869856762643607, 'auprc': 0.9944379763457012, 'loss_val': 0.056076214466858176, 'psi': 0.9899665962968969}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=31 head_norm_before_train=1.840848 cos_to_last_merge=0.8315 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.831
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9962430936640683, 'auprc': 0.9992895199151056, 'loss_val': 0.02533083884094753, 'psi': 0.9974616641644831}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988354629177285, 'loss_val': 0.02472850718914346, 'psi': 0.9977127391428378}
[S13] START round=31 head_norm_before_train=1.472992 cos_to_last_merge=0.9992 (last merge round=26)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.633440198480876, 'auprc': 0.651311912381482, 'loss_val': 0.9497734935414256, 'psi': 0.6405888840411184}-{'f1_val': 0.6334366059683825, 'auprc': 0.7742368563386743, 'loss_val': 0.8238740424812095, 'psi': 0.6897567061164992}
[S14] START round=31 head_norm_before_train=1.495525 cos_to_last_merge=0.9916 (last merge round=25)
[S14] round=31 local utility u=0.007047 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9968985335341451, 'loss_val': 0.08427342798885765, 'psi': 0.9969598413422047}-{'f1_val': 0.9970229111636145, 'auprc': 0.9969613418035508, 'loss_val': 0.09868849245649684, 'psi': 0.9969982834195891}
[S15] START round=31 head_norm_before_train=1.519957 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=1.000000 metrics={'f1_val': 0.982245716884077, 'auprc': 0.992393086958054, 'loss_val': 0.07491263411292243, 'psi': 0.9863046649136678}-{'f1_val': 0.6997573805490664, 'auprc': 0.6642447335914913, 'loss_val': 0.6553307618427328, 'psi': 0.6855523217660364}
[S16] START round=31 head_norm_before_train=1.559659 cos_to_last_merge=0.7595 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.759
[S16] round=31 local utility u=0.069536 metrics={'f1_val': 0.8528138865438254, 'auprc': 0.9916097126597718, 'loss_val': 0.6629319447146921, 'psi': 0.9083322169902039}-{'f1_val': 0.8410993746320695, 'auprc': 0.9931516280317387, 'loss_val': 0.7363423455177538, 'psi': 0.9019202759919371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=31 head_norm_before_train=1.601378 cos_to_last_merge=0.9995 (last merge round=29)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6368835199932514, 'auprc': 0.8307046359834357, 'loss_val': 1.026861184260557, 'psi': 0.7144119663893251}-{'f1_val': 0.6229131162895468, 'auprc': 0.9235233012900418, 'loss_val': 0.9508837008106437, 'psi': 0.7431571902897448}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:39815
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39803
[S14] sending update (kind=head size=1804 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9924 head_norm=1.596081
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.916027e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9924 head_norm=1.587209 delta_norm=0.191603
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39817
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=0.9841
[S15] RECEIVED delta(kind=head bytes=1804) from S14
[S15] cosine check vs S14: cos=0.9957
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.7003 head_norm=1.481840
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.186602e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.7003 head_norm=1.533753 delta_norm=0.118660
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1800) from S15
[S17] cosine check vs S15: cos=0.9781
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39807
[S7] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S7
[S6] cosine check vs S7: cos=0.9982
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.9822 head_norm=1.553527
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.389046e-02
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.9814 head_norm=1.533399 delta_norm=0.073890
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.6369 head_norm=1.644998
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.734495e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.6369 head_norm=1.590487 delta_norm=0.173450
[S17] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=2.039148 (no previous merge yet)
[S2] round=32 local utility u=0.443574 metrics={'f1_val': 0.7028167855261008, 'auprc': 0.7249705292624408, 'loss_val': 1.2050087717056228, 'psi': 0.7116782830206367}-{'f1_val': 0.6296732424849807, 'auprc': 0.7143802012409393, 'loss_val': 1.6215237667902538, 'psi': 0.6635560259873641}
[S3] START round=32 head_norm_before_train=1.457221 cos_to_last_merge=0.9998 (last merge round=30)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.6324749062868376, 'auprc': 0.8850154769844414, 'loss_val': 0.8966012318581223, 'psi': 0.7334911345658791}-{'f1_val': 0.8770471600537184, 'auprc': 0.995665581258095, 'loss_val': 0.24083046507550032, 'psi': 0.924494528535469}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=32 metric=0.6325 head_norm=1.479872
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.409745e-01
[S3] stored merged vector for next round verification (round=32)
[S3] DEBUG after merge:  round=32 metric=0.6387 head_norm=1.474131 delta_norm=0.140974
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] START round=32 head_norm_before_train=1.819107 cos_to_last_merge=0.8163 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.816
[S4] round=32 local utility u=0.029428 metrics={'f1_val': 0.9493949607545467, 'auprc': 0.9854432874907624, 'loss_val': 0.26370183791143603, 'psi': 0.9638142914490329}-{'f1_val': 0.939943847693455, 'auprc': 0.9651739219600641, 'loss_val': 0.20504344593506107, 'psi': 0.9500358774000986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=32 head_norm_before_train=1.533753 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.7139761357639205, 'auprc': 0.7941593810524439, 'loss_val': 0.4697909090211948, 'psi': 0.7460494338793298}-{'f1_val': 0.7003213174339138, 'auprc': 0.9982440959540703, 'loss_val': 0.20032764746915535, 'psi': 0.8194904288419764}
[S6] START round=32 head_norm_before_train=1.715854 cos_to_last_merge=0.9982 (last merge round=28)
[S6] round=32 local utility u=0.527551 metrics={'f1_val': 0.7371102426814152, 'auprc': 0.9490256905561296, 'loss_val': 0.4843207264501301, 'psi': 0.821876421831301}-{'f1_val': 0.6175878365464117, 'auprc': 0.8916353510342684, 'loss_val': 0.6501179753943831, 'psi': 0.7272068423415543}
[S7] START round=32 head_norm_before_train=1.648990 cos_to_last_merge=0.9999 (last merge round=30)
[S7] round=32 local utility u=0.240059 metrics={'f1_val': 0.5801589752011931, 'auprc': 0.7914105543214116, 'loss_val': 0.687058911878198, 'psi': 0.6646596068492805}-{'f1_val': 0.5245736642199469, 'auprc': 0.7791337291920556, 'loss_val': 0.7968347843591906, 'psi': 0.6263976902087904}
[S8] START round=32 head_norm_before_train=1.587209 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9920183620540944, 'auprc': 0.9979824581529497, 'loss_val': 0.053181858849085405, 'psi': 0.9944040004936365}-{'f1_val': 0.9923652907733383, 'auprc': 0.9963868534945579, 'loss_val': 0.04979811499361813, 'psi': 0.9939739158618262}
[S9] START round=32 head_norm_before_train=1.817684 cos_to_last_merge=0.7966 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.797
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9959729459758572, 'loss_val': 0.020367548402566625, 'psi': 0.9966509258976286}-{'f1_val': 0.9971029125121428, 'auprc': 0.9968609791508389, 'loss_val': 0.021086234969465014, 'psi': 0.9970061391676213}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.540990 cos_to_last_merge=0.9999 (last merge round=30)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9919664617031769, 'auprc': 0.9948952090530384, 'loss_val': 0.04914484881067534, 'psi': 0.9931379606431214}-{'f1_val': 0.992384337331391, 'auprc': 0.9951827932476334, 'loss_val': 0.05011714707014169, 'psi': 0.993503719697888}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.857252 cos_to_last_merge=0.8307 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.831
[S11] round=32 local utility u=0.003836 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9992215177241747, 'loss_val': 0.021782322982076847, 'psi': 0.9978671610654162}-{'f1_val': 0.9962430936640683, 'auprc': 0.9992895199151056, 'loss_val': 0.02533083884094753, 'psi': 0.9974616641644831}
[S13] START round=32 head_norm_before_train=1.485454 cos_to_last_merge=0.9990 (last merge round=26)
[S13] round=32 local utility u=0.087163 metrics={'f1_val': 0.6487412600834219, 'auprc': 0.6592992733894879, 'loss_val': 0.8912153995001252, 'psi': 0.6529644654058484}-{'f1_val': 0.633440198480876, 'auprc': 0.651311912381482, 'loss_val': 0.9497734935414256, 'psi': 0.6405888840411184}
[S14] START round=32 head_norm_before_train=1.516607 cos_to_last_merge=0.9897 (last merge round=25)
[S14] round=32 local utility u=0.006063 metrics={'f1_val': 0.9970013471753054, 'auprc': 0.998286640870654, 'loss_val': 0.07631514930456032, 'psi': 0.9975154646534448}-{'f1_val': 0.9970007132142444, 'auprc': 0.9968985335341451, 'loss_val': 0.08427342798885765, 'psi': 0.9969598413422047}
[S15] START round=32 head_norm_before_train=1.533399 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.9532745977505939, 'auprc': 0.99319583377275, 'loss_val': 0.09880490341657848, 'psi': 0.9692430921594564}-{'f1_val': 0.982245716884077, 'auprc': 0.992393086958054, 'loss_val': 0.07491263411292243, 'psi': 0.9863046649136678}
[S16] START round=32 head_norm_before_train=1.576549 cos_to_last_merge=0.7581 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.758
[S16] round=32 local utility u=0.507876 metrics={'f1_val': 0.9368907612612252, 'auprc': 0.9911783739023297, 'loss_val': 0.15034664159047656, 'psi': 0.958605806317667}-{'f1_val': 0.8528138865438254, 'auprc': 0.9916097126597718, 'loss_val': 0.6629319447146921, 'psi': 0.9083322169902039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=32 head_norm_before_train=1.590487 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.558888 metrics={'f1_val': 0.7071412499426335, 'auprc': 0.9354886822101243, 'loss_val': 0.6449838403631823, 'psi': 0.7984802228496298}-{'f1_val': 0.6368835199932514, 'auprc': 0.8307046359834357, 'loss_val': 1.026861184260557, 'psi': 0.7144119663893251}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39802
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:39815
[S13] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:39812
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=-0.0920
[S2] DROPPED delta from S11 (cos=-0.0920 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9978
[S15] RECEIVED delta(kind=head bytes=1804) from S14
[S15] cosine check vs S14: cos=0.9961
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S2
[S11] cosine check vs S2: cos=-0.0920
[S11] DROPPED delta from S2 (cos=-0.0920 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S6
[S2] cosine check vs S6: cos=0.9686
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39815
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.9533 head_norm=1.589881
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.362810e-02
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.9514 head_norm=1.562291 delta_norm=0.073628
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S17
[S15] cosine check vs S17: cos=0.9853
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] cosine check vs S7: cos=0.9972
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.7371 head_norm=1.732731
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.297651e-02
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.7665 head_norm=1.691359 delta_norm=0.072977
[S6] aggregate: ACCEPT kept=['S7', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=32 metric=0.7028 head_norm=2.048728
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.840221e-01
[S2] stored merged vector for next round verification (round=32)
[S2] DEBUG after merge:  round=32 metric=0.7026 head_norm=1.875941 delta_norm=0.284022
[S2] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.875941 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=33 local utility u=0.107367 metrics={'f1_val': 0.7126340960844239, 'auprc': 0.7232751162182113, 'loss_val': 1.0440930995580626, 'psi': 0.7168905041379388}-{'f1_val': 0.7028167855261008, 'auprc': 0.7249705292624408, 'loss_val': 1.2050087717056228, 'psi': 0.7116782830206367}
[S3] START round=33 head_norm_before_train=1.474131 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=33 local utility u=1.000000 metrics={'f1_val': 0.9955083205315272, 'auprc': 0.9994820508394907, 'loss_val': 0.0772122431339566, 'psi': 0.9970978126547126}-{'f1_val': 0.6324749062868376, 'auprc': 0.8850154769844414, 'loss_val': 0.8966012318581223, 'psi': 0.7334911345658791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=33 head_norm_before_train=1.823748 cos_to_last_merge=0.8162 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.816
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9410421319300557, 'auprc': 0.9736539409096862, 'loss_val': 0.19132101506628135, 'psi': 0.9540868555219079}-{'f1_val': 0.9493949607545467, 'auprc': 0.9854432874907624, 'loss_val': 0.26370183791143603, 'psi': 0.9638142914490329}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.542498 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=33 local utility u=0.361439 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9951975320921652, 'loss_val': 0.2680933889476753, 'psi': 0.8182713719316814}-{'f1_val': 0.7139761357639205, 'auprc': 0.7941593810524439, 'loss_val': 0.4697909090211948, 'psi': 0.7460494338793298}
[S6] START round=33 head_norm_before_train=1.691359 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.5962665786140184, 'auprc': 0.8062562335648642, 'loss_val': 0.7296584318280621, 'psi': 0.6802624405943567}-{'f1_val': 0.7371102426814152, 'auprc': 0.9490256905561296, 'loss_val': 0.4843207264501301, 'psi': 0.821876421831301}
[S7] START round=33 head_norm_before_train=1.655395 cos_to_last_merge=0.9998 (last merge round=30)
[S7] round=33 local utility u=0.534323 metrics={'f1_val': 0.6832059689557088, 'auprc': 0.860231653224283, 'loss_val': 0.44315778850483883, 'psi': 0.7540162426631385}-{'f1_val': 0.5801589752011931, 'auprc': 0.7914105543214116, 'loss_val': 0.687058911878198, 'psi': 0.6646596068492805}
[S8] START round=33 head_norm_before_train=1.610722 cos_to_last_merge=0.9998 (last merge round=31)
[S8] round=33 local utility u=0.002409 metrics={'f1_val': 0.9918008107316822, 'auprc': 0.9985650344152569, 'loss_val': 0.0488060805292277, 'psi': 0.9945065002051121}-{'f1_val': 0.9920183620540944, 'auprc': 0.9979824581529497, 'loss_val': 0.053181858849085405, 'psi': 0.9944040004936365}
[S9] START round=33 head_norm_before_train=1.829545 cos_to_last_merge=0.7957 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.796
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9996084485862897, 'loss_val': 0.025287493600574022, 'psi': 0.9962070070329241}-{'f1_val': 0.9971029125121428, 'auprc': 0.9959729459758572, 'loss_val': 0.020367548402566625, 'psi': 0.9966509258976286}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.569753 cos_to_last_merge=0.9998 (last merge round=30)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9911320303647527, 'auprc': 0.9945405536831443, 'loss_val': 0.04882463807769438, 'psi': 0.9924954396921093}-{'f1_val': 0.9919664617031769, 'auprc': 0.9948952090530384, 'loss_val': 0.04914484881067534, 'psi': 0.9931379606431214}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.9911 head_norm=1.596702
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.425861e-02
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.9911 head_norm=1.547913 delta_norm=0.074259
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] START round=33 head_norm_before_train=1.872860 cos_to_last_merge=0.8303 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.830
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9985656355748129, 'loss_val': 0.021997394211453525, 'psi': 0.9970943751885426}-{'f1_val': 0.9969642566262439, 'auprc': 0.9992215177241747, 'loss_val': 0.021782322982076847, 'psi': 0.9978671610654162}
[S13] START round=33 head_norm_before_train=1.501213 cos_to_last_merge=0.9986 (last merge round=26)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.6446197274155234, 'auprc': 0.6605982504436986, 'loss_val': 0.9320881743558764, 'psi': 0.6510111366267934}-{'f1_val': 0.6487412600834219, 'auprc': 0.6592992733894879, 'loss_val': 0.8912153995001252, 'psi': 0.6529644654058484}
[S14] START round=33 head_norm_before_train=1.537735 cos_to_last_merge=0.9878 (last merge round=25)
[S14] round=33 local utility u=0.002903 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.9967523871826437, 'loss_val': 0.06444489655638451, 'psi': 0.9967555968992239}-{'f1_val': 0.9970013471753054, 'auprc': 0.998286640870654, 'loss_val': 0.07631514930456032, 'psi': 0.9975154646534448}
[S15] START round=33 head_norm_before_train=1.562291 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.162072 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9962390030177075, 'loss_val': 0.042137747565605954, 'psi': 0.9962950477163676}-{'f1_val': 0.9532745977505939, 'auprc': 0.99319583377275, 'loss_val': 0.09880490341657848, 'psi': 0.9692430921594564}
[S16] START round=33 head_norm_before_train=1.593436 cos_to_last_merge=0.7567 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.757
[S16] round=33 local utility u=0.039144 metrics={'f1_val': 0.9498568932759976, 'auprc': 0.9924117355676737, 'loss_val': 0.1535552039263678, 'psi': 0.9668788301926681}-{'f1_val': 0.9368907612612252, 'auprc': 0.9911783739023297, 'loss_val': 0.15034664159047656, 'psi': 0.958605806317667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=33 head_norm_before_train=1.634026 cos_to_last_merge=0.9996 (last merge round=31)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6391735856553441, 'auprc': 0.9549366701663023, 'loss_val': 1.0280507967629913, 'psi': 0.7654788194597274}-{'f1_val': 0.7071412499426335, 'auprc': 0.9354886822101243, 'loss_val': 0.6449838403631823, 'psi': 0.7984802228496298}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39803
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:39805
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:39812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39817
[S8] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] cosine check vs S14: cos=0.9963
[S5] RECEIVED delta(kind=head bytes=1804) from S8
[S5] cosine check vs S8: cos=0.9430
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=0.9873
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.7003 head_norm=1.550038
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.715270e-01
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.7003 head_norm=1.568306 delta_norm=0.271527
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S15
[S17] cosine check vs S15: cos=0.9833
[S11] RECEIVED delta(kind=head bytes=1796) from S2
[S11] cosine check vs S2: cos=-0.0534
[S11] DROPPED delta from S2 (cos=-0.0534 < 0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.9963 head_norm=1.623145
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.822985e-02
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.9963 head_norm=1.604261 delta_norm=0.068230
[S15] aggregate: ACCEPT kept=['S17', 'S14'] (k=2/2) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=0.9984
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.5963 head_norm=1.720416
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.640842e-02
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.5963 head_norm=1.690352 delta_norm=0.056408
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.6392 head_norm=1.667803
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.521016e-01
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.6392 head_norm=1.638581 delta_norm=0.152102
[S17] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.886596 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=34 local utility u=0.001605 metrics={'f1_val': 0.7133108817912703, 'auprc': 0.7223962562624879, 'loss_val': 1.04230702354737, 'psi': 0.7169450315797574}-{'f1_val': 0.7126340960844239, 'auprc': 0.7232751162182113, 'loss_val': 1.0440930995580626, 'psi': 0.7168905041379388}
[S3] START round=34 head_norm_before_train=1.489140 cos_to_last_merge=0.9999 (last merge round=32)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9603162089582811, 'auprc': 0.9991452818451857, 'loss_val': 0.12270807714338633, 'psi': 0.9758478381130429}-{'f1_val': 0.9955083205315272, 'auprc': 0.9994820508394907, 'loss_val': 0.0772122431339566, 'psi': 0.9970978126547126}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=34 metric=0.9603 head_norm=1.506513
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.308392e-01
[S3] stored merged vector for next round verification (round=34)
[S3] DEBUG after merge:  round=34 metric=0.9603 head_norm=1.522820 delta_norm=0.130839
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] START round=34 head_norm_before_train=1.834343 cos_to_last_merge=0.8154 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.815
[S4] round=34 local utility u=0.064583 metrics={'f1_val': 0.9527893927513921, 'auprc': 0.9901329811881245, 'loss_val': 0.18207667534998817, 'psi': 0.967726828126085}-{'f1_val': 0.9410421319300557, 'auprc': 0.9736539409096862, 'loss_val': 0.19132101506628135, 'psi': 0.9540868555219079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=34 head_norm_before_train=1.568306 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.7076447486946393, 'auprc': 0.8841453940394906, 'loss_val': 0.38263223881808567, 'psi': 0.7782450068325798}-{'f1_val': 0.700320598491359, 'auprc': 0.9951975320921652, 'loss_val': 0.2680933889476753, 'psi': 0.8182713719316814}
[S6] START round=34 head_norm_before_train=1.690352 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=1.000000 metrics={'f1_val': 0.8508024154946693, 'auprc': 0.9524550354492037, 'loss_val': 0.3378274137618968, 'psi': 0.8914634634764831}-{'f1_val': 0.5962665786140184, 'auprc': 0.8062562335648642, 'loss_val': 0.7296584318280621, 'psi': 0.6802624405943567}
[S7] START round=34 head_norm_before_train=1.661660 cos_to_last_merge=0.9995 (last merge round=30)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6082606326197714, 'auprc': 0.7947246307699833, 'loss_val': 0.640144608961804, 'psi': 0.6828462318798563}-{'f1_val': 0.6832059689557088, 'auprc': 0.860231653224283, 'loss_val': 0.44315778850483883, 'psi': 0.7540162426631385}
[S8] START round=34 head_norm_before_train=1.632178 cos_to_last_merge=0.9995 (last merge round=31)
[S8] round=34 local utility u=0.002719 metrics={'f1_val': 0.992392260479464, 'auprc': 0.9984009558839341, 'loss_val': 0.04642414981412562, 'psi': 0.994795738641252}-{'f1_val': 0.9918008107316822, 'auprc': 0.9985650344152569, 'loss_val': 0.0488060805292277, 'psi': 0.9945065002051121}
[S9] START round=34 head_norm_before_train=1.839166 cos_to_last_merge=0.7950 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.795
[S9] round=34 local utility u=0.010599 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9981788338883423, 'loss_val': 0.018781279685599932, 'psi': 0.9975332810626226}-{'f1_val': 0.9939393793306803, 'auprc': 0.9996084485862897, 'loss_val': 0.025287493600574022, 'psi': 0.9962070070329241}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=34 head_norm_before_train=1.547913 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9911320303647527, 'auprc': 0.9947752402296984, 'loss_val': 0.0499232182032417, 'psi': 0.9925893143107309}-{'f1_val': 0.9911320303647527, 'auprc': 0.9945405536831443, 'loss_val': 0.04882463807769438, 'psi': 0.9924954396921093}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.887406 cos_to_last_merge=0.8299 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.830
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.997853953880907, 'loss_val': 0.022254366389225892, 'psi': 0.9968097025109803}-{'f1_val': 0.9961135349310292, 'auprc': 0.9985656355748129, 'loss_val': 0.021997394211453525, 'psi': 0.9970943751885426}
[S13] START round=34 head_norm_before_train=1.514481 cos_to_last_merge=0.9982 (last merge round=26)
[S13] round=34 local utility u=0.081079 metrics={'f1_val': 0.6400500308716414, 'auprc': 0.7260770168629768, 'loss_val': 0.9389480265800898, 'psi': 0.6744608252681755}-{'f1_val': 0.6446197274155234, 'auprc': 0.6605982504436986, 'loss_val': 0.9320881743558764, 'psi': 0.6510111366267934}
[S14] START round=34 head_norm_before_train=1.559663 cos_to_last_merge=0.9859 (last merge round=25)
[S14] round=34 local utility u=0.004506 metrics={'f1_val': 0.9970229111636145, 'auprc': 0.9972043636842545, 'loss_val': 0.05838047664820823, 'psi': 0.9970954921718705}-{'f1_val': 0.9967577367102773, 'auprc': 0.9967523871826437, 'loss_val': 0.06444489655638451, 'psi': 0.9967555968992239}
[S15] START round=34 head_norm_before_train=1.604261 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7809492009082757, 'auprc': 0.8895738216949337, 'loss_val': 0.45918609362516805, 'psi': 0.8243990492229389}-{'f1_val': 0.9963324108488076, 'auprc': 0.9962390030177075, 'loss_val': 0.042137747565605954, 'psi': 0.9962950477163676}
[S16] START round=34 head_norm_before_train=1.608275 cos_to_last_merge=0.7555 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.756
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8559279685263372, 'auprc': 0.9896880686140132, 'loss_val': 0.7074165663579326, 'psi': 0.9094320085614076}-{'f1_val': 0.9498568932759976, 'auprc': 0.9924117355676737, 'loss_val': 0.1535552039263678, 'psi': 0.9668788301926681}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.638581 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6299937275954959, 'auprc': 0.8230581852426728, 'loss_val': 1.0448962850627999, 'psi': 0.7072195106543666}-{'f1_val': 0.6391735856553441, 'auprc': 0.9549366701663023, 'loss_val': 1.0280507967629913, 'psi': 0.7654788194597274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39808
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] cosine check vs S6: cos=0.9991
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.6083 head_norm=1.666815
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.175104e-02
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.6118 head_norm=1.687557 delta_norm=0.041751
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.900463 cos_to_last_merge=0.9999 (last merge round=32)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7136513307524537, 'auprc': 0.7239607404690338, 'loss_val': 1.0551150100535114, 'psi': 0.7177750946390857}-{'f1_val': 0.7133108817912703, 'auprc': 0.7223962562624879, 'loss_val': 1.04230702354737, 'psi': 0.7169450315797574}
[S3] START round=35 head_norm_before_train=1.522820 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=35 local utility u=0.114653 metrics={'f1_val': 0.9912594673287659, 'auprc': 0.9997031961375581, 'loss_val': 0.08073499586687632, 'psi': 0.9946369588522828}-{'f1_val': 0.9603162089582811, 'auprc': 0.9991452818451857, 'loss_val': 0.12270807714338633, 'psi': 0.9758478381130429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=35 head_norm_before_train=1.843863 cos_to_last_merge=0.8150 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.815
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9493635680733433, 'auprc': 0.9691516689538202, 'loss_val': 0.2274109755441871, 'psi': 0.9572788084255341}-{'f1_val': 0.9527893927513921, 'auprc': 0.9901329811881245, 'loss_val': 0.18207667534998817, 'psi': 0.967726828126085}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.573256 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=35 local utility u=1.000000 metrics={'f1_val': 0.9947807161038388, 'auprc': 0.9981108828635297, 'loss_val': 0.17157934790712742, 'psi': 0.9961127828077152}-{'f1_val': 0.7076447486946393, 'auprc': 0.8841453940394906, 'loss_val': 0.38263223881808567, 'psi': 0.7782450068325798}
[S6] START round=35 head_norm_before_train=1.709069 cos_to_last_merge=0.9999 (last merge round=33)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.8133314958471535, 'auprc': 0.9538400856907077, 'loss_val': 0.4379870329089559, 'psi': 0.8695349317845751}-{'f1_val': 0.8508024154946693, 'auprc': 0.9524550354492037, 'loss_val': 0.3378274137618968, 'psi': 0.8914634634764831}
[S7] START round=35 head_norm_before_train=1.687557 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.000160 metrics={'f1_val': 0.6093950765715836, 'auprc': 0.7928543463367557, 'loss_val': 0.6410206793256976, 'psi': 0.6827787844776525}-{'f1_val': 0.6082606326197714, 'auprc': 0.7947246307699833, 'loss_val': 0.640144608961804, 'psi': 0.6828462318798563}
[S8] START round=35 head_norm_before_train=1.658090 cos_to_last_merge=0.9990 (last merge round=31)
[S8] round=35 local utility u=0.001171 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9985212400998491, 'loss_val': 0.043076361407443614, 'psi': 0.994707265712971}-{'f1_val': 0.992392260479464, 'auprc': 0.9984009558839341, 'loss_val': 0.04642414981412562, 'psi': 0.994795738641252}
[S9] START round=35 head_norm_before_train=1.848740 cos_to_last_merge=0.7944 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.794
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9888785659900814, 'auprc': 0.9999129586545048, 'loss_val': 0.04141270535325055, 'psi': 0.9932923230558508}-{'f1_val': 0.9971029125121428, 'auprc': 0.9981788338883423, 'loss_val': 0.018781279685599932, 'psi': 0.9975332810626226}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.572388 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9861614393444839, 'auprc': 0.9940389841150856, 'loss_val': 0.05460128180408268, 'psi': 0.9893124572527245}-{'f1_val': 0.9911320303647527, 'auprc': 0.9947752402296984, 'loss_val': 0.0499232182032417, 'psi': 0.9925893143107309}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.900863 cos_to_last_merge=0.8294 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.829
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9905059559087509, 'auprc': 0.9993260059343878, 'loss_val': 0.04275676862499593, 'psi': 0.9940339759190057}-{'f1_val': 0.9961135349310292, 'auprc': 0.997853953880907, 'loss_val': 0.022254366389225892, 'psi': 0.9968097025109803}
[S13] START round=35 head_norm_before_train=1.527851 cos_to_last_merge=0.9978 (last merge round=26)
[S13] round=35 local utility u=0.656802 metrics={'f1_val': 0.7732522417973802, 'auprc': 0.7814573512975325, 'loss_val': 0.5906983897712871, 'psi': 0.7765342855974411}-{'f1_val': 0.6400500308716414, 'auprc': 0.7260770168629768, 'loss_val': 0.9389480265800898, 'psi': 0.6744608252681755}
[S14] START round=35 head_norm_before_train=1.578061 cos_to_last_merge=0.9842 (last merge round=25)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9987514272841902, 'loss_val': 0.06746884064197939, 'psi': 0.9978467079710994}-{'f1_val': 0.9970229111636145, 'auprc': 0.9972043636842545, 'loss_val': 0.05838047664820823, 'psi': 0.9970954921718705}
[S15] START round=35 head_norm_before_train=1.659170 cos_to_last_merge=0.9995 (last merge round=33)
[S15] round=35 local utility u=0.964346 metrics={'f1_val': 0.98267473081402, 'auprc': 0.9938423769415254, 'loss_val': 0.05365360059069218, 'psi': 0.9871417892650222}-{'f1_val': 0.7809492009082757, 'auprc': 0.8895738216949337, 'loss_val': 0.45918609362516805, 'psi': 0.8243990492229389}
[S16] START round=35 head_norm_before_train=1.620135 cos_to_last_merge=0.7546 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.755
[S16] round=35 local utility u=0.730297 metrics={'f1_val': 0.9884550648518249, 'auprc': 0.9947384749437871, 'loss_val': 0.057136139806386294, 'psi': 0.9909684288886097}-{'f1_val': 0.8559279685263372, 'auprc': 0.9896880686140132, 'loss_val': 0.7074165663579326, 'psi': 0.9094320085614076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=35 head_norm_before_train=1.676100 cos_to_last_merge=0.9997 (last merge round=33)
[S17] round=35 local utility u=0.163172 metrics={'f1_val': 0.6358115520980678, 'auprc': 0.9001974024701673, 'loss_val': 0.9848776902628, 'psi': 0.7415658922469077}-{'f1_val': 0.6299937275954959, 'auprc': 0.8230581852426728, 'loss_val': 1.0448962850627999, 'psi': 0.7072195106543666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.007 → S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:39817
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S15
[S17] cosine check vs S15: cos=0.9938
[S2] ⇄ pheromone p=0.084 → S11@127.0.0.1:39812
[S6] ⇄ pheromone p=0.345 → S7@127.0.0.1:39808
[S15] ⇄ pheromone p=0.407 → S17@127.0.0.1:39817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S15@127.0.0.1:39815
[S17] sending update (kind=head size=1807 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] cosine check vs S7: cos=0.9993
[S15] RECEIVED delta(kind=head bytes=1807) from S17
[S15] cosine check vs S17: cos=0.9938
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=35 metric=0.6358 head_norm=1.719153
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.550267e-02
[S17] stored merged vector for next round verification (round=35)
[S17] DEBUG after merge:  round=35 metric=0.6358 head_norm=1.712112 delta_norm=0.095503
[S17] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.131 → S15@127.0.0.1:39815
[S7] ⇄ pheromone p=0.154 → S6@127.0.0.1:39807
[S2] START round=36 head_norm_before_train=1.917198 cos_to_last_merge=0.9997 (last merge round=32)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.6731512605893795, 'auprc': 0.7243381421010043, 'loss_val': 1.2246615249477053, 'psi': 0.6936260131940294}-{'f1_val': 0.7136513307524537, 'auprc': 0.7239607404690338, 'loss_val': 1.0551150100535114, 'psi': 0.7177750946390857}
[S3] START round=36 head_norm_before_train=1.540533 cos_to_last_merge=0.9999 (last merge round=34)
[S3] round=36 local utility u=0.005004 metrics={'f1_val': 0.991152338253556, 'auprc': 0.9996900662651158, 'loss_val': 0.0700447934441733, 'psi': 0.9945674294581799}-{'f1_val': 0.9912594673287659, 'auprc': 0.9997031961375581, 'loss_val': 0.08073499586687632, 'psi': 0.9946369588522828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=36 head_norm_before_train=1.848444 cos_to_last_merge=0.8148 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.815
[S4] round=36 local utility u=0.010676 metrics={'f1_val': 0.9509878909426862, 'auprc': 0.9679057794479107, 'loss_val': 0.212067240943871, 'psi': 0.9577550463447759}-{'f1_val': 0.9493635680733433, 'auprc': 0.9691516689538202, 'loss_val': 0.2274109755441871, 'psi': 0.9572788084255341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=36 head_norm_before_train=1.580033 cos_to_last_merge=0.9998 (last merge round=33)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.8858012204606899, 'auprc': 0.9937121797206265, 'loss_val': 0.1884205073901874, 'psi': 0.9289656041646646}-{'f1_val': 0.9947807161038388, 'auprc': 0.9981108828635297, 'loss_val': 0.17157934790712742, 'psi': 0.9961127828077152}
[S6] START round=36 head_norm_before_train=1.732036 cos_to_last_merge=0.9996 (last merge round=33)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.6002030087730602, 'auprc': 0.935815387863144, 'loss_val': 0.7094100245405819, 'psi': 0.7344479604090938}-{'f1_val': 0.8133314958471535, 'auprc': 0.9538400856907077, 'loss_val': 0.4379870329089559, 'psi': 0.8695349317845751}
[S7] START round=36 head_norm_before_train=1.692388 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=36 local utility u=0.389602 metrics={'f1_val': 0.6841505667224377, 'auprc': 0.8366704289868424, 'loss_val': 0.44179845445691146, 'psi': 0.7451585116281996}-{'f1_val': 0.6093950765715836, 'auprc': 0.7928543463367557, 'loss_val': 0.6410206793256976, 'psi': 0.6827787844776525}
[S8] START round=36 head_norm_before_train=1.685786 cos_to_last_merge=0.9984 (last merge round=31)
[S8] round=36 local utility u=0.003577 metrics={'f1_val': 0.9931148882341876, 'auprc': 0.9984460451549764, 'loss_val': 0.041399095320839456, 'psi': 0.9952473510025032}-{'f1_val': 0.9921646161217188, 'auprc': 0.9985212400998491, 'loss_val': 0.043076361407443614, 'psi': 0.994707265712971}
[S9] START round=36 head_norm_before_train=1.858456 cos_to_last_merge=0.7937 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.794
[S9] round=36 local utility u=0.032740 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9975707162639016, 'loss_val': 0.018251204078497674, 'psi': 0.9972900340128463}-{'f1_val': 0.9888785659900814, 'auprc': 0.9999129586545048, 'loss_val': 0.04141270535325055, 'psi': 0.9932923230558508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=36 head_norm_before_train=1.598826 cos_to_last_merge=0.9998 (last merge round=33)
[S10] round=36 local utility u=0.006793 metrics={'f1_val': 0.9878115672463043, 'auprc': 0.994189433793906, 'loss_val': 0.051368163317960375, 'psi': 0.990362713865345}-{'f1_val': 0.9861614393444839, 'auprc': 0.9940389841150856, 'loss_val': 0.05460128180408268, 'psi': 0.9893124572527245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=36 head_norm_before_train=1.913492 cos_to_last_merge=0.8287 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.829
[S11] round=36 local utility u=0.026980 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9986608813022282, 'loss_val': 0.020447202163270877, 'psi': 0.9971324734795087}-{'f1_val': 0.9905059559087509, 'auprc': 0.9993260059343878, 'loss_val': 0.04275676862499593, 'psi': 0.9940339759190057}
[S13] START round=36 head_norm_before_train=1.535452 cos_to_last_merge=0.9976 (last merge round=26)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.6318703637364393, 'auprc': 0.6591338521412214, 'loss_val': 1.092240904143837, 'psi': 0.6427757590983522}-{'f1_val': 0.7732522417973802, 'auprc': 0.7814573512975325, 'loss_val': 0.5906983897712871, 'psi': 0.7765342855974411}
[S14] START round=36 head_norm_before_train=1.594298 cos_to_last_merge=0.9826 (last merge round=25)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9968337624308853, 'auprc': 0.9974236948554109, 'loss_val': 0.07352017551051272, 'psi': 0.9970697354006955}-{'f1_val': 0.9972435617623723, 'auprc': 0.9987514272841902, 'loss_val': 0.06746884064197939, 'psi': 0.9978467079710994}
[S15] START round=36 head_norm_before_train=1.710383 cos_to_last_merge=0.9984 (last merge round=33)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.7315298495206538, 'loss_val': 0.6905574976862945, 'psi': 0.7131621261100356}-{'f1_val': 0.98267473081402, 'auprc': 0.9938423769415254, 'loss_val': 0.05365360059069218, 'psi': 0.9871417892650222}
[S16] START round=36 head_norm_before_train=1.631562 cos_to_last_merge=0.7539 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.754
[S16] round=36 local utility u=0.014046 metrics={'f1_val': 0.9917527102534209, 'auprc': 0.9939862607478304, 'loss_val': 0.04657356015989926, 'psi': 0.9926461304511847}-{'f1_val': 0.9884550648518249, 'auprc': 0.9947384749437871, 'loss_val': 0.057136139806386294, 'psi': 0.9909684288886097}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=36 head_norm_before_train=1.712112 cos_to_last_merge=1.0000 (last merge round=35)
[S17] round=36 local utility u=0.639965 metrics={'f1_val': 0.7575318025640101, 'auprc': 0.9471780846899581, 'loss_val': 0.5762113349445167, 'psi': 0.8333903154143893}-{'f1_val': 0.6358115520980678, 'auprc': 0.9001974024701673, 'loss_val': 0.9848776902628, 'psi': 0.7415658922469077}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39802
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.995)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=-0.0544
[S2] DROPPED delta from S11 (cos=-0.0544 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.6002 head_norm=1.756898
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.493344e-02
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.6001 head_norm=1.724070 delta_norm=0.054933
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.7009 head_norm=1.747041
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.030283e-01
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.7009 head_norm=1.730088 delta_norm=0.103028
[S15] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → trigger blocked (psi=0.833)
[S7] not sending this round → trigger blocked (psi=0.745)
[S2] START round=37 head_norm_before_train=1.941927 cos_to_last_merge=0.9993 (last merge round=32)
[S2] round=37 local utility u=0.199571 metrics={'f1_val': 0.714890026630737, 'auprc': 0.7237508563242433, 'loss_val': 1.074190561808377, 'psi': 0.7184343585081394}-{'f1_val': 0.6731512605893795, 'auprc': 0.7243381421010043, 'loss_val': 1.2246615249477053, 'psi': 0.6936260131940294}
[S3] START round=37 head_norm_before_train=1.557155 cos_to_last_merge=0.9996 (last merge round=34)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.960110729356964, 'auprc': 0.9963163173533671, 'loss_val': 0.13070126493327813, 'psi': 0.9745929645555251}-{'f1_val': 0.991152338253556, 'auprc': 0.9996900662651158, 'loss_val': 0.0700447934441733, 'psi': 0.9945674294581799}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.856017 cos_to_last_merge=0.8143 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.814
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9514599598991398, 'auprc': 0.9689532337118361, 'loss_val': 0.22796614947568403, 'psi': 0.9584572694242183}-{'f1_val': 0.9509878909426862, 'auprc': 0.9679057794479107, 'loss_val': 0.212067240943871, 'psi': 0.9577550463447759}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.592085 cos_to_last_merge=0.9996 (last merge round=33)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9965425480027886, 'loss_val': 0.1701849473949567, 'psi': 0.8188093782959309}-{'f1_val': 0.8858012204606899, 'auprc': 0.9937121797206265, 'loss_val': 0.1884205073901874, 'psi': 0.9289656041646646}
[S6] START round=37 head_norm_before_train=1.724070 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.967783 metrics={'f1_val': 0.8443372854467942, 'auprc': 0.9692780111747212, 'loss_val': 0.3390374381240034, 'psi': 0.894313575737965}-{'f1_val': 0.6002030087730602, 'auprc': 0.935815387863144, 'loss_val': 0.7094100245405819, 'psi': 0.7344479604090938}
[S7] START round=37 head_norm_before_train=1.699288 cos_to_last_merge=0.9999 (last merge round=34)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.593261844089628, 'auprc': 0.7927072732483958, 'loss_val': 0.6626228403118934, 'psi': 0.6730400157531351}-{'f1_val': 0.6841505667224377, 'auprc': 0.8366704289868424, 'loss_val': 0.44179845445691146, 'psi': 0.7451585116281996}
[S8] START round=37 head_norm_before_train=1.706598 cos_to_last_merge=0.9978 (last merge round=31)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9885656966123193, 'auprc': 0.9987147491745582, 'loss_val': 0.04499443686828762, 'psi': 0.9926253176372148}-{'f1_val': 0.9931148882341876, 'auprc': 0.9984460451549764, 'loss_val': 0.041399095320839456, 'psi': 0.9952473510025032}
[S9] START round=37 head_norm_before_train=1.867735 cos_to_last_merge=0.7931 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.793
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9950454876695187, 'loss_val': 0.019821350848179344, 'psi': 0.9960336898266648}-{'f1_val': 0.9971029125121428, 'auprc': 0.9975707162639016, 'loss_val': 0.018251204078497674, 'psi': 0.9972900340128463}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.623014 cos_to_last_merge=0.9997 (last merge round=33)
[S10] round=37 local utility u=0.000953 metrics={'f1_val': 0.9878115672463043, 'auprc': 0.9944591799993237, 'loss_val': 0.05027170435909427, 'psi': 0.990470612347512}-{'f1_val': 0.9878115672463043, 'auprc': 0.994189433793906, 'loss_val': 0.051368163317960375, 'psi': 0.990362713865345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=37 head_norm_before_train=1.923912 cos_to_last_merge=0.8281 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.828
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9980958927821875, 'loss_val': 0.02125691683129274, 'psi': 0.9969064780714925}-{'f1_val': 0.9961135349310292, 'auprc': 0.9986608813022282, 'loss_val': 0.020447202163270877, 'psi': 0.9971324734795087}
[S13] START round=37 head_norm_before_train=1.545297 cos_to_last_merge=0.9973 (last merge round=26)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6260037652085004, 'auprc': 0.6521068426108746, 'loss_val': 1.1055628926284098, 'psi': 0.63644499616945}-{'f1_val': 0.6318703637364393, 'auprc': 0.6591338521412214, 'loss_val': 1.092240904143837, 'psi': 0.6427757590983522}
[S14] START round=37 head_norm_before_train=1.609066 cos_to_last_merge=0.9812 (last merge round=25)
[S14] round=37 local utility u=0.012599 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9968184138698027, 'loss_val': 0.04995366484463407, 'psi': 0.9971723272489564}-{'f1_val': 0.9968337624308853, 'auprc': 0.9974236948554109, 'loss_val': 0.07352017551051272, 'psi': 0.9970697354006955}
[S15] START round=37 head_norm_before_train=1.730088 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=1.000000 metrics={'f1_val': 0.9967662976850173, 'auprc': 0.9978504882062205, 'loss_val': 0.026894221996735582, 'psi': 0.9971999738934986}-{'f1_val': 0.7009169771696235, 'auprc': 0.7315298495206538, 'loss_val': 0.6905574976862945, 'psi': 0.7131621261100356}
[S16] START round=37 head_norm_before_train=1.642599 cos_to_last_merge=0.7531 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.753
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9398438411104529, 'auprc': 0.9915706857382065, 'loss_val': 0.2053504572111107, 'psi': 0.9605345789615545}-{'f1_val': 0.9917527102534209, 'auprc': 0.9939862607478304, 'loss_val': 0.04657356015989926, 'psi': 0.9926461304511847}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.746858 cos_to_last_merge=0.9997 (last merge round=35)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6264788545756305, 'auprc': 0.8268297928305333, 'loss_val': 1.0763417204055636, 'psi': 0.7066192298775916}-{'f1_val': 0.7575318025640101, 'auprc': 0.9471780846899581, 'loss_val': 0.5762113349445167, 'psi': 0.8333903154143893}
[S2]  timeout peer S6
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:39812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39817
[S6] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S6
[S7] cosine check vs S6: cos=0.9989
[S17] RECEIVED delta(kind=head bytes=1799) from S15
[S17] cosine check vs S15: cos=0.9989
[S11] RECEIVED delta(kind=head bytes=1802) from S2
[S11] cosine check vs S2: cos=-0.0547
[S11] DROPPED delta from S2 (cos=-0.0547 < 0.0)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.5933 head_norm=1.704952
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.432825e-02
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.6014 head_norm=1.724281 delta_norm=0.044328
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=37 metric=0.6265 head_norm=1.770254
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.283250e-02
[S17] stored merged vector for next round verification (round=37)
[S17] DEBUG after merge:  round=37 metric=0.6308 head_norm=1.762880 delta_norm=0.042832
[S17] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.960912 cos_to_last_merge=0.9990 (last merge round=32)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6971759445559944, 'auprc': 0.7234492400712803, 'loss_val': 1.1019124129174567, 'psi': 0.7076852627621089}-{'f1_val': 0.714890026630737, 'auprc': 0.7237508563242433, 'loss_val': 1.074190561808377, 'psi': 0.7184343585081394}
[S3] START round=38 head_norm_before_train=1.574778 cos_to_last_merge=0.9991 (last merge round=34)
[S3] round=38 local utility u=0.115984 metrics={'f1_val': 0.9855888146977344, 'auprc': 0.9996584368055349, 'loss_val': 0.06162842489517353, 'psi': 0.9912166635408546}-{'f1_val': 0.960110729356964, 'auprc': 0.9963163173533671, 'loss_val': 0.13070126493327813, 'psi': 0.9745929645555251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=38 head_norm_before_train=1.861735 cos_to_last_merge=0.8139 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.814
[S4] round=38 local utility u=0.002340 metrics={'f1_val': 0.9482750339647488, 'auprc': 0.9474106094474135, 'loss_val': 0.13954860918047882, 'psi': 0.9479292641578146}-{'f1_val': 0.9514599598991398, 'auprc': 0.9689532337118361, 'loss_val': 0.22796614947568403, 'psi': 0.9584572694242183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=38 head_norm_before_train=1.606275 cos_to_last_merge=0.9995 (last merge round=33)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.7113128256346475, 'auprc': 0.8956583241579099, 'loss_val': 0.37775928395281955, 'psi': 0.7850510250439524}-{'f1_val': 0.700320598491359, 'auprc': 0.9965425480027886, 'loss_val': 0.1701849473949567, 'psi': 0.8188093782959309}
[S6] START round=38 head_norm_before_train=1.744522 cos_to_last_merge=0.9999 (last merge round=36)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.6574355504893832, 'auprc': 0.9113614449855962, 'loss_val': 0.49663155669500747, 'psi': 0.7590059082878684}-{'f1_val': 0.8443372854467942, 'auprc': 0.9692780111747212, 'loss_val': 0.3390374381240034, 'psi': 0.894313575737965}
[S7] START round=38 head_norm_before_train=1.724281 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.093100 metrics={'f1_val': 0.614469076095461, 'auprc': 0.7976931139494393, 'loss_val': 0.6186232136990242, 'psi': 0.6877586912370524}-{'f1_val': 0.593261844089628, 'auprc': 0.7927072732483958, 'loss_val': 0.6626228403118934, 'psi': 0.6730400157531351}
[S8] START round=38 head_norm_before_train=1.726922 cos_to_last_merge=0.9973 (last merge round=31)
[S8] round=38 local utility u=0.010639 metrics={'f1_val': 0.9929205408612032, 'auprc': 0.9961662109944724, 'loss_val': 0.04220084293619957, 'psi': 0.9942188089145109}-{'f1_val': 0.9885656966123193, 'auprc': 0.9987147491745582, 'loss_val': 0.04499443686828762, 'psi': 0.9926253176372148}
[S9] START round=38 head_norm_before_train=1.875772 cos_to_last_merge=0.7926 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.793
[S9] round=38 local utility u=0.005302 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9973338487688566, 'loss_val': 0.018544323894077668, 'psi': 0.9971952870148283}-{'f1_val': 0.9966924912647621, 'auprc': 0.9950454876695187, 'loss_val': 0.019821350848179344, 'psi': 0.9960336898266648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=38 head_norm_before_train=1.644055 cos_to_last_merge=0.9994 (last merge round=33)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9791860602969286, 'auprc': 0.9939134515946813, 'loss_val': 0.05624727459791836, 'psi': 0.9850770168160297}-{'f1_val': 0.9878115672463043, 'auprc': 0.9944591799993237, 'loss_val': 0.05027170435909427, 'psi': 0.990470612347512}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.933901 cos_to_last_merge=0.8276 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.828
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9177108618141723, 'auprc': 0.9993347373830663, 'loss_val': 0.22868086976355081, 'psi': 0.9503604120417298}-{'f1_val': 0.9961135349310292, 'auprc': 0.9980958927821875, 'loss_val': 0.02125691683129274, 'psi': 0.9969064780714925}
[S13] START round=38 head_norm_before_train=1.554997 cos_to_last_merge=0.9971 (last merge round=26)
[S13] round=38 local utility u=0.065253 metrics={'f1_val': 0.6364087876510796, 'auprc': 0.6467956623825867, 'loss_val': 1.021552749444437, 'psi': 0.6405635375436824}-{'f1_val': 0.6260037652085004, 'auprc': 0.6521068426108746, 'loss_val': 1.1055628926284098, 'psi': 0.63644499616945}
[S14] START round=38 head_norm_before_train=1.623803 cos_to_last_merge=0.9798 (last merge round=25)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9969910436891155, 'auprc': 0.9968711376529766, 'loss_val': 0.056024001565465026, 'psi': 0.99694308127466}-{'f1_val': 0.9974082695017256, 'auprc': 0.9968184138698027, 'loss_val': 0.04995366484463407, 'psi': 0.9971723272489564}
[S15] START round=38 head_norm_before_train=1.756520 cos_to_last_merge=0.9999 (last merge round=36)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7012218451287537, 'auprc': 0.7060171442464815, 'loss_val': 0.7279624295608229, 'psi': 0.703139964775845}-{'f1_val': 0.9967662976850173, 'auprc': 0.9978504882062205, 'loss_val': 0.026894221996735582, 'psi': 0.9971999738934986}
[S16] START round=38 head_norm_before_train=1.653950 cos_to_last_merge=0.7524 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.752
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8523214527897569, 'auprc': 0.8980852981529184, 'loss_val': 0.8135592898382384, 'psi': 0.8706269909350215}-{'f1_val': 0.9398438411104529, 'auprc': 0.9915706857382065, 'loss_val': 0.2053504572111107, 'psi': 0.9605345789615545}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.762880 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=38 local utility u=0.052553 metrics={'f1_val': 0.6333766818380336, 'auprc': 0.8694909209160098, 'loss_val': 1.1406066402758084, 'psi': 0.7278223774692241}-{'f1_val': 0.6264788545756305, 'auprc': 0.8268297928305333, 'loss_val': 1.0763417204055636, 'psi': 0.7066192298775916}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[S7] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=0.9993
[S15] RECEIVED delta(kind=head bytes=1802) from S17
[S15] cosine check vs S17: cos=0.9992
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=38 metric=0.6574 head_norm=1.764166
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.702177e-02
[S6] stored merged vector for next round verification (round=38)
[S6] DEBUG after merge:  round=38 metric=0.6574 head_norm=1.746674 delta_norm=0.037022
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.976906 cos_to_last_merge=0.9986 (last merge round=32)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6846692369760233, 'auprc': 0.7288797887886374, 'loss_val': 1.1678342843094336, 'psi': 0.7023534577010689}-{'f1_val': 0.6971759445559944, 'auprc': 0.7234492400712803, 'loss_val': 1.1019124129174567, 'psi': 0.7076852627621089}
[S3] START round=39 head_norm_before_train=1.591674 cos_to_last_merge=0.9985 (last merge round=34)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.984174708061025, 'auprc': 0.999157841309444, 'loss_val': 0.07060395629723473, 'psi': 0.9901679613603926}-{'f1_val': 0.9855888146977344, 'auprc': 0.9996584368055349, 'loss_val': 0.06162842489517353, 'psi': 0.9912166635408546}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.990 u=0.0000 p_local=0.1302 f1=0.984 auprc=0.999 bytes=44952
[S4] START round=39 head_norm_before_train=1.865926 cos_to_last_merge=0.8136 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.814
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9525430728836525, 'auprc': 0.9714164662955882, 'loss_val': 0.2658403170133425, 'psi': 0.9600924302484267}-{'f1_val': 0.9482750339647488, 'auprc': 0.9474106094474135, 'loss_val': 0.13954860918047882, 'psi': 0.9479292641578146}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.960 u=0.0000 p_local=0.0121 f1=0.953 auprc=0.971 bytes=46804
[S5] START round=39 head_norm_before_train=1.618683 cos_to_last_merge=0.9991 (last merge round=33)
[S5] round=39 local utility u=0.214450 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9939829174989057, 'loss_val': 0.1778793529499842, 'psi': 0.8177855260943776}-{'f1_val': 0.7113128256346475, 'auprc': 0.8956583241579099, 'loss_val': 0.37775928395281955, 'psi': 0.7850510250439524}
[S6] START round=39 head_norm_before_train=1.746674 cos_to_last_merge=1.0000 (last merge round=38)
[S6] round=39 local utility u=0.631820 metrics={'f1_val': 0.8206488431582755, 'auprc': 0.9703739783962233, 'loss_val': 0.38930936406803285, 'psi': 0.8805388972534547}-{'f1_val': 0.6574355504893832, 'auprc': 0.9113614449855962, 'loss_val': 0.49663155669500747, 'psi': 0.7590059082878684}
[S7] START round=39 head_norm_before_train=1.729799 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=39 local utility u=0.255459 metrics={'f1_val': 0.6626025857063544, 'auprc': 0.8220182013425611, 'loss_val': 0.4694811171480122, 'psi': 0.7263688319608371}-{'f1_val': 0.614469076095461, 'auprc': 0.7976931139494393, 'loss_val': 0.6186232136990242, 'psi': 0.6877586912370524}
[S8] START round=39 head_norm_before_train=1.743915 cos_to_last_merge=0.9967 (last merge round=31)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9836013959184189, 'auprc': 0.9986693458935626, 'loss_val': 0.055028194323515696, 'psi': 0.9896285759084764}-{'f1_val': 0.9929205408612032, 'auprc': 0.9961662109944724, 'loss_val': 0.04220084293619957, 'psi': 0.9942188089145109}
[S9] START round=39 head_norm_before_train=1.883679 cos_to_last_merge=0.7920 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.792
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9994986770003285, 'loss_val': 0.019066224247894756, 'psi': 0.9971653570739933}-{'f1_val': 0.9971029125121428, 'auprc': 0.9973338487688566, 'loss_val': 0.018544323894077668, 'psi': 0.9971952870148283}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.997 u=0.0000 p_local=0.0067 f1=0.996 auprc=0.999 bytes=45043
[S10] START round=39 head_norm_before_train=1.665108 cos_to_last_merge=0.9992 (last merge round=33)
[S10] round=39 local utility u=0.032473 metrics={'f1_val': 0.9878115672463043, 'auprc': 0.9956646410932318, 'loss_val': 0.048307060566989725, 'psi': 0.9909527967850753}-{'f1_val': 0.9791860602969286, 'auprc': 0.9939134515946813, 'loss_val': 0.05624727459791836, 'psi': 0.9850770168160297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S10] r=40 psi=0.991 u=0.0325 p_local=0.0103 f1=0.988 auprc=0.996 bytes=41350
[S11] START round=39 head_norm_before_train=1.942274 cos_to_last_merge=0.8270 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.827
[S11] round=39 local utility u=0.338080 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9985460547677611, 'loss_val': 0.020571645260749137, 'psi': 0.9970865428657218}-{'f1_val': 0.9177108618141723, 'auprc': 0.9993347373830663, 'loss_val': 0.22868086976355081, 'psi': 0.9503604120417298}
[S13] START round=39 head_norm_before_train=1.564523 cos_to_last_merge=0.9968 (last merge round=26)
[S13] round=39 local utility u=0.028334 metrics={'f1_val': 0.6339610681699931, 'auprc': 0.6731182213688277, 'loss_val': 1.029166671584582, 'psi': 0.649623929449527}-{'f1_val': 0.6364087876510796, 'auprc': 0.6467956623825867, 'loss_val': 1.021552749444437, 'psi': 0.6405635375436824}
[S14] START round=39 head_norm_before_train=1.636722 cos_to_last_merge=0.9785 (last merge round=25)
[S14] round=39 local utility u=0.010193 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9994484282631313, 'loss_val': 0.04833972831421294, 'psi': 0.9984710820855836}-{'f1_val': 0.9969910436891155, 'auprc': 0.9968711376529766, 'loss_val': 0.056024001565465026, 'psi': 0.99694308127466}
[S15] START round=39 head_norm_before_train=1.775437 cos_to_last_merge=0.9998 (last merge round=36)
[S15] round=39 local utility u=1.000000 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9968986014349842, 'loss_val': 0.0391278644938157, 'psi': 0.9965847487601874}-{'f1_val': 0.7012218451287537, 'auprc': 0.7060171442464815, 'loss_val': 0.7279624295608229, 'psi': 0.703139964775845}
[S16] START round=39 head_norm_before_train=1.661987 cos_to_last_merge=0.7518 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.752
[S16] round=39 local utility u=0.926916 metrics={'f1_val': 0.9878218264510596, 'auprc': 0.9920911186382361, 'loss_val': 0.05474666282134214, 'psi': 0.9895295433259302}-{'f1_val': 0.8523214527897569, 'auprc': 0.8980852981529184, 'loss_val': 0.8135592898382384, 'psi': 0.8706269909350215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S16] r=40 psi=0.990 u=0.9269 p_local=0.2930 f1=0.988 auprc=0.992 bytes=41272
[S17] START round=39 head_norm_before_train=1.786755 cos_to_last_merge=0.9999 (last merge round=37)
[S17] round=39 local utility u=0.385494 metrics={'f1_val': 0.6761643010220115, 'auprc': 0.9489849280613442, 'loss_val': 0.8648254344346078, 'psi': 0.7852925518377446}-{'f1_val': 0.6333766818380336, 'auprc': 0.8694909209160098, 'loss_val': 1.1406066402758084, 'psi': 0.7278223774692241}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] r=40 psi=0.650 u=0.0283 p_local=0.1039 f1=0.634 auprc=0.673 bytes=39551
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39817
[S14] r=40 psi=0.998 u=0.0102 p_local=0.0103 f1=0.998 auprc=0.999 bytes=53977
[S8] r=40 psi=0.990 u=0.0000 p_local=0.0138 f1=0.984 auprc=0.999 bytes=43161
[S5] r=40 psi=0.818 u=0.2145 p_local=0.1757 f1=0.700 auprc=0.994 bytes=37731
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39808
[S2] r=40 psi=0.702 u=0.0000 p_local=0.0599 f1=0.685 auprc=0.729 bytes=32381
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=-0.0553
[S2] DROPPED delta from S11 (cos=-0.0553 < 0.0)
[S6] sending update (kind=head size=1802 to 1 peers)
[S11] r=40 psi=0.997 u=0.3381 p_local=0.0731 f1=0.996 auprc=0.999 bytes=53944
[S15] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S15
[S17] cosine check vs S15: cos=0.9984
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] cosine check vs S6: cos=0.9995
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.9964 head_norm=1.785687
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.171125e-02
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.9964 head_norm=1.785734 delta_norm=0.041711
[S15] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.997 u=1.0000 p_local=0.4945 f1=0.996 auprc=0.997 bytes=41378
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39815
[S7] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] cosine check vs S7: cos=0.9995
[S15] RECEIVED delta(kind=head bytes=1801) from S17
[S15] cosine check vs S17: cos=0.9994
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=39 metric=0.6762 head_norm=1.806225
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.197464e-02
[S17] stored merged vector for next round verification (round=39)
[S17] DEBUG after merge:  round=39 metric=0.6771 head_norm=1.795233 delta_norm=0.051975
[S17] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] r=40 psi=0.785 u=0.3855 p_local=0.2045 f1=0.676 auprc=0.949 bytes=34198
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=39 metric=0.6626 head_norm=1.735815
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.201568e-02
[S7] stored merged vector for next round verification (round=39)
[S7] DEBUG after merge:  round=39 metric=0.6652 head_norm=1.749343 delta_norm=0.032016
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] r=40 psi=0.726 u=0.2555 p_local=0.1688 f1=0.663 auprc=0.822 bytes=44935
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=39 metric=0.8206 head_norm=1.763349
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.201567e-02
[S6] stored merged vector for next round verification (round=39)
[S6] DEBUG after merge:  round=39 metric=0.8351 head_norm=1.749343 delta_norm=0.032016
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] r=40 psi=0.881 u=0.6318 p_local=0.3917 f1=0.821 auprc=0.970 bytes=39577
[S2] START round=40 head_norm_before_train=1.993119 cos_to_last_merge=0.9982 (last merge round=32)
[S2] round=40 local utility u=0.087013 metrics={'f1_val': 0.7018129998996651, 'auprc': 0.7297508985043313, 'loss_val': 1.0992846853755611, 'psi': 0.7129881593415315}-{'f1_val': 0.6846692369760233, 'auprc': 0.7288797887886374, 'loss_val': 1.1678342843094336, 'psi': 0.7023534577010689}
[S3] START round=40 head_norm_before_train=1.612047 cos_to_last_merge=0.9978 (last merge round=34)
[S3] round=40 local utility u=0.003630 metrics={'f1_val': 0.9827160165321871, 'auprc': 0.999550751896652, 'loss_val': 0.05576956328451325, 'psi': 0.989449910677973}-{'f1_val': 0.984174708061025, 'auprc': 0.999157841309444, 'loss_val': 0.07060395629723473, 'psi': 0.9901679613603926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=40 head_norm_before_train=1.869312 cos_to_last_merge=0.8138 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.814
[S4] round=40 local utility u=0.118828 metrics={'f1_val': 0.9730200388968306, 'auprc': 0.9558545036931341, 'loss_val': 0.10436085229750922, 'psi': 0.9661538248153521}-{'f1_val': 0.9525430728836525, 'auprc': 0.9714164662955882, 'loss_val': 0.2658403170133425, 'psi': 0.9600924302484267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=40 head_norm_before_train=1.629227 cos_to_last_merge=0.9989 (last merge round=33)
[S5] round=40 local utility u=0.001176 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9914629941405748, 'loss_val': 0.1679670614489687, 'psi': 0.8167775567510454}-{'f1_val': 0.700320598491359, 'auprc': 0.9939829174989057, 'loss_val': 0.1778793529499842, 'psi': 0.8177855260943776}
[S6] START round=40 head_norm_before_train=1.749343 cos_to_last_merge=1.0000 (last merge round=39)
[S6] round=40 local utility u=0.321334 metrics={'f1_val': 0.8900666825518895, 'auprc': 0.9840340284973637, 'loss_val': 0.20412808158688459, 'psi': 0.9276536209300791}-{'f1_val': 0.8206488431582755, 'auprc': 0.9703739783962233, 'loss_val': 0.38930936406803285, 'psi': 0.8805388972534547}
[S7] START round=40 head_norm_before_train=1.749343 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5600833164950891, 'auprc': 0.7855413518977822, 'loss_val': 0.7289550796739582, 'psi': 0.6502665306561664}-{'f1_val': 0.6626025857063544, 'auprc': 0.8220182013425611, 'loss_val': 0.4694811171480122, 'psi': 0.7263688319608371}
[S8] START round=40 head_norm_before_train=1.756404 cos_to_last_merge=0.9963 (last merge round=31)
[S8] round=40 local utility u=0.037255 metrics={'f1_val': 0.993080372776832, 'auprc': 0.9984878602223597, 'loss_val': 0.03684678259602883, 'psi': 0.9952433677550432}-{'f1_val': 0.9836013959184189, 'auprc': 0.9986693458935626, 'loss_val': 0.055028194323515696, 'psi': 0.9896285759084764}
[S9] START round=40 head_norm_before_train=1.889687 cos_to_last_merge=0.7916 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.792
[S9] round=40 local utility u=0.004580 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9993673137501383, 'loss_val': 0.01846985765708167, 'psi': 0.998008673007341}-{'f1_val': 0.9956098104564366, 'auprc': 0.9994986770003285, 'loss_val': 0.019066224247894756, 'psi': 0.9971653570739933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=40 head_norm_before_train=1.684445 cos_to_last_merge=0.9990 (last merge round=33)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9781565739580718, 'auprc': 0.9943085691752949, 'loss_val': 0.055387421760886, 'psi': 0.9846173720449609}-{'f1_val': 0.9878115672463043, 'auprc': 0.9956646410932318, 'loss_val': 0.048307060566989725, 'psi': 0.9909527967850753}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.950023 cos_to_last_merge=0.8266 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.827
[S11] round=40 local utility u=0.003970 metrics={'f1_val': 0.9967926336575387, 'auprc': 0.9992129450190723, 'loss_val': 0.018707555224008545, 'psi': 0.9977607582021522}-{'f1_val': 0.9961135349310292, 'auprc': 0.9985460547677611, 'loss_val': 0.020571645260749137, 'psi': 0.9970865428657218}
[S13] START round=40 head_norm_before_train=1.569728 cos_to_last_merge=0.9966 (last merge round=26)
[S13] round=40 local utility u=0.362244 metrics={'f1_val': 0.7092126825870932, 'auprc': 0.7263522879818146, 'loss_val': 0.9158905676512169, 'psi': 0.7160685247449818}-{'f1_val': 0.6339610681699931, 'auprc': 0.6731182213688277, 'loss_val': 1.029166671584582, 'psi': 0.649623929449527}
[S14] START round=40 head_norm_before_train=1.648976 cos_to_last_merge=0.9772 (last merge round=25)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.997841853906109, 'auprc': 0.9993213615333412, 'loss_val': 0.05065022034516542, 'psi': 0.9984336569570019}-{'f1_val': 0.9978195179672185, 'auprc': 0.9994484282631313, 'loss_val': 0.04833972831421294, 'psi': 0.9984710820855836}
[S15] START round=40 head_norm_before_train=1.785734 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7459057182828213, 'auprc': 0.7556767981676414, 'loss_val': 0.6415693905764099, 'psi': 0.7498141502367494}-{'f1_val': 0.9963755136436562, 'auprc': 0.9968986014349842, 'loss_val': 0.0391278644938157, 'psi': 0.9965847487601874}
[S16] START round=40 head_norm_before_train=1.669483 cos_to_last_merge=0.7514 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.751
[S16] round=40 local utility u=0.010062 metrics={'f1_val': 0.9903089954225539, 'auprc': 0.9919286074406877, 'loss_val': 0.04905851914705862, 'psi': 0.9909568402298075}-{'f1_val': 0.9878218264510596, 'auprc': 0.9920911186382361, 'loss_val': 0.05474666282134214, 'psi': 0.9895295433259302}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=40 head_norm_before_train=1.795233 cos_to_last_merge=1.0000 (last merge round=39)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.40553975621058475, 'auprc': 0.6836221956682893, 'loss_val': 1.6622637741830661, 'psi': 0.5167727319936666}-{'f1_val': 0.6761643010220115, 'auprc': 0.9489849280613442, 'loss_val': 0.8648254344346078, 'psi': 0.7852925518377446}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.817)
[S13] not sending this round → trigger blocked (psi=0.716)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S11] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:39812
[S2] sending update (kind=head size=1796 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.928)
[S11] ⇄ pheromone p=0.059 → S2@127.0.0.1:39802
[S11] RECEIVED delta(kind=head bytes=1796) from S2
[S11] cosine check vs S2: cos=-0.0556
[S11] DROPPED delta from S2 (cos=-0.0556 < 0.0)
[S2] ⇄ pheromone p=0.065 → S11@127.0.0.1:39812
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=40 metric=0.7459 head_norm=1.802292
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.490286e-02
[S15] stored merged vector for next round verification (round=40)
[S15] DEBUG after merge:  round=40 metric=0.7459 head_norm=1.803922 delta_norm=0.034903
[S15] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.396 → S17@127.0.0.1:39817
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] ⇄ pheromone p=0.164 → S15@127.0.0.1:39815
[S7] ⇄ pheromone p=0.135 → S6@127.0.0.1:39807
[S6] ⇄ pheromone p=0.378 → S7@127.0.0.1:39808
[S2] START round=41 head_norm_before_train=2.005745 cos_to_last_merge=0.9979 (last merge round=32)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.6855435984490521, 'auprc': 0.7241787612275327, 'loss_val': 1.1870950952326187, 'psi': 0.7009976635604444}-{'f1_val': 0.7018129998996651, 'auprc': 0.7297508985043313, 'loss_val': 1.0992846853755611, 'psi': 0.7129881593415315}
[S3] START round=41 head_norm_before_train=1.632560 cos_to_last_merge=0.9969 (last merge round=34)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9510612893582964, 'auprc': 0.9926767466639872, 'loss_val': 0.12366430066135453, 'psi': 0.9677074722805727}-{'f1_val': 0.9827160165321871, 'auprc': 0.999550751896652, 'loss_val': 0.05576956328451325, 'psi': 0.989449910677973}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.865185 cos_to_last_merge=0.8144 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.814
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9692397660462422, 'auprc': 0.9629035263654706, 'loss_val': 0.10906083665121746, 'psi': 0.9667052701739335}-{'f1_val': 0.9730200388968306, 'auprc': 0.9558545036931341, 'loss_val': 0.10436085229750922, 'psi': 0.9661538248153521}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.639370 cos_to_last_merge=0.9985 (last merge round=33)
[S5] round=41 local utility u=0.018203 metrics={'f1_val': 0.700320598491359, 'auprc': 0.995978032725559, 'loss_val': 0.14510527064351889, 'psi': 0.818583572185039}-{'f1_val': 0.700320598491359, 'auprc': 0.9914629941405748, 'loss_val': 0.1679670614489687, 'psi': 0.8167775567510454}
[S6] START round=41 head_norm_before_train=1.773406 cos_to_last_merge=0.9999 (last merge round=39)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.6113448295915309, 'auprc': 0.7658051766806548, 'loss_val': 0.8747115918166954, 'psi': 0.6731289684271805}-{'f1_val': 0.8900666825518895, 'auprc': 0.9840340284973637, 'loss_val': 0.20412808158688459, 'psi': 0.9276536209300791}
[S7] START round=41 head_norm_before_train=1.755777 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5125359040445837, 'auprc': 0.7805087348869464, 'loss_val': 0.8277174114928498, 'psi': 0.6197250363815288}-{'f1_val': 0.5600833164950891, 'auprc': 0.7855413518977822, 'loss_val': 0.7289550796739582, 'psi': 0.6502665306561664}
[S8] START round=41 head_norm_before_train=1.768672 cos_to_last_merge=0.9958 (last merge round=31)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9923498862294302, 'auprc': 0.9985140047206664, 'loss_val': 0.036824715393564265, 'psi': 0.9948155336259247}-{'f1_val': 0.993080372776832, 'auprc': 0.9984878602223597, 'loss_val': 0.03684678259602883, 'psi': 0.9952433677550432}
[S9] START round=41 head_norm_before_train=1.896966 cos_to_last_merge=0.7912 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.791
[S9] round=41 local utility u=0.000305 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9993824537345184, 'loss_val': 0.01790565499385796, 'psi': 0.998014729001093}-{'f1_val': 0.9971029125121428, 'auprc': 0.9993673137501383, 'loss_val': 0.01846985765708167, 'psi': 0.998008673007341}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=41 head_norm_before_train=1.699226 cos_to_last_merge=0.9987 (last merge round=33)
[S10] round=41 local utility u=0.030927 metrics={'f1_val': 0.9865733521563858, 'auprc': 0.995832364146931, 'loss_val': 0.048605530110615976, 'psi': 0.9902769569526039}-{'f1_val': 0.9781565739580718, 'auprc': 0.9943085691752949, 'loss_val': 0.055387421760886, 'psi': 0.9846173720449609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=41 head_norm_before_train=1.958172 cos_to_last_merge=0.8261 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.826
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9922361599975561, 'auprc': 0.9994984259663273, 'loss_val': 0.027743973944526965, 'psi': 0.9951410663850646}-{'f1_val': 0.9967926336575387, 'auprc': 0.9992129450190723, 'loss_val': 0.018707555224008545, 'psi': 0.9977607582021522}
[S13] START round=41 head_norm_before_train=1.574332 cos_to_last_merge=0.9964 (last merge round=26)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6680148544447226, 'auprc': 0.778685993977691, 'loss_val': 0.8979929015477457, 'psi': 0.71228331025791}-{'f1_val': 0.7092126825870932, 'auprc': 0.7263522879818146, 'loss_val': 0.9158905676512169, 'psi': 0.7160685247449818}
[S14] START round=41 head_norm_before_train=1.661461 cos_to_last_merge=0.9760 (last merge round=25)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9965760575063591, 'auprc': 0.996805978334679, 'loss_val': 0.05274002322008077, 'psi': 0.996668025837687}-{'f1_val': 0.997841853906109, 'auprc': 0.9993213615333412, 'loss_val': 0.05065022034516542, 'psi': 0.9984336569570019}
[S15] START round=41 head_norm_before_train=1.803922 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=41 local utility u=1.000000 metrics={'f1_val': 0.9466648143105535, 'auprc': 0.9964166230801916, 'loss_val': 0.09911507918534632, 'psi': 0.9665655378184088}-{'f1_val': 0.7459057182828213, 'auprc': 0.7556767981676414, 'loss_val': 0.6415693905764099, 'psi': 0.7498141502367494}
[S16] START round=41 head_norm_before_train=1.678386 cos_to_last_merge=0.7508 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.751
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.8485050942914757, 'auprc': 0.8753999157154875, 'loss_val': 0.9039574326526993, 'psi': 0.8592630228610805}-{'f1_val': 0.9903089954225539, 'auprc': 0.9919286074406877, 'loss_val': 0.04905851914705862, 'psi': 0.9909568402298075}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.816472 cos_to_last_merge=0.9999 (last merge round=39)
[S17] round=41 local utility u=1.000000 metrics={'f1_val': 0.6236767610386513, 'auprc': 0.7941458402780033, 'loss_val': 1.2165956853167492, 'psi': 0.6918643927343922}-{'f1_val': 0.40553975621058475, 'auprc': 0.6836221956682893, 'loss_val': 1.6622637741830661, 'psi': 0.5167727319936666}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39817
[S15] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S15
[S17] cosine check vs S15: cos=0.9998
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39815
[S17] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S17
[S15] cosine check vs S17: cos=0.9998
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=41 metric=0.6237 head_norm=1.841103
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.997681e-02
[S17] stored merged vector for next round verification (round=41)
[S17] DEBUG after merge:  round=41 metric=0.6237 head_norm=1.833487 delta_norm=0.019977
[S17] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=2.013930 cos_to_last_merge=0.9977 (last merge round=32)
[S2] round=42 local utility u=0.176669 metrics={'f1_val': 0.7208232967155703, 'auprc': 0.731277777964028, 'loss_val': 1.0667328906514093, 'psi': 0.7250050892149534}-{'f1_val': 0.6855435984490521, 'auprc': 0.7241787612275327, 'loss_val': 1.1870950952326187, 'psi': 0.7009976635604444}
[S3] START round=42 head_norm_before_train=1.651623 cos_to_last_merge=0.9959 (last merge round=34)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.8632297123864754, 'auprc': 0.9697095058210303, 'loss_val': 0.39958907671981814, 'psi': 0.9058216297602973}-{'f1_val': 0.9510612893582964, 'auprc': 0.9926767466639872, 'loss_val': 0.12366430066135453, 'psi': 0.9677074722805727}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.869626 cos_to_last_merge=0.8142 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.814
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9533739067071695, 'auprc': 0.9912270780530145, 'loss_val': 0.16150818028824693, 'psi': 0.9685151752455075}-{'f1_val': 0.9692397660462422, 'auprc': 0.9629035263654706, 'loss_val': 0.10906083665121746, 'psi': 0.9667052701739335}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.650116 cos_to_last_merge=0.9981 (last merge round=33)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.7140122240634571, 'auprc': 0.8575788908473807, 'loss_val': 0.4601135218969736, 'psi': 0.7714388907770267}-{'f1_val': 0.700320598491359, 'auprc': 0.995978032725559, 'loss_val': 0.14510527064351889, 'psi': 0.818583572185039}
[S6] START round=42 head_norm_before_train=1.795986 cos_to_last_merge=0.9997 (last merge round=39)
[S6] round=42 local utility u=1.000000 metrics={'f1_val': 0.7908314040797398, 'auprc': 0.9720057820874238, 'loss_val': 0.33820326331861655, 'psi': 0.8633011552828135}-{'f1_val': 0.6113448295915309, 'auprc': 0.7658051766806548, 'loss_val': 0.8747115918166954, 'psi': 0.6731289684271805}
[S7] START round=42 head_norm_before_train=1.760714 cos_to_last_merge=0.9999 (last merge round=39)
[S7] round=42 local utility u=0.976144 metrics={'f1_val': 0.6925223184192674, 'auprc': 0.9077106456700743, 'loss_val': 0.33695286191626456, 'psi': 0.7785976493195902}-{'f1_val': 0.5125359040445837, 'auprc': 0.7805087348869464, 'loss_val': 0.8277174114928498, 'psi': 0.6197250363815288}
[S8] START round=42 head_norm_before_train=1.779793 cos_to_last_merge=0.9953 (last merge round=31)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.998552894763463, 'loss_val': 0.03649137831642172, 'psi': 0.9947199275784165}-{'f1_val': 0.9923498862294302, 'auprc': 0.9985140047206664, 'loss_val': 0.036824715393564265, 'psi': 0.9948155336259247}
[S9] START round=42 head_norm_before_train=1.904453 cos_to_last_merge=0.7907 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.791
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.990399656971262, 'auprc': 0.9988717222250362, 'loss_val': 0.037534061384619594, 'psi': 0.9937884830727717}-{'f1_val': 0.9971029125121428, 'auprc': 0.9993824537345184, 'loss_val': 0.01790565499385796, 'psi': 0.998014729001093}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.713309 cos_to_last_merge=0.9984 (last merge round=33)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9781565739580718, 'auprc': 0.9945132331482835, 'loss_val': 0.05534161044744758, 'psi': 0.9846992376341565}-{'f1_val': 0.9865733521563858, 'auprc': 0.995832364146931, 'loss_val': 0.048605530110615976, 'psi': 0.9902769569526039}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.966369 cos_to_last_merge=0.8256 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.826
[S11] round=42 local utility u=0.014994 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9988018561326253, 'loss_val': 0.018931403270301562, 'psi': 0.9971888634116676}-{'f1_val': 0.9922361599975561, 'auprc': 0.9994984259663273, 'loss_val': 0.027743973944526965, 'psi': 0.9951410663850646}
[S13] START round=42 head_norm_before_train=1.577621 cos_to_last_merge=0.9963 (last merge round=26)
[S13] round=42 local utility u=0.155195 metrics={'f1_val': 0.6858053297072108, 'auprc': 0.8172067532633629, 'loss_val': 0.8099089007076242, 'psi': 0.7383658991296717}-{'f1_val': 0.6680148544447226, 'auprc': 0.778685993977691, 'loss_val': 0.8979929015477457, 'psi': 0.71228331025791}
[S14] START round=42 head_norm_before_train=1.672663 cos_to_last_merge=0.9749 (last merge round=25)
[S14] round=42 local utility u=0.013147 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9989852760984986, 'loss_val': 0.03553224015653285, 'psi': 0.9977945383679461}-{'f1_val': 0.9965760575063591, 'auprc': 0.996805978334679, 'loss_val': 0.05274002322008077, 'psi': 0.996668025837687}
[S15] START round=42 head_norm_before_train=1.826057 cos_to_last_merge=0.9999 (last merge round=40)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7115254746424324, 'auprc': 0.774716871186381, 'loss_val': 0.6642732482691232, 'psi': 0.7368020332600118}-{'f1_val': 0.9466648143105535, 'auprc': 0.9964166230801916, 'loss_val': 0.09911507918534632, 'psi': 0.9665655378184088}
[S16] START round=42 head_norm_before_train=1.687439 cos_to_last_merge=0.7502 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.750
[S16] round=42 local utility u=1.000000 metrics={'f1_val': 0.9921497430254755, 'auprc': 0.9915180692074919, 'loss_val': 0.03994409241290158, 'psi': 0.9918970734982822}-{'f1_val': 0.8485050942914757, 'auprc': 0.8753999157154875, 'loss_val': 0.9039574326526993, 'psi': 0.8592630228610805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S17] START round=42 head_norm_before_train=1.833487 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=42 local utility u=0.164230 metrics={'f1_val': 0.6395633373859915, 'auprc': 0.8485155169213312, 'loss_val': 1.1465638327165761, 'psi': 0.7231442092001275}-{'f1_val': 0.6236767610386513, 'auprc': 0.7941458402780033, 'loss_val': 1.2165956853167492, 'psi': 0.6918643927343922}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:39812
[S2] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39808
[S11] sending update (kind=head size=1795 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] RECEIVED delta(kind=head bytes=1795) from S11
[S2] cosine check vs S11: cos=-0.0561
[S2] DROPPED delta from S11 (cos=-0.0561 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1795) from S2
[S11] cosine check vs S2: cos=-0.0561
[S11] DROPPED delta from S2 (cos=-0.0561 < 0.0)
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S6
[S7] cosine check vs S6: cos=0.9993
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=42 metric=0.7115 head_norm=1.848637
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.456494e-02
[S15] stored merged vector for next round verification (round=42)
[S15] DEBUG after merge:  round=42 metric=0.7115 head_norm=1.844710 delta_norm=0.024565
[S15] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:39807
[S17] not sending this round → trigger blocked (psi=0.723)
[S7] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S7
[S6] cosine check vs S7: cos=0.9993
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=42 metric=0.6925 head_norm=1.764656
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.839877e-02
[S7] stored merged vector for next round verification (round=42)
[S7] DEBUG after merge:  round=42 metric=0.6923 head_norm=1.784484 delta_norm=0.038399
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=42 metric=0.7908 head_norm=1.804911
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.839877e-02
[S6] stored merged vector for next round verification (round=42)
[S6] DEBUG after merge:  round=42 metric=0.7810 head_norm=1.784484 delta_norm=0.038399
[S6] aggregate: ROLLBACK (f1_val pre=0.791 post=0.781 tol_abs=0.005 tol_rel=0.0)
[S2] START round=43 head_norm_before_train=2.023717 cos_to_last_merge=0.9975 (last merge round=32)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7028354075818039, 'auprc': 0.7447191524533026, 'loss_val': 1.0396728695687683, 'psi': 0.7195889055304033}-{'f1_val': 0.7208232967155703, 'auprc': 0.731277777964028, 'loss_val': 1.0667328906514093, 'psi': 0.7250050892149534}
[S3] START round=43 head_norm_before_train=1.669961 cos_to_last_merge=0.9949 (last merge round=34)
[S3] round=43 local utility u=0.298016 metrics={'f1_val': 0.9233356452150633, 'auprc': 0.9828929878135823, 'loss_val': 0.20374363366104326, 'psi': 0.9471585822544708}-{'f1_val': 0.8632297123864754, 'auprc': 0.9697095058210303, 'loss_val': 0.39958907671981814, 'psi': 0.9058216297602973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=43 head_norm_before_train=1.869348 cos_to_last_merge=0.8148 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.815
[S4] round=43 local utility u=0.028884 metrics={'f1_val': 0.9669107008353097, 'auprc': 0.9645342823667914, 'loss_val': 0.10488178313530183, 'psi': 0.9659601334479024}-{'f1_val': 0.9533739067071695, 'auprc': 0.9912270780530145, 'loss_val': 0.16150818028824693, 'psi': 0.9685151752455075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=43 head_norm_before_train=1.658393 cos_to_last_merge=0.9978 (last merge round=33)
[S5] round=43 local utility u=0.327165 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9975203850586283, 'loss_val': 0.14346308036696787, 'psi': 0.8192009444837995}-{'f1_val': 0.7140122240634571, 'auprc': 0.8575788908473807, 'loss_val': 0.4601135218969736, 'psi': 0.7714388907770267}
[S6] START round=43 head_norm_before_train=1.784484 cos_to_last_merge=1.0000 (last merge round=42)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.8215635086053961, 'auprc': 0.9478034778263112, 'loss_val': 0.49375003716997207, 'psi': 0.8720594962937621}-{'f1_val': 0.7908314040797398, 'auprc': 0.9720057820874238, 'loss_val': 0.33820326331861655, 'psi': 0.8633011552828135}
[S7] START round=43 head_norm_before_train=1.784484 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.47610874602069586, 'auprc': 0.7807156460700471, 'loss_val': 0.8986543556849358, 'psi': 0.5979515060404363}-{'f1_val': 0.6925223184192674, 'auprc': 0.9077106456700743, 'loss_val': 0.33695286191626456, 'psi': 0.7785976493195902}
[S8] START round=43 head_norm_before_train=1.791919 cos_to_last_merge=0.9949 (last merge round=31)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9871370762874481, 'auprc': 0.9986275191410829, 'loss_val': 0.04663669122971345, 'psi': 0.9917332534289021}-{'f1_val': 0.9921646161217188, 'auprc': 0.998552894763463, 'loss_val': 0.03649137831642172, 'psi': 0.9947199275784165}
[S9] START round=43 head_norm_before_train=1.910157 cos_to_last_merge=0.7903 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.790
[S9] round=43 local utility u=0.028551 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9997923889234237, 'loss_val': 0.01842293619977038, 'psi': 0.9976795730076131}-{'f1_val': 0.990399656971262, 'auprc': 0.9988717222250362, 'loss_val': 0.037534061384619594, 'psi': 0.9937884830727717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=43 head_norm_before_train=1.729190 cos_to_last_merge=0.9982 (last merge round=33)
[S10] round=43 local utility u=0.025597 metrics={'f1_val': 0.9853388387774755, 'auprc': 0.9951991860801149, 'loss_val': 0.04929821033707456, 'psi': 0.9892829776985312}-{'f1_val': 0.9781565739580718, 'auprc': 0.9945132331482835, 'loss_val': 0.05534161044744758, 'psi': 0.9846992376341565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=43 head_norm_before_train=1.974132 cos_to_last_merge=0.8253 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.825
[S11] round=43 local utility u=0.004257 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9995002686640223, 'loss_val': 0.017616462877319262, 'psi': 0.9979786614413553}-{'f1_val': 0.9961135349310292, 'auprc': 0.9988018561326253, 'loss_val': 0.018931403270301562, 'psi': 0.9971888634116676}
[S13] START round=43 head_norm_before_train=1.583858 cos_to_last_merge=0.9961 (last merge round=26)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6215577994128966, 'auprc': 0.6432505499747071, 'loss_val': 1.2913090626522248, 'psi': 0.6302348996376208}-{'f1_val': 0.6858053297072108, 'auprc': 0.8172067532633629, 'loss_val': 0.8099089007076242, 'psi': 0.7383658991296717}
[S14] START round=43 head_norm_before_train=1.685075 cos_to_last_merge=0.9736 (last merge round=25)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9989531396302259, 'loss_val': 0.03808596557213461, 'psi': 0.9976495603563736}-{'f1_val': 0.9970007132142444, 'auprc': 0.9989852760984986, 'loss_val': 0.03553224015653285, 'psi': 0.9977945383679461}
[S15] START round=43 head_norm_before_train=1.844710 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=43 local utility u=1.000000 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9982881576503561, 'loss_val': 0.023454709629444716, 'psi': 0.9971147095694269}-{'f1_val': 0.7115254746424324, 'auprc': 0.774716871186381, 'loss_val': 0.6642732482691232, 'psi': 0.7368020332600118}
[S16] START round=43 head_norm_before_train=1.696766 cos_to_last_merge=0.7496 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.750
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.8609196147196486, 'auprc': 0.9886566797340937, 'loss_val': 0.45350104639283423, 'psi': 0.9120144407254266}-{'f1_val': 0.9921497430254755, 'auprc': 0.9915180692074919, 'loss_val': 0.03994409241290158, 'psi': 0.9918970734982822}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.850745 cos_to_last_merge=0.9999 (last merge round=41)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.3734007167908147, 'auprc': 0.7319113764315879, 'loss_val': 1.8127183971361316, 'psi': 0.516804980647124}-{'f1_val': 0.6395633373859915, 'auprc': 0.8485155169213312, 'loss_val': 1.1465638327165761, 'psi': 0.7231442092001275}
[S8]  timeout peer S5
[S7]  timeout peer S13
[S17]  timeout peer S8
[S14]  timeout peer S15
[S13]  timeout peer S10
[S5]  timeout peer S3
[S6]  timeout peer S2
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39817
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=-0.0559
[S2] DROPPED delta from S11 (cos=-0.0559 < 0.0)
[S15] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S15
[S17] cosine check vs S15: cos=0.9997
[S2] START round=44 head_norm_before_train=2.038352 cos_to_last_merge=0.9971 (last merge round=32)
[S2] round=44 local utility u=0.031632 metrics={'f1_val': 0.7211851804134745, 'auprc': 0.739384771008509, 'loss_val': 1.0705050243858072, 'psi': 0.7284650166514883}-{'f1_val': 0.7028354075818039, 'auprc': 0.7447191524533026, 'loss_val': 1.0396728695687683, 'psi': 0.7195889055304033}
[S3] START round=44 head_norm_before_train=1.687461 cos_to_last_merge=0.9940 (last merge round=34)
[S3] round=44 local utility u=0.051520 metrics={'f1_val': 0.9315422744702738, 'auprc': 0.995172782508404, 'loss_val': 0.18678294829233563, 'psi': 0.9569944776855259}-{'f1_val': 0.9233356452150633, 'auprc': 0.9828929878135823, 'loss_val': 0.20374363366104326, 'psi': 0.9471585822544708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=44 head_norm_before_train=1.879070 cos_to_last_merge=0.8137 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.814
[S4] round=44 local utility u=0.031337 metrics={'f1_val': 0.9721933760164361, 'auprc': 0.9730947891866268, 'loss_val': 0.09958625631585118, 'psi': 0.9725539412845123}-{'f1_val': 0.9669107008353097, 'auprc': 0.9645342823667914, 'loss_val': 0.10488178313530183, 'psi': 0.9659601334479024}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=44 head_norm_before_train=1.662243 cos_to_last_merge=0.9976 (last merge round=33)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.7136833726054006, 'auprc': 0.9743228737255019, 'loss_val': 0.37208901606407513, 'psi': 0.8179391730534411}-{'f1_val': 0.7003213174339138, 'auprc': 0.9975203850586283, 'loss_val': 0.14346308036696787, 'psi': 0.8192009444837995}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.793771 cos_to_last_merge=1.0000 (last merge round=42)
[S6] round=44 local utility u=0.299511 metrics={'f1_val': 0.8746869562687146, 'auprc': 0.9706473702052699, 'loss_val': 0.2820009220843156, 'psi': 0.9130711218433367}-{'f1_val': 0.8215635086053961, 'auprc': 0.9478034778263112, 'loss_val': 0.49375003716997207, 'psi': 0.8720594962937621}
[S7] START round=44 head_norm_before_train=1.787648 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=44 local utility u=0.765754 metrics={'f1_val': 0.652912884758982, 'auprc': 0.8048449422801272, 'loss_val': 0.5003584762708934, 'psi': 0.7136857077674401}-{'f1_val': 0.47610874602069586, 'auprc': 0.7807156460700471, 'loss_val': 0.8986543556849358, 'psi': 0.5979515060404363}
[S8] START round=44 head_norm_before_train=1.804509 cos_to_last_merge=0.9945 (last merge round=31)
[S8] round=44 local utility u=0.017535 metrics={'f1_val': 0.9925533179144562, 'auprc': 0.9976339091849346, 'loss_val': 0.04108401447426012, 'psi': 0.9945855544226475}-{'f1_val': 0.9871370762874481, 'auprc': 0.9986275191410829, 'loss_val': 0.04663669122971345, 'psi': 0.9917332534289021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=44 head_norm_before_train=1.917270 cos_to_last_merge=0.7898 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.790
[S9] round=44 local utility u=0.001540 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9976237204401786, 'loss_val': 0.016479407386400538, 'psi': 0.9975764221824577}-{'f1_val': 0.9962710290637395, 'auprc': 0.9997923889234237, 'loss_val': 0.01842293619977038, 'psi': 0.9976795730076131}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=44 head_norm_before_train=1.743285 cos_to_last_merge=0.9979 (last merge round=33)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9828806799350496, 'auprc': 0.994803990167515, 'loss_val': 0.05090792483837298, 'psi': 0.9876500040280358}-{'f1_val': 0.9853388387774755, 'auprc': 0.9951991860801149, 'loss_val': 0.04929821033707456, 'psi': 0.9892829776985312}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.982154 cos_to_last_merge=0.8249 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.825
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9990152909210774, 'loss_val': 0.017936856448601903, 'psi': 0.9975222352658102}-{'f1_val': 0.9969642566262439, 'auprc': 0.9995002686640223, 'loss_val': 0.017616462877319262, 'psi': 0.9979786614413553}
[S13] START round=44 head_norm_before_train=1.592058 cos_to_last_merge=0.9958 (last merge round=26)
[S13] round=44 local utility u=0.276658 metrics={'f1_val': 0.6529156434430904, 'auprc': 0.668564794081649, 'loss_val': 1.0020824768828789, 'psi': 0.6591753036985138}-{'f1_val': 0.6215577994128966, 'auprc': 0.6432505499747071, 'loss_val': 1.2913090626522248, 'psi': 0.6302348996376208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=44 head_norm_before_train=1.696851 cos_to_last_merge=0.9725 (last merge round=25)
[S14] round=44 local utility u=0.002576 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9983312222664678, 'loss_val': 0.032388897181908585, 'psi': 0.9975329168351338}-{'f1_val': 0.9967805075071389, 'auprc': 0.9989531396302259, 'loss_val': 0.03808596557213461, 'psi': 0.9976495603563736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=44 head_norm_before_train=1.865103 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7009180804352899, 'auprc': 0.801772300617433, 'loss_val': 0.7181522515738832, 'psi': 0.7412597685081472}-{'f1_val': 0.9963324108488076, 'auprc': 0.9982881576503561, 'loss_val': 0.023454709629444716, 'psi': 0.9971147095694269}
[S16] START round=44 head_norm_before_train=1.706547 cos_to_last_merge=0.7489 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.749
[S16] round=44 local utility u=0.340487 metrics={'f1_val': 0.9392064100396954, 'auprc': 0.9936467664212499, 'loss_val': 0.25721780355326596, 'psi': 0.9609825525923172}-{'f1_val': 0.8609196147196486, 'auprc': 0.9886566797340937, 'loss_val': 0.45350104639283423, 'psi': 0.9120144407254266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=44 head_norm_before_train=1.864331 cos_to_last_merge=0.9999 (last merge round=41)
[S17] round=44 local utility u=1.000000 metrics={'f1_val': 0.8142407145377593, 'auprc': 0.9886717041231967, 'loss_val': 0.5658251831101933, 'psi': 0.8840131103719342}-{'f1_val': 0.3734007167908147, 'auprc': 0.7319113764315879, 'loss_val': 1.8127183971361316, 'psi': 0.516804980647124}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:39815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:39812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39807
[S7] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] cosine check vs S6: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1797) from S2
[S11] cosine check vs S2: cos=-0.0560
[S11] DROPPED delta from S2 (cos=-0.0560 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] cosine check vs S7: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1806) from S17
[S15] cosine check vs S17: cos=0.9994
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=44 metric=0.8142 head_norm=1.878479
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.823469e-02
[S17] stored merged vector for next round verification (round=44)
[S17] DEBUG after merge:  round=44 metric=0.8111 head_norm=1.871590 delta_norm=0.028235
[S17] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=44 metric=0.6529 head_norm=1.791361
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.662744e-02
[S7] stored merged vector for next round verification (round=44)
[S7] DEBUG after merge:  round=44 metric=0.6543 head_norm=1.797284 delta_norm=0.016627
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=44 metric=0.8747 head_norm=1.803340
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.662744e-02
[S6] stored merged vector for next round verification (round=44)
[S6] DEBUG after merge:  round=44 metric=0.8749 head_norm=1.797284 delta_norm=0.016627
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=44 metric=0.7009 head_norm=1.887542
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.327988e-02
[S15] stored merged vector for next round verification (round=44)
[S15] DEBUG after merge:  round=44 metric=0.7009 head_norm=1.882722 delta_norm=0.033280
[S15] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=2.051310 cos_to_last_merge=0.9968 (last merge round=32)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.7217712930449296, 'auprc': 0.738515508545724, 'loss_val': 1.0754192756726935, 'psi': 0.7284689792452473}-{'f1_val': 0.7211851804134745, 'auprc': 0.739384771008509, 'loss_val': 1.0705050243858072, 'psi': 0.7284650166514883}
[S3] START round=45 head_norm_before_train=1.704035 cos_to_last_merge=0.9930 (last merge round=34)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.8992725408820562, 'auprc': 0.9968216856181347, 'loss_val': 0.29794285009301114, 'psi': 0.9382921987764876}-{'f1_val': 0.9315422744702738, 'auprc': 0.995172782508404, 'loss_val': 0.18678294829233563, 'psi': 0.9569944776855259}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.890495 cos_to_last_merge=0.8125 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.813
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.95814931829883, 'auprc': 0.9884152541494966, 'loss_val': 0.15082403363388686, 'psi': 0.9702556926390966}-{'f1_val': 0.9721933760164361, 'auprc': 0.9730947891866268, 'loss_val': 0.09958625631585118, 'psi': 0.9725539412845123}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.664781 cos_to_last_merge=0.9974 (last merge round=33)
[S5] round=45 local utility u=0.073267 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.9938185320603032, 'loss_val': 0.2023771914957386, 'psi': 0.8175709443244485}-{'f1_val': 0.7136833726054006, 'auprc': 0.9743228737255019, 'loss_val': 0.37208901606407513, 'psi': 0.8179391730534411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=45 head_norm_before_train=1.797284 cos_to_last_merge=1.0000 (last merge round=44)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.619688564950849, 'auprc': 0.8948455213833616, 'loss_val': 0.6217133027827204, 'psi': 0.7297513475238541}-{'f1_val': 0.8746869562687146, 'auprc': 0.9706473702052699, 'loss_val': 0.2820009220843156, 'psi': 0.9130711218433367}
[S7] START round=45 head_norm_before_train=1.797284 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=45 local utility u=0.205359 metrics={'f1_val': 0.6885420056721738, 'auprc': 0.8382195896400756, 'loss_val': 0.40353836379522023, 'psi': 0.7484130392593346}-{'f1_val': 0.652912884758982, 'auprc': 0.8048449422801272, 'loss_val': 0.5003584762708934, 'psi': 0.7136857077674401}
[S8] START round=45 head_norm_before_train=1.813735 cos_to_last_merge=0.9939 (last merge round=31)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9832505925752337, 'auprc': 0.9987728645420983, 'loss_val': 0.05232513467347554, 'psi': 0.9894595013619796}-{'f1_val': 0.9925533179144562, 'auprc': 0.9976339091849346, 'loss_val': 0.04108401447426012, 'psi': 0.9945855544226475}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.925297 cos_to_last_merge=0.7893 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.789
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9946367966381642, 'auprc': 0.9998315081601677, 'loss_val': 0.022239318855034156, 'psi': 0.9967146812469656}-{'f1_val': 0.9975448900106438, 'auprc': 0.9976237204401786, 'loss_val': 0.016479407386400538, 'psi': 0.9975764221824577}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.756144 cos_to_last_merge=0.9976 (last merge round=33)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.978410348161484, 'auprc': 0.9943422036976155, 'loss_val': 0.05438082895386556, 'psi': 0.9847830903759367}-{'f1_val': 0.9828806799350496, 'auprc': 0.994803990167515, 'loss_val': 0.05090792483837298, 'psi': 0.9876500040280358}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.989894 cos_to_last_merge=0.8247 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.825
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9988638555223092, 'loss_val': 0.01813302978284782, 'psi': 0.9974616611063029}-{'f1_val': 0.9965268648289654, 'auprc': 0.9990152909210774, 'loss_val': 0.017936856448601903, 'psi': 0.9975222352658102}
[S13] START round=45 head_norm_before_train=1.601752 cos_to_last_merge=0.9953 (last merge round=26)
[S13] round=45 local utility u=0.256145 metrics={'f1_val': 0.6983866307649846, 'auprc': 0.6945783825995432, 'loss_val': 0.8406593767000119, 'psi': 0.696863331498808}-{'f1_val': 0.6529156434430904, 'auprc': 0.668564794081649, 'loss_val': 1.0020824768828789, 'psi': 0.6591753036985138}
[S13] not sending this round → trigger blocked (psi=0.697)
[S14] START round=45 head_norm_before_train=1.709174 cos_to_last_merge=0.9714 (last merge round=25)
[S14] round=45 local utility u=0.000033 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9968641124990706, 'loss_val': 0.030382836037886433, 'psi': 0.9971922415603252}-{'f1_val': 0.9970007132142444, 'auprc': 0.9983312222664678, 'loss_val': 0.032388897181908585, 'psi': 0.9975329168351338}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=45 head_norm_before_train=1.882722 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=45 local utility u=1.000000 metrics={'f1_val': 0.9853180297863509, 'auprc': 0.983862147409607, 'loss_val': 0.09085641309172196, 'psi': 0.9847356768356533}-{'f1_val': 0.7009180804352899, 'auprc': 0.801772300617433, 'loss_val': 0.7181522515738832, 'psi': 0.7412597685081472}
[S16] START round=45 head_norm_before_train=1.711916 cos_to_last_merge=0.7485 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.748
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8534661378283452, 'auprc': 0.990065065491758, 'loss_val': 0.8131385559246747, 'psi': 0.9081057088937103}-{'f1_val': 0.9392064100396954, 'auprc': 0.9936467664212499, 'loss_val': 0.25721780355326596, 'psi': 0.9609825525923172}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.871590 cos_to_last_merge=1.0000 (last merge round=44)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6343597841386197, 'auprc': 0.7784497848517256, 'loss_val': 1.1457079583548444, 'psi': 0.691995784423862}-{'f1_val': 0.8142407145377593, 'auprc': 0.9886717041231967, 'loss_val': 0.5658251831101933, 'psi': 0.8840131103719342}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.748)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.022 → S2@127.0.0.1:39802
[S6] ⇄ pheromone p=0.274 → S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39817
[S17] ⇄ pheromone p=0.312 → S15@127.0.0.1:39815
[S7] ⇄ pheromone p=0.308 → S6@127.0.0.1:39807
[S2] ⇄ pheromone p=0.045 → S11@127.0.0.1:39812
[S15] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S15
[S17] cosine check vs S15: cos=0.9999
[S15] ⇄ pheromone p=0.540 → S17@127.0.0.1:39817
[S2] START round=46 head_norm_before_train=2.065209 cos_to_last_merge=0.9964 (last merge round=32)
[S2] round=46 local utility u=0.015334 metrics={'f1_val': 0.706480211597692, 'auprc': 0.7519659967635497, 'loss_val': 0.9933560111422106, 'psi': 0.7246745256640351}-{'f1_val': 0.7217712930449296, 'auprc': 0.738515508545724, 'loss_val': 1.0754192756726935, 'psi': 0.7284689792452473}
[S3] START round=46 head_norm_before_train=1.719518 cos_to_last_merge=0.9921 (last merge round=34)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.7508027240024417, 'auprc': 0.9236464641181819, 'loss_val': 0.8234404235225187, 'psi': 0.8199402200487378}-{'f1_val': 0.8992725408820562, 'auprc': 0.9968216856181347, 'loss_val': 0.29794285009301114, 'psi': 0.9382921987764876}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.895125 cos_to_last_merge=0.8121 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.812
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9519785279613472, 'auprc': 0.9708510665767399, 'loss_val': 0.1884693742569969, 'psi': 0.9595275434075043}-{'f1_val': 0.95814931829883, 'auprc': 0.9884152541494966, 'loss_val': 0.15082403363388686, 'psi': 0.9702556926390966}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.670057 cos_to_last_merge=0.9973 (last merge round=33)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.7009013953909534, 'auprc': 0.9911924247005738, 'loss_val': 0.23244913922569133, 'psi': 0.8170178071148015}-{'f1_val': 0.7000725525005456, 'auprc': 0.9938185320603032, 'loss_val': 0.2023771914957386, 'psi': 0.8175709443244485}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.806291 cos_to_last_merge=0.9999 (last merge round=44)
[S6] round=46 local utility u=0.773153 metrics={'f1_val': 0.8233890162502803, 'auprc': 0.9553392974644027, 'loss_val': 0.4790919917093388, 'psi': 0.8761691287359292}-{'f1_val': 0.619688564950849, 'auprc': 0.8948455213833616, 'loss_val': 0.6217133027827204, 'psi': 0.7297513475238541}
[S7] START round=46 head_norm_before_train=1.802854 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.5308840488468436, 'auprc': 0.7779110303528991, 'loss_val': 0.8945868193175183, 'psi': 0.6296948414492658}-{'f1_val': 0.6885420056721738, 'auprc': 0.8382195896400756, 'loss_val': 0.40353836379522023, 'psi': 0.7484130392593346}
[S8] START round=46 head_norm_before_train=1.823875 cos_to_last_merge=0.9935 (last merge round=31)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9196236886873299, 'auprc': 0.9842127009682188, 'loss_val': 0.12879965183829234, 'psi': 0.9454592935996855}-{'f1_val': 0.9832505925752337, 'auprc': 0.9987728645420983, 'loss_val': 0.05232513467347554, 'psi': 0.9894595013619796}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.933490 cos_to_last_merge=0.7889 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.789
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9912852408039612, 'auprc': 0.9998547847811317, 'loss_val': 0.02752835116541138, 'psi': 0.9947130583948294}-{'f1_val': 0.9946367966381642, 'auprc': 0.9998315081601677, 'loss_val': 0.022239318855034156, 'psi': 0.9967146812469656}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.770007 cos_to_last_merge=0.9974 (last merge round=33)
[S10] round=46 local utility u=0.015388 metrics={'f1_val': 0.9824723702591945, 'auprc': 0.9951774781865206, 'loss_val': 0.05048302734280846, 'psi': 0.9875544134301251}-{'f1_val': 0.978410348161484, 'auprc': 0.9943422036976155, 'loss_val': 0.05438082895386556, 'psi': 0.9847830903759367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=46 head_norm_before_train=1.995546 cos_to_last_merge=0.8237 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.824
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9960467929594546, 'auprc': 0.9994924810190928, 'loss_val': 0.017776380175265526, 'psi': 0.9974250681833099}-{'f1_val': 0.9965268648289654, 'auprc': 0.9988638555223092, 'loss_val': 0.01813302978284782, 'psi': 0.9974616611063029}
[S13] START round=46 head_norm_before_train=1.609519 cos_to_last_merge=0.9949 (last merge round=26)
[S13] round=46 local utility u=0.190125 metrics={'f1_val': 0.7352676604903676, 'auprc': 0.7403985083524196, 'loss_val': 0.8191552710279691, 'psi': 0.7373199996351885}-{'f1_val': 0.6983866307649846, 'auprc': 0.6945783825995432, 'loss_val': 0.8406593767000119, 'psi': 0.696863331498808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=46 head_norm_before_train=1.721933 cos_to_last_merge=0.9702 (last merge round=25)
[S14] round=46 local utility u=0.002533 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9989461996420039, 'loss_val': 0.029081689822866803, 'psi': 0.9977769847514006}-{'f1_val': 0.9974109942678281, 'auprc': 0.9968641124990706, 'loss_val': 0.030382836037886433, 'psi': 0.9971922415603252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=46 head_norm_before_train=1.902393 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.7143388843565796, 'auprc': 0.7925265704344895, 'loss_val': 0.7812542090797173, 'psi': 0.7456139587877435}-{'f1_val': 0.9853180297863509, 'auprc': 0.983862147409607, 'loss_val': 0.09085641309172196, 'psi': 0.9847356768356533}
[S16] START round=46 head_norm_before_train=1.714692 cos_to_last_merge=0.7483 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.748
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.8451645008262698, 'auprc': 0.9902173228094009, 'loss_val': 0.9291941292278596, 'psi': 0.9031856296195222}-{'f1_val': 0.8534661378283452, 'auprc': 0.990065065491758, 'loss_val': 0.8131385559246747, 'psi': 0.9081057088937103}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.886396 cos_to_last_merge=1.0000 (last merge round=44)
[S17] round=46 local utility u=1.000000 metrics={'f1_val': 0.8251258412508844, 'auprc': 0.8795211896392313, 'loss_val': 0.46437764853182695, 'psi': 0.8468839806062232}-{'f1_val': 0.6343597841386197, 'auprc': 0.7784497848517256, 'loss_val': 1.1457079583548444, 'psi': 0.691995784423862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:39812
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1794 to 1 peers)
[S17] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1794) from S2
[S11] cosine check vs S2: cos=-0.0568
[S11] DROPPED delta from S2 (cos=-0.0568 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=0.9995
[S15] RECEIVED delta(kind=head bytes=1802) from S17
[S15] cosine check vs S17: cos=0.9996
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=46 metric=0.8251 head_norm=1.902712
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.100893e-02
[S17] stored merged vector for next round verification (round=46)
[S17] DEBUG after merge:  round=46 metric=0.8256 head_norm=1.902437 delta_norm=0.021009
[S17] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=46 metric=0.7143 head_norm=1.913369
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.796032e-02
[S15] stored merged vector for next round verification (round=46)
[S15] DEBUG after merge:  round=46 metric=0.7143 head_norm=1.907843 delta_norm=0.027960
[S15] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=2.074872 cos_to_last_merge=0.9961 (last merge round=32)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7205819774415901, 'auprc': 0.7345795286818739, 'loss_val': 1.0921534604147647, 'psi': 0.7261809979377036}-{'f1_val': 0.706480211597692, 'auprc': 0.7519659967635497, 'loss_val': 0.9933560111422106, 'psi': 0.7246745256640351}
[S3] START round=47 head_norm_before_train=1.733291 cos_to_last_merge=0.9912 (last merge round=34)
[S3] round=47 local utility u=0.426846 metrics={'f1_val': 0.8218314757742762, 'auprc': 0.9645449092098183, 'loss_val': 0.5186159992531234, 'psi': 0.8789168491484931}-{'f1_val': 0.7508027240024417, 'auprc': 0.9236464641181819, 'loss_val': 0.8234404235225187, 'psi': 0.8199402200487378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=47 head_norm_before_train=1.893513 cos_to_last_merge=0.8127 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.813
[S4] round=47 local utility u=0.128134 metrics={'f1_val': 0.9744296543387249, 'auprc': 0.9827584291877275, 'loss_val': 0.10263081695394143, 'psi': 0.9777611642783259}-{'f1_val': 0.9519785279613472, 'auprc': 0.9708510665767399, 'loss_val': 0.1884693742569969, 'psi': 0.9595275434075043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=47 head_norm_before_train=1.675633 cos_to_last_merge=0.9971 (last merge round=33)
[S5] round=47 local utility u=0.051690 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9945687512718417, 'loss_val': 0.13571356083000788, 'psi': 0.8180198596035522}-{'f1_val': 0.7009013953909534, 'auprc': 0.9911924247005738, 'loss_val': 0.23244913922569133, 'psi': 0.8170178071148015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=47 head_norm_before_train=1.815466 cos_to_last_merge=0.9997 (last merge round=44)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.5998992839499957, 'auprc': 0.7998368584268554, 'loss_val': 0.816188730604568, 'psi': 0.6798743137407396}-{'f1_val': 0.8233890162502803, 'auprc': 0.9553392974644027, 'loss_val': 0.4790919917093388, 'psi': 0.8761691287359292}
[S7] START round=47 head_norm_before_train=1.807619 cos_to_last_merge=0.9999 (last merge round=44)
[S7] round=47 local utility u=0.633947 metrics={'f1_val': 0.6646427648271263, 'auprc': 0.8019239847686838, 'loss_val': 0.5012837680277628, 'psi': 0.7195552528037492}-{'f1_val': 0.5308840488468436, 'auprc': 0.7779110303528991, 'loss_val': 0.8945868193175183, 'psi': 0.6296948414492658}
[S8] START round=47 head_norm_before_train=1.835377 cos_to_last_merge=0.9930 (last merge round=31)
[S8] round=47 local utility u=0.219169 metrics={'f1_val': 0.9742980378982122, 'auprc': 0.9989402757353005, 'loss_val': 0.06269046636416632, 'psi': 0.9841549330330476}-{'f1_val': 0.9196236886873299, 'auprc': 0.9842127009682188, 'loss_val': 0.12879965183829234, 'psi': 0.9454592935996855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=47 head_norm_before_train=1.941501 cos_to_last_merge=0.7884 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.788
[S9] round=47 local utility u=0.021050 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9974413575084433, 'loss_val': 0.01574626685721248, 'psi': 0.9975034770097636}-{'f1_val': 0.9912852408039612, 'auprc': 0.9998547847811317, 'loss_val': 0.02752835116541138, 'psi': 0.9947130583948294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=47 head_norm_before_train=1.783985 cos_to_last_merge=0.9972 (last merge round=33)
[S10] round=47 local utility u=0.002220 metrics={'f1_val': 0.9828806799350496, 'auprc': 0.9956745907059765, 'loss_val': 0.0499842589557274, 'psi': 0.9879982442434204}-{'f1_val': 0.9824723702591945, 'auprc': 0.9951774781865206, 'loss_val': 0.05048302734280846, 'psi': 0.9875544134301251}
[S10] not sending this round → trigger blocked (psi=0.988)
[S11] START round=47 head_norm_before_train=2.001778 cos_to_last_merge=0.8228 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.823
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9956334630615185, 'auprc': 0.9990606328389807, 'loss_val': 0.019428310746976707, 'psi': 0.9970043309725034}-{'f1_val': 0.9960467929594546, 'auprc': 0.9994924810190928, 'loss_val': 0.017776380175265526, 'psi': 0.9974250681833099}
[S13] START round=47 head_norm_before_train=1.614699 cos_to_last_merge=0.9944 (last merge round=26)
[S13] round=47 local utility u=0.023765 metrics={'f1_val': 0.7499098972269852, 'auprc': 0.7420683915119285, 'loss_val': 0.864489041114419, 'psi': 0.7467732949409625}-{'f1_val': 0.7352676604903676, 'auprc': 0.7403985083524196, 'loss_val': 0.8191552710279691, 'psi': 0.7373199996351885}
[S13] not sending this round → trigger blocked (psi=0.747)
[S14] START round=47 head_norm_before_train=1.733634 cos_to_last_merge=0.9690 (last merge round=25)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9989806801279695, 'loss_val': 0.028305297989859448, 'psi': 0.9976587366226495}-{'f1_val': 0.9969975081576651, 'auprc': 0.9989461996420039, 'loss_val': 0.029081689822866803, 'psi': 0.9977769847514006}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.907843 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=47 local utility u=1.000000 metrics={'f1_val': 0.9855349837940857, 'auprc': 0.985595288975172, 'loss_val': 0.08322872265393039, 'psi': 0.9855591058665202}-{'f1_val': 0.7143388843565796, 'auprc': 0.7925265704344895, 'loss_val': 0.7812542090797173, 'psi': 0.7456139587877435}
[S16] START round=47 head_norm_before_train=1.720756 cos_to_last_merge=0.7478 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.748
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.8469696783081442, 'auprc': 0.9802307749886507, 'loss_val': 0.9241851528640601, 'psi': 0.9002741169803468}-{'f1_val': 0.8451645008262698, 'auprc': 0.9902173228094009, 'loss_val': 0.9291941292278596, 'psi': 0.9031856296195222}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.902437 cos_to_last_merge=1.0000 (last merge round=46)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5725332836533054, 'auprc': 0.6528147484858139, 'loss_val': 1.4091624254481987, 'psi': 0.6046458695863088}-{'f1_val': 0.8251258412508844, 'auprc': 0.8795211896392313, 'loss_val': 0.46437764853182695, 'psi': 0.8468839806062232}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:39807
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:39817
[S6] RECEIVED delta(kind=head bytes=1795) from S7
[S6] cosine check vs S7: cos=0.9993
[S15] sending update (kind=head size=1805 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=47 metric=0.6646 head_norm=1.811703
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.014136e-02
[S7] stored merged vector for next round verification (round=47)
[S7] DEBUG after merge:  round=47 metric=0.6704 head_norm=1.813335 delta_norm=0.030141
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1805) from S15
[S17] cosine check vs S15: cos=0.9999
[S2] START round=48 head_norm_before_train=2.083670 cos_to_last_merge=0.9959 (last merge round=32)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.7214039998152364, 'auprc': 0.7309660634910929, 'loss_val': 1.0978171451394445, 'psi': 0.725228825285579}-{'f1_val': 0.7205819774415901, 'auprc': 0.7345795286818739, 'loss_val': 1.0921534604147647, 'psi': 0.7261809979377036}
[S3] START round=48 head_norm_before_train=1.743682 cos_to_last_merge=0.9905 (last merge round=34)
[S3] round=48 local utility u=0.810573 metrics={'f1_val': 0.9929705250606122, 'auprc': 0.99934863921881, 'loss_val': 0.028715444484874515, 'psi': 0.9955217707238914}-{'f1_val': 0.8218314757742762, 'auprc': 0.9645449092098183, 'loss_val': 0.5186159992531234, 'psi': 0.8789168491484931}
[S3] not sending this round → trigger blocked (psi=0.996)
[S4] START round=48 head_norm_before_train=1.897742 cos_to_last_merge=0.8126 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.813
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9506378485125446, 'auprc': 0.9710441906069146, 'loss_val': 0.1981211889547621, 'psi': 0.9588003853502927}-{'f1_val': 0.9744296543387249, 'auprc': 0.9827584291877275, 'loss_val': 0.10263081695394143, 'psi': 0.9777611642783259}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.680380 cos_to_last_merge=0.9967 (last merge round=33)
[S5] round=48 local utility u=0.405746 metrics={'f1_val': 0.8454652955235692, 'auprc': 0.9911055493391112, 'loss_val': 0.18469953997349223, 'psi': 0.903721397049786}-{'f1_val': 0.700320598491359, 'auprc': 0.9945687512718417, 'loss_val': 0.13571356083000788, 'psi': 0.8180198596035522}
[S5] not sending this round → trigger blocked (psi=0.904)
[S6] START round=48 head_norm_before_train=1.825193 cos_to_last_merge=0.9995 (last merge round=44)
[S6] round=48 local utility u=1.000000 metrics={'f1_val': 0.8505367390006987, 'auprc': 0.9830058918844031, 'loss_val': 0.26456435956557783, 'psi': 0.9035244001541805}-{'f1_val': 0.5998992839499957, 'auprc': 0.7998368584268554, 'loss_val': 0.816188730604568, 'psi': 0.6798743137407396}
[S7] START round=48 head_norm_before_train=1.813335 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=48 local utility u=0.076719 metrics={'f1_val': 0.6812824674177246, 'auprc': 0.8040318139793139, 'loss_val': 0.4540084213376643, 'psi': 0.7303822060423604}-{'f1_val': 0.6646427648271263, 'auprc': 0.8019239847686838, 'loss_val': 0.5012837680277628, 'psi': 0.7195552528037492}
[S8] START round=48 head_norm_before_train=1.845246 cos_to_last_merge=0.9927 (last merge round=31)
[S8] round=48 local utility u=0.064426 metrics={'f1_val': 0.992392260479464, 'auprc': 0.9975663286028024, 'loss_val': 0.038282391815068456, 'psi': 0.9944618877287994}-{'f1_val': 0.9742980378982122, 'auprc': 0.9989402757353005, 'loss_val': 0.06269046636416632, 'psi': 0.9841549330330476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=48 head_norm_before_train=1.949789 cos_to_last_merge=0.7879 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.788
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9948785595521599, 'loss_val': 0.01774995397400188, 'psi': 0.9959669185797213}-{'f1_val': 0.9975448900106438, 'auprc': 0.9974413575084433, 'loss_val': 0.01574626685721248, 'psi': 0.9975034770097636}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.793945 cos_to_last_merge=0.9968 (last merge round=33)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9775672769145339, 'auprc': 0.9947824777419214, 'loss_val': 0.054205347596618804, 'psi': 0.9844533572454889}-{'f1_val': 0.9828806799350496, 'auprc': 0.9956745907059765, 'loss_val': 0.0499842589557274, 'psi': 0.9879982442434204}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=2.009037 cos_to_last_merge=0.8222 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.822
[S11] round=48 local utility u=0.002886 metrics={'f1_val': 0.9963109504467467, 'auprc': 0.9991087795682709, 'loss_val': 0.0178661878009917, 'psi': 0.9974300820953563}-{'f1_val': 0.9956334630615185, 'auprc': 0.9990606328389807, 'loss_val': 0.019428310746976707, 'psi': 0.9970043309725034}
[S13] START round=48 head_norm_before_train=1.629246 cos_to_last_merge=0.9936 (last merge round=26)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6936363167962345, 'auprc': 0.6806207510326903, 'loss_val': 1.0167249697464558, 'psi': 0.6884300904908168}-{'f1_val': 0.7499098972269852, 'auprc': 0.7420683915119285, 'loss_val': 0.864489041114419, 'psi': 0.7467732949409625}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.744077 cos_to_last_merge=0.9680 (last merge round=25)
[S14] round=48 local utility u=0.000734 metrics={'f1_val': 0.996990823237825, 'auprc': 0.9991322709556466, 'loss_val': 0.028572403635460538, 'psi': 0.9978474023249536}-{'f1_val': 0.9967774409524363, 'auprc': 0.9989806801279695, 'loss_val': 0.028305297989859448, 'psi': 0.9976587366226495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S14] sending update (kind=head size=1810 to 1 peers)
[S15] START round=48 head_norm_before_train=1.918195 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.6996931330140286, 'auprc': 0.6650895627049054, 'loss_val': 0.7817733737580818, 'psi': 0.6858517048903793}-{'f1_val': 0.9855349837940857, 'auprc': 0.985595288975172, 'loss_val': 0.08322872265393039, 'psi': 0.9855591058665202}
[S16] START round=48 head_norm_before_train=1.726332 cos_to_last_merge=0.7475 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.747
[S16] round=48 local utility u=0.100788 metrics={'f1_val': 0.8572417722735467, 'auprc': 0.9881558327089704, 'loss_val': 0.8080174578298067, 'psi': 0.9096073964477163}-{'f1_val': 0.8469696783081442, 'auprc': 0.9802307749886507, 'loss_val': 0.9241851528640601, 'psi': 0.9002741169803468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=48 head_norm_before_train=1.915114 cos_to_last_merge=1.0000 (last merge round=46)
[S17] round=48 local utility u=1.000000 metrics={'f1_val': 0.742595121896561, 'auprc': 0.9998264810037314, 'loss_val': 0.6730961364799629, 'psi': 0.8454876655394292}-{'f1_val': 0.5725332836533054, 'auprc': 0.6528147484858139, 'loss_val': 1.4091624254481987, 'psi': 0.6046458695863088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39802
[S6] sending update (kind=head size=1798 to 1 peers)
[S17] sending update (kind=head size=1801 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=-0.0569
[S2] DROPPED delta from S11 (cos=-0.0569 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S7
[S6] cosine check vs S7: cos=0.9997
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] cosine check vs S6: cos=0.9997
[S15] RECEIVED delta(kind=head bytes=1801) from S17
[S15] cosine check vs S17: cos=0.9995
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=48 metric=0.6813 head_norm=1.816408
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.609262e-02
[S7] stored merged vector for next round verification (round=48)
[S7] DEBUG after merge:  round=48 metric=0.6840 head_norm=1.826197 delta_norm=0.026093
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=48 metric=0.8505 head_norm=1.836304
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.191087e-02
[S6] stored merged vector for next round verification (round=48)
[S6] DEBUG after merge:  round=48 metric=0.8505 head_norm=1.824903 delta_norm=0.031911
[S6] aggregate: ACCEPT kept=['S7', 'S7'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=48 metric=0.7426 head_norm=1.923436
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.906103e-02
[S17] stored merged vector for next round verification (round=48)
[S17] DEBUG after merge:  round=48 metric=0.7418 head_norm=1.920723 delta_norm=0.019061
[S17] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=48 metric=0.6997 head_norm=1.926579
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.924126e-02
[S15] stored merged vector for next round verification (round=48)
[S15] DEBUG after merge:  round=48 metric=0.6997 head_norm=1.924786 delta_norm=0.029241
[S15] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=2.095649 cos_to_last_merge=0.9955 (last merge round=32)
[S2] round=49 local utility u=0.010432 metrics={'f1_val': 0.7214862439687791, 'auprc': 0.7390623365308392, 'loss_val': 1.1017348774281983, 'psi': 0.7285166809936032}-{'f1_val': 0.7214039998152364, 'auprc': 0.7309660634910929, 'loss_val': 1.0978171451394445, 'psi': 0.725228825285579}
[S3] START round=49 head_norm_before_train=1.752651 cos_to_last_merge=0.9900 (last merge round=34)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9790451397070008, 'auprc': 0.998936201254088, 'loss_val': 0.07328003010246424, 'psi': 0.9870015643258357}-{'f1_val': 0.9929705250606122, 'auprc': 0.99934863921881, 'loss_val': 0.028715444484874515, 'psi': 0.9955217707238914}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.900896 cos_to_last_merge=0.8122 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.812
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.938686168920495, 'auprc': 0.9423988347705325, 'loss_val': 0.20754272362661164, 'psi': 0.9401712352605099}-{'f1_val': 0.9506378485125446, 'auprc': 0.9710441906069146, 'loss_val': 0.1981211889547621, 'psi': 0.9588003853502927}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.684680 cos_to_last_merge=0.9962 (last merge round=33)
[S5] round=49 local utility u=0.505343 metrics={'f1_val': 0.9963332086366786, 'auprc': 0.9970418907783833, 'loss_val': 0.09703007647695862, 'psi': 0.9966166814933606}-{'f1_val': 0.8454652955235692, 'auprc': 0.9911055493391112, 'loss_val': 0.18469953997349223, 'psi': 0.903721397049786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=49 head_norm_before_train=1.824903 cos_to_last_merge=1.0000 (last merge round=48)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6667780382334813, 'auprc': 0.9618226485134832, 'loss_val': 0.5241730221950375, 'psi': 0.784795882345482}-{'f1_val': 0.8505367390006987, 'auprc': 0.9830058918844031, 'loss_val': 0.26456435956557783, 'psi': 0.9035244001541805}
[S7] START round=49 head_norm_before_train=1.826197 cos_to_last_merge=1.0000 (last merge round=48)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5662911746616442, 'auprc': 0.7815727143522968, 'loss_val': 0.7516886395449319, 'psi': 0.6524037905379052}-{'f1_val': 0.6812824674177246, 'auprc': 0.8040318139793139, 'loss_val': 0.4540084213376643, 'psi': 0.7303822060423604}
[S8] START round=49 head_norm_before_train=1.850030 cos_to_last_merge=0.9924 (last merge round=31)
[S8] round=49 local utility u=0.003504 metrics={'f1_val': 0.9928779138875032, 'auprc': 0.9982353089986187, 'loss_val': 0.03619449249628112, 'psi': 0.9950208719319494}-{'f1_val': 0.992392260479464, 'auprc': 0.9975663286028024, 'loss_val': 0.038282391815068456, 'psi': 0.9944618877287994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=49 head_norm_before_train=1.951651 cos_to_last_merge=0.7877 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.788
[S9] round=49 local utility u=0.009193 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9998808118398752, 'loss_val': 0.016833622074837483, 'psi': 0.9982140722432358}-{'f1_val': 0.9966924912647621, 'auprc': 0.9948785595521599, 'loss_val': 0.01774995397400188, 'psi': 0.9959669185797213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=49 head_norm_before_train=1.805675 cos_to_last_merge=0.9966 (last merge round=33)
[S10] round=49 local utility u=0.005024 metrics={'f1_val': 0.9788148576804969, 'auprc': 0.9954143788838608, 'loss_val': 0.05353803677916423, 'psi': 0.9854546661618424}-{'f1_val': 0.9775672769145339, 'auprc': 0.9947824777419214, 'loss_val': 0.054205347596618804, 'psi': 0.9844533572454889}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=49 head_norm_before_train=2.016774 cos_to_last_merge=0.8219 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.822
[S11] round=49 local utility u=0.003582 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9995272367414074, 'loss_val': 0.01587817136908972, 'psi': 0.9979894486723093}-{'f1_val': 0.9963109504467467, 'auprc': 0.9991087795682709, 'loss_val': 0.0178661878009917, 'psi': 0.9974300820953563}
[S13] START round=49 head_norm_before_train=1.646937 cos_to_last_merge=0.9928 (last merge round=26)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.681616137565044, 'auprc': 0.6869130113984615, 'loss_val': 0.9920849826634898, 'psi': 0.683734887098411}-{'f1_val': 0.6936363167962345, 'auprc': 0.6806207510326903, 'loss_val': 1.0167249697464558, 'psi': 0.6884300904908168}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.751387 cos_to_last_merge=0.9672 (last merge round=25)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.99635583111001, 'auprc': 0.9970481201899649, 'loss_val': 0.03162370651862815, 'psi': 0.996632746741992}-{'f1_val': 0.996990823237825, 'auprc': 0.9991322709556466, 'loss_val': 0.028572403635460538, 'psi': 0.9978474023249536}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.924786 cos_to_last_merge=1.0000 (last merge round=48)
[S15] round=49 local utility u=1.000000 metrics={'f1_val': 0.9696155723403876, 'auprc': 0.9935179352851086, 'loss_val': 0.06418393784123066, 'psi': 0.9791765175182761}-{'f1_val': 0.6996931330140286, 'auprc': 0.6650895627049054, 'loss_val': 0.7817733737580818, 'psi': 0.6858517048903793}
[S16] START round=49 head_norm_before_train=1.733776 cos_to_last_merge=0.7470 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.747
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.838811668564421, 'auprc': 0.832053457932599, 'loss_val': 1.0820673489404733, 'psi': 0.8361083843116921}-{'f1_val': 0.8572417722735467, 'auprc': 0.9881558327089704, 'loss_val': 0.8080174578298067, 'psi': 0.9096073964477163}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.920723 cos_to_last_merge=1.0000 (last merge round=48)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6331856262315896, 'auprc': 0.95717514891309, 'loss_val': 1.2284017332369006, 'psi': 0.7627814353041897}-{'f1_val': 0.742595121896561, 'auprc': 0.9998264810037314, 'loss_val': 0.6730961364799629, 'psi': 0.8454876655394292}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:39802
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:39812
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:39817
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] cosine check vs S11: cos=-0.0568
[S2] DROPPED delta from S11 (cos=-0.0568 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S2
[S11] cosine check vs S2: cos=-0.0568
[S11] DROPPED delta from S2 (cos=-0.0568 < 0.0)
[S15] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S15
[S17] cosine check vs S15: cos=0.9997
[runner] rounds complete.
[runner] all agents stopped.
