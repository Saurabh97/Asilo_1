[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:54503
[S3] → join 127.0.0.1:54502
[S4] → join 127.0.0.1:54502
[S5] → join 127.0.0.1:54502
[S6] → join 127.0.0.1:54502
[S7] → join 127.0.0.1:54502
[S8] → join 127.0.0.1:54502
[S9] → join 127.0.0.1:54502
[S10] → join 127.0.0.1:54502
[S11] → join 127.0.0.1:54502
[S13] → join 127.0.0.1:54502
[S14] → join 127.0.0.1:54502
[S15] → join 127.0.0.1:54502
[S16] → join 127.0.0.1:54502
[S17] → join 127.0.0.1:54502
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.187878 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.124628 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.205519 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.148928 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.172072 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.214365 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.175722 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.166516 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.162876 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.185910 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.165223 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.170615 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.183965 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.236737 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.149565 (no previous merge yet)
[S17]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S3] + discovered S4
[S3] + discovered S10
[S3] + discovered S5
[S3] + discovered S6
[S3] + discovered S16
[S3] + discovered S8
[S3] + discovered S7
[S3] + discovered S9
[S3] + discovered S14
[S3] + discovered S17
[S3] + discovered S11
[S3] + discovered S13
[S3] + discovered S15
[S4] + discovered S3
[S4] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S5] + discovered S2
[S4] + discovered S15
[S4] + discovered S13
[S4] + discovered S11
[S4] + discovered S17
[S4] + discovered S14
[S4] + discovered S9
[S4] + discovered S7
[S4] + discovered S8
[S4] + discovered S16
[S4] + discovered S6
[S4] + discovered S5
[S4] + discovered S10
[S5] + discovered S6
[S5] + discovered S14
[S5] + discovered S10
[S5] + discovered S16
[S5] + discovered S7
[S5] + discovered S9
[S5] + discovered S17
[S5] + discovered S13
[S5] + discovered S8
[S5] + discovered S11
[S5] + discovered S15
[S6] + discovered S2
[S6] + discovered S4
[S6] + discovered S5
[S6] + discovered S3
[S7] + discovered S5
[S7] + discovered S2
[S6] + discovered S11
[S6] + discovered S7
[S6] + discovered S8
[S6] + discovered S13
[S7] + discovered S3
[S6] + discovered S9
[S6] + discovered S10
[S6] + discovered S15
[S6] + discovered S17
[S6] + discovered S16
[S6] + discovered S14
[S7] + discovered S4
[S7] + discovered S6
[S8] + discovered S3
[S8] + discovered S2
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S4
[S8] + discovered S7
[S7] + discovered S10
[S7] + discovered S9
[S7] + discovered S15
[S7] + discovered S14
[S7] + discovered S13
[S7] + discovered S16
[S7] + discovered S8
[S7] + discovered S11
[S7] + discovered S17
[S8] + discovered S11
[S8] + discovered S13
[S8] + discovered S14
[S8] + discovered S16
[S9] + discovered S7
[S8] + discovered S10
[S9] + discovered S4
[S8] + discovered S17
[S9] + discovered S6
[S8] + discovered S15
[S9] + discovered S3
[S9] + discovered S8
[S9] + discovered S2
[S9] + discovered S5
[S8] + discovered S9
[S10] + discovered S3
[S10] + discovered S8
[S10] + discovered S4
[S10] + discovered S7
[S10] + discovered S2
[S10] + discovered S9
[S9] + discovered S15
[S10] + discovered S6
[S10] + discovered S5
[S9] + discovered S14
[S9] + discovered S13
[S9] + discovered S16
[S9] + discovered S17
[S9] + discovered S10
[S9] + discovered S11
[S10] + discovered S17
[S11] + discovered S5
[S11] + discovered S9
[S11] + discovered S10
[S11] + discovered S2
[S11] + discovered S7
[S11] + discovered S6
[S10] + discovered S14
[S11] + discovered S4
[S11] + discovered S8
[S11] + discovered S3
[S10] + discovered S16
[S10] + discovered S13
[S10] + discovered S15
[S10] + discovered S11
[S13] + discovered S5
[S11] + discovered S14
[S13] + discovered S7
[S11] + discovered S15
[S13] + discovered S10
[S11] + discovered S16
[S13] + discovered S9
[S13] + discovered S4
[S13] + discovered S6
[S11] + discovered S13
[S13] + discovered S11
[S13] + discovered S2
[S13] + discovered S8
[S11] + discovered S17
[S13] + discovered S3
[S14] + discovered S4
[S14] + discovered S2
[S13] + discovered S14
[S14] + discovered S7
[S13] + discovered S16
[S14] + discovered S11
[S13] + discovered S15
[S14] + discovered S13
[S14] + discovered S5
[S14] + discovered S8
[S14] + discovered S6
[S14] + discovered S9
[S14] + discovered S10
[S14] + discovered S3
[S13] + discovered S17
[S14] + discovered S15
[S14] + discovered S17
[S14] + discovered S16
[S15] + discovered S8
[S15] + discovered S13
[S15] + discovered S7
[S15] + discovered S2
[S15] + discovered S11
[S15] + discovered S4
[S15] + discovered S5
[S15] + discovered S9
[S15] + discovered S14
[S15] + discovered S10
[S15] + discovered S6
[S15] + discovered S3
[S15] + discovered S17
[S16] + discovered S6
[S16] + discovered S10
[S16] + discovered S7
[S15] + discovered S16
[S16] + discovered S3
[S16] + discovered S14
[S16] + discovered S2
[S16] + discovered S15
[S16] + discovered S13
[S16] + discovered S11
[S16] + discovered S5
[S16] + discovered S4
[S16] + discovered S9
[S16] + discovered S8
[S17] + discovered S5
[S17] + discovered S16
[S17] + discovered S15
[S17] + discovered S11
[S17] + discovered S13
[S17] + discovered S2
[S17] + discovered S14
[S17] + discovered S3
[S17] + discovered S7
[S17] + discovered S6
[S17] + discovered S4
[S17] + discovered S8
[S17] + discovered S10
[S17] + discovered S9
[S16] + discovered S17
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=1.000 → S14@127.0.0.1:54514
[S4] ⇄ pheromone p=1.000 → S14@127.0.0.1:54514
[S7] ⇄ pheromone p=1.000 → S13@127.0.0.1:54513
[S8] ⇄ pheromone p=1.000 → S5@127.0.0.1:54505
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:54503
[S9] ⇄ pheromone p=1.000 → S7@127.0.0.1:54508
[S10] ⇄ pheromone p=1.000 → S5@127.0.0.1:54505
[S6] ⇄ pheromone p=1.000 → S7@127.0.0.1:54508
[S2] ⇄ pheromone p=1.000 → S6@127.0.0.1:54507
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:54511
[S11] ⇄ pheromone p=1.000 → S2@127.0.0.1:54502
[S3] ⇄ pheromone p=1.000 → S14@127.0.0.1:54514
[S15] ⇄ pheromone p=1.000 → S14@127.0.0.1:54514
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:54508
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:54509
[S2] START round=1 head_norm_before_train=1.179495 (no previous merge yet)
[S2] round=1 local utility u=0.725840 metrics={'f1_val': 0.27358894278689616, 'auprc': 0.6006032484578774, 'loss_val': 1.3552909363361967, 'psi': 0.40439466505528865}-{'f1_val': 0.14319175515302934, 'auprc': 0.3874982861841318, 'loss_val': 1.3852721676003839, 'psi': 0.24091436756547033}
[S3] START round=1 head_norm_before_train=1.121245 (no previous merge yet)
[S3] round=1 local utility u=0.261334 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7953017534900697, 'loss_val': 1.2894614210655952, 'psi': 0.40202474076449213}-{'f1_val': 0.13984006561410703, 'auprc': 0.6440911945942291, 'loss_val': 1.3584981107825826, 'psi': 0.34154051720615586}
[S4] START round=1 head_norm_before_train=1.212187 (no previous merge yet)
[S4] round=1 local utility u=0.969898 metrics={'f1_val': 0.401678582067322, 'auprc': 0.6199951655205412, 'loss_val': 1.31707473226264, 'psi': 0.4890052154486097}-{'f1_val': 0.10637591321673677, 'auprc': 0.5760355197453991, 'loss_val': 1.3531753827093127, 'psi': 0.2942397558282017}
[S5] START round=1 head_norm_before_train=1.171301 (no previous merge yet)
[S5] round=1 local utility u=0.030494 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7696417650536579, 'loss_val': 1.2512095094528615, 'psi': 0.39321384887860605}-{'f1_val': 0.14226190476190476, 'auprc': 0.7696007977370463, 'loss_val': 1.3120737146215444, 'psi': 0.39319746195196137}
[S6] START round=1 head_norm_before_train=1.177048 (no previous merge yet)
[S6] round=1 local utility u=0.055983 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6518187881567059, 'loss_val': 1.3182280914713933, 'psi': 0.3455832844934516}-{'f1_val': 0.14142628205128205, 'auprc': 0.6285674666009153, 'loss_val': 1.3604406246059233, 'psi': 0.3362827558711354}
[S7] START round=1 head_norm_before_train=1.218233 (no previous merge yet)
[S7] round=1 local utility u=0.443918 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.776717734294381, 'loss_val': 1.2957588424176953, 'psi': 0.39592118735520737}-{'f1_val': 0.10429108604291086, 'auprc': 0.5759370070983035, 'loss_val': 1.3546582863485614, 'psi': 0.2929494544650679}
[S8] START round=1 head_norm_before_train=1.171176 (no previous merge yet)
[S8] round=1 local utility u=1.000000 metrics={'f1_val': 0.4158888197469405, 'auprc': 0.7538501529725683, 'loss_val': 1.3464409679228269, 'psi': 0.5510733530371916}-{'f1_val': 0.00420149074218982, 'auprc': 0.7698345620572462, 'loss_val': 1.3818254885990118, 'psi': 0.3104547192682124}
[S9] START round=1 head_norm_before_train=1.172530 (no previous merge yet)
[S9] round=1 local utility u=0.281742 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9770512502755437, 'loss_val': 1.2634523479366107, 'psi': 0.4756592743942151}-{'f1_val': 0.141397957139996, 'auprc': 0.8111542425174411, 'loss_val': 1.3292452641560666, 'psi': 0.4093004712909741}
[S10] START round=1 head_norm_before_train=1.164557 (no previous merge yet)
[S10] round=1 local utility u=0.311762 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5271025986497625, 'loss_val': 1.3318142712577434, 'psi': 0.29401402198493937}-{'f1_val': 0.10798722044728434, 'auprc': 0.3890574827789293, 'loss_val': 1.3573964153646643, 'psi': 0.22041532537994235}
[S11] START round=1 head_norm_before_train=1.190632 (no previous merge yet)
[S11] round=1 local utility u=0.193412 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7795751542845518, 'loss_val': 1.3125727720410305, 'psi': 0.3960782717376871}-{'f1_val': 0.14041368337311058, 'auprc': 0.6597364679729137, 'loss_val': 1.3398812594171408, 'psi': 0.3481427972130319}
[S13] START round=1 head_norm_before_train=1.161207 (no previous merge yet)
[S13] round=1 local utility u=0.016179 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5271568707948662, 'loss_val': 1.3050523380130539, 'psi': 0.29509420586417834}-{'f1_val': 0.1403857625770531, 'auprc': 0.5287495996840545, 'loss_val': 1.342188160896102, 'psi': 0.2957312974198537}
[S14] START round=1 head_norm_before_train=1.171498 (no previous merge yet)
[S14] round=1 local utility u=0.642511 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7625031069655983, 'loss_val': 1.3628771262007477, 'psi': 0.3892159545158616}-{'f1_val': 0.05498154981549815, 'auprc': 0.512717157550649, 'loss_val': 1.3862830022411665, 'psi': 0.23807579290955846}
[S15] START round=1 head_norm_before_train=1.188077 (no previous merge yet)
[S15] round=1 local utility u=0.048663 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.5949405367544451, 'loss_val': 1.3258098129796754, 'psi': 0.32181640551871304}-{'f1_val': 0.13973365136155833, 'auprc': 0.5713447591892895, 'loss_val': 1.3523476670672627, 'psi': 0.3123780944926508}
[S16] START round=1 head_norm_before_train=1.248090 (no previous merge yet)
[S16] round=1 local utility u=0.020108 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.996678418903503, 'loss_val': 1.3084905011762824, 'psi': 0.48305383768092314}-{'f1_val': 0.14063745019920318, 'auprc': 0.9917092253980555, 'loss_val': 1.3337995283180588, 'psi': 0.48106616027874416}
[S17] START round=1 head_norm_before_train=1.149554 (no previous merge yet)
[S17] round=1 local utility u=0.419027 metrics={'f1_val': 0.16717543992862433, 'auprc': 0.5834974837495498, 'loss_val': 1.3365905633327106, 'psi': 0.3337042574569945}-{'f1_val': 0.11607250862499922, 'auprc': 0.4148804080354621, 'loss_val': 1.362176180544147, 'psi': 0.2355956683891844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S10] → sending delta(kind=head bytes=1788) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:54516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S14] → sending delta(kind=head bytes=1787) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S2] → sending delta(kind=head bytes=1787) to S9@127.0.0.1:54510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:54516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S11] → sending delta(kind=head bytes=1785) to S9@127.0.0.1:54510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:54515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1778 reason=None
[S16] → sending delta(kind=head bytes=1778) to S4@127.0.0.1:54504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:54516
[S4] sending update (kind=head size=1789 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1778 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1785 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1787 to 1 peers)
[S14] sending update (kind=head size=1787 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1788 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=0.1720
[S17] RECEIVED delta(kind=head bytes=1787) from S14
[S17] cosine check vs S14: cos=0.0725
[S16] RECEIVED delta(kind=head bytes=1791) from S6
[S16] cosine check vs S6: cos=-0.0076
[S16] DROPPED delta from S6 (cos=-0.0076 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1789) from S4
[S16] cosine check vs S4: cos=-0.0558
[S16] DROPPED delta from S4 (cos=-0.0558 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S15
[S16] cosine check vs S15: cos=0.0773
[S9] RECEIVED delta(kind=head bytes=1785) from S11
[S9] cosine check vs S11: cos=0.0240
[S9] RECEIVED delta(kind=head bytes=1787) from S2
[S9] cosine check vs S2: cos=0.0081
[S14] RECEIVED delta(kind=head bytes=1791) from S8
[S14] cosine check vs S8: cos=0.0484
[S8] RECEIVED delta(kind=head bytes=1792) from S13
[S8] cosine check vs S13: cos=-0.0738
[S8] DROPPED delta from S13 (cos=-0.0738 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S9
[S15] cosine check vs S9: cos=0.0141
[S7] RECEIVED delta(kind=head bytes=1793) from S3
[S7] cosine check vs S3: cos=-0.1456
[S7] DROPPED delta from S3 (cos=-0.1456 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] cosine check vs S5: cos=0.0756
[S11] RECEIVED delta(kind=head bytes=1788) from S10
[S11] cosine check vs S10: cos=0.0006
[S4] RECEIVED delta(kind=head bytes=1778) from S16
[S4] cosine check vs S16: cos=-0.0558
[S4] DROPPED delta from S16 (cos=-0.0558 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1791 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1791) from S17
[S8] cosine check vs S17: cos=-0.0985
[S8] DROPPED delta from S17 (cos=-0.0985 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.172480
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.798603e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1027 head_norm=0.927533 delta_norm=0.779860
[S10] aggregate: ROLLBACK (f1_val pre=0.139 post=0.103 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.267066
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.390886e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.906529 delta_norm=0.839089
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.1404 head_norm=1.181708
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.144879e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.0550 head_norm=0.854916 delta_norm=0.814488
[S14] aggregate: ROLLBACK (f1_val pre=0.140 post=0.055 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.202611
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.454252e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.857399 delta_norm=0.845425
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.205604
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.266224e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.742371 delta_norm=0.726622
[S9] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.201769
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.259459e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.763060 delta_norm=0.725946
[S11] aggregate: ACCEPT kept=['S5', 'S10'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1672 head_norm=1.157345
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.964887e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.3916 head_norm=0.856473 delta_norm=0.796489
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.182590 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7777008348815337, 'loss_val': 1.324287618179276, 'psi': 0.39614661398575357}-{'f1_val': 0.27358894278689616, 'auprc': 0.6006032484578774, 'loss_val': 1.3552909363361967, 'psi': 0.40439466505528865}
[S3] START round=2 head_norm_before_train=1.150841 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.613672342521979, 'loss_val': 1.182514047196226, 'psi': 0.3293729763772558}-{'f1_val': 0.13984006561410703, 'auprc': 0.7953017534900697, 'loss_val': 1.2894614210655952, 'psi': 0.40202474076449213}
[S4] START round=2 head_norm_before_train=1.227925 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7528140821487039, 'loss_val': 1.2717988852803046, 'psi': 0.38526161019659205}-{'f1_val': 0.401678582067322, 'auprc': 0.6199951655205412, 'loss_val': 1.31707473226264, 'psi': 0.4890052154486097}
[S5] START round=2 head_norm_before_train=1.208104 (no previous merge yet)
[S5] round=2 local utility u=0.042577 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7693572030091053, 'loss_val': 1.1652014015257437, 'psi': 0.393100024060785}-{'f1_val': 0.14226190476190476, 'auprc': 0.7696417650536579, 'loss_val': 1.2512095094528615, 'psi': 0.39321384887860605}
[S6] START round=2 head_norm_before_train=1.190194 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6335866009870762, 'loss_val': 1.2820769163970878, 'psi': 0.3382904096255997}-{'f1_val': 0.14142628205128205, 'auprc': 0.6518187881567059, 'loss_val': 1.3182280914713933, 'psi': 0.3455832844934516}
[S7] START round=2 head_norm_before_train=1.249916 (no previous merge yet)
[S7] round=2 local utility u=0.026430 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777245346864702, 'loss_val': 1.2459183681932267, 'psi': 0.3963239075120431}-{'f1_val': 0.14205682272909165, 'auprc': 0.776717734294381, 'loss_val': 1.2957588424176953, 'psi': 0.39592118735520737}
[S8] START round=2 head_norm_before_train=1.179876 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7429774312760762, 'loss_val': 1.3056077679726181, 'psi': 0.3811645619462048}-{'f1_val': 0.4158888197469405, 'auprc': 0.7538501529725683, 'loss_val': 1.3464409679228269, 'psi': 0.5510733530371916}
[S9] START round=2 head_norm_before_train=0.742371 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.035752 metrics={'f1_val': 0.141397957139996, 'auprc': 0.989640459839762, 'loss_val': 1.2297155505528383, 'psi': 0.48069495821990244}-{'f1_val': 0.141397957139996, 'auprc': 0.9770512502755437, 'loss_val': 1.2634523479366107, 'psi': 0.4756592743942151}
[S10] START round=2 head_norm_before_train=0.927533 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.166006 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6404721915355496, 'loss_val': 1.3399119243442728, 'psi': 0.3393618591392542}-{'f1_val': 0.13862163754172394, 'auprc': 0.5271025986497625, 'loss_val': 1.3318142712577434, 'psi': 0.29401402198493937}
[S11] START round=2 head_norm_before_train=0.763060 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7139523089563378, 'loss_val': 1.315658254522577, 'psi': 0.36982913360640146}-{'f1_val': 0.14041368337311058, 'auprc': 0.7795751542845518, 'loss_val': 1.3125727720410305, 'psi': 0.3960782717376871}
[S13] START round=2 head_norm_before_train=1.172381 (no previous merge yet)
[S13] round=2 local utility u=0.108300 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5860518537982253, 'loss_val': 1.2651373345923238, 'psi': 0.318652199065522}-{'f1_val': 0.1403857625770531, 'auprc': 0.5271568707948662, 'loss_val': 1.3050523380130539, 'psi': 0.29509420586417834}
[S14] START round=2 head_norm_before_train=0.854916 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.682826 metrics={'f1_val': 0.3633704233795716, 'auprc': 0.7738201073436439, 'loss_val': 1.3692520110395479, 'psi': 0.5275502969652006}-{'f1_val': 0.14035785288270378, 'auprc': 0.7625031069655983, 'loss_val': 1.3628771262007477, 'psi': 0.3892159545158616}
[S15] START round=2 head_norm_before_train=0.857399 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.285705 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7853089767384263, 'loss_val': 1.325504616468078, 'psi': 0.39796378151230555}-{'f1_val': 0.13973365136155833, 'auprc': 0.5949405367544451, 'loss_val': 1.3258098129796754, 'psi': 0.32181640551871304}
[S16] START round=2 head_norm_before_train=0.906529 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8348075379286645, 'loss_val': 1.320307363380861, 'psi': 0.41830548529098777}-{'f1_val': 0.14063745019920318, 'auprc': 0.996678418903503, 'loss_val': 1.3084905011762824, 'psi': 0.48305383768092314}
[S17] START round=2 head_norm_before_train=0.856473 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.153290 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7415127197352746, 'loss_val': 1.3466977282219197, 'psi': 0.38117446588454046}-{'f1_val': 0.16717543992862433, 'auprc': 0.5834974837495498, 'loss_val': 1.3365905633327106, 'psi': 0.3337042574569945}
[S13] not sending this round → trigger blocked (psi=0.319)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.398)
[S5] not sending this round → trigger blocked (psi=0.393)
[S7] not sending this round → trigger blocked (psi=0.396)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.528)
[S9] not sending this round → trigger blocked (psi=0.481)
[S10] not sending this round → trigger blocked (psi=0.339)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.381)
[S2] START round=3 head_norm_before_train=1.195022 (no previous merge yet)
[S2] round=3 local utility u=0.017833 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7771167335595273, 'loss_val': 1.28686898874704, 'psi': 0.395912973456951}-{'f1_val': 0.1417771333885667, 'auprc': 0.7777008348815337, 'loss_val': 1.324287618179276, 'psi': 0.39614661398575357}
[S3] START round=3 head_norm_before_train=1.205269 (no previous merge yet)
[S3] round=3 local utility u=1.000000 metrics={'f1_val': 0.41826717164570004, 'auprc': 0.7952163631398678, 'loss_val': 0.9863232025654481, 'psi': 0.5690468482433672}-{'f1_val': 0.13984006561410703, 'auprc': 0.613672342521979, 'loss_val': 1.182514047196226, 'psi': 0.3293729763772558}
[S4] START round=3 head_norm_before_train=1.252394 (no previous merge yet)
[S4] round=3 local utility u=0.069496 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7795615120972187, 'loss_val': 1.2130494527563762, 'psi': 0.395960582175998}-{'f1_val': 0.14022662889518414, 'auprc': 0.7528140821487039, 'loss_val': 1.2717988852803046, 'psi': 0.38526161019659205}
[S5] START round=3 head_norm_before_train=1.259742 (no previous merge yet)
[S5] round=3 local utility u=0.897328 metrics={'f1_val': 0.41819354899256067, 'auprc': 0.777749001929214, 'loss_val': 1.0513116221842227, 'psi': 0.562015730167222}-{'f1_val': 0.14226190476190476, 'auprc': 0.7693572030091053, 'loss_val': 1.1652014015257437, 'psi': 0.393100024060785}
[S6] START round=3 head_norm_before_train=1.208034 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6125397431184059, 'loss_val': 1.2582309134053324, 'psi': 0.3298716664781316}-{'f1_val': 0.14142628205128205, 'auprc': 0.6335866009870762, 'loss_val': 1.2820769163970878, 'psi': 0.3382904096255997}
[S7] START round=3 head_norm_before_train=1.298758 (no previous merge yet)
[S7] round=3 local utility u=0.027362 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778865647862658, 'loss_val': 1.19168088820743, 'psi': 0.39638871955196137}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777245346864702, 'loss_val': 1.2459183681932267, 'psi': 0.3963239075120431}
[S8] START round=3 head_norm_before_train=1.200495 (no previous merge yet)
[S8] round=3 local utility u=0.001309 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7262005802895115, 'loss_val': 1.2526586643987332, 'psi': 0.3744538215515789}-{'f1_val': 0.13995598239295717, 'auprc': 0.7429774312760762, 'loss_val': 1.3056077679726181, 'psi': 0.3811645619462048}
[S9] START round=3 head_norm_before_train=0.795426 cos_to_last_merge=0.9882 (last merge round=1)
[S9] round=3 local utility u=0.036683 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9679867090284615, 'loss_val': 1.0913882254334766, 'psi': 0.47203345789538226}-{'f1_val': 0.141397957139996, 'auprc': 0.989640459839762, 'loss_val': 1.2297155505528383, 'psi': 0.48069495821990244}
[S10] START round=3 head_norm_before_train=0.932947 cos_to_last_merge=0.9973 (last merge round=1)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6131217595175438, 'loss_val': 1.3012335902875007, 'psi': 0.3284216863320519}-{'f1_val': 0.13862163754172394, 'auprc': 0.6404721915355496, 'loss_val': 1.3399119243442728, 'psi': 0.3393618591392542}
[S11] START round=3 head_norm_before_train=0.779666 cos_to_last_merge=0.9961 (last merge round=1)
[S11] round=3 local utility u=0.011271 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7117253087137534, 'loss_val': 1.2864352918606021, 'psi': 0.3689383335093677}-{'f1_val': 0.14041368337311058, 'auprc': 0.7139523089563378, 'loss_val': 1.315658254522577, 'psi': 0.36982913360640146}
[S13] START round=3 head_norm_before_train=1.194454 (no previous merge yet)
[S13] round=3 local utility u=0.085809 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.628136228009625, 'loss_val': 1.2197734034273588, 'psi': 0.33548594875008186}-{'f1_val': 0.1403857625770531, 'auprc': 0.5860518537982253, 'loss_val': 1.2651373345923238, 'psi': 0.318652199065522}
[S14] START round=3 head_norm_before_train=0.867423 cos_to_last_merge=0.9968 (last merge round=1)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7805198014283876, 'loss_val': 1.3452592860481365, 'psi': 0.3964226323009773}-{'f1_val': 0.3633704233795716, 'auprc': 0.7738201073436439, 'loss_val': 1.3692520110395479, 'psi': 0.5275502969652006}
[S15] START round=3 head_norm_before_train=0.872560 cos_to_last_merge=0.9970 (last merge round=1)
[S15] round=3 local utility u=0.013197 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7851510453776641, 'loss_val': 1.298637627995696, 'psi': 0.39790060896800067}-{'f1_val': 0.13973365136155833, 'auprc': 0.7853089767384263, 'loss_val': 1.325504616468078, 'psi': 0.39796378151230555}
[S16] START round=3 head_norm_before_train=0.925036 cos_to_last_merge=0.9972 (last merge round=1)
[S16] round=3 local utility u=0.019405 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8348707403355458, 'loss_val': 1.281686029701796, 'psi': 0.4183307662537402}-{'f1_val': 0.14063745019920318, 'auprc': 0.8348075379286645, 'loss_val': 1.320307363380861, 'psi': 0.41830548529098777}
[S17] START round=3 head_norm_before_train=0.871399 cos_to_last_merge=0.9971 (last merge round=1)
[S17] round=3 local utility u=0.111916 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8042373681174649, 'loss_val': 1.3110397813303676, 'psi': 0.4062643252374166}-{'f1_val': 0.14094896331738438, 'auprc': 0.7415127197352746, 'loss_val': 1.3466977282219197, 'psi': 0.38117446588454046}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S2] → sending delta(kind=head bytes=1787) to S6@127.0.0.1:54507
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:54511
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:54503
[S5] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1787 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S4
[S14] cosine check vs S4: cos=-0.0050
[S14] DROPPED delta from S4 (cos=-0.0050 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1792) from S7
[S13] cosine check vs S7: cos=-0.0238
[S13] DROPPED delta from S7 (cos=-0.0238 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S11
[S2] cosine check vs S11: cos=0.0262
[S5] RECEIVED delta(kind=head bytes=1795) from S8
[S5] cosine check vs S8: cos=0.0878
[S6] RECEIVED delta(kind=head bytes=1787) from S2
[S6] cosine check vs S2: cos=-0.1499
[S6] DROPPED delta from S2 (cos=-0.1499 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S9
[S7] cosine check vs S9: cos=0.0596
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=0.0505
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] cosine check vs S5: cos=0.0717
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=0.0859
[S14] RECEIVED delta(kind=head bytes=1792) from S16
[S14] cosine check vs S16: cos=0.1002
[S14] RECEIVED delta(kind=head bytes=1798) from S3
[S14] cosine check vs S3: cos=0.1575
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=-0.0498
[S8] DROPPED delta from S17 (cos=-0.0498 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.1386 head_norm=0.948651
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.532310e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.1386 head_norm=0.791021 delta_norm=0.753231
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=0.889674
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.170304e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.602842 delta_norm=0.517030
[S14] aggregate: ACCEPT kept=['S15', 'S16', 'S3'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=1.326367
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.695307e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.812700 delta_norm=0.769531
[S7] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=1.215182
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.197788e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1418 head_norm=0.737376 delta_norm=0.719779
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.4183 head_norm=1.262350
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.710997e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.3965 head_norm=0.935909 delta_norm=0.871100
[S3] aggregate: ROLLBACK (f1_val pre=0.418 post=0.396 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.4182 head_norm=1.294587
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.534504e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.4191 head_norm=0.931909 delta_norm=0.853450
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.737376 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.008758 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7822265273581037, 'loss_val': 1.2846826046551023, 'psi': 0.39795689097638154}-{'f1_val': 0.1417771333885667, 'auprc': 0.7771167335595273, 'loss_val': 1.28686898874704, 'psi': 0.395912973456951}
[S3] START round=4 head_norm_before_train=0.935909 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.004157 metrics={'f1_val': 0.39776905080213903, 'auprc': 0.7957298514080497, 'loss_val': 0.8565603635712329, 'psi': 0.5569533710445034}-{'f1_val': 0.41826717164570004, 'auprc': 0.7952163631398678, 'loss_val': 0.9863232025654481, 'psi': 0.5690468482433672}
[S4] START round=4 head_norm_before_train=1.283063 (no previous merge yet)
[S4] round=4 local utility u=0.299571 metrics={'f1_val': 0.22332340668838752, 'auprc': 0.7818024111440588, 'loss_val': 1.119211656553092, 'psi': 0.44671500847065604}-{'f1_val': 0.14022662889518414, 'auprc': 0.7795615120972187, 'loss_val': 1.2130494527563762, 'psi': 0.395960582175998}
[S5] START round=4 head_norm_before_train=0.931909 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.053793 metrics={'f1_val': 0.41750764008433106, 'auprc': 0.7777218186615922, 'loss_val': 0.9395291926444592, 'psi': 0.5615933115152355}-{'f1_val': 0.41819354899256067, 'auprc': 0.777749001929214, 'loss_val': 1.0513116221842227, 'psi': 0.562015730167222}
[S6] START round=4 head_norm_before_train=1.228970 (no previous merge yet)
[S6] round=4 local utility u=0.022457 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6203530386456657, 'loss_val': 1.2367565408141707, 'psi': 0.3329969846890355}-{'f1_val': 0.14142628205128205, 'auprc': 0.6125397431184059, 'loss_val': 1.2582309134053324, 'psi': 0.3298716664781316}
[S7] START round=4 head_norm_before_train=0.812700 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.548825 metrics={'f1_val': 0.31218143201564286, 'auprc': 0.7951866895026615, 'loss_val': 1.1666781462466462, 'psi': 0.5053835350104503}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778865647862658, 'loss_val': 1.19168088820743, 'psi': 0.39638871955196137}
[S8] START round=4 head_norm_before_train=1.231953 (no previous merge yet)
[S8] round=4 local utility u=0.079792 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7657305645845376, 'loss_val': 1.211665515388582, 'psi': 0.39026581526958937}-{'f1_val': 0.13995598239295717, 'auprc': 0.7262005802895115, 'loss_val': 1.2526586643987332, 'psi': 0.3744538215515789}
[S9] START round=4 head_norm_before_train=0.863752 cos_to_last_merge=0.9658 (last merge round=1)
[S9] round=4 local utility u=1.000000 metrics={'f1_val': 0.7022582254763806, 'auprc': 0.9856882546354072, 'loss_val': 0.8004269486099518, 'psi': 0.8156302371399913}-{'f1_val': 0.141397957139996, 'auprc': 0.9679867090284615, 'loss_val': 1.0913882254334766, 'psi': 0.47203345789538226}
[S10] START round=4 head_norm_before_train=0.791021 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=0.032304 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6224068830653378, 'loss_val': 1.2644814163561644, 'psi': 0.3321357357511695}-{'f1_val': 0.13862163754172394, 'auprc': 0.6131217595175438, 'loss_val': 1.3012335902875007, 'psi': 0.3284216863320519}
[S11] START round=4 head_norm_before_train=0.804328 cos_to_last_merge=0.9870 (last merge round=1)
[S11] round=4 local utility u=0.006243 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7021686582358861, 'loss_val': 1.2452788404199322, 'psi': 0.3651156733182208}-{'f1_val': 0.14041368337311058, 'auprc': 0.7117253087137534, 'loss_val': 1.2864352918606021, 'psi': 0.3689383335093677}
[S13] START round=4 head_norm_before_train=1.219100 (no previous merge yet)
[S13] round=4 local utility u=0.112785 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6836164454829439, 'loss_val': 1.1606434048011964, 'psi': 0.35767803573940943}-{'f1_val': 0.1403857625770531, 'auprc': 0.628136228009625, 'loss_val': 1.2197734034273588, 'psi': 0.33548594875008186}
[S14] START round=4 head_norm_before_train=0.602842 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6542681103144921, 'loss_val': 1.3342286945430524, 'psi': 0.34592195585541907}-{'f1_val': 0.14035785288270378, 'auprc': 0.7805198014283876, 'loss_val': 1.3452592860481365, 'psi': 0.3964226323009773}
[S15] START round=4 head_norm_before_train=0.897032 cos_to_last_merge=0.9893 (last merge round=1)
[S15] round=4 local utility u=0.007357 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7778140942880082, 'loss_val': 1.261913117144129, 'psi': 0.3949658285321383}-{'f1_val': 0.13973365136155833, 'auprc': 0.7851510453776641, 'loss_val': 1.298637627995696, 'psi': 0.39790060896800067}
[S16] START round=4 head_norm_before_train=0.954864 cos_to_last_merge=0.9893 (last merge round=1)
[S16] round=4 local utility u=0.024157 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.834310759103351, 'loss_val': 1.2316914853881977, 'psi': 0.41810677376086236}-{'f1_val': 0.14063745019920318, 'auprc': 0.8348707403355458, 'loss_val': 1.281686029701796, 'psi': 0.4183307662537402}
[S17] START round=4 head_norm_before_train=0.896009 cos_to_last_merge=0.9888 (last merge round=1)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6072270551116661, 'loss_val': 1.2582200024675834, 'psi': 0.32746020003509707}-{'f1_val': 0.14094896331738438, 'auprc': 0.8042373681174649, 'loss_val': 1.3110397813303676, 'psi': 0.4062643252374166}
[S13] not sending this round → trigger blocked (psi=0.358)
[S3] not sending this round → trigger blocked (psi=0.557)
[S8] not sending this round → trigger blocked (psi=0.390)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S10] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:54505
[S9] not sending this round → trigger blocked (psi=0.816)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:54508
[S16] not sending this round → trigger blocked (psi=0.418)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.398)
[S5] not sending this round → trigger blocked (psi=0.562)
[S4] not sending this round → trigger blocked (psi=0.447)
[S11] not sending this round → trigger blocked (psi=0.365)
[S15] not sending this round → trigger blocked (psi=0.395)
[S7] not sending this round → trigger blocked (psi=0.505)
[S6] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1788 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1793) from S6
[S7] cosine check vs S6: cos=0.0023
[S5] RECEIVED delta(kind=head bytes=1788) from S10
[S5] cosine check vs S10: cos=-0.0787
[S5] DROPPED delta from S10 (cos=-0.0787 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.3122 head_norm=0.854292
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.528982e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.4163 head_norm=0.754503 delta_norm=0.752898
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.765371 cos_to_last_merge=0.9969 (last merge round=3)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.699410822151344, 'loss_val': 1.2361880302012163, 'psi': 0.36483060889367763}-{'f1_val': 0.1417771333885667, 'auprc': 0.7822265273581037, 'loss_val': 1.2846826046551023, 'psi': 0.39795689097638154}
[S3] START round=5 head_norm_before_train=1.011213 cos_to_last_merge=0.9905 (last merge round=3)
[S3] round=5 local utility u=0.079454 metrics={'f1_val': 0.40375458928096164, 'auprc': 0.7969719274193888, 'loss_val': 0.7372925428106194, 'psi': 0.5610415245363325}-{'f1_val': 0.39776905080213903, 'auprc': 0.7957298514080497, 'loss_val': 0.8565603635712329, 'psi': 0.5569533710445034}
[S4] START round=5 head_norm_before_train=1.324983 (no previous merge yet)
[S4] round=5 local utility u=0.642493 metrics={'f1_val': 0.4139930282181375, 'auprc': 0.7811365224310972, 'loss_val': 0.9762453374988311, 'psi': 0.5608504259033213}-{'f1_val': 0.22332340668838752, 'auprc': 0.7818024111440588, 'loss_val': 1.119211656553092, 'psi': 0.44671500847065604}
[S5] START round=5 head_norm_before_train=0.987752 cos_to_last_merge=0.9939 (last merge round=3)
[S5] round=5 local utility u=0.816793 metrics={'f1_val': 0.6528214823667624, 'auprc': 0.7948630448366509, 'loss_val': 0.7692502640749855, 'psi': 0.7096381073547178}-{'f1_val': 0.41750764008433106, 'auprc': 0.7777218186615922, 'loss_val': 0.9395291926444592, 'psi': 0.5615933115152355}
[S6] START round=5 head_norm_before_train=1.241953 (no previous merge yet)
[S6] round=5 local utility u=0.048509 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6418067294064725, 'loss_val': 1.2040993400818043, 'psi': 0.34157846099335826}-{'f1_val': 0.14142628205128205, 'auprc': 0.6203530386456657, 'loss_val': 1.2367565408141707, 'psi': 0.3329969846890355}
[S7] START round=5 head_norm_before_train=0.754503 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.367118 metrics={'f1_val': 0.41736073619820624, 'auprc': 0.7876964430011506, 'loss_val': 1.0410480668379585, 'psi': 0.565495018919384}-{'f1_val': 0.31218143201564286, 'auprc': 0.7951866895026615, 'loss_val': 1.1666781462466462, 'psi': 0.5053835350104503}
[S8] START round=5 head_norm_before_train=1.259337 (no previous merge yet)
[S8] round=5 local utility u=0.514969 metrics={'f1_val': 0.3030874875966246, 'auprc': 0.7677518244858998, 'loss_val': 1.1665800004323643, 'psi': 0.48895322235233474}-{'f1_val': 0.13995598239295717, 'auprc': 0.7657305645845376, 'loss_val': 1.211665515388582, 'psi': 0.39026581526958937}
[S9] START round=5 head_norm_before_train=0.937001 cos_to_last_merge=0.9441 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.944
[S9] round=5 local utility u=0.182190 metrics={'f1_val': 0.7018630368647369, 'auprc': 0.9988414339404943, 'loss_val': 0.4731347026470148, 'psi': 0.8206543956950398}-{'f1_val': 0.7022582254763806, 'auprc': 0.9856882546354072, 'loss_val': 0.8004269486099518, 'psi': 0.8156302371399913}
[S10] START round=5 head_norm_before_train=0.818933 cos_to_last_merge=0.9962 (last merge round=3)
[S10] round=5 local utility u=0.011918 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6080918882666125, 'loss_val': 1.1977000524228236, 'psi': 0.32640973783167937}-{'f1_val': 0.13862163754172394, 'auprc': 0.6224068830653378, 'loss_val': 1.2644814163561644, 'psi': 0.3321357357511695}
[S11] START round=5 head_norm_before_train=0.835600 cos_to_last_merge=0.9745 (last merge round=1)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.595907373631595, 'loss_val': 1.1925818447769343, 'psi': 0.3226111594765043}-{'f1_val': 0.14041368337311058, 'auprc': 0.7021686582358861, 'loss_val': 1.2452788404199322, 'psi': 0.3651156733182208}
[S13] START round=5 head_norm_before_train=1.243296 (no previous merge yet)
[S13] round=5 local utility u=0.809386 metrics={'f1_val': 0.41607788054795825, 'auprc': 0.6442440780954061, 'loss_val': 1.0779072803376855, 'psi': 0.5073443595669374}-{'f1_val': 0.1403857625770531, 'auprc': 0.6836164454829439, 'loss_val': 1.1606434048011964, 'psi': 0.35767803573940943}
[S14] START round=5 head_norm_before_train=0.631027 cos_to_last_merge=0.9942 (last merge round=3)
[S14] round=5 local utility u=0.040509 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6694526224005565, 'loss_val': 1.2987638954906375, 'psi': 0.35199576068984484}-{'f1_val': 0.14035785288270378, 'auprc': 0.6542681103144921, 'loss_val': 1.3342286945430524, 'psi': 0.34592195585541907}
[S15] START round=5 head_norm_before_train=0.928476 cos_to_last_merge=0.9781 (last merge round=1)
[S15] round=5 local utility u=0.031220 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7769894265769883, 'loss_val': 1.1969991735696124, 'psi': 0.39463596144773033}-{'f1_val': 0.13973365136155833, 'auprc': 0.7778140942880082, 'loss_val': 1.261913117144129, 'psi': 0.3949658285321383}
[S16] START round=5 head_norm_before_train=0.988829 cos_to_last_merge=0.9786 (last merge round=1)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8113999603687648, 'loss_val': 1.1737629388248259, 'psi': 0.4089424542670279}-{'f1_val': 0.14063745019920318, 'auprc': 0.834310759103351, 'loss_val': 1.2316914853881977, 'psi': 0.41810677376086236}
[S17] START round=5 head_norm_before_train=0.931046 cos_to_last_merge=0.9757 (last merge round=1)
[S17] round=5 local utility u=0.041339 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6125554388804797, 'loss_val': 1.1915269952291705, 'psi': 0.3295915535426225}-{'f1_val': 0.14094896331738438, 'auprc': 0.6072270551116661, 'loss_val': 1.2582200024675834, 'psi': 0.32746020003509707}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:54511
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.326)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:54503
[S6] not sending this round → trigger blocked (psi=0.342)
[S5] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S7
[S13] cosine check vs S7: cos=-0.0575
[S13] DROPPED delta from S7 (cos=-0.0575 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S8
[S5] cosine check vs S8: cos=0.6432
[S10] RECEIVED delta(kind=head bytes=1792) from S13
[S10] cosine check vs S13: cos=0.7670
[S14] RECEIVED delta(kind=head bytes=1805) from S3
[S14] cosine check vs S3: cos=0.2050
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.4805
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] cosine check vs S4: cos=0.0068
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=0.5960
[S7] RECEIVED delta(kind=head bytes=1804) from S14
[S7] cosine check vs S14: cos=0.0611
[S7] RECEIVED delta(kind=head bytes=1793) from S9
[S7] cosine check vs S9: cos=0.3251
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1792 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S17
[S8] cosine check vs S17: cos=-0.0621
[S8] DROPPED delta from S17 (cos=-0.0621 < 0.0)
[S6] ⇄ pheromone p=0.346 → S7@127.0.0.1:54508
[S11] ⇄ pheromone p=0.346 → S2@127.0.0.1:54502
[S2] ⇄ pheromone p=0.391 → S6@127.0.0.1:54507
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.1386 head_norm=0.849758
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.115579e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.1386 head_norm=0.998024 delta_norm=0.411558
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.378 → S5@127.0.0.1:54505
[S13] ⇄ pheromone p=0.531 → S10@127.0.0.1:54511
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.669415
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.647174e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.555209 delta_norm=0.364717
[S14] aggregate: ACCEPT kept=['S3', 'S15', 'S4'] (k=3/3) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.458 → S7@127.0.0.1:54508
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.4038 head_norm=1.109413
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.874243e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.4044 head_norm=0.967676 delta_norm=0.487424
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.494 → S14@127.0.0.1:54514
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.6528 head_norm=1.056957
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.048900e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.7081 head_norm=1.061843 delta_norm=0.504890
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.621 → S3@127.0.0.1:54503
[S4] ⇄ pheromone p=0.592 → S14@127.0.0.1:54514
[S9] ⇄ pheromone p=0.556 → S7@127.0.0.1:54508
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.4174 head_norm=0.812237
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.396471e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.4172 head_norm=0.589666 delta_norm=0.439647
[S7] aggregate: ACCEPT kept=['S14', 'S9'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.531 → S13@127.0.0.1:54513
[S8] ⇄ pheromone p=0.526 → S5@127.0.0.1:54505
[S15] ⇄ pheromone p=0.370 → S14@127.0.0.1:54514
[S16] ⇄ pheromone p=0.336 → S14@127.0.0.1:54514
[S17] ⇄ pheromone p=0.400 → S8@127.0.0.1:54509
[S2] START round=6 head_norm_before_train=0.803301 cos_to_last_merge=0.9882 (last merge round=3)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6170829962849018, 'loss_val': 1.1867351549694296, 'psi': 0.3318994785471008}-{'f1_val': 0.1417771333885667, 'auprc': 0.699410822151344, 'loss_val': 1.2361880302012163, 'psi': 0.36483060889367763}
[S3] START round=6 head_norm_before_train=0.967676 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.197347 metrics={'f1_val': 0.4045316402820668, 'auprc': 0.9342893216304509, 'loss_val': 0.7592139972052948, 'psi': 0.6164347128214205}-{'f1_val': 0.40375458928096164, 'auprc': 0.7969719274193888, 'loss_val': 0.7372925428106194, 'psi': 0.5610415245363325}
[S4] START round=6 head_norm_before_train=1.369777 (no previous merge yet)
[S4] round=6 local utility u=0.681369 metrics={'f1_val': 0.6757873492633468, 'auprc': 0.657177994525169, 'loss_val': 0.8123981733549974, 'psi': 0.6683436073680757}-{'f1_val': 0.4139930282181375, 'auprc': 0.7811365224310972, 'loss_val': 0.9762453374988311, 'psi': 0.5608504259033213}
[S5] START round=6 head_norm_before_train=1.061843 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.193197 metrics={'f1_val': 0.7149202099987672, 'auprc': 0.7913917392245783, 'loss_val': 0.7450356983736587, 'psi': 0.7455088216890917}-{'f1_val': 0.6528214823667624, 'auprc': 0.7948630448366509, 'loss_val': 0.7692502640749855, 'psi': 0.7096381073547178}
[S6] START round=6 head_norm_before_train=1.263414 (no previous merge yet)
[S6] round=6 local utility u=0.147008 metrics={'f1_val': 0.17823682584730627, 'auprc': 0.6439000781591461, 'loss_val': 1.137226414694763, 'psi': 0.3645021267720422}-{'f1_val': 0.14142628205128205, 'auprc': 0.6418067294064725, 'loss_val': 1.2040993400818043, 'psi': 0.34157846099335826}
[S7] START round=6 head_norm_before_train=0.589666 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.054162 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.7846813106343435, 'loss_val': 0.9217270716353507, 'psi': 0.5640937805465063}-{'f1_val': 0.41736073619820624, 'auprc': 0.7876964430011506, 'loss_val': 1.0410480668379585, 'psi': 0.565495018919384}
[S8] START round=6 head_norm_before_train=1.283624 (no previous merge yet)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7148755912016524, 'auprc': 0.7767124465052304, 'loss_val': 1.1077575621298528, 'psi': 0.7396103333230837}-{'f1_val': 0.3030874875966246, 'auprc': 0.7677518244858998, 'loss_val': 1.1665800004323643, 'psi': 0.48895322235233474}
[S9] START round=6 head_norm_before_train=1.043698 cos_to_last_merge=0.9120 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.912
[S9] round=6 local utility u=0.063907 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9988497769690685, 'loss_val': 0.3438573741953822, 'psi': 0.8205088202185644}-{'f1_val': 0.7018630368647369, 'auprc': 0.9988414339404943, 'loss_val': 0.4731347026470148, 'psi': 0.8206543956950398}
[S10] START round=6 head_norm_before_train=0.998024 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=1.000000 metrics={'f1_val': 0.4157904658747533, 'auprc': 0.7193930581572869, 'loss_val': 1.1254233227607056, 'psi': 0.5372315027877668}-{'f1_val': 0.13862163754172394, 'auprc': 0.6080918882666125, 'loss_val': 1.1977000524228236, 'psi': 0.32640973783167937}
[S11] START round=6 head_norm_before_train=0.875231 cos_to_last_merge=0.9583 (last merge round=1)
[S11] round=6 local utility u=0.287559 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.755276729796457, 'loss_val': 1.0955712813235043, 'psi': 0.38635890194244915}-{'f1_val': 0.14041368337311058, 'auprc': 0.595907373631595, 'loss_val': 1.1925818447769343, 'psi': 0.3226111594765043}
[S13] START round=6 head_norm_before_train=1.268375 (no previous merge yet)
[S13] round=6 local utility u=0.003468 metrics={'f1_val': 0.4159679838056728, 'auprc': 0.6120693589728725, 'loss_val': 0.9737873586096534, 'psi': 0.4944085338725527}-{'f1_val': 0.41607788054795825, 'auprc': 0.6442440780954061, 'loss_val': 1.0779072803376855, 'psi': 0.5073443595669374}
[S14] START round=6 head_norm_before_train=0.555209 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.622616636169778, 'loss_val': 1.2779061300395127, 'psi': 0.3332613661975335}-{'f1_val': 0.14035785288270378, 'auprc': 0.6694526224005565, 'loss_val': 1.2987638954906375, 'psi': 0.35199576068984484}
[S15] START round=6 head_norm_before_train=0.973003 cos_to_last_merge=0.9636 (last merge round=1)
[S15] round=6 local utility u=0.901164 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.7878512460044832, 'loss_val': 1.087109886750393, 'psi': 0.5649660021061598}-{'f1_val': 0.13973365136155833, 'auprc': 0.7769894265769883, 'loss_val': 1.1969991735696124, 'psi': 0.39463596144773033}
[S16] START round=6 head_norm_before_train=1.022316 cos_to_last_merge=0.9670 (last merge round=1)
[S16] round=6 local utility u=0.716626 metrics={'f1_val': 0.41742175001598325, 'auprc': 0.6940220496006979, 'loss_val': 1.0490839063289952, 'psi': 0.5280618698498691}-{'f1_val': 0.14063745019920318, 'auprc': 0.8113999603687648, 'loss_val': 1.1737629388248259, 'psi': 0.4089424542670279}
[S17] START round=6 head_norm_before_train=0.965978 cos_to_last_merge=0.9624 (last merge round=1)
[S17] round=6 local utility u=0.885952 metrics={'f1_val': 0.3924431904544764, 'auprc': 0.6676810427337454, 'loss_val': 1.0939646277005322, 'psi': 0.502538331366184}-{'f1_val': 0.14094896331738438, 'auprc': 0.6125554388804797, 'loss_val': 1.1915269952291705, 'psi': 0.3295915535426225}
[S7] not sending this round → trigger blocked (psi=0.564)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:54505
[S8] not sending this round → trigger blocked (psi=0.740)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:54502
[S15] not sending this round → trigger blocked (psi=0.565)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.668)
[S13] not sending this round → trigger blocked (psi=0.494)
[S3] not sending this round → trigger blocked (psi=0.616)
[S5] not sending this round → trigger blocked (psi=0.746)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:54508
[S9] not sending this round → trigger blocked (psi=0.821)
[S10] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1792) from S16
[S14] cosine check vs S16: cos=0.3983
[S2] RECEIVED delta(kind=head bytes=1793) from S11
[S2] cosine check vs S11: cos=0.5142
[S7] RECEIVED delta(kind=head bytes=1791) from S6
[S7] cosine check vs S6: cos=0.5117
[S5] RECEIVED delta(kind=head bytes=1789) from S10
[S5] cosine check vs S10: cos=-0.1080
[S5] DROPPED delta from S10 (cos=-0.1080 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.503)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.591980
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.922048e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.701073 delta_norm=0.492205
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.4170 head_norm=0.678518
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.558274e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.4169 head_norm=0.870725 delta_norm=0.555827
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.1418 head_norm=0.843797
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.331664e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.1418 head_norm=0.763230 delta_norm=0.433166
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.763230 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.548688 metrics={'f1_val': 0.2580967482130273, 'auprc': 0.7349344334235374, 'loss_val': 1.1408314199418947, 'psi': 0.4488318222972313}-{'f1_val': 0.1417771333885667, 'auprc': 0.6170829962849018, 'loss_val': 1.1867351549694296, 'psi': 0.3318994785471008}
[S3] START round=7 head_norm_before_train=1.061838 cos_to_last_merge=0.9897 (last merge round=5)
[S3] round=7 local utility u=1.000000 metrics={'f1_val': 0.6924948654681071, 'auprc': 0.9954979275665465, 'loss_val': 0.47917669040777766, 'psi': 0.8136960903074828}-{'f1_val': 0.4045316402820668, 'auprc': 0.9342893216304509, 'loss_val': 0.7592139972052948, 'psi': 0.6164347128214205}
[S4] START round=7 head_norm_before_train=1.410475 (no previous merge yet)
[S4] round=7 local utility u=0.028267 metrics={'f1_val': 0.6621846384056419, 'auprc': 0.6583497076119997, 'loss_val': 0.6777634408711618, 'psi': 0.660650666088185}-{'f1_val': 0.6757873492633468, 'auprc': 0.657177994525169, 'loss_val': 0.8123981733549974, 'psi': 0.6683436073680757}
[S5] START round=7 head_norm_before_train=1.114652 cos_to_last_merge=0.9947 (last merge round=5)
[S5] round=7 local utility u=0.024199 metrics={'f1_val': 0.6983818865662754, 'auprc': 0.7905359297013269, 'loss_val': 0.5948411850082639, 'psi': 0.735243503820296}-{'f1_val': 0.7149202099987672, 'auprc': 0.7913917392245783, 'loss_val': 0.7450356983736587, 'psi': 0.7455088216890917}
[S6] START round=7 head_norm_before_train=1.293765 (no previous merge yet)
[S6] round=7 local utility u=0.922325 metrics={'f1_val': 0.4164535851642239, 'auprc': 0.7389537340020393, 'loss_val': 1.0070379855098421, 'psi': 0.5454536446993501}-{'f1_val': 0.17823682584730627, 'auprc': 0.6439000781591461, 'loss_val': 1.137226414694763, 'psi': 0.3645021267720422}
[S7] START round=7 head_norm_before_train=0.870725 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.722747 metrics={'f1_val': 0.644121226343779, 'auprc': 0.7818802780789562, 'loss_val': 0.8303449220594546, 'psi': 0.6992248470378499}-{'f1_val': 0.41703542715461484, 'auprc': 0.7846813106343435, 'loss_val': 0.9217270716353507, 'psi': 0.5640937805465063}
[S8] START round=7 head_norm_before_train=1.307981 (no previous merge yet)
[S8] round=7 local utility u=0.073242 metrics={'f1_val': 0.7147473519913303, 'auprc': 0.7770274296870341, 'loss_val': 0.9614496978905045, 'psi': 0.7396593830696119}-{'f1_val': 0.7148755912016524, 'auprc': 0.7767124465052304, 'loss_val': 1.1077575621298528, 'psi': 0.7396103333230837}
[S9] START round=7 head_norm_before_train=1.156008 cos_to_last_merge=0.8789 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.879
[S9] round=7 local utility u=0.021496 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9988298232263337, 'loss_val': 0.2993048704721057, 'psi': 0.820350729922039}-{'f1_val': 0.7016148490515617, 'auprc': 0.9988497769690685, 'loss_val': 0.3438573741953822, 'psi': 0.8205088202185644}
[S10] START round=7 head_norm_before_train=1.019007 cos_to_last_merge=0.9977 (last merge round=5)
[S10] round=7 local utility u=0.134191 metrics={'f1_val': 0.4170518629654155, 'auprc': 0.7521125616465235, 'loss_val': 0.962767721746469, 'psi': 0.5510761424378587}-{'f1_val': 0.4157904658747533, 'auprc': 0.7193930581572869, 'loss_val': 1.1254233227607056, 'psi': 0.5372315027877668}
[S11] START round=7 head_norm_before_train=0.910117 cos_to_last_merge=0.9450 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.945
[S11] round=7 local utility u=1.000000 metrics={'f1_val': 0.39658602128368947, 'auprc': 0.9807452029506207, 'loss_val': 0.979307026954419, 'psi': 0.630249693950462}-{'f1_val': 0.14041368337311058, 'auprc': 0.755276729796457, 'loss_val': 1.0955712813235043, 'psi': 0.38635890194244915}
[S13] START round=7 head_norm_before_train=1.301172 (no previous merge yet)
[S13] round=7 local utility u=0.081627 metrics={'f1_val': 0.37170506565784633, 'auprc': 0.7253377882316058, 'loss_val': 0.8847612383708073, 'psi': 0.51315815468735}-{'f1_val': 0.4159679838056728, 'auprc': 0.6120693589728725, 'loss_val': 0.9737873586096534, 'psi': 0.4944085338725527}
[S14] START round=7 head_norm_before_train=0.701073 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.189421 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7368062193203377, 'loss_val': 1.2416334797312882, 'psi': 0.37893719945775733}-{'f1_val': 0.14035785288270378, 'auprc': 0.622616636169778, 'loss_val': 1.2779061300395127, 'psi': 0.3332613661975335}
[S15] START round=7 head_norm_before_train=1.022205 cos_to_last_merge=0.9478 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=7 local utility u=0.104785 metrics={'f1_val': 0.41691903018686227, 'auprc': 0.7989449359242861, 'loss_val': 0.9140794404433282, 'psi': 0.5697293924818319}-{'f1_val': 0.4163758395072774, 'auprc': 0.7878512460044832, 'loss_val': 1.087109886750393, 'psi': 0.5649660021061598}
[S16] START round=7 head_norm_before_train=1.056929 cos_to_last_merge=0.9545 (last merge round=1)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.4353112078725129, 'auprc': 0.605868858437225, 'loss_val': 0.9079337627228984, 'psi': 0.5035342680983977}-{'f1_val': 0.41742175001598325, 'auprc': 0.6940220496006979, 'loss_val': 1.0490839063289952, 'psi': 0.5280618698498691}
[S17] START round=7 head_norm_before_train=1.005688 cos_to_last_merge=0.9480 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.948
[S17] round=7 local utility u=0.114511 metrics={'f1_val': 0.3910215094004868, 'auprc': 0.7158235136509004, 'loss_val': 1.000839640363878, 'psi': 0.5209423111006523}-{'f1_val': 0.3924431904544764, 'auprc': 0.6676810427337454, 'loss_val': 1.0939646277005322, 'psi': 0.502538331366184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:54508
[S10] not sending this round → trigger blocked (psi=0.551)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:54508
[S11] not sending this round → trigger blocked (psi=0.630)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:54514
[S6] not sending this round → trigger blocked (psi=0.545)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:54503
[S5] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1807 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S3
[S14] cosine check vs S3: cos=0.1673
[S10] RECEIVED delta(kind=head bytes=1794) from S13
[S10] cosine check vs S13: cos=0.9270
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.5537
[S14] RECEIVED delta(kind=head bytes=1807) from S4
[S14] cosine check vs S4: cos=0.1363
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=0.7188
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.1279
[S7] RECEIVED delta(kind=head bytes=1802) from S9
[S7] cosine check vs S9: cos=0.2879
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] cosine check vs S7: cos=-0.0649
[S13] DROPPED delta from S7 (cos=-0.0649 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S8
[S5] cosine check vs S8: cos=0.8602
[S6] RECEIVED delta(kind=head bytes=1797) from S2
[S6] cosine check vs S2: cos=-0.0660
[S6] DROPPED delta from S2 (cos=-0.0660 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=-0.0737
[S8] DROPPED delta from S17 (cos=-0.0737 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.4171 head_norm=1.051198
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.689492e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.4168 head_norm=1.174106 delta_norm=0.268949
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1404 head_norm=0.727029
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.613524e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1404 head_norm=0.623030 delta_norm=0.361352
[S14] aggregate: ACCEPT kept=['S3', 'S15', 'S4'] (k=3/3) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.6984 head_norm=1.185213
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.422154e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.7006 head_norm=1.218148 delta_norm=0.342215
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.6441 head_norm=0.936522
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.958158e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.4168 head_norm=0.675564 delta_norm=0.495816
[S7] aggregate: ROLLBACK (f1_val pre=0.644 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.6925 head_norm=1.165408
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.407707e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.6912 head_norm=1.089575 delta_norm=0.440771
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.799151 cos_to_last_merge=0.9961 (last merge round=6)
[S2] round=8 local utility u=0.597695 metrics={'f1_val': 0.417102078559347, 'auprc': 0.7775351875607951, 'loss_val': 1.0272759841272325, 'psi': 0.5612753221599263}-{'f1_val': 0.2580967482130273, 'auprc': 0.7349344334235374, 'loss_val': 1.1408314199418947, 'psi': 0.4488318222972313}
[S3] START round=8 head_norm_before_train=1.089575 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.076395 metrics={'f1_val': 0.7004261945879899, 'auprc': 0.9950013904867769, 'loss_val': 0.3724854279951939, 'psi': 0.8182562729475047}-{'f1_val': 0.6924948654681071, 'auprc': 0.9954979275665465, 'loss_val': 0.47917669040777766, 'psi': 0.8136960903074828}
[S4] START round=8 head_norm_before_train=1.461520 (no previous merge yet)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.5461777037914867, 'auprc': 0.6563022534323466, 'loss_val': 0.6145064873137581, 'psi': 0.5902275236478307}-{'f1_val': 0.6621846384056419, 'auprc': 0.6583497076119997, 'loss_val': 0.6777634408711618, 'psi': 0.660650666088185}
[S5] START round=8 head_norm_before_train=1.218148 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.6833252547218338, 'auprc': 0.785588350115602, 'loss_val': 0.5901929536976568, 'psi': 0.724230492879341}-{'f1_val': 0.6983818865662754, 'auprc': 0.7905359297013269, 'loss_val': 0.5948411850082639, 'psi': 0.735243503820296}
[S6] START round=8 head_norm_before_train=1.319491 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.3864171493488354, 'auprc': 0.7360676816628884, 'loss_val': 0.8397367912212123, 'psi': 0.5262773622744567}-{'f1_val': 0.4164535851642239, 'auprc': 0.7389537340020393, 'loss_val': 1.0070379855098421, 'psi': 0.5454536446993501}
[S7] START round=8 head_norm_before_train=0.675564 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.6216024775654927, 'auprc': 0.7874648948934004, 'loss_val': 0.8782647129794162, 'psi': 0.6879474444966558}-{'f1_val': 0.644121226343779, 'auprc': 0.7818802780789562, 'loss_val': 0.8303449220594546, 'psi': 0.6992248470378499}
[S8] START round=8 head_norm_before_train=1.340619 (no previous merge yet)
[S8] round=8 local utility u=0.077263 metrics={'f1_val': 0.7016547028006626, 'auprc': 0.7925831814569192, 'loss_val': 0.77503560175564, 'psi': 0.7380260942631652}-{'f1_val': 0.7147473519913303, 'auprc': 0.7770274296870341, 'loss_val': 0.9614496978905045, 'psi': 0.7396593830696119}
[S9] START round=8 head_norm_before_train=1.238930 cos_to_last_merge=0.8540 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.854
[S9] round=8 local utility u=0.008759 metrics={'f1_val': 0.7013629453504064, 'auprc': 0.9988154153374753, 'loss_val': 0.28173392939247777, 'psi': 0.820343933345234}-{'f1_val': 0.7013646677191758, 'auprc': 0.9988298232263337, 'loss_val': 0.2993048704721057, 'psi': 0.820350729922039}
[S10] START round=8 head_norm_before_train=1.174106 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.293785 metrics={'f1_val': 0.38639886648742156, 'auprc': 0.9622945105475997, 'loss_val': 0.8218264320692945, 'psi': 0.6167571241114929}-{'f1_val': 0.4170518629654155, 'auprc': 0.7521125616465235, 'loss_val': 0.962767721746469, 'psi': 0.5510761424378587}
[S11] START round=8 head_norm_before_train=0.948837 cos_to_last_merge=0.9300 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.930
[S11] round=8 local utility u=0.081775 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9826557967555842, 'loss_val': 0.8212851389002368, 'psi': 0.6309936602579574}-{'f1_val': 0.39658602128368947, 'auprc': 0.9807452029506207, 'loss_val': 0.979307026954419, 'psi': 0.630249693950462}
[S13] START round=8 head_norm_before_train=1.340410 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.37169029467602305, 'auprc': 0.5678499814848638, 'loss_val': 0.9466530556802246, 'psi': 0.4501541693995593}-{'f1_val': 0.37170506565784633, 'auprc': 0.7253377882316058, 'loss_val': 0.8847612383708073, 'psi': 0.51315815468735}
[S14] START round=8 head_norm_before_train=0.623030 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.371687 metrics={'f1_val': 0.1647787034724902, 'auprc': 0.9121202448931436, 'loss_val': 1.1707266171288457, 'psi': 0.4637153200407516}-{'f1_val': 0.14035785288270378, 'auprc': 0.7368062193203377, 'loss_val': 1.2416334797312882, 'psi': 0.37893719945775733}
[S15] START round=8 head_norm_before_train=1.073444 cos_to_last_merge=0.9318 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.932
[S15] round=8 local utility u=0.150839 metrics={'f1_val': 0.4304769893508231, 'auprc': 0.8210382183377687, 'loss_val': 0.7600298848793865, 'psi': 0.5867014809456014}-{'f1_val': 0.41691903018686227, 'auprc': 0.7989449359242861, 'loss_val': 0.9140794404433282, 'psi': 0.5697293924818319}
[S16] START round=8 head_norm_before_train=1.095986 cos_to_last_merge=0.9392 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.939
[S16] round=8 local utility u=0.101370 metrics={'f1_val': 0.364549442904167, 'auprc': 0.7882417475354281, 'loss_val': 0.8277422229188118, 'psi': 0.5340263647566714}-{'f1_val': 0.4353112078725129, 'auprc': 0.605868858437225, 'loss_val': 0.9079337627228984, 'psi': 0.5035342680983977}
[S17] START round=8 head_norm_before_train=1.054313 cos_to_last_merge=0.9299 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.930
[S17] round=8 local utility u=0.275282 metrics={'f1_val': 0.35725765849729063, 'auprc': 0.9295572443993417, 'loss_val': 0.8888935934392147, 'psi': 0.586177492858111}-{'f1_val': 0.3910215094004868, 'auprc': 0.7158235136509004, 'loss_val': 1.000839640363878, 'psi': 0.5209423111006523}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:54505
[S15] not sending this round → trigger blocked (psi=0.587)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.820)
[S3] not sending this round → trigger blocked (psi=0.818)
[S2] not sending this round → trigger blocked (psi=0.561)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:54502
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:54514
[S14] not sending this round → trigger blocked (psi=0.464)
[S8] not sending this round → trigger blocked (psi=0.738)
[S16] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] cosine check vs S10: cos=-0.1050
[S5] DROPPED delta from S10 (cos=-0.1050 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=0.5978
[S2] RECEIVED delta(kind=head bytes=1793) from S11
[S2] cosine check vs S11: cos=0.8142
[S17] not sending this round → trigger blocked (psi=0.586)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.4171 head_norm=0.840128
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.913162e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.5654 head_norm=0.877884 delta_norm=0.291316
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.1648 head_norm=0.652784
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.569304e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.1404 head_norm=0.808362 delta_norm=0.456930
[S14] aggregate: ROLLBACK (f1_val pre=0.165 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S2] START round=9 head_norm_before_train=0.877884 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.601010 metrics={'f1_val': 0.6057736798371738, 'auprc': 0.7767765306708546, 'loss_val': 0.9550102912877163, 'psi': 0.6741748201706461}-{'f1_val': 0.417102078559347, 'auprc': 0.7775351875607951, 'loss_val': 1.0272759841272325, 'psi': 0.5612753221599263}
[S3] START round=9 head_norm_before_train=1.184440 cos_to_last_merge=0.9945 (last merge round=7)
[S3] round=9 local utility u=0.026386 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9992435716743439, 'loss_val': 0.3348725561802942, 'psi': 0.8201964696850239}-{'f1_val': 0.7004261945879899, 'auprc': 0.9950013904867769, 'loss_val': 0.3724854279951939, 'psi': 0.8182562729475047}
[S4] START round=9 head_norm_before_train=1.513115 (no previous merge yet)
[S4] round=9 local utility u=0.494162 metrics={'f1_val': 0.6868782303750637, 'auprc': 0.6601789390163245, 'loss_val': 0.4820160873554333, 'psi': 0.676198513831568}-{'f1_val': 0.5461777037914867, 'auprc': 0.6563022534323466, 'loss_val': 0.6145064873137581, 'psi': 0.5902275236478307}
[S5] START round=9 head_norm_before_train=1.269957 cos_to_last_merge=0.9967 (last merge round=7)
[S5] round=9 local utility u=0.143912 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.7768153912050557, 'loss_val': 0.37975221579635193, 'psi': 0.7310916128854907}-{'f1_val': 0.6833252547218338, 'auprc': 0.785588350115602, 'loss_val': 0.5901929536976568, 'psi': 0.724230492879341}
[S6] START round=9 head_norm_before_train=1.350929 (no previous merge yet)
[S6] round=9 local utility u=0.872712 metrics={'f1_val': 0.6208549930910316, 'auprc': 0.7951718886792938, 'loss_val': 0.6782517862122349, 'psi': 0.6905817513263366}-{'f1_val': 0.3864171493488354, 'auprc': 0.7360676816628884, 'loss_val': 0.8397367912212123, 'psi': 0.5262773622744567}
[S7] START round=9 head_norm_before_train=0.746051 cos_to_last_merge=0.9863 (last merge round=7)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.4989893477423638, 'auprc': 0.7870513805202191, 'loss_val': 0.8186935078395743, 'psi': 0.6142141608535059}-{'f1_val': 0.6216024775654927, 'auprc': 0.7874648948934004, 'loss_val': 0.8782647129794162, 'psi': 0.6879474444966558}
[S8] START round=9 head_norm_before_train=1.372674 (no previous merge yet)
[S8] round=9 local utility u=0.144163 metrics={'f1_val': 0.7144610111876308, 'auprc': 0.7944834047508162, 'loss_val': 0.5692481382772426, 'psi': 0.746469968612905}-{'f1_val': 0.7016547028006626, 'auprc': 0.7925831814569192, 'loss_val': 0.77503560175564, 'psi': 0.7380260942631652}
[S9] START round=9 head_norm_before_train=1.302099 cos_to_last_merge=0.8351 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.835
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.59462499705627, 'auprc': 0.8658566562584094, 'loss_val': 0.429195293803289, 'psi': 0.7031176607371258}-{'f1_val': 0.7013629453504064, 'auprc': 0.9988154153374753, 'loss_val': 0.28173392939247777, 'psi': 0.820343933345234}
[S10] START round=9 head_norm_before_train=1.207121 cos_to_last_merge=0.9975 (last merge round=7)
[S10] round=9 local utility u=0.114091 metrics={'f1_val': 0.3870198675496689, 'auprc': 0.9906820162467926, 'loss_val': 0.6825339432688843, 'psi': 0.6284847270285184}-{'f1_val': 0.38639886648742156, 'auprc': 0.9622945105475997, 'loss_val': 0.8218264320692945, 'psi': 0.6167571241114929}
[S11] START round=9 head_norm_before_train=1.002635 cos_to_last_merge=0.9098 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.910
[S11] round=9 local utility u=0.607924 metrics={'f1_val': 0.5975181202393554, 'auprc': 0.9419674227968703, 'loss_val': 0.6891668304359786, 'psi': 0.7352978412623614}-{'f1_val': 0.39655223592620625, 'auprc': 0.9826557967555842, 'loss_val': 0.8212851389002368, 'psi': 0.6309936602579574}
[S13] START round=9 head_norm_before_train=1.373421 (no previous merge yet)
[S13] round=9 local utility u=1.000000 metrics={'f1_val': 0.5888071890294779, 'auprc': 0.7746952054793214, 'loss_val': 0.7488290037953155, 'psi': 0.6631623956094153}-{'f1_val': 0.37169029467602305, 'auprc': 0.5678499814848638, 'loss_val': 0.9466530556802246, 'psi': 0.4501541693995593}
[S14] START round=9 head_norm_before_train=0.808362 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.787058 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.9266771625938316, 'loss_val': 1.0307736854929794, 'psi': 0.6085874076846873}-{'f1_val': 0.1647787034724902, 'auprc': 0.9121202448931436, 'loss_val': 1.1707266171288457, 'psi': 0.4637153200407516}
[S15] START round=9 head_norm_before_train=1.131096 cos_to_last_merge=0.9132 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.913
[S15] round=9 local utility u=0.223534 metrics={'f1_val': 0.4367212892822426, 'auprc': 0.9197106759678766, 'loss_val': 0.646444997375652, 'psi': 0.6299170439564962}-{'f1_val': 0.4304769893508231, 'auprc': 0.8210382183377687, 'loss_val': 0.7600298848793865, 'psi': 0.5867014809456014}
[S16] START round=9 head_norm_before_train=1.139449 cos_to_last_merge=0.9215 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.922
[S16] round=9 local utility u=0.210848 metrics={'f1_val': 0.4256651962394408, 'auprc': 0.7849811702394803, 'loss_val': 0.7629583288205688, 'psi': 0.5693915858394567}-{'f1_val': 0.364549442904167, 'auprc': 0.7882417475354281, 'loss_val': 0.8277422229188118, 'psi': 0.5340263647566714}
[S17] START round=9 head_norm_before_train=1.107599 cos_to_last_merge=0.9095 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.910
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.3543196388484247, 'auprc': 0.8396862417509448, 'loss_val': 0.8568834291315701, 'psi': 0.5484662800094328}-{'f1_val': 0.35725765849729063, 'auprc': 0.9295572443993417, 'loss_val': 0.8888935934392147, 'psi': 0.586177492858111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:54511
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S5] → sending delta(kind=head bytes=1787) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:54508
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[S15] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1787 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S3
[S14] cosine check vs S3: cos=0.1427
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.9299
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.3047
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] cosine check vs S6: cos=0.6159
[S5] RECEIVED delta(kind=head bytes=1792) from S10
[S5] cosine check vs S10: cos=-0.0977
[S5] DROPPED delta from S10 (cos=-0.0977 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1790) from S2
[S6] cosine check vs S2: cos=-0.0254
[S6] DROPPED delta from S2 (cos=-0.0254 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9515
[S14] RECEIVED delta(kind=head bytes=1805) from S4
[S14] cosine check vs S4: cos=0.1526
[S14] RECEIVED delta(kind=head bytes=1805) from S15
[S14] cosine check vs S15: cos=0.5089
[S14] RECEIVED delta(kind=head bytes=1801) from S16
[S14] cosine check vs S16: cos=0.9164
[S5] RECEIVED delta(kind=head bytes=1793) from S8
[S5] cosine check vs S8: cos=0.9258
[S3] RECEIVED delta(kind=head bytes=1787) from S5
[S3] cosine check vs S5: cos=0.8333
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4990 head_norm=0.814626
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.364866e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.5635 head_norm=0.752198 delta_norm=0.336487
[S7] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.7008 head_norm=1.260672
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.754786e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.7008 head_norm=1.240440 delta_norm=0.375479
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.6058 head_norm=0.919048
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.977590e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.6331 head_norm=0.972034 delta_norm=0.197759
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.7006 head_norm=1.330434
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.667189e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.7006 head_norm=1.344499 delta_norm=0.266719
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.3870 head_norm=1.249080
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.191778e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.3864 head_norm=1.308275 delta_norm=0.219178
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3965 head_norm=0.837970
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.410778e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.3965 head_norm=0.737082 delta_norm=0.241078
[S14] aggregate: ACCEPT kept=['S3', 'S4', 'S15', 'S16'] (k=4/4) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.972034 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.301143 metrics={'f1_val': 0.7015165128175402, 'auprc': 0.7442809662605404, 'loss_val': 0.8296949462451283, 'psi': 0.7186222941947402}-{'f1_val': 0.6057736798371738, 'auprc': 0.7767765306708546, 'loss_val': 0.9550102912877163, 'psi': 0.6741748201706461}
[S3] START round=10 head_norm_before_train=1.240440 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.000957 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9982752885719727, 'loss_val': 0.32960003623098355, 'psi': 0.8197638376699689}-{'f1_val': 0.7008317350254774, 'auprc': 0.9992435716743439, 'loss_val': 0.3348725561802942, 'psi': 0.8201964696850239}
[S4] START round=10 head_norm_before_train=1.564916 (no previous merge yet)
[S4] round=10 local utility u=0.163853 metrics={'f1_val': 0.6664182749388391, 'auprc': 0.8012784645127122, 'loss_val': 0.4548490201954493, 'psi': 0.7203623507683884}-{'f1_val': 0.6868782303750637, 'auprc': 0.6601789390163245, 'loss_val': 0.4820160873554333, 'psi': 0.676198513831568}
[S5] START round=10 head_norm_before_train=1.344499 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.249593 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.9461700858269099, 'loss_val': 0.3888978545654861, 'psi': 0.7988602250582195}-{'f1_val': 0.7006090940057808, 'auprc': 0.7768153912050557, 'loss_val': 0.37975221579635193, 'psi': 0.7310916128854907}
[S6] START round=10 head_norm_before_train=1.389542 (no previous merge yet)
[S6] round=10 local utility u=0.002734 metrics={'f1_val': 0.6109949707628692, 'auprc': 0.792969347515699, 'loss_val': 0.6070154408749183, 'psi': 0.6837847214640012}-{'f1_val': 0.6208549930910316, 'auprc': 0.7951718886792938, 'loss_val': 0.6782517862122349, 'psi': 0.6905817513263366}
[S7] START round=10 head_norm_before_train=0.752198 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.431482 metrics={'f1_val': 0.6203317016772739, 'auprc': 0.8170770981180612, 'loss_val': 0.7738607620617778, 'psi': 0.6990298602535888}-{'f1_val': 0.4989893477423638, 'auprc': 0.7870513805202191, 'loss_val': 0.8186935078395743, 'psi': 0.6142141608535059}
[S8] START round=10 head_norm_before_train=1.409815 (no previous merge yet)
[S8] round=10 local utility u=0.069174 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.794503573641151, 'loss_val': 0.4296300821732355, 'psi': 0.7463448926951579}-{'f1_val': 0.7144610111876308, 'auprc': 0.7944834047508162, 'loss_val': 0.5692481382772426, 'psi': 0.746469968612905}
[S9] START round=10 head_norm_before_train=1.352702 cos_to_last_merge=0.8243 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.824
[S9] round=10 local utility u=0.609328 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9988282946056558, 'loss_val': 0.24944703590323258, 'psi': 0.8203056079668004}-{'f1_val': 0.59462499705627, 'auprc': 0.8658566562584094, 'loss_val': 0.429195293803289, 'psi': 0.7031176607371258}
[S10] START round=10 head_norm_before_train=1.308275 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.601038 metrics={'f1_val': 0.5699355457925391, 'auprc': 0.9927306970272567, 'loss_val': 0.5840982398274072, 'psi': 0.7390536062864261}-{'f1_val': 0.3870198675496689, 'auprc': 0.9906820162467926, 'loss_val': 0.6825339432688843, 'psi': 0.6284847270285184}
[S11] START round=10 head_norm_before_train=1.059843 cos_to_last_merge=0.8890 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.889
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.5655921686747837, 'auprc': 0.94180406724184, 'loss_val': 0.5699871391740641, 'psi': 0.7160769281016062}-{'f1_val': 0.5975181202393554, 'auprc': 0.9419674227968703, 'loss_val': 0.6891668304359786, 'psi': 0.7352978412623614}
[S13] START round=10 head_norm_before_train=1.399659 (no previous merge yet)
[S13] round=10 local utility u=0.248050 metrics={'f1_val': 0.6629975895226058, 'auprc': 0.7825400163270281, 'loss_val': 0.7214052110895063, 'psi': 0.7108145602443747}-{'f1_val': 0.5888071890294779, 'auprc': 0.7746952054793214, 'loss_val': 0.7488290037953155, 'psi': 0.6631623956094153}
[S14] START round=10 head_norm_before_train=0.737082 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.105450 metrics={'f1_val': 0.3960888112971124, 'auprc': 0.9577842529804521, 'loss_val': 0.9105629614433276, 'psi': 0.6207669879704483}-{'f1_val': 0.39652757107859105, 'auprc': 0.9266771625938316, 'loss_val': 1.0307736854929794, 'psi': 0.6085874076846873}
[S15] START round=10 head_norm_before_train=1.191021 cos_to_last_merge=0.8948 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.895
[S15] round=10 local utility u=0.216014 metrics={'f1_val': 0.6146147268734653, 'auprc': 0.6956734233611057, 'loss_val': 0.6096655754818172, 'psi': 0.6470382054685215}-{'f1_val': 0.4367212892822426, 'auprc': 0.9197106759678766, 'loss_val': 0.646444997375652, 'psi': 0.6299170439564962}
[S16] START round=10 head_norm_before_train=1.182446 cos_to_last_merge=0.9046 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.905
[S16] round=10 local utility u=0.532972 metrics={'f1_val': 0.581074649999783, 'auprc': 0.8132178339907719, 'loss_val': 0.7141800873118093, 'psi': 0.6739319235961785}-{'f1_val': 0.4256651962394408, 'auprc': 0.7849811702394803, 'loss_val': 0.7629583288205688, 'psi': 0.5693915858394567}
[S17] START round=10 head_norm_before_train=1.157474 cos_to_last_merge=0.8898 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.890
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.35332502165965807, 'auprc': 0.8222655227017567, 'loss_val': 0.8788249458382064, 'psi': 0.5409012220764975}-{'f1_val': 0.3543196388484247, 'auprc': 0.8396862417509448, 'loss_val': 0.8568834291315701, 'psi': 0.5484662800094328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S3@127.0.0.1:54503
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[S4] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.4739
[S13] RECEIVED delta(kind=head bytes=1796) from S7
[S13] cosine check vs S7: cos=-0.0635
[S13] DROPPED delta from S7 (cos=-0.0635 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=-0.1067
[S5] DROPPED delta from S10 (cos=-0.1067 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S8
[S5] cosine check vs S8: cos=0.9684
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=-0.0114
[S6] DROPPED delta from S2 (cos=-0.0114 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S13
[S10] cosine check vs S13: cos=0.9790
[S14] RECEIVED delta(kind=head bytes=1799) from S16
[S14] cosine check vs S16: cos=0.7809
[S3] RECEIVED delta(kind=head bytes=1789) from S5
[S3] cosine check vs S5: cos=0.9091
[S14] RECEIVED delta(kind=head bytes=1805) from S4
[S14] cosine check vs S4: cos=0.2792
[S14] RECEIVED delta(kind=head bytes=1801) from S3
[S14] cosine check vs S3: cos=0.2712
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] cosine check vs S6: cos=0.7850
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=0.6281
[S7] RECEIVED delta(kind=head bytes=1795) from S9
[S7] cosine check vs S9: cos=0.3616
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.347 → S2@127.0.0.1:54502
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7007 head_norm=1.393069
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.810300e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7006 head_norm=1.411112 delta_norm=0.181030
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.295 → S3@127.0.0.1:54503
[S4] ⇄ pheromone p=0.365 → S14@127.0.0.1:54514
[S16] ⇄ pheromone p=0.322 → S14@127.0.0.1:54514
[S6] ⇄ pheromone p=0.360 → S7@127.0.0.1:54508
[S14] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.3961 head_norm=0.780633
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.570375e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.3957 head_norm=0.742403 delta_norm=0.157037
[S14] aggregate: ACCEPT kept=['S16', 'S4', 'S3', 'S15'] (k=4/4) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.364 → S7@127.0.0.1:54508
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.6203 head_norm=0.814795
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.989914e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.6590 head_norm=0.733348 delta_norm=0.198991
[S7] aggregate: ACCEPT kept=['S14', 'S6', 'S9'] (k=3/3) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.339 → S13@127.0.0.1:54513
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.7008 head_norm=1.303938
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.907051e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.7008 head_norm=1.317550 delta_norm=0.290705
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.295 → S14@127.0.0.1:54514
[S15] ⇄ pheromone p=0.304 → S14@127.0.0.1:54514
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.5699 head_norm=1.347992
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.475542e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.5748 head_norm=1.380331 delta_norm=0.147554
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.396 → S5@127.0.0.1:54505
[S9] ⇄ pheromone p=0.312 → S7@127.0.0.1:54508
[S8] ⇄ pheromone p=0.308 → S5@127.0.0.1:54505
[S2] ⇄ pheromone p=0.417 → S6@127.0.0.1:54507
[S13] ⇄ pheromone p=0.392 → S10@127.0.0.1:54511
[S17] ⇄ pheromone p=0.251 → S8@127.0.0.1:54509
[S2] START round=11 head_norm_before_train=1.017322 cos_to_last_merge=0.9955 (last merge round=9)
[S2] round=11 local utility u=0.128530 metrics={'f1_val': 0.701441511764984, 'auprc': 0.7778754996705788, 'loss_val': 0.6729678989726995, 'psi': 0.732015106927222}-{'f1_val': 0.7015165128175402, 'auprc': 0.7442809662605404, 'loss_val': 0.8296949462451283, 'psi': 0.7186222941947402}
[S3] START round=11 head_norm_before_train=1.317550 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9986820148831653, 'loss_val': 0.336374762725907, 'psi': 0.8199718469685526}-{'f1_val': 0.7007562037352997, 'auprc': 0.9982752885719727, 'loss_val': 0.32960003623098355, 'psi': 0.8197638376699689}
[S4] START round=11 head_norm_before_train=1.610920 (no previous merge yet)
[S4] round=11 local utility u=0.144060 metrics={'f1_val': 0.6641295821802309, 'auprc': 0.8921550556268714, 'loss_val': 0.42562729367564733, 'psi': 0.7553397715588871}-{'f1_val': 0.6664182749388391, 'auprc': 0.8012784645127122, 'loss_val': 0.4548490201954493, 'psi': 0.7203623507683884}
[S5] START round=11 head_norm_before_train=1.411112 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.6245372458030183, 'auprc': 0.8516001990378724, 'loss_val': 0.48249505761155637, 'psi': 0.7153624270969599}-{'f1_val': 0.7006536512124258, 'auprc': 0.9461700858269099, 'loss_val': 0.3888978545654861, 'psi': 0.7988602250582195}
[S6] START round=11 head_norm_before_train=1.430757 (no previous merge yet)
[S6] round=11 local utility u=0.346800 metrics={'f1_val': 0.7007336801687921, 'auprc': 0.79329228031927, 'loss_val': 0.4528161085354188, 'psi': 0.7377571202289832}-{'f1_val': 0.6109949707628692, 'auprc': 0.792969347515699, 'loss_val': 0.6070154408749183, 'psi': 0.6837847214640012}
[S7] START round=11 head_norm_before_train=0.733348 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.5994804261157274, 'auprc': 0.7816146803772674, 'loss_val': 0.768521860343139, 'psi': 0.6723341278203434}-{'f1_val': 0.6203317016772739, 'auprc': 0.8170770981180612, 'loss_val': 0.7738607620617778, 'psi': 0.6990298602535888}
[S8] START round=11 head_norm_before_train=1.451681 (no previous merge yet)
[S8] round=11 local utility u=0.324917 metrics={'f1_val': 0.7011681352769201, 'auprc': 0.99724745725486, 'loss_val': 0.30960220798145816, 'psi': 0.8195998640680962}-{'f1_val': 0.7142391053978291, 'auprc': 0.794503573641151, 'loss_val': 0.4296300821732355, 'psi': 0.7463448926951579}
[S9] START round=11 head_norm_before_train=1.388077 cos_to_last_merge=0.8167 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.817
[S9] round=11 local utility u=0.016044 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9988444632049641, 'loss_val': 0.21740679484856945, 'psi': 0.8203120754065237}-{'f1_val': 0.7012904835408967, 'auprc': 0.9988282946056558, 'loss_val': 0.24944703590323258, 'psi': 0.8203056079668004}
[S10] START round=11 head_norm_before_train=1.380331 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.445358 metrics={'f1_val': 0.7001224412791066, 'auprc': 0.9882772211151203, 'loss_val': 0.46114359954076667, 'psi': 0.8153843532135121}-{'f1_val': 0.5699355457925391, 'auprc': 0.9927306970272567, 'loss_val': 0.5840982398274072, 'psi': 0.7390536062864261}
[S11] START round=11 head_norm_before_train=1.120438 cos_to_last_merge=0.8693 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.869
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.577325276258146, 'auprc': 0.83300529201657, 'loss_val': 0.7313730905517315, 'psi': 0.6795972825615156}-{'f1_val': 0.5655921686747837, 'auprc': 0.94180406724184, 'loss_val': 0.5699871391740641, 'psi': 0.7160769281016062}
[S13] START round=11 head_norm_before_train=1.427265 (no previous merge yet)
[S13] round=11 local utility u=0.091834 metrics={'f1_val': 0.68877170567594, 'auprc': 0.7825714619014692, 'loss_val': 0.6924758136583319, 'psi': 0.7262916081661517}-{'f1_val': 0.6629975895226058, 'auprc': 0.7825400163270281, 'loss_val': 0.7214052110895063, 'psi': 0.7108145602443747}
[S14] START round=11 head_norm_before_train=0.742403 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.114108 metrics={'f1_val': 0.3963571201827263, 'auprc': 0.9967800436094706, 'loss_val': 0.8009435337983866, 'psi': 0.636526289553424}-{'f1_val': 0.3960888112971124, 'auprc': 0.9577842529804521, 'loss_val': 0.9105629614433276, 'psi': 0.6207669879704483}
[S15] START round=11 head_norm_before_train=1.248540 cos_to_last_merge=0.8782 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.878
[S15] round=11 local utility u=0.706038 metrics={'f1_val': 0.6926271321936163, 'auprc': 0.9501610508436537, 'loss_val': 0.42912676654146237, 'psi': 0.7956406996536312}-{'f1_val': 0.6146147268734653, 'auprc': 0.6956734233611057, 'loss_val': 0.6096655754818172, 'psi': 0.6470382054685215}
[S16] START round=11 head_norm_before_train=1.225486 cos_to_last_merge=0.8900 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.890
[S16] round=11 local utility u=0.131377 metrics={'f1_val': 0.542600623911102, 'auprc': 0.9247811129235854, 'loss_val': 0.5552712831921192, 'psi': 0.6954728195160954}-{'f1_val': 0.581074649999783, 'auprc': 0.8132178339907719, 'loss_val': 0.7141800873118093, 'psi': 0.6739319235961785}
[S17] START round=11 head_norm_before_train=1.199631 cos_to_last_merge=0.8730 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.873
[S17] round=11 local utility u=0.038613 metrics={'f1_val': 0.3544440508351692, 'auprc': 0.8543242713347069, 'loss_val': 0.9044886830656295, 'psi': 0.5543961390349843}-{'f1_val': 0.35332502165965807, 'auprc': 0.8222655227017567, 'loss_val': 0.8788249458382064, 'psi': 0.5409012220764975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:54511
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:54507
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:54505
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S9
[S7] cosine check vs S9: cos=0.4965
[S7] RECEIVED delta(kind=head bytes=1796) from S6
[S7] cosine check vs S6: cos=0.7135
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=-0.1114
[S5] DROPPED delta from S10 (cos=-0.1114 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1792) from S13
[S10] cosine check vs S13: cos=0.9884
[S6] RECEIVED delta(kind=head bytes=1795) from S2
[S6] cosine check vs S2: cos=-0.0105
[S6] DROPPED delta from S2 (cos=-0.0105 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S4
[S14] cosine check vs S4: cos=0.3325
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] cosine check vs S16: cos=0.6804
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=0.6831
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.5258
[S5] RECEIVED delta(kind=head bytes=1805) from S8
[S5] cosine check vs S8: cos=0.9817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=-0.0906
[S8] DROPPED delta from S17 (cos=-0.0906 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.6245 head_norm=1.456976
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.424403e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.6618 head_norm=1.469368 delta_norm=0.142440
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.5995 head_norm=0.812315
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.596888e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.6113 head_norm=0.750992 delta_norm=0.159689
[S7] aggregate: ACCEPT kept=['S9', 'S6', 'S14'] (k=3/3) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.7001 head_norm=1.424097
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.106733e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.7003 head_norm=1.434695 delta_norm=0.110673
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.3964 head_norm=0.791358
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.988031e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.3964 head_norm=0.821846 delta_norm=0.198803
[S14] aggregate: ACCEPT kept=['S4', 'S16', 'S15'] (k=3/3) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.077520 cos_to_last_merge=0.9842 (last merge round=9)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.700672522881944, 'auprc': 0.7326485328646213, 'loss_val': 0.5380500915760672, 'psi': 0.713462926875015}-{'f1_val': 0.701441511764984, 'auprc': 0.7778754996705788, 'loss_val': 0.6729678989726995, 'psi': 0.732015106927222}
[S3] START round=12 head_norm_before_train=1.374978 cos_to_last_merge=0.9977 (last merge round=10)
[S3] round=12 local utility u=0.017072 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9988201712694563, 'loss_val': 0.3021928698794725, 'psi': 0.8199817907489624}-{'f1_val': 0.7008317350254774, 'auprc': 0.9986820148831653, 'loss_val': 0.336374762725907, 'psi': 0.8199718469685526}
[S4] START round=12 head_norm_before_train=1.648114 (no previous merge yet)
[S4] round=12 local utility u=0.923879 metrics={'f1_val': 0.9496812987688255, 'auprc': 0.9474563580881169, 'loss_val': 0.4570833845947736, 'psi': 0.9487913224965421}-{'f1_val': 0.6641295821802309, 'auprc': 0.8921550556268714, 'loss_val': 0.42562729367564733, 'psi': 0.7553397715588871}
[S5] START round=12 head_norm_before_train=1.469368 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.299001 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.8580571914245745, 'loss_val': 0.36029519768713575, 'psi': 0.7635883329732982}-{'f1_val': 0.6245372458030183, 'auprc': 0.8516001990378724, 'loss_val': 0.48249505761155637, 'psi': 0.7153624270969599}
[S6] START round=12 head_norm_before_train=1.468888 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6209367628278805, 'auprc': 0.7913280747265028, 'loss_val': 0.5495963485730876, 'psi': 0.6890932875873295}-{'f1_val': 0.7007336801687921, 'auprc': 0.79329228031927, 'loss_val': 0.4528161085354188, 'psi': 0.7377571202289832}
[S7] START round=12 head_norm_before_train=0.750992 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.114459 metrics={'f1_val': 0.6254156644058035, 'auprc': 0.7779880524870635, 'loss_val': 0.6843359692003778, 'psi': 0.6864446196383076}-{'f1_val': 0.5994804261157274, 'auprc': 0.7816146803772674, 'loss_val': 0.768521860343139, 'psi': 0.6723341278203434}
[S8] START round=12 head_norm_before_train=1.495287 (no previous merge yet)
[S8] round=12 local utility u=0.027891 metrics={'f1_val': 0.7014150776626948, 'auprc': 0.9976088749626595, 'loss_val': 0.2563852724823219, 'psi': 0.8198925965826807}-{'f1_val': 0.7011681352769201, 'auprc': 0.99724745725486, 'loss_val': 0.30960220798145816, 'psi': 0.8195998640680962}
[S9] START round=12 head_norm_before_train=1.418181 cos_to_last_merge=0.8106 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.811
[S9] round=12 local utility u=0.018310 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9988501555615963, 'loss_val': 0.18080385107611693, 'psi': 0.8203143523491766}-{'f1_val': 0.7012904835408967, 'auprc': 0.9988444632049641, 'loss_val': 0.21740679484856945, 'psi': 0.8203120754065237}
[S10] START round=12 head_norm_before_train=1.434695 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.045856 metrics={'f1_val': 0.6979174453657955, 'auprc': 0.9917148210150477, 'loss_val': 0.3665146098873204, 'psi': 0.8154363956254964}-{'f1_val': 0.7001224412791066, 'auprc': 0.9882772211151203, 'loss_val': 0.46114359954076667, 'psi': 0.8153843532135121}
[S11] START round=12 head_norm_before_train=1.175872 cos_to_last_merge=0.8527 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.853
[S11] round=12 local utility u=0.576490 metrics={'f1_val': 0.6406632088185107, 'auprc': 0.9948893410243794, 'loss_val': 0.4440725899499459, 'psi': 0.7823536617008582}-{'f1_val': 0.577325276258146, 'auprc': 0.83300529201657, 'loss_val': 0.7313730905517315, 'psi': 0.6795972825615156}
[S13] START round=12 head_norm_before_train=1.453666 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6748008323438046, 'auprc': 0.7802124951958693, 'loss_val': 0.688245869162154, 'psi': 0.7169654974846305}-{'f1_val': 0.68877170567594, 'auprc': 0.7825714619014692, 'loss_val': 0.6924758136583319, 'psi': 0.7262916081661517}
[S14] START round=12 head_norm_before_train=0.821846 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.040964 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9969254026058632, 'loss_val': 0.7206727935234936, 'psi': 0.6367064824285403}-{'f1_val': 0.3963571201827263, 'auprc': 0.9967800436094706, 'loss_val': 0.8009435337983866, 'psi': 0.636526289553424}
[S15] START round=12 head_norm_before_train=1.306572 cos_to_last_merge=0.8641 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.864
[S15] round=12 local utility u=0.068762 metrics={'f1_val': 0.6881962807230483, 'auprc': 0.984147647368806, 'loss_val': 0.36697714325557196, 'psi': 0.8065768273813514}-{'f1_val': 0.6926271321936163, 'auprc': 0.9501610508436537, 'loss_val': 0.42912676654146237, 'psi': 0.7956406996536312}
[S16] START round=12 head_norm_before_train=1.268135 cos_to_last_merge=0.8777 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.878
[S16] round=12 local utility u=0.169727 metrics={'f1_val': 0.5632220184214775, 'auprc': 0.9635056939457081, 'loss_val': 0.4557201280975566, 'psi': 0.7233354886311698}-{'f1_val': 0.542600623911102, 'auprc': 0.9247811129235854, 'loss_val': 0.5552712831921192, 'psi': 0.6954728195160954}
[S17] START round=12 head_norm_before_train=1.232420 cos_to_last_merge=0.8591 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.859
[S17] round=12 local utility u=0.050674 metrics={'f1_val': 0.36699466348272897, 'auprc': 0.8671097376993266, 'loss_val': 0.9168017468344216, 'psi': 0.5670406931693681}-{'f1_val': 0.3544440508351692, 'auprc': 0.8543242713347069, 'loss_val': 0.9044886830656295, 'psi': 0.5543961390349843}
[S10] not sending this round → trigger blocked (psi=0.815)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:54503
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.723)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:54514
[S8] not sending this round → trigger blocked (psi=0.820)
[S14] not sending this round → trigger blocked (psi=0.637)
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:54513
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.807)
[S4] not sending this round → trigger blocked (psi=0.949)
[S7] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S7
[S13] cosine check vs S7: cos=-0.0964
[S13] DROPPED delta from S7 (cos=-0.0964 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] cosine check vs S5: cos=0.9320
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=0.9127
[S14] RECEIVED delta(kind=head bytes=1796) from S3
[S14] cosine check vs S3: cos=0.1932
[S17] not sending this round → trigger blocked (psi=0.567)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.3966 head_norm=0.864579
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.605791e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.3966 head_norm=0.904061 delta_norm=0.760579
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7007 head_norm=1.140965
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.492565e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.6940 head_norm=1.153321 delta_norm=0.249256
[S2] aggregate: ROLLBACK (f1_val pre=0.701 post=0.694 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.7008 head_norm=1.429726
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.754237e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.7008 head_norm=1.449516 delta_norm=0.275424
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.153321 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.086444 metrics={'f1_val': 0.7119505099251144, 'auprc': 0.7781195695068627, 'loss_val': 0.5692439985801404, 'psi': 0.7384181337578137}-{'f1_val': 0.700672522881944, 'auprc': 0.7326485328646213, 'loss_val': 0.5380500915760672, 'psi': 0.713462926875015}
[S3] START round=13 head_norm_before_train=1.449516 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9994181591553021, 'loss_val': 0.3227630388362016, 'psi': 0.8201161012573739}-{'f1_val': 0.7007562037352997, 'auprc': 0.9988201712694563, 'loss_val': 0.3021928698794725, 'psi': 0.8199817907489624}
[S4] START round=13 head_norm_before_train=1.681485 (no previous merge yet)
[S4] round=13 local utility u=0.028517 metrics={'f1_val': 0.9502115245867159, 'auprc': 0.9557840474409135, 'loss_val': 0.4282132887969837, 'psi': 0.9524405337283949}-{'f1_val': 0.9496812987688255, 'auprc': 0.9474563580881169, 'loss_val': 0.4570833845947736, 'psi': 0.9487913224965421}
[S5] START round=13 head_norm_before_train=1.519801 cos_to_last_merge=0.9973 (last merge round=11)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.5846405815791491, 'auprc': 0.8472638583786375, 'loss_val': 0.5367284665516087, 'psi': 0.6896898922989445}-{'f1_val': 0.7006090940057808, 'auprc': 0.8580571914245745, 'loss_val': 0.36029519768713575, 'psi': 0.7635883329732982}
[S6] START round=13 head_norm_before_train=1.504609 (no previous merge yet)
[S6] round=13 local utility u=0.310621 metrics={'f1_val': 0.709003570711765, 'auprc': 0.789727921586461, 'loss_val': 0.45195407842567675, 'psi': 0.7412933110616434}-{'f1_val': 0.6209367628278805, 'auprc': 0.7913280747265028, 'loss_val': 0.5495963485730876, 'psi': 0.6890932875873295}
[S7] START round=13 head_norm_before_train=0.823999 cos_to_last_merge=0.9910 (last merge round=11)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.5628127618646783, 'auprc': 0.70641768180903, 'loss_val': 0.7578355293006949, 'psi': 0.620254729842419}-{'f1_val': 0.6254156644058035, 'auprc': 0.7779880524870635, 'loss_val': 0.6843359692003778, 'psi': 0.6864446196383076}
[S8] START round=13 head_norm_before_train=1.533477 (no previous merge yet)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.7012407622490027, 'auprc': 0.973916175513938, 'loss_val': 0.26281555027288667, 'psi': 0.8103109275549768}-{'f1_val': 0.7014150776626948, 'auprc': 0.9976088749626595, 'loss_val': 0.2563852724823219, 'psi': 0.8198925965826807}
[S9] START round=13 head_norm_before_train=1.450506 cos_to_last_merge=0.8050 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.805
[S9] round=13 local utility u=0.920443 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9990012774166106, 'loss_val': 0.11771198783123141, 'psi': 0.9981088014206908}-{'f1_val': 0.7012904835408967, 'auprc': 0.9988501555615963, 'loss_val': 0.18080385107611693, 'psi': 0.8203143523491766}
[S10] START round=13 head_norm_before_train=1.482989 cos_to_last_merge=0.9986 (last merge round=11)
[S10] round=13 local utility u=0.052712 metrics={'f1_val': 0.6984413351386141, 'auprc': 0.9962062580025501, 'loss_val': 0.2777075551219888, 'psi': 0.8175473042841885}-{'f1_val': 0.6979174453657955, 'auprc': 0.9917148210150477, 'loss_val': 0.3665146098873204, 'psi': 0.8154363956254964}
[S11] START round=13 head_norm_before_train=1.217685 cos_to_last_merge=0.8405 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.841
[S11] round=13 local utility u=0.224072 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9965554643111435, 'loss_val': 0.36855999101966563, 'psi': 0.8197833757034494}-{'f1_val': 0.6406632088185107, 'auprc': 0.9948893410243794, 'loss_val': 0.4440725899499459, 'psi': 0.7823536617008582}
[S13] START round=13 head_norm_before_train=1.479355 (no previous merge yet)
[S13] round=13 local utility u=0.088005 metrics={'f1_val': 0.7120701569568044, 'auprc': 0.7632560878455309, 'loss_val': 0.6849830743704205, 'psi': 0.732544529312295}-{'f1_val': 0.6748008323438046, 'auprc': 0.7802124951958693, 'loss_val': 0.688245869162154, 'psi': 0.7169654974846305}
[S14] START round=13 head_norm_before_train=0.904061 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.006927 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9971067134919267, 'loss_val': 0.7073619343192714, 'psi': 0.6367790067829657}-{'f1_val': 0.39656053564365834, 'auprc': 0.9969254026058632, 'loss_val': 0.7206727935234936, 'psi': 0.6367064824285403}
[S15] START round=13 head_norm_before_train=1.358449 cos_to_last_merge=0.8533 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.853
[S15] round=13 local utility u=0.017489 metrics={'f1_val': 0.6897692393087553, 'auprc': 0.9846832053200163, 'loss_val': 0.3430436472020139, 'psi': 0.8077348257132597}-{'f1_val': 0.6881962807230483, 'auprc': 0.984147647368806, 'loss_val': 0.36697714325557196, 'psi': 0.8065768273813514}
[S16] START round=13 head_norm_before_train=1.315257 cos_to_last_merge=0.8663 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.866
[S16] round=13 local utility u=0.720861 metrics={'f1_val': 0.8455897765169886, 'auprc': 0.9365548064512456, 'loss_val': 0.6273524024767301, 'psi': 0.8819757884906914}-{'f1_val': 0.5632220184214775, 'auprc': 0.9635056939457081, 'loss_val': 0.4557201280975566, 'psi': 0.7233354886311698}
[S17] START round=13 head_norm_before_train=1.256746 cos_to_last_merge=0.8485 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.849
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.3518829443654007, 'auprc': 0.8769627720939611, 'loss_val': 0.9420887720251934, 'psi': 0.5619148754568248}-{'f1_val': 0.36699466348272897, 'auprc': 0.8671097376993266, 'loss_val': 0.9168017468344216, 'psi': 0.5670406931693681}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:54508
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:54502
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:54514
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:54508
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:54511
[S13] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] cosine check vs S11: cos=0.9648
[S5] RECEIVED delta(kind=head bytes=1795) from S10
[S5] cosine check vs S10: cos=-0.1131
[S5] DROPPED delta from S10 (cos=-0.1131 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] cosine check vs S2: cos=-0.0040
[S6] DROPPED delta from S2 (cos=-0.0040 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=0.9856
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=0.4481
[S14] RECEIVED delta(kind=head bytes=1805) from S4
[S14] cosine check vs S4: cos=0.1252
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=0.3199
[S7] RECEIVED delta(kind=head bytes=1797) from S9
[S7] cosine check vs S9: cos=0.5435
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] cosine check vs S6: cos=0.6514
[S7] RECEIVED delta(kind=head bytes=1794) from S14
[S7] cosine check vs S14: cos=0.3773
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.5628 head_norm=0.887365
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.180435e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.5695 head_norm=0.802448 delta_norm=0.218044
[S7] aggregate: ACCEPT kept=['S9', 'S6', 'S14'] (k=3/3) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.6984 head_norm=1.529550
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.294760e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.6984 head_norm=1.508399 delta_norm=0.129476
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.3966 head_norm=0.938104
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.760454e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.3966 head_norm=0.812997 delta_norm=0.476045
[S14] aggregate: ACCEPT kept=['S15', 'S4', 'S16'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.7120 head_norm=1.209291
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.649927e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.7082 head_norm=1.221359 delta_norm=0.164993
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.221359 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.017281 metrics={'f1_val': 0.7018626208173713, 'auprc': 0.7830634421219818, 'loss_val': 0.4889870058459132, 'psi': 0.7343429493392155}-{'f1_val': 0.7119505099251144, 'auprc': 0.7781195695068627, 'loss_val': 0.5692439985801404, 'psi': 0.7384181337578137}
[S3] START round=14 head_norm_before_train=1.497479 cos_to_last_merge=0.9988 (last merge round=12)
[S3] round=14 local utility u=0.011328 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9993349587991539, 'loss_val': 0.29985786070175036, 'psi': 0.8200828211149146}-{'f1_val': 0.7005813959920884, 'auprc': 0.9994181591553021, 'loss_val': 0.3227630388362016, 'psi': 0.8201161012573739}
[S4] START round=14 head_norm_before_train=1.707605 (no previous merge yet)
[S4] round=14 local utility u=0.038964 metrics={'f1_val': 0.953134159758266, 'auprc': 0.9569991555184135, 'loss_val': 0.37146666930909295, 'psi': 0.954680158062325}-{'f1_val': 0.9502115245867159, 'auprc': 0.9557840474409135, 'loss_val': 0.4282132887969837, 'psi': 0.9524405337283949}
[S5] START round=14 head_norm_before_train=1.558872 cos_to_last_merge=0.9932 (last merge round=11)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.45035181143852415, 'auprc': 0.8542479237892683, 'loss_val': 0.689709172575933, 'psi': 0.6119102563788218}-{'f1_val': 0.5846405815791491, 'auprc': 0.8472638583786375, 'loss_val': 0.5367284665516087, 'psi': 0.6896898922989445}
[S6] START round=14 head_norm_before_train=1.531452 (no previous merge yet)
[S6] round=14 local utility u=0.315465 metrics={'f1_val': 0.7092551443190896, 'auprc': 0.9631433919663852, 'loss_val': 0.34277952431714387, 'psi': 0.8108104433780079}-{'f1_val': 0.709003570711765, 'auprc': 0.789727921586461, 'loss_val': 0.45195407842567675, 'psi': 0.7412933110616434}
[S7] START round=14 head_norm_before_train=0.802448 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.392078 metrics={'f1_val': 0.6228407137194746, 'auprc': 0.8191862920026141, 'loss_val': 0.6721537415148574, 'psi': 0.7013789450327303}-{'f1_val': 0.5628127618646783, 'auprc': 0.70641768180903, 'loss_val': 0.7578355293006949, 'psi': 0.620254729842419}
[S8] START round=14 head_norm_before_train=1.564225 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.9110760738913761, 'loss_val': 0.3452354372280479, 'psi': 0.7928406583408192}-{'f1_val': 0.7012407622490027, 'auprc': 0.973916175513938, 'loss_val': 0.26281555027288667, 'psi': 0.8103109275549768}
[S9] START round=14 head_norm_before_train=1.486700 cos_to_last_merge=0.8011 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.801
[S9] round=14 local utility u=0.015933 metrics={'f1_val': 0.9975426610709598, 'auprc': 0.9991830204965169, 'loss_val': 0.08656522834995369, 'psi': 0.9981988048411826}-{'f1_val': 0.9975138174234109, 'auprc': 0.9990012774166106, 'loss_val': 0.11771198783123141, 'psi': 0.9981088014206908}
[S10] START round=14 head_norm_before_train=1.508399 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.679703 metrics={'f1_val': 0.9336540064316314, 'auprc': 0.989419211531864, 'loss_val': 0.30921548875749827, 'psi': 0.9559600884717244}-{'f1_val': 0.6984413351386141, 'auprc': 0.9962062580025501, 'loss_val': 0.2777075551219888, 'psi': 0.8175473042841885}
[S11] START round=14 head_norm_before_train=1.255188 cos_to_last_merge=0.8305 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.830
[S11] round=14 local utility u=0.023293 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9963464140048585, 'loss_val': 0.3198965737965632, 'psi': 0.8195546533540983}-{'f1_val': 0.7019353166316534, 'auprc': 0.9965554643111435, 'loss_val': 0.36855999101966563, 'psi': 0.8197833757034494}
[S13] START round=14 head_norm_before_train=1.498178 (no previous merge yet)
[S13] round=14 local utility u=0.021538 metrics={'f1_val': 0.7116411800817113, 'auprc': 0.7466986548859135, 'loss_val': 0.589661543996044, 'psi': 0.7256641700033921}-{'f1_val': 0.7120701569568044, 'auprc': 0.7632560878455309, 'loss_val': 0.6849830743704205, 'psi': 0.732544529312295}
[S14] START round=14 head_norm_before_train=0.812997 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.029427 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9970672551069097, 'loss_val': 0.6483889447428549, 'psi': 0.636763223428959}-{'f1_val': 0.39656053564365834, 'auprc': 0.9971067134919267, 'loss_val': 0.7073619343192714, 'psi': 0.6367790067829657}
[S15] START round=14 head_norm_before_train=1.404029 cos_to_last_merge=0.8447 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.845
[S15] round=14 local utility u=0.081773 metrics={'f1_val': 0.6978148486698506, 'auprc': 0.9877852525222317, 'loss_val': 0.23707792660160465, 'psi': 0.813803010210803}-{'f1_val': 0.6897692393087553, 'auprc': 0.9846832053200163, 'loss_val': 0.3430436472020139, 'psi': 0.8077348257132597}
[S16] START round=14 head_norm_before_train=1.357779 cos_to_last_merge=0.8579 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.858
[S16] round=14 local utility u=0.059815 metrics={'f1_val': 0.84896343800498, 'auprc': 0.9721377601956098, 'loss_val': 0.6347131439717616, 'psi': 0.8982331668812319}-{'f1_val': 0.8455897765169886, 'auprc': 0.9365548064512456, 'loss_val': 0.6273524024767301, 'psi': 0.8819757884906914}
[S17] START round=14 head_norm_before_train=1.278479 cos_to_last_merge=0.8395 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.839
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.3517393092105263, 'auprc': 0.8630565993602134, 'loss_val': 0.927058214876552, 'psi': 0.5562662252704011}-{'f1_val': 0.3518829443654007, 'auprc': 0.8769627720939611, 'loss_val': 0.9420887720251934, 'psi': 0.5619148754568248}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:54511
[S13] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S9
[S7] cosine check vs S9: cos=0.5879
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] cosine check vs S6: cos=0.6549
[S7] RECEIVED delta(kind=head bytes=1794) from S14
[S7] cosine check vs S14: cos=0.5665
[S13] RECEIVED delta(kind=head bytes=1794) from S7
[S13] cosine check vs S7: cos=-0.1267
[S13] DROPPED delta from S7 (cos=-0.1267 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=-0.1218
[S5] DROPPED delta from S10 (cos=-0.1218 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.9810
[S6] RECEIVED delta(kind=head bytes=1797) from S2
[S6] cosine check vs S2: cos=-0.0022
[S6] DROPPED delta from S2 (cos=-0.0022 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9923
[S14] RECEIVED delta(kind=head bytes=1799) from S3
[S14] cosine check vs S3: cos=0.5149
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=0.7119
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] cosine check vs S4: cos=0.3260
[S14] RECEIVED delta(kind=head bytes=1801) from S16
[S14] cosine check vs S16: cos=0.5526
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.9337 head_norm=1.544594
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.572221e-02
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.8955 head_norm=1.527833 delta_norm=0.095722
[S10] aggregate: ROLLBACK (f1_val pre=0.934 post=0.895 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7019 head_norm=1.274869
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.253015e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.7017 head_norm=1.276700 delta_norm=0.125302
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.6228 head_norm=0.849107
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.320396e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.6230 head_norm=0.800543 delta_norm=0.132040
[S7] aggregate: ACCEPT kept=['S9', 'S6', 'S14'] (k=3/3) mode=median trim_p=0.1
[S14] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.3966 head_norm=0.848143
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.188990e-02
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.4049 head_norm=0.837611 delta_norm=0.091890
[S14] aggregate: ACCEPT kept=['S3', 'S15', 'S4', 'S16'] (k=4/4) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.276700 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7142411927721413, 'auprc': 0.7722730487626148, 'loss_val': 0.6350211012871625, 'psi': 0.7374539351683307}-{'f1_val': 0.7018626208173713, 'auprc': 0.7830634421219818, 'loss_val': 0.4889870058459132, 'psi': 0.7343429493392155}
[S3] START round=15 head_norm_before_train=1.540929 cos_to_last_merge=0.9961 (last merge round=12)
[S3] round=15 local utility u=0.004220 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9990403995185042, 'loss_val': 0.29053322085687755, 'psi': 0.8199649974026547}-{'f1_val': 0.7005813959920884, 'auprc': 0.9993349587991539, 'loss_val': 0.29985786070175036, 'psi': 0.8200828211149146}
[S4] START round=15 head_norm_before_train=1.735869 (no previous merge yet)
[S4] round=15 local utility u=0.003172 metrics={'f1_val': 0.9460768792576422, 'auprc': 0.9649240219146725, 'loss_val': 0.3465526211913101, 'psi': 0.9536157363204544}-{'f1_val': 0.953134159758266, 'auprc': 0.9569991555184135, 'loss_val': 0.37146666930909295, 'psi': 0.954680158062325}
[S5] START round=15 head_norm_before_train=1.585279 cos_to_last_merge=0.9903 (last merge round=11)
[S5] round=15 local utility u=0.935305 metrics={'f1_val': 0.6614142709454545, 'auprc': 0.9387187818179749, 'loss_val': 0.33888669562254814, 'psi': 0.7723360752944626}-{'f1_val': 0.45035181143852415, 'auprc': 0.8542479237892683, 'loss_val': 0.689709172575933, 'psi': 0.6119102563788218}
[S6] START round=15 head_norm_before_train=1.552943 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.709965291213394, 'auprc': 0.9516900906739827, 'loss_val': 0.3515061925394284, 'psi': 0.8066552109976295}-{'f1_val': 0.7092551443190896, 'auprc': 0.9631433919663852, 'loss_val': 0.34277952431714387, 'psi': 0.8108104433780079}
[S7] START round=15 head_norm_before_train=0.800543 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.4389713723719553, 'auprc': 0.6456680510109506, 'loss_val': 1.0018177007274316, 'psi': 0.5216500438275535}-{'f1_val': 0.6228407137194746, 'auprc': 0.8191862920026141, 'loss_val': 0.6721537415148574, 'psi': 0.7013789450327303}
[S8] START round=15 head_norm_before_train=1.588417 (no previous merge yet)
[S8] round=15 local utility u=1.000000 metrics={'f1_val': 0.9944419165290753, 'auprc': 0.9978919880738317, 'loss_val': 0.16228224998299778, 'psi': 0.9958219451469779}-{'f1_val': 0.7140170479737811, 'auprc': 0.9110760738913761, 'loss_val': 0.3452354372280479, 'psi': 0.7928406583408192}
[S9] START round=15 head_norm_before_train=1.525712 cos_to_last_merge=0.7968 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.797
[S9] round=15 local utility u=0.009895 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9975416238153407, 'loss_val': 0.05938537782273419, 'psi': 0.9972957033104017}-{'f1_val': 0.9975426610709598, 'auprc': 0.9991830204965169, 'loss_val': 0.08656522834995369, 'psi': 0.9981988048411826}
[S10] START round=15 head_norm_before_train=1.527833 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.8322647182740259, 'auprc': 0.9976528163477251, 'loss_val': 0.293597395978236, 'psi': 0.8984199575035056}-{'f1_val': 0.9336540064316314, 'auprc': 0.989419211531864, 'loss_val': 0.30921548875749827, 'psi': 0.9559600884717244}
[S11] START round=15 head_norm_before_train=1.290750 cos_to_last_merge=0.8214 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.821
[S11] round=15 local utility u=0.026696 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9982574875056962, 'loss_val': 0.27368872463682964, 'psi': 0.8204641849812706}-{'f1_val': 0.7016934795869249, 'auprc': 0.9963464140048585, 'loss_val': 0.3198965737965632, 'psi': 0.8195546533540983}
[S13] START round=15 head_norm_before_train=1.516938 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.655420743635801, 'auprc': 0.7771222868739042, 'loss_val': 0.5821934862888357, 'psi': 0.7041013609310423}-{'f1_val': 0.7116411800817113, 'auprc': 0.7466986548859135, 'loss_val': 0.589661543996044, 'psi': 0.7256641700033921}
[S14] START round=15 head_norm_before_train=0.837611 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.905596 metrics={'f1_val': 0.690160260280847, 'auprc': 0.9953124555580413, 'loss_val': 0.5935304557089279, 'psi': 0.8122211383917247}-{'f1_val': 0.39656053564365834, 'auprc': 0.9970672551069097, 'loss_val': 0.6483889447428549, 'psi': 0.636763223428959}
[S15] START round=15 head_norm_before_train=1.440766 cos_to_last_merge=0.8383 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.838
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6939698615976004, 'auprc': 0.9874397264649455, 'loss_val': 0.24646177684114137, 'psi': 0.8113578075445385}-{'f1_val': 0.6978148486698506, 'auprc': 0.9877852525222317, 'loss_val': 0.23707792660160465, 'psi': 0.813803010210803}
[S16] START round=15 head_norm_before_train=1.399410 cos_to_last_merge=0.8503 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.850
[S16] round=15 local utility u=0.607960 metrics={'f1_val': 0.9678260816572739, 'auprc': 0.992127082066552, 'loss_val': 0.1919368478465349, 'psi': 0.9775464818209851}-{'f1_val': 0.84896343800498, 'auprc': 0.9721377601956098, 'loss_val': 0.6347131439717616, 'psi': 0.8982331668812319}
[S17] START round=15 head_norm_before_train=1.296268 cos_to_last_merge=0.8324 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.832
[S17] round=15 local utility u=0.081110 metrics={'f1_val': 0.37570490996141354, 'auprc': 0.8721228454527975, 'loss_val': 0.9358311831509782, 'psi': 0.5742720841579672}-{'f1_val': 0.3517393092105263, 'auprc': 0.8630565993602134, 'loss_val': 0.927058214876552, 'psi': 0.5562662252704011}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:54514
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:54503
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:54505
[S5] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S9
[S7] cosine check vs S9: cos=0.6082
[S2] RECEIVED delta(kind=head bytes=1790) from S11
[S2] cosine check vs S11: cos=0.9866
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] cosine check vs S8: cos=0.9658
[S14] RECEIVED delta(kind=head bytes=1799) from S16
[S14] cosine check vs S16: cos=0.5608
[S14] RECEIVED delta(kind=head bytes=1800) from S3
[S14] cosine check vs S3: cos=0.4766
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.6064
[S14] RECEIVED delta(kind=head bytes=1804) from S4
[S14] cosine check vs S4: cos=0.3468
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=0.9675
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=-0.0976
[S8] DROPPED delta from S17 (cos=-0.0976 < 0.0)
[S10] ⇄ pheromone p=0.286 → S5@127.0.0.1:54505
[S6] ⇄ pheromone p=0.237 → S7@127.0.0.1:54508
[S13] ⇄ pheromone p=0.151 → S10@127.0.0.1:54511
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7142 head_norm=1.326950
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.087255e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.7142 head_norm=1.324644 delta_norm=0.108725
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.161 → S6@127.0.0.1:54507
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.4390 head_norm=0.846006
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.033449e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.4430 head_norm=0.848894 delta_norm=0.303345
[S7] aggregate: ACCEPT kept=['S9', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.186 → S13@127.0.0.1:54513
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.7006 head_norm=1.582435
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.033802e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.7006 head_norm=1.580958 delta_norm=0.203380
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.101 → S14@127.0.0.1:54514
[S9] ⇄ pheromone p=0.228 → S7@127.0.0.1:54508
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.6614 head_norm=1.605454
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.103966e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.6735 head_norm=1.594690 delta_norm=0.210397
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.314 → S3@127.0.0.1:54503
[S16] ⇄ pheromone p=0.357 → S14@127.0.0.1:54514
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.6902 head_norm=0.874991
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.425209e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.6927 head_norm=0.837530 delta_norm=0.242521
[S14] aggregate: ACCEPT kept=['S16', 'S3', 'S4'] (k=3/3) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.320 → S7@127.0.0.1:54508
[S8] ⇄ pheromone p=0.331 → S5@127.0.0.1:54505
[S11] ⇄ pheromone p=0.211 → S2@127.0.0.1:54502
[S4] ⇄ pheromone p=0.236 → S14@127.0.0.1:54514
[S15] ⇄ pheromone p=0.180 → S14@127.0.0.1:54514
[S17] ⇄ pheromone p=0.107 → S8@127.0.0.1:54509
[S2] START round=16 head_norm_before_train=1.324644 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.051259 metrics={'f1_val': 0.7132369429248555, 'auprc': 0.7802454155735731, 'loss_val': 0.550395435430111, 'psi': 0.7400403319843425}-{'f1_val': 0.7142411927721413, 'auprc': 0.7722730487626148, 'loss_val': 0.6350211012871625, 'psi': 0.7374539351683307}
[S3] START round=16 head_norm_before_train=1.580958 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.6603232146393048, 'auprc': 0.9945059529227268, 'loss_val': 0.3892375050525902, 'psi': 0.7939963099526736}-{'f1_val': 0.7005813959920884, 'auprc': 0.9990403995185042, 'loss_val': 0.29053322085687755, 'psi': 0.8199649974026547}
[S4] START round=16 head_norm_before_train=1.763439 (no previous merge yet)
[S4] round=16 local utility u=0.017361 metrics={'f1_val': 0.944450144528819, 'auprc': 0.9670104526014457, 'loss_val': 0.30833030580292925, 'psi': 0.9534742677578696}-{'f1_val': 0.9460768792576422, 'auprc': 0.9649240219146725, 'loss_val': 0.3465526211913101, 'psi': 0.9536157363204544}
[S5] START round=16 head_norm_before_train=1.594690 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.6390092068311173, 'auprc': 0.8778073253886204, 'loss_val': 0.4039949726122901, 'psi': 0.7345284542541185}-{'f1_val': 0.6614142709454545, 'auprc': 0.9387187818179749, 'loss_val': 0.33888669562254814, 'psi': 0.7723360752944626}
[S6] START round=16 head_norm_before_train=1.572745 (no previous merge yet)
[S6] round=16 local utility u=0.050008 metrics={'f1_val': 0.7102317945949432, 'auprc': 0.9646590681089316, 'loss_val': 0.29199518888402404, 'psi': 0.8120027040005386}-{'f1_val': 0.709965291213394, 'auprc': 0.9516900906739827, 'loss_val': 0.3515061925394284, 'psi': 0.8066552109976295}
[S7] START round=16 head_norm_before_train=0.848894 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.131937 metrics={'f1_val': 0.46653460869087127, 'auprc': 0.6608612712741194, 'loss_val': 0.9489021539299848, 'psi': 0.5442652737241706}-{'f1_val': 0.4389713723719553, 'auprc': 0.6456680510109506, 'loss_val': 1.0018177007274316, 'psi': 0.5216500438275535}
[S8] START round=16 head_norm_before_train=1.611559 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.8682336883587234, 'auprc': 0.9957785514419899, 'loss_val': 0.16561425810237382, 'psi': 0.91925163359203}-{'f1_val': 0.9944419165290753, 'auprc': 0.9978919880738317, 'loss_val': 0.16228224998299778, 'psi': 0.9958219451469779}
[S9] START round=16 head_norm_before_train=1.570964 cos_to_last_merge=0.7902 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.790
[S9] round=16 local utility u=0.007046 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9971366551346558, 'loss_val': 0.044079276685736433, 'psi': 0.9971337158381277}-{'f1_val': 0.9971317563071089, 'auprc': 0.9975416238153407, 'loss_val': 0.05938537782273419, 'psi': 0.9972957033104017}
[S10] START round=16 head_norm_before_train=1.557987 cos_to_last_merge=0.9996 (last merge round=14)
[S10] round=16 local utility u=0.531753 metrics={'f1_val': 0.9957292349169065, 'auprc': 0.9976161935234096, 'loss_val': 0.21076941940453858, 'psi': 0.9964840183595077}-{'f1_val': 0.8322647182740259, 'auprc': 0.9976528163477251, 'loss_val': 0.293597395978236, 'psi': 0.8984199575035056}
[S11] START round=16 head_norm_before_train=1.331243 cos_to_last_merge=0.8123 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.812
[S11] round=16 local utility u=0.003584 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9966282264661855, 'loss_val': 0.2616330576400122, 'psi': 0.8198124805654663}-{'f1_val': 0.7019353166316534, 'auprc': 0.9982574875056962, 'loss_val': 0.27368872463682964, 'psi': 0.8204641849812706}
[S13] START round=16 head_norm_before_train=1.538492 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.611389974362545, 'auprc': 0.7547719763631628, 'loss_val': 0.5920845588970974, 'psi': 0.6687427751627921}-{'f1_val': 0.655420743635801, 'auprc': 0.7771222868739042, 'loss_val': 0.5821934862888357, 'psi': 0.7041013609310423}
[S14] START round=16 head_norm_before_train=0.837530 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.391533 metrics={'f1_val': 0.8137606434413724, 'auprc': 0.9968589622851824, 'loss_val': 0.5567063591385268, 'psi': 0.8869999709788965}-{'f1_val': 0.690160260280847, 'auprc': 0.9953124555580413, 'loss_val': 0.5935304557089279, 'psi': 0.8122211383917247}
[S15] START round=16 head_norm_before_train=1.471867 cos_to_last_merge=0.8334 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.833
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6934245298330631, 'auprc': 0.9823142100819686, 'loss_val': 0.43698316885893035, 'psi': 0.8089804019326254}-{'f1_val': 0.6939698615976004, 'auprc': 0.9874397264649455, 'loss_val': 0.24646177684114137, 'psi': 0.8113578075445385}
[S16] START round=16 head_norm_before_train=1.443373 cos_to_last_merge=0.8434 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.843
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.9414960099389301, 'auprc': 0.9944679110811687, 'loss_val': 0.19582391810250752, 'psi': 0.9626847703958256}-{'f1_val': 0.9678260816572739, 'auprc': 0.992127082066552, 'loss_val': 0.1919368478465349, 'psi': 0.9775464818209851}
[S17] START round=16 head_norm_before_train=1.309020 cos_to_last_merge=0.8295 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.830
[S17] round=16 local utility u=1.000000 metrics={'f1_val': 0.6817553250963455, 'auprc': 0.9505959064492373, 'loss_val': 0.5978207531158611, 'psi': 0.7892915576375023}-{'f1_val': 0.37570490996141354, 'auprc': 0.8721228454527975, 'loss_val': 0.9358311831509782, 'psi': 0.5742720841579672}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:54502
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:54507
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:54505
[S14] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1807 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=0.3874
[S7] RECEIVED delta(kind=head bytes=1800) from S9
[S7] cosine check vs S9: cos=0.7814
[S13] RECEIVED delta(kind=head bytes=1793) from S7
[S13] cosine check vs S7: cos=-0.1295
[S13] DROPPED delta from S7 (cos=-0.1295 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S11
[S2] cosine check vs S11: cos=0.9895
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=-0.1221
[S5] DROPPED delta from S10 (cos=-0.1221 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S2
[S6] cosine check vs S2: cos=-0.0028
[S6] DROPPED delta from S2 (cos=-0.0028 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1807) from S4
[S14] cosine check vs S4: cos=0.4196
[S7] RECEIVED delta(kind=head bytes=1793) from S14
[S7] cosine check vs S14: cos=0.5354
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=-0.1014
[S8] DROPPED delta from S17 (cos=-0.1014 < 0.0)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.4665 head_norm=0.892471
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.754307e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.4725 head_norm=0.822730 delta_norm=0.175431
[S7] aggregate: ACCEPT kept=['S6', 'S9', 'S14'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.7132 head_norm=1.371420
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.926112e-02
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.7129 head_norm=1.366509 delta_norm=0.099261
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.8138 head_norm=0.879404
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.149127e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.6927 head_norm=1.150929 delta_norm=0.814913
[S14] aggregate: ROLLBACK (f1_val pre=0.814 post=0.693 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.366509 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.019115 metrics={'f1_val': 0.7063892431586554, 'auprc': 0.7826509587335652, 'loss_val': 0.47829588439355686, 'psi': 0.7368939293886193}-{'f1_val': 0.7132369429248555, 'auprc': 0.7802454155735731, 'loss_val': 0.550395435430111, 'psi': 0.7400403319843425}
[S3] START round=17 head_norm_before_train=1.617918 cos_to_last_merge=0.9994 (last merge round=15)
[S3] round=17 local utility u=0.139053 metrics={'f1_val': 0.6927498788157274, 'auprc': 0.9995802806682721, 'loss_val': 0.32091362284692465, 'psi': 0.8154820395567453}-{'f1_val': 0.6603232146393048, 'auprc': 0.9945059529227268, 'loss_val': 0.3892375050525902, 'psi': 0.7939963099526736}
[S4] START round=17 head_norm_before_train=1.789997 (no previous merge yet)
[S4] round=17 local utility u=0.020439 metrics={'f1_val': 0.9485905927094807, 'auprc': 0.9646947863921563, 'loss_val': 0.2853487473510571, 'psi': 0.9550322701825509}-{'f1_val': 0.944450144528819, 'auprc': 0.9670104526014457, 'loss_val': 0.30833030580292925, 'psi': 0.9534742677578696}
[S5] START round=17 head_norm_before_train=1.611602 cos_to_last_merge=0.9999 (last merge round=15)
[S5] round=17 local utility u=0.451694 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9975047813265302, 'loss_val': 0.227572665483696, 'psi': 0.8191947029909603}-{'f1_val': 0.6390092068311173, 'auprc': 0.8778073253886204, 'loss_val': 0.4039949726122901, 'psi': 0.7345284542541185}
[S6] START round=17 head_norm_before_train=1.594197 (no previous merge yet)
[S6] round=17 local utility u=0.610786 metrics={'f1_val': 0.9058708144912883, 'auprc': 0.9696484745897938, 'loss_val': 0.25922641853632367, 'psi': 0.9313818785306904}-{'f1_val': 0.7102317945949432, 'auprc': 0.9646590681089316, 'loss_val': 0.29199518888402404, 'psi': 0.8120027040005386}
[S7] START round=17 head_norm_before_train=0.822730 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.4491808153963487, 'auprc': 0.64539207752802, 'loss_val': 0.9991132620736797, 'psi': 0.5276653202490171}-{'f1_val': 0.46653460869087127, 'auprc': 0.6608612712741194, 'loss_val': 0.9489021539299848, 'psi': 0.5442652737241706}
[S8] START round=17 head_norm_before_train=1.636271 (no previous merge yet)
[S8] round=17 local utility u=0.407121 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.9974099920520498, 'loss_val': 0.11366817499988491, 'psi': 0.9956443180022571}-{'f1_val': 0.8682336883587234, 'auprc': 0.9957785514419899, 'loss_val': 0.16561425810237382, 'psi': 0.91925163359203}
[S9] START round=17 head_norm_before_train=1.613989 cos_to_last_merge=0.7841 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.784
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9937649441666649, 'auprc': 0.9992270300384941, 'loss_val': 0.039301256961409105, 'psi': 0.9959497785153967}-{'f1_val': 0.9971317563071089, 'auprc': 0.9971366551346558, 'loss_val': 0.044079276685736433, 'psi': 0.9971337158381277}
[S10] START round=17 head_norm_before_train=1.583969 cos_to_last_merge=0.9985 (last merge round=14)
[S10] round=17 local utility u=0.016814 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9971101446450485, 'loss_val': 0.17308586244213595, 'psi': 0.9960278564250643}-{'f1_val': 0.9957292349169065, 'auprc': 0.9976161935234096, 'loss_val': 0.21076941940453858, 'psi': 0.9964840183595077}
[S11] START round=17 head_norm_before_train=1.368797 cos_to_last_merge=0.8044 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.804
[S11] round=17 local utility u=0.869391 metrics={'f1_val': 0.9824099966764672, 'auprc': 0.9980575785305367, 'loss_val': 0.20998629486557213, 'psi': 0.988669029418095}-{'f1_val': 0.7019353166316534, 'auprc': 0.9966282264661855, 'loss_val': 0.2616330576400122, 'psi': 0.8198124805654663}
[S13] START round=17 head_norm_before_train=1.561950 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6102434471830543, 'auprc': 0.6486894768652778, 'loss_val': 0.626101415038091, 'psi': 0.6256218590559437}-{'f1_val': 0.611389974362545, 'auprc': 0.7547719763631628, 'loss_val': 0.5920845588970974, 'psi': 0.6687427751627921}
[S14] START round=17 head_norm_before_train=1.150929 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.7020236003000903, 'auprc': 0.998206823164481, 'loss_val': 0.5618937501838767, 'psi': 0.8204968894458465}-{'f1_val': 0.8137606434413724, 'auprc': 0.9968589622851824, 'loss_val': 0.5567063591385268, 'psi': 0.8869999709788965}
[S15] START round=17 head_norm_before_train=1.503749 cos_to_last_merge=0.8284 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.828
[S15] round=17 local utility u=0.258820 metrics={'f1_val': 0.7489815855827294, 'auprc': 0.988913093921462, 'loss_val': 0.2724817821291082, 'psi': 0.8449541889182224}-{'f1_val': 0.6934245298330631, 'auprc': 0.9823142100819686, 'loss_val': 0.43698316885893035, 'psi': 0.8089804019326254}
[S16] START round=17 head_norm_before_train=1.486608 cos_to_last_merge=0.8362 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.836
[S16] round=17 local utility u=0.023773 metrics={'f1_val': 0.9442481098641418, 'auprc': 0.9940263138160959, 'loss_val': 0.16346560681826552, 'psi': 0.9641593914449235}-{'f1_val': 0.9414960099389301, 'auprc': 0.9944679110811687, 'loss_val': 0.19582391810250752, 'psi': 0.9626847703958256}
[S17] START round=17 head_norm_before_train=1.328615 cos_to_last_merge=0.8267 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.827
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.3787905375189209, 'auprc': 0.7209140515419684, 'loss_val': 0.8379091480489765, 'psi': 0.5156399431281399}-{'f1_val': 0.6817553250963455, 'auprc': 0.9505959064492373, 'loss_val': 0.5978207531158611, 'psi': 0.7892915576375023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:54505
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:54514
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:54514
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[S2] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1807 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.9912
[S3] RECEIVED delta(kind=head bytes=1790) from S5
[S3] cosine check vs S5: cos=0.9739
[S5] RECEIVED delta(kind=head bytes=1794) from S8
[S5] cosine check vs S8: cos=0.9833
[S5] RECEIVED delta(kind=head bytes=1795) from S10
[S5] cosine check vs S10: cos=-0.1210
[S5] DROPPED delta from S10 (cos=-0.1210 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S6
[S7] cosine check vs S6: cos=0.5230
[S6] RECEIVED delta(kind=head bytes=1791) from S2
[S6] cosine check vs S2: cos=-0.0048
[S6] DROPPED delta from S2 (cos=-0.0048 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=0.2939
[S14] RECEIVED delta(kind=head bytes=1800) from S3
[S14] cosine check vs S3: cos=0.1511
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] cosine check vs S16: cos=0.1798
[S14] RECEIVED delta(kind=head bytes=1807) from S4
[S14] cosine check vs S4: cos=0.9214
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.7020 head_norm=1.184271
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.410696e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.6918 head_norm=0.950408 delta_norm=0.441070
[S14] aggregate: ROLLBACK (f1_val pre=0.702 post=0.692 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.4492 head_norm=0.868492
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.885732e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.4440 head_norm=1.099015 delta_norm=0.688573
[S7] aggregate: ROLLBACK (f1_val pre=0.449 post=0.444 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.6927 head_norm=1.653727
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.881003e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.6907 head_norm=1.632574 delta_norm=0.188100
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.7064 head_norm=1.407871
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.334719e-02
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.7055 head_norm=1.403509 delta_norm=0.093347
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.7003 head_norm=1.632957
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.510800e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7003 head_norm=1.639348 delta_norm=0.151080
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.403509 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7061057697172803, 'auprc': 0.7791993770791587, 'loss_val': 0.4837566899808392, 'psi': 0.7353432126620316}-{'f1_val': 0.7063892431586554, 'auprc': 0.7826509587335652, 'loss_val': 0.47829588439355686, 'psi': 0.7368939293886193}
[S3] START round=18 head_norm_before_train=1.632574 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.043433 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9989208707329527, 'loss_val': 0.28010709502442865, 'psi': 0.8200220705343608}-{'f1_val': 0.6927498788157274, 'auprc': 0.9995802806682721, 'loss_val': 0.32091362284692465, 'psi': 0.8154820395567453}
[S4] START round=18 head_norm_before_train=1.812727 (no previous merge yet)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9437700686013112, 'auprc': 0.9631163678954144, 'loss_val': 0.2772327617567547, 'psi': 0.9515085883189525}-{'f1_val': 0.9485905927094807, 'auprc': 0.9646947863921563, 'loss_val': 0.2853487473510571, 'psi': 0.9550322701825509}
[S5] START round=18 head_norm_before_train=1.639348 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.6251222879929508, 'auprc': 0.6729046969109627, 'loss_val': 0.5146711665140051, 'psi': 0.6442352515601555}-{'f1_val': 0.7003213174339138, 'auprc': 0.9975047813265302, 'loss_val': 0.227572665483696, 'psi': 0.8191947029909603}
[S6] START round=18 head_norm_before_train=1.615443 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.6438442009861582, 'auprc': 0.8158636079185538, 'loss_val': 0.4410314457422113, 'psi': 0.7126519637591164}-{'f1_val': 0.9058708144912883, 'auprc': 0.9696484745897938, 'loss_val': 0.25922641853632367, 'psi': 0.9313818785306904}
[S7] START round=18 head_norm_before_train=1.099015 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.686544 metrics={'f1_val': 0.5747077269826844, 'auprc': 0.7801582631360611, 'loss_val': 0.7834843479926947, 'psi': 0.6568879414440351}-{'f1_val': 0.4491808153963487, 'auprc': 0.64539207752802, 'loss_val': 0.9991132620736797, 'psi': 0.5276653202490171}
[S8] START round=18 head_norm_before_train=1.659526 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9933434229799246, 'auprc': 0.9911344676468543, 'loss_val': 0.09743943803806335, 'psi': 0.9924598408466965}-{'f1_val': 0.9944672019690619, 'auprc': 0.9974099920520498, 'loss_val': 0.11366817499988491, 'psi': 0.9956443180022571}
[S9] START round=18 head_norm_before_train=1.653286 cos_to_last_merge=0.7790 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.779
[S9] round=18 local utility u=0.010761 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.997272100155197, 'loss_val': 0.03194204794755028, 'psi': 0.9971705875693645}-{'f1_val': 0.9937649441666649, 'auprc': 0.9992270300384941, 'loss_val': 0.039301256961409105, 'psi': 0.9959497785153967}
[S10] START round=18 head_norm_before_train=1.606983 cos_to_last_merge=0.9971 (last merge round=14)
[S10] round=18 local utility u=0.014549 metrics={'f1_val': 0.9948429234526912, 'auprc': 0.9970695837864931, 'loss_val': 0.14108483818616172, 'psi': 0.995733587586212}-{'f1_val': 0.9953063309450747, 'auprc': 0.9971101446450485, 'loss_val': 0.17308586244213595, 'psi': 0.9960278564250643}
[S11] START round=18 head_norm_before_train=1.405347 cos_to_last_merge=0.7972 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.797
[S11] round=18 local utility u=0.050876 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9966343095731438, 'loss_val': 0.1887862288965615, 'psi': 0.9965819265374113}-{'f1_val': 0.9824099966764672, 'auprc': 0.9980575785305367, 'loss_val': 0.20998629486557213, 'psi': 0.988669029418095}
[S13] START round=18 head_norm_before_train=1.585830 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5696149048200477, 'auprc': 0.5414993402895871, 'loss_val': 0.7512871237457966, 'psi': 0.5583686790078635}-{'f1_val': 0.6102434471830543, 'auprc': 0.6486894768652778, 'loss_val': 0.626101415038091, 'psi': 0.6256218590559437}
[S14] START round=18 head_norm_before_train=0.950408 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.929339 metrics={'f1_val': 0.9875834864906797, 'auprc': 0.9987755376422299, 'loss_val': 0.41828022560724043, 'psi': 0.9920603069512998}-{'f1_val': 0.7020236003000903, 'auprc': 0.998206823164481, 'loss_val': 0.5618937501838767, 'psi': 0.8204968894458465}
[S15] START round=18 head_norm_before_train=1.534675 cos_to_last_merge=0.8236 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.824
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.7018090758073106, 'auprc': 0.9833232375255925, 'loss_val': 0.32464303021389196, 'psi': 0.8144147404946234}-{'f1_val': 0.7489815855827294, 'auprc': 0.988913093921462, 'loss_val': 0.2724817821291082, 'psi': 0.8449541889182224}
[S16] START round=18 head_norm_before_train=1.526937 cos_to_last_merge=0.8305 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.831
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.9271795650562864, 'auprc': 0.9929608451222368, 'loss_val': 0.27641538124069936, 'psi': 0.9534920770826666}-{'f1_val': 0.9442481098641418, 'auprc': 0.9940263138160959, 'loss_val': 0.16346560681826552, 'psi': 0.9641593914449235}
[S17] START round=18 head_norm_before_train=1.351893 cos_to_last_merge=0.8252 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.825
[S17] round=18 local utility u=0.257097 metrics={'f1_val': 0.40328151578548077, 'auprc': 0.8636524339643218, 'loss_val': 0.8988762955705328, 'psi': 0.5874298830570173}-{'f1_val': 0.3787905375189209, 'auprc': 0.7209140515419684, 'loss_val': 0.8379091480489765, 'psi': 0.5156399431281399}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:54514
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:54505
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:54513
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:54508
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] cosine check vs S10: cos=-0.1173
[S5] DROPPED delta from S10 (cos=-0.1173 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S3
[S14] cosine check vs S3: cos=0.3210
[S7] RECEIVED delta(kind=head bytes=1802) from S9
[S7] cosine check vs S9: cos=0.3305
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.2826
[S13] RECEIVED delta(kind=head bytes=1795) from S7
[S13] cosine check vs S7: cos=-0.1019
[S13] DROPPED delta from S7 (cos=-0.1019 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] cosine check vs S11: cos=0.9929
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=-0.1069
[S8] DROPPED delta from S17 (cos=-0.1069 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.7061 head_norm=1.439037
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.601233e-02
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.7060 head_norm=1.436348 delta_norm=0.086012
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.5747 head_norm=1.130762
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.889317e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.5786 head_norm=0.906427 delta_norm=0.588932
[S7] aggregate: ACCEPT kept=['S9', 'S14'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9876 head_norm=1.001152
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.239387e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.7573 head_norm=1.102398 delta_norm=0.823939
[S14] aggregate: ROLLBACK (f1_val pre=0.988 post=0.757 tol_abs=0.005 tol_rel=0.0)
[S2] START round=19 head_norm_before_train=1.436348 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7052785458709204, 'auprc': 0.7575419126576941, 'loss_val': 0.4661924851176286, 'psi': 0.7261838925856299}-{'f1_val': 0.7061057697172803, 'auprc': 0.7791993770791587, 'loss_val': 0.4837566899808392, 'psi': 0.7353432126620316}
[S3] START round=19 head_norm_before_train=1.669134 cos_to_last_merge=0.9994 (last merge round=17)
[S3] round=19 local utility u=0.009279 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9985605610669008, 'loss_val': 0.2600165074087544, 'psi': 0.8198328002259612}-{'f1_val': 0.7007562037352997, 'auprc': 0.9989208707329527, 'loss_val': 0.28010709502442865, 'psi': 0.8200220705343608}
[S4] START round=19 head_norm_before_train=1.831101 (no previous merge yet)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9412452038299768, 'auprc': 0.9483790575699128, 'loss_val': 0.2702341463254609, 'psi': 0.9440987453259513}-{'f1_val': 0.9437700686013112, 'auprc': 0.9631163678954144, 'loss_val': 0.2772327617567547, 'psi': 0.9515085883189525}
[S5] START round=19 head_norm_before_train=1.653199 cos_to_last_merge=0.9999 (last merge round=17)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.5682502495330326, 'auprc': 0.6945212161538047, 'loss_val': 0.6130163666001794, 'psi': 0.6187586361813415}-{'f1_val': 0.6251222879929508, 'auprc': 0.6729046969109627, 'loss_val': 0.5146711665140051, 'psi': 0.6442352515601555}
[S6] START round=19 head_norm_before_train=1.631867 (no previous merge yet)
[S6] round=19 local utility u=1.000000 metrics={'f1_val': 0.9148188653394191, 'auprc': 0.9613960637547296, 'loss_val': 0.2567374489664719, 'psi': 0.9334497447055433}-{'f1_val': 0.6438442009861582, 'auprc': 0.8158636079185538, 'loss_val': 0.4410314457422113, 'psi': 0.7126519637591164}
[S7] START round=19 head_norm_before_train=0.906427 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.779227 metrics={'f1_val': 0.6978563955039375, 'auprc': 0.9529929005846041, 'loss_val': 0.4824270539304573, 'psi': 0.7999109975362042}-{'f1_val': 0.5747077269826844, 'auprc': 0.7801582631360611, 'loss_val': 0.7834843479926947, 'psi': 0.6568879414440351}
[S8] START round=19 head_norm_before_train=1.685067 (no previous merge yet)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9901171427418579, 'auprc': 0.9872078789777751, 'loss_val': 0.12361710246900032, 'psi': 0.9889534372362248}-{'f1_val': 0.9933434229799246, 'auprc': 0.9911344676468543, 'loss_val': 0.09743943803806335, 'psi': 0.9924598408466965}
[S9] START round=19 head_norm_before_train=1.684591 cos_to_last_merge=0.7751 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.775
[S9] round=19 local utility u=0.000034 metrics={'f1_val': 0.9958557717480525, 'auprc': 0.9992232690670688, 'loss_val': 0.030244452745522885, 'psi': 0.997202770675659}-{'f1_val': 0.9971029125121428, 'auprc': 0.997272100155197, 'loss_val': 0.03194204794755028, 'psi': 0.9971705875693645}
[S10] START round=19 head_norm_before_train=1.628769 cos_to_last_merge=0.9956 (last merge round=14)
[S10] round=19 local utility u=0.005496 metrics={'f1_val': 0.9943624847472301, 'auprc': 0.9969835362185505, 'loss_val': 0.12695266095162458, 'psi': 0.9954109053357583}-{'f1_val': 0.9948429234526912, 'auprc': 0.9970695837864931, 'loss_val': 0.14108483818616172, 'psi': 0.995733587586212}
[S11] START round=19 head_norm_before_train=1.438806 cos_to_last_merge=0.7913 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.791
[S11] round=19 local utility u=0.034205 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9980236122472482, 'loss_val': 0.1270261003562408, 'psi': 0.997385942745676}-{'f1_val': 0.9965470045135896, 'auprc': 0.9966343095731438, 'loss_val': 0.1887862288965615, 'psi': 0.9965819265374113}
[S13] START round=19 head_norm_before_train=1.603530 (no previous merge yet)
[S13] round=19 local utility u=0.060596 metrics={'f1_val': 0.5654372629632349, 'auprc': 0.5978406533588958, 'loss_val': 0.7740529445914188, 'psi': 0.5783986191214993}-{'f1_val': 0.5696149048200477, 'auprc': 0.5414993402895871, 'loss_val': 0.7512871237457966, 'psi': 0.5583686790078635}
[S14] START round=19 head_norm_before_train=1.102398 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.024774 metrics={'f1_val': 0.9974306056599991, 'auprc': 0.9977236258964024, 'loss_val': 0.42465930696851734, 'psi': 0.9975478137545604}-{'f1_val': 0.9875834864906797, 'auprc': 0.9987755376422299, 'loss_val': 0.41828022560724043, 'psi': 0.9920603069512998}
[S15] START round=19 head_norm_before_train=1.564976 cos_to_last_merge=0.8188 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.819
[S15] round=19 local utility u=0.190390 metrics={'f1_val': 0.7563061509093356, 'auprc': 0.9890778095978738, 'loss_val': 0.28810950382218603, 'psi': 0.8494148143847509}-{'f1_val': 0.7018090758073106, 'auprc': 0.9833232375255925, 'loss_val': 0.32464303021389196, 'psi': 0.8144147404946234}
[S16] START round=19 head_norm_before_train=1.564541 cos_to_last_merge=0.8267 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.827
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8353365887080789, 'auprc': 0.9867681889564907, 'loss_val': 0.7874089581133195, 'psi': 0.8959092288074435}-{'f1_val': 0.9271795650562864, 'auprc': 0.9929608451222368, 'loss_val': 0.27641538124069936, 'psi': 0.9534920770826666}
[S17] START round=19 head_norm_before_train=1.374049 cos_to_last_merge=0.8232 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.823
[S17] round=19 local utility u=0.433156 metrics={'f1_val': 0.5233724167862345, 'auprc': 0.8663298978641725, 'loss_val': 0.7611423267732736, 'psi': 0.6605554092174097}-{'f1_val': 0.40328151578548077, 'auprc': 0.8636524339643218, 'loss_val': 0.8988762955705328, 'psi': 0.5874298830570173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:54502
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S9
[S7] cosine check vs S9: cos=0.6966
[S13] RECEIVED delta(kind=head bytes=1799) from S7
[S13] cosine check vs S7: cos=-0.1272
[S13] DROPPED delta from S7 (cos=-0.1272 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] cosine check vs S11: cos=0.9945
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] cosine check vs S10: cos=-0.1163
[S5] DROPPED delta from S10 (cos=-0.1163 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=0.9778
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.3473
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=0.3744
[S14] RECEIVED delta(kind=head bytes=1804) from S3
[S14] cosine check vs S3: cos=0.8846
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] cosine check vs S6: cos=0.6317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S17
[S8] cosine check vs S17: cos=-0.1076
[S8] DROPPED delta from S17 (cos=-0.1076 < 0.0)
[S5] r=20 psi=0.619 u=0.0000 p_local=0.1866 f1=0.568 auprc=0.695 bytes=16152
[S8] r=20 psi=0.989 u=0.0000 p_local=0.1875 f1=0.990 auprc=0.987 bytes=16167
[S4] r=20 psi=0.944 u=0.0000 p_local=0.1012 f1=0.941 auprc=0.948 bytes=21625
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.7053 head_norm=1.465883
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.728563e-02
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.7051 head_norm=1.466751 delta_norm=0.077286
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.726 u=0.0000 p_local=0.0737 f1=0.705 auprc=0.758 bytes=17936
[S13] r=20 psi=0.578 u=0.0606 p_local=0.0739 f1=0.565 auprc=0.598 bytes=17951
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9974 head_norm=1.144846
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.370959e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9974 head_norm=1.147398 delta_norm=0.337096
[S14] aggregate: ACCEPT kept=['S15', 'S3'] (k=2/2) mode=median trim_p=0.1
[S14] r=20 psi=0.998 u=0.0248 p_local=0.3246 f1=0.997 auprc=0.998 bytes=21558
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.6979 head_norm=0.938264
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.673678e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.6977 head_norm=0.895156 delta_norm=0.167368
[S7] aggregate: ACCEPT kept=['S9', 'S14', 'S6'] (k=3/3) mode=median trim_p=0.1
[S7] r=20 psi=0.800 u=0.7792 p_local=0.3552 f1=0.698 auprc=0.953 bytes=17957
[S3] r=20 psi=0.820 u=0.0093 p_local=0.0679 f1=0.701 auprc=0.999 bytes=21597
[S11] r=20 psi=0.997 u=0.0342 p_local=0.2129 f1=0.997 auprc=0.998 bytes=23333
[S9] r=20 psi=0.997 u=0.0000 p_local=0.0958 f1=0.996 auprc=0.999 bytes=21580
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9944 head_norm=1.650161
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.730032e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9944 head_norm=1.624144 delta_norm=0.173003
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.995 u=0.0055 p_local=0.1773 f1=0.994 auprc=0.997 bytes=23331
[S6] r=20 psi=0.933 u=1.0000 p_local=0.3802 f1=0.915 auprc=0.961 bytes=19773
[S15] r=20 psi=0.849 u=0.1904 p_local=0.1449 f1=0.756 auprc=0.989 bytes=19801
[S16] r=20 psi=0.896 u=0.0000 p_local=0.1493 f1=0.835 auprc=0.987 bytes=19750
[S17] r=20 psi=0.661 u=0.4332 p_local=0.2739 f1=0.523 auprc=0.866 bytes=16186
[S2] START round=20 head_norm_before_train=1.466751 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.6972314585237963, 'auprc': 0.6704388316419592, 'loss_val': 0.4194816835315505, 'psi': 0.6865144077710614}-{'f1_val': 0.7052785458709204, 'auprc': 0.7575419126576941, 'loss_val': 0.4661924851176286, 'psi': 0.7261838925856299}
[S3] START round=20 head_norm_before_train=1.701711 cos_to_last_merge=0.9981 (last merge round=17)
[S3] round=20 local utility u=0.009793 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9990501995867256, 'loss_val': 0.24189964383915477, 'psi': 0.8200286556338912}-{'f1_val': 0.7006809596653347, 'auprc': 0.9985605610669008, 'loss_val': 0.2600165074087544, 'psi': 0.8198328002259612}
[S4] START round=20 head_norm_before_train=1.844891 (no previous merge yet)
[S4] round=20 local utility u=0.007756 metrics={'f1_val': 0.9414460036011022, 'auprc': 0.9508429597778955, 'loss_val': 0.2633194924590552, 'psi': 0.9452047860718196}-{'f1_val': 0.9412452038299768, 'auprc': 0.9483790575699128, 'loss_val': 0.2702341463254609, 'psi': 0.9440987453259513}
[S5] START round=20 head_norm_before_train=1.668257 cos_to_last_merge=0.9994 (last merge round=17)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.45694625052810217, 'auprc': 0.772283271036114, 'loss_val': 0.7140852480444918, 'psi': 0.5830810587313069}-{'f1_val': 0.5682502495330326, 'auprc': 0.6945212161538047, 'loss_val': 0.6130163666001794, 'psi': 0.6187586361813415}
[S6] START round=20 head_norm_before_train=1.647442 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.620847315909473, 'auprc': 0.7985485379257368, 'loss_val': 0.5231735151340702, 'psi': 0.6919278047159785}-{'f1_val': 0.9148188653394191, 'auprc': 0.9613960637547296, 'loss_val': 0.2567374489664719, 'psi': 0.9334497447055433}
[S7] START round=20 head_norm_before_train=0.895156 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.059826 metrics={'f1_val': 0.6992669571907963, 'auprc': 0.9779805305202579, 'loss_val': 0.44620122032719034, 'psi': 0.810752386522581}-{'f1_val': 0.6978563955039375, 'auprc': 0.9529929005846041, 'loss_val': 0.4824270539304573, 'psi': 0.7999109975362042}
[S8] START round=20 head_norm_before_train=1.708961 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.7940482021985137, 'loss_val': 0.583466496202406, 'psi': 0.7461627441181029}-{'f1_val': 0.9901171427418579, 'auprc': 0.9872078789777751, 'loss_val': 0.12361710246900032, 'psi': 0.9889534372362248}
[S9] START round=20 head_norm_before_train=1.713089 cos_to_last_merge=0.7718 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.772
[S9] round=20 local utility u=0.003304 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9973724493359797, 'loss_val': 0.025740717245355926, 'psi': 0.9972280335186573}-{'f1_val': 0.9958557717480525, 'auprc': 0.9992232690670688, 'loss_val': 0.030244452745522885, 'psi': 0.997202770675659}
[S10] START round=20 head_norm_before_train=1.624144 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9951453992231678, 'loss_val': 0.16226805711805206, 'psi': 0.9951604139182775}-{'f1_val': 0.9943624847472301, 'auprc': 0.9969835362185505, 'loss_val': 0.12695266095162458, 'psi': 0.9954109053357583}
[S11] START round=20 head_norm_before_train=1.471684 cos_to_last_merge=0.7858 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.786
[S11] round=20 local utility u=0.006894 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9966567104219997, 'loss_val': 0.10810493226895986, 'psi': 0.9967359140744185}-{'f1_val': 0.996960829744628, 'auprc': 0.9980236122472482, 'loss_val': 0.1270261003562408, 'psi': 0.997385942745676}
[S13] START round=20 head_norm_before_train=1.616329 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5674671788723693, 'auprc': 0.5336461497769807, 'loss_val': 0.7317234251054535, 'psi': 0.5539387672342138}-{'f1_val': 0.5654372629632349, 'auprc': 0.5978406533588958, 'loss_val': 0.7740529445914188, 'psi': 0.5783986191214993}
[S14] START round=20 head_norm_before_train=1.147398 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.043715 metrics={'f1_val': 0.9979161758042404, 'auprc': 0.9981707334311563, 'loss_val': 0.34148443434171744, 'psi': 0.9980179988550067}-{'f1_val': 0.9974306056599991, 'auprc': 0.9977236258964024, 'loss_val': 0.42465930696851734, 'psi': 0.9975478137545604}
[S15] START round=20 head_norm_before_train=1.592310 cos_to_last_merge=0.8148 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.815
[S15] round=20 local utility u=0.073590 metrics={'f1_val': 0.7760522579583401, 'auprc': 0.9878795127235672, 'loss_val': 0.2558120263068575, 'psi': 0.860783159864431}-{'f1_val': 0.7563061509093356, 'auprc': 0.9890778095978738, 'loss_val': 0.28810950382218603, 'psi': 0.8494148143847509}
[S16] START round=20 head_norm_before_train=1.597133 cos_to_last_merge=0.8238 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.824
[S16] round=20 local utility u=0.403480 metrics={'f1_val': 0.8777497465161979, 'auprc': 0.9900861819528737, 'loss_val': 0.24488215560163645, 'psi': 0.9226843206908681}-{'f1_val': 0.8353365887080789, 'auprc': 0.9867681889564907, 'loss_val': 0.7874089581133195, 'psi': 0.8959092288074435}
[S17] START round=20 head_norm_before_train=1.395644 cos_to_last_merge=0.8225 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.823
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.45170351794351765, 'auprc': 0.8718661163200138, 'loss_val': 0.6194026023798006, 'psi': 0.6197685572941161}-{'f1_val': 0.5233724167862345, 'auprc': 0.8663298978641725, 'loss_val': 0.7611423267732736, 'psi': 0.6605554092174097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:54514
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S9
[S7] cosine check vs S9: cos=0.6641
[S13] RECEIVED delta(kind=head bytes=1796) from S7
[S13] cosine check vs S7: cos=-0.1442
[S13] DROPPED delta from S7 (cos=-0.1442 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.9955
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=0.2145
[S14] RECEIVED delta(kind=head bytes=1803) from S4
[S14] cosine check vs S4: cos=0.1518
[S14] RECEIVED delta(kind=head bytes=1795) from S3
[S14] cosine check vs S3: cos=0.8421
[S14] RECEIVED delta(kind=head bytes=1793) from S15
[S14] cosine check vs S15: cos=0.5945
[S7] RECEIVED delta(kind=head bytes=1806) from S14
[S7] cosine check vs S14: cos=0.5204
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.150 → S5@127.0.0.1:54505
[S5] ⇄ pheromone p=0.149 → S3@127.0.0.1:54503
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.6972 head_norm=1.492670
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.121241e-02
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.6965 head_norm=1.498330 delta_norm=0.071212
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.059 → S6@127.0.0.1:54507
[S13] ⇄ pheromone p=0.059 → S10@127.0.0.1:54511
[S10] ⇄ pheromone p=0.142 → S5@127.0.0.1:54505
[S6] ⇄ pheromone p=0.304 → S7@127.0.0.1:54508
[S11] ⇄ pheromone p=0.172 → S2@127.0.0.1:54502
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.6993 head_norm=0.928023
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.403896e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.6993 head_norm=0.968639 delta_norm=0.340390
[S7] aggregate: ACCEPT kept=['S9', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.296 → S13@127.0.0.1:54513
[S3] ⇄ pheromone p=0.056 → S14@127.0.0.1:54514
[S14] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9979 head_norm=1.190505
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.279011e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9977 head_norm=1.019342 delta_norm=0.327901
[S14] aggregate: ACCEPT kept=['S16', 'S4', 'S3', 'S15'] (k=4/4) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.268 → S7@127.0.0.1:54508
[S9] ⇄ pheromone p=0.077 → S7@127.0.0.1:54508
[S16] ⇄ pheromone p=0.200 → S14@127.0.0.1:54514
[S15] ⇄ pheromone p=0.131 → S14@127.0.0.1:54514
[S4] ⇄ pheromone p=0.083 → S14@127.0.0.1:54514
[S17] ⇄ pheromone p=0.219 → S8@127.0.0.1:54509
[S2] START round=21 head_norm_before_train=1.498330 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.161104 metrics={'f1_val': 0.7083625623922465, 'auprc': 0.7894136368482354, 'loss_val': 0.5209853282205572, 'psi': 0.740782992174642}-{'f1_val': 0.6972314585237963, 'auprc': 0.6704388316419592, 'loss_val': 0.4194816835315505, 'psi': 0.6865144077710614}
[S3] START round=21 head_norm_before_train=1.732570 cos_to_last_merge=0.9962 (last merge round=17)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.6362589534869414, 'auprc': 0.8477707038080713, 'loss_val': 0.4055717494641032, 'psi': 0.7208636536153934}-{'f1_val': 0.7006809596653347, 'auprc': 0.9990501995867256, 'loss_val': 0.24189964383915477, 'psi': 0.8200286556338912}
[S4] START round=21 head_norm_before_train=1.863088 (no previous merge yet)
[S4] round=21 local utility u=0.009687 metrics={'f1_val': 0.942363244530626, 'auprc': 0.9545441255860291, 'loss_val': 0.26055297719272325, 'psi': 0.9472355969527873}-{'f1_val': 0.9414460036011022, 'auprc': 0.9508429597778955, 'loss_val': 0.2633194924590552, 'psi': 0.9452047860718196}
[S5] START round=21 head_norm_before_train=1.680839 cos_to_last_merge=0.9988 (last merge round=17)
[S5] round=21 local utility u=1.000000 metrics={'f1_val': 0.6814600513331502, 'auprc': 0.8851746630417714, 'loss_val': 0.36227563347737024, 'psi': 0.7629458960165987}-{'f1_val': 0.45694625052810217, 'auprc': 0.772283271036114, 'loss_val': 0.7140852480444918, 'psi': 0.5830810587313069}
[S6] START round=21 head_norm_before_train=1.665821 (no previous merge yet)
[S6] round=21 local utility u=0.952823 metrics={'f1_val': 0.8247622065956011, 'auprc': 0.9578148109068445, 'loss_val': 0.3188151036899623, 'psi': 0.8779832483200984}-{'f1_val': 0.620847315909473, 'auprc': 0.7985485379257368, 'loss_val': 0.5231735151340702, 'psi': 0.6919278047159785}
[S7] START round=21 head_norm_before_train=0.968639 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.5716914554153396, 'auprc': 0.670604758691503, 'loss_val': 0.7772182582530134, 'psi': 0.611256776725805}-{'f1_val': 0.6992669571907963, 'auprc': 0.9779805305202579, 'loss_val': 0.44620122032719034, 'psi': 0.810752386522581}
[S8] START round=21 head_norm_before_train=1.728694 (no previous merge yet)
[S8] round=21 local utility u=1.000000 metrics={'f1_val': 0.9328821484241535, 'auprc': 0.9988996669098568, 'loss_val': 0.16285337680576453, 'psi': 0.9592891558184348}-{'f1_val': 0.7142391053978291, 'auprc': 0.7940482021985137, 'loss_val': 0.583466496202406, 'psi': 0.7461627441181029}
[S9] START round=21 head_norm_before_train=1.735888 cos_to_last_merge=0.7692 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.769
[S9] round=21 local utility u=0.001241 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9973348959544043, 'loss_val': 0.02314627289824111, 'psi': 0.9972130121660271}-{'f1_val': 0.9971317563071089, 'auprc': 0.9973724493359797, 'loss_val': 0.025740717245355926, 'psi': 0.9972280335186573}
[S10] START round=21 head_norm_before_train=1.648795 cos_to_last_merge=0.9997 (last merge round=19)
[S10] round=21 local utility u=0.017922 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.994902261717062, 'loss_val': 0.12316302169325188, 'psi': 0.9948100702184484}-{'f1_val': 0.9951704237150173, 'auprc': 0.9951453992231678, 'loss_val': 0.16226805711805206, 'psi': 0.9951604139182775}
[S11] START round=21 head_norm_before_train=1.507337 cos_to_last_merge=0.7802 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.780
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.996733463774981, 'loss_val': 0.11107554018964526, 'psi': 0.9965186176554428}-{'f1_val': 0.9967887165093644, 'auprc': 0.9966567104219997, 'loss_val': 0.10810493226895986, 'psi': 0.9967359140744185}
[S13] START round=21 head_norm_before_train=1.626153 (no previous merge yet)
[S13] round=21 local utility u=0.235930 metrics={'f1_val': 0.5770682890461781, 'auprc': 0.6686502653822778, 'loss_val': 0.7224822678384326, 'psi': 0.6137010795806179}-{'f1_val': 0.5674671788723693, 'auprc': 0.5336461497769807, 'loss_val': 0.7317234251054535, 'psi': 0.5539387672342138}
[S14] START round=21 head_norm_before_train=1.019342 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.022723 metrics={'f1_val': 0.9974306056599991, 'auprc': 0.9975257662997119, 'loss_val': 0.29119037963345973, 'psi': 0.9974686699158842}-{'f1_val': 0.9979161758042404, 'auprc': 0.9981707334311563, 'loss_val': 0.34148443434171744, 'psi': 0.9980179988550067}
[S15] START round=21 head_norm_before_train=1.619043 cos_to_last_merge=0.8111 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.811
[S15] round=21 local utility u=0.691862 metrics={'f1_val': 0.978434193309591, 'auprc': 0.9944718352503139, 'loss_val': 0.10615727067920769, 'psi': 0.9848492500858802}-{'f1_val': 0.7760522579583401, 'auprc': 0.9878795127235672, 'loss_val': 0.2558120263068575, 'psi': 0.860783159864431}
[S16] START round=21 head_norm_before_train=1.625100 cos_to_last_merge=0.8216 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.822
[S16] round=21 local utility u=0.100376 metrics={'f1_val': 0.9254077676042398, 'auprc': 0.9927092729797706, 'loss_val': 0.33794792493628084, 'psi': 0.9523283697544521}-{'f1_val': 0.8777497465161979, 'auprc': 0.9900861819528737, 'loss_val': 0.24488215560163645, 'psi': 0.9226843206908681}
[S17] START round=21 head_norm_before_train=1.412292 cos_to_last_merge=0.8216 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.822
[S17] round=21 local utility u=0.015392 metrics={'f1_val': 0.44631575159622927, 'auprc': 0.8771588704039874, 'loss_val': 0.5721695080456064, 'psi': 0.6186529991193326}-{'f1_val': 0.45170351794351765, 'auprc': 0.8718661163200138, 'loss_val': 0.6194026023798006, 'psi': 0.6197685572941161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:54508
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:54507
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S8
[S5] cosine check vs S8: cos=0.9840
[S5] RECEIVED delta(kind=head bytes=1804) from S10
[S5] cosine check vs S10: cos=-0.1248
[S5] DROPPED delta from S10 (cos=-0.1248 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1791) from S2
[S6] cosine check vs S2: cos=-0.0156
[S6] DROPPED delta from S2 (cos=-0.0156 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S13
[S10] cosine check vs S13: cos=0.9858
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=0.2684
[S14] RECEIVED delta(kind=head bytes=1801) from S16
[S14] cosine check vs S16: cos=0.3853
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] cosine check vs S15: cos=0.6869
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=0.9746
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=0.6308
[S7] RECEIVED delta(kind=head bytes=1797) from S9
[S7] cosine check vs S9: cos=0.7991
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] cosine check vs S6: cos=0.3591
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=-0.1058
[S8] DROPPED delta from S17 (cos=-0.1058 < 0.0)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.5717 head_norm=1.001180
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.617214e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.5744 head_norm=0.938804 delta_norm=0.161721
[S7] aggregate: ACCEPT kept=['S14', 'S9', 'S6'] (k=3/3) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.6363 head_norm=1.762846
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.979729e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.6371 head_norm=1.715582 delta_norm=0.197973
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9974 head_norm=1.065862
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.838844e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9974 head_norm=1.004102 delta_norm=0.383884
[S14] aggregate: ACCEPT kept=['S4', 'S16', 'S15'] (k=3/3) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.9947 head_norm=1.680629
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.416606e-01
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.9947 head_norm=1.652920 delta_norm=0.141661
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.6815 head_norm=1.690327
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.555349e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.6982 head_norm=1.709623 delta_norm=0.155535
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.522865 cos_to_last_merge=0.9996 (last merge round=20)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.623483242632017, 'auprc': 0.6320518475887256, 'loss_val': 0.6898024957250488, 'psi': 0.6269106846147005}-{'f1_val': 0.7083625623922465, 'auprc': 0.7894136368482354, 'loss_val': 0.5209853282205572, 'psi': 0.740782992174642}
[S3] START round=22 head_norm_before_train=1.715582 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.5507785226435808, 'auprc': 0.8123778036226806, 'loss_val': 0.5789106778104371, 'psi': 0.6554182350352208}-{'f1_val': 0.6362589534869414, 'auprc': 0.8477707038080713, 'loss_val': 0.4055717494641032, 'psi': 0.7208636536153934}
[S4] START round=22 head_norm_before_train=1.880888 (no previous merge yet)
[S4] round=22 local utility u=0.002918 metrics={'f1_val': 0.9429636161196484, 'auprc': 0.9555868467056309, 'loss_val': 0.26144677550812984, 'psi': 0.9480129083540414}-{'f1_val': 0.942363244530626, 'auprc': 0.9545441255860291, 'loss_val': 0.26055297719272325, 'psi': 0.9472355969527873}
[S5] START round=22 head_norm_before_train=1.709623 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.7129120959302153, 'loss_val': 0.35331115630892257, 'psi': 0.7054089842006471}-{'f1_val': 0.6814600513331502, 'auprc': 0.8851746630417714, 'loss_val': 0.36227563347737024, 'psi': 0.7629458960165987}
[S6] START round=22 head_norm_before_train=1.681287 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.8236828613255367, 'auprc': 0.8551328182810477, 'loss_val': 0.4100716711262267, 'psi': 0.8362628441077411}-{'f1_val': 0.8247622065956011, 'auprc': 0.9578148109068445, 'loss_val': 0.3188151036899623, 'psi': 0.8779832483200984}
[S7] START round=22 head_norm_before_train=0.938804 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.5238649298584152, 'auprc': 0.6980275505481881, 'loss_val': 0.9155612858511587, 'psi': 0.5935299781343244}-{'f1_val': 0.5716914554153396, 'auprc': 0.670604758691503, 'loss_val': 0.7772182582530134, 'psi': 0.611256776725805}
[S8] START round=22 head_norm_before_train=1.742640 (no previous merge yet)
[S8] round=22 local utility u=0.219997 metrics={'f1_val': 0.9936297631890177, 'auprc': 0.9933524650149249, 'loss_val': 0.07070388295797152, 'psi': 0.9935188439193806}-{'f1_val': 0.9328821484241535, 'auprc': 0.9988996669098568, 'loss_val': 0.16285337680576453, 'psi': 0.9592891558184348}
[S9] START round=22 head_norm_before_train=1.758764 cos_to_last_merge=0.7669 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.767
[S9] round=22 local utility u=0.004961 metrics={'f1_val': 0.9975426610709598, 'auprc': 0.9992240914377507, 'loss_val': 0.02135798854149735, 'psi': 0.9982152332176761}-{'f1_val': 0.9971317563071089, 'auprc': 0.9973348959544043, 'loss_val': 0.02314627289824111, 'psi': 0.9972130121660271}
[S10] START round=22 head_norm_before_train=1.652920 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.009629 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9971279107148958, 'loss_val': 0.10531615494880715, 'psi': 0.9951737919162853}-{'f1_val': 0.9947486092193725, 'auprc': 0.994902261717062, 'loss_val': 0.12316302169325188, 'psi': 0.9948100702184484}
[S11] START round=22 head_norm_before_train=1.544113 cos_to_last_merge=0.7745 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.775
[S11] round=22 local utility u=0.017870 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9966105672461794, 'loss_val': 0.07599732586091816, 'psi': 0.9965724296066255}-{'f1_val': 0.9963753869090841, 'auprc': 0.996733463774981, 'loss_val': 0.11107554018964526, 'psi': 0.9965186176554428}
[S13] START round=22 head_norm_before_train=1.637044 (no previous merge yet)
[S13] round=22 local utility u=0.074662 metrics={'f1_val': 0.6098814880176043, 'auprc': 0.615449867173552, 'loss_val': 0.6104364374020634, 'psi': 0.6121088396799834}-{'f1_val': 0.5770682890461781, 'auprc': 0.6686502653822778, 'loss_val': 0.7224822678384326, 'psi': 0.6137010795806179}
[S14] START round=22 head_norm_before_train=1.004102 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.013802 metrics={'f1_val': 0.9968189060544872, 'auprc': 0.9952252992863916, 'loss_val': 0.25301497293824327, 'psi': 0.996181463347249}-{'f1_val': 0.9974306056599991, 'auprc': 0.9975257662997119, 'loss_val': 0.29119037963345973, 'psi': 0.9974686699158842}
[S15] START round=22 head_norm_before_train=1.645024 cos_to_last_merge=0.8076 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.808
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7251701002562786, 'auprc': 0.9861758429408849, 'loss_val': 0.3989003996845486, 'psi': 0.8295723973301211}-{'f1_val': 0.978434193309591, 'auprc': 0.9944718352503139, 'loss_val': 0.10615727067920769, 'psi': 0.9848492500858802}
[S16] START round=22 head_norm_before_train=1.646389 cos_to_last_merge=0.8205 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.820
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8689236416443533, 'auprc': 0.9913370914962347, 'loss_val': 0.5898179562609223, 'psi': 0.9178890215851059}-{'f1_val': 0.9254077676042398, 'auprc': 0.9927092729797706, 'loss_val': 0.33794792493628084, 'psi': 0.9523283697544521}
[S17] START round=22 head_norm_before_train=1.428322 cos_to_last_merge=0.8210 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.42128907555931516, 'auprc': 0.8725187859438293, 'loss_val': 0.6087963327468575, 'psi': 0.6017809597131208}-{'f1_val': 0.44631575159622927, 'auprc': 0.8771588704039874, 'loss_val': 0.5721695080456064, 'psi': 0.6186529991193326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:54505
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:54511
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:54514
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:54505
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.6340
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] cosine check vs S11: cos=0.9930
[S5] RECEIVED delta(kind=head bytes=1802) from S8
[S5] cosine check vs S8: cos=0.9942
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=-0.1290
[S5] DROPPED delta from S10 (cos=-0.1290 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S13
[S10] cosine check vs S13: cos=0.9926
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] cosine check vs S4: cos=0.3864
[S7] RECEIVED delta(kind=head bytes=1804) from S9
[S7] cosine check vs S9: cos=0.7271
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.5239 head_norm=0.989188
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.656102e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.5193 head_norm=1.020165 delta_norm=0.265610
[S7] aggregate: ACCEPT kept=['S14', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.6235 head_norm=1.545690
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.409580e-02
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.5709 head_norm=1.561159 delta_norm=0.094096
[S2] aggregate: ROLLBACK (f1_val pre=0.623 post=0.571 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7004 head_norm=1.727586
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.479528e-02
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7004 head_norm=1.738387 delta_norm=0.094795
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9968 head_norm=1.055795
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.908758e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9981 head_norm=1.252496 delta_norm=0.890876
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9939 head_norm=1.681996
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.029125e-01
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9939 head_norm=1.661278 delta_norm=0.102912
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.561159 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.544579 metrics={'f1_val': 0.7140416624308487, 'auprc': 0.7701854160237583, 'loss_val': 0.5583947408315654, 'psi': 0.7364991638680125}-{'f1_val': 0.623483242632017, 'auprc': 0.6320518475887256, 'loss_val': 0.6898024957250488, 'psi': 0.6269106846147005}
[S3] START round=23 head_norm_before_train=1.749239 cos_to_last_merge=0.9995 (last merge round=21)
[S3] round=23 local utility u=1.000000 metrics={'f1_val': 0.9919703715347346, 'auprc': 0.9991779753751988, 'loss_val': 0.16244928440432507, 'psi': 0.9948534130709202}-{'f1_val': 0.5507785226435808, 'auprc': 0.8123778036226806, 'loss_val': 0.5789106778104371, 'psi': 0.6554182350352208}
[S4] START round=23 head_norm_before_train=1.900028 (no previous merge yet)
[S4] round=23 local utility u=0.047475 metrics={'f1_val': 0.9487714382407305, 'auprc': 0.975217366589307, 'loss_val': 0.2602353839078799, 'psi': 0.9593498095801611}-{'f1_val': 0.9429636161196484, 'auprc': 0.9555868467056309, 'loss_val': 0.26144677550812984, 'psi': 0.9480129083540414}
[S5] START round=23 head_norm_before_train=1.738387 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.083427 metrics={'f1_val': 0.6942971329876401, 'auprc': 0.7848029245847138, 'loss_val': 0.3654716471346607, 'psi': 0.7304994496264696}-{'f1_val': 0.7004069097142683, 'auprc': 0.7129120959302153, 'loss_val': 0.35331115630892257, 'psi': 0.7054089842006471}
[S6] START round=23 head_norm_before_train=1.697312 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.8194078787655195, 'auprc': 0.8211454533674736, 'loss_val': 0.4471244279308739, 'psi': 0.8201029086063011}-{'f1_val': 0.8236828613255367, 'auprc': 0.8551328182810477, 'loss_val': 0.4100716711262267, 'psi': 0.8362628441077411}
[S7] START round=23 head_norm_before_train=1.020165 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.267222 metrics={'f1_val': 0.5524041289662823, 'auprc': 0.7960100396415535, 'loss_val': 0.8462999035629575, 'psi': 0.6498464932363908}-{'f1_val': 0.5238649298584152, 'auprc': 0.6980275505481881, 'loss_val': 0.9155612858511587, 'psi': 0.5935299781343244}
[S8] START round=23 head_norm_before_train=1.754252 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.7141743438394846, 'auprc': 0.9870395458454043, 'loss_val': 0.17763057755615147, 'psi': 0.8233204246418525}-{'f1_val': 0.9936297631890177, 'auprc': 0.9933524650149249, 'loss_val': 0.07070388295797152, 'psi': 0.9935188439193806}
[S9] START round=23 head_norm_before_train=1.777360 cos_to_last_merge=0.7653 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.765
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9973399240166726, 'loss_val': 0.020850904067316173, 'psi': 0.9972150233909345}-{'f1_val': 0.9975426610709598, 'auprc': 0.9992240914377507, 'loss_val': 0.02135798854149735, 'psi': 0.9982152332176761}
[S10] START round=23 head_norm_before_train=1.661278 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.004453 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9967403055224744, 'loss_val': 0.10051184773410018, 'psi': 0.9955452877406132}-{'f1_val': 0.993871046050545, 'auprc': 0.9971279107148958, 'loss_val': 0.10531615494880715, 'psi': 0.9951737919162853}
[S11] START round=23 head_norm_before_train=1.582081 cos_to_last_merge=0.7688 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.769
[S11] round=23 local utility u=0.006623 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9966962789930165, 'loss_val': 0.06445802179147855, 'psi': 0.9967517415028253}-{'f1_val': 0.9965470045135896, 'auprc': 0.9966105672461794, 'loss_val': 0.07599732586091816, 'psi': 0.9965724296066255}
[S13] START round=23 head_norm_before_train=1.646741 (no previous merge yet)
[S13] round=23 local utility u=0.098686 metrics={'f1_val': 0.6173486058942088, 'auprc': 0.667940935851578, 'loss_val': 0.6153410851010057, 'psi': 0.6375855378771564}-{'f1_val': 0.6098814880176043, 'auprc': 0.615449867173552, 'loss_val': 0.6104364374020634, 'psi': 0.6121088396799834}
[S14] START round=23 head_norm_before_train=1.252496 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.001961 metrics={'f1_val': 0.9976483782674455, 'auprc': 0.9956709904021879, 'loss_val': 0.25540682440342083, 'psi': 0.9968574231213424}-{'f1_val': 0.9968189060544872, 'auprc': 0.9952252992863916, 'loss_val': 0.25301497293824327, 'psi': 0.996181463347249}
[S15] START round=23 head_norm_before_train=1.668473 cos_to_last_merge=0.8046 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.805
[S15] round=23 local utility u=0.586689 metrics={'f1_val': 0.8751166602043053, 'auprc': 0.9936544027122306, 'loss_val': 0.14763809835114838, 'psi': 0.9225317572074755}-{'f1_val': 0.7251701002562786, 'auprc': 0.9861758429408849, 'loss_val': 0.3989003996845486, 'psi': 0.8295723973301211}
[S16] START round=23 head_norm_before_train=1.666169 cos_to_last_merge=0.8194 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.819
[S16] round=23 local utility u=0.331180 metrics={'f1_val': 0.9327430418338265, 'auprc': 0.9952376378442356, 'loss_val': 0.3220761546950908, 'psi': 0.9577408802379902}-{'f1_val': 0.8689236416443533, 'auprc': 0.9913370914962347, 'loss_val': 0.5898179562609223, 'psi': 0.9178890215851059}
[S17] START round=23 head_norm_before_train=1.447784 cos_to_last_merge=0.8209 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=23 local utility u=0.764033 metrics={'f1_val': 0.7187323072341866, 'auprc': 0.8067680467616852, 'loss_val': 0.6681368257780114, 'psi': 0.753946603045186}-{'f1_val': 0.42128907555931516, 'auprc': 0.8725187859438293, 'loss_val': 0.6087963327468575, 'psi': 0.6017809597131208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:54503
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:54511
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=0.9956
[S14] RECEIVED delta(kind=head bytes=1792) from S3
[S14] cosine check vs S3: cos=0.1296
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.4450
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=0.9083
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.4064
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] cosine check vs S5: cos=0.9752
[S13] RECEIVED delta(kind=head bytes=1791) from S7
[S13] cosine check vs S7: cos=-0.1258
[S13] DROPPED delta from S7 (cos=-0.1258 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S16
[S14] cosine check vs S16: cos=0.1668
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=-0.1309
[S5] DROPPED delta from S10 (cos=-0.1309 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1792) from S2
[S6] cosine check vs S2: cos=-0.0194
[S6] DROPPED delta from S2 (cos=-0.0194 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=0.9964
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] cosine check vs S17: cos=-0.1047
[S8] DROPPED delta from S17 (cos=-0.1047 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.7140 head_norm=1.579310
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.071787e-02
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.7139 head_norm=1.596567 delta_norm=0.070718
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.5524 head_norm=1.054856
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.274426e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.5487 head_norm=1.000932 delta_norm=0.627443
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.9920 head_norm=1.777268
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.970352e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.9953 head_norm=1.754591 delta_norm=0.197035
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9976 head_norm=1.295521
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.575572e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9956 head_norm=1.048935 delta_norm=0.457557
[S14] aggregate: ACCEPT kept=['S3', 'S4', 'S15', 'S16'] (k=4/4) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9947 head_norm=1.692677
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.053082e-02
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9947 head_norm=1.672829 delta_norm=0.080531
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.596567 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.719867144865221, 'auprc': 0.7623599963359632, 'loss_val': 0.5940802423350732, 'psi': 0.7368642854535179}-{'f1_val': 0.7140416624308487, 'auprc': 0.7701854160237583, 'loss_val': 0.5583947408315654, 'psi': 0.7364991638680125}
[S3] START round=24 head_norm_before_train=1.754591 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.023769 metrics={'f1_val': 0.9973750180472613, 'auprc': 0.9992177426433246, 'loss_val': 0.14745910828703968, 'psi': 0.9981121078856866}-{'f1_val': 0.9919703715347346, 'auprc': 0.9991779753751988, 'loss_val': 0.16244928440432507, 'psi': 0.9948534130709202}
[S4] START round=24 head_norm_before_train=1.915478 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9439238169133107, 'auprc': 0.9539876031498792, 'loss_val': 0.2588636853034442, 'psi': 0.9479493314079381}-{'f1_val': 0.9487714382407305, 'auprc': 0.975217366589307, 'loss_val': 0.2602353839078799, 'psi': 0.9593498095801611}
[S5] START round=24 head_norm_before_train=1.753893 cos_to_last_merge=0.9997 (last merge round=22)
[S5] round=24 local utility u=0.425592 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9969968585749523, 'loss_val': 0.18701547106194327, 'psi': 0.8189915338903292}-{'f1_val': 0.6942971329876401, 'auprc': 0.7848029245847138, 'loss_val': 0.3654716471346607, 'psi': 0.7304994496264696}
[S6] START round=24 head_norm_before_train=1.711250 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.5959801826499779, 'auprc': 0.7784345628906046, 'loss_val': 0.7897931761729328, 'psi': 0.6689619347462286}-{'f1_val': 0.8194078787655195, 'auprc': 0.8211454533674736, 'loss_val': 0.4471244279308739, 'psi': 0.8201029086063011}
[S7] START round=24 head_norm_before_train=1.000932 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5516844099869476, 'auprc': 0.6644985293410319, 'loss_val': 0.8649811608883351, 'psi': 0.5968100577285813}-{'f1_val': 0.5524041289662823, 'auprc': 0.7960100396415535, 'loss_val': 0.8462999035629575, 'psi': 0.6498464932363908}
[S8] START round=24 head_norm_before_train=1.770901 (no previous merge yet)
[S8] round=24 local utility u=0.904256 metrics={'f1_val': 0.9902890463068262, 'auprc': 0.9989704881030169, 'loss_val': 0.061599124257419494, 'psi': 0.9937616230253026}-{'f1_val': 0.7141743438394846, 'auprc': 0.9870395458454043, 'loss_val': 0.17763057755615147, 'psi': 0.8233204246418525}
[S9] START round=24 head_norm_before_train=1.797009 cos_to_last_merge=0.7634 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.763
[S9] round=24 local utility u=0.003098 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9992077848526184, 'loss_val': 0.020085976510511208, 'psi': 0.997944861448333}-{'f1_val': 0.9971317563071089, 'auprc': 0.9973399240166726, 'loss_val': 0.020850904067316173, 'psi': 0.9972150233909345}
[S10] START round=24 head_norm_before_train=1.672829 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.004914 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9961582490865852, 'loss_val': 0.08893832174736845, 'psi': 0.9953124651662576}-{'f1_val': 0.9947486092193725, 'auprc': 0.9967403055224744, 'loss_val': 0.10051184773410018, 'psi': 0.9955452877406132}
[S11] START round=24 head_norm_before_train=1.616735 cos_to_last_merge=0.7640 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.764
[S11] round=24 local utility u=0.005396 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9967359885866609, 'loss_val': 0.05233407827156646, 'psi': 0.9966225981428181}-{'f1_val': 0.9967887165093644, 'auprc': 0.9966962789930165, 'loss_val': 0.06445802179147855, 'psi': 0.9967517415028253}
[S13] START round=24 head_norm_before_train=1.656663 (no previous merge yet)
[S13] round=24 local utility u=0.023068 metrics={'f1_val': 0.6224469829511019, 'auprc': 0.6695646743386994, 'loss_val': 0.6046667628222259, 'psi': 0.6412940595061409}-{'f1_val': 0.6173486058942088, 'auprc': 0.667940935851578, 'loss_val': 0.6153410851010057, 'psi': 0.6375855378771564}
[S14] START round=24 head_norm_before_train=1.048935 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.018943 metrics={'f1_val': 0.9969910436891155, 'auprc': 0.9967917016196521, 'loss_val': 0.21693976353617467, 'psi': 0.9969113068613302}-{'f1_val': 0.9976483782674455, 'auprc': 0.9956709904021879, 'loss_val': 0.25540682440342083, 'psi': 0.9968574231213424}
[S15] START round=24 head_norm_before_train=1.689601 cos_to_last_merge=0.8019 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.802
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7515090866199887, 'auprc': 0.9893103628422166, 'loss_val': 0.38980859695548464, 'psi': 0.84662959710888}-{'f1_val': 0.8751166602043053, 'auprc': 0.9936544027122306, 'loss_val': 0.14763809835114838, 'psi': 0.9225317572074755}
[S16] START round=24 head_norm_before_train=1.684228 cos_to_last_merge=0.8183 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.818
[S16] round=24 local utility u=0.312033 metrics={'f1_val': 0.9913147558668051, 'auprc': 0.99579969853743, 'loss_val': 0.05112607789497834, 'psi': 0.9931087329350551}-{'f1_val': 0.9327430418338265, 'auprc': 0.9952376378442356, 'loss_val': 0.3220761546950908, 'psi': 0.9577408802379902}
[S17] START round=24 head_norm_before_train=1.468341 cos_to_last_merge=0.8209 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=24 local utility u=0.338028 metrics={'f1_val': 0.7938648631650436, 'auprc': 0.8681198425417501, 'loss_val': 0.6269308154835839, 'psi': 0.8235668549157262}-{'f1_val': 0.7187323072341866, 'auprc': 0.8067680467616852, 'loss_val': 0.6681368257780114, 'psi': 0.753946603045186}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:54502
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:54508
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:54514
[S14] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1792) from S14
[S7] cosine check vs S14: cos=0.8984
[S7] RECEIVED delta(kind=head bytes=1801) from S9
[S7] cosine check vs S9: cos=0.5271
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=0.9978
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] cosine check vs S8: cos=0.9951
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] cosine check vs S10: cos=-0.1323
[S5] DROPPED delta from S10 (cos=-0.1323 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=0.9966
[S14] RECEIVED delta(kind=head bytes=1796) from S3
[S14] cosine check vs S3: cos=0.3228
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=0.3606
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] cosine check vs S5: cos=0.9930
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1806 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1806) from S17
[S8] cosine check vs S17: cos=-0.1046
[S8] DROPPED delta from S17 (cos=-0.1046 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.7199 head_norm=1.615461
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.609169e-02
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.7199 head_norm=1.629261 delta_norm=0.056092
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.5517 head_norm=1.034705
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.897475e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.5508 head_norm=1.044988 delta_norm=0.289748
[S7] aggregate: ACCEPT kept=['S14', 'S9'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.7003 head_norm=1.770271
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.788221e-02
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7003 head_norm=1.775026 delta_norm=0.087882
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.9974 head_norm=1.778393
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.052283e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.9974 head_norm=1.771214 delta_norm=0.105228
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9970 head_norm=1.104116
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.126514e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9953 head_norm=1.015500 delta_norm=0.612651
[S14] aggregate: ACCEPT kept=['S3', 'S16'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=24 metric=0.9947 head_norm=1.708638
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.224984e-02
[S10] stored merged vector for next round verification (round=24)
[S10] DEBUG after merge:  round=24 metric=0.9947 head_norm=1.686854 delta_norm=0.072250
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.629261 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.7191020815943959, 'auprc': 0.7436336301866882, 'loss_val': 0.5946236294554401, 'psi': 0.7289147010313128}-{'f1_val': 0.719867144865221, 'auprc': 0.7623599963359632, 'loss_val': 0.5940802423350732, 'psi': 0.7368642854535179}
[S3] START round=25 head_norm_before_train=1.771214 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.7672990679481252, 'auprc': 0.8163388248591226, 'loss_val': 0.45764486044158964, 'psi': 0.7869149707125241}-{'f1_val': 0.9973750180472613, 'auprc': 0.9992177426433246, 'loss_val': 0.14745910828703968, 'psi': 0.9981121078856866}
[S4] START round=25 head_norm_before_train=1.917579 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9417996131630435, 'auprc': 0.948029762077933, 'loss_val': 0.25815798957833175, 'psi': 0.9442916727289994}-{'f1_val': 0.9439238169133107, 'auprc': 0.9539876031498792, 'loss_val': 0.2588636853034442, 'psi': 0.9479493314079381}
[S5] START round=25 head_norm_before_train=1.775026 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.996594918051959, 'loss_val': 0.18725044455803713, 'psi': 0.8188307576811318}-{'f1_val': 0.7003213174339138, 'auprc': 0.9969968585749523, 'loss_val': 0.18701547106194327, 'psi': 0.8189915338903292}
[S6] START round=25 head_norm_before_train=1.721782 (no previous merge yet)
[S6] round=25 local utility u=1.000000 metrics={'f1_val': 0.9242799300840878, 'auprc': 0.9696329349431904, 'loss_val': 0.2201023126056461, 'psi': 0.9424211320277288}-{'f1_val': 0.5959801826499779, 'auprc': 0.7784345628906046, 'loss_val': 0.7897931761729328, 'psi': 0.6689619347462286}
[S7] START round=25 head_norm_before_train=1.044988 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.228597 metrics={'f1_val': 0.5536403231533235, 'auprc': 0.799444296611581, 'loss_val': 0.8243605354393928, 'psi': 0.6519619125366265}-{'f1_val': 0.5516844099869476, 'auprc': 0.6644985293410319, 'loss_val': 0.8649811608883351, 'psi': 0.5968100577285813}
[S8] START round=25 head_norm_before_train=1.784102 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9936217179912127, 'auprc': 0.9888685539796341, 'loss_val': 0.06632587739212535, 'psi': 0.9917204523865812}-{'f1_val': 0.9902890463068262, 'auprc': 0.9989704881030169, 'loss_val': 0.061599124257419494, 'psi': 0.9937616230253026}
[S9] START round=25 head_norm_before_train=1.814795 cos_to_last_merge=0.7618 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.762
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9966857875385419, 'auprc': 0.999216030936967, 'loss_val': 0.01916620749394278, 'psi': 0.9976978848979119}-{'f1_val': 0.9971029125121428, 'auprc': 0.9992077848526184, 'loss_val': 0.020085976510511208, 'psi': 0.997944861448333}
[S10] START round=25 head_norm_before_train=1.686854 cos_to_last_merge=1.0000 (last merge round=24)
[S10] round=25 local utility u=0.007306 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9973362236015036, 'loss_val': 0.07786049395725478, 'psi': 0.995783654972225}-{'f1_val': 0.9947486092193725, 'auprc': 0.9961582490865852, 'loss_val': 0.08893832174736845, 'psi': 0.9953124651662576}
[S11] START round=25 head_norm_before_train=1.644858 cos_to_last_merge=0.7600 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.760
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9967143242667372, 'loss_val': 0.06577869592858854, 'psi': 0.9965232420251614}-{'f1_val': 0.9965470045135896, 'auprc': 0.9967359885866609, 'loss_val': 0.05233407827156646, 'psi': 0.9966225981428181}
[S13] START round=25 head_norm_before_train=1.667918 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6092485695907449, 'auprc': 0.6717187363590043, 'loss_val': 0.6849526813414735, 'psi': 0.6342366362980486}-{'f1_val': 0.6224469829511019, 'auprc': 0.6695646743386994, 'loss_val': 0.6046667628222259, 'psi': 0.6412940595061409}
[S14] START round=25 head_norm_before_train=1.015500 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9971242345601592, 'loss_val': 0.23991880484878128, 'psi': 0.997294655525099}-{'f1_val': 0.9969910436891155, 'auprc': 0.9967917016196521, 'loss_val': 0.21693976353617467, 'psi': 0.9969113068613302}
[S15] START round=25 head_norm_before_train=1.710526 cos_to_last_merge=0.7994 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.799
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.7327867370885399, 'auprc': 0.9873484800435819, 'loss_val': 0.40884074794899256, 'psi': 0.8346114342705567}-{'f1_val': 0.7515090866199887, 'auprc': 0.9893103628422166, 'loss_val': 0.38980859695548464, 'psi': 0.84662959710888}
[S16] START round=25 head_norm_before_train=1.702755 cos_to_last_merge=0.8176 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.818
[S16] round=25 local utility u=0.001033 metrics={'f1_val': 0.9920139700014868, 'auprc': 0.9936530642686145, 'loss_val': 0.04681539254126029, 'psi': 0.9926696077083379}-{'f1_val': 0.9913147558668051, 'auprc': 0.99579969853743, 'loss_val': 0.05112607789497834, 'psi': 0.9931087329350551}
[S17] START round=25 head_norm_before_train=1.489442 cos_to_last_merge=0.8210 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.7117962705351666, 'auprc': 0.8711817804215976, 'loss_val': 0.5741626574949636, 'psi': 0.775550474489739}-{'f1_val': 0.7938648631650436, 'auprc': 0.8681198425417501, 'loss_val': 0.6269308154835839, 'psi': 0.8235668549157262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:54513
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:54505
[S16] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S7
[S13] cosine check vs S7: cos=-0.1182
[S13] DROPPED delta from S7 (cos=-0.1182 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=-0.1318
[S5] DROPPED delta from S10 (cos=-0.1318 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=0.6283
[S7] RECEIVED delta(kind=head bytes=1804) from S6
[S7] cosine check vs S6: cos=0.1751
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.102 → S6@127.0.0.1:54507
[S9] ⇄ pheromone p=0.026 → S7@127.0.0.1:54508
[S8] ⇄ pheromone p=0.298 → S5@127.0.0.1:54505
[S5] ⇄ pheromone p=0.210 → S3@127.0.0.1:54503
[S13] ⇄ pheromone p=0.063 → S10@127.0.0.1:54511
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9974 head_norm=1.069216
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.681397e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9974 head_norm=1.264973 delta_norm=0.668140
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.095 → S7@127.0.0.1:54508
[S11] ⇄ pheromone p=0.060 → S2@127.0.0.1:54502
[S4] ⇄ pheromone p=0.034 → S14@127.0.0.1:54514
[S3] ⇄ pheromone p=0.150 → S14@127.0.0.1:54514
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.5536 head_norm=1.085883
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.375267e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.5689 head_norm=1.099108 delta_norm=0.937527
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.177 → S13@127.0.0.1:54513
[S10] ⇄ pheromone p=0.052 → S5@127.0.0.1:54505
[S16] ⇄ pheromone p=0.166 → S14@127.0.0.1:54514
[S6] ⇄ pheromone p=0.378 → S7@127.0.0.1:54508
[S17] ⇄ pheromone p=0.225 → S8@127.0.0.1:54509
[S15] ⇄ pheromone p=0.175 → S14@127.0.0.1:54514
[S2] START round=26 head_norm_before_train=1.644397 cos_to_last_merge=0.9998 (last merge round=24)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.5552929408362575, 'auprc': 0.5263404772657383, 'loss_val': 1.3817238553665792, 'psi': 0.5437119554080498}-{'f1_val': 0.7191020815943959, 'auprc': 0.7436336301866882, 'loss_val': 0.5946236294554401, 'psi': 0.7289147010313128}
[S3] START round=26 head_norm_before_train=1.804458 cos_to_last_merge=0.9995 (last merge round=24)
[S3] round=26 local utility u=1.000000 metrics={'f1_val': 0.9793968730791639, 'auprc': 0.9932190115072159, 'loss_val': 0.14292679907137312, 'psi': 0.9849257284503847}-{'f1_val': 0.7672990679481252, 'auprc': 0.8163388248591226, 'loss_val': 0.45764486044158964, 'psi': 0.7869149707125241}
[S4] START round=26 head_norm_before_train=1.920434 (no previous merge yet)
[S4] round=26 local utility u=0.002643 metrics={'f1_val': 0.9414593748933974, 'auprc': 0.9509013397687002, 'loss_val': 0.25944481978332695, 'psi': 0.9452361608435185}-{'f1_val': 0.9417996131630435, 'auprc': 0.948029762077933, 'loss_val': 0.25815798957833175, 'psi': 0.9442916727289994}
[S5] START round=26 head_norm_before_train=1.785806 cos_to_last_merge=0.9999 (last merge round=24)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.6986036828498998, 'auprc': 0.8058525049005482, 'loss_val': 0.35610405868590306, 'psi': 0.7415032116701592}-{'f1_val': 0.7003213174339138, 'auprc': 0.996594918051959, 'loss_val': 0.18725044455803713, 'psi': 0.8188307576811318}
[S6] START round=26 head_norm_before_train=1.730563 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.4497555400655221, 'auprc': 0.7832096910002477, 'loss_val': 1.1310968186843047, 'psi': 0.5831372004394124}-{'f1_val': 0.9242799300840878, 'auprc': 0.9696329349431904, 'loss_val': 0.2201023126056461, 'psi': 0.9424211320277288}
[S7] START round=26 head_norm_before_train=1.099108 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.484225 metrics={'f1_val': 0.6561597511652373, 'auprc': 0.8211838152037862, 'loss_val': 0.5362465021509873, 'psi': 0.722169376780657}-{'f1_val': 0.5536403231533235, 'auprc': 0.799444296611581, 'loss_val': 0.8243605354393928, 'psi': 0.6519619125366265}
[S8] START round=26 head_norm_before_train=1.795631 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9934353142976775, 'auprc': 0.9877638058219872, 'loss_val': 0.07585888248613418, 'psi': 0.9911667109074014}-{'f1_val': 0.9936217179912127, 'auprc': 0.9888685539796341, 'loss_val': 0.06632587739212535, 'psi': 0.9917204523865812}
[S9] START round=26 head_norm_before_train=1.831218 cos_to_last_merge=0.7604 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.760
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9956091063695326, 'loss_val': 0.019643948644756288, 'psi': 0.9965053900550987}-{'f1_val': 0.9966857875385419, 'auprc': 0.999216030936967, 'loss_val': 0.01916620749394278, 'psi': 0.9976978848979119}
[S10] START round=26 head_norm_before_train=1.722643 cos_to_last_merge=0.9993 (last merge round=24)
[S10] round=26 local utility u=0.004164 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9962581405258891, 'loss_val': 0.06761504014309956, 'psi': 0.9954841681294013}-{'f1_val': 0.9947486092193725, 'auprc': 0.9973362236015036, 'loss_val': 0.07786049395725478, 'psi': 0.995783654972225}
[S11] START round=26 head_norm_before_train=1.672456 cos_to_last_merge=0.7563 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.756
[S11] round=26 local utility u=0.008665 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9967266397131151, 'loss_val': 0.04848556491483621, 'psi': 0.9965281682037126}-{'f1_val': 0.9963958538641108, 'auprc': 0.9967143242667372, 'loss_val': 0.06577869592858854, 'psi': 0.9965232420251614}
[S13] START round=26 head_norm_before_train=1.680944 (no previous merge yet)
[S13] round=26 local utility u=0.044775 metrics={'f1_val': 0.6231026466818542, 'auprc': 0.6637010157138304, 'loss_val': 0.6544733502798862, 'psi': 0.6393419942946448}-{'f1_val': 0.6092485695907449, 'auprc': 0.6717187363590043, 'loss_val': 0.6849526813414735, 'psi': 0.6342366362980486}
[S14] START round=26 head_norm_before_train=1.264973 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9929696574742257, 'loss_val': 0.2387485158046257, 'psi': 0.9958795737700213}-{'f1_val': 0.9974082695017256, 'auprc': 0.9971242345601592, 'loss_val': 0.23991880484878128, 'psi': 0.997294655525099}
[S15] START round=26 head_norm_before_train=1.728322 cos_to_last_merge=0.7973 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.797
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.6997174551552718, 'auprc': 0.98895122585881, 'loss_val': 0.46127373602808897, 'psi': 0.8154109634366871}-{'f1_val': 0.7327867370885399, 'auprc': 0.9873484800435819, 'loss_val': 0.40884074794899256, 'psi': 0.8346114342705567}
[S16] START round=26 head_norm_before_train=1.717531 cos_to_last_merge=0.8175 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.818
[S16] round=26 local utility u=0.001090 metrics={'f1_val': 0.9920139700014868, 'auprc': 0.9938120715139722, 'loss_val': 0.045111558028872935, 'psi': 0.992733210606481}-{'f1_val': 0.9920139700014868, 'auprc': 0.9936530642686145, 'loss_val': 0.04681539254126029, 'psi': 0.9926696077083379}
[S17] START round=26 head_norm_before_train=1.509327 cos_to_last_merge=0.8206 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.6936316022214354, 'auprc': 0.7814523434770265, 'loss_val': 0.5772453879532927, 'psi': 0.7287598987236719}-{'f1_val': 0.7117962705351666, 'auprc': 0.8711817804215976, 'loss_val': 0.5741626574949636, 'psi': 0.775550474489739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:54514
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:54514
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:54513
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:54502
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S16
[S14] cosine check vs S16: cos=0.9321
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] cosine check vs S4: cos=0.0999
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9943
[S14] RECEIVED delta(kind=head bytes=1797) from S3
[S14] cosine check vs S3: cos=0.3128
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] cosine check vs S7: cos=-0.1132
[S13] DROPPED delta from S7 (cos=-0.1132 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=0.9974
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=-0.1303
[S5] DROPPED delta from S10 (cos=-0.1303 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=26 metric=0.5553 head_norm=1.657000
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.383914e-02
[S2] stored merged vector for next round verification (round=26)
[S2] DEBUG after merge:  round=26 metric=0.5550 head_norm=1.676219 delta_norm=0.063839
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9978 head_norm=1.305197
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.796210e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9978 head_norm=1.112445 delta_norm=0.379621
[S14] aggregate: ACCEPT kept=['S16', 'S4', 'S3'] (k=3/3) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.9950 head_norm=1.755710
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.714988e-02
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.9950 head_norm=1.721807 delta_norm=0.097150
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.676219 cos_to_last_merge=1.0000 (last merge round=26)
[S2] round=27 local utility u=0.986115 metrics={'f1_val': 0.6721241339613357, 'auprc': 0.7463991739644169, 'loss_val': 0.7706565804412161, 'psi': 0.7018341499625682}-{'f1_val': 0.5552929408362575, 'auprc': 0.5263404772657383, 'loss_val': 1.3817238553665792, 'psi': 0.5437119554080498}
[S3] START round=27 head_norm_before_train=1.841879 cos_to_last_merge=0.9979 (last merge round=24)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.8490552891438948, 'auprc': 0.8647996213450602, 'loss_val': 0.3361026257323619, 'psi': 0.855353022024361}-{'f1_val': 0.9793968730791639, 'auprc': 0.9932190115072159, 'loss_val': 0.14292679907137312, 'psi': 0.9849257284503847}
[S4] START round=27 head_norm_before_train=1.927520 (no previous merge yet)
[S4] round=27 local utility u=0.065537 metrics={'f1_val': 0.951723324509827, 'auprc': 0.9749116300748849, 'loss_val': 0.2619859008744301, 'psi': 0.9609986467358502}-{'f1_val': 0.9414593748933974, 'auprc': 0.9509013397687002, 'loss_val': 0.25944481978332695, 'psi': 0.9452361608435185}
[S5] START round=27 head_norm_before_train=1.794650 cos_to_last_merge=0.9996 (last merge round=24)
[S5] round=27 local utility u=0.243499 metrics={'f1_val': 0.6861563617088126, 'auprc': 0.9659910287483502, 'loss_val': 0.2748380040634174, 'psi': 0.7980902285246276}-{'f1_val': 0.6986036828498998, 'auprc': 0.8058525049005482, 'loss_val': 0.35610405868590306, 'psi': 0.7415032116701592}
[S6] START round=27 head_norm_before_train=1.742688 (no previous merge yet)
[S6] round=27 local utility u=0.835632 metrics={'f1_val': 0.627282426104483, 'auprc': 0.8050693329938609, 'loss_val': 0.5905725902672413, 'psi': 0.6983971888602342}-{'f1_val': 0.4497555400655221, 'auprc': 0.7832096910002477, 'loss_val': 1.1310968186843047, 'psi': 0.5831372004394124}
[S7] START round=27 head_norm_before_train=1.136312 cos_to_last_merge=0.9985 (last merge round=25)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.5930940309888721, 'auprc': 0.7944463791644276, 'loss_val': 0.6996281070077499, 'psi': 0.6736349702590944}-{'f1_val': 0.6561597511652373, 'auprc': 0.8211838152037862, 'loss_val': 0.5362465021509873, 'psi': 0.722169376780657}
[S8] START round=27 head_norm_before_train=1.807293 (no previous merge yet)
[S8] round=27 local utility u=0.028863 metrics={'f1_val': 0.9935879766866298, 'auprc': 0.998406209449032, 'loss_val': 0.05097674973842961, 'psi': 0.9955152697915907}-{'f1_val': 0.9934353142976775, 'auprc': 0.9877638058219872, 'loss_val': 0.07585888248613418, 'psi': 0.9911667109074014}
[S9] START round=27 head_norm_before_train=1.845112 cos_to_last_merge=0.7591 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.759
[S9] round=27 local utility u=0.006856 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.999208904306451, 'loss_val': 0.01919660377252148, 'psi': 0.998191852176627}-{'f1_val': 0.9971029125121428, 'auprc': 0.9956091063695326, 'loss_val': 0.019643948644756288, 'psi': 0.9965053900550987}
[S10] START round=27 head_norm_before_train=1.721807 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.993560617225544, 'auprc': 0.9979237564208081, 'loss_val': 0.06834678817117189, 'psi': 0.9953058729036497}-{'f1_val': 0.9949681865317428, 'auprc': 0.9962581405258891, 'loss_val': 0.06761504014309956, 'psi': 0.9954841681294013}
[S11] START round=27 head_norm_before_train=1.697623 cos_to_last_merge=0.7530 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.753
[S11] round=27 local utility u=0.005020 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.996729889627614, 'loss_val': 0.03833183863937418, 'psi': 0.996517187996496}-{'f1_val': 0.9963958538641108, 'auprc': 0.9967266397131151, 'loss_val': 0.04848556491483621, 'psi': 0.9965281682037126}
[S13] START round=27 head_norm_before_train=1.692807 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6164464103235006, 'auprc': 0.6671897408454492, 'loss_val': 0.6963383155726777, 'psi': 0.63674374253228}-{'f1_val': 0.6231026466818542, 'auprc': 0.6637010157138304, 'loss_val': 0.6544733502798862, 'psi': 0.6393419942946448}
[S14] START round=27 head_norm_before_train=1.112445 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.018611 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9967616876401765, 'loss_val': 0.2129017727580019, 'psi': 0.9973963858364017}-{'f1_val': 0.9978195179672185, 'auprc': 0.9929696574742257, 'loss_val': 0.2387485158046257, 'psi': 0.9958795737700213}
[S15] START round=27 head_norm_before_train=1.742822 cos_to_last_merge=0.7957 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.796
[S15] round=27 local utility u=1.000000 metrics={'f1_val': 0.9816052682156763, 'auprc': 0.9941084180516191, 'loss_val': 0.11008487325783027, 'psi': 0.9866065281500533}-{'f1_val': 0.6997174551552718, 'auprc': 0.98895122585881, 'loss_val': 0.46127373602808897, 'psi': 0.8154109634366871}
[S16] START round=27 head_norm_before_train=1.733623 cos_to_last_merge=0.8171 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.817
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.9912906701717978, 'auprc': 0.9949136616100124, 'loss_val': 0.04478521230283888, 'psi': 0.9927398667470836}-{'f1_val': 0.9920139700014868, 'auprc': 0.9938120715139722, 'loss_val': 0.045111558028872935, 'psi': 0.992733210606481}
[S17] START round=27 head_norm_before_train=1.526171 cos_to_last_merge=0.8205 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.820
[S17] round=27 local utility u=0.017327 metrics={'f1_val': 0.6748401914694664, 'auprc': 0.8202778139460568, 'loss_val': 0.5463199242738404, 'psi': 0.7330152404601026}-{'f1_val': 0.6936316022214354, 'auprc': 0.7814523434770265, 'loss_val': 0.5772453879532927, 'psi': 0.7287598987236719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:54508
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:54507
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.3190
[S7] RECEIVED delta(kind=head bytes=1803) from S6
[S7] cosine check vs S6: cos=0.8561
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.9987
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] cosine check vs S8: cos=0.9954
[S6] RECEIVED delta(kind=head bytes=1793) from S2
[S6] cosine check vs S2: cos=-0.0256
[S6] DROPPED delta from S2 (cos=-0.0256 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=0.2834
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] cosine check vs S15: cos=0.3777
[S3] RECEIVED delta(kind=head bytes=1793) from S5
[S3] cosine check vs S5: cos=0.9893
[S7] RECEIVED delta(kind=head bytes=1798) from S9
[S7] cosine check vs S9: cos=0.4226
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] cosine check vs S17: cos=-0.1049
[S8] DROPPED delta from S17 (cos=-0.1049 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.8491 head_norm=1.876549
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.385201e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.8506 head_norm=1.839818 delta_norm=0.138520
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.5931 head_norm=1.161096
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.462135e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6018 head_norm=1.019186 delta_norm=0.246213
[S7] aggregate: ACCEPT kept=['S14', 'S6', 'S9'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.6721 head_norm=1.688263
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.671770e-02
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.6724 head_norm=1.703776 delta_norm=0.046718
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9978 head_norm=1.159487
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.703401e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9978 head_norm=1.073611 delta_norm=0.670340
[S14] aggregate: ACCEPT kept=['S4', 'S15'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.6862 head_norm=1.812953
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.677957e-02
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.7014 head_norm=1.814514 delta_norm=0.086780
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.703776 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.4788434429374089, 'auprc': 0.5041237617041121, 'loss_val': 1.6500763257668347, 'psi': 0.4889555704440902}-{'f1_val': 0.6721241339613357, 'auprc': 0.7463991739644169, 'loss_val': 0.7706565804412161, 'psi': 0.7018341499625682}
[S3] START round=28 head_norm_before_train=1.839818 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.613276 metrics={'f1_val': 0.9580960370536024, 'auprc': 0.994934865683732, 'loss_val': 0.154201582643169, 'psi': 0.9728315685056542}-{'f1_val': 0.8490552891438948, 'auprc': 0.8647996213450602, 'loss_val': 0.3361026257323619, 'psi': 0.855353022024361}
[S4] START round=28 head_norm_before_train=1.938121 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9495515621568877, 'auprc': 0.963855025357242, 'loss_val': 0.2722702091601074, 'psi': 0.9552729474370294}-{'f1_val': 0.951723324509827, 'auprc': 0.9749116300748849, 'loss_val': 0.2619859008744301, 'psi': 0.9609986467358502}
[S5] START round=28 head_norm_before_train=1.814514 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9133467997514371, 'loss_val': 0.320365493464022, 'psi': 0.7855828657291359}-{'f1_val': 0.6861563617088126, 'auprc': 0.9659910287483502, 'loss_val': 0.2748380040634174, 'psi': 0.7980902285246276}
[S6] START round=28 head_norm_before_train=1.750742 (no previous merge yet)
[S6] round=28 local utility u=1.000000 metrics={'f1_val': 0.9830306836479108, 'auprc': 0.9686978257270529, 'loss_val': 0.12234884014271351, 'psi': 0.9772975404795676}-{'f1_val': 0.627282426104483, 'auprc': 0.8050693329938609, 'loss_val': 0.5905725902672413, 'psi': 0.6983971888602342}
[S7] START round=28 head_norm_before_train=1.019186 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.045356 metrics={'f1_val': 0.606085064054867, 'auprc': 0.7962068033908544, 'loss_val': 0.6921436744727695, 'psi': 0.6821337597892619}-{'f1_val': 0.5930940309888721, 'auprc': 0.7944463791644276, 'loss_val': 0.6996281070077499, 'psi': 0.6736349702590944}
[S8] START round=28 head_norm_before_train=1.820216 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9939974855123931, 'auprc': 0.9977856854515076, 'loss_val': 0.05295223707547901, 'psi': 0.9955127654880389}-{'f1_val': 0.9935879766866298, 'auprc': 0.998406209449032, 'loss_val': 0.05097674973842961, 'psi': 0.9955152697915907}
[S9] START round=28 head_norm_before_train=1.856158 cos_to_last_merge=0.7581 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.758
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9992220499411013, 'loss_val': 0.018326180075365215, 'psi': 0.9979488496999785}-{'f1_val': 0.9975138174234109, 'auprc': 0.999208904306451, 'loss_val': 0.01919660377252148, 'psi': 0.998191852176627}
[S10] START round=28 head_norm_before_train=1.747557 cos_to_last_merge=0.9997 (last merge round=26)
[S10] round=28 local utility u=0.008231 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9979767797374264, 'loss_val': 0.059171593427464496, 'psi': 0.9960398774265941}-{'f1_val': 0.993560617225544, 'auprc': 0.9979237564208081, 'loss_val': 0.06834678817117189, 'psi': 0.9953058729036497}
[S11] START round=28 head_norm_before_train=1.720418 cos_to_last_merge=0.7502 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.750
[S11] round=28 local utility u=0.005111 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9980269398820512, 'loss_val': 0.03448141793519, 'psi': 0.9972840058584391}-{'f1_val': 0.9963753869090841, 'auprc': 0.996729889627614, 'loss_val': 0.03833183863937418, 'psi': 0.996517187996496}
[S13] START round=28 head_norm_before_train=1.705855 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5900360106997555, 'auprc': 0.6823396201758326, 'loss_val': 0.7954840389484544, 'psi': 0.6269574544901864}-{'f1_val': 0.6164464103235006, 'auprc': 0.6671897408454492, 'loss_val': 0.6963383155726777, 'psi': 0.63674374253228}
[S14] START round=28 head_norm_before_train=1.073611 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.030071 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9988416561913865, 'loss_val': 0.16045659249429642, 'psi': 0.9983740823857624}-{'f1_val': 0.9978195179672185, 'auprc': 0.9967616876401765, 'loss_val': 0.2129017727580019, 'psi': 0.9973963858364017}
[S15] START round=28 head_norm_before_train=1.757780 cos_to_last_merge=0.7942 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.794
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.6986175067254696, 'auprc': 0.7345068772920355, 'loss_val': 0.6024388249209078, 'psi': 0.712973254952096}-{'f1_val': 0.9816052682156763, 'auprc': 0.9941084180516191, 'loss_val': 0.11008487325783027, 'psi': 0.9866065281500533}
[S16] START round=28 head_norm_before_train=1.749834 cos_to_last_merge=0.8165 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.816
[S16] round=28 local utility u=0.003278 metrics={'f1_val': 0.9921443652441528, 'auprc': 0.9955587453092574, 'loss_val': 0.04528693478891513, 'psi': 0.9935101172701947}-{'f1_val': 0.9912906701717978, 'auprc': 0.9949136616100124, 'loss_val': 0.04478521230283888, 'psi': 0.9927398667470836}
[S17] START round=28 head_norm_before_train=1.539963 cos_to_last_merge=0.8204 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.820
[S17] round=28 local utility u=1.000000 metrics={'f1_val': 0.8978792229296031, 'auprc': 0.978140064871676, 'loss_val': 0.2534817381558768, 'psi': 0.9299835597064323}-{'f1_val': 0.6748401914694664, 'auprc': 0.8202778139460568, 'loss_val': 0.5463199242738404, 'psi': 0.7330152404601026}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:54514
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S3
[S14] cosine check vs S3: cos=0.3036
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:54502
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=-0.1322
[S5] DROPPED delta from S10 (cos=-0.1322 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:54513
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[S11] sending update (kind=head size=1794 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1794) from S11
[S2] cosine check vs S11: cos=0.9992
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[S7] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] cosine check vs S6: cos=0.7931
[S13] RECEIVED delta(kind=head bytes=1797) from S7
[S13] cosine check vs S7: cos=-0.1180
[S13] DROPPED delta from S7 (cos=-0.1180 < 0.0)
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=0.4829
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=-0.1044
[S8] DROPPED delta from S17 (cos=-0.1044 < 0.0)
[S14] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.5270
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=28 metric=0.4788 head_norm=1.714238
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.751091e-02
[S2] stored merged vector for next round verification (round=28)
[S2] DEBUG after merge:  round=28 metric=0.4781 head_norm=1.728124 delta_norm=0.037511
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.6061 head_norm=1.041765
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.312849e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.6072 head_norm=1.043222 delta_norm=0.231285
[S7] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9981 head_norm=1.129884
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.987431e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9981 head_norm=1.077688 delta_norm=0.598743
[S14] aggregate: ACCEPT kept=['S3', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.728124 cos_to_last_merge=1.0000 (last merge round=28)
[S2] round=29 local utility u=1.000000 metrics={'f1_val': 0.6345959072422809, 'auprc': 0.7500428126690935, 'loss_val': 1.004006007485593, 'psi': 0.6807746694130059}-{'f1_val': 0.4788434429374089, 'auprc': 0.5041237617041121, 'loss_val': 1.6500763257668347, 'psi': 0.4889555704440902}
[S3] START round=29 head_norm_before_train=1.874398 cos_to_last_merge=0.9996 (last merge round=27)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.8985146450522481, 'auprc': 0.9822607521835615, 'loss_val': 0.23049004218452596, 'psi': 0.9320130879047734}-{'f1_val': 0.9580960370536024, 'auprc': 0.994934865683732, 'loss_val': 0.154201582643169, 'psi': 0.9728315685056542}
[S4] START round=29 head_norm_before_train=1.945455 (no previous merge yet)
[S4] round=29 local utility u=0.009525 metrics={'f1_val': 0.9505332865474173, 'auprc': 0.9685168400994081, 'loss_val': 0.2730962115303314, 'psi': 0.9577267079682137}-{'f1_val': 0.9495515621568877, 'auprc': 0.963855025357242, 'loss_val': 0.2722702091601074, 'psi': 0.9552729474370294}
[S5] START round=29 head_norm_before_train=1.834041 cos_to_last_merge=0.9998 (last merge round=27)
[S5] round=29 local utility u=0.756474 metrics={'f1_val': 0.8869936695631062, 'auprc': 0.9939984346583267, 'loss_val': 0.1688934441698345, 'psi': 0.9297955756011944}-{'f1_val': 0.7004069097142683, 'auprc': 0.9133467997514371, 'loss_val': 0.320365493464022, 'psi': 0.7855828657291359}
[S6] START round=29 head_norm_before_train=1.754114 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.6939265796630327, 'auprc': 0.8106473654266819, 'loss_val': 0.6401408127548003, 'psi': 0.7406148939684924}-{'f1_val': 0.9830306836479108, 'auprc': 0.9686978257270529, 'loss_val': 0.12234884014271351, 'psi': 0.9772975404795676}
[S7] START round=29 head_norm_before_train=1.043222 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.214137 metrics={'f1_val': 0.6508574223430744, 'auprc': 0.811719998360215, 'loss_val': 0.5790436250477742, 'psi': 0.7152024527499307}-{'f1_val': 0.606085064054867, 'auprc': 0.7962068033908544, 'loss_val': 0.6921436744727695, 'psi': 0.6821337597892619}
[S8] START round=29 head_norm_before_train=1.831668 (no previous merge yet)
[S8] round=29 local utility u=0.006195 metrics={'f1_val': 0.9940572439116249, 'auprc': 0.9986021674589318, 'loss_val': 0.0433702493311652, 'psi': 0.9958752133305476}-{'f1_val': 0.9939974855123931, 'auprc': 0.9977856854515076, 'loss_val': 0.05295223707547901, 'psi': 0.9955127654880389}
[S9] START round=29 head_norm_before_train=1.869801 cos_to_last_merge=0.7569 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.757
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9973324809256109, 'loss_val': 0.01811248267859686, 'psi': 0.9972120461545098}-{'f1_val': 0.9971000495392299, 'auprc': 0.9992220499411013, 'loss_val': 0.018326180075365215, 'psi': 0.9979488496999785}
[S10] START round=29 head_norm_before_train=1.768645 cos_to_last_merge=0.9992 (last merge round=26)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.995406697268423, 'loss_val': 0.05920381150631043, 'psi': 0.9951435908264149}-{'f1_val': 0.9947486092193725, 'auprc': 0.9979767797374264, 'loss_val': 0.059171593427464496, 'psi': 0.9960398774265941}
[S11] START round=29 head_norm_before_train=1.742708 cos_to_last_merge=0.7476 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.748
[S11] round=29 local utility u=0.001357 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9981648518836951, 'loss_val': 0.0321806162180713, 'psi': 0.9973391706590966}-{'f1_val': 0.9967887165093644, 'auprc': 0.9980269398820512, 'loss_val': 0.03448141793519, 'psi': 0.9972840058584391}
[S13] START round=29 head_norm_before_train=1.717573 (no previous merge yet)
[S13] round=29 local utility u=0.082571 metrics={'f1_val': 0.6107503799233458, 'auprc': 0.6426119264845254, 'loss_val': 0.635444857914509, 'psi': 0.6234949985478175}-{'f1_val': 0.5900360106997555, 'auprc': 0.6823396201758326, 'loss_val': 0.7954840389484544, 'psi': 0.6269574544901864}
[S14] START round=29 head_norm_before_train=1.077688 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9964034173396682, 'auprc': 0.9979646268625603, 'loss_val': 0.18219964765521496, 'psi': 0.997027901148825}-{'f1_val': 0.9980623665153463, 'auprc': 0.9988416561913865, 'loss_val': 0.16045659249429642, 'psi': 0.9983740823857624}
[S15] START round=29 head_norm_before_train=1.769814 cos_to_last_merge=0.7930 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.793
[S15] round=29 local utility u=1.000000 metrics={'f1_val': 0.9879829105476896, 'auprc': 0.9982157827256066, 'loss_val': 0.057219051930465066, 'psi': 0.9920760594188563}-{'f1_val': 0.6986175067254696, 'auprc': 0.7345068772920355, 'loss_val': 0.6024388249209078, 'psi': 0.712973254952096}
[S16] START round=29 head_norm_before_train=1.764758 cos_to_last_merge=0.8161 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.816
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.9893012139614793, 'auprc': 0.9961765568400403, 'loss_val': 0.055427523789586, 'psi': 0.9920513511129037}-{'f1_val': 0.9921443652441528, 'auprc': 0.9955587453092574, 'loss_val': 0.04528693478891513, 'psi': 0.9935101172701947}
[S17] START round=29 head_norm_before_train=1.555358 cos_to_last_merge=0.8199 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.820
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.6192358811254127, 'auprc': 0.7998524802481096, 'loss_val': 0.6622290131854432, 'psi': 0.6914825207744915}-{'f1_val': 0.8978792229296031, 'auprc': 0.978140064871676, 'loss_val': 0.2534817381558768, 'psi': 0.9299835597064323}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:54502
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:54511
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:54514
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S7
[S13] cosine check vs S7: cos=-0.1150
[S13] DROPPED delta from S7 (cos=-0.1150 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=0.9995
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] cosine check vs S8: cos=0.9966
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=0.9923
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=0.9921
[S14] RECEIVED delta(kind=head bytes=1805) from S4
[S14] cosine check vs S4: cos=0.2824
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:54514
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:54507
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] cosine check vs S15: cos=0.5128
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] cosine check vs S2: cos=-0.0272
[S6] DROPPED delta from S2 (cos=-0.0272 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.8985 head_norm=1.900503
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.208265e-01
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.9014 head_norm=1.869732 delta_norm=0.120826
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=29 metric=0.6346 head_norm=1.735233
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.180169e-02
[S2] stored merged vector for next round verification (round=29)
[S2] DEBUG after merge:  round=29 metric=0.6346 head_norm=1.749165 delta_norm=0.031802
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=29 metric=0.9950 head_norm=1.791512
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.139971e-01
[S10] stored merged vector for next round verification (round=29)
[S10] DEBUG after merge:  round=29 metric=0.9950 head_norm=1.754207 delta_norm=0.113997
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.8870 head_norm=1.846370
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.623268e-02
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.8765 head_norm=1.844862 delta_norm=0.076233
[S5] aggregate: ROLLBACK (f1_val pre=0.887 post=0.877 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9964 head_norm=1.125832
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.155860e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9956 head_norm=1.096593 delta_norm=0.615586
[S14] aggregate: ACCEPT kept=['S4', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.749165 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.566474717698976, 'auprc': 0.6186174700804854, 'loss_val': 1.2342388884485949, 'psi': 0.5873318186515797}-{'f1_val': 0.6345959072422809, 'auprc': 0.7500428126690935, 'loss_val': 1.004006007485593, 'psi': 0.6807746694130059}
[S3] START round=30 head_norm_before_train=1.869732 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.7923212085981233, 'auprc': 0.846616478011571, 'loss_val': 0.4062503456947791, 'psi': 0.8140393163635024}-{'f1_val': 0.8985146450522481, 'auprc': 0.9822607521835615, 'loss_val': 0.23049004218452596, 'psi': 0.9320130879047734}
[S4] START round=30 head_norm_before_train=1.952736 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9475704756378195, 'auprc': 0.9657484179373939, 'loss_val': 0.27748756976993627, 'psi': 0.9548416525576493}-{'f1_val': 0.9505332865474173, 'auprc': 0.9685168400994081, 'loss_val': 0.2730962115303314, 'psi': 0.9577267079682137}
[S5] START round=30 head_norm_before_train=1.844862 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.172085 metrics={'f1_val': 0.9424281837531074, 'auprc': 0.9961413305451852, 'loss_val': 0.1637595025263994, 'psi': 0.9639134424699385}-{'f1_val': 0.8869936695631062, 'auprc': 0.9939984346583267, 'loss_val': 0.1688934441698345, 'psi': 0.9297955756011944}
[S6] START round=30 head_norm_before_train=1.757763 (no previous merge yet)
[S6] round=30 local utility u=0.748851 metrics={'f1_val': 0.8119813347638343, 'auprc': 0.9615961833679051, 'loss_val': 0.30361409302699977, 'psi': 0.8718272742054626}-{'f1_val': 0.6939265796630327, 'auprc': 0.8106473654266819, 'loss_val': 0.6401408127548003, 'psi': 0.7406148939684924}
[S7] START round=30 head_norm_before_train=1.078353 cos_to_last_merge=0.9988 (last merge round=28)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.47860314394427855, 'auprc': 0.7814881404831479, 'loss_val': 1.0401972427484534, 'psi': 0.5997571425598263}-{'f1_val': 0.6508574223430744, 'auprc': 0.811719998360215, 'loss_val': 0.5790436250477742, 'psi': 0.7152024527499307}
[S8] START round=30 head_norm_before_train=1.846503 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9893959316942147, 'auprc': 0.9874502746938081, 'loss_val': 0.08005879131663896, 'psi': 0.988617668894052}-{'f1_val': 0.9940572439116249, 'auprc': 0.9986021674589318, 'loss_val': 0.0433702493311652, 'psi': 0.9958752133305476}
[S9] START round=30 head_norm_before_train=1.883487 cos_to_last_merge=0.7556 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.756
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9972339416674938, 'loss_val': 0.018359568477027112, 'psi': 0.9971553241742832}-{'f1_val': 0.9971317563071089, 'auprc': 0.9973324809256109, 'loss_val': 0.01811248267859686, 'psi': 0.9972120461545098}
[S10] START round=30 head_norm_before_train=1.754207 cos_to_last_merge=1.0000 (last merge round=29)
[S10] round=30 local utility u=0.002708 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9971749571109465, 'loss_val': 0.05777457650155683, 'psi': 0.9957191483760022}-{'f1_val': 0.9949681865317428, 'auprc': 0.995406697268423, 'loss_val': 0.05920381150631043, 'psi': 0.9951435908264149}
[S11] START round=30 head_norm_before_train=1.763560 cos_to_last_merge=0.7453 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.745
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9967032072078821, 'loss_val': 0.03572363726871004, 'psi': 0.9965187952016193}-{'f1_val': 0.9967887165093644, 'auprc': 0.9981648518836951, 'loss_val': 0.0321806162180713, 'psi': 0.9973391706590966}
[S13] START round=30 head_norm_before_train=1.723647 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5891309009785175, 'auprc': 0.6709813669092554, 'loss_val': 0.7241425117472959, 'psi': 0.6218710873508126}-{'f1_val': 0.6107503799233458, 'auprc': 0.6426119264845254, 'loss_val': 0.635444857914509, 'psi': 0.6234949985478175}
[S14] START round=30 head_norm_before_train=1.096593 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.019194 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9984496039441382, 'loss_val': 0.14751053517794716, 'psi': 0.997446306149117}-{'f1_val': 0.9964034173396682, 'auprc': 0.9979646268625603, 'loss_val': 0.18219964765521496, 'psi': 0.997027901148825}
[S15] START round=30 head_norm_before_train=1.777823 cos_to_last_merge=0.7921 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.792
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.9447525276917504, 'auprc': 0.9866658189468832, 'loss_val': 0.1515267502270191, 'psi': 0.9615178441938036}-{'f1_val': 0.9879829105476896, 'auprc': 0.9982157827256066, 'loss_val': 0.057219051930465066, 'psi': 0.9920760594188563}
[S16] START round=30 head_norm_before_train=1.774887 cos_to_last_merge=0.8157 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.816
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9373139350787666, 'auprc': 0.9926877251843608, 'loss_val': 0.3117775359471454, 'psi': 0.9594634511210043}-{'f1_val': 0.9893012139614793, 'auprc': 0.9961765568400403, 'loss_val': 0.055427523789586, 'psi': 0.9920513511129037}
[S17] START round=30 head_norm_before_train=1.568085 cos_to_last_merge=0.8192 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.819
[S17] round=30 local utility u=1.000000 metrics={'f1_val': 0.9659132774225178, 'auprc': 0.9775423601110474, 'loss_val': 0.22505678386134162, 'psi': 0.9705649104979296}-{'f1_val': 0.6192358811254127, 'auprc': 0.7998524802481096, 'loss_val': 0.6622290131854432, 'psi': 0.6914825207744915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:54508
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:54503
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] cosine check vs S6: cos=0.8274
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=0.5826
[S3] RECEIVED delta(kind=head bytes=1794) from S5
[S3] cosine check vs S5: cos=0.9947
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:54509
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=-0.1331
[S5] DROPPED delta from S10 (cos=-0.1331 < 0.0)
[S17] sending update (kind=head size=1807 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1807) from S17
[S8] cosine check vs S17: cos=-0.1035
[S8] DROPPED delta from S17 (cos=-0.1035 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.7923 head_norm=1.898846
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.956507e-02
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.7952 head_norm=1.872620 delta_norm=0.099565
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.210 → S14@127.0.0.1:54514
[S2] ⇄ pheromone p=0.294 → S6@127.0.0.1:54507
[S8] ⇄ pheromone p=0.102 → S5@127.0.0.1:54505
[S6] ⇄ pheromone p=0.487 → S7@127.0.0.1:54508
[S5] ⇄ pheromone p=0.249 → S3@127.0.0.1:54503
[S13] ⇄ pheromone p=0.037 → S10@127.0.0.1:54511
[S9] ⇄ pheromone p=0.009 → S7@127.0.0.1:54508
[S14] ⇄ pheromone p=0.041 → S7@127.0.0.1:54508
[S11] ⇄ pheromone p=0.022 → S2@127.0.0.1:54502
[S4] ⇄ pheromone p=0.020 → S14@127.0.0.1:54514
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.4786 head_norm=1.113178
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.471932e-01
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.4810 head_norm=1.097147 delta_norm=0.147193
[S7] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.138 → S13@127.0.0.1:54513
[S15] ⇄ pheromone p=0.320 → S14@127.0.0.1:54514
[S10] ⇄ pheromone p=0.019 → S5@127.0.0.1:54505
[S17] ⇄ pheromone p=0.403 → S8@127.0.0.1:54509
[S16] ⇄ pheromone p=0.055 → S14@127.0.0.1:54514
[S2] START round=31 head_norm_before_train=1.756213 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=31 local utility u=0.688407 metrics={'f1_val': 0.6805646476599307, 'auprc': 0.7027526163673115, 'loss_val': 0.794369444564334, 'psi': 0.689439835142883}-{'f1_val': 0.566474717698976, 'auprc': 0.6186174700804854, 'loss_val': 1.2342388884485949, 'psi': 0.5873318186515797}
[S3] START round=31 head_norm_before_train=1.872620 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.887565 metrics={'f1_val': 0.969129114395145, 'auprc': 0.9946088222221117, 'loss_val': 0.1359439829588705, 'psi': 0.9793209975259317}-{'f1_val': 0.7923212085981233, 'auprc': 0.846616478011571, 'loss_val': 0.4062503456947791, 'psi': 0.8140393163635024}
[S4] START round=31 head_norm_before_train=1.958950 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.944308786622916, 'auprc': 0.9506912954876144, 'loss_val': 0.28140266677961273, 'psi': 0.9468617901687953}-{'f1_val': 0.9475704756378195, 'auprc': 0.9657484179373939, 'loss_val': 0.27748756976993627, 'psi': 0.9548416525576493}
[S5] START round=31 head_norm_before_train=1.851384 cos_to_last_merge=0.9999 (last merge round=29)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.7555957122637197, 'loss_val': 0.36907367919728595, 'psi': 0.7224824307340489}-{'f1_val': 0.9424281837531074, 'auprc': 0.9961413305451852, 'loss_val': 0.1637595025263994, 'psi': 0.9639134424699385}
[S6] START round=31 head_norm_before_train=1.761586 (no previous merge yet)
[S6] round=31 local utility u=0.339933 metrics={'f1_val': 0.9194221487448946, 'auprc': 0.963278683183546, 'loss_val': 0.2734400256954614, 'psi': 0.9369647625203551}-{'f1_val': 0.8119813347638343, 'auprc': 0.9615961833679051, 'loss_val': 0.30361409302699977, 'psi': 0.8718272742054626}
[S7] START round=31 head_norm_before_train=1.097147 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.476420 metrics={'f1_val': 0.5876061442195757, 'auprc': 0.7932525028954558, 'loss_val': 0.7766677480711583, 'psi': 0.6698646876899277}-{'f1_val': 0.47860314394427855, 'auprc': 0.7814881404831479, 'loss_val': 1.0401972427484534, 'psi': 0.5997571425598263}
[S8] START round=31 head_norm_before_train=1.863770 (no previous merge yet)
[S8] round=31 local utility u=0.043994 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.9989520852583682, 'loss_val': 0.04278483605548711, 'psi': 0.9948392183223664}-{'f1_val': 0.9893959316942147, 'auprc': 0.9874502746938081, 'loss_val': 0.08005879131663896, 'psi': 0.988617668894052}
[S9] START round=31 head_norm_before_train=1.893064 cos_to_last_merge=0.7547 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.755
[S9] round=31 local utility u=0.003515 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9992180720129769, 'loss_val': 0.017281161983074268, 'psi': 0.9979489763124765}-{'f1_val': 0.9971029125121428, 'auprc': 0.9972339416674938, 'loss_val': 0.018359568477027112, 'psi': 0.9971553241742832}
[S10] START round=31 head_norm_before_train=1.777729 cos_to_last_merge=0.9998 (last merge round=29)
[S10] round=31 local utility u=0.003744 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9974013559620223, 'loss_val': 0.05096582751437289, 'psi': 0.9958097079164324}-{'f1_val': 0.9947486092193725, 'auprc': 0.9971749571109465, 'loss_val': 0.05777457650155683, 'psi': 0.9957191483760022}
[S11] START round=31 head_norm_before_train=1.778785 cos_to_last_merge=0.7434 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.743
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9967209803521373, 'loss_val': 0.035480032188982095, 'psi': 0.9963808769873022}-{'f1_val': 0.9963958538641108, 'auprc': 0.9967032072078821, 'loss_val': 0.03572363726871004, 'psi': 0.9965187952016193}
[S13] START round=31 head_norm_before_train=1.727894 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5825670372464136, 'auprc': 0.6866491722218797, 'loss_val': 0.8197018545368282, 'psi': 0.6241998912366}-{'f1_val': 0.5891309009785175, 'auprc': 0.6709813669092554, 'loss_val': 0.7241425117472959, 'psi': 0.6218710873508126}
[S14] START round=31 head_norm_before_train=1.143470 cos_to_last_merge=0.9991 (last merge round=29)
[S14] round=31 local utility u=0.014333 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.998708912816008, 'loss_val': 0.12094315889050113, 'psi': 0.9976820700210023}-{'f1_val': 0.9967774409524363, 'auprc': 0.9984496039441382, 'loss_val': 0.14751053517794716, 'psi': 0.997446306149117}
[S15] START round=31 head_norm_before_train=1.785032 cos_to_last_merge=0.7915 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.791
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6972401861555814, 'auprc': 0.6658098052927387, 'loss_val': 0.6304370177734576, 'psi': 0.6846680338104443}-{'f1_val': 0.9447525276917504, 'auprc': 0.9866658189468832, 'loss_val': 0.1515267502270191, 'psi': 0.9615178441938036}
[S16] START round=31 head_norm_before_train=1.784288 cos_to_last_merge=0.8152 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.815
[S16] round=31 local utility u=0.295424 metrics={'f1_val': 0.9908770957330659, 'auprc': 0.994875971307456, 'loss_val': 0.04887248754477222, 'psi': 0.992476645962822}-{'f1_val': 0.9373139350787666, 'auprc': 0.9926877251843608, 'loss_val': 0.3117775359471454, 'psi': 0.9594634511210043}
[S17] START round=31 head_norm_before_train=1.578017 cos_to_last_merge=0.8186 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.819
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6619910614910001, 'auprc': 0.8164333724613366, 'loss_val': 0.7716429684903597, 'psi': 0.7237679858791347}-{'f1_val': 0.9659132774225178, 'auprc': 0.9775423601110474, 'loss_val': 0.22505678386134162, 'psi': 0.9705649104979296}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:54502
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:54515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:54512
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.7022
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] cosine check vs S8: cos=-0.1031
[S17] DROPPED delta from S8 (cos=-0.1031 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=0.8447
[S11] RECEIVED delta(kind=head bytes=1791) from S2
[S11] cosine check vs S2: cos=0.9993
[S5] RECEIVED delta(kind=head bytes=1797) from S3
[S5] cosine check vs S3: cos=0.9974
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=0.9950
[S2] RECEIVED delta(kind=head bytes=1805) from S6
[S2] cosine check vs S6: cos=-0.0274
[S2] DROPPED delta from S6 (cos=-0.0274 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.9962 head_norm=1.793037
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.543961e-02
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.9962 head_norm=1.779791 delta_norm=0.035440
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.6972 head_norm=1.791273
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.386881e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.6972 head_norm=1.377902 delta_norm=0.638688
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=31 metric=0.5826 head_norm=1.732662
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.488488e-02
[S13] stored merged vector for next round verification (round=31)
[S13] DEBUG after merge:  round=31 metric=0.5842 head_norm=1.764442 delta_norm=0.094885
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.7004 head_norm=1.860783
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.051050e-02
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.7004 head_norm=1.880380 delta_norm=0.070510
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.9194 head_norm=1.765155
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.086470e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.9319 head_norm=1.385502 delta_norm=0.508647
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.767156 cos_to_last_merge=0.9998 (last merge round=29)
[S2] round=32 local utility u=0.105726 metrics={'f1_val': 0.6893198031125515, 'auprc': 0.734912723383769, 'loss_val': 0.73192916534538, 'psi': 0.7075569712210386}-{'f1_val': 0.6805646476599307, 'auprc': 0.7027526163673115, 'loss_val': 0.794369444564334, 'psi': 0.689439835142883}
[S3] START round=32 head_norm_before_train=1.902390 cos_to_last_merge=0.9996 (last merge round=30)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9340191411355778, 'auprc': 0.9951773849803656, 'loss_val': 0.17184592149641936, 'psi': 0.9584824386734929}-{'f1_val': 0.969129114395145, 'auprc': 0.9946088222221117, 'loss_val': 0.1359439829588705, 'psi': 0.9793209975259317}
[S4] START round=32 head_norm_before_train=1.966193 (no previous merge yet)
[S4] round=32 local utility u=0.008999 metrics={'f1_val': 0.942447950571742, 'auprc': 0.9561662396949622, 'loss_val': 0.2686644543639751, 'psi': 0.9479352662210301}-{'f1_val': 0.944308786622916, 'auprc': 0.9506912954876144, 'loss_val': 0.28140266677961273, 'psi': 0.9468617901687953}
[S5] START round=32 head_norm_before_train=1.880380 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.429383 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9919809687113302, 'loss_val': 0.21946691538060065, 'psi': 0.8170369204164603}-{'f1_val': 0.7004069097142683, 'auprc': 0.7555957122637197, 'loss_val': 0.36907367919728595, 'psi': 0.7224824307340489}
[S6] START round=32 head_norm_before_train=1.385502 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.6218916482509409, 'auprc': 0.805091533821441, 'loss_val': 0.6664910548918516, 'psi': 0.695171602479141}-{'f1_val': 0.9194221487448946, 'auprc': 0.963278683183546, 'loss_val': 0.2734400256954614, 'psi': 0.9369647625203551}
[S7] START round=32 head_norm_before_train=1.113957 cos_to_last_merge=0.9996 (last merge round=30)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5863898217318506, 'auprc': 0.787867252634407, 'loss_val': 0.8011522075087554, 'psi': 0.6669807940928731}-{'f1_val': 0.5876061442195757, 'auprc': 0.7932525028954558, 'loss_val': 0.7766677480711583, 'psi': 0.6698646876899277}
[S8] START round=32 head_norm_before_train=1.877608 (no previous merge yet)
[S8] round=32 local utility u=0.006335 metrics={'f1_val': 0.994191112481867, 'auprc': 0.9979250234415679, 'loss_val': 0.039596705024344064, 'psi': 0.9956846768657474}-{'f1_val': 0.9920973070316986, 'auprc': 0.9989520852583682, 'loss_val': 0.04278483605548711, 'psi': 0.9948392183223664}
[S9] START round=32 head_norm_before_train=1.904865 cos_to_last_merge=0.7536 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.754
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.998164858202577, 'loss_val': 0.017222857879004703, 'psi': 0.9975276907883165}-{'f1_val': 0.9971029125121428, 'auprc': 0.9992180720129769, 'loss_val': 0.017281161983074268, 'psi': 0.9979489763124765}
[S10] START round=32 head_norm_before_train=1.800666 cos_to_last_merge=0.9993 (last merge round=29)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9941075804750749, 'loss_val': 0.05288275827216303, 'psi': 0.9947557356016548}-{'f1_val': 0.9947486092193725, 'auprc': 0.9974013559620223, 'loss_val': 0.05096582751437289, 'psi': 0.9958097079164324}
[S11] START round=32 head_norm_before_train=1.779791 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9961547642675344, 'auprc': 0.9965431567615731, 'loss_val': 0.04058834047701699, 'psi': 0.9963101212651498}-{'f1_val': 0.9961541414107454, 'auprc': 0.9967209803521373, 'loss_val': 0.035480032188982095, 'psi': 0.9963808769873022}
[S13] START round=32 head_norm_before_train=1.764442 cos_to_last_merge=1.0000 (last merge round=31)
[S13] round=32 local utility u=0.011071 metrics={'f1_val': 0.5858541080114146, 'auprc': 0.6802596647152798, 'loss_val': 0.7981132055533163, 'psi': 0.6236163306929606}-{'f1_val': 0.5825670372464136, 'auprc': 0.6866491722218797, 'loss_val': 0.8197018545368282, 'psi': 0.6241998912366}
[S14] START round=32 head_norm_before_train=1.185079 cos_to_last_merge=0.9972 (last merge round=29)
[S14] round=32 local utility u=0.009524 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9971546204143494, 'loss_val': 0.09971399302932486, 'psi': 0.9973084447264366}-{'f1_val': 0.9969975081576651, 'auprc': 0.998708912816008, 'loss_val': 0.12094315889050113, 'psi': 0.9976820700210023}
[S15] START round=32 head_norm_before_train=1.377902 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=1.000000 metrics={'f1_val': 0.9910190653096624, 'auprc': 0.9972343500039926, 'loss_val': 0.08182573208441503, 'psi': 0.9935051791873944}-{'f1_val': 0.6972401861555814, 'auprc': 0.6658098052927387, 'loss_val': 0.6304370177734576, 'psi': 0.6846680338104443}
[S16] START round=32 head_norm_before_train=1.795495 cos_to_last_merge=0.8148 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.815
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9396617670652637, 'auprc': 0.9947765314174709, 'loss_val': 0.24342133229327897, 'psi': 0.9617076728061467}-{'f1_val': 0.9908770957330659, 'auprc': 0.994875971307456, 'loss_val': 0.04887248754477222, 'psi': 0.992476645962822}
[S17] START round=32 head_norm_before_train=1.588255 cos_to_last_merge=0.8179 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.818
[S17] round=32 local utility u=0.040916 metrics={'f1_val': 0.6537298725073127, 'auprc': 0.8792650117480094, 'loss_val': 0.8287387234683724, 'psi': 0.7439439282035913}-{'f1_val': 0.6619910614910001, 'auprc': 0.8164333724613366, 'loss_val': 0.7716429684903597, 'psi': 0.7237679858791347}
[S14] not sending this round → trigger blocked (psi=0.997)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:54509
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.708)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S5
[S8] cosine check vs S5: cos=0.9950
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=-0.1116
[S7] DROPPED delta from S13 (cos=-0.1116 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9942 head_norm=1.889614
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.417655e-02
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9944 head_norm=1.888515 delta_norm=0.094177
[S8] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.779275 cos_to_last_merge=0.9995 (last merge round=29)
[S2] round=33 local utility u=0.081352 metrics={'f1_val': 0.7189599441127739, 'auprc': 0.7203002377618948, 'loss_val': 0.7032289887994929, 'psi': 0.7194960615724222}-{'f1_val': 0.6893198031125515, 'auprc': 0.734912723383769, 'loss_val': 0.73192916534538, 'psi': 0.7075569712210386}
[S3] START round=33 head_norm_before_train=1.926313 cos_to_last_merge=0.9989 (last merge round=30)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.7715542144787428, 'auprc': 0.8426780377114063, 'loss_val': 0.4338685117016169, 'psi': 0.8000037437718082}-{'f1_val': 0.9340191411355778, 'auprc': 0.9951773849803656, 'loss_val': 0.17184592149641936, 'psi': 0.9584824386734929}
[S4] START round=33 head_norm_before_train=1.971411 (no previous merge yet)
[S4] round=33 local utility u=0.005900 metrics={'f1_val': 0.9426818410850019, 'auprc': 0.9579765910808589, 'loss_val': 0.2636994457160765, 'psi': 0.9487997410833446}-{'f1_val': 0.942447950571742, 'auprc': 0.9561662396949622, 'loss_val': 0.2686644543639751, 'psi': 0.9479352662210301}
[S5] START round=33 head_norm_before_train=1.892107 cos_to_last_merge=0.9999 (last merge round=31)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9075419190722035, 'loss_val': 0.34664354843150846, 'psi': 0.7832609134574424}-{'f1_val': 0.700407554886547, 'auprc': 0.9919809687113302, 'loss_val': 0.21946691538060065, 'psi': 0.8170369204164603}
[S6] START round=33 head_norm_before_train=1.393629 cos_to_last_merge=0.9999 (last merge round=31)
[S6] round=33 local utility u=1.000000 metrics={'f1_val': 0.9874917003316237, 'auprc': 0.9580330403570989, 'loss_val': 0.16243801756029524, 'psi': 0.9757082363418137}-{'f1_val': 0.6218916482509409, 'auprc': 0.805091533821441, 'loss_val': 0.6664910548918516, 'psi': 0.695171602479141}
[S7] START round=33 head_norm_before_train=1.134725 cos_to_last_merge=0.9988 (last merge round=30)
[S7] round=33 local utility u=0.211571 metrics={'f1_val': 0.6212877818802081, 'auprc': 0.7994604414252933, 'loss_val': 0.6221785078688177, 'psi': 0.6925568456982422}-{'f1_val': 0.5863898217318506, 'auprc': 0.787867252634407, 'loss_val': 0.8011522075087554, 'psi': 0.6669807940928731}
[S8] START round=33 head_norm_before_train=1.888515 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9943795289865018, 'auprc': 0.9979254297965932, 'loss_val': 0.04095841993612218, 'psi': 0.9957978893105384}-{'f1_val': 0.994191112481867, 'auprc': 0.9979250234415679, 'loss_val': 0.039596705024344064, 'psi': 0.9956846768657474}
[S9] START round=33 head_norm_before_train=1.916687 cos_to_last_merge=0.7526 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.753
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.997143467788472, 'loss_val': 0.018053867082394846, 'psi': 0.9971191346226744}-{'f1_val': 0.9971029125121428, 'auprc': 0.998164858202577, 'loss_val': 0.017222857879004703, 'psi': 0.9975276907883165}
[S10] START round=33 head_norm_before_train=1.820845 cos_to_last_merge=0.9987 (last merge round=29)
[S10] round=33 local utility u=0.009985 metrics={'f1_val': 0.9949436619942489, 'auprc': 0.9976519271722338, 'loss_val': 0.042080766143123824, 'psi': 0.9960269680654429}-{'f1_val': 0.9951878390193748, 'auprc': 0.9941075804750749, 'loss_val': 0.05288275827216303, 'psi': 0.9947557356016548}
[S11] START round=33 head_norm_before_train=1.793717 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=33 local utility u=0.003978 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9966934492893362, 'loss_val': 0.03307935134641512, 'psi': 0.9963698645621817}-{'f1_val': 0.9961547642675344, 'auprc': 0.9965431567615731, 'loss_val': 0.04058834047701699, 'psi': 0.9963101212651498}
[S13] START round=33 head_norm_before_train=1.768044 cos_to_last_merge=1.0000 (last merge round=31)
[S13] round=33 local utility u=0.051720 metrics={'f1_val': 0.5982550149117194, 'auprc': 0.6633927106515354, 'loss_val': 0.7184772559961136, 'psi': 0.6243100932076457}-{'f1_val': 0.5858541080114146, 'auprc': 0.6802596647152798, 'loss_val': 0.7981132055533163, 'psi': 0.6236163306929606}
[S14] START round=33 head_norm_before_train=1.226050 cos_to_last_merge=0.9946 (last merge round=29)
[S14] round=33 local utility u=0.008419 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9988520413280717, 'loss_val': 0.08548833407320529, 'psi': 0.9977393214258277}-{'f1_val': 0.9974109942678281, 'auprc': 0.9971546204143494, 'loss_val': 0.09971399302932486, 'psi': 0.9973084447264366}
[S15] START round=33 head_norm_before_train=1.390012 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.7755925815240176, 'auprc': 0.9902328797954955, 'loss_val': 0.31581867853693035, 'psi': 0.8614487008326087}-{'f1_val': 0.9910190653096624, 'auprc': 0.9972343500039926, 'loss_val': 0.08182573208441503, 'psi': 0.9935051791873944}
[S16] START round=33 head_norm_before_train=1.807626 cos_to_last_merge=0.8143 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.814
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8828294213615262, 'auprc': 0.993738795466762, 'loss_val': 0.5742722027774549, 'psi': 0.9271931710036205}-{'f1_val': 0.9396617670652637, 'auprc': 0.9947765314174709, 'loss_val': 0.24342133229327897, 'psi': 0.9617076728061467}
[S17] START round=33 head_norm_before_train=1.605149 cos_to_last_merge=0.8164 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=33 local utility u=0.840362 metrics={'f1_val': 0.8737549649155175, 'auprc': 0.8856307896933325, 'loss_val': 0.4872627790857222, 'psi': 0.8785052948266434}-{'f1_val': 0.6537298725073127, 'auprc': 0.8792650117480094, 'loss_val': 0.8287387234683724, 'psi': 0.7439439282035913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:54513
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:54507
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:54512
[S2] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S2
[S11] cosine check vs S2: cos=0.9991
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=0.9974
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:54515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:54508
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] cosine check vs S14: cos=0.8780
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1795) from S6
[S2] cosine check vs S6: cos=-0.0251
[S2] DROPPED delta from S6 (cos=-0.0251 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S7
[S6] cosine check vs S7: cos=0.9294
[S13] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S13
[S7] cosine check vs S13: cos=-0.1112
[S7] DROPPED delta from S13 (cos=-0.1112 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9962 head_norm=1.805753
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.874119e-02
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9962 head_norm=1.797502 delta_norm=0.038741
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S8
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S9
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.7756 head_norm=1.411013
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.378879e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.7754 head_norm=1.294567 delta_norm=0.337888
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.9875 head_norm=1.409980
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.698146e-01
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.9867 head_norm=1.265969 delta_norm=0.269815
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.5983 head_norm=1.772311
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.404274e-02
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.5965 head_norm=1.805375 delta_norm=0.074043
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.790051 cos_to_last_merge=0.9991 (last merge round=29)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6880290279627266, 'auprc': 0.7037063884178719, 'loss_val': 0.7924343694057445, 'psi': 0.6942999721447847}-{'f1_val': 0.7189599441127739, 'auprc': 0.7203002377618948, 'loss_val': 0.7032289887994929, 'psi': 0.7194960615724222}
[S3] START round=34 head_norm_before_train=1.947012 cos_to_last_merge=0.9979 (last merge round=30)
[S3] round=34 local utility u=0.276350 metrics={'f1_val': 0.822078780089075, 'auprc': 0.887017291999023, 'loss_val': 0.3173333483823965, 'psi': 0.8480541848530543}-{'f1_val': 0.7715542144787428, 'auprc': 0.8426780377114063, 'loss_val': 0.4338685117016169, 'psi': 0.8000037437718082}
[S4] START round=34 head_norm_before_train=1.976458 (no previous merge yet)
[S4] round=34 local utility u=0.057473 metrics={'f1_val': 0.9496386377091945, 'auprc': 0.9801507128694628, 'loss_val': 0.25701753801290644, 'psi': 0.9618434677733019}-{'f1_val': 0.9426818410850019, 'auprc': 0.9579765910808589, 'loss_val': 0.2636994457160765, 'psi': 0.9487997410833446}
[S4] not sending this round → trigger blocked (psi=0.962)
[S5] START round=34 head_norm_before_train=1.902170 cos_to_last_merge=0.9997 (last merge round=31)
[S5] round=34 local utility u=0.139571 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9846394475152991, 'loss_val': 0.2993128424160658, 'psi': 0.8141517558874112}-{'f1_val': 0.7004069097142683, 'auprc': 0.9075419190722035, 'loss_val': 0.34664354843150846, 'psi': 0.7832609134574424}
[S6] START round=34 head_norm_before_train=1.265969 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.7565013170262818, 'auprc': 0.9523180285188952, 'loss_val': 0.544982484673832, 'psi': 0.8348280016233272}-{'f1_val': 0.9874917003316237, 'auprc': 0.9580330403570989, 'loss_val': 0.16243801756029524, 'psi': 0.9757082363418137}
[S7] START round=34 head_norm_before_train=1.167437 cos_to_last_merge=0.9965 (last merge round=30)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6219359072189227, 'auprc': 0.7955018929684996, 'loss_val': 0.6244479838405496, 'psi': 0.6913623015187534}-{'f1_val': 0.6212877818802081, 'auprc': 0.7994604414252933, 'loss_val': 0.6221785078688177, 'psi': 0.6925568456982422}
[S8] START round=34 head_norm_before_train=1.899344 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9924605795656339, 'auprc': 0.9983205208464255, 'loss_val': 0.03867580000170003, 'psi': 0.9948045560779506}-{'f1_val': 0.9943795289865018, 'auprc': 0.9979254297965932, 'loss_val': 0.04095841993612218, 'psi': 0.9957978893105384}
[S9] START round=34 head_norm_before_train=1.925504 cos_to_last_merge=0.7518 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.752
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9874269136456545, 'auprc': 0.999125295602189, 'loss_val': 0.04712628257998067, 'psi': 0.9921062664282683}-{'f1_val': 0.9971029125121428, 'auprc': 0.997143467788472, 'loss_val': 0.018053867082394846, 'psi': 0.9971191346226744}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.840825 cos_to_last_merge=0.9980 (last merge round=29)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9955385762912694, 'loss_val': 0.04233753457046913, 'psi': 0.9951963424355534}-{'f1_val': 0.9949436619942489, 'auprc': 0.9976519271722338, 'loss_val': 0.042080766143123824, 'psi': 0.9960269680654429}
[S11] START round=34 head_norm_before_train=1.797502 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.001560 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9967655585785037, 'loss_val': 0.03162691792265657, 'psi': 0.996543735749868}-{'f1_val': 0.9961541414107454, 'auprc': 0.9966934492893362, 'loss_val': 0.03307935134641512, 'psi': 0.9963698645621817}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=34 head_norm_before_train=1.805375 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5997720614130742, 'auprc': 0.6703145822867547, 'loss_val': 0.7952804716307389, 'psi': 0.6279890697625463}-{'f1_val': 0.5982550149117194, 'auprc': 0.6633927106515354, 'loss_val': 0.7184772559961136, 'psi': 0.6243100932076457}
[S14] START round=34 head_norm_before_train=1.260630 cos_to_last_merge=0.9919 (last merge round=29)
[S14] round=34 local utility u=0.005623 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9991570924754526, 'loss_val': 0.07529503198675876, 'psi': 0.9978750106639065}-{'f1_val': 0.9969975081576651, 'auprc': 0.9988520413280717, 'loss_val': 0.08548833407320529, 'psi': 0.9977393214258277}
[S15] START round=34 head_norm_before_train=1.294567 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.732937 metrics={'f1_val': 0.9857883110315465, 'auprc': 0.9968000048701973, 'loss_val': 0.13082011536345253, 'psi': 0.9901929885670069}-{'f1_val': 0.7755925815240176, 'auprc': 0.9902328797954955, 'loss_val': 0.31581867853693035, 'psi': 0.8614487008326087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=34 head_norm_before_train=1.816853 cos_to_last_merge=0.8133 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.813
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8611909572117398, 'auprc': 0.9948034757601457, 'loss_val': 0.744214870539376, 'psi': 0.9146359646311022}-{'f1_val': 0.8828294213615262, 'auprc': 0.993738795466762, 'loss_val': 0.5742722027774549, 'psi': 0.9271931710036205}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.623814 cos_to_last_merge=0.8146 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6557256845236215, 'auprc': 0.7170099213018296, 'loss_val': 0.9649692513206064, 'psi': 0.6802393792349047}-{'f1_val': 0.8737549649155175, 'auprc': 0.8856307896933325, 'loss_val': 0.4872627790857222, 'psi': 0.8785052948266434}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:54505
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S3
[S5] cosine check vs S3: cos=0.9965
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:54509
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S5
[S8] cosine check vs S5: cos=0.9975
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=34 metric=0.7005 head_norm=1.913547
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.649298e-02
[S5] stored merged vector for next round verification (round=34)
[S5] DEBUG after merge:  round=34 metric=0.7004 head_norm=1.940288 delta_norm=0.086493
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] RoundReady barrier timeout: have=1 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:54515
[S7] RoundReady barrier timeout: have=1 need=2 — continuing
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S14
[S15] cosine check vs S14: cos=0.9592
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S15
[S14]  timeout peer S16
[S10]  timeout peer S13
[S2]  timeout peer S11
[S6]  timeout peer S2
[S5]  timeout peer S8
[S5]  timeout peer S10
[S8]  timeout peer S17
[S7]  timeout peer S6
[S7]  timeout peer S9
[S3]  timeout peer S5
[S13]  timeout peer S7
[S2] START round=35 head_norm_before_train=1.802264 cos_to_last_merge=0.9985 (last merge round=29)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6529610328344327, 'auprc': 0.7019188390142393, 'loss_val': 0.8741091681606664, 'psi': 0.6725441553063554}-{'f1_val': 0.6880290279627266, 'auprc': 0.7037063884178719, 'loss_val': 0.7924343694057445, 'psi': 0.6942999721447847}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.970466 cos_to_last_merge=0.9967 (last merge round=30)
[S3] round=35 local utility u=0.823484 metrics={'f1_val': 0.9965655661594752, 'auprc': 0.9995962793637216, 'loss_val': 0.05502289305396624, 'psi': 0.9977778514411738}-{'f1_val': 0.822078780089075, 'auprc': 0.887017291999023, 'loss_val': 0.3173333483823965, 'psi': 0.8480541848530543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=35 head_norm_before_train=1.980229 (no previous merge yet)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9452485990046955, 'auprc': 0.9599431940861587, 'loss_val': 0.2634719276207097, 'psi': 0.9511264370372807}-{'f1_val': 0.9496386377091945, 'auprc': 0.9801507128694628, 'loss_val': 0.25701753801290644, 'psi': 0.9618434677733019}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.940288 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=35 local utility u=0.035123 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9913925041742054, 'loss_val': 0.24829402496230768, 'psi': 0.8167497921300304}-{'f1_val': 0.7004932948021524, 'auprc': 0.9846394475152991, 'loss_val': 0.2993128424160658, 'psi': 0.8141517558874112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=35 head_norm_before_train=1.282269 cos_to_last_merge=0.9999 (last merge round=33)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.5801238298062055, 'auprc': 0.7845156163386513, 'loss_val': 0.7577670562793185, 'psi': 0.6618805444191838}-{'f1_val': 0.7565013170262818, 'auprc': 0.9523180285188952, 'loss_val': 0.544982484673832, 'psi': 0.8348280016233272}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.190139 cos_to_last_merge=0.9943 (last merge round=30)
[S7] round=35 local utility u=0.318506 metrics={'f1_val': 0.6749956324343906, 'auprc': 0.8298175113852909, 'loss_val': 0.4087414831291377, 'psi': 0.7369243840147508}-{'f1_val': 0.6219359072189227, 'auprc': 0.7955018929684996, 'loss_val': 0.6244479838405496, 'psi': 0.6913623015187534}
[S8] START round=35 head_norm_before_train=1.911264 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9936297631890177, 'auprc': 0.9963286792632112, 'loss_val': 0.04159184074946112, 'psi': 0.9947093296186951}-{'f1_val': 0.9924605795656339, 'auprc': 0.9983205208464255, 'loss_val': 0.03867580000170003, 'psi': 0.9948045560779506}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9936 head_norm=1.920420
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.962298e-02
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9936 head_norm=1.915722 delta_norm=0.069623
[S8] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] START round=35 head_norm_before_train=1.935415 cos_to_last_merge=0.7510 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.751
[S9] round=35 local utility u=0.022089 metrics={'f1_val': 0.9912751909181616, 'auprc': 0.9992246728361891, 'loss_val': 0.02633617474407777, 'psi': 0.9944549836853727}-{'f1_val': 0.9874269136456545, 'auprc': 0.999125295602189, 'loss_val': 0.04712628257998067, 'psi': 0.9921062664282683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=35 head_norm_before_train=1.860254 cos_to_last_merge=0.9971 (last merge round=29)
[S10] round=35 local utility u=0.006484 metrics={'f1_val': 0.9948593846939079, 'auprc': 0.9982534488475434, 'loss_val': 0.03686036916191535, 'psi': 0.996217010355362}-{'f1_val': 0.9949681865317428, 'auprc': 0.9955385762912694, 'loss_val': 0.04233753457046913, 'psi': 0.9951963424355534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=35 head_norm_before_train=1.809555 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=35 local utility u=0.001587 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9967286612210339, 'loss_val': 0.028342540556069613, 'psi': 0.9965289768068801}-{'f1_val': 0.9963958538641108, 'auprc': 0.9967655585785037, 'loss_val': 0.03162691792265657, 'psi': 0.996543735749868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=35 head_norm_before_train=1.813137 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.587708672745132, 'auprc': 0.6752201896319909, 'loss_val': 0.8370626351337358, 'psi': 0.6227132794998755}-{'f1_val': 0.5997720614130742, 'auprc': 0.6703145822867547, 'loss_val': 0.7952804716307389, 'psi': 0.6279890697625463}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.290529 cos_to_last_merge=0.9895 (last merge round=29)
[S14] round=35 local utility u=0.003275 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9991308132305816, 'loss_val': 0.06720904285513331, 'psi': 0.9977187898636943}-{'f1_val': 0.9970202894562089, 'auprc': 0.9991570924754526, 'loss_val': 0.07529503198675876, 'psi': 0.9978750106639065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=35 head_norm_before_train=1.331266 cos_to_last_merge=0.9996 (last merge round=33)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6967419968570036, 'auprc': 0.9893134904659738, 'loss_val': 0.4181105126556526, 'psi': 0.8137705943005917}-{'f1_val': 0.9857883110315465, 'auprc': 0.9968000048701973, 'loss_val': 0.13082011536345253, 'psi': 0.9901929885670069}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=35 metric=0.6967 head_norm=1.377461
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.094121e-01
[S15] stored merged vector for next round verification (round=35)
[S15] DEBUG after merge:  round=35 metric=0.6967 head_norm=1.318173 delta_norm=0.209412
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] START round=35 head_norm_before_train=1.827497 cos_to_last_merge=0.8126 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.813
[S16] round=35 local utility u=0.452123 metrics={'f1_val': 0.9391943218127621, 'auprc': 0.9920749466362484, 'loss_val': 0.2998027117254568, 'psi': 0.9603465717421567}-{'f1_val': 0.8611909572117398, 'auprc': 0.9948034757601457, 'loss_val': 0.744214870539376, 'psi': 0.9146359646311022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=35 head_norm_before_train=1.637961 cos_to_last_merge=0.8132 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=35 local utility u=0.662618 metrics={'f1_val': 0.699067194553742, 'auprc': 0.8967725619812761, 'loss_val': 0.4390695376412164, 'psi': 0.7781493415247556}-{'f1_val': 0.6557256845236215, 'auprc': 0.7170099213018296, 'loss_val': 0.9649692513206064, 'psi': 0.6802393792349047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S2] START round=36 head_norm_before_train=1.813444 cos_to_last_merge=0.9979 (last merge round=29)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.6246558601662432, 'auprc': 0.6634781301354927, 'loss_val': 1.1480617365727919, 'psi': 0.640184768153943}-{'f1_val': 0.6529610328344327, 'auprc': 0.7019188390142393, 'loss_val': 0.8741091681606664, 'psi': 0.6725441553063554}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.988858 cos_to_last_merge=0.9957 (last merge round=30)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9960364889171824, 'auprc': 0.9996628420123699, 'loss_val': 0.05525979364543597, 'psi': 0.9974870301552574}-{'f1_val': 0.9965655661594752, 'auprc': 0.9995962793637216, 'loss_val': 0.05502289305396624, 'psi': 0.9977778514411738}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.988243 (no previous merge yet)
[S4] round=36 local utility u=0.050438 metrics={'f1_val': 0.9533009795675942, 'auprc': 0.9779721250227377, 'loss_val': 0.26499647007812777, 'psi': 0.9631694377496516}-{'f1_val': 0.9452485990046955, 'auprc': 0.9599431940861587, 'loss_val': 0.2634719276207097, 'psi': 0.9511264370372807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=36 head_norm_before_train=1.947408 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=36 local utility u=0.276962 metrics={'f1_val': 0.7975871919207661, 'auprc': 0.9751801924234293, 'loss_val': 0.22932867723928074, 'psi': 0.8686243921218314}-{'f1_val': 0.7003213174339138, 'auprc': 0.9913925041742054, 'loss_val': 0.24829402496230768, 'psi': 0.8167497921300304}
[S5] not sending this round → trigger blocked (psi=0.869)
[S6] START round=36 head_norm_before_train=1.304322 cos_to_last_merge=0.9994 (last merge round=33)
[S6] round=36 local utility u=1.000000 metrics={'f1_val': 0.9821995402768509, 'auprc': 0.9622402318254267, 'loss_val': 0.17682013337916452, 'psi': 0.9742158168962811}-{'f1_val': 0.5801238298062055, 'auprc': 0.7845156163386513, 'loss_val': 0.7577670562793185, 'psi': 0.6618805444191838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=36 head_norm_before_train=1.216490 cos_to_last_merge=0.9919 (last merge round=30)
[S7] round=36 local utility u=0.066386 metrics={'f1_val': 0.6854897563920931, 'auprc': 0.839867183361495, 'loss_val': 0.36908416548308476, 'psi': 0.7472407271798539}-{'f1_val': 0.6749956324343906, 'auprc': 0.8298175113852909, 'loss_val': 0.4087414831291377, 'psi': 0.7369243840147508}
[S8] START round=36 head_norm_before_train=1.915722 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.004938 metrics={'f1_val': 0.993553675737062, 'auprc': 0.9984132191993582, 'loss_val': 0.03751273332088408, 'psi': 0.9954974931219805}-{'f1_val': 0.9936297631890177, 'auprc': 0.9963286792632112, 'loss_val': 0.04159184074946112, 'psi': 0.9947093296186951}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=36 head_norm_before_train=1.946066 cos_to_last_merge=0.7501 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.750
[S9] round=36 local utility u=0.019773 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.997548818466111, 'loss_val': 0.01672942823771546, 'psi': 0.9972812748937301}-{'f1_val': 0.9912751909181616, 'auprc': 0.9992246728361891, 'loss_val': 0.02633617474407777, 'psi': 0.9944549836853727}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=36 head_norm_before_train=1.879284 cos_to_last_merge=0.9962 (last merge round=29)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.99430162626397, 'loss_val': 0.03810260349935867, 'psi': 0.9947015624246337}-{'f1_val': 0.9948593846939079, 'auprc': 0.9982534488475434, 'loss_val': 0.03686036916191535, 'psi': 0.996217010355362}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.820379 cos_to_last_merge=0.9999 (last merge round=33)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.996653962169664, 'loss_val': 0.029025524219296515, 'psi': 0.9963417898158512}-{'f1_val': 0.9963958538641108, 'auprc': 0.9967286612210339, 'loss_val': 0.028342540556069613, 'psi': 0.9965289768068801}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.818801 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=36 local utility u=0.095172 metrics={'f1_val': 0.606469644963282, 'auprc': 0.6716738281816821, 'loss_val': 0.748645647907855, 'psi': 0.632551318250642}-{'f1_val': 0.587708672745132, 'auprc': 0.6752201896319909, 'loss_val': 0.8370626351337358, 'psi': 0.6227132794998755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=36 head_norm_before_train=1.318071 cos_to_last_merge=0.9871 (last merge round=29)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9971495055636089, 'loss_val': 0.0649892478350809, 'psi': 0.9971589780240987}-{'f1_val': 0.9967774409524363, 'auprc': 0.9991308132305816, 'loss_val': 0.06720904285513331, 'psi': 0.9977187898636943}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.318173 cos_to_last_merge=1.0000 (last merge round=35)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.6968658138325746, 'auprc': 0.9866648159476028, 'loss_val': 0.4422311126313352, 'psi': 0.8127854146785859}-{'f1_val': 0.6967419968570036, 'auprc': 0.9893134904659738, 'loss_val': 0.4181105126556526, 'psi': 0.8137705943005917}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.837111 cos_to_last_merge=0.8121 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.812
[S16] round=36 local utility u=0.283402 metrics={'f1_val': 0.991074342971619, 'auprc': 0.9942748309529366, 'loss_val': 0.05087881792328534, 'psi': 0.9923545381641461}-{'f1_val': 0.9391943218127621, 'auprc': 0.9920749466362484, 'loss_val': 0.2998027117254568, 'psi': 0.9603465717421567}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=36 head_norm_before_train=1.649840 cos_to_last_merge=0.8120 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6579045884328051, 'auprc': 0.8838987828934897, 'loss_val': 0.8071836062948069, 'psi': 0.7483022662170788}-{'f1_val': 0.699067194553742, 'auprc': 0.8967725619812761, 'loss_val': 0.4390695376412164, 'psi': 0.7781493415247556}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.747)
[S2] START round=37 head_norm_before_train=1.825906 cos_to_last_merge=0.9971 (last merge round=29)
[S2] round=37 local utility u=0.424155 metrics={'f1_val': 0.6930162954596673, 'auprc': 0.7056103565224384, 'loss_val': 0.8363104978434827, 'psi': 0.6980539198847757}-{'f1_val': 0.6246558601662432, 'auprc': 0.6634781301354927, 'loss_val': 1.1480617365727919, 'psi': 0.640184768153943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] sending update (kind=head size=1792 to 1 peers)
[S3] START round=37 head_norm_before_train=2.003290 cos_to_last_merge=0.9948 (last merge round=30)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.927122789101104, 'auprc': 0.985190247699417, 'loss_val': 0.13702806567580408, 'psi': 0.9503497725404292}-{'f1_val': 0.9960364889171824, 'auprc': 0.9996628420123699, 'loss_val': 0.05525979364543597, 'psi': 0.9974870301552574}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.995635 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9519304965685593, 'auprc': 0.9747017204636467, 'loss_val': 0.26101277650424204, 'psi': 0.9610389861265942}-{'f1_val': 0.9533009795675942, 'auprc': 0.9779721250227377, 'loss_val': 0.26499647007812777, 'psi': 0.9631694377496516}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.952456 cos_to_last_merge=0.9999 (last merge round=34)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.7740373274199893, 'auprc': 0.9877405119548494, 'loss_val': 0.2281290770920661, 'psi': 0.8595186012339333}-{'f1_val': 0.7975871919207661, 'auprc': 0.9751801924234293, 'loss_val': 0.22932867723928074, 'psi': 0.8686243921218314}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.322089 cos_to_last_merge=0.9987 (last merge round=33)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.78328623012616, 'auprc': 0.9506080266013592, 'loss_val': 0.47665955253648573, 'psi': 0.8502149487162398}-{'f1_val': 0.9821995402768509, 'auprc': 0.9622402318254267, 'loss_val': 0.17682013337916452, 'psi': 0.9742158168962811}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.240887 cos_to_last_merge=0.9892 (last merge round=30)
[S7] round=37 local utility u=0.249958 metrics={'f1_val': 0.7007393759787767, 'auprc': 0.9386275581506769, 'loss_val': 0.25694747459887196, 'psi': 0.7958946488475368}-{'f1_val': 0.6854897563920931, 'auprc': 0.839867183361495, 'loss_val': 0.36908416548308476, 'psi': 0.7472407271798539}
[S8] START round=37 head_norm_before_train=1.926462 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9939465467499868, 'auprc': 0.997887902539254, 'loss_val': 0.04015265701210691, 'psi': 0.9955230890656936}-{'f1_val': 0.993553675737062, 'auprc': 0.9984132191993582, 'loss_val': 0.03751273332088408, 'psi': 0.9954974931219805}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.953484 cos_to_last_merge=0.7495 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.749
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9971979927403231, 'loss_val': 0.01812518824261257, 'psi': 0.997140944603415}-{'f1_val': 0.9971029125121428, 'auprc': 0.997548818466111, 'loss_val': 0.01672942823771546, 'psi': 0.9972812748937301}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.896699 cos_to_last_merge=0.9953 (last merge round=29)
[S10] round=37 local utility u=0.003132 metrics={'f1_val': 0.9939149604967501, 'auprc': 0.9978942112488195, 'loss_val': 0.03629778972236455, 'psi': 0.9955066607975779}-{'f1_val': 0.9949681865317428, 'auprc': 0.99430162626397, 'loss_val': 0.03810260349935867, 'psi': 0.9947015624246337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=37 head_norm_before_train=1.826913 cos_to_last_merge=0.9999 (last merge round=33)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9392577610619172, 'auprc': 0.9972057827026469, 'loss_val': 0.26057868057966066, 'psi': 0.9624369697182091}-{'f1_val': 0.9961336749133093, 'auprc': 0.996653962169664, 'loss_val': 0.029025524219296515, 'psi': 0.9963417898158512}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.821749 cos_to_last_merge=0.9999 (last merge round=33)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5994256301335383, 'auprc': 0.6799149729776688, 'loss_val': 0.7775559948916754, 'psi': 0.6316213672711906}-{'f1_val': 0.606469644963282, 'auprc': 0.6716738281816821, 'loss_val': 0.748645647907855, 'psi': 0.632551318250642}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.341386 cos_to_last_merge=0.9849 (last merge round=29)
[S14] round=37 local utility u=0.007609 metrics={'f1_val': 0.9972183481640888, 'auprc': 0.9992270128331583, 'loss_val': 0.05632249892721746, 'psi': 0.9980218140317165}-{'f1_val': 0.9971652929977585, 'auprc': 0.9971495055636089, 'loss_val': 0.0649892478350809, 'psi': 0.9971589780240987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=37 head_norm_before_train=1.369769 cos_to_last_merge=0.9992 (last merge round=35)
[S15] round=37 local utility u=1.000000 metrics={'f1_val': 0.9921062872762122, 'auprc': 0.9980810013446436, 'loss_val': 0.0813631542552168, 'psi': 0.9944961729035847}-{'f1_val': 0.6968658138325746, 'auprc': 0.9866648159476028, 'loss_val': 0.4422311126313352, 'psi': 0.8127854146785859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=37 head_norm_before_train=1.846281 cos_to_last_merge=0.8117 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.812
[S16] round=37 local utility u=0.013242 metrics={'f1_val': 0.9928508455745393, 'auprc': 0.9942895843603936, 'loss_val': 0.035099044441456034, 'psi': 0.9934263410888811}-{'f1_val': 0.991074342971619, 'auprc': 0.9942748309529366, 'loss_val': 0.05087881792328534, 'psi': 0.9923545381641461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=37 head_norm_before_train=1.662220 cos_to_last_merge=0.8107 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=37 local utility u=0.239009 metrics={'f1_val': 0.6986317039328764, 'auprc': 0.8879041359423625, 'loss_val': 0.5855451631997969, 'psi': 0.774340676736671}-{'f1_val': 0.6579045884328051, 'auprc': 0.8838987828934897, 'loss_val': 0.8071836062948069, 'psi': 0.7483022662170788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S2] START round=38 head_norm_before_train=1.838497 cos_to_last_merge=0.9963 (last merge round=29)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6451823685876266, 'auprc': 0.694189852143847, 'loss_val': 1.0018230918760105, 'psi': 0.6647853620101147}-{'f1_val': 0.6930162954596673, 'auprc': 0.7056103565224384, 'loss_val': 0.8363104978434827, 'psi': 0.6980539198847757}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=2.024044 cos_to_last_merge=0.9934 (last merge round=30)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.8594823439702564, 'auprc': 0.9799465822988996, 'loss_val': 0.21979408652371096, 'psi': 0.9076680393017136}-{'f1_val': 0.927122789101104, 'auprc': 0.985190247699417, 'loss_val': 0.13702806567580408, 'psi': 0.9503497725404292}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=2.000111 (no previous merge yet)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9441287721082701, 'auprc': 0.9595877964855356, 'loss_val': 0.25734188429982296, 'psi': 0.9503123818591763}-{'f1_val': 0.9519304965685593, 'auprc': 0.9747017204636467, 'loss_val': 0.26101277650424204, 'psi': 0.9610389861265942}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.958710 cos_to_last_merge=0.9998 (last merge round=34)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.6719045597630842, 'auprc': 0.8177555543486802, 'loss_val': 0.4166275844766443, 'psi': 0.7302449575973227}-{'f1_val': 0.7740373274199893, 'auprc': 0.9877405119548494, 'loss_val': 0.2281290770920661, 'psi': 0.8595186012339333}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.342943 cos_to_last_merge=0.9975 (last merge round=33)
[S6] round=38 local utility u=0.585080 metrics={'f1_val': 0.9423595752287893, 'auprc': 0.9593960791104021, 'loss_val': 0.28730472800567136, 'psi': 0.9491741767814345}-{'f1_val': 0.78328623012616, 'auprc': 0.9506080266013592, 'loss_val': 0.47665955253648573, 'psi': 0.8502149487162398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] sending update (kind=head size=1791 to 1 peers)
[S7] START round=38 head_norm_before_train=1.259168 cos_to_last_merge=0.9874 (last merge round=30)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6500681955553518, 'auprc': 0.8066502463263834, 'loss_val': 0.4774814297964342, 'psi': 0.7127010158637644}-{'f1_val': 0.7007393759787767, 'auprc': 0.9386275581506769, 'loss_val': 0.25694747459887196, 'psi': 0.7958946488475368}
[S8] START round=38 head_norm_before_train=1.937032 cos_to_last_merge=0.9999 (last merge round=35)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9928243971176908, 'auprc': 0.9984729238585119, 'loss_val': 0.037421485072837816, 'psi': 0.9950838078140192}-{'f1_val': 0.9939465467499868, 'auprc': 0.997887902539254, 'loss_val': 0.04015265701210691, 'psi': 0.9955230890656936}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.962406 cos_to_last_merge=0.7487 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.749
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.9992095012694304, 'loss_val': 0.027467871209314217, 'psi': 0.9944302886446625}-{'f1_val': 0.9971029125121428, 'auprc': 0.9971979927403231, 'loss_val': 0.01812518824261257, 'psi': 0.997140944603415}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.911970 cos_to_last_merge=0.9945 (last merge round=29)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.993830053475262, 'loss_val': 0.03620786375762414, 'psi': 0.9945129333091505}-{'f1_val': 0.9939149604967501, 'auprc': 0.9978942112488195, 'loss_val': 0.03629778972236455, 'psi': 0.9955066607975779}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.832115 cos_to_last_merge=0.9998 (last merge round=33)
[S11] round=38 local utility u=0.286947 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9969979436426917, 'loss_val': 0.02743990617170679, 'psi': 0.9964916623035239}-{'f1_val': 0.9392577610619172, 'auprc': 0.9972057827026469, 'loss_val': 0.26057868057966066, 'psi': 0.9624369697182091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=38 head_norm_before_train=1.825479 cos_to_last_merge=0.9998 (last merge round=33)
[S13] round=38 local utility u=0.048781 metrics={'f1_val': 0.6120174723461697, 'auprc': 0.6718911706843747, 'loss_val': 0.7314744218175003, 'psi': 0.6359669516814517}-{'f1_val': 0.5994256301335383, 'auprc': 0.6799149729776688, 'loss_val': 0.7775559948916754, 'psi': 0.6316213672711906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=38 head_norm_before_train=1.360745 cos_to_last_merge=0.9831 (last merge round=29)
[S14] round=38 local utility u=0.001832 metrics={'f1_val': 0.9972408627570057, 'auprc': 0.9988517650905884, 'loss_val': 0.05166786111504948, 'psi': 0.9978852236904387}-{'f1_val': 0.9972183481640888, 'auprc': 0.9992270128331583, 'loss_val': 0.05632249892721746, 'psi': 0.9980218140317165}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=38 head_norm_before_train=1.418078 cos_to_last_merge=0.9973 (last merge round=35)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7009202876340006, 'auprc': 0.9867922046027359, 'loss_val': 0.4732566489919244, 'psi': 0.8152690544214947}-{'f1_val': 0.9921062872762122, 'auprc': 0.9980810013446436, 'loss_val': 0.0813631542552168, 'psi': 0.9944961729035847}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.854675 cos_to_last_merge=0.8114 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.811
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9253091911640139, 'auprc': 0.9851141229333015, 'loss_val': 0.43638557655032, 'psi': 0.9492311638717289}-{'f1_val': 0.9928508455745393, 'auprc': 0.9942895843603936, 'loss_val': 0.035099044441456034, 'psi': 0.9934263410888811}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.676996 cos_to_last_merge=0.8092 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.809
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.678083241138237, 'auprc': 0.8906475982055978, 'loss_val': 0.8148444530526409, 'psi': 0.7631089839651813}-{'f1_val': 0.6986317039328764, 'auprc': 0.8879041359423625, 'loss_val': 0.5855451631997969, 'psi': 0.774340676736671}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.852042 cos_to_last_merge=0.9954 (last merge round=29)
[S2] round=39 local utility u=0.231463 metrics={'f1_val': 0.6908892357289624, 'auprc': 0.7047057121101638, 'loss_val': 0.8446861302720464, 'psi': 0.696415826281443}-{'f1_val': 0.6451823685876266, 'auprc': 0.694189852143847, 'loss_val': 1.0018230918760105, 'psi': 0.6647853620101147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S2] sending update (kind=head size=1787 to 1 peers)
[S2] r=40 psi=0.696 u=0.2315 p_local=0.1719 f1=0.691 auprc=0.705 bytes=32278
[S3] START round=39 head_norm_before_train=2.045749 cos_to_last_merge=0.9920 (last merge round=30)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.8159011803414786, 'auprc': 0.9331814115611013, 'loss_val': 0.3179955025572338, 'psi': 0.8628132728293277}-{'f1_val': 0.8594823439702564, 'auprc': 0.9799465822988996, 'loss_val': 0.21979408652371096, 'psi': 0.9076680393017136}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.863 u=0.0000 p_local=0.1435 f1=0.816 auprc=0.933 bytes=35963
[S4] START round=39 head_norm_before_train=2.007051 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9437633144781797, 'auprc': 0.9527041445708437, 'loss_val': 0.27049976374288914, 'psi': 0.9473396465152453}-{'f1_val': 0.9441287721082701, 'auprc': 0.9595877964855356, 'loss_val': 0.25734188429982296, 'psi': 0.9503123818591763}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.947 u=0.0000 p_local=0.0123 f1=0.944 auprc=0.953 bytes=39641
[S5] START round=39 head_norm_before_train=1.963306 cos_to_last_merge=0.9998 (last merge round=34)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.6447213622630602, 'auprc': 0.6653066164378882, 'loss_val': 0.5656921953542352, 'psi': 0.6529554639329914}-{'f1_val': 0.6719045597630842, 'auprc': 0.8177555543486802, 'loss_val': 0.4166275844766443, 'psi': 0.7302449575973227}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.653 u=0.0000 p_local=0.0918 f1=0.645 auprc=0.665 bytes=32338
[S6] START round=39 head_norm_before_train=1.375224 cos_to_last_merge=0.9955 (last merge round=33)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.6187505101830583, 'auprc': 0.8021254454451203, 'loss_val': 0.7071715929061905, 'psi': 0.6921004842878831}-{'f1_val': 0.9423595752287893, 'auprc': 0.9593960791104021, 'loss_val': 0.28730472800567136, 'psi': 0.9491741767814345}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.692 u=0.0000 p_local=0.3252 f1=0.619 auprc=0.802 bytes=35973
[S7] START round=39 head_norm_before_train=1.269019 cos_to_last_merge=0.9865 (last merge round=30)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5900641213466082, 'auprc': 0.7908891704648056, 'loss_val': 0.699874652759555, 'psi': 0.6703941409938872}-{'f1_val': 0.6500681955553518, 'auprc': 0.8066502463263834, 'loss_val': 0.4774814297964342, 'psi': 0.7127010158637644}
[S8] START round=39 head_norm_before_train=1.948294 cos_to_last_merge=0.9999 (last merge round=35)
[S8] round=39 local utility u=0.005046 metrics={'f1_val': 0.9943795289865018, 'auprc': 0.9981949837450731, 'loss_val': 0.03582718105661122, 'psi': 0.9959057108899304}-{'f1_val': 0.9928243971176908, 'auprc': 0.9984729238585119, 'loss_val': 0.037421485072837816, 'psi': 0.9950838078140192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S8] r=40 psi=0.996 u=0.0050 p_local=0.0169 f1=0.994 auprc=0.998 bytes=30556
[S9] START round=39 head_norm_before_train=1.969761 cos_to_last_merge=0.7479 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.748
[S9] round=39 local utility u=0.021443 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9976675682218712, 'loss_val': 0.01528099548254457, 'psi': 0.9973460810730139}-{'f1_val': 0.9912441468948172, 'auprc': 0.9992095012694304, 'loss_val': 0.027467871209314217, 'psi': 0.9944302886446625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S9] r=40 psi=0.997 u=0.0214 p_local=0.0095 f1=0.997 auprc=0.998 bytes=35980
[S10] START round=39 head_norm_before_train=1.926165 cos_to_last_merge=0.9936 (last merge round=29)
[S10] round=39 local utility u=0.006801 metrics={'f1_val': 0.9944204775781598, 'auprc': 0.9982930750154818, 'loss_val': 0.03270830480867114, 'psi': 0.9959695165530886}-{'f1_val': 0.9949681865317428, 'auprc': 0.993830053475262, 'loss_val': 0.03620786375762414, 'psi': 0.9945129333091505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S10] r=40 psi=0.996 u=0.0068 p_local=0.0055 f1=0.994 auprc=0.998 bytes=46738
[S11] START round=39 head_norm_before_train=1.839646 cos_to_last_merge=0.9997 (last merge round=33)
[S11] round=39 local utility u=0.002296 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9973731354516666, 'loss_val': 0.025423443703030093, 'psi': 0.9967867664991332}-{'f1_val': 0.9961541414107454, 'auprc': 0.9969979436426917, 'loss_val': 0.02743990617170679, 'psi': 0.9964916623035239}
[S11] not sending this round → trigger blocked (psi=0.997)
[S11] r=40 psi=0.997 u=0.0023 p_local=0.0497 f1=0.996 auprc=0.997 bytes=43105
[S13] START round=39 head_norm_before_train=1.830230 cos_to_last_merge=0.9998 (last merge round=33)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.5725480747675051, 'auprc': 0.6867476850532953, 'loss_val': 0.8214777126943815, 'psi': 0.6182279188818212}-{'f1_val': 0.6120174723461697, 'auprc': 0.6718911706843747, 'loss_val': 0.7314744218175003, 'psi': 0.6359669516814517}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.618 u=0.0000 p_local=0.0257 f1=0.573 auprc=0.687 bytes=35938
[S14] START round=39 head_norm_before_train=1.380365 cos_to_last_merge=0.9813 (last merge round=29)
[S14] round=39 local utility u=0.002475 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9992273868669798, 'loss_val': 0.048985213962620386, 'psi': 0.9981495850511696}-{'f1_val': 0.9972408627570057, 'auprc': 0.9988517650905884, 'loss_val': 0.05166786111504948, 'psi': 0.9978852236904387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S14] r=40 psi=0.998 u=0.0025 p_local=0.0092 f1=0.997 auprc=0.999 bytes=46764
[S15] START round=39 head_norm_before_train=1.459861 cos_to_last_merge=0.9952 (last merge round=35)
[S15] round=39 local utility u=1.000000 metrics={'f1_val': 0.9777299379225959, 'auprc': 0.9964480774028192, 'loss_val': 0.13081000939043197, 'psi': 0.9852171937146852}-{'f1_val': 0.7009202876340006, 'auprc': 0.9867922046027359, 'loss_val': 0.4732566489919244, 'psi': 0.8152690544214947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S15] r=40 psi=0.985 u=1.0000 p_local=0.4609 f1=0.978 auprc=0.996 bytes=35993
[S16] START round=39 head_norm_before_train=1.862111 cos_to_last_merge=0.8106 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.811
[S16] round=39 local utility u=0.413101 metrics={'f1_val': 0.9920139700014868, 'auprc': 0.9942467072280727, 'loss_val': 0.03781098441437213, 'psi': 0.9929070648921212}-{'f1_val': 0.9253091911640139, 'auprc': 0.9851141229333015, 'loss_val': 0.43638557655032, 'psi': 0.9492311638717289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S16] r=40 psi=0.993 u=0.4131 p_local=0.1677 f1=0.992 auprc=0.994 bytes=39562
[S17] START round=39 head_norm_before_train=1.691261 cos_to_last_merge=0.8077 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=39 local utility u=0.697818 metrics={'f1_val': 0.8052939242931905, 'auprc': 0.948451067634216, 'loss_val': 0.355883856057797, 'psi': 0.8625567816296007}-{'f1_val': 0.678083241138237, 'auprc': 0.8906475982055978, 'loss_val': 0.8148444530526409, 'psi': 0.7631089839651813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S17] r=40 psi=0.863 u=0.6978 p_local=0.3244 f1=0.805 auprc=0.948 bytes=35984
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.670 u=0.0000 p_local=0.1104 f1=0.590 auprc=0.791 bytes=35931
[S2] START round=40 head_norm_before_train=1.862009 cos_to_last_merge=0.9946 (last merge round=29)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.6514968758988967, 'auprc': 0.6963748882691533, 'loss_val': 0.9273401829249974, 'psi': 0.6694480808469994}-{'f1_val': 0.6908892357289624, 'auprc': 0.7047057121101638, 'loss_val': 0.8446861302720464, 'psi': 0.696415826281443}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.062358 cos_to_last_merge=0.9909 (last merge round=30)
[S3] round=40 local utility u=0.375755 metrics={'f1_val': 0.9028475678625264, 'auprc': 0.9708064784312583, 'loss_val': 0.201038187993066, 'psi': 0.9300311320900192}-{'f1_val': 0.8159011803414786, 'auprc': 0.9331814115611013, 'loss_val': 0.3179955025572338, 'psi': 0.8628132728293277}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=40 head_norm_before_train=2.014002 (no previous merge yet)
[S4] round=40 local utility u=0.052291 metrics={'f1_val': 0.9504891677303657, 'auprc': 0.975379966851841, 'loss_val': 0.2742994789059063, 'psi': 0.9604454873789559}-{'f1_val': 0.9437633144781797, 'auprc': 0.9527041445708437, 'loss_val': 0.27049976374288914, 'psi': 0.9473396465152453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=40 head_norm_before_train=1.971146 cos_to_last_merge=0.9997 (last merge round=34)
[S5] round=40 local utility u=0.763511 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9800737323725155, 'loss_val': 0.31760264643965336, 'psi': 0.8123254698302977}-{'f1_val': 0.6447213622630602, 'auprc': 0.6653066164378882, 'loss_val': 0.5656921953542352, 'psi': 0.6529554639329914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] sending update (kind=head size=1792 to 1 peers)
[S6] START round=40 head_norm_before_train=1.411615 cos_to_last_merge=0.9930 (last merge round=33)
[S6] round=40 local utility u=1.000000 metrics={'f1_val': 0.8496817363143069, 'auprc': 0.9608537836726914, 'loss_val': 0.2385999885829187, 'psi': 0.8941505552576607}-{'f1_val': 0.6187505101830583, 'auprc': 0.8021254454451203, 'loss_val': 0.7071715929061905, 'psi': 0.6921004842878831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=40 head_norm_before_train=1.282235 cos_to_last_merge=0.9853 (last merge round=30)
[S7] round=40 local utility u=0.201163 metrics={'f1_val': 0.6365340363425674, 'auprc': 0.7998381528173051, 'loss_val': 0.6032151417019254, 'psi': 0.7018556829324625}-{'f1_val': 0.5900641213466082, 'auprc': 0.7908891704648056, 'loss_val': 0.699874652759555, 'psi': 0.6703941409938872}
[S8] START round=40 head_norm_before_train=1.958897 cos_to_last_merge=0.9998 (last merge round=35)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9939974855123931, 'auprc': 0.9963151642883138, 'loss_val': 0.03637480067997987, 'psi': 0.9949245570227614}-{'f1_val': 0.9943795289865018, 'auprc': 0.9981949837450731, 'loss_val': 0.03582718105661122, 'psi': 0.9959057108899304}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.980064 cos_to_last_merge=0.7470 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.747
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9972279933087543, 'loss_val': 0.016230793027842007, 'psi': 0.9971529448307874}-{'f1_val': 0.9971317563071089, 'auprc': 0.9976675682218712, 'loss_val': 0.01528099548254457, 'psi': 0.9973460810730139}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.938049 cos_to_last_merge=0.9931 (last merge round=29)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9955756081681677, 'loss_val': 0.03279159688476822, 'psi': 0.9950794087988906}-{'f1_val': 0.9944204775781598, 'auprc': 0.9982930750154818, 'loss_val': 0.03270830480867114, 'psi': 0.9959695165530886}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.848970 cos_to_last_merge=0.9996 (last merge round=33)
[S11] round=40 local utility u=0.000743 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9973089448730045, 'loss_val': 0.024774578329722245, 'psi': 0.99686406033293}-{'f1_val': 0.9963958538641108, 'auprc': 0.9973731354516666, 'loss_val': 0.025423443703030093, 'psi': 0.9967867664991332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=40 head_norm_before_train=1.834608 cos_to_last_merge=0.9996 (last merge round=33)
[S13] round=40 local utility u=0.082952 metrics={'f1_val': 0.5905823464622211, 'auprc': 0.6753451002226428, 'loss_val': 0.7295711022195744, 'psi': 0.6244874479663898}-{'f1_val': 0.5725480747675051, 'auprc': 0.6867476850532953, 'loss_val': 0.8214777126943815, 'psi': 0.6182279188818212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=40 head_norm_before_train=1.399517 cos_to_last_merge=0.9796 (last merge round=29)
[S14] round=40 local utility u=0.002183 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9988525767010173, 'loss_val': 0.044682920537227916, 'psi': 0.9981184965173433}-{'f1_val': 0.9974310505072961, 'auprc': 0.9992273868669798, 'loss_val': 0.048985213962620386, 'psi': 0.9981495850511696}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=40 head_norm_before_train=1.498726 cos_to_last_merge=0.9930 (last merge round=35)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6975894049252358, 'auprc': 0.9739174539992201, 'loss_val': 0.5191466165487397, 'psi': 0.8081206245548296}-{'f1_val': 0.9777299379225959, 'auprc': 0.9964480774028192, 'loss_val': 0.13081000939043197, 'psi': 0.9852171937146852}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.868346 cos_to_last_merge=0.8103 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.810
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.94334777939804, 'auprc': 0.9946650808089981, 'loss_val': 0.1880730881623438, 'psi': 0.9638746999624233}-{'f1_val': 0.9920139700014868, 'auprc': 0.9942467072280727, 'loss_val': 0.03781098441437213, 'psi': 0.9929070648921212}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.704066 cos_to_last_merge=0.8064 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.806
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6634837289165649, 'auprc': 0.7318614858574586, 'loss_val': 0.9386112505082062, 'psi': 0.6908348316929224}-{'f1_val': 0.8052939242931905, 'auprc': 0.948451067634216, 'loss_val': 0.355883856057797, 'psi': 0.8625567816296007}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S2] START round=41 head_norm_before_train=1.870502 cos_to_last_merge=0.9939 (last merge round=29)
[S2] round=41 local utility u=0.181607 metrics={'f1_val': 0.6826642122281447, 'auprc': 0.7281821802589445, 'loss_val': 0.846551296948605, 'psi': 0.7008713994404646}-{'f1_val': 0.6514968758988967, 'auprc': 0.6963748882691533, 'loss_val': 0.9273401829249974, 'psi': 0.6694480808469994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] sending update (kind=head size=1790 to 1 peers)
[S3] START round=41 head_norm_before_train=2.076090 cos_to_last_merge=0.9899 (last merge round=30)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.8291529369877031, 'auprc': 0.9423243597521019, 'loss_val': 0.3210694028616694, 'psi': 0.8744215060934626}-{'f1_val': 0.9028475678625264, 'auprc': 0.9708064784312583, 'loss_val': 0.201038187993066, 'psi': 0.9300311320900192}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=2.022020 (no previous merge yet)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9516502335086751, 'auprc': 0.9638481701908201, 'loss_val': 0.2868185943278031, 'psi': 0.9565294081815331}-{'f1_val': 0.9504891677303657, 'auprc': 0.975379966851841, 'loss_val': 0.2742994789059063, 'psi': 0.9604454873789559}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.975504 cos_to_last_merge=0.9995 (last merge round=34)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.4474015458974093, 'auprc': 0.8469826572775502, 'loss_val': 0.9802801883768197, 'psi': 0.6072339904494657}-{'f1_val': 0.7004932948021524, 'auprc': 0.9800737323725155, 'loss_val': 0.31760264643965336, 'psi': 0.8123254698302977}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.443352 cos_to_last_merge=0.9908 (last merge round=33)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.6668109465328069, 'auprc': 0.8086490424669425, 'loss_val': 0.6716777162107225, 'psi': 0.7235461849064612}-{'f1_val': 0.8496817363143069, 'auprc': 0.9608537836726914, 'loss_val': 0.2385999885829187, 'psi': 0.8941505552576607}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.292095 cos_to_last_merge=0.9836 (last merge round=30)
[S7] round=41 local utility u=0.276275 metrics={'f1_val': 0.6779049762941318, 'auprc': 0.8304168961377316, 'loss_val': 0.39062694246753904, 'psi': 0.7389097442315717}-{'f1_val': 0.6365340363425674, 'auprc': 0.7998381528173051, 'loss_val': 0.6032151417019254, 'psi': 0.7018556829324625}
[S8] START round=41 head_norm_before_train=1.971081 cos_to_last_merge=0.9997 (last merge round=35)
[S8] round=41 local utility u=0.003049 metrics={'f1_val': 0.9932225217693944, 'auprc': 0.9987070970937206, 'loss_val': 0.03280357489098578, 'psi': 0.9954163518991249}-{'f1_val': 0.9939974855123931, 'auprc': 0.9963151642883138, 'loss_val': 0.03637480067997987, 'psi': 0.9949245570227614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=41 head_norm_before_train=1.988649 cos_to_last_merge=0.7466 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.747
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9971417837100818, 'loss_val': 0.016274417181834658, 'psi': 0.9971184609913184}-{'f1_val': 0.9971029125121428, 'auprc': 0.9972279933087543, 'loss_val': 0.016230793027842007, 'psi': 0.9971529448307874}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.950137 cos_to_last_merge=0.9925 (last merge round=29)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9949288945942466, 'loss_val': 0.03259840902743556, 'psi': 0.9949524697567443}-{'f1_val': 0.9947486092193725, 'auprc': 0.9955756081681677, 'loss_val': 0.03279159688476822, 'psi': 0.9950794087988906}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.859265 cos_to_last_merge=0.9995 (last merge round=33)
[S11] round=41 local utility u=0.000193 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9974505993176569, 'loss_val': 0.024812558547185032, 'psi': 0.996920722110791}-{'f1_val': 0.996567470639547, 'auprc': 0.9973089448730045, 'loss_val': 0.024774578329722245, 'psi': 0.99686406033293}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=41 head_norm_before_train=1.838244 cos_to_last_merge=0.9992 (last merge round=33)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.5588819650568019, 'auprc': 0.6825618154542031, 'loss_val': 0.7871721400113081, 'psi': 0.6083539052157624}-{'f1_val': 0.5905823464622211, 'auprc': 0.6753451002226428, 'loss_val': 0.7295711022195744, 'psi': 0.6244874479663898}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.417994 cos_to_last_merge=0.9779 (last merge round=29)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9969981421187261, 'auprc': 0.9988518930745398, 'loss_val': 0.04153020213518383, 'psi': 0.9977396425010516}-{'f1_val': 0.9976291097282272, 'auprc': 0.9988525767010173, 'loss_val': 0.044682920537227916, 'psi': 0.9981184965173433}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.533683 cos_to_last_merge=0.9909 (last merge round=35)
[S15] round=41 local utility u=1.000000 metrics={'f1_val': 0.9668676642864944, 'auprc': 0.9954511210347123, 'loss_val': 0.08270285515977951, 'psi': 0.9783010469857816}-{'f1_val': 0.6975894049252358, 'auprc': 0.9739174539992201, 'loss_val': 0.5191466165487397, 'psi': 0.8081206245548296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=41 head_norm_before_train=1.873581 cos_to_last_merge=0.8103 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.810
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9379302127385635, 'auprc': 0.9902171581609592, 'loss_val': 0.3380187129346316, 'psi': 0.9588449909075217}-{'f1_val': 0.94334777939804, 'auprc': 0.9946650808089981, 'loss_val': 0.1880730881623438, 'psi': 0.9638746999624233}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.717899 cos_to_last_merge=0.8049 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.805
[S17] round=41 local utility u=1.000000 metrics={'f1_val': 0.8095673656513899, 'auprc': 0.9437160056273983, 'loss_val': 0.4040971976990205, 'psi': 0.8632268216417933}-{'f1_val': 0.6634837289165649, 'auprc': 0.7318614858574586, 'loss_val': 0.9386112505082062, 'psi': 0.6908348316929224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S7]  timeout peer S14
[S7] not sending this round → trigger blocked (psi=0.739)
[S2] START round=42 head_norm_before_train=1.877904 cos_to_last_merge=0.9933 (last merge round=29)
[S2] round=42 local utility u=0.127240 metrics={'f1_val': 0.7180631633622723, 'auprc': 0.723999972546134, 'loss_val': 0.7919174971620558, 'psi': 0.720437887035817}-{'f1_val': 0.6826642122281447, 'auprc': 0.7281821802589445, 'loss_val': 0.846551296948605, 'psi': 0.7008713994404646}
[S2] not sending this round → trigger blocked (psi=0.720)
[S3] START round=42 head_norm_before_train=2.088760 cos_to_last_merge=0.9889 (last merge round=30)
[S3] round=42 local utility u=0.523500 metrics={'f1_val': 0.9508700477788632, 'auprc': 0.9825835107888944, 'loss_val': 0.12514990609504648, 'psi': 0.9635554329828757}-{'f1_val': 0.8291529369877031, 'auprc': 0.9423243597521019, 'loss_val': 0.3210694028616694, 'psi': 0.8744215060934626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=42 head_norm_before_train=2.028098 (no previous merge yet)
[S4] round=42 local utility u=0.011687 metrics={'f1_val': 0.9488714163605309, 'auprc': 0.9730115434001817, 'loss_val': 0.2742618030051866, 'psi': 0.9585274671763913}-{'f1_val': 0.9516502335086751, 'auprc': 0.9638481701908201, 'loss_val': 0.2868185943278031, 'psi': 0.9565294081815331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=42 head_norm_before_train=1.978369 cos_to_last_merge=0.9992 (last merge round=34)
[S5] round=42 local utility u=0.261870 metrics={'f1_val': 0.582008543428009, 'auprc': 0.7043608391639633, 'loss_val': 0.8363158853822215, 'psi': 0.6309494617223907}-{'f1_val': 0.4474015458974093, 'auprc': 0.8469826572775502, 'loss_val': 0.9802801883768197, 'psi': 0.6072339904494657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=42 head_norm_before_train=1.469563 cos_to_last_merge=0.9887 (last merge round=33)
[S6] round=42 local utility u=0.624708 metrics={'f1_val': 0.7816282357190253, 'auprc': 0.9420064077508258, 'loss_val': 0.5112370403651304, 'psi': 0.8457795045317456}-{'f1_val': 0.6668109465328069, 'auprc': 0.8086490424669425, 'loss_val': 0.6716777162107225, 'psi': 0.7235461849064612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=42 head_norm_before_train=1.304778 cos_to_last_merge=0.9820 (last merge round=30)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.668124662074534, 'auprc': 0.8236730679380586, 'loss_val': 0.39929627082727026, 'psi': 0.730344024419944}-{'f1_val': 0.6779049762941318, 'auprc': 0.8304168961377316, 'loss_val': 0.39062694246753904, 'psi': 0.7389097442315717}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.983624 cos_to_last_merge=0.9995 (last merge round=35)
[S8] round=42 local utility u=0.001326 metrics={'f1_val': 0.9935799906887397, 'auprc': 0.9989396909587879, 'loss_val': 0.03299419186688968, 'psi': 0.9957238707967591}-{'f1_val': 0.9932225217693944, 'auprc': 0.9987070970937206, 'loss_val': 0.03280357489098578, 'psi': 0.9954163518991249}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=42 head_norm_before_train=1.994543 cos_to_last_merge=0.7468 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.747
[S9] round=42 local utility u=0.000244 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9973375955761012, 'loss_val': 0.0163747795254612, 'psi': 0.9971967857377262}-{'f1_val': 0.9971029125121428, 'auprc': 0.9971417837100818, 'loss_val': 0.016274417181834658, 'psi': 0.9971184609913184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=42 head_norm_before_train=1.961758 cos_to_last_merge=0.9919 (last merge round=29)
[S10] round=42 local utility u=0.002230 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9976974757622428, 'loss_val': 0.030672509389842978, 'psi': 0.9954827868618373}-{'f1_val': 0.9949681865317428, 'auprc': 0.9949288945942466, 'loss_val': 0.03259840902743556, 'psi': 0.9949524697567443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=42 head_norm_before_train=1.869391 cos_to_last_merge=0.9994 (last merge round=33)
[S11] round=42 local utility u=0.001901 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9976893681025752, 'loss_val': 0.023178091062869204, 'psi': 0.9971612570967774}-{'f1_val': 0.996567470639547, 'auprc': 0.9974505993176569, 'loss_val': 0.024812558547185032, 'psi': 0.996920722110791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=42 head_norm_before_train=1.842391 cos_to_last_merge=0.9989 (last merge round=33)
[S13] round=42 local utility u=0.091388 metrics={'f1_val': 0.5905017910877433, 'auprc': 0.6721011961837073, 'loss_val': 0.762734223337022, 'psi': 0.6231415531261288}-{'f1_val': 0.5588819650568019, 'auprc': 0.6825618154542031, 'loss_val': 0.7871721400113081, 'psi': 0.6083539052157624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=42 head_norm_before_train=1.435145 cos_to_last_merge=0.9763 (last merge round=29)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9553991601490152, 'auprc': 0.9968110114220026, 'loss_val': 0.08492063758289481, 'psi': 0.9719639006582101}-{'f1_val': 0.9969981421187261, 'auprc': 0.9988518930745398, 'loss_val': 0.04153020213518383, 'psi': 0.9977396425010516}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.562979 cos_to_last_merge=0.9889 (last merge round=35)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7775834742522253, 'auprc': 0.9930231469389725, 'loss_val': 0.385817319964925, 'psi': 0.8637593433269242}-{'f1_val': 0.9668676642864944, 'auprc': 0.9954511210347123, 'loss_val': 0.08270285515977951, 'psi': 0.9783010469857816}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.872280 cos_to_last_merge=0.8098 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.810
[S16] round=42 local utility u=0.111042 metrics={'f1_val': 0.9397823614164226, 'auprc': 0.9933071442884548, 'loss_val': 0.13631800477912395, 'psi': 0.9611922745652355}-{'f1_val': 0.9379302127385635, 'auprc': 0.9902171581609592, 'loss_val': 0.3380187129346316, 'psi': 0.9588449909075217}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=42 head_norm_before_train=1.732124 cos_to_last_merge=0.8036 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.804
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6549547934801377, 'auprc': 0.7232565182760522, 'loss_val': 1.0542175074244093, 'psi': 0.6822754833985035}-{'f1_val': 0.8095673656513899, 'auprc': 0.9437160056273983, 'loss_val': 0.4040971976990205, 'psi': 0.8632268216417933}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.885148 cos_to_last_merge=0.9929 (last merge round=29)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.6707904699640712, 'auprc': 0.7252507411489604, 'loss_val': 0.9590550695594744, 'psi': 0.6925745784380268}-{'f1_val': 0.7180631633622723, 'auprc': 0.723999972546134, 'loss_val': 0.7919174971620558, 'psi': 0.720437887035817}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=2.104040 cos_to_last_merge=0.9878 (last merge round=30)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9442046347285002, 'auprc': 0.9745520962290047, 'loss_val': 0.15863463746969308, 'psi': 0.956343619328702}-{'f1_val': 0.9508700477788632, 'auprc': 0.9825835107888944, 'loss_val': 0.12514990609504648, 'psi': 0.9635554329828757}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=2.032639 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9404203447791419, 'auprc': 0.9482754258496872, 'loss_val': 0.2679848367580981, 'psi': 0.94356237720736}-{'f1_val': 0.9488714163605309, 'auprc': 0.9730115434001817, 'loss_val': 0.2742618030051866, 'psi': 0.9585274671763913}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.981598 cos_to_last_merge=0.9992 (last merge round=34)
[S5] round=43 local utility u=0.580000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.7251368868954703, 'loss_val': 0.4490334638138568, 'psi': 0.7102989005867492}-{'f1_val': 0.582008543428009, 'auprc': 0.7043608391639633, 'loss_val': 0.8363158853822215, 'psi': 0.6309494617223907}
[S5] not sending this round → trigger blocked (psi=0.710)
[S6] START round=43 head_norm_before_train=1.491579 cos_to_last_merge=0.9868 (last merge round=33)
[S6] round=43 local utility u=0.179219 metrics={'f1_val': 0.8211653240968341, 'auprc': 0.9531538251618625, 'loss_val': 0.4234636164890027, 'psi': 0.8739607245228455}-{'f1_val': 0.7816282357190253, 'auprc': 0.9420064077508258, 'loss_val': 0.5112370403651304, 'psi': 0.8457795045317456}
[S6] not sending this round → trigger blocked (psi=0.874)
[S7] START round=43 head_norm_before_train=1.316339 cos_to_last_merge=0.9811 (last merge round=30)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.6387862276058649, 'auprc': 0.8068180454164292, 'loss_val': 0.49526522371943776, 'psi': 0.7059989547300907}-{'f1_val': 0.668124662074534, 'auprc': 0.8236730679380586, 'loss_val': 0.39929627082727026, 'psi': 0.730344024419944}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.991745 cos_to_last_merge=0.9993 (last merge round=35)
[S8] round=43 local utility u=0.001478 metrics={'f1_val': 0.9938326055531397, 'auprc': 0.9988840561024126, 'loss_val': 0.031386213959303244, 'psi': 0.9958531857728489}-{'f1_val': 0.9935799906887397, 'auprc': 0.9989396909587879, 'loss_val': 0.03299419186688968, 'psi': 0.9957238707967591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=43 head_norm_before_train=2.001078 cos_to_last_merge=0.7464 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.746
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9969794629964475, 'loss_val': 0.01669570795966543, 'psi': 0.9970535327058647}-{'f1_val': 0.9971029125121428, 'auprc': 0.9973375955761012, 'loss_val': 0.0163747795254612, 'psi': 0.9971967857377262}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.972912 cos_to_last_merge=0.9913 (last merge round=29)
[S10] round=43 local utility u=0.001564 metrics={'f1_val': 0.9944204775781598, 'auprc': 0.9979143697813558, 'loss_val': 0.030679925888223596, 'psi': 0.9958180344594382}-{'f1_val': 0.9940063275949004, 'auprc': 0.9976974757622428, 'loss_val': 0.030672509389842978, 'psi': 0.9954827868618373}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=43 head_norm_before_train=1.880498 cos_to_last_merge=0.9993 (last merge round=33)
[S11] round=43 local utility u=0.000242 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.997678702130466, 'loss_val': 0.02266124914993494, 'psi': 0.9971569907079337}-{'f1_val': 0.9968091830929121, 'auprc': 0.9976893681025752, 'loss_val': 0.023178091062869204, 'psi': 0.9971612570967774}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=43 head_norm_before_train=1.843874 cos_to_last_merge=0.9989 (last merge round=33)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5666897957538385, 'auprc': 0.6841177777873768, 'loss_val': 0.8030085526797448, 'psi': 0.6136609885672538}-{'f1_val': 0.5905017910877433, 'auprc': 0.6721011961837073, 'loss_val': 0.762734223337022, 'psi': 0.6231415531261288}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.450035 cos_to_last_merge=0.9750 (last merge round=29)
[S14] round=43 local utility u=0.148998 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9971558409726619, 'loss_val': 0.038693495231907744, 'psi': 0.9971752575911788}-{'f1_val': 0.9553991601490152, 'auprc': 0.9968110114220026, 'loss_val': 0.08492063758289481, 'psi': 0.9719639006582101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=43 head_norm_before_train=1.591473 cos_to_last_merge=0.9871 (last merge round=35)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.6967136548306493, 'auprc': 0.9712438051028979, 'loss_val': 0.5447982645210161, 'psi': 0.8065257149395487}-{'f1_val': 0.7775834742522253, 'auprc': 0.9930231469389725, 'loss_val': 0.385817319964925, 'psi': 0.8637593433269242}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.874272 cos_to_last_merge=0.8094 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.809
[S16] round=43 local utility u=0.208463 metrics={'f1_val': 0.9930642524020498, 'auprc': 0.9917939448716329, 'loss_val': 0.034543252873682956, 'psi': 0.992556129389883}-{'f1_val': 0.9397823614164226, 'auprc': 0.9933071442884548, 'loss_val': 0.13631800477912395, 'psi': 0.9611922745652355}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=43 head_norm_before_train=1.743546 cos_to_last_merge=0.8022 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.802
[S17] round=43 local utility u=1.000000 metrics={'f1_val': 0.8519524738703856, 'auprc': 0.96622921827643, 'loss_val': 0.2778443517421621, 'psi': 0.8976631716328034}-{'f1_val': 0.6549547934801377, 'auprc': 0.7232565182760522, 'loss_val': 1.0542175074244093, 'psi': 0.6822754833985035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=44 head_norm_before_train=1.892679 cos_to_last_merge=0.9923 (last merge round=29)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.6584076536916919, 'auprc': 0.7195342035649369, 'loss_val': 1.076198214451115, 'psi': 0.6828582736409898}-{'f1_val': 0.6707904699640712, 'auprc': 0.7252507411489604, 'loss_val': 0.9590550695594744, 'psi': 0.6925745784380268}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.118400 cos_to_last_merge=0.9869 (last merge round=30)
[S3] round=44 local utility u=0.006766 metrics={'f1_val': 0.938542113837728, 'auprc': 0.9825518188479107, 'loss_val': 0.1351262675919186, 'psi': 0.956145995841801}-{'f1_val': 0.9442046347285002, 'auprc': 0.9745520962290047, 'loss_val': 0.15863463746969308, 'psi': 0.956343619328702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=44 head_norm_before_train=2.036729 (no previous merge yet)
[S4] round=44 local utility u=0.044385 metrics={'f1_val': 0.9475139334808101, 'auprc': 0.9619250940360797, 'loss_val': 0.26272578076885317, 'psi': 0.953278397702918}-{'f1_val': 0.9404203447791419, 'auprc': 0.9482754258496872, 'loss_val': 0.2679848367580981, 'psi': 0.94356237720736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=44 head_norm_before_train=1.984089 cos_to_last_merge=0.9992 (last merge round=34)
[S5] round=44 local utility u=0.246402 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8750331462682017, 'loss_val': 0.4054000110331734, 'psi': 0.7702056176020962}-{'f1_val': 0.7004069097142683, 'auprc': 0.7251368868954703, 'loss_val': 0.4490334638138568, 'psi': 0.7102989005867492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] sending update (kind=head size=1791 to 1 peers)
[S6] START round=44 head_norm_before_train=1.508696 cos_to_last_merge=0.9850 (last merge round=33)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.8208748829053008, 'auprc': 0.9469608976929071, 'loss_val': 0.4200645778023605, 'psi': 0.8713092888203433}-{'f1_val': 0.8211653240968341, 'auprc': 0.9531538251618625, 'loss_val': 0.4234636164890027, 'psi': 0.8739607245228455}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.331679 cos_to_last_merge=0.9794 (last merge round=30)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.6197973465599901, 'auprc': 0.7954317447219745, 'loss_val': 0.7347617472004531, 'psi': 0.6900511058247838}-{'f1_val': 0.6387862276058649, 'auprc': 0.8068180454164292, 'loss_val': 0.49526522371943776, 'psi': 0.7059989547300907}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.997528 cos_to_last_merge=0.9993 (last merge round=35)
[S8] round=44 local utility u=0.000843 metrics={'f1_val': 0.9938326055531397, 'auprc': 0.999026055124949, 'loss_val': 0.03012582043171313, 'psi': 0.9959099853818635}-{'f1_val': 0.9938326055531397, 'auprc': 0.9988840561024126, 'loss_val': 0.031386213959303244, 'psi': 0.9958531857728489}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=44 head_norm_before_train=2.005913 cos_to_last_merge=0.7460 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.746
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9968467757265378, 'loss_val': 0.019001806561703534, 'psi': 0.9970004577979008}-{'f1_val': 0.9971029125121428, 'auprc': 0.9969794629964475, 'loss_val': 0.01669570795966543, 'psi': 0.9970535327058647}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.982816 cos_to_last_merge=0.9908 (last merge round=29)
[S10] round=44 local utility u=0.003235 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9977672905734476, 'loss_val': 0.029083931937908383, 'psi': 0.996290714796424}-{'f1_val': 0.9944204775781598, 'auprc': 0.9979143697813558, 'loss_val': 0.030679925888223596, 'psi': 0.9958180344594382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=44 head_norm_before_train=1.892466 cos_to_last_merge=0.9991 (last merge round=33)
[S11] round=44 local utility u=0.000050 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9976033121454937, 'loss_val': 0.022335560872270187, 'psi': 0.9971268347139448}-{'f1_val': 0.9968091830929121, 'auprc': 0.997678702130466, 'loss_val': 0.02266124914993494, 'psi': 0.9971569907079337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] sending update (kind=head size=1790 to 1 peers)
[S13] START round=44 head_norm_before_train=1.847949 cos_to_last_merge=0.9987 (last merge round=33)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5593877085188832, 'auprc': 0.6845995086303511, 'loss_val': 0.7996160213085132, 'psi': 0.6094724285634704}-{'f1_val': 0.5666897957538385, 'auprc': 0.6841177777873768, 'loss_val': 0.8030085526797448, 'psi': 0.6136609885672538}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.463537 cos_to_last_merge=0.9736 (last merge round=29)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9957188009563763, 'loss_val': 0.03903457564510396, 'psi': 0.9962237471528093}-{'f1_val': 0.9971882020035234, 'auprc': 0.9971558409726619, 'loss_val': 0.038693495231907744, 'psi': 0.9971752575911788}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.615474 cos_to_last_merge=0.9854 (last merge round=35)
[S15] round=44 local utility u=1.000000 metrics={'f1_val': 0.9855321058438681, 'auprc': 0.9982595142502101, 'loss_val': 0.07536693728178857, 'psi': 0.9906230692064049}-{'f1_val': 0.6967136548306493, 'auprc': 0.9712438051028979, 'loss_val': 0.5447982645210161, 'psi': 0.8065257149395487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=44 head_norm_before_train=1.879969 cos_to_last_merge=0.8091 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.809
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9906166001291218, 'auprc': 0.9899133725564958, 'loss_val': 0.045497028720351364, 'psi': 0.9903353091000713}-{'f1_val': 0.9930642524020498, 'auprc': 0.9917939448716329, 'loss_val': 0.034543252873682956, 'psi': 0.992556129389883}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.753052 cos_to_last_merge=0.8012 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.801
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6876370922982746, 'auprc': 0.8977348916825214, 'loss_val': 0.839631438857776, 'psi': 0.7716762120519733}-{'f1_val': 0.8519524738703856, 'auprc': 0.96622921827643, 'loss_val': 0.2778443517421621, 'psi': 0.8976631716328034}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.901408 cos_to_last_merge=0.9917 (last merge round=29)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.540284575315191, 'auprc': 0.5900953275352254, 'loss_val': 1.909212112483412, 'psi': 0.5602088762032048}-{'f1_val': 0.6584076536916919, 'auprc': 0.7195342035649369, 'loss_val': 1.076198214451115, 'psi': 0.6828582736409898}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.132474 cos_to_last_merge=0.9856 (last merge round=30)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.7938625186046637, 'auprc': 0.9169656331793812, 'loss_val': 0.42505001751194504, 'psi': 0.8431037644345507}-{'f1_val': 0.938542113837728, 'auprc': 0.9825518188479107, 'loss_val': 0.1351262675919186, 'psi': 0.956145995841801}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=2.043040 (no previous merge yet)
[S4] round=45 local utility u=0.012681 metrics={'f1_val': 0.953365098504463, 'auprc': 0.9662925930420814, 'loss_val': 0.28557243771662266, 'psi': 0.9585360963195104}-{'f1_val': 0.9475139334808101, 'auprc': 0.9619250940360797, 'loss_val': 0.26272578076885317, 'psi': 0.953278397702918}
[S4] not sending this round → trigger blocked (psi=0.959)
[S5] START round=45 head_norm_before_train=1.986078 cos_to_last_merge=0.9992 (last merge round=34)
[S5] round=45 local utility u=0.073785 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9226514222670622, 'loss_val': 0.4012030329909605, 'psi': 0.789304714735386}-{'f1_val': 0.700320598491359, 'auprc': 0.8750331462682017, 'loss_val': 0.4054000110331734, 'psi': 0.7702056176020962}
[S5] not sending this round → trigger blocked (psi=0.789)
[S6] START round=45 head_norm_before_train=1.523571 cos_to_last_merge=0.9836 (last merge round=33)
[S6] round=45 local utility u=0.174957 metrics={'f1_val': 0.8609009860483092, 'auprc': 0.9459835907203162, 'loss_val': 0.307375274526487, 'psi': 0.894934027917112}-{'f1_val': 0.8208748829053008, 'auprc': 0.9469608976929071, 'loss_val': 0.4200645778023605, 'psi': 0.8713092888203433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=45 head_norm_before_train=1.348277 cos_to_last_merge=0.9771 (last merge round=30)
[S7] round=45 local utility u=1.000000 metrics={'f1_val': 0.9176555506403956, 'auprc': 0.9960562751930411, 'loss_val': 0.14625358283419587, 'psi': 0.9490158404614537}-{'f1_val': 0.6197973465599901, 'auprc': 0.7954317447219745, 'loss_val': 0.7347617472004531, 'psi': 0.6900511058247838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=45 head_norm_before_train=2.006197 cos_to_last_merge=0.9992 (last merge round=35)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9938326055531397, 'auprc': 0.9991204502858795, 'loss_val': 0.03316691636623934, 'psi': 0.9959477434462356}-{'f1_val': 0.9938326055531397, 'auprc': 0.999026055124949, 'loss_val': 0.03012582043171313, 'psi': 0.9959099853818635}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=2.010409 cos_to_last_merge=0.7454 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.745
[S9] round=45 local utility u=0.006227 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9992194801742292, 'loss_val': 0.016131935168519948, 'psi': 0.9981960825237383}-{'f1_val': 0.9971029125121428, 'auprc': 0.9968467757265378, 'loss_val': 0.019001806561703534, 'psi': 0.9970004577979008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=45 head_norm_before_train=1.990935 cos_to_last_merge=0.9905 (last merge round=29)
[S10] round=45 local utility u=0.000314 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9978706112148794, 'loss_val': 0.02876598677421439, 'psi': 0.9963320430529966}-{'f1_val': 0.9953063309450747, 'auprc': 0.9977672905734476, 'loss_val': 0.029083931937908383, 'psi': 0.996290714796424}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=45 head_norm_before_train=1.902003 cos_to_last_merge=0.9989 (last merge round=33)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.997749567593124, 'loss_val': 0.0224537572584426, 'psi': 0.9969373393557162}-{'f1_val': 0.9968091830929121, 'auprc': 0.9976033121454937, 'loss_val': 0.022335560872270187, 'psi': 0.9971268347139448}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.854085 cos_to_last_merge=0.9984 (last merge round=33)
[S13] round=45 local utility u=0.144445 metrics={'f1_val': 0.5983589964619672, 'auprc': 0.6797870268969053, 'loss_val': 0.7301161936206355, 'psi': 0.6309302086359425}-{'f1_val': 0.5593877085188832, 'auprc': 0.6845995086303511, 'loss_val': 0.7996160213085132, 'psi': 0.6094724285634704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=45 head_norm_before_train=1.477840 cos_to_last_merge=0.9722 (last merge round=29)
[S14] round=45 local utility u=0.008194 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9992082714334203, 'loss_val': 0.035737589116891344, 'psi': 0.9978818134679672}-{'f1_val': 0.9965603779504312, 'auprc': 0.9957188009563763, 'loss_val': 0.03903457564510396, 'psi': 0.9962237471528093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=45 head_norm_before_train=1.632398 cos_to_last_merge=0.9841 (last merge round=35)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.7009202876340006, 'auprc': 0.9897430069420938, 'loss_val': 0.5490799964516995, 'psi': 0.8164493753572379}-{'f1_val': 0.9855321058438681, 'auprc': 0.9982595142502101, 'loss_val': 0.07536693728178857, 'psi': 0.9906230692064049}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.887843 cos_to_last_merge=0.8090 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.809
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9437604864999811, 'auprc': 0.9922906230818018, 'loss_val': 0.19838097747008426, 'psi': 0.9631725411327093}-{'f1_val': 0.9906166001291218, 'auprc': 0.9899133725564958, 'loss_val': 0.045497028720351364, 'psi': 0.9903353091000713}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.762034 cos_to_last_merge=0.8001 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.800
[S17] round=45 local utility u=0.388149 metrics={'f1_val': 0.75741593682666, 'auprc': 0.9091264308174174, 'loss_val': 0.5161805604054314, 'psi': 0.8181001344229629}-{'f1_val': 0.6876370922982746, 'auprc': 0.8977348916825214, 'loss_val': 0.839631438857776, 'psi': 0.7716762120519733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=46 head_norm_before_train=1.908754 cos_to_last_merge=0.9912 (last merge round=29)
[S2] round=46 local utility u=0.864558 metrics={'f1_val': 0.6428339277275064, 'auprc': 0.7035474951329322, 'loss_val': 1.1357485148952329, 'psi': 0.6671193546896768}-{'f1_val': 0.540284575315191, 'auprc': 0.5900953275352254, 'loss_val': 1.909212112483412, 'psi': 0.5602088762032048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=46 head_norm_before_train=2.147961 cos_to_last_merge=0.9843 (last merge round=30)
[S3] round=46 local utility u=0.882370 metrics={'f1_val': 0.9831238484510215, 'auprc': 0.9995325238907168, 'loss_val': 0.043579044539797836, 'psi': 0.9896873186268996}-{'f1_val': 0.7938625186046637, 'auprc': 0.9169656331793812, 'loss_val': 0.42505001751194504, 'psi': 0.8431037644345507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=46 head_norm_before_train=2.050428 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9494476523001587, 'auprc': 0.9662019642284997, 'loss_val': 0.2814078004651906, 'psi': 0.956149377071495}-{'f1_val': 0.953365098504463, 'auprc': 0.9662925930420814, 'loss_val': 0.28557243771662266, 'psi': 0.9585360963195104}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.986802 cos_to_last_merge=0.9992 (last merge round=34)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.6981739569172122, 'auprc': 0.7594463934910016, 'loss_val': 0.4292698381973912, 'psi': 0.722682931546728}-{'f1_val': 0.7004069097142683, 'auprc': 0.9226514222670622, 'loss_val': 0.4012030329909605, 'psi': 0.789304714735386}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.539010 cos_to_last_merge=0.9817 (last merge round=33)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.8225287932879467, 'auprc': 0.9504482772956218, 'loss_val': 0.4014321555674346, 'psi': 0.8736965868910167}-{'f1_val': 0.8609009860483092, 'auprc': 0.9459835907203162, 'loss_val': 0.307375274526487, 'psi': 0.894934027917112}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.359740 cos_to_last_merge=0.9758 (last merge round=30)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.5068721469516232, 'auprc': 0.7788735310880829, 'loss_val': 1.2210226454066844, 'psi': 0.615672700606207}-{'f1_val': 0.9176555506403956, 'auprc': 0.9960562751930411, 'loss_val': 0.14625358283419587, 'psi': 0.9490158404614537}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=2.012797 cos_to_last_merge=0.9990 (last merge round=35)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9928243971176908, 'auprc': 0.9991403536513246, 'loss_val': 0.03637586847671076, 'psi': 0.9953507797311443}-{'f1_val': 0.9938326055531397, 'auprc': 0.9991204502858795, 'loss_val': 0.03316691636623934, 'psi': 0.9959477434462356}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=2.019875 cos_to_last_merge=0.7446 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.745
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9878532334303461, 'auprc': 0.9964810916113039, 'loss_val': 0.045623976225761705, 'psi': 0.9913043767027293}-{'f1_val': 0.9975138174234109, 'auprc': 0.9992194801742292, 'loss_val': 0.016131935168519948, 'psi': 0.9981960825237383}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.999687 cos_to_last_merge=0.9901 (last merge round=29)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9962477314759216, 'loss_val': 0.028771975023765207, 'psi': 0.9956828911574135}-{'f1_val': 0.9953063309450747, 'auprc': 0.9978706112148794, 'loss_val': 0.02876598677421439, 'psi': 0.9963320430529966}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.907763 cos_to_last_merge=0.9987 (last merge round=33)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9805047520420742, 'auprc': 0.9979485721381453, 'loss_val': 0.06733380350714192, 'psi': 0.9874822800805027}-{'f1_val': 0.9963958538641108, 'auprc': 0.997749567593124, 'loss_val': 0.0224537572584426, 'psi': 0.9969373393557162}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.860471 cos_to_last_merge=0.9982 (last merge round=33)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.5602787263969272, 'auprc': 0.6889923785672647, 'loss_val': 0.8952073424019156, 'psi': 0.6117641872650622}-{'f1_val': 0.5983589964619672, 'auprc': 0.6797870268969053, 'loss_val': 0.7301161936206355, 'psi': 0.6309302086359425}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.490948 cos_to_last_merge=0.9710 (last merge round=29)
[S14] round=46 local utility u=0.000364 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9988501365953442, 'loss_val': 0.033802793711887165, 'psi': 0.9977253546884035}-{'f1_val': 0.9969975081576651, 'auprc': 0.9992082714334203, 'loss_val': 0.035737589116891344, 'psi': 0.9978818134679672}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=46 head_norm_before_train=1.650420 cos_to_last_merge=0.9828 (last merge round=35)
[S15] round=46 local utility u=0.236626 metrics={'f1_val': 0.766346948270624, 'auprc': 0.9925022796772738, 'loss_val': 0.47666670487514606, 'psi': 0.8568090808332839}-{'f1_val': 0.7009202876340006, 'auprc': 0.9897430069420938, 'loss_val': 0.5490799964516995, 'psi': 0.8164493753572379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=46 head_norm_before_train=1.897010 cos_to_last_merge=0.8090 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.809
[S16] round=46 local utility u=0.032696 metrics={'f1_val': 0.9464993579828604, 'auprc': 0.9945654938051283, 'loss_val': 0.15624651347895216, 'psi': 0.9657258123117676}-{'f1_val': 0.9437604864999811, 'auprc': 0.9922906230818018, 'loss_val': 0.19838097747008426, 'psi': 0.9631725411327093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=46 head_norm_before_train=1.775389 cos_to_last_merge=0.7988 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.799
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.7279252755212721, 'auprc': 0.8981379030165598, 'loss_val': 0.5334157446763365, 'psi': 0.7960103265193872}-{'f1_val': 0.75741593682666, 'auprc': 0.9091264308174174, 'loss_val': 0.5161805604054314, 'psi': 0.8181001344229629}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.914402 cos_to_last_merge=0.9908 (last merge round=29)
[S2] round=47 local utility u=0.057208 metrics={'f1_val': 0.6578582174666949, 'auprc': 0.6940181607742669, 'loss_val': 1.082891207266198, 'psi': 0.6723221947897238}-{'f1_val': 0.6428339277275064, 'auprc': 0.7035474951329322, 'loss_val': 1.1357485148952329, 'psi': 0.6671193546896768}
[S2] not sending this round → trigger blocked (psi=0.672)
[S3] START round=47 head_norm_before_train=2.162473 cos_to_last_merge=0.9832 (last merge round=30)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9526869714974356, 'auprc': 0.9452922098978609, 'loss_val': 0.2671936616238096, 'psi': 0.9497290668576057}-{'f1_val': 0.9831238484510215, 'auprc': 0.9995325238907168, 'loss_val': 0.043579044539797836, 'psi': 0.9896873186268996}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=2.057472 (no previous merge yet)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9396316567549279, 'auprc': 0.9406927418076154, 'loss_val': 0.27825245362000206, 'psi': 0.9400560907760029}-{'f1_val': 0.9494476523001587, 'auprc': 0.9662019642284997, 'loss_val': 0.2814078004651906, 'psi': 0.956149377071495}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.989310 cos_to_last_merge=0.9990 (last merge round=34)
[S5] round=47 local utility u=0.041782 metrics={'f1_val': 0.6690037850467554, 'auprc': 0.8387984033416805, 'loss_val': 0.4087410855963246, 'psi': 0.7369216323647254}-{'f1_val': 0.6981739569172122, 'auprc': 0.7594463934910016, 'loss_val': 0.4292698381973912, 'psi': 0.722682931546728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=47 head_norm_before_train=1.553411 cos_to_last_merge=0.9797 (last merge round=33)
[S6] round=47 local utility u=0.667535 metrics={'f1_val': 0.9882963079801875, 'auprc': 0.9605012716741562, 'loss_val': 0.09112596312304404, 'psi': 0.977178293457775}-{'f1_val': 0.8225287932879467, 'auprc': 0.9504482772956218, 'loss_val': 0.4014321555674346, 'psi': 0.8736965868910167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=47 head_norm_before_train=1.361251 cos_to_last_merge=0.9760 (last merge round=30)
[S7] round=47 local utility u=0.953049 metrics={'f1_val': 0.6695749862360276, 'auprc': 0.8122172393134585, 'loss_val': 0.391173360079345, 'psi': 0.7266318874669999}-{'f1_val': 0.5068721469516232, 'auprc': 0.7788735310880829, 'loss_val': 1.2210226454066844, 'psi': 0.615672700606207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=47 head_norm_before_train=2.018204 cos_to_last_merge=0.9989 (last merge round=35)
[S8] round=47 local utility u=0.006777 metrics={'f1_val': 0.99397741430663, 'auprc': 0.9993934698502038, 'loss_val': 0.030499108021863845, 'psi': 0.9961438365240595}-{'f1_val': 0.9928243971176908, 'auprc': 0.9991403536513246, 'loss_val': 0.03637586847671076, 'psi': 0.9953507797311443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=47 head_norm_before_train=2.026213 cos_to_last_merge=0.7440 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.744
[S9] round=47 local utility u=0.039615 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9944754912971498, 'loss_val': 0.01604863597264968, 'psi': 0.9960692503031253}-{'f1_val': 0.9878532334303461, 'auprc': 0.9964810916113039, 'loss_val': 0.045623976225761705, 'psi': 0.9913043767027293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=47 head_norm_before_train=2.008722 cos_to_last_merge=0.9896 (last merge round=29)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9954198285744389, 'loss_val': 0.028665609788409412, 'psi': 0.9953517299968204}-{'f1_val': 0.9953063309450747, 'auprc': 0.9962477314759216, 'loss_val': 0.028771975023765207, 'psi': 0.9956828911574135}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.915764 cos_to_last_merge=0.9986 (last merge round=33)
[S11] round=47 local utility u=0.070215 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9978135347254252, 'loss_val': 0.0218455245035488, 'psi': 0.9969629262086366}-{'f1_val': 0.9805047520420742, 'auprc': 0.9979485721381453, 'loss_val': 0.06733380350714192, 'psi': 0.9874822800805027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=47 head_norm_before_train=1.862513 cos_to_last_merge=0.9980 (last merge round=33)
[S13] round=47 local utility u=0.109470 metrics={'f1_val': 0.5725657824120187, 'auprc': 0.6732985149894609, 'loss_val': 0.7029071222361222, 'psi': 0.6128588754429956}-{'f1_val': 0.5602787263969272, 'auprc': 0.6889923785672647, 'loss_val': 0.8952073424019156, 'psi': 0.6117641872650622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=47 head_norm_before_train=1.503031 cos_to_last_merge=0.9698 (last merge round=29)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9983462839554951, 'loss_val': 0.03397065704748389, 'psi': 0.9974068180864814}-{'f1_val': 0.9969755000837764, 'auprc': 0.9988501365953442, 'loss_val': 0.033802793711887165, 'psi': 0.9977253546884035}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.669469 cos_to_last_merge=0.9816 (last merge round=35)
[S15] round=47 local utility u=0.452886 metrics={'f1_val': 0.8715568562702556, 'auprc': 0.9954629911373867, 'loss_val': 0.21103660151472267, 'psi': 0.921119310217108}-{'f1_val': 0.766346948270624, 'auprc': 0.9925022796772738, 'loss_val': 0.47666670487514606, 'psi': 0.8568090808332839}
[S15] not sending this round → trigger blocked (psi=0.921)
[S16] START round=47 head_norm_before_train=1.906621 cos_to_last_merge=0.8089 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.809
[S16] round=47 local utility u=0.074600 metrics={'f1_val': 0.963140126723316, 'auprc': 0.9960944914797946, 'loss_val': 0.11147767647426671, 'psi': 0.9763218726259073}-{'f1_val': 0.9464993579828604, 'auprc': 0.9945654938051283, 'loss_val': 0.15624651347895216, 'psi': 0.9657258123117676}
[S16] not sending this round → trigger blocked (psi=0.976)
[S17] START round=47 head_norm_before_train=1.789099 cos_to_last_merge=0.7974 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.797
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6746704505574491, 'auprc': 0.8887301207651054, 'loss_val': 0.8804994298482514, 'psi': 0.7602943186405117}-{'f1_val': 0.7279252755212721, 'auprc': 0.8981379030165598, 'loss_val': 0.5334157446763365, 'psi': 0.7960103265193872}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.920397 cos_to_last_merge=0.9904 (last merge round=29)
[S2] round=48 local utility u=0.054426 metrics={'f1_val': 0.6615434389476961, 'auprc': 0.6901282953370451, 'loss_val': 0.9844816827862258, 'psi': 0.6729773815034357}-{'f1_val': 0.6578582174666949, 'auprc': 0.6940181607742669, 'loss_val': 1.082891207266198, 'psi': 0.6723221947897238}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=48 head_norm_before_train=2.179713 cos_to_last_merge=0.9818 (last merge round=30)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.7936374946365906, 'auprc': 0.8695438086559772, 'loss_val': 0.4724548925071436, 'psi': 0.8240000202443453}-{'f1_val': 0.9526869714974356, 'auprc': 0.9452922098978609, 'loss_val': 0.2671936616238096, 'psi': 0.9497290668576057}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.065152 (no previous merge yet)
[S4] round=48 local utility u=0.010244 metrics={'f1_val': 0.9402225426057478, 'auprc': 0.9473522991065095, 'loss_val': 0.28128812368924777, 'psi': 0.9430744452060524}-{'f1_val': 0.9396316567549279, 'auprc': 0.9406927418076154, 'loss_val': 0.27825245362000206, 'psi': 0.9400560907760029}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=48 head_norm_before_train=1.992207 cos_to_last_merge=0.9988 (last merge round=34)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.6030187962117413, 'auprc': 0.6783687495797586, 'loss_val': 0.6911767853654145, 'psi': 0.6331587775589482}-{'f1_val': 0.6690037850467554, 'auprc': 0.8387984033416805, 'loss_val': 0.4087410855963246, 'psi': 0.7369216323647254}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.568883 cos_to_last_merge=0.9781 (last merge round=33)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.7225358488466694, 'auprc': 0.9413901880258658, 'loss_val': 0.6864213576789009, 'psi': 0.810077584518348}-{'f1_val': 0.9882963079801875, 'auprc': 0.9605012716741562, 'loss_val': 0.09112596312304404, 'psi': 0.977178293457775}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.360719 cos_to_last_merge=0.9764 (last merge round=30)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6647199157975674, 'auprc': 0.8058043936938628, 'loss_val': 0.44749752677535476, 'psi': 0.7211537069560856}-{'f1_val': 0.6695749862360276, 'auprc': 0.8122172393134585, 'loss_val': 0.391173360079345, 'psi': 0.7266318874669999}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.027106 cos_to_last_merge=0.9988 (last merge round=35)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9939974855123931, 'auprc': 0.9948312105144569, 'loss_val': 0.03322406605758532, 'psi': 0.9943309755132186}-{'f1_val': 0.99397741430663, 'auprc': 0.9993934698502038, 'loss_val': 0.030499108021863845, 'psi': 0.9961438365240595}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=2.035089 cos_to_last_merge=0.7432 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.743
[S9] round=48 local utility u=0.000317 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.994522540118635, 'loss_val': 0.015556164107022959, 'psi': 0.9960880698317194}-{'f1_val': 0.9971317563071089, 'auprc': 0.9944754912971498, 'loss_val': 0.01604863597264968, 'psi': 0.9960692503031253}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=48 head_norm_before_train=2.017698 cos_to_last_merge=0.9891 (last merge round=29)
[S10] round=48 local utility u=0.001886 metrics={'f1_val': 0.9950868285240967, 'auprc': 0.997159955812485, 'loss_val': 0.02879793279944547, 'psi': 0.9959160794394519}-{'f1_val': 0.9953063309450747, 'auprc': 0.9954198285744389, 'loss_val': 0.028665609788409412, 'psi': 0.9953517299968204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=48 head_norm_before_train=1.925293 cos_to_last_merge=0.9984 (last merge round=33)
[S11] round=48 local utility u=0.000347 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9978641458241388, 'loss_val': 0.022333015069943153, 'psi': 0.9970861407133838}-{'f1_val': 0.9963958538641108, 'auprc': 0.9978135347254252, 'loss_val': 0.0218455245035488, 'psi': 0.9969629262086366}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=48 head_norm_before_train=1.863196 cos_to_last_merge=0.9977 (last merge round=33)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.555565248539974, 'auprc': 0.6896781182911743, 'loss_val': 0.9008387242413501, 'psi': 0.609210396440454}-{'f1_val': 0.5725657824120187, 'auprc': 0.6732985149894609, 'loss_val': 0.7029071222361222, 'psi': 0.6128588754429956}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.514562 cos_to_last_merge=0.9687 (last merge round=29)
[S14] round=48 local utility u=0.003739 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.998851096188629, 'loss_val': 0.03164142270457362, 'psi': 0.9979721954642005}-{'f1_val': 0.9967805075071389, 'auprc': 0.9983462839554951, 'loss_val': 0.03397065704748389, 'psi': 0.9974068180864814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=48 head_norm_before_train=1.688874 cos_to_last_merge=0.9802 (last merge round=35)
[S15] round=48 local utility u=0.130510 metrics={'f1_val': 0.9058602032572063, 'auprc': 0.99541557525807, 'loss_val': 0.15569479729733865, 'psi': 0.9416823520575518}-{'f1_val': 0.8715568562702556, 'auprc': 0.9954629911373867, 'loss_val': 0.21103660151472267, 'psi': 0.921119310217108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=48 head_norm_before_train=1.916052 cos_to_last_merge=0.8088 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.809
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.8614298842593219, 'auprc': 0.9867783923790716, 'loss_val': 0.8665337365365775, 'psi': 0.9115692875072219}-{'f1_val': 0.963140126723316, 'auprc': 0.9960944914797946, 'loss_val': 0.11147767647426671, 'psi': 0.9763218726259073}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.799764 cos_to_last_merge=0.7961 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.796
[S17] round=48 local utility u=0.215980 metrics={'f1_val': 0.6982278156259755, 'auprc': 0.9050986622023972, 'loss_val': 0.6389900739773262, 'psi': 0.7809761542565441}-{'f1_val': 0.6746704505574491, 'auprc': 0.8887301207651054, 'loss_val': 0.8804994298482514, 'psi': 0.7602943186405117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=49 head_norm_before_train=1.927179 cos_to_last_merge=0.9900 (last merge round=29)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.6487401823801314, 'auprc': 0.6974263661916513, 'loss_val': 1.0166098024324297, 'psi': 0.6682146559047394}-{'f1_val': 0.6615434389476961, 'auprc': 0.6901282953370451, 'loss_val': 0.9844816827862258, 'psi': 0.6729773815034357}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.192666 cos_to_last_merge=0.9806 (last merge round=30)
[S3] round=49 local utility u=0.910300 metrics={'f1_val': 0.9680241870835475, 'auprc': 0.9969780183753459, 'loss_val': 0.08047718472329632, 'psi': 0.9796057196002669}-{'f1_val': 0.7936374946365906, 'auprc': 0.8695438086559772, 'loss_val': 0.4724548925071436, 'psi': 0.8240000202443453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=49 head_norm_before_train=2.073531 (no previous merge yet)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.940831131910822, 'auprc': 0.9405962594218833, 'loss_val': 0.2907191773958053, 'psi': 0.9407371829152466}-{'f1_val': 0.9402225426057478, 'auprc': 0.9473522991065095, 'loss_val': 0.28128812368924777, 'psi': 0.9430744452060524}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.996797 cos_to_last_merge=0.9988 (last merge round=34)
[S5] round=49 local utility u=0.413133 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.6828699762803463, 'loss_val': 0.4627434066139987, 'psi': 0.6933921363406995}-{'f1_val': 0.6030187962117413, 'auprc': 0.6783687495797586, 'loss_val': 0.6911767853654145, 'psi': 0.6331587775589482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=49 head_norm_before_train=1.581195 cos_to_last_merge=0.9765 (last merge round=33)
[S6] round=49 local utility u=0.565842 metrics={'f1_val': 0.8640998523433181, 'auprc': 0.9472204137311222, 'loss_val': 0.4216123996398593, 'psi': 0.8973480768984397}-{'f1_val': 0.7225358488466694, 'auprc': 0.9413901880258658, 'loss_val': 0.6864213576789009, 'psi': 0.810077584518348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=49 head_norm_before_train=1.366634 cos_to_last_merge=0.9758 (last merge round=30)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6585137292773354, 'auprc': 0.803765146844175, 'loss_val': 0.5135470233162664, 'psi': 0.7166142963040713}-{'f1_val': 0.6647199157975674, 'auprc': 0.8058043936938628, 'loss_val': 0.44749752677535476, 'psi': 0.7211537069560856}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=2.038466 cos_to_last_merge=0.9986 (last merge round=35)
[S8] round=49 local utility u=0.009310 metrics={'f1_val': 0.9943795289865018, 'auprc': 0.9989017950501475, 'loss_val': 0.02910885386584096, 'psi': 0.9961884354119601}-{'f1_val': 0.9939974855123931, 'auprc': 0.9948312105144569, 'loss_val': 0.03322406605758532, 'psi': 0.9943309755132186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=49 head_norm_before_train=2.042149 cos_to_last_merge=0.7431 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.743
[S9] round=49 local utility u=0.008493 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.999213667534946, 'loss_val': 0.014935300435662975, 'psi': 0.998193757468025}-{'f1_val': 0.9971317563071089, 'auprc': 0.994522540118635, 'loss_val': 0.015556164107022959, 'psi': 0.9960880698317194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=49 head_norm_before_train=2.026457 cos_to_last_merge=0.9885 (last merge round=29)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9944287677762472, 'auprc': 0.9974523667058014, 'loss_val': 0.028939441510672896, 'psi': 0.995638207348069}-{'f1_val': 0.9950868285240967, 'auprc': 0.997159955812485, 'loss_val': 0.02879793279944547, 'psi': 0.9959160794394519}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.935437 cos_to_last_merge=0.9982 (last merge round=33)
[S11] round=49 local utility u=0.000063 metrics={'f1_val': 0.996567470639547, 'auprc': 0.997839103593106, 'loss_val': 0.02213133095114418, 'psi': 0.9970761238209707}-{'f1_val': 0.996567470639547, 'auprc': 0.9978641458241388, 'loss_val': 0.022333015069943153, 'psi': 0.9970861407133838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=49 head_norm_before_train=1.865197 cos_to_last_merge=0.9973 (last merge round=33)
[S13] round=49 local utility u=0.171544 metrics={'f1_val': 0.5945209775678897, 'auprc': 0.6720285273384462, 'loss_val': 0.7385354300793388, 'psi': 0.6255239974761122}-{'f1_val': 0.555565248539974, 'auprc': 0.6896781182911743, 'loss_val': 0.9008387242413501, 'psi': 0.609210396440454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=49 head_norm_before_train=1.525993 cos_to_last_merge=0.9677 (last merge round=29)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.994470429891246, 'auprc': 0.9988506397717674, 'loss_val': 0.03918579481156286, 'psi': 0.9962225138434546}-{'f1_val': 0.9973862616479148, 'auprc': 0.998851096188629, 'loss_val': 0.03164142270457362, 'psi': 0.9979721954642005}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.707319 cos_to_last_merge=0.9790 (last merge round=35)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.7748172784019252, 'auprc': 0.9907541719753991, 'loss_val': 0.44882412796253196, 'psi': 0.8611920358313148}-{'f1_val': 0.9058602032572063, 'auprc': 0.99541557525807, 'loss_val': 0.15569479729733865, 'psi': 0.9416823520575518}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.923513 cos_to_last_merge=0.8086 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.809
[S16] round=49 local utility u=0.518086 metrics={'f1_val': 0.9420329014891597, 'auprc': 0.9851804463780724, 'loss_val': 0.309186350250731, 'psi': 0.9592919194447248}-{'f1_val': 0.8614298842593219, 'auprc': 0.9867783923790716, 'loss_val': 0.8665337365365775, 'psi': 0.9115692875072219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=49 head_norm_before_train=1.811776 cos_to_last_merge=0.7947 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.795
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6881308058211069, 'auprc': 0.9010443179772956, 'loss_val': 0.6262181013007654, 'psi': 0.7732962106835823}-{'f1_val': 0.6982278156259755, 'auprc': 0.9050986622023972, 'loss_val': 0.6389900739773262, 'psi': 0.7809761542565441}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
