[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:39003
[S3] → join 127.0.0.1:39002
[S4] → join 127.0.0.1:39002
[S5] → join 127.0.0.1:39002
[S6] → join 127.0.0.1:39002
[S7] → join 127.0.0.1:39002
[S8] → join 127.0.0.1:39002
[S9] → join 127.0.0.1:39002
[S10] → join 127.0.0.1:39002
[S11] → join 127.0.0.1:39002
[S13] → join 127.0.0.1:39002
[S14] → join 127.0.0.1:39002
[S15] → join 127.0.0.1:39002
[S16] → join 127.0.0.1:39002
[S17] → join 127.0.0.1:39002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.127806 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.170394 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.168579 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.141692 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.168629 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.161369 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.123164 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.160232 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.179474 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.075069 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.148385 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.108273 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.138924 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.188138 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.147865 (no previous merge yet)
[S3]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S4] + discovered S2
[S3] + discovered S15
[S3] + discovered S13
[S3] + discovered S14
[S3] + discovered S8
[S3] + discovered S6
[S3] + discovered S7
[S3] + discovered S17
[S3] + discovered S16
[S3] + discovered S9
[S3] + discovered S5
[S3] + discovered S10
[S3] + discovered S11
[S3] + discovered S4
[S4] + discovered S3
[S4] + discovered S9
[S4] + discovered S16
[S4] + discovered S17
[S4] + discovered S7
[S4] + discovered S6
[S4] + discovered S8
[S4] + discovered S14
[S4] + discovered S13
[S4] + discovered S15
[S5] + discovered S4
[S5] + discovered S2
[S5] + discovered S3
[S4] + discovered S11
[S4] + discovered S10
[S4] + discovered S5
[S5] + discovered S6
[S5] + discovered S8
[S5] + discovered S14
[S5] + discovered S13
[S5] + discovered S15
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S3
[S6] + discovered S2
[S5] + discovered S10
[S5] + discovered S9
[S5] + discovered S16
[S5] + discovered S17
[S5] + discovered S11
[S5] + discovered S7
[S7] + discovered S6
[S7] + discovered S4
[S6] + discovered S17
[S6] + discovered S16
[S6] + discovered S9
[S6] + discovered S15
[S6] + discovered S10
[S6] + discovered S14
[S6] + discovered S13
[S6] + discovered S8
[S6] + discovered S7
[S6] + discovered S11
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S3
[S7] + discovered S8
[S7] + discovered S10
[S7] + discovered S13
[S7] + discovered S17
[S7] + discovered S11
[S8] + discovered S6
[S8] + discovered S5
[S7] + discovered S14
[S7] + discovered S9
[S7] + discovered S15
[S7] + discovered S16
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S3
[S8] + discovered S2
[S9] + discovered S6
[S9] + discovered S2
[S9] + discovered S4
[S9] + discovered S7
[S9] + discovered S3
[S9] + discovered S5
[S9] + discovered S8
[S8] + discovered S17
[S8] + discovered S14
[S8] + discovered S13
[S8] + discovered S16
[S8] + discovered S15
[S8] + discovered S11
[S8] + discovered S9
[S8] + discovered S10
[S9] + discovered S17
[S9] + discovered S15
[S9] + discovered S16
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S13
[S9] + discovered S10
[S10] + discovered S8
[S10] + discovered S5
[S10] + discovered S9
[S10] + discovered S7
[S10] + discovered S4
[S10] + discovered S2
[S10] + discovered S6
[S10] + discovered S3
[S11] + discovered S3
[S11] + discovered S6
[S10] + discovered S14
[S11] + discovered S10
[S10] + discovered S13
[S11] + discovered S7
[S10] + discovered S17
[S10] + discovered S11
[S11] + discovered S4
[S10] + discovered S16
[S10] + discovered S15
[S11] + discovered S5
[S11] + discovered S9
[S11] + discovered S2
[S11] + discovered S8
[S13] + discovered S10
[S13] + discovered S9
[S13] + discovered S6
[S13] + discovered S4
[S13] + discovered S3
[S13] + discovered S2
[S13] + discovered S8
[S11] + discovered S16
[S11] + discovered S14
[S13] + discovered S5
[S13] + discovered S7
[S13] + discovered S11
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S15
[S14] + discovered S7
[S14] + discovered S13
[S14] + discovered S8
[S14] + discovered S2
[S14] + discovered S4
[S14] + discovered S9
[S13] + discovered S17
[S14] + discovered S11
[S14] + discovered S10
[S14] + discovered S5
[S14] + discovered S3
[S14] + discovered S6
[S13] + discovered S14
[S13] + discovered S16
[S13] + discovered S15
[S15] + discovered S4
[S15] + discovered S3
[S15] + discovered S11
[S15] + discovered S8
[S15] + discovered S9
[S15] + discovered S2
[S15] + discovered S13
[S15] + discovered S6
[S15] + discovered S14
[S15] + discovered S5
[S15] + discovered S10
[S15] + discovered S7
[S14] + discovered S16
[S14] + discovered S17
[S14] + discovered S15
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S10
[S16] + discovered S3
[S16] + discovered S14
[S16] + discovered S13
[S16] + discovered S5
[S16] + discovered S2
[S16] + discovered S8
[S16] + discovered S9
[S16] + discovered S11
[S16] + discovered S4
[S16] + discovered S15
[S16] + discovered S6
[S16] + discovered S7
[S16] + discovered S17
[S17] + discovered S13
[S17] + discovered S4
[S17] + discovered S8
[S17] + discovered S3
[S17] + discovered S7
[S17] + discovered S10
[S17] + discovered S6
[S17] + discovered S16
[S17] + discovered S5
[S17] + discovered S15
[S17] + discovered S11
[S17] + discovered S9
[S17] + discovered S2
[S17] + discovered S14
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:39017
[S5] ⇄ pheromone p=1.000 → S17@127.0.0.1:39017
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:39008
[S13] ⇄ pheromone p=1.000 → S4@127.0.0.1:39004
[S7] ⇄ pheromone p=1.000 → S2@127.0.0.1:39002
[S14] ⇄ pheromone p=1.000 → S17@127.0.0.1:39017
[S3] ⇄ pheromone p=1.000 → S8@127.0.0.1:39009
[S9] ⇄ pheromone p=1.000 → S15@127.0.0.1:39015
[S4] ⇄ pheromone p=1.000 → S10@127.0.0.1:39011
[S15] ⇄ pheromone p=1.000 → S6@127.0.0.1:39007
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:39014
[S11] ⇄ pheromone p=1.000 → S5@127.0.0.1:39005
[S2] ⇄ pheromone p=1.000 → S9@127.0.0.1:39010
[S8] ⇄ pheromone p=1.000 → S5@127.0.0.1:39005
[S17] ⇄ pheromone p=1.000 → S16@127.0.0.1:39016
[S2] START round=1 head_norm_before_train=1.130928 (no previous merge yet)
[S2] round=1 local utility u=0.016025 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.785512920517316, 'loss_val': 1.3145759919188225, 'psi': 0.3992714482400665}-{'f1_val': 0.1417771333885667, 'auprc': 0.7874685087318123, 'loss_val': 1.3524936850388425, 'psi': 0.40005368352586496}
[S3] START round=1 head_norm_before_train=1.174728 (no previous merge yet)
[S3] round=1 local utility u=0.355262 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9264433036717713, 'loss_val': 1.3250658278476029, 'psi': 0.4544813608371727}-{'f1_val': 0.13984006561410703, 'auprc': 0.6981426770822877, 'loss_val': 1.3506875094903985, 'psi': 0.3631611102013793}
[S4] START round=1 head_norm_before_train=1.172796 (no previous merge yet)
[S4] round=1 local utility u=1.000000 metrics={'f1_val': 0.3838913941736961, 'auprc': 0.7296787706331126, 'loss_val': 1.3187242076253465, 'psi': 0.5222063447574627}-{'f1_val': 0.10637591321673677, 'auprc': 0.42983719298394135, 'loss_val': 1.358439667499539, 'psi': 0.2357604251236186}
[S5] START round=1 head_norm_before_train=1.141544 (no previous merge yet)
[S5] round=1 local utility u=0.452116 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7560679454875192, 'loss_val': 1.346946881688674, 'psi': 0.38778432105215055}-{'f1_val': 0.06823027718550106, 'auprc': 0.6158141968523531, 'loss_val': 1.3862272656845522, 'psi': 0.2872638450522419}
[S6] START round=1 head_norm_before_train=1.169067 (no previous merge yet)
[S6] round=1 local utility u=0.649828 metrics={'f1_val': 0.10398230088495575, 'auprc': 0.7354091748900814, 'loss_val': 1.3601543768550186, 'psi': 0.356553050487006}-{'f1_val': 0.10398230088495575, 'auprc': 0.31126963670139024, 'loss_val': 1.3873911840261648, 'psi': 0.18689723521152954}
[S7] START round=1 head_norm_before_train=1.162306 (no previous merge yet)
[S7] round=1 local utility u=0.107532 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6742324513998771, 'loss_val': 1.3266099820662267, 'psi': 0.3549270741974058}-{'f1_val': 0.14205682272909165, 'auprc': 0.6121916680832381, 'loss_val': 1.3555524233370153, 'psi': 0.33011076087075025}
[S8] START round=1 head_norm_before_train=1.123822 (no previous merge yet)
[S8] round=1 local utility u=0.297809 metrics={'f1_val': 0.10450549450549451, 'auprc': 0.5420779268940923, 'loss_val': 1.3513830108647884, 'psi': 0.27953446746093363}-{'f1_val': 0.10450549450549451, 'auprc': 0.3543430416772616, 'loss_val': 1.3837966480962336, 'psi': 0.20444051337420133}
[S9] START round=1 head_norm_before_train=1.164411 (no previous merge yet)
[S9] round=1 local utility u=1.000000 metrics={'f1_val': 0.4161306542517693, 'auprc': 0.8643226394817138, 'loss_val': 1.3208959616175484, 'psi': 0.5954074483437471}-{'f1_val': 0.08895775941230487, 'auprc': 0.6870212409611187, 'loss_val': 1.3604491407773531, 'psi': 0.3281831520318304}
[S10] START round=1 head_norm_before_train=1.184159 (no previous merge yet)
[S10] round=1 local utility u=0.753169 metrics={'f1_val': 0.23757134011121583, 'auprc': 0.8536529569413042, 'loss_val': 1.3248020020488644, 'psi': 0.4840039868432512}-{'f1_val': 0.09576103667911268, 'auprc': 0.6457996318322454, 'loss_val': 1.3567187239178553, 'psi': 0.3157764747403658}
[S11] START round=1 head_norm_before_train=1.071461 (no previous merge yet)
[S11] round=1 local utility u=0.222300 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7473871307815911, 'loss_val': 1.351525639644453, 'psi': 0.3832030623365028}-{'f1_val': 0.1425477584603922, 'auprc': 0.6045518129198992, 'loss_val': 1.3804236140871762, 'psi': 0.327349380244195}
[S13] START round=1 head_norm_before_train=1.149839 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5659181319786609, 'loss_val': 1.3238109247419236, 'psi': 0.31059871033769626}-{'f1_val': 0.41592377599636055, 'auprc': 0.6028200006102473, 'loss_val': 1.3614887128681255, 'psi': 0.49068226584191527}
[S14] START round=1 head_norm_before_train=1.111524 (no previous merge yet)
[S14] round=1 local utility u=0.630167 metrics={'f1_val': 0.26202484105175283, 'auprc': 0.6940991804792727, 'loss_val': 1.3487085863003927, 'psi': 0.4348545768227608}-{'f1_val': 0.1038107752956636, 'auprc': 0.5989478753917735, 'loss_val': 1.3743048212619544, 'psi': 0.30186561533410755}
[S15] START round=1 head_norm_before_train=1.141945 (no previous merge yet)
[S15] round=1 local utility u=0.367082 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.6250742937817882, 'loss_val': 1.3255247093838622, 'psi': 0.3338699083296503}-{'f1_val': 0.13973365136155833, 'auprc': 0.38852027736149874, 'loss_val': 1.3500276257665031, 'psi': 0.2392483017615345}
[S16] START round=1 head_norm_before_train=1.190671 (no previous merge yet)
[S16] round=1 local utility u=0.433819 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8663890138948044, 'loss_val': 1.33176656763985, 'psi': 0.4309380756774437}-{'f1_val': 0.09148550724637682, 'auprc': 0.6901244664649809, 'loss_val': 1.3756987141054795, 'psi': 0.33094109093381846}
[S17] START round=1 head_norm_before_train=1.146767 (no previous merge yet)
[S17] round=1 local utility u=0.351100 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5812416318852918, 'loss_val': 1.3494516597671102, 'psi': 0.3170660307445473}-{'f1_val': 0.13926501345678433, 'auprc': 0.3591826611024632, 'loss_val': 1.3753703716534622, 'psi': 0.2272320725150559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S7] → sending delta(kind=head bytes=1787) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S10] → sending delta(kind=head bytes=1785) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S16] → sending delta(kind=head bytes=1786) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:39010
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1786 to 1 peers)
[S10] sending update (kind=head size=1785 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1787 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1785) from S10
[S8] cosine check vs S10: cos=-0.1958
[S8] DROPPED delta from S10 (cos=-0.1958 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1790) from S6
[S9] cosine check vs S6: cos=0.0399
[S9] RECEIVED delta(kind=head bytes=1786) from S16
[S9] cosine check vs S16: cos=0.1361
[S9] RECEIVED delta(kind=head bytes=1794) from S14
[S9] cosine check vs S14: cos=0.0279
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=-0.0840
[S5] DROPPED delta from S15 (cos=-0.0840 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S3
[S5] cosine check vs S3: cos=-0.0844
[S5] DROPPED delta from S3 (cos=-0.0844 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1791) from S8
[S4] cosine check vs S8: cos=0.0078
[S4] RECEIVED delta(kind=head bytes=1791) from S11
[S4] cosine check vs S11: cos=-0.0150
[S4] DROPPED delta from S11 (cos=-0.0150 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1792) from S4
[S15] cosine check vs S4: cos=0.0413
[S8] RECEIVED delta(kind=head bytes=1787) from S7
[S8] cosine check vs S7: cos=-0.0632
[S8] DROPPED delta from S7 (cos=-0.0632 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1789) from S2
[S15] cosine check vs S2: cos=-0.0605
[S15] DROPPED delta from S2 (cos=-0.0605 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1793) from S5
[S14] cosine check vs S5: cos=-0.0119
[S14] DROPPED delta from S5 (cos=-0.0119 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1792) from S9
[S7] cosine check vs S9: cos=-0.0106
[S7] DROPPED delta from S9 (cos=-0.0106 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:39012
[S17] sending update (kind=head size=1789 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1789) from S17
[S11] cosine check vs S17: cos=-0.0887
[S11] DROPPED delta from S17 (cos=-0.0887 < 0.0)
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.4161 head_norm=1.180716
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.460211e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.3329 head_norm=0.712279 delta_norm=0.646021
[S9] aggregate: ROLLBACK (f1_val pre=0.416 post=0.333 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.3839 head_norm=1.184942
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.161212e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.4102 head_norm=0.822525 delta_norm=0.816121
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.153201
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.095095e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1037 head_norm=0.843608 delta_norm=0.809510
[S15] aggregate: ROLLBACK (f1_val pre=0.140 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S2] START round=2 head_norm_before_train=1.144511 (no previous merge yet)
[S2] round=2 local utility u=0.023005 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7851334869036292, 'loss_val': 1.2674284294837748, 'psi': 0.3991196747945917}-{'f1_val': 0.1417771333885667, 'auprc': 0.785512920517316, 'loss_val': 1.3145759919188225, 'psi': 0.3992714482400665}
[S3] START round=2 head_norm_before_train=1.183385 (no previous merge yet)
[S3] round=2 local utility u=0.110101 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9896117532858604, 'loss_val': 1.2943698335951763, 'psi': 0.4797487406828084}-{'f1_val': 0.13984006561410703, 'auprc': 0.9264433036717713, 'loss_val': 1.3250658278476029, 'psi': 0.4544813608371727}
[S4] START round=2 head_norm_before_train=0.822525 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.3977525309336333, 'auprc': 0.5461774786928475, 'loss_val': 1.3044661066745862, 'psi': 0.45712251003731896}-{'f1_val': 0.3838913941736961, 'auprc': 0.7296787706331126, 'loss_val': 1.3187242076253465, 'psi': 0.5222063447574627}
[S5] START round=2 head_norm_before_train=1.152983 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7363024448951303, 'loss_val': 1.3000234966854947, 'psi': 0.379878120815195}-{'f1_val': 0.14226190476190476, 'auprc': 0.7560679454875192, 'loss_val': 1.346946881688674, 'psi': 0.38778432105215055}
[S6] START round=2 head_norm_before_train=1.176350 (no previous merge yet)
[S6] round=2 local utility u=1.000000 metrics={'f1_val': 0.4006736677058834, 'auprc': 0.805535263006746, 'loss_val': 1.3273974775631041, 'psi': 0.5626183058262285}-{'f1_val': 0.10398230088495575, 'auprc': 0.7354091748900814, 'loss_val': 1.3601543768550186, 'psi': 0.356553050487006}
[S7] START round=2 head_norm_before_train=1.172005 (no previous merge yet)
[S7] round=2 local utility u=0.095248 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7280367974143889, 'loss_val': 1.29752782924637, 'psi': 0.37644881260321056}-{'f1_val': 0.14205682272909165, 'auprc': 0.6742324513998771, 'loss_val': 1.3266099820662267, 'psi': 0.3549270741974058}
[S8] START round=2 head_norm_before_train=1.131863 (no previous merge yet)
[S8] round=2 local utility u=0.934189 metrics={'f1_val': 0.39146451823504935, 'auprc': 0.5784747138488492, 'loss_val': 1.3139496913963717, 'psi': 0.4662685964805693}-{'f1_val': 0.10450549450549451, 'auprc': 0.5420779268940923, 'loss_val': 1.3513830108647884, 'psi': 0.27953446746093363}
[S9] START round=2 head_norm_before_train=0.712279 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.4161306542517693, 'auprc': 0.8631337089533545, 'loss_val': 1.327487687786102, 'psi': 0.5949318761324034}-{'f1_val': 0.4161306542517693, 'auprc': 0.8643226394817138, 'loss_val': 1.3208959616175484, 'psi': 0.5954074483437471}
[S10] START round=2 head_norm_before_train=1.196465 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8078019059178555, 'loss_val': 1.290687363913646, 'psi': 0.40629374489217657}-{'f1_val': 0.23757134011121583, 'auprc': 0.8536529569413042, 'loss_val': 1.3248020020488644, 'psi': 0.4840039868432512}
[S11] START round=2 head_norm_before_train=1.079184 (no previous merge yet)
[S11] round=2 local utility u=0.076592 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7876876724451767, 'loss_val': 1.3192425292628405, 'psi': 0.39932327900193704}-{'f1_val': 0.14041368337311058, 'auprc': 0.7473871307815911, 'loss_val': 1.351525639644453, 'psi': 0.3832030623365028}
[S13] START round=2 head_norm_before_train=1.164032 (no previous merge yet)
[S13] round=2 local utility u=0.031313 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5723399117732475, 'loss_val': 1.2804495152160658, 'psi': 0.31316742225553085}-{'f1_val': 0.1403857625770531, 'auprc': 0.5659181319786609, 'loss_val': 1.3238109247419236, 'psi': 0.31059871033769626}
[S14] START round=2 head_norm_before_train=1.124820 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7638453467754005, 'loss_val': 1.31568936077697, 'psi': 0.38975285043978247}-{'f1_val': 0.26202484105175283, 'auprc': 0.6940991804792727, 'loss_val': 1.3487085863003927, 'psi': 0.4348545768227608}
[S15] START round=2 head_norm_before_train=0.843608 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.954625 metrics={'f1_val': 0.38892889528389984, 'auprc': 0.7704510500526687, 'loss_val': 1.3475755394447262, 'psi': 0.5415377571914074}-{'f1_val': 0.13973365136155833, 'auprc': 0.6250742937817882, 'loss_val': 1.3255247093838622, 'psi': 0.3338699083296503}
[S16] START round=2 head_norm_before_train=1.204731 (no previous merge yet)
[S16] round=2 local utility u=0.020773 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8638581234877057, 'loss_val': 1.2826275608043793, 'psi': 0.42992571951460423}-{'f1_val': 0.14063745019920318, 'auprc': 0.8663890138948044, 'loss_val': 1.33176656763985, 'psi': 0.4309380756774437}
[S17] START round=2 head_norm_before_train=1.155984 (no previous merge yet)
[S17] round=2 local utility u=0.203004 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7067788092159464, 'loss_val': 1.3200542161787356, 'psi': 0.3672809016768092}-{'f1_val': 0.14094896331738438, 'auprc': 0.5812416318852918, 'loss_val': 1.3494516597671102, 'psi': 0.3170660307445473}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S3] → sending delta(kind=head bytes=1786) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:39017
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:39012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:39016
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:39011
[S13] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1786 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1786) from S3
[S5] cosine check vs S3: cos=-0.0825
[S5] DROPPED delta from S3 (cos=-0.0825 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1790) from S7
[S6] cosine check vs S7: cos=-0.0716
[S6] DROPPED delta from S7 (cos=-0.0716 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1793) from S6
[S4] cosine check vs S6: cos=0.0383
[S9] RECEIVED delta(kind=head bytes=1790) from S11
[S9] cosine check vs S11: cos=0.0439
[S17] RECEIVED delta(kind=head bytes=1798) from S13
[S17] cosine check vs S13: cos=0.0535
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] cosine check vs S15: cos=0.0333
[S11] RECEIVED delta(kind=head bytes=1790) from S8
[S11] cosine check vs S8: cos=-0.0052
[S11] DROPPED delta from S8 (cos=-0.0052 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1793) from S2
[S10] cosine check vs S2: cos=-0.0720
[S10] DROPPED delta from S2 (cos=-0.0720 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S16
[S2] cosine check vs S16: cos=-0.0317
[S2] DROPPED delta from S16 (cos=-0.0317 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:39010
[S17] sending update (kind=head size=1793 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S17
[S9] cosine check vs S17: cos=0.0184
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.4161 head_norm=0.735735
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.200630e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.4157 head_norm=0.544156 delta_norm=0.520063
[S9] aggregate: ACCEPT kept=['S11', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=2 metric=0.3978 head_norm=0.845583
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.184467e-01
[S4] stored merged vector for next round verification (round=2)
[S4] DEBUG after merge:  round=2 metric=0.3487 head_norm=0.744895 delta_norm=0.718447
[S4] aggregate: ROLLBACK (f1_val pre=0.398 post=0.349 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=1.225466
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.346039e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.757942 delta_norm=0.734604
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1409 head_norm=1.172386
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.127401e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.1409 head_norm=0.857424 delta_norm=0.812740
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.169797 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7176825517505823, 'loss_val': 1.2205647069956482, 'psi': 0.372139300733373}-{'f1_val': 0.1417771333885667, 'auprc': 0.7851334869036292, 'loss_val': 1.2674284294837748, 'psi': 0.3991196747945917}
[S3] START round=3 head_norm_before_train=1.201606 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9553492106182176, 'loss_val': 1.2586640015025223, 'psi': 0.4660437236157513}-{'f1_val': 0.13984006561410703, 'auprc': 0.9896117532858604, 'loss_val': 1.2943698335951763, 'psi': 0.4797487406828084}
[S4] START round=3 head_norm_before_train=0.744895 cos_to_last_merge=1.0000 (last merge round=2)
[S4] round=3 local utility u=0.311292 metrics={'f1_val': 0.3917039412538916, 'auprc': 0.7622615654172591, 'loss_val': 1.2938428330600535, 'psi': 0.5399269909192386}-{'f1_val': 0.3977525309336333, 'auprc': 0.5461774786928475, 'loss_val': 1.3044661066745862, 'psi': 0.45712251003731896}
[S5] START round=3 head_norm_before_train=1.175920 (no previous merge yet)
[S5] round=3 local utility u=0.017470 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7312192265262012, 'loss_val': 1.2498339292403828, 'psi': 0.3778448334676233}-{'f1_val': 0.14226190476190476, 'auprc': 0.7363024448951303, 'loss_val': 1.3000234966854947, 'psi': 0.379878120815195}
[S6] START round=3 head_norm_before_train=1.194595 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8530762030555773, 'loss_val': 1.2833097773821827, 'psi': 0.42608625045300014}-{'f1_val': 0.4006736677058834, 'auprc': 0.805535263006746, 'loss_val': 1.3273974775631041, 'psi': 0.5626183058262285}
[S7] START round=3 head_norm_before_train=1.189533 (no previous merge yet)
[S7] round=3 local utility u=0.077062 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7690320935145739, 'loss_val': 1.2663901674056117, 'psi': 0.39284693104328455}-{'f1_val': 0.14205682272909165, 'auprc': 0.7280367974143889, 'loss_val': 1.29752782924637, 'psi': 0.37644881260321056}
[S8] START round=3 head_norm_before_train=1.147283 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6681382066026373, 'loss_val': 1.262745559584149, 'psi': 0.3512288720768293}-{'f1_val': 0.39146451823504935, 'auprc': 0.5784747138488492, 'loss_val': 1.3139496913963717, 'psi': 0.4662685964805693}
[S9] START round=3 head_norm_before_train=0.544156 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9846576087651384, 'loss_val': 1.3210272262142524, 'psi': 0.478701817790053}-{'f1_val': 0.4161306542517693, 'auprc': 0.8631337089533545, 'loss_val': 1.327487687786102, 'psi': 0.5949318761324034}
[S10] START round=3 head_norm_before_train=1.215556 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6596692387609727, 'loss_val': 1.2589773722851578, 'psi': 0.34704067802942345}-{'f1_val': 0.13862163754172394, 'auprc': 0.8078019059178555, 'loss_val': 1.290687363913646, 'psi': 0.40629374489217657}
[S11] START round=3 head_norm_before_train=1.097754 (no previous merge yet)
[S11] round=3 local utility u=0.022377 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7873647872547082, 'loss_val': 1.2735200617574036, 'psi': 0.3991941249257496}-{'f1_val': 0.14041368337311058, 'auprc': 0.7876876724451767, 'loss_val': 1.3192425292628405, 'psi': 0.39932327900193704}
[S13] START round=3 head_norm_before_train=1.190359 (no previous merge yet)
[S13] round=3 local utility u=0.073385 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6077067506352991, 'loss_val': 1.2397798812919925, 'psi': 0.3273141578003515}-{'f1_val': 0.1403857625770531, 'auprc': 0.5723399117732475, 'loss_val': 1.2804495152160658, 'psi': 0.31316742225553085}
[S14] START round=3 head_norm_before_train=1.146863 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7314612782710905, 'loss_val': 1.2706273120753944, 'psi': 0.37679922303805846}-{'f1_val': 0.14035785288270378, 'auprc': 0.7638453467754005, 'loss_val': 1.31568936077697, 'psi': 0.38975285043978247}
[S15] START round=3 head_norm_before_train=0.852332 cos_to_last_merge=0.9968 (last merge round=1)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7745537017342048, 'loss_val': 1.311548299523071, 'psi': 0.39366167151061693}-{'f1_val': 0.38892889528389984, 'auprc': 0.7704510500526687, 'loss_val': 1.3475755394447262, 'psi': 0.5415377571914074}
[S16] START round=3 head_norm_before_train=0.757942 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7812380673999035, 'loss_val': 1.273561886096962, 'psi': 0.3968776970794834}-{'f1_val': 0.14063745019920318, 'auprc': 0.8638581234877057, 'loss_val': 1.2826275608043793, 'psi': 0.42992571951460423}
[S17] START round=3 head_norm_before_train=0.857424 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6989837078432856, 'loss_val': 1.3128265047676873, 'psi': 0.3641628611277449}-{'f1_val': 0.14094896331738438, 'auprc': 0.7067788092159464, 'loss_val': 1.3200542161787356, 'psi': 0.3672809016768092}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39017
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:39005
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:39004
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:39011
[S4] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1794) from S4
[S10] cosine check vs S4: cos=0.0686
[S17] RECEIVED delta(kind=head bytes=1795) from S5
[S17] cosine check vs S5: cos=0.0173
[S2] RECEIVED delta(kind=head bytes=1795) from S7
[S2] cosine check vs S7: cos=-0.0427
[S2] DROPPED delta from S7 (cos=-0.0427 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S11
[S5] cosine check vs S11: cos=-0.0913
[S5] DROPPED delta from S11 (cos=-0.0913 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S13
[S4] cosine check vs S13: cos=-0.0646
[S4] DROPPED delta from S13 (cos=-0.0646 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.1386 head_norm=1.237653
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.052937e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.1386 head_norm=0.750072 delta_norm=0.705294
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=0.880205
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.385201e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1161 head_norm=0.750830 delta_norm=0.738520
[S17] aggregate: ROLLBACK (f1_val pre=0.141 post=0.116 tol_abs=0.005 tol_rel=0.0)
[S2] START round=4 head_norm_before_train=1.198656 (no previous merge yet)
[S2] round=4 local utility u=0.038186 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7297675058019075, 'loss_val': 1.1804485411126593, 'psi': 0.37697328235390304}-{'f1_val': 0.1417771333885667, 'auprc': 0.7176825517505823, 'loss_val': 1.2205647069956482, 'psi': 0.372139300733373}
[S3] START round=4 head_norm_before_train=1.226488 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6674838270031008, 'loss_val': 1.2232257036328436, 'psi': 0.3508975701697046}-{'f1_val': 0.13984006561410703, 'auprc': 0.9553492106182176, 'loss_val': 1.2586640015025223, 'psi': 0.4660437236157513}
[S4] START round=4 head_norm_before_train=0.767014 cos_to_last_merge=0.9954 (last merge round=2)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.698381316777496, 'loss_val': 1.2214660451898152, 'psi': 0.3634885040481089}-{'f1_val': 0.3917039412538916, 'auprc': 0.7622615654172591, 'loss_val': 1.2938428330600535, 'psi': 0.5399269909192386}
[S5] START round=4 head_norm_before_train=1.201480 (no previous merge yet)
[S5] round=4 local utility u=0.035119 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7351707645221374, 'loss_val': 1.1914495454095944, 'psi': 0.3794254486659978}-{'f1_val': 0.14226190476190476, 'auprc': 0.7312192265262012, 'loss_val': 1.2498339292403828, 'psi': 0.3778448334676233}
[S6] START round=4 head_norm_before_train=1.219819 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6995163947792647, 'loss_val': 1.2375820136197775, 'psi': 0.3646623271424751}-{'f1_val': 0.14142628205128205, 'auprc': 0.8530762030555773, 'loss_val': 1.2833097773821827, 'psi': 0.42608625045300014}
[S7] START round=4 head_norm_before_train=1.213806 (no previous merge yet)
[S7] round=4 local utility u=0.026481 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.776436616671566, 'loss_val': 1.2356409434157174, 'psi': 0.39580874030608143}-{'f1_val': 0.14205682272909165, 'auprc': 0.7690320935145739, 'loss_val': 1.2663901674056117, 'psi': 0.39284693104328455}
[S8] START round=4 head_norm_before_train=1.170340 (no previous merge yet)
[S8] round=4 local utility u=0.074096 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6974177886790285, 'loss_val': 1.202393052691927, 'psi': 0.3629407049073857}-{'f1_val': 0.13995598239295717, 'auprc': 0.6681382066026373, 'loss_val': 1.262745559584149, 'psi': 0.3512288720768293}
[S9] START round=4 head_norm_before_train=0.572991 cos_to_last_merge=0.9917 (last merge round=2)
[S9] round=4 local utility u=0.028667 metrics={'f1_val': 0.141397957139996, 'auprc': 0.983203532586525, 'loss_val': 1.2593317101254378, 'psi': 0.47812018731860767}-{'f1_val': 0.141397957139996, 'auprc': 0.9846576087651384, 'loss_val': 1.3210272262142524, 'psi': 0.478701817790053}
[S10] START round=4 head_norm_before_train=0.750072 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6340973587324183, 'loss_val': 1.265396201537852, 'psi': 0.3368119260180017}-{'f1_val': 0.13862163754172394, 'auprc': 0.6596692387609727, 'loss_val': 1.2589773722851578, 'psi': 0.34704067802942345}
[S11] START round=4 head_norm_before_train=1.128272 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7611972096630656, 'loss_val': 1.221373683845287, 'psi': 0.3887270938890926}-{'f1_val': 0.14041368337311058, 'auprc': 0.7873647872547082, 'loss_val': 1.2735200617574036, 'psi': 0.3991941249257496}
[S13] START round=4 head_norm_before_train=1.218497 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5615611903006507, 'loss_val': 1.1989839863053005, 'psi': 0.3088559336664921}-{'f1_val': 0.1403857625770531, 'auprc': 0.6077067506352991, 'loss_val': 1.2397798812919925, 'psi': 0.3273141578003515}
[S14] START round=4 head_norm_before_train=1.178328 (no previous merge yet)
[S14] round=4 local utility u=0.023580 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7320412837271791, 'loss_val': 1.225206880816237, 'psi': 0.3770312252204939}-{'f1_val': 0.14035785288270378, 'auprc': 0.7314612782710905, 'loss_val': 1.2706273120753944, 'psi': 0.37679922303805846}
[S15] START round=4 head_norm_before_train=0.871641 cos_to_last_merge=0.9874 (last merge round=1)
[S15] round=4 local utility u=0.026546 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.775774646060017, 'loss_val': 1.2621198046334845, 'psi': 0.3941500492409418}-{'f1_val': 0.13973365136155833, 'auprc': 0.7745537017342048, 'loss_val': 1.311548299523071, 'psi': 0.39366167151061693}
[S16] START round=4 head_norm_before_train=0.786285 cos_to_last_merge=0.9959 (last merge round=2)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6266067472646182, 'loss_val': 1.234567403077744, 'psi': 0.33502516902536916}-{'f1_val': 0.14063745019920318, 'auprc': 0.7812380673999035, 'loss_val': 1.273561886096962, 'psi': 0.3968776970794834}
[S17] START round=4 head_norm_before_train=0.750830 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6835472127369688, 'loss_val': 1.3205777017605154, 'psi': 0.3579882630852182}-{'f1_val': 0.14094896331738438, 'auprc': 0.6989837078432856, 'loss_val': 1.3128265047676873, 'psi': 0.3641628611277449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:39002
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39017
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:39017
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39005
[S15] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S5
[S17] cosine check vs S5: cos=0.7811
[S17] RECEIVED delta(kind=head bytes=1792) from S14
[S17] cosine check vs S14: cos=-0.0221
[S17] DROPPED delta from S14 (cos=-0.0221 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1794) from S7
[S2] cosine check vs S7: cos=-0.0452
[S2] DROPPED delta from S7 (cos=-0.0452 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1790) from S2
[S9] cosine check vs S2: cos=-0.0161
[S9] DROPPED delta from S2 (cos=-0.0161 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S15
[S6] cosine check vs S15: cos=0.0309
[S5] RECEIVED delta(kind=head bytes=1796) from S8
[S5] cosine check vs S8: cos=-0.0261
[S5] DROPPED delta from S8 (cos=-0.0261 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] cosine check vs S9: cos=0.0517
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=4 metric=0.1414 head_norm=1.252804
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.602050e-01
[S6] stored merged vector for next round verification (round=4)
[S6] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.782846 delta_norm=0.760205
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=4 metric=0.1397 head_norm=0.901111
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.319886e-01
[S15] stored merged vector for next round verification (round=4)
[S15] DEBUG after merge:  round=4 metric=0.1397 head_norm=0.558228 delta_norm=0.531989
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.1409 head_norm=0.765471
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.960180e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.0975 head_norm=0.944445 delta_norm=0.396018
[S17] aggregate: ROLLBACK (f1_val pre=0.141 post=0.098 tol_abs=0.005 tol_rel=0.0)
[S2] START round=5 head_norm_before_train=1.224194 (no previous merge yet)
[S2] round=5 local utility u=0.098997 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7755106518325465, 'loss_val': 1.1196836574230054, 'psi': 0.3952705407661587}-{'f1_val': 0.1417771333885667, 'auprc': 0.7297675058019075, 'loss_val': 1.1804485411126593, 'psi': 0.37697328235390304}
[S3] START round=5 head_norm_before_train=1.256084 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.62596935594153, 'loss_val': 1.1625177183391138, 'psi': 0.33429178174507623}-{'f1_val': 0.13984006561410703, 'auprc': 0.6674838270031008, 'loss_val': 1.2232257036328436, 'psi': 0.3508975701697046}
[S4] START round=5 head_norm_before_train=0.797399 cos_to_last_merge=0.9834 (last merge round=2)
[S4] round=5 local utility u=0.130274 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7577482457293242, 'loss_val': 1.1390184044415843, 'psi': 0.3872352756288402}-{'f1_val': 0.14022662889518414, 'auprc': 0.698381316777496, 'loss_val': 1.2214660451898152, 'psi': 0.3634885040481089}
[S5] START round=5 head_norm_before_train=1.229499 (no previous merge yet)
[S5] round=5 local utility u=0.914883 metrics={'f1_val': 0.4163396018254457, 'auprc': 0.770780507255344, 'loss_val': 1.1129792748302936, 'psi': 0.558115963997405}-{'f1_val': 0.14226190476190476, 'auprc': 0.7351707645221374, 'loss_val': 1.1914495454095944, 'psi': 0.3794254486659978}
[S6] START round=5 head_norm_before_train=0.782846 cos_to_last_merge=1.0000 (last merge round=4)
[S6] round=5 local utility u=0.211360 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8432562692262924, 'loss_val': 1.2460810149341595, 'psi': 0.42215827692128616}-{'f1_val': 0.14142628205128205, 'auprc': 0.6995163947792647, 'loss_val': 1.2375820136197775, 'psi': 0.3646623271424751}
[S7] START round=5 head_norm_before_train=1.232405 (no previous merge yet)
[S7] round=5 local utility u=0.018308 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7764977943510303, 'loss_val': 1.1992083920630967, 'psi': 0.39583321137786714}-{'f1_val': 0.14205682272909165, 'auprc': 0.776436616671566, 'loss_val': 1.2356409434157174, 'psi': 0.39580874030608143}
[S8] START round=5 head_norm_before_train=1.200395 (no previous merge yet)
[S8] round=5 local utility u=0.507683 metrics={'f1_val': 0.2641213305424332, 'auprc': 0.7660697671911594, 'loss_val': 1.1379746588254027, 'psi': 0.46490070520192367}-{'f1_val': 0.13995598239295717, 'auprc': 0.6974177886790285, 'loss_val': 1.202393052691927, 'psi': 0.3629407049073857}
[S9] START round=5 head_norm_before_train=0.614214 cos_to_last_merge=0.9699 (last merge round=2)
[S9] round=5 local utility u=0.009257 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9642386309598058, 'loss_val': 1.1839229583003528, 'psi': 0.47053422666791994}-{'f1_val': 0.141397957139996, 'auprc': 0.983203532586525, 'loss_val': 1.2593317101254378, 'psi': 0.47812018731860767}
[S10] START round=5 head_norm_before_train=0.772080 cos_to_last_merge=0.9980 (last merge round=3)
[S10] round=5 local utility u=0.037222 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6461392226068073, 'loss_val': 1.2270784461537039, 'psi': 0.3416286715677573}-{'f1_val': 0.13862163754172394, 'auprc': 0.6340973587324183, 'loss_val': 1.265396201537852, 'psi': 0.3368119260180017}
[S11] START round=5 head_norm_before_train=1.163264 (no previous merge yet)
[S11] round=5 local utility u=0.045420 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7703491717311101, 'loss_val': 1.1579901232256578, 'psi': 0.39238787871631037}-{'f1_val': 0.14041368337311058, 'auprc': 0.7611972096630656, 'loss_val': 1.221373683845287, 'psi': 0.3887270938890926}
[S13] START round=5 head_norm_before_train=1.241963 (no previous merge yet)
[S13] round=5 local utility u=0.808695 metrics={'f1_val': 0.41489387956931567, 'auprc': 0.5320698759823652, 'loss_val': 1.1401688734038904, 'psi': 0.46176427813453547}-{'f1_val': 0.1403857625770531, 'auprc': 0.5615611903006507, 'loss_val': 1.1989839863053005, 'psi': 0.3088559336664921}
[S14] START round=5 head_norm_before_train=1.209396 (no previous merge yet)
[S14] round=5 local utility u=0.085651 metrics={'f1_val': 0.1539132330499237, 'auprc': 0.7392666497358347, 'loss_val': 1.1569130487509356, 'psi': 0.3880545997242881}-{'f1_val': 0.14035785288270378, 'auprc': 0.7320412837271791, 'loss_val': 1.225206880816237, 'psi': 0.3770312252204939}
[S15] START round=5 head_norm_before_train=0.558228 cos_to_last_merge=1.0000 (last merge round=4)
[S15] round=5 local utility u=0.000137 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7756666833015873, 'loss_val': 1.2615211873868548, 'psi': 0.39410686413756996}-{'f1_val': 0.13973365136155833, 'auprc': 0.775774646060017, 'loss_val': 1.2621198046334845, 'psi': 0.3941500492409418}
[S16] START round=5 head_norm_before_train=0.815516 cos_to_last_merge=0.9872 (last merge round=2)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.549773649045059, 'loss_val': 1.1793948582813782, 'psi': 0.3042919297375455}-{'f1_val': 0.14063745019920318, 'auprc': 0.6266067472646182, 'loss_val': 1.234567403077744, 'psi': 0.33502516902536916}
[S17] START round=5 head_norm_before_train=0.944445 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.592952288031019, 'loss_val': 1.2973455626535035, 'psi': 0.3217502932028382}-{'f1_val': 0.14094896331738438, 'auprc': 0.6835472127369688, 'loss_val': 1.3205777017605154, 'psi': 0.3579882630852182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:39002
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39015
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S10] → sending delta(kind=head bytes=1787) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39005
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1787 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1792) from S2
[S9] cosine check vs S2: cos=-0.0113
[S9] DROPPED delta from S2 (cos=-0.0113 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S7
[S2] cosine check vs S7: cos=-0.0491
[S2] DROPPED delta from S7 (cos=-0.0491 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S15
[S6] cosine check vs S15: cos=0.5385
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] cosine check vs S8: cos=-0.0261
[S5] DROPPED delta from S8 (cos=-0.0261 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S11
[S5] cosine check vs S11: cos=-0.0836
[S5] DROPPED delta from S11 (cos=-0.0836 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] cosine check vs S13: cos=-0.0660
[S4] DROPPED delta from S13 (cos=-0.0660 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] cosine check vs S9: cos=0.5590
[S17] RECEIVED delta(kind=head bytes=1796) from S14
[S17] cosine check vs S14: cos=-0.0153
[S17] DROPPED delta from S14 (cos=-0.0153 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1787) from S10
[S14] cosine check vs S10: cos=0.0642
[S10] RECEIVED delta(kind=head bytes=1793) from S4
[S10] cosine check vs S4: cos=0.5156
[S17] RECEIVED delta(kind=head bytes=1794) from S6
[S17] cosine check vs S6: cos=-0.0650
[S17] DROPPED delta from S6 (cos=-0.0650 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S5
[S17] cosine check vs S5: cos=0.9494
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.368 → S8@127.0.0.1:39009
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.1397 head_norm=0.587713
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.963055e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.1397 head_norm=0.553635 delta_norm=0.296306
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.460 → S6@127.0.0.1:39007
[S8] ⇄ pheromone p=0.561 → S5@127.0.0.1:39005
[S7] ⇄ pheromone p=0.364 → S2@127.0.0.1:39002
[S13] ⇄ pheromone p=0.502 → S4@127.0.0.1:39004
[S5] ⇄ pheromone p=0.556 → S17@127.0.0.1:39017
[S11] ⇄ pheromone p=0.366 → S5@127.0.0.1:39005
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.810228
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.496513e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.615371 delta_norm=0.349651
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.526 → S17@127.0.0.1:39017
[S2] ⇄ pheromone p=0.357 → S9@127.0.0.1:39010
[S4] ⇄ pheromone p=0.476 → S10@127.0.0.1:39011
[S9] ⇄ pheromone p=0.416 → S15@127.0.0.1:39015
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.1386 head_norm=0.798939
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.013480e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.1386 head_norm=0.709503 delta_norm=0.401348
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.397 → S14@127.0.0.1:39014
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1539 head_norm=1.240898
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.160413e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1539 head_norm=0.759178 delta_norm=0.716041
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.400 → S17@127.0.0.1:39017
[S16] ⇄ pheromone p=0.365 → S7@127.0.0.1:39008
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.1409 head_norm=0.955961
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.285624e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.1409 head_norm=1.090260 delta_norm=0.228562
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.377 → S16@127.0.0.1:39016
[S2] START round=6 head_norm_before_train=1.249917 (no previous merge yet)
[S2] round=6 local utility u=0.870324 metrics={'f1_val': 0.4167275806938775, 'auprc': 0.7755910515930662, 'loss_val': 1.028979221340516, 'psi': 0.5602729690535531}-{'f1_val': 0.1417771333885667, 'auprc': 0.7755106518325465, 'loss_val': 1.1196836574230054, 'psi': 0.3952705407661587}
[S3] START round=6 head_norm_before_train=1.283056 (no previous merge yet)
[S3] round=6 local utility u=1.000000 metrics={'f1_val': 0.40590114253574094, 'auprc': 0.7958434178413398, 'loss_val': 1.0537776065043047, 'psi': 0.5618780526579805}-{'f1_val': 0.13984006561410703, 'auprc': 0.62596935594153, 'loss_val': 1.1625177183391138, 'psi': 0.33429178174507623}
[S4] START round=6 head_norm_before_train=0.831052 cos_to_last_merge=0.9684 (last merge round=2)
[S4] round=6 local utility u=1.000000 metrics={'f1_val': 0.6805246609972795, 'auprc': 0.7605668088709306, 'loss_val': 1.0186297388273406, 'psi': 0.71254152014674}-{'f1_val': 0.14022662889518414, 'auprc': 0.7577482457293242, 'loss_val': 1.1390184044415843, 'psi': 0.3872352756288402}
[S5] START round=6 head_norm_before_train=1.252180 (no previous merge yet)
[S5] round=6 local utility u=0.076500 metrics={'f1_val': 0.41851765403972324, 'auprc': 0.7777803090604686, 'loss_val': 0.9940475707320635, 'psi': 0.5622227160480213}-{'f1_val': 0.4163396018254457, 'auprc': 0.770780507255344, 'loss_val': 1.1129792748302936, 'psi': 0.558115963997405}
[S6] START round=6 head_norm_before_train=0.615371 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.032416 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8637220873977134, 'loss_val': 1.242647280860825, 'psi': 0.4303446041898546}-{'f1_val': 0.14142628205128205, 'auprc': 0.8432562692262924, 'loss_val': 1.2460810149341595, 'psi': 0.42215827692128616}
[S7] START round=6 head_norm_before_train=1.250032 (no previous merge yet)
[S7] round=6 local utility u=0.031767 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7763390296952083, 'loss_val': 1.135197813751731, 'psi': 0.3957697055155383}-{'f1_val': 0.14205682272909165, 'auprc': 0.7764977943510303, 'loss_val': 1.1992083920630967, 'psi': 0.39583321137786714}
[S8] START round=6 head_norm_before_train=1.219491 (no previous merge yet)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7148118385281752, 'auprc': 0.7764055422748288, 'loss_val': 1.054659530692249, 'psi': 0.7394493200268366}-{'f1_val': 0.2641213305424332, 'auprc': 0.7660697671911594, 'loss_val': 1.1379746588254027, 'psi': 0.46490070520192367}
[S9] START round=6 head_norm_before_train=0.665741 cos_to_last_merge=0.9415 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.942
[S9] round=6 local utility u=0.051830 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9602679541199429, 'loss_val': 1.0683518119913575, 'psi': 0.4689459559319748}-{'f1_val': 0.141397957139996, 'auprc': 0.9642386309598058, 'loss_val': 1.1839229583003528, 'psi': 0.47053422666791994}
[S10] START round=6 head_norm_before_train=0.709503 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5929643042734136, 'loss_val': 1.2042605266602162, 'psi': 0.3203587042343998}-{'f1_val': 0.13862163754172394, 'auprc': 0.6461392226068073, 'loss_val': 1.2270784461537039, 'psi': 0.3416286715677573}
[S11] START round=6 head_norm_before_train=1.194542 (no previous merge yet)
[S11] round=6 local utility u=0.834653 metrics={'f1_val': 0.3286682346882418, 'auprc': 0.9154930292709132, 'loss_val': 1.0536438432821322, 'psi': 0.5633981525213104}-{'f1_val': 0.14041368337311058, 'auprc': 0.7703491717311101, 'loss_val': 1.1579901232256578, 'psi': 0.39238787871631037}
[S13] START round=6 head_norm_before_train=1.266145 (no previous merge yet)
[S13] round=6 local utility u=0.025167 metrics={'f1_val': 0.41627458463323097, 'auprc': 0.5204965536991127, 'loss_val': 1.0633992465803024, 'psi': 0.45796337225958367}-{'f1_val': 0.41489387956931567, 'auprc': 0.5320698759823652, 'loss_val': 1.1401688734038904, 'psi': 0.46176427813453547}
[S14] START round=6 head_norm_before_train=0.759178 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.15394679459223726, 'auprc': 0.646570299083914, 'loss_val': 1.1289844613503397, 'psi': 0.35099619638890794}-{'f1_val': 0.1539132330499237, 'auprc': 0.7392666497358347, 'loss_val': 1.1569130487509356, 'psi': 0.3880545997242881}
[S15] START round=6 head_norm_before_train=0.553635 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.005317 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7757101790928663, 'loss_val': 1.2510179206021463, 'psi': 0.39412426245408155}-{'f1_val': 0.13973365136155833, 'auprc': 0.7756666833015873, 'loss_val': 1.2615211873868548, 'psi': 0.39410686413756996}
[S16] START round=6 head_norm_before_train=0.843974 cos_to_last_merge=0.9757 (last merge round=2)
[S16] round=6 local utility u=0.934669 metrics={'f1_val': 0.43474503823848804, 'auprc': 0.5637477022426927, 'loss_val': 1.1166240053000807, 'psi': 0.48634610384016985}-{'f1_val': 0.14063745019920318, 'auprc': 0.549773649045059, 'loss_val': 1.1793948582813782, 'psi': 0.3042919297375455}
[S17] START round=6 head_norm_before_train=1.090260 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5655970714948241, 'loss_val': 1.2453572333834972, 'psi': 0.3108082065883603}-{'f1_val': 0.14094896331738438, 'auprc': 0.592952288031019, 'loss_val': 1.2973455626535035, 'psi': 0.3217502932028382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:39011
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:39008
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39007
[S6] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1794) from S5
[S17] cosine check vs S5: cos=0.9781
[S2] RECEIVED delta(kind=head bytes=1792) from S7
[S2] cosine check vs S7: cos=-0.0537
[S2] DROPPED delta from S7 (cos=-0.0537 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S15
[S6] cosine check vs S15: cos=0.6380
[S9] RECEIVED delta(kind=head bytes=1796) from S2
[S9] cosine check vs S2: cos=-0.0042
[S9] DROPPED delta from S2 (cos=-0.0042 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1791) from S8
[S5] cosine check vs S8: cos=-0.0239
[S5] DROPPED delta from S8 (cos=-0.0239 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1792) from S3
[S8] cosine check vs S3: cos=0.0347
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] cosine check vs S11: cos=-0.0832
[S5] DROPPED delta from S11 (cos=-0.0832 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S13
[S4] cosine check vs S13: cos=-0.0679
[S4] DROPPED delta from S13 (cos=-0.0679 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] cosine check vs S9: cos=0.8584
[S10] RECEIVED delta(kind=head bytes=1790) from S4
[S10] cosine check vs S4: cos=0.8383
[S17] RECEIVED delta(kind=head bytes=1797) from S6
[S17] cosine check vs S6: cos=-0.0724
[S17] DROPPED delta from S6 (cos=-0.0724 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1791) from S16
[S7] cosine check vs S16: cos=0.0415
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.1386 head_norm=0.736708
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.374198e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.1386 head_norm=0.770868 delta_norm=0.237420
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.1397 head_norm=0.576181
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.852866e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.1397 head_norm=0.624153 delta_norm=0.185287
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1414 head_norm=0.639501
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.601917e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1433 head_norm=0.550248 delta_norm=0.260192
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.7148 head_norm=1.244306
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.880373e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.6415 head_norm=0.919333 delta_norm=0.888037
[S8] aggregate: ROLLBACK (f1_val pre=0.715 post=0.642 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=1.275591
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.587711e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1710 head_norm=0.788757 delta_norm=0.758771
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.1409 head_norm=1.103759
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.529563e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.1409 head_norm=1.186040 delta_norm=0.152956
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.279247 (no previous merge yet)
[S2] round=7 local utility u=0.059466 metrics={'f1_val': 0.4167714126006876, 'auprc': 0.7759057702302068, 'loss_val': 0.9112547079556903, 'psi': 0.5604251556524953}-{'f1_val': 0.4167275806938775, 'auprc': 0.7755910515930662, 'loss_val': 1.028979221340516, 'psi': 0.5602729690535531}
[S3] START round=7 head_norm_before_train=1.311209 (no previous merge yet)
[S3] round=7 local utility u=0.064862 metrics={'f1_val': 0.39638969140647473, 'auprc': 0.7961981854343375, 'loss_val': 0.8680499683527075, 'psi': 0.5563130890176198}-{'f1_val': 0.40590114253574094, 'auprc': 0.7958434178413398, 'loss_val': 1.0537776065043047, 'psi': 0.5618780526579805}
[S4] START round=7 head_norm_before_train=0.870903 cos_to_last_merge=0.9511 (last merge round=2)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.4087055881708125, 'auprc': 0.7556585392332213, 'loss_val': 0.8871268590168462, 'psi': 0.547486768595776}-{'f1_val': 0.6805246609972795, 'auprc': 0.7605668088709306, 'loss_val': 1.0186297388273406, 'psi': 0.71254152014674}
[S5] START round=7 head_norm_before_train=1.281363 (no previous merge yet)
[S5] round=7 local utility u=0.064579 metrics={'f1_val': 0.4183544144322735, 'auprc': 0.7774123771865368, 'loss_val': 0.862806425363564, 'psi': 0.5619775995339789}-{'f1_val': 0.41851765403972324, 'auprc': 0.7777803090604686, 'loss_val': 0.9940475707320635, 'psi': 0.5622227160480213}
[S6] START round=7 head_norm_before_train=0.550248 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6280793304698756, 'loss_val': 1.21527641699903, 'psi': 0.33608750141871946}-{'f1_val': 0.14142628205128205, 'auprc': 0.8637220873977134, 'loss_val': 1.242647280860825, 'psi': 0.4303446041898546}
[S7] START round=7 head_norm_before_train=0.788757 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.833195 metrics={'f1_val': 0.416467909967687, 'auprc': 0.7758855936033775, 'loss_val': 1.1139148384621471, 'psi': 0.5602349834219632}-{'f1_val': 0.14205682272909165, 'auprc': 0.7763390296952083, 'loss_val': 1.135197813751731, 'psi': 0.3957697055155383}
[S8] START round=7 head_norm_before_train=0.919333 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.017211 metrics={'f1_val': 0.7145254456069222, 'auprc': 0.7767153870785162, 'loss_val': 1.0194478156010403, 'psi': 0.7394014221955598}-{'f1_val': 0.7148118385281752, 'auprc': 0.7764055422748288, 'loss_val': 1.054659530692249, 'psi': 0.7394493200268366}
[S9] START round=7 head_norm_before_train=0.718199 cos_to_last_merge=0.9148 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.915
[S9] round=7 local utility u=1.000000 metrics={'f1_val': 0.7005072247572763, 'auprc': 0.9980021031708683, 'loss_val': 0.8539741904863363, 'psi': 0.8195051761227132}-{'f1_val': 0.141397957139996, 'auprc': 0.9602679541199429, 'loss_val': 1.0683518119913575, 'psi': 0.4689459559319748}
[S10] START round=7 head_norm_before_train=0.770868 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.051437 metrics={'f1_val': 0.13903111461205198, 'auprc': 0.6051757773746304, 'loss_val': 1.1404776953867157, 'psi': 0.32548897971708335}-{'f1_val': 0.13862163754172394, 'auprc': 0.5929643042734136, 'loss_val': 1.2042605266602162, 'psi': 0.3203587042343998}
[S11] START round=7 head_norm_before_train=1.224424 (no previous merge yet)
[S11] round=7 local utility u=0.345500 metrics={'f1_val': 0.40565455820956814, 'auprc': 0.9409802398647111, 'loss_val': 0.9010232755434933, 'psi': 0.6197848308716254}-{'f1_val': 0.3286682346882418, 'auprc': 0.9154930292709132, 'loss_val': 1.0536438432821322, 'psi': 0.5633981525213104}
[S13] START round=7 head_norm_before_train=1.297168 (no previous merge yet)
[S13] round=7 local utility u=0.025046 metrics={'f1_val': 0.416200286011302, 'auprc': 0.518775678656276, 'loss_val': 1.0076986441605817, 'psi': 0.4572304430692916}-{'f1_val': 0.41627458463323097, 'auprc': 0.5204965536991127, 'loss_val': 1.0633992465803024, 'psi': 0.45796337225958367}
[S14] START round=7 head_norm_before_train=0.798791 cos_to_last_merge=0.9968 (last merge round=5)
[S14] round=7 local utility u=0.994035 metrics={'f1_val': 0.3964619511854436, 'auprc': 0.7843772450310434, 'loss_val': 1.0094262278605282, 'psi': 0.5516280687236835}-{'f1_val': 0.15394679459223726, 'auprc': 0.646570299083914, 'loss_val': 1.1289844613503397, 'psi': 0.35099619638890794}
[S15] START round=7 head_norm_before_train=0.624153 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.013606 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7759232378880082, 'loss_val': 1.2244444038040008, 'psi': 0.3942094859721383}-{'f1_val': 0.13973365136155833, 'auprc': 0.7757101790928663, 'loss_val': 1.2510179206021463, 'psi': 0.39412426245408155}
[S16] START round=7 head_norm_before_train=0.876704 cos_to_last_merge=0.9611 (last merge round=2)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.4177827176245312, 'auprc': 0.5273029414631116, 'loss_val': 1.015765726127994, 'psi': 0.46159080715996337}-{'f1_val': 0.43474503823848804, 'auprc': 0.5637477022426927, 'loss_val': 1.1166240053000807, 'psi': 0.48634610384016985}
[S17] START round=7 head_norm_before_train=1.186040 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.062581 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5738022781212386, 'loss_val': 1.144811071528912, 'psi': 0.3140902892389261}-{'f1_val': 0.14094896331738438, 'auprc': 0.5655970714948241, 'loss_val': 1.2453572333834972, 'psi': 0.3108082065883603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:39004
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:39010
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:39002
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39017
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1792) from S14
[S17] cosine check vs S14: cos=-0.0311
[S17] DROPPED delta from S14 (cos=-0.0311 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S8
[S5] cosine check vs S8: cos=-0.0543
[S5] DROPPED delta from S8 (cos=-0.0543 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S3
[S8] cosine check vs S3: cos=0.7090
[S2] RECEIVED delta(kind=head bytes=1792) from S7
[S2] cosine check vs S7: cos=-0.0866
[S2] DROPPED delta from S7 (cos=-0.0866 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S2
[S9] cosine check vs S2: cos=0.0044
[S6] RECEIVED delta(kind=head bytes=1799) from S15
[S6] cosine check vs S15: cos=0.7562
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] cosine check vs S11: cos=-0.0820
[S5] DROPPED delta from S11 (cos=-0.0820 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S13
[S4] cosine check vs S13: cos=-0.0701
[S4] DROPPED delta from S13 (cos=-0.0701 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S10
[S14] cosine check vs S10: cos=0.3990
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] cosine check vs S9: cos=0.9394
[S17] RECEIVED delta(kind=head bytes=1800) from S5
[S17] cosine check vs S5: cos=0.9844
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1788 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1788) from S17
[S16] cosine check vs S17: cos=-0.0512
[S16] DROPPED delta from S17 (cos=-0.0512 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.1414 head_norm=0.575063
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.149263e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.0963 head_norm=0.570631 delta_norm=0.214926
[S6] aggregate: ROLLBACK (f1_val pre=0.141 post=0.096 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.3965 head_norm=0.846508
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.493259e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.3965 head_norm=0.684743 delta_norm=0.449326
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.7145 head_norm=0.952323
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.758981e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.4910 head_norm=1.066702 delta_norm=0.475898
[S8] aggregate: ROLLBACK (f1_val pre=0.715 post=0.491 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7005 head_norm=0.770435
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.606930e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.4172 head_norm=0.763604 delta_norm=0.760693
[S9] aggregate: ROLLBACK (f1_val pre=0.701 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.1397 head_norm=0.642596
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.381614e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.1397 head_norm=0.695817 delta_norm=0.138161
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.1409 head_norm=1.206276
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.231018e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.2892 head_norm=1.254130 delta_norm=0.123102
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.315264 (no previous merge yet)
[S2] round=8 local utility u=0.687703 metrics={'f1_val': 0.6233925392848891, 'auprc': 0.7762306188082078, 'loss_val': 0.7765491447658693, 'psi': 0.6845277710942166}-{'f1_val': 0.4167714126006876, 'auprc': 0.7759057702302068, 'loss_val': 0.9112547079556903, 'psi': 0.5604251556524953}
[S3] START round=8 head_norm_before_train=1.349720 (no previous merge yet)
[S3] round=8 local utility u=0.383161 metrics={'f1_val': 0.401708470248874, 'auprc': 0.997521879317987, 'loss_val': 0.7376109121326799, 'psi': 0.6400338338765192}-{'f1_val': 0.39638969140647473, 'auprc': 0.7961981854343375, 'loss_val': 0.8680499683527075, 'psi': 0.5563130890176198}
[S4] START round=8 head_norm_before_train=0.916936 cos_to_last_merge=0.9313 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.931
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.3743687060425549, 'auprc': 0.6570254435950422, 'loss_val': 0.7971508689657524, 'psi': 0.4874314010635498}-{'f1_val': 0.4087055881708125, 'auprc': 0.7556585392332213, 'loss_val': 0.8871268590168462, 'psi': 0.547486768595776}
[S5] START round=8 head_norm_before_train=1.311826 (no previous merge yet)
[S5] round=8 local utility u=0.325557 metrics={'f1_val': 0.49629763124637005, 'auprc': 0.7948234468547313, 'loss_val': 0.7315847918816786, 'psi': 0.6157079574897146}-{'f1_val': 0.4183544144322735, 'auprc': 0.7774123771865368, 'loss_val': 0.862806425363564, 'psi': 0.5619775995339789}
[S6] START round=8 head_norm_before_train=0.570631 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.814743 metrics={'f1_val': 0.41544627768762743, 'auprc': 0.6106644015163709, 'loss_val': 1.177666154810188, 'psi': 0.4935335272191248}-{'f1_val': 0.14142628205128205, 'auprc': 0.6280793304698756, 'loss_val': 1.21527641699903, 'psi': 0.33608750141871946}
[S7] START round=8 head_norm_before_train=0.817877 cos_to_last_merge=0.9974 (last merge round=6)
[S7] round=8 local utility u=0.068507 metrics={'f1_val': 0.4171579869317734, 'auprc': 0.7769058235946733, 'loss_val': 0.9841027838375427, 'psi': 0.5610571215969333}-{'f1_val': 0.416467909967687, 'auprc': 0.7758855936033775, 'loss_val': 1.1139148384621471, 'psi': 0.5602349834219632}
[S8] START round=8 head_norm_before_train=1.066702 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.3726652774371328, 'auprc': 0.7748493929215684, 'loss_val': 0.9832237266933898, 'psi': 0.533538923630907}-{'f1_val': 0.7145254456069222, 'auprc': 0.7767153870785162, 'loss_val': 1.0194478156010403, 'psi': 0.7394014221955598}
[S9] START round=8 head_norm_before_train=0.763604 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.4366972869045076, 'auprc': 0.9988475414911182, 'loss_val': 0.8310142456591154, 'psi': 0.6615573887391519}-{'f1_val': 0.7005072247572763, 'auprc': 0.9980021031708683, 'loss_val': 0.8539741904863363, 'psi': 0.8195051761227132}
[S10] START round=8 head_norm_before_train=0.790542 cos_to_last_merge=0.9964 (last merge round=6)
[S10] round=8 local utility u=0.950931 metrics={'f1_val': 0.41705153456077904, 'auprc': 0.6329216402468888, 'loss_val': 0.9899765297141874, 'psi': 0.503399576835223}-{'f1_val': 0.13903111461205198, 'auprc': 0.6051757773746304, 'loss_val': 1.1404776953867157, 'psi': 0.32548897971708335}
[S11] START round=8 head_norm_before_train=1.265502 (no previous merge yet)
[S11] round=8 local utility u=0.134439 metrics={'f1_val': 0.396484976660716, 'auprc': 0.9962374787304262, 'loss_val': 0.7428996478223309, 'psi': 0.6363859774886}-{'f1_val': 0.40565455820956814, 'auprc': 0.9409802398647111, 'loss_val': 0.9010232755434933, 'psi': 0.6197848308716254}
[S13] START round=8 head_norm_before_train=1.330062 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.37169029467602305, 'auprc': 0.49460099950335484, 'loss_val': 1.053538164969037, 'psi': 0.4208545766069558}-{'f1_val': 0.416200286011302, 'auprc': 0.518775678656276, 'loss_val': 1.0076986441605817, 'psi': 0.4572304430692916}
[S14] START round=8 head_norm_before_train=0.684743 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.6930567411103907, 'loss_val': 0.9594059576963635, 'psi': 0.515139239091311}-{'f1_val': 0.3964619511854436, 'auprc': 0.7843772450310434, 'loss_val': 1.0094262278605282, 'psi': 0.5516280687236835}
[S15] START round=8 head_norm_before_train=0.695817 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.025308 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.776311025514364, 'loss_val': 1.1749920455698737, 'psi': 0.3943646010226806}-{'f1_val': 0.13973365136155833, 'auprc': 0.7759232378880082, 'loss_val': 1.2244444038040008, 'psi': 0.3942094859721383}
[S16] START round=8 head_norm_before_train=0.916158 cos_to_last_merge=0.9468 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.947
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.341414717191437, 'auprc': 0.5618214124470152, 'loss_val': 0.9684268741457612, 'psi': 0.42957739529366834}-{'f1_val': 0.4177827176245312, 'auprc': 0.5273029414631116, 'loss_val': 1.015765726127994, 'psi': 0.46159080715996337}
[S17] START round=8 head_norm_before_train=1.254130 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.933634 metrics={'f1_val': 0.3893778807331663, 'auprc': 0.6671664395853707, 'loss_val': 1.0482095670101486, 'psi': 0.500493304274048}-{'f1_val': 0.14094896331738438, 'auprc': 0.5738022781212386, 'loss_val': 1.144811071528912, 'psi': 0.3140902892389261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:39010
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39005
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39009
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S5
[S17] cosine check vs S5: cos=0.9857
[S8] RECEIVED delta(kind=head bytes=1795) from S3
[S8] cosine check vs S3: cos=0.9287
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=-0.0388
[S17] DROPPED delta from S6 (cos=-0.0388 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S7
[S2] cosine check vs S7: cos=-0.0951
[S2] DROPPED delta from S7 (cos=-0.0951 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1792) from S2
[S9] cosine check vs S2: cos=0.8245
[S6] RECEIVED delta(kind=head bytes=1794) from S15
[S6] cosine check vs S15: cos=0.8670
[S5] RECEIVED delta(kind=head bytes=1798) from S11
[S5] cosine check vs S11: cos=-0.0811
[S5] DROPPED delta from S11 (cos=-0.0811 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S10
[S14] cosine check vs S10: cos=0.7826
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1791 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1791) from S17
[S16] cosine check vs S17: cos=-0.0443
[S16] DROPPED delta from S17 (cos=-0.0443 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.3965 head_norm=0.723415
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.585867e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3966 head_norm=0.728896 delta_norm=0.258587
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.4367 head_norm=0.807652
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.151520e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.4151 head_norm=1.038012 delta_norm=0.415152
[S9] aggregate: ROLLBACK (f1_val pre=0.437 post=0.415 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.3727 head_norm=1.089008
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.784147e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.3727 head_norm=1.219969 delta_norm=0.278415
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.4154 head_norm=0.592543
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.776417e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.4408 head_norm=0.630046 delta_norm=0.177642
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3894 head_norm=1.280566
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.157129e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3896 head_norm=1.308390 delta_norm=0.115713
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.359168 (no previous merge yet)
[S2] round=9 local utility u=0.313332 metrics={'f1_val': 0.7140770498513698, 'auprc': 0.7762572203546783, 'loss_val': 0.6940714558654741, 'psi': 0.7389491180526933}-{'f1_val': 0.6233925392848891, 'auprc': 0.7762306188082078, 'loss_val': 0.7765491447658693, 'psi': 0.6845277710942166}
[S3] START round=9 head_norm_before_train=1.394898 (no previous merge yet)
[S3] round=9 local utility u=0.050922 metrics={'f1_val': 0.40448947588906725, 'auprc': 0.9984765709365626, 'loss_val': 0.6553175399692405, 'psi': 0.6420843139080654}-{'f1_val': 0.401708470248874, 'auprc': 0.997521879317987, 'loss_val': 0.7376109121326799, 'psi': 0.6400338338765192}
[S4] START round=9 head_norm_before_train=0.969994 cos_to_last_merge=0.9091 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.909
[S4] round=9 local utility u=0.033608 metrics={'f1_val': 0.3754255153473521, 'auprc': 0.6607888152749275, 'loss_val': 0.7475655029214581, 'psi': 0.48957083531838225}-{'f1_val': 0.3743687060425549, 'auprc': 0.6570254435950422, 'loss_val': 0.7971508689657524, 'psi': 0.4874314010635498}
[S5] START round=9 head_norm_before_train=1.345621 (no previous merge yet)
[S5] round=9 local utility u=0.320902 metrics={'f1_val': 0.589458048037051, 'auprc': 0.7890693963699698, 'loss_val': 0.6314819407873704, 'psi': 0.6693025873702185}-{'f1_val': 0.49629763124637005, 'auprc': 0.7948234468547313, 'loss_val': 0.7315847918816786, 'psi': 0.6157079574897146}
[S6] START round=9 head_norm_before_train=0.630046 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.075657 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.6391009880196827, 'loss_val': 1.1201144485107106, 'psi': 0.5057535067341935}-{'f1_val': 0.41544627768762743, 'auprc': 0.6106644015163709, 'loss_val': 1.177666154810188, 'psi': 0.4935335272191248}
[S7] START round=9 head_norm_before_train=0.861256 cos_to_last_merge=0.9884 (last merge round=6)
[S7] round=9 local utility u=0.014117 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7610236873276401, 'loss_val': 0.9067526751691888, 'psi': 0.5545573331925306}-{'f1_val': 0.4171579869317734, 'auprc': 0.7769058235946733, 'loss_val': 0.9841027838375427, 'psi': 0.5610571215969333}
[S8] START round=9 head_norm_before_train=1.219969 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.3727318090052443, 'auprc': 0.6449354705731399, 'loss_val': 0.959374690422243, 'psi': 0.4816132736324026}-{'f1_val': 0.3726652774371328, 'auprc': 0.7748493929215684, 'loss_val': 0.9832237266933898, 'psi': 0.533538923630907}
[S9] START round=9 head_norm_before_train=1.038012 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.41665258336701083, 'auprc': 0.9832254846426935, 'loss_val': 0.7161731630033916, 'psi': 0.6432817438772839}-{'f1_val': 0.4366972869045076, 'auprc': 0.9988475414911182, 'loss_val': 0.8310142456591154, 'psi': 0.6615573887391519}
[S10] START round=9 head_norm_before_train=0.820356 cos_to_last_merge=0.9847 (last merge round=6)
[S10] round=9 local utility u=1.000000 metrics={'f1_val': 0.6948547404516667, 'auprc': 0.7792914485841633, 'loss_val': 0.8427447923900361, 'psi': 0.7286294237046653}-{'f1_val': 0.41705153456077904, 'auprc': 0.6329216402468888, 'loss_val': 0.9899765297141874, 'psi': 0.503399576835223}
[S11] START round=9 head_norm_before_train=1.311865 (no previous merge yet)
[S11] round=9 local utility u=0.843491 metrics={'f1_val': 0.6523060973563611, 'auprc': 0.9943994974933823, 'loss_val': 0.5853295007718997, 'psi': 0.7891434574111695}-{'f1_val': 0.396484976660716, 'auprc': 0.9962374787304262, 'loss_val': 0.7428996478223309, 'psi': 0.6363859774886}
[S13] START round=9 head_norm_before_train=1.366138 (no previous merge yet)
[S13] round=9 local utility u=0.064898 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.41716757865924253, 'loss_val': 0.9561443459798616, 'psi': 0.41635139265511534}-{'f1_val': 0.37169029467602305, 'auprc': 0.49460099950335484, 'loss_val': 1.053538164969037, 'psi': 0.4208545766069558}
[S14] START round=9 head_norm_before_train=0.728896 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.6713070237966008, 'loss_val': 0.9329956239056907, 'psi': 0.5064393521657949}-{'f1_val': 0.39652757107859105, 'auprc': 0.6930567411103907, 'loss_val': 0.9594059576963635, 'psi': 0.515139239091311}
[S15] START round=9 head_norm_before_train=0.711282 cos_to_last_merge=0.9954 (last merge round=7)
[S15] round=9 local utility u=0.546724 metrics={'f1_val': 0.30240183843754487, 'auprc': 0.7764293348350562, 'loss_val': 1.0579080623287065, 'psi': 0.4920128369965494}-{'f1_val': 0.13973365136155833, 'auprc': 0.776311025514364, 'loss_val': 1.1749920455698737, 'psi': 0.3943646010226806}
[S16] START round=9 head_norm_before_train=0.956215 cos_to_last_merge=0.9318 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.932
[S16] round=9 local utility u=0.362996 metrics={'f1_val': 0.3837773547320789, 'auprc': 0.7155487810027095, 'loss_val': 0.9577922919689593, 'psi': 0.5164859252403311}-{'f1_val': 0.341414717191437, 'auprc': 0.5618214124470152, 'loss_val': 0.9684268741457612, 'psi': 0.42957739529366834}
[S17] START round=9 head_norm_before_train=1.308390 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.090964 metrics={'f1_val': 0.38819386064231465, 'auprc': 0.6884534581941522, 'loss_val': 0.923038116778271, 'psi': 0.5082976996630497}-{'f1_val': 0.3893778807331663, 'auprc': 0.6671664395853707, 'loss_val': 1.0482095670101486, 'psi': 0.500493304274048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:39010
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39008
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39014
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.9080
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=0.5090
[S8] RECEIVED delta(kind=head bytes=1797) from S3
[S8] cosine check vs S3: cos=0.9714
[S2] RECEIVED delta(kind=head bytes=1797) from S7
[S2] cosine check vs S7: cos=-0.0991
[S2] DROPPED delta from S7 (cos=-0.0991 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S2
[S9] cosine check vs S2: cos=0.9536
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] cosine check vs S11: cos=-0.0835
[S5] DROPPED delta from S11 (cos=-0.0835 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S5
[S17] cosine check vs S5: cos=0.9870
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=-0.0227
[S17] DROPPED delta from S6 (cos=-0.0227 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S13
[S4] cosine check vs S13: cos=-0.0736
[S4] DROPPED delta from S13 (cos=-0.0736 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S15
[S6] cosine check vs S15: cos=0.9402
[S10] RECEIVED delta(kind=head bytes=1789) from S4
[S10] cosine check vs S4: cos=0.8692
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S17
[S16] cosine check vs S17: cos=-0.0372
[S16] DROPPED delta from S17 (cos=-0.0372 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3727 head_norm=1.241874
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.896847e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.3727 head_norm=1.333879 delta_norm=0.189685
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3965 head_norm=0.763024
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.813558e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.3965 head_norm=0.794719 delta_norm=0.181356
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.4167 head_norm=1.071398
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.505831e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.4167 head_norm=1.224179 delta_norm=0.250583
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4169 head_norm=0.906606
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.751507e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4169 head_norm=0.830054 delta_norm=0.475151
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.6949 head_norm=0.864136
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.537932e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.6932 head_norm=0.913354 delta_norm=0.253793
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.4169 head_norm=0.652820
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.280163e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.4173 head_norm=0.686376 delta_norm=0.128016
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3882 head_norm=1.340653
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.116812e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3812 head_norm=1.356175 delta_norm=0.111681
[S17] aggregate: ROLLBACK (f1_val pre=0.388 post=0.381 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=1.405318 (no previous merge yet)
[S2] round=10 local utility u=0.082981 metrics={'f1_val': 0.7140100917657282, 'auprc': 0.7933448544000994, 'loss_val': 0.5789702354185814, 'psi': 0.7457439968194767}-{'f1_val': 0.7140770498513698, 'auprc': 0.7762572203546783, 'loss_val': 0.6940714558654741, 'psi': 0.7389491180526933}
[S3] START round=10 head_norm_before_train=1.445052 (no previous merge yet)
[S3] round=10 local utility u=0.780893 metrics={'f1_val': 0.6423099435964327, 'auprc': 0.9986705282286036, 'loss_val': 0.5210366334049439, 'psi': 0.784854177449301}-{'f1_val': 0.40448947588906725, 'auprc': 0.9984765709365626, 'loss_val': 0.6553175399692405, 'psi': 0.6420843139080654}
[S4] START round=10 head_norm_before_train=1.024950 cos_to_last_merge=0.8876 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.888
[S4] round=10 local utility u=0.012165 metrics={'f1_val': 0.3744639410711181, 'auprc': 0.6562561844938714, 'loss_val': 0.703869138896615, 'psi': 0.4871808384402194}-{'f1_val': 0.3754255153473521, 'auprc': 0.6607888152749275, 'loss_val': 0.7475655029214581, 'psi': 0.48957083531838225}
[S5] START round=10 head_norm_before_train=1.380586 (no previous merge yet)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.41770670426636225, 'auprc': 0.7918513788056181, 'loss_val': 0.6149205329846674, 'psi': 0.5673645740820645}-{'f1_val': 0.589458048037051, 'auprc': 0.7890693963699698, 'loss_val': 0.6314819407873704, 'psi': 0.6693025873702185}
[S6] START round=10 head_norm_before_train=0.686376 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.050829 metrics={'f1_val': 0.40679158320869035, 'auprc': 0.6708982129576676, 'loss_val': 1.0534672855925649, 'psi': 0.5124342351082812}-{'f1_val': 0.4168551858772006, 'auprc': 0.6391009880196827, 'loss_val': 1.1201144485107106, 'psi': 0.5057535067341935}
[S7] START round=10 head_norm_before_train=0.830054 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.006640 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.7701076638168751, 'loss_val': 0.9202410585951883, 'psi': 0.5581425451858142}-{'f1_val': 0.4169130971024577, 'auprc': 0.7610236873276401, 'loss_val': 0.9067526751691888, 'psi': 0.5545573331925306}
[S8] START round=10 head_norm_before_train=1.333879 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.358927 metrics={'f1_val': 0.3729322731464855, 'auprc': 0.8606106829243393, 'loss_val': 0.8897492266096629, 'psi': 0.568003637057627}-{'f1_val': 0.3727318090052443, 'auprc': 0.6449354705731399, 'loss_val': 0.959374690422243, 'psi': 0.4816132736324026}
[S9] START round=10 head_norm_before_train=1.224179 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.079057 metrics={'f1_val': 0.4167327429296869, 'auprc': 0.9954999960133935, 'loss_val': 0.59536283001527, 'psi': 0.6482396441631695}-{'f1_val': 0.41665258336701083, 'auprc': 0.9832254846426935, 'loss_val': 0.7161731630033916, 'psi': 0.6432817438772839}
[S10] START round=10 head_norm_before_train=0.913354 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.4373079202803595, 'auprc': 0.6236762610966262, 'loss_val': 0.8251833312460218, 'psi': 0.5118552566068661}-{'f1_val': 0.6948547404516667, 'auprc': 0.7792914485841633, 'loss_val': 0.8427447923900361, 'psi': 0.7286294237046653}
[S11] START round=10 head_norm_before_train=1.360865 (no previous merge yet)
[S11] round=10 local utility u=0.210304 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9951886453920842, 'loss_val': 0.46525763265374814, 'psi': 0.819275923724373}-{'f1_val': 0.6523060973563611, 'auprc': 0.9943994974933823, 'loss_val': 0.5853295007718997, 'psi': 0.7891434574111695}
[S13] START round=10 head_norm_before_train=1.405888 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.3429847856124567, 'auprc': 0.4256407391033126, 'loss_val': 0.9948289708522678, 'psi': 0.37604716700879903}-{'f1_val': 0.41580726865236384, 'auprc': 0.41716757865924253, 'loss_val': 0.9561443459798616, 'psi': 0.41635139265511534}
[S14] START round=10 head_norm_before_train=0.794719 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.019805 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.6726932897374208, 'loss_val': 0.8977430577585058, 'psi': 0.5070136372811633}-{'f1_val': 0.39652757107859105, 'auprc': 0.6713070237966008, 'loss_val': 0.9329956239056907, 'psi': 0.5064393521657949}
[S15] START round=10 head_norm_before_train=0.740829 cos_to_last_merge=0.9814 (last merge round=7)
[S15] round=10 local utility u=0.439045 metrics={'f1_val': 0.41915155302495066, 'auprc': 0.7895491256517149, 'loss_val': 0.9196753302265893, 'psi': 0.5673105820756563}-{'f1_val': 0.30240183843754487, 'auprc': 0.7764293348350562, 'loss_val': 1.0579080623287065, 'psi': 0.4920128369965494}
[S16] START round=10 head_norm_before_train=1.003783 cos_to_last_merge=0.9152 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.915
[S16] round=10 local utility u=0.057835 metrics={'f1_val': 0.3656727910687396, 'auprc': 0.752463538428449, 'loss_val': 0.8442394635847991, 'psi': 0.5203890900126233}-{'f1_val': 0.3837773547320789, 'auprc': 0.7155487810027095, 'loss_val': 0.9577922919689593, 'psi': 0.5164859252403311}
[S17] START round=10 head_norm_before_train=1.356175 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.3531220629699248, 'auprc': 0.6215854865731429, 'loss_val': 0.8822768361700832, 'psi': 0.46050743241121206}-{'f1_val': 0.38819386064231465, 'auprc': 0.6884534581941522, 'loss_val': 0.923038116778271, 'psi': 0.5082976996630497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39008
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39015
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S3
[S8] cosine check vs S3: cos=0.9824
[S17] RECEIVED delta(kind=head bytes=1794) from S14
[S17] cosine check vs S14: cos=-0.0415
[S17] DROPPED delta from S14 (cos=-0.0415 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S7
[S2] cosine check vs S7: cos=-0.1175
[S2] DROPPED delta from S7 (cos=-0.1175 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S2
[S9] cosine check vs S2: cos=0.9765
[S6] RECEIVED delta(kind=head bytes=1797) from S15
[S6] cosine check vs S15: cos=0.9555
[S5] RECEIVED delta(kind=head bytes=1790) from S8
[S5] cosine check vs S8: cos=-0.0489
[S5] DROPPED delta from S8 (cos=-0.0489 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] cosine check vs S11: cos=-0.0874
[S5] DROPPED delta from S11 (cos=-0.0874 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S9
[S15] cosine check vs S9: cos=0.1834
[S10] RECEIVED delta(kind=head bytes=1797) from S4
[S10] cosine check vs S4: cos=0.9486
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] cosine check vs S16: cos=0.8486
[S17] RECEIVED delta(kind=head bytes=1795) from S6
[S17] cosine check vs S6: cos=-0.0153
[S17] DROPPED delta from S6 (cos=-0.0153 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.180 → S4@127.0.0.1:39004
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.4373 head_norm=0.952098
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.753337e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.4374 head_norm=1.004313 delta_norm=0.175334
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.417 → S14@127.0.0.1:39014
[S5] ⇄ pheromone p=0.288 → S17@127.0.0.1:39017
[S14] ⇄ pheromone p=0.237 → S17@127.0.0.1:39017
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.3729 head_norm=1.358511
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.500589e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3729 head_norm=1.420142 delta_norm=0.150059
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.339 → S5@127.0.0.1:39005
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.4192 head_norm=0.781977
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.765676e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.3127 head_norm=0.798780 delta_norm=0.676568
[S15] aggregate: ROLLBACK (f1_val pre=0.419 post=0.313 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.331 → S6@127.0.0.1:39007
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4168 head_norm=0.868121
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.798348e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4168 head_norm=0.925487 delta_norm=0.279835
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.220 → S2@127.0.0.1:39002
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.4068 head_norm=0.715626
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.164620e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.4130 head_norm=0.740433 delta_norm=0.116462
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.301 → S17@127.0.0.1:39017
[S16] ⇄ pheromone p=0.266 → S7@127.0.0.1:39008
[S11] ⇄ pheromone p=0.418 → S5@127.0.0.1:39005
[S2] ⇄ pheromone p=0.349 → S9@127.0.0.1:39010
[S4] ⇄ pheromone p=0.246 → S10@127.0.0.1:39011
[S3] ⇄ pheromone p=0.423 → S8@127.0.0.1:39009
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.4167 head_norm=1.257020
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.774084e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.4163 head_norm=1.348792 delta_norm=0.177408
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.259 → S15@127.0.0.1:39015
[S17] ⇄ pheromone p=0.264 → S16@127.0.0.1:39016
[S2] START round=11 head_norm_before_train=1.456477 (no previous merge yet)
[S2] round=11 local utility u=0.044854 metrics={'f1_val': 0.7133831235956654, 'auprc': 0.7922002007788853, 'loss_val': 0.4820669363312774, 'psi': 0.7449099544689533}-{'f1_val': 0.7140100917657282, 'auprc': 0.7933448544000994, 'loss_val': 0.5789702354185814, 'psi': 0.7457439968194767}
[S3] START round=11 head_norm_before_train=1.494354 (no previous merge yet)
[S3] round=11 local utility u=0.226094 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9984885820051222, 'loss_val': 0.4149253378571858, 'psi': 0.8194436149581998}-{'f1_val': 0.6423099435964327, 'auprc': 0.9986705282286036, 'loss_val': 0.5210366334049439, 'psi': 0.784854177449301}
[S4] START round=11 head_norm_before_train=1.082719 cos_to_last_merge=0.8683 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.868
[S4] round=11 local utility u=0.029818 metrics={'f1_val': 0.3737008394838101, 'auprc': 0.6610515593293304, 'loss_val': 0.6540414240036213, 'psi': 0.4886411274220182}-{'f1_val': 0.3744639410711181, 'auprc': 0.6562561844938714, 'loss_val': 0.703869138896615, 'psi': 0.4871808384402194}
[S5] START round=11 head_norm_before_train=1.406740 (no previous merge yet)
[S5] round=11 local utility u=0.703685 metrics={'f1_val': 0.7010644289311239, 'auprc': 0.6697948608087643, 'loss_val': 0.5415282641433349, 'psi': 0.68855660168218}-{'f1_val': 0.41770670426636225, 'auprc': 0.7918513788056181, 'loss_val': 0.6149205329846674, 'psi': 0.5673645740820645}
[S6] START round=11 head_norm_before_train=0.740433 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.354373 metrics={'f1_val': 0.4150420236907487, 'auprc': 0.8602423362881988, 'loss_val': 0.9622554314029116, 'psi': 0.5931221487297288}-{'f1_val': 0.40679158320869035, 'auprc': 0.6708982129576676, 'loss_val': 1.0534672855925649, 'psi': 0.5124342351082812}
[S7] START round=11 head_norm_before_train=0.925487 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7207632244738026, 'loss_val': 0.9122721388871011, 'psi': 0.5383313606561351}-{'f1_val': 0.41683246609844005, 'auprc': 0.7701076638168751, 'loss_val': 0.9202410585951883, 'psi': 0.5581425451858142}
[S8] START round=11 head_norm_before_train=1.420142 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.050107 metrics={'f1_val': 0.3731322377369826, 'auprc': 0.8656233236667047, 'loss_val': 0.8057727642644161, 'psi': 0.5701286721088714}-{'f1_val': 0.3729322731464855, 'auprc': 0.8606106829243393, 'loss_val': 0.8897492266096629, 'psi': 0.568003637057627}
[S9] START round=11 head_norm_before_train=1.348792 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.905873 metrics={'f1_val': 0.6997998234343205, 'auprc': 0.9975831145034847, 'loss_val': 0.4882681148604773, 'psi': 0.8189131398619862}-{'f1_val': 0.4167327429296869, 'auprc': 0.9954999960133935, 'loss_val': 0.59536283001527, 'psi': 0.6482396441631695}
[S10] START round=11 head_norm_before_train=1.004313 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.713573 metrics={'f1_val': 0.5733089354824324, 'auprc': 0.787663984322803, 'loss_val': 0.7060075275019941, 'psi': 0.6590509550185807}-{'f1_val': 0.4373079202803595, 'auprc': 0.6236762610966262, 'loss_val': 0.8251833312460218, 'psi': 0.5118552566068661}
[S11] START round=11 head_norm_before_train=1.411231 (no previous merge yet)
[S11] round=11 local utility u=0.070410 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9975164166136073, 'loss_val': 0.32996948861930675, 'psi': 0.8200619296423217}-{'f1_val': 0.7020007759458987, 'auprc': 0.9951886453920842, 'loss_val': 0.46525763265374814, 'psi': 0.819275923724373}
[S13] START round=11 head_norm_before_train=1.429922 (no previous merge yet)
[S13] round=11 local utility u=0.181492 metrics={'f1_val': 0.35458540597843624, 'auprc': 0.5013278568189067, 'loss_val': 0.9285107961169777, 'psi': 0.41328238631462444}-{'f1_val': 0.3429847856124567, 'auprc': 0.4256407391033126, 'loss_val': 0.9948289708522678, 'psi': 0.37604716700879903}
[S14] START round=11 head_norm_before_train=0.826942 cos_to_last_merge=0.9911 (last merge round=9)
[S14] round=11 local utility u=0.145607 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.7421642045186149, 'loss_val': 0.8149419356427084, 'psi': 0.5348020031936409}-{'f1_val': 0.39656053564365834, 'auprc': 0.6726932897374208, 'loss_val': 0.8977430577585058, 'psi': 0.5070136372811633}
[S15] START round=11 head_norm_before_train=0.798780 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.091032 metrics={'f1_val': 0.4336057430359787, 'auprc': 0.7979978726504094, 'loss_val': 0.8496823097130966, 'psi': 0.579362594881751}-{'f1_val': 0.41915155302495066, 'auprc': 0.7895491256517149, 'loss_val': 0.9196753302265893, 'psi': 0.5673105820756563}
[S16] START round=11 head_norm_before_train=1.056425 cos_to_last_merge=0.8989 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.899
[S16] round=11 local utility u=0.598536 metrics={'f1_val': 0.549087363681878, 'auprc': 0.7643168398882573, 'loss_val': 0.7832146727562349, 'psi': 0.6351791541644297}-{'f1_val': 0.3656727910687396, 'auprc': 0.752463538428449, 'loss_val': 0.8442394635847991, 'psi': 0.5203890900126233}
[S17] START round=11 head_norm_before_train=1.390107 cos_to_last_merge=0.9980 (last merge round=9)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.3469170346940587, 'auprc': 0.6276278468849804, 'loss_val': 0.9364934221108862, 'psi': 0.4592013595704274}-{'f1_val': 0.3531220629699248, 'auprc': 0.6215854865731429, 'loss_val': 0.8822768361700832, 'psi': 0.46050743241121206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:39010
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S14] → sending delta(kind=head bytes=1787) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39011
[S4] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1787 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1807 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S3
[S8] cosine check vs S3: cos=0.9871
[S7] RECEIVED delta(kind=head bytes=1789) from S16
[S7] cosine check vs S16: cos=0.9429
[S9] RECEIVED delta(kind=head bytes=1798) from S2
[S9] cosine check vs S2: cos=0.9834
[S6] RECEIVED delta(kind=head bytes=1797) from S15
[S6] cosine check vs S15: cos=0.6435
[S5] RECEIVED delta(kind=head bytes=1792) from S11
[S5] cosine check vs S11: cos=-0.0897
[S5] DROPPED delta from S11 (cos=-0.0897 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S8
[S5] cosine check vs S8: cos=-0.0483
[S5] DROPPED delta from S8 (cos=-0.0483 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1807) from S13
[S4] cosine check vs S13: cos=-0.0678
[S4] DROPPED delta from S13 (cos=-0.0678 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S9
[S15] cosine check vs S9: cos=0.8251
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.8519
[S10] RECEIVED delta(kind=head bytes=1796) from S4
[S10] cosine check vs S4: cos=0.9732
[S17] RECEIVED delta(kind=head bytes=1787) from S14
[S17] cosine check vs S14: cos=-0.0385
[S17] DROPPED delta from S14 (cos=-0.0385 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S6
[S17] cosine check vs S6: cos=-0.0045
[S17] DROPPED delta from S6 (cos=-0.0045 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S5
[S17] cosine check vs S5: cos=0.9808
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4167 head_norm=0.960122
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.902075e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4167 head_norm=1.021052 delta_norm=0.190208
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.3966 head_norm=0.871382
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.724545e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.3966 head_norm=0.919926 delta_norm=0.272454
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.5733 head_norm=1.040041
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.347043e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.6974 head_norm=1.081048 delta_norm=0.134704
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.6998 head_norm=1.382332
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.465518e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.6995 head_norm=1.440657 delta_norm=0.146552
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.3731 head_norm=1.447489
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.288464e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.3731 head_norm=1.490001 delta_norm=0.128846
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.4336 head_norm=0.836211
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.191235e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.2845 head_norm=1.062723 delta_norm=0.419123
[S15] aggregate: ROLLBACK (f1_val pre=0.434 post=0.285 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.4150 head_norm=0.770756
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.405178e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.4171 head_norm=0.728495 delta_norm=0.340518
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3469 head_norm=1.423543
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.397350e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3460 head_norm=1.420482 delta_norm=0.139735
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.510993 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.6999488443093624, 'auprc': 0.772578658933262, 'loss_val': 0.40130007822521996, 'psi': 0.7290007701589223}-{'f1_val': 0.7133831235956654, 'auprc': 0.7922002007788853, 'loss_val': 0.4820669363312774, 'psi': 0.7449099544689533}
[S3] START round=12 head_norm_before_train=1.542136 (no previous merge yet)
[S3] round=12 local utility u=0.030497 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9954882872484305, 'loss_val': 0.34793775403495053, 'psi': 0.8185441524946252}-{'f1_val': 0.7000803035935849, 'auprc': 0.9984885820051222, 'loss_val': 0.4149253378571858, 'psi': 0.8194436149581998}
[S4] START round=12 head_norm_before_train=1.136633 cos_to_last_merge=0.8526 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.853
[S4] round=12 local utility u=0.861544 metrics={'f1_val': 0.658679497615879, 'auprc': 0.6537500443821673, 'loss_val': 0.6189198387626499, 'psi': 0.6567077163223943}-{'f1_val': 0.3737008394838101, 'auprc': 0.6610515593293304, 'loss_val': 0.6540414240036213, 'psi': 0.4886411274220182}
[S5] START round=12 head_norm_before_train=1.431124 (no previous merge yet)
[S5] round=12 local utility u=0.211324 metrics={'f1_val': 0.7076497872325653, 'auprc': 0.7903785866569348, 'loss_val': 0.5201426132238206, 'psi': 0.7407413070023132}-{'f1_val': 0.7010644289311239, 'auprc': 0.6697948608087643, 'loss_val': 0.5415282641433349, 'psi': 0.68855660168218}
[S6] START round=12 head_norm_before_train=0.728495 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.057331 metrics={'f1_val': 0.41953178896669663, 'auprc': 0.8625968685134665, 'loss_val': 0.8815949734358624, 'psi': 0.5967578207854046}-{'f1_val': 0.4150420236907487, 'auprc': 0.8602423362881988, 'loss_val': 0.9622554314029116, 'psi': 0.5931221487297288}
[S7] START round=12 head_norm_before_train=1.021052 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.6896626048222236, 'loss_val': 0.8929150046144201, 'psi': 0.5258911127955035}-{'f1_val': 0.41671011811102343, 'auprc': 0.7207632244738026, 'loss_val': 0.9122721388871011, 'psi': 0.5383313606561351}
[S8] START round=12 head_norm_before_train=1.490001 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.153186 metrics={'f1_val': 0.4058137614389612, 'auprc': 0.8661545420911456, 'loss_val': 0.6970840875468559, 'psi': 0.589950073699835}-{'f1_val': 0.3731322377369826, 'auprc': 0.8656233236667047, 'loss_val': 0.8057727642644161, 'psi': 0.5701286721088714}
[S9] START round=12 head_norm_before_train=1.440657 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.041534 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9978698502464164, 'loss_val': 0.4150035547085978, 'psi': 0.8199222302231046}-{'f1_val': 0.6997998234343205, 'auprc': 0.9975831145034847, 'loss_val': 0.4882681148604773, 'psi': 0.8189131398619862}
[S10] START round=12 head_norm_before_train=1.081048 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.706940 metrics={'f1_val': 0.6931490484963042, 'auprc': 0.9792370378181809, 'loss_val': 0.5858865055710395, 'psi': 0.8075842442250549}-{'f1_val': 0.5733089354824324, 'auprc': 0.787663984322803, 'loss_val': 0.7060075275019941, 'psi': 0.6590509550185807}
[S11] START round=12 head_norm_before_train=1.464453 (no previous merge yet)
[S11] round=12 local utility u=0.657838 metrics={'f1_val': 0.9169192086680542, 'auprc': 0.9982564677573544, 'loss_val': 0.307474812518114, 'psi': 0.9494541123037743}-{'f1_val': 0.7017589383281313, 'auprc': 0.9975164166136073, 'loss_val': 0.32996948861930675, 'psi': 0.8200619296423217}
[S13] START round=12 head_norm_before_train=1.454884 (no previous merge yet)
[S13] round=12 local utility u=0.081724 metrics={'f1_val': 0.3845777646598761, 'auprc': 0.5063158550042494, 'loss_val': 0.9599815036084132, 'psi': 0.43327300079762543}-{'f1_val': 0.35458540597843624, 'auprc': 0.5013278568189067, 'loss_val': 0.9285107961169777, 'psi': 0.41328238631462444}
[S14] START round=12 head_norm_before_train=0.919926 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.024316 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.7495833696363363, 'loss_val': 0.7887650804836803, 'psi': 0.5377895098832918}-{'f1_val': 0.39656053564365834, 'auprc': 0.7421642045186149, 'loss_val': 0.8149419356427084, 'psi': 0.5348020031936409}
[S15] START round=12 head_norm_before_train=1.062723 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=1.000000 metrics={'f1_val': 0.948490951673707, 'auprc': 0.940778032692904, 'loss_val': 0.760810122164768, 'psi': 0.9454057840813859}-{'f1_val': 0.4336057430359787, 'auprc': 0.7979978726504094, 'loss_val': 0.8496823097130966, 'psi': 0.579362594881751}
[S16] START round=12 head_norm_before_train=1.111583 cos_to_last_merge=0.8849 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.885
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.4614119936827612, 'auprc': 0.7698436706312346, 'loss_val': 0.7467228421220147, 'psi': 0.5847846644621506}-{'f1_val': 0.549087363681878, 'auprc': 0.7643168398882573, 'loss_val': 0.7832146727562349, 'psi': 0.6351791541644297}
[S17] START round=12 head_norm_before_train=1.420482 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.33838405615311445, 'auprc': 0.5637736456058536, 'loss_val': 0.9704230459344413, 'psi': 0.42853989193421016}-{'f1_val': 0.3469170346940587, 'auprc': 0.6276278468849804, 'loss_val': 0.9364934221108862, 'psi': 0.4592013595704274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39009
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39017
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39015
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S3
[S8] cosine check vs S3: cos=0.9898
[S6] RECEIVED delta(kind=head bytes=1799) from S15
[S6] cosine check vs S15: cos=0.7254
[S5] RECEIVED delta(kind=head bytes=1803) from S8
[S5] cosine check vs S8: cos=-0.0495
[S5] DROPPED delta from S8 (cos=-0.0495 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S11
[S5] cosine check vs S11: cos=-0.0908
[S5] DROPPED delta from S11 (cos=-0.0908 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S13
[S4] cosine check vs S13: cos=-0.0674
[S4] DROPPED delta from S13 (cos=-0.0674 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] cosine check vs S9: cos=0.9494
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=0.9343
[S10] RECEIVED delta(kind=head bytes=1796) from S4
[S10] cosine check vs S4: cos=0.9832
[S17] RECEIVED delta(kind=head bytes=1791) from S14
[S17] cosine check vs S14: cos=-0.0241
[S17] DROPPED delta from S14 (cos=-0.0241 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S5
[S17] cosine check vs S5: cos=0.9899
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=0.0005
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.9485 head_norm=1.092376
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.779213e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.9648 head_norm=1.267457 delta_norm=0.277921
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.6931 head_norm=1.116352
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.119647e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.6909 head_norm=1.148741 delta_norm=0.111965
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.3966 head_norm=0.949948
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.043709e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.3966 head_norm=1.016147 delta_norm=0.204371
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.4195 head_norm=0.762468
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.762521e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.4400 head_norm=0.863572 delta_norm=0.376252
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.4058 head_norm=1.518024
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.157185e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.4066 head_norm=1.547916 delta_norm=0.115719
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3384 head_norm=1.447187
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.114585e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3382 head_norm=1.101191 delta_norm=0.411459
[S17] aggregate: ACCEPT kept=['S5', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.563282 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.6876099990757807, 'auprc': 0.6677385588181662, 'loss_val': 0.3814542873926397, 'psi': 0.6796614229727349}-{'f1_val': 0.6999488443093624, 'auprc': 0.772578658933262, 'loss_val': 0.40130007822521996, 'psi': 0.7290007701589223}
[S3] START round=13 head_norm_before_train=1.585709 (no previous merge yet)
[S3] round=13 local utility u=0.011981 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9941678065338395, 'loss_val': 0.3185111552161046, 'psi': 0.8178656740254531}-{'f1_val': 0.7005813959920884, 'auprc': 0.9954882872484305, 'loss_val': 0.34793775403495053, 'psi': 0.8185441524946252}
[S4] START round=13 head_norm_before_train=1.190816 cos_to_last_merge=0.8379 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.838
[S4] round=13 local utility u=0.324111 metrics={'f1_val': 0.6616380746737578, 'auprc': 0.8490960263704358, 'loss_val': 0.5744876095603202, 'psi': 0.736621255352429}-{'f1_val': 0.658679497615879, 'auprc': 0.6537500443821673, 'loss_val': 0.6189198387626499, 'psi': 0.6567077163223943}
[S5] START round=13 head_norm_before_train=1.456092 (no previous merge yet)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.6960569594046877, 'loss_val': 0.42959950007260517, 'psi': 0.6989128990683893}-{'f1_val': 0.7076497872325653, 'auprc': 0.7903785866569348, 'loss_val': 0.5201426132238206, 'psi': 0.7407413070023132}
[S6] START round=13 head_norm_before_train=0.863572 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.014131 metrics={'f1_val': 0.4185096571854428, 'auprc': 0.8599499560284, 'loss_val': 0.8392594968731805, 'psi': 0.5950857767226256}-{'f1_val': 0.41953178896669663, 'auprc': 0.8625968685134665, 'loss_val': 0.8815949734358624, 'psi': 0.5967578207854046}
[S7] START round=13 head_norm_before_train=1.050118 cos_to_last_merge=0.9959 (last merge round=11)
[S7] round=13 local utility u=0.020046 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.6858994234074596, 'loss_val': 0.8415326903865537, 'psi': 0.5243858402295979}-{'f1_val': 0.41671011811102343, 'auprc': 0.6896626048222236, 'loss_val': 0.8929150046144201, 'psi': 0.5258911127955035}
[S8] START round=13 head_norm_before_train=1.547916 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.110665 metrics={'f1_val': 0.37385712535452115, 'auprc': 0.9905707369344923, 'loss_val': 0.6572624011321163, 'psi': 0.6205425699865097}-{'f1_val': 0.4058137614389612, 'auprc': 0.8661545420911456, 'loss_val': 0.6970840875468559, 'psi': 0.589950073699835}
[S9] START round=13 head_norm_before_train=1.474480 cos_to_last_merge=0.9977 (last merge round=11)
[S9] round=13 local utility u=0.032262 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9976689049440812, 'loss_val': 0.3498761221046111, 'psi': 0.8198418521021705}-{'f1_val': 0.7012904835408967, 'auprc': 0.9978698502464164, 'loss_val': 0.4150035547085978, 'psi': 0.8199222302231046}
[S10] START round=13 head_norm_before_train=1.148741 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.063146 metrics={'f1_val': 0.6922363084454471, 'auprc': 0.9950580655364601, 'loss_val': 0.5015812389795045, 'psi': 0.8133650112818523}-{'f1_val': 0.6931490484963042, 'auprc': 0.9792370378181809, 'loss_val': 0.5858865055710395, 'psi': 0.8075842442250549}
[S11] START round=13 head_norm_before_train=1.517407 (no previous merge yet)
[S11] round=13 local utility u=0.185724 metrics={'f1_val': 0.9599487202552428, 'auprc': 0.9979209586284057, 'loss_val': 0.19319784249969188, 'psi': 0.975137615604508}-{'f1_val': 0.9169192086680542, 'auprc': 0.9982564677573544, 'loss_val': 0.307474812518114, 'psi': 0.9494541123037743}
[S13] START round=13 head_norm_before_train=1.481601 (no previous merge yet)
[S13] round=13 local utility u=0.449804 metrics={'f1_val': 0.4831597390950938, 'auprc': 0.6002737155542269, 'loss_val': 0.9337386966400724, 'psi': 0.530005329678747}-{'f1_val': 0.3845777646598761, 'auprc': 0.5063158550042494, 'loss_val': 0.9599815036084132, 'psi': 0.43327300079762543}
[S14] START round=13 head_norm_before_train=1.016147 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.077553 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.7961657097067697, 'loss_val': 0.7732077445713388, 'psi': 0.556402605268903}-{'f1_val': 0.39659360338126215, 'auprc': 0.7495833696363363, 'loss_val': 0.7887650804836803, 'psi': 0.5377895098832918}
[S15] START round=13 head_norm_before_train=1.267457 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.6976424939661235, 'auprc': 0.7407185787972412, 'loss_val': 0.6631080180486895, 'psi': 0.7148729278985706}-{'f1_val': 0.948490951673707, 'auprc': 0.940778032692904, 'loss_val': 0.760810122164768, 'psi': 0.9454057840813859}
[S16] START round=13 head_norm_before_train=1.164159 cos_to_last_merge=0.8728 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.873
[S16] round=13 local utility u=0.151607 metrics={'f1_val': 0.5169102373922204, 'auprc': 0.7981650470736896, 'loss_val': 0.8614617444124117, 'psi': 0.629412161264808}-{'f1_val': 0.4614119936827612, 'auprc': 0.7698436706312346, 'loss_val': 0.7467228421220147, 'psi': 0.5847846644621506}
[S17] START round=13 head_norm_before_train=1.101191 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.060590 metrics={'f1_val': 0.34704426295004875, 'auprc': 0.5853276497602948, 'loss_val': 0.9658670138453094, 'psi': 0.44235761767414716}-{'f1_val': 0.33838405615311445, 'auprc': 0.5637736456058536, 'loss_val': 0.9704230459344413, 'psi': 0.42853989193421016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39002
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:39017
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39008
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39017
[S10] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] cosine check vs S8: cos=-0.0516
[S5] DROPPED delta from S8 (cos=-0.0516 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S4
[S10] cosine check vs S4: cos=0.9878
[S17] RECEIVED delta(kind=head bytes=1793) from S14
[S17] cosine check vs S14: cos=0.0150
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] cosine check vs S16: cos=0.9465
[S2] RECEIVED delta(kind=head bytes=1797) from S7
[S2] cosine check vs S7: cos=-0.1165
[S2] DROPPED delta from S7 (cos=-0.1165 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S11
[S5] cosine check vs S11: cos=-0.0902
[S5] DROPPED delta from S11 (cos=-0.0902 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S6
[S17] cosine check vs S6: cos=0.1564
[S4] RECEIVED delta(kind=head bytes=1800) from S13
[S4] cosine check vs S13: cos=-0.0656
[S4] DROPPED delta from S13 (cos=-0.0656 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1806) from S9
[S15] cosine check vs S9: cos=0.9816
[S8] RECEIVED delta(kind=head bytes=1806) from S3
[S8] cosine check vs S3: cos=0.9919
[S14] RECEIVED delta(kind=head bytes=1794) from S10
[S14] cosine check vs S10: cos=0.9678
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1793 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S17
[S16] cosine check vs S17: cos=0.0194
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.4167 head_norm=1.082306
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.969417e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.4167 head_norm=1.128928 delta_norm=0.196942
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.3966 head_norm=1.037012
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.582038e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.3966 head_norm=1.100637 delta_norm=0.158204
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.6922 head_norm=1.182146
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.916729e-02
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.6899 head_norm=1.208297 delta_norm=0.099167
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.5169 head_norm=1.206292
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.171956e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.5166 head_norm=0.833140 delta_norm=0.817196
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.3739 head_norm=1.577920
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.042907e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.3739 head_norm=1.596735 delta_norm=0.104291
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6976 head_norm=1.296257
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.724308e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6976 head_norm=1.397974 delta_norm=0.172431
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3470 head_norm=1.126375
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.324728e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3415 head_norm=0.698008 delta_norm=0.632473
[S17] aggregate: ROLLBACK (f1_val pre=0.347 post=0.342 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.605889 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.6710044342605689, 'auprc': 0.6487966671371054, 'loss_val': 0.4629202374760418, 'psi': 0.6621213274111835}-{'f1_val': 0.6876099990757807, 'auprc': 0.6677385588181662, 'loss_val': 0.3814542873926397, 'psi': 0.6796614229727349}
[S3] START round=14 head_norm_before_train=1.622051 (no previous merge yet)
[S3] round=14 local utility u=0.020024 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9952798805599028, 'loss_val': 0.2848032958552717, 'psi': 0.8186109932392476}-{'f1_val': 0.700330919019862, 'auprc': 0.9941678065338395, 'loss_val': 0.3185111552161046, 'psi': 0.8178656740254531}
[S4] START round=14 head_norm_before_train=1.241839 cos_to_last_merge=0.8229 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.823
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.6650384243419165, 'auprc': 0.7838226065801116, 'loss_val': 0.5545334192411223, 'psi': 0.7125520972371946}-{'f1_val': 0.6616380746737578, 'auprc': 0.8490960263704358, 'loss_val': 0.5744876095603202, 'psi': 0.736621255352429}
[S5] START round=14 head_norm_before_train=1.488195 (no previous merge yet)
[S5] round=14 local utility u=0.137717 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.7784664303183118, 'loss_val': 0.39990327947972465, 'psi': 0.7317276781301157}-{'f1_val': 0.7008168588441903, 'auprc': 0.6960569594046877, 'loss_val': 0.42959950007260517, 'psi': 0.6989128990683893}
[S6] START round=14 head_norm_before_train=0.890917 cos_to_last_merge=0.9962 (last merge round=12)
[S6] round=14 local utility u=0.219175 metrics={'f1_val': 0.46875652315331795, 'auprc': 0.8605103313113437, 'loss_val': 0.7040724869360807, 'psi': 0.6254580464165282}-{'f1_val': 0.4185096571854428, 'auprc': 0.8599499560284, 'loss_val': 0.8392594968731805, 'psi': 0.5950857767226256}
[S7] START round=14 head_norm_before_train=1.128928 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.39777520717455545, 'auprc': 0.645257111801425, 'loss_val': 0.8743163805671478, 'psi': 0.49676796902530324}-{'f1_val': 0.41671011811102343, 'auprc': 0.6858994234074596, 'loss_val': 0.8415326903865537, 'psi': 0.5243858402295979}
[S8] START round=14 head_norm_before_train=1.596735 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.718329 metrics={'f1_val': 0.6553452627147397, 'auprc': 0.8857419495437229, 'loss_val': 0.5950473270595725, 'psi': 0.747503937446333}-{'f1_val': 0.37385712535452115, 'auprc': 0.9905707369344923, 'loss_val': 0.6572624011321163, 'psi': 0.6205425699865097}
[S9] START round=14 head_norm_before_train=1.512564 cos_to_last_merge=0.9928 (last merge round=11)
[S9] round=14 local utility u=0.016895 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9974973209747691, 'loss_val': 0.3159965131702187, 'psi': 0.8198157440969951}-{'f1_val': 0.7012904835408967, 'auprc': 0.9976689049440812, 'loss_val': 0.3498761221046111, 'psi': 0.8198418521021705}
[S10] START round=14 head_norm_before_train=1.208297 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.6830484745597455, 'auprc': 0.9295739282447772, 'loss_val': 0.508704025849676, 'psi': 0.7816586560337582}-{'f1_val': 0.6922363084454471, 'auprc': 0.9950580655364601, 'loss_val': 0.5015812389795045, 'psi': 0.8133650112818523}
[S11] START round=14 head_norm_before_train=1.566283 (no previous merge yet)
[S11] round=14 local utility u=0.125842 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9985045468566294, 'loss_val': 0.16388597468874025, 'psi': 0.9974332143625914}-{'f1_val': 0.9599487202552428, 'auprc': 0.9979209586284057, 'loss_val': 0.19319784249969188, 'psi': 0.975137615604508}
[S13] START round=14 head_norm_before_train=1.502040 (no previous merge yet)
[S13] round=14 local utility u=0.231478 metrics={'f1_val': 0.5611504566597075, 'auprc': 0.5622306595300095, 'loss_val': 0.8245977108614106, 'psi': 0.5615825378078283}-{'f1_val': 0.4831597390950938, 'auprc': 0.6002737155542269, 'loss_val': 0.9337386966400724, 'psi': 0.530005329678747}
[S14] START round=14 head_norm_before_train=1.100637 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.7708021025260559, 'loss_val': 0.7398879146312795, 'psi': 0.5462373836575769}-{'f1_val': 0.39656053564365834, 'auprc': 0.7961657097067697, 'loss_val': 0.7732077445713388, 'psi': 0.556402605268903}
[S15] START round=14 head_norm_before_train=1.397974 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.487720 metrics={'f1_val': 0.7025315124624018, 'auprc': 0.9970704291845083, 'loss_val': 0.4860584740736756, 'psi': 0.8203470791512444}-{'f1_val': 0.6976424939661235, 'auprc': 0.7407185787972412, 'loss_val': 0.6631080180486895, 'psi': 0.7148729278985706}
[S16] START round=14 head_norm_before_train=0.833140 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.4379822900136469, 'auprc': 0.8219949640287965, 'loss_val': 0.7455567970809209, 'psi': 0.5915873596197068}-{'f1_val': 0.5169102373922204, 'auprc': 0.7981650470736896, 'loss_val': 0.8614617444124117, 'psi': 0.629412161264808}
[S17] START round=14 head_norm_before_train=0.698008 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.34947125409591895, 'auprc': 0.5287455647171806, 'loss_val': 0.9879123648252852, 'psi': 0.4211809783444236}-{'f1_val': 0.34704426295004875, 'auprc': 0.5853276497602948, 'loss_val': 0.9658670138453094, 'psi': 0.44235761767414716}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:39009
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39017
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39015
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39005
[S13] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1807 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S15
[S6] cosine check vs S15: cos=0.8487
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] cosine check vs S8: cos=-0.0541
[S5] DROPPED delta from S8 (cos=-0.0541 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] cosine check vs S11: cos=-0.0898
[S5] DROPPED delta from S11 (cos=-0.0898 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S13
[S4] cosine check vs S13: cos=-0.0647
[S4] DROPPED delta from S13 (cos=-0.0647 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S9
[S15] cosine check vs S9: cos=0.9887
[S17] RECEIVED delta(kind=head bytes=1800) from S5
[S17] cosine check vs S5: cos=0.7794
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=0.4603
[S8] RECEIVED delta(kind=head bytes=1807) from S3
[S8] cosine check vs S3: cos=0.9942
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.7025 head_norm=1.427793
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.268345e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.8752 head_norm=1.483317 delta_norm=0.126834
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.6553 head_norm=1.623891
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.970284e-02
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.6551 head_norm=1.635823 delta_norm=0.089703
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.4688 head_norm=0.925679
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.037289e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.5995 head_norm=1.133464 delta_norm=0.403729
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3495 head_norm=0.741730
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.923652e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3516 head_norm=0.796309 delta_norm=0.192365
[S17] aggregate: ACCEPT kept=['S5', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.636797 (no previous merge yet)
[S2] round=15 local utility u=0.053435 metrics={'f1_val': 0.678956170298796, 'auprc': 0.6511364170900884, 'loss_val': 0.41078007345909767, 'psi': 0.6678282690153129}-{'f1_val': 0.6710044342605689, 'auprc': 0.6487966671371054, 'loss_val': 0.4629202374760418, 'psi': 0.6621213274111835}
[S3] START round=15 head_norm_before_train=1.652546 (no previous merge yet)
[S3] round=15 local utility u=0.002603 metrics={'f1_val': 0.7010863553524592, 'auprc': 0.9941683982404536, 'loss_val': 0.27779078607061686, 'psi': 0.8183191725076571}-{'f1_val': 0.7008317350254774, 'auprc': 0.9952798805599028, 'loss_val': 0.2848032958552717, 'psi': 0.8186109932392476}
[S4] START round=15 head_norm_before_train=1.287681 cos_to_last_merge=0.8103 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.810
[S4] round=15 local utility u=0.106189 metrics={'f1_val': 0.6625220906071896, 'auprc': 0.8586136753273659, 'loss_val': 0.5514315835469982, 'psi': 0.7409587244952601}-{'f1_val': 0.6650384243419165, 'auprc': 0.7838226065801116, 'loss_val': 0.5545334192411223, 'psi': 0.7125520972371946}
[S5] START round=15 head_norm_before_train=1.518976 (no previous merge yet)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.7489350767602418, 'loss_val': 0.3719792400330214, 'psi': 0.7199151367068878}-{'f1_val': 0.7005685100046517, 'auprc': 0.7784664303183118, 'loss_val': 0.39990327947972465, 'psi': 0.7317276781301157}
[S6] START round=15 head_norm_before_train=1.133464 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.4377371237743743, 'auprc': 0.8606276162759308, 'loss_val': 0.6949185609620097, 'psi': 0.6068933207749969}-{'f1_val': 0.46875652315331795, 'auprc': 0.8605103313113437, 'loss_val': 0.7040724869360807, 'psi': 0.6254580464165282}
[S7] START round=15 head_norm_before_train=1.156386 cos_to_last_merge=0.9975 (last merge round=13)
[S7] round=15 local utility u=0.193830 metrics={'f1_val': 0.42663981419400776, 'auprc': 0.7020136755034666, 'loss_val': 0.8301146611731712, 'psi': 0.5367893587177912}-{'f1_val': 0.39777520717455545, 'auprc': 0.645257111801425, 'loss_val': 0.8743163805671478, 'psi': 0.49676796902530324}
[S8] START round=15 head_norm_before_train=1.635823 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.654201145234794, 'auprc': 0.8649947746173452, 'loss_val': 0.5548581275259372, 'psi': 0.7385185969878145}-{'f1_val': 0.6553452627147397, 'auprc': 0.8857419495437229, 'loss_val': 0.5950473270595725, 'psi': 0.747503937446333}
[S9] START round=15 head_norm_before_train=1.547269 cos_to_last_merge=0.9877 (last merge round=11)
[S9] round=15 local utility u=0.008808 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9971423539349565, 'loss_val': 0.29731644625735265, 'psi': 0.8196737572810702}-{'f1_val': 0.7013613595118124, 'auprc': 0.9974973209747691, 'loss_val': 0.3159965131702187, 'psi': 0.8198157440969951}
[S10] START round=15 head_norm_before_train=1.239764 cos_to_last_merge=0.9990 (last merge round=13)
[S10] round=15 local utility u=0.468032 metrics={'f1_val': 0.7874923985356199, 'auprc': 0.9927661088163653, 'loss_val': 0.3888809962572211, 'psi': 0.869601882647918}-{'f1_val': 0.6830484745597455, 'auprc': 0.9295739282447772, 'loss_val': 0.508704025849676, 'psi': 0.7816586560337582}
[S11] START round=15 head_norm_before_train=1.608908 (no previous merge yet)
[S11] round=15 local utility u=0.010222 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9985869696504416, 'loss_val': 0.14120674887013007, 'psi': 0.9972178883414933}-{'f1_val': 0.9967189926998994, 'auprc': 0.9985045468566294, 'loss_val': 0.16388597468874025, 'psi': 0.9974332143625914}
[S13] START round=15 head_norm_before_train=1.516700 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5566053009836143, 'auprc': 0.5168736065356047, 'loss_val': 0.8382694961214943, 'psi': 0.5407126232044104}-{'f1_val': 0.5611504566597075, 'auprc': 0.5622306595300095, 'loss_val': 0.8245977108614106, 'psi': 0.5615825378078283}
[S14] START round=15 head_norm_before_train=1.125859 cos_to_last_merge=0.9976 (last merge round=13)
[S14] round=15 local utility u=0.270060 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.9183751722182261, 'loss_val': 0.6428837945574746, 'psi': 0.6053062309160477}-{'f1_val': 0.39652757107859105, 'auprc': 0.7708021025260559, 'loss_val': 0.7398879146312795, 'psi': 0.5462373836575769}
[S15] START round=15 head_norm_before_train=1.483317 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6941680422578679, 'auprc': 0.9456109048181105, 'loss_val': 0.4698110337369267, 'psi': 0.7947451872819649}-{'f1_val': 0.7025315124624018, 'auprc': 0.9970704291845083, 'loss_val': 0.4860584740736756, 'psi': 0.8203470791512444}
[S16] START round=15 head_norm_before_train=0.871201 cos_to_last_merge=0.9977 (last merge round=13)
[S16] round=15 local utility u=1.000000 metrics={'f1_val': 0.9052668973801622, 'auprc': 0.9124115205817297, 'loss_val': 0.5762409431086299, 'psi': 0.9081247466607891}-{'f1_val': 0.4379822900136469, 'auprc': 0.8219949640287965, 'loss_val': 0.7455567970809209, 'psi': 0.5915873596197068}
[S17] START round=15 head_norm_before_train=0.796309 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.352445 metrics={'f1_val': 0.36342136555959725, 'auprc': 0.7202323782626471, 'loss_val': 0.9411843776828752, 'psi': 0.5061457706408172}-{'f1_val': 0.34947125409591895, 'auprc': 0.5287455647171806, 'loss_val': 0.9879123648252852, 'psi': 0.4211809783444236}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39011
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:39010
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39008
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39014
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S7
[S2] cosine check vs S7: cos=-0.1015
[S2] DROPPED delta from S7 (cos=-0.1015 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S2
[S9] cosine check vs S2: cos=0.9546
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] cosine check vs S11: cos=-0.0899
[S5] DROPPED delta from S11 (cos=-0.0899 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S9
[S15] cosine check vs S9: cos=0.9927
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9685
[S10] RECEIVED delta(kind=head bytes=1796) from S4
[S10] cosine check vs S4: cos=0.9840
[S17] RECEIVED delta(kind=head bytes=1798) from S14
[S17] cosine check vs S14: cos=0.1933
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] cosine check vs S16: cos=0.7835
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S17
[S16] cosine check vs S17: cos=0.6149
[S3] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S3
[S8] cosine check vs S3: cos=0.9952
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.6542 head_norm=1.668814
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.191998e-02
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.6320 head_norm=1.671367 delta_norm=0.081920
[S8] aggregate: ROLLBACK (f1_val pre=0.654 post=0.632 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.260 → S5@127.0.0.1:39005
[S6] ⇄ pheromone p=0.171 → S17@127.0.0.1:39017
[S5] ⇄ pheromone p=0.196 → S17@127.0.0.1:39017
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7014 head_norm=1.578497
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.479267e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7014 head_norm=1.602477 delta_norm=0.247927
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.172 → S15@127.0.0.1:39015
[S4] ⇄ pheromone p=0.234 → S10@127.0.0.1:39011
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.7875 head_norm=1.270008
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.189070e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.7868 head_norm=1.291129 delta_norm=0.118907
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.369 → S14@127.0.0.1:39014
[S2] ⇄ pheromone p=0.129 → S9@127.0.0.1:39010
[S11] ⇄ pheromone p=0.256 → S5@127.0.0.1:39005
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.4266 head_norm=1.186981
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.687811e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.5176 head_norm=0.997271 delta_norm=0.368781
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.113 → S2@127.0.0.1:39002
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.3966 head_norm=1.158474
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.621136e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.3966 head_norm=1.204662 delta_norm=0.162114
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.156 → S17@127.0.0.1:39017
[S13] ⇄ pheromone p=0.177 → S4@127.0.0.1:39004
[S3] ⇄ pheromone p=0.165 → S8@127.0.0.1:39009
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.6942 head_norm=1.509767
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.958703e-02
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.6936 head_norm=1.541300 delta_norm=0.099587
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.296 → S6@127.0.0.1:39007
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.9053 head_norm=0.923134
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.903941e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.8994 head_norm=0.796784 delta_norm=0.390394
[S16] aggregate: ROLLBACK (f1_val pre=0.905 post=0.899 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.356 → S7@127.0.0.1:39008
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3634 head_norm=0.849923
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.488064e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3520 head_norm=0.781835 delta_norm=0.648806
[S17] aggregate: ROLLBACK (f1_val pre=0.363 post=0.352 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.165 → S16@127.0.0.1:39016
[S2] START round=16 head_norm_before_train=1.663475 (no previous merge yet)
[S2] round=16 local utility u=0.247188 metrics={'f1_val': 0.7091425585513104, 'auprc': 0.787732333863985, 'loss_val': 0.5073109533806471, 'psi': 0.7405784686763802}-{'f1_val': 0.678956170298796, 'auprc': 0.6511364170900884, 'loss_val': 0.41078007345909767, 'psi': 0.6678282690153129}
[S3] START round=16 head_norm_before_train=1.677920 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9939588990606582, 'loss_val': 0.27473812206387943, 'psi': 0.8177821110361805}-{'f1_val': 0.7010863553524592, 'auprc': 0.9941683982404536, 'loss_val': 0.27779078607061686, 'psi': 0.8183191725076571}
[S4] START round=16 head_norm_before_train=1.322644 cos_to_last_merge=0.8016 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.802
[S4] round=16 local utility u=0.975556 metrics={'f1_val': 0.9447878031008853, 'auprc': 0.9412903002782633, 'loss_val': 0.5419429159899648, 'psi': 0.9433888019718366}-{'f1_val': 0.6625220906071896, 'auprc': 0.8586136753273659, 'loss_val': 0.5514315835469982, 'psi': 0.7409587244952601}
[S5] START round=16 head_norm_before_train=1.547999 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.6672232881232889, 'loss_val': 0.337056243558037, 'psi': 0.6872304212521065}-{'f1_val': 0.7005685100046517, 'auprc': 0.7489350767602418, 'loss_val': 0.3719792400330214, 'psi': 0.7199151367068878}
[S6] START round=16 head_norm_before_train=1.160033 cos_to_last_merge=0.9982 (last merge round=14)
[S6] round=16 local utility u=0.854285 metrics={'f1_val': 0.6987775155125888, 'auprc': 0.8561712945204595, 'loss_val': 0.5392211294662507, 'psi': 0.761735027115737}-{'f1_val': 0.4377371237743743, 'auprc': 0.8606276162759308, 'loss_val': 0.6949185609620097, 'psi': 0.6068933207749969}
[S7] START round=16 head_norm_before_train=0.997271 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.734768 metrics={'f1_val': 0.6500628559579643, 'auprc': 0.729754184842508, 'loss_val': 0.7843379541982638, 'psi': 0.6819393875117818}-{'f1_val': 0.42663981419400776, 'auprc': 0.7020136755034666, 'loss_val': 0.8301146611731712, 'psi': 0.5367893587177912}
[S8] START round=16 head_norm_before_train=1.671367 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.37266438550987346, 'auprc': 0.9887464593521723, 'loss_val': 0.628457669414297, 'psi': 0.619097215046793}-{'f1_val': 0.654201145234794, 'auprc': 0.8649947746173452, 'loss_val': 0.5548581275259372, 'psi': 0.7385185969878145}
[S9] START round=16 head_norm_before_train=1.602477 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9963459634300869, 'loss_val': 0.3058487970925191, 'psi': 0.8193552010791223}-{'f1_val': 0.7013613595118124, 'auprc': 0.9971423539349565, 'loss_val': 0.29731644625735265, 'psi': 0.8196737572810702}
[S10] START round=16 head_norm_before_train=1.291129 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.248691 metrics={'f1_val': 0.8625873064902708, 'auprc': 0.9958528878307001, 'loss_val': 0.3513286040243791, 'psi': 0.9158935390264425}-{'f1_val': 0.7874923985356199, 'auprc': 0.9927661088163653, 'loss_val': 0.3888809962572211, 'psi': 0.869601882647918}
[S11] START round=16 head_norm_before_train=1.646327 (no previous merge yet)
[S11] round=16 local utility u=0.004745 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980939555946443, 'loss_val': 0.1316877840524258, 'psi': 0.9971657849460115}-{'f1_val': 0.996305167468861, 'auprc': 0.9985869696504416, 'loss_val': 0.14120674887013007, 'psi': 0.9972178883414933}
[S13] START round=16 head_norm_before_train=1.533533 (no previous merge yet)
[S13] round=16 local utility u=0.373350 metrics={'f1_val': 0.5632778330984347, 'auprc': 0.7380135048162584, 'loss_val': 0.7950238505551848, 'psi': 0.6331721017855642}-{'f1_val': 0.5566053009836143, 'auprc': 0.5168736065356047, 'loss_val': 0.8382694961214943, 'psi': 0.5407126232044104}
[S14] START round=16 head_norm_before_train=1.204662 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.987587 metrics={'f1_val': 0.6914185912510199, 'auprc': 0.9841524778461919, 'loss_val': 0.6339912462140503, 'psi': 0.8085121458890887}-{'f1_val': 0.39659360338126215, 'auprc': 0.9183751722182261, 'loss_val': 0.6428837945574746, 'psi': 0.6053062309160477}
[S15] START round=16 head_norm_before_train=1.541300 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.113405 metrics={'f1_val': 0.6978417401416451, 'auprc': 0.9866553380482485, 'loss_val': 0.38817613396831885, 'psi': 0.8133671793042865}-{'f1_val': 0.6941680422578679, 'auprc': 0.9456109048181105, 'loss_val': 0.4698110337369267, 'psi': 0.7947451872819649}
[S16] START round=16 head_norm_before_train=0.796784 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.023694 metrics={'f1_val': 0.8985207019004235, 'auprc': 0.9737162621945008, 'loss_val': 0.6722893600538689, 'psi': 0.9285989260180545}-{'f1_val': 0.9052668973801622, 'auprc': 0.9124115205817297, 'loss_val': 0.5762409431086299, 'psi': 0.9081247466607891}
[S17] START round=16 head_norm_before_train=0.781835 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.3525844685111543, 'auprc': 0.580587156904839, 'loss_val': 0.9885398667617705, 'psi': 0.44378554386862823}-{'f1_val': 0.36342136555959725, 'auprc': 0.7202323782626471, 'loss_val': 0.9411843776828752, 'psi': 0.5061457706408172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39014
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39017
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:39002
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:39011
[S4] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=0.2622
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=0.9803
[S2] RECEIVED delta(kind=head bytes=1796) from S7
[S2] cosine check vs S7: cos=-0.0694
[S2] DROPPED delta from S7 (cos=-0.0694 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S4
[S10] cosine check vs S4: cos=0.9916
[S9] RECEIVED delta(kind=head bytes=1805) from S2
[S9] cosine check vs S2: cos=0.9838
[S6] RECEIVED delta(kind=head bytes=1803) from S15
[S6] cosine check vs S15: cos=0.9455
[S5] RECEIVED delta(kind=head bytes=1800) from S11
[S5] cosine check vs S11: cos=-0.0901
[S5] DROPPED delta from S11 (cos=-0.0901 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1804) from S13
[S4] cosine check vs S13: cos=-0.0643
[S4] DROPPED delta from S13 (cos=-0.0643 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39008
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1794 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1794) from S16
[S7] cosine check vs S16: cos=0.7681
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:39017
[S14] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S14
[S17] cosine check vs S14: cos=0.8002
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.6501 head_norm=1.026024
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.297433e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.6305 head_norm=0.879997 delta_norm=0.329743
[S7] aggregate: ROLLBACK (f1_val pre=0.650 post=0.630 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.6988 head_norm=1.189814
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.937545e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.6990 head_norm=1.359562 delta_norm=0.293754
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.7014 head_norm=1.627574
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.521575e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.7014 head_norm=1.651562 delta_norm=0.152158
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.8626 head_norm=1.316338
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.910406e-02
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.9185 head_norm=1.334830 delta_norm=0.089104
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.6914 head_norm=1.229733
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.333673e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.6914 head_norm=1.266771 delta_norm=0.133367
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.3526 head_norm=0.824740
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.036254e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.3523 head_norm=0.791603 delta_norm=0.303625
[S17] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.688970 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.7139698959734435, 'auprc': 0.7793193198897077, 'loss_val': 0.8395981933147509, 'psi': 0.7401096655399493}-{'f1_val': 0.7091425585513104, 'auprc': 0.787732333863985, 'loss_val': 0.5073109533806471, 'psi': 0.7405784686763802}
[S3] START round=17 head_norm_before_train=1.701846 (no previous merge yet)
[S3] round=17 local utility u=0.007197 metrics={'f1_val': 0.7003264167718803, 'auprc': 0.993958466572469, 'loss_val': 0.26031664382491726, 'psi': 0.8177792366921158}-{'f1_val': 0.700330919019862, 'auprc': 0.9939588990606582, 'loss_val': 0.27473812206387943, 'psi': 0.8177821110361805}
[S4] START round=17 head_norm_before_train=1.358925 cos_to_last_merge=0.7934 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.793
[S4] round=17 local utility u=0.035864 metrics={'f1_val': 0.9463522034690597, 'auprc': 0.9449209529910669, 'loss_val': 0.4904937425944496, 'psi': 0.9457797032778625}-{'f1_val': 0.9447878031008853, 'auprc': 0.9412903002782633, 'loss_val': 0.5419429159899648, 'psi': 0.9433888019718366}
[S5] START round=17 head_norm_before_train=1.569412 (no previous merge yet)
[S5] round=17 local utility u=0.012591 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.6681598385857189, 'loss_val': 0.31641408511259045, 'psi': 0.6877781055238068}-{'f1_val': 0.7005685100046517, 'auprc': 0.6672232881232889, 'loss_val': 0.337056243558037, 'psi': 0.6872304212521065}
[S6] START round=17 head_norm_before_train=1.359562 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.6925424339851464, 'auprc': 0.804056646780497, 'loss_val': 0.5329926752738253, 'psi': 0.7371481191032867}-{'f1_val': 0.6987775155125888, 'auprc': 0.8561712945204595, 'loss_val': 0.5392211294662507, 'psi': 0.761735027115737}
[S7] START round=17 head_norm_before_train=0.879997 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.37673821266660446, 'auprc': 0.6963183846627223, 'loss_val': 0.9493067167178326, 'psi': 0.5045702814650516}-{'f1_val': 0.6500628559579643, 'auprc': 0.729754184842508, 'loss_val': 0.7843379541982638, 'psi': 0.6819393875117818}
[S8] START round=17 head_norm_before_train=1.701940 cos_to_last_merge=0.9994 (last merge round=15)
[S8] round=17 local utility u=0.945311 metrics={'f1_val': 0.6553452627147397, 'auprc': 0.9902039150217999, 'loss_val': 0.4382926105679167, 'psi': 0.7892887236375639}-{'f1_val': 0.37266438550987346, 'auprc': 0.9887464593521723, 'loss_val': 0.628457669414297, 'psi': 0.619097215046793}
[S9] START round=17 head_norm_before_train=1.651562 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.7011111564128257, 'auprc': 0.9962157759446709, 'loss_val': 0.30412953273581944, 'psi': 0.8191530042255639}-{'f1_val': 0.7013613595118124, 'auprc': 0.9963459634300869, 'loss_val': 0.3058487970925191, 'psi': 0.8193552010791223}
[S10] START round=17 head_norm_before_train=1.334830 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.239378 metrics={'f1_val': 0.9576786406634819, 'auprc': 0.9752059389234278, 'loss_val': 0.38117876556829006, 'psi': 0.9646895599674603}-{'f1_val': 0.8625873064902708, 'auprc': 0.9958528878307001, 'loss_val': 0.3513286040243791, 'psi': 0.9158935390264425}
[S11] START round=17 head_norm_before_train=1.676847 (no previous merge yet)
[S11] round=17 local utility u=0.017603 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9985199594428924, 'loss_val': 0.09630824546108992, 'psi': 0.9971910842584735}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980939555946443, 'loss_val': 0.1316877840524258, 'psi': 0.9971657849460115}
[S13] START round=17 head_norm_before_train=1.552899 (no previous merge yet)
[S13] round=17 local utility u=0.166972 metrics={'f1_val': 0.6174312937516204, 'auprc': 0.6855752791280068, 'loss_val': 0.6286865756848027, 'psi': 0.6446888879021749}-{'f1_val': 0.5632778330984347, 'auprc': 0.7380135048162584, 'loss_val': 0.7950238505551848, 'psi': 0.6331721017855642}
[S14] START round=17 head_norm_before_train=1.266771 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.023461 metrics={'f1_val': 0.6919101942412695, 'auprc': 0.9918117722229876, 'loss_val': 0.6129958774304652, 'psi': 0.8118708254339567}-{'f1_val': 0.6914185912510199, 'auprc': 0.9841524778461919, 'loss_val': 0.6339912462140503, 'psi': 0.8085121458890887}
[S15] START round=17 head_norm_before_train=1.566442 cos_to_last_merge=0.9992 (last merge round=15)
[S15] round=17 local utility u=0.323604 metrics={'f1_val': 0.7861094534717077, 'auprc': 0.9908957613603124, 'loss_val': 0.28329663577277964, 'psi': 0.8680239766271496}-{'f1_val': 0.6978417401416451, 'auprc': 0.9866553380482485, 'loss_val': 0.38817613396831885, 'psi': 0.8133671793042865}
[S16] START round=17 head_norm_before_train=0.844703 cos_to_last_merge=0.9936 (last merge round=15)
[S16] round=17 local utility u=0.090249 metrics={'f1_val': 0.9093074716855213, 'auprc': 0.9610757952627286, 'loss_val': 0.5185903880241762, 'psi': 0.9300148011164042}-{'f1_val': 0.8985207019004235, 'auprc': 0.9737162621945008, 'loss_val': 0.6722893600538689, 'psi': 0.9285989260180545}
[S17] START round=17 head_norm_before_train=0.791603 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.35273268957802617, 'auprc': 0.5670153419057482, 'loss_val': 1.0018758343026484, 'psi': 0.438445750509115}-{'f1_val': 0.3525844685111543, 'auprc': 0.580587156904839, 'loss_val': 0.9885398667617705, 'psi': 0.44378554386862823}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39011
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39017
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39005
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S3
[S8] cosine check vs S3: cos=0.9940
[S6] RECEIVED delta(kind=head bytes=1804) from S15
[S6] cosine check vs S15: cos=0.9861
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] cosine check vs S8: cos=-0.0534
[S5] DROPPED delta from S8 (cos=-0.0534 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] cosine check vs S11: cos=-0.0896
[S5] DROPPED delta from S11 (cos=-0.0896 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S13
[S4] cosine check vs S13: cos=-0.0639
[S4] DROPPED delta from S13 (cos=-0.0639 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=0.9863
[S10] RECEIVED delta(kind=head bytes=1798) from S4
[S10] cosine check vs S4: cos=0.9947
[S17] RECEIVED delta(kind=head bytes=1800) from S14
[S17] cosine check vs S14: cos=0.7769
[S17] RECEIVED delta(kind=head bytes=1795) from S5
[S17] cosine check vs S5: cos=0.3032
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=0.9315
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.6925 head_norm=1.382674
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.624826e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.6928 head_norm=1.482690 delta_norm=0.162483
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.3767 head_norm=0.910421
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.683845e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.3767 head_norm=0.893867 delta_norm=0.168384
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.6919 head_norm=1.289415
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.147581e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.6919 head_norm=1.319053 delta_norm=0.114758
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9577 head_norm=1.357773
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.235866e-02
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9571 head_norm=1.372522 delta_norm=0.072359
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.6553 head_norm=1.726495
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.473439e-02
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.6551 head_norm=1.723387 delta_norm=0.094734
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.3527 head_norm=0.831169
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.579296e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.3526 head_norm=0.862921 delta_norm=0.357930
[S17] aggregate: ACCEPT kept=['S14', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.710334 (no previous merge yet)
[S2] round=18 local utility u=0.039420 metrics={'f1_val': 0.7016120424304714, 'auprc': 0.6887794536946945, 'loss_val': 0.4149916079155443, 'psi': 0.6964790069361606}-{'f1_val': 0.7139698959734435, 'auprc': 0.7793193198897077, 'loss_val': 0.8395981933147509, 'psi': 0.7401096655399493}
[S3] START round=18 head_norm_before_train=1.725483 (no previous merge yet)
[S3] round=18 local utility u=0.006724 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9952786579141227, 'loss_val': 0.25386039274416516, 'psi': 0.8186105041809355}-{'f1_val': 0.7003264167718803, 'auprc': 0.993958466572469, 'loss_val': 0.26031664382491726, 'psi': 0.8177792366921158}
[S4] START round=18 head_norm_before_train=1.390884 cos_to_last_merge=0.7872 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.787
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9393155716837954, 'auprc': 0.9489593304398081, 'loss_val': 0.48531558026902544, 'psi': 0.9431730751862004}-{'f1_val': 0.9463522034690597, 'auprc': 0.9449209529910669, 'loss_val': 0.4904937425944496, 'psi': 0.9457797032778625}
[S5] START round=18 head_norm_before_train=1.588511 (no previous merge yet)
[S5] round=18 local utility u=0.017612 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.6758572166989076, 'loss_val': 0.3027947138148625, 'psi': 0.6907083430830315}-{'f1_val': 0.7008569501491988, 'auprc': 0.6681598385857189, 'loss_val': 0.31641408511259045, 'psi': 0.6877781055238068}
[S6] START round=18 head_norm_before_train=1.482690 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.6886770297864591, 'auprc': 0.7915817825086235, 'loss_val': 0.5241897458083473, 'psi': 0.7298389308753248}-{'f1_val': 0.6925424339851464, 'auprc': 0.804056646780497, 'loss_val': 0.5329926752738253, 'psi': 0.7371481191032867}
[S7] START round=18 head_norm_before_train=0.893867 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.745848 metrics={'f1_val': 0.5616229463401724, 'auprc': 0.7982472165775167, 'loss_val': 0.8727049815711798, 'psi': 0.6562726544351101}-{'f1_val': 0.37673821266660446, 'auprc': 0.6963183846627223, 'loss_val': 0.9493067167178326, 'psi': 0.5045702814650516}
[S8] START round=18 head_norm_before_train=1.723387 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.020966 metrics={'f1_val': 0.6550634210237409, 'auprc': 0.9949633711840171, 'loss_val': 0.40894735057098847, 'psi': 0.7910234010878514}-{'f1_val': 0.6553452627147397, 'auprc': 0.9902039150217999, 'loss_val': 0.4382926105679167, 'psi': 0.7892887236375639}
[S9] START round=18 head_norm_before_train=1.673750 cos_to_last_merge=0.9997 (last merge round=16)
[S9] round=18 local utility u=0.008750 metrics={'f1_val': 0.7011111564128257, 'auprc': 0.9970762932048763, 'loss_val': 0.2892115437854885, 'psi': 0.819497211129646}-{'f1_val': 0.7011111564128257, 'auprc': 0.9962157759446709, 'loss_val': 0.30412953273581944, 'psi': 0.8191530042255639}
[S10] START round=18 head_norm_before_train=1.372522 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.058632 metrics={'f1_val': 0.9599534993939463, 'auprc': 0.9921914008064314, 'loss_val': 0.3285208510723612, 'psi': 0.9728486599589403}-{'f1_val': 0.9576786406634819, 'auprc': 0.9752059389234278, 'loss_val': 0.38117876556829006, 'psi': 0.9646895599674603}
[S11] START round=18 head_norm_before_train=1.704774 (no previous merge yet)
[S11] round=18 local utility u=0.001053 metrics={'f1_val': 0.996567470639547, 'auprc': 0.998585334732522, 'loss_val': 0.09597141809841267, 'psi': 0.997374616276737}-{'f1_val': 0.996305167468861, 'auprc': 0.9985199594428924, 'loss_val': 0.09630824546108992, 'psi': 0.9971910842584735}
[S13] START round=18 head_norm_before_train=1.567245 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5892117384373298, 'auprc': 0.6820385110454095, 'loss_val': 0.727926157532526, 'psi': 0.6263424474805617}-{'f1_val': 0.6174312937516204, 'auprc': 0.6855752791280068, 'loss_val': 0.6286865756848027, 'psi': 0.6446888879021749}
[S14] START round=18 head_norm_before_train=1.319053 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.011354 metrics={'f1_val': 0.6914967126377752, 'auprc': 0.9930894498159913, 'loss_val': 0.5916409595105542, 'psi': 0.8121338075090617}-{'f1_val': 0.6919101942412695, 'auprc': 0.9918117722229876, 'loss_val': 0.6129958774304652, 'psi': 0.8118708254339567}
[S15] START round=18 head_norm_before_train=1.593032 cos_to_last_merge=0.9973 (last merge round=15)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6988028231399803, 'auprc': 0.9843821425875345, 'loss_val': 0.2800303292440054, 'psi': 0.813034550919002}-{'f1_val': 0.7861094534717077, 'auprc': 0.9908957613603124, 'loss_val': 0.28329663577277964, 'psi': 0.8680239766271496}
[S16] START round=18 head_norm_before_train=0.908755 cos_to_last_merge=0.9758 (last merge round=15)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8473422573437952, 'auprc': 0.996403541741389, 'loss_val': 0.5790557593411587, 'psi': 0.9069667711028327}-{'f1_val': 0.9093074716855213, 'auprc': 0.9610757952627286, 'loss_val': 0.5185903880241762, 'psi': 0.9300148011164042}
[S17] START round=18 head_norm_before_train=0.862921 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.171230 metrics={'f1_val': 0.35281080585369984, 'auprc': 0.6654541987260861, 'loss_val': 0.9552019924915214, 'psi': 0.47786816300265433}-{'f1_val': 0.35273268957802617, 'auprc': 0.5670153419057482, 'loss_val': 1.0018758343026484, 'psi': 0.438445750509115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39005
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39005
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39017
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S7
[S2] cosine check vs S7: cos=0.0574
[S9] RECEIVED delta(kind=head bytes=1797) from S2
[S9] cosine check vs S2: cos=0.9900
[S5] RECEIVED delta(kind=head bytes=1802) from S11
[S5] cosine check vs S11: cos=-0.0898
[S5] DROPPED delta from S11 (cos=-0.0898 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S14
[S17] cosine check vs S14: cos=0.7104
[S17] RECEIVED delta(kind=head bytes=1797) from S5
[S17] cosine check vs S5: cos=0.6289
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] cosine check vs S8: cos=-0.0567
[S5] DROPPED delta from S8 (cos=-0.0567 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S9
[S15] cosine check vs S9: cos=0.9665
[S14] RECEIVED delta(kind=head bytes=1793) from S10
[S14] cosine check vs S10: cos=0.9904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] cosine check vs S17: cos=0.5968
[S3] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S3
[S8] cosine check vs S3: cos=0.9969
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.6551 head_norm=1.744950
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.843759e-02
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.6551 head_norm=1.744514 delta_norm=0.068438
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.7016 head_norm=1.728602
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.560588e-01
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.7019 head_norm=1.002836 delta_norm=0.956059
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.7011 head_norm=1.694984
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.219349e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.7011 head_norm=1.707528 delta_norm=0.121935
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.3528 head_norm=0.913597
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.943641e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.3528 head_norm=0.966622 delta_norm=0.194364
[S17] aggregate: ACCEPT kept=['S14', 'S5'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.6915 head_norm=1.340074
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.837331e-02
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.6915 head_norm=1.363399 delta_norm=0.098373
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.6988 head_norm=1.616262
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.179013e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.6985 head_norm=1.641693 delta_norm=0.217901
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.8473 head_norm=0.976263
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.252111e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.8401 head_norm=0.844435 delta_norm=0.425211
[S16] aggregate: ROLLBACK (f1_val pre=0.847 post=0.840 tol_abs=0.005 tol_rel=0.0)
[S2] START round=19 head_norm_before_train=1.002836 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7009425751847558, 'auprc': 0.670667778517077, 'loss_val': 0.43543849122612993, 'psi': 0.6888326565176843}-{'f1_val': 0.7016120424304714, 'auprc': 0.6887794536946945, 'loss_val': 0.4149916079155443, 'psi': 0.6964790069361606}
[S3] START round=19 head_norm_before_train=1.746761 (no previous merge yet)
[S3] round=19 local utility u=0.010547 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.99548761449193, 'loss_val': 0.23339248937543186, 'psi': 0.8186940868120585}-{'f1_val': 0.7008317350254774, 'auprc': 0.9952786579141227, 'loss_val': 0.25386039274416516, 'psi': 0.8186105041809355}
[S4] START round=19 head_norm_before_train=1.418124 cos_to_last_merge=0.7820 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.782
[S4] round=19 local utility u=0.058934 metrics={'f1_val': 0.9426823065462036, 'auprc': 0.9528379382474141, 'loss_val': 0.3992834573268951, 'psi': 0.9467445592266878}-{'f1_val': 0.9393155716837954, 'auprc': 0.9489593304398081, 'loss_val': 0.48531558026902544, 'psi': 0.9431730751862004}
[S5] START round=19 head_norm_before_train=1.607284 (no previous merge yet)
[S5] round=19 local utility u=0.021848 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.6892757925526215, 'loss_val': 0.29934927306250403, 'psi': 0.6960753526186532}-{'f1_val': 0.7006090940057808, 'auprc': 0.6758572166989076, 'loss_val': 0.3027947138148625, 'psi': 0.6907083430830315}
[S6] START round=19 head_norm_before_train=1.501638 cos_to_last_merge=0.9995 (last merge round=17)
[S6] round=19 local utility u=0.007475 metrics={'f1_val': 0.6814877027347832, 'auprc': 0.7918901971291696, 'loss_val': 0.4670298807662945, 'psi': 0.7256487004925378}-{'f1_val': 0.6886770297864591, 'auprc': 0.7915817825086235, 'loss_val': 0.5241897458083473, 'psi': 0.7298389308753248}
[S7] START round=19 head_norm_before_train=0.922710 cos_to_last_merge=0.9970 (last merge round=17)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.44782778384154087, 'auprc': 0.9731578299243214, 'loss_val': 0.8753498616210901, 'psi': 0.6579598022746531}-{'f1_val': 0.5616229463401724, 'auprc': 0.7982472165775167, 'loss_val': 0.8727049815711798, 'psi': 0.6562726544351101}
[S8] START round=19 head_norm_before_train=1.744514 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.142650 metrics={'f1_val': 0.7140852719263995, 'auprc': 0.9902764698892266, 'loss_val': 0.4637184483836395, 'psi': 0.8245617511115304}-{'f1_val': 0.6550634210237409, 'auprc': 0.9949633711840171, 'loss_val': 0.40894735057098847, 'psi': 0.7910234010878514}
[S9] START round=19 head_norm_before_train=1.707528 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.7011111564128257, 'auprc': 0.9964669758131204, 'loss_val': 0.2893553667528248, 'psi': 0.8192534841729436}-{'f1_val': 0.7011111564128257, 'auprc': 0.9970762932048763, 'loss_val': 0.2892115437854885, 'psi': 0.819497211129646}
[S10] START round=19 head_norm_before_train=1.393295 cos_to_last_merge=0.9997 (last merge round=17)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.7870855391447479, 'auprc': 0.9953292959981818, 'loss_val': 0.30533028522170524, 'psi': 0.8703830418861215}-{'f1_val': 0.9599534993939463, 'auprc': 0.9921914008064314, 'loss_val': 0.3285208510723612, 'psi': 0.9728486599589403}
[S11] START round=19 head_norm_before_train=1.728865 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.9917687392050427, 'auprc': 0.9985644998147549, 'loss_val': 0.10515153937017885, 'psi': 0.9944870434489276}-{'f1_val': 0.996567470639547, 'auprc': 0.998585334732522, 'loss_val': 0.09597141809841267, 'psi': 0.997374616276737}
[S13] START round=19 head_norm_before_train=1.580464 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5930484227348563, 'auprc': 0.6455227295780428, 'loss_val': 0.7347790862731813, 'psi': 0.6140381454721309}-{'f1_val': 0.5892117384373298, 'auprc': 0.6820385110454095, 'loss_val': 0.727926157532526, 'psi': 0.6263424474805617}
[S14] START round=19 head_norm_before_train=1.363399 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.010068 metrics={'f1_val': 0.6914185912510199, 'auprc': 0.9908008731831481, 'loss_val': 0.5641700275047549, 'psi': 0.8111715040238712}-{'f1_val': 0.6914967126377752, 'auprc': 0.9930894498159913, 'loss_val': 0.5916409595105542, 'psi': 0.8121338075090617}
[S15] START round=19 head_norm_before_train=1.641693 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.233272 metrics={'f1_val': 0.7738567776810451, 'auprc': 0.9874857990673928, 'loss_val': 0.2731216734034452, 'psi': 0.8593083862355841}-{'f1_val': 0.6988028231399803, 'auprc': 0.9843821425875345, 'loss_val': 0.2800303292440054, 'psi': 0.813034550919002}
[S16] START round=19 head_norm_before_train=0.844435 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.122867 metrics={'f1_val': 0.8837407631685629, 'auprc': 0.9960795908112996, 'loss_val': 0.550740000282079, 'psi': 0.9286762942256576}-{'f1_val': 0.8473422573437952, 'auprc': 0.996403541741389, 'loss_val': 0.5790557593411587, 'psi': 0.9069667711028327}
[S17] START round=19 head_norm_before_train=0.966622 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.147247 metrics={'f1_val': 0.3525862967346304, 'auprc': 0.7664517766544429, 'loss_val': 0.9623529926718244, 'psi': 0.5181324887025553}-{'f1_val': 0.35281080585369984, 'auprc': 0.6654541987260861, 'loss_val': 0.9552019924915214, 'psi': 0.47786816300265433}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:39011
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:39008
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:39017
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39007
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39009
[S3] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S15
[S6] cosine check vs S15: cos=0.9798
[S5] RECEIVED delta(kind=head bytes=1801) from S8
[S5] cosine check vs S8: cos=-0.0573
[S5] DROPPED delta from S8 (cos=-0.0573 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S4
[S10] cosine check vs S4: cos=0.9928
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] cosine check vs S6: cos=0.0879
[S17] RECEIVED delta(kind=head bytes=1797) from S5
[S17] cosine check vs S5: cos=0.7266
[S17] RECEIVED delta(kind=head bytes=1803) from S14
[S17] cosine check vs S14: cos=0.6608
[S7] RECEIVED delta(kind=head bytes=1805) from S16
[S7] cosine check vs S16: cos=0.8886
[S8] RECEIVED delta(kind=head bytes=1803) from S3
[S8] cosine check vs S3: cos=0.9979
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S17
[S16] cosine check vs S17: cos=0.8394
[S11] r=20 psi=0.994 u=0.0000 p_local=0.1078 f1=0.992 auprc=0.999 bytes=30561
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.4478 head_norm=0.957369
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.209874e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.4383 head_norm=0.902730 delta_norm=0.220987
[S7] aggregate: ROLLBACK (f1_val pre=0.448 post=0.438 tol_abs=0.005 tol_rel=0.0)
[S7] r=20 psi=0.658 u=0.0000 p_local=0.2410 f1=0.448 auprc=0.973 bytes=25126
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.7871 head_norm=1.414253
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.696543e-02
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.7861 head_norm=1.426151 delta_norm=0.086965
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.870 u=0.0000 p_local=0.2167 f1=0.787 auprc=0.995 bytes=21529
[S2] r=20 psi=0.689 u=0.0000 p_local=0.0844 f1=0.701 auprc=0.671 bytes=23338
[S9] r=20 psi=0.819 u=0.0000 p_local=0.0718 f1=0.701 auprc=0.996 bytes=21581
[S13] r=20 psi=0.614 u=0.0000 p_local=0.1320 f1=0.593 auprc=0.646 bytes=21616
[S5] r=20 psi=0.696 u=0.0218 p_local=0.0889 f1=0.701 auprc=0.689 bytes=25155
[S3] r=20 psi=0.819 u=0.0105 p_local=0.0718 f1=0.701 auprc=0.995 bytes=26965
[S14] r=20 psi=0.811 u=0.0101 p_local=0.1719 f1=0.691 auprc=0.991 bytes=23345
[S4] r=20 psi=0.947 u=0.0589 p_local=0.2121 f1=0.943 auprc=0.953 bytes=23322
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.8837 head_norm=0.900531
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.759753e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.8836 head_norm=0.916637 delta_norm=0.275975
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] r=20 psi=0.929 u=0.1229 p_local=0.1842 f1=0.884 auprc=0.996 bytes=19751
[S15] r=20 psi=0.859 u=0.2333 p_local=0.2211 f1=0.774 auprc=0.987 bytes=26980
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.7141 head_norm=1.767983
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.753561e-02
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.7141 head_norm=1.766046 delta_norm=0.057536
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.825 u=0.1426 p_local=0.2594 f1=0.714 auprc=0.990 bytes=25152
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.6815 head_norm=1.520653
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.748741e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.6813 head_norm=1.583537 delta_norm=0.174874
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] r=20 psi=0.726 u=0.0075 p_local=0.1588 f1=0.681 auprc=0.792 bytes=23363
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.3526 head_norm=1.010848
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.633512e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.3526 head_norm=0.906400 delta_norm=0.263351
[S17] aggregate: ACCEPT kept=['S6', 'S5', 'S14'] (k=3/3) mode=median trim_p=0.1
[S17] r=20 psi=0.518 u=0.1472 p_local=0.1243 f1=0.353 auprc=0.766 bytes=16146
[S2] START round=20 head_norm_before_train=1.039638 cos_to_last_merge=0.9990 (last merge round=18)
[S2] round=20 local utility u=0.193269 metrics={'f1_val': 0.7117936904541399, 'auprc': 0.7969850579388554, 'loss_val': 0.4929582305310052, 'psi': 0.7458702374480262}-{'f1_val': 0.7009425751847558, 'auprc': 0.670667778517077, 'loss_val': 0.43543849122612993, 'psi': 0.6888326565176843}
[S3] START round=20 head_norm_before_train=1.765981 (no previous merge yet)
[S3] round=20 local utility u=0.020464 metrics={'f1_val': 0.7005769689796157, 'auprc': 0.9952784013274624, 'loss_val': 0.19030797473114672, 'psi': 0.8184575419187543}-{'f1_val': 0.7008317350254774, 'auprc': 0.99548761449193, 'loss_val': 0.23339248937543186, 'psi': 0.8186940868120585}
[S4] START round=20 head_norm_before_train=1.443200 cos_to_last_merge=0.7778 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.778
[S4] round=20 local utility u=0.057229 metrics={'f1_val': 0.9440085511405821, 'auprc': 0.9628283678584899, 'loss_val': 0.3227545985894133, 'psi': 0.9515364778277453}-{'f1_val': 0.9426823065462036, 'auprc': 0.9528379382474141, 'loss_val': 0.3992834573268951, 'psi': 0.9467445592266878}
[S5] START round=20 head_norm_before_train=1.622916 (no previous merge yet)
[S5] round=20 local utility u=0.079659 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7427190047683394, 'loss_val': 0.30036034767993114, 'psi': 0.7174526375049404}-{'f1_val': 0.7006083926626743, 'auprc': 0.6892757925526215, 'loss_val': 0.29934927306250403, 'psi': 0.6960753526186532}
[S6] START round=20 head_norm_before_train=1.583537 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.050830 metrics={'f1_val': 0.6980113237732994, 'auprc': 0.7933205940361809, 'loss_val': 0.46880232797877047, 'psi': 0.7361350318784521}-{'f1_val': 0.6814877027347832, 'auprc': 0.7918901971291696, 'loss_val': 0.4670298807662945, 'psi': 0.7256487004925378}
[S7] START round=20 head_norm_before_train=0.902730 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.754543 metrics={'f1_val': 0.6633044463059319, 'auprc': 0.9815719568697264, 'loss_val': 0.684365806280215, 'psi': 0.7906114505314497}-{'f1_val': 0.44782778384154087, 'auprc': 0.9731578299243214, 'loss_val': 0.8753498616210901, 'psi': 0.6579598022746531}
[S8] START round=20 head_norm_before_train=1.766046 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.949234 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.9944515423245917, 'loss_val': 0.27309993166343527, 'psi': 0.9957642651938339}-{'f1_val': 0.7140852719263995, 'auprc': 0.9902764698892266, 'loss_val': 0.4637184483836395, 'psi': 0.8245617511115304}
[S9] START round=20 head_norm_before_train=1.725563 cos_to_last_merge=0.9998 (last merge round=18)
[S9] round=20 local utility u=0.006172 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9951020202872125, 'loss_val': 0.2744183231612939, 'psi': 0.8188576238219725}-{'f1_val': 0.7011111564128257, 'auprc': 0.9964669758131204, 'loss_val': 0.2893553667528248, 'psi': 0.8192534841729436}
[S10] START round=20 head_norm_before_train=1.426151 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.254174 metrics={'f1_val': 0.8676602669552822, 'auprc': 0.9954333066236246, 'loss_val': 0.2807424559398799, 'psi': 0.9187694828226192}-{'f1_val': 0.7870855391447479, 'auprc': 0.9953292959981818, 'loss_val': 0.30533028522170524, 'psi': 0.8703830418861215}
[S11] START round=20 head_norm_before_train=1.755084 (no previous merge yet)
[S11] round=20 local utility u=0.032293 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9985119812466932, 'loss_val': 0.06774910683276783, 'psi': 0.997200172311745}-{'f1_val': 0.9917687392050427, 'auprc': 0.9985644998147549, 'loss_val': 0.10515153937017885, 'psi': 0.9944870434489276}
[S13] START round=20 head_norm_before_train=1.592045 (no previous merge yet)
[S13] round=20 local utility u=0.055252 metrics={'f1_val': 0.604921730022018, 'auprc': 0.6263518717248977, 'loss_val': 0.6380029159336499, 'psi': 0.6134937867031698}-{'f1_val': 0.5930484227348563, 'auprc': 0.6455227295780428, 'loss_val': 0.7347790862731813, 'psi': 0.6140381454721309}
[S14] START round=20 head_norm_before_train=1.390072 cos_to_last_merge=0.9986 (last merge round=18)
[S14] round=20 local utility u=0.036994 metrics={'f1_val': 0.6923177505287506, 'auprc': 0.9967538562607673, 'loss_val': 0.5134357787051872, 'psi': 0.8140921928215572}-{'f1_val': 0.6914185912510199, 'auprc': 0.9908008731831481, 'loss_val': 0.5641700275047549, 'psi': 0.8111715040238712}
[S15] START round=20 head_norm_before_train=1.662515 cos_to_last_merge=0.9997 (last merge round=18)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.697575480262692, 'auprc': 0.9862834027801206, 'loss_val': 0.30737697797421, 'psi': 0.8130586492696634}-{'f1_val': 0.7738567776810451, 'auprc': 0.9874857990673928, 'loss_val': 0.2731216734034452, 'psi': 0.8593083862355841}
[S16] START round=20 head_norm_before_train=0.916637 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.858898382616982, 'auprc': 0.9977043942375019, 'loss_val': 0.6799742462924993, 'psi': 0.9144207872651899}-{'f1_val': 0.8837407631685629, 'auprc': 0.9960795908112996, 'loss_val': 0.550740000282079, 'psi': 0.9286762942256576}
[S17] START round=20 head_norm_before_train=0.906400 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.187491 metrics={'f1_val': 0.47025901383695135, 'auprc': 0.6448480634616506, 'loss_val': 0.9285958534953297, 'psi': 0.5400946336868311}-{'f1_val': 0.3525862967346304, 'auprc': 0.7664517766544429, 'loss_val': 0.9623529926718244, 'psi': 0.5181324887025553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39005
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:39004
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39002
[S11] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=0.2993
[S15] RECEIVED delta(kind=head bytes=1798) from S9
[S15] cosine check vs S9: cos=0.9811
[S2] RECEIVED delta(kind=head bytes=1797) from S7
[S2] cosine check vs S7: cos=0.4837
[S9] RECEIVED delta(kind=head bytes=1793) from S2
[S9] cosine check vs S2: cos=0.9042
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] cosine check vs S11: cos=-0.0885
[S5] DROPPED delta from S11 (cos=-0.0885 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] cosine check vs S8: cos=-0.0575
[S5] DROPPED delta from S8 (cos=-0.0575 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S5
[S17] cosine check vs S5: cos=0.6926
[S8] RECEIVED delta(kind=head bytes=1804) from S3
[S8] cosine check vs S3: cos=0.9983
[S4] RECEIVED delta(kind=head bytes=1805) from S13
[S4] cosine check vs S13: cos=-0.0640
[S4] DROPPED delta from S13 (cos=-0.0640 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.9860
[S10] RECEIVED delta(kind=head bytes=1796) from S4
[S10] cosine check vs S4: cos=0.9961
[S17] RECEIVED delta(kind=head bytes=1794) from S14
[S17] cosine check vs S14: cos=0.6328
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S17
[S16] cosine check vs S17: cos=0.9181
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.6976 head_norm=1.684444
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.692439e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.6970 head_norm=1.706651 delta_norm=0.169244
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.177 → S6@127.0.0.1:39007
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.8589 head_norm=0.959179
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.925597e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.8456 head_norm=0.931261 delta_norm=0.192560
[S16] aggregate: ROLLBACK (f1_val pre=0.859 post=0.846 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.147 → S7@127.0.0.1:39008
[S13] ⇄ pheromone p=0.117 → S4@127.0.0.1:39004
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9966 head_norm=1.787370
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.210605e-02
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9966 head_norm=1.784265 delta_norm=0.052106
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.397 → S5@127.0.0.1:39005
[S3] ⇄ pheromone p=0.062 → S8@127.0.0.1:39009
[S7] ⇄ pheromone p=0.344 → S2@127.0.0.1:39002
[S5] ⇄ pheromone p=0.087 → S17@127.0.0.1:39017
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.8677 head_norm=1.444677
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.509487e-02
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9045 head_norm=1.454313 delta_norm=0.065095
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.224 → S14@127.0.0.1:39014
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.7014 head_norm=1.745064
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.432577e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.7014 head_norm=1.388776 delta_norm=0.443258
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.059 → S15@127.0.0.1:39015
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.7118 head_norm=1.097771
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.222173e-01
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.7140 head_norm=0.878717 delta_norm=0.522217
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.106 → S9@127.0.0.1:39010
[S4] ⇄ pheromone p=0.181 → S10@127.0.0.1:39011
[S11] ⇄ pheromone p=0.093 → S5@127.0.0.1:39005
[S6] ⇄ pheromone p=0.137 → S17@127.0.0.1:39017
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.6923 head_norm=1.421830
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.205165e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.6923 head_norm=1.428223 delta_norm=0.120516
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.145 → S17@127.0.0.1:39017
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.4703 head_norm=0.942671
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.603990e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.3440 head_norm=0.903984 delta_norm=0.160399
[S17] aggregate: ROLLBACK (f1_val pre=0.470 post=0.344 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.137 → S16@127.0.0.1:39016
[S2] START round=21 head_norm_before_train=0.878717 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.704133368556526, 'auprc': 0.7683528796375374, 'loss_val': 0.535094227918338, 'psi': 0.7298211729889306}-{'f1_val': 0.7117936904541399, 'auprc': 0.7969850579388554, 'loss_val': 0.4929582305310052, 'psi': 0.7458702374480262}
[S3] START round=21 head_norm_before_train=1.782678 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.6779612826854904, 'auprc': 0.9941962309641023, 'loss_val': 0.24977006711848498, 'psi': 0.8044552619969352}-{'f1_val': 0.7005769689796157, 'auprc': 0.9952784013274624, 'loss_val': 0.19030797473114672, 'psi': 0.8184575419187543}
[S4] START round=21 head_norm_before_train=1.466777 cos_to_last_merge=0.7743 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.774
[S4] round=21 local utility u=0.010998 metrics={'f1_val': 0.9435717364483234, 'auprc': 0.9631026126219563, 'loss_val': 0.2989594691424009, 'psi': 0.9513840869177765}-{'f1_val': 0.9440085511405821, 'auprc': 0.9628283678584899, 'loss_val': 0.3227545985894133, 'psi': 0.9515364778277453}
[S5] START round=21 head_norm_before_train=1.632211 (no previous merge yet)
[S5] round=21 local utility u=0.104580 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8102906811863919, 'loss_val': 0.293915425413249, 'psi': 0.7444813080721613}-{'f1_val': 0.7006083926626743, 'auprc': 0.7427190047683394, 'loss_val': 0.30036034767993114, 'psi': 0.7174526375049404}
[S6] START round=21 head_norm_before_train=1.599919 cos_to_last_merge=0.9997 (last merge round=19)
[S6] round=21 local utility u=0.040346 metrics={'f1_val': 0.6988478375928824, 'auprc': 0.7941499818663942, 'loss_val': 0.3956168695123245, 'psi': 0.7369686953022871}-{'f1_val': 0.6980113237732994, 'auprc': 0.7933205940361809, 'loss_val': 0.46880232797877047, 'psi': 0.7361350318784521}
[S7] START round=21 head_norm_before_train=0.940535 cos_to_last_merge=0.9965 (last merge round=19)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.44248597771698617, 'auprc': 0.6484534525495317, 'loss_val': 0.8770990434725017, 'psi': 0.5248729676500044}-{'f1_val': 0.6633044463059319, 'auprc': 0.9815719568697264, 'loss_val': 0.684365806280215, 'psi': 0.7906114505314497}
[S8] START round=21 head_norm_before_train=1.784265 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.026245 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.9947419405487985, 'loss_val': 0.2214805406048726, 'psi': 0.9958804244835167}-{'f1_val': 0.9966394137733288, 'auprc': 0.9944515423245917, 'loss_val': 0.27309993166343527, 'psi': 0.9957642651938339}
[S9] START round=21 head_norm_before_train=1.388776 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9969534733813039, 'loss_val': 0.29153433897584075, 'psi': 0.8195546905156272}-{'f1_val': 0.7013613595118124, 'auprc': 0.9951020202872125, 'loss_val': 0.2744183231612939, 'psi': 0.8188576238219725}
[S10] START round=21 head_norm_before_train=1.454313 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.382572 metrics={'f1_val': 0.9938128314971357, 'auprc': 0.9954485449240662, 'loss_val': 0.272559380356285, 'psi': 0.9944671168679079}-{'f1_val': 0.8676602669552822, 'auprc': 0.9954333066236246, 'loss_val': 0.2807424559398799, 'psi': 0.9187694828226192}
[S11] START round=21 head_norm_before_train=1.782988 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9917687392050427, 'auprc': 0.9985362536644118, 'loss_val': 0.07811547659034088, 'psi': 0.9944757449887903}-{'f1_val': 0.9963256330217796, 'auprc': 0.9985119812466932, 'loss_val': 0.06774910683276783, 'psi': 0.997200172311745}
[S13] START round=21 head_norm_before_train=1.604965 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5992654551350709, 'auprc': 0.6290375481664345, 'loss_val': 0.7638867698920859, 'psi': 0.6111742923476163}-{'f1_val': 0.604921730022018, 'auprc': 0.6263518717248977, 'loss_val': 0.6380029159336499, 'psi': 0.6134937867031698}
[S14] START round=21 head_norm_before_train=1.428223 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.003411 metrics={'f1_val': 0.6917447324701869, 'auprc': 0.9962174142181153, 'loss_val': 0.5015668219788502, 'psi': 0.8135338051693582}-{'f1_val': 0.6923177505287506, 'auprc': 0.9967538562607673, 'loss_val': 0.5134357787051872, 'psi': 0.8140921928215572}
[S15] START round=21 head_norm_before_train=1.706651 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.016310 metrics={'f1_val': 0.7008694553242885, 'auprc': 0.9887993398794612, 'loss_val': 0.30206851297494963, 'psi': 0.8160414091463576}-{'f1_val': 0.697575480262692, 'auprc': 0.9862834027801206, 'loss_val': 0.30737697797421, 'psi': 0.8130586492696634}
[S16] START round=21 head_norm_before_train=0.931261 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.147747 metrics={'f1_val': 0.9010868634728977, 'auprc': 0.9978220255564447, 'loss_val': 0.6379632429439719, 'psi': 0.9397809283063165}-{'f1_val': 0.858898382616982, 'auprc': 0.9977043942375019, 'loss_val': 0.6799742462924993, 'psi': 0.9144207872651899}
[S17] START round=21 head_norm_before_train=0.903984 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.36650780168617086, 'auprc': 0.577822974682541, 'loss_val': 0.8527179878166864, 'psi': 0.4510338708847189}-{'f1_val': 0.47025901383695135, 'auprc': 0.6448480634616506, 'loss_val': 0.9285958534953297, 'psi': 0.5400946336868311}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:39017
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39008
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39017
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39007
[S15] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1794) from S14
[S17] cosine check vs S14: cos=0.6051
[S17] RECEIVED delta(kind=head bytes=1799) from S5
[S17] cosine check vs S5: cos=0.6613
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] cosine check vs S6: cos=0.4169
[S6] RECEIVED delta(kind=head bytes=1803) from S15
[S6] cosine check vs S15: cos=0.9809
[S5] RECEIVED delta(kind=head bytes=1802) from S8
[S5] cosine check vs S8: cos=-0.0574
[S5] DROPPED delta from S8 (cos=-0.0574 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S16
[S7] cosine check vs S16: cos=0.8520
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] cosine check vs S10: cos=0.9915
[S10] RECEIVED delta(kind=head bytes=1796) from S4
[S10] cosine check vs S4: cos=0.9976
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.4425 head_norm=0.974662
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.642994e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.4200 head_norm=0.934901 delta_norm=0.264299
[S7] aggregate: ROLLBACK (f1_val pre=0.442 post=0.420 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.6917 head_norm=1.455648
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.598797e-02
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.6916 head_norm=1.462037 delta_norm=0.095988
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.6988 head_norm=1.616692
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.722842e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.6988 head_norm=1.663483 delta_norm=0.172284
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.9938 head_norm=1.474660
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.111825e-02
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.9936 head_norm=1.477785 delta_norm=0.051118
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.3665 head_norm=0.939779
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.138222e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.3655 head_norm=0.917128 delta_norm=0.113822
[S17] aggregate: ACCEPT kept=['S14', 'S5', 'S6'] (k=3/3) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=0.942737 cos_to_last_merge=0.9951 (last merge round=20)
[S2] round=22 local utility u=0.030073 metrics={'f1_val': 0.7033043785805293, 'auprc': 0.7771336327739979, 'loss_val': 0.49631667558517684, 'psi': 0.7328360802579168}-{'f1_val': 0.704133368556526, 'auprc': 0.7683528796375374, 'loss_val': 0.535094227918338, 'psi': 0.7298211729889306}
[S3] START round=22 head_norm_before_train=1.797292 (no previous merge yet)
[S3] round=22 local utility u=0.799695 metrics={'f1_val': 0.9313238096687599, 'auprc': 0.9968880244420042, 'loss_val': 0.17863003487150042, 'psi': 0.9575494955780576}-{'f1_val': 0.6779612826854904, 'auprc': 0.9941962309641023, 'loss_val': 0.24977006711848498, 'psi': 0.8044552619969352}
[S4] START round=22 head_norm_before_train=1.482668 cos_to_last_merge=0.7724 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.772
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9426093592502012, 'auprc': 0.9465649442174597, 'loss_val': 0.2990444577050684, 'psi': 0.9441915932371046}-{'f1_val': 0.9435717364483234, 'auprc': 0.9631026126219563, 'loss_val': 0.2989594691424009, 'psi': 0.9513840869177765}
[S5] START round=22 head_norm_before_train=1.643361 (no previous merge yet)
[S5] round=22 local utility u=0.286718 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9948737618620153, 'loss_val': 0.27423219391703807, 'psi': 0.8183149611482745}-{'f1_val': 0.7006083926626743, 'auprc': 0.8102906811863919, 'loss_val': 0.293915425413249, 'psi': 0.7444813080721613}
[S6] START round=22 head_norm_before_train=1.663483 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.6984053889619369, 'auprc': 0.7933161582999992, 'loss_val': 0.40964599145834096, 'psi': 0.7363696966971618}-{'f1_val': 0.6988478375928824, 'auprc': 0.7941499818663942, 'loss_val': 0.3956168695123245, 'psi': 0.7369686953022871}
[S7] START round=22 head_norm_before_train=0.934901 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.916257 metrics={'f1_val': 0.6717036602067257, 'auprc': 0.7195063351143742, 'loss_val': 0.6330495854941709, 'psi': 0.6908247301697851}-{'f1_val': 0.44248597771698617, 'auprc': 0.6484534525495317, 'loss_val': 0.8770990434725017, 'psi': 0.5248729676500044}
[S8] START round=22 head_norm_before_train=1.810724 cos_to_last_merge=0.9995 (last merge round=20)
[S8] round=22 local utility u=0.004281 metrics={'f1_val': 0.9946130404325813, 'auprc': 0.9920601082791298, 'loss_val': 0.1927140441371873, 'psi': 0.9935918675712008}-{'f1_val': 0.9966394137733288, 'auprc': 0.9947419405487985, 'loss_val': 0.2214805406048726, 'psi': 0.9958804244835167}
[S9] START round=22 head_norm_before_train=1.413465 cos_to_last_merge=0.9997 (last merge round=20)
[S9] round=22 local utility u=0.010969 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9976484617433067, 'loss_val': 0.2716819729287825, 'psi': 0.8198326858604283}-{'f1_val': 0.7012888352718426, 'auprc': 0.9969534733813039, 'loss_val': 0.29153433897584075, 'psi': 0.8195546905156272}
[S10] START round=22 head_norm_before_train=1.477785 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.014798 metrics={'f1_val': 0.9938128314971357, 'auprc': 0.9954727508163806, 'loss_val': 0.24303600045289275, 'psi': 0.9944767992248337}-{'f1_val': 0.9938128314971357, 'auprc': 0.9954485449240662, 'loss_val': 0.272559380356285, 'psi': 0.9944671168679079}
[S11] START round=22 head_norm_before_train=1.808829 (no previous merge yet)
[S11] round=22 local utility u=0.026821 metrics={'f1_val': 0.996567470639547, 'auprc': 0.99846873823305, 'loss_val': 0.05306296227349132, 'psi': 0.9973279776769483}-{'f1_val': 0.9917687392050427, 'auprc': 0.9985362536644118, 'loss_val': 0.07811547659034088, 'psi': 0.9944757449887903}
[S13] START round=22 head_norm_before_train=1.620655 (no previous merge yet)
[S13] round=22 local utility u=0.155359 metrics={'f1_val': 0.6117561589382521, 'auprc': 0.68084656504592, 'loss_val': 0.683539634227126, 'psi': 0.6393923213813193}-{'f1_val': 0.5992654551350709, 'auprc': 0.6290375481664345, 'loss_val': 0.7638867698920859, 'psi': 0.6111742923476163}
[S14] START round=22 head_norm_before_train=1.462037 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.002570 metrics={'f1_val': 0.6910700498185652, 'auprc': 0.9981266969086435, 'loss_val': 0.49810666611794735, 'psi': 0.8138927086545966}-{'f1_val': 0.6917447324701869, 'auprc': 0.9962174142181153, 'loss_val': 0.5015668219788502, 'psi': 0.8135338051693582}
[S15] START round=22 head_norm_before_train=1.726274 cos_to_last_merge=0.9998 (last merge round=20)
[S15] round=22 local utility u=0.748298 metrics={'f1_val': 0.9283301308227889, 'auprc': 0.9925225407217917, 'loss_val': 0.18140698552108378, 'psi': 0.95400709478239}-{'f1_val': 0.7008694553242885, 'auprc': 0.9887993398794612, 'loss_val': 0.30206851297494963, 'psi': 0.8160414091463576}
[S16] START round=22 head_norm_before_train=0.968412 cos_to_last_merge=0.9929 (last merge round=20)
[S16] round=22 local utility u=0.139965 metrics={'f1_val': 0.9212770392622832, 'auprc': 0.9976720563292215, 'loss_val': 0.47872403463091856, 'psi': 0.9518350460890586}-{'f1_val': 0.9010868634728977, 'auprc': 0.9978220255564447, 'loss_val': 0.6379632429439719, 'psi': 0.9397809283063165}
[S17] START round=22 head_norm_before_train=0.917128 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.038708 metrics={'f1_val': 0.3759246577408786, 'auprc': 0.5708531451344081, 'loss_val': 0.8108946179937386, 'psi': 0.45389605269829036}-{'f1_val': 0.36650780168617086, 'auprc': 0.577822974682541, 'loss_val': 0.8527179878166864, 'psi': 0.4510338708847189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39008
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39009
[S16] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=0.9639
[S8] RECEIVED delta(kind=head bytes=1800) from S3
[S8] cosine check vs S3: cos=0.9957
[S6] RECEIVED delta(kind=head bytes=1804) from S15
[S6] cosine check vs S15: cos=0.9940
[S9] RECEIVED delta(kind=head bytes=1806) from S2
[S9] cosine check vs S2: cos=0.8129
[S5] RECEIVED delta(kind=head bytes=1801) from S8
[S5] cosine check vs S8: cos=-0.0539
[S5] DROPPED delta from S8 (cos=-0.0539 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S7
[S2] cosine check vs S7: cos=0.7413
[S4] RECEIVED delta(kind=head bytes=1802) from S13
[S4] cosine check vs S13: cos=-0.0657
[S4] DROPPED delta from S13 (cos=-0.0657 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S9
[S15] cosine check vs S9: cos=0.9799
[S14] RECEIVED delta(kind=head bytes=1793) from S10
[S14] cosine check vs S10: cos=0.9948
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] cosine check vs S11: cos=-0.0869
[S5] DROPPED delta from S11 (cos=-0.0869 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S14
[S17] cosine check vs S14: cos=0.5877
[S17] RECEIVED delta(kind=head bytes=1795) from S5
[S17] cosine check vs S5: cos=0.6450
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] cosine check vs S17: cos=0.8823
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.6984 head_norm=1.681459
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.927124e-02
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.6986 head_norm=1.711903 delta_norm=0.099271
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.9283 head_norm=1.747463
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.205571e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.9332 head_norm=1.586860 delta_norm=0.220557
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.6911 head_norm=1.485411
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.702161e-02
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.6911 head_norm=1.492912 delta_norm=0.077022
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9946 head_norm=1.838681
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.585656e-02
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9942 head_norm=1.822042 delta_norm=0.085857
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.7013 head_norm=1.442191
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.263207e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.7013 head_norm=1.176576 delta_norm=0.426321
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.7033 head_norm=1.025791
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.586945e-01
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.7063 head_norm=0.927342 delta_norm=0.358694
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.6717 head_norm=0.961770
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.365432e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.6708 head_norm=0.982698 delta_norm=0.136543
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.9213 head_norm=1.021605
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.417894e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.9110 head_norm=0.957742 delta_norm=0.241789
[S16] aggregate: ROLLBACK (f1_val pre=0.921 post=0.911 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.3759 head_norm=0.952779
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.866444e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.3759 head_norm=1.003648 delta_norm=0.286644
[S17] aggregate: ACCEPT kept=['S14', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=0.927342 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7055094492719046, 'auprc': 0.7947083820785495, 'loss_val': 0.567110834542014, 'psi': 0.7411890223945625}-{'f1_val': 0.7033043785805293, 'auprc': 0.7771336327739979, 'loss_val': 0.49631667558517684, 'psi': 0.7328360802579168}
[S3] START round=23 head_norm_before_train=1.809328 (no previous merge yet)
[S3] round=23 local utility u=0.162292 metrics={'f1_val': 0.9802863873440067, 'auprc': 0.9984538741505163, 'loss_val': 0.1525195410162773, 'psi': 0.9875533820666106}-{'f1_val': 0.9313238096687599, 'auprc': 0.9968880244420042, 'loss_val': 0.17863003487150042, 'psi': 0.9575494955780576}
[S4] START round=23 head_norm_before_train=1.500920 cos_to_last_merge=0.7700 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.770
[S4] round=23 local utility u=0.053339 metrics={'f1_val': 0.9484790558903097, 'auprc': 0.963626909469531, 'loss_val': 0.27876965031003853, 'psi': 0.9545381973219982}-{'f1_val': 0.9426093592502012, 'auprc': 0.9465649442174597, 'loss_val': 0.2990444577050684, 'psi': 0.9441915932371046}
[S5] START round=23 head_norm_before_train=1.657295 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.6395966753859486, 'auprc': 0.7778756041244242, 'loss_val': 0.5186607415758622, 'psi': 0.6949082468813388}-{'f1_val': 0.7006090940057808, 'auprc': 0.9948737618620153, 'loss_val': 0.27423219391703807, 'psi': 0.8183149611482745}
[S6] START round=23 head_norm_before_train=1.711903 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.698624348315928, 'auprc': 0.7936818586466118, 'loss_val': 0.42183078634204985, 'psi': 0.7366473524482016}-{'f1_val': 0.6984053889619369, 'auprc': 0.7933161582999992, 'loss_val': 0.40964599145834096, 'psi': 0.7363696966971618}
[S7] START round=23 head_norm_before_train=0.982698 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.3854595991326653, 'auprc': 0.625997994791285, 'loss_val': 1.0041520560061754, 'psi': 0.4816749573961132}-{'f1_val': 0.6717036602067257, 'auprc': 0.7195063351143742, 'loss_val': 0.6330495854941709, 'psi': 0.6908247301697851}
[S8] START round=23 head_norm_before_train=1.822042 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.030211 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.9943809395244843, 'loss_val': 0.15141278272165293, 'psi': 0.9957360240737909}-{'f1_val': 0.9946130404325813, 'auprc': 0.9920601082791298, 'loss_val': 0.1927140441371873, 'psi': 0.9935918675712008}
[S9] START round=23 head_norm_before_train=1.176576 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.7010397148377312, 'auprc': 0.9979112835840547, 'loss_val': 0.3085441518414797, 'psi': 0.8197883423362606}-{'f1_val': 0.7012888352718426, 'auprc': 0.9976484617433067, 'loss_val': 0.2716819729287825, 'psi': 0.8198326858604283}
[S10] START round=23 head_norm_before_train=1.504324 cos_to_last_merge=0.9995 (last merge round=21)
[S10] round=23 local utility u=0.023265 metrics={'f1_val': 0.9938128314971357, 'auprc': 0.9955921980116929, 'loss_val': 0.19686486458876243, 'psi': 0.9945245781029586}-{'f1_val': 0.9938128314971357, 'auprc': 0.9954727508163806, 'loss_val': 0.24303600045289275, 'psi': 0.9944767992248337}
[S11] START round=23 head_norm_before_train=1.836014 (no previous merge yet)
[S11] round=23 local utility u=0.001306 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998044876273685, 'loss_val': 0.04905583707466002, 'psi': 0.9971461532176278}-{'f1_val': 0.996567470639547, 'auprc': 0.99846873823305, 'loss_val': 0.05306296227349132, 'psi': 0.9973279776769483}
[S13] START round=23 head_norm_before_train=1.637610 (no previous merge yet)
[S13] round=23 local utility u=0.055549 metrics={'f1_val': 0.6199979096687491, 'auprc': 0.6810110462772206, 'loss_val': 0.6223861199079098, 'psi': 0.6444031643121377}-{'f1_val': 0.6117561589382521, 'auprc': 0.68084656504592, 'loss_val': 0.683539634227126, 'psi': 0.6393923213813193}
[S14] START round=23 head_norm_before_train=1.492912 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.014386 metrics={'f1_val': 0.6919069891846901, 'auprc': 0.9983695535312318, 'loss_val': 0.47508419243461875, 'psi': 0.8144920149233068}-{'f1_val': 0.6910700498185652, 'auprc': 0.9981266969086435, 'loss_val': 0.49810666611794735, 'psi': 0.8138927086545966}
[S15] START round=23 head_norm_before_train=1.586860 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7375676813916027, 'auprc': 0.9866744527588583, 'loss_val': 0.3032981501265939, 'psi': 0.8372103899385049}-{'f1_val': 0.9283301308227889, 'auprc': 0.9925225407217917, 'loss_val': 0.18140698552108378, 'psi': 0.95400709478239}
[S16] START round=23 head_norm_before_train=0.957742 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.047225 metrics={'f1_val': 0.9385452862711565, 'auprc': 0.9966966910505215, 'loss_val': 0.48495782491181944, 'psi': 0.9618058481829025}-{'f1_val': 0.9212770392622832, 'auprc': 0.9976720563292215, 'loss_val': 0.47872403463091856, 'psi': 0.9518350460890586}
[S17] START round=23 head_norm_before_train=1.003648 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.144785 metrics={'f1_val': 0.4041274475849074, 'auprc': 0.5842817334411492, 'loss_val': 0.7308279348224729, 'psi': 0.4761891619274041}-{'f1_val': 0.3759246577408786, 'auprc': 0.5708531451344081, 'loss_val': 0.8108946179937386, 'psi': 0.45389605269829036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:39005
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39005
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:39009
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39008
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=0.9963
[S17] RECEIVED delta(kind=head bytes=1795) from S14
[S17] cosine check vs S14: cos=0.6449
[S5] RECEIVED delta(kind=head bytes=1801) from S8
[S5] cosine check vs S8: cos=-0.0551
[S5] DROPPED delta from S8 (cos=-0.0551 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S11
[S5] cosine check vs S11: cos=-0.0862
[S5] DROPPED delta from S11 (cos=-0.0862 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1806) from S13
[S4] cosine check vs S13: cos=-0.0661
[S4] DROPPED delta from S13 (cos=-0.0661 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] cosine check vs S16: cos=0.9653
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] cosine check vs S4: cos=0.9947
[S8] RECEIVED delta(kind=head bytes=1804) from S3
[S8] cosine check vs S3: cos=0.9970
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S17
[S16] cosine check vs S17: cos=0.9354
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.3855 head_norm=1.007724
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.324795e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.3829 head_norm=0.996338 delta_norm=0.132480
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.6919 head_norm=1.516897
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.633047e-02
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.6919 head_norm=1.526268 delta_norm=0.066330
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9966 head_norm=1.848543
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.200704e-02
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9966 head_norm=1.836565 delta_norm=0.072007
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9938 head_norm=1.538444
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.924376e-02
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9936 head_norm=1.527571 delta_norm=0.079244
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9385 head_norm=1.002483
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.844027e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9283 head_norm=1.004276 delta_norm=0.184403
[S16] aggregate: ROLLBACK (f1_val pre=0.939 post=0.928 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.4041 head_norm=1.039316
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.804498e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.3850 head_norm=1.163466 delta_norm=0.580450
[S17] aggregate: ROLLBACK (f1_val pre=0.404 post=0.385 tol_abs=0.005 tol_rel=0.0)
[S2] START round=24 head_norm_before_train=0.994630 cos_to_last_merge=0.9943 (last merge round=22)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7051880587553838, 'auprc': 0.7761641617330135, 'loss_val': 0.5170249003574503, 'psi': 0.7335784999464356}-{'f1_val': 0.7055094492719046, 'auprc': 0.7947083820785495, 'loss_val': 0.567110834542014, 'psi': 0.7411890223945625}
[S3] START round=24 head_norm_before_train=1.827347 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.8966694448566227, 'auprc': 0.998463057602186, 'loss_val': 0.22240338360292108, 'psi': 0.937386889954848}-{'f1_val': 0.9802863873440067, 'auprc': 0.9984538741505163, 'loss_val': 0.1525195410162773, 'psi': 0.9875533820666106}
[S4] START round=24 head_norm_before_train=1.520755 cos_to_last_merge=0.7677 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.768
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9421739655256429, 'auprc': 0.9569854449014947, 'loss_val': 0.2828487619747131, 'psi': 0.9480985572759836}-{'f1_val': 0.9484790558903097, 'auprc': 0.963626909469531, 'loss_val': 0.27876965031003853, 'psi': 0.9545381973219982}
[S5] START round=24 head_norm_before_train=1.667522 (no previous merge yet)
[S5] round=24 local utility u=0.639467 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9977300942764668, 'loss_val': 0.2653644236164546, 'psi': 0.8194574941140551}-{'f1_val': 0.6395966753859486, 'auprc': 0.7778756041244242, 'loss_val': 0.5186607415758622, 'psi': 0.6949082468813388}
[S6] START round=24 head_norm_before_train=1.728978 cos_to_last_merge=0.9997 (last merge round=22)
[S6] round=24 local utility u=0.107244 metrics={'f1_val': 0.6994970433107301, 'auprc': 0.843304240380349, 'loss_val': 0.36144653392252885, 'psi': 0.7570199221385777}-{'f1_val': 0.698624348315928, 'auprc': 0.7936818586466118, 'loss_val': 0.42183078634204985, 'psi': 0.7366473524482016}
[S7] START round=24 head_norm_before_train=0.996338 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.571864 metrics={'f1_val': 0.5368238303956049, 'auprc': 0.6513723366989178, 'loss_val': 0.8447324047074178, 'psi': 0.58264323291693}-{'f1_val': 0.3854595991326653, 'auprc': 0.625997994791285, 'loss_val': 1.0041520560061754, 'psi': 0.4816749573961132}
[S8] START round=24 head_norm_before_train=1.836565 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.010263 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9943762157959628, 'loss_val': 0.12997376976377034, 'psi': 0.9956441518797902}-{'f1_val': 0.9966394137733288, 'auprc': 0.9943809395244843, 'loss_val': 0.15141278272165293, 'psi': 0.9957360240737909}
[S9] START round=24 head_norm_before_train=1.211428 cos_to_last_merge=0.9993 (last merge round=22)
[S9] round=24 local utility u=0.019895 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9978326093531292, 'loss_val': 0.2700131015462173, 'psi': 0.8199063449043573}-{'f1_val': 0.7010397148377312, 'auprc': 0.9979112835840547, 'loss_val': 0.3085441518414797, 'psi': 0.8197883423362606}
[S10] START round=24 head_norm_before_train=1.527571 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.009872 metrics={'f1_val': 0.993593908338861, 'auprc': 0.9957667840206157, 'loss_val': 0.17633081914695778, 'psi': 0.9944630586115629}-{'f1_val': 0.9938128314971357, 'auprc': 0.9955921980116929, 'loss_val': 0.19686486458876243, 'psi': 0.9945245781029586}
[S11] START round=24 head_norm_before_train=1.864357 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9058515916252609, 'auprc': 0.9974426417491953, 'loss_val': 0.25690407328591464, 'psi': 0.9424880116748346}-{'f1_val': 0.9965470045135896, 'auprc': 0.998044876273685, 'loss_val': 0.04905583707466002, 'psi': 0.9971461532176278}
[S13] START round=24 head_norm_before_train=1.648494 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5579674658087316, 'auprc': 0.7034134933915276, 'loss_val': 0.95155889419506, 'psi': 0.61614587684185}-{'f1_val': 0.6199979096687491, 'auprc': 0.6810110462772206, 'loss_val': 0.6223861199079098, 'psi': 0.6444031643121377}
[S14] START round=24 head_norm_before_train=1.526268 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.013224 metrics={'f1_val': 0.6914967126377752, 'auprc': 0.9975755813520093, 'loss_val': 0.44379194205696126, 'psi': 0.8139282601234689}-{'f1_val': 0.6919069891846901, 'auprc': 0.9983695535312318, 'loss_val': 0.47508419243461875, 'psi': 0.8144920149233068}
[S15] START round=24 head_norm_before_train=1.606242 cos_to_last_merge=0.9998 (last merge round=22)
[S15] round=24 local utility u=0.550856 metrics={'f1_val': 0.8998865144182486, 'auprc': 0.9949652888328977, 'loss_val': 0.20037115604238243, 'psi': 0.9379180241841083}-{'f1_val': 0.7375676813916027, 'auprc': 0.9866744527588583, 'loss_val': 0.3032981501265939, 'psi': 0.8372103899385049}
[S16] START round=24 head_norm_before_train=1.004276 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8657746778683079, 'auprc': 0.997192369447403, 'loss_val': 0.6268186504130409, 'psi': 0.9183417544999459}-{'f1_val': 0.9385452862711565, 'auprc': 0.9966966910505215, 'loss_val': 0.48495782491181944, 'psi': 0.9618058481829025}
[S17] START round=24 head_norm_before_train=1.163466 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.258001 metrics={'f1_val': 0.4792372933373569, 'auprc': 0.6126857060353892, 'loss_val': 0.7506963544996591, 'psi': 0.5326166584165698}-{'f1_val': 0.4041274475849074, 'auprc': 0.5842817334411492, 'loss_val': 0.7308279348224729, 'psi': 0.4761891619274041}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39007
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:39017
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1795) from S7
[S2] cosine check vs S7: cos=0.8593
[S6] RECEIVED delta(kind=head bytes=1799) from S15
[S6] cosine check vs S15: cos=0.9915
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] cosine check vs S8: cos=-0.0559
[S5] DROPPED delta from S8 (cos=-0.0559 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S9
[S15] cosine check vs S9: cos=0.9426
[S14] RECEIVED delta(kind=head bytes=1792) from S10
[S14] cosine check vs S10: cos=0.9969
[S17] RECEIVED delta(kind=head bytes=1797) from S5
[S17] cosine check vs S5: cos=0.3712
[S17] RECEIVED delta(kind=head bytes=1805) from S6
[S17] cosine check vs S6: cos=0.0828
[S17] RECEIVED delta(kind=head bytes=1797) from S14
[S17] cosine check vs S14: cos=0.9260
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S17
[S16] cosine check vs S17: cos=0.8377
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.7052 head_norm=1.074515
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.788358e-01
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.7052 head_norm=1.009046 delta_norm=0.278836
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.8999 head_norm=1.626687
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.059463e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.9005 head_norm=1.418802 delta_norm=0.305946
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=24 metric=0.6995 head_norm=1.745422
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.249787e-01
[S6] stored merged vector for next round verification (round=24)
[S6] DEBUG after merge:  round=24 metric=0.6995 head_norm=1.682464 delta_norm=0.124979
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.6915 head_norm=1.549980
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.136592e-02
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.6915 head_norm=1.555035 delta_norm=0.061366
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.8658 head_norm=1.043113
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.256705e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.8453 head_norm=1.070330 delta_norm=0.325671
[S16] aggregate: ROLLBACK (f1_val pre=0.866 post=0.845 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.4792 head_norm=1.189643
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.590122e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.3724 head_norm=1.019879 delta_norm=0.359012
[S17] aggregate: ROLLBACK (f1_val pre=0.479 post=0.372 tol_abs=0.005 tol_rel=0.0)
[S2] START round=25 head_norm_before_train=1.009046 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6591757471428117, 'auprc': 0.7388819887361744, 'loss_val': 0.6466835068295433, 'psi': 0.6910582437801568}-{'f1_val': 0.7051880587553838, 'auprc': 0.7761641617330135, 'loss_val': 0.5170249003574503, 'psi': 0.7335784999464356}
[S3] START round=25 head_norm_before_train=1.847992 (no previous merge yet)
[S3] round=25 local utility u=0.339963 metrics={'f1_val': 0.993502203286029, 'auprc': 0.9987564730010701, 'loss_val': 0.12435451824395348, 'psi': 0.9956039111720454}-{'f1_val': 0.8966694448566227, 'auprc': 0.998463057602186, 'loss_val': 0.22240338360292108, 'psi': 0.937386889954848}
[S4] START round=25 head_norm_before_train=1.538411 cos_to_last_merge=0.7659 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.766
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9407442602204659, 'auprc': 0.9321062196482375, 'loss_val': 0.3077739447100464, 'psi': 0.9372890439915744}-{'f1_val': 0.9421739655256429, 'auprc': 0.9569854449014947, 'loss_val': 0.2828487619747131, 'psi': 0.9480985572759836}
[S5] START round=25 head_norm_before_train=1.675957 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8983610436751666, 'loss_val': 0.3147614956907614, 'psi': 0.7797094530676711}-{'f1_val': 0.7006090940057808, 'auprc': 0.9977300942764668, 'loss_val': 0.2653644236164546, 'psi': 0.8194574941140551}
[S6] START round=25 head_norm_before_train=1.682464 cos_to_last_merge=1.0000 (last merge round=24)
[S6] round=25 local utility u=0.138180 metrics={'f1_val': 0.6994970433107301, 'auprc': 0.9354401710140101, 'loss_val': 0.36149475161599637, 'psi': 0.7938742943920422}-{'f1_val': 0.6994970433107301, 'auprc': 0.843304240380349, 'loss_val': 0.36144653392252885, 'psi': 0.7570199221385777}
[S7] START round=25 head_norm_before_train=1.018461 cos_to_last_merge=0.9986 (last merge round=23)
[S7] round=25 local utility u=0.657267 metrics={'f1_val': 0.626893240230874, 'auprc': 0.8553647972748226, 'loss_val': 0.6825929636407944, 'psi': 0.7182818630484535}-{'f1_val': 0.5368238303956049, 'auprc': 0.6513723366989178, 'loss_val': 0.8447324047074178, 'psi': 0.58264323291693}
[S8] START round=25 head_norm_before_train=1.867615 cos_to_last_merge=0.9996 (last merge round=23)
[S8] round=25 local utility u=0.018990 metrics={'f1_val': 0.9963525581780791, 'auprc': 0.9961504256300316, 'loss_val': 0.09649419105865527, 'psi': 0.9962717051588601}-{'f1_val': 0.9964894426023416, 'auprc': 0.9943762157959628, 'loss_val': 0.12997376976377034, 'psi': 0.9956441518797902}
[S9] START round=25 head_norm_before_train=1.251838 cos_to_last_merge=0.9972 (last merge round=22)
[S9] round=25 local utility u=0.016759 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9978033482327797, 'loss_val': 0.23640683526535014, 'psi': 0.8198946404562175}-{'f1_val': 0.7012888352718426, 'auprc': 0.9978326093531292, 'loss_val': 0.2700131015462173, 'psi': 0.8199063449043573}
[S10] START round=25 head_norm_before_train=1.562485 cos_to_last_merge=0.9994 (last merge round=23)
[S10] round=25 local utility u=0.010066 metrics={'f1_val': 0.9933750578586366, 'auprc': 0.996016734752603, 'loss_val': 0.15563467486034072, 'psi': 0.9944317286162231}-{'f1_val': 0.993593908338861, 'auprc': 0.9957667840206157, 'loss_val': 0.17633081914695778, 'psi': 0.9944630586115629}
[S11] START round=25 head_norm_before_train=1.888264 (no previous merge yet)
[S11] round=25 local utility u=0.380307 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979936587761278, 'loss_val': 0.040664833606882375, 'psi': 0.9969805639917677}-{'f1_val': 0.9058515916252609, 'auprc': 0.9974426417491953, 'loss_val': 0.25690407328591464, 'psi': 0.9424880116748346}
[S13] START round=25 head_norm_before_train=1.655580 (no previous merge yet)
[S13] round=25 local utility u=0.257084 metrics={'f1_val': 0.6105072316480701, 'auprc': 0.664832030124497, 'loss_val': 0.6368841725455732, 'psi': 0.6322371510386409}-{'f1_val': 0.5579674658087316, 'auprc': 0.7034134933915276, 'loss_val': 0.95155889419506, 'psi': 0.61614587684185}
[S14] START round=25 head_norm_before_train=1.555035 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.419279 metrics={'f1_val': 0.8232035939894939, 'auprc': 0.9977901320134275, 'loss_val': 0.39611882963497663, 'psi': 0.8930382091990674}-{'f1_val': 0.6914967126377752, 'auprc': 0.9975755813520093, 'loss_val': 0.44379194205696126, 'psi': 0.8139282601234689}
[S15] START round=25 head_norm_before_train=1.418802 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.7078774400056052, 'auprc': 0.9549689738951848, 'loss_val': 0.3444450957371941, 'psi': 0.806714053561437}-{'f1_val': 0.8998865144182486, 'auprc': 0.9949652888328977, 'loss_val': 0.20037115604238243, 'psi': 0.9379180241841083}
[S16] START round=25 head_norm_before_train=1.070330 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.232910 metrics={'f1_val': 0.9244472136038703, 'auprc': 0.9972986489560305, 'loss_val': 0.5133533552775846, 'psi': 0.9535877877447343}-{'f1_val': 0.8657746778683079, 'auprc': 0.997192369447403, 'loss_val': 0.6268186504130409, 'psi': 0.9183417544999459}
[S17] START round=25 head_norm_before_train=1.019879 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.710318 metrics={'f1_val': 0.627118469678723, 'auprc': 0.7687606561135878, 'loss_val': 0.6855729506704702, 'psi': 0.683775344252669}-{'f1_val': 0.4792372933373569, 'auprc': 0.6126857060353892, 'loss_val': 0.7506963544996591, 'psi': 0.5326166584165698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39005
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39017
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39009
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39002
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39008
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=0.9971
[S8] RECEIVED delta(kind=head bytes=1803) from S3
[S8] cosine check vs S3: cos=0.9949
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=0.9180
[S2] RECEIVED delta(kind=head bytes=1800) from S7
[S2] cosine check vs S7: cos=0.9331
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] cosine check vs S8: cos=-0.0531
[S5] DROPPED delta from S8 (cos=-0.0531 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] cosine check vs S11: cos=-0.0846
[S5] DROPPED delta from S11 (cos=-0.0846 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S9
[S15] cosine check vs S9: cos=0.9801
[S4] RECEIVED delta(kind=head bytes=1801) from S13
[S4] cosine check vs S13: cos=-0.0676
[S4] DROPPED delta from S13 (cos=-0.0676 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=0.3109
[S17] RECEIVED delta(kind=head bytes=1799) from S14
[S17] cosine check vs S14: cos=0.7998
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] cosine check vs S17: cos=0.9658
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=25 metric=0.6592 head_norm=1.083435
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.956405e-01
[S2] stored merged vector for next round verification (round=25)
[S2] DEBUG after merge:  round=25 metric=0.6606 head_norm=1.047490 delta_norm=0.195641
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.038 → S9@127.0.0.1:39010
[S5] ⇄ pheromone p=0.169 → S17@127.0.0.1:39017
[S4] ⇄ pheromone p=0.067 → S10@127.0.0.1:39011
[S13] ⇄ pheromone p=0.113 → S4@127.0.0.1:39004
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.6269 head_norm=1.047469
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.198353e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.6139 head_norm=1.054117 delta_norm=0.219835
[S7] aggregate: ROLLBACK (f1_val pre=0.627 post=0.614 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.429 → S2@127.0.0.1:39002
[S6] ⇄ pheromone p=0.093 → S17@127.0.0.1:39017
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.8232 head_norm=1.579268
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.100969e-02
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.6919 head_norm=1.586194 delta_norm=0.061010
[S14] aggregate: ROLLBACK (f1_val pre=0.823 post=0.692 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.136 → S17@127.0.0.1:39017
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9964 head_norm=1.899719
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.671163e-02
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9964 head_norm=1.881943 delta_norm=0.096712
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.142 → S5@127.0.0.1:39005
[S9] ⇄ pheromone p=0.027 → S15@127.0.0.1:39015
[S11] ⇄ pheromone p=0.109 → S5@127.0.0.1:39005
[S10] ⇄ pheromone p=0.113 → S14@127.0.0.1:39014
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.9244 head_norm=1.105346
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.434070e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.9069 head_norm=1.071012 delta_norm=0.143407
[S16] aggregate: ROLLBACK (f1_val pre=0.924 post=0.907 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.127 → S7@127.0.0.1:39008
[S3] ⇄ pheromone p=0.191 → S8@127.0.0.1:39009
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.7079 head_norm=1.443904
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.554274e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.7077 head_norm=1.362274 delta_norm=0.155427
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.224 → S6@127.0.0.1:39007
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.6271 head_norm=1.055212
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.746540e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.7495 head_norm=1.041801 delta_norm=0.374654
[S17] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.251 → S16@127.0.0.1:39016
[S2] START round=26 head_norm_before_train=1.047490 cos_to_last_merge=1.0000 (last merge round=25)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.5781957408613229, 'auprc': 0.6442248632456584, 'loss_val': 0.8942880035684121, 'psi': 0.604607389815057}-{'f1_val': 0.6591757471428117, 'auprc': 0.7388819887361744, 'loss_val': 0.6466835068295433, 'psi': 0.6910582437801568}
[S3] START round=26 head_norm_before_train=1.869009 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9755679071198273, 'auprc': 0.9985040749424838, 'loss_val': 0.08021831445996547, 'psi': 0.98474237424889}-{'f1_val': 0.993502203286029, 'auprc': 0.9987564730010701, 'loss_val': 0.12435451824395348, 'psi': 0.9956039111720454}
[S4] START round=26 head_norm_before_train=1.554551 cos_to_last_merge=0.7648 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.765
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9399129056507884, 'auprc': 0.9177756030438412, 'loss_val': 0.32249352538436, 'psi': 0.9310579846080096}-{'f1_val': 0.9407442602204659, 'auprc': 0.9321062196482375, 'loss_val': 0.3077739447100464, 'psi': 0.9372890439915744}
[S5] START round=26 head_norm_before_train=1.686995 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.6786810386280752, 'auprc': 0.9323689879344246, 'loss_val': 0.3100796267874107, 'psi': 0.780156218350615}-{'f1_val': 0.7006083926626743, 'auprc': 0.8983610436751666, 'loss_val': 0.3147614956907614, 'psi': 0.7797094530676711}
[S6] START round=26 head_norm_before_train=1.698696 cos_to_last_merge=0.9998 (last merge round=24)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.6973316711443462, 'auprc': 0.7830466548528401, 'loss_val': 0.4029168477625308, 'psi': 0.7316176646277438}-{'f1_val': 0.6994970433107301, 'auprc': 0.9354401710140101, 'loss_val': 0.36149475161599637, 'psi': 0.7938742943920422}
[S7] START round=26 head_norm_before_train=1.054117 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.327553 metrics={'f1_val': 0.6818106659680534, 'auprc': 0.9207891023969225, 'loss_val': 0.5532649149067441, 'psi': 0.777402040539601}-{'f1_val': 0.626893240230874, 'auprc': 0.8553647972748226, 'loss_val': 0.6825929636407944, 'psi': 0.7182818630484535}
[S8] START round=26 head_norm_before_train=1.881943 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.004649 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.9975994327523885, 'loss_val': 0.09326525795444694, 'psi': 0.9970234213649526}-{'f1_val': 0.9963525581780791, 'auprc': 0.9961504256300316, 'loss_val': 0.09649419105865527, 'psi': 0.9962717051588601}
[S9] START round=26 head_norm_before_train=1.294233 cos_to_last_merge=0.9940 (last merge round=22)
[S9] round=26 local utility u=0.014714 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9977902798382342, 'loss_val': 0.20694001454508004, 'psi': 0.8198894130983994}-{'f1_val': 0.7012888352718426, 'auprc': 0.9978033482327797, 'loss_val': 0.23640683526535014, 'psi': 0.8198946404562175}
[S10] START round=26 head_norm_before_train=1.595424 cos_to_last_merge=0.9981 (last merge round=23)
[S10] round=26 local utility u=0.010786 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9953651339214415, 'loss_val': 0.13088956486286543, 'psi': 0.9940493098745065}-{'f1_val': 0.9933750578586366, 'auprc': 0.996016734752603, 'loss_val': 0.15563467486034072, 'psi': 0.9944317286162231}
[S11] START round=26 head_norm_before_train=1.905564 (no previous merge yet)
[S11] round=26 local utility u=0.002592 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982047651262556, 'loss_val': 0.037688686905424575, 'psi': 0.9972223884342304}-{'f1_val': 0.996305167468861, 'auprc': 0.9979936587761278, 'loss_val': 0.040664833606882375, 'psi': 0.9969805639917677}
[S13] START round=26 head_norm_before_train=1.661142 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5405483835062763, 'auprc': 0.6940671955490996, 'loss_val': 0.8573538717880492, 'psi': 0.6019559083234056}-{'f1_val': 0.6105072316480701, 'auprc': 0.664832030124497, 'loss_val': 0.6368841725455732, 'psi': 0.6322371510386409}
[S14] START round=26 head_norm_before_train=1.586194 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.530027 metrics={'f1_val': 0.9934743334651056, 'auprc': 0.9984768205189432, 'loss_val': 0.3597499678456828, 'psi': 0.9954753282866406}-{'f1_val': 0.8232035939894939, 'auprc': 0.9977901320134275, 'loss_val': 0.39611882963497663, 'psi': 0.8930382091990674}
[S15] START round=26 head_norm_before_train=1.362274 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.580920 metrics={'f1_val': 0.8771366274335899, 'auprc': 0.978470035558029, 'loss_val': 0.268662658739189, 'psi': 0.9176699906833656}-{'f1_val': 0.7078774400056052, 'auprc': 0.9549689738951848, 'loss_val': 0.3444450957371941, 'psi': 0.806714053561437}
[S16] START round=26 head_norm_before_train=1.071012 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.117497 metrics={'f1_val': 0.9564488072461028, 'auprc': 0.9952244292531272, 'loss_val': 0.46414554661829494, 'psi': 0.9719590560489126}-{'f1_val': 0.9244472136038703, 'auprc': 0.9972986489560305, 'loss_val': 0.5133533552775846, 'psi': 0.9535877877447343}
[S17] START round=26 head_norm_before_train=1.041801 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.5402392878176483, 'auprc': 0.7689924485235458, 'loss_val': 0.7438251672658727, 'psi': 0.6317405521000072}-{'f1_val': 0.627118469678723, 'auprc': 0.7687606561135878, 'loss_val': 0.6855729506704702, 'psi': 0.683775344252669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39014
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:39002
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:39005
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39005
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S15
[S6] cosine check vs S15: cos=0.9620
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] cosine check vs S9: cos=0.9921
[S2] RECEIVED delta(kind=head bytes=1801) from S7
[S2] cosine check vs S7: cos=0.9347
[S5] RECEIVED delta(kind=head bytes=1798) from S8
[S5] cosine check vs S8: cos=-0.0552
[S5] DROPPED delta from S8 (cos=-0.0552 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S11
[S5] cosine check vs S11: cos=-0.0845
[S5] DROPPED delta from S11 (cos=-0.0845 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S14
[S17] cosine check vs S14: cos=0.7717
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=0.9702
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=0.9968
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=26 metric=0.5782 head_norm=1.111754
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.986001e-01
[S2] stored merged vector for next round verification (round=26)
[S2] DEBUG after merge:  round=26 metric=0.5833 head_norm=1.076919 delta_norm=0.198600
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.6973 head_norm=1.713209
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.666216e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.6973 head_norm=1.538153 delta_norm=0.266622
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.8771 head_norm=1.392451
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.044193e-02
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.8771 head_norm=1.360160 delta_norm=0.090442
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9935 head_norm=1.610680
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.503966e-02
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9750 head_norm=1.618348 delta_norm=0.065040
[S14] aggregate: ROLLBACK (f1_val pre=0.993 post=0.975 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.6818 head_norm=1.078144
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.339480e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.6816 head_norm=1.084087 delta_norm=0.133948
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.5402 head_norm=1.070406
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.194066e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.5426 head_norm=1.265008 delta_norm=0.519407
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.076919 cos_to_last_merge=1.0000 (last merge round=26)
[S2] round=27 local utility u=0.633305 metrics={'f1_val': 0.6853267143364168, 'auprc': 0.767778587350084, 'loss_val': 0.6411242483569795, 'psi': 0.7183074635418837}-{'f1_val': 0.5781957408613229, 'auprc': 0.6442248632456584, 'loss_val': 0.8942880035684121, 'psi': 0.604607389815057}
[S3] START round=27 head_norm_before_train=1.893489 (no previous merge yet)
[S3] round=27 local utility u=0.080442 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9986921224073018, 'loss_val': 0.05088109568179424, 'psi': 0.9979157904305551}-{'f1_val': 0.9755679071198273, 'auprc': 0.9985040749424838, 'loss_val': 0.08021831445996547, 'psi': 0.98474237424889}
[S4] START round=27 head_norm_before_train=1.570442 cos_to_last_merge=0.7640 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.764
[S4] round=27 local utility u=0.056061 metrics={'f1_val': 0.942881473037128, 'auprc': 0.9383226358462318, 'loss_val': 0.28982354648608466, 'psi': 0.9410579381607695}-{'f1_val': 0.9399129056507884, 'auprc': 0.9177756030438412, 'loss_val': 0.32249352538436, 'psi': 0.9310579846080096}
[S5] START round=27 head_norm_before_train=1.698242 (no previous merge yet)
[S5] round=27 local utility u=0.189402 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9961720887839244, 'loss_val': 0.2542485249795605, 'psi': 0.8188338711111743}-{'f1_val': 0.6786810386280752, 'auprc': 0.9323689879344246, 'loss_val': 0.3100796267874107, 'psi': 0.780156218350615}
[S6] START round=27 head_norm_before_train=1.538153 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.261919 metrics={'f1_val': 0.6955029302632354, 'auprc': 0.9556590687809341, 'loss_val': 0.38594408677716446, 'psi': 0.7995653856703149}-{'f1_val': 0.6973316711443462, 'auprc': 0.7830466548528401, 'loss_val': 0.4029168477625308, 'psi': 0.7316176646277438}
[S7] START round=27 head_norm_before_train=1.084087 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.45953514879655677, 'auprc': 0.7819101213199846, 'loss_val': 0.9179484533955166, 'psi': 0.5884851378059279}-{'f1_val': 0.6818106659680534, 'auprc': 0.9207891023969225, 'loss_val': 0.5532649149067441, 'psi': 0.777402040539601}
[S8] START round=27 head_norm_before_train=1.911012 cos_to_last_merge=0.9997 (last merge round=25)
[S8] round=27 local utility u=0.008563 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.9979099991486089, 'loss_val': 0.07707101889177777, 'psi': 0.9971476479234408}-{'f1_val': 0.9966394137733288, 'auprc': 0.9975994327523885, 'loss_val': 0.09326525795444694, 'psi': 0.9970234213649526}
[S9] START round=27 head_norm_before_train=1.333233 cos_to_last_merge=0.9905 (last merge round=22)
[S9] round=27 local utility u=0.906005 metrics={'f1_val': 0.9960641043180497, 'auprc': 0.9977704152385798, 'loss_val': 0.16352239539090793, 'psi': 0.9967466286862616}-{'f1_val': 0.7012888352718426, 'auprc': 0.9977902798382342, 'loss_val': 0.20694001454508004, 'psi': 0.8198894130983994}
[S10] START round=27 head_norm_before_train=1.628580 cos_to_last_merge=0.9963 (last merge round=23)
[S10] round=27 local utility u=0.008240 metrics={'f1_val': 0.9936100131187782, 'auprc': 0.9957067828437619, 'loss_val': 0.1180628390835375, 'psi': 0.9944487210087716}-{'f1_val': 0.9931720938432163, 'auprc': 0.9953651339214415, 'loss_val': 0.13088956486286543, 'psi': 0.9940493098745065}
[S11] START round=27 head_norm_before_train=1.920415 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9948824314557263, 'auprc': 0.9983466757704599, 'loss_val': 0.04209597458314239, 'psi': 0.9962681291816198}-{'f1_val': 0.996567470639547, 'auprc': 0.9982047651262556, 'loss_val': 0.037688686905424575, 'psi': 0.9972223884342304}
[S13] START round=27 head_norm_before_train=1.669120 (no previous merge yet)
[S13] round=27 local utility u=0.009751 metrics={'f1_val': 0.5441444784378646, 'auprc': 0.7050966149536388, 'loss_val': 0.8925169981539366, 'psi': 0.6085253330441743}-{'f1_val': 0.5405483835062763, 'auprc': 0.6940671955490996, 'loss_val': 0.8573538717880492, 'psi': 0.6019559083234056}
[S14] START round=27 head_norm_before_train=1.618348 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.029667 metrics={'f1_val': 0.9964688301972123, 'auprc': 0.9983513263169725, 'loss_val': 0.3180055698625715, 'psi': 0.9972218286451164}-{'f1_val': 0.9934743334651056, 'auprc': 0.9984768205189432, 'loss_val': 0.3597499678456828, 'psi': 0.9954753282866406}
[S15] START round=27 head_norm_before_train=1.360160 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.014073 metrics={'f1_val': 0.8711609068752576, 'auprc': 0.9929056901146418, 'loss_val': 0.24796832400282917, 'psi': 0.9198588201710113}-{'f1_val': 0.8771366274335899, 'auprc': 0.978470035558029, 'loss_val': 0.268662658739189, 'psi': 0.9176699906833656}
[S16] START round=27 head_norm_before_train=1.106336 cos_to_last_merge=0.9956 (last merge round=25)
[S16] round=27 local utility u=0.098059 metrics={'f1_val': 0.9701614794818612, 'auprc': 0.99561674424631, 'loss_val': 0.35148138921208166, 'psi': 0.9803435853876408}-{'f1_val': 0.9564488072461028, 'auprc': 0.9952244292531272, 'loss_val': 0.46414554661829494, 'psi': 0.9719590560489126}
[S17] START round=27 head_norm_before_train=1.265008 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.5355314315434287, 'auprc': 0.6062984097622517, 'loss_val': 0.7654184795289508, 'psi': 0.563838222830958}-{'f1_val': 0.5402392878176483, 'auprc': 0.7689924485235458, 'loss_val': 0.7438251672658727, 'psi': 0.6317405521000072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:39013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:39003
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39011
[S9] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S9
[S2] cosine check vs S9: cos=0.6200
[S8] RECEIVED delta(kind=head bytes=1794) from S5
[S8] cosine check vs S5: cos=-0.0530
[S8] DROPPED delta from S5 (cos=-0.0530 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S15
[S9] cosine check vs S15: cos=0.9950
[S7] RECEIVED delta(kind=head bytes=1802) from S2
[S7] cosine check vs S2: cos=0.9585
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=0.9870
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=0.9941
[S15] RECEIVED delta(kind=head bytes=1802) from S6
[S15] cosine check vs S6: cos=0.9799
[S13] RECEIVED delta(kind=head bytes=1798) from S4
[S13] cosine check vs S4: cos=-0.0711
[S13] DROPPED delta from S4 (cos=-0.0711 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S14
[S10] cosine check vs S14: cos=0.9969
[S17] RECEIVED delta(kind=head bytes=1793) from S16
[S17] cosine check vs S16: cos=0.8762
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.4595 head_norm=1.102125
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.606280e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.4636 head_norm=1.100755 delta_norm=0.160628
[S7] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.9974 head_norm=1.917312
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.054231e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.9974 head_norm=1.924833 delta_norm=0.105423
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.6853 head_norm=1.122608
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.546899e-01
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.6729 head_norm=1.123231 delta_norm=0.554690
[S2] aggregate: ROLLBACK (f1_val pre=0.685 post=0.673 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.8712 head_norm=1.398792
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.659974e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.8735 head_norm=1.467174 delta_norm=0.165997
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=27 metric=0.9936 head_norm=1.661638
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.534538e-02
[S10] stored merged vector for next round verification (round=27)
[S10] DEBUG after merge:  round=27 metric=0.9934 head_norm=1.651424 delta_norm=0.065345
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9429 head_norm=1.587336
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.359175e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9431 head_norm=1.619218 delta_norm=0.135917
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9961 head_norm=1.370550
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.056344e-02
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9961 head_norm=1.382944 delta_norm=0.070563
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.5355 head_norm=1.287939
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.106612e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.5287 head_norm=1.182813 delta_norm=0.310661
[S17] aggregate: ROLLBACK (f1_val pre=0.536 post=0.529 tol_abs=0.005 tol_rel=0.0)
[S2] START round=28 head_norm_before_train=1.123231 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.6001047943244637, 'auprc': 0.7189881035655241, 'loss_val': 0.8729899354551082, 'psi': 0.6476581180208879}-{'f1_val': 0.6853267143364168, 'auprc': 0.767778587350084, 'loss_val': 0.6411242483569795, 'psi': 0.7183074635418837}
[S3] START round=28 head_norm_before_train=1.924833 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9825714639544857, 'auprc': 0.9986847770925936, 'loss_val': 0.06756829639783202, 'psi': 0.9890167892097288}-{'f1_val': 0.9973982357793907, 'auprc': 0.9986921224073018, 'loss_val': 0.05088109568179424, 'psi': 0.9979157904305551}
[S4] START round=28 head_norm_before_train=1.619218 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.058497 metrics={'f1_val': 0.9483590310341423, 'auprc': 0.9660395557834204, 'loss_val': 0.28884473080503154, 'psi': 0.9554312409338535}-{'f1_val': 0.942881473037128, 'auprc': 0.9383226358462318, 'loss_val': 0.28982354648608466, 'psi': 0.9410579381607695}
[S5] START round=28 head_norm_before_train=1.706110 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9846672303348177, 'loss_val': 0.2564541445244431, 'psi': 0.8142319277315317}-{'f1_val': 0.7006083926626743, 'auprc': 0.9961720887839244, 'loss_val': 0.2542485249795605, 'psi': 0.8188338711111743}
[S6] START round=28 head_norm_before_train=1.550384 cos_to_last_merge=0.9998 (last merge round=26)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6976510286426558, 'auprc': 0.7912800125375277, 'loss_val': 0.42984570516288595, 'psi': 0.7351026222006045}-{'f1_val': 0.6955029302632354, 'auprc': 0.9556590687809341, 'loss_val': 0.38594408677716446, 'psi': 0.7995653856703149}
[S7] START round=28 head_norm_before_train=1.100755 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=1.000000 metrics={'f1_val': 0.6861647434060364, 'auprc': 0.9422327365904053, 'loss_val': 0.4885904320270856, 'psi': 0.788591940679784}-{'f1_val': 0.45953514879655677, 'auprc': 0.7819101213199846, 'loss_val': 0.9179484533955166, 'psi': 0.5884851378059279}
[S8] START round=28 head_norm_before_train=1.938067 cos_to_last_merge=0.9991 (last merge round=25)
[S8] round=28 local utility u=0.004987 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9985507688551074, 'loss_val': 0.06811954750641239, 'psi': 0.9973139731034479}-{'f1_val': 0.9966394137733288, 'auprc': 0.9979099991486089, 'loss_val': 0.07707101889177777, 'psi': 0.9971476479234408}
[S9] START round=28 head_norm_before_train=1.382944 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.006089 metrics={'f1_val': 0.9927489669882278, 'auprc': 0.9985702924194632, 'loss_val': 0.13385314231635181, 'psi': 0.9950774971607219}-{'f1_val': 0.9960641043180497, 'auprc': 0.9977704152385798, 'loss_val': 0.16352239539090793, 'psi': 0.9967466286862616}
[S10] START round=28 head_norm_before_train=1.651424 cos_to_last_merge=1.0000 (last merge round=27)
[S10] round=28 local utility u=0.012429 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9961205273720116, 'loss_val': 0.09181836398763717, 'psi': 0.9943514672547344}-{'f1_val': 0.9936100131187782, 'auprc': 0.9957067828437619, 'loss_val': 0.1180628390835375, 'psi': 0.9944487210087716}
[S11] START round=28 head_norm_before_train=1.936965 (no previous merge yet)
[S11] round=28 local utility u=0.008349 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9982294674921716, 'loss_val': 0.033706386350383984, 'psi': 0.9970871668099364}-{'f1_val': 0.9948824314557263, 'auprc': 0.9983466757704599, 'loss_val': 0.04209597458314239, 'psi': 0.9962681291816198}
[S13] START round=28 head_norm_before_train=1.679677 (no previous merge yet)
[S13] round=28 local utility u=0.154383 metrics={'f1_val': 0.613433569591167, 'auprc': 0.6192439301510376, 'loss_val': 0.7419268948403998, 'psi': 0.6157577138151152}-{'f1_val': 0.5441444784378646, 'auprc': 0.7050966149536388, 'loss_val': 0.8925169981539366, 'psi': 0.6085253330441743}
[S14] START round=28 head_norm_before_train=1.643746 cos_to_last_merge=0.9994 (last merge round=26)
[S14] round=28 local utility u=0.032208 metrics={'f1_val': 0.9973057695633372, 'auprc': 0.9986998537835619, 'loss_val': 0.25965701143180114, 'psi': 0.9978634032514271}-{'f1_val': 0.9964688301972123, 'auprc': 0.9983513263169725, 'loss_val': 0.3180055698625715, 'psi': 0.9972218286451164}
[S15] START round=28 head_norm_before_train=1.467174 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.7145561089089719, 'auprc': 0.895334026493734, 'loss_val': 0.4578430027455958, 'psi': 0.7868672759428768}-{'f1_val': 0.8711609068752576, 'auprc': 0.9929056901146418, 'loss_val': 0.24796832400282917, 'psi': 0.9198588201710113}
[S16] START round=28 head_norm_before_train=1.154264 cos_to_last_merge=0.9843 (last merge round=25)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8842512210836448, 'auprc': 0.9971665560286591, 'loss_val': 0.40115297274755796, 'psi': 0.9294173550616506}-{'f1_val': 0.9701614794818612, 'auprc': 0.99561674424631, 'loss_val': 0.35148138921208166, 'psi': 0.9803435853876408}
[S17] START round=28 head_norm_before_train=1.182813 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.408552 metrics={'f1_val': 0.6204116188157501, 'auprc': 0.6803322068334589, 'loss_val': 0.6796967733195081, 'psi': 0.6443798540228336}-{'f1_val': 0.5355314315434287, 'auprc': 0.6062984097622517, 'loss_val': 0.7654184795289508, 'psi': 0.563838222830958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:39013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:39016
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:39004
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39002
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S9
[S2] cosine check vs S9: cos=0.9152
[S10] RECEIVED delta(kind=head bytes=1797) from S14
[S10] cosine check vs S14: cos=0.9972
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=0.9967
[S4] RECEIVED delta(kind=head bytes=1793) from S10
[S4] cosine check vs S10: cos=0.9960
[S16] RECEIVED delta(kind=head bytes=1790) from S7
[S16] cosine check vs S7: cos=0.9694
[S13] RECEIVED delta(kind=head bytes=1801) from S4
[S13] cosine check vs S4: cos=-0.0786
[S13] DROPPED delta from S4 (cos=-0.0786 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39005
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] cosine check vs S17: cos=0.3770
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.9826 head_norm=1.944919
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.943220e-02
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.9795 head_norm=1.951271 delta_norm=0.079432
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.7006 head_norm=1.711543
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.423972e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.7006 head_norm=1.222343 delta_norm=0.842397
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=28 metric=0.6001 head_norm=1.177825
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.919758e-01
[S2] stored merged vector for next round verification (round=28)
[S2] DEBUG after merge:  round=28 metric=0.5966 head_norm=1.270398 delta_norm=0.291976
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9484 head_norm=1.638003
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.746152e-02
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9500 head_norm=1.658658 delta_norm=0.077462
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.9932 head_norm=1.682629
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.323388e-02
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.9932 head_norm=1.675221 delta_norm=0.063234
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.8843 head_norm=1.207361
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.501615e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.8813 head_norm=1.156060 delta_norm=0.150162
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.270398 cos_to_last_merge=1.0000 (last merge round=28)
[S2] round=29 local utility u=0.562383 metrics={'f1_val': 0.7215267517203214, 'auprc': 0.783552770009017, 'loss_val': 0.6704497995237788, 'psi': 0.7463371590357997}-{'f1_val': 0.6001047943244637, 'auprc': 0.7189881035655241, 'loss_val': 0.8729899354551082, 'psi': 0.6476581180208879}
[S3] START round=29 head_norm_before_train=1.951271 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9661730702897104, 'auprc': 0.9984972364783573, 'loss_val': 0.08157699650308471, 'psi': 0.9791027367651691}-{'f1_val': 0.9825714639544857, 'auprc': 0.9986847770925936, 'loss_val': 0.06756829639783202, 'psi': 0.9890167892097288}
[S4] START round=29 head_norm_before_train=1.658658 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9464961744457866, 'auprc': 0.9653419770620659, 'loss_val': 0.2983030491611896, 'psi': 0.9540344954922984}-{'f1_val': 0.9483590310341423, 'auprc': 0.9660395557834204, 'loss_val': 0.28884473080503154, 'psi': 0.9554312409338535}
[S5] START round=29 head_norm_before_train=1.222343 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.6984628475581323, 'auprc': 0.8587344309790551, 'loss_val': 0.38375470134898376, 'psi': 0.7625714809265014}-{'f1_val': 0.7006083926626743, 'auprc': 0.9846672303348177, 'loss_val': 0.2564541445244431, 'psi': 0.8142319277315317}
[S6] START round=29 head_norm_before_train=1.564501 cos_to_last_merge=0.9993 (last merge round=26)
[S6] round=29 local utility u=0.312874 metrics={'f1_val': 0.6994970433107301, 'auprc': 0.96652868727526, 'loss_val': 0.34092077555644046, 'psi': 0.8063097008965421}-{'f1_val': 0.6976510286426558, 'auprc': 0.7912800125375277, 'loss_val': 0.42984570516288595, 'psi': 0.7351026222006045}
[S7] START round=29 head_norm_before_train=1.122644 cos_to_last_merge=0.9993 (last merge round=27)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.6261493409735691, 'auprc': 0.8151500738396225, 'loss_val': 0.6466815096731335, 'psi': 0.7017496341199905}-{'f1_val': 0.6861647434060364, 'auprc': 0.9422327365904053, 'loss_val': 0.4885904320270856, 'psi': 0.788591940679784}
[S8] START round=29 head_norm_before_train=1.960823 cos_to_last_merge=0.9982 (last merge round=25)
[S8] round=29 local utility u=0.000575 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9971562851181451, 'loss_val': 0.06278676735706595, 'psi': 0.996756179608663}-{'f1_val': 0.9964894426023416, 'auprc': 0.9985507688551074, 'loss_val': 0.06811954750641239, 'psi': 0.9973139731034479}
[S9] START round=29 head_norm_before_train=1.418115 cos_to_last_merge=0.9996 (last merge round=27)
[S9] round=29 local utility u=0.017734 metrics={'f1_val': 0.9940546756789306, 'auprc': 0.9984471911093465, 'loss_val': 0.10585053354347601, 'psi': 0.9958116818510969}-{'f1_val': 0.9927489669882278, 'auprc': 0.9985702924194632, 'loss_val': 0.13385314231635181, 'psi': 0.9950774971607219}
[S10] START round=29 head_norm_before_train=1.675221 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9953925121843918, 'loss_val': 0.09205486491066464, 'psi': 0.9941916150746513}-{'f1_val': 0.9931720938432163, 'auprc': 0.9961205273720116, 'loss_val': 0.09181836398763717, 'psi': 0.9943514672547344}
[S11] START round=29 head_norm_before_train=1.954754 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9915300483457061, 'auprc': 0.998399283221846, 'loss_val': 0.053832538187879135, 'psi': 0.9942777422961621}-{'f1_val': 0.9963256330217796, 'auprc': 0.9982294674921716, 'loss_val': 0.033706386350383984, 'psi': 0.9970871668099364}
[S13] START round=29 head_norm_before_train=1.688174 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5853317896643003, 'auprc': 0.6995760572922252, 'loss_val': 0.8284855878481528, 'psi': 0.6310294967154703}-{'f1_val': 0.613433569591167, 'auprc': 0.6192439301510376, 'loss_val': 0.7419268948403998, 'psi': 0.6157577138151152}
[S14] START round=29 head_norm_before_train=1.670177 cos_to_last_merge=0.9980 (last merge round=26)
[S14] round=29 local utility u=0.020675 metrics={'f1_val': 0.9966527066798861, 'auprc': 0.9986408249655777, 'loss_val': 0.21421114362101987, 'psi': 0.9974479539941628}-{'f1_val': 0.9973057695633372, 'auprc': 0.9986998537835619, 'loss_val': 0.25965701143180114, 'psi': 0.9978634032514271}
[S15] START round=29 head_norm_before_train=1.500505 cos_to_last_merge=0.9995 (last merge round=27)
[S15] round=29 local utility u=0.706989 metrics={'f1_val': 0.8635682301392684, 'auprc': 0.9930862723065534, 'loss_val': 0.23119357533936144, 'psi': 0.9153754470061823}-{'f1_val': 0.7145561089089719, 'auprc': 0.895334026493734, 'loss_val': 0.4578430027455958, 'psi': 0.7868672759428768}
[S16] START round=29 head_norm_before_train=1.156060 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.229620 metrics={'f1_val': 0.9399771984913259, 'auprc': 0.9964765297284226, 'loss_val': 0.2741994116428555, 'psi': 0.9625769309861645}-{'f1_val': 0.8842512210836448, 'auprc': 0.9971665560286591, 'loss_val': 0.40115297274755796, 'psi': 0.9294173550616506}
[S17] START round=29 head_norm_before_train=1.215784 cos_to_last_merge=0.9984 (last merge round=27)
[S17] round=29 local utility u=0.317447 metrics={'f1_val': 0.6171454432905377, 'auprc': 0.8755880143294997, 'loss_val': 0.6109728013719146, 'psi': 0.7205224717061225}-{'f1_val': 0.6204116188157501, 'auprc': 0.6803322068334589, 'loss_val': 0.6796967733195081, 'psi': 0.6443798540228336}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39003
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39017
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39015
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S9
[S2] cosine check vs S9: cos=0.9800
[S9] RECEIVED delta(kind=head bytes=1799) from S15
[S9] cosine check vs S15: cos=0.9854
[S7] RECEIVED delta(kind=head bytes=1793) from S2
[S7] cosine check vs S2: cos=0.6596
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=0.9980
[S15] RECEIVED delta(kind=head bytes=1802) from S6
[S15] cosine check vs S6: cos=0.9929
[S10] RECEIVED delta(kind=head bytes=1796) from S14
[S10] cosine check vs S14: cos=0.9975
[S17] RECEIVED delta(kind=head bytes=1799) from S16
[S17] cosine check vs S16: cos=0.9262
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39005
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] cosine check vs S17: cos=0.7633
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.9662 head_norm=1.970882
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.307562e-02
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.9634 head_norm=1.974021 delta_norm=0.063076
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=29 metric=0.9934 head_norm=1.703176
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.072724e-02
[S10] stored merged vector for next round verification (round=29)
[S10] DEBUG after merge:  round=29 metric=0.9934 head_norm=1.699308 delta_norm=0.060727
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.6261 head_norm=1.142371
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.119640e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.5741 head_norm=1.118114 delta_norm=0.511964
[S7] aggregate: ROLLBACK (f1_val pre=0.626 post=0.574 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.6985 head_norm=1.246101
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.297402e-01
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.6855 head_norm=1.172864 delta_norm=0.429740
[S5] aggregate: ROLLBACK (f1_val pre=0.698 post=0.685 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=29 metric=0.7215 head_norm=1.311319
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.546458e-01
[S2] stored merged vector for next round verification (round=29)
[S2] DEBUG after merge:  round=29 metric=0.7215 head_norm=1.374564 delta_norm=0.154646
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=29 metric=0.9941 head_norm=1.451594
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.317985e-01
[S9] stored merged vector for next round verification (round=29)
[S9] DEBUG after merge:  round=29 metric=0.9941 head_norm=1.481862 delta_norm=0.131798
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.8636 head_norm=1.522974
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.579492e-02
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.8661 head_norm=1.546577 delta_norm=0.095795
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.6171 head_norm=1.252121
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.373709e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.6068 head_norm=1.208220 delta_norm=0.237371
[S17] aggregate: ROLLBACK (f1_val pre=0.617 post=0.607 tol_abs=0.005 tol_rel=0.0)
[S2] START round=30 head_norm_before_train=1.374564 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.6856709053803549, 'auprc': 0.6988459051987892, 'loss_val': 0.675270135299667, 'psi': 0.6909409053077287}-{'f1_val': 0.7215267517203214, 'auprc': 0.783552770009017, 'loss_val': 0.6704497995237788, 'psi': 0.7463371590357997}
[S3] START round=30 head_norm_before_train=1.974021 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.092681 metrics={'f1_val': 0.9950503914805644, 'auprc': 0.9985017733759164, 'loss_val': 0.06949193503482068, 'psi': 0.9964309442387052}-{'f1_val': 0.9661730702897104, 'auprc': 0.9984972364783573, 'loss_val': 0.08157699650308471, 'psi': 0.9791027367651691}
[S4] START round=30 head_norm_before_train=1.674979 cos_to_last_merge=0.9999 (last merge round=28)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9402182408168959, 'auprc': 0.9284305317283312, 'loss_val': 0.3256681977615504, 'psi': 0.93550315718147}-{'f1_val': 0.9464961744457866, 'auprc': 0.9653419770620659, 'loss_val': 0.2983030491611896, 'psi': 0.9540344954922984}
[S5] START round=30 head_norm_before_train=1.172864 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8004366641816949, 'loss_val': 0.3821639412656404, 'psi': 0.7405397012702826}-{'f1_val': 0.6984628475581323, 'auprc': 0.8587344309790551, 'loss_val': 0.38375470134898376, 'psi': 0.7625714809265014}
[S6] START round=30 head_norm_before_train=1.575661 cos_to_last_merge=0.9987 (last merge round=26)
[S6] round=30 local utility u=0.004637 metrics={'f1_val': 0.6994970433107301, 'auprc': 0.9652574310065365, 'loss_val': 0.3278339147055551, 'psi': 0.8058011983890527}-{'f1_val': 0.6994970433107301, 'auprc': 0.96652868727526, 'loss_val': 0.34092077555644046, 'psi': 0.8063097008965421}
[S7] START round=30 head_norm_before_train=1.118114 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.6151715814273987, 'auprc': 0.7769112048238174, 'loss_val': 0.7050910633923778, 'psi': 0.6798674307859662}-{'f1_val': 0.6261493409735691, 'auprc': 0.8151500738396225, 'loss_val': 0.6466815096731335, 'psi': 0.7017496341199905}
[S8] START round=30 head_norm_before_train=1.979166 cos_to_last_merge=0.9973 (last merge round=25)
[S8] round=30 local utility u=0.003751 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9987854978860045, 'loss_val': 0.06017235831710746, 'psi': 0.9974078647158068}-{'f1_val': 0.9964894426023416, 'auprc': 0.9971562851181451, 'loss_val': 0.06278676735706595, 'psi': 0.996756179608663}
[S9] START round=30 head_norm_before_train=1.481862 cos_to_last_merge=1.0000 (last merge round=29)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9914877899498036, 'auprc': 0.9984270932108231, 'loss_val': 0.09767492767453126, 'psi': 0.9942635112542113}-{'f1_val': 0.9940546756789306, 'auprc': 0.9984471911093465, 'loss_val': 0.10585053354347601, 'psi': 0.9958116818510969}
[S10] START round=30 head_norm_before_train=1.699308 cos_to_last_merge=1.0000 (last merge round=29)
[S10] round=30 local utility u=0.001248 metrics={'f1_val': 0.993593908338861, 'auprc': 0.995867924210604, 'loss_val': 0.09220285109178782, 'psi': 0.9945035146875583}-{'f1_val': 0.993391017001491, 'auprc': 0.9953925121843918, 'loss_val': 0.09205486491066464, 'psi': 0.9941916150746513}
[S11] START round=30 head_norm_before_train=1.970558 (no previous merge yet)
[S11] round=30 local utility u=0.025799 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983616611992401, 'loss_val': 0.03234552069362068, 'psi': 0.9972851468634243}-{'f1_val': 0.9915300483457061, 'auprc': 0.998399283221846, 'loss_val': 0.053832538187879135, 'psi': 0.9942777422961621}
[S13] START round=30 head_norm_before_train=1.697530 (no previous merge yet)
[S13] round=30 local utility u=0.124998 metrics={'f1_val': 0.5986440481199563, 'auprc': 0.6916434248394878, 'loss_val': 0.63456510089282, 'psi': 0.635843798807769}-{'f1_val': 0.5853317896643003, 'auprc': 0.6995760572922252, 'loss_val': 0.8284855878481528, 'psi': 0.6310294967154703}
[S14] START round=30 head_norm_before_train=1.697606 cos_to_last_merge=0.9958 (last merge round=26)
[S14] round=30 local utility u=0.019027 metrics={'f1_val': 0.9968429160880343, 'auprc': 0.9986105673886645, 'loss_val': 0.17720855146661058, 'psi': 0.9975499766082865}-{'f1_val': 0.9966527066798861, 'auprc': 0.9986408249655777, 'loss_val': 0.21421114362101987, 'psi': 0.9974479539941628}
[S15] START round=30 head_norm_before_train=1.546577 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.122654 metrics={'f1_val': 0.8953330723052756, 'auprc': 0.9925035614170776, 'loss_val': 0.1747261638778961, 'psi': 0.9342012679499964}-{'f1_val': 0.8635682301392684, 'auprc': 0.9930862723065534, 'loss_val': 0.23119357533936144, 'psi': 0.9153754470061823}
[S16] START round=30 head_norm_before_train=1.210155 cos_to_last_merge=0.9985 (last merge round=28)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9229144375052671, 'auprc': 0.9972290789680011, 'loss_val': 0.28288499076252466, 'psi': 0.9526402940903607}-{'f1_val': 0.9399771984913259, 'auprc': 0.9964765297284226, 'loss_val': 0.2741994116428555, 'psi': 0.9625769309861645}
[S17] START round=30 head_norm_before_train=1.208220 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6202720573868445, 'auprc': 0.7418958765611289, 'loss_val': 0.6624141053961268, 'psi': 0.6689215850565582}-{'f1_val': 0.6171454432905377, 'auprc': 0.8755880143294997, 'loss_val': 0.6109728013719146, 'psi': 0.7205224717061225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39015
[S6] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S6
[S15] cosine check vs S6: cos=0.9972
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:39003
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S8
[S3] cosine check vs S8: cos=0.9985
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:39011
[S15] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S15
[S9] cosine check vs S15: cos=0.9907
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S14
[S10] cosine check vs S14: cos=0.9978
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S16
[S6]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=0.296 → S16@127.0.0.1:39016
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=30 metric=0.9915 head_norm=1.509732
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.089111e-01
[S9] stored merged vector for next round verification (round=30)
[S9] DEBUG after merge:  round=30 metric=0.9915 head_norm=1.535432 delta_norm=0.108911
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.106 → S2@127.0.0.1:39002
[S14] ⇄ pheromone p=0.102 → S10@127.0.0.1:39011
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.9951 head_norm=1.995174
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.518267e-02
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.9942 head_norm=1.994332 delta_norm=0.055183
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.167 → S7@127.0.0.1:39008
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.8953 head_norm=1.568291
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.039245e-02
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.8953 head_norm=1.577782 delta_norm=0.060392
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.260 → S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:39004
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.049 → S3@127.0.0.1:39003
[S5] ⇄ pheromone p=0.075 → S8@127.0.0.1:39009
[S6] ⇄ pheromone p=0.108 → S15@127.0.0.1:39015
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.035 → S13@127.0.0.1:39013
[S16] ⇄ pheromone p=0.098 → S17@127.0.0.1:39017
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S10
[S4] cosine check vs S10: cos=0.9959
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.9936 head_norm=1.727844
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.694829e-02
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.9936 head_norm=1.724271 delta_norm=0.056948
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.041 → S4@127.0.0.1:39004
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S15
[S17] ⇄ pheromone p=0.185 → S5@127.0.0.1:39005
[S2] START round=31 head_norm_before_train=1.404859 cos_to_last_merge=0.9997 (last merge round=29)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.6359974206659923, 'auprc': 0.7502179453227666, 'loss_val': 0.8132485017210098, 'psi': 0.681685630528702}-{'f1_val': 0.6856709053803549, 'auprc': 0.6988459051987892, 'loss_val': 0.675270135299667, 'psi': 0.6909409053077287}
[S3] START round=31 head_norm_before_train=1.994332 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.8773644494043992, 'auprc': 0.9986788512885589, 'loss_val': 0.1843125786927961, 'psi': 0.925890210158063}-{'f1_val': 0.9950503914805644, 'auprc': 0.9985017733759164, 'loss_val': 0.06949193503482068, 'psi': 0.9964309442387052}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.689340 cos_to_last_merge=0.9998 (last merge round=28)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9397483810671488, 'auprc': 0.9124874396432463, 'loss_val': 0.32967015742966443, 'psi': 0.9288440044975877}-{'f1_val': 0.9402182408168959, 'auprc': 0.9284305317283312, 'loss_val': 0.3256681977615504, 'psi': 0.93550315718147}
[S5] START round=31 head_norm_before_train=1.219263 cos_to_last_merge=0.9984 (last merge round=29)
[S5] round=31 local utility u=0.297998 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9795904268274045, 'loss_val': 0.3236296171156966, 'psi': 0.8122012063285664}-{'f1_val': 0.7006083926626743, 'auprc': 0.8004366641816949, 'loss_val': 0.3821639412656404, 'psi': 0.7405397012702826}
[S6] START round=31 head_norm_before_train=1.589512 cos_to_last_merge=0.9979 (last merge round=26)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.7081041255663325, 'auprc': 0.7901727157621918, 'loss_val': 0.5153934677592854, 'psi': 0.7409315616446762}-{'f1_val': 0.6994970433107301, 'auprc': 0.9652574310065365, 'loss_val': 0.3278339147055551, 'psi': 0.8058011983890527}
[S7] START round=31 head_norm_before_train=1.135573 cos_to_last_merge=0.9995 (last merge round=29)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.5933214733149587, 'auprc': 0.8062228199708856, 'loss_val': 0.7171367144703189, 'psi': 0.6784820119773294}-{'f1_val': 0.6151715814273987, 'auprc': 0.7769112048238174, 'loss_val': 0.7050910633923778, 'psi': 0.6798674307859662}
[S8] START round=31 head_norm_before_train=1.995017 cos_to_last_merge=0.9964 (last merge round=25)
[S8] round=31 local utility u=0.004694 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.9991763898899493, 'loss_val': 0.05285708805414933, 'psi': 0.997654204219977}-{'f1_val': 0.9964894426023416, 'auprc': 0.9987854978860045, 'loss_val': 0.06017235831710746, 'psi': 0.9974078647158068}
[S9] START round=31 head_norm_before_train=1.535432 cos_to_last_merge=1.0000 (last merge round=30)
[S9] round=31 local utility u=0.023882 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9981602689464268, 'loss_val': 0.08129968991864021, 'psi': 0.9973756588339251}-{'f1_val': 0.9914877899498036, 'auprc': 0.9984270932108231, 'loss_val': 0.09767492767453126, 'psi': 0.9942635112542113}
[S10] START round=31 head_norm_before_train=1.724271 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.005305 metrics={'f1_val': 0.9933750578586366, 'auprc': 0.9964471928894596, 'loss_val': 0.08201809865082052, 'psi': 0.9946039118709658}-{'f1_val': 0.993593908338861, 'auprc': 0.995867924210604, 'loss_val': 0.09220285109178782, 'psi': 0.9945035146875583}
[S11] START round=31 head_norm_before_train=1.983148 (no previous merge yet)
[S11] round=31 local utility u=0.000408 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982766063855688, 'loss_val': 0.0312739143779833, 'psi': 0.9972511249379558}-{'f1_val': 0.996567470639547, 'auprc': 0.9983616611992401, 'loss_val': 0.03234552069362068, 'psi': 0.9972851468634243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=31 head_norm_before_train=1.705761 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6037539123796962, 'auprc': 0.6054671429159869, 'loss_val': 0.7933232756067012, 'psi': 0.6044392045942124}-{'f1_val': 0.5986440481199563, 'auprc': 0.6916434248394878, 'loss_val': 0.63456510089282, 'psi': 0.635843798807769}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.722573 cos_to_last_merge=0.9935 (last merge round=26)
[S14] round=31 local utility u=0.008989 metrics={'f1_val': 0.9968657110110009, 'auprc': 0.9954073161274866, 'loss_val': 0.14975710807567724, 'psi': 0.996282353057595}-{'f1_val': 0.9968429160880343, 'auprc': 0.9986105673886645, 'loss_val': 0.17720855146661058, 'psi': 0.9975499766082865}
[S15] START round=31 head_norm_before_train=1.577782 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.176906 metrics={'f1_val': 0.9498950918661497, 'auprc': 0.9865832808308816, 'loss_val': 0.13052465574923922, 'psi': 0.9645703674520425}-{'f1_val': 0.8953330723052756, 'auprc': 0.9925035614170776, 'loss_val': 0.1747261638778961, 'psi': 0.9342012679499964}
[S16] START round=31 head_norm_before_train=1.261563 cos_to_last_merge=0.9952 (last merge round=28)
[S16] round=31 local utility u=0.024269 metrics={'f1_val': 0.9262441533110939, 'auprc': 0.9972601718832017, 'loss_val': 0.2544187804262798, 'psi': 0.9546505607399369}-{'f1_val': 0.9229144375052671, 'auprc': 0.9972290789680011, 'loss_val': 0.28288499076252466, 'psi': 0.9526402940903607}
[S17] START round=31 head_norm_before_train=1.244671 cos_to_last_merge=0.9991 (last merge round=29)
[S17] round=31 local utility u=0.763535 metrics={'f1_val': 0.7861360119533922, 'auprc': 0.8609695080185074, 'loss_val': 0.4877479528614344, 'psi': 0.8160694103794384}-{'f1_val': 0.6202720573868445, 'auprc': 0.7418958765611289, 'loss_val': 0.6624141053961268, 'psi': 0.6689215850565582}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:39004
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39003
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39017
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39002
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=31 metric=0.9397 head_norm=1.699346
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.247194e-02
[S4] stored merged vector for next round verification (round=31)
[S4] DEBUG after merge:  round=31 metric=0.9397 head_norm=1.711669 delta_norm=0.082472
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39009
[S10] RECEIVED delta(kind=head bytes=1795) from S14
[S10] cosine check vs S14: cos=0.9981
[S4] RECEIVED delta(kind=head bytes=1797) from S10
[S4] cosine check vs S10: cos=0.9978
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=0.9988
[S17] RECEIVED delta(kind=head bytes=1799) from S16
[S17] cosine check vs S16: cos=0.9640
[S2] RECEIVED delta(kind=head bytes=1802) from S9
[S2] cosine check vs S9: cos=0.9771
[S9] RECEIVED delta(kind=head bytes=1798) from S15
[S9] cosine check vs S15: cos=0.9946
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.9969 head_norm=1.560673
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.453497e-02
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.9969 head_norm=1.577264 delta_norm=0.084535
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=31 metric=0.9934 head_norm=1.751122
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.341864e-02
[S10] stored merged vector for next round verification (round=31)
[S10] DEBUG after merge:  round=31 metric=0.9932 head_norm=1.746754 delta_norm=0.053419
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S5
[S8] cosine check vs S5: cos=0.0466
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=31 metric=0.6360 head_norm=1.425184
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.733190e-01
[S2] stored merged vector for next round verification (round=31)
[S2] DEBUG after merge:  round=31 metric=0.6357 head_norm=1.484380 delta_norm=0.173319
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] RoundReady barrier timeout: have=1 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39005
[S17] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S17
[S5] cosine check vs S17: cos=0.9408
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.7006 head_norm=1.272414
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.191531e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.7006 head_norm=1.254978 delta_norm=0.219153
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9]  timeout peer S2
[S15]  timeout peer S9
[S5]  timeout peer S8
[S5]  timeout peer S11
[S4]  timeout peer S13
[S16]  timeout peer S17
[S7]  timeout peer S16
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S14
[S6]  timeout peer S15
[S10]  timeout peer S4
[S14]  timeout peer S10
[S2]  timeout peer S7
[S8]  timeout peer S3
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.7861 head_norm=1.275522
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.739931e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.7844 head_norm=1.279703 delta_norm=0.173993
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.484380 cos_to_last_merge=1.0000 (last merge round=31)
[S2] round=32 local utility u=0.239826 metrics={'f1_val': 0.6774966633704631, 'auprc': 0.7790506894746021, 'loss_val': 0.6690903201612237, 'psi': 0.7181182738121188}-{'f1_val': 0.6359974206659923, 'auprc': 0.7502179453227666, 'loss_val': 0.8132485017210098, 'psi': 0.681685630528702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=32 head_norm_before_train=2.014018 cos_to_last_merge=0.9998 (last merge round=30)
[S3] round=32 local utility u=0.387353 metrics={'f1_val': 0.983867992857389, 'auprc': 0.9984990675677902, 'loss_val': 0.04808892429564684, 'psi': 0.9897204227415495}-{'f1_val': 0.8773644494043992, 'auprc': 0.9986788512885589, 'loss_val': 0.1843125786927961, 'psi': 0.925890210158063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=32 metric=0.9839 head_norm=2.034073
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.560276e-02
[S3] stored merged vector for next round verification (round=32)
[S3] DEBUG after merge:  round=32 metric=0.9830 head_norm=2.022191 delta_norm=0.065603
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] START round=32 head_norm_before_train=1.711669 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=32 local utility u=0.004865 metrics={'f1_val': 0.9405244902141181, 'auprc': 0.9144477937294844, 'loss_val': 0.33047881003912233, 'psi': 0.9300938116202646}-{'f1_val': 0.9397483810671488, 'auprc': 0.9124874396432463, 'loss_val': 0.32967015742966443, 'psi': 0.9288440044975877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9405 head_norm=1.722176
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.171283e-02
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9411 head_norm=1.735613 delta_norm=0.061713
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] START round=32 head_norm_before_train=1.254978 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.6885430216585202, 'auprc': 0.8000089177865943, 'loss_val': 0.40857045975453604, 'psi': 0.7331293801097498}-{'f1_val': 0.7006083926626743, 'auprc': 0.9795904268274045, 'loss_val': 0.3236296171156966, 'psi': 0.8122012063285664}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.602380 cos_to_last_merge=0.9971 (last merge round=26)
[S6] round=32 local utility u=0.352762 metrics={'f1_val': 0.6992464480250545, 'auprc': 0.9762310310331236, 'loss_val': 0.31489860808279996, 'psi': 0.8100402812282821}-{'f1_val': 0.7081041255663325, 'auprc': 0.7901727157621918, 'loss_val': 0.5153934677592854, 'psi': 0.7409315616446762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=32 head_norm_before_train=1.160219 cos_to_last_merge=0.9974 (last merge round=29)
[S7] round=32 local utility u=0.226063 metrics={'f1_val': 0.6383163015024628, 'auprc': 0.826776883826011, 'loss_val': 0.596642616215749, 'psi': 0.7137005344318821}-{'f1_val': 0.5933214733149587, 'auprc': 0.8062228199708856, 'loss_val': 0.7171367144703189, 'psi': 0.6784820119773294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=32 head_norm_before_train=2.012378 cos_to_last_merge=0.9957 (last merge round=25)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9959789603727395, 'auprc': 0.9982500378907406, 'loss_val': 0.0561660777609326, 'psi': 0.9968873913799399}-{'f1_val': 0.9966394137733288, 'auprc': 0.9991763898899493, 'loss_val': 0.05285708805414933, 'psi': 0.997654204219977}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9960 head_norm=2.027268
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.170585e+00
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9884 head_norm=1.222357 delta_norm=1.170585
[S8] aggregate: ROLLBACK (f1_val pre=0.996 post=0.988 tol_abs=0.005 tol_rel=0.0)
[S9] START round=32 head_norm_before_train=1.577264 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9918873100557919, 'auprc': 0.998013589353828, 'loss_val': 0.07927724082569113, 'psi': 0.9943378217750063}-{'f1_val': 0.9968525854255906, 'auprc': 0.9981602689464268, 'loss_val': 0.08129968991864021, 'psi': 0.9973756588339251}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.746754 cos_to_last_merge=1.0000 (last merge round=31)
[S10] round=32 local utility u=0.000845 metrics={'f1_val': 0.9929289500455621, 'auprc': 0.9964500078733509, 'loss_val': 0.07766074391032626, 'psi': 0.9943373731766777}-{'f1_val': 0.9933750578586366, 'auprc': 0.9964471928894596, 'loss_val': 0.08201809865082052, 'psi': 0.9946039118709658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=32 head_norm_before_train=1.996531 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9485457214152527, 'auprc': 0.9983702044785367, 'loss_val': 0.19443600288268414, 'psi': 0.9684755146405664}-{'f1_val': 0.996567470639547, 'auprc': 0.9982766063855688, 'loss_val': 0.0312739143779833, 'psi': 0.9972511249379558}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=1.713241 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5524920418821094, 'auprc': 0.6669318889454467, 'loss_val': 1.0194822872558789, 'psi': 0.5982679807074444}-{'f1_val': 0.6037539123796962, 'auprc': 0.6054671429159869, 'loss_val': 0.7933232756067012, 'psi': 0.6044392045942124}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.744012 cos_to_last_merge=0.9913 (last merge round=26)
[S14] round=32 local utility u=0.013427 metrics={'f1_val': 0.9968429160880343, 'auprc': 0.996892001600774, 'loss_val': 0.1272205171744084, 'psi': 0.9968625502931302}-{'f1_val': 0.9968657110110009, 'auprc': 0.9954073161274866, 'loss_val': 0.14975710807567724, 'psi': 0.996282353057595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=32 head_norm_before_train=1.598161 cos_to_last_merge=0.9999 (last merge round=30)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.899622779302214, 'auprc': 0.9889027432969526, 'loss_val': 0.1669173842488494, 'psi': 0.9353347649001095}-{'f1_val': 0.9498950918661497, 'auprc': 0.9865832808308816, 'loss_val': 0.13052465574923922, 'psi': 0.9645703674520425}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.307239 cos_to_last_merge=0.9914 (last merge round=28)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9204161301403134, 'auprc': 0.9972915013845698, 'loss_val': 0.26391636696694787, 'psi': 0.951166278638016}-{'f1_val': 0.9262441533110939, 'auprc': 0.9972601718832017, 'loss_val': 0.2544187804262798, 'psi': 0.9546505607399369}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.279703 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.5825661503458024, 'auprc': 0.7589525352918468, 'loss_val': 0.8325087865865229, 'psi': 0.6531207043242202}-{'f1_val': 0.7861360119533922, 'auprc': 0.8609695080185074, 'loss_val': 0.4877479528614344, 'psi': 0.8160694103794384}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.502836 cos_to_last_merge=0.9998 (last merge round=31)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.5668922724771879, 'auprc': 0.7203930522263127, 'loss_val': 1.2668834396159994, 'psi': 0.6282925843768379}-{'f1_val': 0.6774966633704631, 'auprc': 0.7790506894746021, 'loss_val': 0.6690903201612237, 'psi': 0.7181182738121188}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=2.022191 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.961289870742017, 'auprc': 0.9985829565275407, 'loss_val': 0.09755332034441024, 'psi': 0.9762071050562264}-{'f1_val': 0.983867992857389, 'auprc': 0.9984990675677902, 'loss_val': 0.04808892429564684, 'psi': 0.9897204227415495}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.735613 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.007033 metrics={'f1_val': 0.9411610736460801, 'auprc': 0.9181314528073967, 'loss_val': 0.33128328698386184, 'psi': 0.9319492253106068}-{'f1_val': 0.9405244902141181, 'auprc': 0.9144477937294844, 'loss_val': 0.33047881003912233, 'psi': 0.9300938116202646}
[S4] not sending this round → trigger blocked (psi=0.932)
[S5] START round=33 head_norm_before_train=1.302259 cos_to_last_merge=0.9983 (last merge round=31)
[S5] round=33 local utility u=0.219594 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8926854289752527, 'loss_val': 0.31980389918715135, 'psi': 0.7774392071877056}-{'f1_val': 0.6885430216585202, 'auprc': 0.8000089177865943, 'loss_val': 0.40857045975453604, 'psi': 0.7331293801097498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=33 head_norm_before_train=1.610574 cos_to_last_merge=0.9964 (last merge round=26)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.6975036698580113, 'auprc': 0.786215407249329, 'loss_val': 0.3545135655854311, 'psi': 0.7329883648145383}-{'f1_val': 0.6992464480250545, 'auprc': 0.9762310310331236, 'loss_val': 0.31489860808279996, 'psi': 0.8100402812282821}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.186373 cos_to_last_merge=0.9942 (last merge round=29)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.6113190937336309, 'auprc': 0.8040810919173288, 'loss_val': 0.6412747753563344, 'psi': 0.68842389300711}-{'f1_val': 0.6383163015024628, 'auprc': 0.826776883826011, 'loss_val': 0.596642616215749, 'psi': 0.7137005344318821}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.222357 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9963525581780791, 'auprc': 0.9963465143210595, 'loss_val': 0.16978392614588952, 'psi': 0.9963501406352713}-{'f1_val': 0.9959789603727395, 'auprc': 0.9982500378907406, 'loss_val': 0.0561660777609326, 'psi': 0.9968873913799399}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=1.601132 cos_to_last_merge=0.9997 (last merge round=31)
[S9] round=33 local utility u=0.002186 metrics={'f1_val': 0.9914152665170077, 'auprc': 0.9981553960672892, 'loss_val': 0.0724983408198554, 'psi': 0.9941113183371203}-{'f1_val': 0.9918873100557919, 'auprc': 0.998013589353828, 'loss_val': 0.07927724082569113, 'psi': 0.9943378217750063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=33 head_norm_before_train=1.771175 cos_to_last_merge=0.9999 (last merge round=31)
[S10] round=33 local utility u=0.002177 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9961509688321113, 'loss_val': 0.07124264608883346, 'psi': 0.994101066700969}-{'f1_val': 0.9929289500455621, 'auprc': 0.9964500078733509, 'loss_val': 0.07766074391032626, 'psi': 0.9943373731766777}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=33 head_norm_before_train=2.012294 (no previous merge yet)
[S11] round=33 local utility u=0.226495 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9984563434739118, 'loss_val': 0.02838400635017352, 'psi': 0.9971779172026325}-{'f1_val': 0.9485457214152527, 'auprc': 0.9983702044785367, 'loss_val': 0.19443600288268414, 'psi': 0.9684755146405664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=33 head_norm_before_train=1.721746 (no previous merge yet)
[S13] round=33 local utility u=0.320854 metrics={'f1_val': 0.6014450134013831, 'auprc': 0.6675726633949004, 'loss_val': 0.673414931714819, 'psi': 0.6278960733987901}-{'f1_val': 0.5524920418821094, 'auprc': 0.6669318889454467, 'loss_val': 1.0194822872558789, 'psi': 0.5982679807074444}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=33 head_norm_before_train=1.765298 cos_to_last_merge=0.9891 (last merge round=26)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9939416359582892, 'auprc': 0.9987919811283164, 'loss_val': 0.12497801454057236, 'psi': 0.9958817740263001}-{'f1_val': 0.9968429160880343, 'auprc': 0.996892001600774, 'loss_val': 0.1272205171744084, 'psi': 0.9968625502931302}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.616506 cos_to_last_merge=0.9995 (last merge round=30)
[S15] round=33 local utility u=0.022319 metrics={'f1_val': 0.9019228025882957, 'auprc': 0.9954521788320821, 'loss_val': 0.15572822705283354, 'psi': 0.9393345530858103}-{'f1_val': 0.899622779302214, 'auprc': 0.9889027432969526, 'loss_val': 0.1669173842488494, 'psi': 0.9353347649001095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] sending update (kind=head size=1807 to 1 peers)
[S16] START round=33 head_norm_before_train=1.347560 cos_to_last_merge=0.9876 (last merge round=28)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8732734369917322, 'auprc': 0.9951459894479749, 'loss_val': 0.40348719844633374, 'psi': 0.9220224579742293}-{'f1_val': 0.9204161301403134, 'auprc': 0.9972915013845698, 'loss_val': 0.26391636696694787, 'psi': 0.951166278638016}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.304415 cos_to_last_merge=0.9997 (last merge round=31)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.5280400940027454, 'auprc': 0.7329255870226598, 'loss_val': 1.0112589375288226, 'psi': 0.6099942912107111}-{'f1_val': 0.5825661503458024, 'auprc': 0.7589525352918468, 'loss_val': 0.8325087865865229, 'psi': 0.6531207043242202}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.520973 cos_to_last_merge=0.9992 (last merge round=31)
[S2] round=34 local utility u=0.786735 metrics={'f1_val': 0.720861813435431, 'auprc': 0.7809114726492831, 'loss_val': 0.7987852694335579, 'psi': 0.7448816771209719}-{'f1_val': 0.5668922724771879, 'auprc': 0.7203930522263127, 'loss_val': 1.2668834396159994, 'psi': 0.6282925843768379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=34 head_norm_before_train=2.038701 cos_to_last_merge=0.9999 (last merge round=32)
[S3] round=34 local utility u=0.084490 metrics={'f1_val': 0.9816704223582675, 'auprc': 0.9985050235528278, 'loss_val': 0.05062253032820979, 'psi': 0.9884042628360916}-{'f1_val': 0.961289870742017, 'auprc': 0.9985829565275407, 'loss_val': 0.09755332034441024, 'psi': 0.9762071050562264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=34 head_norm_before_train=1.745031 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=34 local utility u=0.026565 metrics={'f1_val': 0.9419091455943589, 'auprc': 0.9320434611953636, 'loss_val': 0.324377187321164, 'psi': 0.9379628718347608}-{'f1_val': 0.9411610736460801, 'auprc': 0.9181314528073967, 'loss_val': 0.33128328698386184, 'psi': 0.9319492253106068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=34 head_norm_before_train=1.352156 cos_to_last_merge=0.9948 (last merge round=31)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.6786018297732571, 'auprc': 0.8540765762024918, 'loss_val': 0.3404982436795977, 'psi': 0.748791728344951}-{'f1_val': 0.7006083926626743, 'auprc': 0.8926854289752527, 'loss_val': 0.31980389918715135, 'psi': 0.7774392071877056}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.619451 cos_to_last_merge=0.9956 (last merge round=26)
[S6] round=34 local utility u=0.186614 metrics={'f1_val': 0.698593697038735, 'auprc': 0.8950940437250778, 'loss_val': 0.31446172975188, 'psi': 0.7771938357132722}-{'f1_val': 0.6975036698580113, 'auprc': 0.786215407249329, 'loss_val': 0.3545135655854311, 'psi': 0.7329883648145383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=34 head_norm_before_train=1.210922 cos_to_last_merge=0.9903 (last merge round=29)
[S7] round=34 local utility u=0.622664 metrics={'f1_val': 0.6966530660238703, 'auprc': 0.956009088857949, 'loss_val': 0.36373506740534406, 'psi': 0.8003954751575018}-{'f1_val': 0.6113190937336309, 'auprc': 0.8040810919173288, 'loss_val': 0.6412747753563344, 'psi': 0.68842389300711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=34 head_norm_before_train=1.250752 cos_to_last_merge=0.9996 (last merge round=32)
[S8] round=34 local utility u=0.015474 metrics={'f1_val': 0.9962024490124872, 'auprc': 0.9970003967347671, 'loss_val': 0.1398960335579894, 'psi': 0.9965216281013991}-{'f1_val': 0.9963525581780791, 'auprc': 0.9963465143210595, 'loss_val': 0.16978392614588952, 'psi': 0.9963501406352713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=34 head_norm_before_train=1.621932 cos_to_last_merge=0.9991 (last merge round=31)
[S9] round=34 local utility u=0.022616 metrics={'f1_val': 0.9963223492777684, 'auprc': 0.9981444642376739, 'loss_val': 0.05667668191381884, 'psi': 0.9970511952617307}-{'f1_val': 0.9914152665170077, 'auprc': 0.9981553960672892, 'loss_val': 0.0724983408198554, 'psi': 0.9941113183371203}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=34 head_norm_before_train=1.794972 cos_to_last_merge=0.9995 (last merge round=31)
[S10] round=34 local utility u=0.002161 metrics={'f1_val': 0.992515759314603, 'auprc': 0.9958413249566769, 'loss_val': 0.06467950560668374, 'psi': 0.9938459855714326}-{'f1_val': 0.9927344652802075, 'auprc': 0.9961509688321113, 'loss_val': 0.07124264608883346, 'psi': 0.994101066700969}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=34 head_norm_before_train=2.022287 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.998189553216956, 'loss_val': 0.02929046999795861, 'psi': 0.9970712010998501}-{'f1_val': 0.9963256330217796, 'auprc': 0.9984563434739118, 'loss_val': 0.02838400635017352, 'psi': 0.9971779172026325}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.728187 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5950617805745071, 'auprc': 0.6470351540845868, 'loss_val': 0.8278270174431374, 'psi': 0.615851129978539}-{'f1_val': 0.6014450134013831, 'auprc': 0.6675726633949004, 'loss_val': 0.673414931714819, 'psi': 0.6278960733987901}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.783219 cos_to_last_merge=0.9870 (last merge round=26)
[S14] round=34 local utility u=0.014613 metrics={'f1_val': 0.9965574496053289, 'auprc': 0.9954261455178612, 'loss_val': 0.10135000660909986, 'psi': 0.9961049279703418}-{'f1_val': 0.9939416359582892, 'auprc': 0.9987919811283164, 'loss_val': 0.12497801454057236, 'psi': 0.9958817740263001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=34 head_norm_before_train=1.635604 cos_to_last_merge=0.9989 (last merge round=30)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7602126420973625, 'auprc': 0.9852539404484036, 'loss_val': 0.30654677316115897, 'psi': 0.8502291614377789}-{'f1_val': 0.9019228025882957, 'auprc': 0.9954521788320821, 'loss_val': 0.15572822705283354, 'psi': 0.9393345530858103}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.380841 cos_to_last_merge=0.9842 (last merge round=28)
[S16] round=34 local utility u=0.379616 metrics={'f1_val': 0.9556605467869826, 'auprc': 0.9971129565783454, 'loss_val': 0.14447796406076918, 'psi': 0.9722415107035277}-{'f1_val': 0.8732734369917322, 'auprc': 0.9951459894479749, 'loss_val': 0.40348719844633374, 'psi': 0.9220224579742293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=34 head_norm_before_train=1.327896 cos_to_last_merge=0.9989 (last merge round=31)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.3961174524455702, 'auprc': 0.6803891047672544, 'loss_val': 1.2086109636894429, 'psi': 0.5098261133742439}-{'f1_val': 0.5280400940027454, 'auprc': 0.7329255870226598, 'loss_val': 1.0112589375288226, 'psi': 0.6099942912107111}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.536703 cos_to_last_merge=0.9983 (last merge round=31)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.721463273318615, 'auprc': 0.7594173038548417, 'loss_val': 0.8620775116946295, 'psi': 0.7366448855331058}-{'f1_val': 0.720861813435431, 'auprc': 0.7809114726492831, 'loss_val': 0.7987852694335579, 'psi': 0.7448816771209719}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=2.054614 cos_to_last_merge=0.9997 (last merge round=32)
[S3] round=35 local utility u=0.059690 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9985071834634984, 'loss_val': 0.02791623563694351, 'psi': 0.9980717712123579}-{'f1_val': 0.9816704223582675, 'auprc': 0.9985050235528278, 'loss_val': 0.05062253032820979, 'psi': 0.9884042628360916}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=35 head_norm_before_train=1.756931 cos_to_last_merge=0.9998 (last merge round=32)
[S4] round=35 local utility u=0.026547 metrics={'f1_val': 0.9406819455957796, 'auprc': 0.9528010246146998, 'loss_val': 0.3261935245445833, 'psi': 0.9455295772033476}-{'f1_val': 0.9419091455943589, 'auprc': 0.9320434611953636, 'loss_val': 0.324377187321164, 'psi': 0.9379628718347608}
[S4] not sending this round → trigger blocked (psi=0.946)
[S5] START round=35 head_norm_before_train=1.403082 cos_to_last_merge=0.9899 (last merge round=31)
[S5] round=35 local utility u=0.293307 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9858708016642632, 'loss_val': 0.2795804069007978, 'psi': 0.8145406797605207}-{'f1_val': 0.6786018297732571, 'auprc': 0.8540765762024918, 'loss_val': 0.3404982436795977, 'psi': 0.748791728344951}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=35 head_norm_before_train=1.630523 cos_to_last_merge=0.9947 (last merge round=26)
[S6] round=35 local utility u=0.078082 metrics={'f1_val': 0.6992464480250545, 'auprc': 0.9414172680847015, 'loss_val': 0.3011838442612471, 'psi': 0.7961147760489133}-{'f1_val': 0.698593697038735, 'auprc': 0.8950940437250778, 'loss_val': 0.31446172975188, 'psi': 0.7771938357132722}
[S6] not sending this round → trigger blocked (psi=0.796)
[S7] START round=35 head_norm_before_train=1.233706 cos_to_last_merge=0.9868 (last merge round=29)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.4811447981491793, 'auprc': 0.7820310700519323, 'loss_val': 0.9714573046883307, 'psi': 0.6014993069102805}-{'f1_val': 0.6966530660238703, 'auprc': 0.956009088857949, 'loss_val': 0.36373506740534406, 'psi': 0.8003954751575018}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.289359 cos_to_last_merge=0.9981 (last merge round=32)
[S8] round=35 local utility u=0.010451 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9975411313605751, 'loss_val': 0.1215206075590544, 'psi': 0.9968282975056049}-{'f1_val': 0.9962024490124872, 'auprc': 0.9970003967347671, 'loss_val': 0.1398960335579894, 'psi': 0.9965216281013991}
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] START round=35 head_norm_before_train=1.642873 cos_to_last_merge=0.9983 (last merge round=31)
[S9] round=35 local utility u=0.005676 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9981326849694228, 'loss_val': 0.04997237289990231, 'psi': 0.9975148214950548}-{'f1_val': 0.9963223492777684, 'auprc': 0.9981444642376739, 'loss_val': 0.05667668191381884, 'psi': 0.9970511952617307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=35 head_norm_before_train=1.819461 cos_to_last_merge=0.9989 (last merge round=31)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9929767808544108, 'auprc': 0.9927054402758942, 'loss_val': 0.06232605089516591, 'psi': 0.9928682446230042}-{'f1_val': 0.992515759314603, 'auprc': 0.9958413249566769, 'loss_val': 0.06467950560668374, 'psi': 0.9938459855714326}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=2.029598 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9905764381693896, 'auprc': 0.9968456557996492, 'loss_val': 0.0547418549842306, 'psi': 0.9930841252214935}-{'f1_val': 0.9963256330217796, 'auprc': 0.998189553216956, 'loss_val': 0.02929046999795861, 'psi': 0.9970712010998501}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.733155 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5690859563072067, 'auprc': 0.7335938720175701, 'loss_val': 1.0419041189066063, 'psi': 0.634889122591352}-{'f1_val': 0.5950617805745071, 'auprc': 0.6470351540845868, 'loss_val': 0.8278270174431374, 'psi': 0.615851129978539}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.799948 cos_to_last_merge=0.9853 (last merge round=26)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.976947178361538, 'auprc': 0.9988433180220802, 'loss_val': 0.10739642364863804, 'psi': 0.9857056342257549}-{'f1_val': 0.9965574496053289, 'auprc': 0.9954261455178612, 'loss_val': 0.10135000660909986, 'psi': 0.9961049279703418}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.652970 cos_to_last_merge=0.9983 (last merge round=30)
[S15] round=35 local utility u=0.513106 metrics={'f1_val': 0.901122026421372, 'auprc': 0.9951216373829633, 'loss_val': 0.15539419101575092, 'psi': 0.9387218708060086}-{'f1_val': 0.7602126420973625, 'auprc': 0.9852539404484036, 'loss_val': 0.30654677316115897, 'psi': 0.8502291614377789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=35 head_norm_before_train=1.410118 cos_to_last_merge=0.9811 (last merge round=28)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8441388009343509, 'auprc': 0.9951022577892592, 'loss_val': 0.5522604722298484, 'psi': 0.9045241836763143}-{'f1_val': 0.9556605467869826, 'auprc': 0.9971129565783454, 'loss_val': 0.14447796406076918, 'psi': 0.9722415107035277}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=1.348508 cos_to_last_merge=0.9980 (last merge round=31)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.3217472842563904, 'auprc': 0.6776605318553017, 'loss_val': 1.4472738259835964, 'psi': 0.46411258329595495}-{'f1_val': 0.3961174524455702, 'auprc': 0.6803891047672544, 'loss_val': 1.2086109636894429, 'psi': 0.5098261133742439}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.549558 cos_to_last_merge=0.9975 (last merge round=31)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.721921206948114, 'auprc': 0.7554974005342234, 'loss_val': 0.8899134952832272, 'psi': 0.7353516843825578}-{'f1_val': 0.721463273318615, 'auprc': 0.7594173038548417, 'loss_val': 0.8620775116946295, 'psi': 0.7366448855331058}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=2.070353 cos_to_last_merge=0.9993 (last merge round=32)
[S3] round=36 local utility u=0.001803 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.998686208727466, 'loss_val': 0.024846380728635035, 'psi': 0.998143381317945}-{'f1_val': 0.9977814963782642, 'auprc': 0.9985071834634984, 'loss_val': 0.02791623563694351, 'psi': 0.9980717712123579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=36 head_norm_before_train=1.769829 cos_to_last_merge=0.9995 (last merge round=32)
[S4] round=36 local utility u=0.042435 metrics={'f1_val': 0.9437741018930539, 'auprc': 0.9691515559253772, 'loss_val': 0.30892891705076186, 'psi': 0.9539250835059832}-{'f1_val': 0.9406819455957796, 'auprc': 0.9528010246146998, 'loss_val': 0.3261935245445833, 'psi': 0.9455295772033476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=36 head_norm_before_train=1.446469 cos_to_last_merge=0.9852 (last merge round=31)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9265340279805557, 'loss_val': 0.30969261568982726, 'psi': 0.7908059702870377}-{'f1_val': 0.700320598491359, 'auprc': 0.9858708016642632, 'loss_val': 0.2795804069007978, 'psi': 0.8145406797605207}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.642547 cos_to_last_merge=0.9935 (last merge round=26)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.6980048270157403, 'auprc': 0.7665725062524358, 'loss_val': 0.34320478826231093, 'psi': 0.7254318987104185}-{'f1_val': 0.6992464480250545, 'auprc': 0.9414172680847015, 'loss_val': 0.3011838442612471, 'psi': 0.7961147760489133}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.249356 cos_to_last_merge=0.9844 (last merge round=29)
[S7] round=36 local utility u=1.000000 metrics={'f1_val': 0.6828977128548277, 'auprc': 0.8669034442124744, 'loss_val': 0.4290116984790384, 'psi': 0.7565000053978864}-{'f1_val': 0.4811447981491793, 'auprc': 0.7820310700519323, 'loss_val': 0.9714573046883307, 'psi': 0.6014993069102805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=36 head_norm_before_train=1.337265 cos_to_last_merge=0.9953 (last merge round=32)
[S8] round=36 local utility u=0.017229 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.99830719620819, 'loss_val': 0.08936041789427172, 'psi': 0.9971347234446508}-{'f1_val': 0.9963530749356245, 'auprc': 0.9975411313605751, 'loss_val': 0.1215206075590544, 'psi': 0.9968282975056049}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=36 head_norm_before_train=1.660458 cos_to_last_merge=0.9973 (last merge round=31)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9929348022347503, 'auprc': 0.998210684706412, 'loss_val': 0.05087724603813353, 'psi': 0.995045155223415}-{'f1_val': 0.9971029125121428, 'auprc': 0.9981326849694228, 'loss_val': 0.04997237289990231, 'psi': 0.9975148214950548}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.837947 cos_to_last_merge=0.9984 (last merge round=31)
[S10] round=36 local utility u=0.001847 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9927709586894596, 'loss_val': 0.06131455540849725, 'psi': 0.9931429936766785}-{'f1_val': 0.9929767808544108, 'auprc': 0.9927054402758942, 'loss_val': 0.06232605089516591, 'psi': 0.9928682446230042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=36 head_norm_before_train=2.038538 (no previous merge yet)
[S11] round=36 local utility u=0.034301 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9984369466063474, 'loss_val': 0.026860109761255177, 'psi': 0.9973152610262672}-{'f1_val': 0.9905764381693896, 'auprc': 0.9968456557996492, 'loss_val': 0.0547418549842306, 'psi': 0.9930841252214935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=36 head_norm_before_train=1.739043 (no previous merge yet)
[S13] round=36 local utility u=0.153553 metrics={'f1_val': 0.5790404037711201, 'auprc': 0.7127421220416689, 'loss_val': 0.7319696150135917, 'psi': 0.6325210910793396}-{'f1_val': 0.5690859563072067, 'auprc': 0.7335938720175701, 'loss_val': 1.0419041189066063, 'psi': 0.634889122591352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=36 head_norm_before_train=1.816641 cos_to_last_merge=0.9835 (last merge round=26)
[S14] round=36 local utility u=0.074474 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9971827259329689, 'loss_val': 0.07636984640274162, 'psi': 0.9973317206775651}-{'f1_val': 0.976947178361538, 'auprc': 0.9988433180220802, 'loss_val': 0.10739642364863804, 'psi': 0.9857056342257549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=36 head_norm_before_train=1.667616 cos_to_last_merge=0.9976 (last merge round=30)
[S15] round=36 local utility u=0.012607 metrics={'f1_val': 0.9029388142916208, 'auprc': 0.9952879328078714, 'loss_val': 0.14158077902075505, 'psi': 0.9398784616981211}-{'f1_val': 0.901122026421372, 'auprc': 0.9951216373829633, 'loss_val': 0.15539419101575092, 'psi': 0.9387218708060086}
[S15] not sending this round → trigger blocked (psi=0.940)
[S16] START round=36 head_norm_before_train=1.435605 cos_to_last_merge=0.9782 (last merge round=28)
[S16] round=36 local utility u=0.430860 metrics={'f1_val': 0.9308215307192149, 'auprc': 0.9973754163110278, 'loss_val': 0.21745616159097622, 'psi': 0.9574430849559401}-{'f1_val': 0.8441388009343509, 'auprc': 0.9951022577892592, 'loss_val': 0.5522604722298484, 'psi': 0.9045241836763143}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=36 head_norm_before_train=1.367450 cos_to_last_merge=0.9971 (last merge round=31)
[S17] round=36 local utility u=0.834096 metrics={'f1_val': 0.5305959958303579, 'auprc': 0.6786788712471641, 'loss_val': 1.0352298483018736, 'psi': 0.5898291459970804}-{'f1_val': 0.3217472842563904, 'auprc': 0.6776605318553017, 'loss_val': 1.4472738259835964, 'psi': 0.46411258329595495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=37 head_norm_before_train=1.559256 cos_to_last_merge=0.9967 (last merge round=31)
[S2] round=37 local utility u=0.012155 metrics={'f1_val': 0.7217800972669324, 'auprc': 0.759486712054006, 'loss_val': 0.8767247035948638, 'psi': 0.7368627431817618}-{'f1_val': 0.721921206948114, 'auprc': 0.7554974005342234, 'loss_val': 0.8899134952832272, 'psi': 0.7353516843825578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=37 head_norm_before_train=2.082751 cos_to_last_merge=0.9988 (last merge round=32)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9986813200592848, 'loss_val': 0.11707016892107454, 'psi': 0.9758151124450893}-{'f1_val': 0.9977814963782642, 'auprc': 0.998686208727466, 'loss_val': 0.024846380728635035, 'psi': 0.998143381317945}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.777886 cos_to_last_merge=0.9992 (last merge round=32)
[S4] round=37 local utility u=0.022400 metrics={'f1_val': 0.9546904436306751, 'auprc': 0.960073357641188, 'loss_val': 0.3023928970028245, 'psi': 0.9568436092348802}-{'f1_val': 0.9437741018930539, 'auprc': 0.9691515559253772, 'loss_val': 0.30892891705076186, 'psi': 0.9539250835059832}
[S4] not sending this round → trigger blocked (psi=0.957)
[S5] START round=37 head_norm_before_train=1.481489 cos_to_last_merge=0.9812 (last merge round=31)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.5803346641923356, 'auprc': 0.8556941268566227, 'loss_val': 0.5912882452250545, 'psi': 0.6904784492580505}-{'f1_val': 0.700320598491359, 'auprc': 0.9265340279805557, 'loss_val': 0.30969261568982726, 'psi': 0.7908059702870377}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.652765 cos_to_last_merge=0.9923 (last merge round=26)
[S6] round=37 local utility u=0.903432 metrics={'f1_val': 0.9021525629465337, 'auprc': 0.9465772427889363, 'loss_val': 0.3012409919494612, 'psi': 0.9199224348834947}-{'f1_val': 0.6980048270157403, 'auprc': 0.7665725062524358, 'loss_val': 0.34320478826231093, 'psi': 0.7254318987104185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=37 head_norm_before_train=1.260154 cos_to_last_merge=0.9826 (last merge round=29)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5853488395736461, 'auprc': 0.7998165479268446, 'loss_val': 0.670795167832094, 'psi': 0.6711359229149256}-{'f1_val': 0.6828977128548277, 'auprc': 0.8669034442124744, 'loss_val': 0.4290116984790384, 'psi': 0.7565000053978864}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.389090 cos_to_last_merge=0.9914 (last merge round=32)
[S8] round=37 local utility u=0.009568 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9989274338768576, 'loss_val': 0.07290406233472349, 'psi': 0.997464639112148}-{'f1_val': 0.9963530749356245, 'auprc': 0.99830719620819, 'loss_val': 0.08936041789427172, 'psi': 0.9971347234446508}
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] START round=37 head_norm_before_train=1.678973 cos_to_last_merge=0.9960 (last merge round=31)
[S9] round=37 local utility u=0.017657 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9983451226715725, 'loss_val': 0.04097510492089507, 'psi': 0.9975997965759147}-{'f1_val': 0.9929348022347503, 'auprc': 0.998210684706412, 'loss_val': 0.05087724603813353, 'psi': 0.995045155223415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=37 head_norm_before_train=1.853800 cos_to_last_merge=0.9979 (last merge round=31)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9936100131187782, 'auprc': 0.9926379550880124, 'loss_val': 0.06626102373109298, 'psi': 0.9932211899064718}-{'f1_val': 0.993391017001491, 'auprc': 0.9927709586894596, 'loss_val': 0.06131455540849725, 'psi': 0.9931429936766785}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=2.049173 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983529181799928, 'loss_val': 0.028647013605206037, 'psi': 0.9972816496557253}-{'f1_val': 0.996567470639547, 'auprc': 0.9984369466063474, 'loss_val': 0.026860109761255177, 'psi': 0.9973152610262672}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.742383 (no previous merge yet)
[S13] round=37 local utility u=0.089375 metrics={'f1_val': 0.605447641898992, 'auprc': 0.7072759775962031, 'loss_val': 0.6952644967620568, 'psi': 0.6461789761778765}-{'f1_val': 0.5790404037711201, 'auprc': 0.7127421220416689, 'loss_val': 0.7319696150135917, 'psi': 0.6325210910793396}
[S13] not sending this round → trigger blocked (psi=0.646)
[S14] START round=37 head_norm_before_train=1.833457 cos_to_last_merge=0.9817 (last merge round=26)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9968002980424979, 'auprc': 0.9954718011851962, 'loss_val': 0.07083019868709611, 'psi': 0.9962688992995772}-{'f1_val': 0.9974310505072961, 'auprc': 0.9971827259329689, 'loss_val': 0.07636984640274162, 'psi': 0.9973317206775651}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.684456 cos_to_last_merge=0.9968 (last merge round=30)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.8387905898720228, 'auprc': 0.9926921652752726, 'loss_val': 0.22240874537567534, 'psi': 0.9003512200333227}-{'f1_val': 0.9029388142916208, 'auprc': 0.9952879328078714, 'loss_val': 0.14158077902075505, 'psi': 0.9398784616981211}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.457785 cos_to_last_merge=0.9757 (last merge round=28)
[S16] round=37 local utility u=0.044422 metrics={'f1_val': 0.9389400354295572, 'auprc': 0.9974510951451743, 'loss_val': 0.17754964268362422, 'psi': 0.962344459315804}-{'f1_val': 0.9308215307192149, 'auprc': 0.9973754163110278, 'loss_val': 0.21745616159097622, 'psi': 0.9574430849559401}
[S16] not sending this round → trigger blocked (psi=0.962)
[S17] START round=37 head_norm_before_train=1.389385 cos_to_last_merge=0.9959 (last merge round=31)
[S17] round=37 local utility u=0.354646 metrics={'f1_val': 0.5842968797414597, 'auprc': 0.76489249557273, 'loss_val': 0.906784170009259, 'psi': 0.6565351260739678}-{'f1_val': 0.5305959958303579, 'auprc': 0.6786788712471641, 'loss_val': 1.0352298483018736, 'psi': 0.5898291459970804}
[S17] not sending this round → trigger blocked (psi=0.657)
[S2] START round=38 head_norm_before_train=1.570545 cos_to_last_merge=0.9957 (last merge round=31)
[S2] round=38 local utility u=0.016864 metrics={'f1_val': 0.7199414606955167, 'auprc': 0.7585497557721963, 'loss_val': 0.8291546443118308, 'psi': 0.7353847787261886}-{'f1_val': 0.7217800972669324, 'auprc': 0.759486712054006, 'loss_val': 0.8767247035948638, 'psi': 0.7368627431817618}
[S2] not sending this round → trigger blocked (psi=0.735)
[S3] START round=38 head_norm_before_train=2.093970 cos_to_last_merge=0.9982 (last merge round=32)
[S3] round=38 local utility u=0.157290 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9985008935581845, 'loss_val': 0.022912274360524846, 'psi': 0.9978392988909083}-{'f1_val': 0.9605709740356257, 'auprc': 0.9986813200592848, 'loss_val': 0.11707016892107454, 'psi': 0.9758151124450893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=38 head_norm_before_train=1.784929 cos_to_last_merge=0.9988 (last merge round=32)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9466763233001206, 'auprc': 0.9498627322642047, 'loss_val': 0.3106691423252794, 'psi': 0.9479508868857542}-{'f1_val': 0.9546904436306751, 'auprc': 0.960073357641188, 'loss_val': 0.3023928970028245, 'psi': 0.9568436092348802}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.503404 cos_to_last_merge=0.9786 (last merge round=31)
[S5] round=38 local utility u=0.751052 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9933376175189628, 'loss_val': 0.22202994633508338, 'psi': 0.8175274061024005}-{'f1_val': 0.5803346641923356, 'auprc': 0.8556941268566227, 'loss_val': 0.5912882452250545, 'psi': 0.6904784492580505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=38 head_norm_before_train=1.659896 cos_to_last_merge=0.9914 (last merge round=26)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.6992806886936324, 'auprc': 0.8380626788671931, 'loss_val': 0.31245629165016797, 'psi': 0.7547934847630566}-{'f1_val': 0.9021525629465337, 'auprc': 0.9465772427889363, 'loss_val': 0.3012409919494612, 'psi': 0.9199224348834947}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.269519 cos_to_last_merge=0.9811 (last merge round=29)
[S7] round=38 local utility u=0.007431 metrics={'f1_val': 0.5894487727020974, 'auprc': 0.7960895998702322, 'loss_val': 0.6693509257265102, 'psi': 0.6721051035693513}-{'f1_val': 0.5853488395736461, 'auprc': 0.7998165479268446, 'loss_val': 0.670795167832094, 'psi': 0.6711359229149256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=38 head_norm_before_train=1.433870 cos_to_last_merge=0.9874 (last merge round=32)
[S8] round=38 local utility u=0.002889 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.9971789683229618, 'loss_val': 0.06277963541165382, 'psi': 0.9968552355931819}-{'f1_val': 0.9964894426023416, 'auprc': 0.9989274338768576, 'loss_val': 0.07290406233472349, 'psi': 0.997464639112148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=38 head_norm_before_train=1.696112 cos_to_last_merge=0.9949 (last merge round=31)
[S9] round=38 local utility u=0.000092 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9983671223098747, 'loss_val': 0.03839386502310009, 'psi': 0.9973623436828072}-{'f1_val': 0.9971029125121428, 'auprc': 0.9983451226715725, 'loss_val': 0.04097510492089507, 'psi': 0.9975997965759147}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=38 head_norm_before_train=1.869273 cos_to_last_merge=0.9974 (last merge round=31)
[S10] round=38 local utility u=0.005749 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9938730224629084, 'loss_val': 0.05584163006488752, 'psi': 0.9934524652910932}-{'f1_val': 0.9936100131187782, 'auprc': 0.9926379550880124, 'loss_val': 0.06626102373109298, 'psi': 0.9932211899064718}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=38 head_norm_before_train=2.060464 (no previous merge yet)
[S11] round=38 local utility u=0.001504 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982090895534044, 'loss_val': 0.025207074386996327, 'psi': 0.99722411820509}-{'f1_val': 0.996567470639547, 'auprc': 0.9983529181799928, 'loss_val': 0.028647013605206037, 'psi': 0.9972816496557253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=38 head_norm_before_train=1.746489 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5669410694241689, 'auprc': 0.733184426476212, 'loss_val': 0.8482034607663755, 'psi': 0.6334384122449861}-{'f1_val': 0.605447641898992, 'auprc': 0.7072759775962031, 'loss_val': 0.6952644967620568, 'psi': 0.6461789761778765}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.849007 cos_to_last_merge=0.9801 (last merge round=26)
[S14] round=38 local utility u=0.010397 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9989096665675031, 'loss_val': 0.06545537902985496, 'psi': 0.9981545374569134}-{'f1_val': 0.9968002980424979, 'auprc': 0.9954718011851962, 'loss_val': 0.07083019868709611, 'psi': 0.9962688992995772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=38 head_norm_before_train=1.702474 cos_to_last_merge=0.9959 (last merge round=30)
[S15] round=38 local utility u=0.022097 metrics={'f1_val': 0.8425995208044093, 'auprc': 0.9919286913656189, 'loss_val': 0.19877741393834567, 'psi': 0.9023311890288931}-{'f1_val': 0.8387905898720228, 'auprc': 0.9926921652752726, 'loss_val': 0.22240874537567534, 'psi': 0.9003512200333227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=38 head_norm_before_train=1.477073 cos_to_last_merge=0.9734 (last merge round=28)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9097387600138089, 'auprc': 0.9931929910270587, 'loss_val': 0.30818730417011514, 'psi': 0.9431204524191088}-{'f1_val': 0.9389400354295572, 'auprc': 0.9974510951451743, 'loss_val': 0.17754964268362422, 'psi': 0.962344459315804}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.407940 cos_to_last_merge=0.9948 (last merge round=31)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.3333893982812155, 'auprc': 0.6310025516137913, 'loss_val': 1.4019602311496813, 'psi': 0.4524346596142458}-{'f1_val': 0.5842968797414597, 'auprc': 0.76489249557273, 'loss_val': 0.906784170009259, 'psi': 0.6565351260739678}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.583540 cos_to_last_merge=0.9946 (last merge round=31)
[S2] round=39 local utility u=0.002236 metrics={'f1_val': 0.7213099565943742, 'auprc': 0.7637824433492557, 'loss_val': 0.8485923008533076, 'psi': 0.7382989512963268}-{'f1_val': 0.7199414606955167, 'auprc': 0.7585497557721963, 'loss_val': 0.8291546443118308, 'psi': 0.7353847787261886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S2] r=40 psi=0.738 u=0.0022 p_local=0.0888 f1=0.721 auprc=0.764 bytes=37743
[S3] START round=39 head_norm_before_train=2.105863 cos_to_last_merge=0.9977 (last merge round=32)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9966508675148381, 'auprc': 0.9986699886606094, 'loss_val': 0.04180485416595974, 'psi': 0.9974585159731466}-{'f1_val': 0.9973982357793907, 'auprc': 0.9985008935581845, 'loss_val': 0.022912274360524846, 'psi': 0.9978392988909083}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.997 u=0.0000 p_local=0.0640 f1=0.997 auprc=0.999 bytes=44971
[S4] START round=39 head_norm_before_train=1.789174 cos_to_last_merge=0.9986 (last merge round=32)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9386816774936052, 'auprc': 0.9204973414762316, 'loss_val': 0.33498335474154567, 'psi': 0.9314079430866558}-{'f1_val': 0.9466763233001206, 'auprc': 0.9498627322642047, 'loss_val': 0.3106691423252794, 'psi': 0.9479508868857542}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.931 u=0.0000 p_local=0.0164 f1=0.939 auprc=0.920 bytes=37703
[S5] START round=39 head_norm_before_train=1.520728 cos_to_last_merge=0.9765 (last merge round=31)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.6192523196524751, 'auprc': 0.8603192401821786, 'loss_val': 0.48991559356584363, 'psi': 0.7156790878643565}-{'f1_val': 0.700320598491359, 'auprc': 0.9933376175189628, 'loss_val': 0.22202994633508338, 'psi': 0.8175274061024005}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.716 u=0.0000 p_local=0.1757 f1=0.619 auprc=0.860 bytes=41337
[S6] START round=39 head_norm_before_train=1.666501 cos_to_last_merge=0.9908 (last merge round=26)
[S6] round=39 local utility u=0.190028 metrics={'f1_val': 0.6994970433107301, 'auprc': 0.9510489698460963, 'loss_val': 0.27265701255856906, 'psi': 0.8001178139248766}-{'f1_val': 0.6992806886936324, 'auprc': 0.8380626788671931, 'loss_val': 0.31245629165016797, 'psi': 0.7547934847630566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S6] r=40 psi=0.800 u=0.1900 p_local=0.2016 f1=0.699 auprc=0.951 bytes=43175
[S7] START round=39 head_norm_before_train=1.281357 cos_to_last_merge=0.9789 (last merge round=29)
[S7] round=39 local utility u=0.485448 metrics={'f1_val': 0.6821746285837246, 'auprc': 0.8505710189884916, 'loss_val': 0.4182550433997623, 'psi': 0.7495331847456315}-{'f1_val': 0.5894487727020974, 'auprc': 0.7960895998702322, 'loss_val': 0.6693509257265102, 'psi': 0.6721051035693513}
[S7] not sending this round → trigger blocked (psi=0.750)
[S7] r=40 psi=0.750 u=0.4854 p_local=0.2906 f1=0.682 auprc=0.851 bytes=43110
[S8] START round=39 head_norm_before_train=1.473148 cos_to_last_merge=0.9838 (last merge round=32)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9412651067302649, 'auprc': 0.9928000324035589, 'loss_val': 0.1199536893105391, 'psi': 0.9618790769995824}-{'f1_val': 0.9966394137733288, 'auprc': 0.9971789683229618, 'loss_val': 0.06277963541165382, 'psi': 0.9968552355931819}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.962 u=0.0000 p_local=0.0121 f1=0.941 auprc=0.993 bytes=52150
[S9] START round=39 head_norm_before_train=1.712558 cos_to_last_merge=0.9938 (last merge round=31)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9958557717480525, 'auprc': 0.9983616397883435, 'loss_val': 0.03881625876396579, 'psi': 0.9968581189641689}-{'f1_val': 0.9966924912647621, 'auprc': 0.9983671223098747, 'loss_val': 0.03839386502310009, 'psi': 0.9973623436828072}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.997 u=0.0000 p_local=0.0194 f1=0.996 auprc=0.998 bytes=43176
[S10] START round=39 head_norm_before_train=1.882583 cos_to_last_merge=0.9968 (last merge round=31)
[S10] round=39 local utility u=0.002277 metrics={'f1_val': 0.9920785626156365, 'auprc': 0.9964884069437163, 'loss_val': 0.052572652196887684, 'psi': 0.9938425003468684}-{'f1_val': 0.9931720938432163, 'auprc': 0.9938730224629084, 'loss_val': 0.05584163006488752, 'psi': 0.9934524652910932}
[S10] not sending this round → trigger blocked (psi=0.994)
[S10] r=40 psi=0.994 u=0.0023 p_local=0.0075 f1=0.992 auprc=0.996 bytes=48476
[S11] START round=39 head_norm_before_train=2.071036 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9981855058612747, 'loss_val': 0.025372046520370638, 'psi': 0.9970695821575777}-{'f1_val': 0.996567470639547, 'auprc': 0.9982090895534044, 'loss_val': 0.025207074386996327, 'psi': 0.99722411820509}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.997 u=0.0000 p_local=0.0213 f1=0.996 auprc=0.998 bytes=50364
[S13] START round=39 head_norm_before_train=1.746658 (no previous merge yet)
[S13] round=39 local utility u=0.196007 metrics={'f1_val': 0.6033742067524325, 'auprc': 0.7447884268447718, 'loss_val': 0.7095994592020942, 'psi': 0.6599398947893682}-{'f1_val': 0.5669410694241689, 'auprc': 0.733184426476212, 'loss_val': 0.8482034607663755, 'psi': 0.6334384122449861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S13] r=40 psi=0.660 u=0.1960 p_local=0.0943 f1=0.603 auprc=0.745 bytes=39651
[S14] START round=39 head_norm_before_train=1.864325 cos_to_last_merge=0.9785 (last merge round=26)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9971517897407616, 'loss_val': 0.058190247129483175, 'psi': 0.9969271804677664}-{'f1_val': 0.9976511180498535, 'auprc': 0.9989096665675031, 'loss_val': 0.06545537902985496, 'psi': 0.9981545374569134}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.997 u=0.0000 p_local=0.0248 f1=0.997 auprc=0.997 bytes=52099
[S15] START round=39 head_norm_before_train=1.719872 cos_to_last_merge=0.9951 (last merge round=30)
[S15] round=39 local utility u=0.543472 metrics={'f1_val': 0.9966196520233872, 'auprc': 0.9970625078810695, 'loss_val': 0.0513550218337606, 'psi': 0.9967967943664602}-{'f1_val': 0.8425995208044093, 'auprc': 0.9919286913656189, 'loss_val': 0.19877741393834567, 'psi': 0.9023311890288931}
[S15] not sending this round → trigger blocked (psi=0.997)
[S15] r=40 psi=0.997 u=0.5435 p_local=0.1976 f1=0.997 auprc=0.997 bytes=46792
[S16] START round=39 head_norm_before_train=1.495909 cos_to_last_merge=0.9711 (last merge round=28)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8330459403685779, 'auprc': 0.9867191233382926, 'loss_val': 0.766983043922747, 'psi': 0.8945152135564638}-{'f1_val': 0.9097387600138089, 'auprc': 0.9931929910270587, 'loss_val': 0.30818730417011514, 'psi': 0.9431204524191088}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.895 u=0.0000 p_local=0.0887 f1=0.833 auprc=0.987 bytes=37727
[S17] START round=39 head_norm_before_train=1.424263 cos_to_last_merge=0.9937 (last merge round=31)
[S17] round=39 local utility u=1.000000 metrics={'f1_val': 0.5747846326777875, 'auprc': 0.8123465458413208, 'loss_val': 1.0036974754853276, 'psi': 0.6698093979432008}-{'f1_val': 0.3333893982812155, 'auprc': 0.6310025516137913, 'loss_val': 1.4019602311496813, 'psi': 0.4524346596142458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S17] r=40 psi=0.670 u=1.0000 p_local=0.3813 f1=0.575 auprc=0.812 bytes=34137
[S2] START round=40 head_norm_before_train=1.596226 cos_to_last_merge=0.9935 (last merge round=31)
[S2] round=40 local utility u=0.001646 metrics={'f1_val': 0.7201865171129068, 'auprc': 0.7641008882321285, 'loss_val': 0.8395150171668251, 'psi': 0.7377522655605955}-{'f1_val': 0.7213099565943742, 'auprc': 0.7637824433492557, 'loss_val': 0.8485923008533076, 'psi': 0.7382989512963268}
[S2] not sending this round → trigger blocked (psi=0.738)
[S3] START round=40 head_norm_before_train=2.115668 cos_to_last_merge=0.9970 (last merge round=32)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9422081688604084, 'auprc': 0.9986647060086808, 'loss_val': 0.1376507456657051, 'psi': 0.9647907837197174}-{'f1_val': 0.9966508675148381, 'auprc': 0.9986699886606094, 'loss_val': 0.04180485416595974, 'psi': 0.9974585159731466}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.787067 cos_to_last_merge=0.9984 (last merge round=32)
[S4] round=40 local utility u=0.009008 metrics={'f1_val': 0.9403000434034657, 'auprc': 0.9185609952468504, 'loss_val': 0.3208693479295782, 'psi': 0.9316044241408196}-{'f1_val': 0.9386816774936052, 'auprc': 0.9204973414762316, 'loss_val': 0.33498335474154567, 'psi': 0.9314079430866558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=40 head_norm_before_train=1.533041 cos_to_last_merge=0.9750 (last merge round=31)
[S5] round=40 local utility u=0.439506 metrics={'f1_val': 0.6713145089341879, 'auprc': 0.9725409312188293, 'loss_val': 0.25994208394233564, 'psi': 0.7918050778480444}-{'f1_val': 0.6192523196524751, 'auprc': 0.8603192401821786, 'loss_val': 0.48991559356584363, 'psi': 0.7156790878643565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=40 head_norm_before_train=1.673657 cos_to_last_merge=0.9903 (last merge round=26)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.6994970433107301, 'auprc': 0.9493454694036206, 'loss_val': 0.27222184554088075, 'psi': 0.7994364137478864}-{'f1_val': 0.6994970433107301, 'auprc': 0.9510489698460963, 'loss_val': 0.27265701255856906, 'psi': 0.8001178139248766}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.292758 cos_to_last_merge=0.9772 (last merge round=29)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5435953184641068, 'auprc': 0.7916942690155313, 'loss_val': 0.8395165264991037, 'psi': 0.6428348986846766}-{'f1_val': 0.6821746285837246, 'auprc': 0.8505710189884916, 'loss_val': 0.4182550433997623, 'psi': 0.7495331847456315}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.500802 cos_to_last_merge=0.9809 (last merge round=32)
[S8] round=40 local utility u=0.199209 metrics={'f1_val': 0.9963525581780791, 'auprc': 0.996844538379813, 'loss_val': 0.06419383918568163, 'psi': 0.9965493502587727}-{'f1_val': 0.9412651067302649, 'auprc': 0.9928000324035589, 'loss_val': 0.1199536893105391, 'psi': 0.9618790769995824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=40 head_norm_before_train=1.724250 cos_to_last_merge=0.9930 (last merge round=31)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.7972621242875049, 'auprc': 0.9982907475930561, 'loss_val': 0.22872148894692293, 'psi': 0.8776735736097254}-{'f1_val': 0.9958557717480525, 'auprc': 0.9983616397883435, 'loss_val': 0.03881625876396579, 'psi': 0.9968581189641689}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.897835 cos_to_last_merge=0.9962 (last merge round=31)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9938290824763921, 'auprc': 0.9928026086836287, 'loss_val': 0.05307797685089904, 'psi': 0.9934184929592869}-{'f1_val': 0.9920785626156365, 'auprc': 0.9964884069437163, 'loss_val': 0.052572652196887684, 'psi': 0.9938425003468684}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=2.080197 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9767250488621002, 'auprc': 0.9966383047069992, 'loss_val': 0.0785434131974074, 'psi': 0.9846903512000599}-{'f1_val': 0.9963256330217796, 'auprc': 0.9981855058612747, 'loss_val': 0.025372046520370638, 'psi': 0.9970695821575777}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.751023 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.5959530784574807, 'auprc': 0.7000739957402056, 'loss_val': 0.9595814068384549, 'psi': 0.6376014453705707}-{'f1_val': 0.6033742067524325, 'auprc': 0.7447884268447718, 'loss_val': 0.7095994592020942, 'psi': 0.6599398947893682}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.877230 cos_to_last_merge=0.9772 (last merge round=26)
[S14] round=40 local utility u=0.001371 metrics={'f1_val': 0.9968002980424979, 'auprc': 0.997378564597762, 'loss_val': 0.05626589080727145, 'psi': 0.9970316046646035}-{'f1_val': 0.9967774409524363, 'auprc': 0.9971517897407616, 'loss_val': 0.058190247129483175, 'psi': 0.9969271804677664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=40 head_norm_before_train=1.733979 cos_to_last_merge=0.9943 (last merge round=30)
[S15] round=40 local utility u=0.004710 metrics={'f1_val': 0.9966196520233872, 'auprc': 0.9972182590472217, 'loss_val': 0.04240322778117298, 'psi': 0.996859094832921}-{'f1_val': 0.9966196520233872, 'auprc': 0.9970625078810695, 'loss_val': 0.0513550218337606, 'psi': 0.9967967943664602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=40 head_norm_before_train=1.512690 cos_to_last_merge=0.9693 (last merge round=28)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.7587321073664753, 'auprc': 0.9173989152545479, 'loss_val': 0.8456087348215474, 'psi': 0.8221988305217043}-{'f1_val': 0.8330459403685779, 'auprc': 0.9867191233382926, 'loss_val': 0.766983043922747, 'psi': 0.8945152135564638}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.438655 cos_to_last_merge=0.9927 (last merge round=31)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.3129742964522032, 'auprc': 0.62009250990794, 'loss_val': 1.7759071769664967, 'psi': 0.43582158183449793}-{'f1_val': 0.5747846326777875, 'auprc': 0.8123465458413208, 'loss_val': 1.0036974754853276, 'psi': 0.6698093979432008}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.608316 cos_to_last_merge=0.9924 (last merge round=31)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.6001141504533634, 'auprc': 0.7442126808799395, 'loss_val': 1.224000687521726, 'psi': 0.6577535626239939}-{'f1_val': 0.7201865171129068, 'auprc': 0.7641008882321285, 'loss_val': 0.8395150171668251, 'psi': 0.7377522655605955}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.124687 cos_to_last_merge=0.9965 (last merge round=32)
[S3] round=41 local utility u=0.060540 metrics={'f1_val': 0.9588275782550102, 'auprc': 0.9986511891533338, 'loss_val': 0.11624716784742067, 'psi': 0.9747570226143397}-{'f1_val': 0.9422081688604084, 'auprc': 0.9986647060086808, 'loss_val': 0.1376507456657051, 'psi': 0.9647907837197174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=41 head_norm_before_train=1.780943 cos_to_last_merge=0.9981 (last merge round=32)
[S4] round=41 local utility u=0.088066 metrics={'f1_val': 0.9559697320833139, 'auprc': 0.9477740217676975, 'loss_val': 0.326394499213562, 'psi': 0.9526914479570674}-{'f1_val': 0.9403000434034657, 'auprc': 0.9185609952468504, 'loss_val': 0.3208693479295782, 'psi': 0.9316044241408196}
[S4] not sending this round → trigger blocked (psi=0.953)
[S5] START round=41 head_norm_before_train=1.543618 cos_to_last_merge=0.9738 (last merge round=31)
[S5] round=41 local utility u=0.131285 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.9864810551425677, 'loss_val': 0.21471581374628515, 'psi': 0.8149335280598181}-{'f1_val': 0.6713145089341879, 'auprc': 0.9725409312188293, 'loss_val': 0.25994208394233564, 'psi': 0.7918050778480444}
[S5] not sending this round → trigger blocked (psi=0.815)
[S6] START round=41 head_norm_before_train=1.682119 cos_to_last_merge=0.9898 (last merge round=26)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.7038100792885498, 'auprc': 0.9412545555676889, 'loss_val': 0.2879107917261244, 'psi': 0.7987878698002054}-{'f1_val': 0.6994970433107301, 'auprc': 0.9493454694036206, 'loss_val': 0.27222184554088075, 'psi': 0.7994364137478864}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.304472 cos_to_last_merge=0.9758 (last merge round=29)
[S7] round=41 local utility u=0.393744 metrics={'f1_val': 0.6268172089360884, 'auprc': 0.8072716342285693, 'loss_val': 0.5980928527796867, 'psi': 0.6989989790530808}-{'f1_val': 0.5435953184641068, 'auprc': 0.7916942690155313, 'loss_val': 0.8395165264991037, 'psi': 0.6428348986846766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=41 head_norm_before_train=1.521522 cos_to_last_merge=0.9787 (last merge round=32)
[S8] round=41 local utility u=0.004190 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9973253872193734, 'loss_val': 0.056360001212193325, 'psi': 0.996652016927841}-{'f1_val': 0.9963525581780791, 'auprc': 0.996844538379813, 'loss_val': 0.06419383918568163, 'psi': 0.9965493502587727}
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] START round=41 head_norm_before_train=1.733719 cos_to_last_merge=0.9923 (last merge round=31)
[S9] round=41 local utility u=0.695425 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9983702169134718, 'loss_val': 0.0346928834140753, 'psi': 0.9973635815242461}-{'f1_val': 0.7972621242875049, 'auprc': 0.9982907475930561, 'loss_val': 0.22872148894692293, 'psi': 0.8776735736097254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=41 head_norm_before_train=1.911407 cos_to_last_merge=0.9956 (last merge round=31)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9840725944548027, 'auprc': 0.9926889063780111, 'loss_val': 0.09080344241933222, 'psi': 0.9875191192240861}-{'f1_val': 0.9938290824763921, 'auprc': 0.9928026086836287, 'loss_val': 0.05307797685089904, 'psi': 0.9934184929592869}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=2.086582 (no previous merge yet)
[S11] round=41 local utility u=0.088873 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982391730784309, 'loss_val': 0.02465508161145213, 'psi': 0.9972361516151006}-{'f1_val': 0.9767250488621002, 'auprc': 0.9966383047069992, 'loss_val': 0.0785434131974074, 'psi': 0.9846903512000599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=41 head_norm_before_train=1.762577 (no previous merge yet)
[S13] round=41 local utility u=0.087068 metrics={'f1_val': 0.6331649300307556, 'auprc': 0.6515597858552149, 'loss_val': 0.863173608625009, 'psi': 0.6405228723605394}-{'f1_val': 0.5959530784574807, 'auprc': 0.7000739957402056, 'loss_val': 0.9595814068384549, 'psi': 0.6376014453705707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=41 head_norm_before_train=1.888699 cos_to_last_merge=0.9761 (last merge round=26)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9733848043811515, 'auprc': 0.9972405218045218, 'loss_val': 0.07867522783928829, 'psi': 0.9829270913504996}-{'f1_val': 0.9968002980424979, 'auprc': 0.997378564597762, 'loss_val': 0.05626589080727145, 'psi': 0.9970316046646035}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.748826 cos_to_last_merge=0.9935 (last merge round=30)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.7245312773815509, 'auprc': 0.9880362774840263, 'loss_val': 0.3361469101860442, 'psi': 0.8299332774225411}-{'f1_val': 0.9966196520233872, 'auprc': 0.9972182590472217, 'loss_val': 0.04240322778117298, 'psi': 0.996859094832921}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.525832 cos_to_last_merge=0.9677 (last merge round=28)
[S16] round=41 local utility u=0.923062 metrics={'f1_val': 0.9343031633652203, 'auprc': 0.989184946492646, 'loss_val': 0.26826834444149783, 'psi': 0.9562558766161906}-{'f1_val': 0.7587321073664753, 'auprc': 0.9173989152545479, 'loss_val': 0.8456087348215474, 'psi': 0.8221988305217043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=41 head_norm_before_train=1.454892 cos_to_last_merge=0.9915 (last merge round=31)
[S17] round=41 local utility u=0.297862 metrics={'f1_val': 0.37847984487642705, 'auprc': 0.6450149785182064, 'loss_val': 1.6479844514804474, 'psi': 0.4850938983331388}-{'f1_val': 0.3129742964522032, 'auprc': 0.62009250990794, 'loss_val': 1.7759071769664967, 'psi': 0.43582158183449793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S2] START round=42 head_norm_before_train=1.619340 cos_to_last_merge=0.9914 (last merge round=31)
[S2] round=42 local utility u=0.319679 metrics={'f1_val': 0.6511355033890499, 'auprc': 0.765774493426262, 'loss_val': 0.9554556487273093, 'psi': 0.6969910994039348}-{'f1_val': 0.6001141504533634, 'auprc': 0.7442126808799395, 'loss_val': 1.224000687521726, 'psi': 0.6577535626239939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=42 head_norm_before_train=2.135195 cos_to_last_merge=0.9961 (last merge round=32)
[S3] round=42 local utility u=0.151475 metrics={'f1_val': 0.9966508675148381, 'auprc': 0.9984851145649796, 'loss_val': 0.039739231839877924, 'psi': 0.9973845663348948}-{'f1_val': 0.9588275782550102, 'auprc': 0.9986511891533338, 'loss_val': 0.11624716784742067, 'psi': 0.9747570226143397}
[S3] not sending this round → trigger blocked (psi=0.997)
[S4] START round=42 head_norm_before_train=1.775410 cos_to_last_merge=0.9974 (last merge round=32)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9422059817162424, 'auprc': 0.95632251788791, 'loss_val': 0.3107552388974435, 'psi': 0.9478525961849095}-{'f1_val': 0.9559697320833139, 'auprc': 0.9477740217676975, 'loss_val': 0.326394499213562, 'psi': 0.9526914479570674}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.553103 cos_to_last_merge=0.9727 (last merge round=31)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.6719826665454214, 'auprc': 0.910778506166535, 'loss_val': 0.3322943201281139, 'psi': 0.7675010023938669}-{'f1_val': 0.7005685100046517, 'auprc': 0.9864810551425677, 'loss_val': 0.21471581374628515, 'psi': 0.8149335280598181}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.690833 cos_to_last_merge=0.9887 (last merge round=26)
[S6] round=42 local utility u=0.551272 metrics={'f1_val': 0.8826603161931492, 'auprc': 0.9466733428921252, 'loss_val': 0.2747239793801771, 'psi': 0.9082655268727396}-{'f1_val': 0.7038100792885498, 'auprc': 0.9412545555676889, 'loss_val': 0.2879107917261244, 'psi': 0.7987878698002054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=42 head_norm_before_train=1.314059 cos_to_last_merge=0.9746 (last merge round=29)
[S7] round=42 local utility u=0.083516 metrics={'f1_val': 0.6448800306843885, 'auprc': 0.8083806248505727, 'loss_val': 0.5427649710875895, 'psi': 0.7102802683508622}-{'f1_val': 0.6268172089360884, 'auprc': 0.8072716342285693, 'loss_val': 0.5980928527796867, 'psi': 0.6989989790530808}
[S7] not sending this round → trigger blocked (psi=0.710)
[S8] START round=42 head_norm_before_train=1.543492 cos_to_last_merge=0.9764 (last merge round=32)
[S8] round=42 local utility u=0.006601 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9988257905213284, 'loss_val': 0.04855986612437539, 'psi': 0.997342161169906}-{'f1_val': 0.9962031034001528, 'auprc': 0.9973253872193734, 'loss_val': 0.056360001212193325, 'psi': 0.996652016927841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=42 head_norm_before_train=1.741029 cos_to_last_merge=0.9918 (last merge round=31)
[S9] round=42 local utility u=0.000657 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9983674190378347, 'loss_val': 0.03337078093034746, 'psi': 0.9973624623739912}-{'f1_val': 0.9966924912647621, 'auprc': 0.9983702169134718, 'loss_val': 0.0346928834140753, 'psi': 0.9973635815242461}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=42 head_norm_before_train=1.923034 cos_to_last_merge=0.9949 (last merge round=31)
[S10] round=42 local utility u=0.018713 metrics={'f1_val': 0.9889892007540583, 'auprc': 0.9926965141702153, 'loss_val': 0.0829007843067642, 'psi': 0.9904721261205212}-{'f1_val': 0.9840725944548027, 'auprc': 0.9926889063780111, 'loss_val': 0.09080344241933222, 'psi': 0.9875191192240861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=42 head_norm_before_train=2.094346 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982341101856552, 'loss_val': 0.024752289514557334, 'psi': 0.9972341264579903}-{'f1_val': 0.996567470639547, 'auprc': 0.9982391730784309, 'loss_val': 0.02465508161145213, 'psi': 0.9972361516151006}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.773214 (no previous merge yet)
[S13] round=42 local utility u=0.053224 metrics={'f1_val': 0.6381642062318803, 'auprc': 0.654805816259987, 'loss_val': 0.7964592530785363, 'psi': 0.644820850243123}-{'f1_val': 0.6331649300307556, 'auprc': 0.6515597858552149, 'loss_val': 0.863173608625009, 'psi': 0.6405228723605394}
[S13] not sending this round → trigger blocked (psi=0.645)
[S14] START round=42 head_norm_before_train=1.900865 cos_to_last_merge=0.9750 (last merge round=26)
[S14] round=42 local utility u=0.088679 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9989261891220633, 'loss_val': 0.051971385566539845, 'psi': 0.9981611464787374}-{'f1_val': 0.9733848043811515, 'auprc': 0.9972405218045218, 'loss_val': 0.07867522783928829, 'psi': 0.9829270913504996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=42 head_norm_before_train=1.763206 cos_to_last_merge=0.9927 (last merge round=30)
[S15] round=42 local utility u=0.981182 metrics={'f1_val': 0.9963989292454516, 'auprc': 0.998634685347538, 'loss_val': 0.03678357399766629, 'psi': 0.9972932316862861}-{'f1_val': 0.7245312773815509, 'auprc': 0.9880362774840263, 'loss_val': 0.3361469101860442, 'psi': 0.8299332774225411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=42 head_norm_before_train=1.538536 cos_to_last_merge=0.9661 (last merge round=28)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.855401218441703, 'auprc': 0.9799219940713959, 'loss_val': 0.6630170682969009, 'psi': 0.9052095286935802}-{'f1_val': 0.9343031633652203, 'auprc': 0.989184946492646, 'loss_val': 0.26826834444149783, 'psi': 0.9562558766161906}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.470441 cos_to_last_merge=0.9903 (last merge round=31)
[S17] round=42 local utility u=1.000000 metrics={'f1_val': 0.6076054686677368, 'auprc': 0.7687838993104207, 'loss_val': 0.9933209429388392, 'psi': 0.6720768409248103}-{'f1_val': 0.37847984487642705, 'auprc': 0.6450149785182064, 'loss_val': 1.6479844514804474, 'psi': 0.4850938983331388}
[S17] not sending this round → trigger blocked (psi=0.672)
[S2] START round=43 head_norm_before_train=1.631435 cos_to_last_merge=0.9902 (last merge round=31)
[S2] round=43 local utility u=0.375254 metrics={'f1_val': 0.7120489742797297, 'auprc': 0.7933188915020974, 'loss_val': 0.6530626457435916, 'psi': 0.7445569411686768}-{'f1_val': 0.6511355033890499, 'auprc': 0.765774493426262, 'loss_val': 0.9554556487273093, 'psi': 0.6969910994039348}
[S2] not sending this round → trigger blocked (psi=0.745)
[S3] START round=43 head_norm_before_train=2.146099 cos_to_last_merge=0.9956 (last merge round=32)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.8254397226301459, 'auprc': 0.9978659484799266, 'loss_val': 0.2641530350263123, 'psi': 0.8944102129700582}-{'f1_val': 0.9966508675148381, 'auprc': 0.9984851145649796, 'loss_val': 0.039739231839877924, 'psi': 0.9973845663348948}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.772448 cos_to_last_merge=0.9967 (last merge round=32)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9395968027776651, 'auprc': 0.946448186282874, 'loss_val': 0.33452094163436236, 'psi': 0.9423373561797486}-{'f1_val': 0.9422059817162424, 'auprc': 0.95632251788791, 'loss_val': 0.3107552388974435, 'psi': 0.9478525961849095}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.560462 cos_to_last_merge=0.9719 (last merge round=31)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.6701777203601067, 'auprc': 0.872283662428846, 'loss_val': 0.36457805618006295, 'psi': 0.7510200971876024}-{'f1_val': 0.6719826665454214, 'auprc': 0.910778506166535, 'loss_val': 0.3322943201281139, 'psi': 0.7675010023938669}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.702255 cos_to_last_merge=0.9874 (last merge round=26)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.6992464480250545, 'auprc': 0.9545621201967549, 'loss_val': 0.2399244317974573, 'psi': 0.8013727168937347}-{'f1_val': 0.8826603161931492, 'auprc': 0.9466733428921252, 'loss_val': 0.2747239793801771, 'psi': 0.9082655268727396}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.325431 cos_to_last_merge=0.9729 (last merge round=29)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.562684842275426, 'auprc': 0.7932899846401334, 'loss_val': 0.7490211049462224, 'psi': 0.6549268992213091}-{'f1_val': 0.6448800306843885, 'auprc': 0.8083806248505727, 'loss_val': 0.5427649710875895, 'psi': 0.7102802683508622}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.564605 cos_to_last_merge=0.9742 (last merge round=32)
[S8] round=43 local utility u=0.002253 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9990110411885457, 'loss_val': 0.04461015588434166, 'psi': 0.997416261436793}-{'f1_val': 0.9963530749356245, 'auprc': 0.9988257905213284, 'loss_val': 0.04855986612437539, 'psi': 0.997342161169906}
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] START round=43 head_norm_before_train=1.750662 cos_to_last_merge=0.9912 (last merge round=31)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9893437682937753, 'auprc': 0.9982491403837963, 'loss_val': 0.051732185986004785, 'psi': 0.9929059171297838}-{'f1_val': 0.9966924912647621, 'auprc': 0.9983674190378347, 'loss_val': 0.03337078093034746, 'psi': 0.9973624623739912}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.935616 cos_to_last_merge=0.9943 (last merge round=31)
[S10] round=43 local utility u=0.041986 metrics={'f1_val': 0.9944206159610718, 'auprc': 0.9968554657748006, 'loss_val': 0.04399467198001977, 'psi': 0.9953945558865633}-{'f1_val': 0.9889892007540583, 'auprc': 0.9926965141702153, 'loss_val': 0.0829007843067642, 'psi': 0.9904721261205212}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=43 head_norm_before_train=2.103045 (no previous merge yet)
[S11] round=43 local utility u=0.000261 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9984267904234421, 'loss_val': 0.024808143058721043, 'psi': 0.9973111985531051}-{'f1_val': 0.996567470639547, 'auprc': 0.9982341101856552, 'loss_val': 0.024752289514557334, 'psi': 0.9972341264579903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=43 head_norm_before_train=1.784451 (no previous merge yet)
[S13] round=43 local utility u=0.348566 metrics={'f1_val': 0.7229632498329646, 'auprc': 0.7434877685858317, 'loss_val': 0.874168262941375, 'psi': 0.7311730573341114}-{'f1_val': 0.6381642062318803, 'auprc': 0.654805816259987, 'loss_val': 0.7964592530785363, 'psi': 0.644820850243123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=43 head_norm_before_train=1.913190 cos_to_last_merge=0.9738 (last merge round=26)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9968337624308853, 'auprc': 0.9929659162303733, 'loss_val': 0.04879772692221421, 'psi': 0.9952866239506805}-{'f1_val': 0.9976511180498535, 'auprc': 0.9989261891220633, 'loss_val': 0.051971385566539845, 'psi': 0.9981611464787374}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.774866 cos_to_last_merge=0.9921 (last merge round=30)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.8772979310684762, 'auprc': 0.994298628370016, 'loss_val': 0.24605403241876148, 'psi': 0.9240982099890922}-{'f1_val': 0.9963989292454516, 'auprc': 0.998634685347538, 'loss_val': 0.03678357399766629, 'psi': 0.9972932316862861}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.550260 cos_to_last_merge=0.9647 (last merge round=28)
[S16] round=43 local utility u=0.734102 metrics={'f1_val': 0.9917968578735842, 'auprc': 0.9956394507215228, 'loss_val': 0.06033993712774292, 'psi': 0.9933338950127597}-{'f1_val': 0.855401218441703, 'auprc': 0.9799219940713959, 'loss_val': 0.6630170682969009, 'psi': 0.9052095286935802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=43 head_norm_before_train=1.486199 cos_to_last_merge=0.9891 (last merge round=31)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.5656756544309509, 'auprc': 0.731515369972234, 'loss_val': 1.2310378636240846, 'psi': 0.6320115406474642}-{'f1_val': 0.6076054686677368, 'auprc': 0.7687838993104207, 'loss_val': 0.9933209429388392, 'psi': 0.6720768409248103}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.645075 cos_to_last_merge=0.9890 (last merge round=31)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.7053188302895452, 'auprc': 0.7924288704530855, 'loss_val': 0.6623903759667997, 'psi': 0.7401628463549614}-{'f1_val': 0.7120489742797297, 'auprc': 0.7933188915020974, 'loss_val': 0.6530626457435916, 'psi': 0.7445569411686768}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.155900 cos_to_last_merge=0.9953 (last merge round=32)
[S3] round=44 local utility u=0.295329 metrics={'f1_val': 0.916996816017203, 'auprc': 0.9986685102753625, 'loss_val': 0.2252462133565696, 'psi': 0.9496654937204668}-{'f1_val': 0.8254397226301459, 'auprc': 0.9978659484799266, 'loss_val': 0.2641530350263123, 'psi': 0.8944102129700582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=44 head_norm_before_train=1.775427 cos_to_last_merge=0.9963 (last merge round=32)
[S4] round=44 local utility u=0.015750 metrics={'f1_val': 0.9397650965867347, 'auprc': 0.9584887893962712, 'loss_val': 0.3401525385198401, 'psi': 0.9472545737105493}-{'f1_val': 0.9395968027776651, 'auprc': 0.946448186282874, 'loss_val': 0.33452094163436236, 'psi': 0.9423373561797486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=44 head_norm_before_train=1.568376 cos_to_last_merge=0.9712 (last merge round=31)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.6426161328738079, 'auprc': 0.8571630215300828, 'loss_val': 0.4543608062962984, 'psi': 0.7284348883363179}-{'f1_val': 0.6701777203601067, 'auprc': 0.872283662428846, 'loss_val': 0.36457805618006295, 'psi': 0.7510200971876024}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.716271 cos_to_last_merge=0.9861 (last merge round=26)
[S6] round=44 local utility u=0.572853 metrics={'f1_val': 0.9130042189414884, 'auprc': 0.9318444024080609, 'loss_val': 0.3086115187528382, 'psi': 0.9205402923281174}-{'f1_val': 0.6992464480250545, 'auprc': 0.9545621201967549, 'loss_val': 0.2399244317974573, 'psi': 0.8013727168937347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=44 head_norm_before_train=1.339812 cos_to_last_merge=0.9712 (last merge round=29)
[S7] round=44 local utility u=0.907583 metrics={'f1_val': 0.6987723337185503, 'auprc': 0.969131926225865, 'loss_val': 0.2779068592917091, 'psi': 0.8069161707214763}-{'f1_val': 0.562684842275426, 'auprc': 0.7932899846401334, 'loss_val': 0.7490211049462224, 'psi': 0.6549268992213091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=44 head_norm_before_train=1.585399 cos_to_last_merge=0.9723 (last merge round=32)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9986596656593615, 'loss_val': 0.04741359031052508, 'psi': 0.9971857283038363}-{'f1_val': 0.9963530749356245, 'auprc': 0.9990110411885457, 'loss_val': 0.04461015588434166, 'psi': 0.997416261436793}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.760740 cos_to_last_merge=0.9906 (last merge round=31)
[S9] round=44 local utility u=0.029109 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9983597484681594, 'loss_val': 0.03294334221492354, 'psi': 0.996859981913057}-{'f1_val': 0.9893437682937753, 'auprc': 0.9982491403837963, 'loss_val': 0.051732185986004785, 'psi': 0.9929059171297838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] sending update (kind=head size=1807 to 1 peers)
[S10] START round=44 head_norm_before_train=1.946950 cos_to_last_merge=0.9937 (last merge round=31)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9936129302802283, 'loss_val': 0.05130022991718742, 'psi': 0.9945474263411016}-{'f1_val': 0.9944206159610718, 'auprc': 0.9968554657748006, 'loss_val': 0.04399467198001977, 'psi': 0.9953945558865633}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=2.112464 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.998342798166826, 'loss_val': 0.026321557436049865, 'psi': 0.9970296041131776}-{'f1_val': 0.996567470639547, 'auprc': 0.9984267904234421, 'loss_val': 0.024808143058721043, 'psi': 0.9973111985531051}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.794825 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6510353116432325, 'auprc': 0.7257241225343932, 'loss_val': 0.7894712853414921, 'psi': 0.6809108359996967}-{'f1_val': 0.7229632498329646, 'auprc': 0.7434877685858317, 'loss_val': 0.874168262941375, 'psi': 0.7311730573341114}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.925148 cos_to_last_merge=0.9726 (last merge round=26)
[S14] round=44 local utility u=0.010378 metrics={'f1_val': 0.9968732947155414, 'auprc': 0.9980662408944116, 'loss_val': 0.04358060817642525, 'psi': 0.9973504731870895}-{'f1_val': 0.9968337624308853, 'auprc': 0.9929659162303733, 'loss_val': 0.04879772692221421, 'psi': 0.9952866239506805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=44 head_norm_before_train=1.784221 cos_to_last_merge=0.9915 (last merge round=30)
[S15] round=44 local utility u=0.344849 metrics={'f1_val': 0.9617736030217221, 'auprc': 0.996582881809503, 'loss_val': 0.07006350798205314, 'psi': 0.9756973145368344}-{'f1_val': 0.8772979310684762, 'auprc': 0.994298628370016, 'loss_val': 0.24605403241876148, 'psi': 0.9240982099890922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=44 head_norm_before_train=1.561976 cos_to_last_merge=0.9633 (last merge round=28)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.8968143733588135, 'auprc': 0.9883023494696799, 'loss_val': 0.4019389076856313, 'psi': 0.9334095638031601}-{'f1_val': 0.9917968578735842, 'auprc': 0.9956394507215228, 'loss_val': 0.06033993712774292, 'psi': 0.9933338950127597}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.498709 cos_to_last_merge=0.9881 (last merge round=31)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.4269739279611695, 'auprc': 0.626804683322416, 'loss_val': 1.4420476126704163, 'psi': 0.5069062301056682}-{'f1_val': 0.5656756544309509, 'auprc': 0.731515369972234, 'loss_val': 1.2310378636240846, 'psi': 0.6320115406474642}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.656542 cos_to_last_merge=0.9881 (last merge round=31)
[S2] round=45 local utility u=0.001002 metrics={'f1_val': 0.705829043926595, 'auprc': 0.7935301479587133, 'loss_val': 0.6667518624518652, 'psi': 0.7409094855394422}-{'f1_val': 0.7053188302895452, 'auprc': 0.7924288704530855, 'loss_val': 0.6623903759667997, 'psi': 0.7401628463549614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=45 head_norm_before_train=2.164429 cos_to_last_merge=0.9950 (last merge round=32)
[S3] round=45 local utility u=0.316033 metrics={'f1_val': 0.9915305048135546, 'auprc': 0.9984980043637102, 'loss_val': 0.0398718236136843, 'psi': 0.9943175046336168}-{'f1_val': 0.916996816017203, 'auprc': 0.9986685102753625, 'loss_val': 0.2252462133565696, 'psi': 0.9496654937204668}
[S3] not sending this round → trigger blocked (psi=0.994)
[S4] START round=45 head_norm_before_train=1.778624 cos_to_last_merge=0.9962 (last merge round=32)
[S4] round=45 local utility u=0.024038 metrics={'f1_val': 0.9427373427982844, 'auprc': 0.9588390056072558, 'loss_val': 0.31096076058698874, 'psi': 0.949178007921873}-{'f1_val': 0.9397650965867347, 'auprc': 0.9584887893962712, 'loss_val': 0.3401525385198401, 'psi': 0.9472545737105493}
[S4] not sending this round → trigger blocked (psi=0.949)
[S5] START round=45 head_norm_before_train=1.578584 cos_to_last_merge=0.9699 (last merge round=31)
[S5] round=45 local utility u=1.000000 metrics={'f1_val': 0.8691473398308013, 'auprc': 0.9950099737574221, 'loss_val': 0.16029800300790334, 'psi': 0.9194923934014496}-{'f1_val': 0.6426161328738079, 'auprc': 0.8571630215300828, 'loss_val': 0.4543608062962984, 'psi': 0.7284348883363179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=45 head_norm_before_train=1.729477 cos_to_last_merge=0.9843 (last merge round=26)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.7937485148825001, 'auprc': 0.94922138435964, 'loss_val': 0.27055649505876217, 'psi': 0.855937662673356}-{'f1_val': 0.9130042189414884, 'auprc': 0.9318444024080609, 'loss_val': 0.3086115187528382, 'psi': 0.9205402923281174}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.352689 cos_to_last_merge=0.9694 (last merge round=29)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5592110725511348, 'auprc': 0.7919573310412853, 'loss_val': 0.7483347750942995, 'psi': 0.652309575947195}-{'f1_val': 0.6987723337185503, 'auprc': 0.969131926225865, 'loss_val': 0.2779068592917091, 'psi': 0.8069161707214763}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.601020 cos_to_last_merge=0.9706 (last merge round=32)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9500924326092406, 'auprc': 0.9929717645173111, 'loss_val': 0.10216175082793184, 'psi': 0.9672441653724688}-{'f1_val': 0.9962031034001528, 'auprc': 0.9986596656593615, 'loss_val': 0.04741359031052508, 'psi': 0.9971857283038363}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.769061 cos_to_last_merge=0.9900 (last merge round=31)
[S9] round=45 local utility u=0.000518 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9983410184991385, 'loss_val': 0.03185195763940191, 'psi': 0.9968524899254487}-{'f1_val': 0.9958601375429889, 'auprc': 0.9983597484681594, 'loss_val': 0.03294334221492354, 'psi': 0.996859981913057}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=45 head_norm_before_train=1.957321 cos_to_last_merge=0.9932 (last merge round=31)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9869580329611893, 'auprc': 0.9926451854547693, 'loss_val': 0.08364132225791628, 'psi': 0.9892328939586214}-{'f1_val': 0.9951704237150173, 'auprc': 0.9936129302802283, 'loss_val': 0.05130022991718742, 'psi': 0.9945474263411016}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=2.121495 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9969111580514664, 'loss_val': 0.037536279250327105, 'psi': 0.9967072120878613}-{'f1_val': 0.9961541414107454, 'auprc': 0.998342798166826, 'loss_val': 0.026321557436049865, 'psi': 0.9970296041131776}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.801742 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6295143549659273, 'auprc': 0.7712571137381404, 'loss_val': 0.8330470104622394, 'psi': 0.6862114584748126}-{'f1_val': 0.6510353116432325, 'auprc': 0.7257241225343932, 'loss_val': 0.7894712853414921, 'psi': 0.6809108359996967}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.935005 cos_to_last_merge=0.9716 (last merge round=26)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9943270320122621, 'loss_val': 0.0447167032229773, 'psi': 0.9956670395751636}-{'f1_val': 0.9968732947155414, 'auprc': 0.9980662408944116, 'loss_val': 0.04358060817642525, 'psi': 0.9973504731870895}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.794938 cos_to_last_merge=0.9908 (last merge round=30)
[S15] round=45 local utility u=0.080458 metrics={'f1_val': 0.9852935993166927, 'auprc': 0.9968366356916772, 'loss_val': 0.051029281500778165, 'psi': 0.9899108138666866}-{'f1_val': 0.9617736030217221, 'auprc': 0.996582881809503, 'loss_val': 0.07006350798205314, 'psi': 0.9756973145368344}
[S15] not sending this round → trigger blocked (psi=0.990)
[S16] START round=45 head_norm_before_train=1.574146 cos_to_last_merge=0.9619 (last merge round=28)
[S16] round=45 local utility u=0.136221 metrics={'f1_val': 0.9259665936277475, 'auprc': 0.990119155257398, 'loss_val': 0.309861511277522, 'psi': 0.9516276182796077}-{'f1_val': 0.8968143733588135, 'auprc': 0.9883023494696799, 'loss_val': 0.4019389076856313, 'psi': 0.9334095638031601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=45 head_norm_before_train=1.508489 cos_to_last_merge=0.9873 (last merge round=31)
[S17] round=45 local utility u=0.914717 metrics={'f1_val': 0.6073836135068502, 'auprc': 0.7763253633710832, 'loss_val': 1.1436337430466055, 'psi': 0.6749603134525434}-{'f1_val': 0.4269739279611695, 'auprc': 0.626804683322416, 'loss_val': 1.4420476126704163, 'psi': 0.5069062301056682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=46 head_norm_before_train=1.668780 cos_to_last_merge=0.9871 (last merge round=31)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.5791209285827477, 'auprc': 0.7429926296014713, 'loss_val': 1.4971183997948767, 'psi': 0.6446696089902371}-{'f1_val': 0.705829043926595, 'auprc': 0.7935301479587133, 'loss_val': 0.6667518624518652, 'psi': 0.7409094855394422}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.172768 cos_to_last_merge=0.9948 (last merge round=32)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9072564288166497, 'auprc': 0.9985536544599495, 'loss_val': 0.14860915714143302, 'psi': 0.9437753190739695}-{'f1_val': 0.9915305048135546, 'auprc': 0.9984980043637102, 'loss_val': 0.0398718236136843, 'psi': 0.9943175046336168}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.782988 cos_to_last_merge=0.9963 (last merge round=32)
[S4] round=46 local utility u=0.030553 metrics={'f1_val': 0.9546454128969587, 'auprc': 0.9566572539160815, 'loss_val': 0.31475838488282015, 'psi': 0.9554501493046079}-{'f1_val': 0.9427373427982844, 'auprc': 0.9588390056072558, 'loss_val': 0.31096076058698874, 'psi': 0.949178007921873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=46 head_norm_before_train=1.589655 cos_to_last_merge=0.9685 (last merge round=31)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.6783294809538652, 'auprc': 0.9624278262933429, 'loss_val': 0.2781707571644215, 'psi': 0.7919688190896563}-{'f1_val': 0.8691473398308013, 'auprc': 0.9950099737574221, 'loss_val': 0.16029800300790334, 'psi': 0.9194923934014496}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.740208 cos_to_last_merge=0.9832 (last merge round=26)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7028387240641004, 'auprc': 0.9632911429312581, 'loss_val': 0.21707918509730503, 'psi': 0.8070196916109635}-{'f1_val': 0.7937485148825001, 'auprc': 0.94922138435964, 'loss_val': 0.27055649505876217, 'psi': 0.855937662673356}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.362314 cos_to_last_merge=0.9680 (last merge round=29)
[S7] round=46 local utility u=0.536396 metrics={'f1_val': 0.6668905707682776, 'auprc': 0.8305037578685031, 'loss_val': 0.43725885830465727, 'psi': 0.7323358456083678}-{'f1_val': 0.5592110725511348, 'auprc': 0.7919573310412853, 'loss_val': 0.7483347750942995, 'psi': 0.652309575947195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=46 head_norm_before_train=1.616606 cos_to_last_merge=0.9692 (last merge round=32)
[S8] round=46 local utility u=0.172868 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9987481903031418, 'loss_val': 0.051318561867669796, 'psi': 0.9973111210826315}-{'f1_val': 0.9500924326092406, 'auprc': 0.9929717645173111, 'loss_val': 0.10216175082793184, 'psi': 0.9672441653724688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=46 head_norm_before_train=1.776622 cos_to_last_merge=0.9893 (last merge round=31)
[S9] round=46 local utility u=0.001453 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9983148316732515, 'loss_val': 0.031332201149051775, 'psi': 0.9970885501075443}-{'f1_val': 0.9958601375429889, 'auprc': 0.9983410184991385, 'loss_val': 0.03185195763940191, 'psi': 0.9968524899254487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=46 head_norm_before_train=1.967273 cos_to_last_merge=0.9928 (last merge round=31)
[S10] round=46 local utility u=0.036772 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9927135440731286, 'loss_val': 0.06089344383198166, 'psi': 0.994319418245684}-{'f1_val': 0.9869580329611893, 'auprc': 0.9926451854547693, 'loss_val': 0.08364132225791628, 'psi': 0.9892328939586214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=46 head_norm_before_train=2.131089 (no previous merge yet)
[S11] round=46 local utility u=0.006853 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9983337066508512, 'loss_val': 0.025595090812388872, 'psi': 0.9970259675067877}-{'f1_val': 0.9965712481121245, 'auprc': 0.9969111580514664, 'loss_val': 0.037536279250327105, 'psi': 0.9967072120878613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=46 head_norm_before_train=1.806399 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6201845588398565, 'auprc': 0.6846338955945646, 'loss_val': 0.8765780732491959, 'psi': 0.6459642935417397}-{'f1_val': 0.6295143549659273, 'auprc': 0.7712571137381404, 'loss_val': 0.8330470104622394, 'psi': 0.6862114584748126}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.944264 cos_to_last_merge=0.9708 (last merge round=26)
[S14] round=46 local utility u=0.005582 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.9964884265997561, 'loss_val': 0.04033425609786429, 'psi': 0.9965613786055568}-{'f1_val': 0.9965603779504312, 'auprc': 0.9943270320122621, 'loss_val': 0.0447167032229773, 'psi': 0.9956670395751636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=46 head_norm_before_train=1.806606 cos_to_last_merge=0.9901 (last merge round=30)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.7015231251388487, 'auprc': 0.9289596340530086, 'loss_val': 0.433230401280154, 'psi': 0.7924977287045127}-{'f1_val': 0.9852935993166927, 'auprc': 0.9968366356916772, 'loss_val': 0.051029281500778165, 'psi': 0.9899108138666866}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.585559 cos_to_last_merge=0.9607 (last merge round=28)
[S16] round=46 local utility u=0.335949 metrics={'f1_val': 0.9915828215303233, 'auprc': 0.9975252251300085, 'loss_val': 0.05387897161991284, 'psi': 0.9939597829701974}-{'f1_val': 0.9259665936277475, 'auprc': 0.990119155257398, 'loss_val': 0.309861511277522, 'psi': 0.9516276182796077}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=46 head_norm_before_train=1.517772 cos_to_last_merge=0.9864 (last merge round=31)
[S17] round=46 local utility u=0.000210 metrics={'f1_val': 0.6016540957320079, 'auprc': 0.8027727118763354, 'loss_val': 1.1881777479555053, 'psi': 0.682101542189739}-{'f1_val': 0.6073836135068502, 'auprc': 0.7763253633710832, 'loss_val': 1.1436337430466055, 'psi': 0.6749603134525434}
[S17] not sending this round → trigger blocked (psi=0.682)
[S2] START round=47 head_norm_before_train=1.679082 cos_to_last_merge=0.9863 (last merge round=31)
[S2] round=47 local utility u=0.481314 metrics={'f1_val': 0.6483072908225136, 'auprc': 0.7662721589227165, 'loss_val': 1.0194476954253087, 'psi': 0.6954932380625948}-{'f1_val': 0.5791209285827477, 'auprc': 0.7429926296014713, 'loss_val': 1.4971183997948767, 'psi': 0.6446696089902371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=47 head_norm_before_train=2.180749 cos_to_last_merge=0.9945 (last merge round=32)
[S3] round=47 local utility u=0.261103 metrics={'f1_val': 0.9799874645424383, 'auprc': 0.9984937808343866, 'loss_val': 0.06260884413028817, 'psi': 0.9873899910592177}-{'f1_val': 0.9072564288166497, 'auprc': 0.9985536544599495, 'loss_val': 0.14860915714143302, 'psi': 0.9437753190739695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=47 head_norm_before_train=1.785911 cos_to_last_merge=0.9963 (last merge round=32)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9362443286184213, 'auprc': 0.9362538122871167, 'loss_val': 0.38232227222781384, 'psi': 0.9362481220858995}-{'f1_val': 0.9546454128969587, 'auprc': 0.9566572539160815, 'loss_val': 0.31475838488282015, 'psi': 0.9554501493046079}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.596734 cos_to_last_merge=0.9675 (last merge round=31)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.5659981036317558, 'auprc': 0.8557646228880368, 'loss_val': 0.7337958595991618, 'psi': 0.6819047113342682}-{'f1_val': 0.6783294809538652, 'auprc': 0.9624278262933429, 'loss_val': 0.2781707571644215, 'psi': 0.7919688190896563}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.749522 cos_to_last_merge=0.9821 (last merge round=26)
[S6] round=47 local utility u=0.474174 metrics={'f1_val': 0.9115412654538599, 'auprc': 0.889833531475699, 'loss_val': 0.3005739682300351, 'psi': 0.9028581718625956}-{'f1_val': 0.7028387240641004, 'auprc': 0.9632911429312581, 'loss_val': 0.21707918509730503, 'psi': 0.8070196916109635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=47 head_norm_before_train=1.370308 cos_to_last_merge=0.9670 (last merge round=29)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.588665289274671, 'auprc': 0.7955321119856813, 'loss_val': 0.6752669987834622, 'psi': 0.671412018359075}-{'f1_val': 0.6668905707682776, 'auprc': 0.8305037578685031, 'loss_val': 0.43725885830465727, 'psi': 0.7323358456083678}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.628025 cos_to_last_merge=0.9680 (last merge round=32)
[S8] round=47 local utility u=0.006933 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9990203137953039, 'loss_val': 0.03826848307134857, 'psi': 0.9974199704794964}-{'f1_val': 0.9963530749356245, 'auprc': 0.9987481903031418, 'loss_val': 0.051318561867669796, 'psi': 0.9973111210826315}
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] START round=47 head_norm_before_train=1.784490 cos_to_last_merge=0.9886 (last merge round=31)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9888785659900814, 'auprc': 0.9982889642290658, 'loss_val': 0.047981205116454616, 'psi': 0.9926427252856751}-{'f1_val': 0.9962710290637395, 'auprc': 0.9983148316732515, 'loss_val': 0.031332201149051775, 'psi': 0.9970885501075443}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.976589 cos_to_last_merge=0.9923 (last merge round=31)
[S10] round=47 local utility u=0.010808 metrics={'f1_val': 0.9940318276144229, 'auprc': 0.9964109918021129, 'loss_val': 0.04222173589965689, 'psi': 0.9949834932894989}-{'f1_val': 0.9953900010273877, 'auprc': 0.9927135440731286, 'loss_val': 0.06089344383198166, 'psi': 0.994319418245684}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=47 head_norm_before_train=2.142053 (no previous merge yet)
[S11] round=47 local utility u=0.002228 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982582591148189, 'loss_val': 0.023269362967144623, 'psi': 0.9972315063540813}-{'f1_val': 0.9961541414107454, 'auprc': 0.9983337066508512, 'loss_val': 0.025595090812388872, 'psi': 0.9970259675067877}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=47 head_norm_before_train=1.810526 (no previous merge yet)
[S13] round=47 local utility u=0.191842 metrics={'f1_val': 0.6363552002544612, 'auprc': 0.7556357461358629, 'loss_val': 0.8029229100193954, 'psi': 0.6840674186070219}-{'f1_val': 0.6201845588398565, 'auprc': 0.6846338955945646, 'loss_val': 0.8765780732491959, 'psi': 0.6459642935417397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=47 head_norm_before_train=1.952308 cos_to_last_merge=0.9699 (last merge round=26)
[S14] round=47 local utility u=0.007853 metrics={'f1_val': 0.9976943331204965, 'auprc': 0.9988586257585489, 'loss_val': 0.038244099957524195, 'psi': 0.9981600501757175}-{'f1_val': 0.9966100132760906, 'auprc': 0.9964884265997561, 'loss_val': 0.04033425609786429, 'psi': 0.9965613786055568}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=47 head_norm_before_train=1.818605 cos_to_last_merge=0.9892 (last merge round=30)
[S15] round=47 local utility u=1.000000 metrics={'f1_val': 0.9966196520233872, 'auprc': 0.997876668440836, 'loss_val': 0.029635491691824306, 'psi': 0.9971224585903667}-{'f1_val': 0.7015231251388487, 'auprc': 0.9289596340530086, 'loss_val': 0.433230401280154, 'psi': 0.7924977287045127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=47 head_norm_before_train=1.597127 cos_to_last_merge=0.9594 (last merge round=28)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9018206463071913, 'auprc': 0.9974247377756214, 'loss_val': 0.34075392293798923, 'psi': 0.9400622828945633}-{'f1_val': 0.9915828215303233, 'auprc': 0.9975252251300085, 'loss_val': 0.05387897161991284, 'psi': 0.9939597829701974}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.529146 cos_to_last_merge=0.9855 (last merge round=31)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5840057851356187, 'auprc': 0.8276446023080584, 'loss_val': 1.2625137671965747, 'psi': 0.6814613120045946}-{'f1_val': 0.6016540957320079, 'auprc': 0.8027727118763354, 'loss_val': 1.1881777479555053, 'psi': 0.682101542189739}
[S17]  timeout peer S16
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.687530 cos_to_last_merge=0.9858 (last merge round=31)
[S2] round=48 local utility u=0.396652 metrics={'f1_val': 0.7163379484212333, 'auprc': 0.7912388496026929, 'loss_val': 0.7092268035454308, 'psi': 0.7462983088938171}-{'f1_val': 0.6483072908225136, 'auprc': 0.7662721589227165, 'loss_val': 1.0194476954253087, 'psi': 0.6954932380625948}
[S2] not sending this round → trigger blocked (psi=0.746)
[S3] START round=48 head_norm_before_train=2.188836 cos_to_last_merge=0.9941 (last merge round=32)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9984825806660935, 'loss_val': 0.10902738083918419, 'psi': 0.9760621866071288}-{'f1_val': 0.9799874645424383, 'auprc': 0.9984937808343866, 'loss_val': 0.06260884413028817, 'psi': 0.9873899910592177}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.790660 cos_to_last_merge=0.9961 (last merge round=32)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9104551046045852, 'auprc': 0.9284596130586462, 'loss_val': 0.4247061175020506, 'psi': 0.9176569079862096}-{'f1_val': 0.9362443286184213, 'auprc': 0.9362538122871167, 'loss_val': 0.38232227222781384, 'psi': 0.9362481220858995}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.602317 cos_to_last_merge=0.9668 (last merge round=31)
[S5] round=48 local utility u=1.000000 metrics={'f1_val': 0.9387417090289951, 'auprc': 0.9960333310759659, 'loss_val': 0.13148193047460247, 'psi': 0.9616583578477835}-{'f1_val': 0.5659981036317558, 'auprc': 0.8557646228880368, 'loss_val': 0.7337958595991618, 'psi': 0.6819047113342682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=48 head_norm_before_train=1.759662 cos_to_last_merge=0.9807 (last merge round=26)
[S6] round=48 local utility u=0.144158 metrics={'f1_val': 0.9190010050455509, 'auprc': 0.9580702790024618, 'loss_val': 0.26172722927912095, 'psi': 0.9346287146283152}-{'f1_val': 0.9115412654538599, 'auprc': 0.889833531475699, 'loss_val': 0.3005739682300351, 'psi': 0.9028581718625956}
[S6] not sending this round → trigger blocked (psi=0.935)
[S7] START round=48 head_norm_before_train=1.377162 cos_to_last_merge=0.9660 (last merge round=29)
[S7] round=48 local utility u=0.058728 metrics={'f1_val': 0.5990673576835104, 'auprc': 0.7964614459102546, 'loss_val': 0.6230109849568112, 'psi': 0.6780249929742082}-{'f1_val': 0.588665289274671, 'auprc': 0.7955321119856813, 'loss_val': 0.6752669987834622, 'psi': 0.671412018359075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=48 head_norm_before_train=1.642404 cos_to_last_merge=0.9666 (last merge round=32)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9989663402387039, 'loss_val': 0.05599676009265564, 'psi': 0.9973983810568563}-{'f1_val': 0.9963530749356245, 'auprc': 0.9990203137953039, 'loss_val': 0.03826848307134857, 'psi': 0.9974199704794964}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.794266 cos_to_last_merge=0.9879 (last merge round=31)
[S9] round=48 local utility u=0.010234 metrics={'f1_val': 0.9908744526594879, 'auprc': 0.998294948250112, 'loss_val': 0.03950558142899191, 'psi': 0.9938426508957376}-{'f1_val': 0.9888785659900814, 'auprc': 0.9982889642290658, 'loss_val': 0.047981205116454616, 'psi': 0.9926427252856751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=48 head_norm_before_train=1.985941 cos_to_last_merge=0.9917 (last merge round=31)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9927325776882954, 'loss_val': 0.05580373445765813, 'psi': 0.9939421966069417}-{'f1_val': 0.9940318276144229, 'auprc': 0.9964109918021129, 'loss_val': 0.04222173589965689, 'psi': 0.9949834932894989}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=2.153374 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981450327692519, 'loss_val': 0.023434849263563925, 'psi': 0.9971862158158545}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982582591148189, 'loss_val': 0.023269362967144623, 'psi': 0.9972315063540813}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.814129 (no previous merge yet)
[S13] round=48 local utility u=0.015812 metrics={'f1_val': 0.654066771684009, 'auprc': 0.7261992597767821, 'loss_val': 0.7892592132619093, 'psi': 0.6829197669211182}-{'f1_val': 0.6363552002544612, 'auprc': 0.7556357461358629, 'loss_val': 0.8029229100193954, 'psi': 0.6840674186070219}
[S13] not sending this round → trigger blocked (psi=0.683)
[S14] START round=48 head_norm_before_train=1.960569 cos_to_last_merge=0.9689 (last merge round=26)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9480325958698476, 'auprc': 0.9986250906607788, 'loss_val': 0.08873006423887538, 'psi': 0.96826959378622}-{'f1_val': 0.9976943331204965, 'auprc': 0.9988586257585489, 'loss_val': 0.038244099957524195, 'psi': 0.9981600501757175}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.827324 cos_to_last_merge=0.9885 (last merge round=30)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.9019206656482751, 'auprc': 0.9947689871209635, 'loss_val': 0.18443447690062167, 'psi': 0.9390599942373505}-{'f1_val': 0.9966196520233872, 'auprc': 0.997876668440836, 'loss_val': 0.029635491691824306, 'psi': 0.9971224585903667}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.608231 cos_to_last_merge=0.9582 (last merge round=28)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.8496280692782027, 'auprc': 0.9973611040347871, 'loss_val': 0.6063355482415721, 'psi': 0.9087212831808364}-{'f1_val': 0.9018206463071913, 'auprc': 0.9974247377756214, 'loss_val': 0.34075392293798923, 'psi': 0.9400622828945633}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.538072 cos_to_last_merge=0.9847 (last merge round=31)
[S17] round=48 local utility u=0.095143 metrics={'f1_val': 0.6008182200841632, 'auprc': 0.751257069065191, 'loss_val': 0.9439397583280817, 'psi': 0.6609937596765743}-{'f1_val': 0.5840057851356187, 'auprc': 0.8276446023080584, 'loss_val': 1.2625137671965747, 'psi': 0.6814613120045946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=49 head_norm_before_train=1.694281 cos_to_last_merge=0.9854 (last merge round=31)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.6051366643095313, 'auprc': 0.7490205348530439, 'loss_val': 1.3703880563330555, 'psi': 0.6626902125269363}-{'f1_val': 0.7163379484212333, 'auprc': 0.7912388496026929, 'loss_val': 0.7092268035454308, 'psi': 0.7462983088938171}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.197112 cos_to_last_merge=0.9938 (last merge round=32)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9336548919915933, 'auprc': 0.9986442372710871, 'loss_val': 0.14465525528770248, 'psi': 0.9596506301033908}-{'f1_val': 0.9611152572344858, 'auprc': 0.9984825806660935, 'loss_val': 0.10902738083918419, 'psi': 0.9760621866071288}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.791871 cos_to_last_merge=0.9956 (last merge round=32)
[S4] round=49 local utility u=0.191075 metrics={'f1_val': 0.9403556334241883, 'auprc': 0.9587461673136692, 'loss_val': 0.312819678068229, 'psi': 0.9477118469799807}-{'f1_val': 0.9104551046045852, 'auprc': 0.9284596130586462, 'loss_val': 0.4247061175020506, 'psi': 0.9176569079862096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=49 head_norm_before_train=1.607879 cos_to_last_merge=0.9661 (last merge round=31)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.4278993659728302, 'auprc': 0.8547394021700372, 'loss_val': 1.2466307307336735, 'psi': 0.598635380451713}-{'f1_val': 0.9387417090289951, 'auprc': 0.9960333310759659, 'loss_val': 0.13148193047460247, 'psi': 0.9616583578477835}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.768905 cos_to_last_merge=0.9791 (last merge round=26)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6248006076810563, 'auprc': 0.9336783301026506, 'loss_val': 0.39673543083493407, 'psi': 0.748351696649694}-{'f1_val': 0.9190010050455509, 'auprc': 0.9580702790024618, 'loss_val': 0.26172722927912095, 'psi': 0.9346287146283152}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.383602 cos_to_last_merge=0.9651 (last merge round=29)
[S7] round=49 local utility u=0.471091 metrics={'f1_val': 0.6845717841412816, 'auprc': 0.8515934005636758, 'loss_val': 0.3592506252738364, 'psi': 0.7513804307102393}-{'f1_val': 0.5990673576835104, 'auprc': 0.7964614459102546, 'loss_val': 0.6230109849568112, 'psi': 0.6780249929742082}
[S7] not sending this round → trigger blocked (psi=0.751)
[S8] START round=49 head_norm_before_train=1.653640 cos_to_last_merge=0.9652 (last merge round=32)
[S8] round=49 local utility u=0.004281 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9981422002309965, 'loss_val': 0.044063127394545265, 'psi': 0.9969787421324903}-{'f1_val': 0.9963530749356245, 'auprc': 0.9989663402387039, 'loss_val': 0.05599676009265564, 'psi': 0.9973983810568563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=49 head_norm_before_train=1.803313 cos_to_last_merge=0.9874 (last merge round=31)
[S9] round=49 local utility u=0.023530 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9983037454149615, 'loss_val': 0.027189174348868483, 'psi': 0.9973178052543195}-{'f1_val': 0.9908744526594879, 'auprc': 0.998294948250112, 'loss_val': 0.03950558142899191, 'psi': 0.9938426508957376}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=49 head_norm_before_train=1.996435 cos_to_last_merge=0.9911 (last merge round=31)
[S10] round=49 local utility u=0.007113 metrics={'f1_val': 0.9938290824763921, 'auprc': 0.9943586271355088, 'loss_val': 0.040938461498426476, 'psi': 0.9940409003400388}-{'f1_val': 0.9947486092193725, 'auprc': 0.9927325776882954, 'loss_val': 0.05580373445765813, 'psi': 0.9939421966069417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=49 head_norm_before_train=2.164177 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982110606301222, 'loss_val': 0.02373659065925991, 'psi': 0.9972126269602026}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981450327692519, 'loss_val': 0.023434849263563925, 'psi': 0.9971862158158545}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.819554 (no previous merge yet)
[S13] round=49 local utility u=0.031943 metrics={'f1_val': 0.6518493417497467, 'auprc': 0.7572419597957308, 'loss_val': 0.8051976661009834, 'psi': 0.6940063889681404}-{'f1_val': 0.654066771684009, 'auprc': 0.7261992597767821, 'loss_val': 0.7892592132619093, 'psi': 0.6829197669211182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=49 head_norm_before_train=1.969133 cos_to_last_merge=0.9680 (last merge round=26)
[S14] round=49 local utility u=0.053860 metrics={'f1_val': 0.9632014278247667, 'auprc': 0.9976836701869404, 'loss_val': 0.06919949714077171, 'psi': 0.9769943247696362}-{'f1_val': 0.9480325958698476, 'auprc': 0.9986250906607788, 'loss_val': 0.08873006423887538, 'psi': 0.96826959378622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=49 head_norm_before_train=1.834788 cos_to_last_merge=0.9879 (last merge round=30)
[S15] round=49 local utility u=0.279355 metrics={'f1_val': 0.9726433919212996, 'auprc': 0.9968824861046606, 'loss_val': 0.05640181155239695, 'psi': 0.9823390295946439}-{'f1_val': 0.9019206656482751, 'auprc': 0.9947689871209635, 'loss_val': 0.18443447690062167, 'psi': 0.9390599942373505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=49 head_norm_before_train=1.619226 cos_to_last_merge=0.9570 (last merge round=28)
[S16] round=49 local utility u=0.410903 metrics={'f1_val': 0.9316538221605845, 'auprc': 0.9947639852780453, 'loss_val': 0.26889227337785215, 'psi': 0.9568978874075689}-{'f1_val': 0.8496280692782027, 'auprc': 0.9973611040347871, 'loss_val': 0.6063355482415721, 'psi': 0.9087212831808364}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=49 head_norm_before_train=1.545004 cos_to_last_merge=0.9843 (last merge round=31)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.5815614914475818, 'auprc': 0.8181505829291651, 'loss_val': 1.26290242646896, 'psi': 0.6761971280402153}-{'f1_val': 0.6008182200841632, 'auprc': 0.751257069065191, 'loss_val': 0.9439397583280817, 'psi': 0.6609937596765743}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
