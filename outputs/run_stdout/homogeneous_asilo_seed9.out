[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:39003
[S3] → join 127.0.0.1:39002
[S4] → join 127.0.0.1:39002
[S5] → join 127.0.0.1:39002
[S6] → join 127.0.0.1:39002
[S7] → join 127.0.0.1:39002
[S8] → join 127.0.0.1:39002
[S9] → join 127.0.0.1:39002
[S10] → join 127.0.0.1:39002
[S11] → join 127.0.0.1:39002
[S13] → join 127.0.0.1:39002
[S14] → join 127.0.0.1:39002
[S15] → join 127.0.0.1:39002
[S16] → join 127.0.0.1:39002
[S17] → join 127.0.0.1:39002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.123631 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.168580 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.142480 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.161641 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.176503 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.224679 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.192860 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.135365 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.124257 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.221258 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.098517 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.128687 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.181435 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.182657 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.169553 (no previous merge yet)
[S2]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S3] + discovered S15
[S3] + discovered S7
[S3] + discovered S9
[S3] + discovered S17
[S3] + discovered S13
[S3] + discovered S8
[S3] + discovered S11
[S3] + discovered S6
[S3] + discovered S14
[S3] + discovered S10
[S3] + discovered S16
[S3] + discovered S5
[S3] + discovered S4
[S4] + discovered S3
[S4] + discovered S2
[S4] + discovered S16
[S4] + discovered S11
[S4] + discovered S15
[S4] + discovered S13
[S4] + discovered S9
[S4] + discovered S8
[S4] + discovered S17
[S5] + discovered S2
[S5] + discovered S3
[S4] + discovered S14
[S4] + discovered S10
[S4] + discovered S6
[S5] + discovered S4
[S4] + discovered S7
[S4] + discovered S5
[S5] + discovered S7
[S5] + discovered S16
[S6] + discovered S2
[S5] + discovered S11
[S5] + discovered S17
[S5] + discovered S6
[S5] + discovered S10
[S5] + discovered S15
[S5] + discovered S14
[S5] + discovered S13
[S6] + discovered S5
[S6] + discovered S4
[S5] + discovered S8
[S5] + discovered S9
[S6] + discovered S3
[S6] + discovered S9
[S6] + discovered S10
[S6] + discovered S15
[S6] + discovered S14
[S6] + discovered S17
[S6] + discovered S7
[S6] + discovered S11
[S7] + discovered S2
[S6] + discovered S8
[S7] + discovered S5
[S6] + discovered S16
[S6] + discovered S13
[S7] + discovered S3
[S7] + discovered S4
[S7] + discovered S6
[S7] + discovered S11
[S7] + discovered S10
[S7] + discovered S16
[S7] + discovered S15
[S8] + discovered S3
[S7] + discovered S9
[S8] + discovered S6
[S7] + discovered S8
[S8] + discovered S4
[S7] + discovered S13
[S7] + discovered S17
[S7] + discovered S14
[S8] + discovered S5
[S8] + discovered S2
[S8] + discovered S7
[S9] + discovered S2
[S9] + discovered S8
[S8] + discovered S11
[S9] + discovered S5
[S9] + discovered S7
[S9] + discovered S6
[S8] + discovered S10
[S8] + discovered S16
[S8] + discovered S13
[S8] + discovered S15
[S8] + discovered S17
[S8] + discovered S14
[S8] + discovered S9
[S9] + discovered S4
[S9] + discovered S3
[S10] + discovered S3
[S10] + discovered S5
[S9] + discovered S13
[S10] + discovered S4
[S9] + discovered S11
[S10] + discovered S6
[S10] + discovered S9
[S10] + discovered S2
[S9] + discovered S14
[S9] + discovered S17
[S9] + discovered S10
[S10] + discovered S8
[S10] + discovered S7
[S9] + discovered S16
[S9] + discovered S15
[S11] + discovered S7
[S11] + discovered S8
[S10] + discovered S15
[S11] + discovered S3
[S10] + discovered S17
[S11] + discovered S10
[S11] + discovered S9
[S10] + discovered S13
[S10] + discovered S11
[S11] + discovered S4
[S10] + discovered S16
[S10] + discovered S14
[S11] + discovered S6
[S11] + discovered S5
[S11] + discovered S2
[S11] + discovered S15
[S13] + discovered S10
[S13] + discovered S4
[S13] + discovered S3
[S13] + discovered S11
[S11] + discovered S17
[S13] + discovered S7
[S11] + discovered S14
[S11] + discovered S13
[S13] + discovered S5
[S13] + discovered S9
[S13] + discovered S6
[S11] + discovered S16
[S13] + discovered S2
[S13] + discovered S8
[S14] + discovered S6
[S13] + discovered S17
[S14] + discovered S5
[S14] + discovered S13
[S14] + discovered S4
[S14] + discovered S10
[S13] + discovered S14
[S14] + discovered S3
[S14] + discovered S8
[S13] + discovered S15
[S14] + discovered S9
[S14] + discovered S2
[S14] + discovered S11
[S14] + discovered S7
[S13] + discovered S16
[S15] + discovered S10
[S15] + discovered S14
[S15] + discovered S8
[S15] + discovered S7
[S15] + discovered S3
[S15] + discovered S9
[S15] + discovered S13
[S15] + discovered S2
[S15] + discovered S4
[S14] + discovered S16
[S15] + discovered S11
[S15] + discovered S6
[S14] + discovered S17
[S15] + discovered S5
[S14] + discovered S15
[S16] + discovered S4
[S16] + discovered S6
[S16] + discovered S14
[S16] + discovered S15
[S15] + discovered S16
[S16] + discovered S8
[S16] + discovered S9
[S16] + discovered S2
[S16] + discovered S10
[S16] + discovered S3
[S15] + discovered S17
[S16] + discovered S7
[S16] + discovered S11
[S16] + discovered S5
[S16] + discovered S13
[S17] + discovered S4
[S17] + discovered S2
[S17] + discovered S6
[S17] + discovered S11
[S16] + discovered S17
[S17] + discovered S5
[S17] + discovered S7
[S17] + discovered S10
[S17] + discovered S16
[S17] + discovered S3
[S17] + discovered S9
[S17] + discovered S14
[S17] + discovered S15
[S17] + discovered S13
[S17] + discovered S8
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=1.000 → S9@127.0.0.1:39010
[S11] ⇄ pheromone p=1.000 → S5@127.0.0.1:39005
[S14] ⇄ pheromone p=1.000 → S17@127.0.0.1:39017
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:39008
[S9] ⇄ pheromone p=1.000 → S15@127.0.0.1:39015
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:39017
[S7] ⇄ pheromone p=1.000 → S2@127.0.0.1:39002
[S3] ⇄ pheromone p=1.000 → S8@127.0.0.1:39009
[S15] ⇄ pheromone p=1.000 → S6@127.0.0.1:39007
[S5] ⇄ pheromone p=1.000 → S17@127.0.0.1:39017
[S4] ⇄ pheromone p=1.000 → S10@127.0.0.1:39011
[S13] ⇄ pheromone p=1.000 → S4@127.0.0.1:39004
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:39014
[S8] ⇄ pheromone p=1.000 → S5@127.0.0.1:39005
[S17] ⇄ pheromone p=1.000 → S16@127.0.0.1:39016
[S2] START round=1 head_norm_before_train=1.732107 (no previous merge yet)
[S2] round=1 local utility u=0.687580 metrics={'f1_val': 0.9149529225130816, 'auprc': 0.9860714953628487, 'loss_val': 0.18431145850778843, 'psi': 0.9434003516529883}-{'f1_val': 0.6997658022741111, 'auprc': 0.9803215846466298, 'loss_val': 0.25109944642162857, 'psi': 0.8119881152231185}
[S3] START round=1 head_norm_before_train=1.900148 (no previous merge yet)
[S3] round=1 local utility u=0.111731 metrics={'f1_val': 0.9958231352255237, 'auprc': 0.9971923234629698, 'loss_val': 0.07055229684093665, 'psi': 0.9963708105205021}-{'f1_val': 0.9654752948944147, 'auprc': 0.9971072606078517, 'loss_val': 0.11167167715756371, 'psi': 0.9781280811797896}
[S4] START round=1 head_norm_before_train=1.865981 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.9397178790007786, 'auprc': 0.9373771588409963, 'loss_val': 0.33516506229143084, 'psi': 0.9387815909368656}-{'f1_val': 0.9420365378839148, 'auprc': 0.977738135222082, 'loss_val': 0.2866114188918038, 'psi': 0.9563171768191817}
[S5] START round=1 head_norm_before_train=1.848728 (no previous merge yet)
[S5] round=1 local utility u=0.964942 metrics={'f1_val': 0.9973917235595179, 'auprc': 0.9996308103295767, 'loss_val': 0.03096269219269339, 'psi': 0.9982873582675414}-{'f1_val': 0.7022248056569772, 'auprc': 0.9918891262460315, 'loss_val': 0.1666196691514019, 'psi': 0.818090533892599}
[S6] START round=1 head_norm_before_train=1.853241 (no previous merge yet)
[S6] round=1 local utility u=0.001381 metrics={'f1_val': 0.827357506829822, 'auprc': 0.951087440103792, 'loss_val': 0.3975197801434759, 'psi': 0.87684948013941}-{'f1_val': 0.8226629205786661, 'auprc': 0.9470384865195488, 'loss_val': 0.3599675081205919, 'psi': 0.8724131469550191}
[S7] START round=1 head_norm_before_train=1.789334 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.6074355993863781, 'auprc': 0.7882614714338361, 'loss_val': 0.5602627756148131, 'psi': 0.6797659482053613}-{'f1_val': 0.6265059142627298, 'auprc': 0.7944820398658352, 'loss_val': 0.5859638399556109, 'psi': 0.693696364503972}
[S8] START round=1 head_norm_before_train=1.947794 (no previous merge yet)
[S8] round=1 local utility u=0.006890 metrics={'f1_val': 0.9946307902678028, 'auprc': 0.9993331497284915, 'loss_val': 0.024792793754411045, 'psi': 0.9965117340520783}-{'f1_val': 0.9947112329003273, 'auprc': 0.9992674757761805, 'loss_val': 0.03885762579946023, 'psi': 0.9965337300506685}
[S9] START round=1 head_norm_before_train=1.933167 (no previous merge yet)
[S9] round=1 local utility u=0.009974 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9996207280178576, 'loss_val': 0.01602737253594357, 'psi': 0.9983752252135293}-{'f1_val': 0.9962710290637395, 'auprc': 0.9989598672741788, 'loss_val': 0.02634888547501487, 'psi': 0.9973465643479152}
[S10] START round=1 head_norm_before_train=1.925070 (no previous merge yet)
[S10] round=1 local utility u=0.005426 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9967438432713864, 'loss_val': 0.033153852259471074, 'psi': 0.9947068957194963}-{'f1_val': 0.9939487387271932, 'auprc': 0.997519638302077, 'loss_val': 0.04993210783887699, 'psi': 0.9953770985571467}
[S11] START round=1 head_norm_before_train=2.091901 (no previous merge yet)
[S11] round=1 local utility u=0.006951 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9985488288213302, 'loss_val': 0.015794235277951922, 'psi': 0.9973500845255905}-{'f1_val': 0.9965509216617638, 'auprc': 0.9975959016998355, 'loss_val': 0.02683786447800291, 'psi': 0.9969689136769926}
[S13] START round=1 head_norm_before_train=1.649623 (no previous merge yet)
[S13] round=1 local utility u=0.279750 metrics={'f1_val': 0.6288798209473047, 'auprc': 0.7648233454518227, 'loss_val': 0.8197462689889041, 'psi': 0.6832572307491118}-{'f1_val': 0.572726907692987, 'auprc': 0.6827059406884884, 'loss_val': 0.7959765924362835, 'psi': 0.6167185208911876}
[S14] START round=1 head_norm_before_train=2.017522 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.9969788439352044, 'auprc': 0.9987260013097389, 'loss_val': 0.024966611849573373, 'psi': 0.9976777068850182}-{'f1_val': 0.9984758593419994, 'auprc': 0.9992353912676313, 'loss_val': 0.024844951143080676, 'psi': 0.9987796721122522}
[S15] START round=1 head_norm_before_train=1.985874 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9980885715377341, 'loss_val': 0.0216176949124769, 'psi': 0.9974533860660815}-{'f1_val': 0.9974605999319422, 'auprc': 0.9992816961716686, 'loss_val': 0.0236738513929521, 'psi': 0.9981890384278329}
[S16] START round=1 head_norm_before_train=1.982737 (no previous merge yet)
[S16] round=1 local utility u=0.011456 metrics={'f1_val': 0.9939866172810436, 'auprc': 0.9902923060850799, 'loss_val': 0.031895754201047066, 'psi': 0.9925088928026581}-{'f1_val': 0.9929020562372061, 'auprc': 0.9917050859462028, 'loss_val': 0.052538315854449874, 'psi': 0.9924232681208047}
[S17] START round=1 head_norm_before_train=1.953495 (no previous merge yet)
[S17] round=1 local utility u=0.730150 metrics={'f1_val': 0.6996240181575436, 'auprc': 0.9718667349157395, 'loss_val': 0.8900679477091822, 'psi': 0.808521104860822}-{'f1_val': 0.5846438746051632, 'auprc': 0.7495266222875727, 'loss_val': 0.9934662428472668, 'psi': 0.650596973678127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39008
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:39004
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39014
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:39005
[S13] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1806 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S3
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.227674)
[S5] loaded HEAD from S3 (vec_in norm=2.227674)
[S5] cosine check vs S3: cos=-0.0047
[S5] DROPPED delta from S3 (cos=-0.0047 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S10
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.179365)
[S15] loaded HEAD from S10 (vec_in norm=2.179365)
[S15] cosine check vs S10: cos=-0.1157
[S15] DROPPED delta from S10 (cos=-0.1157 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1806) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.197170)
[S5] loaded HEAD from S16 (vec_in norm=2.197170)
[S5] cosine check vs S16: cos=0.1090
[S5] BUFFERED delta from S16 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1803) from S6
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=2.133139)
[S10] loaded HEAD from S6 (vec_in norm=2.133139)
[S10] cosine check vs S6: cos=0.0434
[S10] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.172640)
[S7] loaded HEAD from S8 (vec_in norm=2.172640)
[S7] cosine check vs S8: cos=0.0567
[S7] BUFFERED delta from S8 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.859629)
[S4] loaded HEAD from S13 (vec_in norm=1.859629)
[S4] cosine check vs S13: cos=-0.1518
[S4] DROPPED delta from S13 (cos=-0.1518 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.129020)
[S15] loaded HEAD from S9 (vec_in norm=2.129020)
[S15] cosine check vs S9: cos=0.0405
[S15] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.121507)
[S4] loaded HEAD from S5 (vec_in norm=2.121507)
[S4] cosine check vs S5: cos=0.0438
[S4] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S11
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.331371)
[S7] loaded HEAD from S11 (vec_in norm=2.331371)
[S7] cosine check vs S11: cos=-0.1005
[S7] DROPPED delta from S11 (cos=-0.1005 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S2
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.982665)
[S14] loaded HEAD from S2 (vec_in norm=1.982665)
[S14] cosine check vs S2: cos=-0.0023
[S14] DROPPED delta from S2 (cos=-0.0023 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:39009
[S17] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.144510)
[S8] loaded HEAD from S17 (vec_in norm=2.144510)
[S8] cosine check vs S17: cos=-0.0177
[S8] DROPPED delta from S17 (cos=-0.0177 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.9397 head_norm=2.033892
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.9397 head_norm=2.033892 delta_norm=0.000000
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.6074 head_norm=2.001378
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.6074 head_norm=2.001378 delta_norm=0.000000
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.9933 head_norm=2.179365
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.9933 head_norm=2.179365 delta_norm=0.000000
[S10] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.9974 head_norm=2.121507
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.9974 head_norm=2.121507 delta_norm=0.000000
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.9970 head_norm=2.254434
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.9970 head_norm=2.254434 delta_norm=0.000000
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.982665 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.9151013268017865, 'auprc': 0.970648132032135, 'loss_val': 0.22728632293640041, 'psi': 0.9373200488939258}-{'f1_val': 0.9149529225130816, 'auprc': 0.9860714953628487, 'loss_val': 0.18431145850778843, 'psi': 0.9434003516529883}
[S3] START round=2 head_norm_before_train=2.227674 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.9864135609663514, 'auprc': 0.9970580250228992, 'loss_val': 0.030204471067963517, 'psi': 0.9906713465889705}-{'f1_val': 0.9958231352255237, 'auprc': 0.9971923234629698, 'loss_val': 0.07055229684093665, 'psi': 0.9963708105205021}
[S4] START round=2 head_norm_before_train=2.033892 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.047205 metrics={'f1_val': 0.9399594100330935, 'auprc': 0.959995505317101, 'loss_val': 0.3100593221647604, 'psi': 0.9479738481466965}-{'f1_val': 0.9397178790007786, 'auprc': 0.9373771588409963, 'loss_val': 0.33516506229143084, 'psi': 0.9387815909368656}
[S5] START round=2 head_norm_before_train=2.121507 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.002146 metrics={'f1_val': 0.9970241334269112, 'auprc': 0.9991384655099804, 'loss_val': 0.022987724855458178, 'psi': 0.997869866260139}-{'f1_val': 0.9973917235595179, 'auprc': 0.9996308103295767, 'loss_val': 0.03096269219269339, 'psi': 0.9982873582675414}
[S6] START round=2 head_norm_before_train=2.133139 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.6719668870909058, 'auprc': 0.9199124670611251, 'loss_val': 0.7591052763185876, 'psi': 0.7711451190789935}-{'f1_val': 0.827357506829822, 'auprc': 0.951087440103792, 'loss_val': 0.3975197801434759, 'psi': 0.87684948013941}
[S7] START round=2 head_norm_before_train=2.001378 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.6011470717778904, 'auprc': 0.7878681744999743, 'loss_val': 0.6664950683490416, 'psi': 0.6758355128667239}-{'f1_val': 0.6074355993863781, 'auprc': 0.7882614714338361, 'loss_val': 0.5602627756148131, 'psi': 0.6797659482053613}
[S8] START round=2 head_norm_before_train=2.172640 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.9943863538992247, 'auprc': 0.9992976118699088, 'loss_val': 0.028908120502438298, 'psi': 0.9963508570874984}-{'f1_val': 0.9946307902678028, 'auprc': 0.9993331497284915, 'loss_val': 0.024792793754411045, 'psi': 0.9965117340520783}
[S9] START round=2 head_norm_before_train=2.129020 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.9950534268485727, 'auprc': 0.9999463059020863, 'loss_val': 0.016844033839856925, 'psi': 0.9970105784699781}-{'f1_val': 0.9975448900106438, 'auprc': 0.9996207280178576, 'loss_val': 0.01602737253594357, 'psi': 0.9983752252135293}
[S10] START round=2 head_norm_before_train=2.179365 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.001374 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9969694864406151, 'loss_val': 0.031585113705909544, 'psi': 0.9948474194687895}-{'f1_val': 0.9933489306849028, 'auprc': 0.9967438432713864, 'loss_val': 0.033153852259471074, 'psi': 0.9947068957194963}
[S11] START round=2 head_norm_before_train=2.331371 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9980820758448937, 'loss_val': 0.05488184173019403, 'psi': 0.997003847420331}-{'f1_val': 0.9965509216617638, 'auprc': 0.9985488288213302, 'loss_val': 0.015794235277951922, 'psi': 0.9973500845255905}
[S13] START round=2 head_norm_before_train=1.859629 (no previous merge yet)
[S13] round=2 local utility u=0.376399 metrics={'f1_val': 0.7349406738815237, 'auprc': 0.8101296128139521, 'loss_val': 0.8392311983794404, 'psi': 0.7650162494544951}-{'f1_val': 0.6288798209473047, 'auprc': 0.7648233454518227, 'loss_val': 0.8197462689889041, 'psi': 0.6832572307491118}
[S14] START round=2 head_norm_before_train=2.204230 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.8769055680160909, 'auprc': 0.9987118752465585, 'loss_val': 0.25373515409932507, 'psi': 0.9256280909082779}-{'f1_val': 0.9969788439352044, 'auprc': 0.9987260013097389, 'loss_val': 0.024966611849573373, 'psi': 0.9976777068850182}
[S15] START round=2 head_norm_before_train=2.254434 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9981893641863594, 'loss_val': 0.026654705045966266, 'psi': 0.9970751921838283}-{'f1_val': 0.9970299290849798, 'auprc': 0.9980885715377341, 'loss_val': 0.0216176949124769, 'psi': 0.9974533860660815}
[S16] START round=2 head_norm_before_train=2.197170 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.9935942725856693, 'auprc': 0.988846832329952, 'loss_val': 0.029247003124970035, 'psi': 0.9916952964833824}-{'f1_val': 0.9939866172810436, 'auprc': 0.9902923060850799, 'loss_val': 0.031895754201047066, 'psi': 0.9925088928026581}
[S17] START round=2 head_norm_before_train=2.144510 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.628390485109353, 'auprc': 0.8685725481203783, 'loss_val': 1.0102217251264038, 'psi': 0.7244633103137632}-{'f1_val': 0.6996240181575436, 'auprc': 0.9718667349157395, 'loss_val': 0.8900679477091822, 'psi': 0.808521104860822}
[S2]  timeout peer S3
[S3]  timeout peer S2
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:39013
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39005
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39017
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=2.240331)
[S13] loaded HEAD from S5 (vec_in norm=2.240331)
[S13] cosine check vs S5: cos=-0.0232
[S13] DROPPED delta from S5 (cos=-0.0232 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=2.030988)
[S5] loaded HEAD from S13 (vec_in norm=2.030988)
[S5] cosine check vs S13: cos=-0.0232
[S5] DROPPED delta from S13 (cos=-0.0232 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.093199)
[S9] loaded HEAD from S4 (vec_in norm=2.093199)
[S9] cosine check vs S4: cos=-0.1277
[S9] DROPPED delta from S4 (cos=-0.1277 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.295360)
[S17] loaded HEAD from S10 (vec_in norm=2.295360)
[S17] cosine check vs S10: cos=0.0263
[S17] BUFFERED delta from S10 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.6284 head_norm=2.329772
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.6284 head_norm=2.329772 delta_norm=0.000000
[S17] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=2.153862 (no previous merge yet)
[S2] round=3 local utility u=0.004590 metrics={'f1_val': 0.9145972357354817, 'auprc': 0.9813958717704516, 'loss_val': 0.247325640673044, 'psi': 0.9413166901494696}-{'f1_val': 0.9151013268017865, 'auprc': 0.970648132032135, 'loss_val': 0.22728632293640041, 'psi': 0.9373200488939258}
[S3] START round=3 head_norm_before_train=2.387314 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.8117931004417724, 'auprc': 0.998334352940267, 'loss_val': 0.26297517857675257, 'psi': 0.8864096014411702}-{'f1_val': 0.9864135609663514, 'auprc': 0.9970580250228992, 'loss_val': 0.030204471067963517, 'psi': 0.9906713465889705}
[S4] START round=3 head_norm_before_train=2.093199 cos_to_last_merge=0.9952 (last merge round=1)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.8902180220959897, 'auprc': 0.9268507785350945, 'loss_val': 0.42762981441146464, 'psi': 0.9048711246716317}-{'f1_val': 0.9399594100330935, 'auprc': 0.959995505317101, 'loss_val': 0.3100593221647604, 'psi': 0.9479738481466965}
[S5] START round=3 head_norm_before_train=2.240331 cos_to_last_merge=0.9978 (last merge round=1)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.998168419773744, 'auprc': 0.9965299147006484, 'loss_val': 0.03366849223458428, 'psi': 0.9975130177445057}-{'f1_val': 0.9970241334269112, 'auprc': 0.9991384655099804, 'loss_val': 0.022987724855458178, 'psi': 0.997869866260139}
[S6] START round=3 head_norm_before_train=2.304988 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.6875861175547883, 'auprc': 0.8580970544554961, 'loss_val': 1.0097715034107826, 'psi': 0.7557904923150713}-{'f1_val': 0.6719668870909058, 'auprc': 0.9199124670611251, 'loss_val': 0.7591052763185876, 'psi': 0.7711451190789935}
[S7] START round=3 head_norm_before_train=2.124912 cos_to_last_merge=0.9987 (last merge round=1)
[S7] round=3 local utility u=0.087934 metrics={'f1_val': 0.6113141021438879, 'auprc': 0.7910039963203506, 'loss_val': 0.5610369121311598, 'psi': 0.683190059814473}-{'f1_val': 0.6011470717778904, 'auprc': 0.7878681744999743, 'loss_val': 0.6664950683490416, 'psi': 0.6758355128667239}
[S8] START round=3 head_norm_before_train=2.308027 (no previous merge yet)
[S8] round=3 local utility u=0.005539 metrics={'f1_val': 0.9948191519027916, 'auprc': 0.9995509683055199, 'loss_val': 0.021186055281678707, 'psi': 0.9967118784638829}-{'f1_val': 0.9943863538992247, 'auprc': 0.9992976118699088, 'loss_val': 0.028908120502438298, 'psi': 0.9963508570874984}
[S9] START round=3 head_norm_before_train=2.238574 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.9931261513204096, 'auprc': 0.9999453901781743, 'loss_val': 0.020037511938046423, 'psi': 0.9958538468635155}-{'f1_val': 0.9950534268485727, 'auprc': 0.9999463059020863, 'loss_val': 0.016844033839856925, 'psi': 0.9970105784699781}
[S10] START round=3 head_norm_before_train=2.295360 cos_to_last_merge=0.9980 (last merge round=1)
[S10] round=3 local utility u=0.001896 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9980823911577371, 'loss_val': 0.031131974563737487, 'psi': 0.9952925813556384}-{'f1_val': 0.9934327081542391, 'auprc': 0.9969694864406151, 'loss_val': 0.031585113705909544, 'psi': 0.9948474194687895}
[S11] START round=3 head_norm_before_train=2.394178 (no previous merge yet)
[S11] round=3 local utility u=0.022285 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9995378395206249, 'loss_val': 0.01627539197779455, 'psi': 0.9977456888053083}-{'f1_val': 0.9962850284706224, 'auprc': 0.9980820758448937, 'loss_val': 0.05488184173019403, 'psi': 0.997003847420331}
[S13] START round=3 head_norm_before_train=2.030988 (no previous merge yet)
[S13] round=3 local utility u=0.065053 metrics={'f1_val': 0.7269248479683252, 'auprc': 0.8681169468484432, 'loss_val': 0.8349919041067203, 'psi': 0.7834016875203724}-{'f1_val': 0.7349406738815237, 'auprc': 0.8101296128139521, 'loss_val': 0.8392311983794404, 'psi': 0.7650162494544951}
[S14] START round=3 head_norm_before_train=2.350424 (no previous merge yet)
[S14] round=3 local utility u=0.484963 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9992030064187848, 'loss_val': 0.013247559480026157, 'psi': 0.9986210090438369}-{'f1_val': 0.8769055680160909, 'auprc': 0.9987118752465585, 'loss_val': 0.25373515409932507, 'psi': 0.9256280909082779}
[S15] START round=3 head_norm_before_train=2.388907 cos_to_last_merge=0.9994 (last merge round=1)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.987939970038929, 'auprc': 0.9982208822487632, 'loss_val': 0.03014667915158192, 'psi': 0.9920523349228626}-{'f1_val': 0.9963324108488076, 'auprc': 0.9981893641863594, 'loss_val': 0.026654705045966266, 'psi': 0.9970751921838283}
[S16] START round=3 head_norm_before_train=2.297970 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.9935710748898013, 'auprc': 0.9863931672195727, 'loss_val': 0.03028082999916756, 'psi': 0.9906999118217099}-{'f1_val': 0.9935942725856693, 'auprc': 0.988846832329952, 'loss_val': 0.029247003124970035, 'psi': 0.9916952964833824}
[S17] START round=3 head_norm_before_train=2.329772 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=1.000000 metrics={'f1_val': 0.8449931309707492, 'auprc': 0.9657323941135887, 'loss_val': 0.4821761325116743, 'psi': 0.893288836227885}-{'f1_val': 0.628390485109353, 'auprc': 0.8685725481203783, 'loss_val': 1.0102217251264038, 'psi': 0.7244633103137632}
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S2] START round=4 head_norm_before_train=2.282409 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.8330149316327915, 'auprc': 0.9394173388415752, 'loss_val': 0.2749431737073076, 'psi': 0.875575894516305}-{'f1_val': 0.9145972357354817, 'auprc': 0.9813958717704516, 'loss_val': 0.247325640673044, 'psi': 0.9413166901494696}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=4 head_norm_before_train=2.448674 (no previous merge yet)
[S3] round=4 local utility u=0.187834 metrics={'f1_val': 0.8694240556191986, 'auprc': 0.9986710482694021, 'loss_val': 0.23410278368063192, 'psi': 0.92112285267928}-{'f1_val': 0.8117931004417724, 'auprc': 0.998334352940267, 'loss_val': 0.26297517857675257, 'psi': 0.8864096014411702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=4 head_norm_before_train=2.155057 cos_to_last_merge=0.9881 (last merge round=1)
[S4] round=4 local utility u=0.237212 metrics={'f1_val': 0.9409131206262733, 'auprc': 0.947079160074079, 'loss_val': 0.3180606625886767, 'psi': 0.9433795364053956}-{'f1_val': 0.8902180220959897, 'auprc': 0.9268507785350945, 'loss_val': 0.42762981441146464, 'psi': 0.9048711246716317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=4 head_norm_before_train=2.348902 cos_to_last_merge=0.9922 (last merge round=1)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.9929375238115311, 'loss_val': 0.0361965817978129, 'psi': 0.9952387303056943}-{'f1_val': 0.998168419773744, 'auprc': 0.9965299147006484, 'loss_val': 0.03366849223458428, 'psi': 0.9975130177445057}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=4 head_norm_before_train=2.439561 (no previous merge yet)
[S6] round=4 local utility u=0.817099 metrics={'f1_val': 0.8121348378771955, 'auprc': 0.9509952541998463, 'loss_val': 0.4015596420538527, 'psi': 0.8676790044062559}-{'f1_val': 0.6875861175547883, 'auprc': 0.8580970544554961, 'loss_val': 1.0097715034107826, 'psi': 0.7557904923150713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=4 head_norm_before_train=2.226360 cos_to_last_merge=0.9965 (last merge round=1)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.6100110700386085, 'auprc': 0.7852787083057433, 'loss_val': 0.6740956163207176, 'psi': 0.6801181253454625}-{'f1_val': 0.6113141021438879, 'auprc': 0.7910039963203506, 'loss_val': 0.5610369121311598, 'psi': 0.683190059814473}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=4 head_norm_before_train=2.438482 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.9943863538992247, 'auprc': 0.9995629452847515, 'loss_val': 0.02248499468115142, 'psi': 0.9964569904534354}-{'f1_val': 0.9948191519027916, 'auprc': 0.9995509683055199, 'loss_val': 0.021186055281678707, 'psi': 0.9967118784638829}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=4 head_norm_before_train=2.342898 (no previous merge yet)
[S9] round=4 local utility u=0.016957 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9999591687522027, 'loss_val': 0.012491331652624237, 'psi': 0.9984919579549276}-{'f1_val': 0.9931261513204096, 'auprc': 0.9999453901781743, 'loss_val': 0.020037511938046423, 'psi': 0.9958538468635155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S9] sending update (kind=head size=1788 to 1 peers)
[S10] START round=4 head_norm_before_train=2.378525 cos_to_last_merge=0.9929 (last merge round=1)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.9932136491405474, 'auprc': 0.9977099809347967, 'loss_val': 0.03192320493951999, 'psi': 0.9950121818582471}-{'f1_val': 0.9934327081542391, 'auprc': 0.9980823911577371, 'loss_val': 0.031131974563737487, 'psi': 0.9952925813556384}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=4 head_norm_before_train=2.544419 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9994340444668595, 'loss_val': 0.01698410104897981, 'psi': 0.9977041707838021}-{'f1_val': 0.9965509216617638, 'auprc': 0.9995378395206249, 'loss_val': 0.01627539197779455, 'psi': 0.9977456888053083}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=4 head_norm_before_train=2.163282 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.7150267791748549, 'auprc': 0.9409762529501082, 'loss_val': 1.033138100931844, 'psi': 0.8054065686849563}-{'f1_val': 0.7269248479683252, 'auprc': 0.8681169468484432, 'loss_val': 0.8349919041067203, 'psi': 0.7834016875203724}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=4 head_norm_before_train=2.467484 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.9668402448558424, 'auprc': 0.9985915461024669, 'loss_val': 0.06444917075754436, 'psi': 0.9795407653544922}-{'f1_val': 0.9982330107938716, 'auprc': 0.9992030064187848, 'loss_val': 0.013247559480026157, 'psi': 0.9986210090438369}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=4 head_norm_before_train=2.484280 cos_to_last_merge=0.9983 (last merge round=1)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.9815036917622131, 'auprc': 0.9982252116017742, 'loss_val': 0.03405277133105534, 'psi': 0.9881922996980376}-{'f1_val': 0.987939970038929, 'auprc': 0.9982208822487632, 'loss_val': 0.03014667915158192, 'psi': 0.9920523349228626}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=4 head_norm_before_train=2.368140 (no previous merge yet)
[S16] round=4 local utility u=0.006416 metrics={'f1_val': 0.9931756767824134, 'auprc': 0.9919547994200976, 'loss_val': 0.03176103006536763, 'psi': 0.9926873258374871}-{'f1_val': 0.9935710748898013, 'auprc': 0.9863931672195727, 'loss_val': 0.03028082999916756, 'psi': 0.9906999118217099}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=4 head_norm_before_train=2.482324 cos_to_last_merge=0.9990 (last merge round=2)
[S17] round=4 local utility u=0.302800 metrics={'f1_val': 0.9026453642967329, 'auprc': 0.9801610185485636, 'loss_val': 0.2657752830135333, 'psi': 0.9336516259974652}-{'f1_val': 0.8449931309707492, 'auprc': 0.9657323941135887, 'loss_val': 0.4821761325116743, 'psi': 0.893288836227885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=5 head_norm_before_train=2.344317 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.8315022906259294, 'auprc': 0.9503345682474602, 'loss_val': 0.3318700824024063, 'psi': 0.8790352016745417}-{'f1_val': 0.8330149316327915, 'auprc': 0.9394173388415752, 'loss_val': 0.2749431737073076, 'psi': 0.875575894516305}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=5 head_norm_before_train=2.583108 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.8149842773045157, 'auprc': 0.9985346142440451, 'loss_val': 0.39013707073634907, 'psi': 0.8884044120803275}-{'f1_val': 0.8694240556191986, 'auprc': 0.9986710482694021, 'loss_val': 0.23410278368063192, 'psi': 0.92112285267928}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=5 head_norm_before_train=2.214187 cos_to_last_merge=0.9776 (last merge round=1)
[S4] round=5 local utility u=0.089424 metrics={'f1_val': 0.9512096320304004, 'auprc': 0.9823403417127547, 'loss_val': 0.30677567480754314, 'psi': 0.9636619159033422}-{'f1_val': 0.9409131206262733, 'auprc': 0.947079160074079, 'loss_val': 0.3180606625886767, 'psi': 0.9433795364053956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=5 head_norm_before_train=2.397044 cos_to_last_merge=0.9841 (last merge round=1)
[S5] round=5 local utility u=0.013373 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9963398590000825, 'loss_val': 0.021866460912232204, 'psi': 0.996820560800808}-{'f1_val': 0.9967728679684698, 'auprc': 0.9929375238115311, 'loss_val': 0.0361965817978129, 'psi': 0.9952387303056943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] sending update (kind=head size=1791 to 1 peers)
[S6] START round=5 head_norm_before_train=2.583583 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.7123787702711523, 'auprc': 0.8498754636591914, 'loss_val': 0.8382069789403691, 'psi': 0.767377447626368}-{'f1_val': 0.8121348378771955, 'auprc': 0.9509952541998463, 'loss_val': 0.4015596420538527, 'psi': 0.8676790044062559}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=5 head_norm_before_train=2.316105 cos_to_last_merge=0.9936 (last merge round=1)
[S7] round=5 local utility u=0.002970 metrics={'f1_val': 0.5902878619300591, 'auprc': 0.7895667681423018, 'loss_val': 0.562679711246545, 'psi': 0.6699994244149562}-{'f1_val': 0.6100110700386085, 'auprc': 0.7852787083057433, 'loss_val': 0.6740956163207176, 'psi': 0.6801181253454625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=5 head_norm_before_train=2.537024 (no previous merge yet)
[S8] round=5 local utility u=0.000000 metrics={'f1_val': 0.8317815398630984, 'auprc': 0.8729007663249408, 'loss_val': 0.32450725596429675, 'psi': 0.8482292304478354}-{'f1_val': 0.9943863538992247, 'auprc': 0.9995629452847515, 'loss_val': 0.02248499468115142, 'psi': 0.9964569904534354}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=5 head_norm_before_train=2.434217 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.999599336563586, 'loss_val': 0.013077979466159576, 'psi': 0.998348025079481}-{'f1_val': 0.9975138174234109, 'auprc': 0.9999591687522027, 'loss_val': 0.012491331652624237, 'psi': 0.9984919579549276}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=5 head_norm_before_train=2.461230 cos_to_last_merge=0.9872 (last merge round=1)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.9932136491405474, 'auprc': 0.9976958851372901, 'loss_val': 0.03289460964629829, 'psi': 0.9950065435392446}-{'f1_val': 0.9932136491405474, 'auprc': 0.9977099809347967, 'loss_val': 0.03192320493951999, 'psi': 0.9950121818582471}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=5 head_norm_before_train=2.622858 (no previous merge yet)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.999445548104128, 'loss_val': 0.01755139323308671, 'psi': 0.9977087722387096}-{'f1_val': 0.9965509216617638, 'auprc': 0.9994340444668595, 'loss_val': 0.01698410104897981, 'psi': 0.9977041707838021}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=5 head_norm_before_train=2.322550 (no previous merge yet)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.6892842753391137, 'auprc': 0.8453788235826973, 'loss_val': 0.9487126290918391, 'psi': 0.7517220946365473}-{'f1_val': 0.7150267791748549, 'auprc': 0.9409762529501082, 'loss_val': 1.033138100931844, 'psi': 0.8054065686849563}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=5 head_norm_before_train=2.518597 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.834315611597998, 'auprc': 0.9989165814527339, 'loss_val': 0.2844903564657128, 'psi': 0.9001559995398924}-{'f1_val': 0.9668402448558424, 'auprc': 0.9985915461024669, 'loss_val': 0.06444917075754436, 'psi': 0.9795407653544922}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=5 head_norm_before_train=2.559898 cos_to_last_merge=0.9973 (last merge round=1)
[S15] round=5 local utility u=0.000000 metrics={'f1_val': 0.9810700326853032, 'auprc': 0.998271353163301, 'loss_val': 0.034063901257169606, 'psi': 0.9879505608765022}-{'f1_val': 0.9815036917622131, 'auprc': 0.9982252116017742, 'loss_val': 0.03405277133105534, 'psi': 0.9881922996980376}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=5 head_norm_before_train=2.452421 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.9939834183609159, 'auprc': 0.9886658735848655, 'loss_val': 0.029358545755699902, 'psi': 0.9918564004504957}-{'f1_val': 0.9931756767824134, 'auprc': 0.9919547994200976, 'loss_val': 0.03176103006536763, 'psi': 0.9926873258374871}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=5 head_norm_before_train=2.588341 cos_to_last_merge=0.9972 (last merge round=2)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.88767286519185, 'auprc': 0.9772742204653785, 'loss_val': 0.5435294266585352, 'psi': 0.9235134073012614}-{'f1_val': 0.9026453642967329, 'auprc': 0.9801610185485636, 'loss_val': 0.2657752830135333, 'psi': 0.9336516259974652}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=6 head_norm_before_train=2.475911 (no previous merge yet)
[S2] round=6 local utility u=0.264929 metrics={'f1_val': 0.9128032788993568, 'auprc': 0.9358588883347668, 'loss_val': 0.2463913924748111, 'psi': 0.9220255226735208}-{'f1_val': 0.8315022906259294, 'auprc': 0.9503345682474602, 'loss_val': 0.3318700824024063, 'psi': 0.8790352016745417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=6 head_norm_before_train=2.665499 (no previous merge yet)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.8085190667338259, 'auprc': 0.9985293800656652, 'loss_val': 0.45268783219913455, 'psi': 0.8845231920665616}-{'f1_val': 0.8149842773045157, 'auprc': 0.9985346142440451, 'loss_val': 0.39013707073634907, 'psi': 0.8884044120803275}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=6 head_norm_before_train=2.281900 cos_to_last_merge=0.9680 (last merge round=1)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.9396362668971457, 'auprc': 0.9618261165350364, 'loss_val': 0.3329049959593921, 'psi': 0.948512206752302}-{'f1_val': 0.9512096320304004, 'auprc': 0.9823403417127547, 'loss_val': 0.30677567480754314, 'psi': 0.9636619159033422}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=6 head_norm_before_train=2.492057 cos_to_last_merge=0.9782 (last merge round=1)
[S5] round=6 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9938568550880973, 'loss_val': 0.021089845099493375, 'psi': 0.9955639231223135}-{'f1_val': 0.9971410286679584, 'auprc': 0.9963398590000825, 'loss_val': 0.021866460912232204, 'psi': 0.996820560800808}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=6 head_norm_before_train=2.726681 (no previous merge yet)
[S6] round=6 local utility u=0.458758 metrics={'f1_val': 0.7821162886856594, 'auprc': 0.9361168695785508, 'loss_val': 0.5978410120224186, 'psi': 0.8437165210428159}-{'f1_val': 0.7123787702711523, 'auprc': 0.8498754636591914, 'loss_val': 0.8382069789403691, 'psi': 0.767377447626368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=6 head_norm_before_train=2.371489 cos_to_last_merge=0.9905 (last merge round=1)
[S7] round=6 local utility u=0.030116 metrics={'f1_val': 0.6028801805544414, 'auprc': 0.8182132960589608, 'loss_val': 0.6639413602071824, 'psi': 0.6890134267562491}-{'f1_val': 0.5902878619300591, 'auprc': 0.7895667681423018, 'loss_val': 0.562679711246545, 'psi': 0.6699994244149562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=6 head_norm_before_train=2.616184 (no previous merge yet)
[S8] round=6 local utility u=0.824318 metrics={'f1_val': 0.9934630163438034, 'auprc': 0.9997665769662165, 'loss_val': 0.026557292737633374, 'psi': 0.9959844405927687}-{'f1_val': 0.8317815398630984, 'auprc': 0.8729007663249408, 'loss_val': 0.32450725596429675, 'psi': 0.8482292304478354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=6 head_norm_before_train=2.504378 (no previous merge yet)
[S9] round=6 local utility u=0.000936 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9999772838829508, 'loss_val': 0.01233886800799741, 'psi': 0.9984992040072269}-{'f1_val': 0.9975138174234109, 'auprc': 0.999599336563586, 'loss_val': 0.013077979466159576, 'psi': 0.998348025079481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=6 head_norm_before_train=2.533329 cos_to_last_merge=0.9817 (last merge round=1)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.9932136491405474, 'auprc': 0.9973391289767364, 'loss_val': 0.033968522972310275, 'psi': 0.994863841075023}-{'f1_val': 0.9932136491405474, 'auprc': 0.9976958851372901, 'loss_val': 0.03289460964629829, 'psi': 0.9950065435392446}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=6 head_norm_before_train=2.683971 (no previous merge yet)
[S11] round=6 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9994327957360477, 'loss_val': 0.01790155712416757, 'psi': 0.9977036712914774}-{'f1_val': 0.9965509216617638, 'auprc': 0.999445548104128, 'loss_val': 0.01755139323308671, 'psi': 0.9977087722387096}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=6 head_norm_before_train=2.407501 (no previous merge yet)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.6352807288219785, 'auprc': 0.7989884544367387, 'loss_val': 1.0057718011707015, 'psi': 0.7007638190678827}-{'f1_val': 0.6892842753391137, 'auprc': 0.8453788235826973, 'loss_val': 0.9487126290918391, 'psi': 0.7517220946365473}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=6 head_norm_before_train=2.621163 (no previous merge yet)
[S14] round=6 local utility u=0.352274 metrics={'f1_val': 0.9273351469083868, 'auprc': 0.9989115362648565, 'loss_val': 0.13804393605190124, 'psi': 0.9559657026509747}-{'f1_val': 0.834315611597998, 'auprc': 0.9989165814527339, 'loss_val': 0.2844903564657128, 'psi': 0.9001559995398924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] sending update (kind=head size=1791 to 1 peers)
[S15] START round=6 head_norm_before_train=2.622946 cos_to_last_merge=0.9962 (last merge round=1)
[S15] round=6 local utility u=0.004226 metrics={'f1_val': 0.9823692600192115, 'auprc': 0.9983179958326809, 'loss_val': 0.033546276670237365, 'psi': 0.9887487543445993}-{'f1_val': 0.9810700326853032, 'auprc': 0.998271353163301, 'loss_val': 0.034063901257169606, 'psi': 0.9879505608765022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=6 head_norm_before_train=2.532014 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.9927073212700421, 'auprc': 0.988605642461411, 'loss_val': 0.033946034130851656, 'psi': 0.9910666497465896}-{'f1_val': 0.9939834183609159, 'auprc': 0.9886658735848655, 'loss_val': 0.029358545755699902, 'psi': 0.9918564004504957}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=6 head_norm_before_train=2.652573 cos_to_last_merge=0.9961 (last merge round=2)
[S17] round=6 local utility u=0.029418 metrics={'f1_val': 0.8865957412000773, 'auprc': 0.9785199261459425, 'loss_val': 0.48196728744844824, 'psi': 0.9233654151784234}-{'f1_val': 0.88767286519185, 'auprc': 0.9772742204653785, 'loss_val': 0.5435294266585352, 'psi': 0.9235134073012614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=7 head_norm_before_train=2.575943 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.8726210776758457, 'auprc': 0.9359071562848617, 'loss_val': 0.28532243495495035, 'psi': 0.8979355091194521}-{'f1_val': 0.9128032788993568, 'auprc': 0.9358588883347668, 'loss_val': 0.2463913924748111, 'psi': 0.9220255226735208}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=7 head_norm_before_train=2.729817 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.8036512104170096, 'auprc': 0.9983504573161102, 'loss_val': 0.49499414027718674, 'psi': 0.8815309091766499}-{'f1_val': 0.8085190667338259, 'auprc': 0.9985293800656652, 'loss_val': 0.45268783219913455, 'psi': 0.8845231920665616}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=7 head_norm_before_train=2.344543 cos_to_last_merge=0.9580 (last merge round=1)
[S4] round=7 local utility u=0.042493 metrics={'f1_val': 0.9401595216941746, 'auprc': 0.9831194865228415, 'loss_val': 0.31493839252547584, 'psi': 0.9573435076256414}-{'f1_val': 0.9396362668971457, 'auprc': 0.9618261165350364, 'loss_val': 0.3329049959593921, 'psi': 0.948512206752302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=7 head_norm_before_train=2.557615 cos_to_last_merge=0.9738 (last merge round=1)
[S5] round=7 local utility u=0.012464 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.999166252919157, 'loss_val': 0.01472430147293212, 'psi': 0.9979511183684378}-{'f1_val': 0.9967019684784577, 'auprc': 0.9938568550880973, 'loss_val': 0.021089845099493375, 'psi': 0.9955639231223135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] START round=7 head_norm_before_train=2.861767 (no previous merge yet)
[S6] round=7 local utility u=0.059658 metrics={'f1_val': 0.799491202408969, 'auprc': 0.9445592750352374, 'loss_val': 0.6081010238474203, 'psi': 0.8575184314594764}-{'f1_val': 0.7821162886856594, 'auprc': 0.9361168695785508, 'loss_val': 0.5978410120224186, 'psi': 0.8437165210428159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=7 head_norm_before_train=2.491715 cos_to_last_merge=0.9795 (last merge round=1)
[S7] round=7 local utility u=1.000000 metrics={'f1_val': 0.9117109008000363, 'auprc': 0.9850429348528542, 'loss_val': 0.2734496327878946, 'psi': 0.9410437144211634}-{'f1_val': 0.6028801805544414, 'auprc': 0.8182132960589608, 'loss_val': 0.6639413602071824, 'psi': 0.6890134267562491}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] sending update (kind=head size=1790 to 1 peers)
[S8] START round=7 head_norm_before_train=2.684814 (no previous merge yet)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.9889292690494621, 'auprc': 0.9993524887691706, 'loss_val': 0.040843036989024153, 'psi': 0.9930985569373455}-{'f1_val': 0.9934630163438034, 'auprc': 0.9997665769662165, 'loss_val': 0.026557292737633374, 'psi': 0.9959844405927687}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=7 head_norm_before_train=2.576441 (no previous merge yet)
[S9] round=7 local utility u=0.002325 metrics={'f1_val': 0.9979252083193341, 'auprc': 0.999982425940316, 'loss_val': 0.01017357691561797, 'psi': 0.9987480953677269}-{'f1_val': 0.9975138174234109, 'auprc': 0.9999772838829508, 'loss_val': 0.01233886800799741, 'psi': 0.9984992040072269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=7 head_norm_before_train=2.599747 cos_to_last_merge=0.9775 (last merge round=1)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.9932136491405474, 'auprc': 0.9973054803597333, 'loss_val': 0.03452168920577538, 'psi': 0.9948503816282218}-{'f1_val': 0.9932136491405474, 'auprc': 0.9973391289767364, 'loss_val': 0.033968522972310275, 'psi': 0.994863841075023}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=7 head_norm_before_train=2.738533 (no previous merge yet)
[S11] round=7 local utility u=0.000945 metrics={'f1_val': 0.9969845827789485, 'auprc': 0.9991212533367851, 'loss_val': 0.01767796217076238, 'psi': 0.9978392510020831}-{'f1_val': 0.9965509216617638, 'auprc': 0.9994327957360477, 'loss_val': 0.01790155712416757, 'psi': 0.9977036712914774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] sending update (kind=head size=1788 to 1 peers)
[S13] START round=7 head_norm_before_train=2.496790 (no previous merge yet)
[S13] round=7 local utility u=0.450048 metrics={'f1_val': 0.7297528928271155, 'auprc': 0.8647007661223103, 'loss_val': 0.8696464600106993, 'psi': 0.7837320421451934}-{'f1_val': 0.6352807288219785, 'auprc': 0.7989884544367387, 'loss_val': 1.0057718011707015, 'psi': 0.7007638190678827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=7 head_norm_before_train=2.706446 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.8856236390503767, 'auprc': 0.9989190522638054, 'loss_val': 0.2034519809095706, 'psi': 0.9309418043357482}-{'f1_val': 0.9273351469083868, 'auprc': 0.9989115362648565, 'loss_val': 0.13804393605190124, 'psi': 0.9559657026509747}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=7 head_norm_before_train=2.677842 cos_to_last_merge=0.9952 (last merge round=1)
[S15] round=7 local utility u=0.005513 metrics={'f1_val': 0.9840934723770813, 'auprc': 0.9983370554060549, 'loss_val': 0.032922850946163165, 'psi': 0.9897909055886708}-{'f1_val': 0.9823692600192115, 'auprc': 0.9983179958326809, 'loss_val': 0.033546276670237365, 'psi': 0.9887487543445993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=7 head_norm_before_train=2.613936 (no previous merge yet)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.9931117765572137, 'auprc': 0.985187710491009, 'loss_val': 0.035743724212941745, 'psi': 0.9899421501307318}-{'f1_val': 0.9927073212700421, 'auprc': 0.988605642461411, 'loss_val': 0.033946034130851656, 'psi': 0.9910666497465896}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=7 head_norm_before_train=2.728812 cos_to_last_merge=0.9945 (last merge round=2)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.8836111822693156, 'auprc': 0.9715192523941595, 'loss_val': 0.5560191649068253, 'psi': 0.9187744103192531}-{'f1_val': 0.8865957412000773, 'auprc': 0.9785199261459425, 'loss_val': 0.48196728744844824, 'psi': 0.9233654151784234}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=8 head_norm_before_train=2.660126 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.8360288496542123, 'auprc': 0.9438465196202549, 'loss_val': 0.3106544633205023, 'psi': 0.8791559176406294}-{'f1_val': 0.8726210776758457, 'auprc': 0.9359071562848617, 'loss_val': 0.28532243495495035, 'psi': 0.8979355091194521}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=8 head_norm_before_train=2.783577 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.7994785330746761, 'auprc': 0.9981962469480369, 'loss_val': 0.5395759150831548, 'psi': 0.8789656186240205}-{'f1_val': 0.8036512104170096, 'auprc': 0.9983504573161102, 'loss_val': 0.49499414027718674, 'psi': 0.8815309091766499}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=8 head_norm_before_train=2.394078 cos_to_last_merge=0.9520 (last merge round=1)
[S4] round=8 local utility u=0.039846 metrics={'f1_val': 0.948804785558824, 'auprc': 0.9862425314661623, 'loss_val': 0.29648679379424103, 'psi': 0.9637798839217593}-{'f1_val': 0.9401595216941746, 'auprc': 0.9831194865228415, 'loss_val': 0.31493839252547584, 'psi': 0.9573435076256414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=8 head_norm_before_train=2.623580 cos_to_last_merge=0.9703 (last merge round=1)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.9978756509554264, 'auprc': 0.9969912572455106, 'loss_val': 0.029749103287457026, 'psi': 0.99752189347146}-{'f1_val': 0.9971410286679584, 'auprc': 0.999166252919157, 'loss_val': 0.01472430147293212, 'psi': 0.9979511183684378}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=8 head_norm_before_train=2.979459 (no previous merge yet)
[S6] round=8 local utility u=0.266862 metrics={'f1_val': 0.8279915910110763, 'auprc': 0.9631896600466107, 'loss_val': 0.30127002222677024, 'psi': 0.8820708186252901}-{'f1_val': 0.799491202408969, 'auprc': 0.9445592750352374, 'loss_val': 0.6081010238474203, 'psi': 0.8575184314594764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=8 head_norm_before_train=2.607669 cos_to_last_merge=0.9667 (last merge round=1)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.7458052020923137, 'auprc': 0.9678696861976213, 'loss_val': 0.7354109799320111, 'psi': 0.8346309957344367}-{'f1_val': 0.9117109008000363, 'auprc': 0.9850429348528542, 'loss_val': 0.2734496327878946, 'psi': 0.9410437144211634}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=8 head_norm_before_train=2.797949 (no previous merge yet)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.819507180922531, 'auprc': 0.9362627157675238, 'loss_val': 0.40413294669645977, 'psi': 0.8662093948605282}-{'f1_val': 0.9889292690494621, 'auprc': 0.9993524887691706, 'loss_val': 0.040843036989024153, 'psi': 0.9930985569373455}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=8 head_norm_before_train=2.647802 (no previous merge yet)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9999863918184109, 'loss_val': 0.012750250075519377, 'psi': 0.9985028471814109}-{'f1_val': 0.9979252083193341, 'auprc': 0.999982425940316, 'loss_val': 0.01017357691561797, 'psi': 0.9987480953677269}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=8 head_norm_before_train=2.662339 cos_to_last_merge=0.9745 (last merge round=1)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.9932136491405474, 'auprc': 0.9968796773691526, 'loss_val': 0.036747945950323616, 'psi': 0.9946800604319895}-{'f1_val': 0.9932136491405474, 'auprc': 0.9973054803597333, 'loss_val': 0.03452168920577538, 'psi': 0.9948503816282218}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=8 head_norm_before_train=2.732240 (no previous merge yet)
[S11] round=8 local utility u=0.000214 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9991999957082397, 'loss_val': 0.015005407419776328, 'psi': 0.9976227471505706}-{'f1_val': 0.9969845827789485, 'auprc': 0.9991212533367851, 'loss_val': 0.01767796217076238, 'psi': 0.9978392510020831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] sending update (kind=head size=1790 to 1 peers)
[S13] START round=8 head_norm_before_train=2.539739 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.6514708337798866, 'auprc': 0.8182861967517542, 'loss_val': 1.1726856696248846, 'psi': 0.7181969789686335}-{'f1_val': 0.7297528928271155, 'auprc': 0.8647007661223103, 'loss_val': 0.8696464600106993, 'psi': 0.7837320421451934}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=8 head_norm_before_train=2.772194 (no previous merge yet)
[S14] round=8 local utility u=0.430994 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9988814802420816, 'loss_val': 0.01598457917727564, 'psi': 0.9983900120060405}-{'f1_val': 0.8856236390503767, 'auprc': 0.9989190522638054, 'loss_val': 0.2034519809095706, 'psi': 0.9309418043357482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] sending update (kind=head size=1791 to 1 peers)
[S15] START round=8 head_norm_before_train=2.726305 cos_to_last_merge=0.9943 (last merge round=1)
[S15] round=8 local utility u=0.012498 metrics={'f1_val': 0.987939970038929, 'auprc': 0.9983623661639851, 'loss_val': 0.031082683395583476, 'psi': 0.9921089284889514}-{'f1_val': 0.9840934723770813, 'auprc': 0.9983370554060549, 'loss_val': 0.032922850946163165, 'psi': 0.9897909055886708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=8 head_norm_before_train=2.676916 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.9905882650119875, 'auprc': 0.9902380420296295, 'loss_val': 0.0588605208757986, 'psi': 0.9904481758190442}-{'f1_val': 0.9931117765572137, 'auprc': 0.985187710491009, 'loss_val': 0.035743724212941745, 'psi': 0.9899421501307318}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=8 head_norm_before_train=2.783583 cos_to_last_merge=0.9931 (last merge round=2)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.876171019658817, 'auprc': 0.9439158724963362, 'loss_val': 0.6088127096430944, 'psi': 0.9032689607938247}-{'f1_val': 0.8836111822693156, 'auprc': 0.9715192523941595, 'loss_val': 0.5560191649068253, 'psi': 0.9187744103192531}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=9 head_norm_before_train=2.736653 (no previous merge yet)
[S2] round=9 local utility u=0.234636 metrics={'f1_val': 0.9087556312466013, 'auprc': 0.9477437860472666, 'loss_val': 0.28943476682194136, 'psi': 0.9243508931668674}-{'f1_val': 0.8360288496542123, 'auprc': 0.9438465196202549, 'loss_val': 0.3106544633205023, 'psi': 0.8791559176406294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=9 head_norm_before_train=2.830866 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.7904104120891708, 'auprc': 0.9980803114295692, 'loss_val': 0.6273391213967191, 'psi': 0.8734783718253303}-{'f1_val': 0.7994785330746761, 'auprc': 0.9981962469480369, 'loss_val': 0.5395759150831548, 'psi': 0.8789656186240205}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=9 head_norm_before_train=2.513590 cos_to_last_merge=0.9511 (last merge round=1)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.9076343157638931, 'auprc': 0.9271111197583882, 'loss_val': 0.370963595574701, 'psi': 0.9154250373616912}-{'f1_val': 0.948804785558824, 'auprc': 0.9862425314661623, 'loss_val': 0.29648679379424103, 'psi': 0.9637798839217593}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=9 head_norm_before_train=2.718080 cos_to_last_merge=0.9650 (last merge round=1)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.9975086222760589, 'auprc': 0.9955688632854602, 'loss_val': 0.03819606538290317, 'psi': 0.9967327186798194}-{'f1_val': 0.9978756509554264, 'auprc': 0.9969912572455106, 'loss_val': 0.029749103287457026, 'psi': 0.99752189347146}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=9 head_norm_before_train=3.076621 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.827969911421398, 'auprc': 0.9621216685004746, 'loss_val': 0.3222403337175545, 'psi': 0.8816306142530286}-{'f1_val': 0.8279915910110763, 'auprc': 0.9631896600466107, 'loss_val': 0.30127002222677024, 'psi': 0.8820708186252901}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=9 head_norm_before_train=2.790647 cos_to_last_merge=0.9495 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.949
[S7] round=9 local utility u=0.141824 metrics={'f1_val': 0.7880089921325916, 'auprc': 0.9671322762926937, 'loss_val': 0.7027730139430947, 'psi': 0.8596583057966324}-{'f1_val': 0.7458052020923137, 'auprc': 0.9678696861976213, 'loss_val': 0.7354109799320111, 'psi': 0.8346309957344367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=9 head_norm_before_train=2.956844 (no previous merge yet)
[S8] round=9 local utility u=0.801100 metrics={'f1_val': 0.9938030329889089, 'auprc': 0.9952604643949817, 'loss_val': 0.024702106514333154, 'psi': 0.994386005551338}-{'f1_val': 0.819507180922531, 'auprc': 0.9362627157675238, 'loss_val': 0.40413294669645977, 'psi': 0.8662093948605282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=9 head_norm_before_train=2.701813 (no previous merge yet)
[S9] round=9 local utility u=0.004365 metrics={'f1_val': 0.9982059790628092, 'auprc': 0.9999891987993395, 'loss_val': 0.008180753453626005, 'psi': 0.9989192669574213}-{'f1_val': 0.9975138174234109, 'auprc': 0.9999863918184109, 'loss_val': 0.012750250075519377, 'psi': 0.9985028471814109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] sending update (kind=head size=1789 to 1 peers)
[S10] START round=9 head_norm_before_train=2.710769 cos_to_last_merge=0.9707 (last merge round=1)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.992994663041229, 'auprc': 0.9966338362039047, 'loss_val': 0.03885066750335139, 'psi': 0.9944503323062992}-{'f1_val': 0.9932136491405474, 'auprc': 0.9968796773691526, 'loss_val': 0.036747945950323616, 'psi': 0.9946800604319895}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=9 head_norm_before_train=2.833741 (no previous merge yet)
[S11] round=9 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9993932483681608, 'loss_val': 0.016362022040662387, 'psi': 0.9976878523443227}-{'f1_val': 0.9965712481121245, 'auprc': 0.9991999957082397, 'loss_val': 0.015005407419776328, 'psi': 0.9976227471505706}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=9 head_norm_before_train=2.639829 (no previous merge yet)
[S13] round=9 local utility u=0.005782 metrics={'f1_val': 0.6490328307286448, 'auprc': 0.783763841924628, 'loss_val': 1.042925900638264, 'psi': 0.7029252352070381}-{'f1_val': 0.6514708337798866, 'auprc': 0.8182861967517542, 'loss_val': 1.1726856696248846, 'psi': 0.7181969789686335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=9 head_norm_before_train=2.767130 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.9658942758245592, 'auprc': 0.9988312750012374, 'loss_val': 0.08276175104481244, 'psi': 0.9790690754952305}-{'f1_val': 0.9980623665153463, 'auprc': 0.9988814802420816, 'loss_val': 0.01598457917727564, 'psi': 0.9983900120060405}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=9 head_norm_before_train=2.770153 cos_to_last_merge=0.9935 (last merge round=1)
[S15] round=9 local utility u=0.009659 metrics={'f1_val': 0.9909010870725673, 'auprc': 0.9983792421028916, 'loss_val': 0.02958240641991641, 'psi': 0.993892349084697}-{'f1_val': 0.987939970038929, 'auprc': 0.9983623661639851, 'loss_val': 0.031082683395583476, 'psi': 0.9921089284889514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] sending update (kind=head size=1789 to 1 peers)
[S16] START round=9 head_norm_before_train=2.689605 (no previous merge yet)
[S16] round=9 local utility u=0.021597 metrics={'f1_val': 0.9926075423382205, 'auprc': 0.9916213749486043, 'loss_val': 0.03193206855920568, 'psi': 0.9922130753823739}-{'f1_val': 0.9905882650119875, 'auprc': 0.9902380420296295, 'loss_val': 0.0588605208757986, 'psi': 0.9904481758190442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=9 head_norm_before_train=2.836872 cos_to_last_merge=0.9915 (last merge round=2)
[S17] round=9 local utility u=0.086156 metrics={'f1_val': 0.8817698246344141, 'auprc': 0.9689300331967059, 'loss_val': 0.5451369682274869, 'psi': 0.9166339080593309}-{'f1_val': 0.876171019658817, 'auprc': 0.9439158724963362, 'loss_val': 0.6088127096430944, 'psi': 0.9032689607938247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=10 head_norm_before_train=2.796870 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.8323586001214193, 'auprc': 0.9629197322899196, 'loss_val': 0.32416066359858603, 'psi': 0.8845830529888195}-{'f1_val': 0.9087556312466013, 'auprc': 0.9477437860472666, 'loss_val': 0.28943476682194136, 'psi': 0.9243508931668674}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=10 head_norm_before_train=2.873309 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.7895028513997417, 'auprc': 0.9980434684259736, 'loss_val': 0.668062677355752, 'psi': 0.8729190982102345}-{'f1_val': 0.7904104120891708, 'auprc': 0.9980803114295692, 'loss_val': 0.6273391213967191, 'psi': 0.8734783718253303}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=10 head_norm_before_train=2.567328 cos_to_last_merge=0.9518 (last merge round=1)
[S4] round=10 local utility u=0.206006 metrics={'f1_val': 0.9235212361386393, 'auprc': 0.9901719169474477, 'loss_val': 0.2434545700621436, 'psi': 0.9501815084621626}-{'f1_val': 0.9076343157638931, 'auprc': 0.9271111197583882, 'loss_val': 0.370963595574701, 'psi': 0.9154250373616912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=10 head_norm_before_train=2.750641 cos_to_last_merge=0.9635 (last merge round=1)
[S5] round=10 local utility u=0.009341 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9970035251835037, 'loss_val': 0.0216132915822099, 'psi': 0.9970860272741764}-{'f1_val': 0.9975086222760589, 'auprc': 0.9955688632854602, 'loss_val': 0.03819606538290317, 'psi': 0.9967327186798194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=10 head_norm_before_train=3.143198 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.8272421427826832, 'auprc': 0.9611299179889004, 'loss_val': 0.3315555494472793, 'psi': 0.8807972528651701}-{'f1_val': 0.827969911421398, 'auprc': 0.9621216685004746, 'loss_val': 0.3222403337175545, 'psi': 0.8816306142530286}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=10 head_norm_before_train=2.905087 cos_to_last_merge=0.9415 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.941
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.7880674689566061, 'auprc': 0.9307397587409456, 'loss_val': 1.0135389331571016, 'psi': 0.8451363848703419}-{'f1_val': 0.7880089921325916, 'auprc': 0.9671322762926937, 'loss_val': 0.7027730139430947, 'psi': 0.8596583057966324}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=10 head_norm_before_train=3.048265 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.714700161746543, 'auprc': 0.9878807857647901, 'loss_val': 0.27242299690280125, 'psi': 0.8239724113538419}-{'f1_val': 0.9938030329889089, 'auprc': 0.9952604643949817, 'loss_val': 0.024702106514333154, 'psi': 0.994386005551338}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=10 head_norm_before_train=2.763203 (no previous merge yet)
[S9] round=10 local utility u=0.003128 metrics={'f1_val': 0.9986173720722079, 'auprc': 0.9999970898811282, 'loss_val': 0.00441615275230017, 'psi': 0.999169259195776}-{'f1_val': 0.9982059790628092, 'auprc': 0.9999891987993395, 'loss_val': 0.008180753453626005, 'psi': 0.9989192669574213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=10 head_norm_before_train=2.757572 cos_to_last_merge=0.9679 (last merge round=1)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.992994663041229, 'auprc': 0.9964041253583986, 'loss_val': 0.040671402515131176, 'psi': 0.9943584479680969}-{'f1_val': 0.992994663041229, 'auprc': 0.9966338362039047, 'loss_val': 0.03885066750335139, 'psi': 0.9944503323062992}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=10 head_norm_before_train=2.889198 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.9915369213227403, 'auprc': 0.9992113749582738, 'loss_val': 0.02897703546645657, 'psi': 0.9946067027769536}-{'f1_val': 0.9965509216617638, 'auprc': 0.9993932483681608, 'loss_val': 0.016362022040662387, 'psi': 0.9976878523443227}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=10 head_norm_before_train=2.729715 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.6317589586172103, 'auprc': 0.7970487226148051, 'loss_val': 1.2634833379639443, 'psi': 0.6978748642162482}-{'f1_val': 0.6490328307286448, 'auprc': 0.783763841924628, 'loss_val': 1.042925900638264, 'psi': 0.7029252352070381}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=10 head_norm_before_train=2.860236 (no previous merge yet)
[S14] round=10 local utility u=0.064881 metrics={'f1_val': 0.983141767583314, 'auprc': 0.9988587039128052, 'loss_val': 0.05656681204905965, 'psi': 0.9894285421151104}-{'f1_val': 0.9658942758245592, 'auprc': 0.9988312750012374, 'loss_val': 0.08276175104481244, 'psi': 0.9790690754952305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=10 head_norm_before_train=2.810239 cos_to_last_merge=0.9926 (last merge round=1)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.9887886891363633, 'auprc': 0.9983888093971196, 'loss_val': 0.030509356570542986, 'psi': 0.9926287372406658}-{'f1_val': 0.9909010870725673, 'auprc': 0.9983792421028916, 'loss_val': 0.02958240641991641, 'psi': 0.993892349084697}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=10 head_norm_before_train=2.766516 (no previous merge yet)
[S16] round=10 local utility u=0.005411 metrics={'f1_val': 0.9950224949794758, 'auprc': 0.9899919964143757, 'loss_val': 0.030711283530932516, 'psi': 0.9930102955534358}-{'f1_val': 0.9926075423382205, 'auprc': 0.9916213749486043, 'loss_val': 0.03193206855920568, 'psi': 0.9922130753823739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=10 head_norm_before_train=2.882178 cos_to_last_merge=0.9902 (last merge round=2)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.8809539075227673, 'auprc': 0.9663324570171851, 'loss_val': 0.5431685712779947, 'psi': 0.9151053273205343}-{'f1_val': 0.8817698246344141, 'auprc': 0.9689300331967059, 'loss_val': 0.5451369682274869, 'psi': 0.9166339080593309}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=11 head_norm_before_train=2.700873 (no previous merge yet)
[S2] round=11 local utility u=0.242578 metrics={'f1_val': 0.9132574034165324, 'auprc': 0.9378266760179751, 'loss_val': 0.2491187791651471, 'psi': 0.9230851124571094}-{'f1_val': 0.8323586001214193, 'auprc': 0.9629197322899196, 'loss_val': 0.32416066359858603, 'psi': 0.8845830529888195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=11 head_norm_before_train=2.912070 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.7864233936765942, 'auprc': 0.9979261391239505, 'loss_val': 0.7178426586316199, 'psi': 0.8710244918555368}-{'f1_val': 0.7895028513997417, 'auprc': 0.9980434684259736, 'loss_val': 0.668062677355752, 'psi': 0.8729190982102345}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=11 head_norm_before_train=2.659089 cos_to_last_merge=0.9497 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.950
[S4] round=11 local utility u=0.099809 metrics={'f1_val': 0.9540391736040257, 'auprc': 0.9873396592412573, 'loss_val': 0.21844675055483764, 'psi': 0.9673593678589183}-{'f1_val': 0.9235212361386393, 'auprc': 0.9901719169474477, 'loss_val': 0.2434545700621436, 'psi': 0.9501815084621626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] sending update (kind=head size=1789 to 1 peers)
[S5] START round=11 head_norm_before_train=2.766963 cos_to_last_merge=0.9641 (last merge round=1)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9956119425781309, 'loss_val': 0.01760235374130777, 'psi': 0.9965293942320274}-{'f1_val': 0.9971410286679584, 'auprc': 0.9970035251835037, 'loss_val': 0.0216132915822099, 'psi': 0.9970860272741764}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=11 head_norm_before_train=3.196710 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.8237218022154394, 'auprc': 0.9610822348189346, 'loss_val': 0.3203955011500345, 'psi': 0.8786659752568375}-{'f1_val': 0.8272421427826832, 'auprc': 0.9611299179889004, 'loss_val': 0.3315555494472793, 'psi': 0.8807972528651701}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=11 head_norm_before_train=2.989988 cos_to_last_merge=0.9373 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.937
[S7] round=11 local utility u=0.299677 metrics={'f1_val': 0.8156493548560758, 'auprc': 0.9677985046804061, 'loss_val': 0.6908530030549993, 'psi': 0.8765090147858079}-{'f1_val': 0.7880674689566061, 'auprc': 0.9307397587409456, 'loss_val': 1.0135389331571016, 'psi': 0.8451363848703419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=11 head_norm_before_train=3.106086 (no previous merge yet)
[S8] round=11 local utility u=0.879120 metrics={'f1_val': 0.9701679859884996, 'auprc': 0.9978268035504494, 'loss_val': 0.0768283098204702, 'psi': 0.9812315130132796}-{'f1_val': 0.714700161746543, 'auprc': 0.9878807857647901, 'loss_val': 0.27242299690280125, 'psi': 0.8239724113538419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=11 head_norm_before_train=2.827195 (no previous merge yet)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.9991172969349544, 'auprc': 0.9999975050414531, 'loss_val': 0.01873351324696579, 'psi': 0.9994693801775538}-{'f1_val': 0.9986173720722079, 'auprc': 0.9999970898811282, 'loss_val': 0.00441615275230017, 'psi': 0.999169259195776}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=11 head_norm_before_train=2.803185 cos_to_last_merge=0.9655 (last merge round=1)
[S10] round=11 local utility u=0.001573 metrics={'f1_val': 0.9932136491405474, 'auprc': 0.9964582590481568, 'loss_val': 0.03900177657078274, 'psi': 0.9945114931035912}-{'f1_val': 0.992994663041229, 'auprc': 0.9964041253583986, 'loss_val': 0.040671402515131176, 'psi': 0.9943584479680969}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=11 head_norm_before_train=2.939067 (no previous merge yet)
[S11] round=11 local utility u=0.019181 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9988042639719481, 'loss_val': 0.019577820043342117, 'psi': 0.9974621879725074}-{'f1_val': 0.9915369213227403, 'auprc': 0.9992113749582738, 'loss_val': 0.02897703546645657, 'psi': 0.9946067027769536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=11 head_norm_before_train=2.816887 (no previous merge yet)
[S13] round=11 local utility u=0.409519 metrics={'f1_val': 0.7256030462905364, 'auprc': 0.8339733357834931, 'loss_val': 1.11828438443892, 'psi': 0.7689511620877191}-{'f1_val': 0.6317589586172103, 'auprc': 0.7970487226148051, 'loss_val': 1.2634833379639443, 'psi': 0.6978748642162482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=11 head_norm_before_train=2.930547 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.9211311948996646, 'auprc': 0.9988436917067143, 'loss_val': 0.17299997660757543, 'psi': 0.9522161936224844}-{'f1_val': 0.983141767583314, 'auprc': 0.9988587039128052, 'loss_val': 0.05656681204905965, 'psi': 0.9894285421151104}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=11 head_norm_before_train=2.847330 cos_to_last_merge=0.9918 (last merge round=1)
[S15] round=11 local utility u=0.002643 metrics={'f1_val': 0.989635249632218, 'auprc': 0.998417879937416, 'loss_val': 0.030389131863936623, 'psi': 0.9931483017542972}-{'f1_val': 0.9887886891363633, 'auprc': 0.9983888093971196, 'loss_val': 0.030509356570542986, 'psi': 0.9926287372406658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=11 head_norm_before_train=2.813530 (no previous merge yet)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.9950653683541723, 'auprc': 0.9908717945402542, 'loss_val': 0.05156811685246327, 'psi': 0.993387938828605}-{'f1_val': 0.9950224949794758, 'auprc': 0.9899919964143757, 'loss_val': 0.030711283530932516, 'psi': 0.9930102955534358}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=11 head_norm_before_train=2.926652 cos_to_last_merge=0.9890 (last merge round=2)
[S17] round=11 local utility u=0.004516 metrics={'f1_val': 0.8821954891087055, 'auprc': 0.971818863018964, 'loss_val': 0.5580462424617241, 'psi': 0.9180448386728088}-{'f1_val': 0.8809539075227673, 'auprc': 0.9663324570171851, 'loss_val': 0.5431685712779947, 'psi': 0.9151053273205343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=12 head_norm_before_train=2.772022 (no previous merge yet)
[S2] round=12 local utility u=0.066973 metrics={'f1_val': 0.9138278184744214, 'auprc': 0.9816772985862489, 'loss_val': 0.25014689568161896, 'psi': 0.9409676105191525}-{'f1_val': 0.9132574034165324, 'auprc': 0.9378266760179751, 'loss_val': 0.2491187791651471, 'psi': 0.9230851124571094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=12 head_norm_before_train=2.947935 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.7863922681719723, 'auprc': 0.9979379277310211, 'loss_val': 0.7452128953098419, 'psi': 0.8710105319955919}-{'f1_val': 0.7864233936765942, 'auprc': 0.9979261391239505, 'loss_val': 0.7178426586316199, 'psi': 0.8710244918555368}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=12 head_norm_before_train=2.782234 cos_to_last_merge=0.9543 (last merge round=1)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.9540638776622734, 'auprc': 0.9872894410765292, 'loss_val': 0.21878439612111195, 'psi': 0.9673541030279758}-{'f1_val': 0.9540391736040257, 'auprc': 0.9873396592412573, 'loss_val': 0.21844675055483764, 'psi': 0.9673593678589183}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=12 head_norm_before_train=2.854877 cos_to_last_merge=0.9605 (last merge round=1)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.9975086222760589, 'auprc': 0.997170472282604, 'loss_val': 0.030542116345461678, 'psi': 0.9973733622786769}-{'f1_val': 0.9971410286679584, 'auprc': 0.9956119425781309, 'loss_val': 0.01760235374130777, 'psi': 0.9965293942320274}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=12 head_norm_before_train=3.242495 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.8227725182824015, 'auprc': 0.9590179275537108, 'loss_val': 0.3729562629377179, 'psi': 0.8772706819909253}-{'f1_val': 0.8237218022154394, 'auprc': 0.9610822348189346, 'loss_val': 0.3203955011500345, 'psi': 0.8786659752568375}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=12 head_norm_before_train=3.026466 cos_to_last_merge=0.9339 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.49108700192597243, 'auprc': 0.7744878116462854, 'loss_val': 1.3636695142242856, 'psi': 0.6044473258140977}-{'f1_val': 0.8156493548560758, 'auprc': 0.9677985046804061, 'loss_val': 0.6908530030549993, 'psi': 0.8765090147858079}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=12 head_norm_before_train=3.104100 (no previous merge yet)
[S8] round=12 local utility u=0.035180 metrics={'f1_val': 0.9778603022423548, 'auprc': 0.9972369247776258, 'loss_val': 0.05085246043663705, 'psi': 0.9856109512564631}-{'f1_val': 0.9701679859884996, 'auprc': 0.9978268035504494, 'loss_val': 0.0768283098204702, 'psi': 0.9812315130132796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=12 head_norm_before_train=2.887061 (no previous merge yet)
[S9] round=12 local utility u=0.010048 metrics={'f1_val': 0.999558858461434, 'auprc': 0.9999995843032923, 'loss_val': 0.0012921469096430019, 'psi': 0.9997351487981774}-{'f1_val': 0.9991172969349544, 'auprc': 0.9999975050414531, 'loss_val': 0.01873351324696579, 'psi': 0.9994693801775538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1782 reason=None
[S9] sending update (kind=head size=1782 to 1 peers)
[S10] START round=12 head_norm_before_train=2.843568 cos_to_last_merge=0.9628 (last merge round=1)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.9925733077310497, 'auprc': 0.996347149427488, 'loss_val': 0.04137901405109683, 'psi': 0.994082844409625}-{'f1_val': 0.9932136491405474, 'auprc': 0.9964582590481568, 'loss_val': 0.03900177657078274, 'psi': 0.9945114931035912}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=12 head_norm_before_train=2.987566 (no previous merge yet)
[S11] round=12 local utility u=0.002305 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9991565234880126, 'loss_val': 0.016047556237286292, 'psi': 0.9976053582624798}-{'f1_val': 0.996567470639547, 'auprc': 0.9988042639719481, 'loss_val': 0.019577820043342117, 'psi': 0.9974621879725074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=12 head_norm_before_train=2.900684 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6384822510854357, 'auprc': 0.780106036300127, 'loss_val': 1.2085713186960696, 'psi': 0.6951317651713123}-{'f1_val': 0.7256030462905364, 'auprc': 0.8339733357834931, 'loss_val': 1.11828438443892, 'psi': 0.7689511620877191}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=12 head_norm_before_train=2.990147 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.9158387907898219, 'auprc': 0.9989977928980072, 'loss_val': 0.18484998434453614, 'psi': 0.9491023916330961}-{'f1_val': 0.9211311948996646, 'auprc': 0.9988436917067143, 'loss_val': 0.17299997660757543, 'psi': 0.9522161936224844}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=12 head_norm_before_train=2.881880 cos_to_last_merge=0.9911 (last merge round=1)
[S15] round=12 local utility u=0.004083 metrics={'f1_val': 0.9909010870725673, 'auprc': 0.9984750473468078, 'loss_val': 0.029989922949744487, 'psi': 0.9939306711822635}-{'f1_val': 0.989635249632218, 'auprc': 0.998417879937416, 'loss_val': 0.030389131863936623, 'psi': 0.9931483017542972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=12 head_norm_before_train=2.879382 (no previous merge yet)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.99273361475671, 'auprc': 0.9808622205942282, 'loss_val': 0.041645518211098506, 'psi': 0.9879850570917172}-{'f1_val': 0.9950653683541723, 'auprc': 0.9908717945402542, 'loss_val': 0.05156811685246327, 'psi': 0.993387938828605}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=12 head_norm_before_train=2.967380 cos_to_last_merge=0.9878 (last merge round=2)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.8750493146215781, 'auprc': 0.9496754979186219, 'loss_val': 0.5813766556245519, 'psi': 0.9048997879403956}-{'f1_val': 0.8821954891087055, 'auprc': 0.971818863018964, 'loss_val': 0.5580462424617241, 'psi': 0.9180448386728088}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=13 head_norm_before_train=2.845962 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.9154084168653674, 'auprc': 0.9368622059872591, 'loss_val': 0.2364874548921529, 'psi': 0.9239899325141241}-{'f1_val': 0.9138278184744214, 'auprc': 0.9816772985862489, 'loss_val': 0.25014689568161896, 'psi': 0.9409676105191525}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=13 head_norm_before_train=2.981358 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.7846667658475446, 'auprc': 0.9978255152109926, 'loss_val': 0.7811148652799869, 'psi': 0.8699302655929237}-{'f1_val': 0.7863922681719723, 'auprc': 0.9979379277310211, 'loss_val': 0.7452128953098419, 'psi': 0.8710105319955919}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=13 head_norm_before_train=2.858590 cos_to_last_merge=0.9530 (last merge round=1)
[S4] round=13 local utility u=0.021194 metrics={'f1_val': 0.955967669708436, 'auprc': 0.9881080723521096, 'loss_val': 0.19027502254599352, 'psi': 0.9688238307659055}-{'f1_val': 0.9540638776622734, 'auprc': 0.9872894410765292, 'loss_val': 0.21878439612111195, 'psi': 0.9673541030279758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=13 head_norm_before_train=2.915277 cos_to_last_merge=0.9565 (last merge round=1)
[S5] round=13 local utility u=0.005845 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9966627320273905, 'loss_val': 0.01512415656383133, 'psi': 0.9969497100117313}-{'f1_val': 0.9975086222760589, 'auprc': 0.997170472282604, 'loss_val': 0.030542116345461678, 'psi': 0.9973733622786769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] START round=13 head_norm_before_train=3.283958 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.8266737320324362, 'auprc': 0.957290421647671, 'loss_val': 0.40646286955887256, 'psi': 0.8789204078785301}-{'f1_val': 0.8227725182824015, 'auprc': 0.9590179275537108, 'loss_val': 0.3729562629377179, 'psi': 0.8772706819909253}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=13 head_norm_before_train=2.931896 cos_to_last_merge=0.9477 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.948
[S7] round=13 local utility u=0.940068 metrics={'f1_val': 0.7018949404496175, 'auprc': 0.7997708355478863, 'loss_val': 0.8242297041520165, 'psi': 0.7410452984889251}-{'f1_val': 0.49108700192597243, 'auprc': 0.7744878116462854, 'loss_val': 1.3636695142242856, 'psi': 0.6044473258140977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=13 head_norm_before_train=3.175241 (no previous merge yet)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.8820229503825084, 'auprc': 0.9500610895801735, 'loss_val': 0.2520362585927582, 'psi': 0.9092382060615745}-{'f1_val': 0.9778603022423548, 'auprc': 0.9972369247776258, 'loss_val': 0.05085246043663705, 'psi': 0.9856109512564631}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=13 head_norm_before_train=2.960753 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.999558858461434, 'auprc': 0.999998335901247, 'loss_val': 0.0021721038580809365, 'psi': 0.9997346494373592}-{'f1_val': 0.999558858461434, 'auprc': 0.9999995843032923, 'loss_val': 0.0012921469096430019, 'psi': 0.9997351487981774}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=13 head_norm_before_train=2.883318 cos_to_last_merge=0.9605 (last merge round=1)
[S10] round=13 local utility u=0.001134 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.996358340341193, 'loss_val': 0.04045862900892341, 'psi': 0.9942187124346981}-{'f1_val': 0.9925733077310497, 'auprc': 0.996347149427488, 'loss_val': 0.04137901405109683, 'psi': 0.994082844409625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=13 head_norm_before_train=3.045621 (no previous merge yet)
[S11] round=13 local utility u=0.000636 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9992629243150061, 'loss_val': 0.017594844704627802, 'psi': 0.9978978805805319}-{'f1_val': 0.9965712481121245, 'auprc': 0.9991565234880126, 'loss_val': 0.016047556237286292, 'psi': 0.9976053582624798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=13 head_norm_before_train=2.970560 (no previous merge yet)
[S13] round=13 local utility u=0.049154 metrics={'f1_val': 0.6436674769305183, 'auprc': 0.7809638480326893, 'loss_val': 1.14394888171296, 'psi': 0.6985860253713867}-{'f1_val': 0.6384822510854357, 'auprc': 0.780106036300127, 'loss_val': 1.2085713186960696, 'psi': 0.6951317651713123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=13 head_norm_before_train=3.044967 (no previous merge yet)
[S14] round=13 local utility u=0.043190 metrics={'f1_val': 0.9259144129439947, 'auprc': 0.9990642791363983, 'loss_val': 0.15912380439310042, 'psi': 0.9551743594209561}-{'f1_val': 0.9158387907898219, 'auprc': 0.9989977928980072, 'loss_val': 0.18484998434453614, 'psi': 0.9491023916330961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=13 head_norm_before_train=2.914380 cos_to_last_merge=0.9904 (last merge round=1)
[S15] round=13 local utility u=0.000134 metrics={'f1_val': 0.9909010870725673, 'auprc': 0.9985499343646498, 'loss_val': 0.02994710412494981, 'psi': 0.9939606259894003}-{'f1_val': 0.9909010870725673, 'auprc': 0.9984750473468078, 'loss_val': 0.029989922949744487, 'psi': 0.9939306711822635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=13 head_norm_before_train=2.795183 (no previous merge yet)
[S16] round=13 local utility u=0.004519 metrics={'f1_val': 0.994735478455759, 'auprc': 0.9840294391823952, 'loss_val': 0.05412018163765368, 'psi': 0.9904530627464134}-{'f1_val': 0.99273361475671, 'auprc': 0.9808622205942282, 'loss_val': 0.041645518211098506, 'psi': 0.9879850570917172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=13 head_norm_before_train=3.006371 cos_to_last_merge=0.9866 (last merge round=2)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.8737286889668352, 'auprc': 0.9466110152693881, 'loss_val': 0.614134271034554, 'psi': 0.9028816194878564}-{'f1_val': 0.8750493146215781, 'auprc': 0.9496754979186219, 'loss_val': 0.5813766556245519, 'psi': 0.9048997879403956}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=14 head_norm_before_train=2.896280 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.8309388556799692, 'auprc': 0.9736628153301566, 'loss_val': 0.4004193378358339, 'psi': 0.8880284395400442}-{'f1_val': 0.9154084168653674, 'auprc': 0.9368622059872591, 'loss_val': 0.2364874548921529, 'psi': 0.9239899325141241}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=14 head_norm_before_train=3.012710 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.7832854295670487, 'auprc': 0.9977315762264165, 'loss_val': 0.8206004133922539, 'psi': 0.8690638882307958}-{'f1_val': 0.7846667658475446, 'auprc': 0.9978255152109926, 'loss_val': 0.7811148652799869, 'psi': 0.8699302655929237}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=14 head_norm_before_train=2.886971 cos_to_last_merge=0.9503 (last merge round=1)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.9434375713253027, 'auprc': 0.9754009317724623, 'loss_val': 0.23723827549498813, 'psi': 0.9562229155041666}-{'f1_val': 0.955967669708436, 'auprc': 0.9881080723521096, 'loss_val': 0.19027502254599352, 'psi': 0.9688238307659055}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=14 head_norm_before_train=2.893536 cos_to_last_merge=0.9550 (last merge round=1)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.99412738391839, 'loss_val': 0.018512614059663864, 'psi': 0.995935570768131}-{'f1_val': 0.9971410286679584, 'auprc': 0.9966627320273905, 'loss_val': 0.01512415656383133, 'psi': 0.9969497100117313}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=14 head_norm_before_train=3.321682 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.823676682944372, 'auprc': 0.9560012819440782, 'loss_val': 0.4167639168987974, 'psi': 0.8766065225442545}-{'f1_val': 0.8266737320324362, 'auprc': 0.957290421647671, 'loss_val': 0.40646286955887256, 'psi': 0.8789204078785301}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=14 head_norm_before_train=2.978597 cos_to_last_merge=0.9451 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.945
[S7] round=14 local utility u=0.498569 metrics={'f1_val': 0.8103918612351547, 'auprc': 0.8421333551637782, 'loss_val': 0.605161704326349, 'psi': 0.8230884588066041}-{'f1_val': 0.7018949404496175, 'auprc': 0.7997708355478863, 'loss_val': 0.8242297041520165, 'psi': 0.7410452984889251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=14 head_norm_before_train=3.233937 (no previous merge yet)
[S8] round=14 local utility u=0.465780 metrics={'f1_val': 0.9820128240185002, 'auprc': 0.9977084235824398, 'loss_val': 0.06335771347033907, 'psi': 0.9882910638440761}-{'f1_val': 0.8820229503825084, 'auprc': 0.9500610895801735, 'loss_val': 0.2520362585927582, 'psi': 0.9092382060615745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=14 head_norm_before_train=3.003132 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.9985615763428548, 'auprc': 0.9999983359012469, 'loss_val': 0.0030787630400989172, 'psi': 0.9991362801662116}-{'f1_val': 0.999558858461434, 'auprc': 0.999998335901247, 'loss_val': 0.0021721038580809365, 'psi': 0.9997346494373592}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=14 head_norm_before_train=2.920597 cos_to_last_merge=0.9582 (last merge round=1)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.9925318880528124, 'auprc': 0.9970776586396705, 'loss_val': 0.04240129736480578, 'psi': 0.9943501962875556}-{'f1_val': 0.9927922938303682, 'auprc': 0.996358340341193, 'loss_val': 0.04045862900892341, 'psi': 0.9942187124346981}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=14 head_norm_before_train=3.102916 (no previous merge yet)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.9967926336575387, 'auprc': 0.9976147624206391, 'loss_val': 0.021050219253677536, 'psi': 0.9971214851627789}-{'f1_val': 0.9969878514242156, 'auprc': 0.9992629243150061, 'loss_val': 0.017594844704627802, 'psi': 0.9978978805805319}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=14 head_norm_before_train=3.065400 (no previous merge yet)
[S13] round=14 local utility u=0.243871 metrics={'f1_val': 0.7223918472559715, 'auprc': 0.7697553711053671, 'loss_val': 1.0949267892658163, 'psi': 0.7413372567957297}-{'f1_val': 0.6436674769305183, 'auprc': 0.7809638480326893, 'loss_val': 1.14394888171296, 'psi': 0.6985860253713867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=14 head_norm_before_train=3.102997 (no previous merge yet)
[S14] round=14 local utility u=0.110062 metrics={'f1_val': 0.9538487309175481, 'auprc': 0.9994207396960949, 'loss_val': 0.10767527847378314, 'psi': 0.9720775344289668}-{'f1_val': 0.9259144129439947, 'auprc': 0.9990642791363983, 'loss_val': 0.15912380439310042, 'psi': 0.9551743594209561}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] sending update (kind=head size=1791 to 1 peers)
[S15] START round=14 head_norm_before_train=2.945227 cos_to_last_merge=0.9897 (last merge round=1)
[S15] round=14 local utility u=0.001621 metrics={'f1_val': 0.9913219753322389, 'auprc': 0.9987485943549865, 'loss_val': 0.029826439753063615, 'psi': 0.994292622941338}-{'f1_val': 0.9909010870725673, 'auprc': 0.9985499343646498, 'loss_val': 0.02994710412494981, 'psi': 0.9939606259894003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=14 head_norm_before_train=2.874568 (no previous merge yet)
[S16] round=14 local utility u=0.010530 metrics={'f1_val': 0.9951521260131402, 'auprc': 0.9839292064421946, 'loss_val': 0.03526017152089696, 'psi': 0.9906629581847619}-{'f1_val': 0.994735478455759, 'auprc': 0.9840294391823952, 'loss_val': 0.05412018163765368, 'psi': 0.9904530627464134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=14 head_norm_before_train=3.043041 cos_to_last_merge=0.9854 (last merge round=2)
[S17] round=14 local utility u=0.036957 metrics={'f1_val': 0.8775016475418024, 'auprc': 0.9573698299701204, 'loss_val': 0.5951344008406929, 'psi': 0.9094489205131296}-{'f1_val': 0.8737286889668352, 'auprc': 0.9466110152693881, 'loss_val': 0.614134271034554, 'psi': 0.9028816194878564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=15 head_norm_before_train=2.947515 (no previous merge yet)
[S2] round=15 local utility u=0.323704 metrics={'f1_val': 0.9160256522610782, 'auprc': 0.9673769996550725, 'loss_val': 0.24467410279685378, 'psi': 0.936566191218676}-{'f1_val': 0.8309388556799692, 'auprc': 0.9736628153301566, 'loss_val': 0.4004193378358339, 'psi': 0.8880284395400442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=15 head_norm_before_train=3.042510 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.7833201111127803, 'auprc': 0.9977151115314314, 'loss_val': 0.8336439334202995, 'psi': 0.8690781112802408}-{'f1_val': 0.7832854295670487, 'auprc': 0.9977315762264165, 'loss_val': 0.8206004133922539, 'psi': 0.8690638882307958}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=15 head_norm_before_train=2.954354 cos_to_last_merge=0.9491 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.949
[S4] round=15 local utility u=0.086242 metrics={'f1_val': 0.9548400607999104, 'auprc': 0.9958683221126264, 'loss_val': 0.1945713668923158, 'psi': 0.9712513653249968}-{'f1_val': 0.9434375713253027, 'auprc': 0.9754009317724623, 'loss_val': 0.23723827549498813, 'psi': 0.9562229155041666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=15 head_norm_before_train=2.961299 cos_to_last_merge=0.9523 (last merge round=1)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.9985348856777713, 'auprc': 0.9954449358873139, 'loss_val': 0.03683493926309071, 'psi': 0.9972989057615884}-{'f1_val': 0.9971410286679584, 'auprc': 0.99412738391839, 'loss_val': 0.018512614059663864, 'psi': 0.995935570768131}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=15 head_norm_before_train=3.356418 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.8218405827001038, 'auprc': 0.9556124883492236, 'loss_val': 0.42761451055583255, 'psi': 0.8753493449597518}-{'f1_val': 0.823676682944372, 'auprc': 0.9560012819440782, 'loss_val': 0.4167639168987974, 'psi': 0.8766065225442545}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=15 head_norm_before_train=3.125493 cos_to_last_merge=0.9308 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.931
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.6350566096094925, 'auprc': 0.8325648959875205, 'loss_val': 1.5002156289658664, 'psi': 0.7140599241607037}-{'f1_val': 0.8103918612351547, 'auprc': 0.8421333551637782, 'loss_val': 0.605161704326349, 'psi': 0.8230884588066041}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=15 head_norm_before_train=3.257887 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.8922121996776954, 'auprc': 0.9946876785252606, 'loss_val': 0.18937401628721565, 'psi': 0.9332023912167214}-{'f1_val': 0.9820128240185002, 'auprc': 0.9977084235824398, 'loss_val': 0.06335771347033907, 'psi': 0.9882910638440761}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=15 head_norm_before_train=3.036564 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.9983126148576978, 'auprc': 0.999998335901247, 'loss_val': 0.0035733551021170165, 'psi': 0.9989869032751175}-{'f1_val': 0.9985615763428548, 'auprc': 0.9999983359012469, 'loss_val': 0.0030787630400989172, 'psi': 0.9991362801662116}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=15 head_norm_before_train=2.960292 cos_to_last_merge=0.9566 (last merge round=1)
[S10] round=15 local utility u=0.000773 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9951390205124575, 'loss_val': 0.037915999943253224, 'psi': 0.993862419911419}-{'f1_val': 0.9925318880528124, 'auprc': 0.9970776586396705, 'loss_val': 0.04240129736480578, 'psi': 0.9943501962875556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=15 head_norm_before_train=3.100709 (no previous merge yet)
[S11] round=15 local utility u=0.000197 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9977304720874315, 'loss_val': 0.019553488342559593, 'psi': 0.997022741832031}-{'f1_val': 0.9967926336575387, 'auprc': 0.9976147624206391, 'loss_val': 0.021050219253677536, 'psi': 0.9971214851627789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=15 head_norm_before_train=3.166212 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5439672172525937, 'auprc': 0.746828700524837, 'loss_val': 1.578821585777763, 'psi': 0.625111810561491}-{'f1_val': 0.7223918472559715, 'auprc': 0.7697553711053671, 'loss_val': 1.0949267892658163, 'psi': 0.7413372567957297}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=15 head_norm_before_train=3.157321 (no previous merge yet)
[S14] round=15 local utility u=0.163172 metrics={'f1_val': 0.9946681005463983, 'auprc': 0.9992837424850568, 'loss_val': 0.025837447973136134, 'psi': 0.9965143573218618}-{'f1_val': 0.9538487309175481, 'auprc': 0.9994207396960949, 'loss_val': 0.10767527847378314, 'psi': 0.9720775344289668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=15 head_norm_before_train=2.974552 cos_to_last_merge=0.9890 (last merge round=1)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.9909010870725673, 'auprc': 0.9987472682693841, 'loss_val': 0.030133283121413793, 'psi': 0.9940395595512941}-{'f1_val': 0.9913219753322389, 'auprc': 0.9987485943549865, 'loss_val': 0.029826439753063615, 'psi': 0.994292622941338}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=15 head_norm_before_train=2.933343 (no previous merge yet)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.9936415054918462, 'auprc': 0.9836984714504131, 'loss_val': 0.03613605514195186, 'psi': 0.9896642918752729}-{'f1_val': 0.9951521260131402, 'auprc': 0.9839292064421946, 'loss_val': 0.03526017152089696, 'psi': 0.9906629581847619}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=15 head_norm_before_train=3.078396 cos_to_last_merge=0.9843 (last merge round=2)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.8683218446879004, 'auprc': 0.933319535205488, 'loss_val': 0.7103855466666732, 'psi': 0.8943209208949354}-{'f1_val': 0.8775016475418024, 'auprc': 0.9573698299701204, 'loss_val': 0.5951344008406929, 'psi': 0.9094489205131296}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=16 head_norm_before_train=2.999614 (no previous merge yet)
[S2] round=16 local utility u=0.020373 metrics={'f1_val': 0.9122269660443532, 'auprc': 0.9918584925521894, 'loss_val': 0.2545796446525126, 'psi': 0.9440795766474877}-{'f1_val': 0.9160256522610782, 'auprc': 0.9673769996550725, 'loss_val': 0.24467410279685378, 'psi': 0.936566191218676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=16 head_norm_before_train=3.070924 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.781585674930204, 'auprc': 0.9975887219905475, 'loss_val': 0.8753976438927272, 'psi': 0.8679868937543413}-{'f1_val': 0.7833201111127803, 'auprc': 0.9977151115314314, 'loss_val': 0.8336439334202995, 'psi': 0.8690781112802408}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=16 head_norm_before_train=2.981035 cos_to_last_merge=0.9447 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.945
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9501308990898077, 'auprc': 0.9963140120267093, 'loss_val': 0.19480343722656698, 'psi': 0.9686041442645684}-{'f1_val': 0.9548400607999104, 'auprc': 0.9958683221126264, 'loss_val': 0.1945713668923158, 'psi': 0.9712513653249968}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=16 head_norm_before_train=3.028676 cos_to_last_merge=0.9498 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.950
[S5] round=16 local utility u=0.008924 metrics={'f1_val': 0.998168419773744, 'auprc': 0.9966680367241869, 'loss_val': 0.020458345795043666, 'psi': 0.9975682665539212}-{'f1_val': 0.9985348856777713, 'auprc': 0.9954449358873139, 'loss_val': 0.03683493926309071, 'psi': 0.9972989057615884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S5] sending update (kind=head size=1788 to 1 peers)
[S6] START round=16 head_norm_before_train=3.389205 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.8216941503226919, 'auprc': 0.9551658708065032, 'loss_val': 0.4304679757201472, 'psi': 0.8750828385162164}-{'f1_val': 0.8218405827001038, 'auprc': 0.9556124883492236, 'loss_val': 0.42761451055583255, 'psi': 0.8753493449597518}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=16 head_norm_before_train=3.281162 cos_to_last_merge=0.9211 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.921
[S7] round=16 local utility u=0.968023 metrics={'f1_val': 0.8054674091804183, 'auprc': 0.9118267954529483, 'loss_val': 0.8244201015052567, 'psi': 0.8480111636894303}-{'f1_val': 0.6350566096094925, 'auprc': 0.8325648959875205, 'loss_val': 1.5002156289658664, 'psi': 0.7140599241607037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=16 head_norm_before_train=3.309805 (no previous merge yet)
[S8] round=16 local utility u=0.278252 metrics={'f1_val': 0.9724998143977439, 'auprc': 0.9817704885572633, 'loss_val': 0.07584428799479297, 'psi': 0.9762080840615517}-{'f1_val': 0.8922121996776954, 'auprc': 0.9946876785252606, 'loss_val': 0.18937401628721565, 'psi': 0.9332023912167214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=16 head_norm_before_train=3.065860 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.998063796060603, 'auprc': 0.999998335901247, 'loss_val': 0.004151028473046651, 'psi': 0.9988376119968606}-{'f1_val': 0.9983126148576978, 'auprc': 0.999998335901247, 'loss_val': 0.0035733551021170165, 'psi': 0.9989869032751175}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=16 head_norm_before_train=3.002104 cos_to_last_merge=0.9552 (last merge round=1)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9925318880528124, 'auprc': 0.9967285135219539, 'loss_val': 0.040372911225799515, 'psi': 0.994210538240469}-{'f1_val': 0.9930113528440598, 'auprc': 0.9951390205124575, 'loss_val': 0.037915999943253224, 'psi': 0.993862419911419}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=16 head_norm_before_train=3.173557 (no previous merge yet)
[S11] round=16 local utility u=0.001120 metrics={'f1_val': 0.9967926336575387, 'auprc': 0.997889798306043, 'loss_val': 0.01924166936289016, 'psi': 0.9972314995169405}-{'f1_val': 0.9965509216617638, 'auprc': 0.9977304720874315, 'loss_val': 0.019553488342559593, 'psi': 0.997022741832031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] sending update (kind=head size=1790 to 1 peers)
[S13] START round=16 head_norm_before_train=3.167464 (no previous merge yet)
[S13] round=16 local utility u=0.569505 metrics={'f1_val': 0.668879596994373, 'auprc': 0.7578061225511705, 'loss_val': 1.2222185723920953, 'psi': 0.7044502072170921}-{'f1_val': 0.5439672172525937, 'auprc': 0.746828700524837, 'loss_val': 1.578821585777763, 'psi': 0.625111810561491}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=16 head_norm_before_train=3.219209 (no previous merge yet)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.9698294742318407, 'auprc': 0.9986146428685048, 'loss_val': 0.0724889013628483, 'psi': 0.9813435416865064}-{'f1_val': 0.9946681005463983, 'auprc': 0.9992837424850568, 'loss_val': 0.025837447973136134, 'psi': 0.9965143573218618}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=16 head_norm_before_train=3.002562 cos_to_last_merge=0.9884 (last merge round=1)
[S15] round=16 local utility u=0.012972 metrics={'f1_val': 0.9950866547103594, 'auprc': 0.9987555493368231, 'loss_val': 0.02932835399754731, 'psi': 0.9965542125609448}-{'f1_val': 0.9909010870725673, 'auprc': 0.9987472682693841, 'loss_val': 0.030133283121413793, 'psi': 0.9940395595512941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] sending update (kind=head size=1789 to 1 peers)
[S16] START round=16 head_norm_before_train=2.998725 (no previous merge yet)
[S16] round=16 local utility u=0.003584 metrics={'f1_val': 0.9940546849936414, 'auprc': 0.985263048156433, 'loss_val': 0.03614004228802204, 'psi': 0.9905380302587581}-{'f1_val': 0.9936415054918462, 'auprc': 0.9836984714504131, 'loss_val': 0.03613605514195186, 'psi': 0.9896642918752729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=16 head_norm_before_train=3.115525 cos_to_last_merge=0.9830 (last merge round=2)
[S17] round=16 local utility u=0.183724 metrics={'f1_val': 0.8817079436096635, 'auprc': 0.9737488015019579, 'loss_val': 0.5445415430430427, 'psi': 0.9185242867665813}-{'f1_val': 0.8683218446879004, 'auprc': 0.933319535205488, 'loss_val': 0.7103855466666732, 'psi': 0.8943209208949354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=17 head_norm_before_train=3.043387 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.9143433667870456, 'auprc': 0.972690709826161, 'loss_val': 0.23929852548844427, 'psi': 0.9376823040026918}-{'f1_val': 0.9122269660443532, 'auprc': 0.9918584925521894, 'loss_val': 0.2545796446525126, 'psi': 0.9440795766474877}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=17 head_norm_before_train=3.098142 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.7793215148601769, 'auprc': 0.9974313213253985, 'loss_val': 0.9184717316585601, 'psi': 0.8665654374462655}-{'f1_val': 0.781585674930204, 'auprc': 0.9975887219905475, 'loss_val': 0.8753976438927272, 'psi': 0.8679868937543413}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=17 head_norm_before_train=3.047732 cos_to_last_merge=0.9441 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.944
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9496653579441119, 'auprc': 0.9954853480882088, 'loss_val': 0.19608833131791636, 'psi': 0.9679933540017507}-{'f1_val': 0.9501308990898077, 'auprc': 0.9963140120267093, 'loss_val': 0.19480343722656698, 'psi': 0.9686041442645684}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=17 head_norm_before_train=3.092037 cos_to_last_merge=0.9459 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.946
[S5] round=17 local utility u=0.004331 metrics={'f1_val': 0.9980942274279847, 'auprc': 0.9967128282800709, 'loss_val': 0.01148473755920295, 'psi': 0.9975416677688191}-{'f1_val': 0.998168419773744, 'auprc': 0.9966680367241869, 'loss_val': 0.020458345795043666, 'psi': 0.9975682665539212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] sending update (kind=head size=1791 to 1 peers)
[S6] START round=17 head_norm_before_train=3.420416 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.8157687475796751, 'auprc': 0.9537591337147058, 'loss_val': 0.47607101723522516, 'psi': 0.8709649020336874}-{'f1_val': 0.8216941503226919, 'auprc': 0.9551658708065032, 'loss_val': 0.4304679757201472, 'psi': 0.8750828385162164}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=17 head_norm_before_train=3.362859 cos_to_last_merge=0.9172 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.917
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.7566235824274934, 'auprc': 0.8546596239251261, 'loss_val': 1.1119615072082085, 'psi': 0.7958379990265465}-{'f1_val': 0.8054674091804183, 'auprc': 0.9118267954529483, 'loss_val': 0.8244201015052567, 'psi': 0.8480111636894303}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=17 head_norm_before_train=3.374320 (no previous merge yet)
[S8] round=17 local utility u=0.104579 metrics={'f1_val': 0.9918207344392485, 'auprc': 0.9989678624930518, 'loss_val': 0.034204802151413104, 'psi': 0.9946795856607697}-{'f1_val': 0.9724998143977439, 'auprc': 0.9817704885572633, 'loss_val': 0.07584428799479297, 'psi': 0.9762080840615517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=17 head_norm_before_train=3.092938 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9978151194883254, 'auprc': 0.999998335901247, 'loss_val': 0.004572054490013892, 'psi': 0.9986884060534941}-{'f1_val': 0.998063796060603, 'auprc': 0.999998335901247, 'loss_val': 0.004151028473046651, 'psi': 0.9988376119968606}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=17 head_norm_before_train=3.036278 cos_to_last_merge=0.9527 (last merge round=1)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.9858183776293008, 'auprc': 0.9985352349987482, 'loss_val': 0.10008479569220084, 'psi': 0.9909051205770798}-{'f1_val': 0.9925318880528124, 'auprc': 0.9967285135219539, 'loss_val': 0.040372911225799515, 'psi': 0.994210538240469}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=17 head_norm_before_train=3.231964 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.9953694973449114, 'auprc': 0.9983742175926733, 'loss_val': 0.021881463122319582, 'psi': 0.9965713854440161}-{'f1_val': 0.9967926336575387, 'auprc': 0.997889798306043, 'loss_val': 0.01924166936289016, 'psi': 0.9972314995169405}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=17 head_norm_before_train=3.285882 (no previous merge yet)
[S13] round=17 local utility u=0.031893 metrics={'f1_val': 0.6874466946487494, 'auprc': 0.7616566997729104, 'loss_val': 1.2813874703600303, 'psi': 0.7171306966984139}-{'f1_val': 0.668879596994373, 'auprc': 0.7578061225511705, 'loss_val': 1.2222185723920953, 'psi': 0.7044502072170921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=17 head_norm_before_train=3.244971 (no previous merge yet)
[S14] round=17 local utility u=0.079593 metrics={'f1_val': 0.989876255101594, 'auprc': 0.9990323901032875, 'loss_val': 0.03483716290877492, 'psi': 0.9935387091022714}-{'f1_val': 0.9698294742318407, 'auprc': 0.9986146428685048, 'loss_val': 0.0724889013628483, 'psi': 0.9813435416865064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] sending update (kind=head size=1789 to 1 peers)
[S15] START round=17 head_norm_before_train=3.029469 cos_to_last_merge=0.9878 (last merge round=1)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.9913219753322389, 'auprc': 0.9987514607043741, 'loss_val': 0.030239391309786885, 'psi': 0.9942937694810929}-{'f1_val': 0.9950866547103594, 'auprc': 0.9987555493368231, 'loss_val': 0.02932835399754731, 'psi': 0.9965542125609448}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=17 head_norm_before_train=3.057650 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.9929469265117182, 'auprc': 0.9839334315661628, 'loss_val': 0.04310446711616701, 'psi': 0.9893415285334961}-{'f1_val': 0.9940546849936414, 'auprc': 0.985263048156433, 'loss_val': 0.03614004228802204, 'psi': 0.9905380302587581}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=17 head_norm_before_train=3.147779 cos_to_last_merge=0.9820 (last merge round=2)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.8644421081593069, 'auprc': 0.889259603274837, 'loss_val': 0.7965524288129865, 'psi': 0.8743691062055189}-{'f1_val': 0.8817079436096635, 'auprc': 0.9737488015019579, 'loss_val': 0.5445415430430427, 'psi': 0.9185242867665813}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=18 head_norm_before_train=3.084423 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.8309388556799692, 'auprc': 0.9512343817268247, 'loss_val': 0.41831528555739744, 'psi': 0.8790570660987114}-{'f1_val': 0.9143433667870456, 'auprc': 0.972690709826161, 'loss_val': 0.23929852548844427, 'psi': 0.9376823040026918}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=18 head_norm_before_train=3.124328 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.775202306795429, 'auprc': 0.997210749546343, 'loss_val': 0.96605327811567, 'psi': 0.8640056838957946}-{'f1_val': 0.7793215148601769, 'auprc': 0.9974313213253985, 'loss_val': 0.9184717316585601, 'psi': 0.8665654374462655}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=18 head_norm_before_train=3.100442 cos_to_last_merge=0.9421 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.942
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9320318728597969, 'auprc': 0.984860540377244, 'loss_val': 0.2769176634496399, 'psi': 0.9531633398667758}-{'f1_val': 0.9496653579441119, 'auprc': 0.9954853480882088, 'loss_val': 0.19608833131791636, 'psi': 0.9679933540017507}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=18 head_norm_before_train=3.146736 cos_to_last_merge=0.9443 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.944
[S5] round=18 local utility u=0.004416 metrics={'f1_val': 0.9981661076776585, 'auprc': 0.9996535616233435, 'loss_val': 0.011905323151335264, 'psi': 0.9987610892559324}-{'f1_val': 0.9980942274279847, 'auprc': 0.9967128282800709, 'loss_val': 0.01148473755920295, 'psi': 0.9975416677688191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] sending update (kind=head size=1792 to 1 peers)
[S6] START round=18 head_norm_before_train=3.450256 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.8144623320014235, 'auprc': 0.9540343995715396, 'loss_val': 0.47040128305241335, 'psi': 0.87029115902947}-{'f1_val': 0.8157687475796751, 'auprc': 0.9537591337147058, 'loss_val': 0.47607101723522516, 'psi': 0.8709649020336874}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=18 head_norm_before_train=3.381029 cos_to_last_merge=0.9158 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.916
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.7580778386762196, 'auprc': 0.8926187424436159, 'loss_val': 1.3354588518377941, 'psi': 0.8118942001831781}-{'f1_val': 0.7566235824274934, 'auprc': 0.8546596239251261, 'loss_val': 1.1119615072082085, 'psi': 0.7958379990265465}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=18 head_norm_before_train=3.435022 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.8320417908048681, 'auprc': 0.992611992944131, 'loss_val': 0.5638470599205462, 'psi': 0.8962698716605733}-{'f1_val': 0.9918207344392485, 'auprc': 0.9989678624930518, 'loss_val': 0.034204802151413104, 'psi': 0.9946795856607697}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=18 head_norm_before_train=3.118070 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9976524016469486, 'auprc': 0.999998335901247, 'loss_val': 0.004716484085240201, 'psi': 0.9985907753486679}-{'f1_val': 0.9978151194883254, 'auprc': 0.999998335901247, 'loss_val': 0.004572054490013892, 'psi': 0.9986884060534941}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=18 head_norm_before_train=2.922756 cos_to_last_merge=0.9396 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.940
[S10] round=18 local utility u=0.057781 metrics={'f1_val': 0.9955766401672886, 'auprc': 0.9947279349831459, 'loss_val': 0.03164967780155547, 'psi': 0.9952371580936317}-{'f1_val': 0.9858183776293008, 'auprc': 0.9985352349987482, 'loss_val': 0.10008479569220084, 'psi': 0.9909051205770798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=18 head_norm_before_train=3.320389 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.9953504666543074, 'auprc': 0.9980964058080957, 'loss_val': 0.03832044012405343, 'psi': 0.9964488423158226}-{'f1_val': 0.9953694973449114, 'auprc': 0.9983742175926733, 'loss_val': 0.021881463122319582, 'psi': 0.9965713854440161}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=18 head_norm_before_train=3.361291 (no previous merge yet)
[S13] round=18 local utility u=0.096403 metrics={'f1_val': 0.7140865088640704, 'auprc': 0.7751290802947943, 'loss_val': 1.2888368522394933, 'psi': 0.73850353743636}-{'f1_val': 0.6874466946487494, 'auprc': 0.7616566997729104, 'loss_val': 1.2813874703600303, 'psi': 0.7171306966984139}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=18 head_norm_before_train=3.318455 (no previous merge yet)
[S14] round=18 local utility u=0.004801 metrics={'f1_val': 0.9942429722026053, 'auprc': 0.9991208290673677, 'loss_val': 0.05170098267482194, 'psi': 0.9961941149485103}-{'f1_val': 0.989876255101594, 'auprc': 0.9990323901032875, 'loss_val': 0.03483716290877492, 'psi': 0.9935387091022714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S14] sending update (kind=head size=1786 to 1 peers)
[S15] START round=18 head_norm_before_train=3.055414 cos_to_last_merge=0.9872 (last merge round=1)
[S15] round=18 local utility u=0.006391 metrics={'f1_val': 0.9934185961837458, 'auprc': 0.9987579744774733, 'loss_val': 0.030057370947638527, 'psi': 0.9955543475012368}-{'f1_val': 0.9913219753322389, 'auprc': 0.9987514607043741, 'loss_val': 0.030239391309786885, 'psi': 0.9942937694810929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=18 head_norm_before_train=3.057696 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.989649172571529, 'auprc': 0.9815567705611137, 'loss_val': 0.08543272528702628, 'psi': 0.9864122117673628}-{'f1_val': 0.9929469265117182, 'auprc': 0.9839334315661628, 'loss_val': 0.04310446711616701, 'psi': 0.9893415285334961}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=18 head_norm_before_train=3.179063 cos_to_last_merge=0.9813 (last merge round=2)
[S17] round=18 local utility u=0.326104 metrics={'f1_val': 0.8832694381977851, 'auprc': 0.98093373892792, 'loss_val': 0.5323314563232279, 'psi': 0.9223351584898392}-{'f1_val': 0.8644421081593069, 'auprc': 0.889259603274837, 'loss_val': 0.7965524288129865, 'psi': 0.8743691062055189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=19 head_norm_before_train=3.126009 (no previous merge yet)
[S2] round=19 local utility u=0.015268 metrics={'f1_val': 0.829450964717245, 'auprc': 0.959775338564675, 'loss_val': 0.40447520270540593, 'psi': 0.8815807142562171}-{'f1_val': 0.8309388556799692, 'auprc': 0.9512343817268247, 'loss_val': 0.41831528555739744, 'psi': 0.8790570660987114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S2] r=20 psi=0.882 u=0.0153 p_local=0.0675 f1=0.829 auprc=0.960 bytes=16165
[S3] START round=19 head_norm_before_train=3.149734 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.7747410885246024, 'auprc': 0.9971097988708244, 'loss_val': 0.9929050654017696, 'psi': 0.8636885726630912}-{'f1_val': 0.775202306795429, 'auprc': 0.997210749546343, 'loss_val': 0.96605327811567, 'psi': 0.8640056838957946}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=20 psi=0.864 u=0.0000 p_local=0.0161 f1=0.775 auprc=0.997 bytes=3591
[S4] START round=19 head_norm_before_train=3.088448 cos_to_last_merge=0.9359 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.936
[S4] round=19 local utility u=0.070221 metrics={'f1_val': 0.9525886287139074, 'auprc': 0.9871990364233638, 'loss_val': 0.2668319127199777, 'psi': 0.96643279179769}-{'f1_val': 0.9320318728597969, 'auprc': 0.984860540377244, 'loss_val': 0.2769176634496399, 'psi': 0.9531633398667758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S4] r=20 psi=0.966 u=0.0702 p_local=0.0494 f1=0.953 auprc=0.987 bytes=17957
[S5] START round=19 head_norm_before_train=3.149869 cos_to_last_merge=0.9396 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.9980195382902922, 'auprc': 0.9967800882234763, 'loss_val': 0.01095287054965033, 'psi': 0.9975237582635659}-{'f1_val': 0.9981661076776585, 'auprc': 0.9996535616233435, 'loss_val': 0.011905323151335264, 'psi': 0.9987610892559324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=20 psi=0.998 u=0.0000 p_local=0.0209 f1=0.998 auprc=0.997 bytes=16144
[S6] START round=19 head_norm_before_train=3.478801 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.8121831826941645, 'auprc': 0.9532254105231094, 'loss_val': 0.4792965382084503, 'psi': 0.8686000738257424}-{'f1_val': 0.8144623320014235, 'auprc': 0.9540343995715396, 'loss_val': 0.47040128305241335, 'psi': 0.87029115902947}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.869 u=0.0000 p_local=0.0306 f1=0.812 auprc=0.953 bytes=8996
[S7] START round=19 head_norm_before_train=3.455700 cos_to_last_merge=0.9125 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.913
[S7] round=19 local utility u=0.135845 metrics={'f1_val': 0.7612452415263996, 'auprc': 0.8868856433724156, 'loss_val': 1.0655747207149608, 'psi': 0.8115014022648059}-{'f1_val': 0.7580778386762196, 'auprc': 0.8926187424436159, 'loss_val': 1.3354588518377941, 'psi': 0.8118942001831781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S7] r=20 psi=0.812 u=0.1358 p_local=0.2504 f1=0.761 auprc=0.887 bytes=17979
[S8] START round=19 head_norm_before_train=3.490505 (no previous merge yet)
[S8] round=19 local utility u=0.088390 metrics={'f1_val': 0.8477786879670713, 'auprc': 0.9929411840978373, 'loss_val': 0.48247589722529544, 'psi': 0.9058436864193777}-{'f1_val': 0.8320417908048681, 'auprc': 0.992611992944131, 'loss_val': 0.5638470599205462, 'psi': 0.8962698716605733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] sending update (kind=head size=1792 to 1 peers)
[S8] r=20 psi=0.906 u=0.0884 p_local=0.1618 f1=0.848 auprc=0.993 bytes=17958
[S9] START round=19 head_norm_before_train=3.141920 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9971551902648863, 'auprc': 0.9999983359012469, 'loss_val': 0.005569123820298506, 'psi': 0.9982924485194304}-{'f1_val': 0.9976524016469486, 'auprc': 0.999998335901247, 'loss_val': 0.004716484085240201, 'psi': 0.9985907753486679}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=20 psi=0.998 u=0.0000 p_local=0.0152 f1=0.997 auprc=1.000 bytes=12535
[S10] START round=19 head_norm_before_train=3.080112 cos_to_last_merge=0.9134 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.913
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9955766401672886, 'auprc': 0.9939601740293862, 'loss_val': 0.03136055261616128, 'psi': 0.9949300537121277}-{'f1_val': 0.9955766401672886, 'auprc': 0.9947279349831459, 'loss_val': 0.03164967780155547, 'psi': 0.9952371580936317}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=20 psi=0.995 u=0.0000 p_local=0.0239 f1=0.996 auprc=0.994 bytes=12576
[S11] START round=19 head_norm_before_train=3.361135 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.9912857020559438, 'auprc': 0.9980835724605366, 'loss_val': 0.037600407852167866, 'psi': 0.994004850217781}-{'f1_val': 0.9953504666543074, 'auprc': 0.9980964058080957, 'loss_val': 0.03832044012405343, 'psi': 0.9964488423158226}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=20 psi=0.994 u=0.0000 p_local=0.0155 f1=0.991 auprc=0.998 bytes=16138
[S13] START round=19 head_norm_before_train=3.442539 (no previous merge yet)
[S13] round=19 local utility u=0.013164 metrics={'f1_val': 0.6878859746114643, 'auprc': 0.7816047961741253, 'loss_val': 1.12473331397953, 'psi': 0.7253735032365287}-{'f1_val': 0.7140865088640704, 'auprc': 0.7751290802947943, 'loss_val': 1.2888368522394933, 'psi': 0.73850353743636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S13] r=20 psi=0.725 u=0.0132 p_local=0.1365 f1=0.688 auprc=0.782 bytes=21590
[S14] START round=19 head_norm_before_train=3.382448 (no previous merge yet)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9832870879157725, 'auprc': 0.9991208054060047, 'loss_val': 0.07006377990103921, 'psi': 0.9896205749118653}-{'f1_val': 0.9942429722026053, 'auprc': 0.9991208290673677, 'loss_val': 0.05170098267482194, 'psi': 0.9961941149485103}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=20 psi=0.990 u=0.0000 p_local=0.0640 f1=0.983 auprc=0.999 bytes=16122
[S15] START round=19 head_norm_before_train=3.080536 cos_to_last_merge=0.9866 (last merge round=1)
[S15] round=19 local utility u=0.005340 metrics={'f1_val': 0.9950866547103594, 'auprc': 0.9987660754704899, 'loss_val': 0.02940983516134586, 'psi': 0.9965584230144116}-{'f1_val': 0.9934185961837458, 'auprc': 0.9987579744774733, 'loss_val': 0.030057370947638527, 'psi': 0.9955543475012368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S15] r=20 psi=0.997 u=0.0053 p_local=0.0187 f1=0.995 auprc=0.999 bytes=19732
[S16] START round=19 head_norm_before_train=3.082134 (no previous merge yet)
[S16] round=19 local utility u=0.036966 metrics={'f1_val': 0.9941636766716053, 'auprc': 0.9812035395339247, 'loss_val': 0.03752736364904436, 'psi': 0.9889796218165331}-{'f1_val': 0.989649172571529, 'auprc': 0.9815567705611137, 'loss_val': 0.08543272528702628, 'psi': 0.9864122117673628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S16] r=20 psi=0.989 u=0.0370 p_local=0.0238 f1=0.994 auprc=0.981 bytes=14380
[S17] START round=19 head_norm_before_train=3.215630 cos_to_last_merge=0.9803 (last merge round=2)
[S17] round=19 local utility u=0.016170 metrics={'f1_val': 0.8638320251181475, 'auprc': 0.9416564380951954, 'loss_val': 0.2655343026028213, 'psi': 0.8949617903089666}-{'f1_val': 0.8832694381977851, 'auprc': 0.98093373892792, 'loss_val': 0.5323314563232279, 'psi': 0.9223351584898392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] sending update (kind=head size=1789 to 1 peers)
[S17] r=20 psi=0.895 u=0.0162 p_local=0.1038 f1=0.864 auprc=0.942 bytes=17938
[S2] START round=20 head_norm_before_train=3.158618 (no previous merge yet)
[S2] round=20 local utility u=0.315022 metrics={'f1_val': 0.9068912953135119, 'auprc': 0.9645878055151098, 'loss_val': 0.2535104664351161, 'psi': 0.929969899394151}-{'f1_val': 0.829450964717245, 'auprc': 0.959775338564675, 'loss_val': 0.40447520270540593, 'psi': 0.8815807142562171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] sending update (kind=head size=1791 to 1 peers)
[S3] START round=20 head_norm_before_train=3.174177 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.7696200003639464, 'auprc': 0.9969514984855845, 'loss_val': 1.0338277871924184, 'psi': 0.8605525996126017}-{'f1_val': 0.7747410885246024, 'auprc': 0.9971097988708244, 'loss_val': 0.9929050654017696, 'psi': 0.8636885726630912}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=20 head_norm_before_train=3.180253 cos_to_last_merge=0.9347 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.935
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9426134982817986, 'auprc': 0.9789463135833585, 'loss_val': 0.2276464071102181, 'psi': 0.9571466244024225}-{'f1_val': 0.9525886287139074, 'auprc': 0.9871990364233638, 'loss_val': 0.2668319127199777, 'psi': 0.96643279179769}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=20 head_norm_before_train=3.229480 cos_to_last_merge=0.9375 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.9977261485592046, 'auprc': 0.9968212260256242, 'loss_val': 0.010122120215764354, 'psi': 0.9973641795457725}-{'f1_val': 0.9980195382902922, 'auprc': 0.9967800882234763, 'loss_val': 0.01095287054965033, 'psi': 0.9975237582635659}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=20 head_norm_before_train=3.506852 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.8114399753938171, 'auprc': 0.952596020263921, 'loss_val': 0.5163964287992546, 'psi': 0.8679023933418586}-{'f1_val': 0.8121831826941645, 'auprc': 0.9532254105231094, 'loss_val': 0.4792965382084503, 'psi': 0.8686000738257424}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=20 head_norm_before_train=3.492964 cos_to_last_merge=0.9094 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.909
[S7] round=20 local utility u=0.185878 metrics={'f1_val': 0.798882277598945, 'auprc': 0.9343894040663652, 'loss_val': 1.0621526261886276, 'psi': 0.8530851281859131}-{'f1_val': 0.7612452415263996, 'auprc': 0.8868856433724156, 'loss_val': 1.0655747207149608, 'psi': 0.8115014022648059}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=20 head_norm_before_train=3.533629 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.8443316184259878, 'auprc': 0.9924152446730822, 'loss_val': 0.5455619293787788, 'psi': 0.9035650689248256}-{'f1_val': 0.8477786879670713, 'auprc': 0.9929411840978373, 'loss_val': 0.48247589722529544, 'psi': 0.9058436864193777}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=20 head_norm_before_train=3.165035 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9971551902648863, 'auprc': 0.999998335901247, 'loss_val': 0.005800435476178436, 'psi': 0.9982924485194306}-{'f1_val': 0.9971551902648863, 'auprc': 0.9999983359012469, 'loss_val': 0.005569123820298506, 'psi': 0.9982924485194304}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=20 head_norm_before_train=3.132116 cos_to_last_merge=0.9055 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.906
[S10] round=20 local utility u=0.001925 metrics={'f1_val': 0.9955766401672886, 'auprc': 0.9952671942523406, 'loss_val': 0.031430782073588764, 'psi': 0.9954528618013094}-{'f1_val': 0.9955766401672886, 'auprc': 0.9939601740293862, 'loss_val': 0.03136055261616128, 'psi': 0.9949300537121277}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=20 head_norm_before_train=3.429986 (no previous merge yet)
[S11] round=20 local utility u=0.000087 metrics={'f1_val': 0.9917621628052959, 'auprc': 0.9972140183550127, 'loss_val': 0.037676703392071846, 'psi': 0.9939429050251826}-{'f1_val': 0.9912857020559438, 'auprc': 0.9980835724605366, 'loss_val': 0.037600407852167866, 'psi': 0.994004850217781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] sending update (kind=head size=1790 to 1 peers)
[S13] START round=20 head_norm_before_train=3.478283 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.6180160233420471, 'auprc': 0.7317323687108346, 'loss_val': 1.0701317877504986, 'psi': 0.663502561489562}-{'f1_val': 0.6878859746114643, 'auprc': 0.7816047961741253, 'loss_val': 1.12473331397953, 'psi': 0.7253735032365287}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=20 head_norm_before_train=3.429175 (no previous merge yet)
[S14] round=20 local utility u=0.065267 metrics={'f1_val': 0.9983500887049084, 'auprc': 0.9994164516995763, 'loss_val': 0.030794071643989698, 'psi': 0.9987766339027755}-{'f1_val': 0.9832870879157725, 'auprc': 0.9991208054060047, 'loss_val': 0.07006377990103921, 'psi': 0.9896205749118653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] sending update (kind=head size=1789 to 1 peers)
[S15] START round=20 head_norm_before_train=3.104913 cos_to_last_merge=0.9860 (last merge round=1)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.9938363733929021, 'auprc': 0.9987595166014859, 'loss_val': 0.030198145355356455, 'psi': 0.9958056306763357}-{'f1_val': 0.9950866547103594, 'auprc': 0.9987660754704899, 'loss_val': 0.02940983516134586, 'psi': 0.9965584230144116}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=20 head_norm_before_train=3.137123 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.9940140866840121, 'auprc': 0.9818588867990314, 'loss_val': 0.04544101354683051, 'psi': 0.9891520067300199}-{'f1_val': 0.9941636766716053, 'auprc': 0.9812035395339247, 'loss_val': 0.03752736364904436, 'psi': 0.9889796218165331}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=20 head_norm_before_train=3.030311 cos_to_last_merge=0.9792 (last merge round=2)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.8643928386848996, 'auprc': 0.951217505677172, 'loss_val': 0.5354391231332069, 'psi': 0.8991227054818086}-{'f1_val': 0.8638320251181475, 'auprc': 0.9416564380951954, 'loss_val': 0.2655343026028213, 'psi': 0.8949617903089666}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=21 head_norm_before_train=3.197087 (no previous merge yet)
[S2] round=21 local utility u=0.030854 metrics={'f1_val': 0.9123708332279509, 'auprc': 0.9737419151598474, 'loss_val': 0.25214214221562997, 'psi': 0.9369192660007095}-{'f1_val': 0.9068912953135119, 'auprc': 0.9645878055151098, 'loss_val': 0.2535104664351161, 'psi': 0.929969899394151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] sending update (kind=head size=1792 to 1 peers)
[S3] START round=21 head_norm_before_train=3.197984 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.7705576835822979, 'auprc': 0.996989625797236, 'loss_val': 1.0486902997403762, 'psi': 0.8611304604682731}-{'f1_val': 0.7696200003639464, 'auprc': 0.9969514984855845, 'loss_val': 1.0338277871924184, 'psi': 0.8605525996126017}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=21 head_norm_before_train=3.243410 cos_to_last_merge=0.9336 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.934
[S4] round=21 local utility u=0.027327 metrics={'f1_val': 0.9556628861671479, 'auprc': 0.9872827578192825, 'loss_val': 0.2762972679584488, 'psi': 0.9683108348280018}-{'f1_val': 0.9426134982817986, 'auprc': 0.9789463135833585, 'loss_val': 0.2276464071102181, 'psi': 0.9571466244024225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=21 head_norm_before_train=3.309769 cos_to_last_merge=0.9356 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.936
[S5] round=21 local utility u=0.004173 metrics={'f1_val': 0.999560106868155, 'auprc': 0.9995446498450491, 'loss_val': 0.020950257274731068, 'psi': 0.9995539240589126}-{'f1_val': 0.9977261485592046, 'auprc': 0.9968212260256242, 'loss_val': 0.010122120215764354, 'psi': 0.9973641795457725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] START round=21 head_norm_before_train=3.534125 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.810263641111481, 'auprc': 0.952312739552995, 'loss_val': 0.5395677503212122, 'psi': 0.8670832804880866}-{'f1_val': 0.8114399753938171, 'auprc': 0.952596020263921, 'loss_val': 0.5163964287992546, 'psi': 0.8679023933418586}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=21 head_norm_before_train=3.545856 cos_to_last_merge=0.9061 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.906
[S7] round=21 local utility u=0.047594 metrics={'f1_val': 0.8200421666275208, 'auprc': 0.9326037826165994, 'loss_val': 1.0885680126400357, 'psi': 0.8650668130231522}-{'f1_val': 0.798882277598945, 'auprc': 0.9343894040663652, 'loss_val': 1.0621526261886276, 'psi': 0.8530851281859131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=21 head_norm_before_train=3.568558 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.8408905313982697, 'auprc': 0.9919551061007743, 'loss_val': 0.6215901136365437, 'psi': 0.9013163612792716}-{'f1_val': 0.8443316184259878, 'auprc': 0.9924152446730822, 'loss_val': 0.5455619293787788, 'psi': 0.9035650689248256}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=21 head_norm_before_train=3.187129 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9971551902648863, 'auprc': 0.9999983359012469, 'loss_val': 0.0062900274273252335, 'psi': 0.9982924485194304}-{'f1_val': 0.9971551902648863, 'auprc': 0.999998335901247, 'loss_val': 0.005800435476178436, 'psi': 0.9982924485194306}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=21 head_norm_before_train=3.171626 cos_to_last_merge=0.9002 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.900
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9953575369619982, 'auprc': 0.9955877527194512, 'loss_val': 0.03167979208715392, 'psi': 0.9954496232649794}-{'f1_val': 0.9955766401672886, 'auprc': 0.9952671942523406, 'loss_val': 0.031430782073588764, 'psi': 0.9954528618013094}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=21 head_norm_before_train=3.485356 (no previous merge yet)
[S11] round=21 local utility u=0.001756 metrics={'f1_val': 0.9920005651021421, 'auprc': 0.9971461581413125, 'loss_val': 0.035391616890516654, 'psi': 0.9940588023178103}-{'f1_val': 0.9917621628052959, 'auprc': 0.9972140183550127, 'loss_val': 0.037676703392071846, 'psi': 0.9939429050251826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] sending update (kind=head size=1791 to 1 peers)
[S13] START round=21 head_norm_before_train=3.572544 (no previous merge yet)
[S13] round=21 local utility u=0.176025 metrics={'f1_val': 0.7140476343532406, 'auprc': 0.7706758363373266, 'loss_val': 1.411102594367179, 'psi': 0.736698915146875}-{'f1_val': 0.6180160233420471, 'auprc': 0.7317323687108346, 'loss_val': 1.0701317877504986, 'psi': 0.663502561489562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=21 head_norm_before_train=3.478706 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9950335354585476, 'auprc': 0.9992963818902305, 'loss_val': 0.04357349439189192, 'psi': 0.9967386740312207}-{'f1_val': 0.9983500887049084, 'auprc': 0.9994164516995763, 'loss_val': 0.030794071643989698, 'psi': 0.9987766339027755}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=21 head_norm_before_train=3.128622 cos_to_last_merge=0.9855 (last merge round=1)
[S15] round=21 local utility u=0.009637 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987789565037275, 'loss_val': 0.02844427945558587, 'psi': 0.9975595836340033}-{'f1_val': 0.9938363733929021, 'auprc': 0.9987595166014859, 'loss_val': 0.030198145355356455, 'psi': 0.9958056306763357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=21 head_norm_before_train=3.187915 (no previous merge yet)
[S16] round=21 local utility u=0.002664 metrics={'f1_val': 0.9941636766716053, 'auprc': 0.9811257222063388, 'loss_val': 0.03881031261931525, 'psi': 0.9889484948854987}-{'f1_val': 0.9940140866840121, 'auprc': 0.9818588867990314, 'loss_val': 0.04544101354683051, 'psi': 0.9891520067300199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=21 head_norm_before_train=3.142534 cos_to_last_merge=0.9803 (last merge round=2)
[S17] round=21 local utility u=0.042601 metrics={'f1_val': 0.8772902536205669, 'auprc': 0.9652756281947312, 'loss_val': 0.5697950643623194, 'psi': 0.9124844034502326}-{'f1_val': 0.8643928386848996, 'auprc': 0.951217505677172, 'loss_val': 0.5354391231332069, 'psi': 0.8991227054818086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=22 head_norm_before_train=3.241056 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.9123708332279509, 'auprc': 0.9660383491924126, 'loss_val': 0.25081399052058084, 'psi': 0.9338378396137356}-{'f1_val': 0.9123708332279509, 'auprc': 0.9737419151598474, 'loss_val': 0.25214214221562997, 'psi': 0.9369192660007095}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=22 head_norm_before_train=3.221150 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.7663146205644704, 'auprc': 0.9968397835845416, 'loss_val': 1.0855502229015952, 'psi': 0.8585246857724989}-{'f1_val': 0.7705576835822979, 'auprc': 0.996989625797236, 'loss_val': 1.0486902997403762, 'psi': 0.8611304604682731}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=3.256755 cos_to_last_merge=0.9220 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.922
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9548697074901109, 'auprc': 0.9868218311859892, 'loss_val': 0.3279758631768864, 'psi': 0.9676505569684621}-{'f1_val': 0.9556628861671479, 'auprc': 0.9872827578192825, 'loss_val': 0.2762972679584488, 'psi': 0.9683108348280018}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=22 head_norm_before_train=3.385861 cos_to_last_merge=0.9342 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.998830094202838, 'auprc': 0.9998863397329265, 'loss_val': 0.04226099602329931, 'psi': 0.9992525924148734}-{'f1_val': 0.999560106868155, 'auprc': 0.9995446498450491, 'loss_val': 0.020950257274731068, 'psi': 0.9995539240589126}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=22 head_norm_before_train=3.560089 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.8100154763617053, 'auprc': 0.9524874059109188, 'loss_val': 0.5387719476469037, 'psi': 0.8670042481813908}-{'f1_val': 0.810263641111481, 'auprc': 0.952312739552995, 'loss_val': 0.5395677503212122, 'psi': 0.8670832804880866}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=22 head_norm_before_train=3.602024 cos_to_last_merge=0.9048 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.905
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.8064545793008592, 'auprc': 0.9275972745455369, 'loss_val': 1.1846707778851608, 'psi': 0.8549116573987302}-{'f1_val': 0.8200421666275208, 'auprc': 0.9326037826165994, 'loss_val': 1.0885680126400357, 'psi': 0.8650668130231522}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=22 head_norm_before_train=3.599373 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.8406449336694648, 'auprc': 0.9910794602805447, 'loss_val': 0.6614594952143953, 'psi': 0.9008187443138967}-{'f1_val': 0.8408905313982697, 'auprc': 0.9919551061007743, 'loss_val': 0.6215901136365437, 'psi': 0.9013163612792716}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=22 head_norm_before_train=3.208685 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9971551902648863, 'auprc': 0.9999979196681564, 'loss_val': 0.006721171055290219, 'psi': 0.9982922820261944}-{'f1_val': 0.9971551902648863, 'auprc': 0.9999983359012469, 'loss_val': 0.0062900274273252335, 'psi': 0.9982924485194304}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=22 head_norm_before_train=3.204690 cos_to_last_merge=0.8961 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.896
[S10] round=22 local utility u=0.000271 metrics={'f1_val': 0.9953575369619982, 'auprc': 0.9958543055207676, 'loss_val': 0.0319380918032287, 'psi': 0.9955562443855059}-{'f1_val': 0.9953575369619982, 'auprc': 0.9955877527194512, 'loss_val': 0.03167979208715392, 'psi': 0.9954496232649794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=22 head_norm_before_train=3.524760 (no previous merge yet)
[S11] round=22 local utility u=0.002314 metrics={'f1_val': 0.9924777155032968, 'auprc': 0.9971370608415223, 'loss_val': 0.03359929859927268, 'psi': 0.9943414536385871}-{'f1_val': 0.9920005651021421, 'auprc': 0.9971461581413125, 'loss_val': 0.035391616890516654, 'psi': 0.9940588023178103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] sending update (kind=head size=1790 to 1 peers)
[S13] START round=22 head_norm_before_train=3.633317 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.6353115095584241, 'auprc': 0.7364456679971869, 'loss_val': 1.0204006514440895, 'psi': 0.6757651729339291}-{'f1_val': 0.7140476343532406, 'auprc': 0.7706758363373266, 'loss_val': 1.411102594367179, 'psi': 0.736698915146875}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=3.522854 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9909511813771572, 'auprc': 0.9991236845335029, 'loss_val': 0.04749813879235359, 'psi': 0.9942201826396955}-{'f1_val': 0.9950335354585476, 'auprc': 0.9992963818902305, 'loss_val': 0.04357349439189192, 'psi': 0.9967386740312207}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=22 head_norm_before_train=3.151782 cos_to_last_merge=0.9849 (last merge round=1)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.9950866547103594, 'auprc': 0.9987675605687267, 'loss_val': 0.02991760197755446, 'psi': 0.9965590170537063}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987789565037275, 'loss_val': 0.02844427945558587, 'psi': 0.9975595836340033}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=22 head_norm_before_train=3.231870 (no previous merge yet)
[S16] round=22 local utility u=0.000688 metrics={'f1_val': 0.9941636766716053, 'auprc': 0.9818294045259501, 'loss_val': 0.039545859253063184, 'psi': 0.9892299678133433}-{'f1_val': 0.9941636766716053, 'auprc': 0.9811257222063388, 'loss_val': 0.03881031261931525, 'psi': 0.9889484948854987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=22 head_norm_before_train=3.201741 cos_to_last_merge=0.9792 (last merge round=2)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.8747416186064498, 'auprc': 0.9609890346758249, 'loss_val': 0.623675708249253, 'psi': 0.9092405850341998}-{'f1_val': 0.8772902536205669, 'auprc': 0.9652756281947312, 'loss_val': 0.5697950643623194, 'psi': 0.9124844034502326}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=23 head_norm_before_train=3.273784 (no previous merge yet)
[S2] round=23 local utility u=0.004747 metrics={'f1_val': 0.9123708332279509, 'auprc': 0.9677497887243007, 'loss_val': 0.24645369222983962, 'psi': 0.9345224154264908}-{'f1_val': 0.9123708332279509, 'auprc': 0.9660383491924126, 'loss_val': 0.25081399052058084, 'psi': 0.9338378396137356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=23 head_norm_before_train=3.243710 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.758130588134143, 'auprc': 0.9966647148485105, 'loss_val': 1.1240890859425685, 'psi': 0.8535442388198899}-{'f1_val': 0.7663146205644704, 'auprc': 0.9968397835845416, 'loss_val': 1.0855502229015952, 'psi': 0.8585246857724989}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=23 head_norm_before_train=3.346776 cos_to_last_merge=0.9276 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.928
[S4] round=23 local utility u=0.012622 metrics={'f1_val': 0.9506537834975981, 'auprc': 0.9864870601093058, 'loss_val': 0.2764317988091185, 'psi': 0.9649870941422811}-{'f1_val': 0.9548697074901109, 'auprc': 0.9868218311859892, 'loss_val': 0.3279758631768864, 'psi': 0.9676505569684621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=23 head_norm_before_train=3.447411 cos_to_last_merge=0.9329 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=23 local utility u=0.007417 metrics={'f1_val': 0.9981658310701668, 'auprc': 0.9968224214508006, 'loss_val': 0.014248763772556135, 'psi': 0.9976284672224203}-{'f1_val': 0.998830094202838, 'auprc': 0.9998863397329265, 'loss_val': 0.04226099602329931, 'psi': 0.9992525924148734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=23 head_norm_before_train=3.585512 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.8080887738040897, 'auprc': 0.9517763087222566, 'loss_val': 0.551413535328862, 'psi': 0.8655637877713565}-{'f1_val': 0.8100154763617053, 'auprc': 0.9524874059109188, 'loss_val': 0.5387719476469037, 'psi': 0.8670042481813908}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=23 head_norm_before_train=3.649815 cos_to_last_merge=0.9036 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.904
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.7942350195774516, 'auprc': 0.9271120325153173, 'loss_val': 1.2582255819724133, 'psi': 0.8473858247525978}-{'f1_val': 0.8064545793008592, 'auprc': 0.9275972745455369, 'loss_val': 1.1846707778851608, 'psi': 0.8549116573987302}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=23 head_norm_before_train=3.627825 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.8403993593034904, 'auprc': 0.990378273960999, 'loss_val': 0.7051374569929851, 'psi': 0.9003909251664938}-{'f1_val': 0.8406449336694648, 'auprc': 0.9910794602805447, 'loss_val': 0.6614594952143953, 'psi': 0.9008187443138967}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=23 head_norm_before_train=3.229507 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9971551902648863, 'auprc': 0.9999979196681564, 'loss_val': 0.007064529734435777, 'psi': 0.9982922820261944}-{'f1_val': 0.9971551902648863, 'auprc': 0.9999979196681564, 'loss_val': 0.006721171055290219, 'psi': 0.9982922820261944}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=23 head_norm_before_train=3.233692 cos_to_last_merge=0.8925 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.892
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9953575369619982, 'auprc': 0.995872830472493, 'loss_val': 0.03222105650220023, 'psi': 0.9955636543661961}-{'f1_val': 0.9953575369619982, 'auprc': 0.9958543055207676, 'loss_val': 0.0319380918032287, 'psi': 0.9955562443855059}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=23 head_norm_before_train=3.553839 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9917621628052959, 'auprc': 0.9973130852997873, 'loss_val': 0.035860382650964195, 'psi': 0.9939825318030925}-{'f1_val': 0.9924777155032968, 'auprc': 0.9971370608415223, 'loss_val': 0.03359929859927268, 'psi': 0.9943414536385871}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=23 head_norm_before_train=3.652236 (no previous merge yet)
[S13] round=23 local utility u=0.111873 metrics={'f1_val': 0.7216133866001946, 'auprc': 0.7817539535882424, 'loss_val': 1.4503899890185508, 'psi': 0.7456696133954137}-{'f1_val': 0.6353115095584241, 'auprc': 0.7364456679971869, 'loss_val': 1.0204006514440895, 'psi': 0.6757651729339291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] sending update (kind=head size=1790 to 1 peers)
[S14] START round=23 head_norm_before_train=3.555398 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9847681294433193, 'auprc': 0.9991202393579017, 'loss_val': 0.060027057371961755, 'psi': 0.9905089734091522}-{'f1_val': 0.9909511813771572, 'auprc': 0.9991236845335029, 'loss_val': 0.04749813879235359, 'psi': 0.9942201826396955}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=23 head_norm_before_train=3.174376 cos_to_last_merge=0.9844 (last merge round=1)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.9950866547103594, 'auprc': 0.9987698027057876, 'loss_val': 0.030146245634983682, 'psi': 0.9965599139085306}-{'f1_val': 0.9950866547103594, 'auprc': 0.9987675605687267, 'loss_val': 0.02991760197755446, 'psi': 0.9965590170537063}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=23 head_norm_before_train=3.270694 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.9941636766716053, 'auprc': 0.9819722659844922, 'loss_val': 0.04030169167070444, 'psi': 0.9892871123967601}-{'f1_val': 0.9941636766716053, 'auprc': 0.9818294045259501, 'loss_val': 0.039545859253063184, 'psi': 0.9892299678133433}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=23 head_norm_before_train=3.233801 cos_to_last_merge=0.9787 (last merge round=2)
[S17] round=23 local utility u=0.001482 metrics={'f1_val': 0.8771434108859739, 'auprc': 0.9642096555581403, 'loss_val': 0.644783742851542, 'psi': 0.9119699087548404}-{'f1_val': 0.8747416186064498, 'auprc': 0.9609890346758249, 'loss_val': 0.623675708249253, 'psi': 0.9092405850341998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] sending update (kind=head size=1788 to 1 peers)
[S2] START round=24 head_norm_before_train=3.303953 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.8502340001854634, 'auprc': 0.9446137286324028, 'loss_val': 0.22795847882305598, 'psi': 0.8879858915642391}-{'f1_val': 0.9123708332279509, 'auprc': 0.9677497887243007, 'loss_val': 0.24645369222983962, 'psi': 0.9345224154264908}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=24 head_norm_before_train=3.265820 (no previous merge yet)
[S3] round=24 local utility u=0.015381 metrics={'f1_val': 0.7639309077413913, 'auprc': 0.996753911688792, 'loss_val': 1.1283964266435818, 'psi': 0.8570601093203516}-{'f1_val': 0.758130588134143, 'auprc': 0.9966647148485105, 'loss_val': 1.1240890859425685, 'psi': 0.8535442388198899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=24 head_norm_before_train=3.401664 cos_to_last_merge=0.9269 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.927
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9561867985210111, 'auprc': 0.9866990549137934, 'loss_val': 0.3215835414350985, 'psi': 0.968391701078124}-{'f1_val': 0.9506537834975981, 'auprc': 0.9864870601093058, 'loss_val': 0.2764317988091185, 'psi': 0.9649870941422811}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=24 head_norm_before_train=3.487000 cos_to_last_merge=0.9307 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.931
[S5] round=24 local utility u=0.006293 metrics={'f1_val': 0.9991936395785745, 'auprc': 0.9970530408021463, 'loss_val': 0.008521682315370213, 'psi': 0.9983374000680032}-{'f1_val': 0.9981658310701668, 'auprc': 0.9968224214508006, 'loss_val': 0.014248763772556135, 'psi': 0.9976284672224203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] sending update (kind=head size=1790 to 1 peers)
[S6] START round=24 head_norm_before_train=3.609926 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.8061763081350768, 'auprc': 0.9514912524608725, 'loss_val': 0.5426053446754436, 'psi': 0.864302285865395}-{'f1_val': 0.8080887738040897, 'auprc': 0.9517763087222566, 'loss_val': 0.551413535328862, 'psi': 0.8655637877713565}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=24 head_norm_before_train=3.694127 cos_to_last_merge=0.9026 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.903
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.7931280736965579, 'auprc': 0.9286909703127687, 'loss_val': 1.2950743908235127, 'psi': 0.8473532323430423}-{'f1_val': 0.7942350195774516, 'auprc': 0.9271120325153173, 'loss_val': 1.2582255819724133, 'psi': 0.8473858247525978}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=24 head_norm_before_train=3.654409 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.8374541179053173, 'auprc': 0.9895688744409333, 'loss_val': 0.7695028273068222, 'psi': 0.8983000205195637}-{'f1_val': 0.8403993593034904, 'auprc': 0.990378273960999, 'loss_val': 0.7051374569929851, 'psi': 0.9003909251664938}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=24 head_norm_before_train=3.250284 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9971551902648863, 'auprc': 0.9999950516098794, 'loss_val': 0.007417373051745135, 'psi': 0.9982911348028836}-{'f1_val': 0.9971551902648863, 'auprc': 0.9999979196681564, 'loss_val': 0.007064529734435777, 'psi': 0.9982922820261944}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=24 head_norm_before_train=3.262797 cos_to_last_merge=0.8902 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.890
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9953575369619982, 'auprc': 0.9958136119666847, 'loss_val': 0.03248071793651974, 'psi': 0.9955399669638729}-{'f1_val': 0.9953575369619982, 'auprc': 0.995872830472493, 'loss_val': 0.03222105650220023, 'psi': 0.9955636543661961}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=24 head_norm_before_train=3.579758 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9891472248453645, 'auprc': 0.9973268785372856, 'loss_val': 0.043935124366080436, 'psi': 0.992419086322133}-{'f1_val': 0.9917621628052959, 'auprc': 0.9973130852997873, 'loss_val': 0.035860382650964195, 'psi': 0.9939825318030925}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=24 head_norm_before_train=3.734813 (no previous merge yet)
[S13] round=24 local utility u=0.086688 metrics={'f1_val': 0.7394539144640766, 'auprc': 0.7798625568132808, 'loss_val': 1.3783839316673336, 'psi': 0.7556173714037583}-{'f1_val': 0.7216133866001946, 'auprc': 0.7817539535882424, 'loss_val': 1.4503899890185508, 'psi': 0.7456696133954137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=24 head_norm_before_train=3.583708 (no previous merge yet)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9808086623556422, 'auprc': 0.9991199537245886, 'loss_val': 0.06769026910865115, 'psi': 0.9881331789032208}-{'f1_val': 0.9847681294433193, 'auprc': 0.9991202393579017, 'loss_val': 0.060027057371961755, 'psi': 0.9905089734091522}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=24 head_norm_before_train=3.196471 cos_to_last_merge=0.9838 (last merge round=1)
[S15] round=24 local utility u=0.000020 metrics={'f1_val': 0.9950866547103594, 'auprc': 0.9987752566568067, 'loss_val': 0.030122382705472343, 'psi': 0.9965620954889383}-{'f1_val': 0.9950866547103594, 'auprc': 0.9987698027057876, 'loss_val': 0.030146245634983682, 'psi': 0.9965599139085306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] sending update (kind=head size=1790 to 1 peers)
[S16] START round=24 head_norm_before_train=3.307712 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.9939211508931698, 'auprc': 0.9821020003261608, 'loss_val': 0.04118328333461605, 'psi': 0.9891934906663662}-{'f1_val': 0.9941636766716053, 'auprc': 0.9819722659844922, 'loss_val': 0.04030169167070444, 'psi': 0.9892871123967601}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=24 head_norm_before_train=3.279548 cos_to_last_merge=0.9779 (last merge round=2)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.8762389862372895, 'auprc': 0.9630475767208129, 'loss_val': 0.6896453800788481, 'psi': 0.9109624224306988}-{'f1_val': 0.8771434108859739, 'auprc': 0.9642096555581403, 'loss_val': 0.644783742851542, 'psi': 0.9119699087548404}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=25 head_norm_before_train=3.314480 (no previous merge yet)
[S2] round=25 local utility u=0.220334 metrics={'f1_val': 0.9147468905278092, 'auprc': 0.9647586537012539, 'loss_val': 0.23480174910473595, 'psi': 0.9347515957971871}-{'f1_val': 0.8502340001854634, 'auprc': 0.9446137286324028, 'loss_val': 0.22795847882305598, 'psi': 0.8879858915642391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=25 head_norm_before_train=3.287495 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.7605611987514278, 'auprc': 0.9966982117882217, 'loss_val': 1.1576597925321401, 'psi': 0.8550160039661454}-{'f1_val': 0.7639309077413913, 'auprc': 0.996753911688792, 'loss_val': 1.1283964266435818, 'psi': 0.8570601093203516}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=3.408156 cos_to_last_merge=0.9203 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.920
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9449116455729847, 'auprc': 0.9762884937477228, 'loss_val': 0.3314119485668107, 'psi': 0.9574623848428799}-{'f1_val': 0.9561867985210111, 'auprc': 0.9866990549137934, 'loss_val': 0.3215835414350985, 'psi': 0.968391701078124}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=25 head_norm_before_train=3.548336 cos_to_last_merge=0.9288 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.929
[S5] round=25 local utility u=0.000191 metrics={'f1_val': 0.9991206264817875, 'auprc': 0.9969991973798997, 'loss_val': 0.007539428273885691, 'psi': 0.9982720548410323}-{'f1_val': 0.9991936395785745, 'auprc': 0.9970530408021463, 'loss_val': 0.008521682315370213, 'psi': 0.9983374000680032}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] sending update (kind=head size=1792 to 1 peers)
[S6] START round=25 head_norm_before_train=3.634434 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.8072378340315634, 'auprc': 0.951426515779656, 'loss_val': 0.5650941122109568, 'psi': 0.8649133067308004}-{'f1_val': 0.8061763081350768, 'auprc': 0.9514912524608725, 'loss_val': 0.5426053446754436, 'psi': 0.864302285865395}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=25 head_norm_before_train=3.734278 cos_to_last_merge=0.9017 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.902
[S7] round=25 local utility u=0.026553 metrics={'f1_val': 0.7999132366014554, 'auprc': 0.933238284940156, 'loss_val': 1.2963211220816984, 'psi': 0.8532432559369356}-{'f1_val': 0.7931280736965579, 'auprc': 0.9286909703127687, 'loss_val': 1.2950743908235127, 'psi': 0.8473532323430423}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=25 head_norm_before_train=3.679579 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.8369635078769484, 'auprc': 0.9888003943026042, 'loss_val': 0.8107598845479788, 'psi': 0.8976982624472107}-{'f1_val': 0.8374541179053173, 'auprc': 0.9895688744409333, 'loss_val': 0.7695028273068222, 'psi': 0.8983000205195637}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=25 head_norm_before_train=3.270198 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9971551902648863, 'auprc': 0.9999945145984299, 'loss_val': 0.007890700973874664, 'psi': 0.9982909199983037}-{'f1_val': 0.9971551902648863, 'auprc': 0.9999950516098794, 'loss_val': 0.007417373051745135, 'psi': 0.9982911348028836}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=25 head_norm_before_train=3.286276 cos_to_last_merge=0.8871 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.887
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9953575369619982, 'auprc': 0.9958211361363503, 'loss_val': 0.0329290964008218, 'psi': 0.9955429766317391}-{'f1_val': 0.9953575369619982, 'auprc': 0.9958136119666847, 'loss_val': 0.03248071793651974, 'psi': 0.9955399669638729}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=25 head_norm_before_train=3.604060 (no previous merge yet)
[S11] round=25 local utility u=0.003222 metrics={'f1_val': 0.9898590424280995, 'auprc': 0.9973461512345609, 'loss_val': 0.041818927856674924, 'psi': 0.9928538859506841}-{'f1_val': 0.9891472248453645, 'auprc': 0.9973268785372856, 'loss_val': 0.043935124366080436, 'psi': 0.992419086322133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=25 head_norm_before_train=3.772299 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.7022782605445871, 'auprc': 0.7673544504087177, 'loss_val': 1.2374935825133533, 'psi': 0.7283087364902394}-{'f1_val': 0.7394539144640766, 'auprc': 0.7798625568132808, 'loss_val': 1.3783839316673336, 'psi': 0.7556173714037583}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=25 head_norm_before_train=3.609061 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.978249166155719, 'auprc': 0.999121662183771, 'loss_val': 0.06898767473803352, 'psi': 0.9865981645669397}-{'f1_val': 0.9808086623556422, 'auprc': 0.9991199537245886, 'loss_val': 0.06769026910865115, 'psi': 0.9881331789032208}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=25 head_norm_before_train=3.218150 cos_to_last_merge=0.9833 (last merge round=1)
[S15] round=25 local utility u=0.005385 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987793751108558, 'loss_val': 0.029324782751884958, 'psi': 0.9975597510768547}-{'f1_val': 0.9950866547103594, 'auprc': 0.9987752566568067, 'loss_val': 0.030122382705472343, 'psi': 0.9965620954889383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=25 head_norm_before_train=3.342208 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.9939211508931698, 'auprc': 0.982260537611875, 'loss_val': 0.04174365151144487, 'psi': 0.9892569055806519}-{'f1_val': 0.9939211508931698, 'auprc': 0.9821020003261608, 'loss_val': 0.04118328333461605, 'psi': 0.9891934906663662}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=25 head_norm_before_train=3.315626 cos_to_last_merge=0.9771 (last merge round=2)
[S17] round=25 local utility u=0.163483 metrics={'f1_val': 0.8842217295034811, 'auprc': 0.9599940246602274, 'loss_val': 0.4014157336693697, 'psi': 0.9145306475661796}-{'f1_val': 0.8762389862372895, 'auprc': 0.9630475767208129, 'loss_val': 0.6896453800788481, 'psi': 0.9109624224306988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] sending update (kind=head size=1791 to 1 peers)
[S2] START round=26 head_norm_before_train=3.392586 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.9137766741826995, 'auprc': 0.9475753794446027, 'loss_val': 0.23788545921487358, 'psi': 0.9272961562874609}-{'f1_val': 0.9147468905278092, 'auprc': 0.9647586537012539, 'loss_val': 0.23480174910473595, 'psi': 0.9347515957971871}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=3.308794 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.7431120424886148, 'auprc': 0.9964080213090145, 'loss_val': 1.2073039383974873, 'psi': 0.8444304340167748}-{'f1_val': 0.7605611987514278, 'auprc': 0.9966982117882217, 'loss_val': 1.1576597925321401, 'psi': 0.8550160039661454}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=3.466507 cos_to_last_merge=0.9197 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.920
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9494978953618645, 'auprc': 0.9517018923784168, 'loss_val': 0.3584122424550132, 'psi': 0.9503794941684853}-{'f1_val': 0.9449116455729847, 'auprc': 0.9762884937477228, 'loss_val': 0.3314119485668107, 'psi': 0.9574623848428799}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=26 head_norm_before_train=3.607347 cos_to_last_merge=0.9265 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.926
[S5] round=26 local utility u=0.002753 metrics={'f1_val': 0.9989004582326563, 'auprc': 0.999918199985874, 'loss_val': 0.009470351632594994, 'psi': 0.9993075549339434}-{'f1_val': 0.9991206264817875, 'auprc': 0.9969991973798997, 'loss_val': 0.007539428273885691, 'psi': 0.9982720548410323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=26 head_norm_before_train=3.658355 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.8069897530444793, 'auprc': 0.951516372484505, 'loss_val': 0.5791015829625037, 'psi': 0.8648004008204896}-{'f1_val': 0.8072378340315634, 'auprc': 0.951426515779656, 'loss_val': 0.5650941122109568, 'psi': 0.8649133067308004}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=26 head_norm_before_train=3.772974 cos_to_last_merge=0.9007 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.901
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.7955512522696049, 'auprc': 0.9336135988095277, 'loss_val': 1.3492452239713195, 'psi': 0.850776190885574}-{'f1_val': 0.7999132366014554, 'auprc': 0.933238284940156, 'loss_val': 1.2963211220816984, 'psi': 0.8532432559369356}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=3.704124 (no previous merge yet)
[S8] round=26 local utility u=0.011867 metrics={'f1_val': 0.8384355488980801, 'auprc': 0.9885162241856357, 'loss_val': 0.7950058392911322, 'psi': 0.8984678190131024}-{'f1_val': 0.8369635078769484, 'auprc': 0.9888003943026042, 'loss_val': 0.8107598845479788, 'psi': 0.8976982624472107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=26 head_norm_before_train=3.289888 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9971551902648863, 'auprc': 0.9999929821260676, 'loss_val': 0.00817241079835992, 'psi': 0.9982903070093587}-{'f1_val': 0.9971551902648863, 'auprc': 0.9999945145984299, 'loss_val': 0.007890700973874664, 'psi': 0.9982909199983037}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=26 head_norm_before_train=3.312057 cos_to_last_merge=0.8855 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.885
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9951385079721303, 'auprc': 0.9958277807896914, 'loss_val': 0.033218852814911964, 'psi': 0.9954142170991548}-{'f1_val': 0.9953575369619982, 'auprc': 0.9958211361363503, 'loss_val': 0.0329290964008218, 'psi': 0.9955429766317391}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=26 head_norm_before_train=3.626479 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9896216587869567, 'auprc': 0.9972887416967304, 'loss_val': 0.04444203974244664, 'psi': 0.9926884919508662}-{'f1_val': 0.9898590424280995, 'auprc': 0.9973461512345609, 'loss_val': 0.041818927856674924, 'psi': 0.9928538859506841}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=26 head_norm_before_train=3.838239 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6664681355300536, 'auprc': 0.7455559856250322, 'loss_val': 1.488819031042219, 'psi': 0.698103275568045}-{'f1_val': 0.7022782605445871, 'auprc': 0.7673544504087177, 'loss_val': 1.2374935825133533, 'psi': 0.7283087364902394}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=3.632704 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9770742817976052, 'auprc': 0.9991222401827138, 'loss_val': 0.0727319007076655, 'psi': 0.9858934651516487}-{'f1_val': 0.978249166155719, 'auprc': 0.999121662183771, 'loss_val': 0.06898767473803352, 'psi': 0.9865981645669397}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=26 head_norm_before_train=3.239520 cos_to_last_merge=0.9828 (last merge round=1)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987769932195807, 'loss_val': 0.0297835992608946, 'psi': 0.9975587983203447}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987793751108558, 'loss_val': 0.029324782751884958, 'psi': 0.9975597510768547}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=26 head_norm_before_train=3.374750 (no previous merge yet)
[S16] round=26 local utility u=0.000168 metrics={'f1_val': 0.9939211508931698, 'auprc': 0.982581096791509, 'loss_val': 0.04236853715019295, 'psi': 0.9893851292525055}-{'f1_val': 0.9939211508931698, 'auprc': 0.982260537611875, 'loss_val': 0.04174365151144487, 'psi': 0.9892569055806519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=26 head_norm_before_train=3.328854 cos_to_last_merge=0.9766 (last merge round=2)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.8805970122815465, 'auprc': 0.98112258529092, 'loss_val': 0.5269796769466253, 'psi': 0.9208072414852959}-{'f1_val': 0.8842217295034811, 'auprc': 0.9599940246602274, 'loss_val': 0.4014157336693697, 'psi': 0.9145306475661796}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=27 head_norm_before_train=3.435447 (no previous merge yet)
[S2] round=27 local utility u=0.003953 metrics={'f1_val': 0.9137766741826995, 'auprc': 0.9523649522508701, 'loss_val': 0.24434819042861208, 'psi': 0.9292119854099679}-{'f1_val': 0.9137766741826995, 'auprc': 0.9475753794446027, 'loss_val': 0.23788545921487358, 'psi': 0.9272961562874609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=27 head_norm_before_train=3.329771 (no previous merge yet)
[S3] round=27 local utility u=0.027264 metrics={'f1_val': 0.7527119456120109, 'auprc': 0.9964842029608592, 'loss_val': 1.210604499035884, 'psi': 0.8502208485515502}-{'f1_val': 0.7431120424886148, 'auprc': 0.9964080213090145, 'loss_val': 1.2073039383974873, 'psi': 0.8444304340167748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=27 head_norm_before_train=3.530886 cos_to_last_merge=0.9172 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.917
[S4] round=27 local utility u=0.054259 metrics={'f1_val': 0.954494803750783, 'auprc': 0.9843490299185939, 'loss_val': 0.3778177185911361, 'psi': 0.9664364942179073}-{'f1_val': 0.9494978953618645, 'auprc': 0.9517018923784168, 'loss_val': 0.3584122424550132, 'psi': 0.9503794941684853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=27 head_norm_before_train=3.640328 cos_to_last_merge=0.9239 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.924
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.9989016402867434, 'auprc': 0.9999942006256113, 'loss_val': 0.01136748913068766, 'psi': 0.9993386644222906}-{'f1_val': 0.9989004582326563, 'auprc': 0.999918199985874, 'loss_val': 0.009470351632594994, 'psi': 0.9993075549339434}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=27 head_norm_before_train=3.681915 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.8058019287664996, 'auprc': 0.9507484964040056, 'loss_val': 0.5969471523189656, 'psi': 0.8637805558215019}-{'f1_val': 0.8069897530444793, 'auprc': 0.951516372484505, 'loss_val': 0.5791015829625037, 'psi': 0.8648004008204896}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=27 head_norm_before_train=3.809176 cos_to_last_merge=0.8998 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.900
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.7922532683628832, 'auprc': 0.9370584203434025, 'loss_val': 1.3902258217627954, 'psi': 0.8501753291550909}-{'f1_val': 0.7955512522696049, 'auprc': 0.9336135988095277, 'loss_val': 1.3492452239713195, 'psi': 0.850776190885574}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=27 head_norm_before_train=3.727041 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.8381901636175543, 'auprc': 0.9878837109109992, 'loss_val': 0.8314318819085895, 'psi': 0.8980675825349322}-{'f1_val': 0.8384355488980801, 'auprc': 0.9885162241856357, 'loss_val': 0.7950058392911322, 'psi': 0.8984678190131024}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=27 head_norm_before_train=3.309158 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9971551902648863, 'auprc': 0.9999929821260676, 'loss_val': 0.00873393651447523, 'psi': 0.9982903070093587}-{'f1_val': 0.9971551902648863, 'auprc': 0.9999929821260676, 'loss_val': 0.00817241079835992, 'psi': 0.9982903070093587}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=27 head_norm_before_train=3.334337 cos_to_last_merge=0.8831 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.883
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9951385079721303, 'auprc': 0.9958167870799359, 'loss_val': 0.03353143177810825, 'psi': 0.9954098196152525}-{'f1_val': 0.9951385079721303, 'auprc': 0.9958277807896914, 'loss_val': 0.033218852814911964, 'psi': 0.9954142170991548}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=27 head_norm_before_train=3.647835 (no previous merge yet)
[S11] round=27 local utility u=0.001140 metrics={'f1_val': 0.9898590424280995, 'auprc': 0.9975503256853764, 'loss_val': 0.0443710891104452, 'psi': 0.9929355557310102}-{'f1_val': 0.9896216587869567, 'auprc': 0.9972887416967304, 'loss_val': 0.04444203974244664, 'psi': 0.9926884919508662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=27 head_norm_before_train=3.882629 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6693557446559998, 'auprc': 0.7358993313288991, 'loss_val': 1.5402479577914667, 'psi': 0.6959731793251595}-{'f1_val': 0.6664681355300536, 'auprc': 0.7455559856250322, 'loss_val': 1.488819031042219, 'psi': 0.698103275568045}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=3.655329 (no previous merge yet)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9729118720790708, 'auprc': 0.9991267033826535, 'loss_val': 0.08027054314045277, 'psi': 0.9833978046005039}-{'f1_val': 0.9770742817976052, 'auprc': 0.9991222401827138, 'loss_val': 0.0727319007076655, 'psi': 0.9858934651516487}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=27 head_norm_before_train=3.260510 cos_to_last_merge=0.9823 (last merge round=1)
[S15] round=27 local utility u=0.000222 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987797545345668, 'loss_val': 0.029348115040770836, 'psi': 0.9975599028463391}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987769932195807, 'loss_val': 0.0297835992608946, 'psi': 0.9975587983203447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=27 head_norm_before_train=3.406178 (no previous merge yet)
[S16] round=27 local utility u=0.000641 metrics={'f1_val': 0.9939211508931698, 'auprc': 0.9831088169814466, 'loss_val': 0.042670166234597316, 'psi': 0.9895962173284806}-{'f1_val': 0.9939211508931698, 'auprc': 0.982581096791509, 'loss_val': 0.04236853715019295, 'psi': 0.9893851292525055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=27 head_norm_before_train=3.388881 cos_to_last_merge=0.9751 (last merge round=2)
[S17] round=27 local utility u=0.019617 metrics={'f1_val': 0.886669295250599, 'auprc': 0.9874772251269266, 'loss_val': 0.5432442574236321, 'psi': 0.92699246720113}-{'f1_val': 0.8805970122815465, 'auprc': 0.98112258529092, 'loss_val': 0.5269796769466253, 'psi': 0.9208072414852959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=28 head_norm_before_train=3.468023 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.914336567286621, 'auprc': 0.9535242387099021, 'loss_val': 0.2531029543193087, 'psi': 0.9300116358559335}-{'f1_val': 0.9137766741826995, 'auprc': 0.9523649522508701, 'loss_val': 0.24434819042861208, 'psi': 0.9292119854099679}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=28 head_norm_before_train=3.350376 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.7405330480529829, 'auprc': 0.9962270262214563, 'loss_val': 1.248868582763919, 'psi': 0.8428106393203723}-{'f1_val': 0.7527119456120109, 'auprc': 0.9964842029608592, 'loss_val': 1.210604499035884, 'psi': 0.8502208485515502}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=3.566956 cos_to_last_merge=0.9158 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.916
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9541447198810876, 'auprc': 0.9731066235469756, 'loss_val': 0.3902732997640404, 'psi': 0.9617294813474428}-{'f1_val': 0.954494803750783, 'auprc': 0.9843490299185939, 'loss_val': 0.3778177185911361, 'psi': 0.9664364942179073}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=3.720126 cos_to_last_merge=0.9214 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.921
[S5] round=28 local utility u=0.001826 metrics={'f1_val': 0.9989016402867434, 'auprc': 0.9999962631412864, 'loss_val': 0.00772217591953508, 'psi': 0.9993394894285607}-{'f1_val': 0.9989016402867434, 'auprc': 0.9999942006256113, 'loss_val': 0.01136748913068766, 'psi': 0.9993386644222906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S5] sending update (kind=head size=1788 to 1 peers)
[S6] START round=28 head_norm_before_train=3.704975 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.8044118046703987, 'auprc': 0.9504250246233217, 'loss_val': 0.5964764502621815, 'psi': 0.8628170926515679}-{'f1_val': 0.8058019287664996, 'auprc': 0.9507484964040056, 'loss_val': 0.5969471523189656, 'psi': 0.8637805558215019}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=3.845191 cos_to_last_merge=0.8988 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.899
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.7922532683628832, 'auprc': 0.9402152782907086, 'loss_val': 1.4169697229406535, 'psi': 0.8514380723340134}-{'f1_val': 0.7922532683628832, 'auprc': 0.9370584203434025, 'loss_val': 1.3902258217627954, 'psi': 0.8501753291550909}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=3.749511 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.8379447970030157, 'auprc': 0.9876787141202064, 'loss_val': 0.8520822633472058, 'psi': 0.897838363849892}-{'f1_val': 0.8381901636175543, 'auprc': 0.9878837109109992, 'loss_val': 0.8314318819085895, 'psi': 0.8980675825349322}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=28 head_norm_before_train=3.328238 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9969067967561883, 'auprc': 0.9999924460791251, 'loss_val': 0.009233712007314718, 'psi': 0.998141056485363}-{'f1_val': 0.9971551902648863, 'auprc': 0.9999929821260676, 'loss_val': 0.00873393651447523, 'psi': 0.9982903070093587}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=3.356762 cos_to_last_merge=0.8811 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.881
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9951385079721303, 'auprc': 0.9958136889092244, 'loss_val': 0.03400550668557234, 'psi': 0.995408580346968}-{'f1_val': 0.9951385079721303, 'auprc': 0.9958167870799359, 'loss_val': 0.03353143177810825, 'psi': 0.9954098196152525}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=28 head_norm_before_train=3.668577 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9898590424280995, 'auprc': 0.9975535716872398, 'loss_val': 0.04489324067755403, 'psi': 0.9929368541317556}-{'f1_val': 0.9898590424280995, 'auprc': 0.9975503256853764, 'loss_val': 0.0443710891104452, 'psi': 0.9929355557310102}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=28 head_norm_before_train=3.922618 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5353329246436812, 'auprc': 0.758160338889567, 'loss_val': 1.650778208518847, 'psi': 0.6244638903420355}-{'f1_val': 0.6693557446559998, 'auprc': 0.7358993313288991, 'loss_val': 1.5402479577914667, 'psi': 0.6959731793251595}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=3.676682 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9677574034391263, 'auprc': 0.9991288832230489, 'loss_val': 0.08454998679473448, 'psi': 0.9803059953526954}-{'f1_val': 0.9729118720790708, 'auprc': 0.9991267033826535, 'loss_val': 0.08027054314045277, 'psi': 0.9833978046005039}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=3.281226 cos_to_last_merge=0.9818 (last merge round=1)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.9955024063769649, 'auprc': 0.9987800290752771, 'loss_val': 0.03041059934362986, 'psi': 0.9968134554562897}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987797545345668, 'loss_val': 0.029348115040770836, 'psi': 0.9975599028463391}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=28 head_norm_before_train=3.435885 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9934364807170982, 'auprc': 0.9833188347799445, 'loss_val': 0.04386567059904693, 'psi': 0.9893894223422367}-{'f1_val': 0.9939211508931698, 'auprc': 0.9831088169814466, 'loss_val': 0.042670166234597316, 'psi': 0.9895962173284806}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=3.440360 cos_to_last_merge=0.9736 (last merge round=2)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.8565676593579254, 'auprc': 0.9274176341747884, 'loss_val': 0.7134208365291169, 'psi': 0.8849076492846706}-{'f1_val': 0.886669295250599, 'auprc': 0.9874772251269266, 'loss_val': 0.5432442574236321, 'psi': 0.92699246720113}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=3.498793 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.913571692525331, 'auprc': 0.9526549706655831, 'loss_val': 0.259435715244038, 'psi': 0.9292050037814319}-{'f1_val': 0.914336567286621, 'auprc': 0.9535242387099021, 'loss_val': 0.2531029543193087, 'psi': 0.9300116358559335}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=3.370738 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.7405330480529829, 'auprc': 0.9961931739857416, 'loss_val': 1.2654172384222988, 'psi': 0.8427970984260864}-{'f1_val': 0.7405330480529829, 'auprc': 0.9962270262214563, 'loss_val': 1.248868582763919, 'psi': 0.8428106393203723}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=3.621764 cos_to_last_merge=0.9135 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.913
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9285470055692205, 'auprc': 0.9489074180418551, 'loss_val': 0.4080051609093487, 'psi': 0.9366911705582743}-{'f1_val': 0.9541447198810876, 'auprc': 0.9731066235469756, 'loss_val': 0.3902732997640404, 'psi': 0.9617294813474428}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=3.751977 cos_to_last_merge=0.9179 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.918
[S5] round=29 local utility u=0.000993 metrics={'f1_val': 0.9989016402867434, 'auprc': 0.9999962631412864, 'loss_val': 0.005735481497334362, 'psi': 0.9993394894285607}-{'f1_val': 0.9989016402867434, 'auprc': 0.9999962631412864, 'loss_val': 0.00772217591953508, 'psi': 0.9993394894285607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=29 head_norm_before_train=3.727925 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.8051858176436161, 'auprc': 0.9500342980797503, 'loss_val': 0.6177257034663625, 'psi': 0.8631252098180697}-{'f1_val': 0.8044118046703987, 'auprc': 0.9504250246233217, 'loss_val': 0.5964764502621815, 'psi': 0.8628170926515679}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=29 head_norm_before_train=3.879363 cos_to_last_merge=0.8979 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.898
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.7867063537786053, 'auprc': 0.9438298742306026, 'loss_val': 1.4611438863971236, 'psi': 0.8495557619594043}-{'f1_val': 0.7922532683628832, 'auprc': 0.9402152782907086, 'loss_val': 1.4169697229406535, 'psi': 0.8514380723340134}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=29 head_norm_before_train=3.771277 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.8374541179053173, 'auprc': 0.9873773487109005, 'loss_val': 0.8784293343050921, 'psi': 0.8974234102275506}-{'f1_val': 0.8379447970030157, 'auprc': 0.9876787141202064, 'loss_val': 0.8520822633472058, 'psi': 0.897838363849892}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=3.347059 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9969067967561883, 'auprc': 0.9999919109925208, 'loss_val': 0.009310271683506427, 'psi': 0.9981408424507213}-{'f1_val': 0.9969067967561883, 'auprc': 0.9999924460791251, 'loss_val': 0.009233712007314718, 'psi': 0.998141056485363}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=29 head_norm_before_train=3.378307 cos_to_last_merge=0.8791 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.879
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9949896063782135, 'auprc': 0.9958203553907762, 'loss_val': 0.03444427668085367, 'psi': 0.9953219059832387}-{'f1_val': 0.9951385079721303, 'auprc': 0.9958136889092244, 'loss_val': 0.03400550668557234, 'psi': 0.995408580346968}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=29 head_norm_before_train=3.688581 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9898590424280995, 'auprc': 0.9976219381539012, 'loss_val': 0.04762597884279196, 'psi': 0.9929642007184203}-{'f1_val': 0.9898590424280995, 'auprc': 0.9975535716872398, 'loss_val': 0.04489324067755403, 'psi': 0.9929368541317556}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=29 head_norm_before_train=3.819912 (no previous merge yet)
[S13] round=29 local utility u=0.687981 metrics={'f1_val': 0.7073004541472722, 'auprc': 0.7674263080580264, 'loss_val': 1.3344196265573163, 'psi': 0.7313507957115739}-{'f1_val': 0.5353329246436812, 'auprc': 0.758160338889567, 'loss_val': 1.650778208518847, 'psi': 0.6244638903420355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=29 head_norm_before_train=3.697381 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9601969417973976, 'auprc': 0.999141234407126, 'loss_val': 0.09359749500768165, 'psi': 0.9757746588412889}-{'f1_val': 0.9677574034391263, 'auprc': 0.9991288832230489, 'loss_val': 0.08454998679473448, 'psi': 0.9803059953526954}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=29 head_norm_before_train=3.301566 cos_to_last_merge=0.9813 (last merge round=1)
[S15] round=29 local utility u=0.004167 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987866719289853, 'loss_val': 0.029562156784260895, 'psi': 0.9975626698041065}-{'f1_val': 0.9955024063769649, 'auprc': 0.9987800290752771, 'loss_val': 0.03041059934362986, 'psi': 0.9968134554562897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=29 head_norm_before_train=3.465345 (no previous merge yet)
[S16] round=29 local utility u=0.000646 metrics={'f1_val': 0.9936787523814361, 'auprc': 0.983363526606165, 'loss_val': 0.044160801692182054, 'psi': 0.9895526620713277}-{'f1_val': 0.9934364807170982, 'auprc': 0.9833188347799445, 'loss_val': 0.04386567059904693, 'psi': 0.9893894223422367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=29 head_norm_before_train=3.488090 cos_to_last_merge=0.9716 (last merge round=2)
[S17] round=29 local utility u=0.112479 metrics={'f1_val': 0.8703758955715377, 'auprc': 0.9710466414896654, 'loss_val': 0.7021985115404932, 'psi': 0.9106441939387888}-{'f1_val': 0.8565676593579254, 'auprc': 0.9274176341747884, 'loss_val': 0.7134208365291169, 'psi': 0.8849076492846706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] sending update (kind=head size=1789 to 1 peers)
[S2] START round=30 head_norm_before_train=3.525188 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.9139264241690033, 'auprc': 0.9541286630258335, 'loss_val': 0.27129449435940944, 'psi': 0.9300073197117353}-{'f1_val': 0.913571692525331, 'auprc': 0.9526549706655831, 'loss_val': 0.259435715244038, 'psi': 0.9292050037814319}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=3.390785 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.7347787503635943, 'auprc': 0.9958125845557717, 'loss_val': 1.309782886577832, 'psi': 0.8391922840404653}-{'f1_val': 0.7405330480529829, 'auprc': 0.9961931739857416, 'loss_val': 1.2654172384222988, 'psi': 0.8427970984260864}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=3.568118 cos_to_last_merge=0.8916 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.892
[S4] round=30 local utility u=0.057489 metrics={'f1_val': 0.9526234066501619, 'auprc': 0.937337858893335, 'loss_val': 0.4027766608971146, 'psi': 0.9465091875474312}-{'f1_val': 0.9285470055692205, 'auprc': 0.9489074180418551, 'loss_val': 0.4080051609093487, 'psi': 0.9366911705582743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=30 head_norm_before_train=3.811407 cos_to_last_merge=0.9162 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.916
[S5] round=30 local utility u=0.001726 metrics={'f1_val': 0.9989735264922392, 'auprc': 1.0, 'loss_val': 0.002726016676341476, 'psi': 0.9993841158953436}-{'f1_val': 0.9989016402867434, 'auprc': 0.9999962631412864, 'loss_val': 0.005735481497334362, 'psi': 0.9993394894285607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=30 head_norm_before_train=3.750434 (no previous merge yet)
[S6] round=30 local utility u=0.002998 metrics={'f1_val': 0.8052269039809895, 'auprc': 0.9503737641062358, 'loss_val': 0.6129950844294024, 'psi': 0.863285648031088}-{'f1_val': 0.8051858176436161, 'auprc': 0.9500342980797503, 'loss_val': 0.6177257034663625, 'psi': 0.8631252098180697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=30 head_norm_before_train=3.913560 cos_to_last_merge=0.8970 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.897
[S7] round=30 local utility u=0.037302 metrics={'f1_val': 0.7949335826951833, 'auprc': 0.9474269422794401, 'loss_val': 1.4466941368847883, 'psi': 0.855930926528886}-{'f1_val': 0.7867063537786053, 'auprc': 0.9438298742306026, 'loss_val': 1.4611438863971236, 'psi': 0.8495557619594043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] sending update (kind=head size=1793 to 1 peers)
[S8] START round=30 head_norm_before_train=3.792491 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.8371878237136465, 'auprc': 0.987104985289693, 'loss_val': 0.9005854908045529, 'psi': 0.8971546883440651}-{'f1_val': 0.8374541179053173, 'auprc': 0.9873773487109005, 'loss_val': 0.8784293343050921, 'psi': 0.8974234102275506}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=3.365674 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9969067967561883, 'auprc': 0.9999919109925208, 'loss_val': 0.009951373768885321, 'psi': 0.9981408424507213}-{'f1_val': 0.9969067967561883, 'auprc': 0.9999919109925208, 'loss_val': 0.009310271683506427, 'psi': 0.9981408424507213}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=3.399651 cos_to_last_merge=0.8771 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.877
[S10] round=30 local utility u=0.000085 metrics={'f1_val': 0.9951385079721303, 'auprc': 0.9958117267986144, 'loss_val': 0.035141468025964774, 'psi': 0.995407795502724}-{'f1_val': 0.9949896063782135, 'auprc': 0.9958203553907762, 'loss_val': 0.03444427668085367, 'psi': 0.9953219059832387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=30 head_norm_before_train=3.708388 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9889101737737402, 'auprc': 0.9975703696839929, 'loss_val': 0.050688485927210813, 'psi': 0.9923742521378414}-{'f1_val': 0.9898590424280995, 'auprc': 0.9976219381539012, 'loss_val': 0.04762597884279196, 'psi': 0.9929642007184203}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=3.894724 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.700119545649472, 'auprc': 0.7478855144529407, 'loss_val': 1.6262728360166663, 'psi': 0.7192259331708595}-{'f1_val': 0.7073004541472722, 'auprc': 0.7674263080580264, 'loss_val': 1.3344196265573163, 'psi': 0.7313507957115739}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=3.717479 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9527404572161351, 'auprc': 0.9991601077672909, 'loss_val': 0.10679651418510851, 'psi': 0.9713083174365974}-{'f1_val': 0.9601969417973976, 'auprc': 0.999141234407126, 'loss_val': 0.09359749500768165, 'psi': 0.9757746588412889}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=3.321728 cos_to_last_merge=0.9808 (last merge round=1)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.998782323242115, 'loss_val': 0.030276286415283193, 'psi': 0.9975609303293583}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987866719289853, 'loss_val': 0.029562156784260895, 'psi': 0.9975626698041065}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=3.493227 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9931943354816252, 'auprc': 0.9835586067463711, 'loss_val': 0.044808973778062165, 'psi': 0.9893400439875235}-{'f1_val': 0.9936787523814361, 'auprc': 0.983363526606165, 'loss_val': 0.044160801692182054, 'psi': 0.9895526620713277}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=3.527191 cos_to_last_merge=0.9704 (last merge round=2)
[S17] round=30 local utility u=0.078657 metrics={'f1_val': 0.8822966048115279, 'auprc': 0.98361055250589, 'loss_val': 0.6541011029065478, 'psi': 0.9228221838892727}-{'f1_val': 0.8703758955715377, 'auprc': 0.9710466414896654, 'loss_val': 0.7021985115404932, 'psi': 0.9106441939387888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=31 head_norm_before_train=3.552331 (no previous merge yet)
[S2] round=31 local utility u=0.000664 metrics={'f1_val': 0.9129570143202156, 'auprc': 0.9527099804497808, 'loss_val': 0.25989378365828236, 'psi': 0.9288582007720416}-{'f1_val': 0.9139264241690033, 'auprc': 0.9541286630258335, 'loss_val': 0.27129449435940944, 'psi': 0.9300073197117353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=31 head_norm_before_train=3.410662 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.7331897511251632, 'auprc': 0.9957253126212573, 'loss_val': 1.331145368945018, 'psi': 0.8382039757236008}-{'f1_val': 0.7347787503635943, 'auprc': 0.9958125845557717, 'loss_val': 1.309782886577832, 'psi': 0.8391922840404653}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=3.720981 cos_to_last_merge=0.8932 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.893
[S4] round=31 local utility u=0.033094 metrics={'f1_val': 0.9533436861556684, 'auprc': 0.9718232522942996, 'loss_val': 0.4443663440883288, 'psi': 0.9607355126111209}-{'f1_val': 0.9526234066501619, 'auprc': 0.937337858893335, 'loss_val': 0.4027766608971146, 'psi': 0.9465091875474312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=31 head_norm_before_train=3.849282 cos_to_last_merge=0.9160 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.916
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.9983871318983927, 'auprc': 0.9968203450989339, 'loss_val': 0.006795474924370662, 'psi': 0.9977604171786092}-{'f1_val': 0.9989735264922392, 'auprc': 1.0, 'loss_val': 0.002726016676341476, 'psi': 0.9993841158953436}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=3.772535 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.8031701375288209, 'auprc': 0.9488471415974209, 'loss_val': 0.6497750502962912, 'psi': 0.861440939156261}-{'f1_val': 0.8052269039809895, 'auprc': 0.9503737641062358, 'loss_val': 0.6129950844294024, 'psi': 0.863285648031088}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=3.945575 cos_to_last_merge=0.8961 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.896
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.791618634187631, 'auprc': 0.9495449748391884, 'loss_val': 1.4901024721268372, 'psi': 0.854789170448254}-{'f1_val': 0.7949335826951833, 'auprc': 0.9474269422794401, 'loss_val': 1.4466941368847883, 'psi': 0.855930926528886}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=3.813120 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.8366974804858317, 'auprc': 0.9867786382159267, 'loss_val': 0.9175957920048576, 'psi': 0.8967299435778697}-{'f1_val': 0.8371878237136465, 'auprc': 0.987104985289693, 'loss_val': 0.9005854908045529, 'psi': 0.8971546883440651}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=3.384315 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9969067967561883, 'auprc': 0.9999919109925208, 'loss_val': 0.010279967285902752, 'psi': 0.9981408424507213}-{'f1_val': 0.9969067967561883, 'auprc': 0.9999919109925208, 'loss_val': 0.009951373768885321, 'psi': 0.9981408424507213}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=3.422892 cos_to_last_merge=0.8757 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.876
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9945514967400677, 'auprc': 0.9969237437504757, 'loss_val': 0.035847100200778505, 'psi': 0.9955003955442309}-{'f1_val': 0.9951385079721303, 'auprc': 0.9958117267986144, 'loss_val': 0.035141468025964774, 'psi': 0.995407795502724}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=31 head_norm_before_train=3.727762 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9889101737737402, 'auprc': 0.9975484434868901, 'loss_val': 0.05116477810135051, 'psi': 0.9923654816590002}-{'f1_val': 0.9889101737737402, 'auprc': 0.9975703696839929, 'loss_val': 0.050688485927210813, 'psi': 0.9923742521378414}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=3.960669 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6997685081967547, 'auprc': 0.750669806361868, 'loss_val': 1.7497055600997748, 'psi': 0.7201290274628}-{'f1_val': 0.700119545649472, 'auprc': 0.7478855144529407, 'loss_val': 1.6262728360166663, 'psi': 0.7192259331708595}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=3.737496 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.95194668630704, 'auprc': 0.9991625978222483, 'loss_val': 0.1059164580599569, 'psi': 0.9708330509131233}-{'f1_val': 0.9527404572161351, 'auprc': 0.9991601077672909, 'loss_val': 0.10679651418510851, 'psi': 0.9713083174365974}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=31 head_norm_before_train=3.341613 cos_to_last_merge=0.9804 (last merge round=1)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987845322503031, 'loss_val': 0.030344399833300218, 'psi': 0.9975618139326335}-{'f1_val': 0.9967466683875206, 'auprc': 0.998782323242115, 'loss_val': 0.030276286415283193, 'psi': 0.9975609303293583}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=3.520710 (no previous merge yet)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9927104226270074, 'auprc': 0.9835992382021326, 'loss_val': 0.0453081308955825, 'psi': 0.9890659488570575}-{'f1_val': 0.9931943354816252, 'auprc': 0.9835586067463711, 'loss_val': 0.044808973778062165, 'psi': 0.9893400439875235}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=3.564987 cos_to_last_merge=0.9690 (last merge round=2)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.8809161848358606, 'auprc': 0.9813486273047928, 'loss_val': 0.6954647161741949, 'psi': 0.9210891618234335}-{'f1_val': 0.8822966048115279, 'auprc': 0.98361055250589, 'loss_val': 0.6541011029065478, 'psi': 0.9228221838892727}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=3.579079 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.9087983961648582, 'auprc': 0.9382536456620946, 'loss_val': 0.24448399556883535, 'psi': 0.9205804959637528}-{'f1_val': 0.9129570143202156, 'auprc': 0.9527099804497808, 'loss_val': 0.25989378365828236, 'psi': 0.9288582007720416}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=3.430311 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.7305222865100829, 'auprc': 0.9955119058561488, 'loss_val': 1.3609390745663734, 'psi': 0.8365181342485093}-{'f1_val': 0.7331897511251632, 'auprc': 0.9957253126212573, 'loss_val': 1.331145368945018, 'psi': 0.8382039757236008}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=3.808425 cos_to_last_merge=0.8974 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.897
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9479016976908514, 'auprc': 0.9461142881696171, 'loss_val': 0.46080892517011135, 'psi': 0.9471867338823577}-{'f1_val': 0.9533436861556684, 'auprc': 0.9718232522942996, 'loss_val': 0.4443663440883288, 'psi': 0.9607355126111209}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=3.875709 cos_to_last_merge=0.9117 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.912
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.9985337770999654, 'auprc': 0.9964761491176829, 'loss_val': 0.00770290272684316, 'psi': 0.9977107259070523}-{'f1_val': 0.9983871318983927, 'auprc': 0.9968203450989339, 'loss_val': 0.006795474924370662, 'psi': 0.9977604171786092}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=3.794151 (no previous merge yet)
[S6] round=32 local utility u=0.006413 metrics={'f1_val': 0.8031701375288209, 'auprc': 0.949327402469262, 'loss_val': 0.6383908077857062, 'psi': 0.8616330435049974}-{'f1_val': 0.8031701375288209, 'auprc': 0.9488471415974209, 'loss_val': 0.6497750502962912, 'psi': 0.861440939156261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=32 head_norm_before_train=3.977004 cos_to_last_merge=0.8953 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.895
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.791618634187631, 'auprc': 0.9515281711670012, 'loss_val': 1.514403444585911, 'psi': 0.8555824489793791}-{'f1_val': 0.791618634187631, 'auprc': 0.9495449748391884, 'loss_val': 1.4901024721268372, 'psi': 0.854789170448254}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=3.833768 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.8364523323534301, 'auprc': 0.9866124688279455, 'loss_val': 0.940959551349268, 'psi': 0.8965163869432362}-{'f1_val': 0.8366974804858317, 'auprc': 0.9867786382159267, 'loss_val': 0.9175957920048576, 'psi': 0.8967299435778697}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=3.402619 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9969067967561883, 'auprc': 0.9999919109925208, 'loss_val': 0.01032467577616907, 'psi': 0.9981408424507213}-{'f1_val': 0.9969067967561883, 'auprc': 0.9999919109925208, 'loss_val': 0.010279967285902752, 'psi': 0.9981408424507213}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=3.445706 cos_to_last_merge=0.8741 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.874
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9943325524396611, 'auprc': 0.9972511222795305, 'loss_val': 0.03635507538043965, 'psi': 0.9954999803756088}-{'f1_val': 0.9945514967400677, 'auprc': 0.9969237437504757, 'loss_val': 0.035847100200778505, 'psi': 0.9955003955442309}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=3.746814 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9886732327885399, 'auprc': 0.9974772318545632, 'loss_val': 0.05356540041979656, 'psi': 0.9921948324149492}-{'f1_val': 0.9889101737737402, 'auprc': 0.9975484434868901, 'loss_val': 0.05116477810135051, 'psi': 0.9923654816590002}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=4.007261 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6907584101856932, 'auprc': 0.7427481116790591, 'loss_val': 1.7618626445548065, 'psi': 0.7115542907830394}-{'f1_val': 0.6997685081967547, 'auprc': 0.750669806361868, 'loss_val': 1.7497055600997748, 'psi': 0.7201290274628}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=3.756934 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.947882750309424, 'auprc': 0.9991905523810721, 'loss_val': 0.11529970032250046, 'psi': 0.9684058711380832}-{'f1_val': 0.95194668630704, 'auprc': 0.9991625978222483, 'loss_val': 0.1059164580599569, 'psi': 0.9708330509131233}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=3.361322 cos_to_last_merge=0.9799 (last merge round=1)
[S15] round=32 local utility u=0.000009 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987848067519886, 'loss_val': 0.03032633193686501, 'psi': 0.9975619237333078}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987845322503031, 'loss_val': 0.030344399833300218, 'psi': 0.9975618139326335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] sending update (kind=head size=1789 to 1 peers)
[S16] START round=32 head_norm_before_train=3.547625 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9927104226270074, 'auprc': 0.9836538479944705, 'loss_val': 0.045658547252266014, 'psi': 0.9890877927739926}-{'f1_val': 0.9927104226270074, 'auprc': 0.9835992382021326, 'loss_val': 0.0453081308955825, 'psi': 0.9890659488570575}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=3.607246 cos_to_last_merge=0.9673 (last merge round=2)
[S17] round=32 local utility u=0.018837 metrics={'f1_val': 0.8831794446485012, 'auprc': 0.9708113402867572, 'loss_val': 0.6397579235825924, 'psi': 0.9182322029038037}-{'f1_val': 0.8809161848358606, 'auprc': 0.9813486273047928, 'loss_val': 0.6954647161741949, 'psi': 0.9210891618234335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S17] sending update (kind=head size=1786 to 1 peers)
[S2] START round=33 head_norm_before_train=3.606656 (no previous merge yet)
[S2] round=33 local utility u=0.038407 metrics={'f1_val': 0.9089422258253864, 'auprc': 0.9864633566241718, 'loss_val': 0.31316262277281887, 'psi': 0.9399506781449005}-{'f1_val': 0.9087983961648582, 'auprc': 0.9382536456620946, 'loss_val': 0.24448399556883535, 'psi': 0.9205804959637528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=33 head_norm_before_train=3.449766 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.7310577085624402, 'auprc': 0.9954879152233316, 'loss_val': 1.3758230490807326, 'psi': 0.8368297912267968}-{'f1_val': 0.7305222865100829, 'auprc': 0.9955119058561488, 'loss_val': 1.3609390745663734, 'psi': 0.8365181342485093}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=3.842051 cos_to_last_merge=0.8956 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.896
[S4] round=33 local utility u=0.035908 metrics={'f1_val': 0.951756791041858, 'auprc': 0.9650147688031221, 'loss_val': 0.46882462773498557, 'psi': 0.9570599821463636}-{'f1_val': 0.9479016976908514, 'auprc': 0.9461142881696171, 'loss_val': 0.46080892517011135, 'psi': 0.9471867338823577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=33 head_norm_before_train=3.932767 cos_to_last_merge=0.9128 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.913
[S5] round=33 local utility u=0.001313 metrics={'f1_val': 0.9985334274679925, 'auprc': 0.9999130514175756, 'loss_val': 0.015384603668876028, 'psi': 0.9990852770478258}-{'f1_val': 0.9985337770999654, 'auprc': 0.9964761491176829, 'loss_val': 0.00770290272684316, 'psi': 0.9977107259070523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=33 head_norm_before_train=3.815975 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.8028030606008882, 'auprc': 0.9490824399279874, 'loss_val': 0.6596711634133122, 'psi': 0.8613148123317278}-{'f1_val': 0.8031701375288209, 'auprc': 0.949327402469262, 'loss_val': 0.6383908077857062, 'psi': 0.8616330435049974}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=4.006385 cos_to_last_merge=0.8946 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.895
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.7933795309924843, 'auprc': 0.9525146666013289, 'loss_val': 1.5360151994791849, 'psi': 0.8570335852360221}-{'f1_val': 0.791618634187631, 'auprc': 0.9515281711670012, 'loss_val': 1.514403444585911, 'psi': 0.8555824489793791}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=3.853951 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.8340016018722212, 'auprc': 0.985890001030573, 'loss_val': 0.9978236864208132, 'psi': 0.894756961535562}-{'f1_val': 0.8364523323534301, 'auprc': 0.9866124688279455, 'loss_val': 0.940959551349268, 'psi': 0.8965163869432362}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=3.420652 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9969067967561883, 'auprc': 0.9999919109925208, 'loss_val': 0.011311608606024162, 'psi': 0.9981408424507213}-{'f1_val': 0.9969067967561883, 'auprc': 0.9999919109925208, 'loss_val': 0.01032467577616907, 'psi': 0.9981408424507213}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=3.471593 cos_to_last_merge=0.8729 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.873
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9941136814432395, 'auprc': 0.9974779551971638, 'loss_val': 0.03665530187517906, 'psi': 0.9954593909448092}-{'f1_val': 0.9943325524396611, 'auprc': 0.9972511222795305, 'loss_val': 0.03635507538043965, 'psi': 0.9954999803756088}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=3.765646 (no previous merge yet)
[S11] round=33 local utility u=0.001084 metrics={'f1_val': 0.9889101737737402, 'auprc': 0.9975531853170302, 'loss_val': 0.053046826262551486, 'psi': 0.9923673783910563}-{'f1_val': 0.9886732327885399, 'auprc': 0.9974772318545632, 'loss_val': 0.05356540041979656, 'psi': 0.9921948324149492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] sending update (kind=head size=1789 to 1 peers)
[S13] START round=33 head_norm_before_train=4.044920 (no previous merge yet)
[S13] round=33 local utility u=0.095455 metrics={'f1_val': 0.6723591254070244, 'auprc': 0.752607158732443, 'loss_val': 1.4901334330157339, 'psi': 0.7044583387371919}-{'f1_val': 0.6907584101856932, 'auprc': 0.7427481116790591, 'loss_val': 1.7618626445548065, 'psi': 0.7115542907830394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=33 head_norm_before_train=3.776202 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9435963469521105, 'auprc': 0.9992318861820461, 'loss_val': 0.12357586667138037, 'psi': 0.9658505626440848}-{'f1_val': 0.947882750309424, 'auprc': 0.9991905523810721, 'loss_val': 0.11529970032250046, 'psi': 0.9684058711380832}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=3.380794 cos_to_last_merge=0.9794 (last merge round=1)
[S15] round=33 local utility u=0.000107 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987911861291546, 'loss_val': 0.03013140326801628, 'psi': 0.9975644754841742}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987848067519886, 'loss_val': 0.03032633193686501, 'psi': 0.9975619237333078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=33 head_norm_before_train=3.573619 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9927104226270074, 'auprc': 0.9837768993492512, 'loss_val': 0.046225038033755605, 'psi': 0.9891370133159049}-{'f1_val': 0.9927104226270074, 'auprc': 0.9836538479944705, 'loss_val': 0.045658547252266014, 'psi': 0.9890877927739926}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=3.666490 cos_to_last_merge=0.9649 (last merge round=2)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.8612554694612895, 'auprc': 0.9336253089080442, 'loss_val': 0.8042119248988974, 'psi': 0.8902034052399914}-{'f1_val': 0.8831794446485012, 'auprc': 0.9708113402867572, 'loss_val': 0.6397579235825924, 'psi': 0.9182322029038037}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=3.664952 (no previous merge yet)
[S2] round=34 local utility u=0.054969 metrics={'f1_val': 0.9153513179994809, 'auprc': 0.9943534482443599, 'loss_val': 0.2653486385480454, 'psi': 0.9469521700974325}-{'f1_val': 0.9089422258253864, 'auprc': 0.9864633566241718, 'loss_val': 0.31316262277281887, 'psi': 0.9399506781449005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] sending update (kind=head size=1789 to 1 peers)
[S3] START round=34 head_norm_before_train=3.469055 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.7283708492849369, 'auprc': 0.995215736804365, 'loss_val': 1.4033944169626058, 'psi': 0.8351088042927082}-{'f1_val': 0.7310577085624402, 'auprc': 0.9954879152233316, 'loss_val': 1.3758230490807326, 'psi': 0.8368297912267968}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=3.892621 cos_to_last_merge=0.8936 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.894
[S4] round=34 local utility u=0.014106 metrics={'f1_val': 0.9503686561498067, 'auprc': 0.9808725349911127, 'loss_val': 0.47985731953492283, 'psi': 0.9625702076863292}-{'f1_val': 0.951756791041858, 'auprc': 0.9650147688031221, 'loss_val': 0.46882462773498557, 'psi': 0.9570599821463636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=34 head_norm_before_train=3.983014 cos_to_last_merge=0.9115 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.912
[S5] round=34 local utility u=0.006024 metrics={'f1_val': 0.9989736746605191, 'auprc': 0.9999962631412864, 'loss_val': 0.0062278347962388585, 'psi': 0.9993827100528261}-{'f1_val': 0.9985334274679925, 'auprc': 0.9999130514175756, 'loss_val': 0.015384603668876028, 'psi': 0.9990852770478258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=34 head_norm_before_train=3.837402 (no previous merge yet)
[S6] round=34 local utility u=0.005874 metrics={'f1_val': 0.8061252953962721, 'auprc': 0.9494654788190346, 'loss_val': 0.6690060544150348, 'psi': 0.8634613687653772}-{'f1_val': 0.8028030606008882, 'auprc': 0.9490824399279874, 'loss_val': 0.6596711634133122, 'psi': 0.8613148123317278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=34 head_norm_before_train=4.034012 cos_to_last_merge=0.8940 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.894
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.7927183223506045, 'auprc': 0.9535568328546087, 'loss_val': 1.5658176200224503, 'psi': 0.8570537265522061}-{'f1_val': 0.7933795309924843, 'auprc': 0.9525146666013289, 'loss_val': 1.5360151994791849, 'psi': 0.8570335852360221}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=3.873824 (no previous merge yet)
[S8] round=34 local utility u=0.020031 metrics={'f1_val': 0.8362071992577068, 'auprc': 0.9861128796858483, 'loss_val': 0.9716631198212224, 'psi': 0.8961694714289634}-{'f1_val': 0.8340016018722212, 'auprc': 0.985890001030573, 'loss_val': 0.9978236864208132, 'psi': 0.894756961535562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=34 head_norm_before_train=3.438840 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9969067967561883, 'auprc': 0.9999901340208723, 'loss_val': 0.011369539379204686, 'psi': 0.998140131662062}-{'f1_val': 0.9969067967561883, 'auprc': 0.9999919109925208, 'loss_val': 0.011311608606024162, 'psi': 0.9981408424507213}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=3.497362 cos_to_last_merge=0.8713 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.871
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9941136814432395, 'auprc': 0.997474403784951, 'loss_val': 0.036993116949425545, 'psi': 0.995457970379924}-{'f1_val': 0.9941136814432395, 'auprc': 0.9974779551971638, 'loss_val': 0.03665530187517906, 'psi': 0.9954593909448092}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=3.784285 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9886732327885399, 'auprc': 0.9975229353591737, 'loss_val': 0.055652231840165475, 'psi': 0.9922131138167933}-{'f1_val': 0.9889101737737402, 'auprc': 0.9975531853170302, 'loss_val': 0.053046826262551486, 'psi': 0.9923673783910563}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=4.073731 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.6425638623856663, 'auprc': 0.7179582441568431, 'loss_val': 1.8702981781997925, 'psi': 0.6727216150941371}-{'f1_val': 0.6723591254070244, 'auprc': 0.752607158732443, 'loss_val': 1.4901334330157339, 'psi': 0.7044583387371919}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=3.795107 (no previous merge yet)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9397710003188907, 'auprc': 0.9992619350088687, 'loss_val': 0.1286616343418296, 'psi': 0.9635673741948819}-{'f1_val': 0.9435963469521105, 'auprc': 0.9992318861820461, 'loss_val': 0.12357586667138037, 'psi': 0.9658505626440848}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=3.400112 cos_to_last_merge=0.9789 (last merge round=1)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987837223855768, 'loss_val': 0.030277010428141928, 'psi': 0.9975614899867431}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987911861291546, 'loss_val': 0.03013140326801628, 'psi': 0.9975644754841742}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=3.599311 (no previous merge yet)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.9924686541746501, 'auprc': 0.9843848862652601, 'loss_val': 0.047783285678781436, 'psi': 0.9892351470108941}-{'f1_val': 0.9927104226270074, 'auprc': 0.9837768993492512, 'loss_val': 0.046225038033755605, 'psi': 0.9891370133159049}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=3.684499 cos_to_last_merge=0.9638 (last merge round=2)
[S17] round=34 local utility u=0.017969 metrics={'f1_val': 0.8670848390940556, 'auprc': 0.948474975709651, 'loss_val': 0.847798650177503, 'psi': 0.8996408937402938}-{'f1_val': 0.8612554694612895, 'auprc': 0.9336253089080442, 'loss_val': 0.8042119248988974, 'psi': 0.8902034052399914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S17] sending update (kind=head size=1783 to 1 peers)
[S2] START round=35 head_norm_before_train=3.728166 (no previous merge yet)
[S2] round=35 local utility u=0.018165 metrics={'f1_val': 0.9161706170090951, 'auprc': 0.9945811725153793, 'loss_val': 0.23461820721611332, 'psi': 0.9475348392116087}-{'f1_val': 0.9153513179994809, 'auprc': 0.9943534482443599, 'loss_val': 0.2653486385480454, 'psi': 0.9469521700974325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=35 head_norm_before_train=3.488106 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.7262036459145993, 'auprc': 0.9949409399484808, 'loss_val': 1.4394771888384914, 'psi': 0.833698563528152}-{'f1_val': 0.7283708492849369, 'auprc': 0.995215736804365, 'loss_val': 1.4033944169626058, 'psi': 0.8351088042927082}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=3.924689 cos_to_last_merge=0.8887 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.889
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9455415804952214, 'auprc': 0.9374900056253649, 'loss_val': 0.42730213124380945, 'psi': 0.9423209505472788}-{'f1_val': 0.9503686561498067, 'auprc': 0.9808725349911127, 'loss_val': 0.47985731953492283, 'psi': 0.9625702076863292}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=4.026279 cos_to_last_merge=0.9090 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.909
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.9988272367506998, 'auprc': 0.997103568254594, 'loss_val': 0.00579382154846344, 'psi': 0.9981377693522575}-{'f1_val': 0.9989736746605191, 'auprc': 0.9999962631412864, 'loss_val': 0.0062278347962388585, 'psi': 0.9993827100528261}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=3.859340 (no previous merge yet)
[S6] round=35 local utility u=0.016787 metrics={'f1_val': 0.8028440760272106, 'auprc': 0.9499611220540963, 'loss_val': 0.6172308652383244, 'psi': 0.8616908944379649}-{'f1_val': 0.8061252953962721, 'auprc': 0.9494654788190346, 'loss_val': 0.6690060544150348, 'psi': 0.8634613687653772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=35 head_norm_before_train=4.060883 cos_to_last_merge=0.8933 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.893
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.7929407032575757, 'auprc': 0.9549500953691024, 'loss_val': 1.584722105975302, 'psi': 0.8577444601021864}-{'f1_val': 0.7927183223506045, 'auprc': 0.9535568328546087, 'loss_val': 1.5658176200224503, 'psi': 0.8570537265522061}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=3.894191 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.8357169763262662, 'auprc': 0.9860560563553986, 'loss_val': 0.9924921207451025, 'psi': 0.8958526083379192}-{'f1_val': 0.8362071992577068, 'auprc': 0.9861128796858483, 'loss_val': 0.9716631198212224, 'psi': 0.8961694714289634}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=3.456935 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9969067967561883, 'auprc': 0.9999876648728765, 'loss_val': 0.012059365488226857, 'psi': 0.9981391440028635}-{'f1_val': 0.9969067967561883, 'auprc': 0.9999901340208723, 'loss_val': 0.011369539379204686, 'psi': 0.998140131662062}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=3.524982 cos_to_last_merge=0.8698 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.870
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9941136814432395, 'auprc': 0.9974662130263261, 'loss_val': 0.03781070467573042, 'psi': 0.9954546940764741}-{'f1_val': 0.9941136814432395, 'auprc': 0.997474403784951, 'loss_val': 0.036993116949425545, 'psi': 0.995457970379924}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=3.802720 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9886732327885399, 'auprc': 0.997522094890949, 'loss_val': 0.057415568306098154, 'psi': 0.9922127776295036}-{'f1_val': 0.9886732327885399, 'auprc': 0.9975229353591737, 'loss_val': 0.055652231840165475, 'psi': 0.9922131138167933}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=4.123381 (no previous merge yet)
[S13] round=35 local utility u=0.487647 metrics={'f1_val': 0.7211304680140703, 'auprc': 0.7770010533041987, 'loss_val': 1.5435326633750155, 'psi': 0.7434787021301217}-{'f1_val': 0.6425638623856663, 'auprc': 0.7179582441568431, 'loss_val': 1.8702981781997925, 'psi': 0.6727216150941371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=35 head_norm_before_train=3.813806 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9397710003188907, 'auprc': 0.9992809467790045, 'loss_val': 0.1307597874903169, 'psi': 0.9635749789029362}-{'f1_val': 0.9397710003188907, 'auprc': 0.9992619350088687, 'loss_val': 0.1286616343418296, 'psi': 0.9635673741948819}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=3.419220 cos_to_last_merge=0.9785 (last merge round=1)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987898325960349, 'loss_val': 0.030525665203780045, 'psi': 0.9975639340709264}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987837223855768, 'loss_val': 0.030277010428141928, 'psi': 0.9975614899867431}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=3.625125 (no previous merge yet)
[S16] round=35 local utility u=0.001204 metrics={'f1_val': 0.9927104226270074, 'auprc': 0.9844944711348979, 'loss_val': 0.04715470305872883, 'psi': 0.9894240420301635}-{'f1_val': 0.9924686541746501, 'auprc': 0.9843848862652601, 'loss_val': 0.047783285678781436, 'psi': 0.9892351470108941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S16] sending update (kind=head size=1784 to 1 peers)
[S17] START round=35 head_norm_before_train=3.727015 cos_to_last_merge=0.9618 (last merge round=2)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.8611114587301708, 'auprc': 0.9409553341080656, 'loss_val': 0.8613699189606563, 'psi': 0.8930490088813288}-{'f1_val': 0.8670848390940556, 'auprc': 0.948474975709651, 'loss_val': 0.847798650177503, 'psi': 0.8996408937402938}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=3.766917 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.8709070222017963, 'auprc': 0.9625682643602802, 'loss_val': 0.3120381273597132, 'psi': 0.9075715190651898}-{'f1_val': 0.9161706170090951, 'auprc': 0.9945811725153793, 'loss_val': 0.23461820721611332, 'psi': 0.9475348392116087}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=3.507073 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.7267469371688215, 'auprc': 0.9947941498558827, 'loss_val': 1.4496424886114159, 'psi': 0.8339658222436459}-{'f1_val': 0.7262036459145993, 'auprc': 0.9949409399484808, 'loss_val': 1.4394771888384914, 'psi': 0.833698563528152}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=3.862144 cos_to_last_merge=0.8722 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.872
[S4] round=36 local utility u=0.073178 metrics={'f1_val': 0.9522519433633769, 'auprc': 0.9805664907911883, 'loss_val': 0.4504385742763747, 'psi': 0.9635777623345014}-{'f1_val': 0.9455415804952214, 'auprc': 0.9374900056253649, 'loss_val': 0.42730213124380945, 'psi': 0.9423209505472788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=36 head_norm_before_train=4.083391 cos_to_last_merge=0.9071 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.907
[S5] round=36 local utility u=0.006592 metrics={'f1_val': 0.9993411206731109, 'auprc': 0.9999995853732967, 'loss_val': 0.004380314194766951, 'psi': 0.9996045065531852}-{'f1_val': 0.9988272367506998, 'auprc': 0.997103568254594, 'loss_val': 0.00579382154846344, 'psi': 0.9981377693522575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=36 head_norm_before_train=3.880596 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.8028817802922661, 'auprc': 0.9495625538284699, 'loss_val': 0.6386087461733713, 'psi': 0.8615540897067476}-{'f1_val': 0.8028440760272106, 'auprc': 0.9499611220540963, 'loss_val': 0.6172308652383244, 'psi': 0.8616908944379649}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=4.087046 cos_to_last_merge=0.8927 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.893
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.7935949614857855, 'auprc': 0.9549285778363897, 'loss_val': 1.6133504653774011, 'psi': 0.8581284080260272}-{'f1_val': 0.7929407032575757, 'auprc': 0.9549500953691024, 'loss_val': 1.584722105975302, 'psi': 0.8577444601021864}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=3.913661 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.8354718855667492, 'auprc': 0.9857867906617315, 'loss_val': 1.0112611778966514, 'psi': 0.8955978476047421}-{'f1_val': 0.8357169763262662, 'auprc': 0.9860560563553986, 'loss_val': 0.9924921207451025, 'psi': 0.8958526083379192}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=3.474806 (no previous merge yet)
[S9] round=36 local utility u=0.000100 metrics={'f1_val': 0.9969067967561883, 'auprc': 0.9999876648728766, 'loss_val': 0.011859151566435753, 'psi': 0.9981391440028636}-{'f1_val': 0.9969067967561883, 'auprc': 0.9999876648728765, 'loss_val': 0.012059365488226857, 'psi': 0.9981391440028635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S9] sending update (kind=head size=1785 to 1 peers)
[S10] START round=36 head_norm_before_train=3.554258 cos_to_last_merge=0.8683 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.868
[S10] round=36 local utility u=0.005215 metrics={'f1_val': 0.9952087722795309, 'auprc': 0.9974643198327294, 'loss_val': 0.03394624046674076, 'psi': 0.9961109913008104}-{'f1_val': 0.9941136814432395, 'auprc': 0.9974662130263261, 'loss_val': 0.03781070467573042, 'psi': 0.9954546940764741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=36 head_norm_before_train=3.821119 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9886732327885399, 'auprc': 0.9976042755259824, 'loss_val': 0.05780193345661902, 'psi': 0.9922456498835168}-{'f1_val': 0.9886732327885399, 'auprc': 0.997522094890949, 'loss_val': 0.057415568306098154, 'psi': 0.9922127776295036}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=4.147548 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.6571686737861384, 'auprc': 0.7219089778751011, 'loss_val': 1.878646747689052, 'psi': 0.6830647954217235}-{'f1_val': 0.7211304680140703, 'auprc': 0.7770010533041987, 'loss_val': 1.5435326633750155, 'psi': 0.7434787021301217}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=3.832263 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9341105987036219, 'auprc': 0.999364120759753, 'loss_val': 0.1444577035780378, 'psi': 0.9602120075260744}-{'f1_val': 0.9397710003188907, 'auprc': 0.9992809467790045, 'loss_val': 0.1307597874903169, 'psi': 0.9635749789029362}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=3.438289 cos_to_last_merge=0.9780 (last merge round=1)
[S15] round=36 local utility u=0.000449 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9988027913224926, 'loss_val': 0.029667160170350763, 'psi': 0.9975691175615093}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987898325960349, 'loss_val': 0.030525665203780045, 'psi': 0.9975639340709264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S15] sending update (kind=head size=1787 to 1 peers)
[S16] START round=36 head_norm_before_train=3.649662 (no previous merge yet)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9927104226270074, 'auprc': 0.9846520398347338, 'loss_val': 0.04784295756904286, 'psi': 0.9894870695100979}-{'f1_val': 0.9927104226270074, 'auprc': 0.9844944711348979, 'loss_val': 0.04715470305872883, 'psi': 0.9894240420301635}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=3.770531 cos_to_last_merge=0.9600 (last merge round=2)
[S17] round=36 local utility u=0.059818 metrics={'f1_val': 0.8521706585822084, 'auprc': 0.9814328888578564, 'loss_val': 0.809522170600731, 'psi': 0.9038755506924676}-{'f1_val': 0.8611114587301708, 'auprc': 0.9409553341080656, 'loss_val': 0.8613699189606563, 'psi': 0.8930490088813288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=37 head_norm_before_train=3.811035 (no previous merge yet)
[S2] round=37 local utility u=0.122305 metrics={'f1_val': 0.9098313278817528, 'auprc': 0.9530457633721892, 'loss_val': 0.27240607747429224, 'psi': 0.9271171020779273}-{'f1_val': 0.8709070222017963, 'auprc': 0.9625682643602802, 'loss_val': 0.3120381273597132, 'psi': 0.9075715190651898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=37 head_norm_before_train=3.525854 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.7262036459145993, 'auprc': 0.9945250976904465, 'loss_val': 1.4741846878363152, 'psi': 0.8335322266249382}-{'f1_val': 0.7267469371688215, 'auprc': 0.9947941498558827, 'loss_val': 1.4496424886114159, 'psi': 0.8339658222436459}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=3.974734 cos_to_last_merge=0.8834 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.883
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9522968103065762, 'auprc': 0.9803733186107431, 'loss_val': 0.4748690116908124, 'psi': 0.963527413628243}-{'f1_val': 0.9522519433633769, 'auprc': 0.9805664907911883, 'loss_val': 0.4504385742763747, 'psi': 0.9635777623345014}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=4.100073 cos_to_last_merge=0.9053 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.905
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.9985334274679925, 'auprc': 0.9999937857567555, 'loss_val': 0.004304432957293894, 'psi': 0.9991175707834976}-{'f1_val': 0.9993411206731109, 'auprc': 0.9999995853732967, 'loss_val': 0.004380314194766951, 'psi': 0.9996045065531852}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=3.901295 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.8032853016191245, 'auprc': 0.9486724929463839, 'loss_val': 0.6700471313296894, 'psi': 0.8614401781500283}-{'f1_val': 0.8028817802922661, 'auprc': 0.9495625538284699, 'loss_val': 0.6386087461733713, 'psi': 0.8615540897067476}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=4.111877 cos_to_last_merge=0.8922 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.892
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.7931571042392946, 'auprc': 0.9555398658074916, 'loss_val': 1.6392799616174967, 'psi': 0.8581102088665734}-{'f1_val': 0.7935949614857855, 'auprc': 0.9549285778363897, 'loss_val': 1.6133504653774011, 'psi': 0.8581284080260272}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=3.932995 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.8349817431542353, 'auprc': 0.9857170687207617, 'loss_val': 1.0324286616102427, 'psi': 0.8952758733808459}-{'f1_val': 0.8354718855667492, 'auprc': 0.9857867906617315, 'loss_val': 1.0112611778966514, 'psi': 0.8955978476047421}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=3.492503 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9969067967561883, 'auprc': 0.9999873869876499, 'loss_val': 0.012643870543099291, 'psi': 0.9981390328487729}-{'f1_val': 0.9969067967561883, 'auprc': 0.9999876648728766, 'loss_val': 0.011859151566435753, 'psi': 0.9981391440028636}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=3.586312 cos_to_last_merge=0.8666 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.867
[S10] round=37 local utility u=0.000344 metrics={'f1_val': 0.9952087722795309, 'auprc': 0.9974614301593685, 'loss_val': 0.033250242460379935, 'psi': 0.9961098354314659}-{'f1_val': 0.9952087722795309, 'auprc': 0.9974643198327294, 'loss_val': 0.03394624046674076, 'psi': 0.9961109913008104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S10] sending update (kind=head size=1788 to 1 peers)
[S11] START round=37 head_norm_before_train=3.839317 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9872538772362969, 'auprc': 0.9978720113174178, 'loss_val': 0.06450260932163215, 'psi': 0.9915011308687453}-{'f1_val': 0.9886732327885399, 'auprc': 0.9976042755259824, 'loss_val': 0.05780193345661902, 'psi': 0.9922456498835168}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=4.208672 (no previous merge yet)
[S13] round=37 local utility u=0.290792 metrics={'f1_val': 0.6894988185961831, 'auprc': 0.7573892324174794, 'loss_val': 1.5974834511939646, 'psi': 0.7166549841247016}-{'f1_val': 0.6571686737861384, 'auprc': 0.7219089778751011, 'loss_val': 1.878646747689052, 'psi': 0.6830647954217235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=37 head_norm_before_train=3.850688 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.931407441549514, 'auprc': 0.9993983953749516, 'loss_val': 0.15224487962624333, 'psi': 0.958603823079689}-{'f1_val': 0.9341105987036219, 'auprc': 0.999364120759753, 'loss_val': 0.1444577035780378, 'psi': 0.9602120075260744}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=3.457226 cos_to_last_merge=0.9776 (last merge round=1)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987970604033978, 'loss_val': 0.030578987248083986, 'psi': 0.9975668251938714}-{'f1_val': 0.9967466683875206, 'auprc': 0.9988027913224926, 'loss_val': 0.029667160170350763, 'psi': 0.9975691175615093}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=3.675031 (no previous merge yet)
[S16] round=37 local utility u=0.000065 metrics={'f1_val': 0.9927104226270074, 'auprc': 0.9847407873042691, 'loss_val': 0.04797972051689481, 'psi': 0.989522568497912}-{'f1_val': 0.9927104226270074, 'auprc': 0.9846520398347338, 'loss_val': 0.04784295756904286, 'psi': 0.9894870695100979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] sending update (kind=head size=1789 to 1 peers)
[S17] START round=37 head_norm_before_train=3.823637 cos_to_last_merge=0.9574 (last merge round=2)
[S17] round=37 local utility u=0.338690 metrics={'f1_val': 0.9061846679576422, 'auprc': 0.9916284367631452, 'loss_val': 0.48681201698008464, 'psi': 0.9403621754798435}-{'f1_val': 0.8521706585822084, 'auprc': 0.9814328888578564, 'loss_val': 0.809522170600731, 'psi': 0.9038755506924676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] sending update (kind=head size=1791 to 1 peers)
[S2] START round=38 head_norm_before_train=3.852924 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.908988393180636, 'auprc': 0.9508196752136422, 'loss_val': 0.26827723115614116, 'psi': 0.9257209059938384}-{'f1_val': 0.9098313278817528, 'auprc': 0.9530457633721892, 'loss_val': 0.27240607747429224, 'psi': 0.9271171020779273}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=3.544585 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.7251140612064453, 'auprc': 0.9942204117090923, 'loss_val': 1.4944273814286804, 'psi': 0.8327566014075041}-{'f1_val': 0.7262036459145993, 'auprc': 0.9945250976904465, 'loss_val': 1.4741846878363152, 'psi': 0.8335322266249382}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=4.033565 cos_to_last_merge=0.8828 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.883
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9533612315462887, 'auprc': 0.9752943462180843, 'loss_val': 0.49786482732979825, 'psi': 0.9621344774150069}-{'f1_val': 0.9522968103065762, 'auprc': 0.9803733186107431, 'loss_val': 0.4748690116908124, 'psi': 0.963527413628243}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=4.141113 cos_to_last_merge=0.9034 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.903
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.9985369128569197, 'auprc': 1.0, 'loss_val': 0.006156199689346083, 'psi': 0.9991221477141519}-{'f1_val': 0.9985334274679925, 'auprc': 0.9999937857567555, 'loss_val': 0.004304432957293894, 'psi': 0.9991175707834976}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=3.921718 (no previous merge yet)
[S6] round=38 local utility u=0.002622 metrics={'f1_val': 0.8037686118033346, 'auprc': 0.9484870063771639, 'loss_val': 0.6671469495944232, 'psi': 0.8616559696328663}-{'f1_val': 0.8032853016191245, 'auprc': 0.9486724929463839, 'loss_val': 0.6700471313296894, 'psi': 0.8614401781500283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=38 head_norm_before_train=4.136261 cos_to_last_merge=0.8916 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.892
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.7889523607116599, 'auprc': 0.9543867620378308, 'loss_val': 1.708845192041849, 'psi': 0.8551261212421282}-{'f1_val': 0.7931571042392946, 'auprc': 0.9555398658074916, 'loss_val': 1.6392799616174967, 'psi': 0.8581102088665734}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=3.952363 (no previous merge yet)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.8347366905803133, 'auprc': 0.9859149093404654, 'loss_val': 1.058486127744815, 'psi': 0.8952079780843742}-{'f1_val': 0.8349817431542353, 'auprc': 0.9857170687207617, 'loss_val': 1.0324286616102427, 'psi': 0.8952758733808459}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=3.510453 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9969067967561883, 'auprc': 0.9999868538092979, 'loss_val': 0.012666582989269584, 'psi': 0.9981388195774321}-{'f1_val': 0.9969067967561883, 'auprc': 0.9999873869876499, 'loss_val': 0.012643870543099291, 'psi': 0.9981390328487729}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=3.619025 cos_to_last_merge=0.8644 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.864
[S10] round=38 local utility u=0.002057 metrics={'f1_val': 0.9954705242636571, 'auprc': 0.9978773933629077, 'loss_val': 0.03195501547317483, 'psi': 0.9964332719033573}-{'f1_val': 0.9952087722795309, 'auprc': 0.9974614301593685, 'loss_val': 0.033250242460379935, 'psi': 0.9961098354314659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=38 head_norm_before_train=3.857618 (no previous merge yet)
[S11] round=38 local utility u=0.004662 metrics={'f1_val': 0.9884364015058119, 'auprc': 0.9976550005058862, 'loss_val': 0.06162175365096221, 'psi': 0.9921238411058416}-{'f1_val': 0.9872538772362969, 'auprc': 0.9978720113174178, 'loss_val': 0.06450260932163215, 'psi': 0.9915011308687453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=38 head_norm_before_train=4.251683 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.7057842336555245, 'auprc': 0.7567395364290129, 'loss_val': 1.7183376771367134, 'psi': 0.7261663547649199}-{'f1_val': 0.6894988185961831, 'auprc': 0.7573892324174794, 'loss_val': 1.5974834511939646, 'psi': 0.7166549841247016}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=3.868933 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9267129598724883, 'auprc': 0.9993950914319052, 'loss_val': 0.16330130019905162, 'psi': 0.955785812496255}-{'f1_val': 0.931407441549514, 'auprc': 0.9993983953749516, 'loss_val': 0.15224487962624333, 'psi': 0.958603823079689}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=3.475955 cos_to_last_merge=0.9771 (last merge round=1)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987950212079415, 'loss_val': 0.030756792411860426, 'psi': 0.997566009515689}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987970604033978, 'loss_val': 0.030578987248083986, 'psi': 0.9975668251938714}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=3.698848 (no previous merge yet)
[S16] round=38 local utility u=0.000914 metrics={'f1_val': 0.992952316257258, 'auprc': 0.9848961492619894, 'loss_val': 0.04806950537750114, 'psi': 0.9897298494591505}-{'f1_val': 0.9927104226270074, 'auprc': 0.9847407873042691, 'loss_val': 0.04797972051689481, 'psi': 0.989522568497912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=38 head_norm_before_train=3.862921 cos_to_last_merge=0.9555 (last merge round=2)
[S17] round=38 local utility u=0.047097 metrics={'f1_val': 0.9111248149406215, 'auprc': 0.9995447373569271, 'loss_val': 0.44600683604276314, 'psi': 0.9464927839071438}-{'f1_val': 0.9061846679576422, 'auprc': 0.9916284367631452, 'loss_val': 0.48681201698008464, 'psi': 0.9403621754798435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=39 head_norm_before_train=3.880478 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.9119651201634779, 'auprc': 0.9514014335110317, 'loss_val': 0.33027068240927754, 'psi': 0.9277396455024993}-{'f1_val': 0.908988393180636, 'auprc': 0.9508196752136422, 'loss_val': 0.26827723115614116, 'psi': 0.9257209059938384}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.928 u=0.0000 p_local=0.0266 f1=0.912 auprc=0.951 bytes=34104
[S3] START round=39 head_norm_before_train=3.563165 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.719048581872433, 'auprc': 0.9939261541828022, 'loss_val': 1.5293151466776107, 'psi': 0.8289996107965807}-{'f1_val': 0.7251140612064453, 'auprc': 0.9942204117090923, 'loss_val': 1.4944273814286804, 'psi': 0.8327566014075041}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.829 u=0.0000 p_local=0.0007 f1=0.719 auprc=0.994 bytes=7184
[S4] START round=39 head_norm_before_train=4.106537 cos_to_last_merge=0.8813 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.881
[S4] round=39 local utility u=0.026669 metrics={'f1_val': 0.9520667634190864, 'auprc': 0.962026644959261, 'loss_val': 0.3969576019399738, 'psi': 0.9560507160351563}-{'f1_val': 0.9533612315462887, 'auprc': 0.9752943462180843, 'loss_val': 0.49786482732979825, 'psi': 0.9621344774150069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S4] r=40 psi=0.956 u=0.0267 p_local=0.0198 f1=0.952 auprc=0.962 bytes=34132
[S5] START round=39 head_norm_before_train=4.179876 cos_to_last_merge=0.9026 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.903
[S5] round=39 local utility u=0.002782 metrics={'f1_val': 0.9989016402867434, 'auprc': 0.9999987571587655, 'loss_val': 0.002776725528745532, 'psi': 0.9993404870355522}-{'f1_val': 0.9985369128569197, 'auprc': 1.0, 'loss_val': 0.006156199689346083, 'psi': 0.9991221477141519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S5] r=40 psi=0.999 u=0.0028 p_local=0.0022 f1=0.999 auprc=1.000 bytes=37672
[S6] START round=39 head_norm_before_train=3.942146 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.8023454324488398, 'auprc': 0.947902873195207, 'loss_val': 0.686095201599325, 'psi': 0.8605684087473867}-{'f1_val': 0.8037686118033346, 'auprc': 0.9484870063771639, 'loss_val': 0.6671469495944232, 'psi': 0.8616559696328663}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.861 u=0.0000 p_local=0.0029 f1=0.802 auprc=0.948 bytes=17986
[S7] START round=39 head_norm_before_train=4.159863 cos_to_last_merge=0.8911 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.891
[S7] round=39 local utility u=0.034492 metrics={'f1_val': 0.7957705104905928, 'auprc': 0.9560432211983341, 'loss_val': 1.6857403688221482, 'psi': 0.8598795947736892}-{'f1_val': 0.7889523607116599, 'auprc': 0.9543867620378308, 'loss_val': 1.708845192041849, 'psi': 0.8551261212421282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] sending update (kind=head size=1791 to 1 peers)
[S7] r=40 psi=0.860 u=0.0345 p_local=0.0117 f1=0.796 auprc=0.956 bytes=26952
[S8] START round=39 head_norm_before_train=3.971762 (no previous merge yet)
[S8] round=39 local utility u=0.008165 metrics={'f1_val': 0.8359620807360327, 'auprc': 0.9853348602960674, 'loss_val': 1.047769212573399, 'psi': 0.8957111925600467}-{'f1_val': 0.8347366905803133, 'auprc': 0.9859149093404654, 'loss_val': 1.058486127744815, 'psi': 0.8952079780843742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S8] r=40 psi=0.896 u=0.0082 p_local=0.0049 f1=0.836 auprc=0.985 bytes=23340
[S9] START round=39 head_norm_before_train=3.528073 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9964670881300083, 'auprc': 0.9999856274293752, 'loss_val': 0.01352662761904316, 'psi': 0.9978745038497551}-{'f1_val': 0.9969067967561883, 'auprc': 0.9999868538092979, 'loss_val': 0.012666582989269584, 'psi': 0.9981388195774321}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.998 u=0.0000 p_local=0.0002 f1=0.996 auprc=1.000 bytes=14320
[S10] START round=39 head_norm_before_train=3.658402 cos_to_last_merge=0.8627 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.863
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9941136814432395, 'auprc': 0.9972426352974714, 'loss_val': 0.035285051036294535, 'psi': 0.9953652629849322}-{'f1_val': 0.9954705242636571, 'auprc': 0.9978773933629077, 'loss_val': 0.03195501547317483, 'psi': 0.9964332719033573}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0012 f1=0.994 auprc=0.997 bytes=23331
[S11] START round=39 head_norm_before_train=3.875738 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9879630665152123, 'auprc': 0.9979255730469505, 'loss_val': 0.06491568056544156, 'psi': 0.9919480691279076}-{'f1_val': 0.9884364015058119, 'auprc': 0.9976550005058862, 'loss_val': 0.06162175365096221, 'psi': 0.9921238411058416}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.992 u=0.0000 p_local=0.0010 f1=0.988 auprc=0.998 bytes=28677
[S13] START round=39 head_norm_before_train=4.293962 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6780790075798555, 'auprc': 0.7465912430910512, 'loss_val': 1.839072249981123, 'psi': 0.7054839017843337}-{'f1_val': 0.7057842336555245, 'auprc': 0.7567395364290129, 'loss_val': 1.7183376771367134, 'psi': 0.7261663547649199}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.705 u=0.0000 p_local=0.1004 f1=0.678 auprc=0.747 bytes=34177
[S14] START round=39 head_norm_before_train=3.887432 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9264888963087342, 'auprc': 0.9993950708517038, 'loss_val': 0.16670153418830108, 'psi': 0.955651366125922}-{'f1_val': 0.9267129598724883, 'auprc': 0.9993950914319052, 'loss_val': 0.16330130019905162, 'psi': 0.955785812496255}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.956 u=0.0000 p_local=0.0009 f1=0.926 auprc=0.999 bytes=17911
[S15] START round=39 head_norm_before_train=3.494612 cos_to_last_merge=0.9767 (last merge round=1)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.9959176576326709, 'auprc': 0.998795399452012, 'loss_val': 0.03146071808897254, 'psi': 0.9970687543604074}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987950212079415, 'loss_val': 0.030756792411860426, 'psi': 0.997566009515689}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.997 u=0.0000 p_local=0.0004 f1=0.996 auprc=0.999 bytes=34062
[S16] START round=39 head_norm_before_train=3.722682 (no previous merge yet)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9927104226270074, 'auprc': 0.9850800054942379, 'loss_val': 0.04880943226841408, 'psi': 0.9896582557738995}-{'f1_val': 0.992952316257258, 'auprc': 0.9848961492619894, 'loss_val': 0.04806950537750114, 'psi': 0.9897298494591505}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.990 u=0.0000 p_local=0.0006 f1=0.993 auprc=0.985 bytes=28723
[S17] START round=39 head_norm_before_train=3.937519 cos_to_last_merge=0.9503 (last merge round=2)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.9047246410726504, 'auprc': 0.9935214267724164, 'loss_val': 0.5737128064373558, 'psi': 0.9402433553525569}-{'f1_val': 0.9111248149406215, 'auprc': 0.9995447373569271, 'loss_val': 0.44600683604276314, 'psi': 0.9464927839071438}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.940 u=0.0000 p_local=0.0666 f1=0.905 auprc=0.994 bytes=37631
[S2] START round=40 head_norm_before_train=3.898666 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.8312609196393218, 'auprc': 0.9128724016460747, 'loss_val': 0.29616972167584954, 'psi': 0.863905512442023}-{'f1_val': 0.9119651201634779, 'auprc': 0.9514014335110317, 'loss_val': 0.33027068240927754, 'psi': 0.9277396455024993}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=3.581686 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.7179322976533679, 'auprc': 0.9937632707809949, 'loss_val': 1.5503515703748083, 'psi': 0.8282646869044187}-{'f1_val': 0.719048581872433, 'auprc': 0.9939261541828022, 'loss_val': 1.5293151466776107, 'psi': 0.8289996107965807}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=4.033663 cos_to_last_merge=0.8737 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.874
[S4] round=40 local utility u=0.014302 metrics={'f1_val': 0.9530589960552784, 'auprc': 0.9735637197968, 'loss_val': 0.4089187280757677, 'psi': 0.961260885551887}-{'f1_val': 0.9520667634190864, 'auprc': 0.962026644959261, 'loss_val': 0.3969576019399738, 'psi': 0.9560507160351563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=40 head_norm_before_train=4.218017 cos_to_last_merge=0.9011 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.901
[S5] round=40 local utility u=0.001668 metrics={'f1_val': 0.9993411206731109, 'auprc': 1.0, 'loss_val': 0.0020817919995266185, 'psi': 0.9996046724038665}-{'f1_val': 0.9989016402867434, 'auprc': 0.9999987571587655, 'loss_val': 0.002776725528745532, 'psi': 0.9993404870355522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=40 head_norm_before_train=3.962484 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.8023046067243477, 'auprc': 0.9479490993812002, 'loss_val': 0.6946765697940991, 'psi': 0.8605624037870887}-{'f1_val': 0.8023454324488398, 'auprc': 0.947902873195207, 'loss_val': 0.686095201599325, 'psi': 0.8605684087473867}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=4.182585 cos_to_last_merge=0.8906 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.891
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.7922732432092814, 'auprc': 0.9562998218814879, 'loss_val': 1.7215863144600618, 'psi': 0.857883874678164}-{'f1_val': 0.7957705104905928, 'auprc': 0.9560432211983341, 'loss_val': 1.6857403688221482, 'psi': 0.8598795947736892}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=3.990666 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.8344916498147846, 'auprc': 0.9854269742080621, 'loss_val': 1.0859135235058235, 'psi': 0.8948657795720956}-{'f1_val': 0.8359620807360327, 'auprc': 0.9853348602960674, 'loss_val': 1.047769212573399, 'psi': 0.8957111925600467}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=3.545908 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9964670881300083, 'auprc': 0.9999844064639334, 'loss_val': 0.013805763197319342, 'psi': 0.9978740154635783}-{'f1_val': 0.9964670881300083, 'auprc': 0.9999856274293752, 'loss_val': 0.01352662761904316, 'psi': 0.9978745038497551}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=3.697355 cos_to_last_merge=0.8603 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.860
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9934436502722204, 'auprc': 0.9965732264706579, 'loss_val': 0.052809336160118625, 'psi': 0.9946954807515953}-{'f1_val': 0.9941136814432395, 'auprc': 0.9972426352974714, 'loss_val': 0.035285051036294535, 'psi': 0.9953652629849322}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=3.893847 (no previous merge yet)
[S11] round=40 local utility u=0.001347 metrics={'f1_val': 0.9884364015058119, 'auprc': 0.9977095373867993, 'loss_val': 0.06441325709922817, 'psi': 0.9921456558582069}-{'f1_val': 0.9879630665152123, 'auprc': 0.9979255730469505, 'loss_val': 0.06491568056544156, 'psi': 0.9919480691279076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=40 head_norm_before_train=4.329694 (no previous merge yet)
[S13] round=40 local utility u=0.157532 metrics={'f1_val': 0.6936866479066862, 'auprc': 0.7981044557064516, 'loss_val': 1.772193237353186, 'psi': 0.7354537710265924}-{'f1_val': 0.6780790075798555, 'auprc': 0.7465912430910512, 'loss_val': 1.839072249981123, 'psi': 0.7054839017843337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=40 head_norm_before_train=3.905554 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.920903492820148, 'auprc': 0.9993930157661379, 'loss_val': 0.1772861318080545, 'psi': 0.952299301998544}-{'f1_val': 0.9264888963087342, 'auprc': 0.9993950708517038, 'loss_val': 0.16670153418830108, 'psi': 0.955651366125922}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=3.513138 cos_to_last_merge=0.9762 (last merge round=1)
[S15] round=40 local utility u=0.002544 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987853988153862, 'loss_val': 0.03131695255172299, 'psi': 0.9975621605586669}-{'f1_val': 0.9959176576326709, 'auprc': 0.998795399452012, 'loss_val': 0.03146071808897254, 'psi': 0.9970687543604074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S15] sending update (kind=head size=1785 to 1 peers)
[S16] START round=40 head_norm_before_train=3.746297 (no previous merge yet)
[S16] round=40 local utility u=0.000767 metrics={'f1_val': 0.992952316257258, 'auprc': 0.9851275243020243, 'loss_val': 0.048869268938183254, 'psi': 0.9898223994751645}-{'f1_val': 0.9927104226270074, 'auprc': 0.9850800054942379, 'loss_val': 0.04880943226841408, 'psi': 0.9896582557738995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=40 head_norm_before_train=3.997419 cos_to_last_merge=0.9464 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.946
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.8928581729110866, 'auprc': 0.99353793678328, 'loss_val': 0.6276422654181479, 'psi': 0.933130078459964}-{'f1_val': 0.9047246410726504, 'auprc': 0.9935214267724164, 'loss_val': 0.5737128064373558, 'psi': 0.9402433553525569}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=3.912328 (no previous merge yet)
[S2] round=41 local utility u=0.319655 metrics={'f1_val': 0.9125902760406223, 'auprc': 0.9444943597738554, 'loss_val': 0.23970179306531605, 'psi': 0.9253519095339156}-{'f1_val': 0.8312609196393218, 'auprc': 0.9128724016460747, 'loss_val': 0.29616972167584954, 'psi': 0.863905512442023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] sending update (kind=head size=1792 to 1 peers)
[S3] START round=41 head_norm_before_train=3.600063 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.7162499496013315, 'auprc': 0.9933690190286698, 'loss_val': 1.5766211672739836, 'psi': 0.8270975773722669}-{'f1_val': 0.7179322976533679, 'auprc': 0.9937632707809949, 'loss_val': 1.5503515703748083, 'psi': 0.8282646869044187}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=4.079743 cos_to_last_merge=0.8768 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.877
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.952199640906071, 'auprc': 0.9775291382636933, 'loss_val': 0.42171441781892327, 'psi': 0.96233143984912}-{'f1_val': 0.9530589960552784, 'auprc': 0.9735637197968, 'loss_val': 0.4089187280757677, 'psi': 0.961260885551887}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=4.236134 cos_to_last_merge=0.9005 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.901
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.9989016402867434, 'auprc': 1.0, 'loss_val': 0.0023175161478442476, 'psi': 0.9993409841720461}-{'f1_val': 0.9993411206731109, 'auprc': 1.0, 'loss_val': 0.0020817919995266185, 'psi': 0.9996046724038665}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=3.982543 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.801074617699732, 'auprc': 0.9464617574801675, 'loss_val': 0.7060557094740423, 'psi': 0.8592294736119062}-{'f1_val': 0.8023046067243477, 'auprc': 0.9479490993812002, 'loss_val': 0.6946765697940991, 'psi': 0.8605624037870887}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=4.205261 cos_to_last_merge=0.8901 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.890
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.7922732432092814, 'auprc': 0.9562254332727046, 'loss_val': 1.7479404149520141, 'psi': 0.8578541192346507}-{'f1_val': 0.7922732432092814, 'auprc': 0.9562998218814879, 'loss_val': 1.7215863144600618, 'psi': 0.857883874678164}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=4.009741 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.8347366905803133, 'auprc': 0.985245567368352, 'loss_val': 1.0989172464311083, 'psi': 0.8949402412955287}-{'f1_val': 0.8344916498147846, 'auprc': 0.9854269742080621, 'loss_val': 1.0859135235058235, 'psi': 0.8948657795720956}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=3.563506 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9964670881300083, 'auprc': 0.9999844064639334, 'loss_val': 0.014307518727340068, 'psi': 0.9978740154635783}-{'f1_val': 0.9964670881300083, 'auprc': 0.9999844064639334, 'loss_val': 0.013805763197319342, 'psi': 0.9978740154635783}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=3.744545 cos_to_last_merge=0.8557 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.856
[S10] round=41 local utility u=0.001270 metrics={'f1_val': 0.9933874715699831, 'auprc': 0.9958119239068588, 'loss_val': 0.047647386288924586, 'psi': 0.9943572525047334}-{'f1_val': 0.9934436502722204, 'auprc': 0.9965732264706579, 'loss_val': 0.052809336160118625, 'psi': 0.9946954807515953}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=41 head_norm_before_train=3.911877 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9877265620426765, 'auprc': 0.9975203982709359, 'loss_val': 0.06700259522535415, 'psi': 0.9916440965339803}-{'f1_val': 0.9884364015058119, 'auprc': 0.9977095373867993, 'loss_val': 0.06441325709922817, 'psi': 0.9921456558582069}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=4.346063 (no previous merge yet)
[S13] round=41 local utility u=0.046811 metrics={'f1_val': 0.6769049326758196, 'auprc': 0.7753347513329235, 'loss_val': 1.5095724045526564, 'psi': 0.7162768601386612}-{'f1_val': 0.6936866479066862, 'auprc': 0.7981044557064516, 'loss_val': 1.772193237353186, 'psi': 0.7354537710265924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=41 head_norm_before_train=3.923573 (no previous merge yet)
[S14] round=41 local utility u=0.003471 metrics={'f1_val': 0.9222412659474657, 'auprc': 0.9993926011618119, 'loss_val': 0.17837049612535277, 'psi': 0.9531018000332042}-{'f1_val': 0.920903492820148, 'auprc': 0.9993930157661379, 'loss_val': 0.1772861318080545, 'psi': 0.952299301998544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S14] sending update (kind=head size=1786 to 1 peers)
[S15] START round=41 head_norm_before_train=3.531551 cos_to_last_merge=0.9758 (last merge round=1)
[S15] round=41 local utility u=0.000085 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.998795856533714, 'loss_val': 0.03117894491653181, 'psi': 0.9975663436459979}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987853988153862, 'loss_val': 0.03131695255172299, 'psi': 0.9975621605586669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] sending update (kind=head size=1790 to 1 peers)
[S16] START round=41 head_norm_before_train=3.769949 (no previous merge yet)
[S16] round=41 local utility u=0.000107 metrics={'f1_val': 0.992952316257258, 'auprc': 0.9853733433551574, 'loss_val': 0.04939205687736466, 'psi': 0.9899207270964177}-{'f1_val': 0.992952316257258, 'auprc': 0.9851275243020243, 'loss_val': 0.048869268938183254, 'psi': 0.9898223994751645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=41 head_norm_before_train=4.054279 cos_to_last_merge=0.9436 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.944
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6991123577381791, 'auprc': 0.9853541891053574, 'loss_val': 1.1335773368618445, 'psi': 0.8136090902850505}-{'f1_val': 0.8928581729110866, 'auprc': 0.99353793678328, 'loss_val': 0.6276422654181479, 'psi': 0.933130078459964}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=3.985583 (no previous merge yet)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.913459786965428, 'auprc': 0.9512218092504479, 'loss_val': 0.32960111267606196, 'psi': 0.928564595879436}-{'f1_val': 0.9125902760406223, 'auprc': 0.9444943597738554, 'loss_val': 0.23970179306531605, 'psi': 0.9253519095339156}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=3.618364 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.7162499496013315, 'auprc': 0.9931843014202941, 'loss_val': 1.6032240635611361, 'psi': 0.8270236903289165}-{'f1_val': 0.7162499496013315, 'auprc': 0.9933690190286698, 'loss_val': 1.5766211672739836, 'psi': 0.8270975773722669}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=4.106136 cos_to_last_merge=0.8776 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.878
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9476363450710312, 'auprc': 0.9646714394783054, 'loss_val': 0.46188878712149256, 'psi': 0.9544503828339409}-{'f1_val': 0.952199640906071, 'auprc': 0.9775291382636933, 'loss_val': 0.42171441781892327, 'psi': 0.96233143984912}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=4.273990 cos_to_last_merge=0.8969 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.897
[S5] round=42 local utility u=0.002460 metrics={'f1_val': 0.999707026636445, 'auprc': 1.0, 'loss_val': 0.0022307536750881666, 'psi': 0.999824215981867}-{'f1_val': 0.9989016402867434, 'auprc': 1.0, 'loss_val': 0.0023175161478442476, 'psi': 0.9993409841720461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=42 head_norm_before_train=4.002545 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.8016490105000351, 'auprc': 0.9459273932844156, 'loss_val': 0.7358186623524133, 'psi': 0.8593603636137873}-{'f1_val': 0.801074617699732, 'auprc': 0.9464617574801675, 'loss_val': 0.7060557094740423, 'psi': 0.8592294736119062}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=4.227065 cos_to_last_merge=0.8896 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.890
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.792711933556106, 'auprc': 0.9569421035644116, 'loss_val': 1.760922885852005, 'psi': 0.8584040015594282}-{'f1_val': 0.7922732432092814, 'auprc': 0.9562254332727046, 'loss_val': 1.7479404149520141, 'psi': 0.8578541192346507}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=4.028553 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.8347366905803133, 'auprc': 0.9854883099417558, 'loss_val': 1.1091546266821792, 'psi': 0.8950373383248904}-{'f1_val': 0.8347366905803133, 'auprc': 0.985245567368352, 'loss_val': 1.0989172464311083, 'psi': 0.8949402412955287}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=3.581133 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9964670881300083, 'auprc': 0.999983190877194, 'loss_val': 0.014745376163790224, 'psi': 0.9978735292288825}-{'f1_val': 0.9964670881300083, 'auprc': 0.9999844064639334, 'loss_val': 0.014307518727340068, 'psi': 0.9978740154635783}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=3.797484 cos_to_last_merge=0.8515 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.852
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9907412284067502, 'auprc': 0.9946795284456741, 'loss_val': 0.042410456785336316, 'psi': 0.9923165484223198}-{'f1_val': 0.9933874715699831, 'auprc': 0.9958119239068588, 'loss_val': 0.047647386288924586, 'psi': 0.9943572525047334}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=3.929747 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9877265620426765, 'auprc': 0.997605575549268, 'loss_val': 0.0675585624834663, 'psi': 0.9916781674453131}-{'f1_val': 0.9877265620426765, 'auprc': 0.9975203982709359, 'loss_val': 0.06700259522535415, 'psi': 0.9916440965339803}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=4.405654 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6711689454235045, 'auprc': 0.7493855610913747, 'loss_val': 1.7627919381738681, 'psi': 0.7024555916906525}-{'f1_val': 0.6769049326758196, 'auprc': 0.7753347513329235, 'loss_val': 1.5095724045526564, 'psi': 0.7162768601386612}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=3.941736 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9180104170023525, 'auprc': 0.9993910667519644, 'loss_val': 0.18709465963094066, 'psi': 0.9505626769021973}-{'f1_val': 0.9222412659474657, 'auprc': 0.9993926011618119, 'loss_val': 0.17837049612535277, 'psi': 0.9531018000332042}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=3.549926 cos_to_last_merge=0.9753 (last merge round=1)
[S15] round=42 local utility u=0.000128 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.998792960789779, 'loss_val': 0.030914878391369218, 'psi': 0.997565185348424}-{'f1_val': 0.9967466683875206, 'auprc': 0.998795856533714, 'loss_val': 0.03117894491653181, 'psi': 0.9975663436459979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S15] sending update (kind=head size=1786 to 1 peers)
[S16] START round=42 head_norm_before_train=3.792691 (no previous merge yet)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.992952316257258, 'auprc': 0.9854965420611401, 'loss_val': 0.04978980201578635, 'psi': 0.9899700065788108}-{'f1_val': 0.992952316257258, 'auprc': 0.9853733433551574, 'loss_val': 0.04939205687736466, 'psi': 0.9899207270964177}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=4.112651 cos_to_last_merge=0.9404 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.940
[S17] round=42 local utility u=0.621950 metrics={'f1_val': 0.8636124156173057, 'auprc': 0.9885184213977117, 'loss_val': 0.8861710129695728, 'psi': 0.913574817929468}-{'f1_val': 0.6991123577381791, 'auprc': 0.9853541891053574, 'loss_val': 1.1335773368618445, 'psi': 0.8136090902850505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] START round=43 head_norm_before_train=4.015411 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.9037174718813862, 'auprc': 0.9457007057347949, 'loss_val': 0.3958033829114531, 'psi': 0.9205107654227497}-{'f1_val': 0.913459786965428, 'auprc': 0.9512218092504479, 'loss_val': 0.32960111267606196, 'psi': 0.928564595879436}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=3.636615 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.7162499496013315, 'auprc': 0.9931971591634512, 'loss_val': 1.6036977397688954, 'psi': 0.8270288334261794}-{'f1_val': 0.7162499496013315, 'auprc': 0.9931843014202941, 'loss_val': 1.6032240635611361, 'psi': 0.8270236903289165}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=4.156553 cos_to_last_merge=0.8771 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.877
[S4] round=43 local utility u=0.043809 metrics={'f1_val': 0.9509306747716071, 'auprc': 0.9801680770783893, 'loss_val': 0.44052725324992664, 'psi': 0.96262563569432}-{'f1_val': 0.9476363450710312, 'auprc': 0.9646714394783054, 'loss_val': 0.46188878712149256, 'psi': 0.9544503828339409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=43 head_norm_before_train=4.306326 cos_to_last_merge=0.8948 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.895
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.9989008131422167, 'auprc': 0.9999983425320622, 'loss_val': 0.002260112008483939, 'psi': 0.9993398248981549}-{'f1_val': 0.999707026636445, 'auprc': 1.0, 'loss_val': 0.0022307536750881666, 'psi': 0.999824215981867}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=4.022440 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.8009136423165992, 'auprc': 0.9462594868075259, 'loss_val': 0.74012561792819, 'psi': 0.8590519801129699}-{'f1_val': 0.8016490105000351, 'auprc': 0.9459273932844156, 'loss_val': 0.7358186623524133, 'psi': 0.8593603636137873}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=4.248809 cos_to_last_merge=0.8891 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.889
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.7918336242985045, 'auprc': 0.9568166331988525, 'loss_val': 1.795676456575824, 'psi': 0.8578268278586436}-{'f1_val': 0.792711933556106, 'auprc': 0.9569421035644116, 'loss_val': 1.760922885852005, 'psi': 0.8584040015594282}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=4.047379 (no previous merge yet)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.8342466203983618, 'auprc': 0.98543916811275, 'loss_val': 1.1307283925783334, 'psi': 0.894723639484117}-{'f1_val': 0.8347366905803133, 'auprc': 0.9854883099417558, 'loss_val': 1.1091546266821792, 'psi': 0.8950373383248904}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=3.598710 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9964670881300083, 'auprc': 0.9999831908771941, 'loss_val': 0.014870628740254042, 'psi': 0.9978735292288826}-{'f1_val': 0.9964670881300083, 'auprc': 0.999983190877194, 'loss_val': 0.014745376163790224, 'psi': 0.9978735292288825}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=3.644115 cos_to_last_merge=0.8411 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.841
[S10] round=43 local utility u=0.025764 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9988050195026792, 'loss_val': 0.025480816846711683, 'psi': 0.9961889841188658}-{'f1_val': 0.9907412284067502, 'auprc': 0.9946795284456741, 'loss_val': 0.042410456785336316, 'psi': 0.9923165484223198}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=43 head_norm_before_train=3.947746 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9874901657432803, 'auprc': 0.997795919039531, 'loss_val': 0.06951297995308622, 'psi': 0.9916124670617806}-{'f1_val': 0.9877265620426765, 'auprc': 0.997605575549268, 'loss_val': 0.0675585624834663, 'psi': 0.9916781674453131}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=4.455848 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6492327374890876, 'auprc': 0.7505920851277934, 'loss_val': 1.9435706187367465, 'psi': 0.68977647654457}-{'f1_val': 0.6711689454235045, 'auprc': 0.7493855610913747, 'loss_val': 1.7627919381738681, 'psi': 0.7024555916906525}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=3.959863 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9162335337173889, 'auprc': 0.9993919173156959, 'loss_val': 0.1980137256204867, 'psi': 0.9494968871567117}-{'f1_val': 0.9180104170023525, 'auprc': 0.9993910667519644, 'loss_val': 0.18709465963094066, 'psi': 0.9505626769021973}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=3.568200 cos_to_last_merge=0.9749 (last merge round=1)
[S15] round=43 local utility u=0.000356 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9988041605850677, 'loss_val': 0.03023585919273605, 'psi': 0.9975696652665395}-{'f1_val': 0.9967466683875206, 'auprc': 0.998792960789779, 'loss_val': 0.030914878391369218, 'psi': 0.997565185348424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S15] sending update (kind=head size=1787 to 1 peers)
[S16] START round=43 head_norm_before_train=3.814863 (no previous merge yet)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.992952316257258, 'auprc': 0.9856361523555508, 'loss_val': 0.05022035828674752, 'psi': 0.9900258506965751}-{'f1_val': 0.992952316257258, 'auprc': 0.9854965420611401, 'loss_val': 0.04978980201578635, 'psi': 0.9899700065788108}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=4.165527 cos_to_last_merge=0.9377 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.938
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.7982935926701898, 'auprc': 0.9608952466980778, 'loss_val': 1.1280691400135712, 'psi': 0.863334254281345}-{'f1_val': 0.8636124156173057, 'auprc': 0.9885184213977117, 'loss_val': 0.8861710129695728, 'psi': 0.913574817929468}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=4.034211 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.9027555352987375, 'auprc': 0.9451049922486743, 'loss_val': 0.4063656389000715, 'psi': 0.9196953180787122}-{'f1_val': 0.9037174718813862, 'auprc': 0.9457007057347949, 'loss_val': 0.3958033829114531, 'psi': 0.9205107654227497}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=3.654765 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.715687039104514, 'auprc': 0.9928562803039607, 'loss_val': 1.6414973688862446, 'psi': 0.8265547355842927}-{'f1_val': 0.7162499496013315, 'auprc': 0.9931971591634512, 'loss_val': 1.6036977397688954, 'psi': 0.8270288334261794}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=4.176693 cos_to_last_merge=0.8675 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.867
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9533297918206455, 'auprc': 0.9766865230566218, 'loss_val': 0.45803444921737835, 'psi': 0.962672484315036}-{'f1_val': 0.9509306747716071, 'auprc': 0.9801680770783893, 'loss_val': 0.44052725324992664, 'psi': 0.96262563569432}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=4.336914 cos_to_last_merge=0.8942 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.894
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.9992669255222367, 'auprc': 0.9999962708567525, 'loss_val': 0.00459054679641406, 'psi': 0.9995586636560431}-{'f1_val': 0.9989008131422167, 'auprc': 0.9999983425320622, 'loss_val': 0.002260112008483939, 'psi': 0.9993398248981549}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=4.042034 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.8019752632062621, 'auprc': 0.9459241978293469, 'loss_val': 0.758387560993948, 'psi': 0.8595548370554961}-{'f1_val': 0.8009136423165992, 'auprc': 0.9462594868075259, 'loss_val': 0.74012561792819, 'psi': 0.8590519801129699}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=4.270159 cos_to_last_merge=0.8886 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.889
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.7922732432092814, 'auprc': 0.9571579680328519, 'loss_val': 1.8119846244543654, 'psi': 0.8582271331387096}-{'f1_val': 0.7918336242985045, 'auprc': 0.9568166331988525, 'loss_val': 1.795676456575824, 'psi': 0.8578268278586436}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=4.066012 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.8342466203983618, 'auprc': 0.9852114025221075, 'loss_val': 1.1530702125987178, 'psi': 0.8946325332478601}-{'f1_val': 0.8342466203983618, 'auprc': 0.98543916811275, 'loss_val': 1.1307283925783334, 'psi': 0.894723639484117}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=3.616203 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9964670881300083, 'auprc': 0.9999826586467963, 'loss_val': 0.015462714167667138, 'psi': 0.9978733163367235}-{'f1_val': 0.9964670881300083, 'auprc': 0.9999831908771941, 'loss_val': 0.014870628740254042, 'psi': 0.9978735292288826}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=3.684017 cos_to_last_merge=0.8398 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.840
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9988593222062506, 'loss_val': 0.02581410422597278, 'psi': 0.9958663565128272}-{'f1_val': 0.9944449605296568, 'auprc': 0.9988050195026792, 'loss_val': 0.025480816846711683, 'psi': 0.9961889841188658}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=3.965666 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9872538772362969, 'auprc': 0.9978861781611287, 'loss_val': 0.07085216106846062, 'psi': 0.9915067976062296}-{'f1_val': 0.9874901657432803, 'auprc': 0.997795919039531, 'loss_val': 0.06951297995308622, 'psi': 0.9916124670617806}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=4.494452 (no previous merge yet)
[S13] round=44 local utility u=0.143881 metrics={'f1_val': 0.6607584941260443, 'auprc': 0.7669392675725131, 'loss_val': 1.7740053318436344, 'psi': 0.7032308035046317}-{'f1_val': 0.6492327374890876, 'auprc': 0.7505920851277934, 'loss_val': 1.9435706187367465, 'psi': 0.68977647654457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=44 head_norm_before_train=3.978121 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9144591132365754, 'auprc': 0.9993914140488703, 'loss_val': 0.20493152331258616, 'psi': 0.9484320335614933}-{'f1_val': 0.9162335337173889, 'auprc': 0.9993919173156959, 'loss_val': 0.1980137256204867, 'psi': 0.9494968871567117}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=3.586438 cos_to_last_merge=0.9744 (last merge round=1)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987946331099875, 'loss_val': 0.0314800458213169, 'psi': 0.9975658542765073}-{'f1_val': 0.9967466683875206, 'auprc': 0.9988041605850677, 'loss_val': 0.03023585919273605, 'psi': 0.9975696652665395}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=3.837250 (no previous merge yet)
[S16] round=44 local utility u=0.000150 metrics={'f1_val': 0.992952316257258, 'auprc': 0.9858262685833357, 'loss_val': 0.05049102146847978, 'psi': 0.990101897187689}-{'f1_val': 0.992952316257258, 'auprc': 0.9856361523555508, 'loss_val': 0.05022035828674752, 'psi': 0.9900258506965751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=44 head_norm_before_train=4.228608 cos_to_last_merge=0.9346 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.935
[S17] round=44 local utility u=0.039588 metrics={'f1_val': 0.7837931842455739, 'auprc': 0.9423380337354436, 'loss_val': 0.9062197388628926, 'psi': 0.8472111240415218}-{'f1_val': 0.7982935926701898, 'auprc': 0.9608952466980778, 'loss_val': 1.1280691400135712, 'psi': 0.863334254281345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=45 head_norm_before_train=4.062105 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.828949176053792, 'auprc': 0.8878001278653336, 'loss_val': 0.3886430513447332, 'psi': 0.8524895567784087}-{'f1_val': 0.9027555352987375, 'auprc': 0.9451049922486743, 'loss_val': 0.4063656389000715, 'psi': 0.9196953180787122}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=3.672905 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.7151230582543151, 'auprc': 0.9926195907537667, 'loss_val': 1.667187074571124, 'psi': 0.8261216712540957}-{'f1_val': 0.715687039104514, 'auprc': 0.9928562803039607, 'loss_val': 1.6414973688862446, 'psi': 0.8265547355842927}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=4.240527 cos_to_last_merge=0.8666 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.867
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9519756452517586, 'auprc': 0.9705949958336001, 'loss_val': 0.47676203965704655, 'psi': 0.9594233854844952}-{'f1_val': 0.9533297918206455, 'auprc': 0.9766865230566218, 'loss_val': 0.45803444921737835, 'psi': 0.962672484315036}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=4.361764 cos_to_last_merge=0.8913 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.891
[S5] round=45 local utility u=0.000071 metrics={'f1_val': 0.9989004582326563, 'auprc': 0.9999975115433318, 'loss_val': 0.002254213019437388, 'psi': 0.9993392795569265}-{'f1_val': 0.9992669255222367, 'auprc': 0.9999962708567525, 'loss_val': 0.00459054679641406, 'psi': 0.9995586636560431}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=45 head_norm_before_train=4.061692 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.8008730324623052, 'auprc': 0.9453416418335439, 'loss_val': 0.7670550269255895, 'psi': 0.8586604762108007}-{'f1_val': 0.8019752632062621, 'auprc': 0.9459241978293469, 'loss_val': 0.758387560993948, 'psi': 0.8595548370554961}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=4.291240 cos_to_last_merge=0.8882 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.888
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.7922732432092814, 'auprc': 0.9573000506969496, 'loss_val': 1.8400547562719165, 'psi': 0.8582839662043487}-{'f1_val': 0.7922732432092814, 'auprc': 0.9571579680328519, 'loss_val': 1.8119846244543654, 'psi': 0.8582271331387096}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=4.084590 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.8342466203983618, 'auprc': 0.9858120829120708, 'loss_val': 1.171518067468141, 'psi': 0.8948728054038454}-{'f1_val': 0.8342466203983618, 'auprc': 0.9852114025221075, 'loss_val': 1.1530702125987178, 'psi': 0.8946325332478601}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=3.633721 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9962190392098188, 'auprc': 0.9999826586467963, 'loss_val': 0.015981890454163684, 'psi': 0.9977244869846098}-{'f1_val': 0.9964670881300083, 'auprc': 0.9999826586467963, 'loss_val': 0.015462714167667138, 'psi': 0.9978733163367235}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=3.718713 cos_to_last_merge=0.8360 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.836
[S10] round=45 local utility u=0.003183 metrics={'f1_val': 0.9949854573784049, 'auprc': 0.9988204755003417, 'loss_val': 0.02601704273955877, 'psi': 0.9965194646271796}-{'f1_val': 0.993871046050545, 'auprc': 0.9988593222062506, 'loss_val': 0.02581410422597278, 'psi': 0.9958663565128272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] sending update (kind=head size=1790 to 1 peers)
[S11] START round=45 head_norm_before_train=3.983658 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9870176961416375, 'auprc': 0.9978142285810355, 'loss_val': 0.07290820681925221, 'psi': 0.9913363091173968}-{'f1_val': 0.9872538772362969, 'auprc': 0.9978861781611287, 'loss_val': 0.07085216106846062, 'psi': 0.9915067976062296}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=4.524570 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.5511324323268616, 'auprc': 0.7170228084872837, 'loss_val': 2.256376317565586, 'psi': 0.6174885827910304}-{'f1_val': 0.6607584941260443, 'auprc': 0.7669392675725131, 'loss_val': 1.7740053318436344, 'psi': 0.7032308035046317}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=3.996256 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9109170648327519, 'auprc': 0.9993903431634371, 'loss_val': 0.21617045762241, 'psi': 0.946306376165026}-{'f1_val': 0.9144591132365754, 'auprc': 0.9993914140488703, 'loss_val': 0.20493152331258616, 'psi': 0.9484320335614933}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=3.604588 cos_to_last_merge=0.9740 (last merge round=1)
[S15] round=45 local utility u=0.000304 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9988012636656943, 'loss_val': 0.030891028584741978, 'psi': 0.99756850649879}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987946331099875, 'loss_val': 0.0314800458213169, 'psi': 0.9975658542765073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=45 head_norm_before_train=3.859095 (no previous merge yet)
[S16] round=45 local utility u=0.000427 metrics={'f1_val': 0.992952316257258, 'auprc': 0.9862261877999791, 'loss_val': 0.05083665617940103, 'psi': 0.9902618648743464}-{'f1_val': 0.992952316257258, 'auprc': 0.9858262685833357, 'loss_val': 0.05049102146847978, 'psi': 0.990101897187689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=45 head_norm_before_train=4.266190 cos_to_last_merge=0.9309 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.931
[S17] round=45 local utility u=0.288913 metrics={'f1_val': 0.8808404019056759, 'auprc': 0.9518965828591348, 'loss_val': 0.9393531567131986, 'psi': 0.9092628742870594}-{'f1_val': 0.7837931842455739, 'auprc': 0.9423380337354436, 'loss_val': 0.9062197388628926, 'psi': 0.8472111240415218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=46 head_norm_before_train=4.124263 (no previous merge yet)
[S2] round=46 local utility u=0.415986 metrics={'f1_val': 0.9129998155686665, 'auprc': 0.9515805883614732, 'loss_val': 0.252316147617642, 'psi': 0.9284321246857892}-{'f1_val': 0.828949176053792, 'auprc': 0.8878001278653336, 'loss_val': 0.3886430513447332, 'psi': 0.8524895567784087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=46 head_norm_before_train=3.690947 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.7151230582543151, 'auprc': 0.9924985338569887, 'loss_val': 1.6832792738502076, 'psi': 0.8260732484953845}-{'f1_val': 0.7151230582543151, 'auprc': 0.9926195907537667, 'loss_val': 1.667187074571124, 'psi': 0.8261216712540957}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=4.287728 cos_to_last_merge=0.8673 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.867
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9520629644364436, 'auprc': 0.9702901202038972, 'loss_val': 0.500763825109585, 'psi': 0.959353826743425}-{'f1_val': 0.9519756452517586, 'auprc': 0.9705949958336001, 'loss_val': 0.47676203965704655, 'psi': 0.9594233854844952}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=4.403430 cos_to_last_merge=0.8896 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.890
[S5] round=46 local utility u=0.001232 metrics={'f1_val': 0.9992669255222367, 'auprc': 0.9999987571587655, 'loss_val': 0.00199338662442628, 'psi': 0.9995596581768482}-{'f1_val': 0.9989004582326563, 'auprc': 0.9999975115433318, 'loss_val': 0.002254213019437388, 'psi': 0.9993392795569265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=46 head_norm_before_train=4.081168 (no previous merge yet)
[S6] round=46 local utility u=0.003689 metrics={'f1_val': 0.8006251755416736, 'auprc': 0.9459453556959927, 'loss_val': 0.7600016528751157, 'psi': 0.8587532476034012}-{'f1_val': 0.8008730324623052, 'auprc': 0.9453416418335439, 'loss_val': 0.7670550269255895, 'psi': 0.8586604762108007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=46 head_norm_before_train=4.312045 cos_to_last_merge=0.8877 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.888
[S7] round=46 local utility u=0.007309 metrics={'f1_val': 0.7957570847660185, 'auprc': 0.9581378788493334, 'loss_val': 1.8488537434046102, 'psi': 0.8607094023993445}-{'f1_val': 0.7922732432092814, 'auprc': 0.9573000506969496, 'loss_val': 1.8400547562719165, 'psi': 0.8582839662043487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=46 head_norm_before_train=4.103110 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.8342466203983618, 'auprc': 0.985343442831163, 'loss_val': 1.1739219972361237, 'psi': 0.8946853493714823}-{'f1_val': 0.8342466203983618, 'auprc': 0.9858120829120708, 'loss_val': 1.171518067468141, 'psi': 0.8948728054038454}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=3.651182 (no previous merge yet)
[S9] round=46 local utility u=0.000848 metrics={'f1_val': 0.9964670881300083, 'auprc': 0.9999826586467964, 'loss_val': 0.015773563812852665, 'psi': 0.9978733163367235}-{'f1_val': 0.9962190392098188, 'auprc': 0.9999826586467963, 'loss_val': 0.015981890454163684, 'psi': 0.9977244869846098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S9] sending update (kind=head size=1786 to 1 peers)
[S10] START round=46 head_norm_before_train=3.750050 cos_to_last_merge=0.8322 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.832
[S10] round=46 local utility u=0.000756 metrics={'f1_val': 0.99520473735929, 'auprc': 0.998850034551387, 'loss_val': 0.025910071846637656, 'psi': 0.9966628562361288}-{'f1_val': 0.9949854573784049, 'auprc': 0.9988204755003417, 'loss_val': 0.02601704273955877, 'psi': 0.9965194646271796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] sending update (kind=head size=1789 to 1 peers)
[S11] START round=46 head_norm_before_train=4.001614 (no previous merge yet)
[S11] round=46 local utility u=0.001330 metrics={'f1_val': 0.9874901657432803, 'auprc': 0.9976925847307372, 'loss_val': 0.07271835426071833, 'psi': 0.9915711333382631}-{'f1_val': 0.9870176961416375, 'auprc': 0.9978142285810355, 'loss_val': 0.07290820681925221, 'psi': 0.9913363091173968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=46 head_norm_before_train=4.577505 (no previous merge yet)
[S13] round=46 local utility u=1.000000 metrics={'f1_val': 0.7795531591810233, 'auprc': 0.8139259612599685, 'loss_val': 1.3914875913278233, 'psi': 0.7933022800126014}-{'f1_val': 0.5511324323268616, 'auprc': 0.7170228084872837, 'loss_val': 2.256376317565586, 'psi': 0.6174885827910304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=46 head_norm_before_train=4.014311 (no previous merge yet)
[S14] round=46 local utility u=0.018322 metrics={'f1_val': 0.9153460869908318, 'auprc': 0.999388279225664, 'loss_val': 0.2060941144486092, 'psi': 0.9489629638847648}-{'f1_val': 0.9109170648327519, 'auprc': 0.9993903431634371, 'loss_val': 0.21617045762241, 'psi': 0.946306376165026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S14] sending update (kind=head size=1788 to 1 peers)
[S15] START round=46 head_norm_before_train=3.622658 cos_to_last_merge=0.9736 (last merge round=1)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9988033981566387, 'loss_val': 0.03135051461823006, 'psi': 0.9975693602951679}-{'f1_val': 0.9967466683875206, 'auprc': 0.9988012636656943, 'loss_val': 0.030891028584741978, 'psi': 0.99756850649879}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=3.881454 (no previous merge yet)
[S16] round=46 local utility u=0.000467 metrics={'f1_val': 0.992952316257258, 'auprc': 0.9866223770954163, 'loss_val': 0.05109060895584942, 'psi': 0.9904203405925213}-{'f1_val': 0.992952316257258, 'auprc': 0.9862261877999791, 'loss_val': 0.05083665617940103, 'psi': 0.9902618648743464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] sending update (kind=head size=1790 to 1 peers)
[S17] START round=46 head_norm_before_train=4.319903 cos_to_last_merge=0.9285 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.929
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.8792114262377149, 'auprc': 0.9133901036356354, 'loss_val': 1.0093997181417675, 'psi': 0.8928828971968832}-{'f1_val': 0.8808404019056759, 'auprc': 0.9518965828591348, 'loss_val': 0.9393531567131986, 'psi': 0.9092628742870594}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=4.290276 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.9143376367419176, 'auprc': 0.9462046386070343, 'loss_val': 0.24628959901382325, 'psi': 0.9270844374879643}-{'f1_val': 0.9129998155686665, 'auprc': 0.9515805883614732, 'loss_val': 0.252316147617642, 'psi': 0.9284321246857892}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=3.708946 (no previous merge yet)
[S3] round=47 local utility u=0.002104 metrics={'f1_val': 0.7162499496013315, 'auprc': 0.992457580679641, 'loss_val': 1.6857106554721106, 'psi': 0.8267330020326553}-{'f1_val': 0.7151230582543151, 'auprc': 0.9924985338569887, 'loss_val': 1.6832792738502076, 'psi': 0.8260732484953845}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S3] sending update (kind=head size=1787 to 1 peers)
[S4] START round=47 head_norm_before_train=4.320876 cos_to_last_merge=0.8681 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.868
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9516230344304155, 'auprc': 0.9681764293047215, 'loss_val': 0.5069309894774892, 'psi': 0.9582443923801379}-{'f1_val': 0.9520629644364436, 'auprc': 0.9702901202038972, 'loss_val': 0.500763825109585, 'psi': 0.959353826743425}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=4.443893 cos_to_last_merge=0.8890 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.889
[S5] round=47 local utility u=0.000463 metrics={'f1_val': 0.9993411206731109, 'auprc': 1.0, 'loss_val': 0.0015168667059833447, 'psi': 0.9996046724038665}-{'f1_val': 0.9992669255222367, 'auprc': 0.9999987571587655, 'loss_val': 0.00199338662442628, 'psi': 0.9995596581768482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=47 head_norm_before_train=4.100639 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.8006251755416736, 'auprc': 0.945308239157022, 'loss_val': 0.7815087929643824, 'psi': 0.8584984009878129}-{'f1_val': 0.8006251755416736, 'auprc': 0.9459453556959927, 'loss_val': 0.7600016528751157, 'psi': 0.8587532476034012}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=4.332875 cos_to_last_merge=0.8872 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.887
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.7922663381961523, 'auprc': 0.9586450548481472, 'loss_val': 1.8805267655242257, 'psi': 0.8588178248569502}-{'f1_val': 0.7957570847660185, 'auprc': 0.9581378788493334, 'loss_val': 1.8488537434046102, 'psi': 0.8607094023993445}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=4.121614 (no previous merge yet)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.8342466203983618, 'auprc': 0.9855502166617222, 'loss_val': 1.1999917217170168, 'psi': 0.8947680589037059}-{'f1_val': 0.8342466203983618, 'auprc': 0.985343442831163, 'loss_val': 1.1739219972361237, 'psi': 0.8946853493714823}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=3.668452 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9957233608815909, 'auprc': 0.9999814795972374, 'loss_val': 0.02031274268855437, 'psi': 0.9974266083678494}-{'f1_val': 0.9964670881300083, 'auprc': 0.9999826586467964, 'loss_val': 0.015773563812852665, 'psi': 0.9978733163367235}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=3.780558 cos_to_last_merge=0.8286 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.829
[S10] round=47 local utility u=0.001603 metrics={'f1_val': 0.9956435195279056, 'auprc': 0.9989118944273148, 'loss_val': 0.02552333725406885, 'psi': 0.9969508694876693}-{'f1_val': 0.99520473735929, 'auprc': 0.998850034551387, 'loss_val': 0.025910071846637656, 'psi': 0.9966628562361288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=47 head_norm_before_train=4.019638 (no previous merge yet)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9870176961416375, 'auprc': 0.9976998533569372, 'loss_val': 0.07470709367133123, 'psi': 0.9912905590277574}-{'f1_val': 0.9874901657432803, 'auprc': 0.9976925847307372, 'loss_val': 0.07271835426071833, 'psi': 0.9915711333382631}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=4.622782 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6924952289068002, 'auprc': 0.7767400457201802, 'loss_val': 1.585443276407931, 'psi': 0.7261931556321521}-{'f1_val': 0.7795531591810233, 'auprc': 0.8139259612599685, 'loss_val': 1.3914875913278233, 'psi': 0.7933022800126014}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=4.032496 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9089264099971178, 'auprc': 0.9993892956222402, 'loss_val': 0.22710085214662432, 'psi': 0.9451115642471668}-{'f1_val': 0.9153460869908318, 'auprc': 0.999388279225664, 'loss_val': 0.2060941144486092, 'psi': 0.9489629638847648}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=3.640640 cos_to_last_merge=0.9731 (last merge round=1)
[S15] round=47 local utility u=0.000098 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.998783836331046, 'loss_val': 0.031095970523922413, 'psi': 0.9975615355649308}-{'f1_val': 0.9967466683875206, 'auprc': 0.9988033981566387, 'loss_val': 0.03135051461823006, 'psi': 0.9975693602951679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=47 head_norm_before_train=3.903449 (no previous merge yet)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.992952316257258, 'auprc': 0.9868018862812292, 'loss_val': 0.051660490635467925, 'psi': 0.9904921442668464}-{'f1_val': 0.992952316257258, 'auprc': 0.9866223770954163, 'loss_val': 0.05109060895584942, 'psi': 0.9904203405925213}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=4.384340 cos_to_last_merge=0.9256 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.926
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.8664024203617243, 'auprc': 0.8697220167555869, 'loss_val': 1.056398764705134, 'psi': 0.8677302589192694}-{'f1_val': 0.8792114262377149, 'auprc': 0.9133901036356354, 'loss_val': 1.0093997181417675, 'psi': 0.8928828971968832}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=4.324315 (no previous merge yet)
[S2] round=48 local utility u=0.006402 metrics={'f1_val': 0.9160282140354771, 'auprc': 0.9478865908006436, 'loss_val': 0.24867405635078246, 'psi': 0.9287715647415437}-{'f1_val': 0.9143376367419176, 'auprc': 0.9462046386070343, 'loss_val': 0.24628959901382325, 'psi': 0.9270844374879643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=48 head_norm_before_train=3.726909 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.7134246545561308, 'auprc': 0.9918528571046328, 'loss_val': 1.7431083341734976, 'psi': 0.8247959355755317}-{'f1_val': 0.7162499496013315, 'auprc': 0.992457580679641, 'loss_val': 1.6857106554721106, 'psi': 0.8267330020326553}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=4.345975 cos_to_last_merge=0.8683 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.868
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9464344406092324, 'auprc': 0.8985249413003743, 'loss_val': 0.548263535825021, 'psi': 0.9272706408856891}-{'f1_val': 0.9516230344304155, 'auprc': 0.9681764293047215, 'loss_val': 0.5069309894774892, 'psi': 0.9582443923801379}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=4.472496 cos_to_last_merge=0.8877 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.888
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.9991936395785745, 'auprc': 0.9999946111970874, 'loss_val': 0.003718978089880858, 'psi': 0.9995140282259797}-{'f1_val': 0.9993411206731109, 'auprc': 1.0, 'loss_val': 0.0015168667059833447, 'psi': 0.9996046724038665}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=4.120025 (no previous merge yet)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.8008730324623052, 'auprc': 0.9454818560170403, 'loss_val': 0.7897200428433668, 'psi': 0.8587165618841992}-{'f1_val': 0.8006251755416736, 'auprc': 0.945308239157022, 'loss_val': 0.7815087929643824, 'psi': 0.8584984009878129}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=4.353198 cos_to_last_merge=0.8867 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.887
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.7909477513480988, 'auprc': 0.9589150717107524, 'loss_val': 1.9158907849579356, 'psi': 0.8581346794931602}-{'f1_val': 0.7922663381961523, 'auprc': 0.9586450548481472, 'loss_val': 1.8805267655242257, 'psi': 0.8588178248569502}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=4.140182 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.8335115956577916, 'auprc': 0.9859498565231601, 'loss_val': 1.2265035490132699, 'psi': 0.894486900003939}-{'f1_val': 0.8342466203983618, 'auprc': 0.9855502166617222, 'loss_val': 1.1999917217170168, 'psi': 0.8947680589037059}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=3.686997 (no previous merge yet)
[S9] round=48 local utility u=0.004165 metrics={'f1_val': 0.9964670881300083, 'auprc': 0.9999826586467964, 'loss_val': 0.016449294749039462, 'psi': 0.9978733163367235}-{'f1_val': 0.9957233608815909, 'auprc': 0.9999814795972374, 'loss_val': 0.02031274268855437, 'psi': 0.9974266083678494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S9] sending update (kind=head size=1784 to 1 peers)
[S10] START round=48 head_norm_before_train=3.809848 cos_to_last_merge=0.8255 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.826
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9945465985042568, 'auprc': 0.9988259838837749, 'loss_val': 0.02611621486045791, 'psi': 0.996258352656064}-{'f1_val': 0.9956435195279056, 'auprc': 0.9989118944273148, 'loss_val': 0.02552333725406885, 'psi': 0.9969508694876693}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=4.037712 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9870176961416375, 'auprc': 0.9978427158505072, 'loss_val': 0.07561198210904681, 'psi': 0.9913477040251855}-{'f1_val': 0.9870176961416375, 'auprc': 0.9976998533569372, 'loss_val': 0.07470709367133123, 'psi': 0.9912905590277574}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=4.690313 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6846622234109978, 'auprc': 0.7526285086607252, 'loss_val': 1.7720635541064456, 'psi': 0.7118487375108888}-{'f1_val': 0.6924952289068002, 'auprc': 0.7767400457201802, 'loss_val': 1.585443276407931, 'psi': 0.7261931556321521}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=4.050620 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9034155669779359, 'auprc': 0.9993874891240193, 'loss_val': 0.2384968381235303, 'psi': 0.9418043358363692}-{'f1_val': 0.9089264099971178, 'auprc': 0.9993892956222402, 'loss_val': 0.22710085214662432, 'psi': 0.9451115642471668}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=3.658643 cos_to_last_merge=0.9727 (last merge round=1)
[S15] round=48 local utility u=0.000124 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987758422384365, 'loss_val': 0.030824770491168215, 'psi': 0.997558337927887}-{'f1_val': 0.9967466683875206, 'auprc': 0.998783836331046, 'loss_val': 0.031095970523922413, 'psi': 0.9975615355649308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=48 head_norm_before_train=3.924711 (no previous merge yet)
[S16] round=48 local utility u=0.000248 metrics={'f1_val': 0.992952316257258, 'auprc': 0.987048099450913, 'loss_val': 0.051903801555865575, 'psi': 0.99059062953472}-{'f1_val': 0.992952316257258, 'auprc': 0.9868018862812292, 'loss_val': 0.051660490635467925, 'psi': 0.9904921442668464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=48 head_norm_before_train=4.452851 cos_to_last_merge=0.9210 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.921
[S17] round=48 local utility u=0.123876 metrics={'f1_val': 0.8792114262377149, 'auprc': 0.9216571386663273, 'loss_val': 1.041306936332345, 'psi': 0.8961897112091599}-{'f1_val': 0.8664024203617243, 'auprc': 0.8697220167555869, 'loss_val': 1.056398764705134, 'psi': 0.8677302589192694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=49 head_norm_before_train=4.360302 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.9158228092210073, 'auprc': 0.9504250035443944, 'loss_val': 0.2879692666598717, 'psi': 0.9296636869503622}-{'f1_val': 0.9160282140354771, 'auprc': 0.9478865908006436, 'loss_val': 0.24867405635078246, 'psi': 0.9287715647415437}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=3.744842 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.7139918699002638, 'auprc': 0.9916447499787214, 'loss_val': 1.7577045593263911, 'psi': 0.8250530219316468}-{'f1_val': 0.7134246545561308, 'auprc': 0.9918528571046328, 'loss_val': 1.7431083341734976, 'psi': 0.8247959355755317}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=4.367536 cos_to_last_merge=0.8676 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.868
[S4] round=49 local utility u=0.089003 metrics={'f1_val': 0.9523115798617786, 'auprc': 0.9402586540169949, 'loss_val': 0.5307223072542581, 'psi': 0.9474904095238651}-{'f1_val': 0.9464344406092324, 'auprc': 0.8985249413003743, 'loss_val': 0.548263535825021, 'psi': 0.9272706408856891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=49 head_norm_before_train=4.447093 cos_to_last_merge=0.8786 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.879
[S5] round=49 local utility u=0.000610 metrics={'f1_val': 0.9992669255222367, 'auprc': 0.9999958485145831, 'loss_val': 0.002942125389203926, 'psi': 0.9995584947191753}-{'f1_val': 0.9991936395785745, 'auprc': 0.9999946111970874, 'loss_val': 0.003718978089880858, 'psi': 0.9995140282259797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=49 head_norm_before_train=4.139167 (no previous merge yet)
[S6] round=49 local utility u=0.012209 metrics={'f1_val': 0.8006251755416736, 'auprc': 0.9474083150776167, 'loss_val': 0.7695951708648378, 'psi': 0.8593384313560508}-{'f1_val': 0.8008730324623052, 'auprc': 0.9454818560170403, 'loss_val': 0.7897200428433668, 'psi': 0.8587165618841992}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=49 head_norm_before_train=4.373208 cos_to_last_merge=0.8863 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.886
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.7905063548094039, 'auprc': 0.9592849817511864, 'loss_val': 1.9391663657524545, 'psi': 0.858017805586117}-{'f1_val': 0.7909477513480988, 'auprc': 0.9589150717107524, 'loss_val': 1.9158907849579356, 'psi': 0.8581346794931602}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=4.158880 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.8342466203983618, 'auprc': 0.985907374602309, 'loss_val': 1.2317349484179732, 'psi': 0.8949109220799407}-{'f1_val': 0.8335115956577916, 'auprc': 0.9859498565231601, 'loss_val': 1.2265035490132699, 'psi': 0.894486900003939}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=3.704533 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9962190392098188, 'auprc': 0.9999811980622999, 'loss_val': 0.01751631540850229, 'psi': 0.9977239027508112}-{'f1_val': 0.9964670881300083, 'auprc': 0.9999826586467964, 'loss_val': 0.016449294749039462, 'psi': 0.9978733163367235}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=3.837407 cos_to_last_merge=0.8229 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.823
[S10] round=49 local utility u=0.001446 metrics={'f1_val': 0.994911683214924, 'auprc': 0.9988887620298201, 'loss_val': 0.025602144742556985, 'psi': 0.9965025147408824}-{'f1_val': 0.9945465985042568, 'auprc': 0.9988259838837749, 'loss_val': 0.02611621486045791, 'psi': 0.996258352656064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=49 head_norm_before_train=4.055744 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9867816220798488, 'auprc': 0.9980127331704287, 'loss_val': 0.07817275652243902, 'psi': 0.9912740665160806}-{'f1_val': 0.9870176961416375, 'auprc': 0.9978427158505072, 'loss_val': 0.07561198210904681, 'psi': 0.9913477040251855}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=4.740289 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.61094042521194, 'auprc': 0.751825522153067, 'loss_val': 2.1935339163940712, 'psi': 0.6672944639883909}-{'f1_val': 0.6846622234109978, 'auprc': 0.7526285086607252, 'loss_val': 1.7720635541064456, 'psi': 0.7118487375108888}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=4.068770 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.902094717808276, 'auprc': 0.9993851655398316, 'loss_val': 0.2510578348391269, 'psi': 0.9410108969008982}-{'f1_val': 0.9034155669779359, 'auprc': 0.9993874891240193, 'loss_val': 0.2384968381235303, 'psi': 0.9418043358363692}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=3.676580 cos_to_last_merge=0.9723 (last merge round=1)
[S15] round=49 local utility u=0.000076 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987382168979786, 'loss_val': 0.030560727876456088, 'psi': 0.9975432877917038}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987758422384365, 'loss_val': 0.030824770491168215, 'psi': 0.997558337927887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] sending update (kind=head size=1790 to 1 peers)
[S16] START round=49 head_norm_before_train=3.946300 (no previous merge yet)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9927325013443167, 'auprc': 0.9874789876679247, 'loss_val': 0.052287226289494955, 'psi': 0.9906310958737599}-{'f1_val': 0.992952316257258, 'auprc': 0.987048099450913, 'loss_val': 0.051903801555865575, 'psi': 0.99059062953472}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=4.579653 cos_to_last_merge=0.9119 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.912
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.8753956373780258, 'auprc': 0.8942939019546579, 'loss_val': 1.1193050820886703, 'psi': 0.8829549432086787}-{'f1_val': 0.8792114262377149, 'auprc': 0.9216571386663273, 'loss_val': 1.041306936332345, 'psi': 0.8961897112091599}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
